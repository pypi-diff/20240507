# Comparing `tmp/c2cgeoportal_admin-2.7.1.83-py3-none-any.whl.zip` & `tmp/c2cgeoportal_admin-2.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,94 +1,97 @@
-Zip file size: 149613 bytes, number of entries: 92
--rw-r--r--  2.0 unx     4959 b- defN 24-May-07 15:28 c2cgeoportal_admin/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 24-May-07 15:28 c2cgeoportal_admin/py.typed
--rw-r--r--  2.0 unx     4676 b- defN 24-May-07 15:28 c2cgeoportal_admin/routes.py
--rw-r--r--  2.0 unx     2430 b- defN 24-May-07 15:28 c2cgeoportal_admin/subscribers.py
--rw-r--r--  2.0 unx     6132 b- defN 24-May-07 15:28 c2cgeoportal_admin/widgets.py
--rw-r--r--  2.0 unx        0 b- defN 24-May-07 15:28 c2cgeoportal_admin/lib/__init__.py
--rw-r--r--  2.0 unx     3380 b- defN 24-May-07 15:28 c2cgeoportal_admin/lib/lingua_extractor.py
--rw-r--r--  2.0 unx    15421 b- defN 24-May-07 15:28 c2cgeoportal_admin/lib/ogcserver_synchronizer.py
--rw-r--r--  2.0 unx        0 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/__init__.py
--rw-r--r--  2.0 unx     2290 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/dimensions.py
--rw-r--r--  2.0 unx     3941 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/functionalities.py
--rw-r--r--  2.0 unx     2578 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/interfaces.py
--rw-r--r--  2.0 unx     8991 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/metadata.py
--rw-r--r--  2.0 unx     2598 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/restriction_areas.py
--rw-r--r--  2.0 unx     2507 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/roles.py
--rw-r--r--  2.0 unx     7039 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/treegroup.py
--rw-r--r--  2.0 unx     2117 b- defN 24-May-07 15:28 c2cgeoportal_admin/schemas/treeitem.py
--rw-r--r--  2.0 unx     3177 b- defN 24-May-07 15:28 c2cgeoportal_admin/static/layertree.css
--rw-r--r--  2.0 unx     2307 b- defN 24-May-07 15:28 c2cgeoportal_admin/static/navbar.css
--rw-r--r--  2.0 unx     2025 b- defN 24-May-07 15:28 c2cgeoportal_admin/static/theme.css
--rw-r--r--  2.0 unx     1420 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/404.jinja2
--rw-r--r--  2.0 unx     1302 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/edit.jinja2
--rw-r--r--  2.0 unx     1516 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/home.jinja2
--rw-r--r--  2.0 unx     2005 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/index.jinja2
--rw-r--r--  2.0 unx     9830 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/layertree.jinja2
--rw-r--r--  2.0 unx     4105 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/layout.jinja2
--rw-r--r--  2.0 unx     4166 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/navigation_navbar.jinja2
--rw-r--r--  2.0 unx     4327 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/ogcserver_synchronize.jinja2
--rw-r--r--  2.0 unx     2159 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/child.pt
--rw-r--r--  2.0 unx     6625 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/children.pt
--rw-r--r--  2.0 unx     2627 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/dimension.pt
--rw-r--r--  2.0 unx     1211 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/dimensions.pt
--rw-r--r--  2.0 unx     1969 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/functionality_fields.pt
--rw-r--r--  2.0 unx     3223 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/layer_fields.pt
--rw-r--r--  2.0 unx     2459 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/layer_group_fields.pt
--rw-r--r--  2.0 unx     3956 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/layer_v1_fields.pt
--rw-r--r--  2.0 unx     3735 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/metadata.pt
--rw-r--r--  2.0 unx     1476 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/metadatas.pt
--rw-r--r--  2.0 unx     1724 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/ogcserver_fields.pt
--rw-r--r--  2.0 unx     1731 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/restriction_area_fields.pt
--rw-r--r--  2.0 unx     2623 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/role_fields.pt
--rw-r--r--  2.0 unx     3083 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/theme_fields.pt
--rw-r--r--  2.0 unx     1753 b- defN 24-May-07 15:28 c2cgeoportal_admin/templates/widgets/user_fields.pt
--rw-r--r--  2.0 unx        0 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/__init__.py
--rw-r--r--  2.0 unx     2598 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/dimension_layers.py
--rw-r--r--  2.0 unx     4002 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/functionalities.py
--rw-r--r--  2.0 unx     1943 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/home.py
--rw-r--r--  2.0 unx     3465 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/interfaces.py
--rw-r--r--  2.0 unx     3956 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/layer_groups.py
--rw-r--r--  2.0 unx     3039 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/layers.py
--rw-r--r--  2.0 unx     4932 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/layers_vectortiles.py
--rw-r--r--  2.0 unx     7954 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/layers_wms.py
--rw-r--r--  2.0 unx     7731 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/layers_wmts.py
--rw-r--r--  2.0 unx     8589 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/layertree.py
--rw-r--r--  2.0 unx     3740 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/oauth2_clients.py
--rw-r--r--  2.0 unx     7476 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/ogc_servers.py
--rw-r--r--  2.0 unx     5549 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/restriction_areas.py
--rw-r--r--  2.0 unx     5858 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/roles.py
--rw-r--r--  2.0 unx     5710 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/themes.py
--rw-r--r--  2.0 unx     5590 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/themes_ordering.py
--rw-r--r--  2.0 unx     3860 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/treeitems.py
--rw-r--r--  2.0 unx     5355 b- defN 24-May-07 15:28 c2cgeoportal_admin/views/users.py
--rw-r--r--  2.0 unx     9525 b- defN 24-May-07 15:28 tests/__init__.py
--rw-r--r--  2.0 unx     2119 b- defN 24-May-07 15:28 tests/conftest.py
--rw-r--r--  2.0 unx     4495 b- defN 24-May-07 15:28 tests/test_edit_url.py
--rw-r--r--  2.0 unx     4126 b- defN 24-May-07 15:28 tests/test_functionalities.py
--rw-r--r--  2.0 unx      426 b- defN 24-May-07 15:28 tests/test_home.py
--rw-r--r--  2.0 unx     4704 b- defN 24-May-07 15:28 tests/test_interface.py
--rw-r--r--  2.0 unx    11062 b- defN 24-May-07 15:28 tests/test_layer_groups.py
--rw-r--r--  2.0 unx     9395 b- defN 24-May-07 15:28 tests/test_layers_vectortiles.py
--rw-r--r--  2.0 unx    18175 b- defN 24-May-07 15:28 tests/test_layers_wms.py
--rw-r--r--  2.0 unx    11185 b- defN 24-May-07 15:28 tests/test_layers_wmts.py
--rw-r--r--  2.0 unx    11336 b- defN 24-May-07 15:28 tests/test_layertree.py
--rw-r--r--  2.0 unx     2307 b- defN 24-May-07 15:28 tests/test_learn.py
--rw-r--r--  2.0 unx      920 b- defN 24-May-07 15:28 tests/test_left_menu.py
--rw-r--r--  2.0 unx     2515 b- defN 24-May-07 15:28 tests/test_lingua_extractor_config.py
--rw-r--r--  2.0 unx      365 b- defN 24-May-07 15:28 tests/test_main.py
--rw-r--r--  2.0 unx    12089 b- defN 24-May-07 15:28 tests/test_metadatas.py
--rw-r--r--  2.0 unx     5782 b- defN 24-May-07 15:28 tests/test_oauth2_clients.py
--rw-r--r--  2.0 unx     6436 b- defN 24-May-07 15:28 tests/test_ogc_servers.py
--rw-r--r--  2.0 unx     7925 b- defN 24-May-07 15:28 tests/test_restriction_areas.py
--rw-r--r--  2.0 unx    11820 b- defN 24-May-07 15:28 tests/test_role.py
--rw-r--r--  2.0 unx    15181 b- defN 24-May-07 15:28 tests/test_themes.py
--rw-r--r--  2.0 unx     2244 b- defN 24-May-07 15:28 tests/test_themes_ordering.py
--rw-r--r--  2.0 unx      576 b- defN 24-May-07 15:28 tests/test_treegroup.py
--rw-r--r--  2.0 unx    11659 b- defN 24-May-07 15:28 tests/test_user.py
--rw-r--r--  2.0 unx     1343 b- defN 24-May-07 15:28 tests/themes_ordering.py
--rw-r--r--  2.0 unx     1491 b- defN 24-May-07 16:11 c2cgeoportal_admin-2.7.1.83.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-May-07 16:11 c2cgeoportal_admin-2.7.1.83.dist-info/WHEEL
--rw-r--r--  2.0 unx      164 b- defN 24-May-07 16:11 c2cgeoportal_admin-2.7.1.83.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       25 b- defN 24-May-07 16:11 c2cgeoportal_admin-2.7.1.83.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     8626 b- defN 24-May-07 16:11 c2cgeoportal_admin-2.7.1.83.dist-info/RECORD
-92 files, 415048 bytes uncompressed, 135703 bytes compressed:  67.3%
+Zip file size: 159012 bytes, number of entries: 95
+-rw-r--r--  2.0 unx     5767 b- defN 24-May-07 15:29 c2cgeoportal_admin/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-07 15:29 c2cgeoportal_admin/py.typed
+-rw-r--r--  2.0 unx     4712 b- defN 24-May-07 15:29 c2cgeoportal_admin/routes.py
+-rw-r--r--  2.0 unx     2430 b- defN 24-May-07 15:29 c2cgeoportal_admin/subscribers.py
+-rw-r--r--  2.0 unx     6108 b- defN 24-May-07 15:29 c2cgeoportal_admin/widgets.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-07 15:29 c2cgeoportal_admin/lib/__init__.py
+-rw-r--r--  2.0 unx     3368 b- defN 24-May-07 15:29 c2cgeoportal_admin/lib/lingua_extractor.py
+-rw-r--r--  2.0 unx    15542 b- defN 24-May-07 15:29 c2cgeoportal_admin/lib/ogcserver_synchronizer.py
+-rw-r--r--  2.0 unx        0 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/__init__.py
+-rw-r--r--  2.0 unx     2319 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/dimensions.py
+-rw-r--r--  2.0 unx     3852 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/functionalities.py
+-rw-r--r--  2.0 unx     2613 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/interfaces.py
+-rw-r--r--  2.0 unx     8923 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/metadata.py
+-rw-r--r--  2.0 unx     2633 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/restriction_areas.py
+-rw-r--r--  2.0 unx     2542 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/roles.py
+-rw-r--r--  2.0 unx     7164 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/treegroup.py
+-rw-r--r--  2.0 unx     2146 b- defN 24-May-07 15:29 c2cgeoportal_admin/schemas/treeitem.py
+-rw-r--r--  2.0 unx     3177 b- defN 24-May-07 15:29 c2cgeoportal_admin/static/layertree.css
+-rw-r--r--  2.0 unx     2307 b- defN 24-May-07 15:29 c2cgeoportal_admin/static/navbar.css
+-rw-r--r--  2.0 unx     2025 b- defN 24-May-07 15:29 c2cgeoportal_admin/static/theme.css
+-rw-r--r--  2.0 unx     1807 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/404.jinja2
+-rw-r--r--  2.0 unx     1302 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/edit.jinja2
+-rw-r--r--  2.0 unx     1516 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/home.jinja2
+-rw-r--r--  2.0 unx     2005 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/index.jinja2
+-rw-r--r--  2.0 unx     9830 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/layertree.jinja2
+-rw-r--r--  2.0 unx     4105 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/layout.jinja2
+-rw-r--r--  2.0 unx     4166 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/navigation_navbar.jinja2
+-rw-r--r--  2.0 unx     4327 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/ogcserver_synchronize.jinja2
+-rw-r--r--  2.0 unx     2159 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/child.pt
+-rw-r--r--  2.0 unx     6625 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/children.pt
+-rw-r--r--  2.0 unx     2627 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/dimension.pt
+-rw-r--r--  2.0 unx     1211 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/dimensions.pt
+-rw-r--r--  2.0 unx     1969 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/functionality_fields.pt
+-rw-r--r--  2.0 unx     3223 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/layer_fields.pt
+-rw-r--r--  2.0 unx     2459 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/layer_group_fields.pt
+-rw-r--r--  2.0 unx     3956 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/layer_v1_fields.pt
+-rw-r--r--  2.0 unx     3735 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/metadata.pt
+-rw-r--r--  2.0 unx     1476 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/metadatas.pt
+-rw-r--r--  2.0 unx     1724 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/ogcserver_fields.pt
+-rw-r--r--  2.0 unx     1731 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/restriction_area_fields.pt
+-rw-r--r--  2.0 unx     2623 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/role_fields.pt
+-rw-r--r--  2.0 unx     3083 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/theme_fields.pt
+-rw-r--r--  2.0 unx     1753 b- defN 24-May-07 15:29 c2cgeoportal_admin/templates/widgets/user_fields.pt
+-rw-r--r--  2.0 unx      683 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/__init__.py
+-rw-r--r--  2.0 unx     2809 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/dimension_layers.py
+-rw-r--r--  2.0 unx     4410 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/functionalities.py
+-rw-r--r--  2.0 unx     1943 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/home.py
+-rw-r--r--  2.0 unx     3875 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/interfaces.py
+-rw-r--r--  2.0 unx     4520 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/layer_groups.py
+-rw-r--r--  2.0 unx     3279 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/layers.py
+-rw-r--r--  2.0 unx     5661 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/layers_vectortiles.py
+-rw-r--r--  2.0 unx     8397 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/layers_wms.py
+-rw-r--r--  2.0 unx     8111 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/layers_wmts.py
+-rw-r--r--  2.0 unx     8591 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/layertree.py
+-rw-r--r--  2.0 unx     3347 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/logged_views.py
+-rw-r--r--  2.0 unx     3807 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/logs.py
+-rw-r--r--  2.0 unx     3871 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/oauth2_clients.py
+-rw-r--r--  2.0 unx     9702 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/ogc_servers.py
+-rw-r--r--  2.0 unx     6153 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/restriction_areas.py
+-rw-r--r--  2.0 unx     6418 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/roles.py
+-rw-r--r--  2.0 unx     6298 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/themes.py
+-rw-r--r--  2.0 unx     5689 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/themes_ordering.py
+-rw-r--r--  2.0 unx     4069 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/treeitems.py
+-rw-r--r--  2.0 unx     5904 b- defN 24-May-07 15:29 c2cgeoportal_admin/views/users.py
+-rw-r--r--  2.0 unx     9556 b- defN 24-May-07 15:29 tests/__init__.py
+-rw-r--r--  2.0 unx     2254 b- defN 24-May-07 15:29 tests/conftest.py
+-rw-r--r--  2.0 unx     4494 b- defN 24-May-07 15:29 tests/test_edit_url.py
+-rw-r--r--  2.0 unx     5191 b- defN 24-May-07 15:29 tests/test_functionalities.py
+-rw-r--r--  2.0 unx      425 b- defN 24-May-07 15:29 tests/test_home.py
+-rw-r--r--  2.0 unx     5669 b- defN 24-May-07 15:29 tests/test_interface.py
+-rw-r--r--  2.0 unx    12191 b- defN 24-May-07 15:29 tests/test_layer_groups.py
+-rw-r--r--  2.0 unx    10404 b- defN 24-May-07 15:29 tests/test_layers_vectortiles.py
+-rw-r--r--  2.0 unx    19494 b- defN 24-May-07 15:29 tests/test_layers_wms.py
+-rw-r--r--  2.0 unx    12181 b- defN 24-May-07 15:29 tests/test_layers_wmts.py
+-rw-r--r--  2.0 unx    11335 b- defN 24-May-07 15:29 tests/test_layertree.py
+-rw-r--r--  2.0 unx     2307 b- defN 24-May-07 15:29 tests/test_learn.py
+-rw-r--r--  2.0 unx      919 b- defN 24-May-07 15:29 tests/test_left_menu.py
+-rw-r--r--  2.0 unx     2495 b- defN 24-May-07 15:29 tests/test_lingua_extractor_config.py
+-rw-r--r--  2.0 unx     3147 b- defN 24-May-07 15:29 tests/test_logs.py
+-rw-r--r--  2.0 unx      365 b- defN 24-May-07 15:29 tests/test_main.py
+-rw-r--r--  2.0 unx    12088 b- defN 24-May-07 15:29 tests/test_metadatas.py
+-rw-r--r--  2.0 unx     7028 b- defN 24-May-07 15:29 tests/test_oauth2_clients.py
+-rw-r--r--  2.0 unx     8204 b- defN 24-May-07 15:29 tests/test_ogc_servers.py
+-rw-r--r--  2.0 unx     9003 b- defN 24-May-07 15:29 tests/test_restriction_areas.py
+-rw-r--r--  2.0 unx    12804 b- defN 24-May-07 15:29 tests/test_role.py
+-rw-r--r--  2.0 unx    16207 b- defN 24-May-07 15:29 tests/test_themes.py
+-rw-r--r--  2.0 unx     2243 b- defN 24-May-07 15:29 tests/test_themes_ordering.py
+-rw-r--r--  2.0 unx      576 b- defN 24-May-07 15:29 tests/test_treegroup.py
+-rw-r--r--  2.0 unx    12842 b- defN 24-May-07 15:29 tests/test_user.py
+-rw-r--r--  2.0 unx     1342 b- defN 24-May-07 15:29 tests/themes_ordering.py
+-rw-r--r--  2.0 unx     1415 b- defN 24-May-07 16:19 c2cgeoportal_admin-2.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-May-07 16:19 c2cgeoportal_admin-2.9.dist-info/WHEEL
+-rw-r--r--  2.0 unx      165 b- defN 24-May-07 16:19 c2cgeoportal_admin-2.9.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       25 b- defN 24-May-07 16:19 c2cgeoportal_admin-2.9.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     8865 b- defN 24-May-07 16:19 c2cgeoportal_admin-2.9.dist-info/RECORD
+95 files, 449903 bytes uncompressed, 144744 bytes compressed:  67.8%
```

## zipnote {}

```diff
@@ -156,14 +156,20 @@
 
 Filename: c2cgeoportal_admin/views/layers_wmts.py
 Comment: 
 
 Filename: c2cgeoportal_admin/views/layertree.py
 Comment: 
 
+Filename: c2cgeoportal_admin/views/logged_views.py
+Comment: 
+
+Filename: c2cgeoportal_admin/views/logs.py
+Comment: 
+
 Filename: c2cgeoportal_admin/views/oauth2_clients.py
 Comment: 
 
 Filename: c2cgeoportal_admin/views/ogc_servers.py
 Comment: 
 
 Filename: c2cgeoportal_admin/views/restriction_areas.py
@@ -222,14 +228,17 @@
 
 Filename: tests/test_left_menu.py
 Comment: 
 
 Filename: tests/test_lingua_extractor_config.py
 Comment: 
 
+Filename: tests/test_logs.py
+Comment: 
+
 Filename: tests/test_main.py
 Comment: 
 
 Filename: tests/test_metadatas.py
 Comment: 
 
 Filename: tests/test_oauth2_clients.py
@@ -255,23 +264,23 @@
 
 Filename: tests/test_user.py
 Comment: 
 
 Filename: tests/themes_ordering.py
 Comment: 
 
-Filename: c2cgeoportal_admin-2.7.1.83.dist-info/METADATA
+Filename: c2cgeoportal_admin-2.9.dist-info/METADATA
 Comment: 
 
-Filename: c2cgeoportal_admin-2.7.1.83.dist-info/WHEEL
+Filename: c2cgeoportal_admin-2.9.dist-info/WHEEL
 Comment: 
 
-Filename: c2cgeoportal_admin-2.7.1.83.dist-info/entry_points.txt
+Filename: c2cgeoportal_admin-2.9.dist-info/entry_points.txt
 Comment: 
 
-Filename: c2cgeoportal_admin-2.7.1.83.dist-info/top_level.txt
+Filename: c2cgeoportal_admin-2.9.dist-info/top_level.txt
 Comment: 
 
-Filename: c2cgeoportal_admin-2.7.1.83.dist-info/RECORD
+Filename: c2cgeoportal_admin-2.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## c2cgeoportal_admin/__init__.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -26,37 +26,42 @@
 # either expressed or implied, of the FreeBSD Project.
 
 
 from typing import Any
 
 import c2cgeoform
 import c2cwsgiutils.pretty_json
-import sqlalchemy
+import sqlalchemy.orm.session
 import zope.sqlalchemy
 from c2c.template.config import config as configuration
 from pkg_resources import resource_filename
 from pyramid.config import Configurator
 from pyramid.events import BeforeRender, NewRequest
 from sqlalchemy import engine_from_config
 from sqlalchemy.orm import configure_mappers, sessionmaker
 from transaction import TransactionManager
 from translationstring import TranslationStringFactory
 
 from c2cgeoportal_admin.subscribers import add_localizer, add_renderer_globals
+from c2cgeoportal_admin.views import IsAdminPredicate
 
 search_paths = (resource_filename(__name__, "templates/widgets"),) + c2cgeoform.default_search_paths
 c2cgeoform.default_search_paths = search_paths
 
 _ = TranslationStringFactory("c2cgeoportal_admin")
 
 
 def main(_, **settings):
     """Return a Pyramid WSGI application."""
-    configuration.init(settings.get("app.cfg"))
-    settings.update(configuration.get_config())
+    app_cfg = settings.get("app.cfg")
+    assert app_cfg is not None
+    configuration.init(app_cfg)
+    conf = configuration.get_config()
+    assert conf is not None
+    settings.update(conf)
 
     config = Configurator(settings=settings)
 
     c2cwsgiutils.pretty_json.init(config)
     config.include("c2cgeoportal_admin")
 
     # Initialize the dev dbsession
@@ -65,28 +70,45 @@
 
     configure_mappers()
     engine = engine_from_config(settings)
     session_factory = sessionmaker()
     session_factory.configure(bind=engine)
 
     def get_tm_session(
-        session_factory: sessionmaker, transaction_manager: TransactionManager
+        session_factory: sessionmaker[  # pylint: disable=unsubscriptable-object
+            sqlalchemy.orm.session.Session
+        ],
+        transaction_manager: TransactionManager,
     ) -> sqlalchemy.orm.session.Session:
         dbsession = session_factory()
+        assert isinstance(dbsession, sqlalchemy.orm.session.Session)
         zope.sqlalchemy.register(dbsession, transaction_manager=transaction_manager)
         return dbsession
 
     # Make request.dbsession available for use in Pyramid
     config.add_request_method(
         # request.tm is the transaction manager used by pyramid_tm
         lambda request: get_tm_session(session_factory, request.tm),
         "dbsession",
         reify=True,
     )
 
+    # Add fake user as we do not have authentication from geoportal
+    from c2cgeoportal_commons.models.static import User  # pylint: disable=import-outside-toplevel
+
+    config.add_request_method(
+        lambda request: User(
+            username="test_user",
+        ),
+        name="user",
+        property=True,
+    )
+
+    config.add_route("ogc_server_clear_cache", "/admin/ogc_server_clear_cache/{id}")
+
     config.add_subscriber(add_renderer_globals, BeforeRender)
     config.add_subscriber(add_localizer, NewRequest)
 
     return config.make_wsgi_app()
 
 
 class PermissionSetter:
@@ -114,12 +136,13 @@
     config.include("pyramid_jinja2")
     config.include("c2cgeoform")
     config.include("c2cgeoportal_commons")
     config.include("c2cgeoportal_admin.routes")
     # Use pyramid_tm to hook the transaction lifecycle to the request
     config.include("pyramid_tm")
     config.add_translation_dirs("c2cgeoportal_admin:locale")
+    config.add_view_predicate("is_admin", IsAdminPredicate)
 
     configure_mappers()
 
     with PermissionSetter(config):
         config.scan()
```

## c2cgeoportal_admin/routes.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2023, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -57,14 +57,15 @@
     from c2cgeoportal_commons.models.main import (  # pylint: disable=import-outside-toplevel
         Functionality,
         Interface,
         LayerGroup,
         LayerVectorTiles,
         LayerWMS,
         LayerWMTS,
+        Log,
         OGCServer,
         RestrictionArea,
         Role,
         Theme,
     )
     from c2cgeoportal_commons.models.static import (  # pylint: disable=import-outside-toplevel
         OAuth2Client,
@@ -80,14 +81,15 @@
         ("ogc_servers", OGCServer),
         ("restriction_areas", RestrictionArea),
         ("users", User),
         ("roles", Role),
         ("functionalities", Functionality),
         ("interfaces", Interface),
         ("oauth2_clients", OAuth2Client),
+        ("logs", Log),
     ]
 
     admin_interface_config = config.registry.settings["admin_interface"]
 
     # Exclude pages
     visible_routes = [
         (url_path, model)
```

## c2cgeoportal_admin/widgets.py

```diff
@@ -86,19 +86,19 @@
     """
 
     template = "child"
     input_name = "treeitem_id"
     model = TreeItem
     label_field = "name"
 
-    def icon_class(self, child: Any) -> Optional[str]:  # pylint: disable=no-self-use,useless-return
+    def icon_class(self, child: Any) -> Optional[str]:  # pylint: disable=useless-return
         del child
         return None
 
-    def edit_url(  # pylint: disable=no-self-use,useless-return
+    def edit_url(  # pylint: disable=useless-return
         self, request: pyramid.request.Request, child: Any
     ) -> Optional[str]:
         del request
         del child
         return None
 
     def serialize(self, field, cstruct, **kw):
```

## c2cgeoportal_admin/lib/lingua_extractor.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2011-2022, Camptocamp SA
+# Copyright (c) 2011-2023, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,32 +23,32 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 import os
-from typing import Any, Dict, List, Optional
+from typing import Any, Optional
 
 import yaml
 from lingua.extractors import Extractor, Message
 
 
 class GeomapfishConfigExtractor(Extractor):  # type: ignore
     """GeoMapFish config extractor (raster layers, and print templates)."""
 
     extensions = [".yaml"]
 
     def __call__(
         self,
         filename: str,
-        options: Dict[str, Any],
-        fileobj: Optional[Dict[str, Any]] = None,
+        options: dict[str, Any],
+        fileobj: Optional[dict[str, Any]] = None,
         lineno: int = 0,
-    ) -> List[Message]:
+    ) -> list[Message]:
         del options, fileobj, lineno
 
         print(f"Running {self.__class__.__name__} on {filename}")
 
         with open(filename, encoding="utf8") as config_file:
             data = config_file.read()
             settings = yaml.load(
```

## c2cgeoportal_admin/lib/ogcserver_synchronizer.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2020-2021, Camptocamp SA
+# Copyright (c) 2020-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -25,15 +25,15 @@
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 import functools
 import logging
 from io import StringIO
-from typing import Any, Optional, Set, cast
+from typing import Any, Optional, cast
 from xml.etree.ElementTree import Element  # nosec
 
 import pyramid.request
 import requests
 from defusedxml import ElementTree
 from sqlalchemy.orm.session import Session
 
@@ -287,14 +287,15 @@
 
         return group
 
     def get_layer_wms(self, el: Element, parent: Optional[main.TreeGroup] = None) -> main.LayerWMS:
         name_el = el.find("Name")
         assert name_el is not None
         name = name_el.text
+        assert name is not None
 
         layer = cast(
             Optional[main.LayerWMS],
             self._request.dbsession.query(main.LayerWMS).filter(main.LayerWMS.name == name).one_or_none(),
         )
 
         if layer is None:
@@ -353,25 +354,25 @@
             parents = [parent] if isinstance(parent, main.LayerGroup) else []
             if self._force_parents and layer.parents != parents:
                 layer.parents_relation = [main.LayergroupTreeitem(group=parent) for parent in parents]
                 self._logger.info("Layer %s moved to %s", name, parent.name if parent else "root")
 
         return layer
 
-    @functools.lru_cache()
+    @functools.lru_cache(maxsize=10)
     def wms_capabilities(self) -> bytes:
-        errors: Set[str] = set()
+        errors: set[str] = set()
         url = get_url2(
             f"The OGC server '{self._ogc_server.name}'",
             self._ogc_server.url,
             self._request,
             errors,
         )
         if url is None:
-            raise Exception("\n".join(errors))
+            raise Exception("\n".join(errors))  # pylint: disable=broad-exception-raised
 
         # Add functionality params
         # sparams = get_mapserver_substitution_params(self.request)
         # url.add_query(url, sparams)
 
         url.add_query(
             {
@@ -397,13 +398,13 @@
         response.raise_for_status()
 
         # With WMS 1.3 it returns text/xml also in case of error :-(
         if response.headers.get("Content-Type", "").split(";")[0].strip() not in [
             "application/vnd.ogc.wms_xml",
             "text/xml",
         ]:
-            raise Exception(
+            raise Exception(  # pylint: disable=broad-exception-raised
                 f"GetCapabilities from URL '{url}' returns a wrong Content-Type: "
                 f"{response.headers.get('Content-Type', '')}\n{response.text}"
             )
 
         return response.content
```

## c2cgeoportal_admin/schemas/dimensions.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2018-2021, Camptocamp SA
+# Copyright (c) 2018-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -22,23 +22,25 @@
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
+from typing import Any
+
 import colander
 from c2cgeoform.schema import GeoFormSchemaNode
 from deform.widget import MappingWidget, SequenceWidget
 from sqlalchemy.orm.attributes import InstrumentedAttribute
 
 from c2cgeoportal_commons.models.main import Dimension
 
 
-def dimensions_schema_node(prop: InstrumentedAttribute) -> colander.SequenceSchema:
+def dimensions_schema_node(prop: InstrumentedAttribute[Any]) -> colander.SequenceSchema:
     """Get the scheme of the dimensions."""
     return colander.SequenceSchema(
         GeoFormSchemaNode(Dimension, name="dimension", widget=MappingWidget(template="dimension")),
         name=prop.key,
         title=prop.info["colanderalchemy"]["title"],
         description=prop.info["colanderalchemy"]["description"],
         widget=SequenceWidget(category="structural", template="dimensions"),
```

## c2cgeoportal_admin/schemas/functionalities.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2018-2021, Camptocamp SA
+# Copyright (c) 2018-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -22,50 +22,47 @@
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
-from typing import Any, Dict, List
+from typing import Any
 
 import colander
 from c2cgeoform.ext.deform_ext import RelationCheckBoxListWidget
 from c2cgeoform.schema import GeoFormManyToManySchemaNode, manytomany_validator
 from sqlalchemy import inspect, select
 from sqlalchemy.orm.attributes import InstrumentedAttribute
-from sqlalchemy.orm.decl_api import DeclarativeMeta
 from sqlalchemy.sql.functions import concat
 
 from c2cgeoportal_commons.models.main import Functionality
 
 
-def available_functionalities_for(settings: Dict[str, Any], model: DeclarativeMeta) -> List[Dict[str, Any]]:
+def available_functionalities_for(settings: dict[str, Any], model: type[Any]) -> list[dict[str, Any]]:
     """Return filtered list of functionality definitions."""
     mapper = inspect(model)
     relevant_for = {mapper.local_table.name}
     return [
         f
         for f in settings["admin_interface"]["available_functionalities"]
         if relevant_for & set(f.get("relevant_for", relevant_for))
     ]
 
 
-def functionalities_widget(model: DeclarativeMeta) -> colander.deferred:
+def functionalities_widget(model: type[Any]) -> colander.deferred:
     """Return a colander deferred which itself returns a widget for the functionalities field."""
 
     def create_widget(node, kw):
         del node
 
         return RelationCheckBoxListWidget(
-            select(
-                [
-                    Functionality.id,
-                    concat(Functionality.name, "=", Functionality.value).label("label"),
-                ]
+            select(  # type: ignore[arg-type]
+                Functionality.id,
+                concat(Functionality.name, "=", Functionality.value).label("label"),
             )
             .where(
                 Functionality.name.in_(
                     [f["name"] for f in available_functionalities_for(kw["request"].registry.settings, model)]
                 )
             )
             .alias("functionality_labels"),
@@ -77,20 +74,20 @@
             ),
         )
 
     return colander.deferred(create_widget)
 
 
 def functionalities_schema_node(
-    prop: InstrumentedAttribute, model: DeclarativeMeta
+    prop: InstrumentedAttribute[Any], model: type[Any]
 ) -> colander.SequenceSchema:
     """Get the schema of the functionalities."""
 
     return colander.SequenceSchema(
-        GeoFormManyToManySchemaNode(Functionality),
+        GeoFormManyToManySchemaNode(Functionality, None),
         name=prop.key,
         title=prop.info["colanderalchemy"]["title"],
         description=prop.info["colanderalchemy"].get("description"),
         widget=functionalities_widget(model),
         validator=manytomany_validator,
         missing=colander.drop,
     )
```

## c2cgeoportal_admin/schemas/interfaces.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2018-2021, Camptocamp SA
+# Copyright (c) 2018-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -22,26 +22,28 @@
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
+from typing import Any
+
 import colander
 from c2cgeoform.ext.deform_ext import RelationCheckBoxListWidget
 from c2cgeoform.schema import GeoFormManyToManySchemaNode, manytomany_validator
 from sqlalchemy.orm.attributes import InstrumentedAttribute
 
 from c2cgeoportal_commons.models.main import Interface
 
 
-def interfaces_schema_node(prop: InstrumentedAttribute) -> colander.SequenceSchema:
+def interfaces_schema_node(prop: InstrumentedAttribute[Any]) -> colander.SequenceSchema:
     """Get the serializable representation of an interface."""
     return colander.SequenceSchema(
-        GeoFormManyToManySchemaNode(Interface),
+        GeoFormManyToManySchemaNode(Interface, None),
         name=prop.key,
         title=prop.info["colanderalchemy"]["title"],
         description=prop.info["colanderalchemy"]["description"],
         widget=RelationCheckBoxListWidget(
             Interface,
             "id",
             "name",
```

## c2cgeoportal_admin/schemas/metadata.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2018-2021, Camptocamp SA
+# Copyright (c) 2018-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -22,40 +22,40 @@
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 import json
-from typing import Any, Dict, List, Optional, Set, Union, cast
+from typing import Any, Optional, Union, cast
 
 import colander
 import pyramid.request
 from c2cgeoform.schema import GeoFormSchemaNode
 from deform.widget import MappingWidget, SelectWidget, SequenceWidget, TextAreaWidget
 from sqlalchemy import inspect
 from sqlalchemy.orm.attributes import InstrumentedAttribute
-from sqlalchemy.orm.decl_api import DeclarativeMeta
 from sqlalchemy.orm.mapper import Mapper
 
 from c2cgeoportal_admin import _
 from c2cgeoportal_commons.lib.validators import url
 from c2cgeoportal_commons.models.main import Metadata
 
 
-def get_relevant_for(model: Union[DeclarativeMeta, Mapper]) -> Set[str]:
+def get_relevant_for(model: Union[type[Any], Mapper[Any]]) -> set[str]:
     """Return list of relevant_for values for passed class."""
     mapper = inspect(model)
+    assert mapper is not None
     relevant_for = {mapper.local_table.name}  # or mapper.polymorphic_identity
     if mapper.inherits:
         relevant_for |= get_relevant_for(mapper.inherits)
     return relevant_for
 
 
-def metadata_definitions(settings: Dict[str, Any], model: DeclarativeMeta) -> List[Dict[str, Any]]:
+def metadata_definitions(settings: dict[str, Any], model: type[Any]) -> list[dict[str, Any]]:
     """Return filtered list metadata definitions."""
     return [
         m
         for m in settings["admin_interface"]["available_metadata"]
         if get_relevant_for(model) & set(m.get("relevant_for", ["treeitem"]))
     ]
 
@@ -72,15 +72,15 @@
         if isinstance(cstruct, str) and (cstruct, cstruct) not in values:
             values = values.copy()
             values.append((cstruct, cstruct))
         kw["values"] = values
         return super().serialize(field, cstruct, **kw)
 
 
-def metadata_name_widget(model: DeclarativeMeta) -> colander.deferred:
+def metadata_name_widget(model: type[Any]) -> colander.deferred:
     """Return a colander deferred which itself returns a widget for the metadata name field."""
 
     def create_widget(node, kw):
         del node
         return MetadataSelectWidget(
             values=[
                 (m["name"], m["name"])
@@ -132,23 +132,23 @@
         if appstruct is True:
             return "true"
         if appstruct is False:
             return "false"
         return None
 
 
-class MetadataSchemaNode(GeoFormSchemaNode):  # type: ignore # pylint: disable=abstract-method
+class MetadataSchemaNode(GeoFormSchemaNode):  # pylint: disable=abstract-method
     """The metadata schema."""
 
-    metadata_definitions: Optional[Dict[str, Any]] = None
+    metadata_definitions: Optional[dict[str, Any]] = None
 
     def __init__(self, *args: Any, **kw: Any):
         super().__init__(*args, **kw)
 
-        self.available_types: List[str] = []
+        self.available_types: list[str] = []
 
         self._add_value_node("string", colander.String())
         self._add_value_node("liste", colander.String())
         self._add_value_node("boolean", BooleanMetadata())
         self._add_value_node("int", colander.Int())
         self._add_value_node("float", colander.Float())
         self._add_value_node("url", colander.String(), validator=url)
@@ -180,31 +180,31 @@
         value = obj.value or colander.null
         # depending on the type set the value in the right widget
         dict_[self._ui_type(obj.name)] = value
         return dict_
 
     def _ui_type(self, metadata_name: str) -> str:
         metadata_type = (
-            cast(Dict[str, Dict[str, str]], self.metadata_definitions)
+            cast(dict[str, dict[str, str]], self.metadata_definitions)
             .get(metadata_name, {})
             .get("type", "string")
         )
         return metadata_type if metadata_type in self.available_types else "string"
 
 
 def _translate_available_metadata(
-    available_metadata: Dict[str, Any], request: pyramid.request.Request
-) -> Dict[str, Any]:
+    available_metadata: dict[str, Any], request: pyramid.request.Request
+) -> dict[str, Any]:
     result = {}
     result.update(available_metadata)
     result["description"] = request.localizer.translate(_(available_metadata.get("description", "").strip()))
     return result
 
 
-def metadata_schema_node(prop: InstrumentedAttribute, model: DeclarativeMeta) -> colander.SequenceSchema:
+def metadata_schema_node(prop: InstrumentedAttribute[Any], model: type[Any]) -> colander.SequenceSchema:
     """Get the schema of a collection of metadata."""
 
     # Deferred which returns a dictionary with metadata name as key and metadata definition as value.
     # Needed to get the metadata types on UI side.
     metadata_definitions_dict = colander.deferred(
         lambda node, kw: {
             m["name"]: _translate_available_metadata(m, kw["request"])
```

## c2cgeoportal_admin/schemas/restriction_areas.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -22,26 +22,28 @@
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
+from typing import Any
+
 import colander
 from c2cgeoform.ext.deform_ext import RelationCheckBoxListWidget
 from c2cgeoform.schema import GeoFormManyToManySchemaNode, manytomany_validator
 from sqlalchemy.orm.attributes import InstrumentedAttribute
 
 from c2cgeoportal_commons.models.main import RestrictionArea
 
 
-def restrictionareas_schema_node(prop: InstrumentedAttribute) -> colander.SequenceSchema:
+def restrictionareas_schema_node(prop: InstrumentedAttribute[Any]) -> colander.SequenceSchema:
     """Get the schema of a restriction area."""
     return colander.SequenceSchema(
-        GeoFormManyToManySchemaNode(RestrictionArea),
+        GeoFormManyToManySchemaNode(RestrictionArea, None),
         name=prop.key,
         title=prop.info["colanderalchemy"]["title"],
         description=prop.info["colanderalchemy"].get("description"),
         widget=RelationCheckBoxListWidget(
             RestrictionArea,
             "id",
             "name",
```

## c2cgeoportal_admin/schemas/roles.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2018-2021, Camptocamp SA
+# Copyright (c) 2018-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -22,26 +22,28 @@
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
+from typing import Any
+
 import colander
 from c2cgeoform.ext.deform_ext import RelationCheckBoxListWidget
 from c2cgeoform.schema import GeoFormManyToManySchemaNode, manytomany_validator
 from sqlalchemy.orm.attributes import InstrumentedAttribute
 
 from c2cgeoportal_commons.models.main import Role
 
 
-def roles_schema_node(prop: InstrumentedAttribute) -> colander.SequenceSchema:
+def roles_schema_node(prop: InstrumentedAttribute[Any]) -> colander.SequenceSchema:
     """Get the schema of all the items."""
     return colander.SequenceSchema(
-        GeoFormManyToManySchemaNode(Role),
+        GeoFormManyToManySchemaNode(Role, None),
         name=prop.key,
         title=prop.info["colanderalchemy"]["title"],
         description=prop.info["colanderalchemy"].get("description"),
         widget=RelationCheckBoxListWidget(
             Role,
             "id",
             "name",
```

## c2cgeoportal_admin/schemas/treegroup.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2018-2022, Camptocamp SA
+# Copyright (c) 2018-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -24,18 +24,19 @@
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 import logging
 from functools import partial
-from typing import Any, Dict, List, Optional
+from typing import Any, Optional
 
 import colander
 import pyramid.request
+import sqlalchemy
 from c2cgeoform.schema import GeoFormSchemaNode
 from sqlalchemy.orm import aliased
 from sqlalchemy.sql.expression import case, func
 
 from c2cgeoportal_admin import _
 from c2cgeoportal_admin.widgets import ChildrenWidget, ChildWidget
 from c2cgeoportal_commons.lib.literal import Literal
@@ -49,38 +50,41 @@
     "group": "layer_groups",
     "layer": None,
     "l_wms": "layers_wms",
     "l_wmts": "layers_wmts",
 }
 
 
-class ChildSchemaNode(GeoFormSchemaNode):  # type: ignore # pylint: disable=abstract-method
+class ChildSchemaNode(GeoFormSchemaNode):  # pylint: disable=abstract-method
     """Schema of the child nodes."""
 
     def objectify(self, dict_, context=None):
         if dict_.get("id", None):
             context = self.dbsession.query(LayergroupTreeitem).get(dict_["id"])
         context = super().objectify(dict_, context)
         context.treeitem = self.dbsession.query(TreeItem).get(dict_["treeitem_id"])
         return context
 
 
 def treeitems(
-    node: TreeGroup, kw: Dict[str, pyramid.request.Request], only_groups: bool = False
-) -> List[Dict[str, Any]]:
+    node: TreeGroup, kw: dict[str, pyramid.request.Request], only_groups: bool = False
+) -> list[dict[str, Any]]:
     """Get a serializable representation of the tree items."""
     del node
     dbsession = kw["request"].dbsession
+    assert isinstance(dbsession, sqlalchemy.orm.Session)
 
-    group = case([(func.count(LayergroupTreeitem.id) == 0, "Unlinked")], else_="Others")
+    group = case(
+        (func.count(LayergroupTreeitem.id) == 0, "Unlinked"), else_="Others"  # pylint: disable=not-callable
+    )
 
     query = (
         dbsession.query(TreeItem, group)
         .distinct()
-        .outerjoin("parents_relation")
+        .outerjoin(TreeItem.parents_relation)
         .filter(TreeItem.item_type != "theme")
         .group_by(TreeItem.id)
         .order_by(group.desc(), TreeItem.name)
     )
 
     # Do not propose ancestors to avoid cycles
     item_id = kw["request"].matchdict["id"]
@@ -89,15 +93,15 @@
             dbsession.query(LayergroupTreeitem.treegroup_id)
             .filter(LayergroupTreeitem.treeitem_id == item_id)
             .cte(name="ancestors", recursive=True)
         )
         search_alias = aliased(search_ancestors, name="search_ancestors")
         relation_alias = aliased(LayergroupTreeitem, name="relation")
         search_ancestors = search_ancestors.union_all(
-            dbsession.query(relation_alias.treegroup_id).filter(
+            dbsession.query(relation_alias.treegroup_id).filter(  # type: ignore[arg-type]
                 relation_alias.treeitem_id == search_alias.c.treegroup_id
             )
         )
         ancestors = dbsession.query(search_ancestors.c.treegroup_id).subquery("ancestors")
 
         query = query.filter(~TreeItem.id.in_(ancestors)).filter(TreeItem.id != item_id)
```

## c2cgeoportal_admin/schemas/treeitem.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2018-2021, Camptocamp SA
+# Copyright (c) 2018-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -31,15 +31,15 @@
 import colander
 import deform
 
 from c2cgeoportal_admin.schemas.treegroup import base_deferred_parent_id_validator
 
 
 # Used for the creation of a new layer/layergroup from the layertree
-def parent_id_node(model):
+def parent_id_node(model: type) -> colander.SchemaNode:
     """Get the scheme to the parent node ID."""
     return colander.SchemaNode(
         colander.Integer(),
         name="parent_id",
         missing=colander.drop,
         validator=colander.deferred(partial(base_deferred_parent_id_validator, model=model)),
         widget=deform.widget.HiddenWidget(),
```

## c2cgeoportal_admin/templates/404.jinja2

```diff
@@ -20,12 +20,28 @@
  # IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  # CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  #}
 
 {% extends "layout.jinja2" %}
 
 {% block content %}
-<div class="content">
-  <h1><span class="font-semi-bold">Pyramid</span> <span class="smaller">Alchemy scaffold</span></h1>
+<div class="container-fluid">
+{% if "table" in request.matchdict %}
+{% for table in request.c2cgeoform_application.tables() %}
+{% if table["key"] == request.matchdict["table"] %}
+<h2>
+{{ table["title"] }}
+</h2>
+{% endif %}
+{% endfor %}
+{% endif %}
+{% if context.detail %}
+<p>{{ context.detail }}</p>
+{% else  %}
+{% if "id" in request.matchdict and "table" in request.matchdict %}
+<p>{{ _("Element id '{}' not found, probably deleted.").format(request.matchdict["id"]) }}</p>
+{% else %}
   <p class="lead"><span class="font-semi-bold">404</span> Page Not Found</p>
+{% endif %}
+{% endif %}
 </div>
 {% endblock content %}
```

## c2cgeoportal_admin/templates/widgets/metadata.pt

```diff
@@ -83,15 +83,15 @@
          if ($typedFormgroup.length == 0) {
            $typedFormgroup = $metadataItem.find('.item-string');
          }
          $typedFormgroup.show();
          $typedFormgroup.find('.form-control').attr('disabled', false);
 
          $helpBlock = $typedFormgroup.find('p.help-block');
-         $helpBlock.text(description);
+         $helpBlock.html(description);
        };
        $name.change(function() {
          updateType();
        });
        updateType();
      }
    );
```

## c2cgeoportal_admin/views/__init__.py

```diff
@@ -0,0 +1,43 @@
+00000000: 696d 706f 7274 2070 7972 616d 6964 2e68  import pyramid.h
+00000010: 7474 7065 7863 6570 7469 6f6e 730a 696d  ttpexceptions.im
+00000020: 706f 7274 2070 7972 616d 6964 2e72 6571  port pyramid.req
+00000030: 7565 7374 0a66 726f 6d20 7079 7261 6d69  uest.from pyrami
+00000040: 642e 7669 6577 2069 6d70 6f72 7420 7669  d.view import vi
+00000050: 6577 5f63 6f6e 6669 670a 0a0a 636c 6173  ew_config...clas
+00000060: 7320 4973 4164 6d69 6e50 7265 6469 6361  s IsAdminPredica
+00000070: 7465 3a0a 2020 2020 2222 220a 2020 2020  te:.    """.    
+00000080: 4120 6375 7374 6f6d 2070 7265 6469 6361  A custom predica
+00000090: 7465 2074 6861 7420 6368 6563 6b73 2069  te that checks i
+000000a0: 6620 7468 6520 7265 7175 6573 7420 6973  f the request is
+000000b0: 2066 6f72 2074 6865 2061 646d 696e 2069   for the admin i
+000000c0: 6e74 6572 6661 6365 2e0a 2020 2020 2222  nterface..    ""
+000000d0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+000000e0: 745f 5f28 7365 6c66 2c20 7661 6c2c 2069  t__(self, val, i
+000000f0: 6e66 6f29 3a0a 2020 2020 2020 2020 6465  nfo):.        de
+00000100: 6c20 696e 666f 0a0a 2020 2020 2020 2020  l info..        
+00000110: 7365 6c66 2e76 616c 203d 2076 616c 0a0a  self.val = val..
+00000120: 2020 2020 6465 6620 7465 7874 2873 656c      def text(sel
+00000130: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00000140: 726e 2066 2269 735f 6164 6d69 6e20 3d20  rn f"is_admin = 
+00000150: 7b73 656c 662e 7661 6c7d 220a 0a20 2020  {self.val}"..   
+00000160: 2070 6861 7368 203d 2074 6578 740a 0a20   phash = text.. 
+00000170: 2020 2064 6566 205f 5f63 616c 6c5f 5f28     def __call__(
+00000180: 7365 6c66 2c20 636f 6e74 6578 742c 2072  self, context, r
+00000190: 6571 7565 7374 293a 0a20 2020 2020 2020  equest):.       
+000001a0: 2072 6574 7572 6e20 7265 7175 6573 742e   return request.
+000001b0: 7061 7468 2e73 7461 7274 7377 6974 6828  path.startswith(
+000001c0: 222f 6164 6d69 6e2f 2229 206f 7220 7265  "/admin/") or re
+000001d0: 7175 6573 742e 7061 7468 203d 3d20 222f  quest.path == "/
+000001e0: 6164 6d69 6e22 0a0a 0a40 7669 6577 5f63  admin"...@view_c
+000001f0: 6f6e 6669 6728 636f 6e74 6578 743d 7079  onfig(context=py
+00000200: 7261 6d69 642e 6874 7470 6578 6365 7074  ramid.httpexcept
+00000210: 696f 6e73 2e48 5454 504e 6f74 466f 756e  ions.HTTPNotFoun
+00000220: 642c 2069 735f 6164 6d69 6e3d 5472 7565  d, is_admin=True
+00000230: 2c20 7265 6e64 6572 6572 3d22 2e2e 2f74  , renderer="../t
+00000240: 656d 706c 6174 6573 2f34 3034 2e6a 696e  emplates/404.jin
+00000250: 6a61 3222 290a 6465 6620 5f6e 6f74 5f66  ja2").def _not_f
+00000260: 6f75 6e64 5f76 6965 7728 7265 7175 6573  ound_view(reques
+00000270: 743d 7079 7261 6d69 642e 7265 7175 6573  t=pyramid.reques
+00000280: 742e 5265 7175 6573 7429 3a0a 2020 2020  t.Request):.    
+00000290: 6465 6c20 7265 7175 6573 740a 0a20 2020  del request..   
+000002a0: 2072 6574 7572 6e20 7b7d 0a               return {}.
```

## c2cgeoportal_admin/views/dimension_layers.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -24,36 +24,40 @@
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
 from itertools import groupby
-from typing import cast
+from typing import Generic, TypeVar, cast
 
-import sqlalchemy
+import sqlalchemy.orm.query
 from c2cgeoform.views.abstract_views import ListField
 from sqlalchemy.orm import subqueryload
 
 from c2cgeoportal_admin.views.layers import LayerViews
 from c2cgeoportal_commons.models.main import DimensionLayer
 
-_list_field = partial(ListField, DimensionLayer)
+_list_field = partial(ListField, DimensionLayer)  # type: ignore[var-annotated]
 
+_T = TypeVar("_T", bound=DimensionLayer)
 
-class DimensionLayerViews(LayerViews):
+
+class DimensionLayerViews(LayerViews[_T], Generic[_T]):
     """The layer with dimensions administration view."""
 
     _extra_list_fields = [
         _list_field(
             "dimensions",
             renderer=lambda layer_wms: "; ".join(
                 [
                     f"{group[0]}: {', '.join([d.value or 'NULL' for d in group[1]])}"
                     for group in groupby(layer_wms.dimensions, lambda d: cast(str, d.name))
                 ]
             ),
         )
-    ] + LayerViews._extra_list_fields
+    ] + LayerViews._extra_list_fields  # pylint: disable=protected-access
 
-    def _base_query(self, query: sqlalchemy.orm.query.Query) -> sqlalchemy.orm.query.Query:
-        return super()._base_query(query.options(subqueryload("dimensions")))
+    def _sub_query(
+        self, query: sqlalchemy.orm.query.Query[DimensionLayer]
+    ) -> sqlalchemy.orm.query.Query[DimensionLayer]:
+        return super()._sub_query(query.options(subqueryload(DimensionLayer.dimensions)))
```

## c2cgeoportal_admin/views/functionalities.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,32 +23,40 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
-from typing import Any, Dict
+from typing import Any
 
 import colander
 import pyramid.request
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import AbstractViews, ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from pyramid.view import view_config, view_defaults
 
 from c2cgeoportal_admin import _
+from c2cgeoportal_admin.views.logged_views import LoggedViews
 from c2cgeoportal_commons.models.main import Functionality
 
-_list_field = partial(ListField, Functionality)
+_list_field = partial(ListField, Functionality)  # type: ignore[var-annotated]
 
 
 def _translate_available_functionality(
-    available_functionality: Dict[str, Any], request: pyramid.request.Request
-) -> Dict[str, Any]:
+    available_functionality: dict[str, Any], request: pyramid.request.Request
+) -> dict[str, Any]:
     result = {}
     result.update(available_functionality)
     result["description"] = request.localizer.translate(
         _(available_functionality.get("description", "").strip())
     )
     return result
 
@@ -62,40 +70,40 @@
             for f in kw["request"].registry.settings["admin_interface"]["available_functionalities"]
         },
     ),
 )
 
 
 @view_defaults(match_param="table=functionalities")
-class FunctionalityViews(AbstractViews):  # type: ignore
+class FunctionalityViews(LoggedViews[Functionality]):
     """The functionality administration view."""
 
     _list_fields = [_list_field("id"), _list_field("name"), _list_field("description"), _list_field("value")]
     _id_field = "id"
     _model = Functionality
     _base_schema = base_schema
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")
-    def index(self):
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
         return super().index()
 
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")
-    def grid(self):
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
         return super().grid()
 
-    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         return super().edit()
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")
-    def delete(self):
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         return super().delete()
 
     @view_config(
-        route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
+        route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"  # type: ignore[misc]
     )
-    def duplicate(self):
+    def duplicate(self) -> ObjectResponse:
         return super().duplicate()
```

## c2cgeoportal_admin/views/interfaces.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -25,26 +25,34 @@
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
 
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import AbstractViews, ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from pyramid.view import view_config, view_defaults
 
+from c2cgeoportal_admin.views.logged_views import LoggedViews
 from c2cgeoportal_commons.models.main import Interface
 
-_list_field = partial(ListField, Interface)
+_list_field = partial(ListField, Interface)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(Interface)
 
 
 @view_defaults(match_param="table=interfaces")
-class InterfacesViews(AbstractViews):  # type: ignore
+class InterfacesViews(LoggedViews[Interface]):
     """The interface administration view."""
 
     _list_fields = [
         _list_field("id"),
         _list_field("name"),
         _list_field("description"),
         _list_field(
@@ -55,32 +63,32 @@
             renderer=lambda interface: ", ".join([f"{t.name}-{t.name}" or "" for t in interface.theme]),
         ),
     ]
     _id_field = "id"
     _model = Interface
     _base_schema = base_schema
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")
-    def index(self):
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
         return super().index()
 
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")
-    def grid(self):
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
         return super().grid()
 
-    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         return super().edit()
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")
-    def delete(self):
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         return super().delete()
 
-    @view_config(
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self):
+    def duplicate(self) -> ObjectResponse:
         return super().duplicate()
```

## c2cgeoportal_admin/views/layer_groups.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,68 +23,81 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
-from typing import Optional
 
 import sqlalchemy
+import sqlalchemy.orm.query
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from pyramid.view import view_config, view_defaults
 
 from c2cgeoportal_admin.schemas.metadata import metadata_schema_node
 from c2cgeoportal_admin.schemas.treegroup import children_schema_node
 from c2cgeoportal_admin.schemas.treeitem import parent_id_node
 from c2cgeoportal_admin.views.treeitems import TreeItemViews
 from c2cgeoportal_commons.models.main import LayerGroup, TreeGroup
 
-_list_field = partial(ListField, LayerGroup)
+_list_field = partial(ListField, LayerGroup)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(LayerGroup, widget=FormWidget(fields_template="layer_group_fields"))
 base_schema.add(children_schema_node())
 base_schema.add(metadata_schema_node(LayerGroup.metadatas, LayerGroup))
 base_schema.add_unique_validator(LayerGroup.name, LayerGroup.id)
-base_schema.add(parent_id_node(TreeGroup))  # type: ignore
+base_schema.add(parent_id_node(TreeGroup))
 
 
 @view_defaults(match_param="table=layer_groups")
-class LayerGroupsViews(TreeItemViews):
+class LayerGroupsViews(TreeItemViews[LayerGroup]):
     """The layer group administration view."""
 
-    _list_fields = TreeItemViews._list_fields + TreeItemViews._extra_list_fields
+    _list_fields = TreeItemViews._list_fields + TreeItemViews._extra_list_fields  # type: ignore[misc] # pylint: disable=protected-access
 
     _id_field = "id"
     _model = LayerGroup
     _base_schema = base_schema
 
-    def _base_query(self, query: Optional[sqlalchemy.orm.query.Query] = None) -> sqlalchemy.orm.query.Query:
-        return super()._base_query(self._request.dbsession.query(LayerGroup).distinct())
+    def _base_query(self) -> sqlalchemy.orm.query.Query[LayerGroup]:
+        return super()._sub_query(self._request.dbsession.query(LayerGroup).distinct())
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")
-    def index(self):
+    def _sub_query(
+        self, query: sqlalchemy.orm.query.Query[LayerGroup]
+    ) -> sqlalchemy.orm.query.Query[LayerGroup]:
+        del query
+        return self._base_query()
+
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
         return super().index()
 
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")
-    def grid(self):
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
         return super().grid()
 
-    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         return super().edit()
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")
-    def delete(self):
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         return super().delete()
 
-    @view_config(
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self):
+    def duplicate(self) -> ObjectResponse:
         return super().duplicate()
```

## c2cgeoportal_admin/views/layers.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,30 +23,33 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
-from typing import cast
+from typing import Generic, TypeVar, cast
 
 import sqlalchemy
+import sqlalchemy.orm.query
 from c2cgeoform.views.abstract_views import ListField
 from sqlalchemy.orm import subqueryload
 
 from c2cgeoportal_admin.views.treeitems import TreeItemViews
 from c2cgeoportal_commons.models.main import Interface, Layer
 
-_list_field = partial(ListField, Layer)
+_list_field = partial(ListField, Layer)  # type: ignore[var-annotated]
 
+_T = TypeVar("_T", bound=Layer)
 
-class LayerViews(TreeItemViews):
+
+class LayerViews(TreeItemViews[_T], Generic[_T]):
     """The layer administration view."""
 
-    _list_fields = TreeItemViews._list_fields + [
+    _list_fields = TreeItemViews._list_fields + [  # type: ignore[misc] # pylint: disable=protected-access
         _list_field("public"),
         _list_field("geo_table"),
         _list_field("exclude_properties"),
     ]
 
     _extra_list_fields = [
         _list_field(
@@ -59,15 +62,15 @@
         ),
         _list_field(
             "restrictionareas",
             renderer=lambda layer_wms: ", ".join(
                 [r.name or "" for r in sorted(layer_wms.restrictionareas, key=lambda r: cast(str, r.name))]
             ),
         ),
-    ] + TreeItemViews._extra_list_fields
+    ] + TreeItemViews._extra_list_fields  # pylint: disable=protected-access
 
-    def _base_query(self, query: sqlalchemy.orm.query.Query) -> sqlalchemy.orm.query.Query:
-        return super()._base_query(
+    def _sub_query(self, query: sqlalchemy.orm.query.Query[Layer]) -> sqlalchemy.orm.query.Query[Layer]:
+        return super()._sub_query(
             query.outerjoin(Layer.interfaces)
-            .options(subqueryload("interfaces"))
-            .options(subqueryload("restrictionareas"))
+            .options(subqueryload(Layer.interfaces))
+            .options(subqueryload(Layer.restrictionareas))
         )
```

## c2cgeoportal_admin/views/layers_vectortiles.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,93 +23,108 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
-from typing import Optional
+from typing import Optional, cast
 
 import sqlalchemy
+import sqlalchemy.orm.query
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from pyramid.httpexceptions import HTTPNotFound
 from pyramid.view import view_config, view_defaults
 
 from c2cgeoportal_admin import _
 from c2cgeoportal_admin.schemas.interfaces import interfaces_schema_node
 from c2cgeoportal_admin.schemas.metadata import metadata_schema_node
 from c2cgeoportal_admin.schemas.restriction_areas import restrictionareas_schema_node
 from c2cgeoportal_admin.schemas.treeitem import parent_id_node
 from c2cgeoportal_admin.views.dimension_layers import DimensionLayerViews
 from c2cgeoportal_commons.lib.literal import Literal
 from c2cgeoportal_commons.models.main import LayerGroup, LayerVectorTiles
 
-_list_field = partial(ListField, LayerVectorTiles)
+_list_field = partial(ListField, LayerVectorTiles)  # type: ignore[var-annotated]
 
 
 base_schema = GeoFormSchemaNode(LayerVectorTiles, widget=FormWidget(fields_template="layer_fields"))
 base_schema.add(metadata_schema_node(LayerVectorTiles.metadatas, LayerVectorTiles))
 base_schema.add(interfaces_schema_node(LayerVectorTiles.interfaces))
 base_schema.add(restrictionareas_schema_node(LayerVectorTiles.restrictionareas))
 base_schema.add_unique_validator(LayerVectorTiles.name, LayerVectorTiles.id)
-base_schema.add(parent_id_node(LayerGroup))  # type: ignore
+base_schema.add(parent_id_node(LayerGroup))
 
 
 @view_defaults(match_param="table=layers_vectortiles")
-class LayerVectorTilesViews(DimensionLayerViews):
+class LayerVectorTilesViews(DimensionLayerViews[LayerVectorTiles]):
     """The vector tiles administration view."""
 
     _list_fields = (
-        DimensionLayerViews._list_fields
+        DimensionLayerViews._list_fields  # typer: ignore[misc] # pylint: disable=protected-access
         + [_list_field("style"), _list_field("xyz")]
-        + DimensionLayerViews._extra_list_fields
+        + DimensionLayerViews._extra_list_fields  # pylint: disable=protected-access
     )
+
     _id_field = "id"
     _model = LayerVectorTiles
     _base_schema = base_schema
 
-    def _base_query(self, query: Optional[sqlalchemy.orm.query.Query] = None) -> sqlalchemy.orm.query.Query:
+    def _base_query(self) -> sqlalchemy.orm.query.Query[LayerVectorTiles]:
+        return super()._sub_query(self._request.dbsession.query(LayerVectorTiles).distinct())
+
+    def _sub_query(
+        self, query: Optional[sqlalchemy.orm.query.Query[LayerVectorTiles]]
+    ) -> sqlalchemy.orm.query.Query[LayerVectorTiles]:
         del query
-        return super()._base_query(self._request.dbsession.query(LayerVectorTiles).distinct())
+        return self._base_query()
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")
-    def index(self):
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
         return super().index()
 
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")
-    def grid(self):
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
         return super().grid()
 
     def schema(self) -> GeoFormSchemaNode:
         try:
             obj = self._get_object()
         except HTTPNotFound:
             obj = None
 
-        schema = self._base_schema.clone()
-        schema["style"].description = Literal(
-            _("{}<br>Current runtime value is: {}").format(
-                schema["style"].description,
-                obj.style_description(self._request),
+        schema = cast(GeoFormSchemaNode, self._base_schema.clone())
+        if obj is not None:
+            schema["style"].description = Literal(
+                _("{}<br>Current runtime value is: {}").format(
+                    schema["style"].description,
+                    obj.style_description(self._request),
+                )
             )
-        )
         return schema
 
-    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         return super().edit(self.schema())
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")
-    def delete(self):
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         return super().delete()
 
-    @view_config(
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self):
+    def duplicate(self) -> ObjectResponse:
         return super().duplicate()
```

## c2cgeoportal_admin/views/layers_wms.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,127 +23,143 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
-from typing import Any, Dict, List, Optional
+from typing import Optional
 
 import sqlalchemy
+from c2cgeoform import JSONDict
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import ItemAction, ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ItemAction,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from pyramid.view import view_config, view_defaults
 from sqlalchemy import delete, insert, inspect, update
 from zope.sqlalchemy import mark_changed
 
 from c2cgeoportal_admin import _
 from c2cgeoportal_admin.schemas.dimensions import dimensions_schema_node
 from c2cgeoportal_admin.schemas.interfaces import interfaces_schema_node
 from c2cgeoportal_admin.schemas.metadata import metadata_schema_node
 from c2cgeoportal_admin.schemas.restriction_areas import restrictionareas_schema_node
 from c2cgeoportal_admin.schemas.treeitem import parent_id_node
 from c2cgeoportal_admin.views.dimension_layers import DimensionLayerViews
-from c2cgeoportal_commons.models.main import LayerGroup, LayerWMS, LayerWMTS, OGCServer, TreeItem
+from c2cgeoportal_commons.models.main import LayerGroup, LayerWMS, LayerWMTS, LogAction, OGCServer, TreeItem
 
-_list_field = partial(ListField, LayerWMS)
+_list_field = partial(ListField, LayerWMS)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(LayerWMS, widget=FormWidget(fields_template="layer_fields"))
 base_schema.add(dimensions_schema_node(LayerWMS.dimensions))
 base_schema.add(metadata_schema_node(LayerWMS.metadatas, LayerWMS))
 base_schema.add(interfaces_schema_node(LayerWMS.interfaces))
 base_schema.add(restrictionareas_schema_node(LayerWMS.restrictionareas))
 base_schema.add_unique_validator(LayerWMS.name, LayerWMS.id)
-base_schema.add(parent_id_node(LayerGroup))  # type: ignore
+base_schema.add(parent_id_node(LayerGroup))
 
 
 @view_defaults(match_param="table=layers_wms")
-class LayerWmsViews(DimensionLayerViews):
+class LayerWmsViews(DimensionLayerViews[LayerWMS]):
     """The WMS layer administration view."""
 
     _list_fields = (
-        DimensionLayerViews._list_fields
+        DimensionLayerViews._list_fields  # pylint: disable=protected-access
         + [
             _list_field(
                 "ogc_server",
                 renderer=lambda layer_wms: layer_wms.ogc_server.name,
                 sort_column=OGCServer.name,
                 filter_column=OGCServer.name,
             ),
             _list_field("layer"),
             _list_field("style"),
             _list_field("valid", label="Valid"),
             _list_field("invalid_reason", visible=False),
             _list_field("time_mode"),
             _list_field("time_widget"),
         ]
-        + DimensionLayerViews._extra_list_fields
+        + DimensionLayerViews._extra_list_fields  # pylint: disable=protected-access
     )
     _id_field = "id"
     _model = LayerWMS
     _base_schema = base_schema
 
-    def _base_query(self, query: Optional[sqlalchemy.orm.query.Query] = None) -> sqlalchemy.orm.query.Query:
+    def _base_query(self) -> sqlalchemy.orm.query.Query[LayerWMS]:
+        return super()._sub_query(
+            self._request.dbsession.query(LayerWMS, OGCServer.name).distinct().outerjoin(LayerWMS.ogc_server)
+        )
+
+    def _sub_query(
+        self, query: Optional[sqlalchemy.orm.query.Query[LayerWMS]]
+    ) -> sqlalchemy.orm.query.Query[LayerWMS]:
         del query
-        return super()._base_query(self._request.dbsession.query(LayerWMS).distinct().outerjoin("ogc_server"))
+        return self._base_query()
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore
-    def index(self) -> Dict[str, Any]:
-        return super().index()  # type: ignore
-
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore
-    def grid(self) -> Dict[str, Any]:
-        return super().grid()  # type: ignore
-
-    def _item_actions(self, item: LayerWMS, readonly: bool = False) -> List[ItemAction]:
-        actions: List[ItemAction] = super()._item_actions(item, readonly)
-        if inspect(item).persistent:
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
+        return super().index()
+
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
+        return super().grid()
+
+    def _item_actions(self, item: LayerWMS, readonly: bool = False) -> list[ItemAction]:
+        actions: list[ItemAction] = super()._item_actions(item, readonly)
+        if inspect(item).persistent:  # type: ignore[attr-defined]
             actions.insert(
                 next((i for i, v in enumerate(actions) if v.name() == "delete")),
                 ItemAction(
                     name="convert_to_wmts",
                     label=_("Convert to WMTS"),
                     icon="glyphicon icon-l_wmts",
                     url=self._request.route_url("convert_to_wmts", id=getattr(item, self._id_field)),
                     method="POST",
                     confirmation=_("Are you sure you want to convert this layer to WMTS?"),
                 ),
             )
         return actions
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def view(self) -> Dict[str, Any]:
+    def view(self) -> ObjectResponse:
         if self._is_new():
             dbsession = self._request.dbsession
             default_wms = LayerWMS.get_default(dbsession)
             if default_wms:
-                return self.copy(default_wms, excludes=["name", "layer"])  # type: ignore
-        return super().edit()  # type: ignore
+                return self.copy(default_wms, excludes=["name", "layer"])
+        return super().edit()
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2"
     )
-    def save(self) -> Dict[str, Any]:
-        return super().save()  # type: ignore
+    def save(self) -> SaveResponse:
+        return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore
-    def delete(self) -> Dict[str, Any]:
-        return super().delete()  # type: ignore
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
+        return super().delete()
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self) -> Dict[str, Any]:
-        return super().duplicate()  # type: ignore
+    def duplicate(self) -> ObjectResponse:
+        return super().duplicate()
 
-    @view_config(route_name="convert_to_wmts", request_method="POST", renderer="fast_json")  # type: ignore
-    def convert_to_wmts(self) -> Dict[str, Any]:
+    @view_config(route_name="convert_to_wmts", request_method="POST", renderer="fast_json")  # type: ignore[misc]
+    def convert_to_wmts(self) -> JSONDict:
         src = self._get_object()
         dbsession = self._request.dbsession
         default_wmts = LayerWMTS.get_default(dbsession)
         values = (
             {"url": default_wmts.url, "matrix_set": default_wmts.matrix_set}
             if default_wmts
             else {"url": "", "matrix_set": ""}
@@ -168,14 +184,16 @@
             dbsession.execute(i)
             dbsession.execute(u)
             dbsession.expunge(src)
 
         dbsession.flush()
         mark_changed(dbsession)
 
+        self._create_log(LogAction.CONVERT_TO_WMTS, src, element_url_table="layers_wmts")
+
         return {
             "success": True,
             "redirect": self._request.route_url(
                 "c2cgeoform_item",
                 table="layers_wmts",
                 id=self._request.matchdict["id"],
                 _query=[("msg_col", "submit_ok")],
```

## c2cgeoportal_admin/views/layers_wmts.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,119 +23,133 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
-from typing import Any, Dict, List, Optional
 
 import sqlalchemy
+from c2cgeoform import JSONDict
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import ItemAction, ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ItemAction,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from pyramid.view import view_config, view_defaults
 from sqlalchemy import delete, insert, inspect, update
 from zope.sqlalchemy import mark_changed
 
 from c2cgeoportal_admin import _
 from c2cgeoportal_admin.schemas.dimensions import dimensions_schema_node
 from c2cgeoportal_admin.schemas.interfaces import interfaces_schema_node
 from c2cgeoportal_admin.schemas.metadata import metadata_schema_node
 from c2cgeoportal_admin.schemas.restriction_areas import restrictionareas_schema_node
 from c2cgeoportal_admin.schemas.treeitem import parent_id_node
 from c2cgeoportal_admin.views.dimension_layers import DimensionLayerViews
-from c2cgeoportal_commons.models.main import LayerGroup, LayerWMS, LayerWMTS, OGCServer, TreeItem
+from c2cgeoportal_commons.models.main import LayerGroup, LayerWMS, LayerWMTS, LogAction, OGCServer, TreeItem
 
-_list_field = partial(ListField, LayerWMTS)
+_list_field = partial(ListField, LayerWMTS)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(LayerWMTS, widget=FormWidget(fields_template="layer_fields"))
 base_schema.add(dimensions_schema_node(LayerWMTS.dimensions))
 base_schema.add(metadata_schema_node(LayerWMTS.metadatas, LayerWMTS))
 base_schema.add(interfaces_schema_node(LayerWMTS.interfaces))
 base_schema.add(restrictionareas_schema_node(LayerWMTS.restrictionareas))
 base_schema.add_unique_validator(LayerWMTS.name, LayerWMTS.id)
-base_schema.add(parent_id_node(LayerGroup))  # type: ignore
+base_schema.add(parent_id_node(LayerGroup))
 
 
 @view_defaults(match_param="table=layers_wmts")
-class LayerWmtsViews(DimensionLayerViews):
+class LayerWmtsViews(DimensionLayerViews[LayerWMTS]):
     """The WMTS layer administration view."""
 
     _list_fields = (
-        DimensionLayerViews._list_fields
+        DimensionLayerViews._list_fields  # pylint: disable=protected-access
         + [
             _list_field("url"),
             _list_field("layer"),
             _list_field("style"),
             _list_field("matrix_set"),
             _list_field("image_type"),
         ]
-        + DimensionLayerViews._extra_list_fields
+        + DimensionLayerViews._extra_list_fields  # pylint: disable=protected-access
     )
     _id_field = "id"
     _model = LayerWMTS
     _base_schema = base_schema
 
-    def _base_query(self, query: Optional[sqlalchemy.orm.query.Query] = None) -> sqlalchemy.orm.query.Query:
-        return super()._base_query(self._request.dbsession.query(LayerWMTS).distinct())
+    def _base_query(self) -> sqlalchemy.orm.query.Query[LayerWMTS]:
+        return super()._sub_query(self._request.dbsession.query(LayerWMTS).distinct())
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore
-    def index(self) -> Dict[str, Any]:
-        return super().index()  # type: ignore
-
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore
-    def grid(self) -> Dict[str, Any]:
-        return super().grid()  # type: ignore
-
-    def _item_actions(self, item: LayerWMTS, readonly: bool = False) -> List[ItemAction]:
-        actions: List[ItemAction] = super()._item_actions(item, readonly)
-        if inspect(item).persistent:
+    def _sub_query(
+        self, query: sqlalchemy.orm.query.Query[LayerWMTS]
+    ) -> sqlalchemy.orm.query.Query[LayerWMTS]:
+        del query
+        return self._base_query()
+
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
+        return super().index()
+
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
+        return super().grid()
+
+    def _item_actions(self, item: LayerWMTS, readonly: bool = False) -> list[ItemAction]:
+        actions: list[ItemAction] = super()._item_actions(item, readonly)
+        if inspect(item).persistent:  # type: ignore[attr-defined]
             actions.insert(
                 next((i for i, v in enumerate(actions) if v.name() == "delete")),
                 ItemAction(
                     name="convert_to_wms",
                     label=_("Convert to WMS"),
                     icon="glyphicon icon-l_wmts",
                     url=self._request.route_url("convert_to_wms", id=getattr(item, self._id_field)),
                     method="POST",
                     confirmation=_("Are you sure you want to convert this layer to WMS?"),
                 ),
             )
         return actions
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def view(self) -> Dict[str, Any]:
+    def view(self) -> ObjectResponse:
         if self._is_new():
             dbsession = self._request.dbsession
             default_wmts = LayerWMTS.get_default(dbsession)
             if default_wmts:
-                return self.copy(default_wmts, excludes=["name", "layer"])  # type: ignore
-        return super().edit()  # type: ignore
+                return self.copy(default_wmts, excludes=["name", "layer"])
+        return super().edit()
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2"
     )
-    def save(self) -> Dict[str, Any]:
-        return super().save()  # type: ignore
+    def save(self) -> SaveResponse:
+        return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore
-    def delete(self) -> Dict[str, Any]:
-        return super().delete()  # type: ignore
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
+        return super().delete()
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self) -> Dict[str, Any]:
-        return super().duplicate()  # type: ignore
+    def duplicate(self) -> ObjectResponse:
+        return super().duplicate()
 
-    @view_config(route_name="convert_to_wms", request_method="POST", renderer="fast_json")  # type: ignore
-    def convert_to_wms(self) -> Dict[str, Any]:
+    @view_config(route_name="convert_to_wms", request_method="POST", renderer="fast_json")  # type: ignore[misc]
+    def convert_to_wms(self) -> JSONDict:
         src = self._get_object()
         dbsession = self._request.dbsession
         default_wms = LayerWMS.get_default(dbsession)
         values = (
             {
                 "ogc_server_id": default_wms.ogc_server_id,
                 "time_mode": default_wms.time_mode,
@@ -161,14 +175,16 @@
             dbsession.execute(i)
             dbsession.execute(u)
             dbsession.expunge(src)
 
         dbsession.flush()
         mark_changed(dbsession)
 
+        self._create_log(LogAction.CONVERT_TO_WMS, src, element_url_table="layers_wms")
+
         return {
             "success": True,
             "redirect": self._request.route_url(
                 "c2cgeoform_item",
                 table="layers_wms",
                 id=self._request.matchdict["id"],
                 _query=[("msg_col", "submit_ok")],
```

## c2cgeoportal_admin/views/layertree.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -22,18 +22,18 @@
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
-from typing import Any, Dict, List, Optional
+from typing import Any, Optional
 
 import pyramid.request
-from c2cgeoform.views.abstract_views import ItemAction
+from c2cgeoform.views.abstract_views import DeleteResponse, ItemAction
 from pyramid.httpexceptions import HTTPNotFound
 from pyramid.view import view_config, view_defaults
 from translationstring import TranslationStringFactory
 
 from c2cgeoportal_admin import _
 from c2cgeoportal_commons.models.main import Interface, Layer, LayergroupTreeitem, Theme, TreeItem
 
@@ -41,30 +41,30 @@
     "theme": "themes",
     "group": "layer_groups",
     "l_wms": "layers_wms",
     "l_wmts": "layers_wmts",
 }
 
 
-@view_defaults(match_param=("application=admin"))
+@view_defaults(match_param="application=admin")
 class LayerTreeViews:
     """The layer tree administration view."""
 
     def __init__(self, request: pyramid.request.Request):
         self._request = request
         self._dbsession = request.dbsession
 
     @view_config(route_name="layertree", renderer="../templates/layertree.jinja2")  # type: ignore
-    def index(self) -> Dict[str, int]:
+    def index(self) -> dict[str, int]:
         node_limit = self._request.registry.settings["admin_interface"].get("layer_tree_max_nodes")
         limit_exceeded = self._dbsession.query(LayergroupTreeitem).count() < node_limit
         return {"limit_exceeded": limit_exceeded, "interfaces": self._dbsession.query(Interface).all()}
 
     @view_config(route_name="layertree_children", renderer="fast_json")  # type: ignore
-    def children(self) -> List[Dict[str, Any]]:
+    def children(self) -> list[dict[str, Any]]:
         interface = self._request.params.get("interface", None)
         group_id = self._request.params.get("group_id", None)
         path = self._request.params.get("path", "")
 
         client_tsf = TranslationStringFactory(f"{self._request.registry.package_name}-client")
 
         if group_id is None:
@@ -93,15 +93,15 @@
             }
             for item in items
             if interface is None
             or not isinstance(item, Layer)
             or interface in [interface.name for interface in item.interfaces]
         ]
 
-    def _item_actions(self, item: TreeItem, parent_id: Optional[int] = None) -> List[ItemAction]:
+    def _item_actions(self, item: TreeItem, parent_id: Optional[int] = None) -> list[ItemAction]:
         actions = []
         actions.append(
             ItemAction(
                 name="edit",
                 label=_("Edit"),
                 icon="glyphicon glyphicon-pencil",
                 url=self._request.route_url(
@@ -175,15 +175,15 @@
                 confirmation=_("Are your sure you want to delete this record?"),
             )
         )
 
         return actions
 
     @view_config(route_name="layertree_unlink", request_method="DELETE", renderer="fast_json")  # type: ignore
-    def unlink(self) -> Dict[str, Any]:
+    def unlink(self) -> dict[str, Any]:
         group_id = self._request.matchdict.get("group_id")
         item_id = self._request.matchdict.get("item_id")
         link = (
             self._request.dbsession.query(LayergroupTreeitem)
             .filter(LayergroupTreeitem.treegroup_id == group_id)
             .filter(LayergroupTreeitem.treeitem_id == item_id)
             .one_or_none()
@@ -191,15 +191,15 @@
         if link is None:
             raise HTTPNotFound()
         self._request.dbsession.delete(link)
         self._request.dbsession.flush()
         return {"success": True, "redirect": self._request.route_url("layertree")}
 
     @view_config(route_name="layertree_delete", request_method="DELETE", renderer="fast_json")  # type: ignore
-    def delete(self) -> Dict[str, Any]:
+    def delete(self) -> DeleteResponse:
         item_id = self._request.matchdict.get("item_id")
         item = self._request.dbsession.query(TreeItem).get(item_id)
         if item is None:
             raise HTTPNotFound()
         self._request.dbsession.delete(item)
         self._request.dbsession.flush()
         return {"success": True, "redirect": self._request.route_url("layertree")}
```

## c2cgeoportal_admin/views/oauth2_clients.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2021, Camptocamp SA
+# Copyright (c) 2021-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,67 +23,74 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
-from typing import Any, Dict
 
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import AbstractViews, ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from pyramid.view import view_config, view_defaults
 
-from c2cgeoportal_commons.models.static import OAuth2Client
+from c2cgeoportal_admin.views.logged_views import LoggedViews
+from c2cgeoportal_commons.models.static import Log, OAuth2Client
 
-_list_field = partial(ListField, OAuth2Client)
+_list_field = partial(ListField, OAuth2Client)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(OAuth2Client)
 base_schema.add_unique_validator(OAuth2Client.client_id, OAuth2Client.id)
 
 
 @view_defaults(match_param="table=oauth2_clients")
-class OAuth2ClientViews(AbstractViews):  # type: ignore
+class OAuth2ClientViews(LoggedViews[OAuth2Client]):
     """The oAuth2 client administration view."""
 
     _list_fields = [
         _list_field("id"),
         _list_field("client_id"),
         _list_field("secret"),
         _list_field("redirect_uri"),
     ]
     _id_field = "id"
     _model = OAuth2Client
     _base_schema = base_schema
+    _log_model = Log
+    _name_field = "client_id"
 
     def _base_query(self):
         return self._request.dbsession.query(OAuth2Client)
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore
-    def index(self) -> Dict[str, Any]:
-        return super().index()  # type: ignore
-
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore
-    def grid(self) -> Dict[str, Any]:
-        return super().grid()  # type: ignore
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
+        return super().index()
+
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
+        return super().grid()
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def view(self) -> Dict[str, Any]:
-        return super().edit()  # type: ignore
+    def view(self) -> ObjectResponse:
+        return super().edit()
 
-    @view_config(  # type: ignore
-        route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2"
-    )
-    def save(self) -> Dict[str, Any]:
-        return super().save()  # type: ignore
-
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore
-    def delete(self) -> Dict[str, Any]:
-        return super().delete()  # type: ignore
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
+        return super().save()
+
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
+        return super().delete()
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self) -> Dict[str, Any]:
-        return super().duplicate()  # type: ignore
+    def duplicate(self) -> ObjectResponse:
+        return super().duplicate()
```

## c2cgeoportal_admin/views/ogc_servers.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -22,37 +22,55 @@
 # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
+import logging
+import threading
 from functools import partial
-from typing import Any, Dict, List, cast
+from typing import Any, cast
 
+import requests
+from c2cgeoform import JSONDict
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import AbstractViews, ItemAction, ListField, UserMessage
+from c2cgeoform.views.abstract_views import (
+    AbstractViews,
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ItemAction,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+    UserMessage,
+)
 from deform.widget import FormWidget
-from pyramid.httpexceptions import HTTPNotFound
+from pyramid.httpexceptions import HTTPFound
 from pyramid.view import view_config, view_defaults
 from sqlalchemy import inspect
 
 from c2cgeoportal_admin import _
 from c2cgeoportal_admin.lib.ogcserver_synchronizer import OGCServerSynchronizer
+from c2cgeoportal_admin.views.logged_views import LoggedViews
 from c2cgeoportal_commons.lib.literal import Literal
-from c2cgeoportal_commons.models.main import OGCServer
+from c2cgeoportal_commons.models import cache_invalidate_cb
+from c2cgeoportal_commons.models.main import LogAction, OGCServer
 
-_list_field = partial(ListField, OGCServer)
+_list_field = partial(ListField, OGCServer)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(OGCServer, widget=FormWidget(fields_template="ogcserver_fields"))
 base_schema.add_unique_validator(OGCServer.name, OGCServer.id)
 
+LOG = logging.getLogger(__name__)
+
 
 @view_defaults(match_param="table=ogc_servers")
-class OGCServerViews(AbstractViews):  # type: ignore
+class OGCServerViews(LoggedViews[OGCServer]):
     """The OGC server administration view."""
 
     _list_fields = [
         _list_field("id"),
         _list_field("name"),
         _list_field("description"),
         _list_field("url"),
@@ -71,94 +89,113 @@
         **AbstractViews.MSG_COL,
         "cannot_delete": UserMessage(
             _("Impossible to delete this server while it contains WMS layers."),
             "alert-danger",
         ),
     }
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore
-    def index(self) -> Dict[str, Any]:
-        return super().index()  # type: ignore
-
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore
-    def grid(self) -> Dict[str, Any]:
-        return super().grid()  # type: ignore
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
+        return super().index()
+
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
+        return super().grid()
 
     def schema(self) -> GeoFormSchemaNode:
-        try:
-            obj = self._get_object()
-        except HTTPNotFound:
-            obj = None
+        obj = self._get_object()
 
-        schema = self._base_schema.clone()
+        schema = cast(GeoFormSchemaNode, self._base_schema.clone())
         schema["url"].description = Literal(
             _("{}<br>Current runtime value is: {}").format(
                 schema["url"].description,
                 obj.url_description(self._request),
             )
         )
         schema["url_wfs"].description = Literal(
             _("{}<br>Current runtime value is: {}").format(
                 schema["url_wfs"].description,
                 obj.url_wfs_description(self._request),
             )
         )
         return schema
 
-    def _item_actions(self, item: OGCServer, readonly: bool = False) -> List[Any]:
-        actions = cast(List[Any], super()._item_actions(item, readonly))
-        if inspect(item).persistent:
+    def _item_actions(self, item: OGCServer, readonly: bool = False) -> list[Any]:
+        actions = cast(list[Any], super()._item_actions(item, readonly))
+        if inspect(item).persistent:  # type: ignore[attr-defined]
+            actions.insert(
+                next((i for i, v in enumerate(actions) if v.name() == "delete")),
+                ItemAction(
+                    name="clear-cache",
+                    label=_("Clear the cache"),
+                    icon="glyphicon glyphicon-hdd",
+                    url=self._request.route_url(
+                        "ogc_server_clear_cache",
+                        id=getattr(item, self._id_field),
+                        _query={
+                            "came_from": self._request.current_route_url(),
+                        },
+                    ),
+                    confirmation=_("The current changes will be lost."),
+                ),
+            )
             actions.insert(
                 next((i for i, v in enumerate(actions) if v.name() == "delete")),
                 ItemAction(
                     name="synchronize",
                     label=_("Synchronize"),
                     icon="glyphicon glyphicon-import",
                     url=self._request.route_url("ogcserver_synchronize", id=getattr(item, self._id_field)),
                 ),
             )
         return actions
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def view(self) -> Dict[str, Any]:
-        return super().edit(self.schema())  # type: ignore
+    def view(self) -> ObjectResponse:
+        return super().edit(self.schema())
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2"
     )
-    def save(self) -> Dict[str, Any]:
-        return super().save()  # type: ignore
+    def save(self) -> SaveResponse:
+        result = super().save()
+        if isinstance(result, HTTPFound):
+            assert self._obj is not None
+            self._update_cache(self._obj)
+        return result
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore
-    def delete(self) -> Dict[str, Any]:
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         obj = self._get_object()
         if len(obj.layers) > 0:
             return {
                 "success": True,
                 "redirect": self._request.route_url(
                     "c2cgeoform_item",
                     action="edit",
                     id=obj.id,
                     _query=[("msg_col", "cannot_delete")],
                 ),
             }
-        return super().delete()  # type: ignore
+        result = super().delete()
+        cache_invalidate_cb()
+        return result
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self) -> Dict[str, Any]:
-        return super().duplicate()  # type: ignore
+    def duplicate(self) -> ObjectResponse:
+        return super().duplicate()
 
-    @view_config(  # type: ignore
+    @view_config(  # type: ignore[misc]
         route_name="ogcserver_synchronize", renderer="../templates/ogcserver_synchronize.jinja2"
     )
-    def synchronize(self) -> Dict[str, Any]:
+    def synchronize(self) -> JSONDict:
         obj = self._get_object()
 
         if self._request.method == "GET":
             return {
                 "ogcserver": obj,
                 "success": None,
                 "report": None,
@@ -172,20 +209,51 @@
             synchronizer = OGCServerSynchronizer(
                 self._request,
                 obj,
                 force_parents=force_parents,
                 force_ordering=force_ordering,
                 clean=clean,
             )
+
+            ogc_server_id = obj.id
             if "check" in self._request.params:
                 synchronizer.check_layers()
+
             elif "dry-run" in self._request.params:
                 synchronizer.synchronize(dry_run=True)
+
             elif "synchronize" in self._request.params:
                 synchronizer.synchronize()
+
+                self._create_log(LogAction.SYNCHRONIZE, obj)
+
             return {
-                "ogcserver": obj,
+                "ogcserver": self._request.dbsession.query(OGCServer).get(ogc_server_id),
                 "success": True,
                 "report": synchronizer.report(),
             }
 
+        self._update_cache(obj)
+
         return {}
+
+    def _update_cache(self, ogc_server: OGCServer) -> None:
+        try:
+            ogc_server_id = ogc_server.id
+
+            def update_cache() -> None:
+                response = requests.get(
+                    self._request.route_url(
+                        "ogc_server_clear_cache",
+                        id=ogc_server_id,
+                        _query={
+                            "came_from": self._request.current_route_url(),
+                        },
+                    ),
+                    timeout=60,
+                )
+                if not response.ok:
+                    LOG.error("Error while cleaning the OGC server cache:\n%s", response.text)
+
+            threading.Thread(target=update_cache).start()
+        except Exception:
+            LOG.error("Error on cleaning the OGC server cache", exc_info=True)
```

## c2cgeoportal_admin/views/restriction_areas.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -25,26 +25,35 @@
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
 
 import colander
+import sqlalchemy.orm.query
 from c2cgeoform.schema import GeoFormManyToManySchemaNode, GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import AbstractViews, ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from pyramid.view import view_config, view_defaults
 from sqlalchemy.orm import subqueryload
 
 from c2cgeoportal_admin.schemas.roles import roles_schema_node
 from c2cgeoportal_admin.schemas.treegroup import treeitem_edit_url
+from c2cgeoportal_admin.views.logged_views import LoggedViews
 from c2cgeoportal_admin.widgets import ChildrenWidget, ChildWidget
 from c2cgeoportal_commons.models.main import Layer, RestrictionArea
 
-_list_field = partial(ListField, RestrictionArea)
+_list_field = partial(ListField, RestrictionArea)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(RestrictionArea, widget=FormWidget(fields_template="restriction_area_fields"))
 base_schema.add_before("area", roles_schema_node(RestrictionArea.roles))
 base_schema.add_unique_validator(RestrictionArea.name, RestrictionArea.id)
 
 
 def layers(node, kw):  # pylint: disable=unused-argument
@@ -83,15 +92,15 @@
         candidates=colander.deferred(layers),
         widget=ChildrenWidget(child_input_name="id", orderable=False),
     )
 )
 
 
 @view_defaults(match_param="table=restriction_areas")
-class RestrictionAreaViews(AbstractViews):  # type: ignore
+class RestrictionAreaViews(LoggedViews[RestrictionArea]):
     """The restriction area administration view."""
 
     _list_fields = [
         _list_field("id"),
         _list_field("name"),
         _list_field("description"),
         _list_field("readwrite"),
@@ -105,39 +114,41 @@
             ),
         ),
     ]
     _id_field = "id"
     _model = RestrictionArea
     _base_schema = base_schema
 
-    def _base_query(self):
+    def _base_query(self) -> sqlalchemy.orm.query.Query[RestrictionArea]:
+        session = self._request.dbsession
+        assert isinstance(session, sqlalchemy.orm.Session)
         return (
-            self._request.dbsession.query(RestrictionArea)
-            .options(subqueryload("roles"))
-            .options(subqueryload("layers"))
+            session.query(RestrictionArea)
+            .options(subqueryload(RestrictionArea.roles))
+            .options(subqueryload(RestrictionArea.layers))
         )
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")
-    def index(self):
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
         return super().index()
 
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")
-    def grid(self):
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
         return super().grid()
 
-    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         return super().edit()
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")
-    def delete(self):
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         return super().delete()
 
-    @view_config(
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self):
+    def duplicate(self) -> ObjectResponse:
         return super().duplicate()
```

## c2cgeoportal_admin/views/roles.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -25,27 +25,36 @@
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
 
 import colander
+import sqlalchemy.orm.query
 from c2cgeoform.schema import GeoFormManyToManySchemaNode, GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import AbstractViews, ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from pyramid.view import view_config, view_defaults
 from sqlalchemy.orm import subqueryload
 
 from c2cgeoportal_admin.schemas.functionalities import functionalities_schema_node
 from c2cgeoportal_admin.schemas.restriction_areas import restrictionareas_schema_node
+from c2cgeoportal_admin.views.logged_views import LoggedViews
 from c2cgeoportal_admin.widgets import ChildrenWidget, ChildWidget
 from c2cgeoportal_commons.models.main import Role
 from c2cgeoportal_commons.models.static import User
 
-_list_field = partial(ListField, Role)
+_list_field = partial(ListField, Role)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(Role, widget=FormWidget(fields_template="role_fields"))
 base_schema.add_before("extent", functionalities_schema_node(Role.functionalities, Role))
 base_schema.add_before("extent", restrictionareas_schema_node(Role.restrictionareas))
 base_schema.add_unique_validator(Role.name, Role.id)
 
 
@@ -95,15 +104,15 @@
     )
 )
 # Not possible to overwrite this in constructor.
 base_schema["users"].children[0].description = ""
 
 
 @view_defaults(match_param="table=roles")
-class RoleViews(AbstractViews):  # type: ignore
+class RoleViews(LoggedViews[Role]):
     """The roles administration view."""
 
     _list_fields = [
         _list_field("id"),
         _list_field("name"),
         _list_field("description"),
         _list_field(
@@ -114,39 +123,41 @@
             "restrictionareas", renderer=lambda role: ", ".join([r.name or "" for r in role.restrictionareas])
         ),
     ]
     _id_field = "id"
     _model = Role
     _base_schema = base_schema
 
-    def _base_query(self):
+    def _base_query(self) -> sqlalchemy.orm.query.Query[Role]:
+        session = self._request.dbsession
+        assert isinstance(session, sqlalchemy.orm.Session)
         return (
-            self._request.dbsession.query(Role)
-            .options(subqueryload("functionalities"))
-            .options(subqueryload("restrictionareas"))
+            session.query(Role)
+            .options(subqueryload(Role.functionalities))
+            .options(subqueryload(Role.restrictionareas))
         )
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")
-    def index(self):
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
         return super().index()
 
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")
-    def grid(self):
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
         return super().grid()
 
-    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         return super().edit()
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")
-    def delete(self):
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         return super().delete()
 
-    @view_config(
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self):
+    def duplicate(self) -> ObjectResponse:
         return super().duplicate()
```

## c2cgeoportal_admin/views/themes.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,49 +23,56 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
-from typing import Optional, cast
+from typing import cast
 
 import sqlalchemy
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from pyramid.view import view_config, view_defaults
 from sqlalchemy.orm import subqueryload
 from sqlalchemy.sql.functions import concat
 
 from c2cgeoportal_admin.schemas.functionalities import functionalities_schema_node
 from c2cgeoportal_admin.schemas.interfaces import interfaces_schema_node
 from c2cgeoportal_admin.schemas.metadata import metadata_schema_node
 from c2cgeoportal_admin.schemas.roles import roles_schema_node
 from c2cgeoportal_admin.schemas.treegroup import children_schema_node
 from c2cgeoportal_admin.views.treeitems import TreeItemViews
 from c2cgeoportal_commons.models.main import Functionality, Interface, Role, Theme
 
-_list_field = partial(ListField, Theme)
+_list_field = partial(ListField, Theme)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(Theme, widget=FormWidget(fields_template="theme_fields"))
 base_schema.add(children_schema_node(only_groups=True))
 base_schema.add(functionalities_schema_node(Theme.functionalities, Theme))
 base_schema.add(roles_schema_node(Theme.restricted_roles))
 base_schema.add(interfaces_schema_node(Theme.interfaces))
 base_schema.add(metadata_schema_node(Theme.metadatas, Theme))
 base_schema.add_unique_validator(Theme.name, Theme.id)
 
 
 @view_defaults(match_param="table=themes")
-class ThemeViews(TreeItemViews):
+class ThemeViews(TreeItemViews[Theme]):
     """The theme administration view."""
 
     _list_fields = (
-        TreeItemViews._list_fields
+        TreeItemViews._list_fields  # type: ignore[misc] # pylint: disable=protected-access
         + [
             _list_field("ordering"),
             _list_field("public"),
             _list_field("icon"),
             _list_field(
                 "functionalities",
                 renderer=lambda themes: ", ".join(
@@ -85,51 +92,55 @@
                 "interfaces",
                 renderer=lambda themes: ", ".join(
                     [i.name or "" for i in sorted(themes.interfaces, key=lambda i: cast(str, i.name))]
                 ),
                 filter_column=Interface.name,
             ),
         ]
-        + TreeItemViews._extra_list_fields_no_parents
+        + TreeItemViews._extra_list_fields_no_parents  # pylint: disable=protected-access
     )
 
     _id_field = "id"
     _model = Theme
     _base_schema = base_schema
 
-    def _base_query(self, query: Optional[sqlalchemy.orm.query.Query] = None) -> sqlalchemy.orm.query.Query:
-        return super()._base_query(
+    def _base_query(self) -> sqlalchemy.orm.query.Query[Theme]:
+        return super()._sub_query(
             self._request.dbsession.query(Theme)
             .distinct()
-            .outerjoin("interfaces")
+            .outerjoin(Theme.interfaces)
             .outerjoin(Theme.restricted_roles)
             .outerjoin(Theme.functionalities)
-            .options(subqueryload("functionalities"))
-            .options(subqueryload("restricted_roles"))
-            .options(subqueryload("interfaces"))
+            .options(subqueryload(Theme.functionalities))
+            .options(subqueryload(Theme.restricted_roles))
+            .options(subqueryload(Theme.interfaces))
         )
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")
-    def index(self):
+    def _sub_query(self, query: sqlalchemy.orm.query.Query[Theme]) -> sqlalchemy.orm.query.Query[Theme]:
+        del query
+        return self._base_query()
+
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
         return super().index()
 
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")
-    def grid(self):
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
         return super().grid()
 
-    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         return super().edit()
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")
-    def delete(self):
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         return super().delete()
 
-    @view_config(
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self):
+    def duplicate(self) -> ObjectResponse:
         return super().duplicate()
```

## c2cgeoportal_admin/views/themes_ordering.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -24,26 +24,26 @@
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 import colander
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import AbstractViews
+from c2cgeoform.views.abstract_views import AbstractViews, ObjectResponse, SaveResponse
 from deform import ValidationFailure
 from pyramid.httpexceptions import HTTPFound
 from pyramid.view import view_config
 
 from c2cgeoportal_admin import _
 from c2cgeoportal_admin.schemas.treegroup import treeitem_edit_url
 from c2cgeoportal_admin.widgets import ChildrenWidget, ChildWidget
 from c2cgeoportal_commons.models.main import Theme, TreeItem
 
 
-class ThemeOrderSchema(GeoFormSchemaNode):  # type: ignore # pylint: disable=abstract-method
+class ThemeOrderSchema(GeoFormSchemaNode):  # pylint: disable=abstract-method
     """The theme order schema."""
 
     def objectify(self, dict_, context=None):
         context = self.dbsession.query(Theme).get(dict_["id"])
         context = super().objectify(dict_, context)
         return context
 
@@ -64,15 +64,15 @@
         if not dict_["id"] in [item["id"] for item in node.candidates]:
             raise colander.Invalid(
                 node,
                 _("Value {} does not exist in table {}").format(dict_["id"], Theme.__tablename__),
             )
 
 
-class ThemesOrderingSchema(colander.MappingSchema):  # type: ignore
+class ThemesOrderingSchema(colander.MappingSchema):  # type: ignore[misc]
     """The theme ordering schema."""
 
     themes = colander.SequenceSchema(
         ThemeOrderSchema(
             Theme,
             includes=["id", "ordering"],
             name="theme",
@@ -87,38 +87,38 @@
         name="themes",
         candidates=themes,
         validator=themes_validator,
         widget=ChildrenWidget(child_input_name="id", add_subitem=False, orderable=True),
     )
 
 
-class ThemesOrdering(AbstractViews):  # type: ignore
+class ThemesOrdering(AbstractViews[ThemesOrderingSchema]):
     """The theme ordering admin view."""
 
     _base_schema = ThemesOrderingSchema()
 
-    @view_config(route_name="layertree_ordering", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="layertree_ordering", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         form = self._form()
         dict_ = {
             "themes": [
                 form.schema["themes"].children[0].dictify(theme)
                 for theme in self._request.dbsession.query(Theme).order_by(Theme.ordering)
             ]
         }
         return {
             "title": form.title,
             "form": form,
-            "form_render_args": (dict_,),
+            "form_render_args": [dict_],
             "form_render_kwargs": {"request": self._request, "actions": []},
             "deform_dependencies": form.get_widget_resources(),
         }
 
-    @view_config(route_name="layertree_ordering", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="layertree_ordering", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         try:
             form = self._form()
             form_data = self._request.POST.items()
             _appstruct = form.validate(form_data)
             with self._request.dbsession.no_autoflush:
                 for dict_ in _appstruct["themes"]:
                     obj = form.schema["themes"].children[0].objectify(dict_)
@@ -127,11 +127,11 @@
             return HTTPFound(self._request.route_url("layertree"))
         except ValidationFailure as e:
             # FIXME see https://github.com/Pylons/deform/pull/243
             self._populate_widgets(form.schema)
             return {
                 "title": form.title,
                 "form": e,
-                "form_render_args": tuple(),
+                "form_render_args": [],
                 "form_render_kwargs": {"request": self._request, "actions": []},
                 "deform_dependencies": form.get_widget_resources(),
             }
```

## c2cgeoportal_admin/views/treeitems.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2021, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -23,27 +23,32 @@
 
 # The views and conclusions contained in the software and documentation are those
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
+from typing import Generic, TypeVar
 
 import sqlalchemy
-from c2cgeoform.views.abstract_views import AbstractViews, ListField
+from c2cgeoform.views.abstract_views import ListField, SaveResponse
 from pyramid.view import view_config
 from sqlalchemy.orm import subqueryload
 from sqlalchemy.sql.functions import concat
 
+from c2cgeoportal_admin.views.logged_views import LoggedViews
 from c2cgeoportal_commons.models.main import LayergroupTreeitem, Metadata, TreeGroup, TreeItem
 
-_list_field = partial(ListField, TreeItem)
+_list_field = partial(ListField, TreeItem)  # type: ignore[var-annotated]
 
 
-class TreeItemViews(AbstractViews):  # type: ignore
+_T = TypeVar("_T", bound=TreeItem)
+
+
+class TreeItemViews(LoggedViews[_T], Generic[_T]):
     """The admin tree item view."""
 
     _list_fields = [
         _list_field("id"),
         _list_field("name"),
         _list_field("description"),
     ]
@@ -63,28 +68,26 @@
                     p.treegroup.name or ""
                     for p in sorted(layer_wms.parents_relation, key=lambda p: p.treegroup.name or "")
                 ]
             ),
         )
     ] + _extra_list_fields_no_parents
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         response = super().save()
         # correctly handles the validation error as if there is a validation error, cstruct is empty
         has_to_be_registered_in_parent = (
             hasattr(self, "_appstruct") and self._appstruct is not None and self._appstruct.get("parent_id")
         )
         if has_to_be_registered_in_parent:
             parent = self._request.dbsession.query(TreeGroup).get(has_to_be_registered_in_parent)
             rel = LayergroupTreeitem(parent, self._obj, 100)
             self._request.dbsession.add(rel)
         return response
 
-    def _base_query(  # pylint: disable=arguments-differ
-        self, query: sqlalchemy.orm.query.Query
-    ) -> sqlalchemy.orm.query.Query:
+    def _sub_query(self, query: sqlalchemy.orm.query.Query[TreeItem]) -> sqlalchemy.orm.query.Query[TreeItem]:
         return (
-            query.outerjoin("metadatas")
-            .options(subqueryload("parents_relation").joinedload("treegroup"))
-            .options(subqueryload("metadatas"))
+            query.outerjoin(TreeItem.metadatas)
+            .options(subqueryload(TreeItem.parents_relation).joinedload(LayergroupTreeitem.treegroup))
+            .options(subqueryload(TreeItem.metadatas))
         )
```

## c2cgeoportal_admin/views/users.py

```diff
@@ -1,8 +1,8 @@
-# Copyright (c) 2017-2022, Camptocamp SA
+# Copyright (c) 2017-2024, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
@@ -25,37 +25,45 @@
 # of the authors and should not be interpreted as representing official policies,
 # either expressed or implied, of the FreeBSD Project.
 
 
 from functools import partial
 
 from c2cgeoform.schema import GeoFormSchemaNode
-from c2cgeoform.views.abstract_views import AbstractViews, ListField
+from c2cgeoform.views.abstract_views import (
+    DeleteResponse,
+    GridResponse,
+    IndexResponse,
+    ListField,
+    ObjectResponse,
+    SaveResponse,
+)
 from deform.widget import FormWidget
 from passwordgenerator import pwgenerator
 from pyramid.httpexceptions import HTTPFound
 from pyramid.view import view_config, view_defaults
 from sqlalchemy.orm import aliased, subqueryload
 
 from c2cgeoportal_admin.schemas.roles import roles_schema_node
+from c2cgeoportal_admin.views.logged_views import LoggedViews
 from c2cgeoportal_commons.lib.email_ import send_email_config
 from c2cgeoportal_commons.models.main import Role
-from c2cgeoportal_commons.models.static import User
+from c2cgeoportal_commons.models.static import Log, User
 
-_list_field = partial(ListField, User)
+_list_field = partial(ListField, User)  # type: ignore[var-annotated]
 
 base_schema = GeoFormSchemaNode(User, widget=FormWidget(fields_template="user_fields"))
 base_schema.add(roles_schema_node(User.roles))
 base_schema.add_unique_validator(User.username, User.id)
 
 settings_role = aliased(Role)
 
 
 @view_defaults(match_param="table=users")
-class UserViews(AbstractViews):  # type: ignore
+class UserViews(LoggedViews[User]):
     """The admin user view."""
 
     _list_fields = [
         _list_field("id"),
         _list_field("username"),
         _list_field("email"),
         _list_field("last_login"),
@@ -72,49 +80,53 @@
             renderer=lambda user: ", ".join([r.name or "" for r in user.roles]),
             filter_column=Role.name,
         ),
     ]
     _id_field = "id"
     _model = User
     _base_schema = base_schema
+    _log_model = Log
+    _name_field = "username"
 
     def _base_query(self):
         return (
             self._request.dbsession.query(User)
             .distinct()
             .outerjoin(settings_role, settings_role.id == User.settings_role_id)
-            .outerjoin("roles")
-            .options(subqueryload("settings_role"))
-            .options(subqueryload("roles"))
+            .outerjoin(User.roles)
+            .options(subqueryload(User.settings_role))
+            .options(subqueryload(User.roles))
         )
 
-    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")
-    def index(self):
+    @view_config(route_name="c2cgeoform_index", renderer="../templates/index.jinja2")  # type: ignore[misc]
+    def index(self) -> IndexResponse:
         return super().index()
 
-    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")
-    def grid(self):
+    @view_config(route_name="c2cgeoform_grid", renderer="fast_json")  # type: ignore[misc]
+    def grid(self) -> GridResponse:
         return super().grid()
 
-    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")
-    def view(self):
+    @view_config(route_name="c2cgeoform_item", request_method="GET", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def view(self) -> ObjectResponse:
         return super().edit()
 
-    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")
-    def save(self):
+    @view_config(route_name="c2cgeoform_item", request_method="POST", renderer="../templates/edit.jinja2")  # type: ignore[misc]
+    def save(self) -> SaveResponse:
         if self._is_new():
             response = super().save()
 
             if isinstance(response, HTTPFound):
                 password = pwgenerator.generate()
 
                 user = self._obj
+                assert user is not None
                 user.password = password
                 user.is_password_changed = False
                 user = self._request.dbsession.merge(user)
+                assert user is not None
                 self._request.dbsession.flush()
 
                 send_email_config(
                     settings=self._request.registry.settings,
                     email_config_name="welcome_email",
                     email=user.email,
                     user=user.username,
@@ -123,16 +135,16 @@
                     current_url=self._request.current_route_url(),
                 )
 
             return response
 
         return super().save()
 
-    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")
-    def delete(self):
+    @view_config(route_name="c2cgeoform_item", request_method="DELETE", renderer="fast_json")  # type: ignore[misc]
+    def delete(self) -> DeleteResponse:
         return super().delete()
 
-    @view_config(
+    @view_config(  # type: ignore[misc]
         route_name="c2cgeoform_item_duplicate", request_method="GET", renderer="../templates/edit.jinja2"
     )
-    def duplicate(self):
+    def duplicate(self) -> ObjectResponse:
         return super().duplicate()
```

## tests/__init__.py

```diff
@@ -50,15 +50,14 @@
         ("snappingConfig", '{"tolerance": 50}'),
     ]
 
     groups = [LayerGroup(name=f"layer_group_{i}") for i in range(0, 5)]
 
     layers = []
     for i in range(0, 25):
-
         layer = layer_builder(i)
 
         if add_dimension:
             layer.dimensions = [
                 Dimension(name=dimensions_protos[id][0], value=dimensions_protos[id][1], layer=layer)
                 for id in [i % 3, (i + 2) % 4, (i + 3) % 4]
             ]
@@ -86,15 +85,14 @@
 
         dbsession.add(layer)
         layers.append(layer)
     return {"restrictionareas": restrictionareas, "layers": layers, "interfaces": interfaces}
 
 
 class AbstractViewsTests:
-
     _prefix = None  # url prefix (index view url). Example: /users
 
     def get(self, test_app, path="", locale="en", status=200, **kwargs):
         return test_app.get(
             f"{self._prefix}{path}",
             headers={"Cookie": f"_LOCALE_={locale}"},
             status=status,
@@ -116,15 +114,16 @@
         ]
         expected_col_headers = [(x[0], x[1], len(x) == 3 and x[2] or "true") for x in expected_col_headers]
         assert expected_col_headers == effective_cols, str.format(
             "\n\n{}\n\n differs from \n\n{}", pp.pformat(expected_col_headers), pp.pformat(effective_cols)
         )
         actions = resp.html.select_one('th[data-field="actions"]')
         assert "false" == actions.attrs["data-sortable"]
-        assert 1 == len(list(filter(lambda x: next(x.stripped_strings) == new, resp.html.findAll("a"))))
+        if new is not False:
+            assert 1 == len(list(filter(lambda x: next(x.stripped_strings) == new, resp.html.findAll("a"))))
 
     def check_search(self, test_app, search="", offset=0, limit=10, sort="", order="", total=None):
         json = test_app.post(
             f"{self._prefix}/grid.json",
             params={"offset": offset, "limit": limit, "search": search, "sort": sort, "order": order},
             status=200,
         ).json
```

## tests/conftest.py

```diff
@@ -1,8 +1,9 @@
 import pytest
+import sqlalchemy.exc
 import transaction
 from pyramid import testing
 from pyramid.paster import bootstrap
 from sqlalchemy.exc import DBAPIError
 from webtest import TestApp as WebTestApp  # Avoid warning with pytest
 
 from c2cgeoportal_commons.testing import generate_mappers, get_engine, get_session_factory, get_tm_session
@@ -10,26 +11,29 @@
 
 
 @pytest.fixture(scope="session")
 @pytest.mark.usefixtures("settings")
 def dbsession(settings):
     generate_mappers()
     engine = get_engine(settings)
-    truncate_tables(engine)
     session_factory = get_session_factory(engine)
     session = get_tm_session(session_factory, transaction.manager)
+    truncate_tables(session)
     yield session
 
 
 @pytest.fixture(scope="function")
 @pytest.mark.usefixtures("dbsession")
 def transact(dbsession):
     t = dbsession.begin_nested()
     yield t
-    t.rollback()
+    try:
+        t.rollback()
+    except sqlalchemy.exc.ResourceClosedError:
+        print("The transaction was already closed")
     dbsession.expire_all()
 
 
 def raise_db_error(_):
     raise DBAPIError("this is a test !", None, None)
```

## tests/test_edit_url.py

```diff
@@ -88,15 +88,14 @@
         "group": group,
         "roles": roles,
     }
 
 
 @pytest.mark.usefixtures("edit_url_test_data", "test_app")
 class TestUrlEdit(AbstractViewsTests):
-
     _prefix = "/admin/"
 
     def _get(self, test_app, tablename, pk):
         path = f"/{tablename}/{pk}"
         return test_app.get(path, status=200)
 
     def _check_link(self, test_app, resp, item, table, status):
```

## tests/test_functionalities.py

```diff
@@ -27,15 +27,14 @@
     dbsession.flush()
 
     yield {"functionalities": functionalities}
 
 
 @pytest.mark.usefixtures("functionality_test_data", "test_app")
 class TestFunctionality(AbstractViewsTests):
-
     _prefix = "/admin/functionalities"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "Functionalities")
 
@@ -49,46 +48,72 @@
         self.check_grid_headers(resp, expected)
 
     def test_grid_search(self, test_app):
         # search on functionality name
         self.check_search(test_app, "default_basemap", total=1)
 
     def test_submit_new(self, dbsession, test_app):
-        from c2cgeoportal_commons.models.main import Functionality
+        from c2cgeoportal_commons.models.main import Functionality, Log, LogAction
 
         resp = test_app.post(
             "/admin/functionalities/new",
             {"name": "new_name", "description": "new_description", "value": "new_value"},
             status=302,
         )
         functionality = dbsession.query(Functionality).filter(Functionality.name == "new_name").one()
         assert str(functionality.id) == re.match(
             r"http://localhost/admin/functionalities/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
         assert functionality.name == "new_name"
 
-    def test_edit(self, test_app, functionality_test_data):
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "functionality"
+        assert log.element_id == functionality.id
+        assert log.element_name == functionality.name
+        assert log.username == "test_user"
+
+    def test_edit(self, test_app, functionality_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         functionality = functionality_test_data["functionalities"][0]
         resp = test_app.get(f"/admin/functionalities/{functionality.id}", status=200)
         form = resp.form
         assert str(functionality.id) == self.get_first_field_named(form, "id").value
         assert "hidden" == self.get_first_field_named(form, "id").attrs["type"]
         assert functionality.name == form["name"].value
         form["description"] = "new_description"
         assert form.submit().status_int == 302
         assert functionality.description == "new_description"
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "functionality"
+        assert log.element_id == functionality.id
+        assert log.element_name == functionality.name
+        assert log.username == "test_user"
+
     def test_delete(self, test_app, functionality_test_data, dbsession):
-        from c2cgeoportal_commons.models.main import Functionality
+        from c2cgeoportal_commons.models.main import Functionality, Log, LogAction
 
         functionality = functionality_test_data["functionalities"][0]
         deleted_id = functionality.id
         test_app.delete(f"/admin/functionalities/{deleted_id}", status=200)
         assert dbsession.query(Functionality).get(deleted_id) is None
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "functionality"
+        assert log.element_id == functionality.id
+        assert log.element_name == functionality.name
+        assert log.username == "test_user"
+
     def test_duplicate(self, functionality_test_data, test_app, dbsession):
         from c2cgeoportal_commons.models.main import Functionality
 
         functionality = functionality_test_data["functionalities"][3]
 
         resp = test_app.get(f"/admin/functionalities/{functionality.id}/duplicate", status=200)
```

## tests/test_home.py

```diff
@@ -1,15 +1,14 @@
 import pytest
 
 from . import AbstractViewsTests
 
 
 @pytest.mark.usefixtures("test_app")
 class TestHome(AbstractViewsTests):
-
     _prefix = "/admin/"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app, status=302)
         assert "http://localhost/admin/layertree" == resp.location
         to_layer_tree = resp.follow()
         assert to_layer_tree.html.select_one('div[id="layertree"]') is not None
```

## tests/test_interface.py

```diff
@@ -41,15 +41,14 @@
     dbsession.flush()
 
     yield {"interfaces": interfaces}
 
 
 @pytest.mark.usefixtures("interface_test_data", "test_app")
 class TestInterface(AbstractViewsTests):
-
     _prefix = "/admin/interfaces"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "Interfaces")
 
@@ -78,49 +77,73 @@
         assert first_interface.themes[1].name == "theme_0"
 
     def test_grid_search(self, test_app):
         # search on interface name
         self.check_search(test_app, "interface_0", total=1)
 
     def test_submit_new(self, dbsession, test_app):
-        from c2cgeoportal_commons.models.main import Interface
+        from c2cgeoportal_commons.models.main import Interface, Log, LogAction
 
         resp = test_app.post(
             "/admin/interfaces/new", {"name": "new_name", "description": "new description"}, status=302
         )
 
         interface = dbsession.query(Interface).filter(Interface.name == "new_name").one()
         assert str(interface.id) == re.match(
             r"http://localhost/admin/interfaces/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
         assert interface.name == "new_name"
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "interface"
+        assert log.element_id == interface.id
+        assert log.element_name == interface.name
+        assert log.username == "test_user"
+
     def test_edit(self, test_app, interface_test_data, dbsession):
-        from c2cgeoportal_commons.models.main import Interface
+        from c2cgeoportal_commons.models.main import Interface, Log, LogAction
 
         interface = interface_test_data["interfaces"][0]
         descriptions = "{}, {}".format(
             interface_test_data["interfaces"][0].description, interface_test_data["interfaces"][1].description
         )
         resp = test_app.get(f"/admin/interfaces/{interface.id}", status=200)
         form = resp.form
         form["description"] = descriptions
         assert str(interface.id) == self.get_first_field_named(form, "id").value
         assert "hidden" == self.get_first_field_named(form, "id").attrs["type"]
         assert interface.name == self.get_first_field_named(form, "name").value
         assert form.submit().status_int == 302
         assert len(dbsession.query(Interface).filter(Interface.description == descriptions).all()) == 1
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "interface"
+        assert log.element_id == interface.id
+        assert log.element_name == interface.name
+        assert log.username == "test_user"
+
     def test_delete(self, test_app, interface_test_data, dbsession):
-        from c2cgeoportal_commons.models.main import Interface
+        from c2cgeoportal_commons.models.main import Interface, Log, LogAction
 
         interface = interface_test_data["interfaces"][0]
         test_app.delete(f"/admin/interfaces/{interface.id}", status=200)
         assert len(dbsession.query(Interface).filter(Interface.id == interface.id).all()) == 0
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "interface"
+        assert log.element_id == interface.id
+        assert log.element_name == interface.name
+        assert log.username == "test_user"
+
     def test_duplicate(self, interface_test_data, test_app):
         interface = interface_test_data["interfaces"][3]
         resp = test_app.get(f"/admin/interfaces/{interface.id}/duplicate", status=200)
         form = resp.form
         assert "" == self.get_first_field_named(form, "id").value
         assert str(interface.description or "") == "description_3"
         assert form.submit().status_int == 302
```

## tests/test_layer_groups.py

```diff
@@ -56,15 +56,14 @@
     dbsession.flush()
 
     yield {"groups": groups}
 
 
 @pytest.mark.usefixtures("layer_groups_test_data", "test_app")
 class TestLayersGroups(TestTreeGroup):
-
     _prefix = "/admin/layer_groups"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "Layers groups")
 
@@ -90,14 +89,16 @@
         assert "disclaimer: © le momo, copyable: true" == row["metadatas"]
 
     def test_grid_search(self, test_app):
         # search on metadatas
         self.check_search(test_app, "copyable", total=8)
 
     def test_edit(self, test_app, layer_groups_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         group = layer_groups_test_data["groups"][1]
 
         form = self.get_item(test_app, group.id).form
 
         assert str(group.id) == self.get_first_field_named(form, "id").value
         assert "hidden" == self.get_first_field_named(form, "id").attrs["type"]
         assert group.name == self.get_first_field_named(form, "name").value
@@ -130,14 +131,22 @@
         dbsession.expire(group)
         for key, value in new_values.items():
             if isinstance(value, bool):
                 assert value == getattr(group, key)
             else:
                 assert str(value or "") == str(getattr(group, key) or "")
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "layergroup"
+        assert log.element_id == group.id
+        assert log.element_name == group.name
+        assert log.username == "test_user"
+
     def test_post_new_with_children_invalid(self, test_app, layer_groups_test_data):
         """
         Check there is no rendering error when validation fails.
         """
         groups = layer_groups_test_data["groups"]
         resp = test_app.post(
             f"{self._prefix}/new",
@@ -155,14 +164,16 @@
                 ("formsubmit", "formsubmit"),
             ),
             status=200,
         )
         assert "Required" == resp.html.select_one(".item-name .help-block").getText().strip()
 
     def test_post_new_with_children_success(self, test_app, dbsession, layer_groups_test_data):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         groups = layer_groups_test_data["groups"]
         resp = test_app.post(
             f"{self._prefix}/new",
             (
                 ("_charset_", "UTF-8"),
                 ("__formid__", "deform"),
                 ("name", "new_with_children"),
@@ -198,14 +209,22 @@
             r"http://localhost/admin/layer_groups/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
 
         assert [groups[3].id, groups[4].id, groups[5].id] == [
             rel.treeitem_id for rel in group.children_relation
         ]
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "layergroup"
+        assert log.element_id == group.id
+        assert log.element_name == group.name
+        assert log.username == "test_user"
+
     def test_post_with_ancestor(self, layer_groups_test_data, test_app):
         """
         Check that ancestors are refused to avoid cycles.
         """
         groups = layer_groups_test_data["groups"]
         resp = test_app.post(
             f"{self._prefix}/{groups[3].id}",
@@ -270,38 +289,53 @@
         resp = test_app.get(f"{self._prefix}/{group.id}/duplicate", status=200)
 
         resp = resp.form.submit("submit")
 
         self._check_submission_problem(resp, f"{group.name} is already used.")
 
     def test_delete(self, test_app, dbsession, layer_groups_test_data):
-        from c2cgeoportal_commons.models.main import LayerGroup, LayergroupTreeitem, TreeGroup, TreeItem
+        from c2cgeoportal_commons.models.main import (
+            LayerGroup,
+            LayergroupTreeitem,
+            Log,
+            LogAction,
+            TreeGroup,
+            TreeItem,
+        )
 
-        group_id = layer_groups_test_data["groups"][9].id
+        group = layer_groups_test_data["groups"][9]
 
         assert (
             3
-            == dbsession.query(LayergroupTreeitem).filter(LayergroupTreeitem.treegroup_id == group_id).count()
+            == dbsession.query(LayergroupTreeitem).filter(LayergroupTreeitem.treegroup_id == group.id).count()
         )
 
         assert (
             1
-            == dbsession.query(LayergroupTreeitem).filter(LayergroupTreeitem.treeitem_id == group_id).count()
+            == dbsession.query(LayergroupTreeitem).filter(LayergroupTreeitem.treeitem_id == group.id).count()
         )
 
-        test_app.delete(f"/admin/layer_groups/{group_id}", status=200)
+        test_app.delete(f"/admin/layer_groups/{group.id}", status=200)
 
         dbsession.expire_all()
 
-        assert dbsession.query(LayerGroup).get(group_id) is None
-        assert dbsession.query(TreeGroup).get(group_id) is None
-        assert dbsession.query(TreeItem).get(group_id) is None
+        assert dbsession.query(LayerGroup).get(group.id) is None
+        assert dbsession.query(TreeGroup).get(group.id) is None
+        assert dbsession.query(TreeItem).get(group.id) is None
 
         assert (
             0
-            == dbsession.query(LayergroupTreeitem).filter(LayergroupTreeitem.treegroup_id == group_id).count()
+            == dbsession.query(LayergroupTreeitem).filter(LayergroupTreeitem.treegroup_id == group.id).count()
         )
 
         assert (
             0
-            == dbsession.query(LayergroupTreeitem).filter(LayergroupTreeitem.treeitem_id == group_id).count()
+            == dbsession.query(LayergroupTreeitem).filter(LayergroupTreeitem.treeitem_id == group.id).count()
         )
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "layergroup"
+        assert log.element_id == group.id
+        assert log.element_name == group.name
+        assert log.username == "test_user"
```

## tests/test_layers_vectortiles.py

```diff
@@ -34,15 +34,14 @@
     dbsession.flush()
 
     yield data
 
 
 @pytest.mark.usefixtures("layer_vectortiles_test_data", "test_app")
 class TestLayerVectortiles(AbstractViewsTests):
-
     _prefix = "/admin/layers_vectortiles"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "Vector Tiles Layers")
 
@@ -102,14 +101,16 @@
         assert not form["public"].checked
 
         layer = layer_vectortiles_test_data["layers"][11]
         form = self.get_item(test_app, layer.id).form
         assert form["public"].checked
 
     def test_edit(self, test_app, layer_vectortiles_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         layer = layer_vectortiles_test_data["layers"][0]
 
         form = self.get_item(test_app, layer.id).form
 
         assert str(layer.id) == self.get_first_field_named(form, "id").value
         assert "hidden" == self.get_first_field_named(form, "id").attrs["type"]
         assert layer.name == self.get_first_field_named(form, "name").value
@@ -154,16 +155,24 @@
             if isinstance(value, bool):
                 assert value == getattr(layer, key)
             else:
                 assert str(value or "") == str(getattr(layer, key) or "")
         assert {interfaces[1].id, interfaces[3].id} == {interface.id for interface in layer.interfaces}
         assert {ras[1].id, ras[3].id} == {ra.id for ra in layer.restrictionareas}
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "layer_vectortiles"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
+
     def test_submit_new(self, dbsession, test_app, layer_vectortiles_test_data):
-        from c2cgeoportal_commons.models.main import LayerVectorTiles
+        from c2cgeoportal_commons.models.main import LayerVectorTiles, Log, LogAction
 
         resp = test_app.post(
             "/admin/layers_vectortiles/new",
             {
                 "name": "new_name",
                 "description": "new description",
                 "public": True,
@@ -174,14 +183,22 @@
         )
 
         layer = dbsession.query(LayerVectorTiles).filter(LayerVectorTiles.name == "new_name").one()
         assert str(layer.id) == re.match(
             r"http://localhost/admin/layers_vectortiles/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "layer_vectortiles"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
+
     def test_duplicate(self, layer_vectortiles_test_data, test_app, dbsession):
         from c2cgeoportal_commons.models.main import LayerVectorTiles
 
         layer = layer_vectortiles_test_data["layers"][3]
 
         resp = test_app.get(f"/admin/layers_vectortiles/{layer.id}/duplicate", status=200)
         form = resp.form
@@ -208,16 +225,24 @@
         ).group(1)
 
         assert layer.id == layer.metadatas[0].item_id
         assert layer_vectortiles_test_data["layers"][3].metadatas[0].name == layer.metadatas[0].name
         assert layer_vectortiles_test_data["layers"][3].metadatas[1].name == layer.metadatas[1].name
 
     def test_delete(self, test_app, dbsession):
-        from c2cgeoportal_commons.models.main import Layer, LayerVectorTiles, TreeItem
+        from c2cgeoportal_commons.models.main import Layer, LayerVectorTiles, Log, LogAction, TreeItem
 
-        layer_id = dbsession.query(LayerVectorTiles.id).first().id
+        layer = dbsession.query(LayerVectorTiles).first()
 
-        test_app.delete(f"/admin/layers_vectortiles/{layer_id}", status=200)
+        test_app.delete(f"/admin/layers_vectortiles/{layer.id}", status=200)
 
-        assert dbsession.query(LayerVectorTiles).get(layer_id) is None
-        assert dbsession.query(Layer).get(layer_id) is None
-        assert dbsession.query(TreeItem).get(layer_id) is None
+        assert dbsession.query(LayerVectorTiles).get(layer.id) is None
+        assert dbsession.query(Layer).get(layer.id) is None
+        assert dbsession.query(TreeItem).get(layer.id) is None
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "layer_vectortiles"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
```

## tests/test_layers_wms.py

```diff
@@ -35,15 +35,14 @@
     dbsession.flush()
 
     yield data
 
 
 @pytest.mark.usefixtures("layer_wms_test_data", "test_app")
 class TestLayerWMSViews(AbstractViewsTests):
-
     _prefix = "/admin/layers_wms"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "WMS Layers")
 
@@ -150,14 +149,16 @@
         assert not form["public"].checked
 
         layer = layer_wms_test_data["layers"][11]
         form = self.get_item(test_app, layer.id).form
         assert form["public"].checked
 
     def test_edit(self, test_app, layer_wms_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         layer = layer_wms_test_data["layers"][0]
 
         form = self.get_item(test_app, layer.id).form
 
         assert str(layer.id) == self.get_first_field_named(form, "id").value
         assert "hidden" == self.get_first_field_named(form, "id").attrs["type"]
         assert layer.name == self.get_first_field_named(form, "name").value
@@ -208,16 +209,24 @@
             if isinstance(value, bool):
                 assert value == getattr(layer, key)
             else:
                 assert str(value or "") == str(getattr(layer, key) or "")
         assert {interfaces[1].id, interfaces[3].id} == {interface.id for interface in layer.interfaces}
         assert {ras[1].id, ras[3].id} == {ra.id for ra in layer.restrictionareas}
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "layer_wms"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
+
     def test_submit_new(self, dbsession, test_app, layer_wms_test_data):
-        from c2cgeoportal_commons.models.main import LayerWMS
+        from c2cgeoportal_commons.models.main import LayerWMS, Log, LogAction
 
         resp = test_app.post(
             "/admin/layers_wms/new",
             {
                 "name": "new_name",
                 "description": "new description",
                 "public": True,
@@ -233,14 +242,22 @@
         )
 
         layer = dbsession.query(LayerWMS).filter(LayerWMS.name == "new_name").one()
         assert str(layer.id) == re.match(
             r"http://localhost/admin/layers_wms/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "layer_wms"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
+
     def test_duplicate(self, layer_wms_test_data, test_app, dbsession):
         from c2cgeoportal_commons.models.main import LayerWMS
 
         layer = layer_wms_test_data["layers"][3]
 
         resp = test_app.get(f"/admin/layers_wms/{layer.id}/duplicate", status=200)
         form = resp.form
@@ -335,20 +352,28 @@
         assert resp.json["success"]
         assert f"http://localhost/admin/layers_wmts/{layer.id}?msg_col=submit_ok" == resp.json["redirect"]
 
         resp = test_app.get(resp.json["redirect"], status=200)
         assert "image/jpeg" == resp.form["image_type"].value
 
     def test_convert_without_wmts_defaults(self, test_app, layer_wms_test_data, dbsession):
-        from c2cgeoportal_commons.models.main import LayerWMTS
+        from c2cgeoportal_commons.models.main import LayerWMTS, Log, LogAction
 
         dbsession.delete(LayerWMTS.get_default(dbsession))
         layer = layer_wms_test_data["layers"][3]
         test_app.post(f"/admin/layers_wms/{layer.id}/convert_to_wmts", status=200)
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.CONVERT_TO_WMTS
+        assert log.element_type == "layer_wms"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
+
     def test_unicity_validator(self, layer_wms_test_data, test_app):
         layer = layer_wms_test_data["layers"][2]
         resp = test_app.get(f"/admin/layers_wms/{layer.id}/duplicate", status=200)
 
         resp = resp.form.submit("submit")
 
         self._check_submission_problem(resp, f"{layer.name} is already used.")
@@ -367,25 +392,33 @@
 
         # layer = dbsession.query(LayerWMS). \
         #     filter(LayerWMS.name == 'layer_group_0'). \
         #     one()
         # assert str(layer.id) == re.match('http://localhost/admin/layers_wms/(.*)', resp.location).group(1)
 
     def test_delete(self, test_app, dbsession):
-        from c2cgeoportal_commons.models.main import Layer, LayerWMS, TreeItem
+        from c2cgeoportal_commons.models.main import Layer, LayerWMS, Log, LogAction, TreeItem
+
+        layer = dbsession.query(LayerWMS).first()
 
-        layer_id = dbsession.query(LayerWMS.id).first().id
+        test_app.delete(f"/admin/layers_wms/{layer.id}", status=200)
 
-        test_app.delete(f"/admin/layers_wms/{layer_id}", status=200)
+        assert dbsession.query(LayerWMS).get(layer.id) is None
+        assert dbsession.query(Layer).get(layer.id) is None
+        assert dbsession.query(TreeItem).get(layer.id) is None
 
-        assert dbsession.query(LayerWMS).get(layer_id) is None
-        assert dbsession.query(Layer).get(layer_id) is None
-        assert dbsession.query(TreeItem).get(layer_id) is None
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "layer_wms"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
 
-    def test_submit_new_no_layer_name(self, test_app, layer_wms_test_data):
+    def test_submit_new_no_layer_name(self, test_app, layer_wms_test_data, dbsession):
         resp = test_app.post(
             "/admin/layers_wms/new",
             {
                 "name": "new_name",
                 "description": "new description",
                 "public": True,
                 "geo_table": "new_geo_table",
```

## tests/test_layers_wmts.py

```diff
@@ -35,15 +35,14 @@
     dbsession.flush()
 
     yield data
 
 
 @pytest.mark.usefixtures("layer_wmts_test_data", "test_app")
 class TestLayerWMTS(AbstractViewsTests):
-
     _prefix = "/admin/layers_wmts"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "WMTS Layers")
 
@@ -98,14 +97,16 @@
         assert "" == self.get_first_field_named(form, "id").value
         assert "" == self.get_first_field_named(form, "name").value
         assert "" == self.get_first_field_named(form, "layer").value
         assert default_wmts.url == self.get_first_field_named(form, "url").value
         assert default_wmts.matrix_set == self.get_first_field_named(form, "matrix_set").value
 
     def test_edit(self, test_app, layer_wmts_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         layer = layer_wmts_test_data["layers"][0]
 
         form = self.get_item(test_app, layer.id).form
 
         assert str(layer.id) == self.get_first_field_named(form, "id").value
         assert "hidden" == self.get_first_field_named(form, "id").attrs["type"]
         assert layer.name == self.get_first_field_named(form, "name").value
@@ -156,14 +157,22 @@
             if isinstance(value, bool):
                 assert value == getattr(layer, key)
             else:
                 assert str(value or "") == str(getattr(layer, key) or "")
         assert {interfaces[1].id, interfaces[3].id} == {interface.id for interface in layer.interfaces}
         assert {ras[1].id, ras[3].id} == {ra.id for ra in layer.restrictionareas}
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "layer_wmts"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
+
     def test_duplicate(self, layer_wmts_test_data, test_app, dbsession):
         from c2cgeoportal_commons.models.main import LayerWMTS
 
         layer = layer_wmts_test_data["layers"][3]
 
         resp = test_app.get(f"/admin/layers_wmts/{layer.id}/duplicate", status=200)
         form = resp.form
@@ -186,23 +195,31 @@
 
         layer = dbsession.query(LayerWMTS).filter(LayerWMTS.name == "clone").one()
         assert str(layer.id) == re.match(
             r"http://localhost/admin/layers_wmts/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
 
     def test_delete(self, test_app, dbsession):
-        from c2cgeoportal_commons.models.main import Layer, LayerWMTS, TreeItem
+        from c2cgeoportal_commons.models.main import Layer, LayerWMTS, Log, LogAction, TreeItem
 
-        layer_id = dbsession.query(LayerWMTS.id).first().id
+        layer = dbsession.query(LayerWMTS).first()
 
-        test_app.delete(f"/admin/layers_wmts/{layer_id}", status=200)
+        test_app.delete(f"/admin/layers_wmts/{layer.id}", status=200)
 
-        assert dbsession.query(LayerWMTS).get(layer_id) is None
-        assert dbsession.query(Layer).get(layer_id) is None
-        assert dbsession.query(TreeItem).get(layer_id) is None
+        assert dbsession.query(LayerWMTS).get(layer.id) is None
+        assert dbsession.query(Layer).get(layer.id) is None
+        assert dbsession.query(TreeItem).get(layer.id) is None
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "layer_wmts"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
 
     def test_unicity_validator(self, layer_wmts_test_data, test_app):
         layer = layer_wmts_test_data["layers"][2]
         resp = test_app.get(f"/admin/layers_wmts/{layer.id}/duplicate", status=200)
 
         resp = resp.form.submit("submit")
 
@@ -244,12 +261,20 @@
         self._check_dimensions(resp.html, layer.dimensions)
         assert (
             "Your submission has been taken into account."
             == resp.html.find("div", {"class": "msg-lbl"}).getText()
         )
 
     def test_convert_without_wms_defaults(self, test_app, layer_wmts_test_data, dbsession):
-        from c2cgeoportal_commons.models.main import LayerWMS
+        from c2cgeoportal_commons.models.main import LayerWMS, Log, LogAction
 
         dbsession.delete(LayerWMS.get_default(dbsession))
         layer = layer_wmts_test_data["layers"][3]
         test_app.post(f"/admin/layers_wmts/{layer.id}/convert_to_wms", status=200)
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.CONVERT_TO_WMS
+        assert log.element_type == "layer_wmts"
+        assert log.element_id == layer.id
+        assert log.element_name == layer.name
+        assert log.username == "test_user"
```

## tests/test_layertree.py

```diff
@@ -99,15 +99,14 @@
 
 @patch(
     "c2cgeoportal_admin.views.layertree.TranslationStringFactory",
     new=lambda factory_domain: (str(factory_domain) + "_{}_").format,
 )
 @pytest.mark.usefixtures("layertree_test_data", "test_app")
 class TestLayerTreeView(AbstractViewsTests):
-
     _prefix = "/admin/layertree"
 
     def test_index(self, test_app):
         self.get(test_app, status=200)
 
     def check_edit_action(self, test_app, nodes, table, item_id):
         node = next(n for n in nodes if n["id"] == item_id)
```

## tests/test_left_menu.py

```diff
@@ -20,15 +20,14 @@
     dbsession.flush()
 
     yield {"roles": roles}
 
 
 @pytest.mark.usefixtures("test_app")
 class TestLeftMenu(AbstractViewsTests):
-
     _prefix = "/admin/roles"
 
     def test_index(self, test_app):
         resp = test_app.get("/admin/roles", status=200)
         self.check_left_menu(resp, "Roles")
 
     @pytest.mark.usefixtures("left_menu_test_data")
```

## tests/test_lingua_extractor_config.py

```diff
@@ -1,10 +1,8 @@
-# -*- coding: utf-8 -*-
-
-# Copyright (c) 2022, Camptocamp SA
+# Copyright (c) 2022-2023, Camptocamp SA
 # All rights reserved.
 
 # Redistribution and use in source and binary forms, with or without
 # modification, are permitted provided that the following conditions are met:
 
 # 1. Redistributions of source code must retain the above copyright notice, this
 #    list of conditions and the following disclaimer.
```

## tests/test_metadatas.py

```diff
@@ -55,15 +55,14 @@
         "theme": theme,
         "group": group,
     }
 
 
 @pytest.mark.usefixtures("metadatas_test_data", "test_app")
 class TestMetadatasView(AbstractViewsTests):
-
     _prefix = "/admin/"
 
     def __metadata_ui_types(self):
         return ("string", "liste", "boolean", "int", "float", "url", "json")
 
     def __metadata_ui_type(self, test_app, name):
         settings = test_app.app.registry.settings
```

## tests/test_oauth2_clients.py

```diff
@@ -1,12 +1,13 @@
 # pylint: disable=no-self-use,unsubscriptable-object
 
 import re
 from uuid import uuid4
 
+import pyramid.httpexceptions
 import pytest
 from pyramid.testing import DummyRequest
 
 from .test_treegroup import TestTreeGroup
 
 
 @pytest.fixture(scope="function")
@@ -31,15 +32,14 @@
     yield {
         "oauth2_clients": clients,
     }
 
 
 @pytest.mark.usefixtures("oauth2_clients_test_data", "test_app")
 class TestOAuth2Client(TestTreeGroup):
-
     _prefix = "/admin/oauth2_clients"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "OAuth2 Clients")
 
@@ -55,15 +55,16 @@
     def test_grid_search(self, test_app, oauth2_clients_test_data):
         self.check_search(test_app, "", total=23)
 
         client = oauth2_clients_test_data["oauth2_clients"][0]
         self.check_search(test_app, client.client_id, total=1)
 
     def test_submit_new(self, dbsession, test_app, oauth2_clients_test_data):
-        from c2cgeoportal_commons.models.static import OAuth2Client
+        from c2cgeoportal_commons.models.main import LogAction
+        from c2cgeoportal_commons.models.static import Log, OAuth2Client
 
         resp = test_app.post(
             "/admin/oauth2_clients/new",
             (
                 ("_charset_", "UTF-8"),
                 ("__formid__", "deform"),
                 ("id", ""),
@@ -80,15 +81,26 @@
             r"http://localhost/admin/oauth2_clients/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
 
         assert oauth2_client.client_id == "qgis2"
         assert oauth2_client.secret == "12345"
         assert oauth2_client.redirect_uri == "http://127.0.0.1:7070/bis"
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "oauth2_client"
+        assert log.element_id == oauth2_client.id
+        assert log.element_name == oauth2_client.client_id
+        assert log.username == "test_user"
+
     def test_edit_then_save(self, dbsession, test_app, oauth2_clients_test_data):
+        from c2cgeoportal_commons.models.main import LogAction
+        from c2cgeoportal_commons.models.static import Log
+
         oauth2_client = oauth2_clients_test_data["oauth2_clients"][10]
 
         dbsession.expire(oauth2_client)
 
         form = self.get_item(test_app, oauth2_client.id).form
 
         assert str(oauth2_client.id) == form["id"].value
@@ -108,14 +120,22 @@
 
         dbsession.expire(oauth2_client)
 
         assert "New client ID" == oauth2_client.client_id
         assert "New secret" == oauth2_client.secret
         assert "New redirect URI" == oauth2_client.redirect_uri
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "oauth2_client"
+        assert log.element_id == oauth2_client.id
+        assert log.element_name == oauth2_client.client_id
+        assert log.username == "test_user"
+
     def test_duplicate(self, oauth2_clients_test_data, test_app, dbsession):
         from c2cgeoportal_commons.models.static import OAuth2Client
 
         oauth2_client_proto = oauth2_clients_test_data["oauth2_clients"][7]
 
         resp = test_app.get(f"/admin/oauth2_clients/{oauth2_client_proto.id}/duplicate", status=200)
         form = resp.form
@@ -130,28 +150,37 @@
         oauth2_client = dbsession.query(OAuth2Client).filter(OAuth2Client.client_id == "clone").one()
         assert str(oauth2_client.id) == re.match(
             r"http://localhost/admin/oauth2_clients/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
         assert oauth2_client_proto.id != oauth2_client.id
 
     def test_delete(self, test_app, dbsession):
-        from c2cgeoportal_commons.models.static import OAuth2Client
+        from c2cgeoportal_commons.models.main import LogAction
+        from c2cgeoportal_commons.models.static import Log, OAuth2Client
 
-        oauth2_client_id = dbsession.query(OAuth2Client.id).first().id
-        test_app.delete(f"/admin/oauth2_clients/{oauth2_client_id}", status=200)
-        assert dbsession.query(OAuth2Client).get(oauth2_client_id) is None
+        oauth2_client = dbsession.query(OAuth2Client).first()
+        test_app.delete(f"/admin/oauth2_clients/{oauth2_client.id}", status=200)
+        assert dbsession.query(OAuth2Client).get(oauth2_client.id) is None
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "oauth2_client"
+        assert log.element_id == oauth2_client.id
+        assert log.element_name == oauth2_client.client_id
+        assert log.username == "test_user"
 
     def test_unicity_validator(self, oauth2_clients_test_data, test_app):
         oauth2_client_proto = oauth2_clients_test_data["oauth2_clients"][7]
         resp = test_app.get(f"/admin/oauth2_clients/{oauth2_client_proto.id}/duplicate", status=200)
 
         resp = resp.form.submit("submit")
 
         self._check_submission_problem(resp, f"{oauth2_client_proto.client_id} is already used.")
 
     @pytest.mark.usefixtures("raise_db_error_on_query")
     def test_grid_dberror(self, dbsession):
         from c2cgeoportal_admin.views.oauth2_clients import OAuth2ClientViews
 
         request = DummyRequest(dbsession=dbsession, params={"offset": 0, "limit": 10})
-        info = OAuth2ClientViews(request).grid()
-        assert info.status_int == 500, "Expected 500 status when db error"
+        with pytest.raises(pyramid.httpexceptions.HTTPInternalServerError):
+            OAuth2ClientViews(request).grid()
```

## tests/test_ogc_servers.py

```diff
@@ -1,10 +1,11 @@
 # pylint: disable=no-self-use
 
 import re
+from unittest.mock import patch
 
 import pytest
 
 from . import AbstractViewsTests
 
 
 @pytest.fixture(scope="function")
@@ -27,15 +28,14 @@
     dbsession.flush()
 
     yield {"ogc_servers": servers}
 
 
 @pytest.mark.usefixtures("ogc_server_test_data", "test_app")
 class TestOGCServer(AbstractViewsTests):
-
     _prefix = "/admin/ogc_servers"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "OGC Servers")
 
@@ -55,62 +55,90 @@
         self.check_grid_headers(resp, expected)
 
     def test_grid_search(self, test_app):
         # search on ogc_server name
         self.check_search(test_app, "server_0", total=1)
 
     def test_submit_new(self, dbsession, test_app):
-        from c2cgeoportal_commons.models.main import OGCServer
+        from c2cgeoportal_commons.models.main import Log, LogAction, OGCServer
 
-        resp = test_app.post(
-            "/admin/ogc_servers/new",
-            {
-                "name": "new_name",
-                "description": "new description",
-                "url": "www.randomurl.com",
-                "type": "mapserver",
-                "auth": "No auth",
-                "image_type": "image/png",
-            },
-            status=302,
-        )
+        with patch("c2cgeoportal_admin.views.ogc_servers.OGCServerViews._update_cache"):
+            resp = test_app.post(
+                "/admin/ogc_servers/new",
+                {
+                    "name": "new_name",
+                    "description": "new description",
+                    "url": "www.randomurl.com",
+                    "type": "mapserver",
+                    "auth": "No auth",
+                    "image_type": "image/png",
+                },
+                status=302,
+            )
         ogc_server = dbsession.query(OGCServer).filter(OGCServer.name == "new_name").one()
         assert str(ogc_server.id) == re.match(
             r"http://localhost/admin/ogc_servers/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
         assert ogc_server.name == "new_name"
 
-    def test_edit(self, test_app, ogc_server_test_data):
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "ogc_server"
+        assert log.element_id == ogc_server.id
+        assert log.element_name == ogc_server.name
+        assert log.username == "test_user"
+
+    def test_edit(self, test_app, ogc_server_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         ogc_server = ogc_server_test_data["ogc_servers"][0]
         resp = test_app.get(f"/admin/ogc_servers/{ogc_server.id}", status=200)
         form = resp.form
         assert str(ogc_server.id) == self.get_first_field_named(form, "id").value
         assert "hidden" == self.get_first_field_named(form, "id").attrs["type"]
         assert ogc_server.name == form["name"].value
         form["description"] = "new_description"
-        assert form.submit().status_int == 302
+        with patch("c2cgeoportal_admin.views.ogc_servers.OGCServerViews._update_cache"):
+            assert form.submit().status_int == 302
         assert ogc_server.description == "new_description"
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "ogc_server"
+        assert log.element_id == ogc_server.id
+        assert log.element_name == ogc_server.name
+        assert log.username == "test_user"
+
     def test_delete(self, test_app, ogc_server_test_data, dbsession):
-        from c2cgeoportal_commons.models.main import OGCServer
+        from c2cgeoportal_commons.models.main import Log, LogAction, OGCServer
 
         ogc_server = ogc_server_test_data["ogc_servers"][0]
-        deleted_id = ogc_server.id
-        test_app.delete(f"/admin/ogc_servers/{deleted_id}", status=200)
-        assert dbsession.query(OGCServer).get(deleted_id) is None
+        test_app.delete(f"/admin/ogc_servers/{ogc_server.id}", status=200)
+        assert dbsession.query(OGCServer).get(ogc_server.id) is None
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "ogc_server"
+        assert log.element_id == ogc_server.id
+        assert log.element_name == ogc_server.name
+        assert log.username == "test_user"
 
     def test_duplicate(self, ogc_server_test_data, test_app, dbsession):
         from c2cgeoportal_commons.models.main import OGCServer
 
         ogc_server = ogc_server_test_data["ogc_servers"][3]
         resp = test_app.get(f"/admin/ogc_servers/{ogc_server.id}/duplicate", status=200)
         form = resp.form
         assert "" == self.get_first_field_named(form, "id").value
         self.set_first_field_named(form, "name", "clone")
-        resp = form.submit("submit")
+        with patch("c2cgeoportal_admin.views.ogc_servers.OGCServerViews._update_cache"):
+            resp = form.submit("submit")
         assert resp.status_int == 302
         server = dbsession.query(OGCServer).filter(OGCServer.name == "clone").one()
         assert str(server.id) == re.match(
             r"http://localhost/admin/ogc_servers/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
 
     def test_unicity_validator(self, ogc_server_test_data, test_app):
@@ -122,45 +150,55 @@
         self._check_submission_problem(resp, f"{ogc_server.name} is already used.")
 
     def test_check_success(self, ogc_server_test_data, test_app):
         ogc_server = ogc_server_test_data["ogc_servers"][3]
         ogc_server.url = "config://mapserver"
         resp = test_app.get(f"/admin/ogc_servers/{ogc_server.id}/synchronize", status=200)
 
-        resp = resp.forms["form-check"].submit("submit")
+        resp = resp.forms["form-check"].submit("check")
 
         assert list(resp.html.find("div", class_="alert-success").stripped_strings) == [
             "OGC Server has been successfully synchronized."
         ]
 
     def test_dry_run_success(self, ogc_server_test_data, test_app):
         ogc_server = ogc_server_test_data["ogc_servers"][3]
         ogc_server.url = "config://mapserver"
         resp = test_app.get(f"/admin/ogc_servers/{ogc_server.id}/synchronize", status=200)
 
-        resp = resp.forms["form-dry-run"].submit("submit")
+        resp = resp.forms["form-dry-run"].submit("dry-run")
 
         assert list(resp.html.find("div", class_="alert-success").stripped_strings) == [
             "OGC Server has been successfully synchronized."
         ]
 
-    def test_synchronize_success(self, ogc_server_test_data, test_app):
+    def test_synchronize_success(self, ogc_server_test_data, test_app, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         ogc_server = ogc_server_test_data["ogc_servers"][3]
         ogc_server.url = "config://mapserver"
         resp = test_app.get(f"/admin/ogc_servers/{ogc_server.id}/synchronize", status=200)
 
-        resp = resp.forms["form-synchronize"].submit("submit")
+        resp = resp.forms["form-synchronize"].submit("synchronize")
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.SYNCHRONIZE
+        assert log.element_type == "ogc_server"
+        assert log.element_id == ogc_server.id
+        assert log.element_name == ogc_server.name
+        assert log.username == "test_user"
 
         assert list(resp.html.find("div", class_="alert-success").stripped_strings) == [
             "OGC Server has been successfully synchronized."
         ]
 
         form = resp.forms["form-synchronize"]
         form["force-parents"].checked = True
         form["force-ordering"].checked = True
         form["clean"].checked = True
 
-        resp = form.submit("submit")
+        resp = form.submit("synchronize")
 
         assert list(resp.html.find("div", class_="alert-success").stripped_strings) == [
             "OGC Server has been successfully synchronized."
         ]
```

## tests/test_restriction_areas.py

```diff
@@ -46,15 +46,14 @@
         "restriction_areas": restrictionareas,
         "roles": roles,
     }
 
 
 @pytest.mark.usefixtures("restriction_area_test_data", "test_app")
 class TestRestrictionAreaViews(TestTreeGroup):
-
     _prefix = "/admin/restriction_areas"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "Restriction areas")
 
@@ -69,15 +68,15 @@
         ]
         self.check_grid_headers(resp, expected)
 
     def test_grid_search(self, test_app):
         self.check_search(test_app, "restrictionarea_1", total=1)
 
     def test_submit_new(self, dbsession, test_app, restriction_area_test_data):
-        from c2cgeoportal_commons.models.main import RestrictionArea
+        from c2cgeoportal_commons.models.main import Log, LogAction, RestrictionArea
 
         roles = restriction_area_test_data["roles"]
         layers = restriction_area_test_data["layers"]
 
         resp = test_app.post(
             "/admin/restriction_areas/new",
             (
@@ -112,23 +111,33 @@
 
         assert restriction_area.name == "new_name"
         assert restriction_area.description == "new_description"
         assert restriction_area.readwrite
         assert set(restriction_area.roles) == {roles[0], roles[1]}
         assert set(restriction_area.layers) == {layers[0], layers[1]}
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "restrictionarea"
+        assert log.element_id == restriction_area.id
+        assert log.element_name == restriction_area.name
+        assert log.username == "test_user"
+
     def test_unicity_validator(self, restriction_area_test_data, test_app):
         restriction_area = restriction_area_test_data["restriction_areas"][2]
 
         resp = test_app.get(f"/admin/restriction_areas/{restriction_area.id}/duplicate", status=200)
         resp = resp.form.submit("submit")
 
         self._check_submission_problem(resp, f"{restriction_area.name} is already used.")
 
     def test_edit(self, test_app, restriction_area_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         restriction_area = restriction_area_test_data["restriction_areas"][0]
         roles = restriction_area_test_data["roles"]
 
         # Ensure restriction_area.layers is loaded with relationship "order_by"
         dbsession.expire(restriction_area)
 
         form = self.get_item(test_app, restriction_area.id).form
@@ -160,22 +169,38 @@
         form["roles"] = [roles[i].id for i in range(0, 3)]
         form.submit("submit")
 
         dbsession.expire(restriction_area)
         assert restriction_area.description == "new_description"
         assert set(restriction_area.roles) == {roles[i] for i in range(0, 3)}
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "restrictionarea"
+        assert log.element_id == restriction_area.id
+        assert log.element_name == restriction_area.name
+        assert log.username == "test_user"
+
     def test_delete(self, test_app, restriction_area_test_data, dbsession):
-        from c2cgeoportal_commons.models.main import RestrictionArea
+        from c2cgeoportal_commons.models.main import Log, LogAction, RestrictionArea
 
         restriction_area = restriction_area_test_data["restriction_areas"][0]
         deleted_id = restriction_area.id
         test_app.delete(f"/admin/restriction_areas/{deleted_id}", status=200)
         assert dbsession.query(RestrictionArea).get(deleted_id) is None
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "restrictionarea"
+        assert log.element_id == restriction_area.id
+        assert log.element_name == restriction_area.name
+        assert log.username == "test_user"
+
     def test_duplicate(self, restriction_area_test_data, test_app, dbsession):
         from c2cgeoportal_commons.models.main import RestrictionArea
 
         restriction_area = restriction_area_test_data["restriction_areas"][3]
         roles = restriction_area_test_data["roles"]
 
         # Ensure restriction_area.layers is loaded with relationship "order_by"
```

## tests/test_role.py

```diff
@@ -1,12 +1,13 @@
 # pylint: disable=no-self-use,unsubscriptable-object
 
 import json
 import re
 
+import pyramid.httpexceptions
 import pytest
 from geoalchemy2.shape import from_shape, to_shape
 from pyramid.testing import DummyRequest
 from shapely.geometry import Polygon, box, shape
 
 from .test_treegroup import TestTreeGroup
 
@@ -64,15 +65,14 @@
         "users": users,
         "roles": roles,
     }
 
 
 @pytest.mark.usefixtures("roles_test_data", "test_app")
 class TestRole(TestTreeGroup):
-
     _prefix = "/admin/roles"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "Roles")
 
@@ -99,17 +99,17 @@
             ("description", "Description"),
             ("functionalities", "Fonctionnalités", "false"),
             ("restrictionareas", "Zones de restriction", "false"),
         ]
         self.check_grid_headers(resp, expected, new="Nouveau")
 
     def test_submit_new(self, dbsession, test_app, roles_test_data):
-        from c2cgeoportal_commons.models.main import Role
+        from c2cgeoportal_commons.models.main import Log, LogAction, Role
 
-        roles = roles_test_data["roles"]
+        roles_test_data["roles"]
         functionalities = roles_test_data["functionalities"]
         restrictionareas = roles_test_data["restrictionareas"]
         users = roles_test_data["users"]
 
         resp = test_app.post(
             "/admin/roles/new",
             (
@@ -150,15 +150,25 @@
         assert set(role.functionalities) == {
             functionalities["default_basemap"][0],
             functionalities["print_template"][1],
         }
         assert set(role.restrictionareas) == {restrictionareas[0], restrictionareas[1]}
         assert set(role.users) == {users[0], users[1]}
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "role"
+        assert log.element_id == role.id
+        assert log.element_name == role.name
+        assert log.username == "test_user"
+
     def test_edit(self, dbsession, test_app, roles_test_data):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         role = roles_test_data["roles"][10]
 
         # Ensure role.users is loaded with relationship "order_by"
         dbsession.expire(role)
 
         form = self.get_item(test_app, role.id).form
 
@@ -269,14 +279,22 @@
             ]
         )
         assert expected.almost_equals(to_shape(role.extent), decimal=0)
 
         assert set(functionality_ids) == {f.id for f in role.functionalities}
         assert set(ra_ids) == {f.id for f in role.restrictionareas}
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "role"
+        assert log.element_id == role.id
+        assert log.element_name == role.name
+        assert log.username == "test_user"
+
     def test_duplicate(self, roles_test_data, test_app, dbsession):
         from c2cgeoportal_commons.models.main import Role
 
         role_proto = roles_test_data["roles"][7]
 
         resp = test_app.get(f"/admin/roles/{role_proto.id}/duplicate", status=200)
         form = resp.form
@@ -293,28 +311,36 @@
         ).group(1)
         assert role_proto.id != role.id
         assert set(role_proto.functionalities) == set(role.functionalities)
         assert set(role_proto.restrictionareas) == set(role.restrictionareas)
         assert set(role_proto.users) == set(role.users)
 
     def test_delete(self, test_app, dbsession):
-        from c2cgeoportal_commons.models.main import Role
+        from c2cgeoportal_commons.models.main import Log, LogAction, Role
 
-        role_id = dbsession.query(Role.id).first().id
-        test_app.delete(f"/admin/roles/{role_id}", status=200)
-        assert dbsession.query(Role).get(role_id) is None
+        role = dbsession.query(Role).first()
+        test_app.delete(f"/admin/roles/{role.id}", status=200)
+        assert dbsession.query(Role).get(role.id) is None
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "role"
+        assert log.element_id == role.id
+        assert log.element_name == role.name
+        assert log.username == "test_user"
 
     def test_unicity_validator(self, roles_test_data, test_app):
         role_proto = roles_test_data["roles"][7]
         resp = test_app.get(f"/admin/roles/{role_proto.id}/duplicate", status=200)
 
         resp = resp.form.submit("submit")
 
         self._check_submission_problem(resp, f"{role_proto.name} is already used.")
 
     @pytest.mark.usefixtures("raise_db_error_on_query")
     def test_grid_dberror(self, dbsession):
         from c2cgeoportal_admin.views.roles import RoleViews
 
         request = DummyRequest(dbsession=dbsession, params={"offset": 0, "limit": 10})
-        info = RoleViews(request).grid()
-        assert info.status_int == 500, "Expected 500 status when db error"
+        with pytest.raises(pyramid.httpexceptions.HTTPInternalServerError):
+            RoleViews(request).grid()
```

## tests/test_themes.py

```diff
@@ -87,15 +87,14 @@
         "functionalities": functionalities,
         "roles": roles,
     }
 
 
 @pytest.mark.usefixtures("theme_test_data", "test_app")
 class TestTheme(TestTreeGroup):
-
     _prefix = "/admin/themes"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "Themes")
 
@@ -154,14 +153,16 @@
         form10 = test_app.get(f"/admin/themes/{theme.id}", status=200).form
         assert not form10["public"].checked
         theme = theme_test_data["themes"][11]
         form11 = test_app.get(f"/admin/themes/{theme.id}", status=200).form
         assert form11["public"].checked
 
     def test_edit(self, test_app, theme_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         theme = theme_test_data["themes"][0]
 
         resp = test_app.get(f"/admin/themes/{theme.id}", status=200)
         form = resp.form
 
         assert str(theme.id) == self.get_first_field_named(form, "id").value
         assert "hidden" == self.get_first_field_named(form, "id").attrs["type"]
@@ -228,14 +229,22 @@
                 assert value == getattr(theme, key)
             else:
                 assert str(value or "") == str(getattr(theme, key) or "")
         assert {interfaces[1].id, interfaces[3].id} == {interface.id for interface in theme.interfaces}
         assert {functionalities[2].id} == {functionality.id for functionality in theme.functionalities}
         assert 0 == len(theme.restricted_roles)
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "theme"
+        assert log.element_id == theme.id
+        assert log.element_name == theme.name
+        assert log.username == "test_user"
+
     def test_post_new_with_children_invalid(self, test_app, theme_test_data):
         """
         Check there is no rendering error when validation fails.
         """
         groups = theme_test_data["groups"]
         resp = test_app.post(
             f"{self._prefix}/new",
@@ -254,14 +263,16 @@
             ),
             status=200,
         )
 
         self._check_submission_problem(resp, "Required")
 
     def test_post_new_with_children_success(self, test_app, dbsession, theme_test_data):
+        from c2cgeoportal_commons.models.main import Log, LogAction
+
         groups = theme_test_data["groups"]
         resp = test_app.post(
             f"{self._prefix}/new",
             (
                 ("_charset_", "UTF-8"),
                 ("__formid__", "deform"),
                 ("name", "new_with_children"),
@@ -298,14 +309,22 @@
             r"http://localhost/admin/themes/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
 
         assert [groups[1].id, groups[3].id, groups[4].id] == [
             rel.treeitem_id for rel in theme.children_relation
         ]
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "theme"
+        assert log.element_id == theme.id
+        assert log.element_name == theme.name
+        assert log.username == "test_user"
+
     def test_post_new_with_child_layer(self, theme_test_data, test_app):
         """
         Check layers are rejected by the validator (also means that they are not proposed to the user).
         """
         layers = theme_test_data["layers"]
         resp = test_app.post(
             f"{self._prefix}/new",
@@ -391,19 +410,27 @@
             rf"http://localhost{self._prefix}/(.*)\?msg_col=submit_ok", resp.location
         ).group(1)
         assert duplicated.id != theme.id
         assert duplicated.children_relation[0].id != theme.children_relation[0].id
         assert duplicated.children_relation[0].treeitem.id == theme.children_relation[0].treeitem.id
 
     def test_delete(self, test_app, dbsession):
-        from c2cgeoportal_commons.models.main import Theme
+        from c2cgeoportal_commons.models.main import Log, LogAction, Theme
 
-        theme_id = dbsession.query(Theme.id).first().id
-        test_app.delete(f"/admin/themes/{theme_id}", status=200)
-        assert dbsession.query(Theme).get(theme_id) is None
+        theme = dbsession.query(Theme).first()
+        test_app.delete(f"/admin/themes/{theme.id}", status=200)
+        assert dbsession.query(Theme).get(theme.id) is None
+
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "theme"
+        assert log.element_id == theme.id
+        assert log.element_name == theme.name
+        assert log.username == "test_user"
 
     def test_unicity_validator(self, theme_test_data, test_app):
         theme = theme_test_data["themes"][1]
         resp = test_app.get(f"{self._prefix}/{theme.id}/duplicate", status=200)
 
         resp = resp.form.submit("submit")
```

## tests/test_themes_ordering.py

```diff
@@ -24,15 +24,14 @@
     yield {
         "themes": themes,
     }
 
 
 @pytest.mark.usefixtures("theme_test_data", "test_app")
 class TestThemeOrdering(TestTreeGroup):
-
     _prefix = "/admin/layertree/ordering"
 
     def test_edit(self, test_app, theme_test_data, dbsession):
         themes = theme_test_data["themes"]
 
         resp = test_app.get(self._prefix, status=200)
         form = resp.form
```

## tests/test_user.py

```diff
@@ -1,13 +1,14 @@
 # pylint: disable=no-self-use
 
 import email
 import re
 from unittest.mock import MagicMock, patch
 
+import pyramid.httpexceptions
 import pytest
 from pyramid.testing import DummyRequest
 
 from . import AbstractViewsTests
 
 
 @pytest.fixture(scope="function")
@@ -44,15 +45,14 @@
     "Hello {},\n\nYou have a new account on GeoMapFish demo: https://geomapfish-demo.camptocamp.com/2.3\n"
     + "Your user name is: {}\nYour password is: {}\n\nSincerely yours\nThe GeoMapFish team\n"
 )
 
 
 @pytest.mark.usefixtures("users_test_data", "test_app")
 class TestUser(AbstractViewsTests):
-
     _prefix = "/admin/users"
 
     def test_index_rendering(self, test_app):
         resp = self.get(test_app)
 
         self.check_left_menu(resp, "Users")
 
@@ -85,15 +85,18 @@
             ("expire_on", "Date d'expiration"),
             ("deactivated", "Désactivé"),
             ("settings_role", "Rôle de configuration"),
             ("roles", "Rôles", "false"),
         ]
         self.check_grid_headers(resp, expected, new="Nouveau")
 
-    def test_view_edit(self, test_app, users_test_data):
+    def test_view_edit(self, test_app, users_test_data, dbsession):
+        from c2cgeoportal_commons.models.main import LogAction
+        from c2cgeoportal_commons.models.static import Log
+
         user = users_test_data["users"][9]
         roles = users_test_data["roles"]
 
         resp = test_app.get(f"/admin/users/{user.id}", status=200)
 
         assert resp.form["username"].value == user.username
         assert resp.form["email"].value == user.email
@@ -118,23 +121,40 @@
         for key, value in new_values.items():
             if isinstance(value, bool):
                 assert value == getattr(user, key)
             else:
                 assert str(value or "") == str(getattr(user, key) or "")
         assert {roles[2].id, roles[3].id} == {role.id for role in user.roles}
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.UPDATE
+        assert log.element_type == "user"
+        assert log.element_id == user.id
+        assert log.element_name == user.username
+        assert log.username == "test_user"
+
     def test_delete(self, test_app, users_test_data, dbsession):
-        from c2cgeoportal_commons.models.static import User, user_role
+        from c2cgeoportal_commons.models.main import LogAction
+        from c2cgeoportal_commons.models.static import Log, User, user_role
 
         user = users_test_data["users"][9]
         deleted_id = user.id
         test_app.delete(f"/admin/users/{deleted_id}", status=200)
         assert dbsession.query(User).get(deleted_id) is None
         assert dbsession.query(user_role).filter(user_role.c.user_id == user.id).count() == 0
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.DELETE
+        assert log.element_type == "user"
+        assert log.element_id == user.id
+        assert log.element_name == user.username
+        assert log.username == "test_user"
+
     @patch("c2cgeoportal_commons.lib.email_.smtplib.SMTP")
     @patch("c2cgeoportal_admin.views.users.pwgenerator.generate")
     def test_submit_update(self, pw_gen_mock, smtp_mock, dbsession, test_app, users_test_data):
         user = users_test_data["users"][11]
         roles = users_test_data["roles"]
 
         resp = test_app.post(
@@ -229,18 +249,20 @@
         ).decode("utf8")
         assert "mail7@valid.net" == parts[0].items()[3][1]
 
     @patch("c2cgeoportal_commons.lib.email_.smtplib.SMTP")
     @patch("c2cgeoportal_admin.views.users.pwgenerator.generate")
     @pytest.mark.usefixtures("test_app")
     def test_submit_new(self, pw_gen_mock, smtp_mock, dbsession, test_app, users_test_data):
+        from c2cgeoportal_commons.models.main import LogAction
+        from c2cgeoportal_commons.models.static import Log, User
+
         sender_mock = MagicMock()
         smtp_mock.return_value = sender_mock
         pw_gen_mock.return_value = "basile"
-        from c2cgeoportal_commons.models.static import User
 
         roles = users_test_data["roles"]
 
         resp = test_app.post(
             "/admin/users/new",
             (
                 ("__formid__", "deform"),
@@ -271,14 +293,22 @@
 
         parts = list(email.message_from_string(sender_mock.sendmail.mock_calls[0][1][2]).walk())
         assert EXPECTED_WELCOME_MAIL.format("new_user", "new_user", "basile") == parts[1].get_payload(
             decode=True
         ).decode("utf8")
         assert "valid@email.net" == parts[0].items()[3][1]
 
+        log = dbsession.query(Log).one()
+        assert log.date != None
+        assert log.action == LogAction.INSERT
+        assert log.element_type == "user"
+        assert log.element_id == user.id
+        assert log.element_name == user.username
+        assert log.username == "test_user"
+
     def test_invalid_email(self, test_app):
         resp = test_app.post(
             "/admin/users/new",
             {
                 "__formid__": "deform",
                 "_charset_": "UTF-8",
                 "formsubmit": "formsubmit",
@@ -296,16 +326,16 @@
         self._check_submission_problem(resp, "Invalid email address")
 
     @pytest.mark.usefixtures("raise_db_error_on_query")
     def test_grid_dberror(self, dbsession):
         from c2cgeoportal_admin.views.users import UserViews
 
         request = DummyRequest(dbsession=dbsession, params={"offset": 0, "limit": 10})
-        info = UserViews(request).grid()
-        assert info.status_int == 500, "Expected 500 status when db error"
+        with pytest.raises(pyramid.httpexceptions.HTTPInternalServerError):
+            UserViews(request).grid()
 
     def test_grid_settings_role_none(self, dbsession, test_app):
         """
         Grid view must work even if a user's settings_role is None.
         """
         from c2cgeoportal_commons.models.static import User
```

## tests/themes_ordering.py

```diff
@@ -21,15 +21,14 @@
     dbsession.flush()
 
     yield {"themes": themes}
 
 
 @pytest.mark.usefixtures("themes_ordering_test_data", "test_app")
 class TestThemesOrdering(TestTreeGroup):
-
     _prefix = "/admin/layertree/ordering"
 
     def test_edit(self, test_app, themes_ordering_test_data):
         resp = self.get(test_app, status=200)
         form = resp.form
 
         self.check_children(
```

## Comparing `c2cgeoportal_admin-2.7.1.83.dist-info/METADATA` & `c2cgeoportal_admin-2.9.dist-info/METADATA`

 * *Files 16% similar despite different names*

```diff
@@ -1,50 +1,51 @@
 Metadata-Version: 2.1
 Name: c2cgeoportal-admin
-Version: 2.7.1.83
+Version: 2.9
 Summary: c2cgeoportal admin
 Home-page: https://github.com/camptocamp/c2cgeoportal/
 Author: Camptocamp
 Author-email: info@camptocamp.com
+License: UNKNOWN
 Keywords: web gis geoportail c2cgeoportal geocommune pyramid
+Platform: UNKNOWN
 Classifier: Development Status :: 6 - Mature
 Classifier: Environment :: Web Environment
 Classifier: Framework :: Pyramid
 Classifier: Intended Audience :: Other Audience
 Classifier: License :: OSI Approved :: BSD License
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python
 Classifier: Programming Language :: Python :: 3
-Classifier: Programming Language :: Python :: 3.8
+Classifier: Programming Language :: Python :: 3.10
 Classifier: Topic :: Scientific/Engineering :: GIS
 Classifier: Typing :: Typed
+Requires-Python: >=3.10
 Description-Content-Type: text/markdown
 Requires-Dist: c2cgeoform
 Requires-Dist: c2cwsgiutils
 Requires-Dist: colander
 Requires-Dist: deform
 Requires-Dist: passwordgenerator
 Requires-Dist: pyproj
 Requires-Dist: pyramid
 Requires-Dist: pyramid-debugtoolbar
 Requires-Dist: pyramid-jinja2
 Requires-Dist: pyramid-tm
 Requires-Dist: sqlalchemy
-Requires-Dist: zope.event
 Requires-Dist: translationstring
-Requires-Dist: jinja2 (>=2.11.3)
-Requires-Dist: pygments (>=2.7.4)
-Requires-Dist: setuptools (>=65.5.1)
-Requires-Dist: requests (>=2.31.0)
+Requires-Dist: zope.event
 
 # c2cgeoportal admin interface
 
 ## Run the c2cgeoportal_admin development web server
 
 From this folder (admin):
 
 ```
 make preparedev
 make serve
 ```
 
-Now open http://localhost:8888/ in your favorite browser.
+Now open http://localhost:8888/admin/ in your favorite browser.
+
+
```

## Comparing `c2cgeoportal_admin-2.7.1.83.dist-info/RECORD` & `c2cgeoportal_admin-2.9.dist-info/RECORD`

 * *Files 10% similar despite different names*

```diff
@@ -1,28 +1,28 @@
-c2cgeoportal_admin/__init__.py,sha256=4UYLGCcfxd8mfHojIalTFmaYNgD67WFbgVhw2sl5yok,4959
+c2cgeoportal_admin/__init__.py,sha256=HVSQ-CwK5aR9URA-NVH7JlYHGU49xT5vARiTkdxpV70,5767
 c2cgeoportal_admin/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-c2cgeoportal_admin/routes.py,sha256=So17Lj2v8UigkxVwfYJrK_piDejRkvekPiFibyr3qiw,4676
+c2cgeoportal_admin/routes.py,sha256=tgLP5uKhgX80a2gLCpu6C92UtmqwVkOkmJ-tPxEP3QE,4712
 c2cgeoportal_admin/subscribers.py,sha256=P1CaccDTpuxrWak_gMN2qBurz3OrAZ6aZ1LA7P3avu8,2430
-c2cgeoportal_admin/widgets.py,sha256=tW6brDW-95LuRnSsRd_8xVRKNAkwkYtdi8zQ44TBj18,6132
+c2cgeoportal_admin/widgets.py,sha256=bjMlC4mqx_bAjzIzzu-zqdQ7bc6tVo7mKOMbpmbeN38,6108
 c2cgeoportal_admin/lib/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-c2cgeoportal_admin/lib/lingua_extractor.py,sha256=Dw4vo46TcUnJ7vvxgFezPYidfEdL2pHJUM0qxAaJ1KE,3380
-c2cgeoportal_admin/lib/ogcserver_synchronizer.py,sha256=NuCV8EpUso01to2PYbh6NpXPcD702pQOSslah__Bzus,15421
+c2cgeoportal_admin/lib/lingua_extractor.py,sha256=OjZV6KdeOUMVJ3IVtcTidx2ITkLNjoeuy44a7FU38TU,3368
+c2cgeoportal_admin/lib/ogcserver_synchronizer.py,sha256=B5YfS6vshykFP_JHifoTPa98_bc2iPB5-0avMTcF9oY,15542
 c2cgeoportal_admin/schemas/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-c2cgeoportal_admin/schemas/dimensions.py,sha256=rPMEuIdGiVGS5e0xqXUu-COVKlrWg9rpp-xe-8aHbOQ,2290
-c2cgeoportal_admin/schemas/functionalities.py,sha256=AptqKn2oyy74qivzihNfeNvmaDILsl36bSoJdSNXh9Y,3941
-c2cgeoportal_admin/schemas/interfaces.py,sha256=0NCRDZOqbw7Bwj-l3GNsVwYDHck4F0q1fCSo1kTYoOY,2578
-c2cgeoportal_admin/schemas/metadata.py,sha256=px0Teh0vtyimQfzL7zXHXIEkWtBbD00OsadfDDeqSkY,8991
-c2cgeoportal_admin/schemas/restriction_areas.py,sha256=48hFUgFznl_1bYsl490YSXLbXfjCY_f6gURQtB_7eIk,2598
-c2cgeoportal_admin/schemas/roles.py,sha256=4JJrgZNKsj_wru_YGOWxZTEXGVm0hahbAkYf2aePGzI,2507
-c2cgeoportal_admin/schemas/treegroup.py,sha256=-s_aKAzwYwS9zVsuqQAp_7M_-c00LVq-R6dC8BiUWk0,7039
-c2cgeoportal_admin/schemas/treeitem.py,sha256=qnjrLd2LD7NCBjXqzw7aRn83cw_hYZbepJdLzOz0rBk,2117
+c2cgeoportal_admin/schemas/dimensions.py,sha256=zpynF2qMISalyPihl0ZWsRFJBYwSUsbeGLQZjxURW1k,2319
+c2cgeoportal_admin/schemas/functionalities.py,sha256=JecG1DYagM_Bgd7sMj0clN-4CAuYZEdELwDXlLRLBZs,3852
+c2cgeoportal_admin/schemas/interfaces.py,sha256=xJtiXz1mHql67zqrtQ0CFINRSr6gCtgcmZf9xFcmqgE,2613
+c2cgeoportal_admin/schemas/metadata.py,sha256=2yEQS0GnUPSbM0oCS6Gi5G3haf8C_I-0j-LNd-Ai2ak,8923
+c2cgeoportal_admin/schemas/restriction_areas.py,sha256=3zB_Uq9CshCKz99K4cnmit6gtqzuunCJc7vHTuwiUK8,2633
+c2cgeoportal_admin/schemas/roles.py,sha256=op_TUfraHSh9Ef6HaxZUYL4hoS4yEtkBjXqIHYUv5VY,2542
+c2cgeoportal_admin/schemas/treegroup.py,sha256=ASB8B32xLsLHEQWxrvSkMwFfcZbw3ApPkZ82LmHlfNE,7164
+c2cgeoportal_admin/schemas/treeitem.py,sha256=VhGhpG8VcsT-3dnnNlln-uVlsqjwJQXbg6Ap1tEanMI,2146
 c2cgeoportal_admin/static/layertree.css,sha256=tk54KGW0yRRmdrY35gOCZG3qTsqWtGNEwvBYPQKhaVs,3177
 c2cgeoportal_admin/static/navbar.css,sha256=QIaAQsb4n17OfwdKEQdmNDVPCP23Yu-oGW4xsSaHyW0,2307
 c2cgeoportal_admin/static/theme.css,sha256=eHtBEJcBtDhyZJvCKNxE5hgril0VpLtcDKfNFdgCSVw,2025
-c2cgeoportal_admin/templates/404.jinja2,sha256=F05OZUzJljcieoCFMP7Oz1F6Jb-VZ06hTOSc9mrb87g,1420
+c2cgeoportal_admin/templates/404.jinja2,sha256=KSpqCNFwv37rKSmX6kL_VvCnn5egcT1eRD6kIKwWx34,1807
 c2cgeoportal_admin/templates/edit.jinja2,sha256=rkBQiz0JZdL7VDq8XrhRLTv6JaiFt_QB8CwP3NMHWQY,1302
 c2cgeoportal_admin/templates/home.jinja2,sha256=WDQwmBGMZxsiOLw9YeYPLuca_mjjntjrTh529euzd1o,1516
 c2cgeoportal_admin/templates/index.jinja2,sha256=HPgilbqh5dv-yc_T_bc1hV2DEtV2wD617_aAERC2VSk,2005
 c2cgeoportal_admin/templates/layertree.jinja2,sha256=1ys5XDY3nb4gAu8JazkwSFeJUdGRadT7WaBuvin_hYg,9830
 c2cgeoportal_admin/templates/layout.jinja2,sha256=KCDwATUYBu-ZXv7ijo0S0PlTmKtU-JxW8gMhvPA_kAE,4105
 c2cgeoportal_admin/templates/navigation_navbar.jinja2,sha256=XzVQDpo3ClIiRxWf5eDULHZi9u-veYOmndiE_Twqxog,4166
 c2cgeoportal_admin/templates/ogcserver_synchronize.jinja2,sha256=rdQfbHBzrV5VUq5TC97QR7pv8bRvrdKaUUZpnQyldoE,4327
@@ -30,63 +30,66 @@
 c2cgeoportal_admin/templates/widgets/children.pt,sha256=0TPpatvmZcU2TxbcZMjDz8VQcLGtoHkuDJ-eAGvjXho,6625
 c2cgeoportal_admin/templates/widgets/dimension.pt,sha256=1BXmE7s9JpzaJSHAQEtZk0DHB11pQ4FNQPaG_4c8CYo,2627
 c2cgeoportal_admin/templates/widgets/dimensions.pt,sha256=LjWjsgdcFYZxpB_30-3NOfvq5KYkKTu49F-P-r9d5Jg,1211
 c2cgeoportal_admin/templates/widgets/functionality_fields.pt,sha256=8TvwXCmQOtYFkiqsa4AHFUYsWk92LLnthz8bDrLmMBc,1969
 c2cgeoportal_admin/templates/widgets/layer_fields.pt,sha256=RJBYt8ji6YQp9ZaNZJD-caLgy856a6rzlKSMnuZWphw,3223
 c2cgeoportal_admin/templates/widgets/layer_group_fields.pt,sha256=xnqIqFjPPan81OqLwKeDnvNtlhEvYss6h2J9txH5neE,2459
 c2cgeoportal_admin/templates/widgets/layer_v1_fields.pt,sha256=w-MujUevHWmnOkOTbbvES6alDoL_UO1eiMj8SCxcQEY,3956
-c2cgeoportal_admin/templates/widgets/metadata.pt,sha256=jWiLmS0J-cwFkqUxxZwKnkPNX9ShTG2zj0tUCq4TMjQ,3735
+c2cgeoportal_admin/templates/widgets/metadata.pt,sha256=P8noHX8YAv3m6EGh0IDUJCFsyeZDX88HtlqOWab8DAU,3735
 c2cgeoportal_admin/templates/widgets/metadatas.pt,sha256=ErgAH0DA94MO7gqEJ2iZdQ9LRptP2YKH78yze-jdl2Q,1476
 c2cgeoportal_admin/templates/widgets/ogcserver_fields.pt,sha256=x0bDmgrnj9SA6RCVpg3k2lTkkXPkuBFPKMScDgDeyGU,1724
 c2cgeoportal_admin/templates/widgets/restriction_area_fields.pt,sha256=pZVE0KcitAF7HXc3ZlniLr0QwSD05TOhlgieLUR1i7Q,1731
 c2cgeoportal_admin/templates/widgets/role_fields.pt,sha256=gVd9eRYaqw8fGmZauqEUS_Igmyxaa71qcmdC1KUx5nY,2623
 c2cgeoportal_admin/templates/widgets/theme_fields.pt,sha256=68G1Ya8-Dc6pCeP-taQ0ofCIpnY_v0rouazkFhfQflU,3083
 c2cgeoportal_admin/templates/widgets/user_fields.pt,sha256=twmajhUYL1xa47Eu-iATKifNPA5lu3SGpqdKajH6gL8,1753
-c2cgeoportal_admin/views/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-c2cgeoportal_admin/views/dimension_layers.py,sha256=jupwqX_kO37ukcWE-SsO290JdKENEmfoYxk4sRWb25Y,2598
-c2cgeoportal_admin/views/functionalities.py,sha256=U51DvRd6Jg40VQm66kyVy363cDGGEol0WwaQC8b2ZKM,4002
+c2cgeoportal_admin/views/__init__.py,sha256=jtI6CdoXJwizznjwb8ClYySgq4kbwhTIJYutSw89PAw,683
+c2cgeoportal_admin/views/dimension_layers.py,sha256=pman5k3eXmDR2wU1WBdkMBJrkwnxRXd889-ueWJOhYw,2809
+c2cgeoportal_admin/views/functionalities.py,sha256=DiqBEx74v1xQMeq90CQpwxOG41tVd3HHyAh2Ui_MeQo,4410
 c2cgeoportal_admin/views/home.py,sha256=h_hJWIKpzJeSmXl58J0nvZdEg7avSYOOVUEEnlV-r0k,1943
-c2cgeoportal_admin/views/interfaces.py,sha256=3Sl-57PchMlUw_RrvL7F4KTpa57ifpNjOxk-nWqMXpk,3465
-c2cgeoportal_admin/views/layer_groups.py,sha256=CbuURDXMcRXnWbW9aEhXP9nSiSiFq4m3JdtgQS6agxs,3956
-c2cgeoportal_admin/views/layers.py,sha256=xjvcRvKVpeD-LRuVwE8PGkDT-Kih9ADX0beEDcOP1bE,3039
-c2cgeoportal_admin/views/layers_vectortiles.py,sha256=lREdMc7bo2TVqdf-s6MzNXZoauReqFS_K-Hng49NUT4,4932
-c2cgeoportal_admin/views/layers_wms.py,sha256=p3g2zc2waMBBrlFQjgTUn9YTg3WcXQofx5Yw1b3ozAg,7954
-c2cgeoportal_admin/views/layers_wmts.py,sha256=IxvF_knk3HYsa8gKhIaZsyi5Uhmv_Qrmd50gU8BPla8,7731
-c2cgeoportal_admin/views/layertree.py,sha256=x1nTVwyf-ZK7M0gIDpsDdySMZm3XmE6yGEE9j8VYQ4Y,8589
-c2cgeoportal_admin/views/oauth2_clients.py,sha256=hovhxGKK3et_Lny7UuXsterP_OUSZ1HW7YqhawEXrOw,3740
-c2cgeoportal_admin/views/ogc_servers.py,sha256=rK0dIS2XLTc5EDeGrnDf_mpHlNXJsCEyUpci_lIexR8,7476
-c2cgeoportal_admin/views/restriction_areas.py,sha256=0Zpo8p5Zsw3JdPCH8kqWr020boBpNiKMhARKcgCsOVU,5549
-c2cgeoportal_admin/views/roles.py,sha256=7BjQ0zLcsf6JW8OgBKJukaMRksUB-VKTeILfhP9bLG0,5858
-c2cgeoportal_admin/views/themes.py,sha256=Qv6sZ7op90JEd7ASGuTU68rjTdsRrGlf0clYqqumuFI,5710
-c2cgeoportal_admin/views/themes_ordering.py,sha256=NYN3I2tDwLW5E4G-695DwV0dCbHUAObWVFYZ8Bir1-o,5590
-c2cgeoportal_admin/views/treeitems.py,sha256=p-Ba_v3UFtUZEmlct4MZmkwv7jzMoxNKnCVa_FX2hxg,3860
-c2cgeoportal_admin/views/users.py,sha256=YzyKYDDTVn69NQPkrlkmbpgrtsIkK_cxqlcWa6utAVA,5355
-tests/__init__.py,sha256=JbVMbOZgS0u5_MhWBnyzT1gdv3cXwhkXyLQgDqpZAik,9525
-tests/conftest.py,sha256=ah7JmR2epDZul2rmMH5wuUzkSpXIjm8dd-cgGjK6_k0,2119
-tests/test_edit_url.py,sha256=00Q9E3QOtsEEB0YJQehllFr1ztQCU3wc9OyayXCHYI4,4495
-tests/test_functionalities.py,sha256=CPHxBueoCt8W76VJN2sCouxQyc7LD7ccusRah5UK2ys,4126
-tests/test_home.py,sha256=oA4i-V9jJQQgHD9Gz79mgIEMUCRw3tmIQVqdhM9Q2Fo,426
-tests/test_interface.py,sha256=ml1yM4t1o6jIQEHZRwMywjt7mjkUhP-34VKBgHOmWes,4704
-tests/test_layer_groups.py,sha256=Bb1Rsy8QkzGee6edY4UQY8hcxvp54PE7gXUcHoi__JA,11062
-tests/test_layers_vectortiles.py,sha256=DjOLkm3o8nPJJbd010Xi_pwHTK5roiHoQBYAuNaZW5c,9395
-tests/test_layers_wms.py,sha256=MISvkAjEZ4oSD1xg7Zah_GKiBHNu60D8kT03f241wuc,18175
-tests/test_layers_wmts.py,sha256=jjO3AbOQgHgC2yXdYke339W11Ygz1b8DpuAn4OXLnxE,11185
-tests/test_layertree.py,sha256=uu-2AzVtqr87eqq9w_5EWPR_KIXFFjEipEA0_ImnkCU,11336
+c2cgeoportal_admin/views/interfaces.py,sha256=1DVMyou9T5pnuDIl6psSWjt39sunT8yP2_g2kbaIMTE,3875
+c2cgeoportal_admin/views/layer_groups.py,sha256=SwLZlZEL5wRKKDJEo2lOwIA5qeqn9RhyuR3AQv1fU1I,4520
+c2cgeoportal_admin/views/layers.py,sha256=TANFlkbkPi3EJ4AQbUAsh267580eRooy830qbMIS2Co,3279
+c2cgeoportal_admin/views/layers_vectortiles.py,sha256=mTVzPIuMRpLdp2M8YBf6xcVxjv9VJe115iVuKKGyZK8,5661
+c2cgeoportal_admin/views/layers_wms.py,sha256=zn4KKCy3yQ2c-WIdgi0yTGdqipOqMm6PR2rVk70V3kA,8397
+c2cgeoportal_admin/views/layers_wmts.py,sha256=mi76hREXq67KXtevacegt0E1cSLL6M3Oenm2ar-wb3Q,8111
+c2cgeoportal_admin/views/layertree.py,sha256=YU-HivJ4D0B7vEJyicJ4WQ7OBKAJ67OHMyHC7sn0BgQ,8591
+c2cgeoportal_admin/views/logged_views.py,sha256=aSObMIEbYcjnG8u4KBF8JV35kc0FJ0_Ev1uqTubwKaU,3347
+c2cgeoportal_admin/views/logs.py,sha256=76uH6EaUCngVjE0J4RRgmgQU7otJ_H4WV_nHyXLfJSY,3807
+c2cgeoportal_admin/views/oauth2_clients.py,sha256=gtTKX0F0AHp-MWazgaYdsEgNohAg7f_nbaO82RQ1Rn0,3871
+c2cgeoportal_admin/views/ogc_servers.py,sha256=HswNgOlRwBRsa4KPpsREMaqq-HgUTAM9p6R9mYwFEmw,9702
+c2cgeoportal_admin/views/restriction_areas.py,sha256=_0OE4NHhvf1dlp7mvRWM7F8ognIMgpSDgyMSa_j0PSs,6153
+c2cgeoportal_admin/views/roles.py,sha256=HYJrSwpvRR0zo3nmDa3J0BiJvDYFwBrm3nauFfITNeI,6418
+c2cgeoportal_admin/views/themes.py,sha256=hPf-G3VPnZKTUwvekmZStdBiy6PvS7IM3ZVAncT-vII,6298
+c2cgeoportal_admin/views/themes_ordering.py,sha256=PgPaqKe7A5d2cYcDeJyoK615BNXayOmRcKNAAopvfRc,5689
+c2cgeoportal_admin/views/treeitems.py,sha256=ABAsW-Um-oE5preT_0o0mKMHoqF8amVkUtN8o1OuRs4,4069
+c2cgeoportal_admin/views/users.py,sha256=Tx65nQyq1vC4f0wEI2SZxEy5LeqMly-WOvBU5Gr-K3g,5904
+tests/__init__.py,sha256=oo8kqGfoSh8AV0HhTqQfC0izcIQ8ZQPkNmONSEUUby4,9556
+tests/conftest.py,sha256=oZPwuFVOVXaD1lnNgoZZ-OKOiVuHUwKowz3-TZNrNPY,2254
+tests/test_edit_url.py,sha256=Mo_Vo5xvdpPasfjvhQUif5F3nKVpJ6GQJ_x_Hj5VNY8,4494
+tests/test_functionalities.py,sha256=tGQbEsQWjr_oExI3vWhLIioxylDaoUaOfEas42YPw50,5191
+tests/test_home.py,sha256=oWsKaWqRicNpUdaca54YvLIBRaGYnsXlv_Tjqv7guEQ,425
+tests/test_interface.py,sha256=z1jpRzW0R2e9BJWWurE-j-YkG5yhorn7h1XRIauUQ7A,5669
+tests/test_layer_groups.py,sha256=bisbaDY0SiyBc0rexYajbcvfdDt8Kux6VqXIEBLSULM,12191
+tests/test_layers_vectortiles.py,sha256=PpnR8wJyRcsByPTOrrtltQUYzzQ0qRzQM2no1z1rLgU,10404
+tests/test_layers_wms.py,sha256=ynqO1cnXk2ZbSXR3l9hp0IyG8PMXbmR4eyubnwRvRfU,19494
+tests/test_layers_wmts.py,sha256=7zye_pZ_e0RyJdoT8oeHKPoYJMKWfTg0K8lEgMIu77Q,12181
+tests/test_layertree.py,sha256=Dxe10OwuilQ-AEgVIDU4Ns9U6PQ4kPWTxwItdBE7nSg,11335
 tests/test_learn.py,sha256=gQwe-Bim0eihZH0rbBWDn6_rIBxvQD_lyu9MlOljupM,2307
-tests/test_left_menu.py,sha256=-K_429ZcW5Hsz317StIRVz8VtU7GDMH7UCTzZDfckUo,920
-tests/test_lingua_extractor_config.py,sha256=3dqgIdCB1M3YPzXrgDCFQ74t0t4QRXwdQZSy6AMqKp8,2515
+tests/test_left_menu.py,sha256=xnlv5sD0k3wpCChKCnbpYRN0TA895pg8k6wVvjf99-4,919
+tests/test_lingua_extractor_config.py,sha256=vAfunJ4tVuqTJg4xinPwlB0EvA4sYhjY_iDBfMq8EW4,2495
+tests/test_logs.py,sha256=sUBC61rCSIfg9HBavhT6c0QPmPYUnEfDm91bUaUF4Q8,3147
 tests/test_main.py,sha256=_gUdMrMMAEzvGIf1QwkoHQkd0eBACz05ycTidCHP5Ao,365
-tests/test_metadatas.py,sha256=dawAKLxyWy4Ok3TWAR5zsB_IN_Ci_VJdjNE9fU5NVjE,12089
-tests/test_oauth2_clients.py,sha256=UaTz7jE0-V2JJ4VkjA3W0FlzgkfacI1jchiynXNNYbc,5782
-tests/test_ogc_servers.py,sha256=qPrbLFw8zaPOpk-fbydJUtfgLl9nxA81jOUNd1l8EUI,6436
-tests/test_restriction_areas.py,sha256=S97lbxHghyhz9h8Sv78jYt2EOQEgwlUp8zCfOtmV-OU,7925
-tests/test_role.py,sha256=99Rk4PCTtoVzbiTP3cR3cVkuIArdLywBl2Hx8Pk5lnE,11820
-tests/test_themes.py,sha256=e-OGon6beHfY4q8xOGsYjW-_pm0-wTA18DPBOz6F9iM,15181
-tests/test_themes_ordering.py,sha256=qIEgLgIjSYpWqMVXBAhOk6BKBUAPXkiXsxWB_A1Dy4s,2244
+tests/test_metadatas.py,sha256=bVNxvZRKNRMmjQGr7Al1d4H85EjEaoesRpxytyld4Fw,12088
+tests/test_oauth2_clients.py,sha256=5vyuCsba2WVgr6yMJysw73pAnXCZXhLO7dLIgV-spic,7028
+tests/test_ogc_servers.py,sha256=DGSMVIzYnw3bJT53VFGuPYIPMPCyHJDb5ZPJj1VM3Bo,8204
+tests/test_restriction_areas.py,sha256=5VhO9ZvtFQPy1kVFm96Mh_vf1LCI5oeIdl0dfvS6JD8,9003
+tests/test_role.py,sha256=2mbi0RwTESnIZIuUTxMi275ONOcPNKWN-ni7b00SO90,12804
+tests/test_themes.py,sha256=uhzHe2TbuNoLnL4VdYATPnOqtnZWWPKsvUTq6GUxwiU,16207
+tests/test_themes_ordering.py,sha256=T4Esr0C3EN5UdeEyYLa4ePvEn-bx3RNPkGBK3lDFoBo,2243
 tests/test_treegroup.py,sha256=Plv119G4TWlurWLE7Z1mWGeHHPScK_fWKcDmDzMUlIU,576
-tests/test_user.py,sha256=pW2Fsbw8wIP2H3BxAMUojSonhMMyr63jsWFmEteaogk,11659
-tests/themes_ordering.py,sha256=mbjTJHl63UVdv5SsfgDrjOx-1z6C5L4wDSCzIh7LPAE,1343
-c2cgeoportal_admin-2.7.1.83.dist-info/METADATA,sha256=TT7bat-v0qEsnHKb32W0CSMoBwDWUYiAmtGox5o-Hjk,1491
-c2cgeoportal_admin-2.7.1.83.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-c2cgeoportal_admin-2.7.1.83.dist-info/entry_points.txt,sha256=ZF-xnP-Q_zr7y6yRmVqjIGVZ1L2iKi5uaOxjxJQBuG4,164
-c2cgeoportal_admin-2.7.1.83.dist-info/top_level.txt,sha256=DgcTJgTvpJUB8HqwYB14PdLBPAOAFk0B8oqnSTFoAU4,25
-c2cgeoportal_admin-2.7.1.83.dist-info/RECORD,,
+tests/test_user.py,sha256=lr-qQ72ef7AKdRkcd6t_pnjoRPe48jp7G7o3PWt9E-w,12842
+tests/themes_ordering.py,sha256=UdydcRIzWC6RRnTMfl2JM_250DHuAhGC7rijHqfy7lk,1342
+c2cgeoportal_admin-2.9.dist-info/METADATA,sha256=Vxhd1mW8syUaiIkVMYZ0mfEBnAEDJsUMcBrlD682AMg,1415
+c2cgeoportal_admin-2.9.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+c2cgeoportal_admin-2.9.dist-info/entry_points.txt,sha256=kz-7AnYsbtK04jTpGUtcOeu2NbQiXW3CQV3AjyC32tw,165
+c2cgeoportal_admin-2.9.dist-info/top_level.txt,sha256=DgcTJgTvpJUB8HqwYB14PdLBPAOAFk0B8oqnSTFoAU4,25
+c2cgeoportal_admin-2.9.dist-info/RECORD,,
```

