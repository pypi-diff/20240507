# Comparing `tmp/acgc-0.2.6.tar.gz` & `tmp/acgc-0.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "acgc-0.2.6.tar", last modified: Wed Mar 20 23:45:42 2024, max compression
+gzip compressed data, was "acgc-0.3.tar", last modified: Tue May  7 21:02:37 2024, max compression
```

## Comparing `acgc-0.2.6.tar` & `acgc-0.3.tar`

### file list

```diff
@@ -1,160 +1,167 @@
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.283099 acgc-0.2.6/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.243099 acgc-0.2.6/.github/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.243099 acgc-0.2.6/.github/workflows/
--rw-r--r--   0 runner    (1001) docker     (127)     1543 2024-03-20 23:44:34.000000 acgc-0.2.6/.github/workflows/publish-to-pypi.yml
--rw-r--r--   0 runner    (1001) docker     (127)     1972 2024-03-20 23:44:34.000000 acgc-0.2.6/.github/workflows/publish-to-testpypi.yml
--rw-r--r--   0 runner    (1001) docker     (127)      634 2024-03-20 23:44:34.000000 acgc-0.2.6/.github/workflows/run-pytest.yml
--rw-r--r--   0 runner    (1001) docker     (127)       62 2024-03-20 23:44:34.000000 acgc-0.2.6/.gitignore
--rw-r--r--   0 runner    (1001) docker     (127)     7652 2024-03-20 23:44:34.000000 acgc-0.2.6/LICENSE
--rw-r--r--   0 runner    (1001) docker     (127)    11202 2024-03-20 23:45:42.283099 acgc-0.2.6/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)     1026 2024-03-20 23:44:34.000000 acgc-0.2.6/README.md
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.247099 acgc-0.2.6/acgc/
--rw-r--r--   0 runner    (1001) docker     (127)     4196 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)     2454 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/acgc.mplstyle
--rw-r--r--   0 runner    (1001) docker     (127)      407 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/boxcar.py
--rw-r--r--   0 runner    (1001) docker     (127)      438 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/bstats.py
--rw-r--r--   0 runner    (1001) docker     (127)     2318 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/erroranalysis.py
--rw-r--r--   0 runner    (1001) docker     (127)     2607 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/figstyle.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.255099 acgc-0.2.6/acgc/fonts/
--rw-r--r--   0 runner    (1001) docker     (127)   176096 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreadventor-bold.otf
--rw-r--r--   0 runner    (1001) docker     (127)   175456 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreadventor-bolditalic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   170968 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreadventor-italic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   170364 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreadventor-regular.otf
--rw-r--r--   0 runner    (1001) docker     (127)   100924 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrechorus-mediumitalic.otf
--rw-r--r--   0 runner    (1001) docker     (127)    87288 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrecursor-bold.otf
--rw-r--r--   0 runner    (1001) docker     (127)    90360 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrecursor-bolditalic.otf
--rw-r--r--   0 runner    (1001) docker     (127)    87536 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrecursor-italic.otf
--rw-r--r--   0 runner    (1001) docker     (127)    84652 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrecursor-regular.otf
--rw-r--r--   0 runner    (1001) docker     (127)   135204 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreheros-bold.otf
--rw-r--r--   0 runner    (1001) docker     (127)   135264 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreheros-bolditalic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   139208 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreheros-italic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   133600 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreheros-regular.otf
--rw-r--r--   0 runner    (1001) docker     (127)   133220 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreheroscn-bold.otf
--rw-r--r--   0 runner    (1001) docker     (127)   138876 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreheroscn-bolditalic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   138940 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreheroscn-italic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   132372 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyreheroscn-regular.otf
--rw-r--r--   0 runner    (1001) docker     (127)   219564 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrepagella-bold.otf
--rw-r--r--   0 runner    (1001) docker     (127)   216296 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrepagella-bolditalic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   221936 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrepagella-italic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   218100 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyrepagella-regular.otf
--rw-r--r--   0 runner    (1001) docker     (127)   139480 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyretermes-bold.otf
--rw-r--r--   0 runner    (1001) docker     (127)   144180 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyretermes-bolditalic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   141324 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyretermes-italic.otf
--rw-r--r--   0 runner    (1001) docker     (127)   140932 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/fonts/texgyretermes-regular.otf
--rw-r--r--   0 runner    (1001) docker     (127)      121 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/gc.py
--rw-r--r--   0 runner    (1001) docker     (127)    23335 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/geoschem.py
--rw-r--r--   0 runner    (1001) docker     (127)    33137 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/hysplit.py
--rw-r--r--   0 runner    (1001) docker     (127)      382 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/hytools.py
--rw-r--r--   0 runner    (1001) docker     (127)    13468 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/icartt.py
--rw-r--r--   0 runner    (1001) docker     (127)    14959 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/igra.py
--rw-r--r--   0 runner    (1001) docker     (127)    10818 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/mapping.py
--rw-r--r--   0 runner    (1001) docker     (127)     5921 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/met.py
--rw-r--r--   0 runner    (1001) docker     (127)      374 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/mettools.py
--rw-r--r--   0 runner    (1001) docker     (127)     1835 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/modetools.py
--rw-r--r--   0 runner    (1001) docker     (127)      380 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/nctools.py
--rw-r--r--   0 runner    (1001) docker     (127)    23310 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/netcdf.py
--rw-r--r--   0 runner    (1001) docker     (127)      421 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/sen_slope.py
--rw-r--r--   0 runner    (1001) docker     (127)      436 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/smafit.py
--rw-r--r--   0 runner    (1001) docker     (127)    33571 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/solar.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.259099 acgc-0.2.6/acgc/stats/
--rw-r--r--   0 runner    (1001) docker     (127)      981 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/__init__.py
--rw-r--r--   0 runner    (1001) docker     (127)    24515 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/bivariate.py
--rw-r--r--   0 runner    (1001) docker     (127)    21169 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/bivariate_lines.py
--rw-r--r--   0 runner    (1001) docker     (127)     4698 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/boxcar.py
--rw-r--r--   0 runner    (1001) docker     (127)     2768 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/loess.py
--rw-r--r--   0 runner    (1001) docker     (127)     2297 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/partial_corr.py
--rw-r--r--   0 runner    (1001) docker     (127)     9845 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/sma_warton_fit.py
--rw-r--r--   0 runner    (1001) docker     (127)     1455 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/tapply.py
--rw-r--r--   0 runner    (1001) docker     (127)    15443 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/stats/weighted.py
--rw-r--r--   0 runner    (1001) docker     (127)     4455 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/time.py
--rw-r--r--   0 runner    (1001) docker     (127)      376 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/timetools.py
--rw-r--r--   0 runner    (1001) docker     (127)      573 2024-03-20 23:44:34.000000 acgc-0.2.6/acgc/wstats.py
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.283099 acgc-0.2.6/acgc.egg-info/
--rw-r--r--   0 runner    (1001) docker     (127)    11202 2024-03-20 23:45:42.000000 acgc-0.2.6/acgc.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (127)     3682 2024-03-20 23:45:42.000000 acgc-0.2.6/acgc.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (127)        1 2024-03-20 23:45:42.000000 acgc-0.2.6/acgc.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (127)      104 2024-03-20 23:45:42.000000 acgc-0.2.6/acgc.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (127)        5 2024-03-20 23:45:42.000000 acgc-0.2.6/acgc.egg-info/top_level.txt
--rwxr-xr-x   0 runner    (1001) docker     (127)      683 2024-03-20 23:44:34.000000 acgc-0.2.6/create_docs.sh
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.271098 acgc-0.2.6/demo/
--rw-r--r--   0 runner    (1001) docker     (127)     2187 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/EPA_AQS_PM25_Florida_2022.csv
--rw-r--r--   0 runner    (1001) docker     (127)   102214 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/c2h6_brw_surface-flask_1_arl_event.txt
--rw-r--r--   0 runner    (1001) docker     (127)   602584 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_2d_interpolation_methods.ipynb
--rw-r--r--   0 runner    (1001) docker     (127)      429 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_axes_scaling.py
--rw-r--r--   0 runner    (1001) docker     (127)     1199 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_basics.py
--rw-r--r--   0 runner    (1001) docker     (127)      464 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_boxcar.py
--rw-r--r--   0 runner    (1001) docker     (127)      844 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_covariance_propagation.py
--rw-r--r--   0 runner    (1001) docker     (127)     2296 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_deseasonalize.py
--rw-r--r--   0 runner    (1001) docker     (127)    60217 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_figstyle.ipynb
--rw-r--r--   0 runner    (1001) docker     (127)     2583 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_filter.py
--rw-r--r--   0 runner    (1001) docker     (127)    23296 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_fitting.ipynb
--rw-r--r--   0 runner    (1001) docker     (127)     1033 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_fitting.py
--rw-r--r--   0 runner    (1001) docker     (127)      618 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_font.py
--rw-r--r--   0 runner    (1001) docker     (127)     1644 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_gaussianprocess.py
--rw-r--r--   0 runner    (1001) docker     (127)     7139 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_gctools.py
--rw-r--r--   0 runner    (1001) docker     (127)     3789 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_goes_map.py
--rw-r--r--   0 runner    (1001) docker     (127)     9699 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_goes_truecolor.py
--rw-r--r--   0 runner    (1001) docker     (127)     1385 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_lagcorr.py
--rw-r--r--   0 runner    (1001) docker     (127)     1171 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_latex_fonts.py
--rw-r--r--   0 runner    (1001) docker     (127)      707 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_loess.py
--rw-r--r--   0 runner    (1001) docker     (127)     1393 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_lowess.py
--rw-r--r--   0 runner    (1001) docker     (127)   996912 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_maps.ipynb
--rw-r--r--   0 runner    (1001) docker     (127)      535 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_mcf.py
--rw-r--r--   0 runner    (1001) docker     (127)     4257 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_merra2_interp.py
--rw-r--r--   0 runner    (1001) docker     (127)      255 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_nctools.py
--rw-r--r--   0 runner    (1001) docker     (127)      847 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_ols_predict.py
--rw-r--r--   0 runner    (1001) docker     (127)      898 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_pressure_regrid.py
--rw-r--r--   0 runner    (1001) docker     (127)      288 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_qualitative_colors.py
--rw-r--r--   0 runner    (1001) docker     (127)     2626 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_readfixedwidth.py
--rw-r--r--   0 runner    (1001) docker     (127)     3041 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_regression.py
--rw-r--r--   0 runner    (1001) docker     (127)      272 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_regrid.py
--rw-r--r--   0 runner    (1001) docker     (127)     1119 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_regrid2d.py
--rw-r--r--   0 runner    (1001) docker     (127)      809 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_rolling.py
--rw-r--r--   0 runner    (1001) docker     (127)      619 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_rotate_marker.py
--rw-r--r--   0 runner    (1001) docker     (127)     1192 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_rpy2.py
--rw-r--r--   0 runner    (1001) docker     (127)     1644 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_sklearn.py
--rw-r--r--   0 runner    (1001) docker     (127)      410 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_slopes.py
--rw-r--r--   0 runner    (1001) docker     (127)   101754 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_sma.ipynb
--rw-r--r--   0 runner    (1001) docker     (127)     1266 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_sma.py
--rw-r--r--   0 runner    (1001) docker     (127)    88116 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_stats.ipynb
--rw-r--r--   0 runner    (1001) docker     (127)     1200 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_sympy_error_propagation.py
--rw-r--r--   0 runner    (1001) docker     (127)     2172 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_wmedian.py
--rw-r--r--   0 runner    (1001) docker     (127)     1439 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_wmts.py
--rw-r--r--   0 runner    (1001) docker     (127)  4098151 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/demo_wmts_extended.ipynb
--rw-r--r--   0 runner    (1001) docker     (127)  1629671 2024-03-20 23:44:34.000000 acgc-0.2.6/demo/ssasnow_05x0625.201504010100.nc
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.275099 acgc-0.2.6/docs/
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.279099 acgc-0.2.6/docs/acgc/
--rw-r--r--   0 runner    (1001) docker     (127)    62727 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/erroranalysis.html
--rw-r--r--   0 runner    (1001) docker     (127)    69851 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/figstyle.html
--rw-r--r--   0 runner    (1001) docker     (127)    36705 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/gc.html
--rw-r--r--   0 runner    (1001) docker     (127)   329341 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/geoschem.html
--rw-r--r--   0 runner    (1001) docker     (127)   374933 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/hysplit.html
--rw-r--r--   0 runner    (1001) docker     (127)   191496 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/icartt.html
--rw-r--r--   0 runner    (1001) docker     (127)   216235 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/igra.html
--rw-r--r--   0 runner    (1001) docker     (127)    96120 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/map_scalebar.html
--rw-r--r--   0 runner    (1001) docker     (127)   137855 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/mapping.html
--rw-r--r--   0 runner    (1001) docker     (127)   128795 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/met.html
--rw-r--r--   0 runner    (1001) docker     (127)    61319 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/modetools.html
--rw-r--r--   0 runner    (1001) docker     (127)   268586 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/netcdf.html
--rw-r--r--   0 runner    (1001) docker     (127)   481555 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/solar.html
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.283099 acgc-0.2.6/docs/acgc/stats/
--rw-r--r--   0 runner    (1001) docker     (127)   475922 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/stats/bivariate.html
--rw-r--r--   0 runner    (1001) docker     (127)   297331 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/stats/bivariate_lines.html
--rw-r--r--   0 runner    (1001) docker     (127)    95922 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/stats/boxcar.html
--rw-r--r--   0 runner    (1001) docker     (127)    62470 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/stats/partial_corr.html
--rw-r--r--   0 runner    (1001) docker     (127)   158247 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/stats/sma_warton_fit.html
--rw-r--r--   0 runner    (1001) docker     (127)    53284 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/stats/tapply.html
--rw-r--r--   0 runner    (1001) docker     (127)   228497 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/stats/weighted.html
--rw-r--r--   0 runner    (1001) docker     (127)    41510 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/stats.html
--rw-r--r--   0 runner    (1001) docker     (127)   101562 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc/time.html
--rw-r--r--   0 runner    (1001) docker     (127)    60339 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/acgc.html
--rw-r--r--   0 runner    (1001) docker     (127)      135 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/index.html
--rw-r--r--   0 runner    (1001) docker     (127)   190726 2024-03-20 23:44:34.000000 acgc-0.2.6/docs/search.js
--rw-r--r--   0 runner    (1001) docker     (127)     1531 2024-03-20 23:44:34.000000 acgc-0.2.6/pyproject.toml
--rw-r--r--   0 runner    (1001) docker     (127)     1289 2024-03-20 23:44:34.000000 acgc-0.2.6/release.md
--rw-r--r--   0 runner    (1001) docker     (127)       38 2024-03-20 23:45:42.283099 acgc-0.2.6/setup.cfg
-drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-03-20 23:45:42.283099 acgc-0.2.6/tests/
--rw-r--r--   0 runner    (1001) docker     (127)      727 2024-03-20 23:44:34.000000 acgc-0.2.6/tests/test_imports.py
--rw-r--r--   0 runner    (1001) docker     (127)     7727 2024-03-20 23:44:34.000000 acgc-0.2.6/tests/test_solar.py
--rw-r--r--   0 runner    (1001) docker     (127)      523 2024-03-20 23:44:34.000000 acgc-0.2.6/tests/test_stats_bivariate.py
--rw-r--r--   0 runner    (1001) docker     (127)     1264 2024-03-20 23:44:34.000000 acgc-0.2.6/tests/test_stats_weighted.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.817675 acgc-0.3/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.769676 acgc-0.3/.github/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.773676 acgc-0.3/.github/workflows/
+-rw-r--r--   0 runner    (1001) docker     (127)     1543 2024-05-07 21:01:49.000000 acgc-0.3/.github/workflows/publish-to-pypi.yml
+-rw-r--r--   0 runner    (1001) docker     (127)     1972 2024-05-07 21:01:49.000000 acgc-0.3/.github/workflows/publish-to-testpypi.yml
+-rw-r--r--   0 runner    (1001) docker     (127)      635 2024-05-07 21:01:49.000000 acgc-0.3/.github/workflows/run-pytest.yml
+-rw-r--r--   0 runner    (1001) docker     (127)       62 2024-05-07 21:01:49.000000 acgc-0.3/.gitignore
+-rw-r--r--   0 runner    (1001) docker     (127)     7652 2024-05-07 21:01:49.000000 acgc-0.3/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (127)    11200 2024-05-07 21:02:37.817675 acgc-0.3/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)     1026 2024-05-07 21:01:49.000000 acgc-0.3/README.md
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.777675 acgc-0.3/acgc/
+-rw-r--r--   0 runner    (1001) docker     (127)     4250 2024-05-07 21:01:49.000000 acgc-0.3/acgc/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2669 2024-05-07 21:01:49.000000 acgc-0.3/acgc/acgc.mplstyle
+-rw-r--r--   0 runner    (1001) docker     (127)      407 2024-05-07 21:01:49.000000 acgc-0.3/acgc/boxcar.py
+-rw-r--r--   0 runner    (1001) docker     (127)      438 2024-05-07 21:01:49.000000 acgc-0.3/acgc/bstats.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2392 2024-05-07 21:01:49.000000 acgc-0.3/acgc/erroranalysis.py
+-rw-r--r--   0 runner    (1001) docker     (127)     5331 2024-05-07 21:01:49.000000 acgc-0.3/acgc/figstyle.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.789675 acgc-0.3/acgc/fonts/
+-rw-r--r--   0 runner    (1001) docker     (127)   176096 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreadventor-bold.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   175456 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreadventor-bolditalic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   170968 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreadventor-italic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   170364 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreadventor-regular.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   100924 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrechorus-mediumitalic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)    87288 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrecursor-bold.otf
+-rw-r--r--   0 runner    (1001) docker     (127)    90360 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrecursor-bolditalic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)    87536 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrecursor-italic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)    84652 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrecursor-regular.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   135204 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreheros-bold.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   135264 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreheros-bolditalic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   139208 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreheros-italic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   133600 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreheros-regular.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   133220 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreheroscn-bold.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   138876 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreheroscn-bolditalic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   138940 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreheroscn-italic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   132372 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreheroscn-regular.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   219564 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrepagella-bold.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   216296 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrepagella-bolditalic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   221936 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrepagella-italic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   601220 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrepagella-math.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   218100 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyrepagella-regular.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   141752 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreschola-bold.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   144864 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreschola-bolditalic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   143152 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreschola-italic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   596860 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreschola-math.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   140596 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyreschola-regular.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   139480 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyretermes-bold.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   144180 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyretermes-bolditalic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   141324 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyretermes-italic.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   532404 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyretermes-math.otf
+-rw-r--r--   0 runner    (1001) docker     (127)   140932 2024-05-07 21:01:49.000000 acgc-0.3/acgc/fonts/texgyretermes-regular.otf
+-rw-r--r--   0 runner    (1001) docker     (127)      121 2024-05-07 21:01:49.000000 acgc-0.3/acgc/gc.py
+-rw-r--r--   0 runner    (1001) docker     (127)    23335 2024-05-07 21:01:49.000000 acgc-0.3/acgc/geoschem.py
+-rw-r--r--   0 runner    (1001) docker     (127)    33137 2024-05-07 21:01:49.000000 acgc-0.3/acgc/hysplit.py
+-rw-r--r--   0 runner    (1001) docker     (127)      382 2024-05-07 21:01:49.000000 acgc-0.3/acgc/hytools.py
+-rw-r--r--   0 runner    (1001) docker     (127)    13468 2024-05-07 21:01:49.000000 acgc-0.3/acgc/icartt.py
+-rw-r--r--   0 runner    (1001) docker     (127)    14959 2024-05-07 21:01:49.000000 acgc-0.3/acgc/igra.py
+-rw-r--r--   0 runner    (1001) docker     (127)    10818 2024-05-07 21:01:49.000000 acgc-0.3/acgc/mapping.py
+-rw-r--r--   0 runner    (1001) docker     (127)     5921 2024-05-07 21:01:49.000000 acgc-0.3/acgc/met.py
+-rw-r--r--   0 runner    (1001) docker     (127)      374 2024-05-07 21:01:49.000000 acgc-0.3/acgc/mettools.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1835 2024-05-07 21:01:49.000000 acgc-0.3/acgc/modetools.py
+-rw-r--r--   0 runner    (1001) docker     (127)      380 2024-05-07 21:01:49.000000 acgc-0.3/acgc/nctools.py
+-rw-r--r--   0 runner    (1001) docker     (127)    23310 2024-05-07 21:01:49.000000 acgc-0.3/acgc/netcdf.py
+-rw-r--r--   0 runner    (1001) docker     (127)      421 2024-05-07 21:01:49.000000 acgc-0.3/acgc/sen_slope.py
+-rw-r--r--   0 runner    (1001) docker     (127)      436 2024-05-07 21:01:49.000000 acgc-0.3/acgc/smafit.py
+-rw-r--r--   0 runner    (1001) docker     (127)    33571 2024-05-07 21:01:49.000000 acgc-0.3/acgc/solar.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.793675 acgc-0.3/acgc/stats/
+-rw-r--r--   0 runner    (1001) docker     (127)      981 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (127)    24978 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/bivariate.py
+-rw-r--r--   0 runner    (1001) docker     (127)    21169 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/bivariate_lines.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4698 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/boxcar.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2768 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/loess.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2297 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/partial_corr.py
+-rw-r--r--   0 runner    (1001) docker     (127)     9845 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/sma_warton_fit.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1455 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/tapply.py
+-rw-r--r--   0 runner    (1001) docker     (127)    15443 2024-05-07 21:01:49.000000 acgc-0.3/acgc/stats/weighted.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4455 2024-05-07 21:01:49.000000 acgc-0.3/acgc/time.py
+-rw-r--r--   0 runner    (1001) docker     (127)      376 2024-05-07 21:01:49.000000 acgc-0.3/acgc/timetools.py
+-rw-r--r--   0 runner    (1001) docker     (127)      573 2024-05-07 21:01:49.000000 acgc-0.3/acgc/wstats.py
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.817675 acgc-0.3/acgc.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (127)    11200 2024-05-07 21:02:37.000000 acgc-0.3/acgc.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (127)     3932 2024-05-07 21:02:37.000000 acgc-0.3/acgc.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        1 2024-05-07 21:02:37.000000 acgc-0.3/acgc.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (127)      104 2024-05-07 21:02:37.000000 acgc-0.3/acgc.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (127)        5 2024-05-07 21:02:37.000000 acgc-0.3/acgc.egg-info/top_level.txt
+-rwxr-xr-x   0 runner    (1001) docker     (127)      683 2024-05-07 21:01:49.000000 acgc-0.3/create_docs.sh
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.805675 acgc-0.3/demo/
+-rw-r--r--   0 runner    (1001) docker     (127)     2187 2024-05-07 21:01:49.000000 acgc-0.3/demo/EPA_AQS_PM25_Florida_2022.csv
+-rw-r--r--   0 runner    (1001) docker     (127)   102214 2024-05-07 21:01:49.000000 acgc-0.3/demo/c2h6_brw_surface-flask_1_arl_event.txt
+-rw-r--r--   0 runner    (1001) docker     (127)   602584 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_2d_interpolation_methods.ipynb
+-rw-r--r--   0 runner    (1001) docker     (127)      429 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_axes_scaling.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1199 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_basics.py
+-rw-r--r--   0 runner    (1001) docker     (127)      464 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_boxcar.py
+-rw-r--r--   0 runner    (1001) docker     (127)      844 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_covariance_propagation.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2296 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_deseasonalize.py
+-rw-r--r--   0 runner    (1001) docker     (127)    60217 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_figstyle.ipynb
+-rw-r--r--   0 runner    (1001) docker     (127)     2583 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_filter.py
+-rw-r--r--   0 runner    (1001) docker     (127)    23296 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_fitting.ipynb
+-rw-r--r--   0 runner    (1001) docker     (127)     1033 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_fitting.py
+-rw-r--r--   0 runner    (1001) docker     (127)      618 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_font.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1644 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_gaussianprocess.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7139 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_gctools.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3789 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_goes_map.py
+-rw-r--r--   0 runner    (1001) docker     (127)     9699 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_goes_truecolor.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1385 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_lagcorr.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1171 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_latex_fonts.py
+-rw-r--r--   0 runner    (1001) docker     (127)      707 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_loess.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1393 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_lowess.py
+-rw-r--r--   0 runner    (1001) docker     (127)   996912 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_maps.ipynb
+-rw-r--r--   0 runner    (1001) docker     (127)      535 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_mcf.py
+-rw-r--r--   0 runner    (1001) docker     (127)     4257 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_merra2_interp.py
+-rw-r--r--   0 runner    (1001) docker     (127)      255 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_nctools.py
+-rw-r--r--   0 runner    (1001) docker     (127)      847 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_ols_predict.py
+-rw-r--r--   0 runner    (1001) docker     (127)      898 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_pressure_regrid.py
+-rw-r--r--   0 runner    (1001) docker     (127)      288 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_qualitative_colors.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2626 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_readfixedwidth.py
+-rw-r--r--   0 runner    (1001) docker     (127)     3041 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_regression.py
+-rw-r--r--   0 runner    (1001) docker     (127)      272 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_regrid.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1119 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_regrid2d.py
+-rw-r--r--   0 runner    (1001) docker     (127)      809 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_rolling.py
+-rw-r--r--   0 runner    (1001) docker     (127)      619 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_rotate_marker.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1192 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_rpy2.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1644 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_sklearn.py
+-rw-r--r--   0 runner    (1001) docker     (127)      410 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_slopes.py
+-rw-r--r--   0 runner    (1001) docker     (127)   101754 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_sma.ipynb
+-rw-r--r--   0 runner    (1001) docker     (127)     1266 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_sma.py
+-rw-r--r--   0 runner    (1001) docker     (127)    88116 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_stats.ipynb
+-rw-r--r--   0 runner    (1001) docker     (127)     1200 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_sympy_error_propagation.py
+-rw-r--r--   0 runner    (1001) docker     (127)     2172 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_wmedian.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1439 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_wmts.py
+-rw-r--r--   0 runner    (1001) docker     (127)  4098151 2024-05-07 21:01:49.000000 acgc-0.3/demo/demo_wmts_extended.ipynb
+-rw-r--r--   0 runner    (1001) docker     (127)  1629671 2024-05-07 21:01:49.000000 acgc-0.3/demo/ssasnow_05x0625.201504010100.nc
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.809675 acgc-0.3/docs/
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.813675 acgc-0.3/docs/acgc/
+-rw-r--r--   0 runner    (1001) docker     (127)    63420 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/erroranalysis.html
+-rw-r--r--   0 runner    (1001) docker     (127)   118867 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/figstyle.html
+-rw-r--r--   0 runner    (1001) docker     (127)    36705 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/gc.html
+-rw-r--r--   0 runner    (1001) docker     (127)   329341 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/geoschem.html
+-rw-r--r--   0 runner    (1001) docker     (127)   374933 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/hysplit.html
+-rw-r--r--   0 runner    (1001) docker     (127)   191496 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/icartt.html
+-rw-r--r--   0 runner    (1001) docker     (127)   216235 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/igra.html
+-rw-r--r--   0 runner    (1001) docker     (127)    96120 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/map_scalebar.html
+-rw-r--r--   0 runner    (1001) docker     (127)   137855 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/mapping.html
+-rw-r--r--   0 runner    (1001) docker     (127)   128795 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/met.html
+-rw-r--r--   0 runner    (1001) docker     (127)    61319 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/modetools.html
+-rw-r--r--   0 runner    (1001) docker     (127)   268586 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/netcdf.html
+-rw-r--r--   0 runner    (1001) docker     (127)   481555 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/solar.html
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.817675 acgc-0.3/docs/acgc/stats/
+-rw-r--r--   0 runner    (1001) docker     (127)   483746 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/stats/bivariate.html
+-rw-r--r--   0 runner    (1001) docker     (127)   297331 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/stats/bivariate_lines.html
+-rw-r--r--   0 runner    (1001) docker     (127)    95922 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/stats/boxcar.html
+-rw-r--r--   0 runner    (1001) docker     (127)    62470 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/stats/partial_corr.html
+-rw-r--r--   0 runner    (1001) docker     (127)   158247 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/stats/sma_warton_fit.html
+-rw-r--r--   0 runner    (1001) docker     (127)    53284 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/stats/tapply.html
+-rw-r--r--   0 runner    (1001) docker     (127)   228497 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/stats/weighted.html
+-rw-r--r--   0 runner    (1001) docker     (127)    41510 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/stats.html
+-rw-r--r--   0 runner    (1001) docker     (127)   101562 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc/time.html
+-rw-r--r--   0 runner    (1001) docker     (127)    60225 2024-05-07 21:01:49.000000 acgc-0.3/docs/acgc.html
+-rw-r--r--   0 runner    (1001) docker     (127)      135 2024-05-07 21:01:49.000000 acgc-0.3/docs/index.html
+-rw-r--r--   0 runner    (1001) docker     (127)   213380 2024-05-07 21:01:49.000000 acgc-0.3/docs/search.js
+-rw-r--r--   0 runner    (1001) docker     (127)     1531 2024-05-07 21:01:49.000000 acgc-0.3/pyproject.toml
+-rw-r--r--   0 runner    (1001) docker     (127)     1289 2024-05-07 21:01:49.000000 acgc-0.3/release.md
+-rw-r--r--   0 runner    (1001) docker     (127)       38 2024-05-07 21:02:37.817675 acgc-0.3/setup.cfg
+drwxr-xr-x   0 runner    (1001) docker     (127)        0 2024-05-07 21:02:37.817675 acgc-0.3/tests/
+-rw-r--r--   0 runner    (1001) docker     (127)      727 2024-05-07 21:01:49.000000 acgc-0.3/tests/test_imports.py
+-rw-r--r--   0 runner    (1001) docker     (127)     7727 2024-05-07 21:01:49.000000 acgc-0.3/tests/test_solar.py
+-rw-r--r--   0 runner    (1001) docker     (127)      523 2024-05-07 21:01:49.000000 acgc-0.3/tests/test_stats_bivariate.py
+-rw-r--r--   0 runner    (1001) docker     (127)     1264 2024-05-07 21:01:49.000000 acgc-0.3/tests/test_stats_weighted.py
```

### Comparing `acgc-0.2.6/.github/workflows/publish-to-pypi.yml` & `acgc-0.3/.github/workflows/publish-to-pypi.yml`

 * *Files 8% similar despite different names*

```diff
@@ -9,15 +9,15 @@
     name: Build distribution 📦
     runs-on: ubuntu-latest
 
     steps:
     - name: Check out repository code
       uses: actions/checkout@v4
     - name: Set up Python
-      uses: actions/setup-python@v4
+      uses: actions/setup-python@v5
       with:
         python-version: "3.x"
     - name: Install dependencies for testing
       run: |
         python -m pip install --upgrade pip
         pip install .[test]
     - name: Test with Pytest
```

### Comparing `acgc-0.2.6/.github/workflows/publish-to-testpypi.yml` & `acgc-0.3/.github/workflows/publish-to-testpypi.yml`

 * *Files 1% similar despite different names*

```diff
@@ -23,15 +23,15 @@
     # if: endsWith(github.ref, 'main')
     runs-on: ubuntu-latest
 
     steps:
     - name: Check out repository code
       uses: actions/checkout@v4
     - name: Set up Python
-      uses: actions/setup-python@v4
+      uses: actions/setup-python@v5
       with:
         python-version: "3.x"
     - name: Install dependencies for testing
       run: |
         python -m pip install --upgrade pip
         pip install .[test]
     - name: Test with Pytest
```

### Comparing `acgc-0.2.6/.github/workflows/run-pytest.yml` & `acgc-0.3/.github/workflows/run-pytest.yml`

 * *Files 1% similar despite different names*

```diff
@@ -10,18 +10,18 @@
       matrix:  
         python-version: ["3.9","3.10","3.11","3.12"]  
 
     steps:
     - name: Check out repository code
       uses: actions/checkout@v4
     - name: Set up Python ${{ matrix.python-version }} 
-      uses: actions/setup-python@v4
+      uses: actions/setup-python@v5
       with:
         python-version: ${{ matrix.python-version }} 
     - name: Install dependencies
       run: |
         python -m pip install --upgrade pip
         pip install .[test]
     - name: Test with Pytest
       run: |
         pip install pytest 
-        pytest -v -s tests/
+        pytest -v -s tests/
```

### Comparing `acgc-0.2.6/LICENSE` & `acgc-0.3/LICENSE`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/PKG-INFO` & `acgc-0.3/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: acgc
-Version: 0.2.6
+Version: 0.3
 Summary: A collection of data analysis programs used by the Atmospheric Chemistry and Global Change (ACGC) research group
 Author-email: Christopher Holmes <cdholmes@fsu.edu>
 Maintainer-email: Christopher Holmes <cdholmes@fsu.edu>
 License:                    GNU LESSER GENERAL PUBLIC LICENSE
                                Version 3, 29 June 2007
         
          Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>
```

### Comparing `acgc-0.2.6/README.md` & `acgc-0.3/README.md`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/__init__.py` & `acgc-0.3/acgc/__init__.py`

 * *Files 4% similar despite different names*

```diff
@@ -19,34 +19,39 @@
 <!-- ----------------------- SECTION BREAK ----------------------- -->
 
 # Get started
 
 Submodules within `acgc` contain all the capabilities of the package.
 Submodules are imported via `import acgc.<submodule>` or `from acgc import <submodule>`. 
 
-## Better looking figures ([example](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb))
-
+## Better looking figures 
 
 The default appearance of figures from Matplotlib doesn't meet the standards of most 
 scientific journals (high-resolution, Helvetica-like font). With the `acgc.figstyle` module,
 figures meet these criteria. Simply use `from acgc import figstyle` before creating your figures.
 
-## Bivariate statistics ([example](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb))
+[Example using acgc.figstyle](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb)
+
+## Bivariate statistics 
 
 The `BivariateStatistics` class makes it easy to compute and display a large number of
 bivariate statistics, including line fitting and weighted statistics. 
 Results can be easily formatted into tables or inset in figures. Use `from acgc.stats import BivariateStatistics`
 See `acgc.stats.bivariate.BivariateStatistics` for documentation.
 
-## Standard major axis (SMA) line fitting ([example](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb))
+[Example using BivariateStatistics](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb)
+
+## Standard major axis (SMA) line fitting
 
 SMA line fitting (also called reduced major axis or RMA) quantifies the linear relationship 
 between variables in which neither one depends on the other.
 It is available via `from acgc.stats import sma`. 
 
+[Example using SMA](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb)
+
 <!-- ----------------------- SECTION BREAK ----------------------- -->
 
 # Demos
 The [demo](https://github.com/cdholmes/acgc-python/blob/main/demo) 
 folder contains examples of how to accomplish common data analysis and visualization tasks. 
 The examples include uses of the `acgc` library as well as other libraries for 
 geospatial data analysis.
```

### Comparing `acgc-0.2.6/acgc/acgc.mplstyle` & `acgc-0.3/acgc/acgc.mplstyle`

 * *Files 14% similar despite different names*

```diff
@@ -1,18 +1,21 @@
 ### Style inspired by the Proplot package
 
+# For settings documentation, see https://matplotlib.org/stable/users/explain/customizing.html#customizing-with-matplotlibrc-files
+
 ## Font
 font.size       : 10.0
 font.family     : sans-serif
-font.serif      : TeX Gyre Pagella, TeX Gyre Termes, DejaVu Serif, Bitstream Vera Serif, Computer Modern Roman, New Century Schoolbook, Century Schoolbook L, Utopia, ITC Bookman, Bookman, Nimbus Roman No9 L, Times New Roman, Times, Palatino, Charter, serif
+font.serif      : TeX Gyre Pagella, TeX Gyre Termes, TeX Gyre Schola, DejaVu Serif, Bitstream Vera Serif, Computer Modern Roman, New Century Schoolbook, Century Schoolbook L, Utopia, ITC Bookman, Bookman, Nimbus Roman No9 L, Times New Roman, Times, Palatino, Charter, serif
 font.sans-serif : TeX Gyre Heros, Arial, Helvetica, DejaVu Sans, Bitstream Vera Sans, Computer Modern Sans Serif, Lucida Grande, Verdana, Geneva, Lucid, Avant Garde, sans-serif
 font.cursive    : TeX Gyre Chorus, Apple Chancery, Textile, Zapf Chancery, Sand, Script MT, Felipa, Comic Neue, Comic Sans MS, cursive
 font.fantasy    : TeX Gyre Adventor, Chicago, Charcoal, Impact, Western, Humor Sans, xkcd, fantasy
 font.monospace  : DejaVu Sans Mono, TeX Gyre Cursor, Bitstream Vera Sans Mono, Computer Modern Typewriter, Andale Mono, Nimbus Mono L, Courier New, Courier, Fixed, Terminal, monospace
-
+mathtext.fontset: stixsans      # stixsans, stix and cm typically produce best results
+mathtext.fallback: stixsans
 
 ## Figure display
 figure.figsize      : 4.0, 3.3
 figure.titlesize    : 10
 figure.titleweight  : bold
 figure.dpi          : 100
 figure.constrained_layout.use   : True
@@ -61,8 +64,12 @@
 ytick.major.size    : 4.0
 ytick.major.width   : 0.6
 ytick.minor.pad     : 2.0
 ytick.minor.size    : 2.0
 ytick.minor.width   : 0.5
 ytick.minor.visible : True
 
-# See https://matplotlib.org/stable/users/explain/customizing.html#customizing-with-matplotlibrc-files for more documentation
+## Histogram plots
+hist.bins  : 20
+
+## Boxplots
+boxplot.showcaps       : False
```

### Comparing `acgc-0.2.6/acgc/erroranalysis.py` & `acgc-0.3/acgc/erroranalysis.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,27 +26,29 @@
         function to be evaluated
     x0   : list or tuple (n,)
         parameter values for func
     xerr : list or tuple (n,)
         uncertainty in parameter values x0
     h    : float, default=1e-3
         fractional perturbation to x0 used to estimate slope of func via finite difference 
+    **kwargs : (optional)
+        kwargs will be passed to func without error
     
     Returns
     -------
     ferr : float
         the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`
     '''
 
     # Increment size for finite difference
-    # Numerical Methods in C recommends h * x, where x is the variable and 
-    # h = sqrt(machine precision). For a 64-bit (double) float, that implies 
+    # Numerical Methods in C recommends h * x, where x is the variable and
+    # h = sqrt(machine precision). For a 64-bit (double) float, that implies
     # h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.
-    # We choose a larger value to reduce roundoff error. Note 
-    # that very large h causes formula error where secant line is not parallel 
+    # We choose a larger value to reduce roundoff error. Note
+    # that very large h causes formula error where secant line is not parallel
     # to instantaneous slope.
     if h is None:
         h = 1e-7
         h = 1e-3
 
     ferr = np.float64(0)
```

### Comparing `acgc-0.2.6/acgc/fonts/texgyreadventor-bold.otf` & `acgc-0.3/acgc/fonts/texgyreadventor-bold.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreadventor-bolditalic.otf` & `acgc-0.3/acgc/fonts/texgyreadventor-bolditalic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreadventor-italic.otf` & `acgc-0.3/acgc/fonts/texgyreadventor-italic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreadventor-regular.otf` & `acgc-0.3/acgc/fonts/texgyreadventor-regular.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrechorus-mediumitalic.otf` & `acgc-0.3/acgc/fonts/texgyrechorus-mediumitalic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrecursor-bold.otf` & `acgc-0.3/acgc/fonts/texgyrecursor-bold.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrecursor-bolditalic.otf` & `acgc-0.3/acgc/fonts/texgyrecursor-bolditalic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrecursor-italic.otf` & `acgc-0.3/acgc/fonts/texgyrecursor-italic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrecursor-regular.otf` & `acgc-0.3/acgc/fonts/texgyrecursor-regular.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreheros-bold.otf` & `acgc-0.3/acgc/fonts/texgyreheros-bold.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreheros-bolditalic.otf` & `acgc-0.3/acgc/fonts/texgyreheros-bolditalic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreheros-italic.otf` & `acgc-0.3/acgc/fonts/texgyreheros-italic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreheros-regular.otf` & `acgc-0.3/acgc/fonts/texgyreheros-regular.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreheroscn-bold.otf` & `acgc-0.3/acgc/fonts/texgyreheroscn-bold.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreheroscn-bolditalic.otf` & `acgc-0.3/acgc/fonts/texgyreheroscn-bolditalic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreheroscn-italic.otf` & `acgc-0.3/acgc/fonts/texgyreheroscn-italic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyreheroscn-regular.otf` & `acgc-0.3/acgc/fonts/texgyreheroscn-regular.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrepagella-bold.otf` & `acgc-0.3/acgc/fonts/texgyrepagella-bold.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrepagella-bolditalic.otf` & `acgc-0.3/acgc/fonts/texgyrepagella-bolditalic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrepagella-italic.otf` & `acgc-0.3/acgc/fonts/texgyrepagella-italic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyrepagella-regular.otf` & `acgc-0.3/acgc/fonts/texgyrepagella-regular.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyretermes-bold.otf` & `acgc-0.3/acgc/fonts/texgyretermes-bold.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyretermes-bolditalic.otf` & `acgc-0.3/acgc/fonts/texgyretermes-bolditalic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyretermes-italic.otf` & `acgc-0.3/acgc/fonts/texgyretermes-italic.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/fonts/texgyretermes-regular.otf` & `acgc-0.3/acgc/fonts/texgyretermes-regular.otf`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/geoschem.py` & `acgc-0.3/acgc/geoschem.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/hysplit.py` & `acgc-0.3/acgc/hysplit.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/icartt.py` & `acgc-0.3/acgc/icartt.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/igra.py` & `acgc-0.3/acgc/igra.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/mapping.py` & `acgc-0.3/acgc/mapping.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/met.py` & `acgc-0.3/acgc/met.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/modetools.py` & `acgc-0.3/acgc/modetools.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/netcdf.py` & `acgc-0.3/acgc/netcdf.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/solar.py` & `acgc-0.3/acgc/solar.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/stats/__init__.py` & `acgc-0.3/acgc/stats/__init__.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/stats/bivariate.py` & `acgc-0.3/acgc/stats/bivariate.py`

 * *Files 2% similar despite different names*

```diff
@@ -197,28 +197,32 @@
         mean of x and y variables
     xmedian, ymedian :float
         median of x and y variables
     xstd, ystd : float
         standard deviation of x and y variables
     mean_difference, md : float
         ymean - xmean
+    std_difference, stdd : float
+        std( y - x )
     mean_absolute_difference, mad : float
         mean( |y-x| )
     relative_mean_difference, rmd : float
         md / xmean
     relative_mean_absolute_difference, rmad :float
         mad / xmean
     standardized_mean_difference, smd : float
         md / xstd
     standardized_mean_absolute_difference, smad : float
         mad /xstd
     mean_relative_difference, mrd : float
         mean(y/x) - 1
     mean_log10_ratio, mlr : float
         mean( log10(y/x) )
+    std_log10_ratio, stdlr : float
+        std( log10(y/x) )
     mean_absolute_log10_ratio, malr : float
         mean( abs( log10(y/x) ) )
     median_difference, medd : float
         median(y-x)
     median_absolute_difference, medad : float
         median(|y-x|)
     relative_median_difference, rmedd : float
@@ -233,14 +237,16 @@
         median( abs( log10(y/x) ) )
     normalized_mean_bias_factor, nmbf : float
         see `nmbf` 
     normalized_mean_absolute_error_factor, nmaef : float
         see `nmaef`
     root_mean_square_difference, rmsd : float
         $\\sqrt{ \\langle (y - x)^2 \\rangle }$
+    root_mean_square_log10_ratio, rmslr : float
+        $\\sqrt{ \\langle log10(y/x)^2 \\rangle }$
     covariance : float
         cov(x,y)
     correlation_pearson, correlation, pearsonr, R, r : float
         Pearson linear correlation coefficient 
     correlation_spearman, spearmanr : float
         Spearman, non-parametric rank correlation coefficient
     R2, r2 : float
@@ -316,14 +322,15 @@
         self._x = x
         self._y = y
         self._w = w
 
         # Mean and mean absolute differences
         self.mean_difference            = self.md   = self.ymean - self.xmean
         self.mean_absolute_difference   = self.mad  = np.mean( absdiff )
+        self.std_difference             = self.stdd = np.std( diff )
 
         # Relative and standardized differences
         self.relative_mean_difference           = self.rmd  = self.mean_difference / self.xmean
         self.relative_mean_absolute_difference  = self.rmad = self.mean_absolute_difference / self.xmean
         self.standardized_mean_difference       = self.smd  = self.mean_difference / self.xstd
         self.standardized_mean_absolute_difference  = self.smad = self.mean_absolute_difference / self.xstd
 
@@ -341,21 +348,24 @@
 
         self.normalized_mean_bias_factor            = self.nmbf  = nmbf(x,y)
         self.normalized_mean_absolute_error_factor  = self.nmaef = nmaef(x,y)
 
         # Mean and mean absolute log ratio
         self.mean_log10_ratio          = self.mlr  = np.mean( log10ratio )
         self.mean_absolute_log10_ratio = self.malr = np.mean( np.abs( log10ratio ) )
-        
+        self.std_log10_ratio           = self.stdlr= np.std( log10ratio )
+
         # Median and median absolute log ratio
         self.median_log10_ratio          = self.medlr  = np.median( log10ratio )
         self.median_absolute_log10_ratio = self.medalr = np.median( np.abs( log10ratio ) )
-        
+
         # RMS difference
-        self.root_mean_square_difference    = self.rmsd     = np.sqrt( np.mean( np.power( diff, 2) ) )
+        self.root_mean_square_difference = self.rmsd   = np.sqrt( np.mean( np.power( diff, 2) ) )
+        # RMS log ratio
+        self.root_mean_square_log10_ratio = self.rmslr = np.sqrt( np.mean( np.power( log10ratio, 2 )))
 
         # Covariance, correlation
         self.covariance = np.cov(x,y)[0][1]
         self.correlation = self.correlation_pearson = self.R = self.r = self.pearsonr = \
             np.corrcoef(x,y)[0][1]
         self.correlation_spearman = self.spearmanr = stats.spearmanr(x,y).statistic
         self.R2 = self.r2 = self.R**2
```

### Comparing `acgc-0.2.6/acgc/stats/bivariate_lines.py` & `acgc-0.3/acgc/stats/bivariate_lines.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/stats/boxcar.py` & `acgc-0.3/acgc/stats/boxcar.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/stats/loess.py` & `acgc-0.3/acgc/stats/loess.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/stats/partial_corr.py` & `acgc-0.3/acgc/stats/partial_corr.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/stats/sma_warton_fit.py` & `acgc-0.3/acgc/stats/sma_warton_fit.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/stats/tapply.py` & `acgc-0.3/acgc/stats/tapply.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/stats/weighted.py` & `acgc-0.3/acgc/stats/weighted.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/time.py` & `acgc-0.3/acgc/time.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc/wstats.py` & `acgc-0.3/acgc/wstats.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/acgc.egg-info/PKG-INFO` & `acgc-0.3/acgc.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: acgc
-Version: 0.2.6
+Version: 0.3
 Summary: A collection of data analysis programs used by the Atmospheric Chemistry and Global Change (ACGC) research group
 Author-email: Christopher Holmes <cdholmes@fsu.edu>
 Maintainer-email: Christopher Holmes <cdholmes@fsu.edu>
 License:                    GNU LESSER GENERAL PUBLIC LICENSE
                                Version 3, 29 June 2007
         
          Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>
```

### Comparing `acgc-0.2.6/acgc.egg-info/SOURCES.txt` & `acgc-0.3/acgc.egg-info/SOURCES.txt`

 * *Files 6% similar despite different names*

```diff
@@ -52,18 +52,25 @@
 acgc/fonts/texgyreheroscn-bold.otf
 acgc/fonts/texgyreheroscn-bolditalic.otf
 acgc/fonts/texgyreheroscn-italic.otf
 acgc/fonts/texgyreheroscn-regular.otf
 acgc/fonts/texgyrepagella-bold.otf
 acgc/fonts/texgyrepagella-bolditalic.otf
 acgc/fonts/texgyrepagella-italic.otf
+acgc/fonts/texgyrepagella-math.otf
 acgc/fonts/texgyrepagella-regular.otf
+acgc/fonts/texgyreschola-bold.otf
+acgc/fonts/texgyreschola-bolditalic.otf
+acgc/fonts/texgyreschola-italic.otf
+acgc/fonts/texgyreschola-math.otf
+acgc/fonts/texgyreschola-regular.otf
 acgc/fonts/texgyretermes-bold.otf
 acgc/fonts/texgyretermes-bolditalic.otf
 acgc/fonts/texgyretermes-italic.otf
+acgc/fonts/texgyretermes-math.otf
 acgc/fonts/texgyretermes-regular.otf
 acgc/stats/__init__.py
 acgc/stats/bivariate.py
 acgc/stats/bivariate_lines.py
 acgc/stats/boxcar.py
 acgc/stats/loess.py
 acgc/stats/partial_corr.py
```

### Comparing `acgc-0.2.6/create_docs.sh` & `acgc-0.3/create_docs.sh`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/EPA_AQS_PM25_Florida_2022.csv` & `acgc-0.3/demo/EPA_AQS_PM25_Florida_2022.csv`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/c2h6_brw_surface-flask_1_arl_event.txt` & `acgc-0.3/demo/c2h6_brw_surface-flask_1_arl_event.txt`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_2d_interpolation_methods.ipynb` & `acgc-0.3/demo/demo_2d_interpolation_methods.ipynb`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_basics.py` & `acgc-0.3/demo/demo_basics.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_covariance_propagation.py` & `acgc-0.3/demo/demo_covariance_propagation.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_deseasonalize.py` & `acgc-0.3/demo/demo_deseasonalize.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_figstyle.ipynb` & `acgc-0.3/demo/demo_figstyle.ipynb`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_filter.py` & `acgc-0.3/demo/demo_filter.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_fitting.ipynb` & `acgc-0.3/demo/demo_fitting.ipynb`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_fitting.py` & `acgc-0.3/demo/demo_fitting.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_font.py` & `acgc-0.3/demo/demo_font.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_gaussianprocess.py` & `acgc-0.3/demo/demo_gaussianprocess.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_gctools.py` & `acgc-0.3/demo/demo_gctools.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_goes_map.py` & `acgc-0.3/demo/demo_goes_map.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_goes_truecolor.py` & `acgc-0.3/demo/demo_goes_truecolor.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_lagcorr.py` & `acgc-0.3/demo/demo_lagcorr.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_latex_fonts.py` & `acgc-0.3/demo/demo_latex_fonts.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_loess.py` & `acgc-0.3/demo/demo_loess.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_lowess.py` & `acgc-0.3/demo/demo_lowess.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_maps.ipynb` & `acgc-0.3/demo/demo_maps.ipynb`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_mcf.py` & `acgc-0.3/demo/demo_mcf.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_merra2_interp.py` & `acgc-0.3/demo/demo_merra2_interp.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_ols_predict.py` & `acgc-0.3/demo/demo_ols_predict.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_pressure_regrid.py` & `acgc-0.3/demo/demo_pressure_regrid.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_readfixedwidth.py` & `acgc-0.3/demo/demo_readfixedwidth.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_regression.py` & `acgc-0.3/demo/demo_regression.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_regrid2d.py` & `acgc-0.3/demo/demo_regrid2d.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_rolling.py` & `acgc-0.3/demo/demo_rolling.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_rotate_marker.py` & `acgc-0.3/demo/demo_rotate_marker.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_rpy2.py` & `acgc-0.3/demo/demo_rpy2.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_sklearn.py` & `acgc-0.3/demo/demo_sklearn.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_sma.ipynb` & `acgc-0.3/demo/demo_sma.ipynb`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_sma.py` & `acgc-0.3/demo/demo_sma.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_stats.ipynb` & `acgc-0.3/demo/demo_stats.ipynb`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_sympy_error_propagation.py` & `acgc-0.3/demo/demo_sympy_error_propagation.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_wmedian.py` & `acgc-0.3/demo/demo_wmedian.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_wmts.py` & `acgc-0.3/demo/demo_wmts.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/demo_wmts_extended.ipynb` & `acgc-0.3/demo/demo_wmts_extended.ipynb`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/demo/ssasnow_05x0625.201504010100.nc` & `acgc-0.3/demo/ssasnow_05x0625.201504010100.nc`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/erroranalysis.html` & `acgc-0.3/docs/acgc/erroranalysis.html`

 * *Files 1% similar despite different names*

```diff
@@ -107,48 +107,50 @@
 </span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="sd">        function to be evaluated</span>
 </span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="sd">    x0   : list or tuple (n,)</span>
 </span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="sd">        parameter values for func</span>
 </span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="sd">    xerr : list or tuple (n,)</span>
 </span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="sd">        uncertainty in parameter values x0</span>
 </span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a><span class="sd">    h    : float, default=1e-3</span>
 </span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="sd">        fractional perturbation to x0 used to estimate slope of func via finite difference </span>
-</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a><span class="sd">    </span>
-</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="sd">    Returns</span>
-</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a><span class="sd">    -------</span>
-</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a><span class="sd">    ferr : float</span>
-</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a><span class="sd">        the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`</span>
-</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>
-</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="c1"># Increment size for finite difference</span>
-</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="c1"># Numerical Methods in C recommends h * x, where x is the variable and </span>
-</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="c1"># h = sqrt(machine precision). For a 64-bit (double) float, that implies </span>
-</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="c1"># h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.</span>
-</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="c1"># We choose a larger value to reduce roundoff error. Note </span>
-</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="c1"># that very large h causes formula error where secant line is not parallel </span>
-</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="c1"># to instantaneous slope.</span>
-</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="mf">1e-7</span>
-</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="mf">1e-3</span>
-</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>
-</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>    <span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
+</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a><span class="sd">    **kwargs : (optional)</span>
+</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="sd">        kwargs will be passed to func without error</span>
+</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a><span class="sd">    </span>
+</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a><span class="sd">    Returns</span>
+</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a><span class="sd">    -------</span>
+</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a><span class="sd">    ferr : float</span>
+</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a><span class="sd">        the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`</span>
+</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a><span class="sd">    &#39;&#39;&#39;</span>
+</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>
+</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="c1"># Increment size for finite difference</span>
+</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="c1"># Numerical Methods in C recommends h * x, where x is the variable and</span>
+</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="c1"># h = sqrt(machine precision). For a 64-bit (double) float, that implies</span>
+</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="c1"># h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.</span>
+</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="c1"># We choose a larger value to reduce roundoff error. Note</span>
+</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="c1"># that very large h causes formula error where secant line is not parallel</span>
+</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="c1"># to instantaneous slope.</span>
+</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="mf">1e-7</span>
+</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="mf">1e-3</span>
 </span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>
-</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">xi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
-</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>        <span class="n">xplus</span>     <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
-</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>        <span class="n">xminus</span>    <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
-</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>        <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">xi</span>
-</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>        <span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">xi</span>
-</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>
-</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>        <span class="c1"># Centered finite difference estimate of derivative</span>
-</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a>        <span class="n">dfdx</span> <span class="o">=</span> <span class="p">(</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xplus</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xminus</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
-</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a>
-</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>        <span class="n">ferr</span> <span class="o">+=</span> <span class="n">dfdx</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">xerr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
+</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>    <span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
+</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>
+</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">xi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
+</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>        <span class="n">xplus</span>     <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
+</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>        <span class="n">xminus</span>    <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
+</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>        <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">xi</span>
+</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>        <span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">xi</span>
+</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a>
+</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a>        <span class="c1"># Centered finite difference estimate of derivative</span>
+</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>        <span class="n">dfdx</span> <span class="o">=</span> <span class="p">(</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xplus</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xminus</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
 </span><span id="L-63"><a href="#L-63"><span class="linenos">63</span></a>
-</span><span id="L-64"><a href="#L-64"><span class="linenos">64</span></a>    <span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ferr</span><span class="p">)</span>
+</span><span id="L-64"><a href="#L-64"><span class="linenos">64</span></a>        <span class="n">ferr</span> <span class="o">+=</span> <span class="n">dfdx</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">xerr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
 </span><span id="L-65"><a href="#L-65"><span class="linenos">65</span></a>
-</span><span id="L-66"><a href="#L-66"><span class="linenos">66</span></a>    <span class="k">return</span> <span class="n">ferr</span>
+</span><span id="L-66"><a href="#L-66"><span class="linenos">66</span></a>    <span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ferr</span><span class="p">)</span>
+</span><span id="L-67"><a href="#L-67"><span class="linenos">67</span></a>
+</span><span id="L-68"><a href="#L-68"><span class="linenos">68</span></a>    <span class="k">return</span> <span class="n">ferr</span>
 </span></pre></div>
 
 
             </section>
                 <section id="funcerror_uncorr">
                             <input id="funcerror_uncorr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
 <div class="attr function">
@@ -182,48 +184,50 @@
 </span><span id="funcerror_uncorr-27"><a href="#funcerror_uncorr-27"><span class="linenos">27</span></a><span class="sd">        function to be evaluated</span>
 </span><span id="funcerror_uncorr-28"><a href="#funcerror_uncorr-28"><span class="linenos">28</span></a><span class="sd">    x0   : list or tuple (n,)</span>
 </span><span id="funcerror_uncorr-29"><a href="#funcerror_uncorr-29"><span class="linenos">29</span></a><span class="sd">        parameter values for func</span>
 </span><span id="funcerror_uncorr-30"><a href="#funcerror_uncorr-30"><span class="linenos">30</span></a><span class="sd">    xerr : list or tuple (n,)</span>
 </span><span id="funcerror_uncorr-31"><a href="#funcerror_uncorr-31"><span class="linenos">31</span></a><span class="sd">        uncertainty in parameter values x0</span>
 </span><span id="funcerror_uncorr-32"><a href="#funcerror_uncorr-32"><span class="linenos">32</span></a><span class="sd">    h    : float, default=1e-3</span>
 </span><span id="funcerror_uncorr-33"><a href="#funcerror_uncorr-33"><span class="linenos">33</span></a><span class="sd">        fractional perturbation to x0 used to estimate slope of func via finite difference </span>
-</span><span id="funcerror_uncorr-34"><a href="#funcerror_uncorr-34"><span class="linenos">34</span></a><span class="sd">    </span>
-</span><span id="funcerror_uncorr-35"><a href="#funcerror_uncorr-35"><span class="linenos">35</span></a><span class="sd">    Returns</span>
-</span><span id="funcerror_uncorr-36"><a href="#funcerror_uncorr-36"><span class="linenos">36</span></a><span class="sd">    -------</span>
-</span><span id="funcerror_uncorr-37"><a href="#funcerror_uncorr-37"><span class="linenos">37</span></a><span class="sd">    ferr : float</span>
-</span><span id="funcerror_uncorr-38"><a href="#funcerror_uncorr-38"><span class="linenos">38</span></a><span class="sd">        the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`</span>
-</span><span id="funcerror_uncorr-39"><a href="#funcerror_uncorr-39"><span class="linenos">39</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="funcerror_uncorr-40"><a href="#funcerror_uncorr-40"><span class="linenos">40</span></a>
-</span><span id="funcerror_uncorr-41"><a href="#funcerror_uncorr-41"><span class="linenos">41</span></a>    <span class="c1"># Increment size for finite difference</span>
-</span><span id="funcerror_uncorr-42"><a href="#funcerror_uncorr-42"><span class="linenos">42</span></a>    <span class="c1"># Numerical Methods in C recommends h * x, where x is the variable and </span>
-</span><span id="funcerror_uncorr-43"><a href="#funcerror_uncorr-43"><span class="linenos">43</span></a>    <span class="c1"># h = sqrt(machine precision). For a 64-bit (double) float, that implies </span>
-</span><span id="funcerror_uncorr-44"><a href="#funcerror_uncorr-44"><span class="linenos">44</span></a>    <span class="c1"># h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.</span>
-</span><span id="funcerror_uncorr-45"><a href="#funcerror_uncorr-45"><span class="linenos">45</span></a>    <span class="c1"># We choose a larger value to reduce roundoff error. Note </span>
-</span><span id="funcerror_uncorr-46"><a href="#funcerror_uncorr-46"><span class="linenos">46</span></a>    <span class="c1"># that very large h causes formula error where secant line is not parallel </span>
-</span><span id="funcerror_uncorr-47"><a href="#funcerror_uncorr-47"><span class="linenos">47</span></a>    <span class="c1"># to instantaneous slope.</span>
-</span><span id="funcerror_uncorr-48"><a href="#funcerror_uncorr-48"><span class="linenos">48</span></a>    <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="funcerror_uncorr-49"><a href="#funcerror_uncorr-49"><span class="linenos">49</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="mf">1e-7</span>
-</span><span id="funcerror_uncorr-50"><a href="#funcerror_uncorr-50"><span class="linenos">50</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="mf">1e-3</span>
-</span><span id="funcerror_uncorr-51"><a href="#funcerror_uncorr-51"><span class="linenos">51</span></a>
-</span><span id="funcerror_uncorr-52"><a href="#funcerror_uncorr-52"><span class="linenos">52</span></a>    <span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
+</span><span id="funcerror_uncorr-34"><a href="#funcerror_uncorr-34"><span class="linenos">34</span></a><span class="sd">    **kwargs : (optional)</span>
+</span><span id="funcerror_uncorr-35"><a href="#funcerror_uncorr-35"><span class="linenos">35</span></a><span class="sd">        kwargs will be passed to func without error</span>
+</span><span id="funcerror_uncorr-36"><a href="#funcerror_uncorr-36"><span class="linenos">36</span></a><span class="sd">    </span>
+</span><span id="funcerror_uncorr-37"><a href="#funcerror_uncorr-37"><span class="linenos">37</span></a><span class="sd">    Returns</span>
+</span><span id="funcerror_uncorr-38"><a href="#funcerror_uncorr-38"><span class="linenos">38</span></a><span class="sd">    -------</span>
+</span><span id="funcerror_uncorr-39"><a href="#funcerror_uncorr-39"><span class="linenos">39</span></a><span class="sd">    ferr : float</span>
+</span><span id="funcerror_uncorr-40"><a href="#funcerror_uncorr-40"><span class="linenos">40</span></a><span class="sd">        the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`</span>
+</span><span id="funcerror_uncorr-41"><a href="#funcerror_uncorr-41"><span class="linenos">41</span></a><span class="sd">    &#39;&#39;&#39;</span>
+</span><span id="funcerror_uncorr-42"><a href="#funcerror_uncorr-42"><span class="linenos">42</span></a>
+</span><span id="funcerror_uncorr-43"><a href="#funcerror_uncorr-43"><span class="linenos">43</span></a>    <span class="c1"># Increment size for finite difference</span>
+</span><span id="funcerror_uncorr-44"><a href="#funcerror_uncorr-44"><span class="linenos">44</span></a>    <span class="c1"># Numerical Methods in C recommends h * x, where x is the variable and</span>
+</span><span id="funcerror_uncorr-45"><a href="#funcerror_uncorr-45"><span class="linenos">45</span></a>    <span class="c1"># h = sqrt(machine precision). For a 64-bit (double) float, that implies</span>
+</span><span id="funcerror_uncorr-46"><a href="#funcerror_uncorr-46"><span class="linenos">46</span></a>    <span class="c1"># h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.</span>
+</span><span id="funcerror_uncorr-47"><a href="#funcerror_uncorr-47"><span class="linenos">47</span></a>    <span class="c1"># We choose a larger value to reduce roundoff error. Note</span>
+</span><span id="funcerror_uncorr-48"><a href="#funcerror_uncorr-48"><span class="linenos">48</span></a>    <span class="c1"># that very large h causes formula error where secant line is not parallel</span>
+</span><span id="funcerror_uncorr-49"><a href="#funcerror_uncorr-49"><span class="linenos">49</span></a>    <span class="c1"># to instantaneous slope.</span>
+</span><span id="funcerror_uncorr-50"><a href="#funcerror_uncorr-50"><span class="linenos">50</span></a>    <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="funcerror_uncorr-51"><a href="#funcerror_uncorr-51"><span class="linenos">51</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="mf">1e-7</span>
+</span><span id="funcerror_uncorr-52"><a href="#funcerror_uncorr-52"><span class="linenos">52</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="mf">1e-3</span>
 </span><span id="funcerror_uncorr-53"><a href="#funcerror_uncorr-53"><span class="linenos">53</span></a>
-</span><span id="funcerror_uncorr-54"><a href="#funcerror_uncorr-54"><span class="linenos">54</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">xi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
-</span><span id="funcerror_uncorr-55"><a href="#funcerror_uncorr-55"><span class="linenos">55</span></a>        <span class="n">xplus</span>     <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
-</span><span id="funcerror_uncorr-56"><a href="#funcerror_uncorr-56"><span class="linenos">56</span></a>        <span class="n">xminus</span>    <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
-</span><span id="funcerror_uncorr-57"><a href="#funcerror_uncorr-57"><span class="linenos">57</span></a>        <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">xi</span>
-</span><span id="funcerror_uncorr-58"><a href="#funcerror_uncorr-58"><span class="linenos">58</span></a>        <span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">xi</span>
-</span><span id="funcerror_uncorr-59"><a href="#funcerror_uncorr-59"><span class="linenos">59</span></a>
-</span><span id="funcerror_uncorr-60"><a href="#funcerror_uncorr-60"><span class="linenos">60</span></a>        <span class="c1"># Centered finite difference estimate of derivative</span>
-</span><span id="funcerror_uncorr-61"><a href="#funcerror_uncorr-61"><span class="linenos">61</span></a>        <span class="n">dfdx</span> <span class="o">=</span> <span class="p">(</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xplus</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xminus</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
-</span><span id="funcerror_uncorr-62"><a href="#funcerror_uncorr-62"><span class="linenos">62</span></a>
-</span><span id="funcerror_uncorr-63"><a href="#funcerror_uncorr-63"><span class="linenos">63</span></a>        <span class="n">ferr</span> <span class="o">+=</span> <span class="n">dfdx</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">xerr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
+</span><span id="funcerror_uncorr-54"><a href="#funcerror_uncorr-54"><span class="linenos">54</span></a>    <span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
+</span><span id="funcerror_uncorr-55"><a href="#funcerror_uncorr-55"><span class="linenos">55</span></a>
+</span><span id="funcerror_uncorr-56"><a href="#funcerror_uncorr-56"><span class="linenos">56</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">xi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
+</span><span id="funcerror_uncorr-57"><a href="#funcerror_uncorr-57"><span class="linenos">57</span></a>        <span class="n">xplus</span>     <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
+</span><span id="funcerror_uncorr-58"><a href="#funcerror_uncorr-58"><span class="linenos">58</span></a>        <span class="n">xminus</span>    <span class="o">=</span> <span class="n">x0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
+</span><span id="funcerror_uncorr-59"><a href="#funcerror_uncorr-59"><span class="linenos">59</span></a>        <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">xi</span>
+</span><span id="funcerror_uncorr-60"><a href="#funcerror_uncorr-60"><span class="linenos">60</span></a>        <span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="n">xi</span>
+</span><span id="funcerror_uncorr-61"><a href="#funcerror_uncorr-61"><span class="linenos">61</span></a>
+</span><span id="funcerror_uncorr-62"><a href="#funcerror_uncorr-62"><span class="linenos">62</span></a>        <span class="c1"># Centered finite difference estimate of derivative</span>
+</span><span id="funcerror_uncorr-63"><a href="#funcerror_uncorr-63"><span class="linenos">63</span></a>        <span class="n">dfdx</span> <span class="o">=</span> <span class="p">(</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xplus</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">xminus</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">xplus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xminus</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
 </span><span id="funcerror_uncorr-64"><a href="#funcerror_uncorr-64"><span class="linenos">64</span></a>
-</span><span id="funcerror_uncorr-65"><a href="#funcerror_uncorr-65"><span class="linenos">65</span></a>    <span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ferr</span><span class="p">)</span>
+</span><span id="funcerror_uncorr-65"><a href="#funcerror_uncorr-65"><span class="linenos">65</span></a>        <span class="n">ferr</span> <span class="o">+=</span> <span class="n">dfdx</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">xerr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
 </span><span id="funcerror_uncorr-66"><a href="#funcerror_uncorr-66"><span class="linenos">66</span></a>
-</span><span id="funcerror_uncorr-67"><a href="#funcerror_uncorr-67"><span class="linenos">67</span></a>    <span class="k">return</span> <span class="n">ferr</span>
+</span><span id="funcerror_uncorr-67"><a href="#funcerror_uncorr-67"><span class="linenos">67</span></a>    <span class="n">ferr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ferr</span><span class="p">)</span>
+</span><span id="funcerror_uncorr-68"><a href="#funcerror_uncorr-68"><span class="linenos">68</span></a>
+</span><span id="funcerror_uncorr-69"><a href="#funcerror_uncorr-69"><span class="linenos">69</span></a>    <span class="k">return</span> <span class="n">ferr</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>Propagate uncertainties in function parameters to uncertainty in function value. </p>
 
 <p>The uncertainty will be evaluated at f(x0). The method uses 
 a numerical estimate of the derivative of f(x0). For non-linear functions
@@ -245,14 +249,16 @@
 function to be evaluated</li>
 <li><strong>x0</strong> (list or tuple (n,)):
 parameter values for func</li>
 <li><strong>xerr</strong> (list or tuple (n,)):
 uncertainty in parameter values x0</li>
 <li><strong>h</strong> (float, default=1e-3):
 fractional perturbation to x0 used to estimate slope of func via finite difference</li>
+<li><strong>**kwargs</strong> ((optional)):
+kwargs will be passed to func without error</li>
 </ul>
 
 <h6 id="returns">Returns</h6>
 
 <ul>
 <li><strong>ferr</strong> (float):
 the uncertainty in <code>f(x0)</code> given <code>xerr</code> uncertainty in <code>x0</code></li>
```

#### html2text {}

```diff
@@ -39,50 +39,52 @@
 _2_7    x0   : list or tuple (n,)
 _2_8        parameter values for func
 _2_9    xerr : list or tuple (n,)
 _3_0        uncertainty in parameter values x0
 _3_1    h    : float, default=1e-3
 _3_2        fractional perturbation to x0 used to estimate slope of func via
 finite difference
-_3_3
-_3_4    Returns
-_3_5    -------
-_3_6    ferr : float
-_3_7        the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`
-_3_8    '''
-_3_9
-_4_0    # Increment size for finite difference
-_4_1    # Numerical Methods in C recommends h * x, where x is the variable and
-_4_2    # h = sqrt(machine precision). For a 64-bit (double) float, that implies
-_4_3    # h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.
-_4_4    # We choose a larger value to reduce roundoff error. Note
-_4_5    # that very large h causes formula error where secant line is not
+_3_3    **kwargs : (optional)
+_3_4        kwargs will be passed to func without error
+_3_5
+_3_6    Returns
+_3_7    -------
+_3_8    ferr : float
+_3_9        the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`
+_4_0    '''
+_4_1
+_4_2    # Increment size for finite difference
+_4_3    # Numerical Methods in C recommends h * x, where x is the variable and
+_4_4    # h = sqrt(machine precision). For a 64-bit (double) float, that implies
+_4_5    # h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.
+_4_6    # We choose a larger value to reduce roundoff error. Note
+_4_7    # that very large h causes formula error where secant line is not
 parallel
-_4_6    # to instantaneous slope.
-_4_7    if h is None:
-_4_8        h = 1e-7
-_4_9        h = 1e-3
-_5_0
-_5_1    ferr = np.float64(0)
+_4_8    # to instantaneous slope.
+_4_9    if h is None:
+_5_0        h = 1e-7
+_5_1        h = 1e-3
 _5_2
-_5_3    for i,xi in enumerate(x0):
-_5_4        xplus     = x0.copy()
-_5_5        xminus    = x0.copy()
-_5_6        xplus[i]  = xplus[i]  + h*xi
-_5_7        xminus[i] = xminus[i] - h*xi
-_5_8
-_5_9        # Centered finite difference estimate of derivative
-_6_0        dfdx = ( func(*xplus,**kwargs) - func(*xminus,**kwargs) ) / ( xplus
+_5_3    ferr = np.float64(0)
+_5_4
+_5_5    for i,xi in enumerate(x0):
+_5_6        xplus     = x0.copy()
+_5_7        xminus    = x0.copy()
+_5_8        xplus[i]  = xplus[i]  + h*xi
+_5_9        xminus[i] = xminus[i] - h*xi
+_6_0
+_6_1        # Centered finite difference estimate of derivative
+_6_2        dfdx = ( func(*xplus,**kwargs) - func(*xminus,**kwargs) ) / ( xplus
 [i]-xminus[i] )
-_6_1
-_6_2        ferr += dfdx**2 * xerr[i]**2
 _6_3
-_6_4    ferr = np.sqrt(ferr)
+_6_4        ferr += dfdx**2 * xerr[i]**2
 _6_5
-_6_6    return ferr
+_6_6    ferr = np.sqrt(ferr)
+_6_7
+_6_8    return ferr
 ??
 def funcerror_uncorr(func, x0, xerr, h=None, **kwargs): View Source
 _ _8def funcerror_uncorr(func,x0,xerr,h=None,**kwargs):
 _ _9    '''Propagate uncertainties in function parameters to uncertainty in
 function value.
 _1_0
 _1_1    The uncertainty will be evaluated at f(x0). The method uses
@@ -108,50 +110,52 @@
 _2_8    x0   : list or tuple (n,)
 _2_9        parameter values for func
 _3_0    xerr : list or tuple (n,)
 _3_1        uncertainty in parameter values x0
 _3_2    h    : float, default=1e-3
 _3_3        fractional perturbation to x0 used to estimate slope of func via
 finite difference
-_3_4
-_3_5    Returns
-_3_6    -------
-_3_7    ferr : float
-_3_8        the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`
-_3_9    '''
-_4_0
-_4_1    # Increment size for finite difference
-_4_2    # Numerical Methods in C recommends h * x, where x is the variable and
-_4_3    # h = sqrt(machine precision). For a 64-bit (double) float, that implies
-_4_4    # h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.
-_4_5    # We choose a larger value to reduce roundoff error. Note
-_4_6    # that very large h causes formula error where secant line is not
+_3_4    **kwargs : (optional)
+_3_5        kwargs will be passed to func without error
+_3_6
+_3_7    Returns
+_3_8    -------
+_3_9    ferr : float
+_4_0        the uncertainty in `f(x0)` given `xerr` uncertainty in `x0`
+_4_1    '''
+_4_2
+_4_3    # Increment size for finite difference
+_4_4    # Numerical Methods in C recommends h * x, where x is the variable and
+_4_5    # h = sqrt(machine precision). For a 64-bit (double) float, that implies
+_4_6    # h = 2e-8. For a 32-bit (single) float, that implies h = 3e-4.
+_4_7    # We choose a larger value to reduce roundoff error. Note
+_4_8    # that very large h causes formula error where secant line is not
 parallel
-_4_7    # to instantaneous slope.
-_4_8    if h is None:
-_4_9        h = 1e-7
-_5_0        h = 1e-3
-_5_1
-_5_2    ferr = np.float64(0)
+_4_9    # to instantaneous slope.
+_5_0    if h is None:
+_5_1        h = 1e-7
+_5_2        h = 1e-3
 _5_3
-_5_4    for i,xi in enumerate(x0):
-_5_5        xplus     = x0.copy()
-_5_6        xminus    = x0.copy()
-_5_7        xplus[i]  = xplus[i]  + h*xi
-_5_8        xminus[i] = xminus[i] - h*xi
-_5_9
-_6_0        # Centered finite difference estimate of derivative
-_6_1        dfdx = ( func(*xplus,**kwargs) - func(*xminus,**kwargs) ) / ( xplus
+_5_4    ferr = np.float64(0)
+_5_5
+_5_6    for i,xi in enumerate(x0):
+_5_7        xplus     = x0.copy()
+_5_8        xminus    = x0.copy()
+_5_9        xplus[i]  = xplus[i]  + h*xi
+_6_0        xminus[i] = xminus[i] - h*xi
+_6_1
+_6_2        # Centered finite difference estimate of derivative
+_6_3        dfdx = ( func(*xplus,**kwargs) - func(*xminus,**kwargs) ) / ( xplus
 [i]-xminus[i] )
-_6_2
-_6_3        ferr += dfdx**2 * xerr[i]**2
 _6_4
-_6_5    ferr = np.sqrt(ferr)
+_6_5        ferr += dfdx**2 * xerr[i]**2
 _6_6
-_6_7    return ferr
+_6_7    ferr = np.sqrt(ferr)
+_6_8
+_6_9    return ferr
 Propagate uncertainties in function parameters to uncertainty in function
 value.
 The uncertainty will be evaluated at f(x0). The method uses a numerical
 estimate of the derivative of f(x0). For non-linear functions the method is
 appropriate for small relative errors (i.e. small xerr/x0). The method neglects
 possible error correlations between multiple parameters in x0. The function
 variables must all be continuous variables (no categorical or discrete
@@ -161,9 +165,10 @@
 print( funcerr_uncorr( f, [1,2], [0.1,0.3] ) )
 ** PPaarraammeetteerrss **
     * ffuunncc (callable): function to be evaluated
     * xx00 (list or tuple (n,)): parameter values for func
     * xxeerrrr (list or tuple (n,)): uncertainty in parameter values x0
     * hh (float, default=1e-3): fractional perturbation to x0 used to estimate
       slope of func via finite difference
+    * ****kkwwaarrggss ((optional)): kwargs will be passed to func without error
 ** RReettuurrnnss **
     * ffeerrrr (float): the uncertainty in f(x0) given xerr uncertainty in x0
```

### Comparing `acgc-0.2.6/docs/acgc/figstyle.html` & `acgc-0.3/docs/acgc/modetools.html`

 * *Files 21% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 <!doctype html>
 <html lang="en">
 <head>
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">
     <meta name="generator" content="pdoc 14.4.0"/>
-    <title>acgc.figstyle API documentation</title>
+    <title>acgc.modetools API documentation</title>
 
     <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
     <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
     <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
     <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
     <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
     <style>/*! custom.css */</style><script>
@@ -50,24 +50,15 @@
                    pattern=".+" required>
 
 
 
             <h2>API Documentation</h2>
                 <ul class="memberlist">
             <li>
-                    <a class="function" href="#activate_style">activate_style</a>
-            </li>
-            <li>
-                    <a class="function" href="#grid_off">grid_off</a>
-            </li>
-            <li>
-                    <a class="function" href="#grid_on">grid_on</a>
-            </li>
-            <li>
-                    <a class="function" href="#load_fonts">load_fonts</a>
+                    <a class="function" href="#show_modes">show_modes</a>
             </li>
     </ul>
 
 
 
         <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
             built with <span class="visually-hidden">pdoc</span><img
@@ -75,282 +66,168 @@
                 src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
         </a>
 </div>
     </nav>
     <main class="pdoc">
             <section class="module-info">
                     <h1 class="modulename">
-<a href="./../acgc.html">acgc</a><wbr>.figstyle    </h1>
-
-                        <div class="docstring"><p>Style settings for matplotlib, for publication-ready figures</p>
+<a href="./../acgc.html">acgc</a><wbr>.modetools    </h1>
 
-<p>Activate the style by importing this module:</p>
-
-<p><code>from acgc import figstyle</code></p>
-
-<p>Figures generated by Matplotlib will then use the new style.
-The style includes grid lines (horizontal and vertical) by default.
-Turn these off and on with <code><a href="#grid_off">grid_off</a></code> and <code><a href="#grid_on">grid_on</a></code>:</p>
-
-<p><code>figstyle.grid_off()</code></p>
-
-<p><code>figstyle.grid_on()</code></p>
+                        <div class="docstring"><p>Graphical display of eigenmodes</p>
 </div>
 
-                        <input id="mod-figstyle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
+                        <input id="mod-modetools-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
 
-                        <label class="view-source-button" for="mod-figstyle-view-source"><span>View Source</span></label>
+                        <label class="view-source-button" for="mod-modetools-view-source"><span>View Source</span></label>
 
                         <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="ch">#!/usr/bin/env python3</span>
-</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">&#39;&#39;&#39;Style settings for matplotlib, for publication-ready figures</span>
+</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">&#39;&#39;&#39;Graphical display of eigenmodes&#39;&#39;&#39;</span>
 </span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
-</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">Activate the style by importing this module:</span>
-</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>
-</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">`from acgc import figstyle`</span>
-</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>
-</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="sd">Figures generated by Matplotlib will then use the new style.</span>
-</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">The style includes grid lines (horizontal and vertical) by default.</span>
-</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="sd">Turn these off and on with `grid_off` and `grid_on`:</span>
-</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>
-</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">`figstyle.grid_off()`</span>
-</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>
-</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="sd">`figstyle.grid_on()`</span>
-</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">&#39;&#39;&#39;</span>
-</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>
-</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="kn">import</span> <span class="nn">os</span>
-</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="kn">import</span> <span class="nn">warnings</span>
-</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
-</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="kn">import</span> <span class="nn">matplotlib.style</span> <span class="k">as</span> <span class="nn">mstyle</span>
-</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">import</span> <span class="nn">matplotlib.font_manager</span> <span class="k">as</span> <span class="nn">mfonts</span>
-</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="k">if</span> <span class="s1">&#39;inline&#39;</span> <span class="ow">in</span> <span class="n">mpl</span><span class="o">.</span><span class="n">get_backend</span><span class="p">():</span>
-</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>    <span class="kn">import</span> <span class="nn">matplotlib_inline</span>
+</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
+</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
+</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>
+</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="k">def</span> <span class="nf">show_modes</span><span class="p">(</span> <span class="n">labels</span><span class="p">,</span> <span class="n">eigval</span><span class="p">,</span> <span class="n">eigvec</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
+</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Plot figure showing eigenmodes</span>
+</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">    </span>
+</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="sd">    This program assumes that all modes will be displayed, so it is expected that</span>
+</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">    len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes. </span>
+</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>
+</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">    Arguments</span>
+</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="sd">    ---------</span>
+</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">    labels : list, str</span>
+</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="sd">        names for the component variables decomposed into modes</span>
+</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="sd">    eigval : list or array, float</span>
+</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="sd">        eigenvalues</span>
+</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="sd">    eigvec : 2D array, float</span>
+</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="sd">        eigenvector matrix. Vectors should be the columns of eigvec</span>
+</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="sd">    ax : subplot axis (optional)</span>
+</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="sd">        location where graph will be displayed. If not provided, then a new axis will be created.        </span>
+</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="sd">    &#39;&#39;&#39;</span>
 </span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>
-</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="c1"># Path to this module</span>
-</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="n">_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
+</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="c1"># Number of modes</span>
+</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="n">nmodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span>
 </span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>
-</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="k">def</span> <span class="nf">activate_style</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridaxis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">):</span>
-</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Activate style sheet </span>
-</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="sd">    </span>
-</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a><span class="sd">    Parameters</span>
-</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="sd">    ----------</span>
-</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a><span class="sd">    grid : bool, default=True</span>
-</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="sd">        turn grid lines on (True) or off (False)</span>
-</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a><span class="sd">    gridaxis : str, default=&#39;both&#39;</span>
-</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a><span class="sd">        specifies which axes should have grid lines</span>
-</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="n">mstyle</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_PATH</span><span class="p">,</span><span class="s1">&#39;acgc.mplstyle&#39;</span><span class="p">))</span>
-</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>
-</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="c1"># Turn grid on or off</span>
-</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
-</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>        <span class="n">grid_on</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">gridaxis</span><span class="p">)</span>
-</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>
-</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="c1"># Use high quality for inline images; Only use this if the inline backend is active</span>
-</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="c1"># &#39;png&#39; is default, &#39;svg&#39; is also good</span>
-</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="k">if</span> <span class="s1">&#39;inline&#39;</span> <span class="ow">in</span> <span class="n">mpl</span><span class="o">.</span><span class="n">get_backend</span><span class="p">():</span>
-</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>        <span class="n">matplotlib_inline</span><span class="o">.</span><span class="n">backend_inline</span><span class="o">.</span><span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;retina&#39;</span><span class="p">)</span>
-</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>
-</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>
-</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a><span class="k">def</span> <span class="nf">grid_off</span><span class="p">():</span>
-</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Turn off grid lines&#39;&#39;&#39;</span>
-</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
-</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>
-</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a><span class="k">def</span> <span class="nf">grid_on</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">):</span>
-</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Turn on grid lines</span>
-</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a><span class="sd">    </span>
-</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a><span class="sd">    Parameters</span>
-</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a><span class="sd">    ----------</span>
-</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a><span class="sd">    axis : {&#39;both&#39;, &#39;x&#39;, &#39;y&#39;}</span>
-</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a><span class="sd">        specifies which axes should have grid lines </span>
-</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
-</span><span id="L-63"><a href="#L-63"><span class="linenos">63</span></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid.axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis</span>
-</span><span id="L-64"><a href="#L-64"><span class="linenos">64</span></a>
-</span><span id="L-65"><a href="#L-65"><span class="linenos">65</span></a><span class="k">def</span> <span class="nf">load_fonts</span><span class="p">():</span>
-</span><span id="L-66"><a href="#L-66"><span class="linenos">66</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Load fonts contained in the acgc/fonts subdirectory&#39;&#39;&#39;</span>
-</span><span id="L-67"><a href="#L-67"><span class="linenos">67</span></a>
-</span><span id="L-68"><a href="#L-68"><span class="linenos">68</span></a>    <span class="c1"># User fonts</span>
-</span><span id="L-69"><a href="#L-69"><span class="linenos">69</span></a>    <span class="n">fonts_pylib</span> <span class="o">=</span> <span class="n">mfonts</span><span class="o">.</span><span class="n">findSystemFonts</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_PATH</span><span class="p">,</span><span class="s1">&#39;fonts&#39;</span><span class="p">))</span>
-</span><span id="L-70"><a href="#L-70"><span class="linenos">70</span></a>
-</span><span id="L-71"><a href="#L-71"><span class="linenos">71</span></a>    <span class="c1"># Cached fonts</span>
-</span><span id="L-72"><a href="#L-72"><span class="linenos">72</span></a>    <span class="n">fonts_cached</span> <span class="o">=</span> <span class="n">mfonts</span><span class="o">.</span><span class="n">fontManager</span><span class="o">.</span><span class="n">ttflist</span>
-</span><span id="L-73"><a href="#L-73"><span class="linenos">73</span></a>    <span class="n">fonts_cached_paths</span> <span class="o">=</span> <span class="p">[</span> <span class="n">font</span><span class="o">.</span><span class="n">fname</span> <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts_cached</span> <span class="p">]</span>
-</span><span id="L-74"><a href="#L-74"><span class="linenos">74</span></a>
-</span><span id="L-75"><a href="#L-75"><span class="linenos">75</span></a>    <span class="c1"># Add fonts that aren&#39;t already installed</span>
-</span><span id="L-76"><a href="#L-76"><span class="linenos">76</span></a>    <span class="n">rebuild</span> <span class="o">=</span> <span class="kc">False</span>
-</span><span id="L-77"><a href="#L-77"><span class="linenos">77</span></a>    <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts_pylib</span><span class="p">:</span>
-</span><span id="L-78"><a href="#L-78"><span class="linenos">78</span></a>        <span class="k">if</span> <span class="n">font</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fonts_cached_paths</span><span class="p">:</span>
-</span><span id="L-79"><a href="#L-79"><span class="linenos">79</span></a>            <span class="k">if</span> <span class="n">rebuild</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
-</span><span id="L-80"><a href="#L-80"><span class="linenos">80</span></a>                <span class="c1"># Issue warning, first time only</span>
-</span><span id="L-81"><a href="#L-81"><span class="linenos">81</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Rebuilding font cache. This can take time.&#39;</span><span class="p">)</span>
-</span><span id="L-82"><a href="#L-82"><span class="linenos">82</span></a>            <span class="n">rebuild</span> <span class="o">=</span> <span class="kc">True</span>    
-</span><span id="L-83"><a href="#L-83"><span class="linenos">83</span></a>            <span class="n">mfonts</span><span class="o">.</span><span class="n">fontManager</span><span class="o">.</span><span class="n">addfont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
-</span><span id="L-84"><a href="#L-84"><span class="linenos">84</span></a>
-</span><span id="L-85"><a href="#L-85"><span class="linenos">85</span></a>    <span class="c1"># Save font cache</span>
-</span><span id="L-86"><a href="#L-86"><span class="linenos">86</span></a>    <span class="k">if</span> <span class="n">rebuild</span><span class="p">:</span>
-</span><span id="L-87"><a href="#L-87"><span class="linenos">87</span></a>        <span class="n">cache</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
-</span><span id="L-88"><a href="#L-88"><span class="linenos">88</span></a>                        <span class="n">mpl</span><span class="o">.</span><span class="n">get_cachedir</span><span class="p">(),</span>
-</span><span id="L-89"><a href="#L-89"><span class="linenos">89</span></a>                        <span class="sa">f</span><span class="s1">&#39;fontlist-v</span><span class="si">{</span><span class="n">mfonts</span><span class="o">.</span><span class="n">FontManager</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s1">.json&#39;</span>
-</span><span id="L-90"><a href="#L-90"><span class="linenos">90</span></a>                    <span class="p">)</span>
-</span><span id="L-91"><a href="#L-91"><span class="linenos">91</span></a>        <span class="n">mfonts</span><span class="o">.</span><span class="n">json_dump</span><span class="p">(</span><span class="n">mfonts</span><span class="o">.</span><span class="n">fontManager</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
-</span><span id="L-92"><a href="#L-92"><span class="linenos">92</span></a>
-</span><span id="L-93"><a href="#L-93"><span class="linenos">93</span></a><span class="c1">###</span>
-</span><span id="L-94"><a href="#L-94"><span class="linenos">94</span></a><span class="n">load_fonts</span><span class="p">()</span>
-</span><span id="L-95"><a href="#L-95"><span class="linenos">95</span></a><span class="n">activate_style</span><span class="p">()</span>
+</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="c1"># Ensure number of labels equals number of modes</span>
+</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">nmodes</span><span class="p">:</span>
+</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Provide one label per eigenmode&#39;</span><span class="p">)</span>
+</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>
+</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="c1"># Create new axis if one is not passed</span>
+</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
+</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>
+</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="c1"># Sort the modes from largest to smallest eigenvalue</span>
+</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span> <span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="n">eigval</span> <span class="o">=</span> <span class="n">eigval</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
+</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="n">eigvec</span> <span class="o">=</span> <span class="n">eigvec</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span>
+</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>
+</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="c1"># Plot the modes</span>
+</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmodes</span><span class="p">):</span>
+</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>        <span class="c1"># Vertical gray line for reference</span>
+</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">nmodes</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
+</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>        <span class="c1"># Plot mode i</span>
+</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eigvec</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">),</span> <span class="s1">&#39;o-&#39;</span> <span class="p">)</span>
+</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>
+</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="c1"># xaxis labels</span>
+</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="n">xlabel</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;</span><span class="si">{:#.2g}</span><span class="se">\n</span><span class="s1">(</span><span class="si">{:#.2g}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eigval</span><span class="p">]</span>
+</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>
+</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>    <span class="c1"># Set ticks and labels</span>
+</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">),</span>
+</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>            <span class="n">yticklabels</span><span class="o">=</span><span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
+</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
+</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>            <span class="n">xticklabels</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
+</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Reservoir&#39;</span><span class="p">,</span>
+</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Modes: Eigenvalue</span><span class="se">\n</span><span class="s1">(Time scale)&#39;</span><span class="p">)</span>
+</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>
+</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
 </span></pre></div>
 
 
             </section>
-                <section id="activate_style">
-                            <input id="activate_style-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
+                <section id="show_modes">
+                            <input id="show_modes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
 <div class="attr function">
             
         <span class="def">def</span>
-        <span class="name">activate_style</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">grid</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">gridaxis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span></span><span class="return-annotation">):</span></span>
+        <span class="name">show_modes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">labels</span>, </span><span class="param"><span class="n">eigval</span>, </span><span class="param"><span class="n">eigvec</span>, </span><span class="param"><span class="n">ax</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>
 
-                <label class="view-source-button" for="activate_style-view-source"><span>View Source</span></label>
+                <label class="view-source-button" for="show_modes-view-source"><span>View Source</span></label>
 
     </div>
-    <a class="headerlink" href="#activate_style"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="activate_style-29"><a href="#activate_style-29"><span class="linenos">29</span></a><span class="k">def</span> <span class="nf">activate_style</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gridaxis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">):</span>
-</span><span id="activate_style-30"><a href="#activate_style-30"><span class="linenos">30</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Activate style sheet </span>
-</span><span id="activate_style-31"><a href="#activate_style-31"><span class="linenos">31</span></a><span class="sd">    </span>
-</span><span id="activate_style-32"><a href="#activate_style-32"><span class="linenos">32</span></a><span class="sd">    Parameters</span>
-</span><span id="activate_style-33"><a href="#activate_style-33"><span class="linenos">33</span></a><span class="sd">    ----------</span>
-</span><span id="activate_style-34"><a href="#activate_style-34"><span class="linenos">34</span></a><span class="sd">    grid : bool, default=True</span>
-</span><span id="activate_style-35"><a href="#activate_style-35"><span class="linenos">35</span></a><span class="sd">        turn grid lines on (True) or off (False)</span>
-</span><span id="activate_style-36"><a href="#activate_style-36"><span class="linenos">36</span></a><span class="sd">    gridaxis : str, default=&#39;both&#39;</span>
-</span><span id="activate_style-37"><a href="#activate_style-37"><span class="linenos">37</span></a><span class="sd">        specifies which axes should have grid lines</span>
-</span><span id="activate_style-38"><a href="#activate_style-38"><span class="linenos">38</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="activate_style-39"><a href="#activate_style-39"><span class="linenos">39</span></a>    <span class="n">mstyle</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_PATH</span><span class="p">,</span><span class="s1">&#39;acgc.mplstyle&#39;</span><span class="p">))</span>
-</span><span id="activate_style-40"><a href="#activate_style-40"><span class="linenos">40</span></a>
-</span><span id="activate_style-41"><a href="#activate_style-41"><span class="linenos">41</span></a>    <span class="c1"># Turn grid on or off</span>
-</span><span id="activate_style-42"><a href="#activate_style-42"><span class="linenos">42</span></a>    <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
-</span><span id="activate_style-43"><a href="#activate_style-43"><span class="linenos">43</span></a>        <span class="n">grid_on</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">gridaxis</span><span class="p">)</span>
-</span><span id="activate_style-44"><a href="#activate_style-44"><span class="linenos">44</span></a>
-</span><span id="activate_style-45"><a href="#activate_style-45"><span class="linenos">45</span></a>    <span class="c1"># Use high quality for inline images; Only use this if the inline backend is active</span>
-</span><span id="activate_style-46"><a href="#activate_style-46"><span class="linenos">46</span></a>    <span class="c1"># &#39;png&#39; is default, &#39;svg&#39; is also good</span>
-</span><span id="activate_style-47"><a href="#activate_style-47"><span class="linenos">47</span></a>    <span class="k">if</span> <span class="s1">&#39;inline&#39;</span> <span class="ow">in</span> <span class="n">mpl</span><span class="o">.</span><span class="n">get_backend</span><span class="p">():</span>
-</span><span id="activate_style-48"><a href="#activate_style-48"><span class="linenos">48</span></a>        <span class="n">matplotlib_inline</span><span class="o">.</span><span class="n">backend_inline</span><span class="o">.</span><span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;retina&#39;</span><span class="p">)</span>
+    <a class="headerlink" href="#show_modes"></a>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="show_modes-8"><a href="#show_modes-8"><span class="linenos"> 8</span></a><span class="k">def</span> <span class="nf">show_modes</span><span class="p">(</span> <span class="n">labels</span><span class="p">,</span> <span class="n">eigval</span><span class="p">,</span> <span class="n">eigvec</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
+</span><span id="show_modes-9"><a href="#show_modes-9"><span class="linenos"> 9</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Plot figure showing eigenmodes</span>
+</span><span id="show_modes-10"><a href="#show_modes-10"><span class="linenos">10</span></a><span class="sd">    </span>
+</span><span id="show_modes-11"><a href="#show_modes-11"><span class="linenos">11</span></a><span class="sd">    This program assumes that all modes will be displayed, so it is expected that</span>
+</span><span id="show_modes-12"><a href="#show_modes-12"><span class="linenos">12</span></a><span class="sd">    len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes. </span>
+</span><span id="show_modes-13"><a href="#show_modes-13"><span class="linenos">13</span></a>
+</span><span id="show_modes-14"><a href="#show_modes-14"><span class="linenos">14</span></a><span class="sd">    Arguments</span>
+</span><span id="show_modes-15"><a href="#show_modes-15"><span class="linenos">15</span></a><span class="sd">    ---------</span>
+</span><span id="show_modes-16"><a href="#show_modes-16"><span class="linenos">16</span></a><span class="sd">    labels : list, str</span>
+</span><span id="show_modes-17"><a href="#show_modes-17"><span class="linenos">17</span></a><span class="sd">        names for the component variables decomposed into modes</span>
+</span><span id="show_modes-18"><a href="#show_modes-18"><span class="linenos">18</span></a><span class="sd">    eigval : list or array, float</span>
+</span><span id="show_modes-19"><a href="#show_modes-19"><span class="linenos">19</span></a><span class="sd">        eigenvalues</span>
+</span><span id="show_modes-20"><a href="#show_modes-20"><span class="linenos">20</span></a><span class="sd">    eigvec : 2D array, float</span>
+</span><span id="show_modes-21"><a href="#show_modes-21"><span class="linenos">21</span></a><span class="sd">        eigenvector matrix. Vectors should be the columns of eigvec</span>
+</span><span id="show_modes-22"><a href="#show_modes-22"><span class="linenos">22</span></a><span class="sd">    ax : subplot axis (optional)</span>
+</span><span id="show_modes-23"><a href="#show_modes-23"><span class="linenos">23</span></a><span class="sd">        location where graph will be displayed. If not provided, then a new axis will be created.        </span>
+</span><span id="show_modes-24"><a href="#show_modes-24"><span class="linenos">24</span></a><span class="sd">    &#39;&#39;&#39;</span>
+</span><span id="show_modes-25"><a href="#show_modes-25"><span class="linenos">25</span></a>
+</span><span id="show_modes-26"><a href="#show_modes-26"><span class="linenos">26</span></a>    <span class="c1"># Number of modes</span>
+</span><span id="show_modes-27"><a href="#show_modes-27"><span class="linenos">27</span></a>    <span class="n">nmodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span>
+</span><span id="show_modes-28"><a href="#show_modes-28"><span class="linenos">28</span></a>
+</span><span id="show_modes-29"><a href="#show_modes-29"><span class="linenos">29</span></a>    <span class="c1"># Ensure number of labels equals number of modes</span>
+</span><span id="show_modes-30"><a href="#show_modes-30"><span class="linenos">30</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">nmodes</span><span class="p">:</span>
+</span><span id="show_modes-31"><a href="#show_modes-31"><span class="linenos">31</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Provide one label per eigenmode&#39;</span><span class="p">)</span>
+</span><span id="show_modes-32"><a href="#show_modes-32"><span class="linenos">32</span></a>
+</span><span id="show_modes-33"><a href="#show_modes-33"><span class="linenos">33</span></a>    <span class="c1"># Create new axis if one is not passed</span>
+</span><span id="show_modes-34"><a href="#show_modes-34"><span class="linenos">34</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="show_modes-35"><a href="#show_modes-35"><span class="linenos">35</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
+</span><span id="show_modes-36"><a href="#show_modes-36"><span class="linenos">36</span></a>
+</span><span id="show_modes-37"><a href="#show_modes-37"><span class="linenos">37</span></a>    <span class="c1"># Sort the modes from largest to smallest eigenvalue</span>
+</span><span id="show_modes-38"><a href="#show_modes-38"><span class="linenos">38</span></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span> <span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="show_modes-39"><a href="#show_modes-39"><span class="linenos">39</span></a>    <span class="n">eigval</span> <span class="o">=</span> <span class="n">eigval</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
+</span><span id="show_modes-40"><a href="#show_modes-40"><span class="linenos">40</span></a>    <span class="n">eigvec</span> <span class="o">=</span> <span class="n">eigvec</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span>
+</span><span id="show_modes-41"><a href="#show_modes-41"><span class="linenos">41</span></a>
+</span><span id="show_modes-42"><a href="#show_modes-42"><span class="linenos">42</span></a>    <span class="c1"># Plot the modes</span>
+</span><span id="show_modes-43"><a href="#show_modes-43"><span class="linenos">43</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmodes</span><span class="p">):</span>
+</span><span id="show_modes-44"><a href="#show_modes-44"><span class="linenos">44</span></a>        <span class="c1"># Vertical gray line for reference</span>
+</span><span id="show_modes-45"><a href="#show_modes-45"><span class="linenos">45</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">nmodes</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
+</span><span id="show_modes-46"><a href="#show_modes-46"><span class="linenos">46</span></a>        <span class="c1"># Plot mode i</span>
+</span><span id="show_modes-47"><a href="#show_modes-47"><span class="linenos">47</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eigvec</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">),</span> <span class="s1">&#39;o-&#39;</span> <span class="p">)</span>
+</span><span id="show_modes-48"><a href="#show_modes-48"><span class="linenos">48</span></a>
+</span><span id="show_modes-49"><a href="#show_modes-49"><span class="linenos">49</span></a>    <span class="c1"># xaxis labels</span>
+</span><span id="show_modes-50"><a href="#show_modes-50"><span class="linenos">50</span></a>    <span class="n">xlabel</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;</span><span class="si">{:#.2g}</span><span class="se">\n</span><span class="s1">(</span><span class="si">{:#.2g}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eigval</span><span class="p">]</span>
+</span><span id="show_modes-51"><a href="#show_modes-51"><span class="linenos">51</span></a>
+</span><span id="show_modes-52"><a href="#show_modes-52"><span class="linenos">52</span></a>    <span class="c1"># Set ticks and labels</span>
+</span><span id="show_modes-53"><a href="#show_modes-53"><span class="linenos">53</span></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">),</span>
+</span><span id="show_modes-54"><a href="#show_modes-54"><span class="linenos">54</span></a>            <span class="n">yticklabels</span><span class="o">=</span><span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
+</span><span id="show_modes-55"><a href="#show_modes-55"><span class="linenos">55</span></a>            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
+</span><span id="show_modes-56"><a href="#show_modes-56"><span class="linenos">56</span></a>            <span class="n">xticklabels</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
+</span><span id="show_modes-57"><a href="#show_modes-57"><span class="linenos">57</span></a>            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Reservoir&#39;</span><span class="p">,</span>
+</span><span id="show_modes-58"><a href="#show_modes-58"><span class="linenos">58</span></a>            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Modes: Eigenvalue</span><span class="se">\n</span><span class="s1">(Time scale)&#39;</span><span class="p">)</span>
+</span><span id="show_modes-59"><a href="#show_modes-59"><span class="linenos">59</span></a>
+</span><span id="show_modes-60"><a href="#show_modes-60"><span class="linenos">60</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
 </span></pre></div>
 
 
-            <div class="docstring"><p>Activate style sheet </p>
-
-<h6 id="parameters">Parameters</h6>
-
-<ul>
-<li><strong>grid</strong> (bool, default=True):
-turn grid lines on (True) or off (False)</li>
-<li><strong>gridaxis</strong> (str, default='both'):
-specifies which axes should have grid lines</li>
-</ul>
-</div>
-
-
-                </section>
-                <section id="grid_off">
-                            <input id="grid_off-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
-<div class="attr function">
-            
-        <span class="def">def</span>
-        <span class="name">grid_off</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>
+            <div class="docstring"><p>Plot figure showing eigenmodes</p>
 
-                <label class="view-source-button" for="grid_off-view-source"><span>View Source</span></label>
-
-    </div>
-    <a class="headerlink" href="#grid_off"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="grid_off-51"><a href="#grid_off-51"><span class="linenos">51</span></a><span class="k">def</span> <span class="nf">grid_off</span><span class="p">():</span>
-</span><span id="grid_off-52"><a href="#grid_off-52"><span class="linenos">52</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Turn off grid lines&#39;&#39;&#39;</span>
-</span><span id="grid_off-53"><a href="#grid_off-53"><span class="linenos">53</span></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
-</span></pre></div>
-
-
-            <div class="docstring"><p>Turn off grid lines</p>
-</div>
-
-
-                </section>
-                <section id="grid_on">
-                            <input id="grid_on-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
-<div class="attr function">
-            
-        <span class="def">def</span>
-        <span class="name">grid_on</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span></span><span class="return-annotation">):</span></span>
-
-                <label class="view-source-button" for="grid_on-view-source"><span>View Source</span></label>
-
-    </div>
-    <a class="headerlink" href="#grid_on"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="grid_on-55"><a href="#grid_on-55"><span class="linenos">55</span></a><span class="k">def</span> <span class="nf">grid_on</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">):</span>
-</span><span id="grid_on-56"><a href="#grid_on-56"><span class="linenos">56</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Turn on grid lines</span>
-</span><span id="grid_on-57"><a href="#grid_on-57"><span class="linenos">57</span></a><span class="sd">    </span>
-</span><span id="grid_on-58"><a href="#grid_on-58"><span class="linenos">58</span></a><span class="sd">    Parameters</span>
-</span><span id="grid_on-59"><a href="#grid_on-59"><span class="linenos">59</span></a><span class="sd">    ----------</span>
-</span><span id="grid_on-60"><a href="#grid_on-60"><span class="linenos">60</span></a><span class="sd">    axis : {&#39;both&#39;, &#39;x&#39;, &#39;y&#39;}</span>
-</span><span id="grid_on-61"><a href="#grid_on-61"><span class="linenos">61</span></a><span class="sd">        specifies which axes should have grid lines </span>
-</span><span id="grid_on-62"><a href="#grid_on-62"><span class="linenos">62</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="grid_on-63"><a href="#grid_on-63"><span class="linenos">63</span></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
-</span><span id="grid_on-64"><a href="#grid_on-64"><span class="linenos">64</span></a>    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid.axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis</span>
-</span></pre></div>
-
-
-            <div class="docstring"><p>Turn on grid lines</p>
-
-<h6 id="parameters">Parameters</h6>
-
-<ul>
-<li><strong>axis</strong> ({'both', 'x', 'y'}):
-specifies which axes should have grid lines</li>
-</ul>
-</div>
-
-
-                </section>
-                <section id="load_fonts">
-                            <input id="load_fonts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
-<div class="attr function">
-            
-        <span class="def">def</span>
-        <span class="name">load_fonts</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>
-
-                <label class="view-source-button" for="load_fonts-view-source"><span>View Source</span></label>
-
-    </div>
-    <a class="headerlink" href="#load_fonts"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="load_fonts-66"><a href="#load_fonts-66"><span class="linenos">66</span></a><span class="k">def</span> <span class="nf">load_fonts</span><span class="p">():</span>
-</span><span id="load_fonts-67"><a href="#load_fonts-67"><span class="linenos">67</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Load fonts contained in the acgc/fonts subdirectory&#39;&#39;&#39;</span>
-</span><span id="load_fonts-68"><a href="#load_fonts-68"><span class="linenos">68</span></a>
-</span><span id="load_fonts-69"><a href="#load_fonts-69"><span class="linenos">69</span></a>    <span class="c1"># User fonts</span>
-</span><span id="load_fonts-70"><a href="#load_fonts-70"><span class="linenos">70</span></a>    <span class="n">fonts_pylib</span> <span class="o">=</span> <span class="n">mfonts</span><span class="o">.</span><span class="n">findSystemFonts</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_PATH</span><span class="p">,</span><span class="s1">&#39;fonts&#39;</span><span class="p">))</span>
-</span><span id="load_fonts-71"><a href="#load_fonts-71"><span class="linenos">71</span></a>
-</span><span id="load_fonts-72"><a href="#load_fonts-72"><span class="linenos">72</span></a>    <span class="c1"># Cached fonts</span>
-</span><span id="load_fonts-73"><a href="#load_fonts-73"><span class="linenos">73</span></a>    <span class="n">fonts_cached</span> <span class="o">=</span> <span class="n">mfonts</span><span class="o">.</span><span class="n">fontManager</span><span class="o">.</span><span class="n">ttflist</span>
-</span><span id="load_fonts-74"><a href="#load_fonts-74"><span class="linenos">74</span></a>    <span class="n">fonts_cached_paths</span> <span class="o">=</span> <span class="p">[</span> <span class="n">font</span><span class="o">.</span><span class="n">fname</span> <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts_cached</span> <span class="p">]</span>
-</span><span id="load_fonts-75"><a href="#load_fonts-75"><span class="linenos">75</span></a>
-</span><span id="load_fonts-76"><a href="#load_fonts-76"><span class="linenos">76</span></a>    <span class="c1"># Add fonts that aren&#39;t already installed</span>
-</span><span id="load_fonts-77"><a href="#load_fonts-77"><span class="linenos">77</span></a>    <span class="n">rebuild</span> <span class="o">=</span> <span class="kc">False</span>
-</span><span id="load_fonts-78"><a href="#load_fonts-78"><span class="linenos">78</span></a>    <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts_pylib</span><span class="p">:</span>
-</span><span id="load_fonts-79"><a href="#load_fonts-79"><span class="linenos">79</span></a>        <span class="k">if</span> <span class="n">font</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fonts_cached_paths</span><span class="p">:</span>
-</span><span id="load_fonts-80"><a href="#load_fonts-80"><span class="linenos">80</span></a>            <span class="k">if</span> <span class="n">rebuild</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
-</span><span id="load_fonts-81"><a href="#load_fonts-81"><span class="linenos">81</span></a>                <span class="c1"># Issue warning, first time only</span>
-</span><span id="load_fonts-82"><a href="#load_fonts-82"><span class="linenos">82</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Rebuilding font cache. This can take time.&#39;</span><span class="p">)</span>
-</span><span id="load_fonts-83"><a href="#load_fonts-83"><span class="linenos">83</span></a>            <span class="n">rebuild</span> <span class="o">=</span> <span class="kc">True</span>    
-</span><span id="load_fonts-84"><a href="#load_fonts-84"><span class="linenos">84</span></a>            <span class="n">mfonts</span><span class="o">.</span><span class="n">fontManager</span><span class="o">.</span><span class="n">addfont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
-</span><span id="load_fonts-85"><a href="#load_fonts-85"><span class="linenos">85</span></a>
-</span><span id="load_fonts-86"><a href="#load_fonts-86"><span class="linenos">86</span></a>    <span class="c1"># Save font cache</span>
-</span><span id="load_fonts-87"><a href="#load_fonts-87"><span class="linenos">87</span></a>    <span class="k">if</span> <span class="n">rebuild</span><span class="p">:</span>
-</span><span id="load_fonts-88"><a href="#load_fonts-88"><span class="linenos">88</span></a>        <span class="n">cache</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
-</span><span id="load_fonts-89"><a href="#load_fonts-89"><span class="linenos">89</span></a>                        <span class="n">mpl</span><span class="o">.</span><span class="n">get_cachedir</span><span class="p">(),</span>
-</span><span id="load_fonts-90"><a href="#load_fonts-90"><span class="linenos">90</span></a>                        <span class="sa">f</span><span class="s1">&#39;fontlist-v</span><span class="si">{</span><span class="n">mfonts</span><span class="o">.</span><span class="n">FontManager</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s1">.json&#39;</span>
-</span><span id="load_fonts-91"><a href="#load_fonts-91"><span class="linenos">91</span></a>                    <span class="p">)</span>
-</span><span id="load_fonts-92"><a href="#load_fonts-92"><span class="linenos">92</span></a>        <span class="n">mfonts</span><span class="o">.</span><span class="n">json_dump</span><span class="p">(</span><span class="n">mfonts</span><span class="o">.</span><span class="n">fontManager</span><span class="p">,</span> <span class="n">cache</span><span class="p">)</span>
-</span></pre></div>
+<p>This program assumes that all modes will be displayed, so it is expected that
+len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes. </p>
 
+<h6 id="arguments">Arguments</h6>
 
-            <div class="docstring"><p>Load fonts contained in the acgc/fonts subdirectory</p>
+<p>labels : list, str
+    names for the component variables decomposed into modes
+eigval : list or array, float
+    eigenvalues
+eigvec : 2D array, float
+    eigenvector matrix. Vectors should be the columns of eigvec
+ax : subplot axis (optional)
+    location where graph will be displayed. If not provided, then a new axis will be created.</p>
 </div>
 
 
                 </section>
     </main>
 <script>
     function escapeHTML(html) {
```

#### html2text {}

```diff
@@ -1,193 +1,135 @@
 ??
 _ _a_c_g_c[project logo][Unknown INPUT type]
 ********** AAPPII DDooccuummeennttaattiioonn **********
-    * _a_c_t_i_v_a_t_e___s_t_y_l_e
-    * _g_r_i_d___o_f_f
-    * _g_r_i_d___o_n
-    * _l_o_a_d___f_o_n_t_s
+    * _s_h_o_w___m_o_d_e_s
 _b_u_i_l_t_ _w_i_t_h_ _p_d_o_c_[_p_d_o_c_ _l_o_g_o_]
-************ _aa_cc_gg_cc..ffiiggssttyyllee ************
-Style settings for matplotlib, for publication-ready figures
-Activate the style by importing this module:
-from acgc import figstyle
-Figures generated by Matplotlib will then use the new style. The style includes
-grid lines (horizontal and vertical) by default. Turn these off and on with
-_g_r_i_d___o_f_f and _g_r_i_d___o_n:
-figstyle.grid_off()
-figstyle.grid_on()
+************ _aa_cc_gg_cc..mmooddeettoooollss ************
+Graphical display of eigenmodes
 ??View Source
 _ _1#!/usr/bin/env python3
-_ _2'''Style settings for matplotlib, for publication-ready figures
+_ _2'''Graphical display of eigenmodes'''
 _ _3
-_ _4Activate the style by importing this module:
-_ _5
-_ _6`from acgc import figstyle`
-_ _7
-_ _8Figures generated by Matplotlib will then use the new style.
-_ _9The style includes grid lines (horizontal and vertical) by default.
-_1_0Turn these off and on with `grid_off` and `grid_on`:
-_1_1
-_1_2`figstyle.grid_off()`
-_1_3
-_1_4`figstyle.grid_on()`
-_1_5'''
-_1_6
-_1_7import os
-_1_8import warnings
-_1_9import matplotlib as mpl
-_2_0import matplotlib.style as mstyle
-_2_1import matplotlib.font_manager as mfonts
-_2_2if 'inline' in mpl.get_backend():
-_2_3    import matplotlib_inline
+_ _4import numpy as np
+_ _5import matplotlib.pyplot as plt
+_ _6
+_ _7def show_modes( labels, eigval, eigvec, ax=None ):
+_ _8    '''Plot figure showing eigenmodes
+_ _9
+_1_0    This program assumes that all modes will be displayed, so it is expected
+that
+_1_1    len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes.
+_1_2
+_1_3    Arguments
+_1_4    ---------
+_1_5    labels : list, str
+_1_6        names for the component variables decomposed into modes
+_1_7    eigval : list or array, float
+_1_8        eigenvalues
+_1_9    eigvec : 2D array, float
+_2_0        eigenvector matrix. Vectors should be the columns of eigvec
+_2_1    ax : subplot axis (optional)
+_2_2        location where graph will be displayed. If not provided, then a new
+axis will be created.
+_2_3    '''
 _2_4
-_2_5# Path to this module
-_2_6_PATH = os.path.dirname(__file__)
+_2_5    # Number of modes
+_2_6    nmodes = len(eigval)
 _2_7
-_2_8def activate_style(grid=True,gridaxis='both'):
-_2_9    '''Activate style sheet
-_3_0
-_3_1    Parameters
-_3_2    ----------
-_3_3    grid : bool, default=True
-_3_4        turn grid lines on (True) or off (False)
-_3_5    gridaxis : str, default='both'
-_3_6        specifies which axes should have grid lines
-_3_7    '''
-_3_8    mstyle.use(os.path.join(_PATH,'acgc.mplstyle'))
-_3_9
-_4_0    # Turn grid on or off
-_4_1    if grid:
-_4_2        grid_on(axis=gridaxis)
-_4_3
-_4_4    # Use high quality for inline images; Only use this if the inline backend
-is active
-_4_5    # 'png' is default, 'svg' is also good
-_4_6    if 'inline' in mpl.get_backend():
-_4_7        matplotlib_inline.backend_inline.set_matplotlib_formats('retina')
-_4_8
-_4_9
-_5_0def grid_off():
-_5_1    '''Turn off grid lines'''
-_5_2    mpl.rcParams['axes.grid'] = False
-_5_3
-_5_4def grid_on(axis='both'):
-_5_5    '''Turn on grid lines
-_5_6
-_5_7    Parameters
-_5_8    ----------
-_5_9    axis : {'both', 'x', 'y'}
-_6_0        specifies which axes should have grid lines
-_6_1    '''
-_6_2    mpl.rcParams['axes.grid'] = True
-_6_3    mpl.rcParams['axes.grid.axis'] = axis
-_6_4
-_6_5def load_fonts():
-_6_6    '''Load fonts contained in the acgc/fonts subdirectory'''
-_6_7
-_6_8    # User fonts
-_6_9    fonts_pylib = mfonts.findSystemFonts(os.path.join(_PATH,'fonts'))
-_7_0
-_7_1    # Cached fonts
-_7_2    fonts_cached = mfonts.fontManager.ttflist
-_7_3    fonts_cached_paths = [ font.fname for font in fonts_cached ]
-_7_4
-_7_5    # Add fonts that aren't already installed
-_7_6    rebuild = False
-_7_7    for font in fonts_pylib:
-_7_8        if font not in fonts_cached_paths:
-_7_9            if rebuild == False:
-_8_0                # Issue warning, first time only
-_8_1                warnings.warn('Rebuilding font cache. This can take time.')
-_8_2            rebuild = True
-_8_3            mfonts.fontManager.addfont(font)
-_8_4
-_8_5    # Save font cache
-_8_6    if rebuild:
-_8_7        cache = os.path.join(
-_8_8                        mpl.get_cachedir(),
-_8_9                        f'fontlist-v{mfonts.FontManager.__version__}.json'
-_9_0                    )
-_9_1        mfonts.json_dump(mfonts.fontManager, cache)
-_9_2
-_9_3###
-_9_4load_fonts()
-_9_5activate_style()
-??
-def activate_style(grid=True, gridaxis='both'): View Source
-_2_9def activate_style(grid=True,gridaxis='both'):
-_3_0    '''Activate style sheet
+_2_8    # Ensure number of labels equals number of modes
+_2_9    if len(labels) != nmodes:
+_3_0        raise ValueError( 'Provide one label per eigenmode')
 _3_1
-_3_2    Parameters
-_3_3    ----------
-_3_4    grid : bool, default=True
-_3_5        turn grid lines on (True) or off (False)
-_3_6    gridaxis : str, default='both'
-_3_7        specifies which axes should have grid lines
-_3_8    '''
-_3_9    mstyle.use(os.path.join(_PATH,'acgc.mplstyle'))
+_3_2    # Create new axis if one is not passed
+_3_3    if ax is None:
+_3_4        ax = plt.axes()
+_3_5
+_3_6    # Sort the modes from largest to smallest eigenvalue
+_3_7    idx = np.argsort( np.abs(eigval) )[::-1]
+_3_8    eigval = eigval[idx]
+_3_9    eigvec = eigvec[:,idx]
 _4_0
-_4_1    # Turn grid on or off
-_4_2    if grid:
-_4_3        grid_on(axis=gridaxis)
-_4_4
-_4_5    # Use high quality for inline images; Only use this if the inline backend
-is active
-_4_6    # 'png' is default, 'svg' is also good
-_4_7    if 'inline' in mpl.get_backend():
-_4_8        matplotlib_inline.backend_inline.set_matplotlib_formats('retina')
-Activate style sheet
-** PPaarraammeetteerrss **
-    * ggrriidd (bool, default=True): turn grid lines on (True) or off (False)
-    * ggrriiddaaxxiiss (str, default='both'): specifies which axes should have grid
-      lines
-??
-def grid_off(): View Source
-_5_1def grid_off():
-_5_2    '''Turn off grid lines'''
-_5_3    mpl.rcParams['axes.grid'] = False
-Turn off grid lines
+_4_1    # Plot the modes
+_4_2    for i in range(nmodes):
+_4_3        # Vertical gray line for reference
+_4_4        ax.plot( [i*2,i*2], [0,nmodes-1], color='gray')
+_4_5        # Plot mode i
+_4_6        ax.plot( i*2 + eigvec[::-1,i],  np.arange(nmodes), 'o-' )
+_4_7
+_4_8    # xaxis labels
+_4_9    xlabel = [ '{:#.2g}\n({:#.2g})'.format(x,np.abs(1/x)) for x in eigval]
+_5_0
+_5_1    # Set ticks and labels
+_5_2    ax.set( yticks=np.arange(nmodes),
+_5_3            yticklabels=labels[::-1],
+_5_4            xticks=np.arange(nmodes)*2,
+_5_5            xticklabels=xlabel,
+_5_6            ylabel='Reservoir',
+_5_7            xlabel='Modes: Eigenvalue\n(Time scale)')
+_5_8
+_5_9    plt.tight_layout()
 ??
-def grid_on(axis='both'): View Source
-_5_5def grid_on(axis='both'):
-_5_6    '''Turn on grid lines
-_5_7
-_5_8    Parameters
-_5_9    ----------
-_6_0    axis : {'both', 'x', 'y'}
-_6_1        specifies which axes should have grid lines
-_6_2    '''
-_6_3    mpl.rcParams['axes.grid'] = True
-_6_4    mpl.rcParams['axes.grid.axis'] = axis
-Turn on grid lines
-** PPaarraammeetteerrss **
-    * aaxxiiss ({'both', 'x', 'y'}): specifies which axes should have grid lines
-??
-def load_fonts(): View Source
-_6_6def load_fonts():
-_6_7    '''Load fonts contained in the acgc/fonts subdirectory'''
-_6_8
-_6_9    # User fonts
-_7_0    fonts_pylib = mfonts.findSystemFonts(os.path.join(_PATH,'fonts'))
-_7_1
-_7_2    # Cached fonts
-_7_3    fonts_cached = mfonts.fontManager.ttflist
-_7_4    fonts_cached_paths = [ font.fname for font in fonts_cached ]
-_7_5
-_7_6    # Add fonts that aren't already installed
-_7_7    rebuild = False
-_7_8    for font in fonts_pylib:
-_7_9        if font not in fonts_cached_paths:
-_8_0            if rebuild == False:
-_8_1                # Issue warning, first time only
-_8_2                warnings.warn('Rebuilding font cache. This can take time.')
-_8_3            rebuild = True
-_8_4            mfonts.fontManager.addfont(font)
-_8_5
-_8_6    # Save font cache
-_8_7    if rebuild:
-_8_8        cache = os.path.join(
-_8_9                        mpl.get_cachedir(),
-_9_0                        f'fontlist-v{mfonts.FontManager.__version__}.json'
-_9_1                    )
-_9_2        mfonts.json_dump(mfonts.fontManager, cache)
-Load fonts contained in the acgc/fonts subdirectory
+def show_modes(labels, eigval, eigvec, ax=None): View Source
+_ _8def show_modes( labels, eigval, eigvec, ax=None ):
+_ _9    '''Plot figure showing eigenmodes
+_1_0
+_1_1    This program assumes that all modes will be displayed, so it is expected
+that
+_1_2    len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes.
+_1_3
+_1_4    Arguments
+_1_5    ---------
+_1_6    labels : list, str
+_1_7        names for the component variables decomposed into modes
+_1_8    eigval : list or array, float
+_1_9        eigenvalues
+_2_0    eigvec : 2D array, float
+_2_1        eigenvector matrix. Vectors should be the columns of eigvec
+_2_2    ax : subplot axis (optional)
+_2_3        location where graph will be displayed. If not provided, then a new
+axis will be created.
+_2_4    '''
+_2_5
+_2_6    # Number of modes
+_2_7    nmodes = len(eigval)
+_2_8
+_2_9    # Ensure number of labels equals number of modes
+_3_0    if len(labels) != nmodes:
+_3_1        raise ValueError( 'Provide one label per eigenmode')
+_3_2
+_3_3    # Create new axis if one is not passed
+_3_4    if ax is None:
+_3_5        ax = plt.axes()
+_3_6
+_3_7    # Sort the modes from largest to smallest eigenvalue
+_3_8    idx = np.argsort( np.abs(eigval) )[::-1]
+_3_9    eigval = eigval[idx]
+_4_0    eigvec = eigvec[:,idx]
+_4_1
+_4_2    # Plot the modes
+_4_3    for i in range(nmodes):
+_4_4        # Vertical gray line for reference
+_4_5        ax.plot( [i*2,i*2], [0,nmodes-1], color='gray')
+_4_6        # Plot mode i
+_4_7        ax.plot( i*2 + eigvec[::-1,i],  np.arange(nmodes), 'o-' )
+_4_8
+_4_9    # xaxis labels
+_5_0    xlabel = [ '{:#.2g}\n({:#.2g})'.format(x,np.abs(1/x)) for x in eigval]
+_5_1
+_5_2    # Set ticks and labels
+_5_3    ax.set( yticks=np.arange(nmodes),
+_5_4            yticklabels=labels[::-1],
+_5_5            xticks=np.arange(nmodes)*2,
+_5_6            xticklabels=xlabel,
+_5_7            ylabel='Reservoir',
+_5_8            xlabel='Modes: Eigenvalue\n(Time scale)')
+_5_9
+_6_0    plt.tight_layout()
+Plot figure showing eigenmodes
+This program assumes that all modes will be displayed, so it is expected that
+len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes.
+** AArrgguummeennttss **
+labels : list, str names for the component variables decomposed into modes
+eigval : list or array, float eigenvalues eigvec : 2D array, float eigenvector
+matrix. Vectors should be the columns of eigvec ax : subplot axis (optional)
+location where graph will be displayed. If not provided, then a new axis will
+be created.
```

### Comparing `acgc-0.2.6/docs/acgc/gc.html` & `acgc-0.3/docs/acgc/gc.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/geoschem.html` & `acgc-0.3/docs/acgc/geoschem.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/hysplit.html` & `acgc-0.3/docs/acgc/hysplit.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/icartt.html` & `acgc-0.3/docs/acgc/icartt.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/igra.html` & `acgc-0.3/docs/acgc/igra.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/map_scalebar.html` & `acgc-0.3/docs/acgc/map_scalebar.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/mapping.html` & `acgc-0.3/docs/acgc/mapping.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/met.html` & `acgc-0.3/docs/acgc/met.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/modetools.html` & `acgc-0.3/docs/acgc/stats/partial_corr.html`

 * *Files 13% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 <!doctype html>
 <html lang="en">
 <head>
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">
     <meta name="generator" content="pdoc 14.4.0"/>
-    <title>acgc.modetools API documentation</title>
+    <title>acgc.stats.partial_corr API documentation</title>
 
     <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
     <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
     <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
     <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
     <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
     <style>/*! custom.css */</style><script>
@@ -34,31 +34,31 @@
         overflow-x: auto;
     }
 </style></head>
 <body>
     <nav class="pdoc">
         <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
         <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
-        <div>            <a class="pdoc-button module-list-button" href="../acgc.html">
+        <div>            <a class="pdoc-button module-list-button" href="../stats.html">
 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
   <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
   <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
-</svg>                &nbsp;acgc</a>
+</svg>                &nbsp;acgc.stats</a>
 
             <img src="https://acgc.eoas.fsu.edu/wiki/_media/wiki/logo.png" class="logo" alt="project logo"/>
 
             <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                    pattern=".+" required>
 
 
 
             <h2>API Documentation</h2>
                 <ul class="memberlist">
             <li>
-                    <a class="function" href="#show_modes">show_modes</a>
+                    <a class="function" href="#partial_corr">partial_corr</a>
             </li>
     </ul>
 
 
 
         <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
             built with <span class="visually-hidden">pdoc</span><img
@@ -66,168 +66,185 @@
                 src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
         </a>
 </div>
     </nav>
     <main class="pdoc">
             <section class="module-info">
                     <h1 class="modulename">
-<a href="./../acgc.html">acgc</a><wbr>.modetools    </h1>
+<a href="./../../acgc.html">acgc</a><wbr>.<a href="./../stats.html">stats</a><wbr>.partial_corr    </h1>
 
-                        <div class="docstring"><p>Graphical display of eigenmodes</p>
+                        <div class="docstring"><p>Partial Correlation in Python </p>
+
+<p>Clone of Matlab's partialcorr, written by Fabian Pedregosa-Izquierdo, f@bianp.net</p>
 </div>
 
-                        <input id="mod-modetools-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
+                        <input id="mod-partial_corr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
 
-                        <label class="view-source-button" for="mod-modetools-view-source"><span>View Source</span></label>
+                        <label class="view-source-button" for="mod-partial_corr-view-source"><span>View Source</span></label>
 
                         <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="ch">#!/usr/bin/env python3</span>
-</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">&#39;&#39;&#39;Graphical display of eigenmodes&#39;&#39;&#39;</span>
-</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a>
-</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
-</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
-</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>
-</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="k">def</span> <span class="nf">show_modes</span><span class="p">(</span> <span class="n">labels</span><span class="p">,</span> <span class="n">eigval</span><span class="p">,</span> <span class="n">eigvec</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
-</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Plot figure showing eigenmodes</span>
-</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">    </span>
-</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="sd">    This program assumes that all modes will be displayed, so it is expected that</span>
-</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="sd">    len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes. </span>
+</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
+</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">&quot;&quot;&quot;Partial Correlation in Python </span>
+</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
+</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="sd">Clone of Matlab&#39;s partialcorr, written by Fabian Pedregosa-Izquierdo, f@bianp.net</span>
+</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="sd">&quot;&quot;&quot;</span>
+</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>
+</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
+</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span><span class="p">,</span> <span class="n">linalg</span>
+</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
+</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;partial_corr&#39;</span><span class="p">]</span>
 </span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>
-</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="sd">    Arguments</span>
-</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="sd">    ---------</span>
-</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">    labels : list, str</span>
-</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="sd">        names for the component variables decomposed into modes</span>
-</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="sd">    eigval : list or array, float</span>
-</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="sd">        eigenvalues</span>
-</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="sd">    eigvec : 2D array, float</span>
-</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="sd">        eigenvector matrix. Vectors should be the columns of eigvec</span>
-</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="sd">    ax : subplot axis (optional)</span>
-</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="sd">        location where graph will be displayed. If not provided, then a new axis will be created.        </span>
-</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>
-</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="c1"># Number of modes</span>
-</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="n">nmodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span>
-</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>
-</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="c1"># Ensure number of labels equals number of modes</span>
-</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">nmodes</span><span class="p">:</span>
-</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Provide one label per eigenmode&#39;</span><span class="p">)</span>
-</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>
-</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="c1"># Create new axis if one is not passed</span>
-</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
-</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>
-</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="c1"># Sort the modes from largest to smallest eigenvalue</span>
-</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span> <span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="n">eigval</span> <span class="o">=</span> <span class="n">eigval</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
-</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="n">eigvec</span> <span class="o">=</span> <span class="n">eigvec</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span>
+</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="k">def</span> <span class="nf">partial_corr</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
+</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the sample linear partial correlation coefficients between pairs of variables in C, </span>
+</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">    controlling for the remaining variables in C.</span>
+</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>
+</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="sd">    This uses the linear regression approach to compute the partial </span>
+</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="sd">    correlation (might be slow for a huge number of variables). The </span>
+</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="sd">    algorithm is detailed here:</span>
+</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="sd">    http://en.wikipedia.org/wiki/Partial_correlation#Using_linear_regression</span>
+</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="sd">    Taking X and Y two variables of interest and Z the matrix with all the variable minus {X, Y},</span>
+</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="sd">    the algorithm can be summarized as</span>
+</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="sd">        1) perform a normal linear least-squares regression with X as the target and Z as the predictor</span>
+</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="sd">        2) calculate the residuals in Step #1</span>
+</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="sd">        3) perform a normal linear least-squares regression with Y as the target and Z as the predictor</span>
+</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="sd">        4) calculate the residuals in Step #3</span>
+</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="sd">        5) calculate the correlation coefficient between the residuals from Steps #2 and #4; </span>
+</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="sd">    The result is the partial correlation between X and Y while controlling for the effect of Z</span>
+</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>
+</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="sd">    Parameters</span>
+</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a><span class="sd">    ----------</span>
+</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="sd">    C : array-like, (n, p)</span>
+</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a><span class="sd">        Array with the different variables. Each column of C is taken as a variable</span>
+</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a><span class="sd">    Returns</span>
+</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a><span class="sd">    -------</span>
+</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a><span class="sd">    P : array-like, (p, p)</span>
+</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a><span class="sd">        P[i, j] contains the partial correlation of C[:, i] and C[:, j] controlling</span>
+</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a><span class="sd">        for the remaining variables in C.</span>
+</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a><span class="sd">    &quot;&quot;&quot;</span>
 </span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>
-</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="c1"># Plot the modes</span>
-</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmodes</span><span class="p">):</span>
-</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>        <span class="c1"># Vertical gray line for reference</span>
-</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">nmodes</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
-</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>        <span class="c1"># Plot mode i</span>
-</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eigvec</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">),</span> <span class="s1">&#39;o-&#39;</span> <span class="p">)</span>
-</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>
-</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="c1"># xaxis labels</span>
-</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="n">xlabel</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;</span><span class="si">{:#.2g}</span><span class="se">\n</span><span class="s1">(</span><span class="si">{:#.2g}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eigval</span><span class="p">]</span>
-</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>
-</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>    <span class="c1"># Set ticks and labels</span>
-</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">),</span>
-</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>            <span class="n">yticklabels</span><span class="o">=</span><span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
-</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
-</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>            <span class="n">xticklabels</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
-</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Reservoir&#39;</span><span class="p">,</span>
-</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Modes: Eigenvalue</span><span class="se">\n</span><span class="s1">(Time scale)&#39;</span><span class="p">)</span>
-</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>
-</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
+</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="c1">#C = np.column_stack([C0, np.ones(C0.shape[0])])</span>
+</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>
+</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
+</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="n">p</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="n">P_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
+</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
+</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>        <span class="n">P_corr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
+</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
+</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
+</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>            <span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
+</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>            <span class="n">idx</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
+</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>            <span class="n">beta_i</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">C</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">],</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>            <span class="n">beta_j</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">C</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">],</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>
+</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>            <span class="n">res_j</span> <span class="o">=</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">beta_i</span><span class="p">)</span>
+</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>            <span class="n">res_i</span> <span class="o">=</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">beta_j</span><span class="p">)</span>
+</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>
+</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>            <span class="n">corr</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">res_i</span><span class="p">,</span> <span class="n">res_j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>            <span class="n">P_corr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span>
+</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a>            <span class="n">P_corr</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span>
+</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a>
+</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>    <span class="k">return</span> <span class="n">P_corr</span>
 </span></pre></div>
 
 
             </section>
-                <section id="show_modes">
-                            <input id="show_modes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
+                <section id="partial_corr">
+                            <input id="partial_corr-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
 <div class="attr function">
             
         <span class="def">def</span>
-        <span class="name">show_modes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">labels</span>, </span><span class="param"><span class="n">eigval</span>, </span><span class="param"><span class="n">eigvec</span>, </span><span class="param"><span class="n">ax</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>
+        <span class="name">partial_corr</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">C</span></span><span class="return-annotation">):</span></span>
 
-                <label class="view-source-button" for="show_modes-view-source"><span>View Source</span></label>
+                <label class="view-source-button" for="partial_corr-view-source"><span>View Source</span></label>
 
     </div>
-    <a class="headerlink" href="#show_modes"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="show_modes-8"><a href="#show_modes-8"><span class="linenos"> 8</span></a><span class="k">def</span> <span class="nf">show_modes</span><span class="p">(</span> <span class="n">labels</span><span class="p">,</span> <span class="n">eigval</span><span class="p">,</span> <span class="n">eigvec</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
-</span><span id="show_modes-9"><a href="#show_modes-9"><span class="linenos"> 9</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Plot figure showing eigenmodes</span>
-</span><span id="show_modes-10"><a href="#show_modes-10"><span class="linenos">10</span></a><span class="sd">    </span>
-</span><span id="show_modes-11"><a href="#show_modes-11"><span class="linenos">11</span></a><span class="sd">    This program assumes that all modes will be displayed, so it is expected that</span>
-</span><span id="show_modes-12"><a href="#show_modes-12"><span class="linenos">12</span></a><span class="sd">    len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes. </span>
-</span><span id="show_modes-13"><a href="#show_modes-13"><span class="linenos">13</span></a>
-</span><span id="show_modes-14"><a href="#show_modes-14"><span class="linenos">14</span></a><span class="sd">    Arguments</span>
-</span><span id="show_modes-15"><a href="#show_modes-15"><span class="linenos">15</span></a><span class="sd">    ---------</span>
-</span><span id="show_modes-16"><a href="#show_modes-16"><span class="linenos">16</span></a><span class="sd">    labels : list, str</span>
-</span><span id="show_modes-17"><a href="#show_modes-17"><span class="linenos">17</span></a><span class="sd">        names for the component variables decomposed into modes</span>
-</span><span id="show_modes-18"><a href="#show_modes-18"><span class="linenos">18</span></a><span class="sd">    eigval : list or array, float</span>
-</span><span id="show_modes-19"><a href="#show_modes-19"><span class="linenos">19</span></a><span class="sd">        eigenvalues</span>
-</span><span id="show_modes-20"><a href="#show_modes-20"><span class="linenos">20</span></a><span class="sd">    eigvec : 2D array, float</span>
-</span><span id="show_modes-21"><a href="#show_modes-21"><span class="linenos">21</span></a><span class="sd">        eigenvector matrix. Vectors should be the columns of eigvec</span>
-</span><span id="show_modes-22"><a href="#show_modes-22"><span class="linenos">22</span></a><span class="sd">    ax : subplot axis (optional)</span>
-</span><span id="show_modes-23"><a href="#show_modes-23"><span class="linenos">23</span></a><span class="sd">        location where graph will be displayed. If not provided, then a new axis will be created.        </span>
-</span><span id="show_modes-24"><a href="#show_modes-24"><span class="linenos">24</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="show_modes-25"><a href="#show_modes-25"><span class="linenos">25</span></a>
-</span><span id="show_modes-26"><a href="#show_modes-26"><span class="linenos">26</span></a>    <span class="c1"># Number of modes</span>
-</span><span id="show_modes-27"><a href="#show_modes-27"><span class="linenos">27</span></a>    <span class="n">nmodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span>
-</span><span id="show_modes-28"><a href="#show_modes-28"><span class="linenos">28</span></a>
-</span><span id="show_modes-29"><a href="#show_modes-29"><span class="linenos">29</span></a>    <span class="c1"># Ensure number of labels equals number of modes</span>
-</span><span id="show_modes-30"><a href="#show_modes-30"><span class="linenos">30</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">nmodes</span><span class="p">:</span>
-</span><span id="show_modes-31"><a href="#show_modes-31"><span class="linenos">31</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Provide one label per eigenmode&#39;</span><span class="p">)</span>
-</span><span id="show_modes-32"><a href="#show_modes-32"><span class="linenos">32</span></a>
-</span><span id="show_modes-33"><a href="#show_modes-33"><span class="linenos">33</span></a>    <span class="c1"># Create new axis if one is not passed</span>
-</span><span id="show_modes-34"><a href="#show_modes-34"><span class="linenos">34</span></a>    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="show_modes-35"><a href="#show_modes-35"><span class="linenos">35</span></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
-</span><span id="show_modes-36"><a href="#show_modes-36"><span class="linenos">36</span></a>
-</span><span id="show_modes-37"><a href="#show_modes-37"><span class="linenos">37</span></a>    <span class="c1"># Sort the modes from largest to smallest eigenvalue</span>
-</span><span id="show_modes-38"><a href="#show_modes-38"><span class="linenos">38</span></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigval</span><span class="p">)</span> <span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="show_modes-39"><a href="#show_modes-39"><span class="linenos">39</span></a>    <span class="n">eigval</span> <span class="o">=</span> <span class="n">eigval</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
-</span><span id="show_modes-40"><a href="#show_modes-40"><span class="linenos">40</span></a>    <span class="n">eigvec</span> <span class="o">=</span> <span class="n">eigvec</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span>
-</span><span id="show_modes-41"><a href="#show_modes-41"><span class="linenos">41</span></a>
-</span><span id="show_modes-42"><a href="#show_modes-42"><span class="linenos">42</span></a>    <span class="c1"># Plot the modes</span>
-</span><span id="show_modes-43"><a href="#show_modes-43"><span class="linenos">43</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmodes</span><span class="p">):</span>
-</span><span id="show_modes-44"><a href="#show_modes-44"><span class="linenos">44</span></a>        <span class="c1"># Vertical gray line for reference</span>
-</span><span id="show_modes-45"><a href="#show_modes-45"><span class="linenos">45</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">nmodes</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
-</span><span id="show_modes-46"><a href="#show_modes-46"><span class="linenos">46</span></a>        <span class="c1"># Plot mode i</span>
-</span><span id="show_modes-47"><a href="#show_modes-47"><span class="linenos">47</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">eigvec</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span>  <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">),</span> <span class="s1">&#39;o-&#39;</span> <span class="p">)</span>
-</span><span id="show_modes-48"><a href="#show_modes-48"><span class="linenos">48</span></a>
-</span><span id="show_modes-49"><a href="#show_modes-49"><span class="linenos">49</span></a>    <span class="c1"># xaxis labels</span>
-</span><span id="show_modes-50"><a href="#show_modes-50"><span class="linenos">50</span></a>    <span class="n">xlabel</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;</span><span class="si">{:#.2g}</span><span class="se">\n</span><span class="s1">(</span><span class="si">{:#.2g}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">eigval</span><span class="p">]</span>
-</span><span id="show_modes-51"><a href="#show_modes-51"><span class="linenos">51</span></a>
-</span><span id="show_modes-52"><a href="#show_modes-52"><span class="linenos">52</span></a>    <span class="c1"># Set ticks and labels</span>
-</span><span id="show_modes-53"><a href="#show_modes-53"><span class="linenos">53</span></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">yticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">),</span>
-</span><span id="show_modes-54"><a href="#show_modes-54"><span class="linenos">54</span></a>            <span class="n">yticklabels</span><span class="o">=</span><span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
-</span><span id="show_modes-55"><a href="#show_modes-55"><span class="linenos">55</span></a>            <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmodes</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>
-</span><span id="show_modes-56"><a href="#show_modes-56"><span class="linenos">56</span></a>            <span class="n">xticklabels</span><span class="o">=</span><span class="n">xlabel</span><span class="p">,</span>
-</span><span id="show_modes-57"><a href="#show_modes-57"><span class="linenos">57</span></a>            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Reservoir&#39;</span><span class="p">,</span>
-</span><span id="show_modes-58"><a href="#show_modes-58"><span class="linenos">58</span></a>            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Modes: Eigenvalue</span><span class="se">\n</span><span class="s1">(Time scale)&#39;</span><span class="p">)</span>
-</span><span id="show_modes-59"><a href="#show_modes-59"><span class="linenos">59</span></a>
-</span><span id="show_modes-60"><a href="#show_modes-60"><span class="linenos">60</span></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
+    <a class="headerlink" href="#partial_corr"></a>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="partial_corr-14"><a href="#partial_corr-14"><span class="linenos">14</span></a><span class="k">def</span> <span class="nf">partial_corr</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
+</span><span id="partial_corr-15"><a href="#partial_corr-15"><span class="linenos">15</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the sample linear partial correlation coefficients between pairs of variables in C, </span>
+</span><span id="partial_corr-16"><a href="#partial_corr-16"><span class="linenos">16</span></a><span class="sd">    controlling for the remaining variables in C.</span>
+</span><span id="partial_corr-17"><a href="#partial_corr-17"><span class="linenos">17</span></a>
+</span><span id="partial_corr-18"><a href="#partial_corr-18"><span class="linenos">18</span></a><span class="sd">    This uses the linear regression approach to compute the partial </span>
+</span><span id="partial_corr-19"><a href="#partial_corr-19"><span class="linenos">19</span></a><span class="sd">    correlation (might be slow for a huge number of variables). The </span>
+</span><span id="partial_corr-20"><a href="#partial_corr-20"><span class="linenos">20</span></a><span class="sd">    algorithm is detailed here:</span>
+</span><span id="partial_corr-21"><a href="#partial_corr-21"><span class="linenos">21</span></a><span class="sd">    http://en.wikipedia.org/wiki/Partial_correlation#Using_linear_regression</span>
+</span><span id="partial_corr-22"><a href="#partial_corr-22"><span class="linenos">22</span></a><span class="sd">    Taking X and Y two variables of interest and Z the matrix with all the variable minus {X, Y},</span>
+</span><span id="partial_corr-23"><a href="#partial_corr-23"><span class="linenos">23</span></a><span class="sd">    the algorithm can be summarized as</span>
+</span><span id="partial_corr-24"><a href="#partial_corr-24"><span class="linenos">24</span></a><span class="sd">        1) perform a normal linear least-squares regression with X as the target and Z as the predictor</span>
+</span><span id="partial_corr-25"><a href="#partial_corr-25"><span class="linenos">25</span></a><span class="sd">        2) calculate the residuals in Step #1</span>
+</span><span id="partial_corr-26"><a href="#partial_corr-26"><span class="linenos">26</span></a><span class="sd">        3) perform a normal linear least-squares regression with Y as the target and Z as the predictor</span>
+</span><span id="partial_corr-27"><a href="#partial_corr-27"><span class="linenos">27</span></a><span class="sd">        4) calculate the residuals in Step #3</span>
+</span><span id="partial_corr-28"><a href="#partial_corr-28"><span class="linenos">28</span></a><span class="sd">        5) calculate the correlation coefficient between the residuals from Steps #2 and #4; </span>
+</span><span id="partial_corr-29"><a href="#partial_corr-29"><span class="linenos">29</span></a><span class="sd">    The result is the partial correlation between X and Y while controlling for the effect of Z</span>
+</span><span id="partial_corr-30"><a href="#partial_corr-30"><span class="linenos">30</span></a>
+</span><span id="partial_corr-31"><a href="#partial_corr-31"><span class="linenos">31</span></a><span class="sd">    Parameters</span>
+</span><span id="partial_corr-32"><a href="#partial_corr-32"><span class="linenos">32</span></a><span class="sd">    ----------</span>
+</span><span id="partial_corr-33"><a href="#partial_corr-33"><span class="linenos">33</span></a><span class="sd">    C : array-like, (n, p)</span>
+</span><span id="partial_corr-34"><a href="#partial_corr-34"><span class="linenos">34</span></a><span class="sd">        Array with the different variables. Each column of C is taken as a variable</span>
+</span><span id="partial_corr-35"><a href="#partial_corr-35"><span class="linenos">35</span></a><span class="sd">    Returns</span>
+</span><span id="partial_corr-36"><a href="#partial_corr-36"><span class="linenos">36</span></a><span class="sd">    -------</span>
+</span><span id="partial_corr-37"><a href="#partial_corr-37"><span class="linenos">37</span></a><span class="sd">    P : array-like, (p, p)</span>
+</span><span id="partial_corr-38"><a href="#partial_corr-38"><span class="linenos">38</span></a><span class="sd">        P[i, j] contains the partial correlation of C[:, i] and C[:, j] controlling</span>
+</span><span id="partial_corr-39"><a href="#partial_corr-39"><span class="linenos">39</span></a><span class="sd">        for the remaining variables in C.</span>
+</span><span id="partial_corr-40"><a href="#partial_corr-40"><span class="linenos">40</span></a><span class="sd">    &quot;&quot;&quot;</span>
+</span><span id="partial_corr-41"><a href="#partial_corr-41"><span class="linenos">41</span></a>
+</span><span id="partial_corr-42"><a href="#partial_corr-42"><span class="linenos">42</span></a>    <span class="c1">#C = np.column_stack([C0, np.ones(C0.shape[0])])</span>
+</span><span id="partial_corr-43"><a href="#partial_corr-43"><span class="linenos">43</span></a>
+</span><span id="partial_corr-44"><a href="#partial_corr-44"><span class="linenos">44</span></a>    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
+</span><span id="partial_corr-45"><a href="#partial_corr-45"><span class="linenos">45</span></a>    <span class="n">p</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="partial_corr-46"><a href="#partial_corr-46"><span class="linenos">46</span></a>    <span class="n">P_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
+</span><span id="partial_corr-47"><a href="#partial_corr-47"><span class="linenos">47</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
+</span><span id="partial_corr-48"><a href="#partial_corr-48"><span class="linenos">48</span></a>        <span class="n">P_corr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
+</span><span id="partial_corr-49"><a href="#partial_corr-49"><span class="linenos">49</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
+</span><span id="partial_corr-50"><a href="#partial_corr-50"><span class="linenos">50</span></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
+</span><span id="partial_corr-51"><a href="#partial_corr-51"><span class="linenos">51</span></a>            <span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
+</span><span id="partial_corr-52"><a href="#partial_corr-52"><span class="linenos">52</span></a>            <span class="n">idx</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
+</span><span id="partial_corr-53"><a href="#partial_corr-53"><span class="linenos">53</span></a>            <span class="n">beta_i</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">C</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">],</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="partial_corr-54"><a href="#partial_corr-54"><span class="linenos">54</span></a>            <span class="n">beta_j</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">C</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">],</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="partial_corr-55"><a href="#partial_corr-55"><span class="linenos">55</span></a>
+</span><span id="partial_corr-56"><a href="#partial_corr-56"><span class="linenos">56</span></a>            <span class="n">res_j</span> <span class="o">=</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">beta_i</span><span class="p">)</span>
+</span><span id="partial_corr-57"><a href="#partial_corr-57"><span class="linenos">57</span></a>            <span class="n">res_i</span> <span class="o">=</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">C</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">beta_j</span><span class="p">)</span>
+</span><span id="partial_corr-58"><a href="#partial_corr-58"><span class="linenos">58</span></a>
+</span><span id="partial_corr-59"><a href="#partial_corr-59"><span class="linenos">59</span></a>            <span class="n">corr</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">res_i</span><span class="p">,</span> <span class="n">res_j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="partial_corr-60"><a href="#partial_corr-60"><span class="linenos">60</span></a>            <span class="n">P_corr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span>
+</span><span id="partial_corr-61"><a href="#partial_corr-61"><span class="linenos">61</span></a>            <span class="n">P_corr</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr</span>
+</span><span id="partial_corr-62"><a href="#partial_corr-62"><span class="linenos">62</span></a>
+</span><span id="partial_corr-63"><a href="#partial_corr-63"><span class="linenos">63</span></a>    <span class="k">return</span> <span class="n">P_corr</span>
 </span></pre></div>
 
 
-            <div class="docstring"><p>Plot figure showing eigenmodes</p>
-
-<p>This program assumes that all modes will be displayed, so it is expected that
-len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes. </p>
-
-<h6 id="arguments">Arguments</h6>
+            <div class="docstring"><p>Returns the sample linear partial correlation coefficients between pairs of variables in C, 
+controlling for the remaining variables in C.</p>
 
-<p>labels : list, str
-    names for the component variables decomposed into modes
-eigval : list or array, float
-    eigenvalues
-eigvec : 2D array, float
-    eigenvector matrix. Vectors should be the columns of eigvec
-ax : subplot axis (optional)
-    location where graph will be displayed. If not provided, then a new axis will be created.</p>
+<p>This uses the linear regression approach to compute the partial 
+correlation (might be slow for a huge number of variables). The 
+algorithm is detailed here:
+<a href="http://en.wikipedia.org/wiki/Partial_correlation#Using_linear_regression">http://en.wikipedia.org/wiki/Partial_correlation#Using_linear_regression</a>
+Taking X and Y two variables of interest and Z the matrix with all the variable minus {X, Y},
+the algorithm can be summarized as
+    1) perform a normal linear least-squares regression with X as the target and Z as the predictor
+    2) calculate the residuals in Step #1
+    3) perform a normal linear least-squares regression with Y as the target and Z as the predictor
+    4) calculate the residuals in Step #3
+    5) calculate the correlation coefficient between the residuals from Steps #2 and #4; 
+The result is the partial correlation between X and Y while controlling for the effect of Z</p>
+
+<h6 id="parameters">Parameters</h6>
+
+<ul>
+<li><strong>C</strong> (array-like, (n, p)):
+Array with the different variables. Each column of C is taken as a variable</li>
+</ul>
+
+<h6 id="returns">Returns</h6>
+
+<ul>
+<li><strong>P</strong> (array-like, (p, p)):
+P[i, j] contains the partial correlation of C[:, i] and C[:, j] controlling
+for the remaining variables in C.</li>
+</ul>
 </div>
 
 
                 </section>
     </main>
 <script>
     function escapeHTML(html) {
@@ -277,15 +294,15 @@
         try {
             search = await new Promise((resolve, reject) => {
                 const script = document.createElement("script");
                 script.type = "text/javascript";
                 script.async = true;
                 script.onload = () => resolve(window.pdocSearch);
                 script.onerror = (e) => reject(e);
-                script.src = "../search.js";
+                script.src = "../../search.js";
                 document.getElementsByTagName("head")[0].appendChild(script);
             });
         } catch (e) {
             console.error("Cannot fetch pdoc search index");
             searchErr = "Cannot fetch search index.";
         }
         onInput();
@@ -319,15 +336,15 @@
             if (results.length === 0) {
                 html = `No search results for '${escapeHTML(term)}'.`
             } else {
                 html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
             }
             for (let result of results.slice(0, 10)) {
                 let doc = result.doc;
-                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
+                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                 if (doc.qualname) {
                     url += `#${doc.qualname}`;
                 }
 
                 let heading;
                 switch (result.doc.kind) {
                     case "function":
```

#### html2text {}

```diff
@@ -1,135 +1,160 @@
 ??
-_ _a_c_g_c[project logo][Unknown INPUT type]
+_ _a_c_g_c_._s_t_a_t_s[project logo][Unknown INPUT type]
 ********** AAPPII DDooccuummeennttaattiioonn **********
-    * _s_h_o_w___m_o_d_e_s
+    * _p_a_r_t_i_a_l___c_o_r_r
 _b_u_i_l_t_ _w_i_t_h_ _p_d_o_c_[_p_d_o_c_ _l_o_g_o_]
-************ _aa_cc_gg_cc..mmooddeettoooollss ************
-Graphical display of eigenmodes
+************ _aa_cc_gg_cc.._ss_tt_aa_tt_ss..ppaarrttiiaall__ccoorrrr ************
+Partial Correlation in Python
+Clone of Matlab's partialcorr, written by Fabian Pedregosa-Izquierdo,
+f@bianp.net
 ??View Source
 _ _1#!/usr/bin/env python3
-_ _2'''Graphical display of eigenmodes'''
-_ _3
-_ _4import numpy as np
-_ _5import matplotlib.pyplot as plt
-_ _6
-_ _7def show_modes( labels, eigval, eigvec, ax=None ):
-_ _8    '''Plot figure showing eigenmodes
-_ _9
-_1_0    This program assumes that all modes will be displayed, so it is expected
-that
-_1_1    len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes.
+_ _2# -*- coding: utf-8 -*-
+_ _3"""Partial Correlation in Python
+_ _4
+_ _5Clone of Matlab's partialcorr, written by Fabian Pedregosa-Izquierdo,
+f@bianp.net
+_ _6"""
+_ _7
+_ _8import numpy as np
+_ _9from scipy import stats, linalg
+_1_0
+_1_1__all__ = ['partial_corr']
 _1_2
-_1_3    Arguments
-_1_4    ---------
-_1_5    labels : list, str
-_1_6        names for the component variables decomposed into modes
-_1_7    eigval : list or array, float
-_1_8        eigenvalues
-_1_9    eigvec : 2D array, float
-_2_0        eigenvector matrix. Vectors should be the columns of eigvec
-_2_1    ax : subplot axis (optional)
-_2_2        location where graph will be displayed. If not provided, then a new
-axis will be created.
-_2_3    '''
-_2_4
-_2_5    # Number of modes
-_2_6    nmodes = len(eigval)
-_2_7
-_2_8    # Ensure number of labels equals number of modes
-_2_9    if len(labels) != nmodes:
-_3_0        raise ValueError( 'Provide one label per eigenmode')
-_3_1
-_3_2    # Create new axis if one is not passed
-_3_3    if ax is None:
-_3_4        ax = plt.axes()
-_3_5
-_3_6    # Sort the modes from largest to smallest eigenvalue
-_3_7    idx = np.argsort( np.abs(eigval) )[::-1]
-_3_8    eigval = eigval[idx]
-_3_9    eigvec = eigvec[:,idx]
+_1_3def partial_corr(C):
+_1_4    """Returns the sample linear partial correlation coefficients between
+pairs of variables in C,
+_1_5    controlling for the remaining variables in C.
+_1_6
+_1_7    This uses the linear regression approach to compute the partial
+_1_8    correlation (might be slow for a huge number of variables). The
+_1_9    algorithm is detailed here:
+_2_0    http://en.wikipedia.org/wiki/Partial_correlation#Using_linear_regression
+_2_1    Taking X and Y two variables of interest and Z the matrix with all the
+variable minus {X, Y},
+_2_2    the algorithm can be summarized as
+_2_3        1) perform a normal linear least-squares regression with X as the
+target and Z as the predictor
+_2_4        2) calculate the residuals in Step #1
+_2_5        3) perform a normal linear least-squares regression with Y as the
+target and Z as the predictor
+_2_6        4) calculate the residuals in Step #3
+_2_7        5) calculate the correlation coefficient between the residuals from
+Steps #2 and #4;
+_2_8    The result is the partial correlation between X and Y while controlling
+for the effect of Z
+_2_9
+_3_0    Parameters
+_3_1    ----------
+_3_2    C : array-like, (n, p)
+_3_3        Array with the different variables. Each column of C is taken as a
+variable
+_3_4    Returns
+_3_5    -------
+_3_6    P : array-like, (p, p)
+_3_7        P[i, j] contains the partial correlation of C[:, i] and C[:, j]
+controlling
+_3_8        for the remaining variables in C.
+_3_9    """
 _4_0
-_4_1    # Plot the modes
-_4_2    for i in range(nmodes):
-_4_3        # Vertical gray line for reference
-_4_4        ax.plot( [i*2,i*2], [0,nmodes-1], color='gray')
-_4_5        # Plot mode i
-_4_6        ax.plot( i*2 + eigvec[::-1,i],  np.arange(nmodes), 'o-' )
-_4_7
-_4_8    # xaxis labels
-_4_9    xlabel = [ '{:#.2g}\n({:#.2g})'.format(x,np.abs(1/x)) for x in eigval]
-_5_0
-_5_1    # Set ticks and labels
-_5_2    ax.set( yticks=np.arange(nmodes),
-_5_3            yticklabels=labels[::-1],
-_5_4            xticks=np.arange(nmodes)*2,
-_5_5            xticklabels=xlabel,
-_5_6            ylabel='Reservoir',
-_5_7            xlabel='Modes: Eigenvalue\n(Time scale)')
-_5_8
-_5_9    plt.tight_layout()
+_4_1    #C = np.column_stack([C0, np.ones(C0.shape[0])])
+_4_2
+_4_3    C = np.asarray(C)
+_4_4    p = C.shape[1]
+_4_5    P_corr = np.zeros((p, p), dtype=np.float)
+_4_6    for i in range(p):
+_4_7        P_corr[i, i] = 1
+_4_8        for j in range(i+1, p):
+_4_9            idx = np.ones(p, dtype=np.bool)
+_5_0            idx[i] = False
+_5_1            idx[j] = False
+_5_2            beta_i = linalg.lstsq(C[:, idx], C[:, j])[0]
+_5_3            beta_j = linalg.lstsq(C[:, idx], C[:, i])[0]
+_5_4
+_5_5            res_j = C[:, j] - C[:, idx].dot( beta_i)
+_5_6            res_i = C[:, i] - C[:, idx].dot(beta_j)
+_5_7
+_5_8            corr = stats.pearsonr(res_i, res_j)[0]
+_5_9            P_corr[i, j] = corr
+_6_0            P_corr[j, i] = corr
+_6_1
+_6_2    return P_corr
 ??
-def show_modes(labels, eigval, eigvec, ax=None): View Source
-_ _8def show_modes( labels, eigval, eigvec, ax=None ):
-_ _9    '''Plot figure showing eigenmodes
-_1_0
-_1_1    This program assumes that all modes will be displayed, so it is expected
-that
-_1_2    len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes.
-_1_3
-_1_4    Arguments
-_1_5    ---------
-_1_6    labels : list, str
-_1_7        names for the component variables decomposed into modes
-_1_8    eigval : list or array, float
-_1_9        eigenvalues
-_2_0    eigvec : 2D array, float
-_2_1        eigenvector matrix. Vectors should be the columns of eigvec
-_2_2    ax : subplot axis (optional)
-_2_3        location where graph will be displayed. If not provided, then a new
-axis will be created.
-_2_4    '''
-_2_5
-_2_6    # Number of modes
-_2_7    nmodes = len(eigval)
-_2_8
-_2_9    # Ensure number of labels equals number of modes
-_3_0    if len(labels) != nmodes:
-_3_1        raise ValueError( 'Provide one label per eigenmode')
-_3_2
-_3_3    # Create new axis if one is not passed
-_3_4    if ax is None:
-_3_5        ax = plt.axes()
-_3_6
-_3_7    # Sort the modes from largest to smallest eigenvalue
-_3_8    idx = np.argsort( np.abs(eigval) )[::-1]
-_3_9    eigval = eigval[idx]
-_4_0    eigvec = eigvec[:,idx]
+def partial_corr(C): View Source
+_1_4def partial_corr(C):
+_1_5    """Returns the sample linear partial correlation coefficients between
+pairs of variables in C,
+_1_6    controlling for the remaining variables in C.
+_1_7
+_1_8    This uses the linear regression approach to compute the partial
+_1_9    correlation (might be slow for a huge number of variables). The
+_2_0    algorithm is detailed here:
+_2_1    http://en.wikipedia.org/wiki/Partial_correlation#Using_linear_regression
+_2_2    Taking X and Y two variables of interest and Z the matrix with all the
+variable minus {X, Y},
+_2_3    the algorithm can be summarized as
+_2_4        1) perform a normal linear least-squares regression with X as the
+target and Z as the predictor
+_2_5        2) calculate the residuals in Step #1
+_2_6        3) perform a normal linear least-squares regression with Y as the
+target and Z as the predictor
+_2_7        4) calculate the residuals in Step #3
+_2_8        5) calculate the correlation coefficient between the residuals from
+Steps #2 and #4;
+_2_9    The result is the partial correlation between X and Y while controlling
+for the effect of Z
+_3_0
+_3_1    Parameters
+_3_2    ----------
+_3_3    C : array-like, (n, p)
+_3_4        Array with the different variables. Each column of C is taken as a
+variable
+_3_5    Returns
+_3_6    -------
+_3_7    P : array-like, (p, p)
+_3_8        P[i, j] contains the partial correlation of C[:, i] and C[:, j]
+controlling
+_3_9        for the remaining variables in C.
+_4_0    """
 _4_1
-_4_2    # Plot the modes
-_4_3    for i in range(nmodes):
-_4_4        # Vertical gray line for reference
-_4_5        ax.plot( [i*2,i*2], [0,nmodes-1], color='gray')
-_4_6        # Plot mode i
-_4_7        ax.plot( i*2 + eigvec[::-1,i],  np.arange(nmodes), 'o-' )
-_4_8
-_4_9    # xaxis labels
-_5_0    xlabel = [ '{:#.2g}\n({:#.2g})'.format(x,np.abs(1/x)) for x in eigval]
-_5_1
-_5_2    # Set ticks and labels
-_5_3    ax.set( yticks=np.arange(nmodes),
-_5_4            yticklabels=labels[::-1],
-_5_5            xticks=np.arange(nmodes)*2,
-_5_6            xticklabels=xlabel,
-_5_7            ylabel='Reservoir',
-_5_8            xlabel='Modes: Eigenvalue\n(Time scale)')
-_5_9
-_6_0    plt.tight_layout()
-Plot figure showing eigenmodes
-This program assumes that all modes will be displayed, so it is expected that
-len(labels) = len(eigval) = nmodes and eigvec has shape nmodes x nmodes.
-** AArrgguummeennttss **
-labels : list, str names for the component variables decomposed into modes
-eigval : list or array, float eigenvalues eigvec : 2D array, float eigenvector
-matrix. Vectors should be the columns of eigvec ax : subplot axis (optional)
-location where graph will be displayed. If not provided, then a new axis will
-be created.
+_4_2    #C = np.column_stack([C0, np.ones(C0.shape[0])])
+_4_3
+_4_4    C = np.asarray(C)
+_4_5    p = C.shape[1]
+_4_6    P_corr = np.zeros((p, p), dtype=np.float)
+_4_7    for i in range(p):
+_4_8        P_corr[i, i] = 1
+_4_9        for j in range(i+1, p):
+_5_0            idx = np.ones(p, dtype=np.bool)
+_5_1            idx[i] = False
+_5_2            idx[j] = False
+_5_3            beta_i = linalg.lstsq(C[:, idx], C[:, j])[0]
+_5_4            beta_j = linalg.lstsq(C[:, idx], C[:, i])[0]
+_5_5
+_5_6            res_j = C[:, j] - C[:, idx].dot( beta_i)
+_5_7            res_i = C[:, i] - C[:, idx].dot(beta_j)
+_5_8
+_5_9            corr = stats.pearsonr(res_i, res_j)[0]
+_6_0            P_corr[i, j] = corr
+_6_1            P_corr[j, i] = corr
+_6_2
+_6_3    return P_corr
+Returns the sample linear partial correlation coefficients between pairs of
+variables in C, controlling for the remaining variables in C.
+This uses the linear regression approach to compute the partial correlation
+(might be slow for a huge number of variables). The algorithm is detailed here:
+_h_t_t_p_:_/_/_e_n_._w_i_k_i_p_e_d_i_a_._o_r_g_/_w_i_k_i_/_P_a_r_t_i_a_l___c_o_r_r_e_l_a_t_i_o_n_#_U_s_i_n_g___l_i_n_e_a_r___r_e_g_r_e_s_s_i_o_n Taking
+X and Y two variables of interest and Z the matrix with all the variable minus
+{X, Y}, the algorithm can be summarized as 1) perform a normal linear least-
+squares regression with X as the target and Z as the predictor 2) calculate the
+residuals in Step #1 3) perform a normal linear least-squares regression with Y
+as the target and Z as the predictor 4) calculate the residuals in Step #3 5)
+calculate the correlation coefficient between the residuals from Steps #2 and
+#4; The result is the partial correlation between X and Y while controlling for
+the effect of Z
+** PPaarraammeetteerrss **
+    * CC (array-like, (n, p)): Array with the different variables. Each column
+      of C is taken as a variable
+** RReettuurrnnss **
+    * PP (array-like, (p, p)): P[i, j] contains the partial correlation of C[:,
+      i] and C[:, j] controlling for the remaining variables in C.
```

### Comparing `acgc-0.2.6/docs/acgc/netcdf.html` & `acgc-0.3/docs/acgc/netcdf.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/solar.html` & `acgc-0.3/docs/acgc/solar.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/stats/bivariate.html` & `acgc-0.3/docs/acgc/stats/bivariate.html`

 * *Files 1% similar despite different names*

```diff
@@ -337,553 +337,563 @@
 </span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">        mean of x and y variables</span>
 </span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">    xmedian, ymedian :float</span>
 </span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">        median of x and y variables</span>
 </span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">    xstd, ystd : float</span>
 </span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">        standard deviation of x and y variables</span>
 </span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">    mean_difference, md : float</span>
 </span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        ymean - xmean</span>
-</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">    mean_absolute_difference, mad : float</span>
-</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        mean( |y-x| )</span>
-</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">    relative_mean_difference, rmd : float</span>
-</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        md / xmean</span>
-</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">    relative_mean_absolute_difference, rmad :float</span>
-</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">        mad / xmean</span>
-</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">    standardized_mean_difference, smd : float</span>
-</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">        md / xstd</span>
-</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">    standardized_mean_absolute_difference, smad : float</span>
-</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        mad /xstd</span>
-</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">    mean_relative_difference, mrd : float</span>
-</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">        mean(y/x) - 1</span>
-</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">    mean_log10_ratio, mlr : float</span>
-</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">        mean( log10(y/x) )</span>
-</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">    mean_absolute_log10_ratio, malr : float</span>
-</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        mean( abs( log10(y/x) ) )</span>
-</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">    median_difference, medd : float</span>
-</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">        median(y-x)</span>
-</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">    median_absolute_difference, medad : float</span>
-</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">        median(|y-x|)</span>
-</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">    relative_median_difference, rmedd : float</span>
-</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        median(y-x) / xmedian</span>
-</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">    relative_median_absolute_difference, rmedad : float</span>
-</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        median(|y-x|) / xmedian</span>
-</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">    median_relative_difference, medianrd, medrd : float</span>
-</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="sd">        median(y/x)-1</span>
-</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">    median_log10_ratio, medlr : float</span>
-</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        median( log10(y/x) )</span>
-</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">    median_absolute_log10_ratio, medalr : float</span>
-</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        median( abs( log10(y/x) ) )</span>
-</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">    normalized_mean_bias_factor, nmbf : float</span>
-</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">        see `nmbf` </span>
-</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">    normalized_mean_absolute_error_factor, nmaef : float</span>
-</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        see `nmaef`</span>
-</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">    root_mean_square_difference, rmsd : float</span>
-</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        $\\sqrt{ \\langle (y - x)^2 \\rangle }$</span>
-</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">    covariance : float</span>
-</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        cov(x,y)</span>
-</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">    correlation_pearson, correlation, pearsonr, R, r : float</span>
-</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        Pearson linear correlation coefficient </span>
-</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">    correlation_spearman, spearmanr : float</span>
-</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        Spearman, non-parametric rank correlation coefficient</span>
-</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">    R2, r2 : float</span>
-</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        Linear coefficient of determination, $R^2$</span>
-</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>
-</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
-</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute suite of bivariate statistics during initialization</span>
-</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">        </span>
-</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        Statistic values are saved in attributes.</span>
-</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        CAUTION: Weights w are ignored except in SMA fit</span>
+</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">    std_difference, stdd : float</span>
+</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        std( y - x )</span>
+</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">    mean_absolute_difference, mad : float</span>
+</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        mean( |y-x| )</span>
+</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">    relative_mean_difference, rmd : float</span>
+</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">        md / xmean</span>
+</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">    relative_mean_absolute_difference, rmad :float</span>
+</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">        mad / xmean</span>
+</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">    standardized_mean_difference, smd : float</span>
+</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        md / xstd</span>
+</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">    standardized_mean_absolute_difference, smad : float</span>
+</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">        mad /xstd</span>
+</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">    mean_relative_difference, mrd : float</span>
+</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">        mean(y/x) - 1</span>
+</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">    mean_log10_ratio, mlr : float</span>
+</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        mean( log10(y/x) )</span>
+</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">    std_log10_ratio, stdlr : float</span>
+</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">        std( log10(y/x) )</span>
+</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">    mean_absolute_log10_ratio, malr : float</span>
+</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">        mean( abs( log10(y/x) ) )</span>
+</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">    median_difference, medd : float</span>
+</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        median(y-x)</span>
+</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">    median_absolute_difference, medad : float</span>
+</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        median(|y-x|)</span>
+</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">    relative_median_difference, rmedd : float</span>
+</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="sd">        median(y-x) / xmedian</span>
+</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">    relative_median_absolute_difference, rmedad : float</span>
+</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        median(|y-x|) / xmedian</span>
+</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">    median_relative_difference, medianrd, medrd : float</span>
+</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        median(y/x)-1</span>
+</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">    median_log10_ratio, medlr : float</span>
+</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">        median( log10(y/x) )</span>
+</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">    median_absolute_log10_ratio, medalr : float</span>
+</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        median( abs( log10(y/x) ) )</span>
+</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">    normalized_mean_bias_factor, nmbf : float</span>
+</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        see `nmbf` </span>
+</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">    normalized_mean_absolute_error_factor, nmaef : float</span>
+</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        see `nmaef`</span>
+</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">    root_mean_square_difference, rmsd : float</span>
+</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        $\\sqrt{ \\langle (y - x)^2 \\rangle }$</span>
+</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">    root_mean_square_log10_ratio, rmslr : float</span>
+</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        $\\sqrt{ \\langle log10(y/x)^2 \\rangle }$</span>
+</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">    covariance : float</span>
+</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        cov(x,y)</span>
+</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">    correlation_pearson, correlation, pearsonr, R, r : float</span>
+</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        Pearson linear correlation coefficient </span>
+</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">    correlation_spearman, spearmanr : float</span>
+</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">        Spearman, non-parametric rank correlation coefficient</span>
+</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">    R2, r2 : float</span>
+</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        Linear coefficient of determination, $R^2$</span>
+</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">    &#39;&#39;&#39;</span>
 </span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>
-</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        Parameters</span>
-</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">        ----------</span>
-</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">        x : ndarray or str</span>
-</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">            independent variable values</span>
-</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        y : ndarray or str</span>
-</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">            dependent variable values, same size as x</span>
-</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        w : ndarray or str, optional</span>
-</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">            weights for points (x,y), same size as x and y</span>
-</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        dropna : bool, optional (default=False)</span>
-</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">            drops NaN values from x, y, and w</span>
-</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        data : dict-like, optional</span>
-</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">            if x, y, or w are str, then they should be keys in data</span>
-</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>
-</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="c1"># Get values from data if needed</span>
-</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span>
-</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Data argument must be used if x, y, or w is a string&#39;</span><span class="p">)</span>
-</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
-</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
-</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
-</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>
-</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="c1">#Ensure that x and y have same length</span>
-</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
-</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Arguments x and y must have the same length&#39;</span> <span class="p">)</span>
-</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
-</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Argument w (if present) must have the same length as x&#39;</span> <span class="p">)</span>
-</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
-</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="c1"># Drop NaN values</span>
-</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
-</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>            <span class="n">isna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
-</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
-</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="c1"># Differences and ratios used repeatedly</span>
-</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
-</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="n">absdiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="p">)</span>
-</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="c1"># Ignore divide by zero and 0/0 while dividing</span>
-</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="n">old_settings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
-</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">y</span><span class="o">/</span><span class="n">x</span>
-</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="n">log10ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
-</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_settings</span><span class="p">)</span>
-</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
-</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="c1"># Number of data points</span>
-</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>
-</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="c1"># Means, medians, and standard deviations</span>
-</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ystd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
-</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="c1"># Save values for use later</span>
-</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
-</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
-</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">w</span>
-</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>
-</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="c1"># Mean and mean absolute differences</span>
-</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">md</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mad</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
-</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
-</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="c1"># Relative and standardized differences</span>
-</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_difference</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_difference</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
-</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
-</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>
-</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="c1"># Mean and median relative differences</span>
-</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_relative_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mrd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
-</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_relative_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medianrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medrd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
-</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>
-</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="c1"># Median and median absolute differences</span>
-</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
-</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
-</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>
-</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>        <span class="c1"># Relative median differences</span>
-</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
-</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
-</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>
-</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_bias_factor</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmbf</span>  <span class="o">=</span> <span class="n">nmbf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
-</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_absolute_error_factor</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmaef</span> <span class="o">=</span> <span class="n">nmaef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
+</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute suite of bivariate statistics during initialization</span>
+</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">        </span>
+</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        Statistic values are saved in attributes.</span>
+</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        CAUTION: Weights w are ignored except in SMA fit</span>
+</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>
+</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        Parameters</span>
+</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">        ----------</span>
+</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        x : ndarray or str</span>
+</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">            independent variable values</span>
+</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        y : ndarray or str</span>
+</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">            dependent variable values, same size as x</span>
+</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        w : ndarray or str, optional</span>
+</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">            weights for points (x,y), same size as x and y</span>
+</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">        dropna : bool, optional (default=False)</span>
+</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">            drops NaN values from x, y, and w</span>
+</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">        data : dict-like, optional</span>
+</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">            if x, y, or w are str, then they should be keys in data</span>
+</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>
+</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="c1"># Get values from data if needed</span>
+</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span>
+</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Data argument must be used if x, y, or w is a string&#39;</span><span class="p">)</span>
+</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
+</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
+</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
+</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>
+</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="c1">#Ensure that x and y have same length</span>
+</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
+</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Arguments x and y must have the same length&#39;</span> <span class="p">)</span>
+</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
+</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Argument w (if present) must have the same length as x&#39;</span> <span class="p">)</span>
+</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
+</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="c1"># Drop NaN values</span>
+</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
+</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>            <span class="n">isna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
+</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
+</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="c1"># Differences and ratios used repeatedly</span>
+</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
+</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="n">absdiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="p">)</span>
+</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="c1"># Ignore divide by zero and 0/0 while dividing</span>
+</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="n">old_settings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
+</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">y</span><span class="o">/</span><span class="n">x</span>
+</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="n">log10ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
+</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_settings</span><span class="p">)</span>
+</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>
+</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="c1"># Number of data points</span>
+</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>
+</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="c1"># Means, medians, and standard deviations</span>
+</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ystd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>
+</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="c1"># Save values for use later</span>
+</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
+</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
+</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">w</span>
+</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
+</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="c1"># Mean and mean absolute differences</span>
+</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">md</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mad</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
+</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">std_difference</span>             <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
+</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
+</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="c1"># Relative and standardized differences</span>
+</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_difference</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_difference</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
+</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
+</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>
+</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="c1"># Mean and median relative differences</span>
+</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_relative_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mrd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
+</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_relative_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medianrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medrd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
+</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>
+</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>        <span class="c1"># Median and median absolute differences</span>
+</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
+</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
 </span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>
-</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="c1"># Mean and mean absolute log ratio</span>
-</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
-</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">malr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        
-</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>        <span class="c1"># Median and median absolute log ratio</span>
-</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
-</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medalr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        
-</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="c1"># RMS difference</span>
-</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_difference</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsd</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
-</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="c1"># Covariance, correlation</span>
-</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_pearson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pearsonr</span> <span class="o">=</span> \
-</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation_spearman</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spearmanr</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span>
-</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">R2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span>
-</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
-</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
-</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Accesses attribute values via object[&#39;key&#39;]&#39;&#39;&#39;</span>
-</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
-</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
-</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="nf">fitline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute bivariate line fit</span>
-</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        </span>
-</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">        Parameters</span>
-</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        ----------</span>
-</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        method : str</span>
-</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">            line fitting method: sma (default), ols, wls, York, sen, siegel</span>
-</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">        intercept : bool</span>
-</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        **kwargs </span>
-</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">            passed to `acgc.stats.sma` (e.g. robust=True)</span>
-</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
-</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        Returns</span>
-</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        -------</span>
-</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        result : dict</span>
-</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">            dictionary with keys:</span>
-</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">            - slope (float)</span>
-</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">                slope of fitted line</span>
-</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">            - intercept (float)</span>
-</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">                intercept of fitted line</span>
-</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">            - fittedvalues (array (N,))</span>
-</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">                values on fit line</span>
-</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">            - residuals (array (N,))</span>
-</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">                residual from fit line</span>
-</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
-</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="n">fitintercept</span> <span class="o">=</span> <span class="n">intercept</span>
-</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
-</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;sma&#39;</span><span class="p">:</span>
-</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sma</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
-</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span>
-</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>                        <span class="n">intercept</span><span class="o">=</span><span class="n">fitintercept</span><span class="p">,</span>
-</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
-</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
-</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>            <span class="n">intercept</span><span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
-</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
-</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ols&#39;</span><span class="p">:</span>
-</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>            <span class="k">if</span> <span class="n">fitintercept</span><span class="p">:</span>
-</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
-</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>                                      <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
-</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>            <span class="k">else</span><span class="p">:</span>
-</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
-</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
-</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
-</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;theil&#39;</span><span class="p">,</span><span class="s1">&#39;sen&#39;</span><span class="p">,</span><span class="s1">&#39;theilsen&#39;</span><span class="p">]:</span>
-</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
-</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sen</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
-</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
-</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span>
-</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span>
-</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
-</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;siegel&#39;</span><span class="p">:</span>
-</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
-</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="n">siegel</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">siegelslopes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>                                         <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="p">)</span>
-</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">slope</span>
-</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">intercept</span>
-</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>
-</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;wls&#39;</span><span class="p">:</span>
-</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;WLS regression not implemented yet&#39;</span><span class="p">)</span>
+</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="c1"># Relative median differences</span>
+</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
+</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
+</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
+</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_bias_factor</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmbf</span>  <span class="o">=</span> <span class="n">nmbf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_absolute_error_factor</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmaef</span> <span class="o">=</span> <span class="n">nmaef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>
+</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="c1"># Mean and mean absolute log ratio</span>
+</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">malr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">std_log10_ratio</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdlr</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>
+</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="c1"># Median and median absolute log ratio</span>
+</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medalr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>
+</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="c1"># RMS difference</span>
+</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="c1"># RMS log ratio</span>
+</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmslr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">log10ratio</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)))</span>
+</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>
+</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>        <span class="c1"># Covariance, correlation</span>
+</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_pearson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pearsonr</span> <span class="o">=</span> \
+</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation_spearman</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spearmanr</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span>
+</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">R2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span>
+</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>
+</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
+</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Accesses attribute values via object[&#39;key&#39;]&#39;&#39;&#39;</span>
+</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
+</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>
+</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>    <span class="k">def</span> <span class="nf">fitline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute bivariate line fit</span>
+</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        </span>
+</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        Parameters</span>
+</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        ----------</span>
+</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        method : str</span>
+</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">            line fitting method: sma (default), ols, wls, York, sen, siegel</span>
+</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        intercept : bool</span>
+</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">        **kwargs </span>
+</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">            passed to `acgc.stats.sma` (e.g. robust=True)</span>
+</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>
+</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        Returns</span>
+</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        -------</span>
+</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        result : dict</span>
+</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">            dictionary with keys:</span>
+</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">            - slope (float)</span>
+</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">                slope of fitted line</span>
+</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">            - intercept (float)</span>
+</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">                intercept of fitted line</span>
+</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">            - fittedvalues (array (N,))</span>
+</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">                values on fit line</span>
+</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">            - residuals (array (N,))</span>
+</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">                residual from fit line</span>
+</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
+</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="n">fitintercept</span> <span class="o">=</span> <span class="n">intercept</span>
+</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>
+</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;sma&#39;</span><span class="p">:</span>
+</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sma</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
+</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span>
+</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>                        <span class="n">intercept</span><span class="o">=</span><span class="n">fitintercept</span><span class="p">,</span>
+</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
+</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
+</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>            <span class="n">intercept</span><span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
+</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
+</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ols&#39;</span><span class="p">:</span>
+</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="k">if</span> <span class="n">fitintercept</span><span class="p">:</span>
+</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
+</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>                                      <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
+</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>            <span class="k">else</span><span class="p">:</span>
+</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
+</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
+</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;theil&#39;</span><span class="p">,</span><span class="s1">&#39;sen&#39;</span><span class="p">,</span><span class="s1">&#39;theilsen&#39;</span><span class="p">]:</span>
+</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
+</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sen</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
+</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
+</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span>
+</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span>
 </span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>
-</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;york&#39;</span><span class="p">:</span>
-</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;York regression not implemented yet&#39;</span><span class="p">)</span>
-</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
-</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Undefined method &#39;</span><span class="o">+</span><span class="n">method</span><span class="p">)</span>
-</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
-</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">slope</span>          <span class="o">=</span> <span class="n">slope</span><span class="p">,</span>
-</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>                     <span class="n">intercept</span>      <span class="o">=</span> <span class="n">intercept</span><span class="p">,</span>
-</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>                     <span class="n">fittedvalues</span>   <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span>
-</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>                     <span class="n">residuals</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-</span> <span class="p">(</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span> <span class="p">),</span>
-</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>                     <span class="n">method</span>         <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
-</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>                     <span class="n">fitintercept</span>   <span class="o">=</span> <span class="n">fitintercept</span> <span class="p">)</span>
+</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;siegel&#39;</span><span class="p">:</span>
+</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
+</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="n">siegel</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">siegelslopes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>                                         <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="p">)</span>
+</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">slope</span>
+</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">intercept</span>
+</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>
+</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;wls&#39;</span><span class="p">:</span>
+</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;WLS regression not implemented yet&#39;</span><span class="p">)</span>
+</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>
+</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;york&#39;</span><span class="p">:</span>
+</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;York regression not implemented yet&#39;</span><span class="p">)</span>
 </span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>
-</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>        <span class="k">return</span> <span class="n">line</span>
-</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
-</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute slope of bivariate line fit</span>
-</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        </span>
-</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        Parameters</span>
-</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        ----------</span>
-</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        method : str</span>
-</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">            line fitting method: sma (default), ols, wls</span>
-</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        intercept : bool</span>
-</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        **kwargs </span>
-</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">            passed to `fitline`</span>
-</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>
-</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">        Returns</span>
-</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        -------</span>
-</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        slope : float</span>
-</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">            value of y intercept</span>
-</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
-</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>
-</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>    <span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute intercept of bivariate line fit</span>
-</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a><span class="sd">        </span>
-</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="sd">        Parameters</span>
-</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="sd">        ----------</span>
-</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">        method : str</span>
-</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">            line fitting method: sma (default) or ols</span>
-</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">        intercept : bool</span>
-</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">        **kwargs </span>
-</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="sd">            passed to `fitline`</span>
-</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
-</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">        Returns</span>
-</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        -------</span>
-</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">        intercept : float</span>
-</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">            value of y intercept</span>
-</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
-</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>
-</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>    <span class="k">def</span> <span class="nf">_expand_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variables</span><span class="p">):</span>
-</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Expand special strings into a list of variables</span>
-</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">        </span>
-</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        Parameter</span>
-</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">        ---------</span>
-</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
-</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="sd">            Special strings (&quot;all&quot;,&quot;common&quot;) will be expanded to a list of variables</span>
-</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">            list arguments will not be modified</span>
-</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>
-</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">        Returns</span>
-</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">        -------</span>
-</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">        list </span>
-</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">            variable names</span>
-</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>        <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>            <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;common&#39;</span>
-</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="k">if</span> <span class="n">variables</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
-</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>            <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;MAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMD&#39;</span><span class="p">,</span><span class="s1">&#39;RMAD&#39;</span><span class="p">,</span><span class="s1">&#39;MRD&#39;</span><span class="p">,</span><span class="s1">&#39;SMD&#39;</span><span class="p">,</span><span class="s1">&#39;SMAD&#39;</span><span class="p">,</span>
-</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>                       <span class="s1">&#39;MLR&#39;</span><span class="p">,</span><span class="s1">&#39;MALR&#39;</span><span class="p">,</span>
-</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>                       <span class="s1">&#39;MedD&#39;</span><span class="p">,</span><span class="s1">&#39;MedAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMedD&#39;</span><span class="p">,</span><span class="s1">&#39;RMedAD&#39;</span><span class="p">,</span><span class="s1">&#39;MedRD&#39;</span><span class="p">,</span>
-</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>                       <span class="s1">&#39;MedLR&#39;</span><span class="p">,</span><span class="s1">&#39;MedALR&#39;</span><span class="p">,</span>
-</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>                       <span class="s1">&#39;NMBF&#39;</span><span class="p">,</span><span class="s1">&#39;NMAEF&#39;</span><span class="p">,</span><span class="s1">&#39;RMSD&#39;</span><span class="p">,</span><span class="s1">&#39;cov&#39;</span><span class="p">,</span>
-</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>                       <span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;spearmanr&#39;</span><span class="p">,</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">,</span>
-</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>                       <span class="s1">&#39;fitline&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
-</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>        <span class="k">elif</span> <span class="n">variables</span><span class="o">==</span><span class="s1">&#39;common&#39;</span><span class="p">:</span>
-</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>            <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;MAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMD&#39;</span><span class="p">,</span><span class="s1">&#39;RMAD&#39;</span><span class="p">,</span><span class="s1">&#39;MRD&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
-</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
-</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
-</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>                <span class="s1">&#39;variables must be a list, None, or one of these strings: &quot;all&quot;,&quot;common&quot;&#39;</span><span class="p">)</span>
-</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>
-</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="n">variables</span>
-</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>
-</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>    <span class="k">def</span> <span class="nf">summary_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">):</span>
-</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics into a dict</span>
-</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>
-</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">        Parameters</span>
-</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">        ----------</span>
-</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
-</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">        </span>
-</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">        Returns</span>
-</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        -------</span>
-</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        summary : dict</span>
-</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">            names and values of variables</span>
-</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>
-</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="c1"># List of variables</span>
-</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
-</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>        <span class="k">if</span> <span class="n">fitline_kw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>            <span class="n">fitline_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span>
-</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>                          <span class="s1">&#39;intercept&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
-</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>
-</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="c1"># Construct the dict</span>
-</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>        <span class="n">summary</span> <span class="o">=</span> <span class="p">{}</span>
-</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
-</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">]:</span>
-</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>                <span class="c1"># These variables are object methods</span>
-</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
-</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
-</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>            <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="s1">&#39;fitline&#39;</span><span class="p">:</span>
-</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
-</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>                <span class="n">v</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">bivariate_line_equation</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">floatformat_fiteqn</span><span class="p">,</span><span class="n">ystring</span><span class="o">=</span><span class="s1">&#39;separate&#39;</span><span class="p">)</span>
-</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>            <span class="k">else</span><span class="p">:</span>
-</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>                <span class="c1"># Retrieve values</span>
-</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
-</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>
-</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>            <span class="c1"># summary += (stringformat+&#39;=&#39;+floatformat+&#39;\n&#39;).format(v,value)</span>
-</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>            <span class="n">summary</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
-</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>
-</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>        <span class="k">return</span> <span class="n">summary</span>
-</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>
-</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>                <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>                <span class="n">stringlength</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
-</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics</span>
+</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Undefined method &#39;</span><span class="o">+</span><span class="n">method</span><span class="p">)</span>
+</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
+</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">slope</span>          <span class="o">=</span> <span class="n">slope</span><span class="p">,</span>
+</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>                     <span class="n">intercept</span>      <span class="o">=</span> <span class="n">intercept</span><span class="p">,</span>
+</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>                     <span class="n">fittedvalues</span>   <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span>
+</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>                     <span class="n">residuals</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-</span> <span class="p">(</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span> <span class="p">),</span>
+</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>                     <span class="n">method</span>         <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
+</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>                     <span class="n">fitintercept</span>   <span class="o">=</span> <span class="n">fitintercept</span> <span class="p">)</span>
+</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>
+</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="k">return</span> <span class="n">line</span>
+</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>
+</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute slope of bivariate line fit</span>
+</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">        </span>
+</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        Parameters</span>
+</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        ----------</span>
+</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        method : str</span>
+</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">            line fitting method: sma (default), ols, wls</span>
+</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">        intercept : bool</span>
+</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">        **kwargs </span>
+</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">            passed to `fitline`</span>
+</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
+</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="sd">        Returns</span>
+</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="sd">        -------</span>
+</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">        slope : float</span>
+</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">            value of y intercept</span>
+</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
+</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>
+</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>    <span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute intercept of bivariate line fit</span>
+</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">        </span>
+</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        Parameters</span>
+</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">        ----------</span>
+</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">        method : str</span>
+</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">            line fitting method: sma (default) or ols</span>
+</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">        intercept : bool</span>
+</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a><span class="sd">        **kwargs </span>
+</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">            passed to `fitline`</span>
+</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
+</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        Returns</span>
+</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">        -------</span>
+</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">        intercept : float</span>
+</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="sd">            value of y intercept</span>
+</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
+</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>
+</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>    <span class="k">def</span> <span class="nf">_expand_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variables</span><span class="p">):</span>
+</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Expand special strings into a list of variables</span>
+</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">        </span>
+</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        Parameter</span>
+</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        ---------</span>
+</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
+</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">            Special strings (&quot;all&quot;,&quot;common&quot;) will be expanded to a list of variables</span>
+</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">            list arguments will not be modified</span>
+</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>
+</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        Returns</span>
+</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        -------</span>
+</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        list </span>
+</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">            variable names</span>
+</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>        <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>            <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;common&#39;</span>
+</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="n">variables</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
+</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>            <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;MAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMD&#39;</span><span class="p">,</span><span class="s1">&#39;RMAD&#39;</span><span class="p">,</span><span class="s1">&#39;MRD&#39;</span><span class="p">,</span><span class="s1">&#39;SMD&#39;</span><span class="p">,</span><span class="s1">&#39;SMAD&#39;</span><span class="p">,</span>
+</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>                       <span class="s1">&#39;MLR&#39;</span><span class="p">,</span><span class="s1">&#39;MALR&#39;</span><span class="p">,</span>
+</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>                       <span class="s1">&#39;MedD&#39;</span><span class="p">,</span><span class="s1">&#39;MedAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMedD&#39;</span><span class="p">,</span><span class="s1">&#39;RMedAD&#39;</span><span class="p">,</span><span class="s1">&#39;MedRD&#39;</span><span class="p">,</span>
+</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>                       <span class="s1">&#39;MedLR&#39;</span><span class="p">,</span><span class="s1">&#39;MedALR&#39;</span><span class="p">,</span>
+</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>                       <span class="s1">&#39;NMBF&#39;</span><span class="p">,</span><span class="s1">&#39;NMAEF&#39;</span><span class="p">,</span><span class="s1">&#39;RMSD&#39;</span><span class="p">,</span><span class="s1">&#39;cov&#39;</span><span class="p">,</span>
+</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                       <span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;spearmanr&#39;</span><span class="p">,</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">,</span>
+</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>                       <span class="s1">&#39;fitline&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
+</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>        <span class="k">elif</span> <span class="n">variables</span><span class="o">==</span><span class="s1">&#39;common&#39;</span><span class="p">:</span>
+</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>            <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;MAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMD&#39;</span><span class="p">,</span><span class="s1">&#39;RMAD&#39;</span><span class="p">,</span><span class="s1">&#39;MRD&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
+</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
+</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
+</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>                <span class="s1">&#39;variables must be a list, None, or one of these strings: &quot;all&quot;,&quot;common&quot;&#39;</span><span class="p">)</span>
+</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>
+</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>        <span class="k">return</span> <span class="n">variables</span>
+</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>
+</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>    <span class="k">def</span> <span class="nf">summary_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">):</span>
+</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics into a dict</span>
+</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>
+</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">        Parameters</span>
+</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        ----------</span>
+</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
+</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">        </span>
+</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">        Returns</span>
+</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">        -------</span>
+</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">        summary : dict</span>
+</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">            names and values of variables</span>
+</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>
+</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>        <span class="c1"># List of variables</span>
+</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>
+</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>        <span class="k">if</span> <span class="n">fitline_kw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>            <span class="n">fitline_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span>
+</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>                          <span class="s1">&#39;intercept&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
+</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>
+</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>        <span class="c1"># Construct the dict</span>
+</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>        <span class="n">summary</span> <span class="o">=</span> <span class="p">{}</span>
+</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
+</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">]:</span>
+</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>                <span class="c1"># These variables are object methods</span>
+</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
+</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
+</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>            <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="s1">&#39;fitline&#39;</span><span class="p">:</span>
+</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
+</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>                <span class="n">v</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">bivariate_line_equation</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">floatformat_fiteqn</span><span class="p">,</span><span class="n">ystring</span><span class="o">=</span><span class="s1">&#39;separate&#39;</span><span class="p">)</span>
+</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>            <span class="k">else</span><span class="p">:</span>
+</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>                <span class="c1"># Retrieve values</span>
+</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
 </span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>
-</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="sd">        Parameters</span>
-</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">        ----------</span>
-</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
-</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
-</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a><span class="sd">            format specifier for integer values</span>
-</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a><span class="sd">        floatformat : str, default=&#39;{:.4f}&#39;</span>
-</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a><span class="sd">            format specifier for floating point values</span>
-</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a><span class="sd">        stringlength : int, default=None</span>
-</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a><span class="sd">            length of the variables on output</span>
-</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a><span class="sd">            default (None) is to use the length of the longest variable name</span>
-</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="sd">        </span>
-</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">        Returns</span>
-</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">        -------</span>
-</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">        summary : str</span>
-</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="sd">            names and values of variables</span>
-</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>        <span class="c1"># List of variables</span>
-</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>
-</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
-</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>        <span class="k">if</span> <span class="n">stringlength</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>            <span class="n">stringlength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">])</span>
-</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>        <span class="n">stringformat</span> <span class="o">=</span> <span class="s1">&#39;{:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">stringlength</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s}&#39;</span>
-</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>
-</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
-</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
-</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>
-</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>        <span class="c1"># Extract length of the float numbers from floatformat</span>
-</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>        <span class="c1"># import re</span>
-</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>        <span class="c1"># floatlength = np.floor( float( re.findall(&quot;[-+]?(?:\d*\.*\d+)&quot;,</span>
-</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="c1">#       floatformat )[0] ) ).astype(int)</span>
-</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>
-</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>        <span class="c1"># summary = (stringformat+&#39;{:&gt;10s}&#39;).format(&#39;Variable&#39;,&#39;Value&#39;)</span>
-</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>        <span class="n">summarytext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
-</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
-</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>            <span class="n">vstr</span> <span class="o">=</span> <span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
-</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>            <span class="n">summarytext</span> <span class="o">+=</span> <span class="p">(</span><span class="n">stringformat</span><span class="o">+</span><span class="s1">&#39; = </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">vstr</span><span class="p">)</span>
-</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>
-</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>        <span class="k">return</span> <span class="n">summarytext</span>
-</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>
-</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>    <span class="k">def</span> <span class="nf">summary_fig_inset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>                          <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>                          <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc_units</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span>
-</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Display bivariate statistics as a table inset on a plot axis</span>
-</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>
-</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a><span class="sd">        Parameters</span>
-</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a><span class="sd">        ----------</span>
-</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a><span class="sd">        ax : matplotlib.Figure.Axis </span>
-</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a><span class="sd">            axis where the table will be displayed</span>
-</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
-</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
-</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="sd">            format specifier for integer values</span>
-</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a><span class="sd">        floatformat : str, default=&#39;{:.3f}&#39;</span>
-</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a><span class="sd">            format specifier for floating point values</span>
-</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a><span class="sd">        loc : tuple (x0,y0), default=(0.85, 0.05)</span>
-</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a><span class="sd">            location on the axis where the table will be drawn</span>
-</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a><span class="sd">            can be in data units or axes units [0-1]</span>
-</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a><span class="sd">        loc_units : {&#39;axes&#39; (default), &#39;data&#39;}</span>
-</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a><span class="sd">            specifies whether loc has &#39;data&#39; units or &#39;axes&#39; units [0-1]</span>
-</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a><span class="sd">                    </span>
-</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a><span class="sd">        Returns</span>
-</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a><span class="sd">        -------</span>
-</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a><span class="sd">        text1, text2 : matplotlib text object</span>
-</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a><span class="sd">            Artist for the two text boxes        </span>
-</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>        <span class="c1"># List of variables</span>
-</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>
-</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
-</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>
-</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>        <span class="c1"># Default location in lower right corner</span>
-</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>        <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>            <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
-</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>
-</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>        <span class="c1"># Coordinates for loc</span>
-</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>        <span class="k">if</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;data&#39;</span><span class="p">:</span>
-</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
-</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>        <span class="k">elif</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span><span class="s1">&#39;axis&#39;</span><span class="p">]:</span>
-</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
-</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Display units should be &quot;Data&quot; or &quot;Axes&quot;&#39;</span><span class="p">)</span>
-</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>
-</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
-</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
-</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>
-</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>        <span class="c1"># Column of label text</span>
-</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>        <span class="n">label_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_texify_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
-</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>                                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="p">])</span>
-</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>        <span class="c1"># Column of value text</span>
-</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>        <span class="n">value_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
-</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>                                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
+</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>            <span class="c1"># summary += (stringformat+&#39;=&#39;+floatformat+&#39;\n&#39;).format(v,value)</span>
+</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>            <span class="n">summary</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
+</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>
+</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>        <span class="k">return</span> <span class="n">summary</span>
+</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
+</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>                <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>                <span class="n">stringlength</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
+</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics</span>
+</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>
+</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">        Parameters</span>
+</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a><span class="sd">        ----------</span>
+</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
+</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
+</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">            format specifier for integer values</span>
+</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">        floatformat : str, default=&#39;{:.4f}&#39;</span>
+</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="sd">            format specifier for floating point values</span>
+</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a><span class="sd">        stringlength : int, default=None</span>
+</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="sd">            length of the variables on output</span>
+</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">            default (None) is to use the length of the longest variable name</span>
+</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">        </span>
+</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        Returns</span>
+</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        -------</span>
+</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">        summary : str</span>
+</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">            names and values of variables</span>
+</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>        <span class="c1"># List of variables</span>
+</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>
+</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
+</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="k">if</span> <span class="n">stringlength</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>            <span class="n">stringlength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">])</span>
+</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>        <span class="n">stringformat</span> <span class="o">=</span> <span class="s1">&#39;{:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">stringlength</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s}&#39;</span>
+</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
+</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
+</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
+</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>
+</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>        <span class="c1"># Extract length of the float numbers from floatformat</span>
+</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>        <span class="c1"># import re</span>
+</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>        <span class="c1"># floatlength = np.floor( float( re.findall(&quot;[-+]?(?:\d*\.*\d+)&quot;,</span>
+</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>        <span class="c1">#       floatformat )[0] ) ).astype(int)</span>
+</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>
+</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>        <span class="c1"># summary = (stringformat+&#39;{:&gt;10s}&#39;).format(&#39;Variable&#39;,&#39;Value&#39;)</span>
+</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>        <span class="n">summarytext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
+</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
+</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>            <span class="n">vstr</span> <span class="o">=</span> <span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
+</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>            <span class="n">summarytext</span> <span class="o">+=</span> <span class="p">(</span><span class="n">stringformat</span><span class="o">+</span><span class="s1">&#39; = </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">vstr</span><span class="p">)</span>
+</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>
+</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>        <span class="k">return</span> <span class="n">summarytext</span>
+</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>
+</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>    <span class="k">def</span> <span class="nf">summary_fig_inset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>                          <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>                          <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc_units</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span>
+</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Display bivariate statistics as a table inset on a plot axis</span>
+</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>
+</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="sd">        Parameters</span>
+</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a><span class="sd">        ----------</span>
+</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="sd">        ax : matplotlib.Figure.Axis </span>
+</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="sd">            axis where the table will be displayed</span>
+</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
+</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
+</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a><span class="sd">            format specifier for integer values</span>
+</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a><span class="sd">        floatformat : str, default=&#39;{:.3f}&#39;</span>
+</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a><span class="sd">            format specifier for floating point values</span>
+</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a><span class="sd">        loc : tuple (x0,y0), default=(0.85, 0.05)</span>
+</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a><span class="sd">            location on the axis where the table will be drawn</span>
+</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a><span class="sd">            can be in data units or axes units [0-1]</span>
+</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a><span class="sd">        loc_units : {&#39;axes&#39; (default), &#39;data&#39;}</span>
+</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a><span class="sd">            specifies whether loc has &#39;data&#39; units or &#39;axes&#39; units [0-1]</span>
+</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a><span class="sd">                    </span>
+</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a><span class="sd">        Returns</span>
+</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a><span class="sd">        -------</span>
+</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a><span class="sd">        text1, text2 : matplotlib text object</span>
+</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a><span class="sd">            Artist for the two text boxes        </span>
+</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>        <span class="c1"># List of variables</span>
+</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>
+</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
+</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>
+</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>        <span class="c1"># Default location in lower right corner</span>
+</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>        <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>            <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
+</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>
+</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>        <span class="c1"># Coordinates for loc</span>
+</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>        <span class="k">if</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;data&#39;</span><span class="p">:</span>
+</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
+</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>        <span class="k">elif</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span><span class="s1">&#39;axis&#39;</span><span class="p">]:</span>
+</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
+</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Display units should be &quot;Data&quot; or &quot;Axes&quot;&#39;</span><span class="p">)</span>
 </span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>
-</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>        <span class="c1"># Check if horizontal alignment keyword is used</span>
-</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
-</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>        <span class="k">try</span><span class="p">:</span>
-</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span>
-</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
-</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>            <span class="k">pass</span>
-</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>        <span class="k">try</span><span class="p">:</span>
-</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;horizontalalignment&#39;</span><span class="p">]</span>
-</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
-</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>            <span class="k">pass</span>
-</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>
-</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>        <span class="c1"># For right alignment, align on values first</span>
-</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>        <span class="c1"># Otherwise, align on labels</span>
-</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>        <span class="k">if</span> <span class="n">ha</span><span class="o">==</span><span class="s1">&#39;right&#39;</span><span class="p">:</span>
-</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">value_text</span>
-</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">label_text</span>
-</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
-</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">label_text</span>
-</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">value_text</span>
-</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
-</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>
-</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>        <span class="c1"># Add first column of text</span>
-</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>        <span class="n">t1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
-</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>                <span class="n">first_text</span><span class="p">,</span>
-</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>                <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
-</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>                <span class="o">**</span><span class="n">kwargs</span>
-</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>                <span class="p">)</span>
-</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>
-</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>        <span class="c1"># Get width of first text column</span>
-</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
-</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span><span class="o">-</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span>
-</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>
-</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>        <span class="c1"># Add second column of text</span>
-</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">width</span><span class="o">*</span><span class="n">sign</span><span class="p">,</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
-</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>                     <span class="n">second_text</span><span class="p">,</span>
-</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>                     <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
-</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>                     <span class="o">**</span><span class="n">kwargs</span>
-</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>                     <span class="p">)</span>
-</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>
-</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>        <span class="c1">##################################</span>
-</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>        <span class="c1"># Early version of this function using matplotlib.table.table()</span>
+</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
+</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
+</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>
+</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>        <span class="c1"># Column of label text</span>
+</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>        <span class="n">label_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_texify_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
+</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>                                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="p">])</span>
+</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>        <span class="c1"># Column of value text</span>
+</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>        <span class="n">value_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
+</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>                                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
+</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>
+</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>        <span class="c1"># Check if horizontal alignment keyword is used</span>
+</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
+</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>        <span class="k">try</span><span class="p">:</span>
+</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span>
+</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
+</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>            <span class="k">pass</span>
+</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>        <span class="k">try</span><span class="p">:</span>
+</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;horizontalalignment&#39;</span><span class="p">]</span>
+</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
+</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>            <span class="k">pass</span>
+</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>
+</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>        <span class="c1"># For right alignment, align on values first</span>
+</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>        <span class="c1"># Otherwise, align on labels</span>
+</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>        <span class="k">if</span> <span class="n">ha</span><span class="o">==</span><span class="s1">&#39;right&#39;</span><span class="p">:</span>
+</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">value_text</span>
+</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">label_text</span>
+</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
+</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">label_text</span>
+</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">value_text</span>
+</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
+</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>
+</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>        <span class="c1"># Add first column of text</span>
+</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>        <span class="n">t1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
+</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>                <span class="n">first_text</span><span class="p">,</span>
+</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>                <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
+</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>                <span class="o">**</span><span class="n">kwargs</span>
+</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>                <span class="p">)</span>
+</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>
+</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>        <span class="c1"># Get width of first text column</span>
+</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
+</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span><span class="o">-</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span>
 </span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>
-</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>        <span class="c1"># if isinstance(loc,(tuple,list)):</span>
-</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>        <span class="c1">#     # Create an inset axis to contain the table</span>
-</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>        <span class="c1">#     tableaxis = ax.inset_axes(loc)</span>
-</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>        <span class="c1">#     table_width=1</span>
-</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>        <span class="c1"># else:</span>
-</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>        <span class="c1">#     tableaxis = ax</span>
+</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>        <span class="c1"># Add second column of text</span>
+</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">width</span><span class="o">*</span><span class="n">sign</span><span class="p">,</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
+</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>                     <span class="n">second_text</span><span class="p">,</span>
+</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>                     <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
+</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>                     <span class="o">**</span><span class="n">kwargs</span>
+</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>                     <span class="p">)</span>
 </span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>
-</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>        <span class="c1"># # Display the table on the axis</span>
-</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>        <span class="c1"># return mtable.table(</span>
-</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>        <span class="c1">#     tableaxis,</span>
-</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>        <span class="c1">#     cellText=[[floatformat.format(value)] for value in summarydict.values()],</span>
-</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>        <span class="c1">#     rowLabels=[texify_name(key) for key in summarydict],</span>
-</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>        <span class="c1">#     colWidths=[table_width/2]*2,</span>
-</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>        <span class="c1">#     edges=edges,</span>
-</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>        <span class="c1">#     loc=loc, bbox=bbox</span>
-</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>        <span class="c1">#     )</span>
+</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>        <span class="c1">##################################</span>
+</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>        <span class="c1"># Early version of this function using matplotlib.table.table()</span>
+</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>
+</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>        <span class="c1"># if isinstance(loc,(tuple,list)):</span>
+</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>        <span class="c1">#     # Create an inset axis to contain the table</span>
+</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>        <span class="c1">#     tableaxis = ax.inset_axes(loc)</span>
+</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>        <span class="c1">#     table_width=1</span>
+</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>        <span class="c1"># else:</span>
+</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>        <span class="c1">#     tableaxis = ax</span>
 </span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>
-</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">]</span>
+</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>        <span class="c1"># # Display the table on the axis</span>
+</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>        <span class="c1"># return mtable.table(</span>
+</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>        <span class="c1">#     tableaxis,</span>
+</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>        <span class="c1">#     cellText=[[floatformat.format(value)] for value in summarydict.values()],</span>
+</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>        <span class="c1">#     rowLabels=[texify_name(key) for key in summarydict],</span>
+</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>        <span class="c1">#     colWidths=[table_width/2]*2,</span>
+</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>        <span class="c1">#     edges=edges,</span>
+</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a>        <span class="c1">#     loc=loc, bbox=bbox</span>
+</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>        <span class="c1">#     )</span>
+</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>
+</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">]</span>
 </span></pre></div>
 
 
             </section>
                 <section id="BivariateStatistics">
                             <input id="BivariateStatistics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
 <div class="attr class">
@@ -908,553 +918,563 @@
 </span><span id="BivariateStatistics-198"><a href="#BivariateStatistics-198"><span class="linenos">198</span></a><span class="sd">        mean of x and y variables</span>
 </span><span id="BivariateStatistics-199"><a href="#BivariateStatistics-199"><span class="linenos">199</span></a><span class="sd">    xmedian, ymedian :float</span>
 </span><span id="BivariateStatistics-200"><a href="#BivariateStatistics-200"><span class="linenos">200</span></a><span class="sd">        median of x and y variables</span>
 </span><span id="BivariateStatistics-201"><a href="#BivariateStatistics-201"><span class="linenos">201</span></a><span class="sd">    xstd, ystd : float</span>
 </span><span id="BivariateStatistics-202"><a href="#BivariateStatistics-202"><span class="linenos">202</span></a><span class="sd">        standard deviation of x and y variables</span>
 </span><span id="BivariateStatistics-203"><a href="#BivariateStatistics-203"><span class="linenos">203</span></a><span class="sd">    mean_difference, md : float</span>
 </span><span id="BivariateStatistics-204"><a href="#BivariateStatistics-204"><span class="linenos">204</span></a><span class="sd">        ymean - xmean</span>
-</span><span id="BivariateStatistics-205"><a href="#BivariateStatistics-205"><span class="linenos">205</span></a><span class="sd">    mean_absolute_difference, mad : float</span>
-</span><span id="BivariateStatistics-206"><a href="#BivariateStatistics-206"><span class="linenos">206</span></a><span class="sd">        mean( |y-x| )</span>
-</span><span id="BivariateStatistics-207"><a href="#BivariateStatistics-207"><span class="linenos">207</span></a><span class="sd">    relative_mean_difference, rmd : float</span>
-</span><span id="BivariateStatistics-208"><a href="#BivariateStatistics-208"><span class="linenos">208</span></a><span class="sd">        md / xmean</span>
-</span><span id="BivariateStatistics-209"><a href="#BivariateStatistics-209"><span class="linenos">209</span></a><span class="sd">    relative_mean_absolute_difference, rmad :float</span>
-</span><span id="BivariateStatistics-210"><a href="#BivariateStatistics-210"><span class="linenos">210</span></a><span class="sd">        mad / xmean</span>
-</span><span id="BivariateStatistics-211"><a href="#BivariateStatistics-211"><span class="linenos">211</span></a><span class="sd">    standardized_mean_difference, smd : float</span>
-</span><span id="BivariateStatistics-212"><a href="#BivariateStatistics-212"><span class="linenos">212</span></a><span class="sd">        md / xstd</span>
-</span><span id="BivariateStatistics-213"><a href="#BivariateStatistics-213"><span class="linenos">213</span></a><span class="sd">    standardized_mean_absolute_difference, smad : float</span>
-</span><span id="BivariateStatistics-214"><a href="#BivariateStatistics-214"><span class="linenos">214</span></a><span class="sd">        mad /xstd</span>
-</span><span id="BivariateStatistics-215"><a href="#BivariateStatistics-215"><span class="linenos">215</span></a><span class="sd">    mean_relative_difference, mrd : float</span>
-</span><span id="BivariateStatistics-216"><a href="#BivariateStatistics-216"><span class="linenos">216</span></a><span class="sd">        mean(y/x) - 1</span>
-</span><span id="BivariateStatistics-217"><a href="#BivariateStatistics-217"><span class="linenos">217</span></a><span class="sd">    mean_log10_ratio, mlr : float</span>
-</span><span id="BivariateStatistics-218"><a href="#BivariateStatistics-218"><span class="linenos">218</span></a><span class="sd">        mean( log10(y/x) )</span>
-</span><span id="BivariateStatistics-219"><a href="#BivariateStatistics-219"><span class="linenos">219</span></a><span class="sd">    mean_absolute_log10_ratio, malr : float</span>
-</span><span id="BivariateStatistics-220"><a href="#BivariateStatistics-220"><span class="linenos">220</span></a><span class="sd">        mean( abs( log10(y/x) ) )</span>
-</span><span id="BivariateStatistics-221"><a href="#BivariateStatistics-221"><span class="linenos">221</span></a><span class="sd">    median_difference, medd : float</span>
-</span><span id="BivariateStatistics-222"><a href="#BivariateStatistics-222"><span class="linenos">222</span></a><span class="sd">        median(y-x)</span>
-</span><span id="BivariateStatistics-223"><a href="#BivariateStatistics-223"><span class="linenos">223</span></a><span class="sd">    median_absolute_difference, medad : float</span>
-</span><span id="BivariateStatistics-224"><a href="#BivariateStatistics-224"><span class="linenos">224</span></a><span class="sd">        median(|y-x|)</span>
-</span><span id="BivariateStatistics-225"><a href="#BivariateStatistics-225"><span class="linenos">225</span></a><span class="sd">    relative_median_difference, rmedd : float</span>
-</span><span id="BivariateStatistics-226"><a href="#BivariateStatistics-226"><span class="linenos">226</span></a><span class="sd">        median(y-x) / xmedian</span>
-</span><span id="BivariateStatistics-227"><a href="#BivariateStatistics-227"><span class="linenos">227</span></a><span class="sd">    relative_median_absolute_difference, rmedad : float</span>
-</span><span id="BivariateStatistics-228"><a href="#BivariateStatistics-228"><span class="linenos">228</span></a><span class="sd">        median(|y-x|) / xmedian</span>
-</span><span id="BivariateStatistics-229"><a href="#BivariateStatistics-229"><span class="linenos">229</span></a><span class="sd">    median_relative_difference, medianrd, medrd : float</span>
-</span><span id="BivariateStatistics-230"><a href="#BivariateStatistics-230"><span class="linenos">230</span></a><span class="sd">        median(y/x)-1</span>
-</span><span id="BivariateStatistics-231"><a href="#BivariateStatistics-231"><span class="linenos">231</span></a><span class="sd">    median_log10_ratio, medlr : float</span>
-</span><span id="BivariateStatistics-232"><a href="#BivariateStatistics-232"><span class="linenos">232</span></a><span class="sd">        median( log10(y/x) )</span>
-</span><span id="BivariateStatistics-233"><a href="#BivariateStatistics-233"><span class="linenos">233</span></a><span class="sd">    median_absolute_log10_ratio, medalr : float</span>
-</span><span id="BivariateStatistics-234"><a href="#BivariateStatistics-234"><span class="linenos">234</span></a><span class="sd">        median( abs( log10(y/x) ) )</span>
-</span><span id="BivariateStatistics-235"><a href="#BivariateStatistics-235"><span class="linenos">235</span></a><span class="sd">    normalized_mean_bias_factor, nmbf : float</span>
-</span><span id="BivariateStatistics-236"><a href="#BivariateStatistics-236"><span class="linenos">236</span></a><span class="sd">        see `nmbf` </span>
-</span><span id="BivariateStatistics-237"><a href="#BivariateStatistics-237"><span class="linenos">237</span></a><span class="sd">    normalized_mean_absolute_error_factor, nmaef : float</span>
-</span><span id="BivariateStatistics-238"><a href="#BivariateStatistics-238"><span class="linenos">238</span></a><span class="sd">        see `nmaef`</span>
-</span><span id="BivariateStatistics-239"><a href="#BivariateStatistics-239"><span class="linenos">239</span></a><span class="sd">    root_mean_square_difference, rmsd : float</span>
-</span><span id="BivariateStatistics-240"><a href="#BivariateStatistics-240"><span class="linenos">240</span></a><span class="sd">        $\\sqrt{ \\langle (y - x)^2 \\rangle }$</span>
-</span><span id="BivariateStatistics-241"><a href="#BivariateStatistics-241"><span class="linenos">241</span></a><span class="sd">    covariance : float</span>
-</span><span id="BivariateStatistics-242"><a href="#BivariateStatistics-242"><span class="linenos">242</span></a><span class="sd">        cov(x,y)</span>
-</span><span id="BivariateStatistics-243"><a href="#BivariateStatistics-243"><span class="linenos">243</span></a><span class="sd">    correlation_pearson, correlation, pearsonr, R, r : float</span>
-</span><span id="BivariateStatistics-244"><a href="#BivariateStatistics-244"><span class="linenos">244</span></a><span class="sd">        Pearson linear correlation coefficient </span>
-</span><span id="BivariateStatistics-245"><a href="#BivariateStatistics-245"><span class="linenos">245</span></a><span class="sd">    correlation_spearman, spearmanr : float</span>
-</span><span id="BivariateStatistics-246"><a href="#BivariateStatistics-246"><span class="linenos">246</span></a><span class="sd">        Spearman, non-parametric rank correlation coefficient</span>
-</span><span id="BivariateStatistics-247"><a href="#BivariateStatistics-247"><span class="linenos">247</span></a><span class="sd">    R2, r2 : float</span>
-</span><span id="BivariateStatistics-248"><a href="#BivariateStatistics-248"><span class="linenos">248</span></a><span class="sd">        Linear coefficient of determination, $R^2$</span>
-</span><span id="BivariateStatistics-249"><a href="#BivariateStatistics-249"><span class="linenos">249</span></a><span class="sd">    &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-250"><a href="#BivariateStatistics-250"><span class="linenos">250</span></a>
-</span><span id="BivariateStatistics-251"><a href="#BivariateStatistics-251"><span class="linenos">251</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
-</span><span id="BivariateStatistics-252"><a href="#BivariateStatistics-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute suite of bivariate statistics during initialization</span>
-</span><span id="BivariateStatistics-253"><a href="#BivariateStatistics-253"><span class="linenos">253</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics-254"><a href="#BivariateStatistics-254"><span class="linenos">254</span></a><span class="sd">        Statistic values are saved in attributes.</span>
-</span><span id="BivariateStatistics-255"><a href="#BivariateStatistics-255"><span class="linenos">255</span></a><span class="sd">        CAUTION: Weights w are ignored except in SMA fit</span>
+</span><span id="BivariateStatistics-205"><a href="#BivariateStatistics-205"><span class="linenos">205</span></a><span class="sd">    std_difference, stdd : float</span>
+</span><span id="BivariateStatistics-206"><a href="#BivariateStatistics-206"><span class="linenos">206</span></a><span class="sd">        std( y - x )</span>
+</span><span id="BivariateStatistics-207"><a href="#BivariateStatistics-207"><span class="linenos">207</span></a><span class="sd">    mean_absolute_difference, mad : float</span>
+</span><span id="BivariateStatistics-208"><a href="#BivariateStatistics-208"><span class="linenos">208</span></a><span class="sd">        mean( |y-x| )</span>
+</span><span id="BivariateStatistics-209"><a href="#BivariateStatistics-209"><span class="linenos">209</span></a><span class="sd">    relative_mean_difference, rmd : float</span>
+</span><span id="BivariateStatistics-210"><a href="#BivariateStatistics-210"><span class="linenos">210</span></a><span class="sd">        md / xmean</span>
+</span><span id="BivariateStatistics-211"><a href="#BivariateStatistics-211"><span class="linenos">211</span></a><span class="sd">    relative_mean_absolute_difference, rmad :float</span>
+</span><span id="BivariateStatistics-212"><a href="#BivariateStatistics-212"><span class="linenos">212</span></a><span class="sd">        mad / xmean</span>
+</span><span id="BivariateStatistics-213"><a href="#BivariateStatistics-213"><span class="linenos">213</span></a><span class="sd">    standardized_mean_difference, smd : float</span>
+</span><span id="BivariateStatistics-214"><a href="#BivariateStatistics-214"><span class="linenos">214</span></a><span class="sd">        md / xstd</span>
+</span><span id="BivariateStatistics-215"><a href="#BivariateStatistics-215"><span class="linenos">215</span></a><span class="sd">    standardized_mean_absolute_difference, smad : float</span>
+</span><span id="BivariateStatistics-216"><a href="#BivariateStatistics-216"><span class="linenos">216</span></a><span class="sd">        mad /xstd</span>
+</span><span id="BivariateStatistics-217"><a href="#BivariateStatistics-217"><span class="linenos">217</span></a><span class="sd">    mean_relative_difference, mrd : float</span>
+</span><span id="BivariateStatistics-218"><a href="#BivariateStatistics-218"><span class="linenos">218</span></a><span class="sd">        mean(y/x) - 1</span>
+</span><span id="BivariateStatistics-219"><a href="#BivariateStatistics-219"><span class="linenos">219</span></a><span class="sd">    mean_log10_ratio, mlr : float</span>
+</span><span id="BivariateStatistics-220"><a href="#BivariateStatistics-220"><span class="linenos">220</span></a><span class="sd">        mean( log10(y/x) )</span>
+</span><span id="BivariateStatistics-221"><a href="#BivariateStatistics-221"><span class="linenos">221</span></a><span class="sd">    std_log10_ratio, stdlr : float</span>
+</span><span id="BivariateStatistics-222"><a href="#BivariateStatistics-222"><span class="linenos">222</span></a><span class="sd">        std( log10(y/x) )</span>
+</span><span id="BivariateStatistics-223"><a href="#BivariateStatistics-223"><span class="linenos">223</span></a><span class="sd">    mean_absolute_log10_ratio, malr : float</span>
+</span><span id="BivariateStatistics-224"><a href="#BivariateStatistics-224"><span class="linenos">224</span></a><span class="sd">        mean( abs( log10(y/x) ) )</span>
+</span><span id="BivariateStatistics-225"><a href="#BivariateStatistics-225"><span class="linenos">225</span></a><span class="sd">    median_difference, medd : float</span>
+</span><span id="BivariateStatistics-226"><a href="#BivariateStatistics-226"><span class="linenos">226</span></a><span class="sd">        median(y-x)</span>
+</span><span id="BivariateStatistics-227"><a href="#BivariateStatistics-227"><span class="linenos">227</span></a><span class="sd">    median_absolute_difference, medad : float</span>
+</span><span id="BivariateStatistics-228"><a href="#BivariateStatistics-228"><span class="linenos">228</span></a><span class="sd">        median(|y-x|)</span>
+</span><span id="BivariateStatistics-229"><a href="#BivariateStatistics-229"><span class="linenos">229</span></a><span class="sd">    relative_median_difference, rmedd : float</span>
+</span><span id="BivariateStatistics-230"><a href="#BivariateStatistics-230"><span class="linenos">230</span></a><span class="sd">        median(y-x) / xmedian</span>
+</span><span id="BivariateStatistics-231"><a href="#BivariateStatistics-231"><span class="linenos">231</span></a><span class="sd">    relative_median_absolute_difference, rmedad : float</span>
+</span><span id="BivariateStatistics-232"><a href="#BivariateStatistics-232"><span class="linenos">232</span></a><span class="sd">        median(|y-x|) / xmedian</span>
+</span><span id="BivariateStatistics-233"><a href="#BivariateStatistics-233"><span class="linenos">233</span></a><span class="sd">    median_relative_difference, medianrd, medrd : float</span>
+</span><span id="BivariateStatistics-234"><a href="#BivariateStatistics-234"><span class="linenos">234</span></a><span class="sd">        median(y/x)-1</span>
+</span><span id="BivariateStatistics-235"><a href="#BivariateStatistics-235"><span class="linenos">235</span></a><span class="sd">    median_log10_ratio, medlr : float</span>
+</span><span id="BivariateStatistics-236"><a href="#BivariateStatistics-236"><span class="linenos">236</span></a><span class="sd">        median( log10(y/x) )</span>
+</span><span id="BivariateStatistics-237"><a href="#BivariateStatistics-237"><span class="linenos">237</span></a><span class="sd">    median_absolute_log10_ratio, medalr : float</span>
+</span><span id="BivariateStatistics-238"><a href="#BivariateStatistics-238"><span class="linenos">238</span></a><span class="sd">        median( abs( log10(y/x) ) )</span>
+</span><span id="BivariateStatistics-239"><a href="#BivariateStatistics-239"><span class="linenos">239</span></a><span class="sd">    normalized_mean_bias_factor, nmbf : float</span>
+</span><span id="BivariateStatistics-240"><a href="#BivariateStatistics-240"><span class="linenos">240</span></a><span class="sd">        see `nmbf` </span>
+</span><span id="BivariateStatistics-241"><a href="#BivariateStatistics-241"><span class="linenos">241</span></a><span class="sd">    normalized_mean_absolute_error_factor, nmaef : float</span>
+</span><span id="BivariateStatistics-242"><a href="#BivariateStatistics-242"><span class="linenos">242</span></a><span class="sd">        see `nmaef`</span>
+</span><span id="BivariateStatistics-243"><a href="#BivariateStatistics-243"><span class="linenos">243</span></a><span class="sd">    root_mean_square_difference, rmsd : float</span>
+</span><span id="BivariateStatistics-244"><a href="#BivariateStatistics-244"><span class="linenos">244</span></a><span class="sd">        $\\sqrt{ \\langle (y - x)^2 \\rangle }$</span>
+</span><span id="BivariateStatistics-245"><a href="#BivariateStatistics-245"><span class="linenos">245</span></a><span class="sd">    root_mean_square_log10_ratio, rmslr : float</span>
+</span><span id="BivariateStatistics-246"><a href="#BivariateStatistics-246"><span class="linenos">246</span></a><span class="sd">        $\\sqrt{ \\langle log10(y/x)^2 \\rangle }$</span>
+</span><span id="BivariateStatistics-247"><a href="#BivariateStatistics-247"><span class="linenos">247</span></a><span class="sd">    covariance : float</span>
+</span><span id="BivariateStatistics-248"><a href="#BivariateStatistics-248"><span class="linenos">248</span></a><span class="sd">        cov(x,y)</span>
+</span><span id="BivariateStatistics-249"><a href="#BivariateStatistics-249"><span class="linenos">249</span></a><span class="sd">    correlation_pearson, correlation, pearsonr, R, r : float</span>
+</span><span id="BivariateStatistics-250"><a href="#BivariateStatistics-250"><span class="linenos">250</span></a><span class="sd">        Pearson linear correlation coefficient </span>
+</span><span id="BivariateStatistics-251"><a href="#BivariateStatistics-251"><span class="linenos">251</span></a><span class="sd">    correlation_spearman, spearmanr : float</span>
+</span><span id="BivariateStatistics-252"><a href="#BivariateStatistics-252"><span class="linenos">252</span></a><span class="sd">        Spearman, non-parametric rank correlation coefficient</span>
+</span><span id="BivariateStatistics-253"><a href="#BivariateStatistics-253"><span class="linenos">253</span></a><span class="sd">    R2, r2 : float</span>
+</span><span id="BivariateStatistics-254"><a href="#BivariateStatistics-254"><span class="linenos">254</span></a><span class="sd">        Linear coefficient of determination, $R^2$</span>
+</span><span id="BivariateStatistics-255"><a href="#BivariateStatistics-255"><span class="linenos">255</span></a><span class="sd">    &#39;&#39;&#39;</span>
 </span><span id="BivariateStatistics-256"><a href="#BivariateStatistics-256"><span class="linenos">256</span></a>
-</span><span id="BivariateStatistics-257"><a href="#BivariateStatistics-257"><span class="linenos">257</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics-258"><a href="#BivariateStatistics-258"><span class="linenos">258</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics-259"><a href="#BivariateStatistics-259"><span class="linenos">259</span></a><span class="sd">        x : ndarray or str</span>
-</span><span id="BivariateStatistics-260"><a href="#BivariateStatistics-260"><span class="linenos">260</span></a><span class="sd">            independent variable values</span>
-</span><span id="BivariateStatistics-261"><a href="#BivariateStatistics-261"><span class="linenos">261</span></a><span class="sd">        y : ndarray or str</span>
-</span><span id="BivariateStatistics-262"><a href="#BivariateStatistics-262"><span class="linenos">262</span></a><span class="sd">            dependent variable values, same size as x</span>
-</span><span id="BivariateStatistics-263"><a href="#BivariateStatistics-263"><span class="linenos">263</span></a><span class="sd">        w : ndarray or str, optional</span>
-</span><span id="BivariateStatistics-264"><a href="#BivariateStatistics-264"><span class="linenos">264</span></a><span class="sd">            weights for points (x,y), same size as x and y</span>
-</span><span id="BivariateStatistics-265"><a href="#BivariateStatistics-265"><span class="linenos">265</span></a><span class="sd">        dropna : bool, optional (default=False)</span>
-</span><span id="BivariateStatistics-266"><a href="#BivariateStatistics-266"><span class="linenos">266</span></a><span class="sd">            drops NaN values from x, y, and w</span>
-</span><span id="BivariateStatistics-267"><a href="#BivariateStatistics-267"><span class="linenos">267</span></a><span class="sd">        data : dict-like, optional</span>
-</span><span id="BivariateStatistics-268"><a href="#BivariateStatistics-268"><span class="linenos">268</span></a><span class="sd">            if x, y, or w are str, then they should be keys in data</span>
-</span><span id="BivariateStatistics-269"><a href="#BivariateStatistics-269"><span class="linenos">269</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-270"><a href="#BivariateStatistics-270"><span class="linenos">270</span></a>
-</span><span id="BivariateStatistics-271"><a href="#BivariateStatistics-271"><span class="linenos">271</span></a>        <span class="c1"># Get values from data if needed</span>
-</span><span id="BivariateStatistics-272"><a href="#BivariateStatistics-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span>
-</span><span id="BivariateStatistics-273"><a href="#BivariateStatistics-273"><span class="linenos">273</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Data argument must be used if x, y, or w is a string&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics-274"><a href="#BivariateStatistics-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="BivariateStatistics-275"><a href="#BivariateStatistics-275"><span class="linenos">275</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
-</span><span id="BivariateStatistics-276"><a href="#BivariateStatistics-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="BivariateStatistics-277"><a href="#BivariateStatistics-277"><span class="linenos">277</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
-</span><span id="BivariateStatistics-278"><a href="#BivariateStatistics-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="BivariateStatistics-279"><a href="#BivariateStatistics-279"><span class="linenos">279</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
-</span><span id="BivariateStatistics-280"><a href="#BivariateStatistics-280"><span class="linenos">280</span></a>
-</span><span id="BivariateStatistics-281"><a href="#BivariateStatistics-281"><span class="linenos">281</span></a>        <span class="c1">#Ensure that x and y have same length</span>
-</span><span id="BivariateStatistics-282"><a href="#BivariateStatistics-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
-</span><span id="BivariateStatistics-283"><a href="#BivariateStatistics-283"><span class="linenos">283</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Arguments x and y must have the same length&#39;</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-284"><a href="#BivariateStatistics-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics-285"><a href="#BivariateStatistics-285"><span class="linenos">285</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics-286"><a href="#BivariateStatistics-286"><span class="linenos">286</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
-</span><span id="BivariateStatistics-287"><a href="#BivariateStatistics-287"><span class="linenos">287</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Argument w (if present) must have the same length as x&#39;</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-288"><a href="#BivariateStatistics-288"><span class="linenos">288</span></a>
-</span><span id="BivariateStatistics-289"><a href="#BivariateStatistics-289"><span class="linenos">289</span></a>        <span class="c1"># Drop NaN values</span>
-</span><span id="BivariateStatistics-290"><a href="#BivariateStatistics-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
-</span><span id="BivariateStatistics-291"><a href="#BivariateStatistics-291"><span class="linenos">291</span></a>            <span class="n">isna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
-</span><span id="BivariateStatistics-292"><a href="#BivariateStatistics-292"><span class="linenos">292</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="BivariateStatistics-293"><a href="#BivariateStatistics-293"><span class="linenos">293</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="BivariateStatistics-294"><a href="#BivariateStatistics-294"><span class="linenos">294</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="BivariateStatistics-295"><a href="#BivariateStatistics-295"><span class="linenos">295</span></a>
-</span><span id="BivariateStatistics-296"><a href="#BivariateStatistics-296"><span class="linenos">296</span></a>        <span class="c1"># Differences and ratios used repeatedly</span>
-</span><span id="BivariateStatistics-297"><a href="#BivariateStatistics-297"><span class="linenos">297</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
-</span><span id="BivariateStatistics-298"><a href="#BivariateStatistics-298"><span class="linenos">298</span></a>        <span class="n">absdiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-299"><a href="#BivariateStatistics-299"><span class="linenos">299</span></a>        <span class="c1"># Ignore divide by zero and 0/0 while dividing</span>
-</span><span id="BivariateStatistics-300"><a href="#BivariateStatistics-300"><span class="linenos">300</span></a>        <span class="n">old_settings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics-301"><a href="#BivariateStatistics-301"><span class="linenos">301</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">y</span><span class="o">/</span><span class="n">x</span>
-</span><span id="BivariateStatistics-302"><a href="#BivariateStatistics-302"><span class="linenos">302</span></a>        <span class="n">log10ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
-</span><span id="BivariateStatistics-303"><a href="#BivariateStatistics-303"><span class="linenos">303</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_settings</span><span class="p">)</span>
-</span><span id="BivariateStatistics-304"><a href="#BivariateStatistics-304"><span class="linenos">304</span></a>
-</span><span id="BivariateStatistics-305"><a href="#BivariateStatistics-305"><span class="linenos">305</span></a>        <span class="c1"># Number of data points</span>
-</span><span id="BivariateStatistics-306"><a href="#BivariateStatistics-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics-307"><a href="#BivariateStatistics-307"><span class="linenos">307</span></a>
-</span><span id="BivariateStatistics-308"><a href="#BivariateStatistics-308"><span class="linenos">308</span></a>        <span class="c1"># Means, medians, and standard deviations</span>
-</span><span id="BivariateStatistics-309"><a href="#BivariateStatistics-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics-310"><a href="#BivariateStatistics-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="BivariateStatistics-311"><a href="#BivariateStatistics-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics-312"><a href="#BivariateStatistics-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="BivariateStatistics-313"><a href="#BivariateStatistics-313"><span class="linenos">313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics-314"><a href="#BivariateStatistics-314"><span class="linenos">314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ystd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="BivariateStatistics-315"><a href="#BivariateStatistics-315"><span class="linenos">315</span></a>
-</span><span id="BivariateStatistics-316"><a href="#BivariateStatistics-316"><span class="linenos">316</span></a>        <span class="c1"># Save values for use later</span>
-</span><span id="BivariateStatistics-317"><a href="#BivariateStatistics-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
-</span><span id="BivariateStatistics-318"><a href="#BivariateStatistics-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
-</span><span id="BivariateStatistics-319"><a href="#BivariateStatistics-319"><span class="linenos">319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">w</span>
-</span><span id="BivariateStatistics-320"><a href="#BivariateStatistics-320"><span class="linenos">320</span></a>
-</span><span id="BivariateStatistics-321"><a href="#BivariateStatistics-321"><span class="linenos">321</span></a>        <span class="c1"># Mean and mean absolute differences</span>
-</span><span id="BivariateStatistics-322"><a href="#BivariateStatistics-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">md</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="BivariateStatistics-323"><a href="#BivariateStatistics-323"><span class="linenos">323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mad</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-324"><a href="#BivariateStatistics-324"><span class="linenos">324</span></a>
-</span><span id="BivariateStatistics-325"><a href="#BivariateStatistics-325"><span class="linenos">325</span></a>        <span class="c1"># Relative and standardized differences</span>
-</span><span id="BivariateStatistics-326"><a href="#BivariateStatistics-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_difference</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="BivariateStatistics-327"><a href="#BivariateStatistics-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="BivariateStatistics-328"><a href="#BivariateStatistics-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_difference</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
-</span><span id="BivariateStatistics-329"><a href="#BivariateStatistics-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
-</span><span id="BivariateStatistics-330"><a href="#BivariateStatistics-330"><span class="linenos">330</span></a>
-</span><span id="BivariateStatistics-331"><a href="#BivariateStatistics-331"><span class="linenos">331</span></a>        <span class="c1"># Mean and median relative differences</span>
-</span><span id="BivariateStatistics-332"><a href="#BivariateStatistics-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_relative_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mrd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-333"><a href="#BivariateStatistics-333"><span class="linenos">333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_relative_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medianrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medrd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-334"><a href="#BivariateStatistics-334"><span class="linenos">334</span></a>
-</span><span id="BivariateStatistics-335"><a href="#BivariateStatistics-335"><span class="linenos">335</span></a>        <span class="c1"># Median and median absolute differences</span>
-</span><span id="BivariateStatistics-336"><a href="#BivariateStatistics-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-337"><a href="#BivariateStatistics-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-338"><a href="#BivariateStatistics-338"><span class="linenos">338</span></a>
-</span><span id="BivariateStatistics-339"><a href="#BivariateStatistics-339"><span class="linenos">339</span></a>        <span class="c1"># Relative median differences</span>
-</span><span id="BivariateStatistics-340"><a href="#BivariateStatistics-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
-</span><span id="BivariateStatistics-341"><a href="#BivariateStatistics-341"><span class="linenos">341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
-</span><span id="BivariateStatistics-342"><a href="#BivariateStatistics-342"><span class="linenos">342</span></a>
-</span><span id="BivariateStatistics-343"><a href="#BivariateStatistics-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_bias_factor</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmbf</span>  <span class="o">=</span> <span class="n">nmbf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
-</span><span id="BivariateStatistics-344"><a href="#BivariateStatistics-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_absolute_error_factor</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmaef</span> <span class="o">=</span> <span class="n">nmaef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics-257"><a href="#BivariateStatistics-257"><span class="linenos">257</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
+</span><span id="BivariateStatistics-258"><a href="#BivariateStatistics-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute suite of bivariate statistics during initialization</span>
+</span><span id="BivariateStatistics-259"><a href="#BivariateStatistics-259"><span class="linenos">259</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics-260"><a href="#BivariateStatistics-260"><span class="linenos">260</span></a><span class="sd">        Statistic values are saved in attributes.</span>
+</span><span id="BivariateStatistics-261"><a href="#BivariateStatistics-261"><span class="linenos">261</span></a><span class="sd">        CAUTION: Weights w are ignored except in SMA fit</span>
+</span><span id="BivariateStatistics-262"><a href="#BivariateStatistics-262"><span class="linenos">262</span></a>
+</span><span id="BivariateStatistics-263"><a href="#BivariateStatistics-263"><span class="linenos">263</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics-264"><a href="#BivariateStatistics-264"><span class="linenos">264</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics-265"><a href="#BivariateStatistics-265"><span class="linenos">265</span></a><span class="sd">        x : ndarray or str</span>
+</span><span id="BivariateStatistics-266"><a href="#BivariateStatistics-266"><span class="linenos">266</span></a><span class="sd">            independent variable values</span>
+</span><span id="BivariateStatistics-267"><a href="#BivariateStatistics-267"><span class="linenos">267</span></a><span class="sd">        y : ndarray or str</span>
+</span><span id="BivariateStatistics-268"><a href="#BivariateStatistics-268"><span class="linenos">268</span></a><span class="sd">            dependent variable values, same size as x</span>
+</span><span id="BivariateStatistics-269"><a href="#BivariateStatistics-269"><span class="linenos">269</span></a><span class="sd">        w : ndarray or str, optional</span>
+</span><span id="BivariateStatistics-270"><a href="#BivariateStatistics-270"><span class="linenos">270</span></a><span class="sd">            weights for points (x,y), same size as x and y</span>
+</span><span id="BivariateStatistics-271"><a href="#BivariateStatistics-271"><span class="linenos">271</span></a><span class="sd">        dropna : bool, optional (default=False)</span>
+</span><span id="BivariateStatistics-272"><a href="#BivariateStatistics-272"><span class="linenos">272</span></a><span class="sd">            drops NaN values from x, y, and w</span>
+</span><span id="BivariateStatistics-273"><a href="#BivariateStatistics-273"><span class="linenos">273</span></a><span class="sd">        data : dict-like, optional</span>
+</span><span id="BivariateStatistics-274"><a href="#BivariateStatistics-274"><span class="linenos">274</span></a><span class="sd">            if x, y, or w are str, then they should be keys in data</span>
+</span><span id="BivariateStatistics-275"><a href="#BivariateStatistics-275"><span class="linenos">275</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-276"><a href="#BivariateStatistics-276"><span class="linenos">276</span></a>
+</span><span id="BivariateStatistics-277"><a href="#BivariateStatistics-277"><span class="linenos">277</span></a>        <span class="c1"># Get values from data if needed</span>
+</span><span id="BivariateStatistics-278"><a href="#BivariateStatistics-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span>
+</span><span id="BivariateStatistics-279"><a href="#BivariateStatistics-279"><span class="linenos">279</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Data argument must be used if x, y, or w is a string&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics-280"><a href="#BivariateStatistics-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="BivariateStatistics-281"><a href="#BivariateStatistics-281"><span class="linenos">281</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
+</span><span id="BivariateStatistics-282"><a href="#BivariateStatistics-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="BivariateStatistics-283"><a href="#BivariateStatistics-283"><span class="linenos">283</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
+</span><span id="BivariateStatistics-284"><a href="#BivariateStatistics-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="BivariateStatistics-285"><a href="#BivariateStatistics-285"><span class="linenos">285</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
+</span><span id="BivariateStatistics-286"><a href="#BivariateStatistics-286"><span class="linenos">286</span></a>
+</span><span id="BivariateStatistics-287"><a href="#BivariateStatistics-287"><span class="linenos">287</span></a>        <span class="c1">#Ensure that x and y have same length</span>
+</span><span id="BivariateStatistics-288"><a href="#BivariateStatistics-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
+</span><span id="BivariateStatistics-289"><a href="#BivariateStatistics-289"><span class="linenos">289</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Arguments x and y must have the same length&#39;</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-290"><a href="#BivariateStatistics-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics-291"><a href="#BivariateStatistics-291"><span class="linenos">291</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics-292"><a href="#BivariateStatistics-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
+</span><span id="BivariateStatistics-293"><a href="#BivariateStatistics-293"><span class="linenos">293</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Argument w (if present) must have the same length as x&#39;</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-294"><a href="#BivariateStatistics-294"><span class="linenos">294</span></a>
+</span><span id="BivariateStatistics-295"><a href="#BivariateStatistics-295"><span class="linenos">295</span></a>        <span class="c1"># Drop NaN values</span>
+</span><span id="BivariateStatistics-296"><a href="#BivariateStatistics-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
+</span><span id="BivariateStatistics-297"><a href="#BivariateStatistics-297"><span class="linenos">297</span></a>            <span class="n">isna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
+</span><span id="BivariateStatistics-298"><a href="#BivariateStatistics-298"><span class="linenos">298</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="BivariateStatistics-299"><a href="#BivariateStatistics-299"><span class="linenos">299</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="BivariateStatistics-300"><a href="#BivariateStatistics-300"><span class="linenos">300</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="BivariateStatistics-301"><a href="#BivariateStatistics-301"><span class="linenos">301</span></a>
+</span><span id="BivariateStatistics-302"><a href="#BivariateStatistics-302"><span class="linenos">302</span></a>        <span class="c1"># Differences and ratios used repeatedly</span>
+</span><span id="BivariateStatistics-303"><a href="#BivariateStatistics-303"><span class="linenos">303</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
+</span><span id="BivariateStatistics-304"><a href="#BivariateStatistics-304"><span class="linenos">304</span></a>        <span class="n">absdiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-305"><a href="#BivariateStatistics-305"><span class="linenos">305</span></a>        <span class="c1"># Ignore divide by zero and 0/0 while dividing</span>
+</span><span id="BivariateStatistics-306"><a href="#BivariateStatistics-306"><span class="linenos">306</span></a>        <span class="n">old_settings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics-307"><a href="#BivariateStatistics-307"><span class="linenos">307</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">y</span><span class="o">/</span><span class="n">x</span>
+</span><span id="BivariateStatistics-308"><a href="#BivariateStatistics-308"><span class="linenos">308</span></a>        <span class="n">log10ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
+</span><span id="BivariateStatistics-309"><a href="#BivariateStatistics-309"><span class="linenos">309</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_settings</span><span class="p">)</span>
+</span><span id="BivariateStatistics-310"><a href="#BivariateStatistics-310"><span class="linenos">310</span></a>
+</span><span id="BivariateStatistics-311"><a href="#BivariateStatistics-311"><span class="linenos">311</span></a>        <span class="c1"># Number of data points</span>
+</span><span id="BivariateStatistics-312"><a href="#BivariateStatistics-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics-313"><a href="#BivariateStatistics-313"><span class="linenos">313</span></a>
+</span><span id="BivariateStatistics-314"><a href="#BivariateStatistics-314"><span class="linenos">314</span></a>        <span class="c1"># Means, medians, and standard deviations</span>
+</span><span id="BivariateStatistics-315"><a href="#BivariateStatistics-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics-316"><a href="#BivariateStatistics-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics-317"><a href="#BivariateStatistics-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics-318"><a href="#BivariateStatistics-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics-319"><a href="#BivariateStatistics-319"><span class="linenos">319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics-320"><a href="#BivariateStatistics-320"><span class="linenos">320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ystd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics-321"><a href="#BivariateStatistics-321"><span class="linenos">321</span></a>
+</span><span id="BivariateStatistics-322"><a href="#BivariateStatistics-322"><span class="linenos">322</span></a>        <span class="c1"># Save values for use later</span>
+</span><span id="BivariateStatistics-323"><a href="#BivariateStatistics-323"><span class="linenos">323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
+</span><span id="BivariateStatistics-324"><a href="#BivariateStatistics-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
+</span><span id="BivariateStatistics-325"><a href="#BivariateStatistics-325"><span class="linenos">325</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">w</span>
+</span><span id="BivariateStatistics-326"><a href="#BivariateStatistics-326"><span class="linenos">326</span></a>
+</span><span id="BivariateStatistics-327"><a href="#BivariateStatistics-327"><span class="linenos">327</span></a>        <span class="c1"># Mean and mean absolute differences</span>
+</span><span id="BivariateStatistics-328"><a href="#BivariateStatistics-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">md</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="BivariateStatistics-329"><a href="#BivariateStatistics-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mad</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-330"><a href="#BivariateStatistics-330"><span class="linenos">330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">std_difference</span>             <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-331"><a href="#BivariateStatistics-331"><span class="linenos">331</span></a>
+</span><span id="BivariateStatistics-332"><a href="#BivariateStatistics-332"><span class="linenos">332</span></a>        <span class="c1"># Relative and standardized differences</span>
+</span><span id="BivariateStatistics-333"><a href="#BivariateStatistics-333"><span class="linenos">333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_difference</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="BivariateStatistics-334"><a href="#BivariateStatistics-334"><span class="linenos">334</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="BivariateStatistics-335"><a href="#BivariateStatistics-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_difference</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
+</span><span id="BivariateStatistics-336"><a href="#BivariateStatistics-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
+</span><span id="BivariateStatistics-337"><a href="#BivariateStatistics-337"><span class="linenos">337</span></a>
+</span><span id="BivariateStatistics-338"><a href="#BivariateStatistics-338"><span class="linenos">338</span></a>        <span class="c1"># Mean and median relative differences</span>
+</span><span id="BivariateStatistics-339"><a href="#BivariateStatistics-339"><span class="linenos">339</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_relative_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mrd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-340"><a href="#BivariateStatistics-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_relative_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medianrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medrd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-341"><a href="#BivariateStatistics-341"><span class="linenos">341</span></a>
+</span><span id="BivariateStatistics-342"><a href="#BivariateStatistics-342"><span class="linenos">342</span></a>        <span class="c1"># Median and median absolute differences</span>
+</span><span id="BivariateStatistics-343"><a href="#BivariateStatistics-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-344"><a href="#BivariateStatistics-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
 </span><span id="BivariateStatistics-345"><a href="#BivariateStatistics-345"><span class="linenos">345</span></a>
-</span><span id="BivariateStatistics-346"><a href="#BivariateStatistics-346"><span class="linenos">346</span></a>        <span class="c1"># Mean and mean absolute log ratio</span>
-</span><span id="BivariateStatistics-347"><a href="#BivariateStatistics-347"><span class="linenos">347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-348"><a href="#BivariateStatistics-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">malr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-349"><a href="#BivariateStatistics-349"><span class="linenos">349</span></a>        
-</span><span id="BivariateStatistics-350"><a href="#BivariateStatistics-350"><span class="linenos">350</span></a>        <span class="c1"># Median and median absolute log ratio</span>
-</span><span id="BivariateStatistics-351"><a href="#BivariateStatistics-351"><span class="linenos">351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-352"><a href="#BivariateStatistics-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medalr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-353"><a href="#BivariateStatistics-353"><span class="linenos">353</span></a>        
-</span><span id="BivariateStatistics-354"><a href="#BivariateStatistics-354"><span class="linenos">354</span></a>        <span class="c1"># RMS difference</span>
-</span><span id="BivariateStatistics-355"><a href="#BivariateStatistics-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_difference</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsd</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-356"><a href="#BivariateStatistics-356"><span class="linenos">356</span></a>
-</span><span id="BivariateStatistics-357"><a href="#BivariateStatistics-357"><span class="linenos">357</span></a>        <span class="c1"># Covariance, correlation</span>
-</span><span id="BivariateStatistics-358"><a href="#BivariateStatistics-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="BivariateStatistics-359"><a href="#BivariateStatistics-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_pearson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pearsonr</span> <span class="o">=</span> \
-</span><span id="BivariateStatistics-360"><a href="#BivariateStatistics-360"><span class="linenos">360</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="BivariateStatistics-361"><a href="#BivariateStatistics-361"><span class="linenos">361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation_spearman</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spearmanr</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span>
-</span><span id="BivariateStatistics-362"><a href="#BivariateStatistics-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">R2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span>
-</span><span id="BivariateStatistics-363"><a href="#BivariateStatistics-363"><span class="linenos">363</span></a>
-</span><span id="BivariateStatistics-364"><a href="#BivariateStatistics-364"><span class="linenos">364</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
-</span><span id="BivariateStatistics-365"><a href="#BivariateStatistics-365"><span class="linenos">365</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Accesses attribute values via object[&#39;key&#39;]&#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-366"><a href="#BivariateStatistics-366"><span class="linenos">366</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
-</span><span id="BivariateStatistics-367"><a href="#BivariateStatistics-367"><span class="linenos">367</span></a>
-</span><span id="BivariateStatistics-368"><a href="#BivariateStatistics-368"><span class="linenos">368</span></a>    <span class="k">def</span> <span class="nf">fitline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="BivariateStatistics-369"><a href="#BivariateStatistics-369"><span class="linenos">369</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute bivariate line fit</span>
-</span><span id="BivariateStatistics-370"><a href="#BivariateStatistics-370"><span class="linenos">370</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics-371"><a href="#BivariateStatistics-371"><span class="linenos">371</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics-372"><a href="#BivariateStatistics-372"><span class="linenos">372</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics-373"><a href="#BivariateStatistics-373"><span class="linenos">373</span></a><span class="sd">        method : str</span>
-</span><span id="BivariateStatistics-374"><a href="#BivariateStatistics-374"><span class="linenos">374</span></a><span class="sd">            line fitting method: sma (default), ols, wls, York, sen, siegel</span>
-</span><span id="BivariateStatistics-375"><a href="#BivariateStatistics-375"><span class="linenos">375</span></a><span class="sd">        intercept : bool</span>
-</span><span id="BivariateStatistics-376"><a href="#BivariateStatistics-376"><span class="linenos">376</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="BivariateStatistics-377"><a href="#BivariateStatistics-377"><span class="linenos">377</span></a><span class="sd">        **kwargs </span>
-</span><span id="BivariateStatistics-378"><a href="#BivariateStatistics-378"><span class="linenos">378</span></a><span class="sd">            passed to `acgc.stats.sma` (e.g. robust=True)</span>
-</span><span id="BivariateStatistics-379"><a href="#BivariateStatistics-379"><span class="linenos">379</span></a>
-</span><span id="BivariateStatistics-380"><a href="#BivariateStatistics-380"><span class="linenos">380</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics-381"><a href="#BivariateStatistics-381"><span class="linenos">381</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics-382"><a href="#BivariateStatistics-382"><span class="linenos">382</span></a><span class="sd">        result : dict</span>
-</span><span id="BivariateStatistics-383"><a href="#BivariateStatistics-383"><span class="linenos">383</span></a><span class="sd">            dictionary with keys:</span>
-</span><span id="BivariateStatistics-384"><a href="#BivariateStatistics-384"><span class="linenos">384</span></a><span class="sd">            - slope (float)</span>
-</span><span id="BivariateStatistics-385"><a href="#BivariateStatistics-385"><span class="linenos">385</span></a><span class="sd">                slope of fitted line</span>
-</span><span id="BivariateStatistics-386"><a href="#BivariateStatistics-386"><span class="linenos">386</span></a><span class="sd">            - intercept (float)</span>
-</span><span id="BivariateStatistics-387"><a href="#BivariateStatistics-387"><span class="linenos">387</span></a><span class="sd">                intercept of fitted line</span>
-</span><span id="BivariateStatistics-388"><a href="#BivariateStatistics-388"><span class="linenos">388</span></a><span class="sd">            - fittedvalues (array (N,))</span>
-</span><span id="BivariateStatistics-389"><a href="#BivariateStatistics-389"><span class="linenos">389</span></a><span class="sd">                values on fit line</span>
-</span><span id="BivariateStatistics-390"><a href="#BivariateStatistics-390"><span class="linenos">390</span></a><span class="sd">            - residuals (array (N,))</span>
-</span><span id="BivariateStatistics-391"><a href="#BivariateStatistics-391"><span class="linenos">391</span></a><span class="sd">                residual from fit line</span>
-</span><span id="BivariateStatistics-392"><a href="#BivariateStatistics-392"><span class="linenos">392</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-393"><a href="#BivariateStatistics-393"><span class="linenos">393</span></a>
-</span><span id="BivariateStatistics-394"><a href="#BivariateStatistics-394"><span class="linenos">394</span></a>        <span class="n">fitintercept</span> <span class="o">=</span> <span class="n">intercept</span>
-</span><span id="BivariateStatistics-395"><a href="#BivariateStatistics-395"><span class="linenos">395</span></a>
-</span><span id="BivariateStatistics-396"><a href="#BivariateStatistics-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;sma&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-397"><a href="#BivariateStatistics-397"><span class="linenos">397</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sma</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="BivariateStatistics-398"><a href="#BivariateStatistics-398"><span class="linenos">398</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
-</span><span id="BivariateStatistics-399"><a href="#BivariateStatistics-399"><span class="linenos">399</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span>
-</span><span id="BivariateStatistics-400"><a href="#BivariateStatistics-400"><span class="linenos">400</span></a>                        <span class="n">intercept</span><span class="o">=</span><span class="n">fitintercept</span><span class="p">,</span>
-</span><span id="BivariateStatistics-401"><a href="#BivariateStatistics-401"><span class="linenos">401</span></a>                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
-</span><span id="BivariateStatistics-402"><a href="#BivariateStatistics-402"><span class="linenos">402</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics-403"><a href="#BivariateStatistics-403"><span class="linenos">403</span></a>            <span class="n">intercept</span><span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics-404"><a href="#BivariateStatistics-404"><span class="linenos">404</span></a>
-</span><span id="BivariateStatistics-405"><a href="#BivariateStatistics-405"><span class="linenos">405</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ols&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-406"><a href="#BivariateStatistics-406"><span class="linenos">406</span></a>            <span class="k">if</span> <span class="n">fitintercept</span><span class="p">:</span>
-</span><span id="BivariateStatistics-407"><a href="#BivariateStatistics-407"><span class="linenos">407</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
-</span><span id="BivariateStatistics-408"><a href="#BivariateStatistics-408"><span class="linenos">408</span></a>                                      <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-409"><a href="#BivariateStatistics-409"><span class="linenos">409</span></a>            <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics-410"><a href="#BivariateStatistics-410"><span class="linenos">410</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-411"><a href="#BivariateStatistics-411"><span class="linenos">411</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
-</span><span id="BivariateStatistics-412"><a href="#BivariateStatistics-412"><span class="linenos">412</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="BivariateStatistics-413"><a href="#BivariateStatistics-413"><span class="linenos">413</span></a>
-</span><span id="BivariateStatistics-414"><a href="#BivariateStatistics-414"><span class="linenos">414</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;theil&#39;</span><span class="p">,</span><span class="s1">&#39;sen&#39;</span><span class="p">,</span><span class="s1">&#39;theilsen&#39;</span><span class="p">]:</span>
-</span><span id="BivariateStatistics-415"><a href="#BivariateStatistics-415"><span class="linenos">415</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
-</span><span id="BivariateStatistics-416"><a href="#BivariateStatistics-416"><span class="linenos">416</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sen</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="BivariateStatistics-417"><a href="#BivariateStatistics-417"><span class="linenos">417</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
-</span><span id="BivariateStatistics-418"><a href="#BivariateStatistics-418"><span class="linenos">418</span></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
-</span><span id="BivariateStatistics-419"><a href="#BivariateStatistics-419"><span class="linenos">419</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span>
-</span><span id="BivariateStatistics-420"><a href="#BivariateStatistics-420"><span class="linenos">420</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span>
-</span><span id="BivariateStatistics-421"><a href="#BivariateStatistics-421"><span class="linenos">421</span></a>
-</span><span id="BivariateStatistics-422"><a href="#BivariateStatistics-422"><span class="linenos">422</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;siegel&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-423"><a href="#BivariateStatistics-423"><span class="linenos">423</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
-</span><span id="BivariateStatistics-424"><a href="#BivariateStatistics-424"><span class="linenos">424</span></a>            <span class="n">siegel</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">siegelslopes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="BivariateStatistics-425"><a href="#BivariateStatistics-425"><span class="linenos">425</span></a>                                         <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-426"><a href="#BivariateStatistics-426"><span class="linenos">426</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">slope</span>
-</span><span id="BivariateStatistics-427"><a href="#BivariateStatistics-427"><span class="linenos">427</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">intercept</span>
-</span><span id="BivariateStatistics-428"><a href="#BivariateStatistics-428"><span class="linenos">428</span></a>
-</span><span id="BivariateStatistics-429"><a href="#BivariateStatistics-429"><span class="linenos">429</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;wls&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-430"><a href="#BivariateStatistics-430"><span class="linenos">430</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;WLS regression not implemented yet&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics-346"><a href="#BivariateStatistics-346"><span class="linenos">346</span></a>        <span class="c1"># Relative median differences</span>
+</span><span id="BivariateStatistics-347"><a href="#BivariateStatistics-347"><span class="linenos">347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
+</span><span id="BivariateStatistics-348"><a href="#BivariateStatistics-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
+</span><span id="BivariateStatistics-349"><a href="#BivariateStatistics-349"><span class="linenos">349</span></a>
+</span><span id="BivariateStatistics-350"><a href="#BivariateStatistics-350"><span class="linenos">350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_bias_factor</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmbf</span>  <span class="o">=</span> <span class="n">nmbf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics-351"><a href="#BivariateStatistics-351"><span class="linenos">351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_absolute_error_factor</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmaef</span> <span class="o">=</span> <span class="n">nmaef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics-352"><a href="#BivariateStatistics-352"><span class="linenos">352</span></a>
+</span><span id="BivariateStatistics-353"><a href="#BivariateStatistics-353"><span class="linenos">353</span></a>        <span class="c1"># Mean and mean absolute log ratio</span>
+</span><span id="BivariateStatistics-354"><a href="#BivariateStatistics-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-355"><a href="#BivariateStatistics-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">malr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-356"><a href="#BivariateStatistics-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">std_log10_ratio</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdlr</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-357"><a href="#BivariateStatistics-357"><span class="linenos">357</span></a>
+</span><span id="BivariateStatistics-358"><a href="#BivariateStatistics-358"><span class="linenos">358</span></a>        <span class="c1"># Median and median absolute log ratio</span>
+</span><span id="BivariateStatistics-359"><a href="#BivariateStatistics-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-360"><a href="#BivariateStatistics-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medalr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-361"><a href="#BivariateStatistics-361"><span class="linenos">361</span></a>
+</span><span id="BivariateStatistics-362"><a href="#BivariateStatistics-362"><span class="linenos">362</span></a>        <span class="c1"># RMS difference</span>
+</span><span id="BivariateStatistics-363"><a href="#BivariateStatistics-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-364"><a href="#BivariateStatistics-364"><span class="linenos">364</span></a>        <span class="c1"># RMS log ratio</span>
+</span><span id="BivariateStatistics-365"><a href="#BivariateStatistics-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmslr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">log10ratio</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)))</span>
+</span><span id="BivariateStatistics-366"><a href="#BivariateStatistics-366"><span class="linenos">366</span></a>
+</span><span id="BivariateStatistics-367"><a href="#BivariateStatistics-367"><span class="linenos">367</span></a>        <span class="c1"># Covariance, correlation</span>
+</span><span id="BivariateStatistics-368"><a href="#BivariateStatistics-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="BivariateStatistics-369"><a href="#BivariateStatistics-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_pearson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pearsonr</span> <span class="o">=</span> \
+</span><span id="BivariateStatistics-370"><a href="#BivariateStatistics-370"><span class="linenos">370</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="BivariateStatistics-371"><a href="#BivariateStatistics-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation_spearman</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spearmanr</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span>
+</span><span id="BivariateStatistics-372"><a href="#BivariateStatistics-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">R2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span>
+</span><span id="BivariateStatistics-373"><a href="#BivariateStatistics-373"><span class="linenos">373</span></a>
+</span><span id="BivariateStatistics-374"><a href="#BivariateStatistics-374"><span class="linenos">374</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
+</span><span id="BivariateStatistics-375"><a href="#BivariateStatistics-375"><span class="linenos">375</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Accesses attribute values via object[&#39;key&#39;]&#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-376"><a href="#BivariateStatistics-376"><span class="linenos">376</span></a>        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
+</span><span id="BivariateStatistics-377"><a href="#BivariateStatistics-377"><span class="linenos">377</span></a>
+</span><span id="BivariateStatistics-378"><a href="#BivariateStatistics-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">fitline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="BivariateStatistics-379"><a href="#BivariateStatistics-379"><span class="linenos">379</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute bivariate line fit</span>
+</span><span id="BivariateStatistics-380"><a href="#BivariateStatistics-380"><span class="linenos">380</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics-381"><a href="#BivariateStatistics-381"><span class="linenos">381</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics-382"><a href="#BivariateStatistics-382"><span class="linenos">382</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics-383"><a href="#BivariateStatistics-383"><span class="linenos">383</span></a><span class="sd">        method : str</span>
+</span><span id="BivariateStatistics-384"><a href="#BivariateStatistics-384"><span class="linenos">384</span></a><span class="sd">            line fitting method: sma (default), ols, wls, York, sen, siegel</span>
+</span><span id="BivariateStatistics-385"><a href="#BivariateStatistics-385"><span class="linenos">385</span></a><span class="sd">        intercept : bool</span>
+</span><span id="BivariateStatistics-386"><a href="#BivariateStatistics-386"><span class="linenos">386</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="BivariateStatistics-387"><a href="#BivariateStatistics-387"><span class="linenos">387</span></a><span class="sd">        **kwargs </span>
+</span><span id="BivariateStatistics-388"><a href="#BivariateStatistics-388"><span class="linenos">388</span></a><span class="sd">            passed to `acgc.stats.sma` (e.g. robust=True)</span>
+</span><span id="BivariateStatistics-389"><a href="#BivariateStatistics-389"><span class="linenos">389</span></a>
+</span><span id="BivariateStatistics-390"><a href="#BivariateStatistics-390"><span class="linenos">390</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics-391"><a href="#BivariateStatistics-391"><span class="linenos">391</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics-392"><a href="#BivariateStatistics-392"><span class="linenos">392</span></a><span class="sd">        result : dict</span>
+</span><span id="BivariateStatistics-393"><a href="#BivariateStatistics-393"><span class="linenos">393</span></a><span class="sd">            dictionary with keys:</span>
+</span><span id="BivariateStatistics-394"><a href="#BivariateStatistics-394"><span class="linenos">394</span></a><span class="sd">            - slope (float)</span>
+</span><span id="BivariateStatistics-395"><a href="#BivariateStatistics-395"><span class="linenos">395</span></a><span class="sd">                slope of fitted line</span>
+</span><span id="BivariateStatistics-396"><a href="#BivariateStatistics-396"><span class="linenos">396</span></a><span class="sd">            - intercept (float)</span>
+</span><span id="BivariateStatistics-397"><a href="#BivariateStatistics-397"><span class="linenos">397</span></a><span class="sd">                intercept of fitted line</span>
+</span><span id="BivariateStatistics-398"><a href="#BivariateStatistics-398"><span class="linenos">398</span></a><span class="sd">            - fittedvalues (array (N,))</span>
+</span><span id="BivariateStatistics-399"><a href="#BivariateStatistics-399"><span class="linenos">399</span></a><span class="sd">                values on fit line</span>
+</span><span id="BivariateStatistics-400"><a href="#BivariateStatistics-400"><span class="linenos">400</span></a><span class="sd">            - residuals (array (N,))</span>
+</span><span id="BivariateStatistics-401"><a href="#BivariateStatistics-401"><span class="linenos">401</span></a><span class="sd">                residual from fit line</span>
+</span><span id="BivariateStatistics-402"><a href="#BivariateStatistics-402"><span class="linenos">402</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-403"><a href="#BivariateStatistics-403"><span class="linenos">403</span></a>
+</span><span id="BivariateStatistics-404"><a href="#BivariateStatistics-404"><span class="linenos">404</span></a>        <span class="n">fitintercept</span> <span class="o">=</span> <span class="n">intercept</span>
+</span><span id="BivariateStatistics-405"><a href="#BivariateStatistics-405"><span class="linenos">405</span></a>
+</span><span id="BivariateStatistics-406"><a href="#BivariateStatistics-406"><span class="linenos">406</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;sma&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-407"><a href="#BivariateStatistics-407"><span class="linenos">407</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sma</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="BivariateStatistics-408"><a href="#BivariateStatistics-408"><span class="linenos">408</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
+</span><span id="BivariateStatistics-409"><a href="#BivariateStatistics-409"><span class="linenos">409</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span>
+</span><span id="BivariateStatistics-410"><a href="#BivariateStatistics-410"><span class="linenos">410</span></a>                        <span class="n">intercept</span><span class="o">=</span><span class="n">fitintercept</span><span class="p">,</span>
+</span><span id="BivariateStatistics-411"><a href="#BivariateStatistics-411"><span class="linenos">411</span></a>                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
+</span><span id="BivariateStatistics-412"><a href="#BivariateStatistics-412"><span class="linenos">412</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics-413"><a href="#BivariateStatistics-413"><span class="linenos">413</span></a>            <span class="n">intercept</span><span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics-414"><a href="#BivariateStatistics-414"><span class="linenos">414</span></a>
+</span><span id="BivariateStatistics-415"><a href="#BivariateStatistics-415"><span class="linenos">415</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ols&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-416"><a href="#BivariateStatistics-416"><span class="linenos">416</span></a>            <span class="k">if</span> <span class="n">fitintercept</span><span class="p">:</span>
+</span><span id="BivariateStatistics-417"><a href="#BivariateStatistics-417"><span class="linenos">417</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
+</span><span id="BivariateStatistics-418"><a href="#BivariateStatistics-418"><span class="linenos">418</span></a>                                      <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-419"><a href="#BivariateStatistics-419"><span class="linenos">419</span></a>            <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics-420"><a href="#BivariateStatistics-420"><span class="linenos">420</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-421"><a href="#BivariateStatistics-421"><span class="linenos">421</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="BivariateStatistics-422"><a href="#BivariateStatistics-422"><span class="linenos">422</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="BivariateStatistics-423"><a href="#BivariateStatistics-423"><span class="linenos">423</span></a>
+</span><span id="BivariateStatistics-424"><a href="#BivariateStatistics-424"><span class="linenos">424</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;theil&#39;</span><span class="p">,</span><span class="s1">&#39;sen&#39;</span><span class="p">,</span><span class="s1">&#39;theilsen&#39;</span><span class="p">]:</span>
+</span><span id="BivariateStatistics-425"><a href="#BivariateStatistics-425"><span class="linenos">425</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
+</span><span id="BivariateStatistics-426"><a href="#BivariateStatistics-426"><span class="linenos">426</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sen</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="BivariateStatistics-427"><a href="#BivariateStatistics-427"><span class="linenos">427</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
+</span><span id="BivariateStatistics-428"><a href="#BivariateStatistics-428"><span class="linenos">428</span></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
+</span><span id="BivariateStatistics-429"><a href="#BivariateStatistics-429"><span class="linenos">429</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span>
+</span><span id="BivariateStatistics-430"><a href="#BivariateStatistics-430"><span class="linenos">430</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span>
 </span><span id="BivariateStatistics-431"><a href="#BivariateStatistics-431"><span class="linenos">431</span></a>
-</span><span id="BivariateStatistics-432"><a href="#BivariateStatistics-432"><span class="linenos">432</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;york&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-433"><a href="#BivariateStatistics-433"><span class="linenos">433</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;York regression not implemented yet&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics-434"><a href="#BivariateStatistics-434"><span class="linenos">434</span></a>
-</span><span id="BivariateStatistics-435"><a href="#BivariateStatistics-435"><span class="linenos">435</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics-436"><a href="#BivariateStatistics-436"><span class="linenos">436</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Undefined method &#39;</span><span class="o">+</span><span class="n">method</span><span class="p">)</span>
-</span><span id="BivariateStatistics-437"><a href="#BivariateStatistics-437"><span class="linenos">437</span></a>
-</span><span id="BivariateStatistics-438"><a href="#BivariateStatistics-438"><span class="linenos">438</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">slope</span>          <span class="o">=</span> <span class="n">slope</span><span class="p">,</span>
-</span><span id="BivariateStatistics-439"><a href="#BivariateStatistics-439"><span class="linenos">439</span></a>                     <span class="n">intercept</span>      <span class="o">=</span> <span class="n">intercept</span><span class="p">,</span>
-</span><span id="BivariateStatistics-440"><a href="#BivariateStatistics-440"><span class="linenos">440</span></a>                     <span class="n">fittedvalues</span>   <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span>
-</span><span id="BivariateStatistics-441"><a href="#BivariateStatistics-441"><span class="linenos">441</span></a>                     <span class="n">residuals</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-</span> <span class="p">(</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span> <span class="p">),</span>
-</span><span id="BivariateStatistics-442"><a href="#BivariateStatistics-442"><span class="linenos">442</span></a>                     <span class="n">method</span>         <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
-</span><span id="BivariateStatistics-443"><a href="#BivariateStatistics-443"><span class="linenos">443</span></a>                     <span class="n">fitintercept</span>   <span class="o">=</span> <span class="n">fitintercept</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-432"><a href="#BivariateStatistics-432"><span class="linenos">432</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;siegel&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-433"><a href="#BivariateStatistics-433"><span class="linenos">433</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
+</span><span id="BivariateStatistics-434"><a href="#BivariateStatistics-434"><span class="linenos">434</span></a>            <span class="n">siegel</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">siegelslopes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="BivariateStatistics-435"><a href="#BivariateStatistics-435"><span class="linenos">435</span></a>                                         <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-436"><a href="#BivariateStatistics-436"><span class="linenos">436</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">slope</span>
+</span><span id="BivariateStatistics-437"><a href="#BivariateStatistics-437"><span class="linenos">437</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">intercept</span>
+</span><span id="BivariateStatistics-438"><a href="#BivariateStatistics-438"><span class="linenos">438</span></a>
+</span><span id="BivariateStatistics-439"><a href="#BivariateStatistics-439"><span class="linenos">439</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;wls&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-440"><a href="#BivariateStatistics-440"><span class="linenos">440</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;WLS regression not implemented yet&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics-441"><a href="#BivariateStatistics-441"><span class="linenos">441</span></a>
+</span><span id="BivariateStatistics-442"><a href="#BivariateStatistics-442"><span class="linenos">442</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;york&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-443"><a href="#BivariateStatistics-443"><span class="linenos">443</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;York regression not implemented yet&#39;</span><span class="p">)</span>
 </span><span id="BivariateStatistics-444"><a href="#BivariateStatistics-444"><span class="linenos">444</span></a>
-</span><span id="BivariateStatistics-445"><a href="#BivariateStatistics-445"><span class="linenos">445</span></a>        <span class="k">return</span> <span class="n">line</span>
-</span><span id="BivariateStatistics-446"><a href="#BivariateStatistics-446"><span class="linenos">446</span></a>
-</span><span id="BivariateStatistics-447"><a href="#BivariateStatistics-447"><span class="linenos">447</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="BivariateStatistics-448"><a href="#BivariateStatistics-448"><span class="linenos">448</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute slope of bivariate line fit</span>
-</span><span id="BivariateStatistics-449"><a href="#BivariateStatistics-449"><span class="linenos">449</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics-450"><a href="#BivariateStatistics-450"><span class="linenos">450</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics-451"><a href="#BivariateStatistics-451"><span class="linenos">451</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics-452"><a href="#BivariateStatistics-452"><span class="linenos">452</span></a><span class="sd">        method : str</span>
-</span><span id="BivariateStatistics-453"><a href="#BivariateStatistics-453"><span class="linenos">453</span></a><span class="sd">            line fitting method: sma (default), ols, wls</span>
-</span><span id="BivariateStatistics-454"><a href="#BivariateStatistics-454"><span class="linenos">454</span></a><span class="sd">        intercept : bool</span>
-</span><span id="BivariateStatistics-455"><a href="#BivariateStatistics-455"><span class="linenos">455</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="BivariateStatistics-456"><a href="#BivariateStatistics-456"><span class="linenos">456</span></a><span class="sd">        **kwargs </span>
-</span><span id="BivariateStatistics-457"><a href="#BivariateStatistics-457"><span class="linenos">457</span></a><span class="sd">            passed to `fitline`</span>
-</span><span id="BivariateStatistics-458"><a href="#BivariateStatistics-458"><span class="linenos">458</span></a>
-</span><span id="BivariateStatistics-459"><a href="#BivariateStatistics-459"><span class="linenos">459</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics-460"><a href="#BivariateStatistics-460"><span class="linenos">460</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics-461"><a href="#BivariateStatistics-461"><span class="linenos">461</span></a><span class="sd">        slope : float</span>
-</span><span id="BivariateStatistics-462"><a href="#BivariateStatistics-462"><span class="linenos">462</span></a><span class="sd">            value of y intercept</span>
-</span><span id="BivariateStatistics-463"><a href="#BivariateStatistics-463"><span class="linenos">463</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-464"><a href="#BivariateStatistics-464"><span class="linenos">464</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics-465"><a href="#BivariateStatistics-465"><span class="linenos">465</span></a>
-</span><span id="BivariateStatistics-466"><a href="#BivariateStatistics-466"><span class="linenos">466</span></a>    <span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="BivariateStatistics-467"><a href="#BivariateStatistics-467"><span class="linenos">467</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute intercept of bivariate line fit</span>
-</span><span id="BivariateStatistics-468"><a href="#BivariateStatistics-468"><span class="linenos">468</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics-469"><a href="#BivariateStatistics-469"><span class="linenos">469</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics-470"><a href="#BivariateStatistics-470"><span class="linenos">470</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics-471"><a href="#BivariateStatistics-471"><span class="linenos">471</span></a><span class="sd">        method : str</span>
-</span><span id="BivariateStatistics-472"><a href="#BivariateStatistics-472"><span class="linenos">472</span></a><span class="sd">            line fitting method: sma (default) or ols</span>
-</span><span id="BivariateStatistics-473"><a href="#BivariateStatistics-473"><span class="linenos">473</span></a><span class="sd">        intercept : bool</span>
-</span><span id="BivariateStatistics-474"><a href="#BivariateStatistics-474"><span class="linenos">474</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="BivariateStatistics-475"><a href="#BivariateStatistics-475"><span class="linenos">475</span></a><span class="sd">        **kwargs </span>
-</span><span id="BivariateStatistics-476"><a href="#BivariateStatistics-476"><span class="linenos">476</span></a><span class="sd">            passed to `fitline`</span>
-</span><span id="BivariateStatistics-477"><a href="#BivariateStatistics-477"><span class="linenos">477</span></a>
-</span><span id="BivariateStatistics-478"><a href="#BivariateStatistics-478"><span class="linenos">478</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics-479"><a href="#BivariateStatistics-479"><span class="linenos">479</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics-480"><a href="#BivariateStatistics-480"><span class="linenos">480</span></a><span class="sd">        intercept : float</span>
-</span><span id="BivariateStatistics-481"><a href="#BivariateStatistics-481"><span class="linenos">481</span></a><span class="sd">            value of y intercept</span>
-</span><span id="BivariateStatistics-482"><a href="#BivariateStatistics-482"><span class="linenos">482</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-483"><a href="#BivariateStatistics-483"><span class="linenos">483</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics-484"><a href="#BivariateStatistics-484"><span class="linenos">484</span></a>
-</span><span id="BivariateStatistics-485"><a href="#BivariateStatistics-485"><span class="linenos">485</span></a>    <span class="k">def</span> <span class="nf">_expand_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variables</span><span class="p">):</span>
-</span><span id="BivariateStatistics-486"><a href="#BivariateStatistics-486"><span class="linenos">486</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Expand special strings into a list of variables</span>
-</span><span id="BivariateStatistics-487"><a href="#BivariateStatistics-487"><span class="linenos">487</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics-488"><a href="#BivariateStatistics-488"><span class="linenos">488</span></a><span class="sd">        Parameter</span>
-</span><span id="BivariateStatistics-489"><a href="#BivariateStatistics-489"><span class="linenos">489</span></a><span class="sd">        ---------</span>
-</span><span id="BivariateStatistics-490"><a href="#BivariateStatistics-490"><span class="linenos">490</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
-</span><span id="BivariateStatistics-491"><a href="#BivariateStatistics-491"><span class="linenos">491</span></a><span class="sd">            Special strings (&quot;all&quot;,&quot;common&quot;) will be expanded to a list of variables</span>
-</span><span id="BivariateStatistics-492"><a href="#BivariateStatistics-492"><span class="linenos">492</span></a><span class="sd">            list arguments will not be modified</span>
-</span><span id="BivariateStatistics-493"><a href="#BivariateStatistics-493"><span class="linenos">493</span></a>
-</span><span id="BivariateStatistics-494"><a href="#BivariateStatistics-494"><span class="linenos">494</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics-495"><a href="#BivariateStatistics-495"><span class="linenos">495</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics-496"><a href="#BivariateStatistics-496"><span class="linenos">496</span></a><span class="sd">        list </span>
-</span><span id="BivariateStatistics-497"><a href="#BivariateStatistics-497"><span class="linenos">497</span></a><span class="sd">            variable names</span>
-</span><span id="BivariateStatistics-498"><a href="#BivariateStatistics-498"><span class="linenos">498</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-499"><a href="#BivariateStatistics-499"><span class="linenos">499</span></a>        <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics-500"><a href="#BivariateStatistics-500"><span class="linenos">500</span></a>            <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;common&#39;</span>
-</span><span id="BivariateStatistics-501"><a href="#BivariateStatistics-501"><span class="linenos">501</span></a>        <span class="k">if</span> <span class="n">variables</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-502"><a href="#BivariateStatistics-502"><span class="linenos">502</span></a>            <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;MAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMD&#39;</span><span class="p">,</span><span class="s1">&#39;RMAD&#39;</span><span class="p">,</span><span class="s1">&#39;MRD&#39;</span><span class="p">,</span><span class="s1">&#39;SMD&#39;</span><span class="p">,</span><span class="s1">&#39;SMAD&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics-503"><a href="#BivariateStatistics-503"><span class="linenos">503</span></a>                       <span class="s1">&#39;MLR&#39;</span><span class="p">,</span><span class="s1">&#39;MALR&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics-504"><a href="#BivariateStatistics-504"><span class="linenos">504</span></a>                       <span class="s1">&#39;MedD&#39;</span><span class="p">,</span><span class="s1">&#39;MedAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMedD&#39;</span><span class="p">,</span><span class="s1">&#39;RMedAD&#39;</span><span class="p">,</span><span class="s1">&#39;MedRD&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics-505"><a href="#BivariateStatistics-505"><span class="linenos">505</span></a>                       <span class="s1">&#39;MedLR&#39;</span><span class="p">,</span><span class="s1">&#39;MedALR&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics-506"><a href="#BivariateStatistics-506"><span class="linenos">506</span></a>                       <span class="s1">&#39;NMBF&#39;</span><span class="p">,</span><span class="s1">&#39;NMAEF&#39;</span><span class="p">,</span><span class="s1">&#39;RMSD&#39;</span><span class="p">,</span><span class="s1">&#39;cov&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics-507"><a href="#BivariateStatistics-507"><span class="linenos">507</span></a>                       <span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;spearmanr&#39;</span><span class="p">,</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics-508"><a href="#BivariateStatistics-508"><span class="linenos">508</span></a>                       <span class="s1">&#39;fitline&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics-509"><a href="#BivariateStatistics-509"><span class="linenos">509</span></a>        <span class="k">elif</span> <span class="n">variables</span><span class="o">==</span><span class="s1">&#39;common&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-510"><a href="#BivariateStatistics-510"><span class="linenos">510</span></a>            <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;MAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMD&#39;</span><span class="p">,</span><span class="s1">&#39;RMAD&#39;</span><span class="p">,</span><span class="s1">&#39;MRD&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics-511"><a href="#BivariateStatistics-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
-</span><span id="BivariateStatistics-512"><a href="#BivariateStatistics-512"><span class="linenos">512</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
-</span><span id="BivariateStatistics-513"><a href="#BivariateStatistics-513"><span class="linenos">513</span></a>                <span class="s1">&#39;variables must be a list, None, or one of these strings: &quot;all&quot;,&quot;common&quot;&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics-514"><a href="#BivariateStatistics-514"><span class="linenos">514</span></a>
-</span><span id="BivariateStatistics-515"><a href="#BivariateStatistics-515"><span class="linenos">515</span></a>        <span class="k">return</span> <span class="n">variables</span>
-</span><span id="BivariateStatistics-516"><a href="#BivariateStatistics-516"><span class="linenos">516</span></a>
-</span><span id="BivariateStatistics-517"><a href="#BivariateStatistics-517"><span class="linenos">517</span></a>    <span class="k">def</span> <span class="nf">summary_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">):</span>
-</span><span id="BivariateStatistics-518"><a href="#BivariateStatistics-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics into a dict</span>
-</span><span id="BivariateStatistics-519"><a href="#BivariateStatistics-519"><span class="linenos">519</span></a>
-</span><span id="BivariateStatistics-520"><a href="#BivariateStatistics-520"><span class="linenos">520</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics-521"><a href="#BivariateStatistics-521"><span class="linenos">521</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics-522"><a href="#BivariateStatistics-522"><span class="linenos">522</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
-</span><span id="BivariateStatistics-523"><a href="#BivariateStatistics-523"><span class="linenos">523</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="BivariateStatistics-524"><a href="#BivariateStatistics-524"><span class="linenos">524</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="BivariateStatistics-525"><a href="#BivariateStatistics-525"><span class="linenos">525</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="BivariateStatistics-526"><a href="#BivariateStatistics-526"><span class="linenos">526</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="BivariateStatistics-527"><a href="#BivariateStatistics-527"><span class="linenos">527</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="BivariateStatistics-528"><a href="#BivariateStatistics-528"><span class="linenos">528</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="BivariateStatistics-529"><a href="#BivariateStatistics-529"><span class="linenos">529</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="BivariateStatistics-530"><a href="#BivariateStatistics-530"><span class="linenos">530</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="BivariateStatistics-531"><a href="#BivariateStatistics-531"><span class="linenos">531</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="BivariateStatistics-532"><a href="#BivariateStatistics-532"><span class="linenos">532</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics-533"><a href="#BivariateStatistics-533"><span class="linenos">533</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics-534"><a href="#BivariateStatistics-534"><span class="linenos">534</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics-535"><a href="#BivariateStatistics-535"><span class="linenos">535</span></a><span class="sd">        summary : dict</span>
-</span><span id="BivariateStatistics-536"><a href="#BivariateStatistics-536"><span class="linenos">536</span></a><span class="sd">            names and values of variables</span>
-</span><span id="BivariateStatistics-537"><a href="#BivariateStatistics-537"><span class="linenos">537</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-538"><a href="#BivariateStatistics-538"><span class="linenos">538</span></a>
-</span><span id="BivariateStatistics-539"><a href="#BivariateStatistics-539"><span class="linenos">539</span></a>        <span class="c1"># List of variables</span>
-</span><span id="BivariateStatistics-540"><a href="#BivariateStatistics-540"><span class="linenos">540</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="BivariateStatistics-541"><a href="#BivariateStatistics-541"><span class="linenos">541</span></a>
-</span><span id="BivariateStatistics-542"><a href="#BivariateStatistics-542"><span class="linenos">542</span></a>        <span class="k">if</span> <span class="n">fitline_kw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics-543"><a href="#BivariateStatistics-543"><span class="linenos">543</span></a>            <span class="n">fitline_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics-544"><a href="#BivariateStatistics-544"><span class="linenos">544</span></a>                          <span class="s1">&#39;intercept&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
-</span><span id="BivariateStatistics-545"><a href="#BivariateStatistics-545"><span class="linenos">545</span></a>
-</span><span id="BivariateStatistics-546"><a href="#BivariateStatistics-546"><span class="linenos">546</span></a>        <span class="c1"># Construct the dict</span>
-</span><span id="BivariateStatistics-547"><a href="#BivariateStatistics-547"><span class="linenos">547</span></a>        <span class="n">summary</span> <span class="o">=</span> <span class="p">{}</span>
-</span><span id="BivariateStatistics-548"><a href="#BivariateStatistics-548"><span class="linenos">548</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
-</span><span id="BivariateStatistics-549"><a href="#BivariateStatistics-549"><span class="linenos">549</span></a>            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">]:</span>
-</span><span id="BivariateStatistics-550"><a href="#BivariateStatistics-550"><span class="linenos">550</span></a>                <span class="c1"># These variables are object methods</span>
-</span><span id="BivariateStatistics-551"><a href="#BivariateStatistics-551"><span class="linenos">551</span></a>                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
-</span><span id="BivariateStatistics-552"><a href="#BivariateStatistics-552"><span class="linenos">552</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
-</span><span id="BivariateStatistics-553"><a href="#BivariateStatistics-553"><span class="linenos">553</span></a>            <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="s1">&#39;fitline&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-554"><a href="#BivariateStatistics-554"><span class="linenos">554</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
-</span><span id="BivariateStatistics-555"><a href="#BivariateStatistics-555"><span class="linenos">555</span></a>                <span class="n">v</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">bivariate_line_equation</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">floatformat_fiteqn</span><span class="p">,</span><span class="n">ystring</span><span class="o">=</span><span class="s1">&#39;separate&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics-556"><a href="#BivariateStatistics-556"><span class="linenos">556</span></a>            <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics-557"><a href="#BivariateStatistics-557"><span class="linenos">557</span></a>                <span class="c1"># Retrieve values</span>
-</span><span id="BivariateStatistics-558"><a href="#BivariateStatistics-558"><span class="linenos">558</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
-</span><span id="BivariateStatistics-559"><a href="#BivariateStatistics-559"><span class="linenos">559</span></a>
-</span><span id="BivariateStatistics-560"><a href="#BivariateStatistics-560"><span class="linenos">560</span></a>            <span class="c1"># summary += (stringformat+&#39;=&#39;+floatformat+&#39;\n&#39;).format(v,value)</span>
-</span><span id="BivariateStatistics-561"><a href="#BivariateStatistics-561"><span class="linenos">561</span></a>            <span class="n">summary</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
-</span><span id="BivariateStatistics-562"><a href="#BivariateStatistics-562"><span class="linenos">562</span></a>
-</span><span id="BivariateStatistics-563"><a href="#BivariateStatistics-563"><span class="linenos">563</span></a>        <span class="k">return</span> <span class="n">summary</span>
-</span><span id="BivariateStatistics-564"><a href="#BivariateStatistics-564"><span class="linenos">564</span></a>
-</span><span id="BivariateStatistics-565"><a href="#BivariateStatistics-565"><span class="linenos">565</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="BivariateStatistics-566"><a href="#BivariateStatistics-566"><span class="linenos">566</span></a>                <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="BivariateStatistics-567"><a href="#BivariateStatistics-567"><span class="linenos">567</span></a>                <span class="n">stringlength</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
-</span><span id="BivariateStatistics-568"><a href="#BivariateStatistics-568"><span class="linenos">568</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics</span>
+</span><span id="BivariateStatistics-445"><a href="#BivariateStatistics-445"><span class="linenos">445</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics-446"><a href="#BivariateStatistics-446"><span class="linenos">446</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Undefined method &#39;</span><span class="o">+</span><span class="n">method</span><span class="p">)</span>
+</span><span id="BivariateStatistics-447"><a href="#BivariateStatistics-447"><span class="linenos">447</span></a>
+</span><span id="BivariateStatistics-448"><a href="#BivariateStatistics-448"><span class="linenos">448</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">slope</span>          <span class="o">=</span> <span class="n">slope</span><span class="p">,</span>
+</span><span id="BivariateStatistics-449"><a href="#BivariateStatistics-449"><span class="linenos">449</span></a>                     <span class="n">intercept</span>      <span class="o">=</span> <span class="n">intercept</span><span class="p">,</span>
+</span><span id="BivariateStatistics-450"><a href="#BivariateStatistics-450"><span class="linenos">450</span></a>                     <span class="n">fittedvalues</span>   <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span>
+</span><span id="BivariateStatistics-451"><a href="#BivariateStatistics-451"><span class="linenos">451</span></a>                     <span class="n">residuals</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-</span> <span class="p">(</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span> <span class="p">),</span>
+</span><span id="BivariateStatistics-452"><a href="#BivariateStatistics-452"><span class="linenos">452</span></a>                     <span class="n">method</span>         <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
+</span><span id="BivariateStatistics-453"><a href="#BivariateStatistics-453"><span class="linenos">453</span></a>                     <span class="n">fitintercept</span>   <span class="o">=</span> <span class="n">fitintercept</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-454"><a href="#BivariateStatistics-454"><span class="linenos">454</span></a>
+</span><span id="BivariateStatistics-455"><a href="#BivariateStatistics-455"><span class="linenos">455</span></a>        <span class="k">return</span> <span class="n">line</span>
+</span><span id="BivariateStatistics-456"><a href="#BivariateStatistics-456"><span class="linenos">456</span></a>
+</span><span id="BivariateStatistics-457"><a href="#BivariateStatistics-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="BivariateStatistics-458"><a href="#BivariateStatistics-458"><span class="linenos">458</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute slope of bivariate line fit</span>
+</span><span id="BivariateStatistics-459"><a href="#BivariateStatistics-459"><span class="linenos">459</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics-460"><a href="#BivariateStatistics-460"><span class="linenos">460</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics-461"><a href="#BivariateStatistics-461"><span class="linenos">461</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics-462"><a href="#BivariateStatistics-462"><span class="linenos">462</span></a><span class="sd">        method : str</span>
+</span><span id="BivariateStatistics-463"><a href="#BivariateStatistics-463"><span class="linenos">463</span></a><span class="sd">            line fitting method: sma (default), ols, wls</span>
+</span><span id="BivariateStatistics-464"><a href="#BivariateStatistics-464"><span class="linenos">464</span></a><span class="sd">        intercept : bool</span>
+</span><span id="BivariateStatistics-465"><a href="#BivariateStatistics-465"><span class="linenos">465</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="BivariateStatistics-466"><a href="#BivariateStatistics-466"><span class="linenos">466</span></a><span class="sd">        **kwargs </span>
+</span><span id="BivariateStatistics-467"><a href="#BivariateStatistics-467"><span class="linenos">467</span></a><span class="sd">            passed to `fitline`</span>
+</span><span id="BivariateStatistics-468"><a href="#BivariateStatistics-468"><span class="linenos">468</span></a>
+</span><span id="BivariateStatistics-469"><a href="#BivariateStatistics-469"><span class="linenos">469</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics-470"><a href="#BivariateStatistics-470"><span class="linenos">470</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics-471"><a href="#BivariateStatistics-471"><span class="linenos">471</span></a><span class="sd">        slope : float</span>
+</span><span id="BivariateStatistics-472"><a href="#BivariateStatistics-472"><span class="linenos">472</span></a><span class="sd">            value of y intercept</span>
+</span><span id="BivariateStatistics-473"><a href="#BivariateStatistics-473"><span class="linenos">473</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-474"><a href="#BivariateStatistics-474"><span class="linenos">474</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics-475"><a href="#BivariateStatistics-475"><span class="linenos">475</span></a>
+</span><span id="BivariateStatistics-476"><a href="#BivariateStatistics-476"><span class="linenos">476</span></a>    <span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="BivariateStatistics-477"><a href="#BivariateStatistics-477"><span class="linenos">477</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute intercept of bivariate line fit</span>
+</span><span id="BivariateStatistics-478"><a href="#BivariateStatistics-478"><span class="linenos">478</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics-479"><a href="#BivariateStatistics-479"><span class="linenos">479</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics-480"><a href="#BivariateStatistics-480"><span class="linenos">480</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics-481"><a href="#BivariateStatistics-481"><span class="linenos">481</span></a><span class="sd">        method : str</span>
+</span><span id="BivariateStatistics-482"><a href="#BivariateStatistics-482"><span class="linenos">482</span></a><span class="sd">            line fitting method: sma (default) or ols</span>
+</span><span id="BivariateStatistics-483"><a href="#BivariateStatistics-483"><span class="linenos">483</span></a><span class="sd">        intercept : bool</span>
+</span><span id="BivariateStatistics-484"><a href="#BivariateStatistics-484"><span class="linenos">484</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="BivariateStatistics-485"><a href="#BivariateStatistics-485"><span class="linenos">485</span></a><span class="sd">        **kwargs </span>
+</span><span id="BivariateStatistics-486"><a href="#BivariateStatistics-486"><span class="linenos">486</span></a><span class="sd">            passed to `fitline`</span>
+</span><span id="BivariateStatistics-487"><a href="#BivariateStatistics-487"><span class="linenos">487</span></a>
+</span><span id="BivariateStatistics-488"><a href="#BivariateStatistics-488"><span class="linenos">488</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics-489"><a href="#BivariateStatistics-489"><span class="linenos">489</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics-490"><a href="#BivariateStatistics-490"><span class="linenos">490</span></a><span class="sd">        intercept : float</span>
+</span><span id="BivariateStatistics-491"><a href="#BivariateStatistics-491"><span class="linenos">491</span></a><span class="sd">            value of y intercept</span>
+</span><span id="BivariateStatistics-492"><a href="#BivariateStatistics-492"><span class="linenos">492</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-493"><a href="#BivariateStatistics-493"><span class="linenos">493</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics-494"><a href="#BivariateStatistics-494"><span class="linenos">494</span></a>
+</span><span id="BivariateStatistics-495"><a href="#BivariateStatistics-495"><span class="linenos">495</span></a>    <span class="k">def</span> <span class="nf">_expand_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variables</span><span class="p">):</span>
+</span><span id="BivariateStatistics-496"><a href="#BivariateStatistics-496"><span class="linenos">496</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Expand special strings into a list of variables</span>
+</span><span id="BivariateStatistics-497"><a href="#BivariateStatistics-497"><span class="linenos">497</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics-498"><a href="#BivariateStatistics-498"><span class="linenos">498</span></a><span class="sd">        Parameter</span>
+</span><span id="BivariateStatistics-499"><a href="#BivariateStatistics-499"><span class="linenos">499</span></a><span class="sd">        ---------</span>
+</span><span id="BivariateStatistics-500"><a href="#BivariateStatistics-500"><span class="linenos">500</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
+</span><span id="BivariateStatistics-501"><a href="#BivariateStatistics-501"><span class="linenos">501</span></a><span class="sd">            Special strings (&quot;all&quot;,&quot;common&quot;) will be expanded to a list of variables</span>
+</span><span id="BivariateStatistics-502"><a href="#BivariateStatistics-502"><span class="linenos">502</span></a><span class="sd">            list arguments will not be modified</span>
+</span><span id="BivariateStatistics-503"><a href="#BivariateStatistics-503"><span class="linenos">503</span></a>
+</span><span id="BivariateStatistics-504"><a href="#BivariateStatistics-504"><span class="linenos">504</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics-505"><a href="#BivariateStatistics-505"><span class="linenos">505</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics-506"><a href="#BivariateStatistics-506"><span class="linenos">506</span></a><span class="sd">        list </span>
+</span><span id="BivariateStatistics-507"><a href="#BivariateStatistics-507"><span class="linenos">507</span></a><span class="sd">            variable names</span>
+</span><span id="BivariateStatistics-508"><a href="#BivariateStatistics-508"><span class="linenos">508</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-509"><a href="#BivariateStatistics-509"><span class="linenos">509</span></a>        <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics-510"><a href="#BivariateStatistics-510"><span class="linenos">510</span></a>            <span class="n">variables</span><span class="o">=</span><span class="s1">&#39;common&#39;</span>
+</span><span id="BivariateStatistics-511"><a href="#BivariateStatistics-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="n">variables</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-512"><a href="#BivariateStatistics-512"><span class="linenos">512</span></a>            <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;MAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMD&#39;</span><span class="p">,</span><span class="s1">&#39;RMAD&#39;</span><span class="p">,</span><span class="s1">&#39;MRD&#39;</span><span class="p">,</span><span class="s1">&#39;SMD&#39;</span><span class="p">,</span><span class="s1">&#39;SMAD&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics-513"><a href="#BivariateStatistics-513"><span class="linenos">513</span></a>                       <span class="s1">&#39;MLR&#39;</span><span class="p">,</span><span class="s1">&#39;MALR&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics-514"><a href="#BivariateStatistics-514"><span class="linenos">514</span></a>                       <span class="s1">&#39;MedD&#39;</span><span class="p">,</span><span class="s1">&#39;MedAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMedD&#39;</span><span class="p">,</span><span class="s1">&#39;RMedAD&#39;</span><span class="p">,</span><span class="s1">&#39;MedRD&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics-515"><a href="#BivariateStatistics-515"><span class="linenos">515</span></a>                       <span class="s1">&#39;MedLR&#39;</span><span class="p">,</span><span class="s1">&#39;MedALR&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics-516"><a href="#BivariateStatistics-516"><span class="linenos">516</span></a>                       <span class="s1">&#39;NMBF&#39;</span><span class="p">,</span><span class="s1">&#39;NMAEF&#39;</span><span class="p">,</span><span class="s1">&#39;RMSD&#39;</span><span class="p">,</span><span class="s1">&#39;cov&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics-517"><a href="#BivariateStatistics-517"><span class="linenos">517</span></a>                       <span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;spearmanr&#39;</span><span class="p">,</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics-518"><a href="#BivariateStatistics-518"><span class="linenos">518</span></a>                       <span class="s1">&#39;fitline&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics-519"><a href="#BivariateStatistics-519"><span class="linenos">519</span></a>        <span class="k">elif</span> <span class="n">variables</span><span class="o">==</span><span class="s1">&#39;common&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-520"><a href="#BivariateStatistics-520"><span class="linenos">520</span></a>            <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span><span class="s1">&#39;MAD&#39;</span><span class="p">,</span><span class="s1">&#39;RMD&#39;</span><span class="p">,</span><span class="s1">&#39;RMAD&#39;</span><span class="p">,</span><span class="s1">&#39;MRD&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics-521"><a href="#BivariateStatistics-521"><span class="linenos">521</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
+</span><span id="BivariateStatistics-522"><a href="#BivariateStatistics-522"><span class="linenos">522</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
+</span><span id="BivariateStatistics-523"><a href="#BivariateStatistics-523"><span class="linenos">523</span></a>                <span class="s1">&#39;variables must be a list, None, or one of these strings: &quot;all&quot;,&quot;common&quot;&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics-524"><a href="#BivariateStatistics-524"><span class="linenos">524</span></a>
+</span><span id="BivariateStatistics-525"><a href="#BivariateStatistics-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="n">variables</span>
+</span><span id="BivariateStatistics-526"><a href="#BivariateStatistics-526"><span class="linenos">526</span></a>
+</span><span id="BivariateStatistics-527"><a href="#BivariateStatistics-527"><span class="linenos">527</span></a>    <span class="k">def</span> <span class="nf">summary_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">):</span>
+</span><span id="BivariateStatistics-528"><a href="#BivariateStatistics-528"><span class="linenos">528</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics into a dict</span>
+</span><span id="BivariateStatistics-529"><a href="#BivariateStatistics-529"><span class="linenos">529</span></a>
+</span><span id="BivariateStatistics-530"><a href="#BivariateStatistics-530"><span class="linenos">530</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics-531"><a href="#BivariateStatistics-531"><span class="linenos">531</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics-532"><a href="#BivariateStatistics-532"><span class="linenos">532</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
+</span><span id="BivariateStatistics-533"><a href="#BivariateStatistics-533"><span class="linenos">533</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="BivariateStatistics-534"><a href="#BivariateStatistics-534"><span class="linenos">534</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="BivariateStatistics-535"><a href="#BivariateStatistics-535"><span class="linenos">535</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="BivariateStatistics-536"><a href="#BivariateStatistics-536"><span class="linenos">536</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="BivariateStatistics-537"><a href="#BivariateStatistics-537"><span class="linenos">537</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="BivariateStatistics-538"><a href="#BivariateStatistics-538"><span class="linenos">538</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="BivariateStatistics-539"><a href="#BivariateStatistics-539"><span class="linenos">539</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="BivariateStatistics-540"><a href="#BivariateStatistics-540"><span class="linenos">540</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="BivariateStatistics-541"><a href="#BivariateStatistics-541"><span class="linenos">541</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="BivariateStatistics-542"><a href="#BivariateStatistics-542"><span class="linenos">542</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics-543"><a href="#BivariateStatistics-543"><span class="linenos">543</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics-544"><a href="#BivariateStatistics-544"><span class="linenos">544</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics-545"><a href="#BivariateStatistics-545"><span class="linenos">545</span></a><span class="sd">        summary : dict</span>
+</span><span id="BivariateStatistics-546"><a href="#BivariateStatistics-546"><span class="linenos">546</span></a><span class="sd">            names and values of variables</span>
+</span><span id="BivariateStatistics-547"><a href="#BivariateStatistics-547"><span class="linenos">547</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-548"><a href="#BivariateStatistics-548"><span class="linenos">548</span></a>
+</span><span id="BivariateStatistics-549"><a href="#BivariateStatistics-549"><span class="linenos">549</span></a>        <span class="c1"># List of variables</span>
+</span><span id="BivariateStatistics-550"><a href="#BivariateStatistics-550"><span class="linenos">550</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="BivariateStatistics-551"><a href="#BivariateStatistics-551"><span class="linenos">551</span></a>
+</span><span id="BivariateStatistics-552"><a href="#BivariateStatistics-552"><span class="linenos">552</span></a>        <span class="k">if</span> <span class="n">fitline_kw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics-553"><a href="#BivariateStatistics-553"><span class="linenos">553</span></a>            <span class="n">fitline_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics-554"><a href="#BivariateStatistics-554"><span class="linenos">554</span></a>                          <span class="s1">&#39;intercept&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
+</span><span id="BivariateStatistics-555"><a href="#BivariateStatistics-555"><span class="linenos">555</span></a>
+</span><span id="BivariateStatistics-556"><a href="#BivariateStatistics-556"><span class="linenos">556</span></a>        <span class="c1"># Construct the dict</span>
+</span><span id="BivariateStatistics-557"><a href="#BivariateStatistics-557"><span class="linenos">557</span></a>        <span class="n">summary</span> <span class="o">=</span> <span class="p">{}</span>
+</span><span id="BivariateStatistics-558"><a href="#BivariateStatistics-558"><span class="linenos">558</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
+</span><span id="BivariateStatistics-559"><a href="#BivariateStatistics-559"><span class="linenos">559</span></a>            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">]:</span>
+</span><span id="BivariateStatistics-560"><a href="#BivariateStatistics-560"><span class="linenos">560</span></a>                <span class="c1"># These variables are object methods</span>
+</span><span id="BivariateStatistics-561"><a href="#BivariateStatistics-561"><span class="linenos">561</span></a>                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
+</span><span id="BivariateStatistics-562"><a href="#BivariateStatistics-562"><span class="linenos">562</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
+</span><span id="BivariateStatistics-563"><a href="#BivariateStatistics-563"><span class="linenos">563</span></a>            <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="s1">&#39;fitline&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-564"><a href="#BivariateStatistics-564"><span class="linenos">564</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
+</span><span id="BivariateStatistics-565"><a href="#BivariateStatistics-565"><span class="linenos">565</span></a>                <span class="n">v</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">bivariate_line_equation</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">floatformat_fiteqn</span><span class="p">,</span><span class="n">ystring</span><span class="o">=</span><span class="s1">&#39;separate&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics-566"><a href="#BivariateStatistics-566"><span class="linenos">566</span></a>            <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics-567"><a href="#BivariateStatistics-567"><span class="linenos">567</span></a>                <span class="c1"># Retrieve values</span>
+</span><span id="BivariateStatistics-568"><a href="#BivariateStatistics-568"><span class="linenos">568</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
 </span><span id="BivariateStatistics-569"><a href="#BivariateStatistics-569"><span class="linenos">569</span></a>
-</span><span id="BivariateStatistics-570"><a href="#BivariateStatistics-570"><span class="linenos">570</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics-571"><a href="#BivariateStatistics-571"><span class="linenos">571</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics-572"><a href="#BivariateStatistics-572"><span class="linenos">572</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
-</span><span id="BivariateStatistics-573"><a href="#BivariateStatistics-573"><span class="linenos">573</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="BivariateStatistics-574"><a href="#BivariateStatistics-574"><span class="linenos">574</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="BivariateStatistics-575"><a href="#BivariateStatistics-575"><span class="linenos">575</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="BivariateStatistics-576"><a href="#BivariateStatistics-576"><span class="linenos">576</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="BivariateStatistics-577"><a href="#BivariateStatistics-577"><span class="linenos">577</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="BivariateStatistics-578"><a href="#BivariateStatistics-578"><span class="linenos">578</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="BivariateStatistics-579"><a href="#BivariateStatistics-579"><span class="linenos">579</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="BivariateStatistics-580"><a href="#BivariateStatistics-580"><span class="linenos">580</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
-</span><span id="BivariateStatistics-581"><a href="#BivariateStatistics-581"><span class="linenos">581</span></a><span class="sd">            format specifier for integer values</span>
-</span><span id="BivariateStatistics-582"><a href="#BivariateStatistics-582"><span class="linenos">582</span></a><span class="sd">        floatformat : str, default=&#39;{:.4f}&#39;</span>
-</span><span id="BivariateStatistics-583"><a href="#BivariateStatistics-583"><span class="linenos">583</span></a><span class="sd">            format specifier for floating point values</span>
-</span><span id="BivariateStatistics-584"><a href="#BivariateStatistics-584"><span class="linenos">584</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="BivariateStatistics-585"><a href="#BivariateStatistics-585"><span class="linenos">585</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="BivariateStatistics-586"><a href="#BivariateStatistics-586"><span class="linenos">586</span></a><span class="sd">        stringlength : int, default=None</span>
-</span><span id="BivariateStatistics-587"><a href="#BivariateStatistics-587"><span class="linenos">587</span></a><span class="sd">            length of the variables on output</span>
-</span><span id="BivariateStatistics-588"><a href="#BivariateStatistics-588"><span class="linenos">588</span></a><span class="sd">            default (None) is to use the length of the longest variable name</span>
-</span><span id="BivariateStatistics-589"><a href="#BivariateStatistics-589"><span class="linenos">589</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics-590"><a href="#BivariateStatistics-590"><span class="linenos">590</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics-591"><a href="#BivariateStatistics-591"><span class="linenos">591</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics-592"><a href="#BivariateStatistics-592"><span class="linenos">592</span></a><span class="sd">        summary : str</span>
-</span><span id="BivariateStatistics-593"><a href="#BivariateStatistics-593"><span class="linenos">593</span></a><span class="sd">            names and values of variables</span>
-</span><span id="BivariateStatistics-594"><a href="#BivariateStatistics-594"><span class="linenos">594</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-595"><a href="#BivariateStatistics-595"><span class="linenos">595</span></a>        <span class="c1"># List of variables</span>
-</span><span id="BivariateStatistics-596"><a href="#BivariateStatistics-596"><span class="linenos">596</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="BivariateStatistics-597"><a href="#BivariateStatistics-597"><span class="linenos">597</span></a>
-</span><span id="BivariateStatistics-598"><a href="#BivariateStatistics-598"><span class="linenos">598</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics-599"><a href="#BivariateStatistics-599"><span class="linenos">599</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
-</span><span id="BivariateStatistics-600"><a href="#BivariateStatistics-600"><span class="linenos">600</span></a>        <span class="k">if</span> <span class="n">stringlength</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics-601"><a href="#BivariateStatistics-601"><span class="linenos">601</span></a>            <span class="n">stringlength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">])</span>
-</span><span id="BivariateStatistics-602"><a href="#BivariateStatistics-602"><span class="linenos">602</span></a>        <span class="n">stringformat</span> <span class="o">=</span> <span class="s1">&#39;{:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">stringlength</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s}&#39;</span>
-</span><span id="BivariateStatistics-603"><a href="#BivariateStatistics-603"><span class="linenos">603</span></a>
-</span><span id="BivariateStatistics-604"><a href="#BivariateStatistics-604"><span class="linenos">604</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
-</span><span id="BivariateStatistics-605"><a href="#BivariateStatistics-605"><span class="linenos">605</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-606"><a href="#BivariateStatistics-606"><span class="linenos">606</span></a>
-</span><span id="BivariateStatistics-607"><a href="#BivariateStatistics-607"><span class="linenos">607</span></a>        <span class="c1"># Extract length of the float numbers from floatformat</span>
-</span><span id="BivariateStatistics-608"><a href="#BivariateStatistics-608"><span class="linenos">608</span></a>        <span class="c1"># import re</span>
-</span><span id="BivariateStatistics-609"><a href="#BivariateStatistics-609"><span class="linenos">609</span></a>        <span class="c1"># floatlength = np.floor( float( re.findall(&quot;[-+]?(?:\d*\.*\d+)&quot;,</span>
-</span><span id="BivariateStatistics-610"><a href="#BivariateStatistics-610"><span class="linenos">610</span></a>        <span class="c1">#       floatformat )[0] ) ).astype(int)</span>
-</span><span id="BivariateStatistics-611"><a href="#BivariateStatistics-611"><span class="linenos">611</span></a>
-</span><span id="BivariateStatistics-612"><a href="#BivariateStatistics-612"><span class="linenos">612</span></a>        <span class="c1"># summary = (stringformat+&#39;{:&gt;10s}&#39;).format(&#39;Variable&#39;,&#39;Value&#39;)</span>
-</span><span id="BivariateStatistics-613"><a href="#BivariateStatistics-613"><span class="linenos">613</span></a>        <span class="n">summarytext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
-</span><span id="BivariateStatistics-614"><a href="#BivariateStatistics-614"><span class="linenos">614</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
-</span><span id="BivariateStatistics-615"><a href="#BivariateStatistics-615"><span class="linenos">615</span></a>            <span class="n">vstr</span> <span class="o">=</span> <span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
-</span><span id="BivariateStatistics-616"><a href="#BivariateStatistics-616"><span class="linenos">616</span></a>            <span class="n">summarytext</span> <span class="o">+=</span> <span class="p">(</span><span class="n">stringformat</span><span class="o">+</span><span class="s1">&#39; = </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">vstr</span><span class="p">)</span>
-</span><span id="BivariateStatistics-617"><a href="#BivariateStatistics-617"><span class="linenos">617</span></a>
-</span><span id="BivariateStatistics-618"><a href="#BivariateStatistics-618"><span class="linenos">618</span></a>        <span class="k">return</span> <span class="n">summarytext</span>
-</span><span id="BivariateStatistics-619"><a href="#BivariateStatistics-619"><span class="linenos">619</span></a>
-</span><span id="BivariateStatistics-620"><a href="#BivariateStatistics-620"><span class="linenos">620</span></a>    <span class="k">def</span> <span class="nf">summary_fig_inset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="BivariateStatistics-621"><a href="#BivariateStatistics-621"><span class="linenos">621</span></a>                          <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="BivariateStatistics-622"><a href="#BivariateStatistics-622"><span class="linenos">622</span></a>                          <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc_units</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics-623"><a href="#BivariateStatistics-623"><span class="linenos">623</span></a>                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="BivariateStatistics-624"><a href="#BivariateStatistics-624"><span class="linenos">624</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Display bivariate statistics as a table inset on a plot axis</span>
-</span><span id="BivariateStatistics-625"><a href="#BivariateStatistics-625"><span class="linenos">625</span></a>
-</span><span id="BivariateStatistics-626"><a href="#BivariateStatistics-626"><span class="linenos">626</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics-627"><a href="#BivariateStatistics-627"><span class="linenos">627</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics-628"><a href="#BivariateStatistics-628"><span class="linenos">628</span></a><span class="sd">        ax : matplotlib.Figure.Axis </span>
-</span><span id="BivariateStatistics-629"><a href="#BivariateStatistics-629"><span class="linenos">629</span></a><span class="sd">            axis where the table will be displayed</span>
-</span><span id="BivariateStatistics-630"><a href="#BivariateStatistics-630"><span class="linenos">630</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
-</span><span id="BivariateStatistics-631"><a href="#BivariateStatistics-631"><span class="linenos">631</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="BivariateStatistics-632"><a href="#BivariateStatistics-632"><span class="linenos">632</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="BivariateStatistics-633"><a href="#BivariateStatistics-633"><span class="linenos">633</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="BivariateStatistics-634"><a href="#BivariateStatistics-634"><span class="linenos">634</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="BivariateStatistics-635"><a href="#BivariateStatistics-635"><span class="linenos">635</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="BivariateStatistics-636"><a href="#BivariateStatistics-636"><span class="linenos">636</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="BivariateStatistics-637"><a href="#BivariateStatistics-637"><span class="linenos">637</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="BivariateStatistics-638"><a href="#BivariateStatistics-638"><span class="linenos">638</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
-</span><span id="BivariateStatistics-639"><a href="#BivariateStatistics-639"><span class="linenos">639</span></a><span class="sd">            format specifier for integer values</span>
-</span><span id="BivariateStatistics-640"><a href="#BivariateStatistics-640"><span class="linenos">640</span></a><span class="sd">        floatformat : str, default=&#39;{:.3f}&#39;</span>
-</span><span id="BivariateStatistics-641"><a href="#BivariateStatistics-641"><span class="linenos">641</span></a><span class="sd">            format specifier for floating point values</span>
-</span><span id="BivariateStatistics-642"><a href="#BivariateStatistics-642"><span class="linenos">642</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="BivariateStatistics-643"><a href="#BivariateStatistics-643"><span class="linenos">643</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="BivariateStatistics-644"><a href="#BivariateStatistics-644"><span class="linenos">644</span></a><span class="sd">        loc : tuple (x0,y0), default=(0.85, 0.05)</span>
-</span><span id="BivariateStatistics-645"><a href="#BivariateStatistics-645"><span class="linenos">645</span></a><span class="sd">            location on the axis where the table will be drawn</span>
-</span><span id="BivariateStatistics-646"><a href="#BivariateStatistics-646"><span class="linenos">646</span></a><span class="sd">            can be in data units or axes units [0-1]</span>
-</span><span id="BivariateStatistics-647"><a href="#BivariateStatistics-647"><span class="linenos">647</span></a><span class="sd">        loc_units : {&#39;axes&#39; (default), &#39;data&#39;}</span>
-</span><span id="BivariateStatistics-648"><a href="#BivariateStatistics-648"><span class="linenos">648</span></a><span class="sd">            specifies whether loc has &#39;data&#39; units or &#39;axes&#39; units [0-1]</span>
-</span><span id="BivariateStatistics-649"><a href="#BivariateStatistics-649"><span class="linenos">649</span></a><span class="sd">                    </span>
-</span><span id="BivariateStatistics-650"><a href="#BivariateStatistics-650"><span class="linenos">650</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics-651"><a href="#BivariateStatistics-651"><span class="linenos">651</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics-652"><a href="#BivariateStatistics-652"><span class="linenos">652</span></a><span class="sd">        text1, text2 : matplotlib text object</span>
-</span><span id="BivariateStatistics-653"><a href="#BivariateStatistics-653"><span class="linenos">653</span></a><span class="sd">            Artist for the two text boxes        </span>
-</span><span id="BivariateStatistics-654"><a href="#BivariateStatistics-654"><span class="linenos">654</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics-655"><a href="#BivariateStatistics-655"><span class="linenos">655</span></a>        <span class="c1"># List of variables</span>
-</span><span id="BivariateStatistics-656"><a href="#BivariateStatistics-656"><span class="linenos">656</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="BivariateStatistics-657"><a href="#BivariateStatistics-657"><span class="linenos">657</span></a>
-</span><span id="BivariateStatistics-658"><a href="#BivariateStatistics-658"><span class="linenos">658</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics-659"><a href="#BivariateStatistics-659"><span class="linenos">659</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
-</span><span id="BivariateStatistics-660"><a href="#BivariateStatistics-660"><span class="linenos">660</span></a>
-</span><span id="BivariateStatistics-661"><a href="#BivariateStatistics-661"><span class="linenos">661</span></a>        <span class="c1"># Default location in lower right corner</span>
-</span><span id="BivariateStatistics-662"><a href="#BivariateStatistics-662"><span class="linenos">662</span></a>        <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics-663"><a href="#BivariateStatistics-663"><span class="linenos">663</span></a>            <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
-</span><span id="BivariateStatistics-664"><a href="#BivariateStatistics-664"><span class="linenos">664</span></a>
-</span><span id="BivariateStatistics-665"><a href="#BivariateStatistics-665"><span class="linenos">665</span></a>        <span class="c1"># Coordinates for loc</span>
-</span><span id="BivariateStatistics-666"><a href="#BivariateStatistics-666"><span class="linenos">666</span></a>        <span class="k">if</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;data&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-667"><a href="#BivariateStatistics-667"><span class="linenos">667</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
-</span><span id="BivariateStatistics-668"><a href="#BivariateStatistics-668"><span class="linenos">668</span></a>        <span class="k">elif</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span><span class="s1">&#39;axis&#39;</span><span class="p">]:</span>
-</span><span id="BivariateStatistics-669"><a href="#BivariateStatistics-669"><span class="linenos">669</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
-</span><span id="BivariateStatistics-670"><a href="#BivariateStatistics-670"><span class="linenos">670</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics-671"><a href="#BivariateStatistics-671"><span class="linenos">671</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Display units should be &quot;Data&quot; or &quot;Axes&quot;&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics-672"><a href="#BivariateStatistics-672"><span class="linenos">672</span></a>
-</span><span id="BivariateStatistics-673"><a href="#BivariateStatistics-673"><span class="linenos">673</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
-</span><span id="BivariateStatistics-674"><a href="#BivariateStatistics-674"><span class="linenos">674</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
-</span><span id="BivariateStatistics-675"><a href="#BivariateStatistics-675"><span class="linenos">675</span></a>
-</span><span id="BivariateStatistics-676"><a href="#BivariateStatistics-676"><span class="linenos">676</span></a>        <span class="c1"># Column of label text</span>
-</span><span id="BivariateStatistics-677"><a href="#BivariateStatistics-677"><span class="linenos">677</span></a>        <span class="n">label_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_texify_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
-</span><span id="BivariateStatistics-678"><a href="#BivariateStatistics-678"><span class="linenos">678</span></a>                                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="p">])</span>
-</span><span id="BivariateStatistics-679"><a href="#BivariateStatistics-679"><span class="linenos">679</span></a>        <span class="c1"># Column of value text</span>
-</span><span id="BivariateStatistics-680"><a href="#BivariateStatistics-680"><span class="linenos">680</span></a>        <span class="n">value_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
-</span><span id="BivariateStatistics-681"><a href="#BivariateStatistics-681"><span class="linenos">681</span></a>                                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
+</span><span id="BivariateStatistics-570"><a href="#BivariateStatistics-570"><span class="linenos">570</span></a>            <span class="c1"># summary += (stringformat+&#39;=&#39;+floatformat+&#39;\n&#39;).format(v,value)</span>
+</span><span id="BivariateStatistics-571"><a href="#BivariateStatistics-571"><span class="linenos">571</span></a>            <span class="n">summary</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
+</span><span id="BivariateStatistics-572"><a href="#BivariateStatistics-572"><span class="linenos">572</span></a>
+</span><span id="BivariateStatistics-573"><a href="#BivariateStatistics-573"><span class="linenos">573</span></a>        <span class="k">return</span> <span class="n">summary</span>
+</span><span id="BivariateStatistics-574"><a href="#BivariateStatistics-574"><span class="linenos">574</span></a>
+</span><span id="BivariateStatistics-575"><a href="#BivariateStatistics-575"><span class="linenos">575</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="BivariateStatistics-576"><a href="#BivariateStatistics-576"><span class="linenos">576</span></a>                <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="BivariateStatistics-577"><a href="#BivariateStatistics-577"><span class="linenos">577</span></a>                <span class="n">stringlength</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
+</span><span id="BivariateStatistics-578"><a href="#BivariateStatistics-578"><span class="linenos">578</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics</span>
+</span><span id="BivariateStatistics-579"><a href="#BivariateStatistics-579"><span class="linenos">579</span></a>
+</span><span id="BivariateStatistics-580"><a href="#BivariateStatistics-580"><span class="linenos">580</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics-581"><a href="#BivariateStatistics-581"><span class="linenos">581</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics-582"><a href="#BivariateStatistics-582"><span class="linenos">582</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
+</span><span id="BivariateStatistics-583"><a href="#BivariateStatistics-583"><span class="linenos">583</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="BivariateStatistics-584"><a href="#BivariateStatistics-584"><span class="linenos">584</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="BivariateStatistics-585"><a href="#BivariateStatistics-585"><span class="linenos">585</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="BivariateStatistics-586"><a href="#BivariateStatistics-586"><span class="linenos">586</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="BivariateStatistics-587"><a href="#BivariateStatistics-587"><span class="linenos">587</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="BivariateStatistics-588"><a href="#BivariateStatistics-588"><span class="linenos">588</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="BivariateStatistics-589"><a href="#BivariateStatistics-589"><span class="linenos">589</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="BivariateStatistics-590"><a href="#BivariateStatistics-590"><span class="linenos">590</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
+</span><span id="BivariateStatistics-591"><a href="#BivariateStatistics-591"><span class="linenos">591</span></a><span class="sd">            format specifier for integer values</span>
+</span><span id="BivariateStatistics-592"><a href="#BivariateStatistics-592"><span class="linenos">592</span></a><span class="sd">        floatformat : str, default=&#39;{:.4f}&#39;</span>
+</span><span id="BivariateStatistics-593"><a href="#BivariateStatistics-593"><span class="linenos">593</span></a><span class="sd">            format specifier for floating point values</span>
+</span><span id="BivariateStatistics-594"><a href="#BivariateStatistics-594"><span class="linenos">594</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="BivariateStatistics-595"><a href="#BivariateStatistics-595"><span class="linenos">595</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="BivariateStatistics-596"><a href="#BivariateStatistics-596"><span class="linenos">596</span></a><span class="sd">        stringlength : int, default=None</span>
+</span><span id="BivariateStatistics-597"><a href="#BivariateStatistics-597"><span class="linenos">597</span></a><span class="sd">            length of the variables on output</span>
+</span><span id="BivariateStatistics-598"><a href="#BivariateStatistics-598"><span class="linenos">598</span></a><span class="sd">            default (None) is to use the length of the longest variable name</span>
+</span><span id="BivariateStatistics-599"><a href="#BivariateStatistics-599"><span class="linenos">599</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics-600"><a href="#BivariateStatistics-600"><span class="linenos">600</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics-601"><a href="#BivariateStatistics-601"><span class="linenos">601</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics-602"><a href="#BivariateStatistics-602"><span class="linenos">602</span></a><span class="sd">        summary : str</span>
+</span><span id="BivariateStatistics-603"><a href="#BivariateStatistics-603"><span class="linenos">603</span></a><span class="sd">            names and values of variables</span>
+</span><span id="BivariateStatistics-604"><a href="#BivariateStatistics-604"><span class="linenos">604</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-605"><a href="#BivariateStatistics-605"><span class="linenos">605</span></a>        <span class="c1"># List of variables</span>
+</span><span id="BivariateStatistics-606"><a href="#BivariateStatistics-606"><span class="linenos">606</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="BivariateStatistics-607"><a href="#BivariateStatistics-607"><span class="linenos">607</span></a>
+</span><span id="BivariateStatistics-608"><a href="#BivariateStatistics-608"><span class="linenos">608</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics-609"><a href="#BivariateStatistics-609"><span class="linenos">609</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
+</span><span id="BivariateStatistics-610"><a href="#BivariateStatistics-610"><span class="linenos">610</span></a>        <span class="k">if</span> <span class="n">stringlength</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics-611"><a href="#BivariateStatistics-611"><span class="linenos">611</span></a>            <span class="n">stringlength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">])</span>
+</span><span id="BivariateStatistics-612"><a href="#BivariateStatistics-612"><span class="linenos">612</span></a>        <span class="n">stringformat</span> <span class="o">=</span> <span class="s1">&#39;{:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">stringlength</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s}&#39;</span>
+</span><span id="BivariateStatistics-613"><a href="#BivariateStatistics-613"><span class="linenos">613</span></a>
+</span><span id="BivariateStatistics-614"><a href="#BivariateStatistics-614"><span class="linenos">614</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
+</span><span id="BivariateStatistics-615"><a href="#BivariateStatistics-615"><span class="linenos">615</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-616"><a href="#BivariateStatistics-616"><span class="linenos">616</span></a>
+</span><span id="BivariateStatistics-617"><a href="#BivariateStatistics-617"><span class="linenos">617</span></a>        <span class="c1"># Extract length of the float numbers from floatformat</span>
+</span><span id="BivariateStatistics-618"><a href="#BivariateStatistics-618"><span class="linenos">618</span></a>        <span class="c1"># import re</span>
+</span><span id="BivariateStatistics-619"><a href="#BivariateStatistics-619"><span class="linenos">619</span></a>        <span class="c1"># floatlength = np.floor( float( re.findall(&quot;[-+]?(?:\d*\.*\d+)&quot;,</span>
+</span><span id="BivariateStatistics-620"><a href="#BivariateStatistics-620"><span class="linenos">620</span></a>        <span class="c1">#       floatformat )[0] ) ).astype(int)</span>
+</span><span id="BivariateStatistics-621"><a href="#BivariateStatistics-621"><span class="linenos">621</span></a>
+</span><span id="BivariateStatistics-622"><a href="#BivariateStatistics-622"><span class="linenos">622</span></a>        <span class="c1"># summary = (stringformat+&#39;{:&gt;10s}&#39;).format(&#39;Variable&#39;,&#39;Value&#39;)</span>
+</span><span id="BivariateStatistics-623"><a href="#BivariateStatistics-623"><span class="linenos">623</span></a>        <span class="n">summarytext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
+</span><span id="BivariateStatistics-624"><a href="#BivariateStatistics-624"><span class="linenos">624</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
+</span><span id="BivariateStatistics-625"><a href="#BivariateStatistics-625"><span class="linenos">625</span></a>            <span class="n">vstr</span> <span class="o">=</span> <span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
+</span><span id="BivariateStatistics-626"><a href="#BivariateStatistics-626"><span class="linenos">626</span></a>            <span class="n">summarytext</span> <span class="o">+=</span> <span class="p">(</span><span class="n">stringformat</span><span class="o">+</span><span class="s1">&#39; = </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">vstr</span><span class="p">)</span>
+</span><span id="BivariateStatistics-627"><a href="#BivariateStatistics-627"><span class="linenos">627</span></a>
+</span><span id="BivariateStatistics-628"><a href="#BivariateStatistics-628"><span class="linenos">628</span></a>        <span class="k">return</span> <span class="n">summarytext</span>
+</span><span id="BivariateStatistics-629"><a href="#BivariateStatistics-629"><span class="linenos">629</span></a>
+</span><span id="BivariateStatistics-630"><a href="#BivariateStatistics-630"><span class="linenos">630</span></a>    <span class="k">def</span> <span class="nf">summary_fig_inset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="BivariateStatistics-631"><a href="#BivariateStatistics-631"><span class="linenos">631</span></a>                          <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="BivariateStatistics-632"><a href="#BivariateStatistics-632"><span class="linenos">632</span></a>                          <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc_units</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics-633"><a href="#BivariateStatistics-633"><span class="linenos">633</span></a>                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="BivariateStatistics-634"><a href="#BivariateStatistics-634"><span class="linenos">634</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Display bivariate statistics as a table inset on a plot axis</span>
+</span><span id="BivariateStatistics-635"><a href="#BivariateStatistics-635"><span class="linenos">635</span></a>
+</span><span id="BivariateStatistics-636"><a href="#BivariateStatistics-636"><span class="linenos">636</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics-637"><a href="#BivariateStatistics-637"><span class="linenos">637</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics-638"><a href="#BivariateStatistics-638"><span class="linenos">638</span></a><span class="sd">        ax : matplotlib.Figure.Axis </span>
+</span><span id="BivariateStatistics-639"><a href="#BivariateStatistics-639"><span class="linenos">639</span></a><span class="sd">            axis where the table will be displayed</span>
+</span><span id="BivariateStatistics-640"><a href="#BivariateStatistics-640"><span class="linenos">640</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
+</span><span id="BivariateStatistics-641"><a href="#BivariateStatistics-641"><span class="linenos">641</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="BivariateStatistics-642"><a href="#BivariateStatistics-642"><span class="linenos">642</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="BivariateStatistics-643"><a href="#BivariateStatistics-643"><span class="linenos">643</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="BivariateStatistics-644"><a href="#BivariateStatistics-644"><span class="linenos">644</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="BivariateStatistics-645"><a href="#BivariateStatistics-645"><span class="linenos">645</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="BivariateStatistics-646"><a href="#BivariateStatistics-646"><span class="linenos">646</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="BivariateStatistics-647"><a href="#BivariateStatistics-647"><span class="linenos">647</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="BivariateStatistics-648"><a href="#BivariateStatistics-648"><span class="linenos">648</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
+</span><span id="BivariateStatistics-649"><a href="#BivariateStatistics-649"><span class="linenos">649</span></a><span class="sd">            format specifier for integer values</span>
+</span><span id="BivariateStatistics-650"><a href="#BivariateStatistics-650"><span class="linenos">650</span></a><span class="sd">        floatformat : str, default=&#39;{:.3f}&#39;</span>
+</span><span id="BivariateStatistics-651"><a href="#BivariateStatistics-651"><span class="linenos">651</span></a><span class="sd">            format specifier for floating point values</span>
+</span><span id="BivariateStatistics-652"><a href="#BivariateStatistics-652"><span class="linenos">652</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="BivariateStatistics-653"><a href="#BivariateStatistics-653"><span class="linenos">653</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="BivariateStatistics-654"><a href="#BivariateStatistics-654"><span class="linenos">654</span></a><span class="sd">        loc : tuple (x0,y0), default=(0.85, 0.05)</span>
+</span><span id="BivariateStatistics-655"><a href="#BivariateStatistics-655"><span class="linenos">655</span></a><span class="sd">            location on the axis where the table will be drawn</span>
+</span><span id="BivariateStatistics-656"><a href="#BivariateStatistics-656"><span class="linenos">656</span></a><span class="sd">            can be in data units or axes units [0-1]</span>
+</span><span id="BivariateStatistics-657"><a href="#BivariateStatistics-657"><span class="linenos">657</span></a><span class="sd">        loc_units : {&#39;axes&#39; (default), &#39;data&#39;}</span>
+</span><span id="BivariateStatistics-658"><a href="#BivariateStatistics-658"><span class="linenos">658</span></a><span class="sd">            specifies whether loc has &#39;data&#39; units or &#39;axes&#39; units [0-1]</span>
+</span><span id="BivariateStatistics-659"><a href="#BivariateStatistics-659"><span class="linenos">659</span></a><span class="sd">                    </span>
+</span><span id="BivariateStatistics-660"><a href="#BivariateStatistics-660"><span class="linenos">660</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics-661"><a href="#BivariateStatistics-661"><span class="linenos">661</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics-662"><a href="#BivariateStatistics-662"><span class="linenos">662</span></a><span class="sd">        text1, text2 : matplotlib text object</span>
+</span><span id="BivariateStatistics-663"><a href="#BivariateStatistics-663"><span class="linenos">663</span></a><span class="sd">            Artist for the two text boxes        </span>
+</span><span id="BivariateStatistics-664"><a href="#BivariateStatistics-664"><span class="linenos">664</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics-665"><a href="#BivariateStatistics-665"><span class="linenos">665</span></a>        <span class="c1"># List of variables</span>
+</span><span id="BivariateStatistics-666"><a href="#BivariateStatistics-666"><span class="linenos">666</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="BivariateStatistics-667"><a href="#BivariateStatistics-667"><span class="linenos">667</span></a>
+</span><span id="BivariateStatistics-668"><a href="#BivariateStatistics-668"><span class="linenos">668</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics-669"><a href="#BivariateStatistics-669"><span class="linenos">669</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
+</span><span id="BivariateStatistics-670"><a href="#BivariateStatistics-670"><span class="linenos">670</span></a>
+</span><span id="BivariateStatistics-671"><a href="#BivariateStatistics-671"><span class="linenos">671</span></a>        <span class="c1"># Default location in lower right corner</span>
+</span><span id="BivariateStatistics-672"><a href="#BivariateStatistics-672"><span class="linenos">672</span></a>        <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics-673"><a href="#BivariateStatistics-673"><span class="linenos">673</span></a>            <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
+</span><span id="BivariateStatistics-674"><a href="#BivariateStatistics-674"><span class="linenos">674</span></a>
+</span><span id="BivariateStatistics-675"><a href="#BivariateStatistics-675"><span class="linenos">675</span></a>        <span class="c1"># Coordinates for loc</span>
+</span><span id="BivariateStatistics-676"><a href="#BivariateStatistics-676"><span class="linenos">676</span></a>        <span class="k">if</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;data&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-677"><a href="#BivariateStatistics-677"><span class="linenos">677</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
+</span><span id="BivariateStatistics-678"><a href="#BivariateStatistics-678"><span class="linenos">678</span></a>        <span class="k">elif</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span><span class="s1">&#39;axis&#39;</span><span class="p">]:</span>
+</span><span id="BivariateStatistics-679"><a href="#BivariateStatistics-679"><span class="linenos">679</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
+</span><span id="BivariateStatistics-680"><a href="#BivariateStatistics-680"><span class="linenos">680</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics-681"><a href="#BivariateStatistics-681"><span class="linenos">681</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Display units should be &quot;Data&quot; or &quot;Axes&quot;&#39;</span><span class="p">)</span>
 </span><span id="BivariateStatistics-682"><a href="#BivariateStatistics-682"><span class="linenos">682</span></a>
-</span><span id="BivariateStatistics-683"><a href="#BivariateStatistics-683"><span class="linenos">683</span></a>        <span class="c1"># Check if horizontal alignment keyword is used</span>
-</span><span id="BivariateStatistics-684"><a href="#BivariateStatistics-684"><span class="linenos">684</span></a>        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
-</span><span id="BivariateStatistics-685"><a href="#BivariateStatistics-685"><span class="linenos">685</span></a>        <span class="k">try</span><span class="p">:</span>
-</span><span id="BivariateStatistics-686"><a href="#BivariateStatistics-686"><span class="linenos">686</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics-687"><a href="#BivariateStatistics-687"><span class="linenos">687</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
-</span><span id="BivariateStatistics-688"><a href="#BivariateStatistics-688"><span class="linenos">688</span></a>            <span class="k">pass</span>
-</span><span id="BivariateStatistics-689"><a href="#BivariateStatistics-689"><span class="linenos">689</span></a>        <span class="k">try</span><span class="p">:</span>
-</span><span id="BivariateStatistics-690"><a href="#BivariateStatistics-690"><span class="linenos">690</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;horizontalalignment&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics-691"><a href="#BivariateStatistics-691"><span class="linenos">691</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
-</span><span id="BivariateStatistics-692"><a href="#BivariateStatistics-692"><span class="linenos">692</span></a>            <span class="k">pass</span>
-</span><span id="BivariateStatistics-693"><a href="#BivariateStatistics-693"><span class="linenos">693</span></a>
-</span><span id="BivariateStatistics-694"><a href="#BivariateStatistics-694"><span class="linenos">694</span></a>        <span class="c1"># For right alignment, align on values first</span>
-</span><span id="BivariateStatistics-695"><a href="#BivariateStatistics-695"><span class="linenos">695</span></a>        <span class="c1"># Otherwise, align on labels</span>
-</span><span id="BivariateStatistics-696"><a href="#BivariateStatistics-696"><span class="linenos">696</span></a>        <span class="k">if</span> <span class="n">ha</span><span class="o">==</span><span class="s1">&#39;right&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics-697"><a href="#BivariateStatistics-697"><span class="linenos">697</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">value_text</span>
-</span><span id="BivariateStatistics-698"><a href="#BivariateStatistics-698"><span class="linenos">698</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">label_text</span>
-</span><span id="BivariateStatistics-699"><a href="#BivariateStatistics-699"><span class="linenos">699</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
-</span><span id="BivariateStatistics-700"><a href="#BivariateStatistics-700"><span class="linenos">700</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics-701"><a href="#BivariateStatistics-701"><span class="linenos">701</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">label_text</span>
-</span><span id="BivariateStatistics-702"><a href="#BivariateStatistics-702"><span class="linenos">702</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">value_text</span>
-</span><span id="BivariateStatistics-703"><a href="#BivariateStatistics-703"><span class="linenos">703</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
-</span><span id="BivariateStatistics-704"><a href="#BivariateStatistics-704"><span class="linenos">704</span></a>
-</span><span id="BivariateStatistics-705"><a href="#BivariateStatistics-705"><span class="linenos">705</span></a>        <span class="c1"># Add first column of text</span>
-</span><span id="BivariateStatistics-706"><a href="#BivariateStatistics-706"><span class="linenos">706</span></a>        <span class="n">t1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
-</span><span id="BivariateStatistics-707"><a href="#BivariateStatistics-707"><span class="linenos">707</span></a>                <span class="n">first_text</span><span class="p">,</span>
-</span><span id="BivariateStatistics-708"><a href="#BivariateStatistics-708"><span class="linenos">708</span></a>                <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
-</span><span id="BivariateStatistics-709"><a href="#BivariateStatistics-709"><span class="linenos">709</span></a>                <span class="o">**</span><span class="n">kwargs</span>
-</span><span id="BivariateStatistics-710"><a href="#BivariateStatistics-710"><span class="linenos">710</span></a>                <span class="p">)</span>
-</span><span id="BivariateStatistics-711"><a href="#BivariateStatistics-711"><span class="linenos">711</span></a>
-</span><span id="BivariateStatistics-712"><a href="#BivariateStatistics-712"><span class="linenos">712</span></a>        <span class="c1"># Get width of first text column</span>
-</span><span id="BivariateStatistics-713"><a href="#BivariateStatistics-713"><span class="linenos">713</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
-</span><span id="BivariateStatistics-714"><a href="#BivariateStatistics-714"><span class="linenos">714</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span><span class="o">-</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span>
-</span><span id="BivariateStatistics-715"><a href="#BivariateStatistics-715"><span class="linenos">715</span></a>
-</span><span id="BivariateStatistics-716"><a href="#BivariateStatistics-716"><span class="linenos">716</span></a>        <span class="c1"># Add second column of text</span>
-</span><span id="BivariateStatistics-717"><a href="#BivariateStatistics-717"><span class="linenos">717</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">width</span><span class="o">*</span><span class="n">sign</span><span class="p">,</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
-</span><span id="BivariateStatistics-718"><a href="#BivariateStatistics-718"><span class="linenos">718</span></a>                     <span class="n">second_text</span><span class="p">,</span>
-</span><span id="BivariateStatistics-719"><a href="#BivariateStatistics-719"><span class="linenos">719</span></a>                     <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
-</span><span id="BivariateStatistics-720"><a href="#BivariateStatistics-720"><span class="linenos">720</span></a>                     <span class="o">**</span><span class="n">kwargs</span>
-</span><span id="BivariateStatistics-721"><a href="#BivariateStatistics-721"><span class="linenos">721</span></a>                     <span class="p">)</span>
-</span><span id="BivariateStatistics-722"><a href="#BivariateStatistics-722"><span class="linenos">722</span></a>
-</span><span id="BivariateStatistics-723"><a href="#BivariateStatistics-723"><span class="linenos">723</span></a>        <span class="c1">##################################</span>
-</span><span id="BivariateStatistics-724"><a href="#BivariateStatistics-724"><span class="linenos">724</span></a>        <span class="c1"># Early version of this function using matplotlib.table.table()</span>
+</span><span id="BivariateStatistics-683"><a href="#BivariateStatistics-683"><span class="linenos">683</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
+</span><span id="BivariateStatistics-684"><a href="#BivariateStatistics-684"><span class="linenos">684</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
+</span><span id="BivariateStatistics-685"><a href="#BivariateStatistics-685"><span class="linenos">685</span></a>
+</span><span id="BivariateStatistics-686"><a href="#BivariateStatistics-686"><span class="linenos">686</span></a>        <span class="c1"># Column of label text</span>
+</span><span id="BivariateStatistics-687"><a href="#BivariateStatistics-687"><span class="linenos">687</span></a>        <span class="n">label_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_texify_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
+</span><span id="BivariateStatistics-688"><a href="#BivariateStatistics-688"><span class="linenos">688</span></a>                                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="p">])</span>
+</span><span id="BivariateStatistics-689"><a href="#BivariateStatistics-689"><span class="linenos">689</span></a>        <span class="c1"># Column of value text</span>
+</span><span id="BivariateStatistics-690"><a href="#BivariateStatistics-690"><span class="linenos">690</span></a>        <span class="n">value_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
+</span><span id="BivariateStatistics-691"><a href="#BivariateStatistics-691"><span class="linenos">691</span></a>                                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
+</span><span id="BivariateStatistics-692"><a href="#BivariateStatistics-692"><span class="linenos">692</span></a>
+</span><span id="BivariateStatistics-693"><a href="#BivariateStatistics-693"><span class="linenos">693</span></a>        <span class="c1"># Check if horizontal alignment keyword is used</span>
+</span><span id="BivariateStatistics-694"><a href="#BivariateStatistics-694"><span class="linenos">694</span></a>        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
+</span><span id="BivariateStatistics-695"><a href="#BivariateStatistics-695"><span class="linenos">695</span></a>        <span class="k">try</span><span class="p">:</span>
+</span><span id="BivariateStatistics-696"><a href="#BivariateStatistics-696"><span class="linenos">696</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics-697"><a href="#BivariateStatistics-697"><span class="linenos">697</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
+</span><span id="BivariateStatistics-698"><a href="#BivariateStatistics-698"><span class="linenos">698</span></a>            <span class="k">pass</span>
+</span><span id="BivariateStatistics-699"><a href="#BivariateStatistics-699"><span class="linenos">699</span></a>        <span class="k">try</span><span class="p">:</span>
+</span><span id="BivariateStatistics-700"><a href="#BivariateStatistics-700"><span class="linenos">700</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;horizontalalignment&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics-701"><a href="#BivariateStatistics-701"><span class="linenos">701</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
+</span><span id="BivariateStatistics-702"><a href="#BivariateStatistics-702"><span class="linenos">702</span></a>            <span class="k">pass</span>
+</span><span id="BivariateStatistics-703"><a href="#BivariateStatistics-703"><span class="linenos">703</span></a>
+</span><span id="BivariateStatistics-704"><a href="#BivariateStatistics-704"><span class="linenos">704</span></a>        <span class="c1"># For right alignment, align on values first</span>
+</span><span id="BivariateStatistics-705"><a href="#BivariateStatistics-705"><span class="linenos">705</span></a>        <span class="c1"># Otherwise, align on labels</span>
+</span><span id="BivariateStatistics-706"><a href="#BivariateStatistics-706"><span class="linenos">706</span></a>        <span class="k">if</span> <span class="n">ha</span><span class="o">==</span><span class="s1">&#39;right&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics-707"><a href="#BivariateStatistics-707"><span class="linenos">707</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">value_text</span>
+</span><span id="BivariateStatistics-708"><a href="#BivariateStatistics-708"><span class="linenos">708</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">label_text</span>
+</span><span id="BivariateStatistics-709"><a href="#BivariateStatistics-709"><span class="linenos">709</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
+</span><span id="BivariateStatistics-710"><a href="#BivariateStatistics-710"><span class="linenos">710</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics-711"><a href="#BivariateStatistics-711"><span class="linenos">711</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">label_text</span>
+</span><span id="BivariateStatistics-712"><a href="#BivariateStatistics-712"><span class="linenos">712</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">value_text</span>
+</span><span id="BivariateStatistics-713"><a href="#BivariateStatistics-713"><span class="linenos">713</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
+</span><span id="BivariateStatistics-714"><a href="#BivariateStatistics-714"><span class="linenos">714</span></a>
+</span><span id="BivariateStatistics-715"><a href="#BivariateStatistics-715"><span class="linenos">715</span></a>        <span class="c1"># Add first column of text</span>
+</span><span id="BivariateStatistics-716"><a href="#BivariateStatistics-716"><span class="linenos">716</span></a>        <span class="n">t1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
+</span><span id="BivariateStatistics-717"><a href="#BivariateStatistics-717"><span class="linenos">717</span></a>                <span class="n">first_text</span><span class="p">,</span>
+</span><span id="BivariateStatistics-718"><a href="#BivariateStatistics-718"><span class="linenos">718</span></a>                <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
+</span><span id="BivariateStatistics-719"><a href="#BivariateStatistics-719"><span class="linenos">719</span></a>                <span class="o">**</span><span class="n">kwargs</span>
+</span><span id="BivariateStatistics-720"><a href="#BivariateStatistics-720"><span class="linenos">720</span></a>                <span class="p">)</span>
+</span><span id="BivariateStatistics-721"><a href="#BivariateStatistics-721"><span class="linenos">721</span></a>
+</span><span id="BivariateStatistics-722"><a href="#BivariateStatistics-722"><span class="linenos">722</span></a>        <span class="c1"># Get width of first text column</span>
+</span><span id="BivariateStatistics-723"><a href="#BivariateStatistics-723"><span class="linenos">723</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
+</span><span id="BivariateStatistics-724"><a href="#BivariateStatistics-724"><span class="linenos">724</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span><span class="o">-</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span>
 </span><span id="BivariateStatistics-725"><a href="#BivariateStatistics-725"><span class="linenos">725</span></a>
-</span><span id="BivariateStatistics-726"><a href="#BivariateStatistics-726"><span class="linenos">726</span></a>        <span class="c1"># if isinstance(loc,(tuple,list)):</span>
-</span><span id="BivariateStatistics-727"><a href="#BivariateStatistics-727"><span class="linenos">727</span></a>        <span class="c1">#     # Create an inset axis to contain the table</span>
-</span><span id="BivariateStatistics-728"><a href="#BivariateStatistics-728"><span class="linenos">728</span></a>        <span class="c1">#     tableaxis = ax.inset_axes(loc)</span>
-</span><span id="BivariateStatistics-729"><a href="#BivariateStatistics-729"><span class="linenos">729</span></a>        <span class="c1">#     table_width=1</span>
-</span><span id="BivariateStatistics-730"><a href="#BivariateStatistics-730"><span class="linenos">730</span></a>        <span class="c1"># else:</span>
-</span><span id="BivariateStatistics-731"><a href="#BivariateStatistics-731"><span class="linenos">731</span></a>        <span class="c1">#     tableaxis = ax</span>
+</span><span id="BivariateStatistics-726"><a href="#BivariateStatistics-726"><span class="linenos">726</span></a>        <span class="c1"># Add second column of text</span>
+</span><span id="BivariateStatistics-727"><a href="#BivariateStatistics-727"><span class="linenos">727</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">width</span><span class="o">*</span><span class="n">sign</span><span class="p">,</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
+</span><span id="BivariateStatistics-728"><a href="#BivariateStatistics-728"><span class="linenos">728</span></a>                     <span class="n">second_text</span><span class="p">,</span>
+</span><span id="BivariateStatistics-729"><a href="#BivariateStatistics-729"><span class="linenos">729</span></a>                     <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
+</span><span id="BivariateStatistics-730"><a href="#BivariateStatistics-730"><span class="linenos">730</span></a>                     <span class="o">**</span><span class="n">kwargs</span>
+</span><span id="BivariateStatistics-731"><a href="#BivariateStatistics-731"><span class="linenos">731</span></a>                     <span class="p">)</span>
 </span><span id="BivariateStatistics-732"><a href="#BivariateStatistics-732"><span class="linenos">732</span></a>
-</span><span id="BivariateStatistics-733"><a href="#BivariateStatistics-733"><span class="linenos">733</span></a>        <span class="c1"># # Display the table on the axis</span>
-</span><span id="BivariateStatistics-734"><a href="#BivariateStatistics-734"><span class="linenos">734</span></a>        <span class="c1"># return mtable.table(</span>
-</span><span id="BivariateStatistics-735"><a href="#BivariateStatistics-735"><span class="linenos">735</span></a>        <span class="c1">#     tableaxis,</span>
-</span><span id="BivariateStatistics-736"><a href="#BivariateStatistics-736"><span class="linenos">736</span></a>        <span class="c1">#     cellText=[[floatformat.format(value)] for value in summarydict.values()],</span>
-</span><span id="BivariateStatistics-737"><a href="#BivariateStatistics-737"><span class="linenos">737</span></a>        <span class="c1">#     rowLabels=[texify_name(key) for key in summarydict],</span>
-</span><span id="BivariateStatistics-738"><a href="#BivariateStatistics-738"><span class="linenos">738</span></a>        <span class="c1">#     colWidths=[table_width/2]*2,</span>
-</span><span id="BivariateStatistics-739"><a href="#BivariateStatistics-739"><span class="linenos">739</span></a>        <span class="c1">#     edges=edges,</span>
-</span><span id="BivariateStatistics-740"><a href="#BivariateStatistics-740"><span class="linenos">740</span></a>        <span class="c1">#     loc=loc, bbox=bbox</span>
-</span><span id="BivariateStatistics-741"><a href="#BivariateStatistics-741"><span class="linenos">741</span></a>        <span class="c1">#     )</span>
+</span><span id="BivariateStatistics-733"><a href="#BivariateStatistics-733"><span class="linenos">733</span></a>        <span class="c1">##################################</span>
+</span><span id="BivariateStatistics-734"><a href="#BivariateStatistics-734"><span class="linenos">734</span></a>        <span class="c1"># Early version of this function using matplotlib.table.table()</span>
+</span><span id="BivariateStatistics-735"><a href="#BivariateStatistics-735"><span class="linenos">735</span></a>
+</span><span id="BivariateStatistics-736"><a href="#BivariateStatistics-736"><span class="linenos">736</span></a>        <span class="c1"># if isinstance(loc,(tuple,list)):</span>
+</span><span id="BivariateStatistics-737"><a href="#BivariateStatistics-737"><span class="linenos">737</span></a>        <span class="c1">#     # Create an inset axis to contain the table</span>
+</span><span id="BivariateStatistics-738"><a href="#BivariateStatistics-738"><span class="linenos">738</span></a>        <span class="c1">#     tableaxis = ax.inset_axes(loc)</span>
+</span><span id="BivariateStatistics-739"><a href="#BivariateStatistics-739"><span class="linenos">739</span></a>        <span class="c1">#     table_width=1</span>
+</span><span id="BivariateStatistics-740"><a href="#BivariateStatistics-740"><span class="linenos">740</span></a>        <span class="c1"># else:</span>
+</span><span id="BivariateStatistics-741"><a href="#BivariateStatistics-741"><span class="linenos">741</span></a>        <span class="c1">#     tableaxis = ax</span>
 </span><span id="BivariateStatistics-742"><a href="#BivariateStatistics-742"><span class="linenos">742</span></a>
-</span><span id="BivariateStatistics-743"><a href="#BivariateStatistics-743"><span class="linenos">743</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">]</span>
+</span><span id="BivariateStatistics-743"><a href="#BivariateStatistics-743"><span class="linenos">743</span></a>        <span class="c1"># # Display the table on the axis</span>
+</span><span id="BivariateStatistics-744"><a href="#BivariateStatistics-744"><span class="linenos">744</span></a>        <span class="c1"># return mtable.table(</span>
+</span><span id="BivariateStatistics-745"><a href="#BivariateStatistics-745"><span class="linenos">745</span></a>        <span class="c1">#     tableaxis,</span>
+</span><span id="BivariateStatistics-746"><a href="#BivariateStatistics-746"><span class="linenos">746</span></a>        <span class="c1">#     cellText=[[floatformat.format(value)] for value in summarydict.values()],</span>
+</span><span id="BivariateStatistics-747"><a href="#BivariateStatistics-747"><span class="linenos">747</span></a>        <span class="c1">#     rowLabels=[texify_name(key) for key in summarydict],</span>
+</span><span id="BivariateStatistics-748"><a href="#BivariateStatistics-748"><span class="linenos">748</span></a>        <span class="c1">#     colWidths=[table_width/2]*2,</span>
+</span><span id="BivariateStatistics-749"><a href="#BivariateStatistics-749"><span class="linenos">749</span></a>        <span class="c1">#     edges=edges,</span>
+</span><span id="BivariateStatistics-750"><a href="#BivariateStatistics-750"><span class="linenos">750</span></a>        <span class="c1">#     loc=loc, bbox=bbox</span>
+</span><span id="BivariateStatistics-751"><a href="#BivariateStatistics-751"><span class="linenos">751</span></a>        <span class="c1">#     )</span>
+</span><span id="BivariateStatistics-752"><a href="#BivariateStatistics-752"><span class="linenos">752</span></a>
+</span><span id="BivariateStatistics-753"><a href="#BivariateStatistics-753"><span class="linenos">753</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">]</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>A suite of common statistics to quantify bivariate relationships</p>
 
 <p>Class method 'summary' provides a formatted summary of these statistics</p>
 
@@ -1467,28 +1487,32 @@
 mean of x and y variables</li>
 <li><strong>xmedian, ymedian</strong> (float):
 median of x and y variables</li>
 <li><strong>xstd, ystd</strong> (float):
 standard deviation of x and y variables</li>
 <li><strong>mean_difference, md</strong> (float):
 ymean - xmean</li>
+<li><strong>std_difference, stdd</strong> (float):
+std( y - x )</li>
 <li><strong>mean_absolute_difference, mad</strong> (float):
 mean( |y-x| )</li>
 <li><strong>relative_mean_difference, rmd</strong> (float):
 md / xmean</li>
 <li><strong>relative_mean_absolute_difference, rmad</strong> (float):
 mad / xmean</li>
 <li><strong>standardized_mean_difference, smd</strong> (float):
 md / xstd</li>
 <li><strong>standardized_mean_absolute_difference, smad</strong> (float):
 mad /xstd</li>
 <li><strong>mean_relative_difference, mrd</strong> (float):
 mean(y/x) - 1</li>
 <li><strong>mean_log10_ratio, mlr</strong> (float):
 mean( log10(y/x) )</li>
+<li><strong>std_log10_ratio, stdlr</strong> (float):
+std( log10(y/x) )</li>
 <li><strong>mean_absolute_log10_ratio, malr</strong> (float):
 mean( abs( log10(y/x) ) )</li>
 <li><strong>median_difference, medd</strong> (float):
 median(y-x)</li>
 <li><strong>median_absolute_difference, medad</strong> (float):
 median(|y-x|)</li>
 <li><strong>relative_median_difference, rmedd</strong> (float):
@@ -1503,14 +1527,16 @@
 median( abs( log10(y/x) ) )</li>
 <li><strong>normalized_mean_bias_factor, nmbf</strong> (float):
 see <code><a href="#nmbf">nmbf</a></code></li>
 <li><strong>normalized_mean_absolute_error_factor, nmaef</strong> (float):
 see <code><a href="#nmaef">nmaef</a></code></li>
 <li><strong>root_mean_square_difference, rmsd</strong> (float):
 $\sqrt{ \langle (y - x)^2 \rangle }$</li>
+<li><strong>root_mean_square_log10_ratio, rmslr</strong> (float):
+$\sqrt{ \langle log10(y/x)^2 \rangle }$</li>
 <li><strong>covariance</strong> (float):
 cov(x,y)</li>
 <li><strong>correlation_pearson, correlation, pearsonr, R, r</strong> (float):
 Pearson linear correlation coefficient</li>
 <li><strong>correlation_spearman, spearmanr</strong> (float):
 Spearman, non-parametric rank correlation coefficient</li>
 <li><strong>R2, r2</strong> (float):
@@ -1525,126 +1551,130 @@
             
         <span class="name">BivariateStatistics</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">w</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">data</span><span class="o">=</span><span class="kc">None</span></span>)</span>
 
                 <label class="view-source-button" for="BivariateStatistics.__init__-view-source"><span>View Source</span></label>
 
     </div>
     <a class="headerlink" href="#BivariateStatistics.__init__"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.__init__-251"><a href="#BivariateStatistics.__init__-251"><span class="linenos">251</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
-</span><span id="BivariateStatistics.__init__-252"><a href="#BivariateStatistics.__init__-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute suite of bivariate statistics during initialization</span>
-</span><span id="BivariateStatistics.__init__-253"><a href="#BivariateStatistics.__init__-253"><span class="linenos">253</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics.__init__-254"><a href="#BivariateStatistics.__init__-254"><span class="linenos">254</span></a><span class="sd">        Statistic values are saved in attributes.</span>
-</span><span id="BivariateStatistics.__init__-255"><a href="#BivariateStatistics.__init__-255"><span class="linenos">255</span></a><span class="sd">        CAUTION: Weights w are ignored except in SMA fit</span>
-</span><span id="BivariateStatistics.__init__-256"><a href="#BivariateStatistics.__init__-256"><span class="linenos">256</span></a>
-</span><span id="BivariateStatistics.__init__-257"><a href="#BivariateStatistics.__init__-257"><span class="linenos">257</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics.__init__-258"><a href="#BivariateStatistics.__init__-258"><span class="linenos">258</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics.__init__-259"><a href="#BivariateStatistics.__init__-259"><span class="linenos">259</span></a><span class="sd">        x : ndarray or str</span>
-</span><span id="BivariateStatistics.__init__-260"><a href="#BivariateStatistics.__init__-260"><span class="linenos">260</span></a><span class="sd">            independent variable values</span>
-</span><span id="BivariateStatistics.__init__-261"><a href="#BivariateStatistics.__init__-261"><span class="linenos">261</span></a><span class="sd">        y : ndarray or str</span>
-</span><span id="BivariateStatistics.__init__-262"><a href="#BivariateStatistics.__init__-262"><span class="linenos">262</span></a><span class="sd">            dependent variable values, same size as x</span>
-</span><span id="BivariateStatistics.__init__-263"><a href="#BivariateStatistics.__init__-263"><span class="linenos">263</span></a><span class="sd">        w : ndarray or str, optional</span>
-</span><span id="BivariateStatistics.__init__-264"><a href="#BivariateStatistics.__init__-264"><span class="linenos">264</span></a><span class="sd">            weights for points (x,y), same size as x and y</span>
-</span><span id="BivariateStatistics.__init__-265"><a href="#BivariateStatistics.__init__-265"><span class="linenos">265</span></a><span class="sd">        dropna : bool, optional (default=False)</span>
-</span><span id="BivariateStatistics.__init__-266"><a href="#BivariateStatistics.__init__-266"><span class="linenos">266</span></a><span class="sd">            drops NaN values from x, y, and w</span>
-</span><span id="BivariateStatistics.__init__-267"><a href="#BivariateStatistics.__init__-267"><span class="linenos">267</span></a><span class="sd">        data : dict-like, optional</span>
-</span><span id="BivariateStatistics.__init__-268"><a href="#BivariateStatistics.__init__-268"><span class="linenos">268</span></a><span class="sd">            if x, y, or w are str, then they should be keys in data</span>
-</span><span id="BivariateStatistics.__init__-269"><a href="#BivariateStatistics.__init__-269"><span class="linenos">269</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics.__init__-270"><a href="#BivariateStatistics.__init__-270"><span class="linenos">270</span></a>
-</span><span id="BivariateStatistics.__init__-271"><a href="#BivariateStatistics.__init__-271"><span class="linenos">271</span></a>        <span class="c1"># Get values from data if needed</span>
-</span><span id="BivariateStatistics.__init__-272"><a href="#BivariateStatistics.__init__-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span>
-</span><span id="BivariateStatistics.__init__-273"><a href="#BivariateStatistics.__init__-273"><span class="linenos">273</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Data argument must be used if x, y, or w is a string&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-274"><a href="#BivariateStatistics.__init__-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="BivariateStatistics.__init__-275"><a href="#BivariateStatistics.__init__-275"><span class="linenos">275</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
-</span><span id="BivariateStatistics.__init__-276"><a href="#BivariateStatistics.__init__-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="BivariateStatistics.__init__-277"><a href="#BivariateStatistics.__init__-277"><span class="linenos">277</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
-</span><span id="BivariateStatistics.__init__-278"><a href="#BivariateStatistics.__init__-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
-</span><span id="BivariateStatistics.__init__-279"><a href="#BivariateStatistics.__init__-279"><span class="linenos">279</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
-</span><span id="BivariateStatistics.__init__-280"><a href="#BivariateStatistics.__init__-280"><span class="linenos">280</span></a>
-</span><span id="BivariateStatistics.__init__-281"><a href="#BivariateStatistics.__init__-281"><span class="linenos">281</span></a>        <span class="c1">#Ensure that x and y have same length</span>
-</span><span id="BivariateStatistics.__init__-282"><a href="#BivariateStatistics.__init__-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
-</span><span id="BivariateStatistics.__init__-283"><a href="#BivariateStatistics.__init__-283"><span class="linenos">283</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Arguments x and y must have the same length&#39;</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-284"><a href="#BivariateStatistics.__init__-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics.__init__-285"><a href="#BivariateStatistics.__init__-285"><span class="linenos">285</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-286"><a href="#BivariateStatistics.__init__-286"><span class="linenos">286</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
-</span><span id="BivariateStatistics.__init__-287"><a href="#BivariateStatistics.__init__-287"><span class="linenos">287</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Argument w (if present) must have the same length as x&#39;</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-288"><a href="#BivariateStatistics.__init__-288"><span class="linenos">288</span></a>
-</span><span id="BivariateStatistics.__init__-289"><a href="#BivariateStatistics.__init__-289"><span class="linenos">289</span></a>        <span class="c1"># Drop NaN values</span>
-</span><span id="BivariateStatistics.__init__-290"><a href="#BivariateStatistics.__init__-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
-</span><span id="BivariateStatistics.__init__-291"><a href="#BivariateStatistics.__init__-291"><span class="linenos">291</span></a>            <span class="n">isna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-292"><a href="#BivariateStatistics.__init__-292"><span class="linenos">292</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="BivariateStatistics.__init__-293"><a href="#BivariateStatistics.__init__-293"><span class="linenos">293</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="BivariateStatistics.__init__-294"><a href="#BivariateStatistics.__init__-294"><span class="linenos">294</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
-</span><span id="BivariateStatistics.__init__-295"><a href="#BivariateStatistics.__init__-295"><span class="linenos">295</span></a>
-</span><span id="BivariateStatistics.__init__-296"><a href="#BivariateStatistics.__init__-296"><span class="linenos">296</span></a>        <span class="c1"># Differences and ratios used repeatedly</span>
-</span><span id="BivariateStatistics.__init__-297"><a href="#BivariateStatistics.__init__-297"><span class="linenos">297</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
-</span><span id="BivariateStatistics.__init__-298"><a href="#BivariateStatistics.__init__-298"><span class="linenos">298</span></a>        <span class="n">absdiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-299"><a href="#BivariateStatistics.__init__-299"><span class="linenos">299</span></a>        <span class="c1"># Ignore divide by zero and 0/0 while dividing</span>
-</span><span id="BivariateStatistics.__init__-300"><a href="#BivariateStatistics.__init__-300"><span class="linenos">300</span></a>        <span class="n">old_settings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-301"><a href="#BivariateStatistics.__init__-301"><span class="linenos">301</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">y</span><span class="o">/</span><span class="n">x</span>
-</span><span id="BivariateStatistics.__init__-302"><a href="#BivariateStatistics.__init__-302"><span class="linenos">302</span></a>        <span class="n">log10ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-303"><a href="#BivariateStatistics.__init__-303"><span class="linenos">303</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_settings</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-304"><a href="#BivariateStatistics.__init__-304"><span class="linenos">304</span></a>
-</span><span id="BivariateStatistics.__init__-305"><a href="#BivariateStatistics.__init__-305"><span class="linenos">305</span></a>        <span class="c1"># Number of data points</span>
-</span><span id="BivariateStatistics.__init__-306"><a href="#BivariateStatistics.__init__-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-307"><a href="#BivariateStatistics.__init__-307"><span class="linenos">307</span></a>
-</span><span id="BivariateStatistics.__init__-308"><a href="#BivariateStatistics.__init__-308"><span class="linenos">308</span></a>        <span class="c1"># Means, medians, and standard deviations</span>
-</span><span id="BivariateStatistics.__init__-309"><a href="#BivariateStatistics.__init__-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-310"><a href="#BivariateStatistics.__init__-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-311"><a href="#BivariateStatistics.__init__-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-312"><a href="#BivariateStatistics.__init__-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-313"><a href="#BivariateStatistics.__init__-313"><span class="linenos">313</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-314"><a href="#BivariateStatistics.__init__-314"><span class="linenos">314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ystd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-315"><a href="#BivariateStatistics.__init__-315"><span class="linenos">315</span></a>
-</span><span id="BivariateStatistics.__init__-316"><a href="#BivariateStatistics.__init__-316"><span class="linenos">316</span></a>        <span class="c1"># Save values for use later</span>
-</span><span id="BivariateStatistics.__init__-317"><a href="#BivariateStatistics.__init__-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
-</span><span id="BivariateStatistics.__init__-318"><a href="#BivariateStatistics.__init__-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
-</span><span id="BivariateStatistics.__init__-319"><a href="#BivariateStatistics.__init__-319"><span class="linenos">319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">w</span>
-</span><span id="BivariateStatistics.__init__-320"><a href="#BivariateStatistics.__init__-320"><span class="linenos">320</span></a>
-</span><span id="BivariateStatistics.__init__-321"><a href="#BivariateStatistics.__init__-321"><span class="linenos">321</span></a>        <span class="c1"># Mean and mean absolute differences</span>
-</span><span id="BivariateStatistics.__init__-322"><a href="#BivariateStatistics.__init__-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">md</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="BivariateStatistics.__init__-323"><a href="#BivariateStatistics.__init__-323"><span class="linenos">323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mad</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-324"><a href="#BivariateStatistics.__init__-324"><span class="linenos">324</span></a>
-</span><span id="BivariateStatistics.__init__-325"><a href="#BivariateStatistics.__init__-325"><span class="linenos">325</span></a>        <span class="c1"># Relative and standardized differences</span>
-</span><span id="BivariateStatistics.__init__-326"><a href="#BivariateStatistics.__init__-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_difference</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="BivariateStatistics.__init__-327"><a href="#BivariateStatistics.__init__-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
-</span><span id="BivariateStatistics.__init__-328"><a href="#BivariateStatistics.__init__-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_difference</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
-</span><span id="BivariateStatistics.__init__-329"><a href="#BivariateStatistics.__init__-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
-</span><span id="BivariateStatistics.__init__-330"><a href="#BivariateStatistics.__init__-330"><span class="linenos">330</span></a>
-</span><span id="BivariateStatistics.__init__-331"><a href="#BivariateStatistics.__init__-331"><span class="linenos">331</span></a>        <span class="c1"># Mean and median relative differences</span>
-</span><span id="BivariateStatistics.__init__-332"><a href="#BivariateStatistics.__init__-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_relative_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mrd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-333"><a href="#BivariateStatistics.__init__-333"><span class="linenos">333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_relative_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medianrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medrd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-334"><a href="#BivariateStatistics.__init__-334"><span class="linenos">334</span></a>
-</span><span id="BivariateStatistics.__init__-335"><a href="#BivariateStatistics.__init__-335"><span class="linenos">335</span></a>        <span class="c1"># Median and median absolute differences</span>
-</span><span id="BivariateStatistics.__init__-336"><a href="#BivariateStatistics.__init__-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-337"><a href="#BivariateStatistics.__init__-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-338"><a href="#BivariateStatistics.__init__-338"><span class="linenos">338</span></a>
-</span><span id="BivariateStatistics.__init__-339"><a href="#BivariateStatistics.__init__-339"><span class="linenos">339</span></a>        <span class="c1"># Relative median differences</span>
-</span><span id="BivariateStatistics.__init__-340"><a href="#BivariateStatistics.__init__-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
-</span><span id="BivariateStatistics.__init__-341"><a href="#BivariateStatistics.__init__-341"><span class="linenos">341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
-</span><span id="BivariateStatistics.__init__-342"><a href="#BivariateStatistics.__init__-342"><span class="linenos">342</span></a>
-</span><span id="BivariateStatistics.__init__-343"><a href="#BivariateStatistics.__init__-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_bias_factor</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmbf</span>  <span class="o">=</span> <span class="n">nmbf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-344"><a href="#BivariateStatistics.__init__-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_absolute_error_factor</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmaef</span> <span class="o">=</span> <span class="n">nmaef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.__init__-257"><a href="#BivariateStatistics.__init__-257"><span class="linenos">257</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
+</span><span id="BivariateStatistics.__init__-258"><a href="#BivariateStatistics.__init__-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute suite of bivariate statistics during initialization</span>
+</span><span id="BivariateStatistics.__init__-259"><a href="#BivariateStatistics.__init__-259"><span class="linenos">259</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics.__init__-260"><a href="#BivariateStatistics.__init__-260"><span class="linenos">260</span></a><span class="sd">        Statistic values are saved in attributes.</span>
+</span><span id="BivariateStatistics.__init__-261"><a href="#BivariateStatistics.__init__-261"><span class="linenos">261</span></a><span class="sd">        CAUTION: Weights w are ignored except in SMA fit</span>
+</span><span id="BivariateStatistics.__init__-262"><a href="#BivariateStatistics.__init__-262"><span class="linenos">262</span></a>
+</span><span id="BivariateStatistics.__init__-263"><a href="#BivariateStatistics.__init__-263"><span class="linenos">263</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics.__init__-264"><a href="#BivariateStatistics.__init__-264"><span class="linenos">264</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics.__init__-265"><a href="#BivariateStatistics.__init__-265"><span class="linenos">265</span></a><span class="sd">        x : ndarray or str</span>
+</span><span id="BivariateStatistics.__init__-266"><a href="#BivariateStatistics.__init__-266"><span class="linenos">266</span></a><span class="sd">            independent variable values</span>
+</span><span id="BivariateStatistics.__init__-267"><a href="#BivariateStatistics.__init__-267"><span class="linenos">267</span></a><span class="sd">        y : ndarray or str</span>
+</span><span id="BivariateStatistics.__init__-268"><a href="#BivariateStatistics.__init__-268"><span class="linenos">268</span></a><span class="sd">            dependent variable values, same size as x</span>
+</span><span id="BivariateStatistics.__init__-269"><a href="#BivariateStatistics.__init__-269"><span class="linenos">269</span></a><span class="sd">        w : ndarray or str, optional</span>
+</span><span id="BivariateStatistics.__init__-270"><a href="#BivariateStatistics.__init__-270"><span class="linenos">270</span></a><span class="sd">            weights for points (x,y), same size as x and y</span>
+</span><span id="BivariateStatistics.__init__-271"><a href="#BivariateStatistics.__init__-271"><span class="linenos">271</span></a><span class="sd">        dropna : bool, optional (default=False)</span>
+</span><span id="BivariateStatistics.__init__-272"><a href="#BivariateStatistics.__init__-272"><span class="linenos">272</span></a><span class="sd">            drops NaN values from x, y, and w</span>
+</span><span id="BivariateStatistics.__init__-273"><a href="#BivariateStatistics.__init__-273"><span class="linenos">273</span></a><span class="sd">        data : dict-like, optional</span>
+</span><span id="BivariateStatistics.__init__-274"><a href="#BivariateStatistics.__init__-274"><span class="linenos">274</span></a><span class="sd">            if x, y, or w are str, then they should be keys in data</span>
+</span><span id="BivariateStatistics.__init__-275"><a href="#BivariateStatistics.__init__-275"><span class="linenos">275</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics.__init__-276"><a href="#BivariateStatistics.__init__-276"><span class="linenos">276</span></a>
+</span><span id="BivariateStatistics.__init__-277"><a href="#BivariateStatistics.__init__-277"><span class="linenos">277</span></a>        <span class="c1"># Get values from data if needed</span>
+</span><span id="BivariateStatistics.__init__-278"><a href="#BivariateStatistics.__init__-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span>
+</span><span id="BivariateStatistics.__init__-279"><a href="#BivariateStatistics.__init__-279"><span class="linenos">279</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Data argument must be used if x, y, or w is a string&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-280"><a href="#BivariateStatistics.__init__-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="BivariateStatistics.__init__-281"><a href="#BivariateStatistics.__init__-281"><span class="linenos">281</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
+</span><span id="BivariateStatistics.__init__-282"><a href="#BivariateStatistics.__init__-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="BivariateStatistics.__init__-283"><a href="#BivariateStatistics.__init__-283"><span class="linenos">283</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
+</span><span id="BivariateStatistics.__init__-284"><a href="#BivariateStatistics.__init__-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
+</span><span id="BivariateStatistics.__init__-285"><a href="#BivariateStatistics.__init__-285"><span class="linenos">285</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
+</span><span id="BivariateStatistics.__init__-286"><a href="#BivariateStatistics.__init__-286"><span class="linenos">286</span></a>
+</span><span id="BivariateStatistics.__init__-287"><a href="#BivariateStatistics.__init__-287"><span class="linenos">287</span></a>        <span class="c1">#Ensure that x and y have same length</span>
+</span><span id="BivariateStatistics.__init__-288"><a href="#BivariateStatistics.__init__-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
+</span><span id="BivariateStatistics.__init__-289"><a href="#BivariateStatistics.__init__-289"><span class="linenos">289</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Arguments x and y must have the same length&#39;</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-290"><a href="#BivariateStatistics.__init__-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics.__init__-291"><a href="#BivariateStatistics.__init__-291"><span class="linenos">291</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-292"><a href="#BivariateStatistics.__init__-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
+</span><span id="BivariateStatistics.__init__-293"><a href="#BivariateStatistics.__init__-293"><span class="linenos">293</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s1">&#39;Argument w (if present) must have the same length as x&#39;</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-294"><a href="#BivariateStatistics.__init__-294"><span class="linenos">294</span></a>
+</span><span id="BivariateStatistics.__init__-295"><a href="#BivariateStatistics.__init__-295"><span class="linenos">295</span></a>        <span class="c1"># Drop NaN values</span>
+</span><span id="BivariateStatistics.__init__-296"><a href="#BivariateStatistics.__init__-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="n">dropna</span><span class="p">:</span>
+</span><span id="BivariateStatistics.__init__-297"><a href="#BivariateStatistics.__init__-297"><span class="linenos">297</span></a>            <span class="n">isna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-298"><a href="#BivariateStatistics.__init__-298"><span class="linenos">298</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="BivariateStatistics.__init__-299"><a href="#BivariateStatistics.__init__-299"><span class="linenos">299</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="BivariateStatistics.__init__-300"><a href="#BivariateStatistics.__init__-300"><span class="linenos">300</span></a>            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="o">~</span><span class="n">isna</span><span class="p">]</span>
+</span><span id="BivariateStatistics.__init__-301"><a href="#BivariateStatistics.__init__-301"><span class="linenos">301</span></a>
+</span><span id="BivariateStatistics.__init__-302"><a href="#BivariateStatistics.__init__-302"><span class="linenos">302</span></a>        <span class="c1"># Differences and ratios used repeatedly</span>
+</span><span id="BivariateStatistics.__init__-303"><a href="#BivariateStatistics.__init__-303"><span class="linenos">303</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
+</span><span id="BivariateStatistics.__init__-304"><a href="#BivariateStatistics.__init__-304"><span class="linenos">304</span></a>        <span class="n">absdiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-305"><a href="#BivariateStatistics.__init__-305"><span class="linenos">305</span></a>        <span class="c1"># Ignore divide by zero and 0/0 while dividing</span>
+</span><span id="BivariateStatistics.__init__-306"><a href="#BivariateStatistics.__init__-306"><span class="linenos">306</span></a>        <span class="n">old_settings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-307"><a href="#BivariateStatistics.__init__-307"><span class="linenos">307</span></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">y</span><span class="o">/</span><span class="n">x</span>
+</span><span id="BivariateStatistics.__init__-308"><a href="#BivariateStatistics.__init__-308"><span class="linenos">308</span></a>        <span class="n">log10ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-309"><a href="#BivariateStatistics.__init__-309"><span class="linenos">309</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_settings</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-310"><a href="#BivariateStatistics.__init__-310"><span class="linenos">310</span></a>
+</span><span id="BivariateStatistics.__init__-311"><a href="#BivariateStatistics.__init__-311"><span class="linenos">311</span></a>        <span class="c1"># Number of data points</span>
+</span><span id="BivariateStatistics.__init__-312"><a href="#BivariateStatistics.__init__-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-313"><a href="#BivariateStatistics.__init__-313"><span class="linenos">313</span></a>
+</span><span id="BivariateStatistics.__init__-314"><a href="#BivariateStatistics.__init__-314"><span class="linenos">314</span></a>        <span class="c1"># Means, medians, and standard deviations</span>
+</span><span id="BivariateStatistics.__init__-315"><a href="#BivariateStatistics.__init__-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-316"><a href="#BivariateStatistics.__init__-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-317"><a href="#BivariateStatistics.__init__-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-318"><a href="#BivariateStatistics.__init__-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ymedian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-319"><a href="#BivariateStatistics.__init__-319"><span class="linenos">319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-320"><a href="#BivariateStatistics.__init__-320"><span class="linenos">320</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ystd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-321"><a href="#BivariateStatistics.__init__-321"><span class="linenos">321</span></a>
+</span><span id="BivariateStatistics.__init__-322"><a href="#BivariateStatistics.__init__-322"><span class="linenos">322</span></a>        <span class="c1"># Save values for use later</span>
+</span><span id="BivariateStatistics.__init__-323"><a href="#BivariateStatistics.__init__-323"><span class="linenos">323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
+</span><span id="BivariateStatistics.__init__-324"><a href="#BivariateStatistics.__init__-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
+</span><span id="BivariateStatistics.__init__-325"><a href="#BivariateStatistics.__init__-325"><span class="linenos">325</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">w</span>
+</span><span id="BivariateStatistics.__init__-326"><a href="#BivariateStatistics.__init__-326"><span class="linenos">326</span></a>
+</span><span id="BivariateStatistics.__init__-327"><a href="#BivariateStatistics.__init__-327"><span class="linenos">327</span></a>        <span class="c1"># Mean and mean absolute differences</span>
+</span><span id="BivariateStatistics.__init__-328"><a href="#BivariateStatistics.__init__-328"><span class="linenos">328</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">md</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymean</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="BivariateStatistics.__init__-329"><a href="#BivariateStatistics.__init__-329"><span class="linenos">329</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mad</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-330"><a href="#BivariateStatistics.__init__-330"><span class="linenos">330</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">std_difference</span>             <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-331"><a href="#BivariateStatistics.__init__-331"><span class="linenos">331</span></a>
+</span><span id="BivariateStatistics.__init__-332"><a href="#BivariateStatistics.__init__-332"><span class="linenos">332</span></a>        <span class="c1"># Relative and standardized differences</span>
+</span><span id="BivariateStatistics.__init__-333"><a href="#BivariateStatistics.__init__-333"><span class="linenos">333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_difference</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="BivariateStatistics.__init__-334"><a href="#BivariateStatistics.__init__-334"><span class="linenos">334</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmean</span>
+</span><span id="BivariateStatistics.__init__-335"><a href="#BivariateStatistics.__init__-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_difference</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
+</span><span id="BivariateStatistics.__init__-336"><a href="#BivariateStatistics.__init__-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standardized_mean_absolute_difference</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xstd</span>
+</span><span id="BivariateStatistics.__init__-337"><a href="#BivariateStatistics.__init__-337"><span class="linenos">337</span></a>
+</span><span id="BivariateStatistics.__init__-338"><a href="#BivariateStatistics.__init__-338"><span class="linenos">338</span></a>        <span class="c1"># Mean and median relative differences</span>
+</span><span id="BivariateStatistics.__init__-339"><a href="#BivariateStatistics.__init__-339"><span class="linenos">339</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_relative_difference</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mrd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-340"><a href="#BivariateStatistics.__init__-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_relative_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medianrd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medrd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-341"><a href="#BivariateStatistics.__init__-341"><span class="linenos">341</span></a>
+</span><span id="BivariateStatistics.__init__-342"><a href="#BivariateStatistics.__init__-342"><span class="linenos">342</span></a>        <span class="c1"># Median and median absolute differences</span>
+</span><span id="BivariateStatistics.__init__-343"><a href="#BivariateStatistics.__init__-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medd</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">diff</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-344"><a href="#BivariateStatistics.__init__-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">absdiff</span> <span class="p">)</span>
 </span><span id="BivariateStatistics.__init__-345"><a href="#BivariateStatistics.__init__-345"><span class="linenos">345</span></a>
-</span><span id="BivariateStatistics.__init__-346"><a href="#BivariateStatistics.__init__-346"><span class="linenos">346</span></a>        <span class="c1"># Mean and mean absolute log ratio</span>
-</span><span id="BivariateStatistics.__init__-347"><a href="#BivariateStatistics.__init__-347"><span class="linenos">347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-348"><a href="#BivariateStatistics.__init__-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">malr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-349"><a href="#BivariateStatistics.__init__-349"><span class="linenos">349</span></a>        
-</span><span id="BivariateStatistics.__init__-350"><a href="#BivariateStatistics.__init__-350"><span class="linenos">350</span></a>        <span class="c1"># Median and median absolute log ratio</span>
-</span><span id="BivariateStatistics.__init__-351"><a href="#BivariateStatistics.__init__-351"><span class="linenos">351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-352"><a href="#BivariateStatistics.__init__-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medalr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-353"><a href="#BivariateStatistics.__init__-353"><span class="linenos">353</span></a>        
-</span><span id="BivariateStatistics.__init__-354"><a href="#BivariateStatistics.__init__-354"><span class="linenos">354</span></a>        <span class="c1"># RMS difference</span>
-</span><span id="BivariateStatistics.__init__-355"><a href="#BivariateStatistics.__init__-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_difference</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsd</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.__init__-356"><a href="#BivariateStatistics.__init__-356"><span class="linenos">356</span></a>
-</span><span id="BivariateStatistics.__init__-357"><a href="#BivariateStatistics.__init__-357"><span class="linenos">357</span></a>        <span class="c1"># Covariance, correlation</span>
-</span><span id="BivariateStatistics.__init__-358"><a href="#BivariateStatistics.__init__-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="BivariateStatistics.__init__-359"><a href="#BivariateStatistics.__init__-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_pearson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pearsonr</span> <span class="o">=</span> \
-</span><span id="BivariateStatistics.__init__-360"><a href="#BivariateStatistics.__init__-360"><span class="linenos">360</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="BivariateStatistics.__init__-361"><a href="#BivariateStatistics.__init__-361"><span class="linenos">361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation_spearman</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spearmanr</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span>
-</span><span id="BivariateStatistics.__init__-362"><a href="#BivariateStatistics.__init__-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">R2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span>
+</span><span id="BivariateStatistics.__init__-346"><a href="#BivariateStatistics.__init__-346"><span class="linenos">346</span></a>        <span class="c1"># Relative median differences</span>
+</span><span id="BivariateStatistics.__init__-347"><a href="#BivariateStatistics.__init__-347"><span class="linenos">347</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_difference</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedd</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
+</span><span id="BivariateStatistics.__init__-348"><a href="#BivariateStatistics.__init__-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relative_median_absolute_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmedad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_difference</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmedian</span>
+</span><span id="BivariateStatistics.__init__-349"><a href="#BivariateStatistics.__init__-349"><span class="linenos">349</span></a>
+</span><span id="BivariateStatistics.__init__-350"><a href="#BivariateStatistics.__init__-350"><span class="linenos">350</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_bias_factor</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmbf</span>  <span class="o">=</span> <span class="n">nmbf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-351"><a href="#BivariateStatistics.__init__-351"><span class="linenos">351</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalized_mean_absolute_error_factor</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmaef</span> <span class="o">=</span> <span class="n">nmaef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-352"><a href="#BivariateStatistics.__init__-352"><span class="linenos">352</span></a>
+</span><span id="BivariateStatistics.__init__-353"><a href="#BivariateStatistics.__init__-353"><span class="linenos">353</span></a>        <span class="c1"># Mean and mean absolute log ratio</span>
+</span><span id="BivariateStatistics.__init__-354"><a href="#BivariateStatistics.__init__-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-355"><a href="#BivariateStatistics.__init__-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">malr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-356"><a href="#BivariateStatistics.__init__-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">std_log10_ratio</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdlr</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-357"><a href="#BivariateStatistics.__init__-357"><span class="linenos">357</span></a>
+</span><span id="BivariateStatistics.__init__-358"><a href="#BivariateStatistics.__init__-358"><span class="linenos">358</span></a>        <span class="c1"># Median and median absolute log ratio</span>
+</span><span id="BivariateStatistics.__init__-359"><a href="#BivariateStatistics.__init__-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_log10_ratio</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medlr</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-360"><a href="#BivariateStatistics.__init__-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">median_absolute_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">medalr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">log10ratio</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-361"><a href="#BivariateStatistics.__init__-361"><span class="linenos">361</span></a>
+</span><span id="BivariateStatistics.__init__-362"><a href="#BivariateStatistics.__init__-362"><span class="linenos">362</span></a>        <span class="c1"># RMS difference</span>
+</span><span id="BivariateStatistics.__init__-363"><a href="#BivariateStatistics.__init__-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_difference</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmsd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.__init__-364"><a href="#BivariateStatistics.__init__-364"><span class="linenos">364</span></a>        <span class="c1"># RMS log ratio</span>
+</span><span id="BivariateStatistics.__init__-365"><a href="#BivariateStatistics.__init__-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_mean_square_log10_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmslr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span> <span class="n">log10ratio</span><span class="p">,</span> <span class="mi">2</span> <span class="p">)))</span>
+</span><span id="BivariateStatistics.__init__-366"><a href="#BivariateStatistics.__init__-366"><span class="linenos">366</span></a>
+</span><span id="BivariateStatistics.__init__-367"><a href="#BivariateStatistics.__init__-367"><span class="linenos">367</span></a>        <span class="c1"># Covariance, correlation</span>
+</span><span id="BivariateStatistics.__init__-368"><a href="#BivariateStatistics.__init__-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="BivariateStatistics.__init__-369"><a href="#BivariateStatistics.__init__-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_pearson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pearsonr</span> <span class="o">=</span> \
+</span><span id="BivariateStatistics.__init__-370"><a href="#BivariateStatistics.__init__-370"><span class="linenos">370</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="BivariateStatistics.__init__-371"><a href="#BivariateStatistics.__init__-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">correlation_spearman</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spearmanr</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span>
+</span><span id="BivariateStatistics.__init__-372"><a href="#BivariateStatistics.__init__-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">R2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>Compute suite of bivariate statistics during initialization</p>
 
 <p>Statistic values are saved in attributes.
 CAUTION: Weights w are ignored except in SMA fit</p>
@@ -1751,92 +1781,92 @@
         <span class="def">def</span>
         <span class="name">fitline</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span>, </span><span class="param"><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>
 
                 <label class="view-source-button" for="BivariateStatistics.fitline-view-source"><span>View Source</span></label>
 
     </div>
     <a class="headerlink" href="#BivariateStatistics.fitline"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.fitline-368"><a href="#BivariateStatistics.fitline-368"><span class="linenos">368</span></a>    <span class="k">def</span> <span class="nf">fitline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="BivariateStatistics.fitline-369"><a href="#BivariateStatistics.fitline-369"><span class="linenos">369</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute bivariate line fit</span>
-</span><span id="BivariateStatistics.fitline-370"><a href="#BivariateStatistics.fitline-370"><span class="linenos">370</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics.fitline-371"><a href="#BivariateStatistics.fitline-371"><span class="linenos">371</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics.fitline-372"><a href="#BivariateStatistics.fitline-372"><span class="linenos">372</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics.fitline-373"><a href="#BivariateStatistics.fitline-373"><span class="linenos">373</span></a><span class="sd">        method : str</span>
-</span><span id="BivariateStatistics.fitline-374"><a href="#BivariateStatistics.fitline-374"><span class="linenos">374</span></a><span class="sd">            line fitting method: sma (default), ols, wls, York, sen, siegel</span>
-</span><span id="BivariateStatistics.fitline-375"><a href="#BivariateStatistics.fitline-375"><span class="linenos">375</span></a><span class="sd">        intercept : bool</span>
-</span><span id="BivariateStatistics.fitline-376"><a href="#BivariateStatistics.fitline-376"><span class="linenos">376</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="BivariateStatistics.fitline-377"><a href="#BivariateStatistics.fitline-377"><span class="linenos">377</span></a><span class="sd">        **kwargs </span>
-</span><span id="BivariateStatistics.fitline-378"><a href="#BivariateStatistics.fitline-378"><span class="linenos">378</span></a><span class="sd">            passed to `acgc.stats.sma` (e.g. robust=True)</span>
-</span><span id="BivariateStatistics.fitline-379"><a href="#BivariateStatistics.fitline-379"><span class="linenos">379</span></a>
-</span><span id="BivariateStatistics.fitline-380"><a href="#BivariateStatistics.fitline-380"><span class="linenos">380</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics.fitline-381"><a href="#BivariateStatistics.fitline-381"><span class="linenos">381</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics.fitline-382"><a href="#BivariateStatistics.fitline-382"><span class="linenos">382</span></a><span class="sd">        result : dict</span>
-</span><span id="BivariateStatistics.fitline-383"><a href="#BivariateStatistics.fitline-383"><span class="linenos">383</span></a><span class="sd">            dictionary with keys:</span>
-</span><span id="BivariateStatistics.fitline-384"><a href="#BivariateStatistics.fitline-384"><span class="linenos">384</span></a><span class="sd">            - slope (float)</span>
-</span><span id="BivariateStatistics.fitline-385"><a href="#BivariateStatistics.fitline-385"><span class="linenos">385</span></a><span class="sd">                slope of fitted line</span>
-</span><span id="BivariateStatistics.fitline-386"><a href="#BivariateStatistics.fitline-386"><span class="linenos">386</span></a><span class="sd">            - intercept (float)</span>
-</span><span id="BivariateStatistics.fitline-387"><a href="#BivariateStatistics.fitline-387"><span class="linenos">387</span></a><span class="sd">                intercept of fitted line</span>
-</span><span id="BivariateStatistics.fitline-388"><a href="#BivariateStatistics.fitline-388"><span class="linenos">388</span></a><span class="sd">            - fittedvalues (array (N,))</span>
-</span><span id="BivariateStatistics.fitline-389"><a href="#BivariateStatistics.fitline-389"><span class="linenos">389</span></a><span class="sd">                values on fit line</span>
-</span><span id="BivariateStatistics.fitline-390"><a href="#BivariateStatistics.fitline-390"><span class="linenos">390</span></a><span class="sd">            - residuals (array (N,))</span>
-</span><span id="BivariateStatistics.fitline-391"><a href="#BivariateStatistics.fitline-391"><span class="linenos">391</span></a><span class="sd">                residual from fit line</span>
-</span><span id="BivariateStatistics.fitline-392"><a href="#BivariateStatistics.fitline-392"><span class="linenos">392</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics.fitline-393"><a href="#BivariateStatistics.fitline-393"><span class="linenos">393</span></a>
-</span><span id="BivariateStatistics.fitline-394"><a href="#BivariateStatistics.fitline-394"><span class="linenos">394</span></a>        <span class="n">fitintercept</span> <span class="o">=</span> <span class="n">intercept</span>
-</span><span id="BivariateStatistics.fitline-395"><a href="#BivariateStatistics.fitline-395"><span class="linenos">395</span></a>
-</span><span id="BivariateStatistics.fitline-396"><a href="#BivariateStatistics.fitline-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;sma&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics.fitline-397"><a href="#BivariateStatistics.fitline-397"><span class="linenos">397</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sma</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-398"><a href="#BivariateStatistics.fitline-398"><span class="linenos">398</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-399"><a href="#BivariateStatistics.fitline-399"><span class="linenos">399</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-400"><a href="#BivariateStatistics.fitline-400"><span class="linenos">400</span></a>                        <span class="n">intercept</span><span class="o">=</span><span class="n">fitintercept</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-401"><a href="#BivariateStatistics.fitline-401"><span class="linenos">401</span></a>                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
-</span><span id="BivariateStatistics.fitline-402"><a href="#BivariateStatistics.fitline-402"><span class="linenos">402</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics.fitline-403"><a href="#BivariateStatistics.fitline-403"><span class="linenos">403</span></a>            <span class="n">intercept</span><span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics.fitline-404"><a href="#BivariateStatistics.fitline-404"><span class="linenos">404</span></a>
-</span><span id="BivariateStatistics.fitline-405"><a href="#BivariateStatistics.fitline-405"><span class="linenos">405</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ols&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics.fitline-406"><a href="#BivariateStatistics.fitline-406"><span class="linenos">406</span></a>            <span class="k">if</span> <span class="n">fitintercept</span><span class="p">:</span>
-</span><span id="BivariateStatistics.fitline-407"><a href="#BivariateStatistics.fitline-407"><span class="linenos">407</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-408"><a href="#BivariateStatistics.fitline-408"><span class="linenos">408</span></a>                                      <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.fitline-409"><a href="#BivariateStatistics.fitline-409"><span class="linenos">409</span></a>            <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics.fitline-410"><a href="#BivariateStatistics.fitline-410"><span class="linenos">410</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.fitline-411"><a href="#BivariateStatistics.fitline-411"><span class="linenos">411</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
-</span><span id="BivariateStatistics.fitline-412"><a href="#BivariateStatistics.fitline-412"><span class="linenos">412</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
-</span><span id="BivariateStatistics.fitline-413"><a href="#BivariateStatistics.fitline-413"><span class="linenos">413</span></a>
-</span><span id="BivariateStatistics.fitline-414"><a href="#BivariateStatistics.fitline-414"><span class="linenos">414</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;theil&#39;</span><span class="p">,</span><span class="s1">&#39;sen&#39;</span><span class="p">,</span><span class="s1">&#39;theilsen&#39;</span><span class="p">]:</span>
-</span><span id="BivariateStatistics.fitline-415"><a href="#BivariateStatistics.fitline-415"><span class="linenos">415</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
-</span><span id="BivariateStatistics.fitline-416"><a href="#BivariateStatistics.fitline-416"><span class="linenos">416</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sen</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-417"><a href="#BivariateStatistics.fitline-417"><span class="linenos">417</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-418"><a href="#BivariateStatistics.fitline-418"><span class="linenos">418</span></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
-</span><span id="BivariateStatistics.fitline-419"><a href="#BivariateStatistics.fitline-419"><span class="linenos">419</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span>
-</span><span id="BivariateStatistics.fitline-420"><a href="#BivariateStatistics.fitline-420"><span class="linenos">420</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span>
-</span><span id="BivariateStatistics.fitline-421"><a href="#BivariateStatistics.fitline-421"><span class="linenos">421</span></a>
-</span><span id="BivariateStatistics.fitline-422"><a href="#BivariateStatistics.fitline-422"><span class="linenos">422</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;siegel&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics.fitline-423"><a href="#BivariateStatistics.fitline-423"><span class="linenos">423</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
-</span><span id="BivariateStatistics.fitline-424"><a href="#BivariateStatistics.fitline-424"><span class="linenos">424</span></a>            <span class="n">siegel</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">siegelslopes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-425"><a href="#BivariateStatistics.fitline-425"><span class="linenos">425</span></a>                                         <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.fitline-426"><a href="#BivariateStatistics.fitline-426"><span class="linenos">426</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">slope</span>
-</span><span id="BivariateStatistics.fitline-427"><a href="#BivariateStatistics.fitline-427"><span class="linenos">427</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">intercept</span>
-</span><span id="BivariateStatistics.fitline-428"><a href="#BivariateStatistics.fitline-428"><span class="linenos">428</span></a>
-</span><span id="BivariateStatistics.fitline-429"><a href="#BivariateStatistics.fitline-429"><span class="linenos">429</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;wls&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics.fitline-430"><a href="#BivariateStatistics.fitline-430"><span class="linenos">430</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;WLS regression not implemented yet&#39;</span><span class="p">)</span>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.fitline-378"><a href="#BivariateStatistics.fitline-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">fitline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="BivariateStatistics.fitline-379"><a href="#BivariateStatistics.fitline-379"><span class="linenos">379</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute bivariate line fit</span>
+</span><span id="BivariateStatistics.fitline-380"><a href="#BivariateStatistics.fitline-380"><span class="linenos">380</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics.fitline-381"><a href="#BivariateStatistics.fitline-381"><span class="linenos">381</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics.fitline-382"><a href="#BivariateStatistics.fitline-382"><span class="linenos">382</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics.fitline-383"><a href="#BivariateStatistics.fitline-383"><span class="linenos">383</span></a><span class="sd">        method : str</span>
+</span><span id="BivariateStatistics.fitline-384"><a href="#BivariateStatistics.fitline-384"><span class="linenos">384</span></a><span class="sd">            line fitting method: sma (default), ols, wls, York, sen, siegel</span>
+</span><span id="BivariateStatistics.fitline-385"><a href="#BivariateStatistics.fitline-385"><span class="linenos">385</span></a><span class="sd">        intercept : bool</span>
+</span><span id="BivariateStatistics.fitline-386"><a href="#BivariateStatistics.fitline-386"><span class="linenos">386</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="BivariateStatistics.fitline-387"><a href="#BivariateStatistics.fitline-387"><span class="linenos">387</span></a><span class="sd">        **kwargs </span>
+</span><span id="BivariateStatistics.fitline-388"><a href="#BivariateStatistics.fitline-388"><span class="linenos">388</span></a><span class="sd">            passed to `acgc.stats.sma` (e.g. robust=True)</span>
+</span><span id="BivariateStatistics.fitline-389"><a href="#BivariateStatistics.fitline-389"><span class="linenos">389</span></a>
+</span><span id="BivariateStatistics.fitline-390"><a href="#BivariateStatistics.fitline-390"><span class="linenos">390</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics.fitline-391"><a href="#BivariateStatistics.fitline-391"><span class="linenos">391</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics.fitline-392"><a href="#BivariateStatistics.fitline-392"><span class="linenos">392</span></a><span class="sd">        result : dict</span>
+</span><span id="BivariateStatistics.fitline-393"><a href="#BivariateStatistics.fitline-393"><span class="linenos">393</span></a><span class="sd">            dictionary with keys:</span>
+</span><span id="BivariateStatistics.fitline-394"><a href="#BivariateStatistics.fitline-394"><span class="linenos">394</span></a><span class="sd">            - slope (float)</span>
+</span><span id="BivariateStatistics.fitline-395"><a href="#BivariateStatistics.fitline-395"><span class="linenos">395</span></a><span class="sd">                slope of fitted line</span>
+</span><span id="BivariateStatistics.fitline-396"><a href="#BivariateStatistics.fitline-396"><span class="linenos">396</span></a><span class="sd">            - intercept (float)</span>
+</span><span id="BivariateStatistics.fitline-397"><a href="#BivariateStatistics.fitline-397"><span class="linenos">397</span></a><span class="sd">                intercept of fitted line</span>
+</span><span id="BivariateStatistics.fitline-398"><a href="#BivariateStatistics.fitline-398"><span class="linenos">398</span></a><span class="sd">            - fittedvalues (array (N,))</span>
+</span><span id="BivariateStatistics.fitline-399"><a href="#BivariateStatistics.fitline-399"><span class="linenos">399</span></a><span class="sd">                values on fit line</span>
+</span><span id="BivariateStatistics.fitline-400"><a href="#BivariateStatistics.fitline-400"><span class="linenos">400</span></a><span class="sd">            - residuals (array (N,))</span>
+</span><span id="BivariateStatistics.fitline-401"><a href="#BivariateStatistics.fitline-401"><span class="linenos">401</span></a><span class="sd">                residual from fit line</span>
+</span><span id="BivariateStatistics.fitline-402"><a href="#BivariateStatistics.fitline-402"><span class="linenos">402</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics.fitline-403"><a href="#BivariateStatistics.fitline-403"><span class="linenos">403</span></a>
+</span><span id="BivariateStatistics.fitline-404"><a href="#BivariateStatistics.fitline-404"><span class="linenos">404</span></a>        <span class="n">fitintercept</span> <span class="o">=</span> <span class="n">intercept</span>
+</span><span id="BivariateStatistics.fitline-405"><a href="#BivariateStatistics.fitline-405"><span class="linenos">405</span></a>
+</span><span id="BivariateStatistics.fitline-406"><a href="#BivariateStatistics.fitline-406"><span class="linenos">406</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;sma&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics.fitline-407"><a href="#BivariateStatistics.fitline-407"><span class="linenos">407</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sma</span><span class="p">(</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-408"><a href="#BivariateStatistics.fitline-408"><span class="linenos">408</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-409"><a href="#BivariateStatistics.fitline-409"><span class="linenos">409</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-410"><a href="#BivariateStatistics.fitline-410"><span class="linenos">410</span></a>                        <span class="n">intercept</span><span class="o">=</span><span class="n">fitintercept</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-411"><a href="#BivariateStatistics.fitline-411"><span class="linenos">411</span></a>                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-412"><a href="#BivariateStatistics.fitline-412"><span class="linenos">412</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics.fitline-413"><a href="#BivariateStatistics.fitline-413"><span class="linenos">413</span></a>            <span class="n">intercept</span><span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics.fitline-414"><a href="#BivariateStatistics.fitline-414"><span class="linenos">414</span></a>
+</span><span id="BivariateStatistics.fitline-415"><a href="#BivariateStatistics.fitline-415"><span class="linenos">415</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ols&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics.fitline-416"><a href="#BivariateStatistics.fitline-416"><span class="linenos">416</span></a>            <span class="k">if</span> <span class="n">fitintercept</span><span class="p">:</span>
+</span><span id="BivariateStatistics.fitline-417"><a href="#BivariateStatistics.fitline-417"><span class="linenos">417</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-418"><a href="#BivariateStatistics.fitline-418"><span class="linenos">418</span></a>                                      <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-419"><a href="#BivariateStatistics.fitline-419"><span class="linenos">419</span></a>            <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics.fitline-420"><a href="#BivariateStatistics.fitline-420"><span class="linenos">420</span></a>                <span class="n">ols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-421"><a href="#BivariateStatistics.fitline-421"><span class="linenos">421</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
+</span><span id="BivariateStatistics.fitline-422"><a href="#BivariateStatistics.fitline-422"><span class="linenos">422</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">ols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
+</span><span id="BivariateStatistics.fitline-423"><a href="#BivariateStatistics.fitline-423"><span class="linenos">423</span></a>
+</span><span id="BivariateStatistics.fitline-424"><a href="#BivariateStatistics.fitline-424"><span class="linenos">424</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;theil&#39;</span><span class="p">,</span><span class="s1">&#39;sen&#39;</span><span class="p">,</span><span class="s1">&#39;theilsen&#39;</span><span class="p">]:</span>
+</span><span id="BivariateStatistics.fitline-425"><a href="#BivariateStatistics.fitline-425"><span class="linenos">425</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
+</span><span id="BivariateStatistics.fitline-426"><a href="#BivariateStatistics.fitline-426"><span class="linenos">426</span></a>            <span class="n">fit</span> <span class="o">=</span> <span class="n">sen</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-427"><a href="#BivariateStatistics.fitline-427"><span class="linenos">427</span></a>                       <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-428"><a href="#BivariateStatistics.fitline-428"><span class="linenos">428</span></a>                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-429"><a href="#BivariateStatistics.fitline-429"><span class="linenos">429</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">slope</span>
+</span><span id="BivariateStatistics.fitline-430"><a href="#BivariateStatistics.fitline-430"><span class="linenos">430</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">intercept</span>
 </span><span id="BivariateStatistics.fitline-431"><a href="#BivariateStatistics.fitline-431"><span class="linenos">431</span></a>
-</span><span id="BivariateStatistics.fitline-432"><a href="#BivariateStatistics.fitline-432"><span class="linenos">432</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;york&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics.fitline-433"><a href="#BivariateStatistics.fitline-433"><span class="linenos">433</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;York regression not implemented yet&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics.fitline-434"><a href="#BivariateStatistics.fitline-434"><span class="linenos">434</span></a>
-</span><span id="BivariateStatistics.fitline-435"><a href="#BivariateStatistics.fitline-435"><span class="linenos">435</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics.fitline-436"><a href="#BivariateStatistics.fitline-436"><span class="linenos">436</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Undefined method &#39;</span><span class="o">+</span><span class="n">method</span><span class="p">)</span>
-</span><span id="BivariateStatistics.fitline-437"><a href="#BivariateStatistics.fitline-437"><span class="linenos">437</span></a>
-</span><span id="BivariateStatistics.fitline-438"><a href="#BivariateStatistics.fitline-438"><span class="linenos">438</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">slope</span>          <span class="o">=</span> <span class="n">slope</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-439"><a href="#BivariateStatistics.fitline-439"><span class="linenos">439</span></a>                     <span class="n">intercept</span>      <span class="o">=</span> <span class="n">intercept</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-440"><a href="#BivariateStatistics.fitline-440"><span class="linenos">440</span></a>                     <span class="n">fittedvalues</span>   <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-441"><a href="#BivariateStatistics.fitline-441"><span class="linenos">441</span></a>                     <span class="n">residuals</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-</span> <span class="p">(</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span> <span class="p">),</span>
-</span><span id="BivariateStatistics.fitline-442"><a href="#BivariateStatistics.fitline-442"><span class="linenos">442</span></a>                     <span class="n">method</span>         <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
-</span><span id="BivariateStatistics.fitline-443"><a href="#BivariateStatistics.fitline-443"><span class="linenos">443</span></a>                     <span class="n">fitintercept</span>   <span class="o">=</span> <span class="n">fitintercept</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-432"><a href="#BivariateStatistics.fitline-432"><span class="linenos">432</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;siegel&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics.fitline-433"><a href="#BivariateStatistics.fitline-433"><span class="linenos">433</span></a>            <span class="n">fitintercept</span> <span class="o">=</span> <span class="kc">True</span>
+</span><span id="BivariateStatistics.fitline-434"><a href="#BivariateStatistics.fitline-434"><span class="linenos">434</span></a>            <span class="n">siegel</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">siegelslopes</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-435"><a href="#BivariateStatistics.fitline-435"><span class="linenos">435</span></a>                                         <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-436"><a href="#BivariateStatistics.fitline-436"><span class="linenos">436</span></a>            <span class="n">slope</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">slope</span>
+</span><span id="BivariateStatistics.fitline-437"><a href="#BivariateStatistics.fitline-437"><span class="linenos">437</span></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="n">siegel</span><span class="o">.</span><span class="n">intercept</span>
+</span><span id="BivariateStatistics.fitline-438"><a href="#BivariateStatistics.fitline-438"><span class="linenos">438</span></a>
+</span><span id="BivariateStatistics.fitline-439"><a href="#BivariateStatistics.fitline-439"><span class="linenos">439</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;wls&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics.fitline-440"><a href="#BivariateStatistics.fitline-440"><span class="linenos">440</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;WLS regression not implemented yet&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-441"><a href="#BivariateStatistics.fitline-441"><span class="linenos">441</span></a>
+</span><span id="BivariateStatistics.fitline-442"><a href="#BivariateStatistics.fitline-442"><span class="linenos">442</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;york&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics.fitline-443"><a href="#BivariateStatistics.fitline-443"><span class="linenos">443</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;York regression not implemented yet&#39;</span><span class="p">)</span>
 </span><span id="BivariateStatistics.fitline-444"><a href="#BivariateStatistics.fitline-444"><span class="linenos">444</span></a>
-</span><span id="BivariateStatistics.fitline-445"><a href="#BivariateStatistics.fitline-445"><span class="linenos">445</span></a>        <span class="k">return</span> <span class="n">line</span>
+</span><span id="BivariateStatistics.fitline-445"><a href="#BivariateStatistics.fitline-445"><span class="linenos">445</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics.fitline-446"><a href="#BivariateStatistics.fitline-446"><span class="linenos">446</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Undefined method &#39;</span><span class="o">+</span><span class="n">method</span><span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-447"><a href="#BivariateStatistics.fitline-447"><span class="linenos">447</span></a>
+</span><span id="BivariateStatistics.fitline-448"><a href="#BivariateStatistics.fitline-448"><span class="linenos">448</span></a>        <span class="n">line</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span> <span class="n">slope</span>          <span class="o">=</span> <span class="n">slope</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-449"><a href="#BivariateStatistics.fitline-449"><span class="linenos">449</span></a>                     <span class="n">intercept</span>      <span class="o">=</span> <span class="n">intercept</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-450"><a href="#BivariateStatistics.fitline-450"><span class="linenos">450</span></a>                     <span class="n">fittedvalues</span>   <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-451"><a href="#BivariateStatistics.fitline-451"><span class="linenos">451</span></a>                     <span class="n">residuals</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">-</span> <span class="p">(</span> <span class="n">slope</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="n">intercept</span> <span class="p">),</span>
+</span><span id="BivariateStatistics.fitline-452"><a href="#BivariateStatistics.fitline-452"><span class="linenos">452</span></a>                     <span class="n">method</span>         <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
+</span><span id="BivariateStatistics.fitline-453"><a href="#BivariateStatistics.fitline-453"><span class="linenos">453</span></a>                     <span class="n">fitintercept</span>   <span class="o">=</span> <span class="n">fitintercept</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.fitline-454"><a href="#BivariateStatistics.fitline-454"><span class="linenos">454</span></a>
+</span><span id="BivariateStatistics.fitline-455"><a href="#BivariateStatistics.fitline-455"><span class="linenos">455</span></a>        <span class="k">return</span> <span class="n">line</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>Compute bivariate line fit</p>
 
 <h6 id="parameters">Parameters</h6>
 
@@ -1875,32 +1905,32 @@
         <span class="def">def</span>
         <span class="name">slope</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span>, </span><span class="param"><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>
 
                 <label class="view-source-button" for="BivariateStatistics.slope-view-source"><span>View Source</span></label>
 
     </div>
     <a class="headerlink" href="#BivariateStatistics.slope"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.slope-447"><a href="#BivariateStatistics.slope-447"><span class="linenos">447</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="BivariateStatistics.slope-448"><a href="#BivariateStatistics.slope-448"><span class="linenos">448</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute slope of bivariate line fit</span>
-</span><span id="BivariateStatistics.slope-449"><a href="#BivariateStatistics.slope-449"><span class="linenos">449</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics.slope-450"><a href="#BivariateStatistics.slope-450"><span class="linenos">450</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics.slope-451"><a href="#BivariateStatistics.slope-451"><span class="linenos">451</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics.slope-452"><a href="#BivariateStatistics.slope-452"><span class="linenos">452</span></a><span class="sd">        method : str</span>
-</span><span id="BivariateStatistics.slope-453"><a href="#BivariateStatistics.slope-453"><span class="linenos">453</span></a><span class="sd">            line fitting method: sma (default), ols, wls</span>
-</span><span id="BivariateStatistics.slope-454"><a href="#BivariateStatistics.slope-454"><span class="linenos">454</span></a><span class="sd">        intercept : bool</span>
-</span><span id="BivariateStatistics.slope-455"><a href="#BivariateStatistics.slope-455"><span class="linenos">455</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="BivariateStatistics.slope-456"><a href="#BivariateStatistics.slope-456"><span class="linenos">456</span></a><span class="sd">        **kwargs </span>
-</span><span id="BivariateStatistics.slope-457"><a href="#BivariateStatistics.slope-457"><span class="linenos">457</span></a><span class="sd">            passed to `fitline`</span>
-</span><span id="BivariateStatistics.slope-458"><a href="#BivariateStatistics.slope-458"><span class="linenos">458</span></a>
-</span><span id="BivariateStatistics.slope-459"><a href="#BivariateStatistics.slope-459"><span class="linenos">459</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics.slope-460"><a href="#BivariateStatistics.slope-460"><span class="linenos">460</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics.slope-461"><a href="#BivariateStatistics.slope-461"><span class="linenos">461</span></a><span class="sd">        slope : float</span>
-</span><span id="BivariateStatistics.slope-462"><a href="#BivariateStatistics.slope-462"><span class="linenos">462</span></a><span class="sd">            value of y intercept</span>
-</span><span id="BivariateStatistics.slope-463"><a href="#BivariateStatistics.slope-463"><span class="linenos">463</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics.slope-464"><a href="#BivariateStatistics.slope-464"><span class="linenos">464</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.slope-457"><a href="#BivariateStatistics.slope-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="BivariateStatistics.slope-458"><a href="#BivariateStatistics.slope-458"><span class="linenos">458</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute slope of bivariate line fit</span>
+</span><span id="BivariateStatistics.slope-459"><a href="#BivariateStatistics.slope-459"><span class="linenos">459</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics.slope-460"><a href="#BivariateStatistics.slope-460"><span class="linenos">460</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics.slope-461"><a href="#BivariateStatistics.slope-461"><span class="linenos">461</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics.slope-462"><a href="#BivariateStatistics.slope-462"><span class="linenos">462</span></a><span class="sd">        method : str</span>
+</span><span id="BivariateStatistics.slope-463"><a href="#BivariateStatistics.slope-463"><span class="linenos">463</span></a><span class="sd">            line fitting method: sma (default), ols, wls</span>
+</span><span id="BivariateStatistics.slope-464"><a href="#BivariateStatistics.slope-464"><span class="linenos">464</span></a><span class="sd">        intercept : bool</span>
+</span><span id="BivariateStatistics.slope-465"><a href="#BivariateStatistics.slope-465"><span class="linenos">465</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="BivariateStatistics.slope-466"><a href="#BivariateStatistics.slope-466"><span class="linenos">466</span></a><span class="sd">        **kwargs </span>
+</span><span id="BivariateStatistics.slope-467"><a href="#BivariateStatistics.slope-467"><span class="linenos">467</span></a><span class="sd">            passed to `fitline`</span>
+</span><span id="BivariateStatistics.slope-468"><a href="#BivariateStatistics.slope-468"><span class="linenos">468</span></a>
+</span><span id="BivariateStatistics.slope-469"><a href="#BivariateStatistics.slope-469"><span class="linenos">469</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics.slope-470"><a href="#BivariateStatistics.slope-470"><span class="linenos">470</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics.slope-471"><a href="#BivariateStatistics.slope-471"><span class="linenos">471</span></a><span class="sd">        slope : float</span>
+</span><span id="BivariateStatistics.slope-472"><a href="#BivariateStatistics.slope-472"><span class="linenos">472</span></a><span class="sd">            value of y intercept</span>
+</span><span id="BivariateStatistics.slope-473"><a href="#BivariateStatistics.slope-473"><span class="linenos">473</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics.slope-474"><a href="#BivariateStatistics.slope-474"><span class="linenos">474</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>Compute slope of bivariate line fit</p>
 
 <h6 id="parameters">Parameters</h6>
 
@@ -1929,32 +1959,32 @@
         <span class="def">def</span>
         <span class="name">intercept</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span>, </span><span class="param"><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>
 
                 <label class="view-source-button" for="BivariateStatistics.intercept-view-source"><span>View Source</span></label>
 
     </div>
     <a class="headerlink" href="#BivariateStatistics.intercept"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.intercept-466"><a href="#BivariateStatistics.intercept-466"><span class="linenos">466</span></a>    <span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="BivariateStatistics.intercept-467"><a href="#BivariateStatistics.intercept-467"><span class="linenos">467</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute intercept of bivariate line fit</span>
-</span><span id="BivariateStatistics.intercept-468"><a href="#BivariateStatistics.intercept-468"><span class="linenos">468</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics.intercept-469"><a href="#BivariateStatistics.intercept-469"><span class="linenos">469</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics.intercept-470"><a href="#BivariateStatistics.intercept-470"><span class="linenos">470</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics.intercept-471"><a href="#BivariateStatistics.intercept-471"><span class="linenos">471</span></a><span class="sd">        method : str</span>
-</span><span id="BivariateStatistics.intercept-472"><a href="#BivariateStatistics.intercept-472"><span class="linenos">472</span></a><span class="sd">            line fitting method: sma (default) or ols</span>
-</span><span id="BivariateStatistics.intercept-473"><a href="#BivariateStatistics.intercept-473"><span class="linenos">473</span></a><span class="sd">        intercept : bool</span>
-</span><span id="BivariateStatistics.intercept-474"><a href="#BivariateStatistics.intercept-474"><span class="linenos">474</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
-</span><span id="BivariateStatistics.intercept-475"><a href="#BivariateStatistics.intercept-475"><span class="linenos">475</span></a><span class="sd">        **kwargs </span>
-</span><span id="BivariateStatistics.intercept-476"><a href="#BivariateStatistics.intercept-476"><span class="linenos">476</span></a><span class="sd">            passed to `fitline`</span>
-</span><span id="BivariateStatistics.intercept-477"><a href="#BivariateStatistics.intercept-477"><span class="linenos">477</span></a>
-</span><span id="BivariateStatistics.intercept-478"><a href="#BivariateStatistics.intercept-478"><span class="linenos">478</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics.intercept-479"><a href="#BivariateStatistics.intercept-479"><span class="linenos">479</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics.intercept-480"><a href="#BivariateStatistics.intercept-480"><span class="linenos">480</span></a><span class="sd">        intercept : float</span>
-</span><span id="BivariateStatistics.intercept-481"><a href="#BivariateStatistics.intercept-481"><span class="linenos">481</span></a><span class="sd">            value of y intercept</span>
-</span><span id="BivariateStatistics.intercept-482"><a href="#BivariateStatistics.intercept-482"><span class="linenos">482</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics.intercept-483"><a href="#BivariateStatistics.intercept-483"><span class="linenos">483</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.intercept-476"><a href="#BivariateStatistics.intercept-476"><span class="linenos">476</span></a>    <span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span><span class="n">intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="BivariateStatistics.intercept-477"><a href="#BivariateStatistics.intercept-477"><span class="linenos">477</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Compute intercept of bivariate line fit</span>
+</span><span id="BivariateStatistics.intercept-478"><a href="#BivariateStatistics.intercept-478"><span class="linenos">478</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics.intercept-479"><a href="#BivariateStatistics.intercept-479"><span class="linenos">479</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics.intercept-480"><a href="#BivariateStatistics.intercept-480"><span class="linenos">480</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics.intercept-481"><a href="#BivariateStatistics.intercept-481"><span class="linenos">481</span></a><span class="sd">        method : str</span>
+</span><span id="BivariateStatistics.intercept-482"><a href="#BivariateStatistics.intercept-482"><span class="linenos">482</span></a><span class="sd">            line fitting method: sma (default) or ols</span>
+</span><span id="BivariateStatistics.intercept-483"><a href="#BivariateStatistics.intercept-483"><span class="linenos">483</span></a><span class="sd">        intercept : bool</span>
+</span><span id="BivariateStatistics.intercept-484"><a href="#BivariateStatistics.intercept-484"><span class="linenos">484</span></a><span class="sd">            defines whether non-zero intercept should be fitted</span>
+</span><span id="BivariateStatistics.intercept-485"><a href="#BivariateStatistics.intercept-485"><span class="linenos">485</span></a><span class="sd">        **kwargs </span>
+</span><span id="BivariateStatistics.intercept-486"><a href="#BivariateStatistics.intercept-486"><span class="linenos">486</span></a><span class="sd">            passed to `fitline`</span>
+</span><span id="BivariateStatistics.intercept-487"><a href="#BivariateStatistics.intercept-487"><span class="linenos">487</span></a>
+</span><span id="BivariateStatistics.intercept-488"><a href="#BivariateStatistics.intercept-488"><span class="linenos">488</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics.intercept-489"><a href="#BivariateStatistics.intercept-489"><span class="linenos">489</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics.intercept-490"><a href="#BivariateStatistics.intercept-490"><span class="linenos">490</span></a><span class="sd">        intercept : float</span>
+</span><span id="BivariateStatistics.intercept-491"><a href="#BivariateStatistics.intercept-491"><span class="linenos">491</span></a><span class="sd">            value of y intercept</span>
+</span><span id="BivariateStatistics.intercept-492"><a href="#BivariateStatistics.intercept-492"><span class="linenos">492</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics.intercept-493"><a href="#BivariateStatistics.intercept-493"><span class="linenos">493</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>Compute intercept of bivariate line fit</p>
 
 <h6 id="parameters">Parameters</h6>
 
@@ -1983,61 +2013,61 @@
         <span class="def">def</span>
         <span class="name">summary_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">variables</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span></span><span class="return-annotation">):</span></span>
 
                 <label class="view-source-button" for="BivariateStatistics.summary_dict-view-source"><span>View Source</span></label>
 
     </div>
     <a class="headerlink" href="#BivariateStatistics.summary_dict"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.summary_dict-517"><a href="#BivariateStatistics.summary_dict-517"><span class="linenos">517</span></a>    <span class="k">def</span> <span class="nf">summary_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">):</span>
-</span><span id="BivariateStatistics.summary_dict-518"><a href="#BivariateStatistics.summary_dict-518"><span class="linenos">518</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics into a dict</span>
-</span><span id="BivariateStatistics.summary_dict-519"><a href="#BivariateStatistics.summary_dict-519"><span class="linenos">519</span></a>
-</span><span id="BivariateStatistics.summary_dict-520"><a href="#BivariateStatistics.summary_dict-520"><span class="linenos">520</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics.summary_dict-521"><a href="#BivariateStatistics.summary_dict-521"><span class="linenos">521</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics.summary_dict-522"><a href="#BivariateStatistics.summary_dict-522"><span class="linenos">522</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
-</span><span id="BivariateStatistics.summary_dict-523"><a href="#BivariateStatistics.summary_dict-523"><span class="linenos">523</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="BivariateStatistics.summary_dict-524"><a href="#BivariateStatistics.summary_dict-524"><span class="linenos">524</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="BivariateStatistics.summary_dict-525"><a href="#BivariateStatistics.summary_dict-525"><span class="linenos">525</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="BivariateStatistics.summary_dict-526"><a href="#BivariateStatistics.summary_dict-526"><span class="linenos">526</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="BivariateStatistics.summary_dict-527"><a href="#BivariateStatistics.summary_dict-527"><span class="linenos">527</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="BivariateStatistics.summary_dict-528"><a href="#BivariateStatistics.summary_dict-528"><span class="linenos">528</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="BivariateStatistics.summary_dict-529"><a href="#BivariateStatistics.summary_dict-529"><span class="linenos">529</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="BivariateStatistics.summary_dict-530"><a href="#BivariateStatistics.summary_dict-530"><span class="linenos">530</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="BivariateStatistics.summary_dict-531"><a href="#BivariateStatistics.summary_dict-531"><span class="linenos">531</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="BivariateStatistics.summary_dict-532"><a href="#BivariateStatistics.summary_dict-532"><span class="linenos">532</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics.summary_dict-533"><a href="#BivariateStatistics.summary_dict-533"><span class="linenos">533</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics.summary_dict-534"><a href="#BivariateStatistics.summary_dict-534"><span class="linenos">534</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics.summary_dict-535"><a href="#BivariateStatistics.summary_dict-535"><span class="linenos">535</span></a><span class="sd">        summary : dict</span>
-</span><span id="BivariateStatistics.summary_dict-536"><a href="#BivariateStatistics.summary_dict-536"><span class="linenos">536</span></a><span class="sd">            names and values of variables</span>
-</span><span id="BivariateStatistics.summary_dict-537"><a href="#BivariateStatistics.summary_dict-537"><span class="linenos">537</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics.summary_dict-538"><a href="#BivariateStatistics.summary_dict-538"><span class="linenos">538</span></a>
-</span><span id="BivariateStatistics.summary_dict-539"><a href="#BivariateStatistics.summary_dict-539"><span class="linenos">539</span></a>        <span class="c1"># List of variables</span>
-</span><span id="BivariateStatistics.summary_dict-540"><a href="#BivariateStatistics.summary_dict-540"><span class="linenos">540</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_dict-541"><a href="#BivariateStatistics.summary_dict-541"><span class="linenos">541</span></a>
-</span><span id="BivariateStatistics.summary_dict-542"><a href="#BivariateStatistics.summary_dict-542"><span class="linenos">542</span></a>        <span class="k">if</span> <span class="n">fitline_kw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_dict-543"><a href="#BivariateStatistics.summary_dict-543"><span class="linenos">543</span></a>            <span class="n">fitline_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary_dict-544"><a href="#BivariateStatistics.summary_dict-544"><span class="linenos">544</span></a>                          <span class="s1">&#39;intercept&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
-</span><span id="BivariateStatistics.summary_dict-545"><a href="#BivariateStatistics.summary_dict-545"><span class="linenos">545</span></a>
-</span><span id="BivariateStatistics.summary_dict-546"><a href="#BivariateStatistics.summary_dict-546"><span class="linenos">546</span></a>        <span class="c1"># Construct the dict</span>
-</span><span id="BivariateStatistics.summary_dict-547"><a href="#BivariateStatistics.summary_dict-547"><span class="linenos">547</span></a>        <span class="n">summary</span> <span class="o">=</span> <span class="p">{}</span>
-</span><span id="BivariateStatistics.summary_dict-548"><a href="#BivariateStatistics.summary_dict-548"><span class="linenos">548</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_dict-549"><a href="#BivariateStatistics.summary_dict-549"><span class="linenos">549</span></a>            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">]:</span>
-</span><span id="BivariateStatistics.summary_dict-550"><a href="#BivariateStatistics.summary_dict-550"><span class="linenos">550</span></a>                <span class="c1"># These variables are object methods</span>
-</span><span id="BivariateStatistics.summary_dict-551"><a href="#BivariateStatistics.summary_dict-551"><span class="linenos">551</span></a>                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_dict-552"><a href="#BivariateStatistics.summary_dict-552"><span class="linenos">552</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_dict-553"><a href="#BivariateStatistics.summary_dict-553"><span class="linenos">553</span></a>            <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="s1">&#39;fitline&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_dict-554"><a href="#BivariateStatistics.summary_dict-554"><span class="linenos">554</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_dict-555"><a href="#BivariateStatistics.summary_dict-555"><span class="linenos">555</span></a>                <span class="n">v</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">bivariate_line_equation</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">floatformat_fiteqn</span><span class="p">,</span><span class="n">ystring</span><span class="o">=</span><span class="s1">&#39;separate&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_dict-556"><a href="#BivariateStatistics.summary_dict-556"><span class="linenos">556</span></a>            <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_dict-557"><a href="#BivariateStatistics.summary_dict-557"><span class="linenos">557</span></a>                <span class="c1"># Retrieve values</span>
-</span><span id="BivariateStatistics.summary_dict-558"><a href="#BivariateStatistics.summary_dict-558"><span class="linenos">558</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
-</span><span id="BivariateStatistics.summary_dict-559"><a href="#BivariateStatistics.summary_dict-559"><span class="linenos">559</span></a>
-</span><span id="BivariateStatistics.summary_dict-560"><a href="#BivariateStatistics.summary_dict-560"><span class="linenos">560</span></a>            <span class="c1"># summary += (stringformat+&#39;=&#39;+floatformat+&#39;\n&#39;).format(v,value)</span>
-</span><span id="BivariateStatistics.summary_dict-561"><a href="#BivariateStatistics.summary_dict-561"><span class="linenos">561</span></a>            <span class="n">summary</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
-</span><span id="BivariateStatistics.summary_dict-562"><a href="#BivariateStatistics.summary_dict-562"><span class="linenos">562</span></a>
-</span><span id="BivariateStatistics.summary_dict-563"><a href="#BivariateStatistics.summary_dict-563"><span class="linenos">563</span></a>        <span class="k">return</span> <span class="n">summary</span>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.summary_dict-527"><a href="#BivariateStatistics.summary_dict-527"><span class="linenos">527</span></a>    <span class="k">def</span> <span class="nf">summary_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">):</span>
+</span><span id="BivariateStatistics.summary_dict-528"><a href="#BivariateStatistics.summary_dict-528"><span class="linenos">528</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics into a dict</span>
+</span><span id="BivariateStatistics.summary_dict-529"><a href="#BivariateStatistics.summary_dict-529"><span class="linenos">529</span></a>
+</span><span id="BivariateStatistics.summary_dict-530"><a href="#BivariateStatistics.summary_dict-530"><span class="linenos">530</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics.summary_dict-531"><a href="#BivariateStatistics.summary_dict-531"><span class="linenos">531</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics.summary_dict-532"><a href="#BivariateStatistics.summary_dict-532"><span class="linenos">532</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
+</span><span id="BivariateStatistics.summary_dict-533"><a href="#BivariateStatistics.summary_dict-533"><span class="linenos">533</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="BivariateStatistics.summary_dict-534"><a href="#BivariateStatistics.summary_dict-534"><span class="linenos">534</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="BivariateStatistics.summary_dict-535"><a href="#BivariateStatistics.summary_dict-535"><span class="linenos">535</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="BivariateStatistics.summary_dict-536"><a href="#BivariateStatistics.summary_dict-536"><span class="linenos">536</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="BivariateStatistics.summary_dict-537"><a href="#BivariateStatistics.summary_dict-537"><span class="linenos">537</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="BivariateStatistics.summary_dict-538"><a href="#BivariateStatistics.summary_dict-538"><span class="linenos">538</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="BivariateStatistics.summary_dict-539"><a href="#BivariateStatistics.summary_dict-539"><span class="linenos">539</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="BivariateStatistics.summary_dict-540"><a href="#BivariateStatistics.summary_dict-540"><span class="linenos">540</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="BivariateStatistics.summary_dict-541"><a href="#BivariateStatistics.summary_dict-541"><span class="linenos">541</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="BivariateStatistics.summary_dict-542"><a href="#BivariateStatistics.summary_dict-542"><span class="linenos">542</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics.summary_dict-543"><a href="#BivariateStatistics.summary_dict-543"><span class="linenos">543</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics.summary_dict-544"><a href="#BivariateStatistics.summary_dict-544"><span class="linenos">544</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics.summary_dict-545"><a href="#BivariateStatistics.summary_dict-545"><span class="linenos">545</span></a><span class="sd">        summary : dict</span>
+</span><span id="BivariateStatistics.summary_dict-546"><a href="#BivariateStatistics.summary_dict-546"><span class="linenos">546</span></a><span class="sd">            names and values of variables</span>
+</span><span id="BivariateStatistics.summary_dict-547"><a href="#BivariateStatistics.summary_dict-547"><span class="linenos">547</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics.summary_dict-548"><a href="#BivariateStatistics.summary_dict-548"><span class="linenos">548</span></a>
+</span><span id="BivariateStatistics.summary_dict-549"><a href="#BivariateStatistics.summary_dict-549"><span class="linenos">549</span></a>        <span class="c1"># List of variables</span>
+</span><span id="BivariateStatistics.summary_dict-550"><a href="#BivariateStatistics.summary_dict-550"><span class="linenos">550</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_dict-551"><a href="#BivariateStatistics.summary_dict-551"><span class="linenos">551</span></a>
+</span><span id="BivariateStatistics.summary_dict-552"><a href="#BivariateStatistics.summary_dict-552"><span class="linenos">552</span></a>        <span class="k">if</span> <span class="n">fitline_kw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_dict-553"><a href="#BivariateStatistics.summary_dict-553"><span class="linenos">553</span></a>            <span class="n">fitline_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;method&#39;</span><span class="p">:</span><span class="s1">&#39;sma&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary_dict-554"><a href="#BivariateStatistics.summary_dict-554"><span class="linenos">554</span></a>                          <span class="s1">&#39;intercept&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
+</span><span id="BivariateStatistics.summary_dict-555"><a href="#BivariateStatistics.summary_dict-555"><span class="linenos">555</span></a>
+</span><span id="BivariateStatistics.summary_dict-556"><a href="#BivariateStatistics.summary_dict-556"><span class="linenos">556</span></a>        <span class="c1"># Construct the dict</span>
+</span><span id="BivariateStatistics.summary_dict-557"><a href="#BivariateStatistics.summary_dict-557"><span class="linenos">557</span></a>        <span class="n">summary</span> <span class="o">=</span> <span class="p">{}</span>
+</span><span id="BivariateStatistics.summary_dict-558"><a href="#BivariateStatistics.summary_dict-558"><span class="linenos">558</span></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_dict-559"><a href="#BivariateStatistics.summary_dict-559"><span class="linenos">559</span></a>            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">,</span><span class="s1">&#39;intercept&#39;</span><span class="p">]:</span>
+</span><span id="BivariateStatistics.summary_dict-560"><a href="#BivariateStatistics.summary_dict-560"><span class="linenos">560</span></a>                <span class="c1"># These variables are object methods</span>
+</span><span id="BivariateStatistics.summary_dict-561"><a href="#BivariateStatistics.summary_dict-561"><span class="linenos">561</span></a>                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_dict-562"><a href="#BivariateStatistics.summary_dict-562"><span class="linenos">562</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_dict-563"><a href="#BivariateStatistics.summary_dict-563"><span class="linenos">563</span></a>            <span class="k">elif</span> <span class="n">v</span> <span class="o">==</span> <span class="s1">&#39;fitline&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_dict-564"><a href="#BivariateStatistics.summary_dict-564"><span class="linenos">564</span></a>                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitline</span><span class="p">(</span><span class="o">**</span><span class="n">fitline_kw</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_dict-565"><a href="#BivariateStatistics.summary_dict-565"><span class="linenos">565</span></a>                <span class="n">v</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">bivariate_line_equation</span><span class="p">(</span><span class="n">line</span><span class="p">,</span><span class="n">floatformat_fiteqn</span><span class="p">,</span><span class="n">ystring</span><span class="o">=</span><span class="s1">&#39;separate&#39;</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_dict-566"><a href="#BivariateStatistics.summary_dict-566"><span class="linenos">566</span></a>            <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_dict-567"><a href="#BivariateStatistics.summary_dict-567"><span class="linenos">567</span></a>                <span class="c1"># Retrieve values</span>
+</span><span id="BivariateStatistics.summary_dict-568"><a href="#BivariateStatistics.summary_dict-568"><span class="linenos">568</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
+</span><span id="BivariateStatistics.summary_dict-569"><a href="#BivariateStatistics.summary_dict-569"><span class="linenos">569</span></a>
+</span><span id="BivariateStatistics.summary_dict-570"><a href="#BivariateStatistics.summary_dict-570"><span class="linenos">570</span></a>            <span class="c1"># summary += (stringformat+&#39;=&#39;+floatformat+&#39;\n&#39;).format(v,value)</span>
+</span><span id="BivariateStatistics.summary_dict-571"><a href="#BivariateStatistics.summary_dict-571"><span class="linenos">571</span></a>            <span class="n">summary</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
+</span><span id="BivariateStatistics.summary_dict-572"><a href="#BivariateStatistics.summary_dict-572"><span class="linenos">572</span></a>
+</span><span id="BivariateStatistics.summary_dict-573"><a href="#BivariateStatistics.summary_dict-573"><span class="linenos">573</span></a>        <span class="k">return</span> <span class="n">summary</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>Summarize bivariate statistics into a dict</p>
 
 <h6 id="parameters">Parameters</h6>
 
@@ -2071,68 +2101,68 @@
         <span class="def">def</span>
         <span class="name">summary</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">variables</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span>,</span><span class="param">	<span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span>,</span><span class="param">	<span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">stringlength</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>
 
                 <label class="view-source-button" for="BivariateStatistics.summary-view-source"><span>View Source</span></label>
 
     </div>
     <a class="headerlink" href="#BivariateStatistics.summary"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.summary-565"><a href="#BivariateStatistics.summary-565"><span class="linenos">565</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary-566"><a href="#BivariateStatistics.summary-566"><span class="linenos">566</span></a>                <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary-567"><a href="#BivariateStatistics.summary-567"><span class="linenos">567</span></a>                <span class="n">stringlength</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
-</span><span id="BivariateStatistics.summary-568"><a href="#BivariateStatistics.summary-568"><span class="linenos">568</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics</span>
-</span><span id="BivariateStatistics.summary-569"><a href="#BivariateStatistics.summary-569"><span class="linenos">569</span></a>
-</span><span id="BivariateStatistics.summary-570"><a href="#BivariateStatistics.summary-570"><span class="linenos">570</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics.summary-571"><a href="#BivariateStatistics.summary-571"><span class="linenos">571</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics.summary-572"><a href="#BivariateStatistics.summary-572"><span class="linenos">572</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
-</span><span id="BivariateStatistics.summary-573"><a href="#BivariateStatistics.summary-573"><span class="linenos">573</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="BivariateStatistics.summary-574"><a href="#BivariateStatistics.summary-574"><span class="linenos">574</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="BivariateStatistics.summary-575"><a href="#BivariateStatistics.summary-575"><span class="linenos">575</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="BivariateStatistics.summary-576"><a href="#BivariateStatistics.summary-576"><span class="linenos">576</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="BivariateStatistics.summary-577"><a href="#BivariateStatistics.summary-577"><span class="linenos">577</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="BivariateStatistics.summary-578"><a href="#BivariateStatistics.summary-578"><span class="linenos">578</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="BivariateStatistics.summary-579"><a href="#BivariateStatistics.summary-579"><span class="linenos">579</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="BivariateStatistics.summary-580"><a href="#BivariateStatistics.summary-580"><span class="linenos">580</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
-</span><span id="BivariateStatistics.summary-581"><a href="#BivariateStatistics.summary-581"><span class="linenos">581</span></a><span class="sd">            format specifier for integer values</span>
-</span><span id="BivariateStatistics.summary-582"><a href="#BivariateStatistics.summary-582"><span class="linenos">582</span></a><span class="sd">        floatformat : str, default=&#39;{:.4f}&#39;</span>
-</span><span id="BivariateStatistics.summary-583"><a href="#BivariateStatistics.summary-583"><span class="linenos">583</span></a><span class="sd">            format specifier for floating point values</span>
-</span><span id="BivariateStatistics.summary-584"><a href="#BivariateStatistics.summary-584"><span class="linenos">584</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="BivariateStatistics.summary-585"><a href="#BivariateStatistics.summary-585"><span class="linenos">585</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="BivariateStatistics.summary-586"><a href="#BivariateStatistics.summary-586"><span class="linenos">586</span></a><span class="sd">        stringlength : int, default=None</span>
-</span><span id="BivariateStatistics.summary-587"><a href="#BivariateStatistics.summary-587"><span class="linenos">587</span></a><span class="sd">            length of the variables on output</span>
-</span><span id="BivariateStatistics.summary-588"><a href="#BivariateStatistics.summary-588"><span class="linenos">588</span></a><span class="sd">            default (None) is to use the length of the longest variable name</span>
-</span><span id="BivariateStatistics.summary-589"><a href="#BivariateStatistics.summary-589"><span class="linenos">589</span></a><span class="sd">        </span>
-</span><span id="BivariateStatistics.summary-590"><a href="#BivariateStatistics.summary-590"><span class="linenos">590</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics.summary-591"><a href="#BivariateStatistics.summary-591"><span class="linenos">591</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics.summary-592"><a href="#BivariateStatistics.summary-592"><span class="linenos">592</span></a><span class="sd">        summary : str</span>
-</span><span id="BivariateStatistics.summary-593"><a href="#BivariateStatistics.summary-593"><span class="linenos">593</span></a><span class="sd">            names and values of variables</span>
-</span><span id="BivariateStatistics.summary-594"><a href="#BivariateStatistics.summary-594"><span class="linenos">594</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics.summary-595"><a href="#BivariateStatistics.summary-595"><span class="linenos">595</span></a>        <span class="c1"># List of variables</span>
-</span><span id="BivariateStatistics.summary-596"><a href="#BivariateStatistics.summary-596"><span class="linenos">596</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary-597"><a href="#BivariateStatistics.summary-597"><span class="linenos">597</span></a>
-</span><span id="BivariateStatistics.summary-598"><a href="#BivariateStatistics.summary-598"><span class="linenos">598</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary-599"><a href="#BivariateStatistics.summary-599"><span class="linenos">599</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
-</span><span id="BivariateStatistics.summary-600"><a href="#BivariateStatistics.summary-600"><span class="linenos">600</span></a>        <span class="k">if</span> <span class="n">stringlength</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary-601"><a href="#BivariateStatistics.summary-601"><span class="linenos">601</span></a>            <span class="n">stringlength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">])</span>
-</span><span id="BivariateStatistics.summary-602"><a href="#BivariateStatistics.summary-602"><span class="linenos">602</span></a>        <span class="n">stringformat</span> <span class="o">=</span> <span class="s1">&#39;{:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">stringlength</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s}&#39;</span>
-</span><span id="BivariateStatistics.summary-603"><a href="#BivariateStatistics.summary-603"><span class="linenos">603</span></a>
-</span><span id="BivariateStatistics.summary-604"><a href="#BivariateStatistics.summary-604"><span class="linenos">604</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
-</span><span id="BivariateStatistics.summary-605"><a href="#BivariateStatistics.summary-605"><span class="linenos">605</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.summary-606"><a href="#BivariateStatistics.summary-606"><span class="linenos">606</span></a>
-</span><span id="BivariateStatistics.summary-607"><a href="#BivariateStatistics.summary-607"><span class="linenos">607</span></a>        <span class="c1"># Extract length of the float numbers from floatformat</span>
-</span><span id="BivariateStatistics.summary-608"><a href="#BivariateStatistics.summary-608"><span class="linenos">608</span></a>        <span class="c1"># import re</span>
-</span><span id="BivariateStatistics.summary-609"><a href="#BivariateStatistics.summary-609"><span class="linenos">609</span></a>        <span class="c1"># floatlength = np.floor( float( re.findall(&quot;[-+]?(?:\d*\.*\d+)&quot;,</span>
-</span><span id="BivariateStatistics.summary-610"><a href="#BivariateStatistics.summary-610"><span class="linenos">610</span></a>        <span class="c1">#       floatformat )[0] ) ).astype(int)</span>
-</span><span id="BivariateStatistics.summary-611"><a href="#BivariateStatistics.summary-611"><span class="linenos">611</span></a>
-</span><span id="BivariateStatistics.summary-612"><a href="#BivariateStatistics.summary-612"><span class="linenos">612</span></a>        <span class="c1"># summary = (stringformat+&#39;{:&gt;10s}&#39;).format(&#39;Variable&#39;,&#39;Value&#39;)</span>
-</span><span id="BivariateStatistics.summary-613"><a href="#BivariateStatistics.summary-613"><span class="linenos">613</span></a>        <span class="n">summarytext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
-</span><span id="BivariateStatistics.summary-614"><a href="#BivariateStatistics.summary-614"><span class="linenos">614</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
-</span><span id="BivariateStatistics.summary-615"><a href="#BivariateStatistics.summary-615"><span class="linenos">615</span></a>            <span class="n">vstr</span> <span class="o">=</span> <span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary-616"><a href="#BivariateStatistics.summary-616"><span class="linenos">616</span></a>            <span class="n">summarytext</span> <span class="o">+=</span> <span class="p">(</span><span class="n">stringformat</span><span class="o">+</span><span class="s1">&#39; = </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">vstr</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary-617"><a href="#BivariateStatistics.summary-617"><span class="linenos">617</span></a>
-</span><span id="BivariateStatistics.summary-618"><a href="#BivariateStatistics.summary-618"><span class="linenos">618</span></a>        <span class="k">return</span> <span class="n">summarytext</span>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.summary-575"><a href="#BivariateStatistics.summary-575"><span class="linenos">575</span></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary-576"><a href="#BivariateStatistics.summary-576"><span class="linenos">576</span></a>                <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary-577"><a href="#BivariateStatistics.summary-577"><span class="linenos">577</span></a>                <span class="n">stringlength</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
+</span><span id="BivariateStatistics.summary-578"><a href="#BivariateStatistics.summary-578"><span class="linenos">578</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Summarize bivariate statistics</span>
+</span><span id="BivariateStatistics.summary-579"><a href="#BivariateStatistics.summary-579"><span class="linenos">579</span></a>
+</span><span id="BivariateStatistics.summary-580"><a href="#BivariateStatistics.summary-580"><span class="linenos">580</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics.summary-581"><a href="#BivariateStatistics.summary-581"><span class="linenos">581</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics.summary-582"><a href="#BivariateStatistics.summary-582"><span class="linenos">582</span></a><span class="sd">        vars : list or str, default=&#39;common&#39;</span>
+</span><span id="BivariateStatistics.summary-583"><a href="#BivariateStatistics.summary-583"><span class="linenos">583</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="BivariateStatistics.summary-584"><a href="#BivariateStatistics.summary-584"><span class="linenos">584</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="BivariateStatistics.summary-585"><a href="#BivariateStatistics.summary-585"><span class="linenos">585</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="BivariateStatistics.summary-586"><a href="#BivariateStatistics.summary-586"><span class="linenos">586</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="BivariateStatistics.summary-587"><a href="#BivariateStatistics.summary-587"><span class="linenos">587</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="BivariateStatistics.summary-588"><a href="#BivariateStatistics.summary-588"><span class="linenos">588</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="BivariateStatistics.summary-589"><a href="#BivariateStatistics.summary-589"><span class="linenos">589</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="BivariateStatistics.summary-590"><a href="#BivariateStatistics.summary-590"><span class="linenos">590</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
+</span><span id="BivariateStatistics.summary-591"><a href="#BivariateStatistics.summary-591"><span class="linenos">591</span></a><span class="sd">            format specifier for integer values</span>
+</span><span id="BivariateStatistics.summary-592"><a href="#BivariateStatistics.summary-592"><span class="linenos">592</span></a><span class="sd">        floatformat : str, default=&#39;{:.4f}&#39;</span>
+</span><span id="BivariateStatistics.summary-593"><a href="#BivariateStatistics.summary-593"><span class="linenos">593</span></a><span class="sd">            format specifier for floating point values</span>
+</span><span id="BivariateStatistics.summary-594"><a href="#BivariateStatistics.summary-594"><span class="linenos">594</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="BivariateStatistics.summary-595"><a href="#BivariateStatistics.summary-595"><span class="linenos">595</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="BivariateStatistics.summary-596"><a href="#BivariateStatistics.summary-596"><span class="linenos">596</span></a><span class="sd">        stringlength : int, default=None</span>
+</span><span id="BivariateStatistics.summary-597"><a href="#BivariateStatistics.summary-597"><span class="linenos">597</span></a><span class="sd">            length of the variables on output</span>
+</span><span id="BivariateStatistics.summary-598"><a href="#BivariateStatistics.summary-598"><span class="linenos">598</span></a><span class="sd">            default (None) is to use the length of the longest variable name</span>
+</span><span id="BivariateStatistics.summary-599"><a href="#BivariateStatistics.summary-599"><span class="linenos">599</span></a><span class="sd">        </span>
+</span><span id="BivariateStatistics.summary-600"><a href="#BivariateStatistics.summary-600"><span class="linenos">600</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics.summary-601"><a href="#BivariateStatistics.summary-601"><span class="linenos">601</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics.summary-602"><a href="#BivariateStatistics.summary-602"><span class="linenos">602</span></a><span class="sd">        summary : str</span>
+</span><span id="BivariateStatistics.summary-603"><a href="#BivariateStatistics.summary-603"><span class="linenos">603</span></a><span class="sd">            names and values of variables</span>
+</span><span id="BivariateStatistics.summary-604"><a href="#BivariateStatistics.summary-604"><span class="linenos">604</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics.summary-605"><a href="#BivariateStatistics.summary-605"><span class="linenos">605</span></a>        <span class="c1"># List of variables</span>
+</span><span id="BivariateStatistics.summary-606"><a href="#BivariateStatistics.summary-606"><span class="linenos">606</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary-607"><a href="#BivariateStatistics.summary-607"><span class="linenos">607</span></a>
+</span><span id="BivariateStatistics.summary-608"><a href="#BivariateStatistics.summary-608"><span class="linenos">608</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary-609"><a href="#BivariateStatistics.summary-609"><span class="linenos">609</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
+</span><span id="BivariateStatistics.summary-610"><a href="#BivariateStatistics.summary-610"><span class="linenos">610</span></a>        <span class="k">if</span> <span class="n">stringlength</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary-611"><a href="#BivariateStatistics.summary-611"><span class="linenos">611</span></a>            <span class="n">stringlength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">])</span>
+</span><span id="BivariateStatistics.summary-612"><a href="#BivariateStatistics.summary-612"><span class="linenos">612</span></a>        <span class="n">stringformat</span> <span class="o">=</span> <span class="s1">&#39;{:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">stringlength</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;s}&#39;</span>
+</span><span id="BivariateStatistics.summary-613"><a href="#BivariateStatistics.summary-613"><span class="linenos">613</span></a>
+</span><span id="BivariateStatistics.summary-614"><a href="#BivariateStatistics.summary-614"><span class="linenos">614</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
+</span><span id="BivariateStatistics.summary-615"><a href="#BivariateStatistics.summary-615"><span class="linenos">615</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.summary-616"><a href="#BivariateStatistics.summary-616"><span class="linenos">616</span></a>
+</span><span id="BivariateStatistics.summary-617"><a href="#BivariateStatistics.summary-617"><span class="linenos">617</span></a>        <span class="c1"># Extract length of the float numbers from floatformat</span>
+</span><span id="BivariateStatistics.summary-618"><a href="#BivariateStatistics.summary-618"><span class="linenos">618</span></a>        <span class="c1"># import re</span>
+</span><span id="BivariateStatistics.summary-619"><a href="#BivariateStatistics.summary-619"><span class="linenos">619</span></a>        <span class="c1"># floatlength = np.floor( float( re.findall(&quot;[-+]?(?:\d*\.*\d+)&quot;,</span>
+</span><span id="BivariateStatistics.summary-620"><a href="#BivariateStatistics.summary-620"><span class="linenos">620</span></a>        <span class="c1">#       floatformat )[0] ) ).astype(int)</span>
+</span><span id="BivariateStatistics.summary-621"><a href="#BivariateStatistics.summary-621"><span class="linenos">621</span></a>
+</span><span id="BivariateStatistics.summary-622"><a href="#BivariateStatistics.summary-622"><span class="linenos">622</span></a>        <span class="c1"># summary = (stringformat+&#39;{:&gt;10s}&#39;).format(&#39;Variable&#39;,&#39;Value&#39;)</span>
+</span><span id="BivariateStatistics.summary-623"><a href="#BivariateStatistics.summary-623"><span class="linenos">623</span></a>        <span class="n">summarytext</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
+</span><span id="BivariateStatistics.summary-624"><a href="#BivariateStatistics.summary-624"><span class="linenos">624</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
+</span><span id="BivariateStatistics.summary-625"><a href="#BivariateStatistics.summary-625"><span class="linenos">625</span></a>            <span class="n">vstr</span> <span class="o">=</span> <span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary-626"><a href="#BivariateStatistics.summary-626"><span class="linenos">626</span></a>            <span class="n">summarytext</span> <span class="o">+=</span> <span class="p">(</span><span class="n">stringformat</span><span class="o">+</span><span class="s1">&#39; = </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">vstr</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary-627"><a href="#BivariateStatistics.summary-627"><span class="linenos">627</span></a>
+</span><span id="BivariateStatistics.summary-628"><a href="#BivariateStatistics.summary-628"><span class="linenos">628</span></a>        <span class="k">return</span> <span class="n">summarytext</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>Summarize bivariate statistics</p>
 
 <h6 id="parameters">Parameters</h6>
 
@@ -2173,138 +2203,138 @@
         <span class="def">def</span>
         <span class="name">summary_fig_inset</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ax</span>,</span><span class="param">	<span class="n">variables</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span>,</span><span class="param">	<span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span>,</span><span class="param">	<span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">loc</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">loc_units</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>
 
                 <label class="view-source-button" for="BivariateStatistics.summary_fig_inset-view-source"><span>View Source</span></label>
 
     </div>
     <a class="headerlink" href="#BivariateStatistics.summary_fig_inset"></a>
-            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.summary_fig_inset-620"><a href="#BivariateStatistics.summary_fig_inset-620"><span class="linenos">620</span></a>    <span class="k">def</span> <span class="nf">summary_fig_inset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-621"><a href="#BivariateStatistics.summary_fig_inset-621"><span class="linenos">621</span></a>                          <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-622"><a href="#BivariateStatistics.summary_fig_inset-622"><span class="linenos">622</span></a>                          <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc_units</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-623"><a href="#BivariateStatistics.summary_fig_inset-623"><span class="linenos">623</span></a>                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
-</span><span id="BivariateStatistics.summary_fig_inset-624"><a href="#BivariateStatistics.summary_fig_inset-624"><span class="linenos">624</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Display bivariate statistics as a table inset on a plot axis</span>
-</span><span id="BivariateStatistics.summary_fig_inset-625"><a href="#BivariateStatistics.summary_fig_inset-625"><span class="linenos">625</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-626"><a href="#BivariateStatistics.summary_fig_inset-626"><span class="linenos">626</span></a><span class="sd">        Parameters</span>
-</span><span id="BivariateStatistics.summary_fig_inset-627"><a href="#BivariateStatistics.summary_fig_inset-627"><span class="linenos">627</span></a><span class="sd">        ----------</span>
-</span><span id="BivariateStatistics.summary_fig_inset-628"><a href="#BivariateStatistics.summary_fig_inset-628"><span class="linenos">628</span></a><span class="sd">        ax : matplotlib.Figure.Axis </span>
-</span><span id="BivariateStatistics.summary_fig_inset-629"><a href="#BivariateStatistics.summary_fig_inset-629"><span class="linenos">629</span></a><span class="sd">            axis where the table will be displayed</span>
-</span><span id="BivariateStatistics.summary_fig_inset-630"><a href="#BivariateStatistics.summary_fig_inset-630"><span class="linenos">630</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
-</span><span id="BivariateStatistics.summary_fig_inset-631"><a href="#BivariateStatistics.summary_fig_inset-631"><span class="linenos">631</span></a><span class="sd">            names of attribute variables to include in summary</span>
-</span><span id="BivariateStatistics.summary_fig_inset-632"><a href="#BivariateStatistics.summary_fig_inset-632"><span class="linenos">632</span></a><span class="sd">            names are case insensitive            </span>
-</span><span id="BivariateStatistics.summary_fig_inset-633"><a href="#BivariateStatistics.summary_fig_inset-633"><span class="linenos">633</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
-</span><span id="BivariateStatistics.summary_fig_inset-634"><a href="#BivariateStatistics.summary_fig_inset-634"><span class="linenos">634</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-635"><a href="#BivariateStatistics.summary_fig_inset-635"><span class="linenos">635</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-636"><a href="#BivariateStatistics.summary_fig_inset-636"><span class="linenos">636</span></a><span class="sd">        fitline_kw : dict, default=None</span>
-</span><span id="BivariateStatistics.summary_fig_inset-637"><a href="#BivariateStatistics.summary_fig_inset-637"><span class="linenos">637</span></a><span class="sd">            keywords passed to `fitline`</span>
-</span><span id="BivariateStatistics.summary_fig_inset-638"><a href="#BivariateStatistics.summary_fig_inset-638"><span class="linenos">638</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
-</span><span id="BivariateStatistics.summary_fig_inset-639"><a href="#BivariateStatistics.summary_fig_inset-639"><span class="linenos">639</span></a><span class="sd">            format specifier for integer values</span>
-</span><span id="BivariateStatistics.summary_fig_inset-640"><a href="#BivariateStatistics.summary_fig_inset-640"><span class="linenos">640</span></a><span class="sd">        floatformat : str, default=&#39;{:.3f}&#39;</span>
-</span><span id="BivariateStatistics.summary_fig_inset-641"><a href="#BivariateStatistics.summary_fig_inset-641"><span class="linenos">641</span></a><span class="sd">            format specifier for floating point values</span>
-</span><span id="BivariateStatistics.summary_fig_inset-642"><a href="#BivariateStatistics.summary_fig_inset-642"><span class="linenos">642</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
-</span><span id="BivariateStatistics.summary_fig_inset-643"><a href="#BivariateStatistics.summary_fig_inset-643"><span class="linenos">643</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
-</span><span id="BivariateStatistics.summary_fig_inset-644"><a href="#BivariateStatistics.summary_fig_inset-644"><span class="linenos">644</span></a><span class="sd">        loc : tuple (x0,y0), default=(0.85, 0.05)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-645"><a href="#BivariateStatistics.summary_fig_inset-645"><span class="linenos">645</span></a><span class="sd">            location on the axis where the table will be drawn</span>
-</span><span id="BivariateStatistics.summary_fig_inset-646"><a href="#BivariateStatistics.summary_fig_inset-646"><span class="linenos">646</span></a><span class="sd">            can be in data units or axes units [0-1]</span>
-</span><span id="BivariateStatistics.summary_fig_inset-647"><a href="#BivariateStatistics.summary_fig_inset-647"><span class="linenos">647</span></a><span class="sd">        loc_units : {&#39;axes&#39; (default), &#39;data&#39;}</span>
-</span><span id="BivariateStatistics.summary_fig_inset-648"><a href="#BivariateStatistics.summary_fig_inset-648"><span class="linenos">648</span></a><span class="sd">            specifies whether loc has &#39;data&#39; units or &#39;axes&#39; units [0-1]</span>
-</span><span id="BivariateStatistics.summary_fig_inset-649"><a href="#BivariateStatistics.summary_fig_inset-649"><span class="linenos">649</span></a><span class="sd">                    </span>
-</span><span id="BivariateStatistics.summary_fig_inset-650"><a href="#BivariateStatistics.summary_fig_inset-650"><span class="linenos">650</span></a><span class="sd">        Returns</span>
-</span><span id="BivariateStatistics.summary_fig_inset-651"><a href="#BivariateStatistics.summary_fig_inset-651"><span class="linenos">651</span></a><span class="sd">        -------</span>
-</span><span id="BivariateStatistics.summary_fig_inset-652"><a href="#BivariateStatistics.summary_fig_inset-652"><span class="linenos">652</span></a><span class="sd">        text1, text2 : matplotlib text object</span>
-</span><span id="BivariateStatistics.summary_fig_inset-653"><a href="#BivariateStatistics.summary_fig_inset-653"><span class="linenos">653</span></a><span class="sd">            Artist for the two text boxes        </span>
-</span><span id="BivariateStatistics.summary_fig_inset-654"><a href="#BivariateStatistics.summary_fig_inset-654"><span class="linenos">654</span></a><span class="sd">        &#39;&#39;&#39;</span>
-</span><span id="BivariateStatistics.summary_fig_inset-655"><a href="#BivariateStatistics.summary_fig_inset-655"><span class="linenos">655</span></a>        <span class="c1"># List of variables</span>
-</span><span id="BivariateStatistics.summary_fig_inset-656"><a href="#BivariateStatistics.summary_fig_inset-656"><span class="linenos">656</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-657"><a href="#BivariateStatistics.summary_fig_inset-657"><span class="linenos">657</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-658"><a href="#BivariateStatistics.summary_fig_inset-658"><span class="linenos">658</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-659"><a href="#BivariateStatistics.summary_fig_inset-659"><span class="linenos">659</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
-</span><span id="BivariateStatistics.summary_fig_inset-660"><a href="#BivariateStatistics.summary_fig_inset-660"><span class="linenos">660</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-661"><a href="#BivariateStatistics.summary_fig_inset-661"><span class="linenos">661</span></a>        <span class="c1"># Default location in lower right corner</span>
-</span><span id="BivariateStatistics.summary_fig_inset-662"><a href="#BivariateStatistics.summary_fig_inset-662"><span class="linenos">662</span></a>        <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-663"><a href="#BivariateStatistics.summary_fig_inset-663"><span class="linenos">663</span></a>            <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-664"><a href="#BivariateStatistics.summary_fig_inset-664"><span class="linenos">664</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-665"><a href="#BivariateStatistics.summary_fig_inset-665"><span class="linenos">665</span></a>        <span class="c1"># Coordinates for loc</span>
-</span><span id="BivariateStatistics.summary_fig_inset-666"><a href="#BivariateStatistics.summary_fig_inset-666"><span class="linenos">666</span></a>        <span class="k">if</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;data&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-667"><a href="#BivariateStatistics.summary_fig_inset-667"><span class="linenos">667</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
-</span><span id="BivariateStatistics.summary_fig_inset-668"><a href="#BivariateStatistics.summary_fig_inset-668"><span class="linenos">668</span></a>        <span class="k">elif</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span><span class="s1">&#39;axis&#39;</span><span class="p">]:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-669"><a href="#BivariateStatistics.summary_fig_inset-669"><span class="linenos">669</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
-</span><span id="BivariateStatistics.summary_fig_inset-670"><a href="#BivariateStatistics.summary_fig_inset-670"><span class="linenos">670</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-671"><a href="#BivariateStatistics.summary_fig_inset-671"><span class="linenos">671</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Display units should be &quot;Data&quot; or &quot;Axes&quot;&#39;</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-672"><a href="#BivariateStatistics.summary_fig_inset-672"><span class="linenos">672</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-673"><a href="#BivariateStatistics.summary_fig_inset-673"><span class="linenos">673</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
-</span><span id="BivariateStatistics.summary_fig_inset-674"><a href="#BivariateStatistics.summary_fig_inset-674"><span class="linenos">674</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-675"><a href="#BivariateStatistics.summary_fig_inset-675"><span class="linenos">675</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-676"><a href="#BivariateStatistics.summary_fig_inset-676"><span class="linenos">676</span></a>        <span class="c1"># Column of label text</span>
-</span><span id="BivariateStatistics.summary_fig_inset-677"><a href="#BivariateStatistics.summary_fig_inset-677"><span class="linenos">677</span></a>        <span class="n">label_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_texify_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-678"><a href="#BivariateStatistics.summary_fig_inset-678"><span class="linenos">678</span></a>                                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="p">])</span>
-</span><span id="BivariateStatistics.summary_fig_inset-679"><a href="#BivariateStatistics.summary_fig_inset-679"><span class="linenos">679</span></a>        <span class="c1"># Column of value text</span>
-</span><span id="BivariateStatistics.summary_fig_inset-680"><a href="#BivariateStatistics.summary_fig_inset-680"><span class="linenos">680</span></a>        <span class="n">value_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-681"><a href="#BivariateStatistics.summary_fig_inset-681"><span class="linenos">681</span></a>                                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
+            <div class="pdoc-code codehilite"><pre><span></span><span id="BivariateStatistics.summary_fig_inset-630"><a href="#BivariateStatistics.summary_fig_inset-630"><span class="linenos">630</span></a>    <span class="k">def</span> <span class="nf">summary_fig_inset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-631"><a href="#BivariateStatistics.summary_fig_inset-631"><span class="linenos">631</span></a>                          <span class="n">intformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-632"><a href="#BivariateStatistics.summary_fig_inset-632"><span class="linenos">632</span></a>                          <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc_units</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-633"><a href="#BivariateStatistics.summary_fig_inset-633"><span class="linenos">633</span></a>                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
+</span><span id="BivariateStatistics.summary_fig_inset-634"><a href="#BivariateStatistics.summary_fig_inset-634"><span class="linenos">634</span></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Display bivariate statistics as a table inset on a plot axis</span>
+</span><span id="BivariateStatistics.summary_fig_inset-635"><a href="#BivariateStatistics.summary_fig_inset-635"><span class="linenos">635</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-636"><a href="#BivariateStatistics.summary_fig_inset-636"><span class="linenos">636</span></a><span class="sd">        Parameters</span>
+</span><span id="BivariateStatistics.summary_fig_inset-637"><a href="#BivariateStatistics.summary_fig_inset-637"><span class="linenos">637</span></a><span class="sd">        ----------</span>
+</span><span id="BivariateStatistics.summary_fig_inset-638"><a href="#BivariateStatistics.summary_fig_inset-638"><span class="linenos">638</span></a><span class="sd">        ax : matplotlib.Figure.Axis </span>
+</span><span id="BivariateStatistics.summary_fig_inset-639"><a href="#BivariateStatistics.summary_fig_inset-639"><span class="linenos">639</span></a><span class="sd">            axis where the table will be displayed</span>
+</span><span id="BivariateStatistics.summary_fig_inset-640"><a href="#BivariateStatistics.summary_fig_inset-640"><span class="linenos">640</span></a><span class="sd">        variables : list or str, default=&#39;common&#39;</span>
+</span><span id="BivariateStatistics.summary_fig_inset-641"><a href="#BivariateStatistics.summary_fig_inset-641"><span class="linenos">641</span></a><span class="sd">            names of attribute variables to include in summary</span>
+</span><span id="BivariateStatistics.summary_fig_inset-642"><a href="#BivariateStatistics.summary_fig_inset-642"><span class="linenos">642</span></a><span class="sd">            names are case insensitive            </span>
+</span><span id="BivariateStatistics.summary_fig_inset-643"><a href="#BivariateStatistics.summary_fig_inset-643"><span class="linenos">643</span></a><span class="sd">            The following strings are also accepted in place of a list </span>
+</span><span id="BivariateStatistics.summary_fig_inset-644"><a href="#BivariateStatistics.summary_fig_inset-644"><span class="linenos">644</span></a><span class="sd">                &quot;all&quot; (displays all variables)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-645"><a href="#BivariateStatistics.summary_fig_inset-645"><span class="linenos">645</span></a><span class="sd">                &quot;common&quot; (displays all measures of mean difference)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-646"><a href="#BivariateStatistics.summary_fig_inset-646"><span class="linenos">646</span></a><span class="sd">        fitline_kw : dict, default=None</span>
+</span><span id="BivariateStatistics.summary_fig_inset-647"><a href="#BivariateStatistics.summary_fig_inset-647"><span class="linenos">647</span></a><span class="sd">            keywords passed to `fitline`</span>
+</span><span id="BivariateStatistics.summary_fig_inset-648"><a href="#BivariateStatistics.summary_fig_inset-648"><span class="linenos">648</span></a><span class="sd">        intformat : str, default=&#39;{:d}&#39;</span>
+</span><span id="BivariateStatistics.summary_fig_inset-649"><a href="#BivariateStatistics.summary_fig_inset-649"><span class="linenos">649</span></a><span class="sd">            format specifier for integer values</span>
+</span><span id="BivariateStatistics.summary_fig_inset-650"><a href="#BivariateStatistics.summary_fig_inset-650"><span class="linenos">650</span></a><span class="sd">        floatformat : str, default=&#39;{:.3f}&#39;</span>
+</span><span id="BivariateStatistics.summary_fig_inset-651"><a href="#BivariateStatistics.summary_fig_inset-651"><span class="linenos">651</span></a><span class="sd">            format specifier for floating point values</span>
+</span><span id="BivariateStatistics.summary_fig_inset-652"><a href="#BivariateStatistics.summary_fig_inset-652"><span class="linenos">652</span></a><span class="sd">        floatformat_fiteqn : str, default=floatformat</span>
+</span><span id="BivariateStatistics.summary_fig_inset-653"><a href="#BivariateStatistics.summary_fig_inset-653"><span class="linenos">653</span></a><span class="sd">            format specifier for slope and intercept (a,b) in y = a x + b</span>
+</span><span id="BivariateStatistics.summary_fig_inset-654"><a href="#BivariateStatistics.summary_fig_inset-654"><span class="linenos">654</span></a><span class="sd">        loc : tuple (x0,y0), default=(0.85, 0.05)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-655"><a href="#BivariateStatistics.summary_fig_inset-655"><span class="linenos">655</span></a><span class="sd">            location on the axis where the table will be drawn</span>
+</span><span id="BivariateStatistics.summary_fig_inset-656"><a href="#BivariateStatistics.summary_fig_inset-656"><span class="linenos">656</span></a><span class="sd">            can be in data units or axes units [0-1]</span>
+</span><span id="BivariateStatistics.summary_fig_inset-657"><a href="#BivariateStatistics.summary_fig_inset-657"><span class="linenos">657</span></a><span class="sd">        loc_units : {&#39;axes&#39; (default), &#39;data&#39;}</span>
+</span><span id="BivariateStatistics.summary_fig_inset-658"><a href="#BivariateStatistics.summary_fig_inset-658"><span class="linenos">658</span></a><span class="sd">            specifies whether loc has &#39;data&#39; units or &#39;axes&#39; units [0-1]</span>
+</span><span id="BivariateStatistics.summary_fig_inset-659"><a href="#BivariateStatistics.summary_fig_inset-659"><span class="linenos">659</span></a><span class="sd">                    </span>
+</span><span id="BivariateStatistics.summary_fig_inset-660"><a href="#BivariateStatistics.summary_fig_inset-660"><span class="linenos">660</span></a><span class="sd">        Returns</span>
+</span><span id="BivariateStatistics.summary_fig_inset-661"><a href="#BivariateStatistics.summary_fig_inset-661"><span class="linenos">661</span></a><span class="sd">        -------</span>
+</span><span id="BivariateStatistics.summary_fig_inset-662"><a href="#BivariateStatistics.summary_fig_inset-662"><span class="linenos">662</span></a><span class="sd">        text1, text2 : matplotlib text object</span>
+</span><span id="BivariateStatistics.summary_fig_inset-663"><a href="#BivariateStatistics.summary_fig_inset-663"><span class="linenos">663</span></a><span class="sd">            Artist for the two text boxes        </span>
+</span><span id="BivariateStatistics.summary_fig_inset-664"><a href="#BivariateStatistics.summary_fig_inset-664"><span class="linenos">664</span></a><span class="sd">        &#39;&#39;&#39;</span>
+</span><span id="BivariateStatistics.summary_fig_inset-665"><a href="#BivariateStatistics.summary_fig_inset-665"><span class="linenos">665</span></a>        <span class="c1"># List of variables</span>
+</span><span id="BivariateStatistics.summary_fig_inset-666"><a href="#BivariateStatistics.summary_fig_inset-666"><span class="linenos">666</span></a>        <span class="n">variables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_variables</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-667"><a href="#BivariateStatistics.summary_fig_inset-667"><span class="linenos">667</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-668"><a href="#BivariateStatistics.summary_fig_inset-668"><span class="linenos">668</span></a>        <span class="k">if</span> <span class="n">floatformat_fiteqn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-669"><a href="#BivariateStatistics.summary_fig_inset-669"><span class="linenos">669</span></a>            <span class="n">floatformat_fiteqn</span> <span class="o">=</span> <span class="n">floatformat</span>
+</span><span id="BivariateStatistics.summary_fig_inset-670"><a href="#BivariateStatistics.summary_fig_inset-670"><span class="linenos">670</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-671"><a href="#BivariateStatistics.summary_fig_inset-671"><span class="linenos">671</span></a>        <span class="c1"># Default location in lower right corner</span>
+</span><span id="BivariateStatistics.summary_fig_inset-672"><a href="#BivariateStatistics.summary_fig_inset-672"><span class="linenos">672</span></a>        <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-673"><a href="#BivariateStatistics.summary_fig_inset-673"><span class="linenos">673</span></a>            <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-674"><a href="#BivariateStatistics.summary_fig_inset-674"><span class="linenos">674</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-675"><a href="#BivariateStatistics.summary_fig_inset-675"><span class="linenos">675</span></a>        <span class="c1"># Coordinates for loc</span>
+</span><span id="BivariateStatistics.summary_fig_inset-676"><a href="#BivariateStatistics.summary_fig_inset-676"><span class="linenos">676</span></a>        <span class="k">if</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;data&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-677"><a href="#BivariateStatistics.summary_fig_inset-677"><span class="linenos">677</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
+</span><span id="BivariateStatistics.summary_fig_inset-678"><a href="#BivariateStatistics.summary_fig_inset-678"><span class="linenos">678</span></a>        <span class="k">elif</span> <span class="n">loc_units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span><span class="s1">&#39;axis&#39;</span><span class="p">]:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-679"><a href="#BivariateStatistics.summary_fig_inset-679"><span class="linenos">679</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span>
+</span><span id="BivariateStatistics.summary_fig_inset-680"><a href="#BivariateStatistics.summary_fig_inset-680"><span class="linenos">680</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-681"><a href="#BivariateStatistics.summary_fig_inset-681"><span class="linenos">681</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Display units should be &quot;Data&quot; or &quot;Axes&quot;&#39;</span><span class="p">)</span>
 </span><span id="BivariateStatistics.summary_fig_inset-682"><a href="#BivariateStatistics.summary_fig_inset-682"><span class="linenos">682</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-683"><a href="#BivariateStatistics.summary_fig_inset-683"><span class="linenos">683</span></a>        <span class="c1"># Check if horizontal alignment keyword is used</span>
-</span><span id="BivariateStatistics.summary_fig_inset-684"><a href="#BivariateStatistics.summary_fig_inset-684"><span class="linenos">684</span></a>        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
-</span><span id="BivariateStatistics.summary_fig_inset-685"><a href="#BivariateStatistics.summary_fig_inset-685"><span class="linenos">685</span></a>        <span class="k">try</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-686"><a href="#BivariateStatistics.summary_fig_inset-686"><span class="linenos">686</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics.summary_fig_inset-687"><a href="#BivariateStatistics.summary_fig_inset-687"><span class="linenos">687</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-688"><a href="#BivariateStatistics.summary_fig_inset-688"><span class="linenos">688</span></a>            <span class="k">pass</span>
-</span><span id="BivariateStatistics.summary_fig_inset-689"><a href="#BivariateStatistics.summary_fig_inset-689"><span class="linenos">689</span></a>        <span class="k">try</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-690"><a href="#BivariateStatistics.summary_fig_inset-690"><span class="linenos">690</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;horizontalalignment&#39;</span><span class="p">]</span>
-</span><span id="BivariateStatistics.summary_fig_inset-691"><a href="#BivariateStatistics.summary_fig_inset-691"><span class="linenos">691</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-692"><a href="#BivariateStatistics.summary_fig_inset-692"><span class="linenos">692</span></a>            <span class="k">pass</span>
-</span><span id="BivariateStatistics.summary_fig_inset-693"><a href="#BivariateStatistics.summary_fig_inset-693"><span class="linenos">693</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-694"><a href="#BivariateStatistics.summary_fig_inset-694"><span class="linenos">694</span></a>        <span class="c1"># For right alignment, align on values first</span>
-</span><span id="BivariateStatistics.summary_fig_inset-695"><a href="#BivariateStatistics.summary_fig_inset-695"><span class="linenos">695</span></a>        <span class="c1"># Otherwise, align on labels</span>
-</span><span id="BivariateStatistics.summary_fig_inset-696"><a href="#BivariateStatistics.summary_fig_inset-696"><span class="linenos">696</span></a>        <span class="k">if</span> <span class="n">ha</span><span class="o">==</span><span class="s1">&#39;right&#39;</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-697"><a href="#BivariateStatistics.summary_fig_inset-697"><span class="linenos">697</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">value_text</span>
-</span><span id="BivariateStatistics.summary_fig_inset-698"><a href="#BivariateStatistics.summary_fig_inset-698"><span class="linenos">698</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">label_text</span>
-</span><span id="BivariateStatistics.summary_fig_inset-699"><a href="#BivariateStatistics.summary_fig_inset-699"><span class="linenos">699</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
-</span><span id="BivariateStatistics.summary_fig_inset-700"><a href="#BivariateStatistics.summary_fig_inset-700"><span class="linenos">700</span></a>        <span class="k">else</span><span class="p">:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-701"><a href="#BivariateStatistics.summary_fig_inset-701"><span class="linenos">701</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">label_text</span>
-</span><span id="BivariateStatistics.summary_fig_inset-702"><a href="#BivariateStatistics.summary_fig_inset-702"><span class="linenos">702</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">value_text</span>
-</span><span id="BivariateStatistics.summary_fig_inset-703"><a href="#BivariateStatistics.summary_fig_inset-703"><span class="linenos">703</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
-</span><span id="BivariateStatistics.summary_fig_inset-704"><a href="#BivariateStatistics.summary_fig_inset-704"><span class="linenos">704</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-705"><a href="#BivariateStatistics.summary_fig_inset-705"><span class="linenos">705</span></a>        <span class="c1"># Add first column of text</span>
-</span><span id="BivariateStatistics.summary_fig_inset-706"><a href="#BivariateStatistics.summary_fig_inset-706"><span class="linenos">706</span></a>        <span class="n">t1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
-</span><span id="BivariateStatistics.summary_fig_inset-707"><a href="#BivariateStatistics.summary_fig_inset-707"><span class="linenos">707</span></a>                <span class="n">first_text</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-708"><a href="#BivariateStatistics.summary_fig_inset-708"><span class="linenos">708</span></a>                <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-709"><a href="#BivariateStatistics.summary_fig_inset-709"><span class="linenos">709</span></a>                <span class="o">**</span><span class="n">kwargs</span>
-</span><span id="BivariateStatistics.summary_fig_inset-710"><a href="#BivariateStatistics.summary_fig_inset-710"><span class="linenos">710</span></a>                <span class="p">)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-711"><a href="#BivariateStatistics.summary_fig_inset-711"><span class="linenos">711</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-712"><a href="#BivariateStatistics.summary_fig_inset-712"><span class="linenos">712</span></a>        <span class="c1"># Get width of first text column</span>
-</span><span id="BivariateStatistics.summary_fig_inset-713"><a href="#BivariateStatistics.summary_fig_inset-713"><span class="linenos">713</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
-</span><span id="BivariateStatistics.summary_fig_inset-714"><a href="#BivariateStatistics.summary_fig_inset-714"><span class="linenos">714</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span><span class="o">-</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span>
-</span><span id="BivariateStatistics.summary_fig_inset-715"><a href="#BivariateStatistics.summary_fig_inset-715"><span class="linenos">715</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-716"><a href="#BivariateStatistics.summary_fig_inset-716"><span class="linenos">716</span></a>        <span class="c1"># Add second column of text</span>
-</span><span id="BivariateStatistics.summary_fig_inset-717"><a href="#BivariateStatistics.summary_fig_inset-717"><span class="linenos">717</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">width</span><span class="o">*</span><span class="n">sign</span><span class="p">,</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
-</span><span id="BivariateStatistics.summary_fig_inset-718"><a href="#BivariateStatistics.summary_fig_inset-718"><span class="linenos">718</span></a>                     <span class="n">second_text</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-719"><a href="#BivariateStatistics.summary_fig_inset-719"><span class="linenos">719</span></a>                     <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-720"><a href="#BivariateStatistics.summary_fig_inset-720"><span class="linenos">720</span></a>                     <span class="o">**</span><span class="n">kwargs</span>
-</span><span id="BivariateStatistics.summary_fig_inset-721"><a href="#BivariateStatistics.summary_fig_inset-721"><span class="linenos">721</span></a>                     <span class="p">)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-722"><a href="#BivariateStatistics.summary_fig_inset-722"><span class="linenos">722</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-723"><a href="#BivariateStatistics.summary_fig_inset-723"><span class="linenos">723</span></a>        <span class="c1">##################################</span>
-</span><span id="BivariateStatistics.summary_fig_inset-724"><a href="#BivariateStatistics.summary_fig_inset-724"><span class="linenos">724</span></a>        <span class="c1"># Early version of this function using matplotlib.table.table()</span>
+</span><span id="BivariateStatistics.summary_fig_inset-683"><a href="#BivariateStatistics.summary_fig_inset-683"><span class="linenos">683</span></a>        <span class="c1"># Get a dict containing the needed variables</span>
+</span><span id="BivariateStatistics.summary_fig_inset-684"><a href="#BivariateStatistics.summary_fig_inset-684"><span class="linenos">684</span></a>        <span class="n">summarydict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary_dict</span><span class="p">(</span> <span class="n">variables</span><span class="p">,</span> <span class="n">fitline_kw</span><span class="p">,</span> <span class="n">floatformat_fiteqn</span> <span class="p">)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-685"><a href="#BivariateStatistics.summary_fig_inset-685"><span class="linenos">685</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-686"><a href="#BivariateStatistics.summary_fig_inset-686"><span class="linenos">686</span></a>        <span class="c1"># Column of label text</span>
+</span><span id="BivariateStatistics.summary_fig_inset-687"><a href="#BivariateStatistics.summary_fig_inset-687"><span class="linenos">687</span></a>        <span class="n">label_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_texify_name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-688"><a href="#BivariateStatistics.summary_fig_inset-688"><span class="linenos">688</span></a>                                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="p">])</span>
+</span><span id="BivariateStatistics.summary_fig_inset-689"><a href="#BivariateStatistics.summary_fig_inset-689"><span class="linenos">689</span></a>        <span class="c1"># Column of value text</span>
+</span><span id="BivariateStatistics.summary_fig_inset-690"><a href="#BivariateStatistics.summary_fig_inset-690"><span class="linenos">690</span></a>        <span class="n">value_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_number2str</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">intformat</span><span class="p">,</span><span class="n">floatformat</span><span class="p">)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-691"><a href="#BivariateStatistics.summary_fig_inset-691"><span class="linenos">691</span></a>                                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">summarydict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
+</span><span id="BivariateStatistics.summary_fig_inset-692"><a href="#BivariateStatistics.summary_fig_inset-692"><span class="linenos">692</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-693"><a href="#BivariateStatistics.summary_fig_inset-693"><span class="linenos">693</span></a>        <span class="c1"># Check if horizontal alignment keyword is used</span>
+</span><span id="BivariateStatistics.summary_fig_inset-694"><a href="#BivariateStatistics.summary_fig_inset-694"><span class="linenos">694</span></a>        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
+</span><span id="BivariateStatistics.summary_fig_inset-695"><a href="#BivariateStatistics.summary_fig_inset-695"><span class="linenos">695</span></a>        <span class="k">try</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-696"><a href="#BivariateStatistics.summary_fig_inset-696"><span class="linenos">696</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics.summary_fig_inset-697"><a href="#BivariateStatistics.summary_fig_inset-697"><span class="linenos">697</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-698"><a href="#BivariateStatistics.summary_fig_inset-698"><span class="linenos">698</span></a>            <span class="k">pass</span>
+</span><span id="BivariateStatistics.summary_fig_inset-699"><a href="#BivariateStatistics.summary_fig_inset-699"><span class="linenos">699</span></a>        <span class="k">try</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-700"><a href="#BivariateStatistics.summary_fig_inset-700"><span class="linenos">700</span></a>            <span class="n">ha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;horizontalalignment&#39;</span><span class="p">]</span>
+</span><span id="BivariateStatistics.summary_fig_inset-701"><a href="#BivariateStatistics.summary_fig_inset-701"><span class="linenos">701</span></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-702"><a href="#BivariateStatistics.summary_fig_inset-702"><span class="linenos">702</span></a>            <span class="k">pass</span>
+</span><span id="BivariateStatistics.summary_fig_inset-703"><a href="#BivariateStatistics.summary_fig_inset-703"><span class="linenos">703</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-704"><a href="#BivariateStatistics.summary_fig_inset-704"><span class="linenos">704</span></a>        <span class="c1"># For right alignment, align on values first</span>
+</span><span id="BivariateStatistics.summary_fig_inset-705"><a href="#BivariateStatistics.summary_fig_inset-705"><span class="linenos">705</span></a>        <span class="c1"># Otherwise, align on labels</span>
+</span><span id="BivariateStatistics.summary_fig_inset-706"><a href="#BivariateStatistics.summary_fig_inset-706"><span class="linenos">706</span></a>        <span class="k">if</span> <span class="n">ha</span><span class="o">==</span><span class="s1">&#39;right&#39;</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-707"><a href="#BivariateStatistics.summary_fig_inset-707"><span class="linenos">707</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">value_text</span>
+</span><span id="BivariateStatistics.summary_fig_inset-708"><a href="#BivariateStatistics.summary_fig_inset-708"><span class="linenos">708</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">label_text</span>
+</span><span id="BivariateStatistics.summary_fig_inset-709"><a href="#BivariateStatistics.summary_fig_inset-709"><span class="linenos">709</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
+</span><span id="BivariateStatistics.summary_fig_inset-710"><a href="#BivariateStatistics.summary_fig_inset-710"><span class="linenos">710</span></a>        <span class="k">else</span><span class="p">:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-711"><a href="#BivariateStatistics.summary_fig_inset-711"><span class="linenos">711</span></a>            <span class="n">first_text</span> <span class="o">=</span> <span class="n">label_text</span>
+</span><span id="BivariateStatistics.summary_fig_inset-712"><a href="#BivariateStatistics.summary_fig_inset-712"><span class="linenos">712</span></a>            <span class="n">second_text</span> <span class="o">=</span> <span class="n">value_text</span>
+</span><span id="BivariateStatistics.summary_fig_inset-713"><a href="#BivariateStatistics.summary_fig_inset-713"><span class="linenos">713</span></a>            <span class="n">sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
+</span><span id="BivariateStatistics.summary_fig_inset-714"><a href="#BivariateStatistics.summary_fig_inset-714"><span class="linenos">714</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-715"><a href="#BivariateStatistics.summary_fig_inset-715"><span class="linenos">715</span></a>        <span class="c1"># Add first column of text</span>
+</span><span id="BivariateStatistics.summary_fig_inset-716"><a href="#BivariateStatistics.summary_fig_inset-716"><span class="linenos">716</span></a>        <span class="n">t1</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
+</span><span id="BivariateStatistics.summary_fig_inset-717"><a href="#BivariateStatistics.summary_fig_inset-717"><span class="linenos">717</span></a>                <span class="n">first_text</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-718"><a href="#BivariateStatistics.summary_fig_inset-718"><span class="linenos">718</span></a>                <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-719"><a href="#BivariateStatistics.summary_fig_inset-719"><span class="linenos">719</span></a>                <span class="o">**</span><span class="n">kwargs</span>
+</span><span id="BivariateStatistics.summary_fig_inset-720"><a href="#BivariateStatistics.summary_fig_inset-720"><span class="linenos">720</span></a>                <span class="p">)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-721"><a href="#BivariateStatistics.summary_fig_inset-721"><span class="linenos">721</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-722"><a href="#BivariateStatistics.summary_fig_inset-722"><span class="linenos">722</span></a>        <span class="c1"># Get width of first text column</span>
+</span><span id="BivariateStatistics.summary_fig_inset-723"><a href="#BivariateStatistics.summary_fig_inset-723"><span class="linenos">723</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">t1</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
+</span><span id="BivariateStatistics.summary_fig_inset-724"><a href="#BivariateStatistics.summary_fig_inset-724"><span class="linenos">724</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span><span class="o">-</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span>
 </span><span id="BivariateStatistics.summary_fig_inset-725"><a href="#BivariateStatistics.summary_fig_inset-725"><span class="linenos">725</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-726"><a href="#BivariateStatistics.summary_fig_inset-726"><span class="linenos">726</span></a>        <span class="c1"># if isinstance(loc,(tuple,list)):</span>
-</span><span id="BivariateStatistics.summary_fig_inset-727"><a href="#BivariateStatistics.summary_fig_inset-727"><span class="linenos">727</span></a>        <span class="c1">#     # Create an inset axis to contain the table</span>
-</span><span id="BivariateStatistics.summary_fig_inset-728"><a href="#BivariateStatistics.summary_fig_inset-728"><span class="linenos">728</span></a>        <span class="c1">#     tableaxis = ax.inset_axes(loc)</span>
-</span><span id="BivariateStatistics.summary_fig_inset-729"><a href="#BivariateStatistics.summary_fig_inset-729"><span class="linenos">729</span></a>        <span class="c1">#     table_width=1</span>
-</span><span id="BivariateStatistics.summary_fig_inset-730"><a href="#BivariateStatistics.summary_fig_inset-730"><span class="linenos">730</span></a>        <span class="c1"># else:</span>
-</span><span id="BivariateStatistics.summary_fig_inset-731"><a href="#BivariateStatistics.summary_fig_inset-731"><span class="linenos">731</span></a>        <span class="c1">#     tableaxis = ax</span>
+</span><span id="BivariateStatistics.summary_fig_inset-726"><a href="#BivariateStatistics.summary_fig_inset-726"><span class="linenos">726</span></a>        <span class="c1"># Add second column of text</span>
+</span><span id="BivariateStatistics.summary_fig_inset-727"><a href="#BivariateStatistics.summary_fig_inset-727"><span class="linenos">727</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">width</span><span class="o">*</span><span class="n">sign</span><span class="p">,</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
+</span><span id="BivariateStatistics.summary_fig_inset-728"><a href="#BivariateStatistics.summary_fig_inset-728"><span class="linenos">728</span></a>                     <span class="n">second_text</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-729"><a href="#BivariateStatistics.summary_fig_inset-729"><span class="linenos">729</span></a>                     <span class="n">transform</span><span class="o">=</span><span class="n">coord</span><span class="p">,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-730"><a href="#BivariateStatistics.summary_fig_inset-730"><span class="linenos">730</span></a>                     <span class="o">**</span><span class="n">kwargs</span>
+</span><span id="BivariateStatistics.summary_fig_inset-731"><a href="#BivariateStatistics.summary_fig_inset-731"><span class="linenos">731</span></a>                     <span class="p">)</span>
 </span><span id="BivariateStatistics.summary_fig_inset-732"><a href="#BivariateStatistics.summary_fig_inset-732"><span class="linenos">732</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-733"><a href="#BivariateStatistics.summary_fig_inset-733"><span class="linenos">733</span></a>        <span class="c1"># # Display the table on the axis</span>
-</span><span id="BivariateStatistics.summary_fig_inset-734"><a href="#BivariateStatistics.summary_fig_inset-734"><span class="linenos">734</span></a>        <span class="c1"># return mtable.table(</span>
-</span><span id="BivariateStatistics.summary_fig_inset-735"><a href="#BivariateStatistics.summary_fig_inset-735"><span class="linenos">735</span></a>        <span class="c1">#     tableaxis,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-736"><a href="#BivariateStatistics.summary_fig_inset-736"><span class="linenos">736</span></a>        <span class="c1">#     cellText=[[floatformat.format(value)] for value in summarydict.values()],</span>
-</span><span id="BivariateStatistics.summary_fig_inset-737"><a href="#BivariateStatistics.summary_fig_inset-737"><span class="linenos">737</span></a>        <span class="c1">#     rowLabels=[texify_name(key) for key in summarydict],</span>
-</span><span id="BivariateStatistics.summary_fig_inset-738"><a href="#BivariateStatistics.summary_fig_inset-738"><span class="linenos">738</span></a>        <span class="c1">#     colWidths=[table_width/2]*2,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-739"><a href="#BivariateStatistics.summary_fig_inset-739"><span class="linenos">739</span></a>        <span class="c1">#     edges=edges,</span>
-</span><span id="BivariateStatistics.summary_fig_inset-740"><a href="#BivariateStatistics.summary_fig_inset-740"><span class="linenos">740</span></a>        <span class="c1">#     loc=loc, bbox=bbox</span>
-</span><span id="BivariateStatistics.summary_fig_inset-741"><a href="#BivariateStatistics.summary_fig_inset-741"><span class="linenos">741</span></a>        <span class="c1">#     )</span>
+</span><span id="BivariateStatistics.summary_fig_inset-733"><a href="#BivariateStatistics.summary_fig_inset-733"><span class="linenos">733</span></a>        <span class="c1">##################################</span>
+</span><span id="BivariateStatistics.summary_fig_inset-734"><a href="#BivariateStatistics.summary_fig_inset-734"><span class="linenos">734</span></a>        <span class="c1"># Early version of this function using matplotlib.table.table()</span>
+</span><span id="BivariateStatistics.summary_fig_inset-735"><a href="#BivariateStatistics.summary_fig_inset-735"><span class="linenos">735</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-736"><a href="#BivariateStatistics.summary_fig_inset-736"><span class="linenos">736</span></a>        <span class="c1"># if isinstance(loc,(tuple,list)):</span>
+</span><span id="BivariateStatistics.summary_fig_inset-737"><a href="#BivariateStatistics.summary_fig_inset-737"><span class="linenos">737</span></a>        <span class="c1">#     # Create an inset axis to contain the table</span>
+</span><span id="BivariateStatistics.summary_fig_inset-738"><a href="#BivariateStatistics.summary_fig_inset-738"><span class="linenos">738</span></a>        <span class="c1">#     tableaxis = ax.inset_axes(loc)</span>
+</span><span id="BivariateStatistics.summary_fig_inset-739"><a href="#BivariateStatistics.summary_fig_inset-739"><span class="linenos">739</span></a>        <span class="c1">#     table_width=1</span>
+</span><span id="BivariateStatistics.summary_fig_inset-740"><a href="#BivariateStatistics.summary_fig_inset-740"><span class="linenos">740</span></a>        <span class="c1"># else:</span>
+</span><span id="BivariateStatistics.summary_fig_inset-741"><a href="#BivariateStatistics.summary_fig_inset-741"><span class="linenos">741</span></a>        <span class="c1">#     tableaxis = ax</span>
 </span><span id="BivariateStatistics.summary_fig_inset-742"><a href="#BivariateStatistics.summary_fig_inset-742"><span class="linenos">742</span></a>
-</span><span id="BivariateStatistics.summary_fig_inset-743"><a href="#BivariateStatistics.summary_fig_inset-743"><span class="linenos">743</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">]</span>
+</span><span id="BivariateStatistics.summary_fig_inset-743"><a href="#BivariateStatistics.summary_fig_inset-743"><span class="linenos">743</span></a>        <span class="c1"># # Display the table on the axis</span>
+</span><span id="BivariateStatistics.summary_fig_inset-744"><a href="#BivariateStatistics.summary_fig_inset-744"><span class="linenos">744</span></a>        <span class="c1"># return mtable.table(</span>
+</span><span id="BivariateStatistics.summary_fig_inset-745"><a href="#BivariateStatistics.summary_fig_inset-745"><span class="linenos">745</span></a>        <span class="c1">#     tableaxis,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-746"><a href="#BivariateStatistics.summary_fig_inset-746"><span class="linenos">746</span></a>        <span class="c1">#     cellText=[[floatformat.format(value)] for value in summarydict.values()],</span>
+</span><span id="BivariateStatistics.summary_fig_inset-747"><a href="#BivariateStatistics.summary_fig_inset-747"><span class="linenos">747</span></a>        <span class="c1">#     rowLabels=[texify_name(key) for key in summarydict],</span>
+</span><span id="BivariateStatistics.summary_fig_inset-748"><a href="#BivariateStatistics.summary_fig_inset-748"><span class="linenos">748</span></a>        <span class="c1">#     colWidths=[table_width/2]*2,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-749"><a href="#BivariateStatistics.summary_fig_inset-749"><span class="linenos">749</span></a>        <span class="c1">#     edges=edges,</span>
+</span><span id="BivariateStatistics.summary_fig_inset-750"><a href="#BivariateStatistics.summary_fig_inset-750"><span class="linenos">750</span></a>        <span class="c1">#     loc=loc, bbox=bbox</span>
+</span><span id="BivariateStatistics.summary_fig_inset-751"><a href="#BivariateStatistics.summary_fig_inset-751"><span class="linenos">751</span></a>        <span class="c1">#     )</span>
+</span><span id="BivariateStatistics.summary_fig_inset-752"><a href="#BivariateStatistics.summary_fig_inset-752"><span class="linenos">752</span></a>
+</span><span id="BivariateStatistics.summary_fig_inset-753"><a href="#BivariateStatistics.summary_fig_inset-753"><span class="linenos">753</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">]</span>
 </span></pre></div>
 
 
             <div class="docstring"><p>Display bivariate statistics as a table inset on a plot axis</p>
 
 <h6 id="parameters">Parameters</h6>
```

#### html2text {}

```diff
@@ -224,584 +224,595 @@
 _1_9_7        mean of x and y variables
 _1_9_8    xmedian, ymedian :float
 _1_9_9        median of x and y variables
 _2_0_0    xstd, ystd : float
 _2_0_1        standard deviation of x and y variables
 _2_0_2    mean_difference, md : float
 _2_0_3        ymean - xmean
-_2_0_4    mean_absolute_difference, mad : float
-_2_0_5        mean( |y-x| )
-_2_0_6    relative_mean_difference, rmd : float
-_2_0_7        md / xmean
-_2_0_8    relative_mean_absolute_difference, rmad :float
-_2_0_9        mad / xmean
-_2_1_0    standardized_mean_difference, smd : float
-_2_1_1        md / xstd
-_2_1_2    standardized_mean_absolute_difference, smad : float
-_2_1_3        mad /xstd
-_2_1_4    mean_relative_difference, mrd : float
-_2_1_5        mean(y/x) - 1
-_2_1_6    mean_log10_ratio, mlr : float
-_2_1_7        mean( log10(y/x) )
-_2_1_8    mean_absolute_log10_ratio, malr : float
-_2_1_9        mean( abs( log10(y/x) ) )
-_2_2_0    median_difference, medd : float
-_2_2_1        median(y-x)
-_2_2_2    median_absolute_difference, medad : float
-_2_2_3        median(|y-x|)
-_2_2_4    relative_median_difference, rmedd : float
-_2_2_5        median(y-x) / xmedian
-_2_2_6    relative_median_absolute_difference, rmedad : float
-_2_2_7        median(|y-x|) / xmedian
-_2_2_8    median_relative_difference, medianrd, medrd : float
-_2_2_9        median(y/x)-1
-_2_3_0    median_log10_ratio, medlr : float
-_2_3_1        median( log10(y/x) )
-_2_3_2    median_absolute_log10_ratio, medalr : float
-_2_3_3        median( abs( log10(y/x) ) )
-_2_3_4    normalized_mean_bias_factor, nmbf : float
-_2_3_5        see `nmbf`
-_2_3_6    normalized_mean_absolute_error_factor, nmaef : float
-_2_3_7        see `nmaef`
-_2_3_8    root_mean_square_difference, rmsd : float
-_2_3_9        $\\sqrt{ \\langle (y - x)^2 \\rangle }$
-_2_4_0    covariance : float
-_2_4_1        cov(x,y)
-_2_4_2    correlation_pearson, correlation, pearsonr, R, r : float
-_2_4_3        Pearson linear correlation coefficient
-_2_4_4    correlation_spearman, spearmanr : float
-_2_4_5        Spearman, non-parametric rank correlation coefficient
-_2_4_6    R2, r2 : float
-_2_4_7        Linear coefficient of determination, $R^2$
-_2_4_8    '''
-_2_4_9
-_2_5_0    def __init__(self,x,y,w=None,dropna=False,data=None):
-_2_5_1        '''Compute suite of bivariate statistics during initialization
-_2_5_2
-_2_5_3        Statistic values are saved in attributes.
-_2_5_4        CAUTION: Weights w are ignored except in SMA fit
+_2_0_4    std_difference, stdd : float
+_2_0_5        std( y - x )
+_2_0_6    mean_absolute_difference, mad : float
+_2_0_7        mean( |y-x| )
+_2_0_8    relative_mean_difference, rmd : float
+_2_0_9        md / xmean
+_2_1_0    relative_mean_absolute_difference, rmad :float
+_2_1_1        mad / xmean
+_2_1_2    standardized_mean_difference, smd : float
+_2_1_3        md / xstd
+_2_1_4    standardized_mean_absolute_difference, smad : float
+_2_1_5        mad /xstd
+_2_1_6    mean_relative_difference, mrd : float
+_2_1_7        mean(y/x) - 1
+_2_1_8    mean_log10_ratio, mlr : float
+_2_1_9        mean( log10(y/x) )
+_2_2_0    std_log10_ratio, stdlr : float
+_2_2_1        std( log10(y/x) )
+_2_2_2    mean_absolute_log10_ratio, malr : float
+_2_2_3        mean( abs( log10(y/x) ) )
+_2_2_4    median_difference, medd : float
+_2_2_5        median(y-x)
+_2_2_6    median_absolute_difference, medad : float
+_2_2_7        median(|y-x|)
+_2_2_8    relative_median_difference, rmedd : float
+_2_2_9        median(y-x) / xmedian
+_2_3_0    relative_median_absolute_difference, rmedad : float
+_2_3_1        median(|y-x|) / xmedian
+_2_3_2    median_relative_difference, medianrd, medrd : float
+_2_3_3        median(y/x)-1
+_2_3_4    median_log10_ratio, medlr : float
+_2_3_5        median( log10(y/x) )
+_2_3_6    median_absolute_log10_ratio, medalr : float
+_2_3_7        median( abs( log10(y/x) ) )
+_2_3_8    normalized_mean_bias_factor, nmbf : float
+_2_3_9        see `nmbf`
+_2_4_0    normalized_mean_absolute_error_factor, nmaef : float
+_2_4_1        see `nmaef`
+_2_4_2    root_mean_square_difference, rmsd : float
+_2_4_3        $\\sqrt{ \\langle (y - x)^2 \\rangle }$
+_2_4_4    root_mean_square_log10_ratio, rmslr : float
+_2_4_5        $\\sqrt{ \\langle log10(y/x)^2 \\rangle }$
+_2_4_6    covariance : float
+_2_4_7        cov(x,y)
+_2_4_8    correlation_pearson, correlation, pearsonr, R, r : float
+_2_4_9        Pearson linear correlation coefficient
+_2_5_0    correlation_spearman, spearmanr : float
+_2_5_1        Spearman, non-parametric rank correlation coefficient
+_2_5_2    R2, r2 : float
+_2_5_3        Linear coefficient of determination, $R^2$
+_2_5_4    '''
 _2_5_5
-_2_5_6        Parameters
-_2_5_7        ----------
-_2_5_8        x : ndarray or str
-_2_5_9            independent variable values
-_2_6_0        y : ndarray or str
-_2_6_1            dependent variable values, same size as x
-_2_6_2        w : ndarray or str, optional
-_2_6_3            weights for points (x,y), same size as x and y
-_2_6_4        dropna : bool, optional (default=False)
-_2_6_5            drops NaN values from x, y, and w
-_2_6_6        data : dict-like, optional
-_2_6_7            if x, y, or w are str, then they should be keys in data
-_2_6_8        '''
-_2_6_9
-_2_7_0        # Get values from data if needed
-_2_7_1        if data is None and (isinstance(x,str) or isinstance(y,str) or
+_2_5_6    def __init__(self,x,y,w=None,dropna=False,data=None):
+_2_5_7        '''Compute suite of bivariate statistics during initialization
+_2_5_8
+_2_5_9        Statistic values are saved in attributes.
+_2_6_0        CAUTION: Weights w are ignored except in SMA fit
+_2_6_1
+_2_6_2        Parameters
+_2_6_3        ----------
+_2_6_4        x : ndarray or str
+_2_6_5            independent variable values
+_2_6_6        y : ndarray or str
+_2_6_7            dependent variable values, same size as x
+_2_6_8        w : ndarray or str, optional
+_2_6_9            weights for points (x,y), same size as x and y
+_2_7_0        dropna : bool, optional (default=False)
+_2_7_1            drops NaN values from x, y, and w
+_2_7_2        data : dict-like, optional
+_2_7_3            if x, y, or w are str, then they should be keys in data
+_2_7_4        '''
+_2_7_5
+_2_7_6        # Get values from data if needed
+_2_7_7        if data is None and (isinstance(x,str) or isinstance(y,str) or
 isinstance(w,str)):
-_2_7_2            raise ValueError( 'Data argument must be used if x, y, or w is a
+_2_7_8            raise ValueError( 'Data argument must be used if x, y, or w is a
 string')
-_2_7_3        if isinstance(x,str):
-_2_7_4            x = data[x]
-_2_7_5        if isinstance(y,str):
-_2_7_6            y = data[y]
-_2_7_7        if isinstance(w,str):
-_2_7_8            w = data[w]
-_2_7_9
-_2_8_0        #Ensure that x and y have same length
-_2_8_1        if len(x) != len(y):
-_2_8_2            raise ValueError( 'Arguments x and y must have the same length'
+_2_7_9        if isinstance(x,str):
+_2_8_0            x = data[x]
+_2_8_1        if isinstance(y,str):
+_2_8_2            y = data[y]
+_2_8_3        if isinstance(w,str):
+_2_8_4            w = data[w]
+_2_8_5
+_2_8_6        #Ensure that x and y have same length
+_2_8_7        if len(x) != len(y):
+_2_8_8            raise ValueError( 'Arguments x and y must have the same length'
 )
-_2_8_3        if w is None:
-_2_8_4            w = np.ones_like(x)
-_2_8_5        if len(w) != len(x):
-_2_8_6            raise ValueError( 'Argument w (if present) must have the same
+_2_8_9        if w is None:
+_2_9_0            w = np.ones_like(x)
+_2_9_1        if len(w) != len(x):
+_2_9_2            raise ValueError( 'Argument w (if present) must have the same
 length as x' )
-_2_8_7
-_2_8_8        # Drop NaN values
-_2_8_9        if dropna:
-_2_9_0            isna = np.isnan(x*y*w)
-_2_9_1            x = x[~isna]
-_2_9_2            y = y[~isna]
-_2_9_3            w = w[~isna]
-_2_9_4
-_2_9_5        # Differences and ratios used repeatedly
-_2_9_6        diff = y - x
-_2_9_7        absdiff = np.abs( y - x )
-_2_9_8        # Ignore divide by zero and 0/0 while dividing
-_2_9_9        old_settings = np.seterr(divide='ignore',invalid='ignore')
-_3_0_0        ratio = y/x
-_3_0_1        log10ratio = np.log10(ratio)
-_3_0_2        np.seterr(**old_settings)
-_3_0_3
-_3_0_4        # Number of data points
-_3_0_5        self.count = self.n = len(x)
-_3_0_6
-_3_0_7        # Means, medians, and standard deviations
-_3_0_8        self.xmean = np.mean(x)
-_3_0_9        self.ymean = np.mean(y)
-_3_1_0        self.xmedian = np.median(x)
-_3_1_1        self.ymedian = np.median(y)
-_3_1_2        self.xstd   = np.std(x)
-_3_1_3        self.ystd   = np.std(y)
-_3_1_4
-_3_1_5        # Save values for use later
-_3_1_6        self._x = x
-_3_1_7        self._y = y
-_3_1_8        self._w = w
-_3_1_9
-_3_2_0        # Mean and mean absolute differences
-_3_2_1        self.mean_difference            = self.md   = self.ymean -
+_2_9_3
+_2_9_4        # Drop NaN values
+_2_9_5        if dropna:
+_2_9_6            isna = np.isnan(x*y*w)
+_2_9_7            x = x[~isna]
+_2_9_8            y = y[~isna]
+_2_9_9            w = w[~isna]
+_3_0_0
+_3_0_1        # Differences and ratios used repeatedly
+_3_0_2        diff = y - x
+_3_0_3        absdiff = np.abs( y - x )
+_3_0_4        # Ignore divide by zero and 0/0 while dividing
+_3_0_5        old_settings = np.seterr(divide='ignore',invalid='ignore')
+_3_0_6        ratio = y/x
+_3_0_7        log10ratio = np.log10(ratio)
+_3_0_8        np.seterr(**old_settings)
+_3_0_9
+_3_1_0        # Number of data points
+_3_1_1        self.count = self.n = len(x)
+_3_1_2
+_3_1_3        # Means, medians, and standard deviations
+_3_1_4        self.xmean = np.mean(x)
+_3_1_5        self.ymean = np.mean(y)
+_3_1_6        self.xmedian = np.median(x)
+_3_1_7        self.ymedian = np.median(y)
+_3_1_8        self.xstd   = np.std(x)
+_3_1_9        self.ystd   = np.std(y)
+_3_2_0
+_3_2_1        # Save values for use later
+_3_2_2        self._x = x
+_3_2_3        self._y = y
+_3_2_4        self._w = w
+_3_2_5
+_3_2_6        # Mean and mean absolute differences
+_3_2_7        self.mean_difference            = self.md   = self.ymean -
 self.xmean
-_3_2_2        self.mean_absolute_difference   = self.mad  = np.mean( absdiff )
-_3_2_3
-_3_2_4        # Relative and standardized differences
-_3_2_5        self.relative_mean_difference           = self.rmd  =
+_3_2_8        self.mean_absolute_difference   = self.mad  = np.mean( absdiff )
+_3_2_9        self.std_difference             = self.stdd = np.std( diff )
+_3_3_0
+_3_3_1        # Relative and standardized differences
+_3_3_2        self.relative_mean_difference           = self.rmd  =
 self.mean_difference / self.xmean
-_3_2_6        self.relative_mean_absolute_difference  = self.rmad =
+_3_3_3        self.relative_mean_absolute_difference  = self.rmad =
 self.mean_absolute_difference / self.xmean
-_3_2_7        self.standardized_mean_difference       = self.smd  =
+_3_3_4        self.standardized_mean_difference       = self.smd  =
 self.mean_difference / self.xstd
-_3_2_8        self.standardized_mean_absolute_difference  = self.smad =
+_3_3_5        self.standardized_mean_absolute_difference  = self.smad =
 self.mean_absolute_difference / self.xstd
-_3_2_9
-_3_3_0        # Mean and median relative differences
-_3_3_1        self.mean_relative_difference   = self.mrd  = np.mean( ratio - 1 )
-_3_3_2        self.median_relative_difference = self.medianrd = self.medrd =
+_3_3_6
+_3_3_7        # Mean and median relative differences
+_3_3_8        self.mean_relative_difference   = self.mrd  = np.mean( ratio - 1 )
+_3_3_9        self.median_relative_difference = self.medianrd = self.medrd =
 np.median( ratio - 1 )
-_3_3_3
-_3_3_4        # Median and median absolute differences
-_3_3_5        self.median_difference          = self.medd  = np.median( diff )
-_3_3_6        self.median_absolute_difference = self.medad = np.median( absdiff )
-_3_3_7
-_3_3_8        # Relative median differences
-_3_3_9        self.relative_median_difference          = self.rmedd  =
+_3_4_0
+_3_4_1        # Median and median absolute differences
+_3_4_2        self.median_difference          = self.medd  = np.median( diff )
+_3_4_3        self.median_absolute_difference = self.medad = np.median( absdiff )
+_3_4_4
+_3_4_5        # Relative median differences
+_3_4_6        self.relative_median_difference          = self.rmedd  =
 self.median_difference / self.xmedian
-_3_4_0        self.relative_median_absolute_difference = self.rmedad =
+_3_4_7        self.relative_median_absolute_difference = self.rmedad =
 self.median_absolute_difference / self.xmedian
-_3_4_1
-_3_4_2        self.normalized_mean_bias_factor            = self.nmbf  = nmbf(x,y)
-_3_4_3        self.normalized_mean_absolute_error_factor  = self.nmaef = nmaef
+_3_4_8
+_3_4_9        self.normalized_mean_bias_factor            = self.nmbf  = nmbf(x,y)
+_3_5_0        self.normalized_mean_absolute_error_factor  = self.nmaef = nmaef
 (x,y)
-_3_4_4
-_3_4_5        # Mean and mean absolute log ratio
-_3_4_6        self.mean_log10_ratio          = self.mlr  = np.mean( log10ratio )
-_3_4_7        self.mean_absolute_log10_ratio = self.malr = np.mean( np.abs
+_3_5_1
+_3_5_2        # Mean and mean absolute log ratio
+_3_5_3        self.mean_log10_ratio          = self.mlr  = np.mean( log10ratio )
+_3_5_4        self.mean_absolute_log10_ratio = self.malr = np.mean( np.abs
 ( log10ratio ) )
-_3_4_8
-_3_4_9        # Median and median absolute log ratio
-_3_5_0        self.median_log10_ratio          = self.medlr  = np.median
+_3_5_5        self.std_log10_ratio           = self.stdlr= np.std( log10ratio )
+_3_5_6
+_3_5_7        # Median and median absolute log ratio
+_3_5_8        self.median_log10_ratio          = self.medlr  = np.median
 ( log10ratio )
-_3_5_1        self.median_absolute_log10_ratio = self.medalr = np.median( np.abs
+_3_5_9        self.median_absolute_log10_ratio = self.medalr = np.median( np.abs
 ( log10ratio ) )
-_3_5_2
-_3_5_3        # RMS difference
-_3_5_4        self.root_mean_square_difference    = self.rmsd     = np.sqrt
-( np.mean( np.power( diff, 2) ) )
-_3_5_5
-_3_5_6        # Covariance, correlation
-_3_5_7        self.covariance = np.cov(x,y)[0][1]
-_3_5_8        self.correlation = self.correlation_pearson = self.R = self.r =
+_3_6_0
+_3_6_1        # RMS difference
+_3_6_2        self.root_mean_square_difference = self.rmsd   = np.sqrt( np.mean
+( np.power( diff, 2) ) )
+_3_6_3        # RMS log ratio
+_3_6_4        self.root_mean_square_log10_ratio = self.rmslr = np.sqrt( np.mean
+( np.power( log10ratio, 2 )))
+_3_6_5
+_3_6_6        # Covariance, correlation
+_3_6_7        self.covariance = np.cov(x,y)[0][1]
+_3_6_8        self.correlation = self.correlation_pearson = self.R = self.r =
 self.pearsonr = \
-_3_5_9            np.corrcoef(x,y)[0][1]
-_3_6_0        self.correlation_spearman = self.spearmanr = stats.spearmanr
+_3_6_9            np.corrcoef(x,y)[0][1]
+_3_7_0        self.correlation_spearman = self.spearmanr = stats.spearmanr
 (x,y).statistic
-_3_6_1        self.R2 = self.r2 = self.R**2
-_3_6_2
-_3_6_3    def __getitem__(self,key):
-_3_6_4        '''Accesses attribute values via object['key']'''
-_3_6_5        return getattr(self,key)
-_3_6_6
-_3_6_7    def fitline(self,method='sma',intercept=True,**kwargs):
-_3_6_8        '''Compute bivariate line fit
-_3_6_9
-_3_7_0        Parameters
-_3_7_1        ----------
-_3_7_2        method : str
-_3_7_3            line fitting method: sma (default), ols, wls, York, sen, siegel
-_3_7_4        intercept : bool
-_3_7_5            defines whether non-zero intercept should be fitted
-_3_7_6        **kwargs
-_3_7_7            passed to `acgc.stats.sma` (e.g. robust=True)
-_3_7_8
-_3_7_9        Returns
-_3_8_0        -------
-_3_8_1        result : dict
-_3_8_2            dictionary with keys:
-_3_8_3            - slope (float)
-_3_8_4                slope of fitted line
-_3_8_5            - intercept (float)
-_3_8_6                intercept of fitted line
-_3_8_7            - fittedvalues (array (N,))
-_3_8_8                values on fit line
-_3_8_9            - residuals (array (N,))
-_3_9_0                residual from fit line
-_3_9_1        '''
-_3_9_2
-_3_9_3        fitintercept = intercept
-_3_9_4
-_3_9_5        if method.lower()=='sma':
-_3_9_6            fit = sma(  self._x,
-_3_9_7                        self._y,
-_3_9_8                        self._w,
-_3_9_9                        intercept=fitintercept,
-_4_0_0                        **kwargs)
-_4_0_1            slope = fit['slope']
-_4_0_2            intercept= fit['intercept']
-_4_0_3
-_4_0_4        elif method.lower()=='ols':
-_4_0_5            if fitintercept:
-_4_0_6                ols = np.linalg.lstsq( np.vstack([self._x,np.ones(len
+_3_7_1        self.R2 = self.r2 = self.R**2
+_3_7_2
+_3_7_3    def __getitem__(self,key):
+_3_7_4        '''Accesses attribute values via object['key']'''
+_3_7_5        return getattr(self,key)
+_3_7_6
+_3_7_7    def fitline(self,method='sma',intercept=True,**kwargs):
+_3_7_8        '''Compute bivariate line fit
+_3_7_9
+_3_8_0        Parameters
+_3_8_1        ----------
+_3_8_2        method : str
+_3_8_3            line fitting method: sma (default), ols, wls, York, sen, siegel
+_3_8_4        intercept : bool
+_3_8_5            defines whether non-zero intercept should be fitted
+_3_8_6        **kwargs
+_3_8_7            passed to `acgc.stats.sma` (e.g. robust=True)
+_3_8_8
+_3_8_9        Returns
+_3_9_0        -------
+_3_9_1        result : dict
+_3_9_2            dictionary with keys:
+_3_9_3            - slope (float)
+_3_9_4                slope of fitted line
+_3_9_5            - intercept (float)
+_3_9_6                intercept of fitted line
+_3_9_7            - fittedvalues (array (N,))
+_3_9_8                values on fit line
+_3_9_9            - residuals (array (N,))
+_4_0_0                residual from fit line
+_4_0_1        '''
+_4_0_2
+_4_0_3        fitintercept = intercept
+_4_0_4
+_4_0_5        if method.lower()=='sma':
+_4_0_6            fit = sma(  self._x,
+_4_0_7                        self._y,
+_4_0_8                        self._w,
+_4_0_9                        intercept=fitintercept,
+_4_1_0                        **kwargs)
+_4_1_1            slope = fit['slope']
+_4_1_2            intercept= fit['intercept']
+_4_1_3
+_4_1_4        elif method.lower()=='ols':
+_4_1_5            if fitintercept:
+_4_1_6                ols = np.linalg.lstsq( np.vstack([self._x,np.ones(len
 (self._x))]).T,
-_4_0_7                                      self._y, rcond=None )
-_4_0_8            else:
-_4_0_9                ols = np.linalg.lstsq( np.vstack([self._x]).T, self._y,
+_4_1_7                                      self._y, rcond=None )
+_4_1_8            else:
+_4_1_9                ols = np.linalg.lstsq( np.vstack([self._x]).T, self._y,
 rcond=None )
-_4_1_0            slope = ols[0][0]
-_4_1_1            intercept = ols[0][1]
-_4_1_2
-_4_1_3        elif method.lower() in ['theil','sen','theilsen']:
-_4_1_4            fitintercept = True
-_4_1_5            fit = sen( self._x,
-_4_1_6                       self._y,
-_4_1_7                       **kwargs)
-_4_1_8            slope = fit.slope
-_4_1_9            intercept = fit.intercept
-_4_2_0
-_4_2_1        elif method.lower()=='siegel':
-_4_2_2            fitintercept = True
-_4_2_3            siegel = stats.siegelslopes( self._x,
-_4_2_4                                         self._y )
-_4_2_5            slope = siegel.slope
-_4_2_6            intercept = siegel.intercept
-_4_2_7
-_4_2_8        elif method.lower()=='wls':
-_4_2_9            raise NotImplementedError('WLS regression not implemented yet')
+_4_2_0            slope = ols[0][0]
+_4_2_1            intercept = ols[0][1]
+_4_2_2
+_4_2_3        elif method.lower() in ['theil','sen','theilsen']:
+_4_2_4            fitintercept = True
+_4_2_5            fit = sen( self._x,
+_4_2_6                       self._y,
+_4_2_7                       **kwargs)
+_4_2_8            slope = fit.slope
+_4_2_9            intercept = fit.intercept
 _4_3_0
-_4_3_1        elif method.lower()=='york':
-_4_3_2            raise NotImplementedError('York regression not implemented yet')
-_4_3_3
-_4_3_4        else:
-_4_3_5            raise ValueError('Undefined method '+method)
-_4_3_6
-_4_3_7        line = dict( slope          = slope,
-_4_3_8                     intercept      = intercept,
-_4_3_9                     fittedvalues   = slope * self._x + intercept,
-_4_4_0                     residuals      = self._y - ( slope * self._x +
-intercept ),
-_4_4_1                     method         = method,
-_4_4_2                     fitintercept   = fitintercept )
+_4_3_1        elif method.lower()=='siegel':
+_4_3_2            fitintercept = True
+_4_3_3            siegel = stats.siegelslopes( self._x,
+_4_3_4                                         self._y )
+_4_3_5            slope = siegel.slope
+_4_3_6            intercept = siegel.intercept
+_4_3_7
+_4_3_8        elif method.lower()=='wls':
+_4_3_9            raise NotImplementedError('WLS regression not implemented yet')
+_4_4_0
+_4_4_1        elif method.lower()=='york':
+_4_4_2            raise NotImplementedError('York regression not implemented yet')
 _4_4_3
-_4_4_4        return line
-_4_4_5
-_4_4_6    def slope(self,method='sma',intercept=True,**kwargs):
-_4_4_7        '''Compute slope of bivariate line fit
-_4_4_8
-_4_4_9        Parameters
-_4_5_0        ----------
-_4_5_1        method : str
-_4_5_2            line fitting method: sma (default), ols, wls
-_4_5_3        intercept : bool
-_4_5_4            defines whether non-zero intercept should be fitted
-_4_5_5        **kwargs
-_4_5_6            passed to `fitline`
-_4_5_7
-_4_5_8        Returns
-_4_5_9        -------
-_4_6_0        slope : float
-_4_6_1            value of y intercept
-_4_6_2        '''
-_4_6_3        return self.fitline(method,intercept,**kwargs)['slope']
-_4_6_4
-_4_6_5    def intercept(self,method='sma',intercept=True,**kwargs):
-_4_6_6        '''Compute intercept of bivariate line fit
+_4_4_4        else:
+_4_4_5            raise ValueError('Undefined method '+method)
+_4_4_6
+_4_4_7        line = dict( slope          = slope,
+_4_4_8                     intercept      = intercept,
+_4_4_9                     fittedvalues   = slope * self._x + intercept,
+_4_5_0                     residuals      = self._y - ( slope * self._x +
+intercept ),
+_4_5_1                     method         = method,
+_4_5_2                     fitintercept   = fitintercept )
+_4_5_3
+_4_5_4        return line
+_4_5_5
+_4_5_6    def slope(self,method='sma',intercept=True,**kwargs):
+_4_5_7        '''Compute slope of bivariate line fit
+_4_5_8
+_4_5_9        Parameters
+_4_6_0        ----------
+_4_6_1        method : str
+_4_6_2            line fitting method: sma (default), ols, wls
+_4_6_3        intercept : bool
+_4_6_4            defines whether non-zero intercept should be fitted
+_4_6_5        **kwargs
+_4_6_6            passed to `fitline`
 _4_6_7
-_4_6_8        Parameters
-_4_6_9        ----------
-_4_7_0        method : str
-_4_7_1            line fitting method: sma (default) or ols
-_4_7_2        intercept : bool
-_4_7_3            defines whether non-zero intercept should be fitted
-_4_7_4        **kwargs
-_4_7_5            passed to `fitline`
-_4_7_6
-_4_7_7        Returns
-_4_7_8        -------
-_4_7_9        intercept : float
-_4_8_0            value of y intercept
-_4_8_1        '''
-_4_8_2        return self.fitline(method,intercept,**kwargs)['intercept']
-_4_8_3
-_4_8_4    def _expand_variables(self,variables):
-_4_8_5        '''Expand special strings into a list of variables
+_4_6_8        Returns
+_4_6_9        -------
+_4_7_0        slope : float
+_4_7_1            value of y intercept
+_4_7_2        '''
+_4_7_3        return self.fitline(method,intercept,**kwargs)['slope']
+_4_7_4
+_4_7_5    def intercept(self,method='sma',intercept=True,**kwargs):
+_4_7_6        '''Compute intercept of bivariate line fit
+_4_7_7
+_4_7_8        Parameters
+_4_7_9        ----------
+_4_8_0        method : str
+_4_8_1            line fitting method: sma (default) or ols
+_4_8_2        intercept : bool
+_4_8_3            defines whether non-zero intercept should be fitted
+_4_8_4        **kwargs
+_4_8_5            passed to `fitline`
 _4_8_6
-_4_8_7        Parameter
-_4_8_8        ---------
-_4_8_9        variables : list or str, default='common'
-_4_9_0            Special strings ("all","common") will be expanded to a list of
+_4_8_7        Returns
+_4_8_8        -------
+_4_8_9        intercept : float
+_4_9_0            value of y intercept
+_4_9_1        '''
+_4_9_2        return self.fitline(method,intercept,**kwargs)['intercept']
+_4_9_3
+_4_9_4    def _expand_variables(self,variables):
+_4_9_5        '''Expand special strings into a list of variables
+_4_9_6
+_4_9_7        Parameter
+_4_9_8        ---------
+_4_9_9        variables : list or str, default='common'
+_5_0_0            Special strings ("all","common") will be expanded to a list of
 variables
-_4_9_1            list arguments will not be modified
-_4_9_2
-_4_9_3        Returns
-_4_9_4        -------
-_4_9_5        list
-_4_9_6            variable names
-_4_9_7        '''
-_4_9_8        if variables is None:
-_4_9_9            variables='common'
-_5_0_0        if variables=='all':
-_5_0_1            variables=['MD','MAD','RMD','RMAD','MRD','SMD','SMAD',
-_5_0_2                       'MLR','MALR',
-_5_0_3                       'MedD','MedAD','RMedD','RMedAD','MedRD',
-_5_0_4                       'MedLR','MedALR',
-_5_0_5                       'NMBF','NMAEF','RMSD','cov',
-_5_0_6                       'R','R2','spearmanr','slope','intercept',
-_5_0_7                       'fitline','n']
-_5_0_8        elif variables=='common':
-_5_0_9            variables=['MD','MAD','RMD','RMAD','MRD','R2','slope','n']
-_5_1_0        if not isinstance(variables,list):
-_5_1_1            raise ValueError(
-_5_1_2                'variables must be a list, None, or one of these strings:
+_5_0_1            list arguments will not be modified
+_5_0_2
+_5_0_3        Returns
+_5_0_4        -------
+_5_0_5        list
+_5_0_6            variable names
+_5_0_7        '''
+_5_0_8        if variables is None:
+_5_0_9            variables='common'
+_5_1_0        if variables=='all':
+_5_1_1            variables=['MD','MAD','RMD','RMAD','MRD','SMD','SMAD',
+_5_1_2                       'MLR','MALR',
+_5_1_3                       'MedD','MedAD','RMedD','RMedAD','MedRD',
+_5_1_4                       'MedLR','MedALR',
+_5_1_5                       'NMBF','NMAEF','RMSD','cov',
+_5_1_6                       'R','R2','spearmanr','slope','intercept',
+_5_1_7                       'fitline','n']
+_5_1_8        elif variables=='common':
+_5_1_9            variables=['MD','MAD','RMD','RMAD','MRD','R2','slope','n']
+_5_2_0        if not isinstance(variables,list):
+_5_2_1            raise ValueError(
+_5_2_2                'variables must be a list, None, or one of these strings:
 "all","common"')
-_5_1_3
-_5_1_4        return variables
-_5_1_5
-_5_1_6    def summary_dict(self, variables=None, fitline_kw=None,
+_5_2_3
+_5_2_4        return variables
+_5_2_5
+_5_2_6    def summary_dict(self, variables=None, fitline_kw=None,
 floatformat_fiteqn='{:.3f}'):
-_5_1_7        '''Summarize bivariate statistics into a dict
-_5_1_8
-_5_1_9        Parameters
-_5_2_0        ----------
-_5_2_1        vars : list or str, default='common'
-_5_2_2            names of attribute variables to include in summary
-_5_2_3            names are case insensitive
-_5_2_4            The following strings are also accepted in place of a list
-_5_2_5                "all" (displays all variables)
-_5_2_6                "common" (displays all measures of mean difference)
-_5_2_7        fitline_kw : dict, default=None
-_5_2_8            keywords passed to `fitline`
-_5_2_9        floatformat_fiteqn : str, default=floatformat
-_5_3_0            format specifier for slope and intercept (a,b) in y = a x + b
-_5_3_1
-_5_3_2        Returns
-_5_3_3        -------
-_5_3_4        summary : dict
-_5_3_5            names and values of variables
-_5_3_6        '''
-_5_3_7
-_5_3_8        # List of variables
-_5_3_9        variables = self._expand_variables(variables)
-_5_4_0
-_5_4_1        if fitline_kw is None:
-_5_4_2            fitline_kw = {'method':'sma',
-_5_4_3                          'intercept':True}
-_5_4_4
-_5_4_5        # Construct the dict
-_5_4_6        summary = {}
-_5_4_7        for v in variables:
-_5_4_8            if v in ['slope','intercept']:
-_5_4_9                # These variables are object methods
-_5_5_0                func = getattr(self,v)
-_5_5_1                value = func(**fitline_kw)
-_5_5_2            elif v == 'fitline':
-_5_5_3                line = self.fitline(**fitline_kw)
-_5_5_4                v,value = bivariate_line_equation
+_5_2_7        '''Summarize bivariate statistics into a dict
+_5_2_8
+_5_2_9        Parameters
+_5_3_0        ----------
+_5_3_1        vars : list or str, default='common'
+_5_3_2            names of attribute variables to include in summary
+_5_3_3            names are case insensitive
+_5_3_4            The following strings are also accepted in place of a list
+_5_3_5                "all" (displays all variables)
+_5_3_6                "common" (displays all measures of mean difference)
+_5_3_7        fitline_kw : dict, default=None
+_5_3_8            keywords passed to `fitline`
+_5_3_9        floatformat_fiteqn : str, default=floatformat
+_5_4_0            format specifier for slope and intercept (a,b) in y = a x + b
+_5_4_1
+_5_4_2        Returns
+_5_4_3        -------
+_5_4_4        summary : dict
+_5_4_5            names and values of variables
+_5_4_6        '''
+_5_4_7
+_5_4_8        # List of variables
+_5_4_9        variables = self._expand_variables(variables)
+_5_5_0
+_5_5_1        if fitline_kw is None:
+_5_5_2            fitline_kw = {'method':'sma',
+_5_5_3                          'intercept':True}
+_5_5_4
+_5_5_5        # Construct the dict
+_5_5_6        summary = {}
+_5_5_7        for v in variables:
+_5_5_8            if v in ['slope','intercept']:
+_5_5_9                # These variables are object methods
+_5_6_0                func = getattr(self,v)
+_5_6_1                value = func(**fitline_kw)
+_5_6_2            elif v == 'fitline':
+_5_6_3                line = self.fitline(**fitline_kw)
+_5_6_4                v,value = bivariate_line_equation
 (line,floatformat_fiteqn,ystring='separate')
-_5_5_5            else:
-_5_5_6                # Retrieve values
-_5_5_7                value = getattr(self,v.lower())
-_5_5_8
-_5_5_9            # summary += (stringformat+'='+floatformat+'\n').format(v,value)
-_5_6_0            summary[v] = value
-_5_6_1
-_5_6_2        return summary
-_5_6_3
-_5_6_4    def summary(self, variables=None, fitline_kw=None,
-_5_6_5                intformat='{:d}', floatformat='{:.4f}',
-floatformat_fiteqn=None,
-_5_6_6                stringlength=None ):
-_5_6_7        '''Summarize bivariate statistics
+_5_6_5            else:
+_5_6_6                # Retrieve values
+_5_6_7                value = getattr(self,v.lower())
 _5_6_8
-_5_6_9        Parameters
-_5_7_0        ----------
-_5_7_1        vars : list or str, default='common'
-_5_7_2            names of attribute variables to include in summary
-_5_7_3            names are case insensitive
-_5_7_4            The following strings are also accepted in place of a list
-_5_7_5                "all" (displays all variables)
-_5_7_6                "common" (displays all measures of mean difference)
-_5_7_7        fitline_kw : dict, default=None
-_5_7_8            keywords passed to `fitline`
-_5_7_9        intformat : str, default='{:d}'
-_5_8_0            format specifier for integer values
-_5_8_1        floatformat : str, default='{:.4f}'
-_5_8_2            format specifier for floating point values
-_5_8_3        floatformat_fiteqn : str, default=floatformat
-_5_8_4            format specifier for slope and intercept (a,b) in y = a x + b
-_5_8_5        stringlength : int, default=None
-_5_8_6            length of the variables on output
-_5_8_7            default (None) is to use the length of the longest variable name
-_5_8_8
-_5_8_9        Returns
-_5_9_0        -------
-_5_9_1        summary : str
-_5_9_2            names and values of variables
-_5_9_3        '''
-_5_9_4        # List of variables
-_5_9_5        variables = self._expand_variables(variables)
-_5_9_6
-_5_9_7        if floatformat_fiteqn is None:
-_5_9_8            floatformat_fiteqn = floatformat
-_5_9_9        if stringlength is None:
-_6_0_0            stringlength = np.max([len(v) for v in variables])
-_6_0_1        stringformat = '{:'+str(stringlength)+'s}'
-_6_0_2
-_6_0_3        # Get a dict containing the needed variables
-_6_0_4        summarydict = self.summary_dict( variables, fitline_kw,
-floatformat_fiteqn )
-_6_0_5
-_6_0_6        # Extract length of the float numbers from floatformat
-_6_0_7        # import re
-_6_0_8        # floatlength = np.floor( float( re.findall("[-+]?(?:\d*\.*\d+)",
-_6_0_9        #       floatformat )[0] ) ).astype(int)
-_6_1_0
-_6_1_1        # summary = (stringformat+'{:>10s}').format('Variable','Value')
-_6_1_2        summarytext = ''
-_6_1_3        for k,v in summarydict.items():
-_6_1_4            vstr = _number2str(v,intformat,floatformat)
-_6_1_5            summarytext += (stringformat+' = {:s}\n').format(k,vstr)
-_6_1_6
-_6_1_7        return summarytext
-_6_1_8
-_6_1_9    def summary_fig_inset(self, ax, variables=None, fitline_kw=None,
-_6_2_0                          intformat='{:d}', floatformat='{:.3f}',
+_5_6_9            # summary += (stringformat+'='+floatformat+'\n').format(v,value)
+_5_7_0            summary[v] = value
+_5_7_1
+_5_7_2        return summary
+_5_7_3
+_5_7_4    def summary(self, variables=None, fitline_kw=None,
+_5_7_5                intformat='{:d}', floatformat='{:.4f}',
 floatformat_fiteqn=None,
-_6_2_1                          loc=None, loc_units='axes',
-_6_2_2                          **kwargs):
-_6_2_3        '''Display bivariate statistics as a table inset on a plot axis
-_6_2_4
-_6_2_5        Parameters
-_6_2_6        ----------
-_6_2_7        ax : matplotlib.Figure.Axis
-_6_2_8            axis where the table will be displayed
-_6_2_9        variables : list or str, default='common'
-_6_3_0            names of attribute variables to include in summary
-_6_3_1            names are case insensitive
-_6_3_2            The following strings are also accepted in place of a list
-_6_3_3                "all" (displays all variables)
-_6_3_4                "common" (displays all measures of mean difference)
-_6_3_5        fitline_kw : dict, default=None
-_6_3_6            keywords passed to `fitline`
-_6_3_7        intformat : str, default='{:d}'
-_6_3_8            format specifier for integer values
-_6_3_9        floatformat : str, default='{:.3f}'
-_6_4_0            format specifier for floating point values
-_6_4_1        floatformat_fiteqn : str, default=floatformat
-_6_4_2            format specifier for slope and intercept (a,b) in y = a x + b
-_6_4_3        loc : tuple (x0,y0), default=(0.85, 0.05)
-_6_4_4            location on the axis where the table will be drawn
-_6_4_5            can be in data units or axes units [0-1]
-_6_4_6        loc_units : {'axes' (default), 'data'}
-_6_4_7            specifies whether loc has 'data' units or 'axes' units [0-1]
-_6_4_8
-_6_4_9        Returns
-_6_5_0        -------
-_6_5_1        text1, text2 : matplotlib text object
-_6_5_2            Artist for the two text boxes
-_6_5_3        '''
-_6_5_4        # List of variables
-_6_5_5        variables = self._expand_variables(variables)
-_6_5_6
-_6_5_7        if floatformat_fiteqn is None:
-_6_5_8            floatformat_fiteqn = floatformat
-_6_5_9
-_6_6_0        # Default location in lower right corner
-_6_6_1        if loc is None:
-_6_6_2            loc = (0.8,0.05)
-_6_6_3
-_6_6_4        # Coordinates for loc
-_6_6_5        if loc_units.lower()=='data':
-_6_6_6            coord=ax.transData
-_6_6_7        elif loc_units.lower() in ['axes','axis']:
-_6_6_8            coord=ax.transAxes
-_6_6_9        else:
-_6_7_0            raise ValueError('Display units should be "Data" or "Axes"')
-_6_7_1
-_6_7_2        # Get a dict containing the needed variables
-_6_7_3        summarydict = self.summary_dict( variables, fitline_kw,
+_5_7_6                stringlength=None ):
+_5_7_7        '''Summarize bivariate statistics
+_5_7_8
+_5_7_9        Parameters
+_5_8_0        ----------
+_5_8_1        vars : list or str, default='common'
+_5_8_2            names of attribute variables to include in summary
+_5_8_3            names are case insensitive
+_5_8_4            The following strings are also accepted in place of a list
+_5_8_5                "all" (displays all variables)
+_5_8_6                "common" (displays all measures of mean difference)
+_5_8_7        fitline_kw : dict, default=None
+_5_8_8            keywords passed to `fitline`
+_5_8_9        intformat : str, default='{:d}'
+_5_9_0            format specifier for integer values
+_5_9_1        floatformat : str, default='{:.4f}'
+_5_9_2            format specifier for floating point values
+_5_9_3        floatformat_fiteqn : str, default=floatformat
+_5_9_4            format specifier for slope and intercept (a,b) in y = a x + b
+_5_9_5        stringlength : int, default=None
+_5_9_6            length of the variables on output
+_5_9_7            default (None) is to use the length of the longest variable name
+_5_9_8
+_5_9_9        Returns
+_6_0_0        -------
+_6_0_1        summary : str
+_6_0_2            names and values of variables
+_6_0_3        '''
+_6_0_4        # List of variables
+_6_0_5        variables = self._expand_variables(variables)
+_6_0_6
+_6_0_7        if floatformat_fiteqn is None:
+_6_0_8            floatformat_fiteqn = floatformat
+_6_0_9        if stringlength is None:
+_6_1_0            stringlength = np.max([len(v) for v in variables])
+_6_1_1        stringformat = '{:'+str(stringlength)+'s}'
+_6_1_2
+_6_1_3        # Get a dict containing the needed variables
+_6_1_4        summarydict = self.summary_dict( variables, fitline_kw,
 floatformat_fiteqn )
-_6_7_4
-_6_7_5        # Column of label text
-_6_7_6        label_text = '\n'.join([_texify_name(key)
-_6_7_7                                for key in summarydict])
-_6_7_8        # Column of value text
-_6_7_9        value_text = '\n'.join([_number2str(v,intformat,floatformat)
-_6_8_0                                for v in summarydict.values()])
+_6_1_5
+_6_1_6        # Extract length of the float numbers from floatformat
+_6_1_7        # import re
+_6_1_8        # floatlength = np.floor( float( re.findall("[-+]?(?:\d*\.*\d+)",
+_6_1_9        #       floatformat )[0] ) ).astype(int)
+_6_2_0
+_6_2_1        # summary = (stringformat+'{:>10s}').format('Variable','Value')
+_6_2_2        summarytext = ''
+_6_2_3        for k,v in summarydict.items():
+_6_2_4            vstr = _number2str(v,intformat,floatformat)
+_6_2_5            summarytext += (stringformat+' = {:s}\n').format(k,vstr)
+_6_2_6
+_6_2_7        return summarytext
+_6_2_8
+_6_2_9    def summary_fig_inset(self, ax, variables=None, fitline_kw=None,
+_6_3_0                          intformat='{:d}', floatformat='{:.3f}',
+floatformat_fiteqn=None,
+_6_3_1                          loc=None, loc_units='axes',
+_6_3_2                          **kwargs):
+_6_3_3        '''Display bivariate statistics as a table inset on a plot axis
+_6_3_4
+_6_3_5        Parameters
+_6_3_6        ----------
+_6_3_7        ax : matplotlib.Figure.Axis
+_6_3_8            axis where the table will be displayed
+_6_3_9        variables : list or str, default='common'
+_6_4_0            names of attribute variables to include in summary
+_6_4_1            names are case insensitive
+_6_4_2            The following strings are also accepted in place of a list
+_6_4_3                "all" (displays all variables)
+_6_4_4                "common" (displays all measures of mean difference)
+_6_4_5        fitline_kw : dict, default=None
+_6_4_6            keywords passed to `fitline`
+_6_4_7        intformat : str, default='{:d}'
+_6_4_8            format specifier for integer values
+_6_4_9        floatformat : str, default='{:.3f}'
+_6_5_0            format specifier for floating point values
+_6_5_1        floatformat_fiteqn : str, default=floatformat
+_6_5_2            format specifier for slope and intercept (a,b) in y = a x + b
+_6_5_3        loc : tuple (x0,y0), default=(0.85, 0.05)
+_6_5_4            location on the axis where the table will be drawn
+_6_5_5            can be in data units or axes units [0-1]
+_6_5_6        loc_units : {'axes' (default), 'data'}
+_6_5_7            specifies whether loc has 'data' units or 'axes' units [0-1]
+_6_5_8
+_6_5_9        Returns
+_6_6_0        -------
+_6_6_1        text1, text2 : matplotlib text object
+_6_6_2            Artist for the two text boxes
+_6_6_3        '''
+_6_6_4        # List of variables
+_6_6_5        variables = self._expand_variables(variables)
+_6_6_6
+_6_6_7        if floatformat_fiteqn is None:
+_6_6_8            floatformat_fiteqn = floatformat
+_6_6_9
+_6_7_0        # Default location in lower right corner
+_6_7_1        if loc is None:
+_6_7_2            loc = (0.8,0.05)
+_6_7_3
+_6_7_4        # Coordinates for loc
+_6_7_5        if loc_units.lower()=='data':
+_6_7_6            coord=ax.transData
+_6_7_7        elif loc_units.lower() in ['axes','axis']:
+_6_7_8            coord=ax.transAxes
+_6_7_9        else:
+_6_8_0            raise ValueError('Display units should be "Data" or "Axes"')
 _6_8_1
-_6_8_2        # Check if horizontal alignment keyword is used
-_6_8_3        ha=''
-_6_8_4        try:
-_6_8_5            ha = kwargs['ha']
-_6_8_6        except KeyError:
-_6_8_7            pass
-_6_8_8        try:
-_6_8_9            ha = kwargs['horizontalalignment']
-_6_9_0        except KeyError:
-_6_9_1            pass
-_6_9_2
-_6_9_3        # For right alignment, align on values first
-_6_9_4        # Otherwise, align on labels
-_6_9_5        if ha=='right':
-_6_9_6            first_text = value_text
-_6_9_7            second_text = label_text
-_6_9_8            sign = -1
-_6_9_9        else:
-_7_0_0            first_text = label_text
-_7_0_1            second_text = value_text
-_7_0_2            sign = +1
-_7_0_3
-_7_0_4        # Add first column of text
-_7_0_5        t1=ax.text(loc[0],loc[1],
-_7_0_6                first_text,
-_7_0_7                transform=coord,
-_7_0_8                **kwargs
-_7_0_9                )
-_7_1_0
-_7_1_1        # Get width of first text column
-_7_1_2        bbox = t1.get_window_extent().transformed(coord.inverted())
-_7_1_3        width = bbox.x1-bbox.x0
-_7_1_4
-_7_1_5        # Add second column of text
-_7_1_6        t2 = ax.text(loc[0]+width*sign,loc[1],
-_7_1_7                     second_text,
-_7_1_8                     transform=coord,
-_7_1_9                     **kwargs
-_7_2_0                     )
-_7_2_1
-_7_2_2        ##################################
-_7_2_3        # Early version of this function using matplotlib.table.table()
+_6_8_2        # Get a dict containing the needed variables
+_6_8_3        summarydict = self.summary_dict( variables, fitline_kw,
+floatformat_fiteqn )
+_6_8_4
+_6_8_5        # Column of label text
+_6_8_6        label_text = '\n'.join([_texify_name(key)
+_6_8_7                                for key in summarydict])
+_6_8_8        # Column of value text
+_6_8_9        value_text = '\n'.join([_number2str(v,intformat,floatformat)
+_6_9_0                                for v in summarydict.values()])
+_6_9_1
+_6_9_2        # Check if horizontal alignment keyword is used
+_6_9_3        ha=''
+_6_9_4        try:
+_6_9_5            ha = kwargs['ha']
+_6_9_6        except KeyError:
+_6_9_7            pass
+_6_9_8        try:
+_6_9_9            ha = kwargs['horizontalalignment']
+_7_0_0        except KeyError:
+_7_0_1            pass
+_7_0_2
+_7_0_3        # For right alignment, align on values first
+_7_0_4        # Otherwise, align on labels
+_7_0_5        if ha=='right':
+_7_0_6            first_text = value_text
+_7_0_7            second_text = label_text
+_7_0_8            sign = -1
+_7_0_9        else:
+_7_1_0            first_text = label_text
+_7_1_1            second_text = value_text
+_7_1_2            sign = +1
+_7_1_3
+_7_1_4        # Add first column of text
+_7_1_5        t1=ax.text(loc[0],loc[1],
+_7_1_6                first_text,
+_7_1_7                transform=coord,
+_7_1_8                **kwargs
+_7_1_9                )
+_7_2_0
+_7_2_1        # Get width of first text column
+_7_2_2        bbox = t1.get_window_extent().transformed(coord.inverted())
+_7_2_3        width = bbox.x1-bbox.x0
 _7_2_4
-_7_2_5        # if isinstance(loc,(tuple,list)):
-_7_2_6        #     # Create an inset axis to contain the table
-_7_2_7        #     tableaxis = ax.inset_axes(loc)
-_7_2_8        #     table_width=1
-_7_2_9        # else:
-_7_3_0        #     tableaxis = ax
+_7_2_5        # Add second column of text
+_7_2_6        t2 = ax.text(loc[0]+width*sign,loc[1],
+_7_2_7                     second_text,
+_7_2_8                     transform=coord,
+_7_2_9                     **kwargs
+_7_3_0                     )
 _7_3_1
-_7_3_2        # # Display the table on the axis
-_7_3_3        # return mtable.table(
-_7_3_4        #     tableaxis,
-_7_3_5        #     cellText=[[floatformat.format(value)] for value in
-summarydict.values()],
-_7_3_6        #     rowLabels=[texify_name(key) for key in summarydict],
-_7_3_7        #     colWidths=[table_width/2]*2,
-_7_3_8        #     edges=edges,
-_7_3_9        #     loc=loc, bbox=bbox
-_7_4_0        #     )
+_7_3_2        ##################################
+_7_3_3        # Early version of this function using matplotlib.table.table()
+_7_3_4
+_7_3_5        # if isinstance(loc,(tuple,list)):
+_7_3_6        #     # Create an inset axis to contain the table
+_7_3_7        #     tableaxis = ax.inset_axes(loc)
+_7_3_8        #     table_width=1
+_7_3_9        # else:
+_7_4_0        #     tableaxis = ax
 _7_4_1
-_7_4_2        return [t1,t2]
+_7_4_2        # # Display the table on the axis
+_7_4_3        # return mtable.table(
+_7_4_4        #     tableaxis,
+_7_4_5        #     cellText=[[floatformat.format(value)] for value in
+summarydict.values()],
+_7_4_6        #     rowLabels=[texify_name(key) for key in summarydict],
+_7_4_7        #     colWidths=[table_width/2]*2,
+_7_4_8        #     edges=edges,
+_7_4_9        #     loc=loc, bbox=bbox
+_7_5_0        #     )
+_7_5_1
+_7_5_2        return [t1,t2]
 ??
 class BivariateStatistics: View Source
 _1_8_8class BivariateStatistics:
 _1_8_9    '''A suite of common statistics to quantify bivariate relationships
 _1_9_0
 _1_9_1    Class method 'summary' provides a formatted summary of these statistics
 _1_9_2
@@ -813,751 +824,771 @@
 _1_9_8        mean of x and y variables
 _1_9_9    xmedian, ymedian :float
 _2_0_0        median of x and y variables
 _2_0_1    xstd, ystd : float
 _2_0_2        standard deviation of x and y variables
 _2_0_3    mean_difference, md : float
 _2_0_4        ymean - xmean
-_2_0_5    mean_absolute_difference, mad : float
-_2_0_6        mean( |y-x| )
-_2_0_7    relative_mean_difference, rmd : float
-_2_0_8        md / xmean
-_2_0_9    relative_mean_absolute_difference, rmad :float
-_2_1_0        mad / xmean
-_2_1_1    standardized_mean_difference, smd : float
-_2_1_2        md / xstd
-_2_1_3    standardized_mean_absolute_difference, smad : float
-_2_1_4        mad /xstd
-_2_1_5    mean_relative_difference, mrd : float
-_2_1_6        mean(y/x) - 1
-_2_1_7    mean_log10_ratio, mlr : float
-_2_1_8        mean( log10(y/x) )
-_2_1_9    mean_absolute_log10_ratio, malr : float
-_2_2_0        mean( abs( log10(y/x) ) )
-_2_2_1    median_difference, medd : float
-_2_2_2        median(y-x)
-_2_2_3    median_absolute_difference, medad : float
-_2_2_4        median(|y-x|)
-_2_2_5    relative_median_difference, rmedd : float
-_2_2_6        median(y-x) / xmedian
-_2_2_7    relative_median_absolute_difference, rmedad : float
-_2_2_8        median(|y-x|) / xmedian
-_2_2_9    median_relative_difference, medianrd, medrd : float
-_2_3_0        median(y/x)-1
-_2_3_1    median_log10_ratio, medlr : float
-_2_3_2        median( log10(y/x) )
-_2_3_3    median_absolute_log10_ratio, medalr : float
-_2_3_4        median( abs( log10(y/x) ) )
-_2_3_5    normalized_mean_bias_factor, nmbf : float
-_2_3_6        see `nmbf`
-_2_3_7    normalized_mean_absolute_error_factor, nmaef : float
-_2_3_8        see `nmaef`
-_2_3_9    root_mean_square_difference, rmsd : float
-_2_4_0        $\\sqrt{ \\langle (y - x)^2 \\rangle }$
-_2_4_1    covariance : float
-_2_4_2        cov(x,y)
-_2_4_3    correlation_pearson, correlation, pearsonr, R, r : float
-_2_4_4        Pearson linear correlation coefficient
-_2_4_5    correlation_spearman, spearmanr : float
-_2_4_6        Spearman, non-parametric rank correlation coefficient
-_2_4_7    R2, r2 : float
-_2_4_8        Linear coefficient of determination, $R^2$
-_2_4_9    '''
-_2_5_0
-_2_5_1    def __init__(self,x,y,w=None,dropna=False,data=None):
-_2_5_2        '''Compute suite of bivariate statistics during initialization
-_2_5_3
-_2_5_4        Statistic values are saved in attributes.
-_2_5_5        CAUTION: Weights w are ignored except in SMA fit
+_2_0_5    std_difference, stdd : float
+_2_0_6        std( y - x )
+_2_0_7    mean_absolute_difference, mad : float
+_2_0_8        mean( |y-x| )
+_2_0_9    relative_mean_difference, rmd : float
+_2_1_0        md / xmean
+_2_1_1    relative_mean_absolute_difference, rmad :float
+_2_1_2        mad / xmean
+_2_1_3    standardized_mean_difference, smd : float
+_2_1_4        md / xstd
+_2_1_5    standardized_mean_absolute_difference, smad : float
+_2_1_6        mad /xstd
+_2_1_7    mean_relative_difference, mrd : float
+_2_1_8        mean(y/x) - 1
+_2_1_9    mean_log10_ratio, mlr : float
+_2_2_0        mean( log10(y/x) )
+_2_2_1    std_log10_ratio, stdlr : float
+_2_2_2        std( log10(y/x) )
+_2_2_3    mean_absolute_log10_ratio, malr : float
+_2_2_4        mean( abs( log10(y/x) ) )
+_2_2_5    median_difference, medd : float
+_2_2_6        median(y-x)
+_2_2_7    median_absolute_difference, medad : float
+_2_2_8        median(|y-x|)
+_2_2_9    relative_median_difference, rmedd : float
+_2_3_0        median(y-x) / xmedian
+_2_3_1    relative_median_absolute_difference, rmedad : float
+_2_3_2        median(|y-x|) / xmedian
+_2_3_3    median_relative_difference, medianrd, medrd : float
+_2_3_4        median(y/x)-1
+_2_3_5    median_log10_ratio, medlr : float
+_2_3_6        median( log10(y/x) )
+_2_3_7    median_absolute_log10_ratio, medalr : float
+_2_3_8        median( abs( log10(y/x) ) )
+_2_3_9    normalized_mean_bias_factor, nmbf : float
+_2_4_0        see `nmbf`
+_2_4_1    normalized_mean_absolute_error_factor, nmaef : float
+_2_4_2        see `nmaef`
+_2_4_3    root_mean_square_difference, rmsd : float
+_2_4_4        $\\sqrt{ \\langle (y - x)^2 \\rangle }$
+_2_4_5    root_mean_square_log10_ratio, rmslr : float
+_2_4_6        $\\sqrt{ \\langle log10(y/x)^2 \\rangle }$
+_2_4_7    covariance : float
+_2_4_8        cov(x,y)
+_2_4_9    correlation_pearson, correlation, pearsonr, R, r : float
+_2_5_0        Pearson linear correlation coefficient
+_2_5_1    correlation_spearman, spearmanr : float
+_2_5_2        Spearman, non-parametric rank correlation coefficient
+_2_5_3    R2, r2 : float
+_2_5_4        Linear coefficient of determination, $R^2$
+_2_5_5    '''
 _2_5_6
-_2_5_7        Parameters
-_2_5_8        ----------
-_2_5_9        x : ndarray or str
-_2_6_0            independent variable values
-_2_6_1        y : ndarray or str
-_2_6_2            dependent variable values, same size as x
-_2_6_3        w : ndarray or str, optional
-_2_6_4            weights for points (x,y), same size as x and y
-_2_6_5        dropna : bool, optional (default=False)
-_2_6_6            drops NaN values from x, y, and w
-_2_6_7        data : dict-like, optional
-_2_6_8            if x, y, or w are str, then they should be keys in data
-_2_6_9        '''
-_2_7_0
-_2_7_1        # Get values from data if needed
-_2_7_2        if data is None and (isinstance(x,str) or isinstance(y,str) or
+_2_5_7    def __init__(self,x,y,w=None,dropna=False,data=None):
+_2_5_8        '''Compute suite of bivariate statistics during initialization
+_2_5_9
+_2_6_0        Statistic values are saved in attributes.
+_2_6_1        CAUTION: Weights w are ignored except in SMA fit
+_2_6_2
+_2_6_3        Parameters
+_2_6_4        ----------
+_2_6_5        x : ndarray or str
+_2_6_6            independent variable values
+_2_6_7        y : ndarray or str
+_2_6_8            dependent variable values, same size as x
+_2_6_9        w : ndarray or str, optional
+_2_7_0            weights for points (x,y), same size as x and y
+_2_7_1        dropna : bool, optional (default=False)
+_2_7_2            drops NaN values from x, y, and w
+_2_7_3        data : dict-like, optional
+_2_7_4            if x, y, or w are str, then they should be keys in data
+_2_7_5        '''
+_2_7_6
+_2_7_7        # Get values from data if needed
+_2_7_8        if data is None and (isinstance(x,str) or isinstance(y,str) or
 isinstance(w,str)):
-_2_7_3            raise ValueError( 'Data argument must be used if x, y, or w is a
+_2_7_9            raise ValueError( 'Data argument must be used if x, y, or w is a
 string')
-_2_7_4        if isinstance(x,str):
-_2_7_5            x = data[x]
-_2_7_6        if isinstance(y,str):
-_2_7_7            y = data[y]
-_2_7_8        if isinstance(w,str):
-_2_7_9            w = data[w]
-_2_8_0
-_2_8_1        #Ensure that x and y have same length
-_2_8_2        if len(x) != len(y):
-_2_8_3            raise ValueError( 'Arguments x and y must have the same length'
+_2_8_0        if isinstance(x,str):
+_2_8_1            x = data[x]
+_2_8_2        if isinstance(y,str):
+_2_8_3            y = data[y]
+_2_8_4        if isinstance(w,str):
+_2_8_5            w = data[w]
+_2_8_6
+_2_8_7        #Ensure that x and y have same length
+_2_8_8        if len(x) != len(y):
+_2_8_9            raise ValueError( 'Arguments x and y must have the same length'
 )
-_2_8_4        if w is None:
-_2_8_5            w = np.ones_like(x)
-_2_8_6        if len(w) != len(x):
-_2_8_7            raise ValueError( 'Argument w (if present) must have the same
+_2_9_0        if w is None:
+_2_9_1            w = np.ones_like(x)
+_2_9_2        if len(w) != len(x):
+_2_9_3            raise ValueError( 'Argument w (if present) must have the same
 length as x' )
-_2_8_8
-_2_8_9        # Drop NaN values
-_2_9_0        if dropna:
-_2_9_1            isna = np.isnan(x*y*w)
-_2_9_2            x = x[~isna]
-_2_9_3            y = y[~isna]
-_2_9_4            w = w[~isna]
-_2_9_5
-_2_9_6        # Differences and ratios used repeatedly
-_2_9_7        diff = y - x
-_2_9_8        absdiff = np.abs( y - x )
-_2_9_9        # Ignore divide by zero and 0/0 while dividing
-_3_0_0        old_settings = np.seterr(divide='ignore',invalid='ignore')
-_3_0_1        ratio = y/x
-_3_0_2        log10ratio = np.log10(ratio)
-_3_0_3        np.seterr(**old_settings)
-_3_0_4
-_3_0_5        # Number of data points
-_3_0_6        self.count = self.n = len(x)
-_3_0_7
-_3_0_8        # Means, medians, and standard deviations
-_3_0_9        self.xmean = np.mean(x)
-_3_1_0        self.ymean = np.mean(y)
-_3_1_1        self.xmedian = np.median(x)
-_3_1_2        self.ymedian = np.median(y)
-_3_1_3        self.xstd   = np.std(x)
-_3_1_4        self.ystd   = np.std(y)
-_3_1_5
-_3_1_6        # Save values for use later
-_3_1_7        self._x = x
-_3_1_8        self._y = y
-_3_1_9        self._w = w
-_3_2_0
-_3_2_1        # Mean and mean absolute differences
-_3_2_2        self.mean_difference            = self.md   = self.ymean -
+_2_9_4
+_2_9_5        # Drop NaN values
+_2_9_6        if dropna:
+_2_9_7            isna = np.isnan(x*y*w)
+_2_9_8            x = x[~isna]
+_2_9_9            y = y[~isna]
+_3_0_0            w = w[~isna]
+_3_0_1
+_3_0_2        # Differences and ratios used repeatedly
+_3_0_3        diff = y - x
+_3_0_4        absdiff = np.abs( y - x )
+_3_0_5        # Ignore divide by zero and 0/0 while dividing
+_3_0_6        old_settings = np.seterr(divide='ignore',invalid='ignore')
+_3_0_7        ratio = y/x
+_3_0_8        log10ratio = np.log10(ratio)
+_3_0_9        np.seterr(**old_settings)
+_3_1_0
+_3_1_1        # Number of data points
+_3_1_2        self.count = self.n = len(x)
+_3_1_3
+_3_1_4        # Means, medians, and standard deviations
+_3_1_5        self.xmean = np.mean(x)
+_3_1_6        self.ymean = np.mean(y)
+_3_1_7        self.xmedian = np.median(x)
+_3_1_8        self.ymedian = np.median(y)
+_3_1_9        self.xstd   = np.std(x)
+_3_2_0        self.ystd   = np.std(y)
+_3_2_1
+_3_2_2        # Save values for use later
+_3_2_3        self._x = x
+_3_2_4        self._y = y
+_3_2_5        self._w = w
+_3_2_6
+_3_2_7        # Mean and mean absolute differences
+_3_2_8        self.mean_difference            = self.md   = self.ymean -
 self.xmean
-_3_2_3        self.mean_absolute_difference   = self.mad  = np.mean( absdiff )
-_3_2_4
-_3_2_5        # Relative and standardized differences
-_3_2_6        self.relative_mean_difference           = self.rmd  =
+_3_2_9        self.mean_absolute_difference   = self.mad  = np.mean( absdiff )
+_3_3_0        self.std_difference             = self.stdd = np.std( diff )
+_3_3_1
+_3_3_2        # Relative and standardized differences
+_3_3_3        self.relative_mean_difference           = self.rmd  =
 self.mean_difference / self.xmean
-_3_2_7        self.relative_mean_absolute_difference  = self.rmad =
+_3_3_4        self.relative_mean_absolute_difference  = self.rmad =
 self.mean_absolute_difference / self.xmean
-_3_2_8        self.standardized_mean_difference       = self.smd  =
+_3_3_5        self.standardized_mean_difference       = self.smd  =
 self.mean_difference / self.xstd
-_3_2_9        self.standardized_mean_absolute_difference  = self.smad =
+_3_3_6        self.standardized_mean_absolute_difference  = self.smad =
 self.mean_absolute_difference / self.xstd
-_3_3_0
-_3_3_1        # Mean and median relative differences
-_3_3_2        self.mean_relative_difference   = self.mrd  = np.mean( ratio - 1 )
-_3_3_3        self.median_relative_difference = self.medianrd = self.medrd =
+_3_3_7
+_3_3_8        # Mean and median relative differences
+_3_3_9        self.mean_relative_difference   = self.mrd  = np.mean( ratio - 1 )
+_3_4_0        self.median_relative_difference = self.medianrd = self.medrd =
 np.median( ratio - 1 )
-_3_3_4
-_3_3_5        # Median and median absolute differences
-_3_3_6        self.median_difference          = self.medd  = np.median( diff )
-_3_3_7        self.median_absolute_difference = self.medad = np.median( absdiff )
-_3_3_8
-_3_3_9        # Relative median differences
-_3_4_0        self.relative_median_difference          = self.rmedd  =
+_3_4_1
+_3_4_2        # Median and median absolute differences
+_3_4_3        self.median_difference          = self.medd  = np.median( diff )
+_3_4_4        self.median_absolute_difference = self.medad = np.median( absdiff )
+_3_4_5
+_3_4_6        # Relative median differences
+_3_4_7        self.relative_median_difference          = self.rmedd  =
 self.median_difference / self.xmedian
-_3_4_1        self.relative_median_absolute_difference = self.rmedad =
+_3_4_8        self.relative_median_absolute_difference = self.rmedad =
 self.median_absolute_difference / self.xmedian
-_3_4_2
-_3_4_3        self.normalized_mean_bias_factor            = self.nmbf  = nmbf(x,y)
-_3_4_4        self.normalized_mean_absolute_error_factor  = self.nmaef = nmaef
+_3_4_9
+_3_5_0        self.normalized_mean_bias_factor            = self.nmbf  = nmbf(x,y)
+_3_5_1        self.normalized_mean_absolute_error_factor  = self.nmaef = nmaef
 (x,y)
-_3_4_5
-_3_4_6        # Mean and mean absolute log ratio
-_3_4_7        self.mean_log10_ratio          = self.mlr  = np.mean( log10ratio )
-_3_4_8        self.mean_absolute_log10_ratio = self.malr = np.mean( np.abs
+_3_5_2
+_3_5_3        # Mean and mean absolute log ratio
+_3_5_4        self.mean_log10_ratio          = self.mlr  = np.mean( log10ratio )
+_3_5_5        self.mean_absolute_log10_ratio = self.malr = np.mean( np.abs
 ( log10ratio ) )
-_3_4_9
-_3_5_0        # Median and median absolute log ratio
-_3_5_1        self.median_log10_ratio          = self.medlr  = np.median
+_3_5_6        self.std_log10_ratio           = self.stdlr= np.std( log10ratio )
+_3_5_7
+_3_5_8        # Median and median absolute log ratio
+_3_5_9        self.median_log10_ratio          = self.medlr  = np.median
 ( log10ratio )
-_3_5_2        self.median_absolute_log10_ratio = self.medalr = np.median( np.abs
+_3_6_0        self.median_absolute_log10_ratio = self.medalr = np.median( np.abs
 ( log10ratio ) )
-_3_5_3
-_3_5_4        # RMS difference
-_3_5_5        self.root_mean_square_difference    = self.rmsd     = np.sqrt
-( np.mean( np.power( diff, 2) ) )
-_3_5_6
-_3_5_7        # Covariance, correlation
-_3_5_8        self.covariance = np.cov(x,y)[0][1]
-_3_5_9        self.correlation = self.correlation_pearson = self.R = self.r =
+_3_6_1
+_3_6_2        # RMS difference
+_3_6_3        self.root_mean_square_difference = self.rmsd   = np.sqrt( np.mean
+( np.power( diff, 2) ) )
+_3_6_4        # RMS log ratio
+_3_6_5        self.root_mean_square_log10_ratio = self.rmslr = np.sqrt( np.mean
+( np.power( log10ratio, 2 )))
+_3_6_6
+_3_6_7        # Covariance, correlation
+_3_6_8        self.covariance = np.cov(x,y)[0][1]
+_3_6_9        self.correlation = self.correlation_pearson = self.R = self.r =
 self.pearsonr = \
-_3_6_0            np.corrcoef(x,y)[0][1]
-_3_6_1        self.correlation_spearman = self.spearmanr = stats.spearmanr
+_3_7_0            np.corrcoef(x,y)[0][1]
+_3_7_1        self.correlation_spearman = self.spearmanr = stats.spearmanr
 (x,y).statistic
-_3_6_2        self.R2 = self.r2 = self.R**2
-_3_6_3
-_3_6_4    def __getitem__(self,key):
-_3_6_5        '''Accesses attribute values via object['key']'''
-_3_6_6        return getattr(self,key)
-_3_6_7
-_3_6_8    def fitline(self,method='sma',intercept=True,**kwargs):
-_3_6_9        '''Compute bivariate line fit
-_3_7_0
-_3_7_1        Parameters
-_3_7_2        ----------
-_3_7_3        method : str
-_3_7_4            line fitting method: sma (default), ols, wls, York, sen, siegel
-_3_7_5        intercept : bool
-_3_7_6            defines whether non-zero intercept should be fitted
-_3_7_7        **kwargs
-_3_7_8            passed to `acgc.stats.sma` (e.g. robust=True)
-_3_7_9
-_3_8_0        Returns
-_3_8_1        -------
-_3_8_2        result : dict
-_3_8_3            dictionary with keys:
-_3_8_4            - slope (float)
-_3_8_5                slope of fitted line
-_3_8_6            - intercept (float)
-_3_8_7                intercept of fitted line
-_3_8_8            - fittedvalues (array (N,))
-_3_8_9                values on fit line
-_3_9_0            - residuals (array (N,))
-_3_9_1                residual from fit line
-_3_9_2        '''
-_3_9_3
-_3_9_4        fitintercept = intercept
-_3_9_5
-_3_9_6        if method.lower()=='sma':
-_3_9_7            fit = sma(  self._x,
-_3_9_8                        self._y,
-_3_9_9                        self._w,
-_4_0_0                        intercept=fitintercept,
-_4_0_1                        **kwargs)
-_4_0_2            slope = fit['slope']
-_4_0_3            intercept= fit['intercept']
-_4_0_4
-_4_0_5        elif method.lower()=='ols':
-_4_0_6            if fitintercept:
-_4_0_7                ols = np.linalg.lstsq( np.vstack([self._x,np.ones(len
+_3_7_2        self.R2 = self.r2 = self.R**2
+_3_7_3
+_3_7_4    def __getitem__(self,key):
+_3_7_5        '''Accesses attribute values via object['key']'''
+_3_7_6        return getattr(self,key)
+_3_7_7
+_3_7_8    def fitline(self,method='sma',intercept=True,**kwargs):
+_3_7_9        '''Compute bivariate line fit
+_3_8_0
+_3_8_1        Parameters
+_3_8_2        ----------
+_3_8_3        method : str
+_3_8_4            line fitting method: sma (default), ols, wls, York, sen, siegel
+_3_8_5        intercept : bool
+_3_8_6            defines whether non-zero intercept should be fitted
+_3_8_7        **kwargs
+_3_8_8            passed to `acgc.stats.sma` (e.g. robust=True)
+_3_8_9
+_3_9_0        Returns
+_3_9_1        -------
+_3_9_2        result : dict
+_3_9_3            dictionary with keys:
+_3_9_4            - slope (float)
+_3_9_5                slope of fitted line
+_3_9_6            - intercept (float)
+_3_9_7                intercept of fitted line
+_3_9_8            - fittedvalues (array (N,))
+_3_9_9                values on fit line
+_4_0_0            - residuals (array (N,))
+_4_0_1                residual from fit line
+_4_0_2        '''
+_4_0_3
+_4_0_4        fitintercept = intercept
+_4_0_5
+_4_0_6        if method.lower()=='sma':
+_4_0_7            fit = sma(  self._x,
+_4_0_8                        self._y,
+_4_0_9                        self._w,
+_4_1_0                        intercept=fitintercept,
+_4_1_1                        **kwargs)
+_4_1_2            slope = fit['slope']
+_4_1_3            intercept= fit['intercept']
+_4_1_4
+_4_1_5        elif method.lower()=='ols':
+_4_1_6            if fitintercept:
+_4_1_7                ols = np.linalg.lstsq( np.vstack([self._x,np.ones(len
 (self._x))]).T,
-_4_0_8                                      self._y, rcond=None )
-_4_0_9            else:
-_4_1_0                ols = np.linalg.lstsq( np.vstack([self._x]).T, self._y,
+_4_1_8                                      self._y, rcond=None )
+_4_1_9            else:
+_4_2_0                ols = np.linalg.lstsq( np.vstack([self._x]).T, self._y,
 rcond=None )
-_4_1_1            slope = ols[0][0]
-_4_1_2            intercept = ols[0][1]
-_4_1_3
-_4_1_4        elif method.lower() in ['theil','sen','theilsen']:
-_4_1_5            fitintercept = True
-_4_1_6            fit = sen( self._x,
-_4_1_7                       self._y,
-_4_1_8                       **kwargs)
-_4_1_9            slope = fit.slope
-_4_2_0            intercept = fit.intercept
-_4_2_1
-_4_2_2        elif method.lower()=='siegel':
-_4_2_3            fitintercept = True
-_4_2_4            siegel = stats.siegelslopes( self._x,
-_4_2_5                                         self._y )
-_4_2_6            slope = siegel.slope
-_4_2_7            intercept = siegel.intercept
-_4_2_8
-_4_2_9        elif method.lower()=='wls':
-_4_3_0            raise NotImplementedError('WLS regression not implemented yet')
+_4_2_1            slope = ols[0][0]
+_4_2_2            intercept = ols[0][1]
+_4_2_3
+_4_2_4        elif method.lower() in ['theil','sen','theilsen']:
+_4_2_5            fitintercept = True
+_4_2_6            fit = sen( self._x,
+_4_2_7                       self._y,
+_4_2_8                       **kwargs)
+_4_2_9            slope = fit.slope
+_4_3_0            intercept = fit.intercept
 _4_3_1
-_4_3_2        elif method.lower()=='york':
-_4_3_3            raise NotImplementedError('York regression not implemented yet')
-_4_3_4
-_4_3_5        else:
-_4_3_6            raise ValueError('Undefined method '+method)
-_4_3_7
-_4_3_8        line = dict( slope          = slope,
-_4_3_9                     intercept      = intercept,
-_4_4_0                     fittedvalues   = slope * self._x + intercept,
-_4_4_1                     residuals      = self._y - ( slope * self._x +
-intercept ),
-_4_4_2                     method         = method,
-_4_4_3                     fitintercept   = fitintercept )
+_4_3_2        elif method.lower()=='siegel':
+_4_3_3            fitintercept = True
+_4_3_4            siegel = stats.siegelslopes( self._x,
+_4_3_5                                         self._y )
+_4_3_6            slope = siegel.slope
+_4_3_7            intercept = siegel.intercept
+_4_3_8
+_4_3_9        elif method.lower()=='wls':
+_4_4_0            raise NotImplementedError('WLS regression not implemented yet')
+_4_4_1
+_4_4_2        elif method.lower()=='york':
+_4_4_3            raise NotImplementedError('York regression not implemented yet')
 _4_4_4
-_4_4_5        return line
-_4_4_6
-_4_4_7    def slope(self,method='sma',intercept=True,**kwargs):
-_4_4_8        '''Compute slope of bivariate line fit
-_4_4_9
-_4_5_0        Parameters
-_4_5_1        ----------
-_4_5_2        method : str
-_4_5_3            line fitting method: sma (default), ols, wls
-_4_5_4        intercept : bool
-_4_5_5            defines whether non-zero intercept should be fitted
-_4_5_6        **kwargs
-_4_5_7            passed to `fitline`
-_4_5_8
-_4_5_9        Returns
-_4_6_0        -------
-_4_6_1        slope : float
-_4_6_2            value of y intercept
-_4_6_3        '''
-_4_6_4        return self.fitline(method,intercept,**kwargs)['slope']
-_4_6_5
-_4_6_6    def intercept(self,method='sma',intercept=True,**kwargs):
-_4_6_7        '''Compute intercept of bivariate line fit
+_4_4_5        else:
+_4_4_6            raise ValueError('Undefined method '+method)
+_4_4_7
+_4_4_8        line = dict( slope          = slope,
+_4_4_9                     intercept      = intercept,
+_4_5_0                     fittedvalues   = slope * self._x + intercept,
+_4_5_1                     residuals      = self._y - ( slope * self._x +
+intercept ),
+_4_5_2                     method         = method,
+_4_5_3                     fitintercept   = fitintercept )
+_4_5_4
+_4_5_5        return line
+_4_5_6
+_4_5_7    def slope(self,method='sma',intercept=True,**kwargs):
+_4_5_8        '''Compute slope of bivariate line fit
+_4_5_9
+_4_6_0        Parameters
+_4_6_1        ----------
+_4_6_2        method : str
+_4_6_3            line fitting method: sma (default), ols, wls
+_4_6_4        intercept : bool
+_4_6_5            defines whether non-zero intercept should be fitted
+_4_6_6        **kwargs
+_4_6_7            passed to `fitline`
 _4_6_8
-_4_6_9        Parameters
-_4_7_0        ----------
-_4_7_1        method : str
-_4_7_2            line fitting method: sma (default) or ols
-_4_7_3        intercept : bool
-_4_7_4            defines whether non-zero intercept should be fitted
-_4_7_5        **kwargs
-_4_7_6            passed to `fitline`
-_4_7_7
-_4_7_8        Returns
-_4_7_9        -------
-_4_8_0        intercept : float
-_4_8_1            value of y intercept
-_4_8_2        '''
-_4_8_3        return self.fitline(method,intercept,**kwargs)['intercept']
-_4_8_4
-_4_8_5    def _expand_variables(self,variables):
-_4_8_6        '''Expand special strings into a list of variables
+_4_6_9        Returns
+_4_7_0        -------
+_4_7_1        slope : float
+_4_7_2            value of y intercept
+_4_7_3        '''
+_4_7_4        return self.fitline(method,intercept,**kwargs)['slope']
+_4_7_5
+_4_7_6    def intercept(self,method='sma',intercept=True,**kwargs):
+_4_7_7        '''Compute intercept of bivariate line fit
+_4_7_8
+_4_7_9        Parameters
+_4_8_0        ----------
+_4_8_1        method : str
+_4_8_2            line fitting method: sma (default) or ols
+_4_8_3        intercept : bool
+_4_8_4            defines whether non-zero intercept should be fitted
+_4_8_5        **kwargs
+_4_8_6            passed to `fitline`
 _4_8_7
-_4_8_8        Parameter
-_4_8_9        ---------
-_4_9_0        variables : list or str, default='common'
-_4_9_1            Special strings ("all","common") will be expanded to a list of
+_4_8_8        Returns
+_4_8_9        -------
+_4_9_0        intercept : float
+_4_9_1            value of y intercept
+_4_9_2        '''
+_4_9_3        return self.fitline(method,intercept,**kwargs)['intercept']
+_4_9_4
+_4_9_5    def _expand_variables(self,variables):
+_4_9_6        '''Expand special strings into a list of variables
+_4_9_7
+_4_9_8        Parameter
+_4_9_9        ---------
+_5_0_0        variables : list or str, default='common'
+_5_0_1            Special strings ("all","common") will be expanded to a list of
 variables
-_4_9_2            list arguments will not be modified
-_4_9_3
-_4_9_4        Returns
-_4_9_5        -------
-_4_9_6        list
-_4_9_7            variable names
-_4_9_8        '''
-_4_9_9        if variables is None:
-_5_0_0            variables='common'
-_5_0_1        if variables=='all':
-_5_0_2            variables=['MD','MAD','RMD','RMAD','MRD','SMD','SMAD',
-_5_0_3                       'MLR','MALR',
-_5_0_4                       'MedD','MedAD','RMedD','RMedAD','MedRD',
-_5_0_5                       'MedLR','MedALR',
-_5_0_6                       'NMBF','NMAEF','RMSD','cov',
-_5_0_7                       'R','R2','spearmanr','slope','intercept',
-_5_0_8                       'fitline','n']
-_5_0_9        elif variables=='common':
-_5_1_0            variables=['MD','MAD','RMD','RMAD','MRD','R2','slope','n']
-_5_1_1        if not isinstance(variables,list):
-_5_1_2            raise ValueError(
-_5_1_3                'variables must be a list, None, or one of these strings:
+_5_0_2            list arguments will not be modified
+_5_0_3
+_5_0_4        Returns
+_5_0_5        -------
+_5_0_6        list
+_5_0_7            variable names
+_5_0_8        '''
+_5_0_9        if variables is None:
+_5_1_0            variables='common'
+_5_1_1        if variables=='all':
+_5_1_2            variables=['MD','MAD','RMD','RMAD','MRD','SMD','SMAD',
+_5_1_3                       'MLR','MALR',
+_5_1_4                       'MedD','MedAD','RMedD','RMedAD','MedRD',
+_5_1_5                       'MedLR','MedALR',
+_5_1_6                       'NMBF','NMAEF','RMSD','cov',
+_5_1_7                       'R','R2','spearmanr','slope','intercept',
+_5_1_8                       'fitline','n']
+_5_1_9        elif variables=='common':
+_5_2_0            variables=['MD','MAD','RMD','RMAD','MRD','R2','slope','n']
+_5_2_1        if not isinstance(variables,list):
+_5_2_2            raise ValueError(
+_5_2_3                'variables must be a list, None, or one of these strings:
 "all","common"')
-_5_1_4
-_5_1_5        return variables
-_5_1_6
-_5_1_7    def summary_dict(self, variables=None, fitline_kw=None,
+_5_2_4
+_5_2_5        return variables
+_5_2_6
+_5_2_7    def summary_dict(self, variables=None, fitline_kw=None,
 floatformat_fiteqn='{:.3f}'):
-_5_1_8        '''Summarize bivariate statistics into a dict
-_5_1_9
-_5_2_0        Parameters
-_5_2_1        ----------
-_5_2_2        vars : list or str, default='common'
-_5_2_3            names of attribute variables to include in summary
-_5_2_4            names are case insensitive
-_5_2_5            The following strings are also accepted in place of a list
-_5_2_6                "all" (displays all variables)
-_5_2_7                "common" (displays all measures of mean difference)
-_5_2_8        fitline_kw : dict, default=None
-_5_2_9            keywords passed to `fitline`
-_5_3_0        floatformat_fiteqn : str, default=floatformat
-_5_3_1            format specifier for slope and intercept (a,b) in y = a x + b
-_5_3_2
-_5_3_3        Returns
-_5_3_4        -------
-_5_3_5        summary : dict
-_5_3_6            names and values of variables
-_5_3_7        '''
-_5_3_8
-_5_3_9        # List of variables
-_5_4_0        variables = self._expand_variables(variables)
-_5_4_1
-_5_4_2        if fitline_kw is None:
-_5_4_3            fitline_kw = {'method':'sma',
-_5_4_4                          'intercept':True}
-_5_4_5
-_5_4_6        # Construct the dict
-_5_4_7        summary = {}
-_5_4_8        for v in variables:
-_5_4_9            if v in ['slope','intercept']:
-_5_5_0                # These variables are object methods
-_5_5_1                func = getattr(self,v)
-_5_5_2                value = func(**fitline_kw)
-_5_5_3            elif v == 'fitline':
-_5_5_4                line = self.fitline(**fitline_kw)
-_5_5_5                v,value = bivariate_line_equation
+_5_2_8        '''Summarize bivariate statistics into a dict
+_5_2_9
+_5_3_0        Parameters
+_5_3_1        ----------
+_5_3_2        vars : list or str, default='common'
+_5_3_3            names of attribute variables to include in summary
+_5_3_4            names are case insensitive
+_5_3_5            The following strings are also accepted in place of a list
+_5_3_6                "all" (displays all variables)
+_5_3_7                "common" (displays all measures of mean difference)
+_5_3_8        fitline_kw : dict, default=None
+_5_3_9            keywords passed to `fitline`
+_5_4_0        floatformat_fiteqn : str, default=floatformat
+_5_4_1            format specifier for slope and intercept (a,b) in y = a x + b
+_5_4_2
+_5_4_3        Returns
+_5_4_4        -------
+_5_4_5        summary : dict
+_5_4_6            names and values of variables
+_5_4_7        '''
+_5_4_8
+_5_4_9        # List of variables
+_5_5_0        variables = self._expand_variables(variables)
+_5_5_1
+_5_5_2        if fitline_kw is None:
+_5_5_3            fitline_kw = {'method':'sma',
+_5_5_4                          'intercept':True}
+_5_5_5
+_5_5_6        # Construct the dict
+_5_5_7        summary = {}
+_5_5_8        for v in variables:
+_5_5_9            if v in ['slope','intercept']:
+_5_6_0                # These variables are object methods
+_5_6_1                func = getattr(self,v)
+_5_6_2                value = func(**fitline_kw)
+_5_6_3            elif v == 'fitline':
+_5_6_4                line = self.fitline(**fitline_kw)
+_5_6_5                v,value = bivariate_line_equation
 (line,floatformat_fiteqn,ystring='separate')
-_5_5_6            else:
-_5_5_7                # Retrieve values
-_5_5_8                value = getattr(self,v.lower())
-_5_5_9
-_5_6_0            # summary += (stringformat+'='+floatformat+'\n').format(v,value)
-_5_6_1            summary[v] = value
-_5_6_2
-_5_6_3        return summary
-_5_6_4
-_5_6_5    def summary(self, variables=None, fitline_kw=None,
-_5_6_6                intformat='{:d}', floatformat='{:.4f}',
-floatformat_fiteqn=None,
-_5_6_7                stringlength=None ):
-_5_6_8        '''Summarize bivariate statistics
+_5_6_6            else:
+_5_6_7                # Retrieve values
+_5_6_8                value = getattr(self,v.lower())
 _5_6_9
-_5_7_0        Parameters
-_5_7_1        ----------
-_5_7_2        vars : list or str, default='common'
-_5_7_3            names of attribute variables to include in summary
-_5_7_4            names are case insensitive
-_5_7_5            The following strings are also accepted in place of a list
-_5_7_6                "all" (displays all variables)
-_5_7_7                "common" (displays all measures of mean difference)
-_5_7_8        fitline_kw : dict, default=None
-_5_7_9            keywords passed to `fitline`
-_5_8_0        intformat : str, default='{:d}'
-_5_8_1            format specifier for integer values
-_5_8_2        floatformat : str, default='{:.4f}'
-_5_8_3            format specifier for floating point values
-_5_8_4        floatformat_fiteqn : str, default=floatformat
-_5_8_5            format specifier for slope and intercept (a,b) in y = a x + b
-_5_8_6        stringlength : int, default=None
-_5_8_7            length of the variables on output
-_5_8_8            default (None) is to use the length of the longest variable name
-_5_8_9
-_5_9_0        Returns
-_5_9_1        -------
-_5_9_2        summary : str
-_5_9_3            names and values of variables
-_5_9_4        '''
-_5_9_5        # List of variables
-_5_9_6        variables = self._expand_variables(variables)
-_5_9_7
-_5_9_8        if floatformat_fiteqn is None:
-_5_9_9            floatformat_fiteqn = floatformat
-_6_0_0        if stringlength is None:
-_6_0_1            stringlength = np.max([len(v) for v in variables])
-_6_0_2        stringformat = '{:'+str(stringlength)+'s}'
-_6_0_3
-_6_0_4        # Get a dict containing the needed variables
-_6_0_5        summarydict = self.summary_dict( variables, fitline_kw,
-floatformat_fiteqn )
-_6_0_6
-_6_0_7        # Extract length of the float numbers from floatformat
-_6_0_8        # import re
-_6_0_9        # floatlength = np.floor( float( re.findall("[-+]?(?:\d*\.*\d+)",
-_6_1_0        #       floatformat )[0] ) ).astype(int)
-_6_1_1
-_6_1_2        # summary = (stringformat+'{:>10s}').format('Variable','Value')
-_6_1_3        summarytext = ''
-_6_1_4        for k,v in summarydict.items():
-_6_1_5            vstr = _number2str(v,intformat,floatformat)
-_6_1_6            summarytext += (stringformat+' = {:s}\n').format(k,vstr)
-_6_1_7
-_6_1_8        return summarytext
-_6_1_9
-_6_2_0    def summary_fig_inset(self, ax, variables=None, fitline_kw=None,
-_6_2_1                          intformat='{:d}', floatformat='{:.3f}',
+_5_7_0            # summary += (stringformat+'='+floatformat+'\n').format(v,value)
+_5_7_1            summary[v] = value
+_5_7_2
+_5_7_3        return summary
+_5_7_4
+_5_7_5    def summary(self, variables=None, fitline_kw=None,
+_5_7_6                intformat='{:d}', floatformat='{:.4f}',
 floatformat_fiteqn=None,
-_6_2_2                          loc=None, loc_units='axes',
-_6_2_3                          **kwargs):
-_6_2_4        '''Display bivariate statistics as a table inset on a plot axis
-_6_2_5
-_6_2_6        Parameters
-_6_2_7        ----------
-_6_2_8        ax : matplotlib.Figure.Axis
-_6_2_9            axis where the table will be displayed
-_6_3_0        variables : list or str, default='common'
-_6_3_1            names of attribute variables to include in summary
-_6_3_2            names are case insensitive
-_6_3_3            The following strings are also accepted in place of a list
-_6_3_4                "all" (displays all variables)
-_6_3_5                "common" (displays all measures of mean difference)
-_6_3_6        fitline_kw : dict, default=None
-_6_3_7            keywords passed to `fitline`
-_6_3_8        intformat : str, default='{:d}'
-_6_3_9            format specifier for integer values
-_6_4_0        floatformat : str, default='{:.3f}'
-_6_4_1            format specifier for floating point values
-_6_4_2        floatformat_fiteqn : str, default=floatformat
-_6_4_3            format specifier for slope and intercept (a,b) in y = a x + b
-_6_4_4        loc : tuple (x0,y0), default=(0.85, 0.05)
-_6_4_5            location on the axis where the table will be drawn
-_6_4_6            can be in data units or axes units [0-1]
-_6_4_7        loc_units : {'axes' (default), 'data'}
-_6_4_8            specifies whether loc has 'data' units or 'axes' units [0-1]
-_6_4_9
-_6_5_0        Returns
-_6_5_1        -------
-_6_5_2        text1, text2 : matplotlib text object
-_6_5_3            Artist for the two text boxes
-_6_5_4        '''
-_6_5_5        # List of variables
-_6_5_6        variables = self._expand_variables(variables)
-_6_5_7
-_6_5_8        if floatformat_fiteqn is None:
-_6_5_9            floatformat_fiteqn = floatformat
-_6_6_0
-_6_6_1        # Default location in lower right corner
-_6_6_2        if loc is None:
-_6_6_3            loc = (0.8,0.05)
-_6_6_4
-_6_6_5        # Coordinates for loc
-_6_6_6        if loc_units.lower()=='data':
-_6_6_7            coord=ax.transData
-_6_6_8        elif loc_units.lower() in ['axes','axis']:
-_6_6_9            coord=ax.transAxes
-_6_7_0        else:
-_6_7_1            raise ValueError('Display units should be "Data" or "Axes"')
-_6_7_2
-_6_7_3        # Get a dict containing the needed variables
-_6_7_4        summarydict = self.summary_dict( variables, fitline_kw,
+_5_7_7                stringlength=None ):
+_5_7_8        '''Summarize bivariate statistics
+_5_7_9
+_5_8_0        Parameters
+_5_8_1        ----------
+_5_8_2        vars : list or str, default='common'
+_5_8_3            names of attribute variables to include in summary
+_5_8_4            names are case insensitive
+_5_8_5            The following strings are also accepted in place of a list
+_5_8_6                "all" (displays all variables)
+_5_8_7                "common" (displays all measures of mean difference)
+_5_8_8        fitline_kw : dict, default=None
+_5_8_9            keywords passed to `fitline`
+_5_9_0        intformat : str, default='{:d}'
+_5_9_1            format specifier for integer values
+_5_9_2        floatformat : str, default='{:.4f}'
+_5_9_3            format specifier for floating point values
+_5_9_4        floatformat_fiteqn : str, default=floatformat
+_5_9_5            format specifier for slope and intercept (a,b) in y = a x + b
+_5_9_6        stringlength : int, default=None
+_5_9_7            length of the variables on output
+_5_9_8            default (None) is to use the length of the longest variable name
+_5_9_9
+_6_0_0        Returns
+_6_0_1        -------
+_6_0_2        summary : str
+_6_0_3            names and values of variables
+_6_0_4        '''
+_6_0_5        # List of variables
+_6_0_6        variables = self._expand_variables(variables)
+_6_0_7
+_6_0_8        if floatformat_fiteqn is None:
+_6_0_9            floatformat_fiteqn = floatformat
+_6_1_0        if stringlength is None:
+_6_1_1            stringlength = np.max([len(v) for v in variables])
+_6_1_2        stringformat = '{:'+str(stringlength)+'s}'
+_6_1_3
+_6_1_4        # Get a dict containing the needed variables
+_6_1_5        summarydict = self.summary_dict( variables, fitline_kw,
 floatformat_fiteqn )
-_6_7_5
-_6_7_6        # Column of label text
-_6_7_7        label_text = '\n'.join([_texify_name(key)
-_6_7_8                                for key in summarydict])
-_6_7_9        # Column of value text
-_6_8_0        value_text = '\n'.join([_number2str(v,intformat,floatformat)
-_6_8_1                                for v in summarydict.values()])
+_6_1_6
+_6_1_7        # Extract length of the float numbers from floatformat
+_6_1_8        # import re
+_6_1_9        # floatlength = np.floor( float( re.findall("[-+]?(?:\d*\.*\d+)",
+_6_2_0        #       floatformat )[0] ) ).astype(int)
+_6_2_1
+_6_2_2        # summary = (stringformat+'{:>10s}').format('Variable','Value')
+_6_2_3        summarytext = ''
+_6_2_4        for k,v in summarydict.items():
+_6_2_5            vstr = _number2str(v,intformat,floatformat)
+_6_2_6            summarytext += (stringformat+' = {:s}\n').format(k,vstr)
+_6_2_7
+_6_2_8        return summarytext
+_6_2_9
+_6_3_0    def summary_fig_inset(self, ax, variables=None, fitline_kw=None,
+_6_3_1                          intformat='{:d}', floatformat='{:.3f}',
+floatformat_fiteqn=None,
+_6_3_2                          loc=None, loc_units='axes',
+_6_3_3                          **kwargs):
+_6_3_4        '''Display bivariate statistics as a table inset on a plot axis
+_6_3_5
+_6_3_6        Parameters
+_6_3_7        ----------
+_6_3_8        ax : matplotlib.Figure.Axis
+_6_3_9            axis where the table will be displayed
+_6_4_0        variables : list or str, default='common'
+_6_4_1            names of attribute variables to include in summary
+_6_4_2            names are case insensitive
+_6_4_3            The following strings are also accepted in place of a list
+_6_4_4                "all" (displays all variables)
+_6_4_5                "common" (displays all measures of mean difference)
+_6_4_6        fitline_kw : dict, default=None
+_6_4_7            keywords passed to `fitline`
+_6_4_8        intformat : str, default='{:d}'
+_6_4_9            format specifier for integer values
+_6_5_0        floatformat : str, default='{:.3f}'
+_6_5_1            format specifier for floating point values
+_6_5_2        floatformat_fiteqn : str, default=floatformat
+_6_5_3            format specifier for slope and intercept (a,b) in y = a x + b
+_6_5_4        loc : tuple (x0,y0), default=(0.85, 0.05)
+_6_5_5            location on the axis where the table will be drawn
+_6_5_6            can be in data units or axes units [0-1]
+_6_5_7        loc_units : {'axes' (default), 'data'}
+_6_5_8            specifies whether loc has 'data' units or 'axes' units [0-1]
+_6_5_9
+_6_6_0        Returns
+_6_6_1        -------
+_6_6_2        text1, text2 : matplotlib text object
+_6_6_3            Artist for the two text boxes
+_6_6_4        '''
+_6_6_5        # List of variables
+_6_6_6        variables = self._expand_variables(variables)
+_6_6_7
+_6_6_8        if floatformat_fiteqn is None:
+_6_6_9            floatformat_fiteqn = floatformat
+_6_7_0
+_6_7_1        # Default location in lower right corner
+_6_7_2        if loc is None:
+_6_7_3            loc = (0.8,0.05)
+_6_7_4
+_6_7_5        # Coordinates for loc
+_6_7_6        if loc_units.lower()=='data':
+_6_7_7            coord=ax.transData
+_6_7_8        elif loc_units.lower() in ['axes','axis']:
+_6_7_9            coord=ax.transAxes
+_6_8_0        else:
+_6_8_1            raise ValueError('Display units should be "Data" or "Axes"')
 _6_8_2
-_6_8_3        # Check if horizontal alignment keyword is used
-_6_8_4        ha=''
-_6_8_5        try:
-_6_8_6            ha = kwargs['ha']
-_6_8_7        except KeyError:
-_6_8_8            pass
-_6_8_9        try:
-_6_9_0            ha = kwargs['horizontalalignment']
-_6_9_1        except KeyError:
-_6_9_2            pass
-_6_9_3
-_6_9_4        # For right alignment, align on values first
-_6_9_5        # Otherwise, align on labels
-_6_9_6        if ha=='right':
-_6_9_7            first_text = value_text
-_6_9_8            second_text = label_text
-_6_9_9            sign = -1
-_7_0_0        else:
-_7_0_1            first_text = label_text
-_7_0_2            second_text = value_text
-_7_0_3            sign = +1
-_7_0_4
-_7_0_5        # Add first column of text
-_7_0_6        t1=ax.text(loc[0],loc[1],
-_7_0_7                first_text,
-_7_0_8                transform=coord,
-_7_0_9                **kwargs
-_7_1_0                )
-_7_1_1
-_7_1_2        # Get width of first text column
-_7_1_3        bbox = t1.get_window_extent().transformed(coord.inverted())
-_7_1_4        width = bbox.x1-bbox.x0
-_7_1_5
-_7_1_6        # Add second column of text
-_7_1_7        t2 = ax.text(loc[0]+width*sign,loc[1],
-_7_1_8                     second_text,
-_7_1_9                     transform=coord,
-_7_2_0                     **kwargs
-_7_2_1                     )
-_7_2_2
-_7_2_3        ##################################
-_7_2_4        # Early version of this function using matplotlib.table.table()
+_6_8_3        # Get a dict containing the needed variables
+_6_8_4        summarydict = self.summary_dict( variables, fitline_kw,
+floatformat_fiteqn )
+_6_8_5
+_6_8_6        # Column of label text
+_6_8_7        label_text = '\n'.join([_texify_name(key)
+_6_8_8                                for key in summarydict])
+_6_8_9        # Column of value text
+_6_9_0        value_text = '\n'.join([_number2str(v,intformat,floatformat)
+_6_9_1                                for v in summarydict.values()])
+_6_9_2
+_6_9_3        # Check if horizontal alignment keyword is used
+_6_9_4        ha=''
+_6_9_5        try:
+_6_9_6            ha = kwargs['ha']
+_6_9_7        except KeyError:
+_6_9_8            pass
+_6_9_9        try:
+_7_0_0            ha = kwargs['horizontalalignment']
+_7_0_1        except KeyError:
+_7_0_2            pass
+_7_0_3
+_7_0_4        # For right alignment, align on values first
+_7_0_5        # Otherwise, align on labels
+_7_0_6        if ha=='right':
+_7_0_7            first_text = value_text
+_7_0_8            second_text = label_text
+_7_0_9            sign = -1
+_7_1_0        else:
+_7_1_1            first_text = label_text
+_7_1_2            second_text = value_text
+_7_1_3            sign = +1
+_7_1_4
+_7_1_5        # Add first column of text
+_7_1_6        t1=ax.text(loc[0],loc[1],
+_7_1_7                first_text,
+_7_1_8                transform=coord,
+_7_1_9                **kwargs
+_7_2_0                )
+_7_2_1
+_7_2_2        # Get width of first text column
+_7_2_3        bbox = t1.get_window_extent().transformed(coord.inverted())
+_7_2_4        width = bbox.x1-bbox.x0
 _7_2_5
-_7_2_6        # if isinstance(loc,(tuple,list)):
-_7_2_7        #     # Create an inset axis to contain the table
-_7_2_8        #     tableaxis = ax.inset_axes(loc)
-_7_2_9        #     table_width=1
-_7_3_0        # else:
-_7_3_1        #     tableaxis = ax
+_7_2_6        # Add second column of text
+_7_2_7        t2 = ax.text(loc[0]+width*sign,loc[1],
+_7_2_8                     second_text,
+_7_2_9                     transform=coord,
+_7_3_0                     **kwargs
+_7_3_1                     )
 _7_3_2
-_7_3_3        # # Display the table on the axis
-_7_3_4        # return mtable.table(
-_7_3_5        #     tableaxis,
-_7_3_6        #     cellText=[[floatformat.format(value)] for value in
-summarydict.values()],
-_7_3_7        #     rowLabels=[texify_name(key) for key in summarydict],
-_7_3_8        #     colWidths=[table_width/2]*2,
-_7_3_9        #     edges=edges,
-_7_4_0        #     loc=loc, bbox=bbox
-_7_4_1        #     )
+_7_3_3        ##################################
+_7_3_4        # Early version of this function using matplotlib.table.table()
+_7_3_5
+_7_3_6        # if isinstance(loc,(tuple,list)):
+_7_3_7        #     # Create an inset axis to contain the table
+_7_3_8        #     tableaxis = ax.inset_axes(loc)
+_7_3_9        #     table_width=1
+_7_4_0        # else:
+_7_4_1        #     tableaxis = ax
 _7_4_2
-_7_4_3        return [t1,t2]
+_7_4_3        # # Display the table on the axis
+_7_4_4        # return mtable.table(
+_7_4_5        #     tableaxis,
+_7_4_6        #     cellText=[[floatformat.format(value)] for value in
+summarydict.values()],
+_7_4_7        #     rowLabels=[texify_name(key) for key in summarydict],
+_7_4_8        #     colWidths=[table_width/2]*2,
+_7_4_9        #     edges=edges,
+_7_5_0        #     loc=loc, bbox=bbox
+_7_5_1        #     )
+_7_5_2
+_7_5_3        return [t1,t2]
 A suite of common statistics to quantify bivariate relationships
 Class method 'summary' provides a formatted summary of these statistics
 ** AAttttrriibbuutteess **
     * ccoouunntt,, nn (int): number of valid (not NaN) data value pairs
     * xxmmeeaann,, yymmeeaann (float): mean of x and y variables
     * xxmmeeddiiaann,, yymmeeddiiaann (float): median of x and y variables
     * xxssttdd,, yyssttdd (float): standard deviation of x and y variables
     * mmeeaann__ddiiffffeerreennccee,, mmdd (float): ymean - xmean
+    * ssttdd__ddiiffffeerreennccee,, ssttdddd (float): std( y - x )
     * mmeeaann__aabbssoolluuttee__ddiiffffeerreennccee,, mmaadd (float): mean( |y-x| )
     * rreellaattiivvee__mmeeaann__ddiiffffeerreennccee,, rrmmdd (float): md / xmean
     * rreellaattiivvee__mmeeaann__aabbssoolluuttee__ddiiffffeerreennccee,, rrmmaadd (float): mad / xmean
     * ssttaannddaarrddiizzeedd__mmeeaann__ddiiffffeerreennccee,, ssmmdd (float): md / xstd
     * ssttaannddaarrddiizzeedd__mmeeaann__aabbssoolluuttee__ddiiffffeerreennccee,, ssmmaadd (float): mad /xstd
     * mmeeaann__rreellaattiivvee__ddiiffffeerreennccee,, mmrrdd (float): mean(y/x) - 1
     * mmeeaann__lloogg1100__rraattiioo,, mmllrr (float): mean( log10(y/x) )
+    * ssttdd__lloogg1100__rraattiioo,, ssttddllrr (float): std( log10(y/x) )
     * mmeeaann__aabbssoolluuttee__lloogg1100__rraattiioo,, mmaallrr (float): mean( abs( log10(y/x) ) )
     * mmeeddiiaann__ddiiffffeerreennccee,, mmeedddd (float): median(y-x)
     * mmeeddiiaann__aabbssoolluuttee__ddiiffffeerreennccee,, mmeeddaadd (float): median(|y-x|)
     * rreellaattiivvee__mmeeddiiaann__ddiiffffeerreennccee,, rrmmeedddd (float): median(y-x) / xmedian
     * rreellaattiivvee__mmeeddiiaann__aabbssoolluuttee__ddiiffffeerreennccee,, rrmmeeddaadd (float): median(|y-x|) /
       xmedian
     * mmeeddiiaann__rreellaattiivvee__ddiiffffeerreennccee,, mmeeddiiaannrrdd,, mmeeddrrdd (float): median(y/x)-1
     * mmeeddiiaann__lloogg1100__rraattiioo,, mmeeddllrr (float): median( log10(y/x) )
     * mmeeddiiaann__aabbssoolluuttee__lloogg1100__rraattiioo,, mmeeddaallrr (float): median( abs( log10(y/x) ) )
     * nnoorrmmaalliizzeedd__mmeeaann__bbiiaass__ffaaccttoorr,, nnmmbbff (float): see _n_m_b_f
     * nnoorrmmaalliizzeedd__mmeeaann__aabbssoolluuttee__eerrrroorr__ffaaccttoorr,, nnmmaaeeff (float): see _n_m_a_e_f
     * rroooott__mmeeaann__ssqquuaarree__ddiiffffeerreennccee,, rrmmssdd (float): $\sqrt{ \langle (y - x)^2
       \rangle }$
+    * rroooott__mmeeaann__ssqquuaarree__lloogg1100__rraattiioo,, rrmmssllrr (float): $\sqrt{ \langle log10(y/x)^2
+      \rangle }$
     * ccoovvaarriiaannccee (float): cov(x,y)
     * ccoorrrreellaattiioonn__ppeeaarrssoonn,, ccoorrrreellaattiioonn,, ppeeaarrssoonnrr,, RR,, rr (float): Pearson linear
       correlation coefficient
     * ccoorrrreellaattiioonn__ssppeeaarrmmaann,, ssppeeaarrmmaannrr (float): Spearman, non-parametric rank
       correlation coefficient
     * RR22,, rr22 (float): Linear coefficient of determination, $R^2$
 ??
 BivariateStatistics(x, y, w=None, dropna=False, data=None) View Source
-_2_5_1    def __init__(self,x,y,w=None,dropna=False,data=None):
-_2_5_2        '''Compute suite of bivariate statistics during initialization
-_2_5_3
-_2_5_4        Statistic values are saved in attributes.
-_2_5_5        CAUTION: Weights w are ignored except in SMA fit
-_2_5_6
-_2_5_7        Parameters
-_2_5_8        ----------
-_2_5_9        x : ndarray or str
-_2_6_0            independent variable values
-_2_6_1        y : ndarray or str
-_2_6_2            dependent variable values, same size as x
-_2_6_3        w : ndarray or str, optional
-_2_6_4            weights for points (x,y), same size as x and y
-_2_6_5        dropna : bool, optional (default=False)
-_2_6_6            drops NaN values from x, y, and w
-_2_6_7        data : dict-like, optional
-_2_6_8            if x, y, or w are str, then they should be keys in data
-_2_6_9        '''
-_2_7_0
-_2_7_1        # Get values from data if needed
-_2_7_2        if data is None and (isinstance(x,str) or isinstance(y,str) or
+_2_5_7    def __init__(self,x,y,w=None,dropna=False,data=None):
+_2_5_8        '''Compute suite of bivariate statistics during initialization
+_2_5_9
+_2_6_0        Statistic values are saved in attributes.
+_2_6_1        CAUTION: Weights w are ignored except in SMA fit
+_2_6_2
+_2_6_3        Parameters
+_2_6_4        ----------
+_2_6_5        x : ndarray or str
+_2_6_6            independent variable values
+_2_6_7        y : ndarray or str
+_2_6_8            dependent variable values, same size as x
+_2_6_9        w : ndarray or str, optional
+_2_7_0            weights for points (x,y), same size as x and y
+_2_7_1        dropna : bool, optional (default=False)
+_2_7_2            drops NaN values from x, y, and w
+_2_7_3        data : dict-like, optional
+_2_7_4            if x, y, or w are str, then they should be keys in data
+_2_7_5        '''
+_2_7_6
+_2_7_7        # Get values from data if needed
+_2_7_8        if data is None and (isinstance(x,str) or isinstance(y,str) or
 isinstance(w,str)):
-_2_7_3            raise ValueError( 'Data argument must be used if x, y, or w is a
+_2_7_9            raise ValueError( 'Data argument must be used if x, y, or w is a
 string')
-_2_7_4        if isinstance(x,str):
-_2_7_5            x = data[x]
-_2_7_6        if isinstance(y,str):
-_2_7_7            y = data[y]
-_2_7_8        if isinstance(w,str):
-_2_7_9            w = data[w]
-_2_8_0
-_2_8_1        #Ensure that x and y have same length
-_2_8_2        if len(x) != len(y):
-_2_8_3            raise ValueError( 'Arguments x and y must have the same length'
+_2_8_0        if isinstance(x,str):
+_2_8_1            x = data[x]
+_2_8_2        if isinstance(y,str):
+_2_8_3            y = data[y]
+_2_8_4        if isinstance(w,str):
+_2_8_5            w = data[w]
+_2_8_6
+_2_8_7        #Ensure that x and y have same length
+_2_8_8        if len(x) != len(y):
+_2_8_9            raise ValueError( 'Arguments x and y must have the same length'
 )
-_2_8_4        if w is None:
-_2_8_5            w = np.ones_like(x)
-_2_8_6        if len(w) != len(x):
-_2_8_7            raise ValueError( 'Argument w (if present) must have the same
+_2_9_0        if w is None:
+_2_9_1            w = np.ones_like(x)
+_2_9_2        if len(w) != len(x):
+_2_9_3            raise ValueError( 'Argument w (if present) must have the same
 length as x' )
-_2_8_8
-_2_8_9        # Drop NaN values
-_2_9_0        if dropna:
-_2_9_1            isna = np.isnan(x*y*w)
-_2_9_2            x = x[~isna]
-_2_9_3            y = y[~isna]
-_2_9_4            w = w[~isna]
-_2_9_5
-_2_9_6        # Differences and ratios used repeatedly
-_2_9_7        diff = y - x
-_2_9_8        absdiff = np.abs( y - x )
-_2_9_9        # Ignore divide by zero and 0/0 while dividing
-_3_0_0        old_settings = np.seterr(divide='ignore',invalid='ignore')
-_3_0_1        ratio = y/x
-_3_0_2        log10ratio = np.log10(ratio)
-_3_0_3        np.seterr(**old_settings)
-_3_0_4
-_3_0_5        # Number of data points
-_3_0_6        self.count = self.n = len(x)
-_3_0_7
-_3_0_8        # Means, medians, and standard deviations
-_3_0_9        self.xmean = np.mean(x)
-_3_1_0        self.ymean = np.mean(y)
-_3_1_1        self.xmedian = np.median(x)
-_3_1_2        self.ymedian = np.median(y)
-_3_1_3        self.xstd   = np.std(x)
-_3_1_4        self.ystd   = np.std(y)
-_3_1_5
-_3_1_6        # Save values for use later
-_3_1_7        self._x = x
-_3_1_8        self._y = y
-_3_1_9        self._w = w
-_3_2_0
-_3_2_1        # Mean and mean absolute differences
-_3_2_2        self.mean_difference            = self.md   = self.ymean -
+_2_9_4
+_2_9_5        # Drop NaN values
+_2_9_6        if dropna:
+_2_9_7            isna = np.isnan(x*y*w)
+_2_9_8            x = x[~isna]
+_2_9_9            y = y[~isna]
+_3_0_0            w = w[~isna]
+_3_0_1
+_3_0_2        # Differences and ratios used repeatedly
+_3_0_3        diff = y - x
+_3_0_4        absdiff = np.abs( y - x )
+_3_0_5        # Ignore divide by zero and 0/0 while dividing
+_3_0_6        old_settings = np.seterr(divide='ignore',invalid='ignore')
+_3_0_7        ratio = y/x
+_3_0_8        log10ratio = np.log10(ratio)
+_3_0_9        np.seterr(**old_settings)
+_3_1_0
+_3_1_1        # Number of data points
+_3_1_2        self.count = self.n = len(x)
+_3_1_3
+_3_1_4        # Means, medians, and standard deviations
+_3_1_5        self.xmean = np.mean(x)
+_3_1_6        self.ymean = np.mean(y)
+_3_1_7        self.xmedian = np.median(x)
+_3_1_8        self.ymedian = np.median(y)
+_3_1_9        self.xstd   = np.std(x)
+_3_2_0        self.ystd   = np.std(y)
+_3_2_1
+_3_2_2        # Save values for use later
+_3_2_3        self._x = x
+_3_2_4        self._y = y
+_3_2_5        self._w = w
+_3_2_6
+_3_2_7        # Mean and mean absolute differences
+_3_2_8        self.mean_difference            = self.md   = self.ymean -
 self.xmean
-_3_2_3        self.mean_absolute_difference   = self.mad  = np.mean( absdiff )
-_3_2_4
-_3_2_5        # Relative and standardized differences
-_3_2_6        self.relative_mean_difference           = self.rmd  =
+_3_2_9        self.mean_absolute_difference   = self.mad  = np.mean( absdiff )
+_3_3_0        self.std_difference             = self.stdd = np.std( diff )
+_3_3_1
+_3_3_2        # Relative and standardized differences
+_3_3_3        self.relative_mean_difference           = self.rmd  =
 self.mean_difference / self.xmean
-_3_2_7        self.relative_mean_absolute_difference  = self.rmad =
+_3_3_4        self.relative_mean_absolute_difference  = self.rmad =
 self.mean_absolute_difference / self.xmean
-_3_2_8        self.standardized_mean_difference       = self.smd  =
+_3_3_5        self.standardized_mean_difference       = self.smd  =
 self.mean_difference / self.xstd
-_3_2_9        self.standardized_mean_absolute_difference  = self.smad =
+_3_3_6        self.standardized_mean_absolute_difference  = self.smad =
 self.mean_absolute_difference / self.xstd
-_3_3_0
-_3_3_1        # Mean and median relative differences
-_3_3_2        self.mean_relative_difference   = self.mrd  = np.mean( ratio - 1 )
-_3_3_3        self.median_relative_difference = self.medianrd = self.medrd =
+_3_3_7
+_3_3_8        # Mean and median relative differences
+_3_3_9        self.mean_relative_difference   = self.mrd  = np.mean( ratio - 1 )
+_3_4_0        self.median_relative_difference = self.medianrd = self.medrd =
 np.median( ratio - 1 )
-_3_3_4
-_3_3_5        # Median and median absolute differences
-_3_3_6        self.median_difference          = self.medd  = np.median( diff )
-_3_3_7        self.median_absolute_difference = self.medad = np.median( absdiff )
-_3_3_8
-_3_3_9        # Relative median differences
-_3_4_0        self.relative_median_difference          = self.rmedd  =
+_3_4_1
+_3_4_2        # Median and median absolute differences
+_3_4_3        self.median_difference          = self.medd  = np.median( diff )
+_3_4_4        self.median_absolute_difference = self.medad = np.median( absdiff )
+_3_4_5
+_3_4_6        # Relative median differences
+_3_4_7        self.relative_median_difference          = self.rmedd  =
 self.median_difference / self.xmedian
-_3_4_1        self.relative_median_absolute_difference = self.rmedad =
+_3_4_8        self.relative_median_absolute_difference = self.rmedad =
 self.median_absolute_difference / self.xmedian
-_3_4_2
-_3_4_3        self.normalized_mean_bias_factor            = self.nmbf  = nmbf(x,y)
-_3_4_4        self.normalized_mean_absolute_error_factor  = self.nmaef = nmaef
+_3_4_9
+_3_5_0        self.normalized_mean_bias_factor            = self.nmbf  = nmbf(x,y)
+_3_5_1        self.normalized_mean_absolute_error_factor  = self.nmaef = nmaef
 (x,y)
-_3_4_5
-_3_4_6        # Mean and mean absolute log ratio
-_3_4_7        self.mean_log10_ratio          = self.mlr  = np.mean( log10ratio )
-_3_4_8        self.mean_absolute_log10_ratio = self.malr = np.mean( np.abs
+_3_5_2
+_3_5_3        # Mean and mean absolute log ratio
+_3_5_4        self.mean_log10_ratio          = self.mlr  = np.mean( log10ratio )
+_3_5_5        self.mean_absolute_log10_ratio = self.malr = np.mean( np.abs
 ( log10ratio ) )
-_3_4_9
-_3_5_0        # Median and median absolute log ratio
-_3_5_1        self.median_log10_ratio          = self.medlr  = np.median
+_3_5_6        self.std_log10_ratio           = self.stdlr= np.std( log10ratio )
+_3_5_7
+_3_5_8        # Median and median absolute log ratio
+_3_5_9        self.median_log10_ratio          = self.medlr  = np.median
 ( log10ratio )
-_3_5_2        self.median_absolute_log10_ratio = self.medalr = np.median( np.abs
+_3_6_0        self.median_absolute_log10_ratio = self.medalr = np.median( np.abs
 ( log10ratio ) )
-_3_5_3
-_3_5_4        # RMS difference
-_3_5_5        self.root_mean_square_difference    = self.rmsd     = np.sqrt
-( np.mean( np.power( diff, 2) ) )
-_3_5_6
-_3_5_7        # Covariance, correlation
-_3_5_8        self.covariance = np.cov(x,y)[0][1]
-_3_5_9        self.correlation = self.correlation_pearson = self.R = self.r =
+_3_6_1
+_3_6_2        # RMS difference
+_3_6_3        self.root_mean_square_difference = self.rmsd   = np.sqrt( np.mean
+( np.power( diff, 2) ) )
+_3_6_4        # RMS log ratio
+_3_6_5        self.root_mean_square_log10_ratio = self.rmslr = np.sqrt( np.mean
+( np.power( log10ratio, 2 )))
+_3_6_6
+_3_6_7        # Covariance, correlation
+_3_6_8        self.covariance = np.cov(x,y)[0][1]
+_3_6_9        self.correlation = self.correlation_pearson = self.R = self.r =
 self.pearsonr = \
-_3_6_0            np.corrcoef(x,y)[0][1]
-_3_6_1        self.correlation_spearman = self.spearmanr = stats.spearmanr
+_3_7_0            np.corrcoef(x,y)[0][1]
+_3_7_1        self.correlation_spearman = self.spearmanr = stats.spearmanr
 (x,y).statistic
-_3_6_2        self.R2 = self.r2 = self.R**2
+_3_7_2        self.R2 = self.r2 = self.R**2
 Compute suite of bivariate statistics during initialization
 Statistic values are saved in attributes. CAUTION: Weights w are ignored except
 in SMA fit
 ** PPaarraammeetteerrss **
     * xx (ndarray or str): independent variable values
     * yy (ndarray or str): dependent variable values, same size as x
     * ww (ndarray or str, optional): weights for points (x,y), same size as x
@@ -1571,213 +1602,213 @@
 xmedian
 ymedian
 xstd
 ystd
 covariance
 ??
 def fitline(self, method='sma', intercept=True, **kwargs): View Source
-_3_6_8    def fitline(self,method='sma',intercept=True,**kwargs):
-_3_6_9        '''Compute bivariate line fit
-_3_7_0
-_3_7_1        Parameters
-_3_7_2        ----------
-_3_7_3        method : str
-_3_7_4            line fitting method: sma (default), ols, wls, York, sen, siegel
-_3_7_5        intercept : bool
-_3_7_6            defines whether non-zero intercept should be fitted
-_3_7_7        **kwargs
-_3_7_8            passed to `acgc.stats.sma` (e.g. robust=True)
-_3_7_9
-_3_8_0        Returns
-_3_8_1        -------
-_3_8_2        result : dict
-_3_8_3            dictionary with keys:
-_3_8_4            - slope (float)
-_3_8_5                slope of fitted line
-_3_8_6            - intercept (float)
-_3_8_7                intercept of fitted line
-_3_8_8            - fittedvalues (array (N,))
-_3_8_9                values on fit line
-_3_9_0            - residuals (array (N,))
-_3_9_1                residual from fit line
-_3_9_2        '''
-_3_9_3
-_3_9_4        fitintercept = intercept
-_3_9_5
-_3_9_6        if method.lower()=='sma':
-_3_9_7            fit = sma(  self._x,
-_3_9_8                        self._y,
-_3_9_9                        self._w,
-_4_0_0                        intercept=fitintercept,
-_4_0_1                        **kwargs)
-_4_0_2            slope = fit['slope']
-_4_0_3            intercept= fit['intercept']
-_4_0_4
-_4_0_5        elif method.lower()=='ols':
-_4_0_6            if fitintercept:
-_4_0_7                ols = np.linalg.lstsq( np.vstack([self._x,np.ones(len
+_3_7_8    def fitline(self,method='sma',intercept=True,**kwargs):
+_3_7_9        '''Compute bivariate line fit
+_3_8_0
+_3_8_1        Parameters
+_3_8_2        ----------
+_3_8_3        method : str
+_3_8_4            line fitting method: sma (default), ols, wls, York, sen, siegel
+_3_8_5        intercept : bool
+_3_8_6            defines whether non-zero intercept should be fitted
+_3_8_7        **kwargs
+_3_8_8            passed to `acgc.stats.sma` (e.g. robust=True)
+_3_8_9
+_3_9_0        Returns
+_3_9_1        -------
+_3_9_2        result : dict
+_3_9_3            dictionary with keys:
+_3_9_4            - slope (float)
+_3_9_5                slope of fitted line
+_3_9_6            - intercept (float)
+_3_9_7                intercept of fitted line
+_3_9_8            - fittedvalues (array (N,))
+_3_9_9                values on fit line
+_4_0_0            - residuals (array (N,))
+_4_0_1                residual from fit line
+_4_0_2        '''
+_4_0_3
+_4_0_4        fitintercept = intercept
+_4_0_5
+_4_0_6        if method.lower()=='sma':
+_4_0_7            fit = sma(  self._x,
+_4_0_8                        self._y,
+_4_0_9                        self._w,
+_4_1_0                        intercept=fitintercept,
+_4_1_1                        **kwargs)
+_4_1_2            slope = fit['slope']
+_4_1_3            intercept= fit['intercept']
+_4_1_4
+_4_1_5        elif method.lower()=='ols':
+_4_1_6            if fitintercept:
+_4_1_7                ols = np.linalg.lstsq( np.vstack([self._x,np.ones(len
 (self._x))]).T,
-_4_0_8                                      self._y, rcond=None )
-_4_0_9            else:
-_4_1_0                ols = np.linalg.lstsq( np.vstack([self._x]).T, self._y,
+_4_1_8                                      self._y, rcond=None )
+_4_1_9            else:
+_4_2_0                ols = np.linalg.lstsq( np.vstack([self._x]).T, self._y,
 rcond=None )
-_4_1_1            slope = ols[0][0]
-_4_1_2            intercept = ols[0][1]
-_4_1_3
-_4_1_4        elif method.lower() in ['theil','sen','theilsen']:
-_4_1_5            fitintercept = True
-_4_1_6            fit = sen( self._x,
-_4_1_7                       self._y,
-_4_1_8                       **kwargs)
-_4_1_9            slope = fit.slope
-_4_2_0            intercept = fit.intercept
-_4_2_1
-_4_2_2        elif method.lower()=='siegel':
-_4_2_3            fitintercept = True
-_4_2_4            siegel = stats.siegelslopes( self._x,
-_4_2_5                                         self._y )
-_4_2_6            slope = siegel.slope
-_4_2_7            intercept = siegel.intercept
-_4_2_8
-_4_2_9        elif method.lower()=='wls':
-_4_3_0            raise NotImplementedError('WLS regression not implemented yet')
+_4_2_1            slope = ols[0][0]
+_4_2_2            intercept = ols[0][1]
+_4_2_3
+_4_2_4        elif method.lower() in ['theil','sen','theilsen']:
+_4_2_5            fitintercept = True
+_4_2_6            fit = sen( self._x,
+_4_2_7                       self._y,
+_4_2_8                       **kwargs)
+_4_2_9            slope = fit.slope
+_4_3_0            intercept = fit.intercept
 _4_3_1
-_4_3_2        elif method.lower()=='york':
-_4_3_3            raise NotImplementedError('York regression not implemented yet')
-_4_3_4
-_4_3_5        else:
-_4_3_6            raise ValueError('Undefined method '+method)
-_4_3_7
-_4_3_8        line = dict( slope          = slope,
-_4_3_9                     intercept      = intercept,
-_4_4_0                     fittedvalues   = slope * self._x + intercept,
-_4_4_1                     residuals      = self._y - ( slope * self._x +
-intercept ),
-_4_4_2                     method         = method,
-_4_4_3                     fitintercept   = fitintercept )
+_4_3_2        elif method.lower()=='siegel':
+_4_3_3            fitintercept = True
+_4_3_4            siegel = stats.siegelslopes( self._x,
+_4_3_5                                         self._y )
+_4_3_6            slope = siegel.slope
+_4_3_7            intercept = siegel.intercept
+_4_3_8
+_4_3_9        elif method.lower()=='wls':
+_4_4_0            raise NotImplementedError('WLS regression not implemented yet')
+_4_4_1
+_4_4_2        elif method.lower()=='york':
+_4_4_3            raise NotImplementedError('York regression not implemented yet')
 _4_4_4
-_4_4_5        return line
+_4_4_5        else:
+_4_4_6            raise ValueError('Undefined method '+method)
+_4_4_7
+_4_4_8        line = dict( slope          = slope,
+_4_4_9                     intercept      = intercept,
+_4_5_0                     fittedvalues   = slope * self._x + intercept,
+_4_5_1                     residuals      = self._y - ( slope * self._x +
+intercept ),
+_4_5_2                     method         = method,
+_4_5_3                     fitintercept   = fitintercept )
+_4_5_4
+_4_5_5        return line
 Compute bivariate line fit
 ** PPaarraammeetteerrss **
     * mmeetthhoodd (str): line fitting method: sma (default), ols, wls, York, sen,
       siegel
     * iinntteerrcceepptt (bool): defines whether non-zero intercept should be fitted
     * ****kkwwaarrggss: passed to acgc.stats.sma (e.g. robust=True)
 ** RReettuurrnnss **
     * rreessuulltt (dict): dictionary with keys:
           o slope (float) slope of fitted line
           o intercept (float) intercept of fitted line
           o fittedvalues (array (N,)) values on fit line
           o residuals (array (N,)) residual from fit line
 ??
 def slope(self, method='sma', intercept=True, **kwargs): View Source
-_4_4_7    def slope(self,method='sma',intercept=True,**kwargs):
-_4_4_8        '''Compute slope of bivariate line fit
-_4_4_9
-_4_5_0        Parameters
-_4_5_1        ----------
-_4_5_2        method : str
-_4_5_3            line fitting method: sma (default), ols, wls
-_4_5_4        intercept : bool
-_4_5_5            defines whether non-zero intercept should be fitted
-_4_5_6        **kwargs
-_4_5_7            passed to `fitline`
-_4_5_8
-_4_5_9        Returns
-_4_6_0        -------
-_4_6_1        slope : float
-_4_6_2            value of y intercept
-_4_6_3        '''
-_4_6_4        return self.fitline(method,intercept,**kwargs)['slope']
+_4_5_7    def slope(self,method='sma',intercept=True,**kwargs):
+_4_5_8        '''Compute slope of bivariate line fit
+_4_5_9
+_4_6_0        Parameters
+_4_6_1        ----------
+_4_6_2        method : str
+_4_6_3            line fitting method: sma (default), ols, wls
+_4_6_4        intercept : bool
+_4_6_5            defines whether non-zero intercept should be fitted
+_4_6_6        **kwargs
+_4_6_7            passed to `fitline`
+_4_6_8
+_4_6_9        Returns
+_4_7_0        -------
+_4_7_1        slope : float
+_4_7_2            value of y intercept
+_4_7_3        '''
+_4_7_4        return self.fitline(method,intercept,**kwargs)['slope']
 Compute slope of bivariate line fit
 ** PPaarraammeetteerrss **
     * mmeetthhoodd (str): line fitting method: sma (default), ols, wls
     * iinntteerrcceepptt (bool): defines whether non-zero intercept should be fitted
     * ****kkwwaarrggss: passed to _f_i_t_l_i_n_e
 ** RReettuurrnnss **
     * ssllooppee (float): value of y intercept
 ??
 def intercept(self, method='sma', intercept=True, **kwargs): View Source
-_4_6_6    def intercept(self,method='sma',intercept=True,**kwargs):
-_4_6_7        '''Compute intercept of bivariate line fit
-_4_6_8
-_4_6_9        Parameters
-_4_7_0        ----------
-_4_7_1        method : str
-_4_7_2            line fitting method: sma (default) or ols
-_4_7_3        intercept : bool
-_4_7_4            defines whether non-zero intercept should be fitted
-_4_7_5        **kwargs
-_4_7_6            passed to `fitline`
-_4_7_7
-_4_7_8        Returns
-_4_7_9        -------
-_4_8_0        intercept : float
-_4_8_1            value of y intercept
-_4_8_2        '''
-_4_8_3        return self.fitline(method,intercept,**kwargs)['intercept']
+_4_7_6    def intercept(self,method='sma',intercept=True,**kwargs):
+_4_7_7        '''Compute intercept of bivariate line fit
+_4_7_8
+_4_7_9        Parameters
+_4_8_0        ----------
+_4_8_1        method : str
+_4_8_2            line fitting method: sma (default) or ols
+_4_8_3        intercept : bool
+_4_8_4            defines whether non-zero intercept should be fitted
+_4_8_5        **kwargs
+_4_8_6            passed to `fitline`
+_4_8_7
+_4_8_8        Returns
+_4_8_9        -------
+_4_9_0        intercept : float
+_4_9_1            value of y intercept
+_4_9_2        '''
+_4_9_3        return self.fitline(method,intercept,**kwargs)['intercept']
 Compute intercept of bivariate line fit
 ** PPaarraammeetteerrss **
     * mmeetthhoodd (str): line fitting method: sma (default) or ols
     * iinntteerrcceepptt (bool): defines whether non-zero intercept should be fitted
     * ****kkwwaarrggss: passed to _f_i_t_l_i_n_e
 ** RReettuurrnnss **
     * iinntteerrcceepptt (float): value of y intercept
 ??
 def summary_dict(self, variables=None, fitline_kw=None, floatformat_fiteqn='
 {:.3f}'): View Source
-_5_1_7    def summary_dict(self, variables=None, fitline_kw=None,
+_5_2_7    def summary_dict(self, variables=None, fitline_kw=None,
 floatformat_fiteqn='{:.3f}'):
-_5_1_8        '''Summarize bivariate statistics into a dict
-_5_1_9
-_5_2_0        Parameters
-_5_2_1        ----------
-_5_2_2        vars : list or str, default='common'
-_5_2_3            names of attribute variables to include in summary
-_5_2_4            names are case insensitive
-_5_2_5            The following strings are also accepted in place of a list
-_5_2_6                "all" (displays all variables)
-_5_2_7                "common" (displays all measures of mean difference)
-_5_2_8        fitline_kw : dict, default=None
-_5_2_9            keywords passed to `fitline`
-_5_3_0        floatformat_fiteqn : str, default=floatformat
-_5_3_1            format specifier for slope and intercept (a,b) in y = a x + b
-_5_3_2
-_5_3_3        Returns
-_5_3_4        -------
-_5_3_5        summary : dict
-_5_3_6            names and values of variables
-_5_3_7        '''
-_5_3_8
-_5_3_9        # List of variables
-_5_4_0        variables = self._expand_variables(variables)
-_5_4_1
-_5_4_2        if fitline_kw is None:
-_5_4_3            fitline_kw = {'method':'sma',
-_5_4_4                          'intercept':True}
-_5_4_5
-_5_4_6        # Construct the dict
-_5_4_7        summary = {}
-_5_4_8        for v in variables:
-_5_4_9            if v in ['slope','intercept']:
-_5_5_0                # These variables are object methods
-_5_5_1                func = getattr(self,v)
-_5_5_2                value = func(**fitline_kw)
-_5_5_3            elif v == 'fitline':
-_5_5_4                line = self.fitline(**fitline_kw)
-_5_5_5                v,value = bivariate_line_equation
+_5_2_8        '''Summarize bivariate statistics into a dict
+_5_2_9
+_5_3_0        Parameters
+_5_3_1        ----------
+_5_3_2        vars : list or str, default='common'
+_5_3_3            names of attribute variables to include in summary
+_5_3_4            names are case insensitive
+_5_3_5            The following strings are also accepted in place of a list
+_5_3_6                "all" (displays all variables)
+_5_3_7                "common" (displays all measures of mean difference)
+_5_3_8        fitline_kw : dict, default=None
+_5_3_9            keywords passed to `fitline`
+_5_4_0        floatformat_fiteqn : str, default=floatformat
+_5_4_1            format specifier for slope and intercept (a,b) in y = a x + b
+_5_4_2
+_5_4_3        Returns
+_5_4_4        -------
+_5_4_5        summary : dict
+_5_4_6            names and values of variables
+_5_4_7        '''
+_5_4_8
+_5_4_9        # List of variables
+_5_5_0        variables = self._expand_variables(variables)
+_5_5_1
+_5_5_2        if fitline_kw is None:
+_5_5_3            fitline_kw = {'method':'sma',
+_5_5_4                          'intercept':True}
+_5_5_5
+_5_5_6        # Construct the dict
+_5_5_7        summary = {}
+_5_5_8        for v in variables:
+_5_5_9            if v in ['slope','intercept']:
+_5_6_0                # These variables are object methods
+_5_6_1                func = getattr(self,v)
+_5_6_2                value = func(**fitline_kw)
+_5_6_3            elif v == 'fitline':
+_5_6_4                line = self.fitline(**fitline_kw)
+_5_6_5                v,value = bivariate_line_equation
 (line,floatformat_fiteqn,ystring='separate')
-_5_5_6            else:
-_5_5_7                # Retrieve values
-_5_5_8                value = getattr(self,v.lower())
-_5_5_9
-_5_6_0            # summary += (stringformat+'='+floatformat+'\n').format(v,value)
-_5_6_1            summary[v] = value
-_5_6_2
-_5_6_3        return summary
+_5_6_6            else:
+_5_6_7                # Retrieve values
+_5_6_8                value = getattr(self,v.lower())
+_5_6_9
+_5_7_0            # summary += (stringformat+'='+floatformat+'\n').format(v,value)
+_5_7_1            summary[v] = value
+_5_7_2
+_5_7_3        return summary
 Summarize bivariate statistics into a dict
 ** PPaarraammeetteerrss **
     * vvaarrss (list or str, default='common'): names of attribute variables to
       include in summary names are case insensitive
       The following strings are also accepted in place of a list "all"
       (displays all variables) "common" (displays all measures of mean
       difference)
@@ -1791,70 +1822,70 @@
 self,
 variables=None,
 fitline_kw=None,
 intformat='{:d}',
 floatformat='{:.4f}',
 floatformat_fiteqn=None,
 stringlength=None): View Source
-_5_6_5    def summary(self, variables=None, fitline_kw=None,
-_5_6_6                intformat='{:d}', floatformat='{:.4f}',
+_5_7_5    def summary(self, variables=None, fitline_kw=None,
+_5_7_6                intformat='{:d}', floatformat='{:.4f}',
 floatformat_fiteqn=None,
-_5_6_7                stringlength=None ):
-_5_6_8        '''Summarize bivariate statistics
-_5_6_9
-_5_7_0        Parameters
-_5_7_1        ----------
-_5_7_2        vars : list or str, default='common'
-_5_7_3            names of attribute variables to include in summary
-_5_7_4            names are case insensitive
-_5_7_5            The following strings are also accepted in place of a list
-_5_7_6                "all" (displays all variables)
-_5_7_7                "common" (displays all measures of mean difference)
-_5_7_8        fitline_kw : dict, default=None
-_5_7_9            keywords passed to `fitline`
-_5_8_0        intformat : str, default='{:d}'
-_5_8_1            format specifier for integer values
-_5_8_2        floatformat : str, default='{:.4f}'
-_5_8_3            format specifier for floating point values
-_5_8_4        floatformat_fiteqn : str, default=floatformat
-_5_8_5            format specifier for slope and intercept (a,b) in y = a x + b
-_5_8_6        stringlength : int, default=None
-_5_8_7            length of the variables on output
-_5_8_8            default (None) is to use the length of the longest variable name
-_5_8_9
-_5_9_0        Returns
-_5_9_1        -------
-_5_9_2        summary : str
-_5_9_3            names and values of variables
-_5_9_4        '''
-_5_9_5        # List of variables
-_5_9_6        variables = self._expand_variables(variables)
-_5_9_7
-_5_9_8        if floatformat_fiteqn is None:
-_5_9_9            floatformat_fiteqn = floatformat
-_6_0_0        if stringlength is None:
-_6_0_1            stringlength = np.max([len(v) for v in variables])
-_6_0_2        stringformat = '{:'+str(stringlength)+'s}'
-_6_0_3
-_6_0_4        # Get a dict containing the needed variables
-_6_0_5        summarydict = self.summary_dict( variables, fitline_kw,
+_5_7_7                stringlength=None ):
+_5_7_8        '''Summarize bivariate statistics
+_5_7_9
+_5_8_0        Parameters
+_5_8_1        ----------
+_5_8_2        vars : list or str, default='common'
+_5_8_3            names of attribute variables to include in summary
+_5_8_4            names are case insensitive
+_5_8_5            The following strings are also accepted in place of a list
+_5_8_6                "all" (displays all variables)
+_5_8_7                "common" (displays all measures of mean difference)
+_5_8_8        fitline_kw : dict, default=None
+_5_8_9            keywords passed to `fitline`
+_5_9_0        intformat : str, default='{:d}'
+_5_9_1            format specifier for integer values
+_5_9_2        floatformat : str, default='{:.4f}'
+_5_9_3            format specifier for floating point values
+_5_9_4        floatformat_fiteqn : str, default=floatformat
+_5_9_5            format specifier for slope and intercept (a,b) in y = a x + b
+_5_9_6        stringlength : int, default=None
+_5_9_7            length of the variables on output
+_5_9_8            default (None) is to use the length of the longest variable name
+_5_9_9
+_6_0_0        Returns
+_6_0_1        -------
+_6_0_2        summary : str
+_6_0_3            names and values of variables
+_6_0_4        '''
+_6_0_5        # List of variables
+_6_0_6        variables = self._expand_variables(variables)
+_6_0_7
+_6_0_8        if floatformat_fiteqn is None:
+_6_0_9            floatformat_fiteqn = floatformat
+_6_1_0        if stringlength is None:
+_6_1_1            stringlength = np.max([len(v) for v in variables])
+_6_1_2        stringformat = '{:'+str(stringlength)+'s}'
+_6_1_3
+_6_1_4        # Get a dict containing the needed variables
+_6_1_5        summarydict = self.summary_dict( variables, fitline_kw,
 floatformat_fiteqn )
-_6_0_6
-_6_0_7        # Extract length of the float numbers from floatformat
-_6_0_8        # import re
-_6_0_9        # floatlength = np.floor( float( re.findall("[-+]?(?:\d*\.*\d+)",
-_6_1_0        #       floatformat )[0] ) ).astype(int)
-_6_1_1
-_6_1_2        # summary = (stringformat+'{:>10s}').format('Variable','Value')
-_6_1_3        summarytext = ''
-_6_1_4        for k,v in summarydict.items():
-_6_1_5            vstr = _number2str(v,intformat,floatformat)
-_6_1_6            summarytext += (stringformat+' = {:s}\n').format(k,vstr)
-_6_1_7
-_6_1_8        return summarytext
+_6_1_6
+_6_1_7        # Extract length of the float numbers from floatformat
+_6_1_8        # import re
+_6_1_9        # floatlength = np.floor( float( re.findall("[-+]?(?:\d*\.*\d+)",
+_6_2_0        #       floatformat )[0] ) ).astype(int)
+_6_2_1
+_6_2_2        # summary = (stringformat+'{:>10s}').format('Variable','Value')
+_6_2_3        summarytext = ''
+_6_2_4        for k,v in summarydict.items():
+_6_2_5            vstr = _number2str(v,intformat,floatformat)
+_6_2_6            summarytext += (stringformat+' = {:s}\n').format(k,vstr)
+_6_2_7
+_6_2_8        return summarytext
 Summarize bivariate statistics
 ** PPaarraammeetteerrss **
     * vvaarrss (list or str, default='common'): names of attribute variables to
       include in summary names are case insensitive
       The following strings are also accepted in place of a list "all"
       (displays all variables) "common" (displays all measures of mean
       difference)
@@ -1876,141 +1907,141 @@
 fitline_kw=None,
 intformat='{:d}',
 floatformat='{:.3f}',
 floatformat_fiteqn=None,
 loc=None,
 loc_units='axes',
 **kwargs): View Source
-_6_2_0    def summary_fig_inset(self, ax, variables=None, fitline_kw=None,
-_6_2_1                          intformat='{:d}', floatformat='{:.3f}',
+_6_3_0    def summary_fig_inset(self, ax, variables=None, fitline_kw=None,
+_6_3_1                          intformat='{:d}', floatformat='{:.3f}',
 floatformat_fiteqn=None,
-_6_2_2                          loc=None, loc_units='axes',
-_6_2_3                          **kwargs):
-_6_2_4        '''Display bivariate statistics as a table inset on a plot axis
-_6_2_5
-_6_2_6        Parameters
-_6_2_7        ----------
-_6_2_8        ax : matplotlib.Figure.Axis
-_6_2_9            axis where the table will be displayed
-_6_3_0        variables : list or str, default='common'
-_6_3_1            names of attribute variables to include in summary
-_6_3_2            names are case insensitive
-_6_3_3            The following strings are also accepted in place of a list
-_6_3_4                "all" (displays all variables)
-_6_3_5                "common" (displays all measures of mean difference)
-_6_3_6        fitline_kw : dict, default=None
-_6_3_7            keywords passed to `fitline`
-_6_3_8        intformat : str, default='{:d}'
-_6_3_9            format specifier for integer values
-_6_4_0        floatformat : str, default='{:.3f}'
-_6_4_1            format specifier for floating point values
-_6_4_2        floatformat_fiteqn : str, default=floatformat
-_6_4_3            format specifier for slope and intercept (a,b) in y = a x + b
-_6_4_4        loc : tuple (x0,y0), default=(0.85, 0.05)
-_6_4_5            location on the axis where the table will be drawn
-_6_4_6            can be in data units or axes units [0-1]
-_6_4_7        loc_units : {'axes' (default), 'data'}
-_6_4_8            specifies whether loc has 'data' units or 'axes' units [0-1]
-_6_4_9
-_6_5_0        Returns
-_6_5_1        -------
-_6_5_2        text1, text2 : matplotlib text object
-_6_5_3            Artist for the two text boxes
-_6_5_4        '''
-_6_5_5        # List of variables
-_6_5_6        variables = self._expand_variables(variables)
-_6_5_7
-_6_5_8        if floatformat_fiteqn is None:
-_6_5_9            floatformat_fiteqn = floatformat
-_6_6_0
-_6_6_1        # Default location in lower right corner
-_6_6_2        if loc is None:
-_6_6_3            loc = (0.8,0.05)
-_6_6_4
-_6_6_5        # Coordinates for loc
-_6_6_6        if loc_units.lower()=='data':
-_6_6_7            coord=ax.transData
-_6_6_8        elif loc_units.lower() in ['axes','axis']:
-_6_6_9            coord=ax.transAxes
-_6_7_0        else:
-_6_7_1            raise ValueError('Display units should be "Data" or "Axes"')
-_6_7_2
-_6_7_3        # Get a dict containing the needed variables
-_6_7_4        summarydict = self.summary_dict( variables, fitline_kw,
-floatformat_fiteqn )
-_6_7_5
-_6_7_6        # Column of label text
-_6_7_7        label_text = '\n'.join([_texify_name(key)
-_6_7_8                                for key in summarydict])
-_6_7_9        # Column of value text
-_6_8_0        value_text = '\n'.join([_number2str(v,intformat,floatformat)
-_6_8_1                                for v in summarydict.values()])
+_6_3_2                          loc=None, loc_units='axes',
+_6_3_3                          **kwargs):
+_6_3_4        '''Display bivariate statistics as a table inset on a plot axis
+_6_3_5
+_6_3_6        Parameters
+_6_3_7        ----------
+_6_3_8        ax : matplotlib.Figure.Axis
+_6_3_9            axis where the table will be displayed
+_6_4_0        variables : list or str, default='common'
+_6_4_1            names of attribute variables to include in summary
+_6_4_2            names are case insensitive
+_6_4_3            The following strings are also accepted in place of a list
+_6_4_4                "all" (displays all variables)
+_6_4_5                "common" (displays all measures of mean difference)
+_6_4_6        fitline_kw : dict, default=None
+_6_4_7            keywords passed to `fitline`
+_6_4_8        intformat : str, default='{:d}'
+_6_4_9            format specifier for integer values
+_6_5_0        floatformat : str, default='{:.3f}'
+_6_5_1            format specifier for floating point values
+_6_5_2        floatformat_fiteqn : str, default=floatformat
+_6_5_3            format specifier for slope and intercept (a,b) in y = a x + b
+_6_5_4        loc : tuple (x0,y0), default=(0.85, 0.05)
+_6_5_5            location on the axis where the table will be drawn
+_6_5_6            can be in data units or axes units [0-1]
+_6_5_7        loc_units : {'axes' (default), 'data'}
+_6_5_8            specifies whether loc has 'data' units or 'axes' units [0-1]
+_6_5_9
+_6_6_0        Returns
+_6_6_1        -------
+_6_6_2        text1, text2 : matplotlib text object
+_6_6_3            Artist for the two text boxes
+_6_6_4        '''
+_6_6_5        # List of variables
+_6_6_6        variables = self._expand_variables(variables)
+_6_6_7
+_6_6_8        if floatformat_fiteqn is None:
+_6_6_9            floatformat_fiteqn = floatformat
+_6_7_0
+_6_7_1        # Default location in lower right corner
+_6_7_2        if loc is None:
+_6_7_3            loc = (0.8,0.05)
+_6_7_4
+_6_7_5        # Coordinates for loc
+_6_7_6        if loc_units.lower()=='data':
+_6_7_7            coord=ax.transData
+_6_7_8        elif loc_units.lower() in ['axes','axis']:
+_6_7_9            coord=ax.transAxes
+_6_8_0        else:
+_6_8_1            raise ValueError('Display units should be "Data" or "Axes"')
 _6_8_2
-_6_8_3        # Check if horizontal alignment keyword is used
-_6_8_4        ha=''
-_6_8_5        try:
-_6_8_6            ha = kwargs['ha']
-_6_8_7        except KeyError:
-_6_8_8            pass
-_6_8_9        try:
-_6_9_0            ha = kwargs['horizontalalignment']
-_6_9_1        except KeyError:
-_6_9_2            pass
-_6_9_3
-_6_9_4        # For right alignment, align on values first
-_6_9_5        # Otherwise, align on labels
-_6_9_6        if ha=='right':
-_6_9_7            first_text = value_text
-_6_9_8            second_text = label_text
-_6_9_9            sign = -1
-_7_0_0        else:
-_7_0_1            first_text = label_text
-_7_0_2            second_text = value_text
-_7_0_3            sign = +1
-_7_0_4
-_7_0_5        # Add first column of text
-_7_0_6        t1=ax.text(loc[0],loc[1],
-_7_0_7                first_text,
-_7_0_8                transform=coord,
-_7_0_9                **kwargs
-_7_1_0                )
-_7_1_1
-_7_1_2        # Get width of first text column
-_7_1_3        bbox = t1.get_window_extent().transformed(coord.inverted())
-_7_1_4        width = bbox.x1-bbox.x0
-_7_1_5
-_7_1_6        # Add second column of text
-_7_1_7        t2 = ax.text(loc[0]+width*sign,loc[1],
-_7_1_8                     second_text,
-_7_1_9                     transform=coord,
-_7_2_0                     **kwargs
-_7_2_1                     )
-_7_2_2
-_7_2_3        ##################################
-_7_2_4        # Early version of this function using matplotlib.table.table()
+_6_8_3        # Get a dict containing the needed variables
+_6_8_4        summarydict = self.summary_dict( variables, fitline_kw,
+floatformat_fiteqn )
+_6_8_5
+_6_8_6        # Column of label text
+_6_8_7        label_text = '\n'.join([_texify_name(key)
+_6_8_8                                for key in summarydict])
+_6_8_9        # Column of value text
+_6_9_0        value_text = '\n'.join([_number2str(v,intformat,floatformat)
+_6_9_1                                for v in summarydict.values()])
+_6_9_2
+_6_9_3        # Check if horizontal alignment keyword is used
+_6_9_4        ha=''
+_6_9_5        try:
+_6_9_6            ha = kwargs['ha']
+_6_9_7        except KeyError:
+_6_9_8            pass
+_6_9_9        try:
+_7_0_0            ha = kwargs['horizontalalignment']
+_7_0_1        except KeyError:
+_7_0_2            pass
+_7_0_3
+_7_0_4        # For right alignment, align on values first
+_7_0_5        # Otherwise, align on labels
+_7_0_6        if ha=='right':
+_7_0_7            first_text = value_text
+_7_0_8            second_text = label_text
+_7_0_9            sign = -1
+_7_1_0        else:
+_7_1_1            first_text = label_text
+_7_1_2            second_text = value_text
+_7_1_3            sign = +1
+_7_1_4
+_7_1_5        # Add first column of text
+_7_1_6        t1=ax.text(loc[0],loc[1],
+_7_1_7                first_text,
+_7_1_8                transform=coord,
+_7_1_9                **kwargs
+_7_2_0                )
+_7_2_1
+_7_2_2        # Get width of first text column
+_7_2_3        bbox = t1.get_window_extent().transformed(coord.inverted())
+_7_2_4        width = bbox.x1-bbox.x0
 _7_2_5
-_7_2_6        # if isinstance(loc,(tuple,list)):
-_7_2_7        #     # Create an inset axis to contain the table
-_7_2_8        #     tableaxis = ax.inset_axes(loc)
-_7_2_9        #     table_width=1
-_7_3_0        # else:
-_7_3_1        #     tableaxis = ax
+_7_2_6        # Add second column of text
+_7_2_7        t2 = ax.text(loc[0]+width*sign,loc[1],
+_7_2_8                     second_text,
+_7_2_9                     transform=coord,
+_7_3_0                     **kwargs
+_7_3_1                     )
 _7_3_2
-_7_3_3        # # Display the table on the axis
-_7_3_4        # return mtable.table(
-_7_3_5        #     tableaxis,
-_7_3_6        #     cellText=[[floatformat.format(value)] for value in
-summarydict.values()],
-_7_3_7        #     rowLabels=[texify_name(key) for key in summarydict],
-_7_3_8        #     colWidths=[table_width/2]*2,
-_7_3_9        #     edges=edges,
-_7_4_0        #     loc=loc, bbox=bbox
-_7_4_1        #     )
+_7_3_3        ##################################
+_7_3_4        # Early version of this function using matplotlib.table.table()
+_7_3_5
+_7_3_6        # if isinstance(loc,(tuple,list)):
+_7_3_7        #     # Create an inset axis to contain the table
+_7_3_8        #     tableaxis = ax.inset_axes(loc)
+_7_3_9        #     table_width=1
+_7_4_0        # else:
+_7_4_1        #     tableaxis = ax
 _7_4_2
-_7_4_3        return [t1,t2]
+_7_4_3        # # Display the table on the axis
+_7_4_4        # return mtable.table(
+_7_4_5        #     tableaxis,
+_7_4_6        #     cellText=[[floatformat.format(value)] for value in
+summarydict.values()],
+_7_4_7        #     rowLabels=[texify_name(key) for key in summarydict],
+_7_4_8        #     colWidths=[table_width/2]*2,
+_7_4_9        #     edges=edges,
+_7_5_0        #     loc=loc, bbox=bbox
+_7_5_1        #     )
+_7_5_2
+_7_5_3        return [t1,t2]
 Display bivariate statistics as a table inset on a plot axis
 ** PPaarraammeetteerrss **
     * aaxx (matplotlib.Figure.Axis): axis where the table will be displayed
     * vvaarriiaabblleess (list or str, default='common'): names of attribute variables
       to include in summary names are case insensitive
       The following strings are also accepted in place of a list "all"
       (displays all variables) "common" (displays all measures of mean
```

### Comparing `acgc-0.2.6/docs/acgc/stats/bivariate_lines.html` & `acgc-0.3/docs/acgc/stats/bivariate_lines.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/stats/boxcar.html` & `acgc-0.3/docs/acgc/stats/boxcar.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/stats/sma_warton_fit.html` & `acgc-0.3/docs/acgc/stats/sma_warton_fit.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/stats/tapply.html` & `acgc-0.3/docs/acgc/stats/tapply.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/stats/weighted.html` & `acgc-0.3/docs/acgc/stats/weighted.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/stats.html` & `acgc-0.3/docs/acgc/stats.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc/time.html` & `acgc-0.3/docs/acgc/time.html`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/docs/acgc.html` & `acgc-0.3/docs/acgc.html`

 * *Files 2% similar despite different names*

```diff
@@ -45,17 +45,17 @@
                    pattern=".+" required>
 
             <h2>Contents</h2>
             <ul>
   <li><a href="#installation">Installation</a></li>
   <li><a href="#get-started">Get started</a>
   <ul>
-    <li><a href="#better-looking-figures-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_figstyleipynb">Better looking figures (<a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb">example</a>)</a></li>
-    <li><a href="#bivariate-statistics-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_statsipynb">Bivariate statistics (<a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb">example</a>)</a></li>
-    <li><a href="#standard-major-axis-sma-line-fitting-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_smaipynb">Standard major axis (SMA) line fitting (<a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb">example</a>)</a></li>
+    <li><a href="#better-looking-figures">Better looking figures</a></li>
+    <li><a href="#bivariate-statistics">Bivariate statistics</a></li>
+    <li><a href="#standard-major-axis-sma-line-fitting">Standard major axis (SMA) line fitting</a></li>
   </ul></li>
   <li><a href="#demos">Demos</a></li>
   <li><a href="#quick-summary-of-submodules">Quick summary of submodules</a>
   <ul>
     <li><a href="#key-submodules">Key submodules</a></li>
     <li><a href="#other-submodules">Other submodules</a></li>
   </ul></li>
@@ -116,33 +116,39 @@
 <!-- ----------------------- SECTION BREAK ----------------------- -->
 
 <h1 id="get-started">Get started</h1>
 
 <p>Submodules within <code><a href="">acgc</a></code> contain all the capabilities of the package.
 Submodules are imported via <code>import acgc.&lt;submodule&gt;</code> or <code>from acgc import &lt;submodule&gt;</code>. </p>
 
-<h2 id="better-looking-figures-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_figstyleipynb">Better looking figures (<a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb">example</a>)</h2>
+<h2 id="better-looking-figures">Better looking figures</h2>
 
 <p>The default appearance of figures from Matplotlib doesn't meet the standards of most 
 scientific journals (high-resolution, Helvetica-like font). With the <code><a href="acgc/figstyle.html">acgc.figstyle</a></code> module,
 figures meet these criteria. Simply use <code>from acgc import figstyle</code> before creating your figures.</p>
 
-<h2 id="bivariate-statistics-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_statsipynb">Bivariate statistics (<a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb">example</a>)</h2>
+<p><a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb">Example using acgc.figstyle</a></p>
+
+<h2 id="bivariate-statistics">Bivariate statistics</h2>
 
 <p>The <code>BivariateStatistics</code> class makes it easy to compute and display a large number of
 bivariate statistics, including line fitting and weighted statistics. 
 Results can be easily formatted into tables or inset in figures. Use <code>from <a href="acgc/stats.html">acgc.stats</a> import BivariateStatistics</code>
 See <code><a href="acgc/stats/bivariate.html#BivariateStatistics">acgc.stats.bivariate.BivariateStatistics</a></code> for documentation.</p>
 
-<h2 id="standard-major-axis-sma-line-fitting-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_smaipynb">Standard major axis (SMA) line fitting (<a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb">example</a>)</h2>
+<p><a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb">Example using BivariateStatistics</a></p>
+
+<h2 id="standard-major-axis-sma-line-fitting">Standard major axis (SMA) line fitting</h2>
 
 <p>SMA line fitting (also called reduced major axis or RMA) quantifies the linear relationship 
 between variables in which neither one depends on the other.
 It is available via <code>from <a href="acgc/stats.html">acgc.stats</a> import sma</code>. </p>
 
+<p><a href="https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb">Example using SMA</a></p>
+
 <!-- ----------------------- SECTION BREAK ----------------------- -->
 
 <h1 id="demos">Demos</h1>
 
 <p>The <a href="https://github.com/cdholmes/acgc-python/blob/main/demo">demo</a> 
 folder contains examples of how to accomplish common data analysis and visualization tasks. 
 The examples include uses of the <code><a href="">acgc</a></code> library as well as other libraries for 
@@ -218,121 +224,126 @@
 </span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">&lt;!-- ----------------------- SECTION BREAK ----------------------- --&gt;</span>
 </span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
 </span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd"># Get started</span>
 </span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
 </span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">Submodules within `acgc` contain all the capabilities of the package.</span>
 </span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">Submodules are imported via `import acgc.&lt;submodule&gt;` or `from acgc import &lt;submodule&gt;`. </span>
 </span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
-</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">## Better looking figures ([example](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb))</span>
+</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">## Better looking figures </span>
 </span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
-</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
-</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">The default appearance of figures from Matplotlib doesn&#39;t meet the standards of most </span>
-</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">scientific journals (high-resolution, Helvetica-like font). With the `acgc.figstyle` module,</span>
-</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">figures meet these criteria. Simply use `from acgc import figstyle` before creating your figures.</span>
-</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
-</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">## Bivariate statistics ([example](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb))</span>
-</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
-</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">The `BivariateStatistics` class makes it easy to compute and display a large number of</span>
-</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">bivariate statistics, including line fitting and weighted statistics. </span>
-</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">Results can be easily formatted into tables or inset in figures. Use `from acgc.stats import BivariateStatistics`</span>
-</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">See `acgc.stats.bivariate.BivariateStatistics` for documentation.</span>
-</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
-</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">## Standard major axis (SMA) line fitting ([example](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb))</span>
-</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
-</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">SMA line fitting (also called reduced major axis or RMA) quantifies the linear relationship </span>
-</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">between variables in which neither one depends on the other.</span>
-</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">It is available via `from acgc.stats import sma`. </span>
-</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
-</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">&lt;!-- ----------------------- SECTION BREAK ----------------------- --&gt;</span>
-</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
-</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd"># Demos</span>
-</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">The [demo](https://github.com/cdholmes/acgc-python/blob/main/demo) </span>
-</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">folder contains examples of how to accomplish common data analysis and visualization tasks. </span>
-</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">The examples include uses of the `acgc` library as well as other libraries for </span>
-</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">geospatial data analysis.</span>
-</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
-</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">&lt;!-- ----------------------- SECTION BREAK ----------------------- --&gt;</span>
-</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
-</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd"># Quick summary of submodules</span>
-</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
-</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">## Key submodules</span>
-</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
-</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">- `acgc.figstyle`    </span>
-</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">Style settings for matplotlib, for publication-ready figures.</span>
-</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">[demo](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb)</span>
-</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
-</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">- `acgc.stats`    </span>
-</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">Collection of statistical methods. </span>
-</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">[demo](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb) </span>
-</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
-</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">## Other submodules</span>
-</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
-</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">- `acgc.erroranalysis`   </span>
-</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">Propagation of error through complex numerical models</span>
+</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">The default appearance of figures from Matplotlib doesn&#39;t meet the standards of most </span>
+</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">scientific journals (high-resolution, Helvetica-like font). With the `acgc.figstyle` module,</span>
+</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">figures meet these criteria. Simply use `from acgc import figstyle` before creating your figures.</span>
+</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
+</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">[Example using acgc.figstyle](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb)</span>
+</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
+</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">## Bivariate statistics </span>
+</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
+</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">The `BivariateStatistics` class makes it easy to compute and display a large number of</span>
+</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">bivariate statistics, including line fitting and weighted statistics. </span>
+</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">Results can be easily formatted into tables or inset in figures. Use `from acgc.stats import BivariateStatistics`</span>
+</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">See `acgc.stats.bivariate.BivariateStatistics` for documentation.</span>
+</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
+</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">[Example using BivariateStatistics](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb)</span>
+</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
+</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">## Standard major axis (SMA) line fitting</span>
+</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
+</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">SMA line fitting (also called reduced major axis or RMA) quantifies the linear relationship </span>
+</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">between variables in which neither one depends on the other.</span>
+</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">It is available via `from acgc.stats import sma`. </span>
+</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
+</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">[Example using SMA](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb)</span>
+</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
+</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">&lt;!-- ----------------------- SECTION BREAK ----------------------- --&gt;</span>
+</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
+</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd"># Demos</span>
+</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">The [demo](https://github.com/cdholmes/acgc-python/blob/main/demo) </span>
+</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">folder contains examples of how to accomplish common data analysis and visualization tasks. </span>
+</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">The examples include uses of the `acgc` library as well as other libraries for </span>
+</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">geospatial data analysis.</span>
+</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
+</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">&lt;!-- ----------------------- SECTION BREAK ----------------------- --&gt;</span>
+</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
+</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd"># Quick summary of submodules</span>
+</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
+</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">## Key submodules</span>
+</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
+</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">- `acgc.figstyle`    </span>
+</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">Style settings for matplotlib, for publication-ready figures.</span>
+</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">[demo](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb)</span>
+</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
+</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">- `acgc.stats`    </span>
+</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">Collection of statistical methods. </span>
+</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">[demo](https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb) </span>
 </span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
-</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">- `acgc.geoschem` or `acgc.gc`       </span>
-</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">Tools for GEOS-Chem grids (e.g. indexing, remapping, interpolating)</span>
-</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
-</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">- `acgc.hysplit`	        </span>
-</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">Read HYSPLIT output and write HYSPLIT CONTROL files</span>
-</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
-</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">- `acgc.icartt`	        </span>
-</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">Read and write ICARTT format files</span>
-</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
-</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">- `acgc.igra`		        </span>
-</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">Read IGRA radiosonde data files</span>
-</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
-</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">- `acgc.mapping`        </span>
-</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">Distance calculation, scale bar for display on maps</span>
-</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
-</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">- `acgc.met`        </span>
-</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">Miscelaneous functions for PBL properties</span>
-</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
-</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">- `acgc.modetools`	    </span>
-</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">Visualization of eigenmode systems</span>
-</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
-</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">- `acgc.netcdf`          </span>
-</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">High-level functions for reading and writing netCDF files. Legacy code. </span>
-</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">`acgc.netcdf.write_geo_nc` is still useful for concisely creating netCDF files, </span>
-</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">but xarray is better for reading netCDF.</span>
+</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">## Other submodules</span>
+</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
+</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">- `acgc.erroranalysis`   </span>
+</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">Propagation of error through complex numerical models</span>
+</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
+</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">- `acgc.geoschem` or `acgc.gc`       </span>
+</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">Tools for GEOS-Chem grids (e.g. indexing, remapping, interpolating)</span>
+</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
+</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">- `acgc.hysplit`	        </span>
+</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">Read HYSPLIT output and write HYSPLIT CONTROL files</span>
+</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
+</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">- `acgc.icartt`	        </span>
+</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">Read and write ICARTT format files</span>
+</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
+</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">- `acgc.igra`		        </span>
+</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">Read IGRA radiosonde data files</span>
+</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
+</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">- `acgc.mapping`        </span>
+</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">Distance calculation, scale bar for display on maps</span>
+</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
+</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">- `acgc.met`        </span>
+</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">Miscelaneous functions for PBL properties</span>
+</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
+</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">- `acgc.modetools`	    </span>
+</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">Visualization of eigenmode systems</span>
 </span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
-</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">- `acgc.solar`        </span>
-</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">Solar zenith angle, azimuth, declination, equation of time</span>
-</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
-</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">- `acgc.time`       </span>
-</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">Functions for manimulating times and dates. Legacy code.</span>
-</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">&#39;&#39;&#39;</span>
-</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
-</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="k">def</span> <span class="nf">_package_version</span><span class="p">(</span><span class="n">package_name</span><span class="p">):</span>
-</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Find version string for package name&#39;&#39;&#39;</span>
-</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>    <span class="kn">from</span> <span class="nn">importlib.metadata</span> <span class="kn">import</span> <span class="n">version</span><span class="p">,</span> <span class="n">PackageNotFoundError</span>
-</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>    <span class="k">try</span><span class="p">:</span>
-</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">version</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span>
-</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="k">except</span> <span class="n">PackageNotFoundError</span><span class="p">:</span>
-</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;unknown version&quot;</span>
-</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="k">return</span> <span class="n">result</span>
-</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
-</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="n">_package_version</span><span class="p">(</span><span class="s1">&#39;acgc&#39;</span><span class="p">)</span>
-</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>
-</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
-</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="s1">&#39;erroranalysis&#39;</span><span class="p">,</span>
-</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="s1">&#39;figstyle&#39;</span><span class="p">,</span>
-</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="s1">&#39;gc&#39;</span><span class="p">,</span>
-</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>    <span class="s1">&#39;geoschem&#39;</span><span class="p">,</span>
-</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="s1">&#39;hysplit&#39;</span><span class="p">,</span>
-</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>    <span class="s1">&#39;icartt&#39;</span><span class="p">,</span>
-</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="s1">&#39;igra&#39;</span><span class="p">,</span>
-</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="s1">&#39;mapping&#39;</span><span class="p">,</span>
-</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="s1">&#39;met&#39;</span><span class="p">,</span>
-</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="s1">&#39;modetools&#39;</span><span class="p">,</span>
-</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
-</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="s1">&#39;stats&#39;</span><span class="p">,</span>
-</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="s1">&#39;solar&#39;</span><span class="p">,</span>
-</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="s1">&#39;time&#39;</span>
-</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="p">]</span>
+</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">- `acgc.netcdf`          </span>
+</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">High-level functions for reading and writing netCDF files. Legacy code. </span>
+</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">`acgc.netcdf.write_geo_nc` is still useful for concisely creating netCDF files, </span>
+</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">but xarray is better for reading netCDF.</span>
+</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
+</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">- `acgc.solar`        </span>
+</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">Solar zenith angle, azimuth, declination, equation of time</span>
+</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>
+</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">- `acgc.time`       </span>
+</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">Functions for manimulating times and dates. Legacy code.</span>
+</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">&#39;&#39;&#39;</span>
+</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>
+</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="k">def</span> <span class="nf">_package_version</span><span class="p">(</span><span class="n">package_name</span><span class="p">):</span>
+</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Find version string for package name&#39;&#39;&#39;</span>
+</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="kn">from</span> <span class="nn">importlib.metadata</span> <span class="kn">import</span> <span class="n">version</span><span class="p">,</span> <span class="n">PackageNotFoundError</span>
+</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="k">try</span><span class="p">:</span>
+</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">version</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span>
+</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="k">except</span> <span class="n">PackageNotFoundError</span><span class="p">:</span>
+</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;unknown version&quot;</span>
+</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="k">return</span> <span class="n">result</span>
+</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
+</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="n">_package_version</span><span class="p">(</span><span class="s1">&#39;acgc&#39;</span><span class="p">)</span>
+</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
+</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
+</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>    <span class="s1">&#39;erroranalysis&#39;</span><span class="p">,</span>
+</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="s1">&#39;figstyle&#39;</span><span class="p">,</span>
+</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="s1">&#39;gc&#39;</span><span class="p">,</span>
+</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="s1">&#39;geoschem&#39;</span><span class="p">,</span>
+</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="s1">&#39;hysplit&#39;</span><span class="p">,</span>
+</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="s1">&#39;icartt&#39;</span><span class="p">,</span>
+</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="s1">&#39;igra&#39;</span><span class="p">,</span>
+</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="s1">&#39;mapping&#39;</span><span class="p">,</span>
+</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="s1">&#39;met&#39;</span><span class="p">,</span>
+</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="s1">&#39;modetools&#39;</span><span class="p">,</span>
+</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
+</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="s1">&#39;stats&#39;</span><span class="p">,</span>
+</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="s1">&#39;solar&#39;</span><span class="p">,</span>
+</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="s1">&#39;time&#39;</span>
+</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="p">]</span>
 </span></pre></div>
 
 
             </section>
     </main>
 <script>
     function escapeHTML(html) {
```

#### html2text {}

```diff
@@ -1,15 +1,15 @@
 ??
 [project logo][Unknown INPUT type]
 ********** CCoonntteennttss **********
     * _I_n_s_t_a_l_l_a_t_i_o_n
     * _G_e_t_ _s_t_a_r_t_e_d
-          o _B_e_t_t_e_r_ _l_o_o_k_i_n_g_ _f_i_g_u_r_e_s_ _(_e_x_a_m_p_l_e_)
-          o _B_i_v_a_r_i_a_t_e_ _s_t_a_t_i_s_t_i_c_s_ _(_e_x_a_m_p_l_e_)
-          o _S_t_a_n_d_a_r_d_ _m_a_j_o_r_ _a_x_i_s_ _(_S_M_A_)_ _l_i_n_e_ _f_i_t_t_i_n_g_ _(_e_x_a_m_p_l_e_)
+          o _B_e_t_t_e_r_ _l_o_o_k_i_n_g_ _f_i_g_u_r_e_s
+          o _B_i_v_a_r_i_a_t_e_ _s_t_a_t_i_s_t_i_c_s
+          o _S_t_a_n_d_a_r_d_ _m_a_j_o_r_ _a_x_i_s_ _(_S_M_A_)_ _l_i_n_e_ _f_i_t_t_i_n_g
     * _D_e_m_o_s
     * _Q_u_i_c_k_ _s_u_m_m_a_r_y_ _o_f_ _s_u_b_m_o_d_u_l_e_s
           o _K_e_y_ _s_u_b_m_o_d_u_l_e_s
           o _O_t_h_e_r_ _s_u_b_m_o_d_u_l_e_s
 ********** SSuubbmmoodduulleess **********
     * _e_r_r_o_r_a_n_a_l_y_s_i_s
     * _f_i_g_s_t_y_l_e
@@ -37,29 +37,32 @@
 If you plan to modify or improve the acgc package, an editable installation may
 be better: pip install -e git+https://github.com/cdholmes/acgc-python Your
 local files can then be managed with git, including keeping up-to-date with the
 github source repository (e.g. git pull).
 ************ GGeett ssttaarrtteedd ************
 Submodules within acgc contain all the capabilities of the package. Submodules
 are imported via import acgc.<submodule> or from acgc import <submodule>.
-********** BBeetttteerr llooookkiinngg ffiigguurreess ((_ee_xx_aa_mm_pp_ll_ee)) **********
+********** BBeetttteerr llooookkiinngg ffiigguurreess **********
 The default appearance of figures from Matplotlib doesn't meet the standards of
 most scientific journals (high-resolution, Helvetica-like font). With the
 _a_c_g_c_._f_i_g_s_t_y_l_e module, figures meet these criteria. Simply use from acgc import
 figstyle before creating your figures.
-********** BBiivvaarriiaattee ssttaattiissttiiccss ((_ee_xx_aa_mm_pp_ll_ee)) **********
+_E_x_a_m_p_l_e_ _u_s_i_n_g_ _a_c_g_c_._f_i_g_s_t_y_l_e
+********** BBiivvaarriiaattee ssttaattiissttiiccss **********
 The BivariateStatistics class makes it easy to compute and display a large
 number of bivariate statistics, including line fitting and weighted statistics.
 Results can be easily formatted into tables or inset in figures. Use from
 _a_c_g_c_._s_t_a_t_s import BivariateStatistics See
 _a_c_g_c_._s_t_a_t_s_._b_i_v_a_r_i_a_t_e_._B_i_v_a_r_i_a_t_e_S_t_a_t_i_s_t_i_c_s for documentation.
-********** SSttaannddaarrdd mmaajjoorr aaxxiiss ((SSMMAA)) lliinnee ffiittttiinngg ((_ee_xx_aa_mm_pp_ll_ee)) **********
+_E_x_a_m_p_l_e_ _u_s_i_n_g_ _B_i_v_a_r_i_a_t_e_S_t_a_t_i_s_t_i_c_s
+********** SSttaannddaarrdd mmaajjoorr aaxxiiss ((SSMMAA)) lliinnee ffiittttiinngg **********
 SMA line fitting (also called reduced major axis or RMA) quantifies the linear
 relationship between variables in which neither one depends on the other. It is
 available via from _a_c_g_c_._s_t_a_t_s import sma.
+_E_x_a_m_p_l_e_ _u_s_i_n_g_ _S_M_A
 ************ DDeemmooss ************
 The _d_e_m_o folder contains examples of how to accomplish common data analysis and
 visualization tasks. The examples include uses of the acgc library as well as
 other libraries for geospatial data analysis.
 ************ QQuuiicckk ssuummmmaarryy ooff ssuubbmmoodduulleess ************
 ********** KKeeyy ssuubbmmoodduulleess **********
     * _a_c_g_c_._f_i_g_s_t_y_l_e
@@ -116,128 +119,133 @@
 _ _2_0
 _ _2_1# Get started
 _ _2_2
 _ _2_3Submodules within `acgc` contain all the capabilities of the package.
 _ _2_4Submodules are imported via `import acgc.<submodule>` or `from acgc import
 <submodule>`.
 _ _2_5
-_ _2_6## Better looking figures ([example](https://github.com/cdholmes/acgc-
-python/blob/main/demo/demo_figstyle.ipynb))
+_ _2_6## Better looking figures
 _ _2_7
-_ _2_8
-_ _2_9The default appearance of figures from Matplotlib doesn't meet the standards
+_ _2_8The default appearance of figures from Matplotlib doesn't meet the standards
 of most
-_ _3_0scientific journals (high-resolution, Helvetica-like font). With the
+_ _2_9scientific journals (high-resolution, Helvetica-like font). With the
 `acgc.figstyle` module,
-_ _3_1figures meet these criteria. Simply use `from acgc import figstyle` before
+_ _3_0figures meet these criteria. Simply use `from acgc import figstyle` before
 creating your figures.
-_ _3_2
-_ _3_3## Bivariate statistics ([example](https://github.com/cdholmes/acgc-python/
-blob/main/demo/demo_stats.ipynb))
-_ _3_4
-_ _3_5The `BivariateStatistics` class makes it easy to compute and display a large
+_ _3_1
+_ _3_2[Example using acgc.figstyle](https://github.com/cdholmes/acgc-python/blob/
+main/demo/demo_figstyle.ipynb)
+_ _3_3
+_ _3_4## Bivariate statistics
+_ _3_5
+_ _3_6The `BivariateStatistics` class makes it easy to compute and display a large
 number of
-_ _3_6bivariate statistics, including line fitting and weighted statistics.
-_ _3_7Results can be easily formatted into tables or inset in figures. Use `from
+_ _3_7bivariate statistics, including line fitting and weighted statistics.
+_ _3_8Results can be easily formatted into tables or inset in figures. Use `from
 acgc.stats import BivariateStatistics`
-_ _3_8See `acgc.stats.bivariate.BivariateStatistics` for documentation.
-_ _3_9
-_ _4_0## Standard major axis (SMA) line fitting ([example](https://github.com/
-cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb))
-_ _4_1
-_ _4_2SMA line fitting (also called reduced major axis or RMA) quantifies the
+_ _3_9See `acgc.stats.bivariate.BivariateStatistics` for documentation.
+_ _4_0
+_ _4_1[Example using BivariateStatistics](https://github.com/cdholmes/acgc-python/
+blob/main/demo/demo_stats.ipynb)
+_ _4_2
+_ _4_3## Standard major axis (SMA) line fitting
+_ _4_4
+_ _4_5SMA line fitting (also called reduced major axis or RMA) quantifies the
 linear relationship
-_ _4_3between variables in which neither one depends on the other.
-_ _4_4It is available via `from acgc.stats import sma`.
-_ _4_5
-_ _4_6<!-- ----------------------- SECTION BREAK ----------------------- -->
-_ _4_7
-_ _4_8# Demos
-_ _4_9The [demo](https://github.com/cdholmes/acgc-python/blob/main/demo)
-_ _5_0folder contains examples of how to accomplish common data analysis and
+_ _4_6between variables in which neither one depends on the other.
+_ _4_7It is available via `from acgc.stats import sma`.
+_ _4_8
+_ _4_9[Example using SMA](https://github.com/cdholmes/acgc-python/blob/main/demo/
+demo_sma.ipynb)
+_ _5_0
+_ _5_1<!-- ----------------------- SECTION BREAK ----------------------- -->
+_ _5_2
+_ _5_3# Demos
+_ _5_4The [demo](https://github.com/cdholmes/acgc-python/blob/main/demo)
+_ _5_5folder contains examples of how to accomplish common data analysis and
 visualization tasks.
-_ _5_1The examples include uses of the `acgc` library as well as other libraries
+_ _5_6The examples include uses of the `acgc` library as well as other libraries
 for
-_ _5_2geospatial data analysis.
-_ _5_3
-_ _5_4<!-- ----------------------- SECTION BREAK ----------------------- -->
-_ _5_5
-_ _5_6# Quick summary of submodules
-_ _5_7
-_ _5_8## Key submodules
-_ _5_9
-_ _6_0- `acgc.figstyle`
-_ _6_1Style settings for matplotlib, for publication-ready figures.
-_ _6_2[demo](https://github.com/cdholmes/acgc-python/blob/main/demo/
+_ _5_7geospatial data analysis.
+_ _5_8
+_ _5_9<!-- ----------------------- SECTION BREAK ----------------------- -->
+_ _6_0
+_ _6_1# Quick summary of submodules
+_ _6_2
+_ _6_3## Key submodules
+_ _6_4
+_ _6_5- `acgc.figstyle`
+_ _6_6Style settings for matplotlib, for publication-ready figures.
+_ _6_7[demo](https://github.com/cdholmes/acgc-python/blob/main/demo/
 demo_figstyle.ipynb)
-_ _6_3
-_ _6_4- `acgc.stats`
-_ _6_5Collection of statistical methods.
-_ _6_6[demo](https://github.com/cdholmes/acgc-python/blob/main/demo/
+_ _6_8
+_ _6_9- `acgc.stats`
+_ _7_0Collection of statistical methods.
+_ _7_1[demo](https://github.com/cdholmes/acgc-python/blob/main/demo/
 demo_stats.ipynb)
-_ _6_7
-_ _6_8## Other submodules
-_ _6_9
-_ _7_0- `acgc.erroranalysis`
-_ _7_1Propagation of error through complex numerical models
 _ _7_2
-_ _7_3- `acgc.geoschem` or `acgc.gc`
-_ _7_4Tools for GEOS-Chem grids (e.g. indexing, remapping, interpolating)
-_ _7_5
-_ _7_6- `acgc.hysplit`	
-_ _7_7Read HYSPLIT output and write HYSPLIT CONTROL files
-_ _7_8
-_ _7_9- `acgc.icartt`	
-_ _8_0Read and write ICARTT format files
-_ _8_1
-_ _8_2- `acgc.igra`		
-_ _8_3Read IGRA radiosonde data files
-_ _8_4
-_ _8_5- `acgc.mapping`
-_ _8_6Distance calculation, scale bar for display on maps
-_ _8_7
-_ _8_8- `acgc.met`
-_ _8_9Miscelaneous functions for PBL properties
-_ _9_0
-_ _9_1- `acgc.modetools`	
-_ _9_2Visualization of eigenmode systems
-_ _9_3
-_ _9_4- `acgc.netcdf`
-_ _9_5High-level functions for reading and writing netCDF files. Legacy code.
-_ _9_6`acgc.netcdf.write_geo_nc` is still useful for concisely creating netCDF
-files,
-_ _9_7but xarray is better for reading netCDF.
+_ _7_3## Other submodules
+_ _7_4
+_ _7_5- `acgc.erroranalysis`
+_ _7_6Propagation of error through complex numerical models
+_ _7_7
+_ _7_8- `acgc.geoschem` or `acgc.gc`
+_ _7_9Tools for GEOS-Chem grids (e.g. indexing, remapping, interpolating)
+_ _8_0
+_ _8_1- `acgc.hysplit`	
+_ _8_2Read HYSPLIT output and write HYSPLIT CONTROL files
+_ _8_3
+_ _8_4- `acgc.icartt`	
+_ _8_5Read and write ICARTT format files
+_ _8_6
+_ _8_7- `acgc.igra`		
+_ _8_8Read IGRA radiosonde data files
+_ _8_9
+_ _9_0- `acgc.mapping`
+_ _9_1Distance calculation, scale bar for display on maps
+_ _9_2
+_ _9_3- `acgc.met`
+_ _9_4Miscelaneous functions for PBL properties
+_ _9_5
+_ _9_6- `acgc.modetools`	
+_ _9_7Visualization of eigenmode systems
 _ _9_8
-_ _9_9- `acgc.solar`
-_1_0_0Solar zenith angle, azimuth, declination, equation of time
-_1_0_1
-_1_0_2- `acgc.time`
-_1_0_3Functions for manimulating times and dates. Legacy code.
-_1_0_4'''
-_1_0_5
-_1_0_6def _package_version(package_name):
-_1_0_7    '''Find version string for package name'''
-_1_0_8    from importlib.metadata import version, PackageNotFoundError
-_1_0_9    try:
-_1_1_0        result = version(package_name)
-_1_1_1    except PackageNotFoundError:
-_1_1_2        result = "unknown version"
-_1_1_3    return result
-_1_1_4
-_1_1_5__version__ = _package_version('acgc')
-_1_1_6
-_1_1_7__all__ = [
-_1_1_8    'erroranalysis',
-_1_1_9    'figstyle',
-_1_2_0    'gc',
-_1_2_1    'geoschem',
-_1_2_2    'hysplit',
-_1_2_3    'icartt',
-_1_2_4    'igra',
-_1_2_5    'mapping',
-_1_2_6    'met',
-_1_2_7    'modetools',
-_1_2_8    'netcdf',
-_1_2_9    'stats',
-_1_3_0    'solar',
-_1_3_1    'time'
-_1_3_2]
+_ _9_9- `acgc.netcdf`
+_1_0_0High-level functions for reading and writing netCDF files. Legacy code.
+_1_0_1`acgc.netcdf.write_geo_nc` is still useful for concisely creating netCDF
+files,
+_1_0_2but xarray is better for reading netCDF.
+_1_0_3
+_1_0_4- `acgc.solar`
+_1_0_5Solar zenith angle, azimuth, declination, equation of time
+_1_0_6
+_1_0_7- `acgc.time`
+_1_0_8Functions for manimulating times and dates. Legacy code.
+_1_0_9'''
+_1_1_0
+_1_1_1def _package_version(package_name):
+_1_1_2    '''Find version string for package name'''
+_1_1_3    from importlib.metadata import version, PackageNotFoundError
+_1_1_4    try:
+_1_1_5        result = version(package_name)
+_1_1_6    except PackageNotFoundError:
+_1_1_7        result = "unknown version"
+_1_1_8    return result
+_1_1_9
+_1_2_0__version__ = _package_version('acgc')
+_1_2_1
+_1_2_2__all__ = [
+_1_2_3    'erroranalysis',
+_1_2_4    'figstyle',
+_1_2_5    'gc',
+_1_2_6    'geoschem',
+_1_2_7    'hysplit',
+_1_2_8    'icartt',
+_1_2_9    'igra',
+_1_3_0    'mapping',
+_1_3_1    'met',
+_1_3_2    'modetools',
+_1_3_3    'netcdf',
+_1_3_4    'stats',
+_1_3_5    'solar',
+_1_3_6    'time'
+_1_3_7]
```

### Comparing `acgc-0.2.6/docs/search.js` & `acgc-0.3/docs/search.js`

 * *Files 14% similar despite different names*

#### js-beautify {}

```diff
@@ -682,40 +682,56 @@
             })
     }();
     /** pdoc search index */
     const docs = [{
         "fullname": "acgc",
         "modulename": "acgc",
         "kind": "module",
-        "doc": "<p>Data analysis programs from the ACGC research group</p>\n\n<h1 id=\"installation\">Installation</h1>\n\n<p>For conda users:</p>\n\n<p><code>conda install -c conda-forge acgc</code></p>\n\n<p>For pip users:</p>\n\n<p><code>pip install acgc</code></p>\n\n<h3 id=\"for-developers\">For developers</h3>\n\n<p>If you plan to modify or improve the acgc package, an editable installation may be better:\n<code>pip install -e git+https://github.com/cdholmes/acgc-python</code>\nYour local files can then be managed with git, including keeping up-to-date with the \ngithub source repository (e.g. <code>git pull</code>).</p>\n\n<!-- ----------------------- SECTION BREAK ----------------------- -->\n\n<h1 id=\"get-started\">Get started</h1>\n\n<p>Submodules within <code>acgc</code> contain all the capabilities of the package.\nSubmodules are imported via <code>import acgc.&lt;submodule&gt;</code> or <code>from acgc import &lt;submodule&gt;</code>. </p>\n\n<h2 id=\"better-looking-figures-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_figstyleipynb\">Better looking figures (<a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb\">example</a>)</h2>\n\n<p>The default appearance of figures from Matplotlib doesn't meet the standards of most \nscientific journals (high-resolution, Helvetica-like font). With the <code>acgc.figstyle</code> module,\nfigures meet these criteria. Simply use <code>from acgc import figstyle</code> before creating your figures.</p>\n\n<h2 id=\"bivariate-statistics-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_statsipynb\">Bivariate statistics (<a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb\">example</a>)</h2>\n\n<p>The <code>BivariateStatistics</code> class makes it easy to compute and display a large number of\nbivariate statistics, including line fitting and weighted statistics. \nResults can be easily formatted into tables or inset in figures. Use <code>from acgc.stats import BivariateStatistics</code>\nSee <code>acgc.stats.bivariate.BivariateStatistics</code> for documentation.</p>\n\n<h2 id=\"standard-major-axis-sma-line-fitting-examplehttpsgithubcomcdholmesacgc-pythonblobmaindemodemo_smaipynb\">Standard major axis (SMA) line fitting (<a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb\">example</a>)</h2>\n\n<p>SMA line fitting (also called reduced major axis or RMA) quantifies the linear relationship \nbetween variables in which neither one depends on the other.\nIt is available via <code>from acgc.stats import sma</code>. </p>\n\n<!-- ----------------------- SECTION BREAK ----------------------- -->\n\n<h1 id=\"demos\">Demos</h1>\n\n<p>The <a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo\">demo</a> \nfolder contains examples of how to accomplish common data analysis and visualization tasks. \nThe examples include uses of the <code>acgc</code> library as well as other libraries for \ngeospatial data analysis.</p>\n\n<!-- ----------------------- SECTION BREAK ----------------------- -->\n\n<h1 id=\"quick-summary-of-submodules\">Quick summary of submodules</h1>\n\n<h2 id=\"key-submodules\">Key submodules</h2>\n\n<ul>\n<li><p><code>acgc.figstyle</code> <br />\nStyle settings for matplotlib, for publication-ready figures.\n<a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb\">demo</a></p></li>\n<li><p><code>acgc.stats</code> <br />\nCollection of statistical methods. \n<a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb\">demo</a> </p></li>\n</ul>\n\n<h2 id=\"other-submodules\">Other submodules</h2>\n\n<ul>\n<li><p><code>acgc.erroranalysis</code> <br />\nPropagation of error through complex numerical models</p></li>\n<li><p><code>acgc.geoschem</code> or <code>acgc.gc</code> <br />\nTools for GEOS-Chem grids (e.g. indexing, remapping, interpolating)</p></li>\n<li><p><code>acgc.hysplit</code> <br />\nRead HYSPLIT output and write HYSPLIT CONTROL files</p></li>\n<li><p><code>acgc.icartt</code> <br />\nRead and write ICARTT format files</p></li>\n<li><p><code>acgc.igra</code> <br />\nRead IGRA radiosonde data files</p></li>\n<li><p><code>acgc.mapping</code> <br />\nDistance calculation, scale bar for display on maps</p></li>\n<li><p><code>acgc.met</code> <br />\nMiscelaneous functions for PBL properties</p></li>\n<li><p><code>acgc.modetools</code> <br />\nVisualization of eigenmode systems</p></li>\n<li><p><code>acgc.netcdf</code> <br />\nHigh-level functions for reading and writing netCDF files. Legacy code. \n<code>acgc.netcdf.write_geo_nc</code> is still useful for concisely creating netCDF files, \nbut xarray is better for reading netCDF.</p></li>\n<li><p><code>acgc.solar</code> <br />\nSolar zenith angle, azimuth, declination, equation of time</p></li>\n<li><p><code>acgc.time</code> <br />\nFunctions for manimulating times and dates. Legacy code.</p></li>\n</ul>\n"
+        "doc": "<p>Data analysis programs from the ACGC research group</p>\n\n<h1 id=\"installation\">Installation</h1>\n\n<p>For conda users:</p>\n\n<p><code>conda install -c conda-forge acgc</code></p>\n\n<p>For pip users:</p>\n\n<p><code>pip install acgc</code></p>\n\n<h3 id=\"for-developers\">For developers</h3>\n\n<p>If you plan to modify or improve the acgc package, an editable installation may be better:\n<code>pip install -e git+https://github.com/cdholmes/acgc-python</code>\nYour local files can then be managed with git, including keeping up-to-date with the \ngithub source repository (e.g. <code>git pull</code>).</p>\n\n<!-- ----------------------- SECTION BREAK ----------------------- -->\n\n<h1 id=\"get-started\">Get started</h1>\n\n<p>Submodules within <code>acgc</code> contain all the capabilities of the package.\nSubmodules are imported via <code>import acgc.&lt;submodule&gt;</code> or <code>from acgc import &lt;submodule&gt;</code>. </p>\n\n<h2 id=\"better-looking-figures\">Better looking figures</h2>\n\n<p>The default appearance of figures from Matplotlib doesn't meet the standards of most \nscientific journals (high-resolution, Helvetica-like font). With the <code>acgc.figstyle</code> module,\nfigures meet these criteria. Simply use <code>from acgc import figstyle</code> before creating your figures.</p>\n\n<p><a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb\">Example using acgc.figstyle</a></p>\n\n<h2 id=\"bivariate-statistics\">Bivariate statistics</h2>\n\n<p>The <code>BivariateStatistics</code> class makes it easy to compute and display a large number of\nbivariate statistics, including line fitting and weighted statistics. \nResults can be easily formatted into tables or inset in figures. Use <code>from acgc.stats import BivariateStatistics</code>\nSee <code>acgc.stats.bivariate.BivariateStatistics</code> for documentation.</p>\n\n<p><a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb\">Example using BivariateStatistics</a></p>\n\n<h2 id=\"standard-major-axis-sma-line-fitting\">Standard major axis (SMA) line fitting</h2>\n\n<p>SMA line fitting (also called reduced major axis or RMA) quantifies the linear relationship \nbetween variables in which neither one depends on the other.\nIt is available via <code>from acgc.stats import sma</code>. </p>\n\n<p><a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_sma.ipynb\">Example using SMA</a></p>\n\n<!-- ----------------------- SECTION BREAK ----------------------- -->\n\n<h1 id=\"demos\">Demos</h1>\n\n<p>The <a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo\">demo</a> \nfolder contains examples of how to accomplish common data analysis and visualization tasks. \nThe examples include uses of the <code>acgc</code> library as well as other libraries for \ngeospatial data analysis.</p>\n\n<!-- ----------------------- SECTION BREAK ----------------------- -->\n\n<h1 id=\"quick-summary-of-submodules\">Quick summary of submodules</h1>\n\n<h2 id=\"key-submodules\">Key submodules</h2>\n\n<ul>\n<li><p><code>acgc.figstyle</code> <br />\nStyle settings for matplotlib, for publication-ready figures.\n<a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_figstyle.ipynb\">demo</a></p></li>\n<li><p><code>acgc.stats</code> <br />\nCollection of statistical methods. \n<a href=\"https://github.com/cdholmes/acgc-python/blob/main/demo/demo_stats.ipynb\">demo</a> </p></li>\n</ul>\n\n<h2 id=\"other-submodules\">Other submodules</h2>\n\n<ul>\n<li><p><code>acgc.erroranalysis</code> <br />\nPropagation of error through complex numerical models</p></li>\n<li><p><code>acgc.geoschem</code> or <code>acgc.gc</code> <br />\nTools for GEOS-Chem grids (e.g. indexing, remapping, interpolating)</p></li>\n<li><p><code>acgc.hysplit</code> <br />\nRead HYSPLIT output and write HYSPLIT CONTROL files</p></li>\n<li><p><code>acgc.icartt</code> <br />\nRead and write ICARTT format files</p></li>\n<li><p><code>acgc.igra</code> <br />\nRead IGRA radiosonde data files</p></li>\n<li><p><code>acgc.mapping</code> <br />\nDistance calculation, scale bar for display on maps</p></li>\n<li><p><code>acgc.met</code> <br />\nMiscelaneous functions for PBL properties</p></li>\n<li><p><code>acgc.modetools</code> <br />\nVisualization of eigenmode systems</p></li>\n<li><p><code>acgc.netcdf</code> <br />\nHigh-level functions for reading and writing netCDF files. Legacy code. \n<code>acgc.netcdf.write_geo_nc</code> is still useful for concisely creating netCDF files, \nbut xarray is better for reading netCDF.</p></li>\n<li><p><code>acgc.solar</code> <br />\nSolar zenith angle, azimuth, declination, equation of time</p></li>\n<li><p><code>acgc.time</code> <br />\nFunctions for manimulating times and dates. Legacy code.</p></li>\n</ul>\n"
     }, {
         "fullname": "acgc.erroranalysis",
         "modulename": "acgc.erroranalysis",
         "kind": "module",
         "doc": "<p>Propagation of error through complex numerical models</p>\n"
     }, {
         "fullname": "acgc.erroranalysis.funcerror_uncorr",
         "modulename": "acgc.erroranalysis",
         "qualname": "funcerror_uncorr",
         "kind": "function",
-        "doc": "<p>Propagate uncertainties in function parameters to uncertainty in function value. </p>\n\n<p>The uncertainty will be evaluated at f(x0). The method uses \na numerical estimate of the derivative of f(x0). For non-linear functions\nthe method is appropriate for small relative errors (i.e. small xerr/x0).\nThe method neglects possible error correlations between multiple parameters \nin x0.\nThe function variables must all be continuous variables \n(no categorical or discrete variables).</p>\n\n<p>Example. To find the uncertainty in <code>f(x,y)</code> at for values <code>x=1; y=2</code>, where \nthe uncertainty (e.g. standard error) in <code>x</code> is 0.1 and the uncertainty in <code>y</code> \nis 0.3.\n<code>print( funcerr_uncorr( f, [1,2], [0.1,0.3] ) )</code></p>\n\n<h6 id=\"parameters\">Parameters</h6>\n\n<ul>\n<li><strong>func</strong> (callable):\nfunction to be evaluated</li>\n<li><strong>x0</strong> (list or tuple (n,)):\nparameter values for func</li>\n<li><strong>xerr</strong> (list or tuple (n,)):\nuncertainty in parameter values x0</li>\n<li><strong>h</strong> (float, default=1e-3):\nfractional perturbation to x0 used to estimate slope of func via finite difference</li>\n</ul>\n\n<h6 id=\"returns\">Returns</h6>\n\n<ul>\n<li><strong>ferr</strong> (float):\nthe uncertainty in <code>f(x0)</code> given <code>xerr</code> uncertainty in <code>x0</code></li>\n</ul>\n",
+        "doc": "<p>Propagate uncertainties in function parameters to uncertainty in function value. </p>\n\n<p>The uncertainty will be evaluated at f(x0). The method uses \na numerical estimate of the derivative of f(x0). For non-linear functions\nthe method is appropriate for small relative errors (i.e. small xerr/x0).\nThe method neglects possible error correlations between multiple parameters \nin x0.\nThe function variables must all be continuous variables \n(no categorical or discrete variables).</p>\n\n<p>Example. To find the uncertainty in <code>f(x,y)</code> at for values <code>x=1; y=2</code>, where \nthe uncertainty (e.g. standard error) in <code>x</code> is 0.1 and the uncertainty in <code>y</code> \nis 0.3.\n<code>print( funcerr_uncorr( f, [1,2], [0.1,0.3] ) )</code></p>\n\n<h6 id=\"parameters\">Parameters</h6>\n\n<ul>\n<li><strong>func</strong> (callable):\nfunction to be evaluated</li>\n<li><strong>x0</strong> (list or tuple (n,)):\nparameter values for func</li>\n<li><strong>xerr</strong> (list or tuple (n,)):\nuncertainty in parameter values x0</li>\n<li><strong>h</strong> (float, default=1e-3):\nfractional perturbation to x0 used to estimate slope of func via finite difference</li>\n<li><strong>**kwargs</strong> ((optional)):\nkwargs will be passed to func without error</li>\n</ul>\n\n<h6 id=\"returns\">Returns</h6>\n\n<ul>\n<li><strong>ferr</strong> (float):\nthe uncertainty in <code>f(x0)</code> given <code>xerr</code> uncertainty in <code>x0</code></li>\n</ul>\n",
         "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">func</span>, </span><span class=\"param\"><span class=\"n\">x0</span>, </span><span class=\"param\"><span class=\"n\">xerr</span>, </span><span class=\"param\"><span class=\"n\">h</span><span class=\"o\">=</span><span class=\"kc\">None</span>, </span><span class=\"param\"><span class=\"o\">**</span><span class=\"n\">kwargs</span></span><span class=\"return-annotation\">):</span></span>",
         "funcdef": "def"
     }, {
         "fullname": "acgc.figstyle",
         "modulename": "acgc.figstyle",
         "kind": "module",
         "doc": "<p>Style settings for matplotlib, for publication-ready figures</p>\n\n<p>Activate the style by importing this module:</p>\n\n<p><code>from acgc import figstyle</code></p>\n\n<p>Figures generated by Matplotlib will then use the new style.\nThe style includes grid lines (horizontal and vertical) by default.\nTurn these off and on with <code>grid_off</code> and <code>grid_on</code>:</p>\n\n<p><code>figstyle.grid_off()</code></p>\n\n<p><code>figstyle.grid_on()</code></p>\n"
     }, {
         "fullname": "acgc.figstyle.activate_style",
         "modulename": "acgc.figstyle",
         "qualname": "activate_style",
         "kind": "function",
-        "doc": "<p>Activate style sheet </p>\n\n<h6 id=\"parameters\">Parameters</h6>\n\n<ul>\n<li><strong>grid</strong> (bool, default=True):\nturn grid lines on (True) or off (False)</li>\n<li><strong>gridaxis</strong> (str, default='both'):\nspecifies which axes should have grid lines</li>\n</ul>\n",
-        "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">grid</span><span class=\"o\">=</span><span class=\"kc\">True</span>, </span><span class=\"param\"><span class=\"n\">gridaxis</span><span class=\"o\">=</span><span class=\"s1\">&#39;both&#39;</span></span><span class=\"return-annotation\">):</span></span>",
+        "doc": "<p>Activate style sheet </p>\n\n<h6 id=\"parameters\">Parameters</h6>\n\n<ul>\n<li><strong>grid</strong> (bool, default=True):\nturn grid lines on (True) or off (False)</li>\n<li><strong>gridaxis</strong> (str, default='both'):\nspecifies which axes should have grid lines</li>\n<li><strong>mathfont</strong> (str, default='regular'):\nsets font used in mathtext, 'regular' uses same font as regular text.\nsee <code>set_mathfont</code> for all options</li>\n</ul>\n",
+        "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">grid</span><span class=\"o\">=</span><span class=\"kc\">True</span>, </span><span class=\"param\"><span class=\"n\">gridaxis</span><span class=\"o\">=</span><span class=\"s1\">&#39;both&#39;</span>, </span><span class=\"param\"><span class=\"n\">mathfont</span><span class=\"o\">=</span><span class=\"s1\">&#39;regular&#39;</span></span><span class=\"return-annotation\">):</span></span>",
+        "funcdef": "def"
+    }, {
+        "fullname": "acgc.figstyle.deactivate_style",
+        "modulename": "acgc.figstyle",
+        "qualname": "deactivate_style",
+        "kind": "function",
+        "doc": "<p>Restore rcParams prior to importing figstyle</p>\n",
+        "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"return-annotation\">):</span></span>",
+        "funcdef": "def"
+    }, {
+        "fullname": "acgc.figstyle.set_mathfont",
+        "modulename": "acgc.figstyle",
+        "qualname": "set_mathfont",
+        "kind": "function",
+        "doc": "<p>Set the font used for typsetting math in Matplotlib</p>\n\n<h6 id=\"parameters\">Parameters</h6>\n\n<ul>\n<li><strong>fontname</strong> (str, default=None):\nNone         : Restore mathtext font to settings before importing figstyle\n'regular'    : Use same font as regular text in math expressions (default).\n               Same as using \\mathregular or \\mathdefault in math expressions.\n               Best for mixing regular and math text for superscripts and subscripts.\n               May lack or have poor positioning of some math symbols (e.g. integrals).\n               This will overwrite mathtext.bf, .bfit, .it, .rm in rcParams.\n'custom'     : Uses custom settings from rcParams (mathtext.bf, .bfit, .it, .rm)\n'cm'         : Computer Modern (i.e. LaTeX default)\n'stix'       : STIX serif\n'stixsans'   : STIX sans-serif; best for sans-serif math\n'dejavuserif': DejaVu Serif (not recommended)\n'dejavusans' : DejaVu Sans (not recommended)</li>\n</ul>\n",
+        "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">fontname</span><span class=\"o\">=</span><span class=\"kc\">None</span></span><span class=\"return-annotation\">):</span></span>",
         "funcdef": "def"
     }, {
         "fullname": "acgc.figstyle.grid_off",
         "modulename": "acgc.figstyle",
         "qualname": "grid_off",
         "kind": "function",
         "doc": "<p>Turn off grid lines</p>\n",
@@ -734,14 +750,21 @@
         "modulename": "acgc.figstyle",
         "qualname": "load_fonts",
         "kind": "function",
         "doc": "<p>Load fonts contained in the acgc/fonts subdirectory</p>\n",
         "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"return-annotation\">):</span></span>",
         "funcdef": "def"
     }, {
+        "fullname": "acgc.figstyle.rcParams_old",
+        "modulename": "acgc.figstyle",
+        "qualname": "rcParams_old",
+        "kind": "variable",
+        "doc": "<p></p>\n",
+        "default_value": "RcParams({&#x27;_internal.classic_mode&#x27;: False,\n          &#x27;agg.path.chunksize&#x27;: 0,\n          &#x27;animation.bitrate&#x27;: -1,\n          &#x27;animation.codec&#x27;: &#x27;h264&#x27;,\n          &#x27;animation.convert_args&#x27;: [&#x27;-layers&#x27;, &#x27;OptimizePlus&#x27;],\n          &#x27;animation.convert_path&#x27;: &#x27;convert&#x27;,\n          &#x27;animation.embed_limit&#x27;: 20.0,\n          &#x27;animation.ffmpeg_args&#x27;: [],\n          &#x27;animation.ffmpeg_path&#x27;: &#x27;ffmpeg&#x27;,\n          &#x27;animation.frame_format&#x27;: &#x27;png&#x27;,\n          &#x27;animation.html&#x27;: &#x27;none&#x27;,\n          &#x27;animation.writer&#x27;: &#x27;ffmpeg&#x27;,\n          &#x27;axes.autolimit_mode&#x27;: &#x27;data&#x27;,\n          &#x27;axes.axisbelow&#x27;: &#x27;line&#x27;,\n          &#x27;axes.edgecolor&#x27;: &#x27;black&#x27;,\n          &#x27;axes.facecolor&#x27;: &#x27;white&#x27;,\n          &#x27;axes.formatter.limits&#x27;: [-5, 6],\n          &#x27;axes.formatter.min_exponent&#x27;: 0,\n          &#x27;axes.formatter.offset_threshold&#x27;: 4,\n          &#x27;axes.formatter.use_locale&#x27;: False,\n          &#x27;axes.formatter.use_mathtext&#x27;: False,\n          &#x27;axes.formatter.useoffset&#x27;: True,\n          &#x27;axes.grid&#x27;: False,\n          &#x27;axes.grid.axis&#x27;: &#x27;both&#x27;,\n          &#x27;axes.grid.which&#x27;: &#x27;major&#x27;,\n          &#x27;axes.labelcolor&#x27;: &#x27;black&#x27;,\n          &#x27;axes.labelpad&#x27;: 4.0,\n          &#x27;axes.labelsize&#x27;: &#x27;medium&#x27;,\n          &#x27;axes.labelweight&#x27;: &#x27;normal&#x27;,\n          &#x27;axes.linewidth&#x27;: 0.8,\n          &#x27;axes.prop_cycle&#x27;: cycler(&#x27;color&#x27;, [&#x27;#1f77b4&#x27;, &#x27;#ff7f0e&#x27;, &#x27;#2ca02c&#x27;, &#x27;#d62728&#x27;, &#x27;#9467bd&#x27;, &#x27;#8c564b&#x27;, &#x27;#e377c2&#x27;, &#x27;#7f7f7f&#x27;, &#x27;#bcbd22&#x27;, &#x27;#17becf&#x27;]),\n          &#x27;axes.spines.bottom&#x27;: True,\n          &#x27;axes.spines.left&#x27;: True,\n          &#x27;axes.spines.right&#x27;: True,\n          &#x27;axes.spines.top&#x27;: True,\n          &#x27;axes.titlecolor&#x27;: &#x27;auto&#x27;,\n          &#x27;axes.titlelocation&#x27;: &#x27;center&#x27;,\n          &#x27;axes.titlepad&#x27;: 6.0,\n          &#x27;axes.titlesize&#x27;: &#x27;large&#x27;,\n          &#x27;axes.titleweight&#x27;: &#x27;normal&#x27;,\n          &#x27;axes.titley&#x27;: None,\n          &#x27;axes.unicode_minus&#x27;: True,\n          &#x27;axes.xmargin&#x27;: 0.05,\n          &#x27;axes.ymargin&#x27;: 0.05,\n          &#x27;axes.zmargin&#x27;: 0.05,\n          &#x27;axes3d.grid&#x27;: True,\n          &#x27;axes3d.xaxis.panecolor&#x27;: (0.95, 0.95, 0.95, 0.5),\n          &#x27;axes3d.yaxis.panecolor&#x27;: (0.9, 0.9, 0.9, 0.5),\n          &#x27;axes3d.zaxis.panecolor&#x27;: (0.925, 0.925, 0.925, 0.5),\n          &#x27;backend&#x27;: &#x27;MacOSX&#x27;,\n          &#x27;backend_fallback&#x27;: True,\n          &#x27;boxplot.bootstrap&#x27;: None,\n          &#x27;boxplot.boxprops.color&#x27;: &#x27;black&#x27;,\n          &#x27;boxplot.boxprops.linestyle&#x27;: &#x27;-&#x27;,\n          &#x27;boxplot.boxprops.linewidth&#x27;: 1.0,\n          &#x27;boxplot.capprops.color&#x27;: &#x27;black&#x27;,\n          &#x27;boxplot.capprops.linestyle&#x27;: &#x27;-&#x27;,\n          &#x27;boxplot.capprops.linewidth&#x27;: 1.0,\n          &#x27;boxplot.flierprops.color&#x27;: &#x27;black&#x27;,\n          &#x27;boxplot.flierprops.linestyle&#x27;: &#x27;none&#x27;,\n          &#x27;boxplot.flierprops.linewidth&#x27;: 1.0,\n          &#x27;boxplot.flierprops.marker&#x27;: &#x27;o&#x27;,\n          &#x27;boxplot.flierprops.markeredgecolor&#x27;: &#x27;black&#x27;,\n          &#x27;boxplot.flierprops.markeredgewidth&#x27;: 1.0,\n          &#x27;boxplot.flierprops.markerfacecolor&#x27;: &#x27;none&#x27;,\n          &#x27;boxplot.flierprops.markersize&#x27;: 6.0,\n          &#x27;boxplot.meanline&#x27;: False,\n          &#x27;boxplot.meanprops.color&#x27;: &#x27;C2&#x27;,\n          &#x27;boxplot.meanprops.linestyle&#x27;: &#x27;--&#x27;,\n          &#x27;boxplot.meanprops.linewidth&#x27;: 1.0,\n          &#x27;boxplot.meanprops.marker&#x27;: &#x27;^&#x27;,\n          &#x27;boxplot.meanprops.markeredgecolor&#x27;: &#x27;C2&#x27;,\n          &#x27;boxplot.meanprops.markerfacecolor&#x27;: &#x27;C2&#x27;,\n          &#x27;boxplot.meanprops.markersize&#x27;: 6.0,\n          &#x27;boxplot.medianprops.color&#x27;: &#x27;C1&#x27;,\n          &#x27;boxplot.medianprops.linestyle&#x27;: &#x27;-&#x27;,\n          &#x27;boxplot.medianprops.linewidth&#x27;: 1.0,\n          &#x27;boxplot.notch&#x27;: False,\n          &#x27;boxplot.patchartist&#x27;: False,\n          &#x27;boxplot.showbox&#x27;: True,\n          &#x27;boxplot.showcaps&#x27;: True,\n          &#x27;boxplot.showfliers&#x27;: True,\n          &#x27;boxplot.showmeans&#x27;: False,\n          &#x27;boxplot.vertical&#x27;: True,\n          &#x27;boxplot.whiskerprops.color&#x27;: &#x27;black&#x27;,\n          &#x27;boxplot.whiskerprops.linestyle&#x27;: &#x27;-&#x27;,\n          &#x27;boxplot.whiskerprops.linewidth&#x27;: 1.0,\n          &#x27;boxplot.whiskers&#x27;: 1.5,\n          &#x27;contour.algorithm&#x27;: &#x27;mpl2014&#x27;,\n          &#x27;contour.corner_mask&#x27;: True,\n          &#x27;contour.linewidth&#x27;: None,\n          &#x27;contour.negative_linestyle&#x27;: &#x27;dashed&#x27;,\n          &#x27;date.autoformatter.day&#x27;: &#x27;%Y-%m-%d&#x27;,\n          &#x27;date.autoformatter.hour&#x27;: &#x27;%m-%d %H&#x27;,\n          &#x27;date.autoformatter.microsecond&#x27;: &#x27;%M:%S.%f&#x27;,\n          &#x27;date.autoformatter.minute&#x27;: &#x27;%d %H:%M&#x27;,\n          &#x27;date.autoformatter.month&#x27;: &#x27;%Y-%m&#x27;,\n          &#x27;date.autoformatter.second&#x27;: &#x27;%H:%M:%S&#x27;,\n          &#x27;date.autoformatter.year&#x27;: &#x27;%Y&#x27;,\n          &#x27;date.converter&#x27;: &#x27;auto&#x27;,\n          &#x27;date.epoch&#x27;: &#x27;1970-01-01T00:00:00&#x27;,\n          &#x27;date.interval_multiples&#x27;: True,\n          &#x27;docstring.hardcopy&#x27;: False,\n          &#x27;errorbar.capsize&#x27;: 0.0,\n          &#x27;figure.autolayout&#x27;: False,\n          &#x27;figure.constrained_layout.h_pad&#x27;: 0.04167,\n          &#x27;figure.constrained_layout.hspace&#x27;: 0.02,\n          &#x27;figure.constrained_layout.use&#x27;: False,\n          &#x27;figure.constrained_layout.w_pad&#x27;: 0.04167,\n          &#x27;figure.constrained_layout.wspace&#x27;: 0.02,\n          &#x27;figure.dpi&#x27;: 100.0,\n          &#x27;figure.edgecolor&#x27;: &#x27;white&#x27;,\n          &#x27;figure.facecolor&#x27;: &#x27;white&#x27;,\n          &#x27;figure.figsize&#x27;: [6.4, 4.8],\n          &#x27;figure.frameon&#x27;: True,\n          &#x27;figure.hooks&#x27;: [],\n          &#x27;figure.labelsize&#x27;: &#x27;large&#x27;,\n          &#x27;figure.labelweight&#x27;: &#x27;normal&#x27;,\n          &#x27;figure.max_open_warning&#x27;: 20,\n          &#x27;figure.raise_window&#x27;: True,\n          &#x27;figure.subplot.bottom&#x27;: 0.11,\n          &#x27;figure.subplot.hspace&#x27;: 0.2,\n          &#x27;figure.subplot.left&#x27;: 0.125,\n          &#x27;figure.subplot.right&#x27;: 0.9,\n          &#x27;figure.subplot.top&#x27;: 0.88,\n          &#x27;figure.subplot.wspace&#x27;: 0.2,\n          &#x27;figure.titlesize&#x27;: &#x27;large&#x27;,\n          &#x27;figure.titleweight&#x27;: &#x27;normal&#x27;,\n          &#x27;font.cursive&#x27;: [&#x27;Apple Chancery&#x27;,\n                           &#x27;Textile&#x27;,\n                           &#x27;Zapf Chancery&#x27;,\n                           &#x27;Sand&#x27;,\n                           &#x27;Script MT&#x27;,\n                           &#x27;Felipa&#x27;,\n                           &#x27;Comic Neue&#x27;,\n                           &#x27;Comic Sans MS&#x27;,\n                           &#x27;cursive&#x27;],\n          &#x27;font.family&#x27;: [&#x27;sans-serif&#x27;],\n          &#x27;font.fantasy&#x27;: [&#x27;Chicago&#x27;,\n                           &#x27;Charcoal&#x27;,\n                           &#x27;Impact&#x27;,\n                           &#x27;Western&#x27;,\n                           &#x27;xkcd script&#x27;,\n                           &#x27;fantasy&#x27;],\n          &#x27;font.monospace&#x27;: [&#x27;DejaVu Sans Mono&#x27;,\n                             &#x27;Bitstream Vera Sans Mono&#x27;,\n                             &#x27;Computer Modern Typewriter&#x27;,\n                             &#x27;Andale Mono&#x27;,\n                             &#x27;Nimbus Mono L&#x27;,\n                             &#x27;Courier New&#x27;,\n                             &#x27;Courier&#x27;,\n                             &#x27;Fixed&#x27;,\n                             &#x27;Terminal&#x27;,\n                             &#x27;monospace&#x27;],\n          &#x27;font.sans-serif&#x27;: [&#x27;DejaVu Sans&#x27;,\n                              &#x27;Bitstream Vera Sans&#x27;,\n                              &#x27;Computer Modern Sans Serif&#x27;,\n                              &#x27;Lucida Grande&#x27;,\n                              &#x27;Verdana&#x27;,\n                              &#x27;Geneva&#x27;,\n                              &#x27;Lucid&#x27;,\n                              &#x27;Arial&#x27;,\n                              &#x27;Helvetica&#x27;,\n                              &#x27;Avant Garde&#x27;,\n                              &#x27;sans-serif&#x27;],\n          &#x27;font.serif&#x27;: [&#x27;DejaVu Serif&#x27;,\n                         &#x27;Bitstream Vera Serif&#x27;,\n                         &#x27;Computer Modern Roman&#x27;,\n                         &#x27;New Century Schoolbook&#x27;,\n                         &#x27;Century Schoolbook L&#x27;,\n                         &#x27;Utopia&#x27;,\n                         &#x27;ITC Bookman&#x27;,\n                         &#x27;Bookman&#x27;,\n                         &#x27;Nimbus Roman No9 L&#x27;,\n                         &#x27;Times New Roman&#x27;,\n                         &#x27;Times&#x27;,\n                         &#x27;Palatino&#x27;,\n                         &#x27;Charter&#x27;,\n                         &#x27;serif&#x27;],\n          &#x27;font.size&#x27;: 10.0,\n          &#x27;font.stretch&#x27;: &#x27;normal&#x27;,\n          &#x27;font.style&#x27;: &#x27;normal&#x27;,\n          &#x27;font.variant&#x27;: &#x27;normal&#x27;,\n          &#x27;font.weight&#x27;: &#x27;normal&#x27;,\n          &#x27;grid.alpha&#x27;: 1.0,\n          &#x27;grid.color&#x27;: &#x27;#b0b0b0&#x27;,\n          &#x27;grid.linestyle&#x27;: &#x27;-&#x27;,\n          &#x27;grid.linewidth&#x27;: 0.8,\n          &#x27;hatch.color&#x27;: &#x27;black&#x27;,\n          &#x27;hatch.linewidth&#x27;: 1.0,\n          &#x27;hist.bins&#x27;: 10,\n          &#x27;image.aspect&#x27;: &#x27;equal&#x27;,\n          &#x27;image.cmap&#x27;: &#x27;viridis&#x27;,\n          &#x27;image.composite_image&#x27;: True,\n          &#x27;image.interpolation&#x27;: &#x27;antialiased&#x27;,\n          &#x27;image.lut&#x27;: 256,\n          &#x27;image.origin&#x27;: &#x27;upper&#x27;,\n          &#x27;image.resample&#x27;: True,\n          &#x27;interactive&#x27;: False,\n          &#x27;keymap.back&#x27;: [&#x27;left&#x27;, &#x27;c&#x27;, &#x27;backspace&#x27;, &#x27;MouseButton.BACK&#x27;],\n          &#x27;keymap.copy&#x27;: [&#x27;ctrl+c&#x27;, &#x27;cmd+c&#x27;],\n          &#x27;keymap.forward&#x27;: [&#x27;right&#x27;, &#x27;v&#x27;, &#x27;MouseButton.FORWARD&#x27;],\n          &#x27;keymap.fullscreen&#x27;: [&#x27;f&#x27;, &#x27;ctrl+f&#x27;],\n          &#x27;keymap.grid&#x27;: [&#x27;g&#x27;],\n          &#x27;keymap.grid_minor&#x27;: [&#x27;G&#x27;],\n          &#x27;keymap.help&#x27;: [&#x27;f1&#x27;],\n          &#x27;keymap.home&#x27;: [&#x27;h&#x27;, &#x27;r&#x27;, &#x27;home&#x27;],\n          &#x27;keymap.pan&#x27;: [&#x27;p&#x27;],\n          &#x27;keymap.quit&#x27;: [&#x27;ctrl+w&#x27;, &#x27;cmd+w&#x27;, &#x27;q&#x27;],\n          &#x27;keymap.quit_all&#x27;: [],\n          &#x27;keymap.save&#x27;: [&#x27;s&#x27;, &#x27;ctrl+s&#x27;],\n          &#x27;keymap.xscale&#x27;: [&#x27;k&#x27;, &#x27;L&#x27;],\n          &#x27;keymap.yscale&#x27;: [&#x27;l&#x27;],\n          &#x27;keymap.zoom&#x27;: [&#x27;o&#x27;],\n          &#x27;legend.borderaxespad&#x27;: 0.5,\n          &#x27;legend.borderpad&#x27;: 0.4,\n          &#x27;legend.columnspacing&#x27;: 2.0,\n          &#x27;legend.edgecolor&#x27;: &#x27;0.8&#x27;,\n          &#x27;legend.facecolor&#x27;: &#x27;inherit&#x27;,\n          &#x27;legend.fancybox&#x27;: True,\n          &#x27;legend.fontsize&#x27;: &#x27;medium&#x27;,\n          &#x27;legend.framealpha&#x27;: 0.8,\n          &#x27;legend.frameon&#x27;: True,\n          &#x27;legend.handleheight&#x27;: 0.7,\n          &#x27;legend.handlelength&#x27;: 2.0,\n          &#x27;legend.handletextpad&#x27;: 0.8,\n          &#x27;legend.labelcolor&#x27;: &#x27;None&#x27;,\n          &#x27;legend.labelspacing&#x27;: 0.5,\n          &#x27;legend.loc&#x27;: &#x27;best&#x27;,\n          &#x27;legend.markerscale&#x27;: 1.0,\n          &#x27;legend.numpoints&#x27;: 1,\n          &#x27;legend.scatterpoints&#x27;: 1,\n          &#x27;legend.shadow&#x27;: False,\n          &#x27;legend.title_fontsize&#x27;: None,\n          &#x27;lines.antialiased&#x27;: True,\n          &#x27;lines.color&#x27;: &#x27;C0&#x27;,\n          &#x27;lines.dash_capstyle&#x27;: &lt;CapStyle.butt: &#x27;butt&#x27;&gt;,\n          &#x27;lines.dash_joinstyle&#x27;: &lt;JoinStyle.round: &#x27;round&#x27;&gt;,\n          &#x27;lines.dashdot_pattern&#x27;: [6.4, 1.6, 1.0, 1.6],\n          &#x27;lines.dashed_pattern&#x27;: [3.7, 1.6],\n          &#x27;lines.dotted_pattern&#x27;: [1.0, 1.65],\n          &#x27;lines.linestyle&#x27;: &#x27;-&#x27;,\n          &#x27;lines.linewidth&#x27;: 1.5,\n          &#x27;lines.marker&#x27;: &#x27;None&#x27;,\n          &#x27;lines.markeredgecolor&#x27;: &#x27;auto&#x27;,\n          &#x27;lines.markeredgewidth&#x27;: 1.0,\n          &#x27;lines.markerfacecolor&#x27;: &#x27;auto&#x27;,\n          &#x27;lines.markersize&#x27;: 6.0,\n          &#x27;lines.scale_dashes&#x27;: True,\n          &#x27;lines.solid_capstyle&#x27;: &lt;CapStyle.projecting: &#x27;projecting&#x27;&gt;,\n          &#x27;lines.solid_joinstyle&#x27;: &lt;JoinStyle.round: &#x27;round&#x27;&gt;,\n          &#x27;macosx.window_mode&#x27;: &#x27;system&#x27;,\n          &#x27;markers.fillstyle&#x27;: &#x27;full&#x27;,\n          &#x27;mathtext.bf&#x27;: &#x27;sans:bold&#x27;,\n          &#x27;mathtext.bfit&#x27;: &#x27;sans:italic:bold&#x27;,\n          &#x27;mathtext.cal&#x27;: &#x27;cursive&#x27;,\n          &#x27;mathtext.default&#x27;: &#x27;it&#x27;,\n          &#x27;mathtext.fallback&#x27;: &#x27;cm&#x27;,\n          &#x27;mathtext.fontset&#x27;: &#x27;dejavusans&#x27;,\n          &#x27;mathtext.it&#x27;: &#x27;sans:italic&#x27;,\n          &#x27;mathtext.rm&#x27;: &#x27;sans&#x27;,\n          &#x27;mathtext.sf&#x27;: &#x27;sans&#x27;,\n          &#x27;mathtext.tt&#x27;: &#x27;monospace&#x27;,\n          &#x27;patch.antialiased&#x27;: True,\n          &#x27;patch.edgecolor&#x27;: &#x27;black&#x27;,\n          &#x27;patch.facecolor&#x27;: &#x27;C0&#x27;,\n          &#x27;patch.force_edgecolor&#x27;: False,\n          &#x27;patch.linewidth&#x27;: 1.0,\n          &#x27;path.effects&#x27;: [],\n          &#x27;path.simplify&#x27;: True,\n          &#x27;path.simplify_threshold&#x27;: 0.111111111111,\n          &#x27;path.sketch&#x27;: None,\n          &#x27;path.snap&#x27;: True,\n          &#x27;pcolor.shading&#x27;: &#x27;auto&#x27;,\n          &#x27;pcolormesh.snap&#x27;: True,\n          &#x27;pdf.compression&#x27;: 6,\n          &#x27;pdf.fonttype&#x27;: 3,\n          &#x27;pdf.inheritcolor&#x27;: False,\n          &#x27;pdf.use14corefonts&#x27;: False,\n          &#x27;pgf.preamble&#x27;: &#x27;&#x27;,\n          &#x27;pgf.rcfonts&#x27;: True,\n          &#x27;pgf.texsystem&#x27;: &#x27;xelatex&#x27;,\n          &#x27;polaraxes.grid&#x27;: True,\n          &#x27;ps.distiller.res&#x27;: 6000,\n          &#x27;ps.fonttype&#x27;: 3,\n          &#x27;ps.papersize&#x27;: &#x27;letter&#x27;,\n          &#x27;ps.useafm&#x27;: False,\n          &#x27;ps.usedistiller&#x27;: None,\n          &#x27;savefig.bbox&#x27;: None,\n          &#x27;savefig.directory&#x27;: &#x27;~&#x27;,\n          &#x27;savefig.dpi&#x27;: &#x27;figure&#x27;,\n          &#x27;savefig.edgecolor&#x27;: &#x27;auto&#x27;,\n          &#x27;savefig.facecolor&#x27;: &#x27;auto&#x27;,\n          &#x27;savefig.format&#x27;: &#x27;png&#x27;,\n          &#x27;savefig.orientation&#x27;: &#x27;portrait&#x27;,\n          &#x27;savefig.pad_inches&#x27;: 0.1,\n          &#x27;savefig.transparent&#x27;: False,\n          &#x27;scatter.edgecolors&#x27;: &#x27;face&#x27;,\n          &#x27;scatter.marker&#x27;: &#x27;o&#x27;,\n          &#x27;svg.fonttype&#x27;: &#x27;path&#x27;,\n          &#x27;svg.hashsalt&#x27;: None,\n          &#x27;svg.image_inline&#x27;: True,\n          &#x27;text.antialiased&#x27;: True,\n          &#x27;text.color&#x27;: &#x27;black&#x27;,\n          &#x27;text.hinting&#x27;: &#x27;force_autohint&#x27;,\n          &#x27;text.hinting_factor&#x27;: 8,\n          &#x27;text.kerning_factor&#x27;: 0,\n          &#x27;text.latex.preamble&#x27;: &#x27;&#x27;,\n          &#x27;text.parse_math&#x27;: True,\n          &#x27;text.usetex&#x27;: False,\n          &#x27;timezone&#x27;: &#x27;UTC&#x27;,\n          &#x27;tk.window_focus&#x27;: False,\n          &#x27;toolbar&#x27;: &#x27;toolbar2&#x27;,\n          &#x27;webagg.address&#x27;: &#x27;127.0.0.1&#x27;,\n          &#x27;webagg.open_in_browser&#x27;: True,\n          &#x27;webagg.port&#x27;: 8988,\n          &#x27;webagg.port_retries&#x27;: 50,\n          &#x27;xaxis.labellocation&#x27;: &#x27;center&#x27;,\n          &#x27;xtick.alignment&#x27;: &#x27;center&#x27;,\n          &#x27;xtick.bottom&#x27;: True,\n          &#x27;xtick.color&#x27;: &#x27;black&#x27;,\n          &#x27;xtick.direction&#x27;: &#x27;out&#x27;,\n          &#x27;xtick.labelbottom&#x27;: True,\n          &#x27;xtick.labelcolor&#x27;: &#x27;inherit&#x27;,\n          &#x27;xtick.labelsize&#x27;: &#x27;medium&#x27;,\n          &#x27;xtick.labeltop&#x27;: False,\n          &#x27;xtick.major.bottom&#x27;: True,\n          &#x27;xtick.major.pad&#x27;: 3.5,\n          &#x27;xtick.major.size&#x27;: 3.5,\n          &#x27;xtick.major.top&#x27;: True,\n          &#x27;xtick.major.width&#x27;: 0.8,\n          &#x27;xtick.minor.bottom&#x27;: True,\n          &#x27;xtick.minor.ndivs&#x27;: &#x27;auto&#x27;,\n          &#x27;xtick.minor.pad&#x27;: 3.4,\n          &#x27;xtick.minor.size&#x27;: 2.0,\n          &#x27;xtick.minor.top&#x27;: True,\n          &#x27;xtick.minor.visible&#x27;: False,\n          &#x27;xtick.minor.width&#x27;: 0.6,\n          &#x27;xtick.top&#x27;: False,\n          &#x27;yaxis.labellocation&#x27;: &#x27;center&#x27;,\n          &#x27;ytick.alignment&#x27;: &#x27;center_baseline&#x27;,\n          &#x27;ytick.color&#x27;: &#x27;black&#x27;,\n          &#x27;ytick.direction&#x27;: &#x27;out&#x27;,\n          &#x27;ytick.labelcolor&#x27;: &#x27;inherit&#x27;,\n          &#x27;ytick.labelleft&#x27;: True,\n          &#x27;ytick.labelright&#x27;: False,\n          &#x27;ytick.labelsize&#x27;: &#x27;medium&#x27;,\n          &#x27;ytick.left&#x27;: True,\n          &#x27;ytick.major.left&#x27;: True,\n          &#x27;ytick.major.pad&#x27;: 3.5,\n          &#x27;ytick.major.right&#x27;: True,\n          &#x27;ytick.major.size&#x27;: 3.5,\n          &#x27;ytick.major.width&#x27;: 0.8,\n          &#x27;ytick.minor.left&#x27;: True,\n          &#x27;ytick.minor.ndivs&#x27;: &#x27;auto&#x27;,\n          &#x27;ytick.minor.pad&#x27;: 3.4,\n          &#x27;ytick.minor.right&#x27;: True,\n          &#x27;ytick.minor.size&#x27;: 2.0,\n          &#x27;ytick.minor.visible&#x27;: False,\n          &#x27;ytick.minor.width&#x27;: 0.6,\n          &#x27;ytick.right&#x27;: False})"
+    }, {
         "fullname": "acgc.gc",
         "modulename": "acgc.gc",
         "kind": "module",
         "doc": "<p>Alias for <code>acgc.geoschem</code>.</p>\n"
     }, {
         "fullname": "acgc.geoschem",
         "modulename": "acgc.geoschem",
@@ -1379,15 +1402,15 @@
         "kind": "module",
         "doc": "<p>Bivariate statistics</p>\n\n<p>Statistical measures of relationships between two populations</p>\n"
     }, {
         "fullname": "acgc.stats.bivariate.BivariateStatistics",
         "modulename": "acgc.stats.bivariate",
         "qualname": "BivariateStatistics",
         "kind": "class",
-        "doc": "<p>A suite of common statistics to quantify bivariate relationships</p>\n\n<p>Class method 'summary' provides a formatted summary of these statistics</p>\n\n<h6 id=\"attributes\">Attributes</h6>\n\n<ul>\n<li><strong>count, n</strong> (int):\nnumber of valid (not NaN) data value pairs</li>\n<li><strong>xmean, ymean</strong> (float):\nmean of x and y variables</li>\n<li><strong>xmedian, ymedian</strong> (float):\nmedian of x and y variables</li>\n<li><strong>xstd, ystd</strong> (float):\nstandard deviation of x and y variables</li>\n<li><strong>mean_difference, md</strong> (float):\nymean - xmean</li>\n<li><strong>mean_absolute_difference, mad</strong> (float):\nmean( |y-x| )</li>\n<li><strong>relative_mean_difference, rmd</strong> (float):\nmd / xmean</li>\n<li><strong>relative_mean_absolute_difference, rmad</strong> (float):\nmad / xmean</li>\n<li><strong>standardized_mean_difference, smd</strong> (float):\nmd / xstd</li>\n<li><strong>standardized_mean_absolute_difference, smad</strong> (float):\nmad /xstd</li>\n<li><strong>mean_relative_difference, mrd</strong> (float):\nmean(y/x) - 1</li>\n<li><strong>mean_log10_ratio, mlr</strong> (float):\nmean( log10(y/x) )</li>\n<li><strong>mean_absolute_log10_ratio, malr</strong> (float):\nmean( abs( log10(y/x) ) )</li>\n<li><strong>median_difference, medd</strong> (float):\nmedian(y-x)</li>\n<li><strong>median_absolute_difference, medad</strong> (float):\nmedian(|y-x|)</li>\n<li><strong>relative_median_difference, rmedd</strong> (float):\nmedian(y-x) / xmedian</li>\n<li><strong>relative_median_absolute_difference, rmedad</strong> (float):\nmedian(|y-x|) / xmedian</li>\n<li><strong>median_relative_difference, medianrd, medrd</strong> (float):\nmedian(y/x)-1</li>\n<li><strong>median_log10_ratio, medlr</strong> (float):\nmedian( log10(y/x) )</li>\n<li><strong>median_absolute_log10_ratio, medalr</strong> (float):\nmedian( abs( log10(y/x) ) )</li>\n<li><strong>normalized_mean_bias_factor, nmbf</strong> (float):\nsee <code>nmbf</code></li>\n<li><strong>normalized_mean_absolute_error_factor, nmaef</strong> (float):\nsee <code>nmaef</code></li>\n<li><strong>root_mean_square_difference, rmsd</strong> (float):\n$\\sqrt{ \\langle (y - x)^2 \\rangle }$</li>\n<li><strong>covariance</strong> (float):\ncov(x,y)</li>\n<li><strong>correlation_pearson, correlation, pearsonr, R, r</strong> (float):\nPearson linear correlation coefficient</li>\n<li><strong>correlation_spearman, spearmanr</strong> (float):\nSpearman, non-parametric rank correlation coefficient</li>\n<li><strong>R2, r2</strong> (float):\nLinear coefficient of determination, $R^2$</li>\n</ul>\n"
+        "doc": "<p>A suite of common statistics to quantify bivariate relationships</p>\n\n<p>Class method 'summary' provides a formatted summary of these statistics</p>\n\n<h6 id=\"attributes\">Attributes</h6>\n\n<ul>\n<li><strong>count, n</strong> (int):\nnumber of valid (not NaN) data value pairs</li>\n<li><strong>xmean, ymean</strong> (float):\nmean of x and y variables</li>\n<li><strong>xmedian, ymedian</strong> (float):\nmedian of x and y variables</li>\n<li><strong>xstd, ystd</strong> (float):\nstandard deviation of x and y variables</li>\n<li><strong>mean_difference, md</strong> (float):\nymean - xmean</li>\n<li><strong>std_difference, stdd</strong> (float):\nstd( y - x )</li>\n<li><strong>mean_absolute_difference, mad</strong> (float):\nmean( |y-x| )</li>\n<li><strong>relative_mean_difference, rmd</strong> (float):\nmd / xmean</li>\n<li><strong>relative_mean_absolute_difference, rmad</strong> (float):\nmad / xmean</li>\n<li><strong>standardized_mean_difference, smd</strong> (float):\nmd / xstd</li>\n<li><strong>standardized_mean_absolute_difference, smad</strong> (float):\nmad /xstd</li>\n<li><strong>mean_relative_difference, mrd</strong> (float):\nmean(y/x) - 1</li>\n<li><strong>mean_log10_ratio, mlr</strong> (float):\nmean( log10(y/x) )</li>\n<li><strong>std_log10_ratio, stdlr</strong> (float):\nstd( log10(y/x) )</li>\n<li><strong>mean_absolute_log10_ratio, malr</strong> (float):\nmean( abs( log10(y/x) ) )</li>\n<li><strong>median_difference, medd</strong> (float):\nmedian(y-x)</li>\n<li><strong>median_absolute_difference, medad</strong> (float):\nmedian(|y-x|)</li>\n<li><strong>relative_median_difference, rmedd</strong> (float):\nmedian(y-x) / xmedian</li>\n<li><strong>relative_median_absolute_difference, rmedad</strong> (float):\nmedian(|y-x|) / xmedian</li>\n<li><strong>median_relative_difference, medianrd, medrd</strong> (float):\nmedian(y/x)-1</li>\n<li><strong>median_log10_ratio, medlr</strong> (float):\nmedian( log10(y/x) )</li>\n<li><strong>median_absolute_log10_ratio, medalr</strong> (float):\nmedian( abs( log10(y/x) ) )</li>\n<li><strong>normalized_mean_bias_factor, nmbf</strong> (float):\nsee <code>nmbf</code></li>\n<li><strong>normalized_mean_absolute_error_factor, nmaef</strong> (float):\nsee <code>nmaef</code></li>\n<li><strong>root_mean_square_difference, rmsd</strong> (float):\n$\\sqrt{ \\langle (y - x)^2 \\rangle }$</li>\n<li><strong>root_mean_square_log10_ratio, rmslr</strong> (float):\n$\\sqrt{ \\langle log10(y/x)^2 \\rangle }$</li>\n<li><strong>covariance</strong> (float):\ncov(x,y)</li>\n<li><strong>correlation_pearson, correlation, pearsonr, R, r</strong> (float):\nPearson linear correlation coefficient</li>\n<li><strong>correlation_spearman, spearmanr</strong> (float):\nSpearman, non-parametric rank correlation coefficient</li>\n<li><strong>R2, r2</strong> (float):\nLinear coefficient of determination, $R^2$</li>\n</ul>\n"
     }, {
         "fullname": "acgc.stats.bivariate.BivariateStatistics.__init__",
         "modulename": "acgc.stats.bivariate",
         "qualname": "BivariateStatistics.__init__",
         "kind": "function",
         "doc": "<p>Compute suite of bivariate statistics during initialization</p>\n\n<p>Statistic values are saved in attributes.\nCAUTION: Weights w are ignored except in SMA fit</p>\n\n<h6 id=\"parameters\">Parameters</h6>\n\n<ul>\n<li><strong>x</strong> (ndarray or str):\nindependent variable values</li>\n<li><strong>y</strong> (ndarray or str):\ndependent variable values, same size as x</li>\n<li><strong>w</strong> (ndarray or str, optional):\nweights for points (x,y), same size as x and y</li>\n<li><strong>dropna</strong> (bool, optional (default=False)):\ndrops NaN values from x, y, and w</li>\n<li><strong>data</strong> (dict-like, optional):\nif x, y, or w are str, then they should be keys in data</li>\n</ul>\n",
         "signature": "<span class=\"signature pdoc-code condensed\">(<span class=\"param\"><span class=\"n\">x</span>, </span><span class=\"param\"><span class=\"n\">y</span>, </span><span class=\"param\"><span class=\"n\">w</span><span class=\"o\">=</span><span class=\"kc\">None</span>, </span><span class=\"param\"><span class=\"n\">dropna</span><span class=\"o\">=</span><span class=\"kc\">False</span>, </span><span class=\"param\"><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"kc\">None</span></span>)</span>"
```

### Comparing `acgc-0.2.6/pyproject.toml` & `acgc-0.3/pyproject.toml`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/release.md` & `acgc-0.3/release.md`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/tests/test_imports.py` & `acgc-0.3/tests/test_imports.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/tests/test_solar.py` & `acgc-0.3/tests/test_solar.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/tests/test_stats_bivariate.py` & `acgc-0.3/tests/test_stats_bivariate.py`

 * *Files identical despite different names*

### Comparing `acgc-0.2.6/tests/test_stats_weighted.py` & `acgc-0.3/tests/test_stats_weighted.py`

 * *Files identical despite different names*

