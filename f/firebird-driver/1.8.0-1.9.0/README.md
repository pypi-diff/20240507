# Comparing `tmp/firebird-driver-1.8.0.tar.gz` & `tmp/firebird-driver-1.9.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "firebird-driver-1.8.0.tar", last modified: Wed Dec  7 16:41:44 2022, max compression
+gzip compressed data, was "firebird-driver-1.9.0.tar", last modified: Tue Jun 27 14:08:14 2023, max compression
```

## Comparing `firebird-driver-1.8.0.tar` & `firebird-driver-1.9.0.tar`

### file list

```diff
@@ -1,26 +1,26 @@
-drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2022-12-07 16:41:44.020195 firebird-driver-1.8.0/
--rw-r--r--   0 pcisar    (1000) users      (100)     1068 2020-04-30 09:23:34.000000 firebird-driver-1.8.0/LICENSE
--rw-r--r--   0 pcisar    (1000) users      (100)     3017 2022-12-07 16:41:44.020195 firebird-driver-1.8.0/PKG-INFO
--rw-r--r--   0 pcisar    (1000) users      (100)      557 2020-10-13 11:10:04.000000 firebird-driver-1.8.0/README.rst
--rw-r--r--   0 pcisar    (1000) users      (100)     1460 2022-11-28 17:26:53.000000 firebird-driver-1.8.0/pyproject.toml
--rw-r--r--   0 pcisar    (1000) users      (100)       38 2022-12-07 16:41:44.020195 firebird-driver-1.8.0/setup.cfg
--rw-r--r--   0 pcisar    (1000) users      (100)      260 2021-02-09 17:37:53.000000 firebird-driver-1.8.0/setup.py
-drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2022-12-07 16:41:44.004195 firebird-driver-1.8.0/src/
-drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2022-12-07 16:41:44.004195 firebird-driver-1.8.0/src/firebird/
-drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2022-12-07 16:41:44.008195 firebird-driver-1.8.0/src/firebird/driver/
--rw-r--r--   0 pcisar    (1000) users      (100)     3085 2022-12-07 14:04:21.000000 firebird-driver-1.8.0/src/firebird/driver/__init__.py
--rw-r--r--   0 pcisar    (1000) users      (100)    14879 2022-10-06 08:16:28.000000 firebird-driver-1.8.0/src/firebird/driver/config.py
--rw-r--r--   0 pcisar    (1000) users      (100)   259985 2022-12-07 16:36:38.000000 firebird-driver-1.8.0/src/firebird/driver/core.py
--rw-r--r--   0 pcisar    (1000) users      (100)   102172 2022-10-11 13:18:24.000000 firebird-driver-1.8.0/src/firebird/driver/fbapi.py
--rw-r--r--   0 pcisar    (1000) users      (100)     1987 2021-02-23 18:23:03.000000 firebird-driver-1.8.0/src/firebird/driver/hooks.py
--rw-r--r--   0 pcisar    (1000) users      (100)    91707 2022-10-11 15:57:13.000000 firebird-driver-1.8.0/src/firebird/driver/interfaces.py
--rw-r--r--   0 pcisar    (1000) users      (100)    34035 2022-10-10 12:31:33.000000 firebird-driver-1.8.0/src/firebird/driver/types.py
-drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2022-12-07 16:41:44.008195 firebird-driver-1.8.0/src/firebird_driver.egg-info/
--rw-r--r--   0 pcisar    (1000) users      (100)     3017 2022-12-07 16:41:43.000000 firebird-driver-1.8.0/src/firebird_driver.egg-info/PKG-INFO
--rw-r--r--   0 pcisar    (1000) users      (100)      525 2022-12-07 16:41:44.000000 firebird-driver-1.8.0/src/firebird_driver.egg-info/SOURCES.txt
--rw-r--r--   0 pcisar    (1000) users      (100)        1 2022-12-07 16:41:43.000000 firebird-driver-1.8.0/src/firebird_driver.egg-info/dependency_links.txt
--rw-r--r--   0 pcisar    (1000) users      (100)       42 2022-12-07 16:41:43.000000 firebird-driver-1.8.0/src/firebird_driver.egg-info/requires.txt
--rw-r--r--   0 pcisar    (1000) users      (100)        9 2022-12-07 16:41:43.000000 firebird-driver-1.8.0/src/firebird_driver.egg-info/top_level.txt
--rw-r--r--   0 pcisar    (1000) users      (100)        1 2022-12-07 16:41:43.000000 firebird-driver-1.8.0/src/firebird_driver.egg-info/zip-safe
-drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2022-12-07 16:41:44.008195 firebird-driver-1.8.0/test/
--rw-------   0 pcisar    (1000) users      (100)   135084 2022-10-29 13:16:45.000000 firebird-driver-1.8.0/test/test_driver.py
+drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2023-06-27 14:08:14.940858 firebird-driver-1.9.0/
+-rw-r--r--   0 pcisar    (1000) users      (100)     1068 2020-04-30 09:23:34.000000 firebird-driver-1.9.0/LICENSE
+-rw-r--r--   0 pcisar    (1000) users      (100)     3021 2023-06-27 14:08:14.940858 firebird-driver-1.9.0/PKG-INFO
+-rw-r--r--   0 pcisar    (1000) users      (100)      557 2020-10-13 11:10:04.000000 firebird-driver-1.9.0/README.rst
+-rw-r--r--   0 pcisar    (1000) users      (100)     1464 2022-12-08 09:48:16.000000 firebird-driver-1.9.0/pyproject.toml
+-rw-r--r--   0 pcisar    (1000) users      (100)       38 2023-06-27 14:08:14.940858 firebird-driver-1.9.0/setup.cfg
+-rw-r--r--   0 pcisar    (1000) users      (100)      260 2021-02-09 17:37:53.000000 firebird-driver-1.9.0/setup.py
+drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2023-06-27 14:08:14.824859 firebird-driver-1.9.0/src/
+drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2023-06-27 14:08:14.824859 firebird-driver-1.9.0/src/firebird/
+drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2023-06-27 14:08:14.828858 firebird-driver-1.9.0/src/firebird/driver/
+-rw-r--r--   0 pcisar    (1000) users      (100)     3104 2023-06-27 14:07:24.000000 firebird-driver-1.9.0/src/firebird/driver/__init__.py
+-rw-r--r--   0 pcisar    (1000) users      (100)    15023 2023-06-12 16:47:20.000000 firebird-driver-1.9.0/src/firebird/driver/config.py
+-rw-r--r--   0 pcisar    (1000) users      (100)   261063 2023-06-12 17:46:42.000000 firebird-driver-1.9.0/src/firebird/driver/core.py
+-rw-r--r--   0 pcisar    (1000) users      (100)   107108 2023-06-12 16:30:40.000000 firebird-driver-1.9.0/src/firebird/driver/fbapi.py
+-rw-r--r--   0 pcisar    (1000) users      (100)     1987 2021-02-23 18:23:03.000000 firebird-driver-1.9.0/src/firebird/driver/hooks.py
+-rw-r--r--   0 pcisar    (1000) users      (100)    92077 2023-06-12 16:30:40.000000 firebird-driver-1.9.0/src/firebird/driver/interfaces.py
+-rw-r--r--   0 pcisar    (1000) users      (100)    34753 2023-06-12 17:34:55.000000 firebird-driver-1.9.0/src/firebird/driver/types.py
+drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2023-06-27 14:08:14.936858 firebird-driver-1.9.0/src/firebird_driver.egg-info/
+-rw-r--r--   0 pcisar    (1000) users      (100)     3021 2023-06-27 14:08:14.000000 firebird-driver-1.9.0/src/firebird_driver.egg-info/PKG-INFO
+-rw-r--r--   0 pcisar    (1000) users      (100)      525 2023-06-27 14:08:14.000000 firebird-driver-1.9.0/src/firebird_driver.egg-info/SOURCES.txt
+-rw-r--r--   0 pcisar    (1000) users      (100)        1 2023-06-27 14:08:14.000000 firebird-driver-1.9.0/src/firebird_driver.egg-info/dependency_links.txt
+-rw-r--r--   0 pcisar    (1000) users      (100)       42 2023-06-27 14:08:14.000000 firebird-driver-1.9.0/src/firebird_driver.egg-info/requires.txt
+-rw-r--r--   0 pcisar    (1000) users      (100)        9 2023-06-27 14:08:14.000000 firebird-driver-1.9.0/src/firebird_driver.egg-info/top_level.txt
+-rw-r--r--   0 pcisar    (1000) users      (100)        1 2023-03-30 14:38:11.000000 firebird-driver-1.9.0/src/firebird_driver.egg-info/zip-safe
+drwxr-xr-x   0 pcisar    (1000) users      (100)        0 2023-06-27 14:08:14.936858 firebird-driver-1.9.0/test/
+-rw-r--r--   0 pcisar    (1000) users      (100)   136974 2023-06-23 14:16:18.000000 firebird-driver-1.9.0/test/test_driver.py
```

### Comparing `firebird-driver-1.8.0/LICENSE` & `firebird-driver-1.9.0/LICENSE`

 * *Files identical despite different names*

### Comparing `firebird-driver-1.8.0/PKG-INFO` & `firebird-driver-1.9.0/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: firebird-driver
-Version: 1.8.0
+Version: 1.9.0
 Summary: Firebird driver for Python
 Author-email: Pavel Cisar <pcisar@users.sourceforge.net>
 License: MIT License
         
         Copyright (c) 2020 FirebirdSQL
         
         Permission is hereby granted, free of charge, to any person obtaining a copy
@@ -22,16 +22,16 @@
         FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
         AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
         LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
         OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
         SOFTWARE.
         
 Project-URL: Home, https://github.com/FirebirdSQL/python3-driver
-Project-URL: Documentation, https://firebird-base.rtfd.io
-Project-URL: Bug Reports, https://github.com/FirebirdSQL/python3-base/issues
+Project-URL: Documentation, https://firebird-driver.rtfd.io
+Project-URL: Bug Reports, https://github.com/FirebirdSQL/python3-driver/issues
 Project-URL: Funding, https://www.firebirdsql.org/en/donate/
 Project-URL: Source, https://github.com/FirebirdSQL/python3-driver
 Keywords: Firebird,RDBMS,driver
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3 :: Only
```

### Comparing `firebird-driver-1.8.0/README.rst` & `firebird-driver-1.9.0/README.rst`

 * *Files identical despite different names*

### Comparing `firebird-driver-1.8.0/pyproject.toml` & `firebird-driver-1.9.0/pyproject.toml`

 * *Files 4% similar despite different names*

```diff
@@ -29,16 +29,16 @@
     "firebird-base>=1.5.0",
     "python-dateutil>=2.8",
     ]
 dynamic = ["version"]
 
 [project.urls]
 Home = "https://github.com/FirebirdSQL/python3-driver"
-Documentation = "https://firebird-base.rtfd.io"
-"Bug Reports" = "https://github.com/FirebirdSQL/python3-base/issues"
+Documentation = "https://firebird-driver.rtfd.io"
+"Bug Reports" = "https://github.com/FirebirdSQL/python3-driver/issues"
 Funding = "https://www.firebirdsql.org/en/donate/"
 Source = "https://github.com/FirebirdSQL/python3-driver"
 
 [tool.setuptools]
 zip-safe = true
 
 [tool.setuptools.dynamic]
```

### Comparing `firebird-driver-1.8.0/src/firebird/driver/__init__.py` & `firebird-driver-1.9.0/src/firebird/driver/__init__.py`

 * *Files 5% similar despite different names*

```diff
@@ -37,15 +37,15 @@
 """
 from .config import driver_config, ServerConfig, DatabaseConfig, DriverConfig
 from .fbapi import load_api, get_api
 from .types import (Error, InterfaceError, DatabaseError, DataError,
      OperationalError, IntegrityError, InternalError, ProgrammingError,
      NotSupportedError, FirebirdWarning,
      NetProtocol, DirectoryCode, PageSize, DBKeyScope, DbInfoCode, Features, ReplicaMode,
-     StmtInfoCode, TraInfoCode, TraInfoIsolation, TraInfoReadCommitted,
+     StmtInfoCode, ResultSetInfoCode, TraInfoCode, TraInfoIsolation, TraInfoReadCommitted,
      TraInfoAccess, TraIsolation, TraReadCommitted, TraLockResolution, TraAccessMode,
      TableShareMode, TableAccessMode, Isolation, DefaultAction, StatementType, BlobType,
      DbAccessMode, DbSpaceReservation, DbWriteMode, ShutdownMode, OnlineMode,
      ShutdownMethod,
      CancelType, DecfloatRound, DecfloatTraps,
      ServerCapability, SrvRepairFlag, SrvStatFlag, SrvBackupFlag,
      SrvRestoreFlag, SrvNBackupFlag, SrvInfoCode, ConnectionFlag, EncryptionFlag,
@@ -55,8 +55,8 @@
      TimeFromTicks, TimestampFromTicks, STRING, BINARY, NUMBER, DATETIME, ROWID,
      get_timezone)
 from .core import (connect, create_database, connect_server, transaction, temp_database,
      tpb, TPB, CHARSET_MAP, TIMEOUT, DistributedTransactionManager, Connection, Cursor,
      Server, Statement)
 
 #: Current driver version, SEMVER string.
-__VERSION__ = '1.8.0'
+__VERSION__ = '1.9.0'
```

### Comparing `firebird-driver-1.8.0/src/firebird/driver/config.py` & `firebird-driver-1.9.0/src/firebird/driver/config.py`

 * *Files 0% similar despite different names*

```diff
@@ -146,14 +146,17 @@
         #: Set DECFLOAT ROUND [Firebird 4], value is `.DecfloatRound`
         self.decfloat_round: EnumOption = \
             EnumOption('decfloat_round', DecfloatRound, "DECFLOAT round mode")
         #: Set DECFLOAT TRAPS [Firebird 4], values are `.DecfloatTraps`
         self.decfloat_traps: ListOption = \
             ListOption('decfloat_traps', DecfloatTraps,
                        "Which DECFLOAT exceptional conditions cause a trap")
+        #: Number of parallel workers
+        self.parallel_workers = \
+            IntOption('parallel_workers', "Number of parallel workers")
         # Create options
         #: Database create option. Page size to be used.
         self.page_size: IntOption = \
             IntOption('page_size', "Page size to be used for created database.")
         #: Database create option. Write mode (True = sync/False = async).
         self.forced_writes: BoolOption = \
             BoolOption('forced_writes', "Write mode for created database (True = sync, False = async)")
```

### Comparing `firebird-driver-1.8.0/src/firebird/driver/core.py` & `firebird-driver-1.9.0/src/firebird/driver/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -407,15 +407,16 @@
                  dummy_packet_interval: int=None, overwrite: bool=False,
                  db_cache_size: int=None, forced_writes: bool=None,
                  reserve_space: bool=None, page_size: int=None, read_only: bool=False,
                  sweep_interval: int=None, db_sql_dialect: int=None, db_charset: str=None,
                  config: str=None, auth_plugin_list: str=None, session_time_zone: str=None,
                  set_db_replica: ReplicaMode=None, set_bind: str=None,
                  decfloat_round: DecfloatRound=None,
-                 decfloat_traps: List[DecfloatTraps]=None
+                 decfloat_traps: List[DecfloatTraps]=None,
+                 parallel_workers: int=None
                  ):
         # Available options:
         # AuthClient, WireCryptPlugin, Providers, ConnectionTimeout, WireCrypt,
         # WireCompression, DummyPacketInterval, RemoteServiceName, RemoteServicePort,
         # RemoteAuxPort, TcpNoNagle, IpcName, RemotePipeName, ClientBatchBuffer [FB4+]
         #: Configuration override
         self.config: Optional[str] = config
@@ -478,14 +479,16 @@
         self.read_only: bool = read_only
         #: Sweep interval for the database [db create only]
         self.sweep_interval: Optional[int] = sweep_interval
         #: SQL dialect for the database [db create only]
         self.db_sql_dialect: Optional[int] = db_sql_dialect
         #: Character set for the database [db create only]
         self.db_charset: Optional[str] = db_charset
+        #: Number of parallel workers
+        self.parallel_workers: int = parallel_workers
     def clear(self) -> None:
         """Clear all information.
         """
         self.config = None
         # Connect
         self.trusted_auth = False
         self.user = None
@@ -582,14 +585,16 @@
                 elif tag == DPBItem.SET_BIND:
                     self.set_bind = dpb.get_string()
                 elif tag == DPBItem.DECFLOAT_ROUND:
                     self.decfloat_round = DecfloatRound(dpb.get_string())
                 elif tag == DPBItem.DECFLOAT_TRAPS:
                     self.decfloat_traps = [DecfloatTraps(v.strip())
                                            for v in dpb.get_string().split(',')]
+                elif tag == DPBItem.PARALLEL_WORKERS:
+                    self.parallel_workers = dpb.get_int()
     def get_buffer(self, *, for_create: bool = False) -> bytes:
         """Create DPB from stored information.
         """
         _py_charset: str = CHARSET_MAP.get(self.charset, 'ascii')
         with a.get_api().util.get_xpb_builder(XpbKind.DPB) as dpb:
             if self.config is not None:
                 dpb.insert_string(DPBItem.CONFIG, self.config, encoding=_py_charset)
@@ -633,14 +638,16 @@
             if self.set_bind is not None:
                 dpb.insert_string(DPBItem.SET_BIND, self.set_bind)
             if self.decfloat_round is not None:
                 dpb.insert_string(DPBItem.DECFLOAT_ROUND, self.decfloat_round.value)
             if self.decfloat_traps is not None:
                 dpb.insert_string(DPBItem.DECFLOAT_TRAPS, ','.join(e.value for e in
                                                                    self.decfloat_traps))
+            if self.parallel_workers is not None:
+                dpb.insert_int(DPBItem.PARALLEL_WORKERS, self.parallel_workers)
             if for_create:
                 if self.page_size is not None:
                     dpb.insert_int(DPBItem.PAGE_SIZE, self.page_size)
                 if self.overwrite:
                     dpb.insert_int(DPBItem.OVERWRITE, 1)
                 if self.db_cache_size is not None:
                     dpb.insert_int(DPBItem.SET_PAGE_BUFFERS, self.db_cache_size)
@@ -1592,15 +1599,16 @@
     IntegrityError = IntegrityError
     InternalError = InternalError
     ProgrammingError = ProgrammingError
     NotSupportedError = NotSupportedError
     def __init__(self, att: iAttachment, dsn: str, dpb: bytes=None, sql_dialect: int=3,
                  charset: str=None) -> None:
         self._att: iAttachment = att
-        self.__str: str = f'Connection[{self._get_db_handle()}]'
+        self.__handle: a.FB_API_HANDLE = None
+        self.__str: str = f'Connection[{self._get_handle().value}]'
         self.__charset: str = charset
         self.__precision_cache = {}
         self.__sqlsubtype_cache = {}
         self.__ecollectors: List[EventCollector] = []
         self.__dsn: str = dsn
         self.__sql_dialect: int = sql_dialect
         self._encoding: str = CHARSET_MAP.get(charset, 'ascii')
@@ -1635,24 +1643,24 @@
             self._att.detach()
     def __enter__(self) -> Connection:
         return self
     def __exit__(self, exc_type, exc_value, traceback) -> None:
         self.close()
     def __repr__(self):
         return self.__str
-    def _get_db_handle(self) -> int:
-        isc_status = a.ISC_STATUS_ARRAY()
-        db_handle = a.FB_API_HANDLE(0)
-        api = a.get_api()
-        api.fb_get_database_handle(isc_status, db_handle, self._att)
-        if a.db_api_error(isc_status):  # pragma: no cover
-            raise a.exception_from_status(DatabaseError,
-                                          isc_status,
-                                          "Error in Cursor._unpack_output:fb_get_database_handle()")
-        return db_handle.value
+    def _get_handle(self) -> a.FB_API_HANDLE:
+        if self.__handle is None:
+            isc_status = a.ISC_STATUS_ARRAY()
+            self.__handle = a.FB_API_HANDLE(0)
+            a.get_api().fb_get_database_handle(isc_status, self.__handle, self._att)
+            if a.db_api_error(isc_status):  # pragma: no cover
+                raise a.exception_from_status(DatabaseError,
+                                              isc_status,
+                                              "Error in Connection._get_handle:fb_get_database_handle()")
+        return self.__handle
     def __stmt_deleted(self, stmt) -> None:
         self._statements.remove(stmt)
     def _close(self) -> None:
         if self.__schema is not None:
             self.__schema._set_internal(False)
             self.__schema.close()
         if self.__monitor is not None:
@@ -1787,22 +1795,15 @@
         self.main_transaction.execute_immediate(sql)
     def event_collector(self, event_names: Sequence[str]) -> EventCollector:
         """Create new `EventCollector` instance for this connection.
 
         Arguments:
             event_names: Sequence of database event names to whom the collector should be subscribed.
         """
-        isc_status = a.ISC_STATUS_ARRAY()
-        db_handle = a.FB_API_HANDLE(0)
-        a.api.fb_get_database_handle(isc_status, db_handle, self._att)
-        if a.db_api_error(isc_status):  # pragma: no cover
-            raise a.exception_from_status(DatabaseError,
-                                          isc_status,
-                                          "Error in Connection.get_events:fb_get_database_handle()")
-        conduit = EventCollector(db_handle, event_names)
+        conduit = EventCollector(self._get_handle(), event_names)
         self.__ecollectors.append(conduit)
         return conduit
     def close(self) -> None:
         """Close the connection and release all associated resources.
 
         Closes all event collectors, transaction managers (with rollback) and statements
         associated with this connection before attempt (see Hooks) to close the
@@ -2120,15 +2121,16 @@
               charset=charset, cache_size=db_config.cache_size.value,
               no_linger=db_config.no_linger.value, utf8filename=db_config.utf8filename.value,
               no_gc=no_gc, no_db_triggers=no_db_triggers, dbkey_scope=dbkey_scope,
               dummy_packet_interval=db_config.dummy_packet_interval.value,
               config=db_config.config.value, auth_plugin_list=auth_plugin_list,
               session_time_zone=session_time_zone, set_bind=db_config.set_bind.value,
               decfloat_round=db_config.decfloat_round.value,
-              decfloat_traps=db_config.decfloat_traps.value)
+              decfloat_traps=db_config.decfloat_traps.value,
+              parallel_workers=db_config.parallel_workers.value)
     return __make_connection(False, dsn, db_config.utf8filename.value, dpb.get_buffer(),
                              db_config.sql_dialect.value, charset, crypt_callback)
 
 def create_database(database: str, *, user: str=None, password: str=None, role: str=None,
                     no_gc: bool=None, no_db_triggers: bool=None, dbkey_scope: DBKeyScope=None,
                     crypt_callback: iCryptKeyCallbackImpl=None, charset: str=None,
                     overwrite: bool=False, auth_plugin_list=None,
@@ -2339,14 +2341,15 @@
     def __init__(self, connection: Connection, default_tpb: bytes,
                  default_action: DefaultAction=DefaultAction.COMMIT):
         self._connection: Callable[[], Connection] = weakref.ref(connection, self.__dead_con)
         #: Default Transaction Parameter Block used to start transaction
         self.default_tpb: bytes = default_tpb
         #: Default action (commit/rollback) to be performed when transaction is closed.
         self.default_action: DefaultAction = default_action
+        self.__handle: a.FB_API_HANDLE = None
         self.__info: Union[TransactionInfoProvider, TransactionInfoProvider3] = None
         self._cursors: List = []  # Weak references to cursors
         self._tra: iTransaction = None
         self.__closed: bool = False
         self._logging_id_ = 'Transaction'
     def __enter__(self) -> TransactionManager:
         self.begin()
@@ -2373,14 +2376,25 @@
                     default_action = self.default_action
                 if default_action == DefaultAction.COMMIT:
                     self.commit()
                 else:
                     self.rollback()
         finally:
             self._tra = None
+            self.__handle = None
+    def _get_handle(self) -> a.FB_API_HANDLE:
+        if self.__handle is None:
+            isc_status = a.ISC_STATUS_ARRAY()
+            self.__handle = a.FB_API_HANDLE(0)
+            a.get_api().fb_get_transaction_handle(isc_status, self.__handle, self._tra)
+            if a.db_api_error(isc_status):  # pragma: no cover
+                raise a.exception_from_status(DatabaseError,
+                                              isc_status,
+                                              "Error in TransactionManager._get_handle:fb_get_transaction_handle()")
+        return self.__handle
     def close(self) -> None:
         """Close the transaction manager and release all associated resources.
 
         Important:
             Closed instance SHALL NOT be used anymore.
         """
         if not self.__closed:
@@ -2663,15 +2677,15 @@
             meta.release()
             self._out_desc = []
             self._names = []
         else:
             self._out_meta = meta
             self._out_buffer = create_string_buffer(meta.get_message_length())
             self._out_desc = create_meta_descriptors(meta)
-            self._names = [meta.field if meta.field == meta.alias else meta.alias for meta in self._out_desc]
+            self._names = [m.field if m.field == m.alias else m.alias for m in self._out_desc]
     def __enter__(self) -> Statement:
         return self
     def __exit__(self, exc_type, exc_value, traceback) -> None:
         self.free()
     def __del__(self):
         if self._in_meta or self._out_meta or self._istmt:
             warn(f"Statement '{self.logging_id}' disposed without prior free()", ResourceWarning)
@@ -3367,29 +3381,19 @@
                             blob.close()
                             del blob_buf
                 elif datatype == SQLDataType.ARRAY:
                     arrayid = a.ISC_QUAD(0, 0)
                     arrayid_ptr = pointer(arrayid)
                     arraydesc = a.ISC_ARRAY_DESC(0)
                     isc_status = a.ISC_STATUS_ARRAY()
-                    db_handle = a.FB_API_HANDLE(0)
-                    tr_handle = a.FB_API_HANDLE(0)
+                    db_handle = self._connection._get_handle()
+                    tr_handle = self._transaction._get_handle()
                     relname = in_meta.get_relation(i).encode(self._encoding)
                     sqlname = in_meta.get_field(i).encode(self._encoding)
                     api = a.get_api()
-                    api.fb_get_database_handle(isc_status, db_handle, self._connection._att)
-                    if a.db_api_error(isc_status):  # pragma: no cover
-                        raise a.exception_from_status(DatabaseError,
-                                                      isc_status,
-                                                      "Error in Cursor._pack_input:fb_get_database_handle()")
-                    api.fb_get_transaction_handle(isc_status, tr_handle, self._transaction._tra)
-                    if a.db_api_error(isc_status):  # pragma: no cover
-                        raise a.exception_from_status(DatabaseError,
-                                                      isc_status,
-                                                      "Error in Cursor._pack_input:fb_get_transaction_handle()")
                     sqlsubtype = self._connection._get_array_sqlsubtype(relname, sqlname)
                     api.isc_array_lookup_bounds(isc_status, db_handle, tr_handle,
                                                 relname, sqlname, arraydesc)
                     if a.db_api_error(isc_status):  # pragma: no cover
                         raise a.exception_from_status(DatabaseError,
                                                       isc_status,
                                                       "Error in Cursor._pack_input:isc_array_lookup_bounds()")
@@ -3521,29 +3525,19 @@
                 elif datatype == SQLDataType.ARRAY:
                     value = []
                     val = buffer[offset:offset+length]
                     arrayid = a.ISC_QUAD((0).from_bytes(val[:4], 'little'),
                                          (0).from_bytes(val[4:], 'little'))
                     arraydesc = a.ISC_ARRAY_DESC(0)
                     isc_status = a.ISC_STATUS_ARRAY()
-                    db_handle = a.FB_API_HANDLE(0)
-                    tr_handle = a.FB_API_HANDLE(0)
+                    db_handle = self._connection._get_handle()
+                    tr_handle = self._transaction._get_handle()
                     relname = desc.relation.encode(self._encoding)
                     sqlname = desc.field.encode(self._encoding)
                     api = a.get_api()
-                    api.fb_get_database_handle(isc_status, db_handle, self._connection._att)
-                    if a.db_api_error(isc_status):  # pragma: no cover
-                        raise a.exception_from_status(DatabaseError,
-                                                      isc_status,
-                                                      "Error in Cursor._unpack_output:fb_get_database_handle()")
-                    api.fb_get_transaction_handle(isc_status, tr_handle, self._transaction._tra)
-                    if a.db_api_error(isc_status):  # pragma: no cover
-                        raise a.exception_from_status(DatabaseError,
-                                                      isc_status,
-                                                      "Error in Cursor._unpack_output:fb_get_transaction_handle()")
                     sqlsubtype = self._connection._get_array_sqlsubtype(relname, sqlname)
                     api.isc_array_lookup_bounds(isc_status, db_handle, tr_handle,
                                                 relname, sqlname, arraydesc)
                     if a.db_api_error(isc_status):  # pragma: no cover
                         raise a.exception_from_status(DatabaseError,
                                                       isc_status,
                                                       "Error in Cursor._unpack_output:isc_array_lookup_bounds()")
@@ -3928,15 +3922,15 @@
     def description(self) -> Tuple[DESCRIPTION]:
         """Tuple of DESCRIPTION tuples (with 7-items).
 
         Each of these tuples contains information describing one result column:
         (name, type_code, display_size, internal_size, precision, scale, null_ok)
         """
         if self._stmt is None:
-            return []
+            return None
         if self._stmt._desc is None:
             desc = []
             for meta in self._stmt._out_desc:
                 scale = meta.scale
                 precision = 0
                 if meta.datatype in (SQLDataType.TEXT, SQLDataType.VARYING):
                     vtype = str
@@ -3990,15 +3984,15 @@
                     dispsize = 5
                 else:
                     vtype = None
                     dispsize = -1
                 desc.append(tuple([meta.field if meta.field == meta.alias else meta.alias,
                                   vtype, dispsize, meta.length, precision,
                                   scale, meta.nullable]))
-            self._stmt._desc = tuple(desc)
+            self._stmt._desc = tuple(desc) if desc else None
         return self._stmt._desc
     @property
     def affected_rows(self) -> int:
         """Specifies the number of rows that the last `.execute` or `.open`
         produced (for DQL statements like select) or affected (for DML statements
         like update or insert ).
 
@@ -4232,15 +4226,15 @@
                 callback(line)
     def backup(self, *, database: FILESPEC, backup: Union[FILESPEC, Sequence[FILESPEC]],
                backup_file_sizes: Sequence[int]=(),
                flags: SrvBackupFlag=SrvBackupFlag.NONE, role: str=None,
                callback: CB_OUTPUT_LINE=None, stats: str=None,
                verbose: bool=False, verbint: int=None, skip_data: str=None,
                include_data: str=None, keyhoder: str=None, keyname: str=None,
-               crypt: str=None) -> None:
+               crypt: str=None, parallel_workers: int=None) -> None:
         """Request logical (GBAK) database backup. **(ASYNC service)**
 
         Arguments:
             database: Database file specification or alias.
             backup: Backup filespec, or list of backup file specifications.
             backup_file_sizes: List of file sizes for backup files.
             flags: Backup options.
@@ -4250,14 +4244,15 @@
             verbose: Whether output should be verbose or not.
             verbint: Verbose information with explicit interval (number of records)
             skip_data: String with table names whose data should be excluded from backup.
             include_data: String with table names whose data should be included into backup [Firebird 4].
             keyholder: Keyholder name [Firebird 4]
             keyname: Key name [Firebird 4]
             crypt: Encryption specification [Firebird 4]
+            parallel_workers: Number of parallel workers [Firebird 5]
         """
         if isinstance(backup, (str, Path)):
             backup = [backup]
             assert len(backup_file_sizes) == 0
         else:
             assert len(backup) >= 1
             assert len(backup) == len(backup_file_sizes) - 1
@@ -4277,14 +4272,16 @@
                 spb.insert_string(SrvBackupOption.INCLUDE_DATA, include_data)
             if keyhoder is not None:
                 spb.insert_string(SrvBackupOption.KEYHOLDER, keyhoder)
             if keyname is not None:
                 spb.insert_string(SrvBackupOption.KEYNAME, keyname)
             if crypt is not None:
                 spb.insert_string(SrvBackupOption.CRYPT, crypt)
+            if parallel_workers is not None:
+                spb.insert_int(SrvBackupOption.PARALLEL_WORKERS, parallel_workers)
             spb.insert_int(SPBItem.OPTIONS, flags)
             if verbose:
                 spb.insert_tag(SPBItem.VERBOSE)
             if verbint is not None:
                 spb.insert_int(SPBItem.VERBINT, verbint)
             if stats:
                 spb.insert_string(SrvBackupOption.STAT, stats)
@@ -4297,15 +4294,15 @@
                 db_file_pages: Sequence[int]=(),
                 flags: SrvRestoreFlag=SrvRestoreFlag.CREATE, role: str=None,
                 callback: CB_OUTPUT_LINE=None, stats: str=None,
                 verbose: bool=False, verbint: int=None, skip_data: str=None,
                 page_size: int=None, buffers: int=None,
                 access_mode: DbAccessMode=DbAccessMode.READ_WRITE, include_data: str=None,
                 keyhoder: str=None, keyname: str=None, crypt: str=None,
-                replica_mode: ReplicaMode=None) -> None:
+                replica_mode: ReplicaMode=None, parallel_workers: int=None) -> None:
         """Request database restore from logical (GBAK) backup. **(ASYNC service)**
 
         Arguments:
             backup: Backup filespec, or list of backup file specifications.
             database: Database specification or alias, or list of those.
             db_file_pages: List of database file sizes (in pages).
             flags: Restore options.
@@ -4319,14 +4316,15 @@
             buffers: Cache size for restored database.
             access_mode: Restored database access mode (R/W or R/O).
             include_data: String with table names whose data should be included into backup [Firebird 4].
             keyholder: Keyholder name [Firebird 4]
             keyname: Key name [Firebird 4]
             crypt: Encryption specification [Firebird 4]
             replica_mode: Replica mode for restored database [Firebird 4]
+            parallel_workers: Number of parallel workers [Firebird 5]
         """
         if isinstance(backup, (str, Path)):
             backup = [backup]
         if isinstance(database, (str, Path)):
             database = [database]
             assert len(db_file_pages) == 0
         else:
@@ -4356,14 +4354,16 @@
                 spb.insert_string(SrvRestoreOption.KEYHOLDER, keyhoder)
             if keyname is not None:
                 spb.insert_string(SrvRestoreOption.KEYNAME, keyname)
             if crypt is not None:
                 spb.insert_string(SrvRestoreOption.CRYPT, crypt)
             if replica_mode is not None:
                 spb.insert_int(SrvRestoreOption.REPLICA_MODE, replica_mode.value)
+            if parallel_workers is not None:
+                spb.insert_int(SrvRestoreOption.PARALLEL_WORKERS, parallel_workers)
             spb.insert_int(SPBItem.OPTIONS, flags)
             if verbose:
                 spb.insert_tag(SPBItem.VERBOSE)
             if verbint is not None:
                 spb.insert_int(SPBItem.VERBINT, verbint)
             if stats:
                 spb.insert_string(SrvRestoreOption.STAT, stats)
@@ -4575,14 +4575,15 @@
         with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_int(SrvPropertiesOption.PAGE_BUFFERS, size)
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def set_sweep_interval(self, *, database: FILESPEC, interval: int, role: str=None) -> None:
         """Set database sweep interval.
 
         Arguments:
             database: Database specification or alias.
             interval: New value.
             role: SQL ROLE name passed to gfix.
@@ -4591,14 +4592,15 @@
         with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_int(SrvPropertiesOption.SWEEP_INTERVAL, interval)
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def set_space_reservation(self, *, database: FILESPEC, mode: DbSpaceReservation,
                               role: str=None) -> None:
         """Set space reservation for database.
 
         Arguments:
             database: Database specification or alias.
             mode: New value.
@@ -4609,14 +4611,15 @@
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_bytes(SrvPropertiesOption.RESERVE_SPACE,
                              bytes([mode]))
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def set_write_mode(self, *, database: FILESPEC, mode: DbWriteMode, role: str=None) -> None:
         """Set database write mode (SYNC/ASYNC).
 
         Arguments:
             database: Database specification or alias.
             mode: New value.
             role: SQL ROLE name passed to gfix.
@@ -4626,14 +4629,15 @@
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_bytes(SrvPropertiesOption.WRITE_MODE,
                              bytes([mode]))
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def set_access_mode(self, *, database: FILESPEC, mode: DbAccessMode, role: str=None) -> None:
         """Set database access mode (R/W or R/O).
 
         Arguments:
             database: Database specification or alias.
             mode: New value.
             role: SQL ROLE name passed to gfix.
@@ -4642,14 +4646,15 @@
         with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_bytes(SrvPropertiesOption.ACCESS_MODE, bytes([mode]))
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def set_sql_dialect(self, *, database: FILESPEC, dialect: int, role: str=None) -> None:
         """Set database SQL dialect.
 
         Arguments:
             database: Database specification or alias.
             dialect: New value.
             role: SQL ROLE name passed to gfix.
@@ -4658,14 +4663,15 @@
         with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_int(SrvPropertiesOption.SET_SQL_DIALECT, dialect)
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def activate_shadow(self, *, database: FILESPEC, role: str=None) -> None:
         """Activate database shadow.
 
         Arguments:
             database: Database specification or alias.
             role: SQL ROLE name passed to gfix.
         """
@@ -4673,14 +4679,15 @@
         with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_int(SPBItem.OPTIONS, SrvPropertiesFlag.ACTIVATE)
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def no_linger(self, *, database: FILESPEC, role: str=None) -> None:
         """Set one-off override for database linger.
 
         Arguments:
             database: Database specification or alias.
             role: SQL ROLE name passed to gfix.
         """
@@ -4688,14 +4695,15 @@
         with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_int(SPBItem.OPTIONS, SrvPropertiesFlag.NOLINGER)
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def shutdown(self, *, database: FILESPEC, mode: ShutdownMode,
                  method: ShutdownMethod, timeout: int, role: str=None) -> None:
         """Database shutdown.
 
         Arguments:
             database: Database specification or alias.
             mode: Shutdown mode.
@@ -4708,14 +4716,15 @@
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_bytes(SrvPropertiesOption.SHUTDOWN_MODE, bytes([mode]))
             spb.insert_int(method, timeout)
             self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
     def bring_online(self, *, database: FILESPEC, mode: OnlineMode=OnlineMode.NORMAL,
                      role: str=None) -> None:
         """Bring previously shut down database back online.
 
         Arguments:
             database: Database specification or alias.
             mode: Online mode.
@@ -4725,32 +4734,36 @@
         with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
             spb.insert_tag(ServerAction.PROPERTIES)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_bytes(SrvPropertiesOption.ONLINE_MODE, bytes([mode]))
             self._srv()._svc.start(spb.get_buffer())
-    def sweep(self, *, database: FILESPEC, role: str=None) -> None:
+        self._srv().wait()
+    def sweep(self, *, database: FILESPEC, role: str=None, parallel_workers: int=None) -> None:
         """Perform database sweep operation.
 
         Arguments:
             database: Database specification or alias.
             role: SQL ROLE name passed to gfix.
+            parallel_workers: Number of parallel workers [Firebird 5]
         """
         self._srv()._reset_output()
         with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
             spb.insert_tag(ServerAction.REPAIR)
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
+            if parallel_workers is not None:
+                spb.insert_int(SrvRepairOption.PARALLEL_WORKERS, parallel_workers)
             spb.insert_int(SPBItem.OPTIONS, SrvRepairFlag.SWEEP_DB)
             self._srv()._svc.start(spb.get_buffer())
         self._srv().wait()
     def repair(self, *, database: FILESPEC, flags: SrvRepairFlag=SrvRepairFlag.REPAIR,
-               role: str=None) -> bytes:
+               role: str=None) -> None:
         """Perform database repair operation.  **(SYNC service)**
 
         Arguments:
             database: Database specification or alias.
             flags: Repair flags.
             role: SQL ROLE name passed to gfix.
         """
@@ -4903,15 +4916,15 @@
             if transaction_id <= USHRT_MAX:
                 spb.insert_int(SrvRepairOption.ROLLBACK_TRANS, transaction_id)
             else:
                 spb.insert_bigint(SrvRepairOption.ROLLBACK_TRANS_64, transaction_id)
             self._srv()._svc.start(spb.get_buffer())
         self._srv()._read_all_binary_output()
 
-class ServerDbServices(ServerDbServices3):
+class ServerDbServices4(ServerDbServices3):
     """Database-related actions and services [Firebird 4+].
     """
     def nfix_database(self, *, database: FILESPEC, role: str=None,
                       flags: SrvNBackupFlag=SrvNBackupFlag.NONE) -> None:
         """Fixup database after filesystem copy.
 
         Arguments:
@@ -4942,14 +4955,34 @@
             spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
             if role is not None:
                 spb.insert_string(SPBItem.SQL_ROLE_NAME, role, encoding=self._srv().encoding)
             spb.insert_bytes(SrvPropertiesOption.REPLICA_MODE, bytes([mode]))
             self._srv()._svc.start(spb.get_buffer())
         self._srv().wait()
 
+class ServerDbServices(ServerDbServices4):
+    """Database-related actions and services [Firebird 5+].
+    """
+    def upgrade(self, *, database: FILESPEC) -> bytes:
+        """Perform database repair operation.  **(SYNC service)**
+
+        Arguments:
+            database: Database specification or alias.
+            flags: Repair flags.
+            role: SQL ROLE name passed to gfix.
+        """
+        self._srv()._reset_output()
+        with a.get_api().util.get_xpb_builder(XpbKind.SPB_START) as spb:
+            spb.insert_tag(ServerAction.REPAIR)
+            spb.insert_string(SPBItem.DBNAME, str(database), encoding=self._srv().encoding)
+            spb.insert_int(SPBItem.OPTIONS, SrvRepairFlag.UPGRADE_DB)
+            self._srv()._svc.start(spb.get_buffer())
+        self._srv().wait()
+
+
 class ServerUserServices(ServerServiceProvider):
     """User-related actions and services.
     """
     def __fetch_users(self, data: Buffer) -> List[UserInfo]:
         users = []
         user = {}
         while not data.is_eof():
@@ -5457,16 +5490,20 @@
             self.__info = ServerInfoProvider(self.encoding, self)
         return self.__info
     @property
     def database(self) -> Union[ServerDbServices3, ServerDbServices]:
         """Access to various database-related actions and services.
         """
         if self.__dbsvc is None:
-            cls = ServerDbServices if self._engine_version() >= 4.0 \
-                else ServerDbServices3
+            if self._engine_version() >= 5.0:
+                cls = ServerDbServices
+            elif self._engine_version() == 4.0:
+                cls = ServerDbServices4
+            else:
+                cls = ServerDbServices3
             self.__dbsvc = cls(self)
         return self.__dbsvc
     @property
     def trace(self) -> ServerTraceServices:
         """Access to various database-related actions and services.
         """
         if self.__trace is None:
```

### Comparing `firebird-driver-1.8.0/src/firebird/driver/fbapi.py` & `firebird-driver-1.9.0/src/firebird/driver/fbapi.py`

 * *Files 2% similar despite different names*

```diff
@@ -977,16 +977,22 @@
 IResultSet_isBof = CFUNCTYPE(c_bool, IResultSet, IStatus)
 # function getMetadata(this: IResultSet; status: IStatus): IMessageMetadata
 IResultSet_getMetadata = CFUNCTYPE(IMessageMetadata, IResultSet, IStatus)
 # procedure deprecatedClose(this: IResultSet; status: IStatus)
 IResultSet_deprecatedClose = CFUNCTYPE(None, IResultSet, IStatus)
 # procedure setDelayedOutputFormat(this: IResultSet; status: IStatus; format: IMessageMetadata)
 IResultSet_setDelayedOutputFormat = CFUNCTYPE(None, IResultSet, IStatus, IMessageMetadata)
+# IResultSet(4) : IResultSet(3)
 # procedure close(this: IResultSet; status: IStatus)
 IResultSet_close = CFUNCTYPE(None, IResultSet, IStatus)
+# >>> Firebird 5
+# IResultSet(5) : IResultSet(4)
+# procedure(this: IResultSet; status: IStatus; itemsLength: Cardinal; items: BytePtr; bufferLength: Cardinal; buffer: BytePtr); cdecl;
+IResultSet_getInfo = CFUNCTYPE(None, IResultSet, IStatus, Cardinal, BytePtr, Cardinal, BytePtr)
+
 #
 # IStatement(3) : ReferenceCounted
 # --------------------------------
 # procedure getInfo(this: IStatement; status: IStatus; itemsLength: Cardinal; items: BytePtr; bufferLength: Cardinal; buffer: BytePtr)
 IStatement_getInfo = CFUNCTYPE(None, IStatement, IStatus, Cardinal, BytePtr, Cardinal, BytePtr)
 # function getType(this: IStatement; status: IStatus): Cardinal
 IStatement_getType = CFUNCTYPE(Cardinal, IStatement, IStatus)
@@ -1545,15 +1551,17 @@
     ('fetchAbsolute', IResultSet_fetchAbsolute),
     ('fetchRelative', IResultSet_fetchRelative),
     ('isEof', IResultSet_isEof),
     ('isBof', IResultSet_isBof),
     ('getMetadata', IResultSet_getMetadata),
     ('deprecatedClose', IResultSet_deprecatedClose),
     ('setDelayedOutputFormat', IResultSet_setDelayedOutputFormat),
-    ('close', IResultSet_close)] # v4: 3.0.7 => 3.0.8, 4.0.0 => 4.0.1
+    ('close', IResultSet_close), # v4: 3.0.7 => 3.0.8, 4.0.0 => 4.0.1
+    ('getInfo', IResultSet_getInfo),  # v5: 5.0.0
+    ]
 # >>> Firebird 4
 # IStatement(5) : ReferenceCounted
 IStatement_VTable._fields_ = [ # v3 - initial
     ('dummy', c_void_p),
     ('version', c_ulong),
     ('addRef', IReferenceCounted_addRef),
     ('release', IReferenceCounted_release),
@@ -1951,30 +1959,67 @@
             Arguments:
                 status (`ISC_STATUS_PTR`): ISC status
 
             Returns:
                 `ISC_LONG`
 
         isc_array_lookup_bounds():
-            Old API function isc_array_lookup_bounds()
+            Old API function.
 
         isc_array_put_slice():
-            Old API function isc_array_put_slice()
+            Old API function.
 
         isc_array_get_slice():
-            Old API function isc_array_get_slice()
+            Old API function.
 
         isc_que_events():
-            Old API function isc_que_events()
+            Old API function.
 
         isc_event_counts():
-            Old API function isc_event_counts()
+            Old API function.
 
         isc_cancel_events():
-            Old API function isc_cancel_events()
+            Old API function.
+
+        isc_compile_request()
+            Old API function.
+
+        isc_start_request()
+            Old API function.
+
+        isc_release_request()
+            Old API function.
+
+        isc_receive()
+            Old API function.
+
+        isc_start_and_send()
+            Old API function.
+
+        isc_send()
+            Old API function.
+
+        isc_open_blob2()
+            Old API function.
+
+        isc_blob_info()
+            Old API function.
+
+        isc_create_blob2()
+            Old API function.
+
+        isc_get_segment()
+            Old API function.
+
+        isc_put_segment()
+            Old API function.
+
+        isc_close_blob():
+            Old API function.
+
     """
     def __init__(self, filename: Path = None):
         decimal.getcontext().prec = 34
         if filename is None:
             if sys.platform == 'darwin':
                 filename = find_library('Firebird')
             elif sys.platform == 'win32':
@@ -1988,92 +2033,154 @@
             if not filename:
                 raise Exception("The location of Firebird Client Library could not be determined.")
         elif not filename.exists():
             file_name = find_library(filename.name)
             if not file_name:
                 raise Exception(f"Firebird Client Library '{filename}' not found")
             filename = file_name
+        #: Firebird client library
         self.client_library: ctypes.CDLL = None
         if sys.platform in ('win32', 'cygwin', 'os2', 'os2emx'):
             self.client_library: ctypes.CDLL = ctypes.WinDLL(str(filename))
         else:
             self.client_library: ctypes.CDLL = ctypes.CDLL(str(filename))
-        #
+        #: Firebird client library name
         self.client_library_name: Path = Path(filename)
-        #
+        #: Firebird API
         self.fb_get_master_interface = (self.client_library.fb_get_master_interface)
         self.fb_get_master_interface.restype = IMaster
         self.fb_get_master_interface.argtypes = []
-        #
+        #: Firebird API
         self.fb_get_database_handle = self.client_library.fb_get_database_handle
         self.fb_get_database_handle.restype = ISC_STATUS
         self.fb_get_database_handle.argtypes = [ISC_STATUS_PTR, FB_API_HANDLE_PTR, IAttachment]
-        #
+        #: Firebird API
         self.fb_get_transaction_handle = (self.client_library.fb_get_transaction_handle)
         self.fb_get_transaction_handle.restype = ISC_STATUS
         self.fb_get_transaction_handle.argtypes = [ISC_STATUS_PTR, FB_API_HANDLE_PTR, ITransaction]
-        #
+        #: Firebird API
         self.fb_sqlstate = self.client_library.fb_sqlstate
         self.fb_sqlstate.restype = None
         self.fb_sqlstate.argtypes = [STRING, ISC_STATUS_PTR]
-        #
+        #: Firebird API
         self.fb_shutdown_callback = self.client_library.fb_shutdown_callback
         self.fb_shutdown_callback.restype = ISC_STATUS
         self.fb_shutdown_callback.argtypes = [ISC_STATUS_PTR,
                                               FB_SHUTDOWN_CALLBACK,
                                               c_int,
                                               c_void_p]
-        #
+        #: Firebird API
         self.isc_sqlcode = self.client_library.isc_sqlcode
         self.isc_sqlcode.restype = ISC_LONG
         self.isc_sqlcode.argtypes = [ISC_STATUS_PTR]
-        #
+        #: Firebird API
         self.fb_interpret = self.client_library.fb_interpret
         self.fb_interpret.restype = ISC_LONG
         self.fb_interpret.argtypes = [STRING, c_uint, POINTER(ISC_STATUS_PTR)]
-        #
+        #: Firebird API
         self.isc_array_lookup_bounds = (self.client_library.isc_array_lookup_bounds)
         self.isc_array_lookup_bounds.restype = ISC_STATUS
         self.isc_array_lookup_bounds.argtypes = [ISC_STATUS_PTR, FB_API_HANDLE_PTR,
                                                  FB_API_HANDLE_PTR, STRING, STRING,
                                                  ISC_ARRAY_DESC_PTR]
-        #
+        #: Firebird API
         self.isc_array_put_slice = self.client_library.isc_array_put_slice
         self.isc_array_put_slice.restype = ISC_STATUS
         self.isc_array_put_slice.argtypes = [ISC_STATUS_PTR, FB_API_HANDLE_PTR,
                                              FB_API_HANDLE_PTR, ISC_QUAD_PTR,
                                              ISC_ARRAY_DESC_PTR, c_void_p, ISC_LONG_PTR]
-        #
+        #: Firebird API
         self.isc_array_get_slice = self.client_library.isc_array_get_slice
         self.isc_array_get_slice.restype = ISC_STATUS
         self.isc_array_get_slice.argtypes = [ISC_STATUS_PTR, FB_API_HANDLE_PTR,
                                              FB_API_HANDLE_PTR, ISC_QUAD_PTR,
                                              ISC_ARRAY_DESC_PTR, c_void_p, ISC_LONG_PTR]
         #
         self.P_isc_event_block = CFUNCTYPE(ISC_LONG, POINTER(POINTER(ISC_UCHAR)),
                                            POINTER(POINTER(ISC_UCHAR)), ISC_USHORT)
         # C_isc_event_block(ISC_LONG, POINTER(POINTER(ISC_UCHAR)), POINTER(POINTER(ISC_UCHAR)), ISC_USHORT)
         self.C_isc_event_block = self.P_isc_event_block(('isc_event_block', self.client_library))
         self.P_isc_event_block_args = self.C_isc_event_block.argtypes
-        #
+        #: Firebird API
         self.isc_que_events = self.client_library.isc_que_events
         self.isc_que_events.restype = ISC_STATUS
         self.isc_que_events.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
                                         POINTER(ISC_LONG), c_short, POINTER(ISC_UCHAR),
                                         ISC_EVENT_CALLBACK, POINTER(ISC_UCHAR)]
-        #
+        #: Firebird API
         self.isc_event_counts = self.client_library.isc_event_counts
         self.isc_event_counts.restype = None
         self.isc_event_counts.argtypes = [POINTER(RESULT_VECTOR), c_short,
                                           POINTER(ISC_UCHAR), POINTER(ISC_UCHAR)]
-        #
+        #: Firebird API
         self.isc_cancel_events = self.client_library.isc_cancel_events
         self.isc_cancel_events.restype = ISC_STATUS
         self.isc_cancel_events.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
                                            POINTER(ISC_LONG)]
+        #: Firebird API
+        self.isc_compile_request = self.client_library.isc_compile_request
+        self.isc_compile_request.restype = ISC_STATUS
+        self.isc_compile_request.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                             POINTER(FB_API_HANDLE), c_short, STRING]
+        #: Firebird API
+        self.isc_start_request = self.client_library.isc_start_request
+        self.isc_start_request.restype = ISC_STATUS
+        self.isc_start_request.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                           POINTER(FB_API_HANDLE), c_short]
+        #: Firebird API
+        self.isc_release_request = self.client_library.isc_release_request
+        self.isc_release_request.restype = ISC_STATUS
+        self.isc_release_request.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE)]
+        #: Firebird API
+        self.isc_receive = self.client_library.isc_receive
+        self.isc_receive.restype = ISC_STATUS
+        self.isc_receive.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                     c_short, c_short, c_void_p, c_short]
+        #: Firebird API
+        self.isc_start_and_send = self.client_library.isc_start_and_send
+        self.isc_start_and_send.restype = ISC_STATUS
+        self.isc_start_and_send.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                            POINTER(FB_API_HANDLE), c_short, c_short,
+                                            c_void_p, c_short]
+        #: Firebird API
+        self.isc_send = self.client_library.isc_send
+        self.isc_send.restype = ISC_STATUS
+        self.isc_send.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                  c_short, c_short, c_void_p, c_short]
+        #: Firebird API
+        self.isc_open_blob2 = self.client_library.isc_open_blob2
+        self.isc_open_blob2.restype = ISC_STATUS
+        self.isc_open_blob2.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                        POINTER(FB_API_HANDLE), POINTER(FB_API_HANDLE),
+                                        POINTER(ISC_QUAD), ISC_USHORT, STRING] # POINTER(ISC_UCHAR)
+        #: Firebird API
+        self.isc_blob_info = self.client_library.isc_blob_info
+        self.isc_blob_info.restype = ISC_STATUS
+        self.isc_blob_info.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                       c_short, STRING, c_short, POINTER(c_char)]
+        #: Firebird API
+        self.isc_create_blob2 = self.client_library.isc_create_blob2
+        self.isc_create_blob2.restype = ISC_STATUS
+        self.isc_create_blob2.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                          POINTER(FB_API_HANDLE), POINTER(FB_API_HANDLE),
+                                          POINTER(ISC_QUAD), c_short, STRING]
+        #: Firebird API
+        self.isc_get_segment = self.client_library.isc_get_segment
+        self.isc_get_segment.restype = ISC_STATUS
+        self.isc_get_segment.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                         POINTER(c_ushort), c_ushort, c_void_p]
+        #: Firebird API
+        self.isc_put_segment = self.client_library.isc_put_segment
+        self.isc_put_segment.restype = ISC_STATUS
+        self.isc_put_segment.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE),
+                                         c_ushort, c_void_p]
+        #: Firebird API
+        self.isc_close_blob = self.client_library.isc_close_blob
+        self.isc_close_blob.restype = ISC_STATUS
+        self.isc_close_blob.argtypes = [POINTER(ISC_STATUS), POINTER(FB_API_HANDLE)]
         # Next netributes are set in types by API_LOADED hook
         self.master = None
         self.util = None
 
     def isc_event_block(self, event_buffer: bytes, result_buffer: bytes, *args) -> int:
         """Convenience wrapper for isc_event_block() API function. Injects variable
         number of parameters into `C_isc_event_block` call.
```

### Comparing `firebird-driver-1.8.0/src/firebird/driver/hooks.py` & `firebird-driver-1.9.0/src/firebird/driver/hooks.py`

 * *Files identical despite different names*

### Comparing `firebird-driver-1.8.0/src/firebird/driver/interfaces.py` & `firebird-driver-1.9.0/src/firebird/driver/interfaces.py`

 * *Files 1% similar despite different names*

```diff
@@ -711,24 +711,33 @@
         """Important:
              This item is for ISC API emulation only. It may be gone in future versions.
              Please do not use it!
         """
         self.vtable.setDelayedOutputFormat(self, self.status, fmt)
         self._check()
 
-# IResultSet(3) : ReferenceCounted
-class iResultSet(iResultSet_v3):
+# IResultSet(4) : ReferenceCounted
+class iResultSet_v4(iResultSet_v3):
     "Class that wraps IResultSet interface for use from Python"
     VERSION = 4
     def close(self) -> None:
         "Close result set, releases interface on success"
         self.vtable.close(self, self.status)
         self._check()
         self._refcnt -= 1
 
+# IResultSet(5) : ReferenceCounted
+class iResultSet(iResultSet_v3):
+    "Class that wraps IResultSet interface for use from Python"
+    VERSION = 5
+    def get_info(self, items: bytes, buffer: bytes) -> None:
+        "Returns information about result set."
+        self.vtable.getInfo(self, self.status, len(items), items, len(buffer), buffer)
+        self._check()
+
 # IStatement(3) : ReferenceCounted
 class iStatement_v3(iReferenceCounted):
     "Class that wraps IStatement v3 interface for use from Python"
     VERSION = 3
     def get_info(self, items: bytes, buffer: bytes) -> None:
         "Replaces `isc_dsql_sql_info()`"
         self.vtable.getInfo(self, self.status, len(items), items, len(buffer), buffer)
```

### Comparing `firebird-driver-1.8.0/src/firebird/driver/types.py` & `firebird-driver-1.9.0/src/firebird/driver/types.py`

 * *Files 2% similar despite different names*

```diff
@@ -339,14 +339,16 @@
     WIRE_CRYPT = 140
     FEATURES = 141
     NEXT_ATTACHMENT = 142
     NEXT_STATEMENT = 143
     DB_GUID = 144
     DB_FILE_ID = 145
     REPLICA_MODE = 146
+    USER_NAME = 147
+    SQL_ROLE = 148
 
 class Features(IntEnum):
     """Firebird features (Response to DbInfoCode.FEATURES).
     """
     MULTI_STATEMENTS = 1    # Multiple prepared statements in single attachment
     MULTI_TRANSACTIONS = 2  # Multiple concurrent transaction in single attachment
     NAMED_PARAMETERS = 3    # Query parameters can be named
@@ -390,14 +392,22 @@
     RELATION_ALIAS = 25
     EXPLAIN_PLAN = 26
     FLAGS = 27
     # Firebird 4
     TIMEOUT_USER = 28
     TIMEOUT_RUN = 29
     BLOB_ALIGN = 30
+    # Firebird 5
+    EXEC_PATH_BLR_BYTES = 31
+    EXEC_PATH_BLR_TEXT = 32
+
+class ResultSetInfoCode(IntEnum):
+    """Result set information codes.
+    """
+    RECORD_COUNT = 10
 
 class TraInfoCode(IntEnum):
     """Transaction information (isc_info_tra_*) codes.
     """
     ID = 4
     OLDEST_INTERESTING = 5
     OLDEST_SNAPSHOT = 6
@@ -578,14 +588,19 @@
     MAP_ATTACH = 90
     # Firebird 4
     SESSION_TIME_ZONE = 91
     SET_DB_REPLICA = 92
     SET_BIND = 93
     DECFLOAT_ROUND = 94
     DECFLOAT_TRAPS = 95
+    CLEAR_MAP = 96
+    # Firebird 5
+    UPGRADE_DB = 97
+    PARALLEL_WORKERS = 100
+    WORKER_ATTACH = 101
 
 class TPBItem(IntEnum):
     """isc_tpb_* items.
     """
     VERSION3 = 3
     IGNORE_LIMBO = 14
     AUTOCOMMIT = 16
@@ -695,28 +710,30 @@
     TRA_ADVISE_UNKNOWN = 33
     TRA_ID_64 = 46
     SINGLE_TRA_ID_64 = 47
     MULTI_TRA_ID_64 = 48
     COMMIT_TRANS_64 = 49
     ROLLBACK_TRANS_64 = 50
     RECOVER_TWO_PHASE_64 = 51
+    PARALLEL_WORKERS = 52 # Firebird 5
 
 class SrvBackupOption(IntEnum):
     """Parameters for ServerAction.BACKUP.
     """
     FILE = 5
     FACTOR = 6
     LENGTH = 7
     SKIP_DATA = 8
     STAT = 15
     # Firebird 4
     KEYHOLDER = 16
     KEYNAME = 17
     CRYPT = 18
     INCLUDE_DATA = 19
+    PARALLEL_WORKERS = 21 # Firebird 5
 
 class SrvRestoreOption(IntEnum):
     """Parameters for ServerAction.RESTORE.
     """
     FILE = 5
     SKIP_DATA = 8
     BUFFERS = 9
@@ -728,23 +745,27 @@
     STAT = 15
     # Firebird 4
     KEYHOLDER = 16
     KEYNAME = 17
     CRYPT = 18
     INCLUDE_DATA = 19
     REPLICA_MODE = 20
+    PARALLEL_WORKERS = 21 # Firebird 5
 
 class SrvNBackupOption(IntEnum):
     """Parameters for ServerAction.NBAK.
     """
     LEVEL = 5
     FILE = 6
     DIRECT = 7
-    # Firebird 4
-    GUID = 8
+    GUID = 8 # Firebird 4
+    # Firebird 5
+    CLEAN_HISTORY = 9
+    KEEP_DAYS = 10
+    KEEP_ROWS = 11
 
 class SrvTraceOption(IntEnum):
     """Parameters for ServerAction.TRACE_*.
     """
     ID = 1
     NAME = 2
     CONFIG = 3
@@ -933,14 +954,18 @@
     LINUX_HPPA = 82
     LINUX_ALPHA = 83
     LINUX_ARM64 = 84
     LINUX_PPC64EL = 85
     LINUX_PPC64 = 86
     LINUX_M68K = 87
     LINUX_RISCV64 = 88
+    FREEBSD_PPC64EL = 89
+    LINUX_MIPS64EL = 90
+    FREEBSD_PPC64 = 91
+    FREEBSD_PPC = 92
 
 class ImpCPU(IntEnum):
     """Implementation - CPU.
     """
     INTEL386 = 0
     AMD_INTEL_X64 = 1
     ULTRA_SPARC = 2
@@ -1085,14 +1110,15 @@
     MEND_DB = 0x04
     LIST_LIMBO_TRANS = 0x08
     CHECK_DB = 0x10
     IGNORE_CHECKSUM = 0x20
     KILL_SHADOWS = 0x40
     FULL = 0x80
     ICU = 0x0800
+    UPGRADE_DB = 0x1000 # Firebird 5
     #
     CORRUPTION_CHECK = VALIDATE_DB | CHECK_DB | FULL | IGNORE_CHECKSUM
     REPAIR = MEND_DB | FULL | IGNORE_CHECKSUM
 
 class SrvStatFlag(IntFlag):
     """isc_spb_sts_* flags for ServerAction.DB_STATS.
     """
@@ -1117,27 +1143,29 @@
     NO_GARBAGE_COLLECT = 0x08
     OLD_DESCRIPTIONS = 0x10
     NON_TRANSPORTABLE = 0x20
     CONVERT = 0x40
     EXPAND = 0x80
     NO_TRIGGERS = 0x8000
     ZIP = 0x010000 # Firebird 4
+    DIRECT_IO = 0x020000 # Firebird 5
 
 class SrvRestoreFlag(IntFlag):
     """isc_spb_res_* flags for ServerAction.RESTORE.
     """
     METADATA_ONLY = 0x04
     DEACTIVATE_IDX = 0x0100
     NO_SHADOW = 0x0200
     NO_VALIDITY = 0x0400
     ONE_AT_A_TIME = 0x0800
     REPLACE = 0x1000
     CREATE = 0x2000
     USE_ALL_SPACE = 0x4000
     NO_TRIGGERS = 0x8000
+    DIRECT_IO = 0x020000 # Firebird 5
 
 class SrvNBackupFlag(IntFlag):
     """isc_spb_nbk_* flags for ServerAction.NBAK.
     """
     NONE = 0
     NO_TRIGGERS = 0x01
     # Firebird 4
```

### Comparing `firebird-driver-1.8.0/src/firebird_driver.egg-info/PKG-INFO` & `firebird-driver-1.9.0/src/firebird_driver.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: firebird-driver
-Version: 1.8.0
+Version: 1.9.0
 Summary: Firebird driver for Python
 Author-email: Pavel Cisar <pcisar@users.sourceforge.net>
 License: MIT License
         
         Copyright (c) 2020 FirebirdSQL
         
         Permission is hereby granted, free of charge, to any person obtaining a copy
@@ -22,16 +22,16 @@
         FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
         AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
         LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
         OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
         SOFTWARE.
         
 Project-URL: Home, https://github.com/FirebirdSQL/python3-driver
-Project-URL: Documentation, https://firebird-base.rtfd.io
-Project-URL: Bug Reports, https://github.com/FirebirdSQL/python3-base/issues
+Project-URL: Documentation, https://firebird-driver.rtfd.io
+Project-URL: Bug Reports, https://github.com/FirebirdSQL/python3-driver/issues
 Project-URL: Funding, https://www.firebirdsql.org/en/donate/
 Project-URL: Source, https://github.com/FirebirdSQL/python3-driver
 Keywords: Firebird,RDBMS,driver
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3 :: Only
```

### Comparing `firebird-driver-1.8.0/src/firebird_driver.egg-info/SOURCES.txt` & `firebird-driver-1.9.0/src/firebird_driver.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `firebird-driver-1.8.0/test/test_driver.py` & `firebird-driver-1.9.0/test/test_driver.py`

 * *Files 0% similar despite different names*

```diff
@@ -73,8371 +73,8489 @@
 00000480: 0a69 6d70 6f72 7420 7469 6d65 0a69 6d70  .import time.imp
 00000490: 6f72 7420 6465 6369 6d61 6c0a 6672 6f6d  ort decimal.from
 000004a0: 2072 6520 696d 706f 7274 2066 696e 6469   re import findi
 000004b0: 7465 720a 0a66 726f 6d20 696f 2069 6d70  ter..from io imp
 000004c0: 6f72 7420 5374 7269 6e67 494f 2c20 4279  ort StringIO, By
 000004d0: 7465 7349 4f0a 0a46 4233 3020 3d20 2733  tesIO..FB30 = '3
 000004e0: 2e30 270a 4642 3430 203d 2027 342e 3027  .0'.FB40 = '4.0'
-000004f0: 0a0a 2320 4465 6661 756c 7420 7365 7276  ..# Default serv
-00000500: 6572 2068 6f73 740a 2346 4254 4553 545f  er host.#FBTEST_
-00000510: 484f 5354 203d 2027 270a 4642 5445 5354  HOST = ''.FBTEST
-00000520: 5f48 4f53 5420 3d20 276c 6f63 616c 686f  _HOST = 'localho
-00000530: 7374 270a 2320 4465 6661 756c 7420 7573  st'.# Default us
-00000540: 6572 0a46 4254 4553 545f 5553 4552 203d  er.FBTEST_USER =
-00000550: 2027 5359 5344 4241 270a 2320 4465 6661   'SYSDBA'.# Defa
-00000560: 756c 7420 7573 6572 2070 6173 7377 6f72  ult user passwor
-00000570: 640a 4642 5445 5354 5f50 4153 5357 4f52  d.FBTEST_PASSWOR
-00000580: 4420 3d20 276d 6173 7465 726b 6579 270a  D = 'masterkey'.
-00000590: 0a63 6667 203d 2064 7269 7665 725f 636f  .cfg = driver_co
-000005a0: 6e66 6967 2e72 6567 6973 7465 725f 7365  nfig.register_se
-000005b0: 7276 6572 2827 4642 5445 5354 5f48 4f53  rver('FBTEST_HOS
-000005c0: 5427 290a 6366 672e 686f 7374 2e76 616c  T').cfg.host.val
-000005d0: 7565 203d 2046 4254 4553 545f 484f 5354  ue = FBTEST_HOST
-000005e0: 0a63 6667 2e75 7365 722e 7661 6c75 6520  .cfg.user.value 
-000005f0: 3d20 4642 5445 5354 5f55 5345 520a 6366  = FBTEST_USER.cf
-00000600: 672e 7061 7373 776f 7264 2e76 616c 7565  g.password.value
-00000610: 203d 2046 4254 4553 545f 5041 5353 574f   = FBTEST_PASSWO
-00000620: 5244 0a0a 7472 6163 6520 3d20 4661 6c73  RD..trace = Fals
-00000630: 650a 0a69 6620 6e6f 7420 7379 732e 7761  e..if not sys.wa
-00000640: 726e 6f70 7469 6f6e 733a 0a20 2020 2069  rnoptions:.    i
-00000650: 6d70 6f72 7420 7761 726e 696e 6773 0a20  mport warnings. 
-00000660: 2020 2077 6172 6e69 6e67 732e 7369 6d70     warnings.simp
-00000670: 6c65 6669 6c74 6572 2822 616c 7761 7973  lefilter("always
-00000680: 2229 2023 2043 6861 6e67 6520 7468 6520  ") # Change the 
-00000690: 6669 6c74 6572 2069 6e20 7468 6973 2070  filter in this p
-000006a0: 726f 6365 7373 0a20 2020 2023 6f73 2e65  rocess.    #os.e
-000006b0: 6e76 6972 6f6e 5b22 5059 5448 4f4e 5741  nviron["PYTHONWA
-000006c0: 524e 494e 4753 225d 203d 2022 6465 6661  RNINGS"] = "defa
-000006d0: 756c 7422 2023 2041 6c73 6f20 6166 6665  ult" # Also affe
-000006e0: 6374 2073 7562 7072 6f63 6573 7365 730a  ct subprocesses.
-000006f0: 0a64 6566 206f 735f 656e 7669 726f 6e5f  .def os_environ_
-00000700: 6765 745f 6d6f 636b 286b 6579 2c20 6465  get_mock(key, de
-00000710: 6661 756c 7429 3a0a 2020 2020 7265 7475  fault):.    retu
-00000720: 726e 2066 274d 4f43 4b5f 7b6b 6579 7d27  rn f'MOCK_{key}'
-00000730: 0a0a 6465 6620 6c69 6e65 7370 6c69 745f  ..def linesplit_
-00000740: 6974 6572 2873 7472 696e 6729 3a0a 2020  iter(string):.  
-00000750: 2020 7265 7475 726e 2028 6d2e 6772 6f75    return (m.grou
-00000760: 7028 3229 2066 6f72 206d 2069 6e20 6669  p(2) for m in fi
-00000770: 6e64 6974 6572 2827 2828 2e2a 295c 6e7c  nditer('((.*)\n|
-00000780: 282e 2b29 2429 272c 2073 7472 696e 6729  (.+)$)', string)
-00000790: 290a 0a64 6566 2069 7465 725f 636c 6173  )..def iter_clas
-000007a0: 735f 7072 6f70 6572 7469 6573 2863 6c73  s_properties(cls
-000007b0: 293a 0a20 2020 2022 2222 4974 6572 6174  ):.    """Iterat
-000007c0: 6f72 2066 756e 6374 696f 6e2e 0a0a 2020  or function...  
-000007d0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-000007e0: 636c 7320 2863 6c61 7373 293a 2043 6c61  cls (class): Cla
-000007f0: 7373 206f 626a 6563 742e 0a0a 2020 2020  ss object...    
-00000800: 5969 656c 6473 3a0a 2020 2020 2020 2020  Yields:.        
-00000810: 606e 616d 6527 2c20 2770 726f 7065 7274  `name', 'propert
-00000820: 7960 2070 6169 7273 2066 6f72 2061 6c6c  y` pairs for all
-00000830: 2070 726f 7065 7274 6965 7320 696e 2063   properties in c
-00000840: 6c61 7373 2e0a 2222 220a 2020 2020 666f  lass..""".    fo
-00000850: 7220 7661 726e 616d 6520 696e 2076 6172  r varname in var
-00000860: 7328 636c 7329 3a0a 2020 2020 2020 2020  s(cls):.        
-00000870: 7661 6c75 6520 3d20 6765 7461 7474 7228  value = getattr(
-00000880: 636c 732c 2076 6172 6e61 6d65 290a 2020  cls, varname).  
-00000890: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-000008a0: 6e63 6528 7661 6c75 652c 2070 726f 7065  nce(value, prope
-000008b0: 7274 7929 3a0a 2020 2020 2020 2020 2020  rty):.          
-000008c0: 2020 7969 656c 6420 7661 726e 616d 652c    yield varname,
-000008d0: 2076 616c 7565 0a0a 6465 6620 6974 6572   value..def iter
-000008e0: 5f63 6c61 7373 5f76 6172 6961 626c 6573  _class_variables
-000008f0: 2863 6c73 293a 0a20 2020 2022 2222 4974  (cls):.    """It
-00000900: 6572 6174 6f72 2066 756e 6374 696f 6e2e  erator function.
-00000910: 0a0a 2020 2020 4172 6773 3a0a 2020 2020  ..    Args:.    
-00000920: 2020 2020 636c 7320 2863 6c61 7373 293a      cls (class):
-00000930: 2043 6c61 7373 206f 626a 6563 742e 0a0a   Class object...
-00000940: 2020 2020 5969 656c 6473 3a0a 2020 2020      Yields:.    
-00000950: 2020 2020 4e61 6d65 7320 6f66 2061 6c6c      Names of all
-00000960: 206e 6f6e 2d63 616c 6c61 626c 6520 6174   non-callable at
-00000970: 7472 6962 7574 6573 2069 6e20 636c 6173  tributes in clas
-00000980: 732e 0a22 2222 0a20 2020 2066 6f72 2076  s..""".    for v
-00000990: 6172 6e61 6d65 2069 6e20 7661 7273 2863  arname in vars(c
-000009a0: 6c73 293a 0a20 2020 2020 2020 2076 616c  ls):.        val
-000009b0: 7565 203d 2067 6574 6174 7472 2863 6c73  ue = getattr(cls
-000009c0: 2c20 7661 726e 616d 6529 0a20 2020 2020  , varname).     
-000009d0: 2020 2069 6620 6e6f 7420 2869 7369 6e73     if not (isins
-000009e0: 7461 6e63 6528 7661 6c75 652c 2070 726f  tance(value, pro
-000009f0: 7065 7274 7929 206f 7220 6361 6c6c 6162  perty) or callab
-00000a00: 6c65 2876 616c 7565 2929 2061 6e64 206e  le(value)) and n
-00000a10: 6f74 2076 6172 6e61 6d65 2e73 7461 7274  ot varname.start
-00000a20: 7377 6974 6828 275f 2729 3a0a 2020 2020  swith('_'):.    
-00000a30: 2020 2020 2020 2020 7969 656c 6420 7661          yield va
-00000a40: 726e 616d 650a 0a0a 636c 6173 7320 4472  rname...class Dr
-00000a50: 6976 6572 5465 7374 4261 7365 2875 6e69  iverTestBase(uni
-00000a60: 7474 6573 742e 5465 7374 4361 7365 2c20  ttest.TestCase, 
-00000a70: 4c6f 6767 696e 6749 644d 6978 696e 293a  LoggingIdMixin):
-00000a80: 0a20 2020 2064 6566 2073 6574 5570 2873  .    def setUp(s
-00000a90: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00000aa0: 2020 2020 2020 7375 7065 7228 292e 7365        super().se
-00000ab0: 7455 7028 290a 2020 2020 2020 2020 7365  tUp().        se
-00000ac0: 6c66 2e6f 7574 7075 7420 3d20 5374 7269  lf.output = Stri
-00000ad0: 6e67 494f 2829 0a20 2020 2020 2020 2069  ngIO().        i
-00000ae0: 6e73 7461 6c6c 5f6e 756c 6c5f 6c6f 6767  nstall_null_logg
-00000af0: 6572 2829 0a20 2020 2020 2020 2069 6620  er().        if 
-00000b00: 7472 6163 6520 6f72 206f 732e 6765 7465  trace or os.gete
-00000b10: 6e76 2827 4452 4956 4552 5f54 5241 4345  nv('DRIVER_TRACE
-00000b20: 2729 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ') is not None:.
-00000b30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00000b40: 2e6d 6e67 7220 3d20 6c6f 6767 696e 675f  .mngr = logging_
-00000b50: 6d61 6e61 6765 720a 2020 2020 2020 2020  manager.        
-00000b60: 2020 2020 2373 656c 662e 6d6e 6772 2e74      #self.mngr.t
-00000b70: 7261 6365 207c 3d20 5472 6163 6546 6c61  race |= TraceFla
-00000b80: 672e 4245 464f 5245 0a20 2020 2020 2020  g.BEFORE.       
-00000b90: 2020 2020 2023 7365 6c66 2e6d 6e67 722e       #self.mngr.
-00000ba0: 7472 6163 6520 7c3d 2054 7261 6365 466c  trace |= TraceFl
-00000bb0: 6167 2e41 4654 4552 0a20 2020 2020 2020  ag.AFTER.       
-00000bc0: 2020 2020 2073 656c 662e 6d6e 6772 2e62       self.mngr.b
-00000bd0: 696e 645f 6c6f 6767 6572 2841 4e59 2c20  ind_logger(ANY, 
-00000be0: 414e 592c 2027 272c 2027 7472 6163 6527  ANY, '', 'trace'
-00000bf0: 290a 2020 2020 2020 2020 2020 2020 7368  ).            sh
-00000c00: 203d 2053 7472 6561 6d48 616e 646c 6572   = StreamHandler
-00000c10: 2873 7973 2e73 7464 6f75 7429 0a20 2020  (sys.stdout).   
-00000c20: 2020 2020 2020 2020 2073 682e 7365 7446           sh.setF
-00000c30: 6f72 6d61 7474 6572 2846 6f72 6d61 7474  ormatter(Formatt
-00000c40: 6572 2827 5b25 2863 6f6e 7465 7874 2973  er('[%(context)s
-00000c50: 5d20 2528 6167 656e 7429 733a 2025 286d  ] %(agent)s: %(m
-00000c60: 6573 7361 6765 2973 2729 290a 2020 2020  essage)s')).    
-00000c70: 2020 2020 2020 2020 6c6f 6767 6572 203d          logger =
-00000c80: 2067 6574 4c6f 6767 6572 2829 0a20 2020   getLogger().   
-00000c90: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-00000ca0: 7365 744c 6576 656c 2844 4542 5547 290a  setLevel(DEBUG).
-00000cb0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-00000cc0: 6572 2e61 6464 4861 6e64 6c65 7228 7368  er.addHandler(sh
-00000cd0: 290a 2020 2020 2020 2020 230a 2020 2020  ).        #.    
-00000ce0: 2020 2020 7769 7468 2063 6f6e 6e65 6374      with connect
-00000cf0: 5f73 6572 7665 7228 4642 5445 5354 5f48  _server(FBTEST_H
-00000d00: 4f53 542c 2075 7365 723d 4642 5445 5354  OST, user=FBTEST
-00000d10: 5f55 5345 522c 2070 6173 7377 6f72 643d  _USER, password=
-00000d20: 4642 5445 5354 5f50 4153 5357 4f52 4429  FBTEST_PASSWORD)
-00000d30: 2061 7320 7376 633a 0a20 2020 2020 2020   as svc:.       
-00000d40: 2020 2020 2073 656c 662e 7665 7273 696f       self.versio
-00000d50: 6e20 3d20 7376 632e 696e 666f 2e76 6572  n = svc.info.ver
-00000d60: 7369 6f6e 0a20 2020 2020 2020 2069 6620  sion.        if 
-00000d70: 7365 6c66 2e76 6572 7369 6f6e 2e73 7461  self.version.sta
-00000d80: 7274 7377 6974 6828 4642 3330 293a 0a20  rtswith(FB30):. 
-00000d90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00000da0: 4642 5445 5354 5f44 4220 3d20 2766 6274  FBTEST_DB = 'fbt
-00000db0: 6573 7433 302e 6664 6227 0a20 2020 2020  est30.fdb'.     
-00000dc0: 2020 2020 2020 2073 656c 662e 7665 7273         self.vers
-00000dd0: 696f 6e20 3d20 4642 3330 0a20 2020 2020  ion = FB30.     
-00000de0: 2020 2065 6c69 6620 7365 6c66 2e76 6572     elif self.ver
-00000df0: 7369 6f6e 2e73 7461 7274 7377 6974 6828  sion.startswith(
-00000e00: 4642 3430 293a 0a20 2020 2020 2020 2020  FB40):.         
-00000e10: 2020 2073 656c 662e 4642 5445 5354 5f44     self.FBTEST_D
-00000e20: 4220 3d20 2766 6274 6573 7434 302e 6664  B = 'fbtest40.fd
-00000e30: 6227 0a20 2020 2020 2020 2020 2020 2073  b'.            s
-00000e40: 656c 662e 7665 7273 696f 6e20 3d20 4642  elf.version = FB
-00000e50: 3430 0a20 2020 2020 2020 2065 6c73 653a  40.        else:
-00000e60: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00000e70: 7365 2045 7863 6570 7469 6f6e 2822 556e  se Exception("Un
-00000e80: 7375 7070 6f72 7465 6420 4669 7265 6269  supported Firebi
-00000e90: 7264 2076 6572 7369 6f6e 2028 2573 2922  rd version (%s)"
-00000ea0: 2025 2073 656c 662e 7665 7273 696f 6e29   % self.version)
-00000eb0: 0a20 2020 2020 2020 2023 0a20 2020 2020  .        #.     
-00000ec0: 2020 2073 656c 662e 6377 6420 3d20 6f73     self.cwd = os
-00000ed0: 2e67 6574 6377 6428 290a 2020 2020 2020  .getcwd().      
-00000ee0: 2020 7365 6c66 2e64 6270 6174 6820 3d20    self.dbpath = 
-00000ef0: 7365 6c66 2e63 7764 2069 6620 6f73 2e70  self.cwd if os.p
-00000f00: 6174 682e 7370 6c69 7428 7365 6c66 2e63  ath.split(self.c
-00000f10: 7764 295b 315d 203d 3d20 2774 6573 7427  wd)[1] == 'test'
-00000f20: 205c 0a20 2020 2020 2020 2020 2020 2065   \.            e
-00000f30: 6c73 6520 6f73 2e70 6174 682e 6a6f 696e  lse os.path.join
-00000f40: 2873 656c 662e 6377 642c 2027 7465 7374  (self.cwd, 'test
-00000f50: 2729 0a20 2020 2064 6566 2063 6c65 6172  ').    def clear
-00000f60: 5f6f 7574 7075 7428 7365 6c66 2920 2d3e  _output(self) ->
-00000f70: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
-00000f80: 656c 662e 6f75 7470 7574 2e63 6c6f 7365  elf.output.close
-00000f90: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-00000fa0: 6f75 7470 7574 203d 2053 7472 696e 6749  output = StringI
-00000fb0: 4f28 290a 2020 2020 6465 6620 7368 6f77  O().    def show
-00000fc0: 5f6f 7574 7075 7428 7365 6c66 2920 2d3e  _output(self) ->
-00000fd0: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
-00000fe0: 7973 2e73 7464 6f75 742e 7772 6974 6528  ys.stdout.write(
-00000ff0: 7365 6c66 2e6f 7574 7075 742e 6765 7476  self.output.getv
-00001000: 616c 7565 2829 290a 2020 2020 2020 2020  alue()).        
-00001010: 7379 732e 7374 646f 7574 2e66 6c75 7368  sys.stdout.flush
-00001020: 2829 0a20 2020 2064 6566 2070 7269 6e74  ().    def print
-00001030: 6f75 7428 7365 6c66 2c20 7465 7874 3a20  out(self, text: 
-00001040: 7374 7220 3d20 2727 2c20 6e65 776c 696e  str = '', newlin
-00001050: 653a 2062 6f6f 6c20 3d20 5472 7565 2c20  e: bool = True, 
-00001060: 6e6f 5f72 7374 7269 703a 2062 6f6f 6c20  no_rstrip: bool 
-00001070: 3d20 4661 6c73 6529 202d 3e20 4e6f 6e65  = False) -> None
-00001080: 3a0a 2020 2020 2020 2020 6966 206e 6f5f  :.        if no_
-00001090: 7273 7472 6970 3a0a 2020 2020 2020 2020  rstrip:.        
-000010a0: 2020 2020 7365 6c66 2e6f 7574 7075 742e      self.output.
-000010b0: 7772 6974 6528 7465 7874 290a 2020 2020  write(text).    
-000010c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000010d0: 2020 2020 2020 7365 6c66 2e6f 7574 7075        self.outpu
-000010e0: 742e 7772 6974 6528 7465 7874 2e72 7374  t.write(text.rst
-000010f0: 7269 7028 2929 0a20 2020 2020 2020 2069  rip()).        i
-00001100: 6620 6e65 776c 696e 653a 0a20 2020 2020  f newline:.     
-00001110: 2020 2020 2020 2073 656c 662e 6f75 7470         self.outp
-00001120: 7574 2e77 7269 7465 2827 5c6e 2729 0a20  ut.write('\n'). 
-00001130: 2020 2020 2020 2073 656c 662e 6f75 7470         self.outp
-00001140: 7574 2e66 6c75 7368 2829 0a20 2020 2064  ut.flush().    d
-00001150: 6566 2070 7269 6e74 4461 7461 2873 656c  ef printData(sel
-00001160: 662c 2063 7572 2c20 7072 696e 745f 6865  f, cur, print_he
-00001170: 6164 6572 3d54 7275 6529 3a0a 2020 2020  ader=True):.    
-00001180: 2020 2020 2222 2250 7269 6e74 2064 6174      """Print dat
-00001190: 6120 6672 6f6d 206f 7065 6e20 6375 7273  a from open curs
-000011a0: 6f72 2074 6f20 7374 646f 7574 2e22 2222  or to stdout."""
-000011b0: 0a20 2020 2020 2020 2069 6620 7072 696e  .        if prin
-000011c0: 745f 6865 6164 6572 3a0a 2020 2020 2020  t_header:.      
-000011d0: 2020 2020 2020 2320 5072 696e 7420 6120        # Print a 
-000011e0: 6865 6164 6572 2e0a 2020 2020 2020 2020  header..        
-000011f0: 2020 2020 6c69 6e65 203d 205b 5d0a 2020      line = [].  
-00001200: 2020 2020 2020 2020 2020 666f 7220 6669            for fi
-00001210: 656c 6444 6573 6320 696e 2063 7572 2e64  eldDesc in cur.d
-00001220: 6573 6372 6970 7469 6f6e 3a0a 2020 2020  escription:.    
-00001230: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00001240: 2e61 7070 656e 6428 6669 656c 6444 6573  .append(fieldDes
-00001250: 635b 4445 5343 5249 5054 494f 4e5f 4e41  c[DESCRIPTION_NA
-00001260: 4d45 5d2e 6c6a 7573 7428 6669 656c 6444  ME].ljust(fieldD
-00001270: 6573 635b 4445 5343 5249 5054 494f 4e5f  esc[DESCRIPTION_
-00001280: 4449 5350 4c41 595f 5349 5a45 5d29 290a  DISPLAY_SIZE])).
-00001290: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000012a0: 2e70 7269 6e74 6f75 7428 2720 272e 6a6f  .printout(' '.jo
-000012b0: 696e 286c 696e 6529 290a 2020 2020 2020  in(line)).      
-000012c0: 2020 2020 2020 6c69 6e65 203d 205b 5d0a        line = [].
-000012d0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000012e0: 6669 656c 6444 6573 6320 696e 2063 7572  fieldDesc in cur
-000012f0: 2e64 6573 6372 6970 7469 6f6e 3a0a 2020  .description:.  
-00001300: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00001310: 6e65 2e61 7070 656e 6428 222d 2220 2a20  ne.append("-" * 
-00001320: 6d61 7828 286c 656e 2866 6965 6c64 4465  max((len(fieldDe
-00001330: 7363 5b44 4553 4352 4950 5449 4f4e 5f4e  sc[DESCRIPTION_N
-00001340: 414d 455d 292c 2066 6965 6c64 4465 7363  AME]), fieldDesc
-00001350: 5b44 4553 4352 4950 5449 4f4e 5f44 4953  [DESCRIPTION_DIS
-00001360: 504c 4159 5f53 495a 455d 2929 290a 2020  PLAY_SIZE]))).  
-00001370: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00001380: 7269 6e74 6f75 7428 2720 272e 6a6f 696e  rintout(' '.join
-00001390: 286c 696e 6529 290a 2020 2020 2020 2020  (line)).        
-000013a0: 2320 466f 7220 6561 6368 2072 6f77 2c20  # For each row, 
-000013b0: 7072 696e 7420 7468 6520 7661 6c75 6520  print the value 
-000013c0: 6f66 2065 6163 6820 6669 656c 6420 6c65  of each field le
-000013d0: 6674 2d6a 7573 7469 6669 6564 2077 6974  ft-justified wit
-000013e0: 6869 6e0a 2020 2020 2020 2020 2320 7468  hin.        # th
-000013f0: 6520 6d61 7869 6d75 6d20 706f 7373 6962  e maximum possib
-00001400: 6c65 2077 6964 7468 206f 6620 7468 6174  le width of that
-00001410: 2066 6965 6c64 2e0a 2020 2020 2020 2020   field..        
-00001420: 6669 656c 6449 6e64 6963 6573 203d 2072  fieldIndices = r
-00001430: 616e 6765 286c 656e 2863 7572 2e64 6573  ange(len(cur.des
-00001440: 6372 6970 7469 6f6e 2929 0a20 2020 2020  cription)).     
-00001450: 2020 2066 6f72 2072 6f77 2069 6e20 6375     for row in cu
-00001460: 723a 0a20 2020 2020 2020 2020 2020 206c  r:.            l
-00001470: 696e 6520 3d20 5b5d 0a20 2020 2020 2020  ine = [].       
-00001480: 2020 2020 2066 6f72 2066 6965 6c64 496e       for fieldIn
-00001490: 6465 7820 696e 2066 6965 6c64 496e 6469  dex in fieldIndi
-000014a0: 6365 733a 0a20 2020 2020 2020 2020 2020  ces:.           
-000014b0: 2020 2020 2066 6965 6c64 5661 6c75 6520       fieldValue 
-000014c0: 3d20 7374 7228 726f 775b 6669 656c 6449  = str(row[fieldI
-000014d0: 6e64 6578 5d29 0a20 2020 2020 2020 2020  ndex]).         
-000014e0: 2020 2020 2020 2066 6965 6c64 4d61 7857         fieldMaxW
-000014f0: 6964 7468 203d 206d 6178 2828 6c65 6e28  idth = max((len(
-00001500: 6375 722e 6465 7363 7269 7074 696f 6e5b  cur.description[
-00001510: 6669 656c 6449 6e64 6578 5d5b 4445 5343  fieldIndex][DESC
-00001520: 5249 5054 494f 4e5f 4e41 4d45 5d29 2c20  RIPTION_NAME]), 
-00001530: 6375 722e 6465 7363 7269 7074 696f 6e5b  cur.description[
-00001540: 6669 656c 6449 6e64 6578 5d5b 4445 5343  fieldIndex][DESC
-00001550: 5249 5054 494f 4e5f 4449 5350 4c41 595f  RIPTION_DISPLAY_
-00001560: 5349 5a45 5d29 290a 2020 2020 2020 2020  SIZE])).        
-00001570: 2020 2020 2020 2020 6c69 6e65 2e61 7070          line.app
-00001580: 656e 6428 6669 656c 6456 616c 7565 2e6c  end(fieldValue.l
-00001590: 6a75 7374 2866 6965 6c64 4d61 7857 6964  just(fieldMaxWid
-000015a0: 7468 2929 0a20 2020 2020 2020 2020 2020  th)).           
-000015b0: 2073 656c 662e 7072 696e 746f 7574 2827   self.printout('
-000015c0: 2027 2e6a 6f69 6e28 6c69 6e65 2929 0a0a   '.join(line))..
-000015d0: 636c 6173 7320 5465 7374 4372 6561 7465  class TestCreate
-000015e0: 4472 6f70 2844 7269 7665 7254 6573 7442  Drop(DriverTestB
-000015f0: 6173 6529 3a0a 2020 2020 6465 6620 7365  ase):.    def se
-00001600: 7455 7028 7365 6c66 293a 0a20 2020 2020  tUp(self):.     
-00001610: 2020 2073 7570 6572 2829 2e73 6574 5570     super().setUp
-00001620: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-00001630: 6462 6669 6c65 203d 206f 732e 7061 7468  dbfile = os.path
-00001640: 2e6a 6f69 6e28 7365 6c66 2e64 6270 6174  .join(self.dbpat
-00001650: 682c 2027 6472 6f70 7465 7374 2e66 6462  h, 'droptest.fdb
-00001660: 2729 0a20 2020 2020 2020 2069 6620 6f73  ').        if os
-00001670: 2e70 6174 682e 6578 6973 7473 2873 656c  .path.exists(sel
-00001680: 662e 6462 6669 6c65 293a 0a20 2020 2020  f.dbfile):.     
-00001690: 2020 2020 2020 206f 732e 7265 6d6f 7665         os.remove
-000016a0: 2873 656c 662e 6462 6669 6c65 290a 2020  (self.dbfile).  
-000016b0: 2020 6465 6620 7465 7374 5f63 7265 6174    def test_creat
-000016c0: 655f 6472 6f70 5f64 736e 2873 656c 6629  e_drop_dsn(self)
-000016d0: 3a0a 2020 2020 2020 2020 7769 7468 2063  :.        with c
-000016e0: 7265 6174 655f 6461 7461 6261 7365 2873  reate_database(s
-000016f0: 656c 662e 6462 6669 6c65 2c20 7573 6572  elf.dbfile, user
-00001700: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
-00001710: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
-00001720: 5353 574f 5244 2920 6173 2063 6f6e 3a0a  SSWORD) as con:.
-00001730: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00001740: 2e61 7373 6572 7445 7175 616c 2863 6f6e  .assertEqual(con
-00001750: 2e64 736e 2c20 7365 6c66 2e64 6266 696c  .dsn, self.dbfil
-00001760: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
-00001770: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00001780: 636f 6e2e 7371 6c5f 6469 616c 6563 742c  con.sql_dialect,
-00001790: 2033 290a 2020 2020 2020 2020 2020 2020   3).            
-000017a0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000017b0: 2863 6f6e 2e63 6861 7273 6574 2c20 4e6f  (con.charset, No
-000017c0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
-000017d0: 636f 6e2e 6472 6f70 5f64 6174 6162 6173  con.drop_databas
-000017e0: 6528 290a 2020 2020 2020 2020 2320 4f76  e().        # Ov
-000017f0: 6572 7772 6974 650a 2020 2020 2020 2020  erwrite.        
-00001800: 7769 7468 2063 7265 6174 655f 6461 7461  with create_data
-00001810: 6261 7365 2873 656c 662e 6462 6669 6c65  base(self.dbfile
-00001820: 2c20 7573 6572 3d46 4254 4553 545f 5553  , user=FBTEST_US
-00001830: 4552 2c20 7061 7373 776f 7264 3d46 4254  ER, password=FBT
-00001840: 4553 545f 5041 5353 574f 5244 2920 6173  EST_PASSWORD) as
-00001850: 2063 6f6e 3a0a 2020 2020 2020 2020 2020   con:.          
-00001860: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00001870: 616c 2863 6f6e 2e64 736e 2c20 7365 6c66  al(con.dsn, self
-00001880: 2e64 6266 696c 6529 0a20 2020 2020 2020  .dbfile).       
-00001890: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000018a0: 4571 7561 6c28 636f 6e2e 7371 6c5f 6469  Equal(con.sql_di
-000018b0: 616c 6563 742c 2033 290a 2020 2020 2020  alect, 3).      
-000018c0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000018d0: 7445 7175 616c 2863 6f6e 2e63 6861 7273  tEqual(con.chars
-000018e0: 6574 2c20 4e6f 6e65 290a 2020 2020 2020  et, None).      
-000018f0: 2020 7769 7468 2073 656c 662e 6173 7365    with self.asse
-00001900: 7274 5261 6973 6573 2844 6174 6162 6173  rtRaises(Databas
-00001910: 6545 7272 6f72 2920 6173 2063 6d3a 0a20  eError) as cm:. 
-00001920: 2020 2020 2020 2020 2020 2063 7265 6174             creat
-00001930: 655f 6461 7461 6261 7365 2873 656c 662e  e_database(self.
-00001940: 6462 6669 6c65 2c20 7573 6572 3d46 4254  dbfile, user=FBT
-00001950: 4553 545f 5553 4552 2c20 7061 7373 776f  EST_USER, passwo
-00001960: 7264 3d46 4254 4553 545f 5041 5353 574f  rd=FBTEST_PASSWO
-00001970: 5244 290a 2020 2020 2020 2020 7365 6c66  RD).        self
-00001980: 2e61 7373 6572 7454 7275 6528 2765 7869  .assertTrue('exi
-00001990: 7374 2720 696e 2063 6d2e 6578 6365 7074  st' in cm.except
-000019a0: 696f 6e2e 6172 6773 5b30 5d29 0a20 2020  ion.args[0]).   
-000019b0: 2020 2020 2077 6974 6820 6372 6561 7465       with create
-000019c0: 5f64 6174 6162 6173 6528 7365 6c66 2e64  _database(self.d
-000019d0: 6266 696c 652c 2075 7365 723d 4642 5445  bfile, user=FBTE
-000019e0: 5354 5f55 5345 522c 2070 6173 7377 6f72  ST_USER, passwor
-000019f0: 643d 4642 5445 5354 5f50 4153 5357 4f52  d=FBTEST_PASSWOR
-00001a00: 442c 206f 7665 7277 7269 7465 3d54 7275  D, overwrite=Tru
-00001a10: 6529 2061 7320 636f 6e3a 0a20 2020 2020  e) as con:.     
-00001a20: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00001a30: 7274 4571 7561 6c28 636f 6e2e 6473 6e2c  rtEqual(con.dsn,
-00001a40: 2073 656c 662e 6462 6669 6c65 290a 2020   self.dbfile).  
-00001a50: 2020 2020 2020 2020 2020 636f 6e2e 6472            con.dr
-00001a60: 6f70 5f64 6174 6162 6173 6528 290a 2020  op_database().  
-00001a70: 2020 6465 6620 7465 7374 5f63 7265 6174    def test_creat
-00001a80: 655f 6472 6f70 5f63 6f6e 6669 6728 7365  e_drop_config(se
-00001a90: 6c66 293a 0a20 2020 2020 2020 2064 625f  lf):.        db_
-00001aa0: 636f 6e66 6967 203d 2066 2222 220a 2020  config = f""".  
-00001ab0: 2020 2020 2020 5b74 6573 745f 6462 325d        [test_db2]
-00001ac0: 0a20 2020 2020 2020 2064 6174 6162 6173  .        databas
-00001ad0: 6520 3d20 7b73 656c 662e 6462 6669 6c65  e = {self.dbfile
-00001ae0: 7d0a 2020 2020 2020 2020 7573 6572 203d  }.        user =
-00001af0: 207b 4642 5445 5354 5f55 5345 527d 0a20   {FBTEST_USER}. 
-00001b00: 2020 2020 2020 2070 6173 7377 6f72 6420         password 
-00001b10: 3d20 7b46 4254 4553 545f 5041 5353 574f  = {FBTEST_PASSWO
-00001b20: 5244 7d0a 2020 2020 2020 2020 7574 6638  RD}.        utf8
-00001b30: 6669 6c65 6e61 6d65 203d 2074 7275 650a  filename = true.
-00001b40: 2020 2020 2020 2020 6368 6172 7365 7420          charset 
-00001b50: 3d20 5554 4638 0a20 2020 2020 2020 2073  = UTF8.        s
-00001b60: 716c 5f64 6961 6c65 6374 203d 2031 0a20  ql_dialect = 1. 
-00001b70: 2020 2020 2020 2070 6167 655f 7369 7a65         page_size
-00001b80: 203d 207b 7479 7065 732e 5061 6765 5369   = {types.PageSi
-00001b90: 7a65 2e50 4147 455f 3136 4b7d 0a20 2020  ze.PAGE_16K}.   
-00001ba0: 2020 2020 2064 625f 6368 6172 7365 7420       db_charset 
-00001bb0: 3d20 5554 4638 0a20 2020 2020 2020 2064  = UTF8.        d
-00001bc0: 625f 7371 6c5f 6469 616c 6563 7420 3d20  b_sql_dialect = 
-00001bd0: 310a 2020 2020 2020 2020 7377 6565 705f  1.        sweep_
-00001be0: 696e 7465 7276 616c 203d 2030 0a20 2020  interval = 0.   
-00001bf0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00001c00: 2064 7269 7665 725f 636f 6e66 6967 2e72   driver_config.r
-00001c10: 6567 6973 7465 725f 6461 7461 6261 7365  egister_database
-00001c20: 2827 7465 7374 5f64 6232 272c 2064 625f  ('test_db2', db_
-00001c30: 636f 6e66 6967 290a 2020 2020 2020 2020  config).        
-00001c40: 230a 2020 2020 2020 2020 7769 7468 2063  #.        with c
-00001c50: 7265 6174 655f 6461 7461 6261 7365 2827  reate_database('
-00001c60: 7465 7374 5f64 6232 2729 2061 7320 636f  test_db2') as co
-00001c70: 6e3a 0a20 2020 2020 2020 2020 2020 2073  n:.            s
-00001c80: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00001c90: 636f 6e2e 7371 6c5f 6469 616c 6563 742c  con.sql_dialect,
-00001ca0: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
-00001cb0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00001cc0: 2863 6f6e 2e63 6861 7273 6574 2c20 2755  (con.charset, 'U
-00001cd0: 5446 3827 290a 2020 2020 2020 2020 2020  TF8').          
-00001ce0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00001cf0: 616c 2863 6f6e 2e69 6e66 6f2e 7061 6765  al(con.info.page
-00001d00: 5f73 697a 652c 2031 3633 3834 290a 2020  _size, 16384).  
-00001d10: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00001d20: 7373 6572 7445 7175 616c 2863 6f6e 2e69  ssertEqual(con.i
-00001d30: 6e66 6f2e 7371 6c5f 6469 616c 6563 742c  nfo.sql_dialect,
-00001d40: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
-00001d50: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00001d60: 2863 6f6e 2e69 6e66 6f2e 6368 6172 7365  (con.info.charse
-00001d70: 742c 2027 5554 4638 2729 0a20 2020 2020  t, 'UTF8').     
-00001d80: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00001d90: 7274 4571 7561 6c28 636f 6e2e 696e 666f  rtEqual(con.info
-00001da0: 2e73 7765 6570 5f69 6e74 6572 7661 6c2c  .sweep_interval,
-00001db0: 2030 290a 2020 2020 2020 2020 2020 2020   0).            
-00001dc0: 636f 6e2e 6472 6f70 5f64 6174 6162 6173  con.drop_databas
-00001dd0: 6528 290a 0a63 6c61 7373 2054 6573 7443  e()..class TestC
-00001de0: 6f6e 6e65 6374 696f 6e28 4472 6976 6572  onnection(Driver
-00001df0: 5465 7374 4261 7365 293a 0a20 2020 2064  TestBase):.    d
-00001e00: 6566 2073 6574 5570 2873 656c 6629 3a0a  ef setUp(self):.
-00001e10: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-00001e20: 7365 7455 7028 290a 2020 2020 2020 2020  setUp().        
-00001e30: 7365 6c66 2e64 6266 696c 6520 3d20 6f73  self.dbfile = os
-00001e40: 2e70 6174 682e 6a6f 696e 2873 656c 662e  .path.join(self.
-00001e50: 6462 7061 7468 2c20 7365 6c66 2e46 4254  dbpath, self.FBT
-00001e60: 4553 545f 4442 290a 2020 2020 6465 6620  EST_DB).    def 
-00001e70: 7465 6172 446f 776e 2873 656c 6629 3a0a  tearDown(self):.
-00001e80: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-00001e90: 2064 6566 2074 6573 745f 636f 6e6e 6563   def test_connec
-00001ea0: 745f 6865 6c70 6572 2873 656c 6629 3a0a  t_helper(self):.
-00001eb0: 2020 2020 2020 2020 4442 5f4c 494e 5558          DB_LINUX
-00001ec0: 5f50 4154 4820 3d20 272f 7061 7468 2f74  _PATH = '/path/t
-00001ed0: 6f2f 6462 2f65 6d70 6c6f 7965 652e 6664  o/db/employee.fd
-00001ee0: 6227 0a20 2020 2020 2020 2044 425f 5749  b'.        DB_WI
-00001ef0: 4e5f 5041 5448 203d 2027 433a 5c5c 7061  N_PATH = 'C:\\pa
-00001f00: 7468 5c5c 746f 5c5c 6462 5c5c 656d 706c  th\\to\\db\\empl
-00001f10: 6f79 6565 2e66 6462 270a 2020 2020 2020  oyee.fdb'.      
-00001f20: 2020 4442 5f41 4c49 4153 203d 2027 656d    DB_ALIAS = 'em
-00001f30: 706c 6f79 6565 270a 2020 2020 2020 2020  ployee'.        
-00001f40: 484f 5354 203d 2027 6c6f 6361 6c68 6f73  HOST = 'localhos
-00001f50: 7427 0a20 2020 2020 2020 204e 5049 5045  t'.        NPIPE
-00001f60: 5f48 4f53 5420 3d20 275c 5c5c 5c4d 7953  _HOST = '\\\\MyS
-00001f70: 6572 7665 7227 0a20 2020 2020 2020 2049  erver'.        I
-00001f80: 5020 3d20 2731 3237 2e30 2e30 2e31 270a  P = '127.0.0.1'.
-00001f90: 2020 2020 2020 2020 504f 5254 203d 2027          PORT = '
-00001fa0: 3330 3531 270a 2020 2020 2020 2020 5356  3051'.        SV
-00001fb0: 435f 4e41 4d45 203d 2027 6662 5f73 7276  C_NAME = 'fb_srv
-00001fc0: 270a 2020 2020 2020 2020 2320 436c 6173  '.        # Clas
-00001fd0: 7369 6320 4453 4e20 2877 6974 686f 7574  sic DSN (without
-00001fe0: 2070 726f 746f 636f 6c29 0a20 2020 2020   protocol).     
-00001ff0: 2020 2023 2031 2e20 4c6f 6361 6c20 636f     # 1. Local co
-00002000: 6e6e 6563 7469 6f6e 0a20 2020 2020 2020  nnection.       
-00002010: 2064 736e 203d 2064 7269 7665 722e 636f   dsn = driver.co
-00002020: 7265 2e5f 636f 6e6e 6563 745f 6865 6c70  re._connect_help
-00002030: 6572 284e 6f6e 652c 204e 6f6e 652c 204e  er(None, None, N
-00002040: 6f6e 652c 2044 425f 414c 4941 532c 204e  one, DB_ALIAS, N
-00002050: 6f6e 6529 0a20 2020 2020 2020 2073 656c  one).        sel
-00002060: 662e 6173 7365 7274 4571 7561 6c28 6473  f.assertEqual(ds
-00002070: 6e2c 2044 425f 414c 4941 5329 0a20 2020  n, DB_ALIAS).   
-00002080: 2020 2020 2064 736e 203d 2064 7269 7665       dsn = drive
-00002090: 722e 636f 7265 2e5f 636f 6e6e 6563 745f  r.core._connect_
-000020a0: 6865 6c70 6572 284e 6f6e 652c 204e 6f6e  helper(None, Non
-000020b0: 652c 204e 6f6e 652c 2044 425f 4c49 4e55  e, None, DB_LINU
-000020c0: 585f 5041 5448 2c20 4e6f 6e65 290a 2020  X_PATH, None).  
-000020d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000020e0: 7445 7175 616c 2864 736e 2c20 4442 5f4c  tEqual(dsn, DB_L
-000020f0: 494e 5558 5f50 4154 4829 0a20 2020 2020  INUX_PATH).     
-00002100: 2020 2064 736e 203d 2064 7269 7665 722e     dsn = driver.
-00002110: 636f 7265 2e5f 636f 6e6e 6563 745f 6865  core._connect_he
-00002120: 6c70 6572 284e 6f6e 652c 204e 6f6e 652c  lper(None, None,
-00002130: 204e 6f6e 652c 2044 425f 5749 4e5f 5041   None, DB_WIN_PA
-00002140: 5448 2c20 4e6f 6e65 290a 2020 2020 2020  TH, None).      
-00002150: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00002160: 616c 2864 736e 2c20 4442 5f57 494e 5f50  al(dsn, DB_WIN_P
-00002170: 4154 4829 0a20 2020 2020 2020 2023 2032  ATH).        # 2
-00002180: 2e20 5443 502f 4950 0a20 2020 2020 2020  . TCP/IP.       
-00002190: 2064 736e 203d 2064 7269 7665 722e 636f   dsn = driver.co
-000021a0: 7265 2e5f 636f 6e6e 6563 745f 6865 6c70  re._connect_help
-000021b0: 6572 284e 6f6e 652c 2048 4f53 542c 204e  er(None, HOST, N
-000021c0: 6f6e 652c 2044 425f 414c 4941 532c 204e  one, DB_ALIAS, N
-000021d0: 6f6e 6529 0a20 2020 2020 2020 2073 656c  one).        sel
-000021e0: 662e 6173 7365 7274 4571 7561 6c28 6473  f.assertEqual(ds
-000021f0: 6e2c 2066 277b 484f 5354 7d3a 7b44 425f  n, f'{HOST}:{DB_
-00002200: 414c 4941 537d 2729 0a20 2020 2020 2020  ALIAS}').       
-00002210: 2064 736e 203d 2064 7269 7665 722e 636f   dsn = driver.co
-00002220: 7265 2e5f 636f 6e6e 6563 745f 6865 6c70  re._connect_help
-00002230: 6572 284e 6f6e 652c 2049 502c 204e 6f6e  er(None, IP, Non
-00002240: 652c 2044 425f 4c49 4e55 585f 5041 5448  e, DB_LINUX_PATH
-00002250: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00002260: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00002270: 2864 736e 2c20 6627 7b49 507d 3a7b 4442  (dsn, f'{IP}:{DB
-00002280: 5f4c 494e 5558 5f50 4154 487d 2729 0a20  _LINUX_PATH}'). 
-00002290: 2020 2020 2020 2064 736e 203d 2064 7269         dsn = dri
-000022a0: 7665 722e 636f 7265 2e5f 636f 6e6e 6563  ver.core._connec
-000022b0: 745f 6865 6c70 6572 284e 6f6e 652c 2048  t_helper(None, H
-000022c0: 4f53 542c 204e 6f6e 652c 2044 425f 5749  OST, None, DB_WI
-000022d0: 4e5f 5041 5448 2c20 4e6f 6e65 290a 2020  N_PATH, None).  
-000022e0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000022f0: 7445 7175 616c 2864 736e 2c20 6627 7b48  tEqual(dsn, f'{H
-00002300: 4f53 547d 3a7b 4442 5f57 494e 5f50 4154  OST}:{DB_WIN_PAT
-00002310: 487d 2729 0a20 2020 2020 2020 2023 2033  H}').        # 3
-00002320: 2e20 5443 502f 4950 2077 6974 6820 506f  . TCP/IP with Po
-00002330: 7274 0a20 2020 2020 2020 2064 736e 203d  rt.        dsn =
-00002340: 2064 7269 7665 722e 636f 7265 2e5f 636f   driver.core._co
-00002350: 6e6e 6563 745f 6865 6c70 6572 284e 6f6e  nnect_helper(Non
-00002360: 652c 2048 4f53 542c 2050 4f52 542c 2044  e, HOST, PORT, D
-00002370: 425f 414c 4941 532c 204e 6f6e 6529 0a20  B_ALIAS, None). 
-00002380: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00002390: 7274 4571 7561 6c28 6473 6e2c 2066 277b  rtEqual(dsn, f'{
-000023a0: 484f 5354 7d2f 7b50 4f52 547d 3a7b 4442  HOST}/{PORT}:{DB
-000023b0: 5f41 4c49 4153 7d27 290a 2020 2020 2020  _ALIAS}').      
-000023c0: 2020 6473 6e20 3d20 6472 6976 6572 2e63    dsn = driver.c
-000023d0: 6f72 652e 5f63 6f6e 6e65 6374 5f68 656c  ore._connect_hel
-000023e0: 7065 7228 4e6f 6e65 2c20 4950 2c20 504f  per(None, IP, PO
-000023f0: 5254 2c20 4442 5f4c 494e 5558 5f50 4154  RT, DB_LINUX_PAT
-00002400: 482c 204e 6f6e 6529 0a20 2020 2020 2020  H, None).       
-00002410: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00002420: 6c28 6473 6e2c 2066 277b 4950 7d2f 7b50  l(dsn, f'{IP}/{P
-00002430: 4f52 547d 3a7b 4442 5f4c 494e 5558 5f50  ORT}:{DB_LINUX_P
-00002440: 4154 487d 2729 0a20 2020 2020 2020 2064  ATH}').        d
-00002450: 736e 203d 2064 7269 7665 722e 636f 7265  sn = driver.core
-00002460: 2e5f 636f 6e6e 6563 745f 6865 6c70 6572  ._connect_helper
-00002470: 284e 6f6e 652c 2048 4f53 542c 2053 5643  (None, HOST, SVC
-00002480: 5f4e 414d 452c 2044 425f 5749 4e5f 5041  _NAME, DB_WIN_PA
-00002490: 5448 2c20 4e6f 6e65 290a 2020 2020 2020  TH, None).      
-000024a0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000024b0: 616c 2864 736e 2c20 6627 7b48 4f53 547d  al(dsn, f'{HOST}
-000024c0: 2f7b 5356 435f 4e41 4d45 7d3a 7b44 425f  /{SVC_NAME}:{DB_
-000024d0: 5749 4e5f 5041 5448 7d27 290a 2020 2020  WIN_PATH}').    
-000024e0: 2020 2020 2320 342e 204e 616d 6564 2070      # 4. Named p
-000024f0: 6970 6573 0a20 2020 2020 2020 2064 736e  ipes.        dsn
-00002500: 203d 2064 7269 7665 722e 636f 7265 2e5f   = driver.core._
-00002510: 636f 6e6e 6563 745f 6865 6c70 6572 284e  connect_helper(N
-00002520: 6f6e 652c 204e 5049 5045 5f48 4f53 542c  one, NPIPE_HOST,
-00002530: 204e 6f6e 652c 2044 425f 414c 4941 532c   None, DB_ALIAS,
-00002540: 204e 6f6e 6529 0a20 2020 2020 2020 2073   None).        s
-00002550: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00002560: 6473 6e2c 2066 277b 4e50 4950 455f 484f  dsn, f'{NPIPE_HO
-00002570: 5354 7d5c 5c7b 4442 5f41 4c49 4153 7d27  ST}\\{DB_ALIAS}'
-00002580: 290a 2020 2020 2020 2020 6473 6e20 3d20  ).        dsn = 
-00002590: 6472 6976 6572 2e63 6f72 652e 5f63 6f6e  driver.core._con
-000025a0: 6e65 6374 5f68 656c 7065 7228 4e6f 6e65  nect_helper(None
-000025b0: 2c20 4e50 4950 455f 484f 5354 2c20 5356  , NPIPE_HOST, SV
-000025c0: 435f 4e41 4d45 2c20 4442 5f57 494e 5f50  C_NAME, DB_WIN_P
-000025d0: 4154 482c 204e 6f6e 6529 0a20 2020 2020  ATH, None).     
-000025e0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000025f0: 7561 6c28 6473 6e2c 2066 277b 4e50 4950  ual(dsn, f'{NPIP
-00002600: 455f 484f 5354 7d40 7b53 5643 5f4e 414d  E_HOST}@{SVC_NAM
-00002610: 457d 5c5c 7b44 425f 5749 4e5f 5041 5448  E}\\{DB_WIN_PATH
-00002620: 7d27 290a 2020 2020 2020 2020 2320 5552  }').        # UR
-00002630: 4c2d 5374 796c 6520 436f 6e6e 6563 7469  L-Style Connecti
-00002640: 6f6e 2053 7472 696e 6773 2028 7769 7468  on Strings (with
-00002650: 2070 726f 746f 636f 6c29 0a20 2020 2020   protocol).     
-00002660: 2020 2023 2031 2e20 4c6f 6f70 6261 636b     # 1. Loopback
-00002670: 2063 6f6e 6e65 6374 696f 6e0a 2020 2020   connection.    
-00002680: 2020 2020 6473 6e20 3d20 6472 6976 6572      dsn = driver
-00002690: 2e63 6f72 652e 5f63 6f6e 6e65 6374 5f68  .core._connect_h
-000026a0: 656c 7065 7228 4e6f 6e65 2c20 4e6f 6e65  elper(None, None
-000026b0: 2c20 4e6f 6e65 2c20 4442 5f41 4c49 4153  , None, DB_ALIAS
-000026c0: 2c20 4e65 7450 726f 746f 636f 6c2e 494e  , NetProtocol.IN
-000026d0: 4554 290a 2020 2020 2020 2020 7365 6c66  ET).        self
-000026e0: 2e61 7373 6572 7445 7175 616c 2864 736e  .assertEqual(dsn
-000026f0: 2c20 6627 696e 6574 3a2f 2f7b 4442 5f41  , f'inet://{DB_A
-00002700: 4c49 4153 7d27 290a 2020 2020 2020 2020  LIAS}').        
-00002710: 6473 6e20 3d20 6472 6976 6572 2e63 6f72  dsn = driver.cor
-00002720: 652e 5f63 6f6e 6e65 6374 5f68 656c 7065  e._connect_helpe
-00002730: 7228 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f  r(None, None, No
-00002740: 6e65 2c20 4442 5f4c 494e 5558 5f50 4154  ne, DB_LINUX_PAT
-00002750: 482c 204e 6574 5072 6f74 6f63 6f6c 2e49  H, NetProtocol.I
-00002760: 4e45 5429 0a20 2020 2020 2020 2073 656c  NET).        sel
-00002770: 662e 6173 7365 7274 4571 7561 6c28 6473  f.assertEqual(ds
-00002780: 6e2c 2066 2769 6e65 743a 2f2f 7b44 425f  n, f'inet://{DB_
-00002790: 4c49 4e55 585f 5041 5448 7d27 290a 2020  LINUX_PATH}').  
-000027a0: 2020 2020 2020 6473 6e20 3d20 6472 6976        dsn = driv
-000027b0: 6572 2e63 6f72 652e 5f63 6f6e 6e65 6374  er.core._connect
-000027c0: 5f68 656c 7065 7228 4e6f 6e65 2c20 4e6f  _helper(None, No
-000027d0: 6e65 2c20 4e6f 6e65 2c20 4442 5f57 494e  ne, None, DB_WIN
-000027e0: 5f50 4154 482c 204e 6574 5072 6f74 6f63  _PATH, NetProtoc
-000027f0: 6f6c 2e49 4e45 5429 0a20 2020 2020 2020  ol.INET).       
-00002800: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00002810: 6c28 6473 6e2c 2066 2769 6e65 743a 2f2f  l(dsn, f'inet://
-00002820: 7b44 425f 5749 4e5f 5041 5448 7d27 290a  {DB_WIN_PATH}').
-00002830: 2020 2020 2020 2020 6473 6e20 3d20 6472          dsn = dr
-00002840: 6976 6572 2e63 6f72 652e 5f63 6f6e 6e65  iver.core._conne
-00002850: 6374 5f68 656c 7065 7228 4e6f 6e65 2c20  ct_helper(None, 
-00002860: 4e6f 6e65 2c20 4e6f 6e65 2c20 4442 5f41  None, None, DB_A
-00002870: 4c49 4153 2c20 4e65 7450 726f 746f 636f  LIAS, NetProtoco
-00002880: 6c2e 574e 4554 290a 2020 2020 2020 2020  l.WNET).        
-00002890: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000028a0: 2864 736e 2c20 6627 776e 6574 3a2f 2f7b  (dsn, f'wnet://{
-000028b0: 4442 5f41 4c49 4153 7d27 290a 2020 2020  DB_ALIAS}').    
-000028c0: 2020 2020 6473 6e20 3d20 6472 6976 6572      dsn = driver
-000028d0: 2e63 6f72 652e 5f63 6f6e 6e65 6374 5f68  .core._connect_h
-000028e0: 656c 7065 7228 4e6f 6e65 2c20 4e6f 6e65  elper(None, None
-000028f0: 2c20 4e6f 6e65 2c20 4442 5f41 4c49 4153  , None, DB_ALIAS
-00002900: 2c20 4e65 7450 726f 746f 636f 6c2e 584e  , NetProtocol.XN
-00002910: 4554 290a 2020 2020 2020 2020 7365 6c66  ET).        self
-00002920: 2e61 7373 6572 7445 7175 616c 2864 736e  .assertEqual(dsn
-00002930: 2c20 6627 786e 6574 3a2f 2f7b 4442 5f41  , f'xnet://{DB_A
-00002940: 4c49 4153 7d27 290a 2020 2020 2020 2020  LIAS}').        
-00002950: 2320 322e 2054 4350 2f49 500a 2020 2020  # 2. TCP/IP.    
-00002960: 2020 2020 6473 6e20 3d20 6472 6976 6572      dsn = driver
-00002970: 2e63 6f72 652e 5f63 6f6e 6e65 6374 5f68  .core._connect_h
-00002980: 656c 7065 7228 4e6f 6e65 2c20 484f 5354  elper(None, HOST
-00002990: 2c20 4e6f 6e65 2c20 4442 5f41 4c49 4153  , None, DB_ALIAS
-000029a0: 2c20 4e65 7450 726f 746f 636f 6c2e 494e  , NetProtocol.IN
-000029b0: 4554 290a 2020 2020 2020 2020 7365 6c66  ET).        self
-000029c0: 2e61 7373 6572 7445 7175 616c 2864 736e  .assertEqual(dsn
-000029d0: 2c20 6627 696e 6574 3a2f 2f7b 484f 5354  , f'inet://{HOST
-000029e0: 7d2f 7b44 425f 414c 4941 537d 2729 0a20  }/{DB_ALIAS}'). 
-000029f0: 2020 2020 2020 2064 736e 203d 2064 7269         dsn = dri
-00002a00: 7665 722e 636f 7265 2e5f 636f 6e6e 6563  ver.core._connec
-00002a10: 745f 6865 6c70 6572 284e 6f6e 652c 2049  t_helper(None, I
-00002a20: 502c 204e 6f6e 652c 2044 425f 4c49 4e55  P, None, DB_LINU
-00002a30: 585f 5041 5448 2c20 4e65 7450 726f 746f  X_PATH, NetProto
-00002a40: 636f 6c2e 494e 4554 290a 2020 2020 2020  col.INET).      
-00002a50: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00002a60: 616c 2864 736e 2c20 6627 696e 6574 3a2f  al(dsn, f'inet:/
-00002a70: 2f7b 4950 7d2f 7b44 425f 4c49 4e55 585f  /{IP}/{DB_LINUX_
-00002a80: 5041 5448 7d27 290a 2020 2020 2020 2020  PATH}').        
-00002a90: 6473 6e20 3d20 6472 6976 6572 2e63 6f72  dsn = driver.cor
-00002aa0: 652e 5f63 6f6e 6e65 6374 5f68 656c 7065  e._connect_helpe
-00002ab0: 7228 4e6f 6e65 2c20 484f 5354 2c20 4e6f  r(None, HOST, No
-00002ac0: 6e65 2c20 4442 5f57 494e 5f50 4154 482c  ne, DB_WIN_PATH,
-00002ad0: 204e 6574 5072 6f74 6f63 6f6c 2e49 4e45   NetProtocol.INE
-00002ae0: 5429 0a20 2020 2020 2020 2073 656c 662e  T).        self.
-00002af0: 6173 7365 7274 4571 7561 6c28 6473 6e2c  assertEqual(dsn,
-00002b00: 2066 2769 6e65 743a 2f2f 7b48 4f53 547d   f'inet://{HOST}
-00002b10: 2f7b 4442 5f57 494e 5f50 4154 487d 2729  /{DB_WIN_PATH}')
-00002b20: 0a20 2020 2020 2020 2023 2033 2e20 5443  .        # 3. TC
-00002b30: 502f 4950 2077 6974 6820 506f 7274 0a20  P/IP with Port. 
-00002b40: 2020 2020 2020 2064 736e 203d 2064 7269         dsn = dri
-00002b50: 7665 722e 636f 7265 2e5f 636f 6e6e 6563  ver.core._connec
-00002b60: 745f 6865 6c70 6572 284e 6f6e 652c 2048  t_helper(None, H
-00002b70: 4f53 542c 2050 4f52 542c 2044 425f 414c  OST, PORT, DB_AL
-00002b80: 4941 532c 204e 6574 5072 6f74 6f63 6f6c  IAS, NetProtocol
-00002b90: 2e49 4e45 5429 0a20 2020 2020 2020 2073  .INET).        s
-00002ba0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00002bb0: 6473 6e2c 2066 2769 6e65 743a 2f2f 7b48  dsn, f'inet://{H
-00002bc0: 4f53 547d 3a7b 504f 5254 7d2f 7b44 425f  OST}:{PORT}/{DB_
-00002bd0: 414c 4941 537d 2729 0a20 2020 2020 2020  ALIAS}').       
-00002be0: 2064 736e 203d 2064 7269 7665 722e 636f   dsn = driver.co
-00002bf0: 7265 2e5f 636f 6e6e 6563 745f 6865 6c70  re._connect_help
-00002c00: 6572 284e 6f6e 652c 2049 502c 2050 4f52  er(None, IP, POR
-00002c10: 542c 2044 425f 4c49 4e55 585f 5041 5448  T, DB_LINUX_PATH
-00002c20: 2c20 4e65 7450 726f 746f 636f 6c2e 494e  , NetProtocol.IN
-00002c30: 4554 290a 2020 2020 2020 2020 7365 6c66  ET).        self
-00002c40: 2e61 7373 6572 7445 7175 616c 2864 736e  .assertEqual(dsn
-00002c50: 2c20 6627 696e 6574 3a2f 2f7b 4950 7d3a  , f'inet://{IP}:
-00002c60: 7b50 4f52 547d 2f7b 4442 5f4c 494e 5558  {PORT}/{DB_LINUX
-00002c70: 5f50 4154 487d 2729 0a20 2020 2020 2020  _PATH}').       
-00002c80: 2064 736e 203d 2064 7269 7665 722e 636f   dsn = driver.co
-00002c90: 7265 2e5f 636f 6e6e 6563 745f 6865 6c70  re._connect_help
-00002ca0: 6572 284e 6f6e 652c 2048 4f53 542c 2053  er(None, HOST, S
-00002cb0: 5643 5f4e 414d 452c 2044 425f 5749 4e5f  VC_NAME, DB_WIN_
-00002cc0: 5041 5448 2c20 4e65 7450 726f 746f 636f  PATH, NetProtoco
-00002cd0: 6c2e 494e 4554 290a 2020 2020 2020 2020  l.INET).        
-00002ce0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00002cf0: 2864 736e 2c20 6627 696e 6574 3a2f 2f7b  (dsn, f'inet://{
-00002d00: 484f 5354 7d3a 7b53 5643 5f4e 414d 457d  HOST}:{SVC_NAME}
-00002d10: 2f7b 4442 5f57 494e 5f50 4154 487d 2729  /{DB_WIN_PATH}')
-00002d20: 0a20 2020 2020 2020 2023 2034 2e20 4e61  .        # 4. Na
-00002d30: 6d65 6420 7069 7065 730a 2020 2020 2020  med pipes.      
-00002d40: 2020 6473 6e20 3d20 6472 6976 6572 2e63    dsn = driver.c
-00002d50: 6f72 652e 5f63 6f6e 6e65 6374 5f68 656c  ore._connect_hel
-00002d60: 7065 7228 4e6f 6e65 2c20 4e50 4950 455f  per(None, NPIPE_
-00002d70: 484f 5354 2c20 4e6f 6e65 2c20 4442 5f41  HOST, None, DB_A
-00002d80: 4c49 4153 2c20 4e65 7450 726f 746f 636f  LIAS, NetProtoco
-00002d90: 6c2e 574e 4554 290a 2020 2020 2020 2020  l.WNET).        
-00002da0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00002db0: 2864 736e 2c66 2777 6e65 743a 2f2f 7b4e  (dsn,f'wnet://{N
-00002dc0: 5049 5045 5f48 4f53 547d 2f7b 4442 5f41  PIPE_HOST}/{DB_A
-00002dd0: 4c49 4153 7d27 290a 2020 2020 2020 2020  LIAS}').        
-00002de0: 6473 6e20 3d20 6472 6976 6572 2e63 6f72  dsn = driver.cor
-00002df0: 652e 5f63 6f6e 6e65 6374 5f68 656c 7065  e._connect_helpe
-00002e00: 7228 4e6f 6e65 2c20 4e50 4950 455f 484f  r(None, NPIPE_HO
-00002e10: 5354 2c20 5356 435f 4e41 4d45 2c20 4442  ST, SVC_NAME, DB
-00002e20: 5f57 494e 5f50 4154 482c 204e 6574 5072  _WIN_PATH, NetPr
-00002e30: 6f74 6f63 6f6c 2e57 4e45 5429 0a20 2020  otocol.WNET).   
-00002e40: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00002e50: 4571 7561 6c28 6473 6e2c 2066 2777 6e65  Equal(dsn, f'wne
-00002e60: 743a 2f2f 7b4e 5049 5045 5f48 4f53 547d  t://{NPIPE_HOST}
-00002e70: 3a7b 5356 435f 4e41 4d45 7d2f 7b44 425f  :{SVC_NAME}/{DB_
-00002e80: 5749 4e5f 5041 5448 7d27 290a 2020 2020  WIN_PATH}').    
-00002e90: 6465 6620 7465 7374 5f63 6f6e 6e65 6374  def test_connect
-00002ea0: 5f64 736e 2873 656c 6629 3a0a 2020 2020  _dsn(self):.    
-00002eb0: 2020 2020 7769 7468 2063 6f6e 6e65 6374      with connect
-00002ec0: 2873 656c 662e 6462 6669 6c65 2c20 7573  (self.dbfile, us
-00002ed0: 6572 3d46 4254 4553 545f 5553 4552 2c20  er=FBTEST_USER, 
-00002ee0: 7061 7373 776f 7264 3d46 4254 4553 545f  password=FBTEST_
-00002ef0: 5041 5353 574f 5244 2920 6173 2063 6f6e  PASSWORD) as con
-00002f00: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00002f10: 6e2e 5f6c 6f67 6769 6e67 5f69 645f 203d  n._logging_id_ =
-00002f20: 2073 656c 662e 5f5f 636c 6173 735f 5f2e   self.__class__.
-00002f30: 5f5f 6e61 6d65 5f5f 0a20 2020 2020 2020  __name__.       
-00002f40: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00002f50: 4973 4e6f 744e 6f6e 6528 636f 6e2e 5f61  IsNotNone(con._a
-00002f60: 7474 290a 2020 2020 2020 2020 2020 2020  tt).            
-00002f70: 6470 6220 3d20 5b31 2c20 3078 3163 2c20  dpb = [1, 0x1c, 
-00002f80: 6c65 6e28 4642 5445 5354 5f55 5345 5229  len(FBTEST_USER)
-00002f90: 5d0a 2020 2020 2020 2020 2020 2020 6470  ].            dp
-00002fa0: 622e 6578 7465 6e64 286f 7264 2878 2920  b.extend(ord(x) 
-00002fb0: 666f 7220 7820 696e 2046 4254 4553 545f  for x in FBTEST_
-00002fc0: 5553 4552 290a 2020 2020 2020 2020 2020  USER).          
-00002fd0: 2020 6470 622e 6578 7465 6e64 2828 3078    dpb.extend((0x
-00002fe0: 3164 2c20 6c65 6e28 4642 5445 5354 5f50  1d, len(FBTEST_P
-00002ff0: 4153 5357 4f52 4429 2929 0a20 2020 2020  ASSWORD))).     
-00003000: 2020 2020 2020 2064 7062 2e65 7874 656e         dpb.exten
-00003010: 6428 6f72 6428 7829 2066 6f72 2078 2069  d(ord(x) for x i
-00003020: 6e20 4642 5445 5354 5f50 4153 5357 4f52  n FBTEST_PASSWOR
-00003030: 4429 0a20 2020 2020 2020 2020 2020 2064  D).            d
-00003040: 7062 2e65 7874 656e 6428 286f 7264 2827  pb.extend((ord('
-00003050: 3f27 292c 2034 2c20 332c 2030 2c20 302c  ?'), 4, 3, 0, 0,
-00003060: 2030 2929 0a20 2020 2020 2020 2020 2020   0)).           
-00003070: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00003080: 6c28 636f 6e2e 5f64 7062 2c20 6279 7465  l(con._dpb, byte
-00003090: 7328 6470 6229 290a 2020 2020 2020 2020  s(dpb)).        
-000030a0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-000030b0: 7175 616c 2863 6f6e 2e64 736e 2c20 7365  qual(con.dsn, se
-000030c0: 6c66 2e64 6266 696c 6529 0a20 2020 2064  lf.dbfile).    d
-000030d0: 6566 2074 6573 745f 636f 6e6e 6563 745f  ef test_connect_
-000030e0: 636f 6e66 6967 2873 656c 6629 3a0a 2020  config(self):.  
-000030f0: 2020 2020 2020 7372 765f 636f 6e66 6967        srv_config
-00003100: 203d 2066 2222 220a 2020 2020 2020 2020   = f""".        
-00003110: 5b73 6572 7665 722e 6c6f 6361 6c5d 0a20  [server.local]. 
-00003120: 2020 2020 2020 2068 6f73 7420 3d20 7b46         host = {F
-00003130: 4254 4553 545f 484f 5354 7d0a 2020 2020  BTEST_HOST}.    
-00003140: 2020 2020 7573 6572 203d 207b 4642 5445      user = {FBTE
-00003150: 5354 5f55 5345 527d 0a20 2020 2020 2020  ST_USER}.       
-00003160: 2070 6173 7377 6f72 6420 3d20 7b46 4254   password = {FBT
-00003170: 4553 545f 5041 5353 574f 5244 7d0a 2020  EST_PASSWORD}.  
-00003180: 2020 2020 2020 706f 7274 203d 2033 3035        port = 305
-00003190: 300a 2020 2020 2020 2020 2222 220a 2020  0.        """.  
-000031a0: 2020 2020 2020 6462 5f63 6f6e 6669 6720        db_config 
-000031b0: 3d20 6622 2222 0a20 2020 2020 2020 205b  = f""".        [
-000031c0: 7465 7374 5f64 6231 5d0a 2020 2020 2020  test_db1].      
-000031d0: 2020 7365 7276 6572 203d 2073 6572 7665    server = serve
-000031e0: 722e 6c6f 6361 6c0a 2020 2020 2020 2020  r.local.        
-000031f0: 6461 7461 6261 7365 203d 207b 7365 6c66  database = {self
-00003200: 2e64 6266 696c 657d 0a20 2020 2020 2020  .dbfile}.       
-00003210: 2075 7365 7220 3d20 7b46 4254 4553 545f   user = {FBTEST_
-00003220: 5553 4552 7d0a 2020 2020 2020 2020 7061  USER}.        pa
-00003230: 7373 776f 7264 203d 207b 4642 5445 5354  ssword = {FBTEST
-00003240: 5f50 4153 5357 4f52 447d 0a20 2020 2020  _PASSWORD}.     
-00003250: 2020 2075 7466 3866 696c 656e 616d 6520     utf8filename 
-00003260: 3d20 7472 7565 0a20 2020 2020 2020 2063  = true.        c
-00003270: 6861 7273 6574 203d 2055 5446 380a 2020  harset = UTF8.  
-00003280: 2020 2020 2020 7371 6c5f 6469 616c 6563        sql_dialec
-00003290: 7420 3d20 330a 2020 2020 2020 2020 2222  t = 3.        ""
-000032a0: 220a 2020 2020 2020 2020 6472 6976 6572  ".        driver
-000032b0: 5f63 6f6e 6669 672e 7265 6769 7374 6572  _config.register
-000032c0: 5f73 6572 7665 7228 2773 6572 7665 722e  _server('server.
-000032d0: 6c6f 6361 6c27 2c20 7372 765f 636f 6e66  local', srv_conf
-000032e0: 6967 290a 2020 2020 2020 2020 6472 6976  ig).        driv
-000032f0: 6572 5f63 6f6e 6669 672e 7265 6769 7374  er_config.regist
-00003300: 6572 5f64 6174 6162 6173 6528 2774 6573  er_database('tes
-00003310: 745f 6462 3127 2c20 6462 5f63 6f6e 6669  t_db1', db_confi
-00003320: 6729 0a20 2020 2020 2020 2023 0a20 2020  g).        #.   
-00003330: 2020 2020 2077 6974 6820 636f 6e6e 6563       with connec
-00003340: 7428 2774 6573 745f 6462 3127 2920 6173  t('test_db1') as
-00003350: 2063 6f6e 3a0a 2020 2020 2020 2020 2020   con:.          
-00003360: 2020 636f 6e2e 5f6c 6f67 6769 6e67 5f69    con._logging_i
-00003370: 645f 203d 2073 656c 662e 5f5f 636c 6173  d_ = self.__clas
-00003380: 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020  s__.__name__.   
-00003390: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-000033a0: 7365 7274 4973 4e6f 744e 6f6e 6528 636f  sertIsNotNone(co
-000033b0: 6e2e 5f61 7474 290a 2020 2020 2020 2020  n._att).        
-000033c0: 2020 2020 6470 6220 3d20 5b31 2c20 3078      dpb = [1, 0x
-000033d0: 3163 2c20 6c65 6e28 4642 5445 5354 5f55  1c, len(FBTEST_U
-000033e0: 5345 5229 5d0a 2020 2020 2020 2020 2020  SER)].          
-000033f0: 2020 6470 622e 6578 7465 6e64 286f 7264    dpb.extend(ord
-00003400: 2878 2920 666f 7220 7820 696e 2046 4254  (x) for x in FBT
-00003410: 4553 545f 5553 4552 290a 2020 2020 2020  EST_USER).      
-00003420: 2020 2020 2020 6470 622e 6578 7465 6e64        dpb.extend
-00003430: 2828 3078 3164 2c20 6c65 6e28 4642 5445  ((0x1d, len(FBTE
-00003440: 5354 5f50 4153 5357 4f52 4429 2929 0a20  ST_PASSWORD))). 
-00003450: 2020 2020 2020 2020 2020 2064 7062 2e65             dpb.e
-00003460: 7874 656e 6428 6f72 6428 7829 2066 6f72  xtend(ord(x) for
-00003470: 2078 2069 6e20 4642 5445 5354 5f50 4153   x in FBTEST_PAS
-00003480: 5357 4f52 4429 0a20 2020 2020 2020 2020  SWORD).         
-00003490: 2020 2064 7062 2e65 7874 656e 6428 286f     dpb.extend((o
-000034a0: 7264 2827 3f27 292c 2034 2c20 332c 2030  rd('?'), 4, 3, 0
-000034b0: 2c20 302c 2030 2929 0a20 2020 2020 2020  , 0, 0)).       
-000034c0: 2020 2020 2064 7062 2e65 7874 656e 6428       dpb.extend(
-000034d0: 286f 7264 2827 3027 292c 2034 2c20 6f72  (ord('0'), 4, or
-000034e0: 6428 2755 2729 2c20 6f72 6428 2754 2729  d('U'), ord('T')
-000034f0: 2c20 6f72 6428 2746 2729 2c20 6f72 6428  , ord('F'), ord(
-00003500: 2738 2729 2929 0a20 2020 2020 2020 2020  '8'))).         
-00003510: 2020 2064 7062 2e65 7874 656e 6428 2837     dpb.extend((7
-00003520: 372c 2034 2c20 312c 2030 2c20 302c 2030  7, 4, 1, 0, 0, 0
-00003530: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
-00003540: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00003550: 636f 6e2e 5f64 7062 2c20 6279 7465 7328  con._dpb, bytes(
-00003560: 6470 6229 290a 2020 2020 2020 2020 2020  dpb)).          
-00003570: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00003580: 616c 2863 6f6e 2e64 736e 2c20 6627 7b46  al(con.dsn, f'{F
-00003590: 4254 4553 545f 484f 5354 7d2f 3330 3530  BTEST_HOST}/3050
-000035a0: 3a7b 7365 6c66 2e64 6266 696c 657d 2729  :{self.dbfile}')
-000035b0: 0a20 2020 2020 2020 2077 6974 6820 636f  .        with co
-000035c0: 6e6e 6563 7428 2774 6573 745f 6462 3127  nnect('test_db1'
-000035d0: 2c20 6e6f 5f67 633d 312c 206e 6f5f 6462  , no_gc=1, no_db
-000035e0: 5f74 7269 6767 6572 733d 3129 2061 7320  _triggers=1) as 
-000035f0: 636f 6e3a 0a20 2020 2020 2020 2020 2020  con:.           
-00003600: 2063 6f6e 2e5f 6c6f 6767 696e 675f 6964   con._logging_id
-00003610: 5f20 3d20 7365 6c66 2e5f 5f63 6c61 7373  _ = self.__class
-00003620: 5f5f 2e5f 5f6e 616d 655f 5f0a 2020 2020  __.__name__.    
-00003630: 2020 2020 2020 2020 6470 6220 3d20 5b31          dpb = [1
-00003640: 2c20 3078 3163 2c20 6c65 6e28 4642 5445  , 0x1c, len(FBTE
-00003650: 5354 5f55 5345 5229 5d0a 2020 2020 2020  ST_USER)].      
-00003660: 2020 2020 2020 6470 622e 6578 7465 6e64        dpb.extend
-00003670: 286f 7264 2878 2920 666f 7220 7820 696e  (ord(x) for x in
-00003680: 2046 4254 4553 545f 5553 4552 290a 2020   FBTEST_USER).  
-00003690: 2020 2020 2020 2020 2020 6470 622e 6578            dpb.ex
-000036a0: 7465 6e64 2828 3078 3164 2c20 6c65 6e28  tend((0x1d, len(
-000036b0: 4642 5445 5354 5f50 4153 5357 4f52 4429  FBTEST_PASSWORD)
-000036c0: 2929 0a20 2020 2020 2020 2020 2020 2064  )).            d
-000036d0: 7062 2e65 7874 656e 6428 6f72 6428 7829  pb.extend(ord(x)
-000036e0: 2066 6f72 2078 2069 6e20 4642 5445 5354   for x in FBTEST
-000036f0: 5f50 4153 5357 4f52 4429 0a20 2020 2020  _PASSWORD).     
-00003700: 2020 2020 2020 2064 7062 2e65 7874 656e         dpb.exten
-00003710: 6428 286f 7264 2827 3f27 292c 2034 2c20  d((ord('?'), 4, 
-00003720: 332c 2030 2c20 302c 2030 2929 0a20 2020  3, 0, 0, 0)).   
-00003730: 2020 2020 2020 2020 2064 7062 2e65 7874           dpb.ext
-00003740: 656e 6428 286f 7264 2827 3027 292c 2034  end((ord('0'), 4
-00003750: 2c20 6f72 6428 2755 2729 2c20 6f72 6428  , ord('U'), ord(
-00003760: 2754 2729 2c20 6f72 6428 2746 2729 2c20  'T'), ord('F'), 
-00003770: 6f72 6428 2738 2729 2929 0a20 2020 2020  ord('8'))).     
-00003780: 2020 2020 2020 2064 7062 2e65 7874 656e         dpb.exten
-00003790: 6428 5b74 7970 6573 2e44 5042 4974 656d  d([types.DPBItem
-000037a0: 2e4e 4f5f 4741 5242 4147 455f 434f 4c4c  .NO_GARBAGE_COLL
-000037b0: 4543 542c 2034 2c20 312c 2030 2c20 302c  ECT, 4, 1, 0, 0,
-000037c0: 2030 5d29 0a20 2020 2020 2020 2020 2020   0]).           
-000037d0: 2064 7062 2e65 7874 656e 6428 2874 7970   dpb.extend((typ
-000037e0: 6573 2e44 5042 4974 656d 2e55 5446 385f  es.DPBItem.UTF8_
-000037f0: 4649 4c45 4e41 4d45 2c20 342c 2031 2c20  FILENAME, 4, 1, 
-00003800: 302c 2030 2c20 3029 290a 2020 2020 2020  0, 0, 0)).      
-00003810: 2020 2020 2020 6470 622e 6578 7465 6e64        dpb.extend
-00003820: 285b 7479 7065 732e 4450 4249 7465 6d2e  ([types.DPBItem.
-00003830: 4e4f 5f44 425f 5452 4947 4745 5253 2c20  NO_DB_TRIGGERS, 
-00003840: 342c 2031 2c20 302c 2030 2c20 305d 290a  4, 1, 0, 0, 0]).
-00003850: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00003860: 2e61 7373 6572 7445 7175 616c 2863 6f6e  .assertEqual(con
-00003870: 2e5f 6470 622c 2062 7974 6573 2864 7062  ._dpb, bytes(dpb
-00003880: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
-00003890: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000038a0: 636f 6e2e 6473 6e2c 2066 277b 4642 5445  con.dsn, f'{FBTE
-000038b0: 5354 5f48 4f53 547d 2f33 3035 303a 7b73  ST_HOST}/3050:{s
-000038c0: 656c 662e 6462 6669 6c65 7d27 290a 2020  elf.dbfile}').  
-000038d0: 2020 2020 2020 2320 7072 6f74 6f63 6f6c        # protocol
-000038e0: 730a 2020 2020 2020 2020 6366 6720 3d20  s.        cfg = 
-000038f0: 6472 6976 6572 5f63 6f6e 6669 672e 6765  driver_config.ge
-00003900: 745f 6461 7461 6261 7365 2827 7465 7374  t_database('test
-00003910: 5f64 6231 2729 0a20 2020 2020 2020 2063  _db1').        c
-00003920: 6667 2e70 726f 746f 636f 6c2e 7661 6c75  fg.protocol.valu
-00003930: 6520 3d20 4e65 7450 726f 746f 636f 6c2e  e = NetProtocol.
-00003940: 494e 4554 0a20 2020 2020 2020 2077 6974  INET.        wit
-00003950: 6820 636f 6e6e 6563 7428 2774 6573 745f  h connect('test_
-00003960: 6462 3127 2920 6173 2063 6f6e 3a0a 2020  db1') as con:.  
-00003970: 2020 2020 2020 2020 2020 636f 6e2e 5f6c            con._l
-00003980: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
-00003990: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-000039a0: 6d65 5f5f 0a20 2020 2020 2020 2020 2020  me__.           
-000039b0: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
-000039c0: 744e 6f6e 6528 636f 6e2e 5f61 7474 290a  tNone(con._att).
-000039d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000039e0: 2e61 7373 6572 7445 7175 616c 2863 6f6e  .assertEqual(con
-000039f0: 2e64 736e 2c20 6627 696e 6574 3a2f 2f7b  .dsn, f'inet://{
-00003a00: 4642 5445 5354 5f48 4f53 547d 3a33 3035  FBTEST_HOST}:305
-00003a10: 302f 7b73 656c 662e 6462 6669 6c65 7d27  0/{self.dbfile}'
-00003a20: 290a 2020 2020 2020 2020 6366 672e 7072  ).        cfg.pr
-00003a30: 6f74 6f63 6f6c 2e76 616c 7565 203d 204e  otocol.value = N
-00003a40: 6574 5072 6f74 6f63 6f6c 2e49 4e45 5434  etProtocol.INET4
-00003a50: 0a20 2020 2020 2020 2077 6974 6820 636f  .        with co
-00003a60: 6e6e 6563 7428 2774 6573 745f 6462 3127  nnect('test_db1'
-00003a70: 2920 6173 2063 6f6e 3a0a 2020 2020 2020  ) as con:.      
-00003a80: 2020 2020 2020 636f 6e2e 5f6c 6f67 6769        con._loggi
-00003a90: 6e67 5f69 645f 203d 2073 656c 662e 5f5f  ng_id_ = self.__
-00003aa0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-00003ab0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00003ac0: 662e 6173 7365 7274 4973 4e6f 744e 6f6e  f.assertIsNotNon
-00003ad0: 6528 636f 6e2e 5f61 7474 290a 2020 2020  e(con._att).    
-00003ae0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00003af0: 6572 7445 7175 616c 2863 6f6e 2e64 736e  ertEqual(con.dsn
-00003b00: 2c20 6627 696e 6574 343a 2f2f 7b46 4254  , f'inet4://{FBT
-00003b10: 4553 545f 484f 5354 7d3a 3330 3530 2f7b  EST_HOST}:3050/{
-00003b20: 7365 6c66 2e64 6266 696c 657d 2729 0a20  self.dbfile}'). 
-00003b30: 2020 2064 6566 2074 6573 745f 7072 6f70     def test_prop
-00003b40: 6572 7469 6573 2873 656c 6629 3a0a 2020  erties(self):.  
-00003b50: 2020 2020 2020 7769 7468 2063 6f6e 6e65        with conne
-00003b60: 6374 2873 656c 662e 6462 6669 6c65 2c20  ct(self.dbfile, 
-00003b70: 7573 6572 3d46 4254 4553 545f 5553 4552  user=FBTEST_USER
-00003b80: 2c20 7061 7373 776f 7264 3d46 4254 4553  , password=FBTES
-00003b90: 545f 5041 5353 574f 5244 2920 6173 2063  T_PASSWORD) as c
-00003ba0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00003bb0: 636f 6e2e 5f6c 6f67 6769 6e67 5f69 645f  con._logging_id_
-00003bc0: 203d 2073 656c 662e 5f5f 636c 6173 735f   = self.__class_
-00003bd0: 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020 2020  _.__name__.     
-00003be0: 2020 2020 2020 2069 6620 636f 6e2e 696e         if con.in
-00003bf0: 666f 2e65 6e67 696e 655f 7665 7273 696f  fo.engine_versio
-00003c00: 6e20 3e3d 2033 2e30 3a0a 2020 2020 2020  n >= 3.0:.      
-00003c10: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00003c20: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-00003c30: 636f 6e2e 696e 666f 2c20 6472 6976 6572  con.info, driver
-00003c40: 2e63 6f72 652e 4461 7461 6261 7365 496e  .core.DatabaseIn
-00003c50: 666f 5072 6f76 6964 6572 3329 0a20 2020  foProvider3).   
-00003c60: 2020 2020 2020 2020 2069 6620 636f 6e2e           if con.
-00003c70: 696e 666f 2e65 6e67 696e 655f 7665 7273  info.engine_vers
-00003c80: 696f 6e20 3e3d 2034 2e30 3a0a 2020 2020  ion >= 4.0:.    
-00003c90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00003ca0: 2e61 7373 6572 7449 7349 6e73 7461 6e63  .assertIsInstanc
-00003cb0: 6528 636f 6e2e 696e 666f 2c20 6472 6976  e(con.info, driv
-00003cc0: 6572 2e63 6f72 652e 4461 7461 6261 7365  er.core.Database
-00003cd0: 496e 666f 5072 6f76 6964 6572 290a 2020  InfoProvider).  
-00003ce0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00003cf0: 7373 6572 7449 734e 6f6e 6528 636f 6e2e  ssertIsNone(con.
-00003d00: 6368 6172 7365 7429 0a20 2020 2020 2020  charset).       
-00003d10: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00003d20: 4571 7561 6c28 636f 6e2e 7371 6c5f 6469  Equal(con.sql_di
-00003d30: 616c 6563 742c 2033 290a 2020 2020 2020  alect, 3).      
-00003d40: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00003d50: 7449 6e28 636f 6e2e 6d61 696e 5f74 7261  tIn(con.main_tra
-00003d60: 6e73 6163 7469 6f6e 2c20 636f 6e2e 7472  nsaction, con.tr
-00003d70: 616e 7361 6374 696f 6e73 290a 2020 2020  ansactions).    
-00003d80: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00003d90: 6572 7449 6e28 636f 6e2e 7175 6572 795f  ertIn(con.query_
-00003da0: 7472 616e 7361 6374 696f 6e2c 2063 6f6e  transaction, con
-00003db0: 2e74 7261 6e73 6163 7469 6f6e 7329 0a20  .transactions). 
+000004f0: 0a46 4235 3020 3d20 2735 2e30 270a 0a23  .FB50 = '5.0'..#
+00000500: 2044 6566 6175 6c74 2073 6572 7665 7220   Default server 
+00000510: 686f 7374 0a23 4642 5445 5354 5f48 4f53  host.#FBTEST_HOS
+00000520: 5420 3d20 2727 0a46 4254 4553 545f 484f  T = ''.FBTEST_HO
+00000530: 5354 203d 2027 6c6f 6361 6c68 6f73 7427  ST = 'localhost'
+00000540: 0a23 2044 6566 6175 6c74 2075 7365 720a  .# Default user.
+00000550: 4642 5445 5354 5f55 5345 5220 3d20 2753  FBTEST_USER = 'S
+00000560: 5953 4442 4127 0a23 2044 6566 6175 6c74  YSDBA'.# Default
+00000570: 2075 7365 7220 7061 7373 776f 7264 0a46   user password.F
+00000580: 4254 4553 545f 5041 5353 574f 5244 203d  BTEST_PASSWORD =
+00000590: 2027 6d61 7374 6572 6b65 7927 0a0a 6366   'masterkey'..cf
+000005a0: 6720 3d20 6472 6976 6572 5f63 6f6e 6669  g = driver_confi
+000005b0: 672e 7265 6769 7374 6572 5f73 6572 7665  g.register_serve
+000005c0: 7228 2746 4254 4553 545f 484f 5354 2729  r('FBTEST_HOST')
+000005d0: 0a63 6667 2e68 6f73 742e 7661 6c75 6520  .cfg.host.value 
+000005e0: 3d20 4642 5445 5354 5f48 4f53 540a 6366  = FBTEST_HOST.cf
+000005f0: 672e 7573 6572 2e76 616c 7565 203d 2046  g.user.value = F
+00000600: 4254 4553 545f 5553 4552 0a63 6667 2e70  BTEST_USER.cfg.p
+00000610: 6173 7377 6f72 642e 7661 6c75 6520 3d20  assword.value = 
+00000620: 4642 5445 5354 5f50 4153 5357 4f52 440a  FBTEST_PASSWORD.
+00000630: 0a74 7261 6365 203d 2046 616c 7365 0a0a  .trace = False..
+00000640: 6966 206e 6f74 2073 7973 2e77 6172 6e6f  if not sys.warno
+00000650: 7074 696f 6e73 3a0a 2020 2020 696d 706f  ptions:.    impo
+00000660: 7274 2077 6172 6e69 6e67 730a 2020 2020  rt warnings.    
+00000670: 7761 726e 696e 6773 2e73 696d 706c 6566  warnings.simplef
+00000680: 696c 7465 7228 2261 6c77 6179 7322 2920  ilter("always") 
+00000690: 2320 4368 616e 6765 2074 6865 2066 696c  # Change the fil
+000006a0: 7465 7220 696e 2074 6869 7320 7072 6f63  ter in this proc
+000006b0: 6573 730a 2020 2020 236f 732e 656e 7669  ess.    #os.envi
+000006c0: 726f 6e5b 2250 5954 484f 4e57 4152 4e49  ron["PYTHONWARNI
+000006d0: 4e47 5322 5d20 3d20 2264 6566 6175 6c74  NGS"] = "default
+000006e0: 2220 2320 416c 736f 2061 6666 6563 7420  " # Also affect 
+000006f0: 7375 6270 726f 6365 7373 6573 0a0a 6465  subprocesses..de
+00000700: 6620 6f73 5f65 6e76 6972 6f6e 5f67 6574  f os_environ_get
+00000710: 5f6d 6f63 6b28 6b65 792c 2064 6566 6175  _mock(key, defau
+00000720: 6c74 293a 0a20 2020 2072 6574 7572 6e20  lt):.    return 
+00000730: 6627 4d4f 434b 5f7b 6b65 797d 270a 0a64  f'MOCK_{key}'..d
+00000740: 6566 206c 696e 6573 706c 6974 5f69 7465  ef linesplit_ite
+00000750: 7228 7374 7269 6e67 293a 0a20 2020 2072  r(string):.    r
+00000760: 6574 7572 6e20 286d 2e67 726f 7570 2832  eturn (m.group(2
+00000770: 2920 666f 7220 6d20 696e 2066 696e 6469  ) for m in findi
+00000780: 7465 7228 2728 282e 2a29 5c6e 7c28 2e2b  ter('((.*)\n|(.+
+00000790: 2924 2927 2c20 7374 7269 6e67 2929 0a0a  )$)', string))..
+000007a0: 6465 6620 6974 6572 5f63 6c61 7373 5f70  def iter_class_p
+000007b0: 726f 7065 7274 6965 7328 636c 7329 3a0a  roperties(cls):.
+000007c0: 2020 2020 2222 2249 7465 7261 746f 7220      """Iterator 
+000007d0: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2041  function...    A
+000007e0: 7267 733a 0a20 2020 2020 2020 2063 6c73  rgs:.        cls
+000007f0: 2028 636c 6173 7329 3a20 436c 6173 7320   (class): Class 
+00000800: 6f62 6a65 6374 2e0a 0a20 2020 2059 6965  object...    Yie
+00000810: 6c64 733a 0a20 2020 2020 2020 2060 6e61  lds:.        `na
+00000820: 6d65 272c 2027 7072 6f70 6572 7479 6020  me', 'property` 
+00000830: 7061 6972 7320 666f 7220 616c 6c20 7072  pairs for all pr
+00000840: 6f70 6572 7469 6573 2069 6e20 636c 6173  operties in clas
+00000850: 732e 0a22 2222 0a20 2020 2066 6f72 2076  s..""".    for v
+00000860: 6172 6e61 6d65 2069 6e20 7661 7273 2863  arname in vars(c
+00000870: 6c73 293a 0a20 2020 2020 2020 2076 616c  ls):.        val
+00000880: 7565 203d 2067 6574 6174 7472 2863 6c73  ue = getattr(cls
+00000890: 2c20 7661 726e 616d 6529 0a20 2020 2020  , varname).     
+000008a0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000008b0: 2876 616c 7565 2c20 7072 6f70 6572 7479  (value, property
+000008c0: 293a 0a20 2020 2020 2020 2020 2020 2079  ):.            y
+000008d0: 6965 6c64 2076 6172 6e61 6d65 2c20 7661  ield varname, va
+000008e0: 6c75 650a 0a64 6566 2069 7465 725f 636c  lue..def iter_cl
+000008f0: 6173 735f 7661 7269 6162 6c65 7328 636c  ass_variables(cl
+00000900: 7329 3a0a 2020 2020 2222 2249 7465 7261  s):.    """Itera
+00000910: 746f 7220 6675 6e63 7469 6f6e 2e0a 0a20  tor function... 
+00000920: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00000930: 2063 6c73 2028 636c 6173 7329 3a20 436c   cls (class): Cl
+00000940: 6173 7320 6f62 6a65 6374 2e0a 0a20 2020  ass object...   
+00000950: 2059 6965 6c64 733a 0a20 2020 2020 2020   Yields:.       
+00000960: 204e 616d 6573 206f 6620 616c 6c20 6e6f   Names of all no
+00000970: 6e2d 6361 6c6c 6162 6c65 2061 7474 7269  n-callable attri
+00000980: 6275 7465 7320 696e 2063 6c61 7373 2e0a  butes in class..
+00000990: 2222 220a 2020 2020 666f 7220 7661 726e  """.    for varn
+000009a0: 616d 6520 696e 2076 6172 7328 636c 7329  ame in vars(cls)
+000009b0: 3a0a 2020 2020 2020 2020 7661 6c75 6520  :.        value 
+000009c0: 3d20 6765 7461 7474 7228 636c 732c 2076  = getattr(cls, v
+000009d0: 6172 6e61 6d65 290a 2020 2020 2020 2020  arname).        
+000009e0: 6966 206e 6f74 2028 6973 696e 7374 616e  if not (isinstan
+000009f0: 6365 2876 616c 7565 2c20 7072 6f70 6572  ce(value, proper
+00000a00: 7479 2920 6f72 2063 616c 6c61 626c 6528  ty) or callable(
+00000a10: 7661 6c75 6529 2920 616e 6420 6e6f 7420  value)) and not 
+00000a20: 7661 726e 616d 652e 7374 6172 7473 7769  varname.startswi
+00000a30: 7468 2827 5f27 293a 0a20 2020 2020 2020  th('_'):.       
+00000a40: 2020 2020 2079 6965 6c64 2076 6172 6e61       yield varna
+00000a50: 6d65 0a0a 0a63 6c61 7373 2044 7269 7665  me...class Drive
+00000a60: 7254 6573 7442 6173 6528 756e 6974 7465  rTestBase(unitte
+00000a70: 7374 2e54 6573 7443 6173 652c 204c 6f67  st.TestCase, Log
+00000a80: 6769 6e67 4964 4d69 7869 6e29 3a0a 2020  gingIdMixin):.  
+00000a90: 2020 6465 6620 7365 7455 7028 7365 6c66    def setUp(self
+00000aa0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00000ab0: 2020 2073 7570 6572 2829 2e73 6574 5570     super().setUp
+00000ac0: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00000ad0: 6f75 7470 7574 203d 2053 7472 696e 6749  output = StringI
+00000ae0: 4f28 290a 2020 2020 2020 2020 696e 7374  O().        inst
+00000af0: 616c 6c5f 6e75 6c6c 5f6c 6f67 6765 7228  all_null_logger(
+00000b00: 290a 2020 2020 2020 2020 6966 2074 7261  ).        if tra
+00000b10: 6365 206f 7220 6f73 2e67 6574 656e 7628  ce or os.getenv(
+00000b20: 2744 5249 5645 525f 5452 4143 4527 2920  'DRIVER_TRACE') 
+00000b30: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00000b40: 2020 2020 2020 2020 2073 656c 662e 6d6e           self.mn
+00000b50: 6772 203d 206c 6f67 6769 6e67 5f6d 616e  gr = logging_man
+00000b60: 6167 6572 0a20 2020 2020 2020 2020 2020  ager.           
+00000b70: 2023 7365 6c66 2e6d 6e67 722e 7472 6163   #self.mngr.trac
+00000b80: 6520 7c3d 2054 7261 6365 466c 6167 2e42  e |= TraceFlag.B
+00000b90: 4546 4f52 450a 2020 2020 2020 2020 2020  EFORE.          
+00000ba0: 2020 2373 656c 662e 6d6e 6772 2e74 7261    #self.mngr.tra
+00000bb0: 6365 207c 3d20 5472 6163 6546 6c61 672e  ce |= TraceFlag.
+00000bc0: 4146 5445 520a 2020 2020 2020 2020 2020  AFTER.          
+00000bd0: 2020 7365 6c66 2e6d 6e67 722e 6269 6e64    self.mngr.bind
+00000be0: 5f6c 6f67 6765 7228 414e 592c 2041 4e59  _logger(ANY, ANY
+00000bf0: 2c20 2727 2c20 2774 7261 6365 2729 0a20  , '', 'trace'). 
+00000c00: 2020 2020 2020 2020 2020 2073 6820 3d20             sh = 
+00000c10: 5374 7265 616d 4861 6e64 6c65 7228 7379  StreamHandler(sy
+00000c20: 732e 7374 646f 7574 290a 2020 2020 2020  s.stdout).      
+00000c30: 2020 2020 2020 7368 2e73 6574 466f 726d        sh.setForm
+00000c40: 6174 7465 7228 466f 726d 6174 7465 7228  atter(Formatter(
+00000c50: 275b 2528 636f 6e74 6578 7429 735d 2025  '[%(context)s] %
+00000c60: 2861 6765 6e74 2973 3a20 2528 6d65 7373  (agent)s: %(mess
+00000c70: 6167 6529 7327 2929 0a20 2020 2020 2020  age)s')).       
+00000c80: 2020 2020 206c 6f67 6765 7220 3d20 6765       logger = ge
+00000c90: 744c 6f67 6765 7228 290a 2020 2020 2020  tLogger().      
+00000ca0: 2020 2020 2020 6c6f 6767 6572 2e73 6574        logger.set
+00000cb0: 4c65 7665 6c28 4445 4255 4729 0a20 2020  Level(DEBUG).   
+00000cc0: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+00000cd0: 6164 6448 616e 646c 6572 2873 6829 0a20  addHandler(sh). 
+00000ce0: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
+00000cf0: 2077 6974 6820 636f 6e6e 6563 745f 7365   with connect_se
+00000d00: 7276 6572 2846 4254 4553 545f 484f 5354  rver(FBTEST_HOST
+00000d10: 2c20 7573 6572 3d46 4254 4553 545f 5553  , user=FBTEST_US
+00000d20: 4552 2c20 7061 7373 776f 7264 3d46 4254  ER, password=FBT
+00000d30: 4553 545f 5041 5353 574f 5244 2920 6173  EST_PASSWORD) as
+00000d40: 2073 7663 3a0a 2020 2020 2020 2020 2020   svc:.          
+00000d50: 2020 7365 6c66 2e76 6572 7369 6f6e 203d    self.version =
+00000d60: 2073 7663 2e69 6e66 6f2e 7665 7273 696f   svc.info.versio
+00000d70: 6e0a 2020 2020 2020 2020 6966 2073 656c  n.        if sel
+00000d80: 662e 7665 7273 696f 6e2e 7374 6172 7473  f.version.starts
+00000d90: 7769 7468 2846 4233 3029 3a0a 2020 2020  with(FB30):.    
+00000da0: 2020 2020 2020 2020 7365 6c66 2e46 4254          self.FBT
+00000db0: 4553 545f 4442 203d 2027 6662 7465 7374  EST_DB = 'fbtest
+00000dc0: 3330 2e66 6462 270a 2020 2020 2020 2020  30.fdb'.        
+00000dd0: 2020 2020 7365 6c66 2e76 6572 7369 6f6e      self.version
+00000de0: 203d 2046 4233 300a 2020 2020 2020 2020   = FB30.        
+00000df0: 656c 6966 2073 656c 662e 7665 7273 696f  elif self.versio
+00000e00: 6e2e 7374 6172 7473 7769 7468 2846 4234  n.startswith(FB4
+00000e10: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+00000e20: 7365 6c66 2e46 4254 4553 545f 4442 203d  self.FBTEST_DB =
+00000e30: 2027 6662 7465 7374 3430 2e66 6462 270a   'fbtest40.fdb'.
+00000e40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00000e50: 2e76 6572 7369 6f6e 203d 2046 4234 300a  .version = FB40.
+00000e60: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00000e70: 662e 7665 7273 696f 6e2e 7374 6172 7473  f.version.starts
+00000e80: 7769 7468 2846 4235 3029 3a0a 2020 2020  with(FB50):.    
+00000e90: 2020 2020 2020 2020 7365 6c66 2e46 4254          self.FBT
+00000ea0: 4553 545f 4442 203d 2027 6662 7465 7374  EST_DB = 'fbtest
+00000eb0: 3530 2e66 6462 270a 2020 2020 2020 2020  50.fdb'.        
+00000ec0: 2020 2020 7365 6c66 2e76 6572 7369 6f6e      self.version
+00000ed0: 203d 2046 4235 300a 2020 2020 2020 2020   = FB50.        
+00000ee0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00000ef0: 2020 7261 6973 6520 4578 6365 7074 696f    raise Exceptio
+00000f00: 6e28 2255 6e73 7570 706f 7274 6564 2046  n("Unsupported F
+00000f10: 6972 6562 6972 6420 7665 7273 696f 6e20  irebird version 
+00000f20: 2825 7329 2220 2520 7365 6c66 2e76 6572  (%s)" % self.ver
+00000f30: 7369 6f6e 290a 2020 2020 2020 2020 230a  sion).        #.
+00000f40: 2020 2020 2020 2020 7365 6c66 2e63 7764          self.cwd
+00000f50: 203d 206f 732e 6765 7463 7764 2829 0a20   = os.getcwd(). 
+00000f60: 2020 2020 2020 2073 656c 662e 6462 7061         self.dbpa
+00000f70: 7468 203d 2073 656c 662e 6377 6420 6966  th = self.cwd if
+00000f80: 206f 732e 7061 7468 2e73 706c 6974 2873   os.path.split(s
+00000f90: 656c 662e 6377 6429 5b31 5d20 3d3d 2027  elf.cwd)[1] == '
+00000fa0: 7465 7374 2720 5c0a 2020 2020 2020 2020  test' \.        
+00000fb0: 2020 2020 656c 7365 206f 732e 7061 7468      else os.path
+00000fc0: 2e6a 6f69 6e28 7365 6c66 2e63 7764 2c20  .join(self.cwd, 
+00000fd0: 2774 6573 7427 290a 2020 2020 6465 6620  'test').    def 
+00000fe0: 636c 6561 725f 6f75 7470 7574 2873 656c  clear_output(sel
+00000ff0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+00001000: 2020 2020 7365 6c66 2e6f 7574 7075 742e      self.output.
+00001010: 636c 6f73 6528 290a 2020 2020 2020 2020  close().        
+00001020: 7365 6c66 2e6f 7574 7075 7420 3d20 5374  self.output = St
+00001030: 7269 6e67 494f 2829 0a20 2020 2064 6566  ringIO().    def
+00001040: 2073 686f 775f 6f75 7470 7574 2873 656c   show_output(sel
+00001050: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+00001060: 2020 2020 7379 732e 7374 646f 7574 2e77      sys.stdout.w
+00001070: 7269 7465 2873 656c 662e 6f75 7470 7574  rite(self.output
+00001080: 2e67 6574 7661 6c75 6528 2929 0a20 2020  .getvalue()).   
+00001090: 2020 2020 2073 7973 2e73 7464 6f75 742e       sys.stdout.
+000010a0: 666c 7573 6828 290a 2020 2020 6465 6620  flush().    def 
+000010b0: 7072 696e 746f 7574 2873 656c 662c 2074  printout(self, t
+000010c0: 6578 743a 2073 7472 203d 2027 272c 206e  ext: str = '', n
+000010d0: 6577 6c69 6e65 3a20 626f 6f6c 203d 2054  ewline: bool = T
+000010e0: 7275 652c 206e 6f5f 7273 7472 6970 3a20  rue, no_rstrip: 
+000010f0: 626f 6f6c 203d 2046 616c 7365 2920 2d3e  bool = False) ->
+00001100: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
+00001110: 6620 6e6f 5f72 7374 7269 703a 0a20 2020  f no_rstrip:.   
+00001120: 2020 2020 2020 2020 2073 656c 662e 6f75           self.ou
+00001130: 7470 7574 2e77 7269 7465 2874 6578 7429  tput.write(text)
+00001140: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00001150: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001160: 6f75 7470 7574 2e77 7269 7465 2874 6578  output.write(tex
+00001170: 742e 7273 7472 6970 2829 290a 2020 2020  t.rstrip()).    
+00001180: 2020 2020 6966 206e 6577 6c69 6e65 3a0a      if newline:.
+00001190: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000011a0: 2e6f 7574 7075 742e 7772 6974 6528 275c  .output.write('\
+000011b0: 6e27 290a 2020 2020 2020 2020 7365 6c66  n').        self
+000011c0: 2e6f 7574 7075 742e 666c 7573 6828 290a  .output.flush().
+000011d0: 2020 2020 6465 6620 7072 696e 7444 6174      def printDat
+000011e0: 6128 7365 6c66 2c20 6375 722c 2070 7269  a(self, cur, pri
+000011f0: 6e74 5f68 6561 6465 723d 5472 7565 293a  nt_header=True):
+00001200: 0a20 2020 2020 2020 2022 2222 5072 696e  .        """Prin
+00001210: 7420 6461 7461 2066 726f 6d20 6f70 656e  t data from open
+00001220: 2063 7572 736f 7220 746f 2073 7464 6f75   cursor to stdou
+00001230: 742e 2222 220a 2020 2020 2020 2020 6966  t.""".        if
+00001240: 2070 7269 6e74 5f68 6561 6465 723a 0a20   print_header:. 
+00001250: 2020 2020 2020 2020 2020 2023 2050 7269             # Pri
+00001260: 6e74 2061 2068 6561 6465 722e 0a20 2020  nt a header..   
+00001270: 2020 2020 2020 2020 206c 696e 6520 3d20           line = 
+00001280: 5b5d 0a20 2020 2020 2020 2020 2020 2066  [].            f
+00001290: 6f72 2066 6965 6c64 4465 7363 2069 6e20  or fieldDesc in 
+000012a0: 6375 722e 6465 7363 7269 7074 696f 6e3a  cur.description:
+000012b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000012c0: 206c 696e 652e 6170 7065 6e64 2866 6965   line.append(fie
+000012d0: 6c64 4465 7363 5b44 4553 4352 4950 5449  ldDesc[DESCRIPTI
+000012e0: 4f4e 5f4e 414d 455d 2e6c 6a75 7374 2866  ON_NAME].ljust(f
+000012f0: 6965 6c64 4465 7363 5b44 4553 4352 4950  ieldDesc[DESCRIP
+00001300: 5449 4f4e 5f44 4953 504c 4159 5f53 495a  TION_DISPLAY_SIZ
+00001310: 455d 2929 0a20 2020 2020 2020 2020 2020  E])).           
+00001320: 2073 656c 662e 7072 696e 746f 7574 2827   self.printout('
+00001330: 2027 2e6a 6f69 6e28 6c69 6e65 2929 0a20   '.join(line)). 
+00001340: 2020 2020 2020 2020 2020 206c 696e 6520             line 
+00001350: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+00001360: 2066 6f72 2066 6965 6c64 4465 7363 2069   for fieldDesc i
+00001370: 6e20 6375 722e 6465 7363 7269 7074 696f  n cur.descriptio
+00001380: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+00001390: 2020 206c 696e 652e 6170 7065 6e64 2822     line.append("
+000013a0: 2d22 202a 206d 6178 2828 6c65 6e28 6669  -" * max((len(fi
+000013b0: 656c 6444 6573 635b 4445 5343 5249 5054  eldDesc[DESCRIPT
+000013c0: 494f 4e5f 4e41 4d45 5d29 2c20 6669 656c  ION_NAME]), fiel
+000013d0: 6444 6573 635b 4445 5343 5249 5054 494f  dDesc[DESCRIPTIO
+000013e0: 4e5f 4449 5350 4c41 595f 5349 5a45 5d29  N_DISPLAY_SIZE])
+000013f0: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
+00001400: 656c 662e 7072 696e 746f 7574 2827 2027  elf.printout(' '
+00001410: 2e6a 6f69 6e28 6c69 6e65 2929 0a20 2020  .join(line)).   
+00001420: 2020 2020 2023 2046 6f72 2065 6163 6820       # For each 
+00001430: 726f 772c 2070 7269 6e74 2074 6865 2076  row, print the v
+00001440: 616c 7565 206f 6620 6561 6368 2066 6965  alue of each fie
+00001450: 6c64 206c 6566 742d 6a75 7374 6966 6965  ld left-justifie
+00001460: 6420 7769 7468 696e 0a20 2020 2020 2020  d within.       
+00001470: 2023 2074 6865 206d 6178 696d 756d 2070   # the maximum p
+00001480: 6f73 7369 626c 6520 7769 6474 6820 6f66  ossible width of
+00001490: 2074 6861 7420 6669 656c 642e 0a20 2020   that field..   
+000014a0: 2020 2020 2066 6965 6c64 496e 6469 6365       fieldIndice
+000014b0: 7320 3d20 7261 6e67 6528 6c65 6e28 6375  s = range(len(cu
+000014c0: 722e 6465 7363 7269 7074 696f 6e29 290a  r.description)).
+000014d0: 2020 2020 2020 2020 666f 7220 726f 7720          for row 
+000014e0: 696e 2063 7572 3a0a 2020 2020 2020 2020  in cur:.        
+000014f0: 2020 2020 6c69 6e65 203d 205b 5d0a 2020      line = [].  
+00001500: 2020 2020 2020 2020 2020 666f 7220 6669            for fi
+00001510: 656c 6449 6e64 6578 2069 6e20 6669 656c  eldIndex in fiel
+00001520: 6449 6e64 6963 6573 3a0a 2020 2020 2020  dIndices:.      
+00001530: 2020 2020 2020 2020 2020 6669 656c 6456            fieldV
+00001540: 616c 7565 203d 2073 7472 2872 6f77 5b66  alue = str(row[f
+00001550: 6965 6c64 496e 6465 785d 290a 2020 2020  ieldIndex]).    
+00001560: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
+00001570: 644d 6178 5769 6474 6820 3d20 6d61 7828  dMaxWidth = max(
+00001580: 286c 656e 2863 7572 2e64 6573 6372 6970  (len(cur.descrip
+00001590: 7469 6f6e 5b66 6965 6c64 496e 6465 785d  tion[fieldIndex]
+000015a0: 5b44 4553 4352 4950 5449 4f4e 5f4e 414d  [DESCRIPTION_NAM
+000015b0: 455d 292c 2063 7572 2e64 6573 6372 6970  E]), cur.descrip
+000015c0: 7469 6f6e 5b66 6965 6c64 496e 6465 785d  tion[fieldIndex]
+000015d0: 5b44 4553 4352 4950 5449 4f4e 5f44 4953  [DESCRIPTION_DIS
+000015e0: 504c 4159 5f53 495a 455d 2929 0a20 2020  PLAY_SIZE])).   
+000015f0: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+00001600: 652e 6170 7065 6e64 2866 6965 6c64 5661  e.append(fieldVa
+00001610: 6c75 652e 6c6a 7573 7428 6669 656c 644d  lue.ljust(fieldM
+00001620: 6178 5769 6474 6829 290a 2020 2020 2020  axWidth)).      
+00001630: 2020 2020 2020 7365 6c66 2e70 7269 6e74        self.print
+00001640: 6f75 7428 2720 272e 6a6f 696e 286c 696e  out(' '.join(lin
+00001650: 6529 290a 0a63 6c61 7373 2054 6573 7443  e))..class TestC
+00001660: 7265 6174 6544 726f 7028 4472 6976 6572  reateDrop(Driver
+00001670: 5465 7374 4261 7365 293a 0a20 2020 2064  TestBase):.    d
+00001680: 6566 2073 6574 5570 2873 656c 6629 3a0a  ef setUp(self):.
+00001690: 2020 2020 2020 2020 7375 7065 7228 292e          super().
+000016a0: 7365 7455 7028 290a 2020 2020 2020 2020  setUp().        
+000016b0: 7365 6c66 2e64 6266 696c 6520 3d20 6f73  self.dbfile = os
+000016c0: 2e70 6174 682e 6a6f 696e 2873 656c 662e  .path.join(self.
+000016d0: 6462 7061 7468 2c20 2764 726f 7074 6573  dbpath, 'droptes
+000016e0: 742e 6664 6227 290a 2020 2020 2020 2020  t.fdb').        
+000016f0: 6966 206f 732e 7061 7468 2e65 7869 7374  if os.path.exist
+00001700: 7328 7365 6c66 2e64 6266 696c 6529 3a0a  s(self.dbfile):.
+00001710: 2020 2020 2020 2020 2020 2020 6f73 2e72              os.r
+00001720: 656d 6f76 6528 7365 6c66 2e64 6266 696c  emove(self.dbfil
+00001730: 6529 0a20 2020 2064 6566 2074 6573 745f  e).    def test_
+00001740: 6372 6561 7465 5f64 726f 705f 6473 6e28  create_drop_dsn(
+00001750: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
+00001760: 6974 6820 6372 6561 7465 5f64 6174 6162  ith create_datab
+00001770: 6173 6528 7365 6c66 2e64 6266 696c 652c  ase(self.dbfile,
+00001780: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
+00001790: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
+000017a0: 5354 5f50 4153 5357 4f52 4429 2061 7320  ST_PASSWORD) as 
+000017b0: 636f 6e3a 0a20 2020 2020 2020 2020 2020  con:.           
+000017c0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000017d0: 6c28 636f 6e2e 6473 6e2c 2073 656c 662e  l(con.dsn, self.
+000017e0: 6462 6669 6c65 290a 2020 2020 2020 2020  dbfile).        
+000017f0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00001800: 7175 616c 2863 6f6e 2e73 716c 5f64 6961  qual(con.sql_dia
+00001810: 6c65 6374 2c20 3329 0a20 2020 2020 2020  lect, 3).       
+00001820: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00001830: 4571 7561 6c28 636f 6e2e 6368 6172 7365  Equal(con.charse
+00001840: 742c 204e 6f6e 6529 0a20 2020 2020 2020  t, None).       
+00001850: 2020 2020 2063 6f6e 2e64 726f 705f 6461       con.drop_da
+00001860: 7461 6261 7365 2829 0a20 2020 2020 2020  tabase().       
+00001870: 2023 204f 7665 7277 7269 7465 0a20 2020   # Overwrite.   
+00001880: 2020 2020 2077 6974 6820 6372 6561 7465       with create
+00001890: 5f64 6174 6162 6173 6528 7365 6c66 2e64  _database(self.d
+000018a0: 6266 696c 652c 2075 7365 723d 4642 5445  bfile, user=FBTE
+000018b0: 5354 5f55 5345 522c 2070 6173 7377 6f72  ST_USER, passwor
+000018c0: 643d 4642 5445 5354 5f50 4153 5357 4f52  d=FBTEST_PASSWOR
+000018d0: 4429 2061 7320 636f 6e3a 0a20 2020 2020  D) as con:.     
+000018e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000018f0: 7274 4571 7561 6c28 636f 6e2e 6473 6e2c  rtEqual(con.dsn,
+00001900: 2073 656c 662e 6462 6669 6c65 290a 2020   self.dbfile).  
+00001910: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00001920: 7373 6572 7445 7175 616c 2863 6f6e 2e73  ssertEqual(con.s
+00001930: 716c 5f64 6961 6c65 6374 2c20 3329 0a20  ql_dialect, 3). 
+00001940: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001950: 6173 7365 7274 4571 7561 6c28 636f 6e2e  assertEqual(con.
+00001960: 6368 6172 7365 742c 204e 6f6e 6529 0a20  charset, None). 
+00001970: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
+00001980: 2e61 7373 6572 7452 6169 7365 7328 4461  .assertRaises(Da
+00001990: 7461 6261 7365 4572 726f 7229 2061 7320  tabaseError) as 
+000019a0: 636d 3a0a 2020 2020 2020 2020 2020 2020  cm:.            
+000019b0: 6372 6561 7465 5f64 6174 6162 6173 6528  create_database(
+000019c0: 7365 6c66 2e64 6266 696c 652c 2075 7365  self.dbfile, use
+000019d0: 723d 4642 5445 5354 5f55 5345 522c 2070  r=FBTEST_USER, p
+000019e0: 6173 7377 6f72 643d 4642 5445 5354 5f50  assword=FBTEST_P
+000019f0: 4153 5357 4f52 4429 0a20 2020 2020 2020  ASSWORD).       
+00001a00: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00001a10: 2827 6578 6973 7427 2069 6e20 636d 2e65  ('exist' in cm.e
+00001a20: 7863 6570 7469 6f6e 2e61 7267 735b 305d  xception.args[0]
+00001a30: 290a 2020 2020 2020 2020 7769 7468 2063  ).        with c
+00001a40: 7265 6174 655f 6461 7461 6261 7365 2873  reate_database(s
+00001a50: 656c 662e 6462 6669 6c65 2c20 7573 6572  elf.dbfile, user
+00001a60: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
+00001a70: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+00001a80: 5353 574f 5244 2c20 6f76 6572 7772 6974  SSWORD, overwrit
+00001a90: 653d 5472 7565 2920 6173 2063 6f6e 3a0a  e=True) as con:.
+00001aa0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001ab0: 2e61 7373 6572 7445 7175 616c 2863 6f6e  .assertEqual(con
+00001ac0: 2e64 736e 2c20 7365 6c66 2e64 6266 696c  .dsn, self.dbfil
+00001ad0: 6529 0a20 2020 2020 2020 2020 2020 2063  e).            c
+00001ae0: 6f6e 2e64 726f 705f 6461 7461 6261 7365  on.drop_database
+00001af0: 2829 0a20 2020 2064 6566 2074 6573 745f  ().    def test_
+00001b00: 6372 6561 7465 5f64 726f 705f 636f 6e66  create_drop_conf
+00001b10: 6967 2873 656c 6629 3a0a 2020 2020 2020  ig(self):.      
+00001b20: 2020 6462 5f63 6f6e 6669 6720 3d20 6622    db_config = f"
+00001b30: 2222 0a20 2020 2020 2020 205b 7465 7374  "".        [test
+00001b40: 5f64 6232 5d0a 2020 2020 2020 2020 6461  _db2].        da
+00001b50: 7461 6261 7365 203d 207b 7365 6c66 2e64  tabase = {self.d
+00001b60: 6266 696c 657d 0a20 2020 2020 2020 2075  bfile}.        u
+00001b70: 7365 7220 3d20 7b46 4254 4553 545f 5553  ser = {FBTEST_US
+00001b80: 4552 7d0a 2020 2020 2020 2020 7061 7373  ER}.        pass
+00001b90: 776f 7264 203d 207b 4642 5445 5354 5f50  word = {FBTEST_P
+00001ba0: 4153 5357 4f52 447d 0a20 2020 2020 2020  ASSWORD}.       
+00001bb0: 2075 7466 3866 696c 656e 616d 6520 3d20   utf8filename = 
+00001bc0: 7472 7565 0a20 2020 2020 2020 2063 6861  true.        cha
+00001bd0: 7273 6574 203d 2055 5446 380a 2020 2020  rset = UTF8.    
+00001be0: 2020 2020 7371 6c5f 6469 616c 6563 7420      sql_dialect 
+00001bf0: 3d20 310a 2020 2020 2020 2020 7061 6765  = 1.        page
+00001c00: 5f73 697a 6520 3d20 7b74 7970 6573 2e50  _size = {types.P
+00001c10: 6167 6553 697a 652e 5041 4745 5f31 364b  ageSize.PAGE_16K
+00001c20: 7d0a 2020 2020 2020 2020 6462 5f63 6861  }.        db_cha
+00001c30: 7273 6574 203d 2055 5446 380a 2020 2020  rset = UTF8.    
+00001c40: 2020 2020 6462 5f73 716c 5f64 6961 6c65      db_sql_diale
+00001c50: 6374 203d 2031 0a20 2020 2020 2020 2073  ct = 1.        s
+00001c60: 7765 6570 5f69 6e74 6572 7661 6c20 3d20  weep_interval = 
+00001c70: 300a 2020 2020 2020 2020 2222 220a 2020  0.        """.  
+00001c80: 2020 2020 2020 6472 6976 6572 5f63 6f6e        driver_con
+00001c90: 6669 672e 7265 6769 7374 6572 5f64 6174  fig.register_dat
+00001ca0: 6162 6173 6528 2774 6573 745f 6462 3227  abase('test_db2'
+00001cb0: 2c20 6462 5f63 6f6e 6669 6729 0a20 2020  , db_config).   
+00001cc0: 2020 2020 2023 0a20 2020 2020 2020 2077       #.        w
+00001cd0: 6974 6820 6372 6561 7465 5f64 6174 6162  ith create_datab
+00001ce0: 6173 6528 2774 6573 745f 6462 3227 2920  ase('test_db2') 
+00001cf0: 6173 2063 6f6e 3a0a 2020 2020 2020 2020  as con:.        
+00001d00: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00001d10: 7175 616c 2863 6f6e 2e73 716c 5f64 6961  qual(con.sql_dia
+00001d20: 6c65 6374 2c20 3129 0a20 2020 2020 2020  lect, 1).       
+00001d30: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00001d40: 4571 7561 6c28 636f 6e2e 6368 6172 7365  Equal(con.charse
+00001d50: 742c 2027 5554 4638 2729 0a20 2020 2020  t, 'UTF8').     
+00001d60: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00001d70: 7274 4571 7561 6c28 636f 6e2e 696e 666f  rtEqual(con.info
+00001d80: 2e70 6167 655f 7369 7a65 2c20 3136 3338  .page_size, 1638
+00001d90: 3429 0a20 2020 2020 2020 2020 2020 2073  4).            s
+00001da0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00001db0: 636f 6e2e 696e 666f 2e73 716c 5f64 6961  con.info.sql_dia
+00001dc0: 6c65 6374 2c20 3129 0a20 2020 2020 2020  lect, 1).       
+00001dd0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00001de0: 4571 7561 6c28 636f 6e2e 696e 666f 2e63  Equal(con.info.c
+00001df0: 6861 7273 6574 2c20 2755 5446 3827 290a  harset, 'UTF8').
+00001e00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001e10: 2e61 7373 6572 7445 7175 616c 2863 6f6e  .assertEqual(con
+00001e20: 2e69 6e66 6f2e 7377 6565 705f 696e 7465  .info.sweep_inte
+00001e30: 7276 616c 2c20 3029 0a20 2020 2020 2020  rval, 0).       
+00001e40: 2020 2020 2063 6f6e 2e64 726f 705f 6461       con.drop_da
+00001e50: 7461 6261 7365 2829 0a0a 636c 6173 7320  tabase()..class 
+00001e60: 5465 7374 436f 6e6e 6563 7469 6f6e 2844  TestConnection(D
+00001e70: 7269 7665 7254 6573 7442 6173 6529 3a0a  riverTestBase):.
+00001e80: 2020 2020 6465 6620 7365 7455 7028 7365      def setUp(se
+00001e90: 6c66 293a 0a20 2020 2020 2020 2073 7570  lf):.        sup
+00001ea0: 6572 2829 2e73 6574 5570 2829 0a20 2020  er().setUp().   
+00001eb0: 2020 2020 2073 656c 662e 6462 6669 6c65       self.dbfile
+00001ec0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
+00001ed0: 7365 6c66 2e64 6270 6174 682c 2073 656c  self.dbpath, sel
+00001ee0: 662e 4642 5445 5354 5f44 4229 0a20 2020  f.FBTEST_DB).   
+00001ef0: 2064 6566 2074 6561 7244 6f77 6e28 7365   def tearDown(se
+00001f00: 6c66 293a 0a20 2020 2020 2020 2070 6173  lf):.        pas
+00001f10: 730a 2020 2020 6465 6620 7465 7374 5f63  s.    def test_c
+00001f20: 6f6e 6e65 6374 5f68 656c 7065 7228 7365  onnect_helper(se
+00001f30: 6c66 293a 0a20 2020 2020 2020 2044 425f  lf):.        DB_
+00001f40: 4c49 4e55 585f 5041 5448 203d 2027 2f70  LINUX_PATH = '/p
+00001f50: 6174 682f 746f 2f64 622f 656d 706c 6f79  ath/to/db/employ
+00001f60: 6565 2e66 6462 270a 2020 2020 2020 2020  ee.fdb'.        
+00001f70: 4442 5f57 494e 5f50 4154 4820 3d20 2743  DB_WIN_PATH = 'C
+00001f80: 3a5c 5c70 6174 685c 5c74 6f5c 5c64 625c  :\\path\\to\\db\
+00001f90: 5c65 6d70 6c6f 7965 652e 6664 6227 0a20  \employee.fdb'. 
+00001fa0: 2020 2020 2020 2044 425f 414c 4941 5320         DB_ALIAS 
+00001fb0: 3d20 2765 6d70 6c6f 7965 6527 0a20 2020  = 'employee'.   
+00001fc0: 2020 2020 2048 4f53 5420 3d20 276c 6f63       HOST = 'loc
+00001fd0: 616c 686f 7374 270a 2020 2020 2020 2020  alhost'.        
+00001fe0: 4e50 4950 455f 484f 5354 203d 2027 5c5c  NPIPE_HOST = '\\
+00001ff0: 5c5c 4d79 5365 7276 6572 270a 2020 2020  \\MyServer'.    
+00002000: 2020 2020 4950 203d 2027 3132 372e 302e      IP = '127.0.
+00002010: 302e 3127 0a20 2020 2020 2020 2050 4f52  0.1'.        POR
+00002020: 5420 3d20 2733 3035 3127 0a20 2020 2020  T = '3051'.     
+00002030: 2020 2053 5643 5f4e 414d 4520 3d20 2766     SVC_NAME = 'f
+00002040: 625f 7372 7627 0a20 2020 2020 2020 2023  b_srv'.        #
+00002050: 2043 6c61 7373 6963 2044 534e 2028 7769   Classic DSN (wi
+00002060: 7468 6f75 7420 7072 6f74 6f63 6f6c 290a  thout protocol).
+00002070: 2020 2020 2020 2020 2320 312e 204c 6f63          # 1. Loc
+00002080: 616c 2063 6f6e 6e65 6374 696f 6e0a 2020  al connection.  
+00002090: 2020 2020 2020 6473 6e20 3d20 6472 6976        dsn = driv
+000020a0: 6572 2e63 6f72 652e 5f63 6f6e 6e65 6374  er.core._connect
+000020b0: 5f68 656c 7065 7228 4e6f 6e65 2c20 4e6f  _helper(None, No
+000020c0: 6e65 2c20 4e6f 6e65 2c20 4442 5f41 4c49  ne, None, DB_ALI
+000020d0: 4153 2c20 4e6f 6e65 290a 2020 2020 2020  AS, None).      
+000020e0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+000020f0: 616c 2864 736e 2c20 4442 5f41 4c49 4153  al(dsn, DB_ALIAS
+00002100: 290a 2020 2020 2020 2020 6473 6e20 3d20  ).        dsn = 
+00002110: 6472 6976 6572 2e63 6f72 652e 5f63 6f6e  driver.core._con
+00002120: 6e65 6374 5f68 656c 7065 7228 4e6f 6e65  nect_helper(None
+00002130: 2c20 4e6f 6e65 2c20 4e6f 6e65 2c20 4442  , None, None, DB
+00002140: 5f4c 494e 5558 5f50 4154 482c 204e 6f6e  _LINUX_PATH, Non
+00002150: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+00002160: 6173 7365 7274 4571 7561 6c28 6473 6e2c  assertEqual(dsn,
+00002170: 2044 425f 4c49 4e55 585f 5041 5448 290a   DB_LINUX_PATH).
+00002180: 2020 2020 2020 2020 6473 6e20 3d20 6472          dsn = dr
+00002190: 6976 6572 2e63 6f72 652e 5f63 6f6e 6e65  iver.core._conne
+000021a0: 6374 5f68 656c 7065 7228 4e6f 6e65 2c20  ct_helper(None, 
+000021b0: 4e6f 6e65 2c20 4e6f 6e65 2c20 4442 5f57  None, None, DB_W
+000021c0: 494e 5f50 4154 482c 204e 6f6e 6529 0a20  IN_PATH, None). 
+000021d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000021e0: 7274 4571 7561 6c28 6473 6e2c 2044 425f  rtEqual(dsn, DB_
+000021f0: 5749 4e5f 5041 5448 290a 2020 2020 2020  WIN_PATH).      
+00002200: 2020 2320 322e 2054 4350 2f49 500a 2020    # 2. TCP/IP.  
+00002210: 2020 2020 2020 6473 6e20 3d20 6472 6976        dsn = driv
+00002220: 6572 2e63 6f72 652e 5f63 6f6e 6e65 6374  er.core._connect
+00002230: 5f68 656c 7065 7228 4e6f 6e65 2c20 484f  _helper(None, HO
+00002240: 5354 2c20 4e6f 6e65 2c20 4442 5f41 4c49  ST, None, DB_ALI
+00002250: 4153 2c20 4e6f 6e65 290a 2020 2020 2020  AS, None).      
+00002260: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00002270: 616c 2864 736e 2c20 6627 7b48 4f53 547d  al(dsn, f'{HOST}
+00002280: 3a7b 4442 5f41 4c49 4153 7d27 290a 2020  :{DB_ALIAS}').  
+00002290: 2020 2020 2020 6473 6e20 3d20 6472 6976        dsn = driv
+000022a0: 6572 2e63 6f72 652e 5f63 6f6e 6e65 6374  er.core._connect
+000022b0: 5f68 656c 7065 7228 4e6f 6e65 2c20 4950  _helper(None, IP
+000022c0: 2c20 4e6f 6e65 2c20 4442 5f4c 494e 5558  , None, DB_LINUX
+000022d0: 5f50 4154 482c 204e 6f6e 6529 0a20 2020  _PATH, None).   
+000022e0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000022f0: 4571 7561 6c28 6473 6e2c 2066 277b 4950  Equal(dsn, f'{IP
+00002300: 7d3a 7b44 425f 4c49 4e55 585f 5041 5448  }:{DB_LINUX_PATH
+00002310: 7d27 290a 2020 2020 2020 2020 6473 6e20  }').        dsn 
+00002320: 3d20 6472 6976 6572 2e63 6f72 652e 5f63  = driver.core._c
+00002330: 6f6e 6e65 6374 5f68 656c 7065 7228 4e6f  onnect_helper(No
+00002340: 6e65 2c20 484f 5354 2c20 4e6f 6e65 2c20  ne, HOST, None, 
+00002350: 4442 5f57 494e 5f50 4154 482c 204e 6f6e  DB_WIN_PATH, Non
+00002360: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+00002370: 6173 7365 7274 4571 7561 6c28 6473 6e2c  assertEqual(dsn,
+00002380: 2066 277b 484f 5354 7d3a 7b44 425f 5749   f'{HOST}:{DB_WI
+00002390: 4e5f 5041 5448 7d27 290a 2020 2020 2020  N_PATH}').      
+000023a0: 2020 2320 332e 2054 4350 2f49 5020 7769    # 3. TCP/IP wi
+000023b0: 7468 2050 6f72 740a 2020 2020 2020 2020  th Port.        
+000023c0: 6473 6e20 3d20 6472 6976 6572 2e63 6f72  dsn = driver.cor
+000023d0: 652e 5f63 6f6e 6e65 6374 5f68 656c 7065  e._connect_helpe
+000023e0: 7228 4e6f 6e65 2c20 484f 5354 2c20 504f  r(None, HOST, PO
+000023f0: 5254 2c20 4442 5f41 4c49 4153 2c20 4e6f  RT, DB_ALIAS, No
+00002400: 6e65 290a 2020 2020 2020 2020 7365 6c66  ne).        self
+00002410: 2e61 7373 6572 7445 7175 616c 2864 736e  .assertEqual(dsn
+00002420: 2c20 6627 7b48 4f53 547d 2f7b 504f 5254  , f'{HOST}/{PORT
+00002430: 7d3a 7b44 425f 414c 4941 537d 2729 0a20  }:{DB_ALIAS}'). 
+00002440: 2020 2020 2020 2064 736e 203d 2064 7269         dsn = dri
+00002450: 7665 722e 636f 7265 2e5f 636f 6e6e 6563  ver.core._connec
+00002460: 745f 6865 6c70 6572 284e 6f6e 652c 2049  t_helper(None, I
+00002470: 502c 2050 4f52 542c 2044 425f 4c49 4e55  P, PORT, DB_LINU
+00002480: 585f 5041 5448 2c20 4e6f 6e65 290a 2020  X_PATH, None).  
+00002490: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000024a0: 7445 7175 616c 2864 736e 2c20 6627 7b49  tEqual(dsn, f'{I
+000024b0: 507d 2f7b 504f 5254 7d3a 7b44 425f 4c49  P}/{PORT}:{DB_LI
+000024c0: 4e55 585f 5041 5448 7d27 290a 2020 2020  NUX_PATH}').    
+000024d0: 2020 2020 6473 6e20 3d20 6472 6976 6572      dsn = driver
+000024e0: 2e63 6f72 652e 5f63 6f6e 6e65 6374 5f68  .core._connect_h
+000024f0: 656c 7065 7228 4e6f 6e65 2c20 484f 5354  elper(None, HOST
+00002500: 2c20 5356 435f 4e41 4d45 2c20 4442 5f57  , SVC_NAME, DB_W
+00002510: 494e 5f50 4154 482c 204e 6f6e 6529 0a20  IN_PATH, None). 
+00002520: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00002530: 7274 4571 7561 6c28 6473 6e2c 2066 277b  rtEqual(dsn, f'{
+00002540: 484f 5354 7d2f 7b53 5643 5f4e 414d 457d  HOST}/{SVC_NAME}
+00002550: 3a7b 4442 5f57 494e 5f50 4154 487d 2729  :{DB_WIN_PATH}')
+00002560: 0a20 2020 2020 2020 2023 2034 2e20 4e61  .        # 4. Na
+00002570: 6d65 6420 7069 7065 730a 2020 2020 2020  med pipes.      
+00002580: 2020 6473 6e20 3d20 6472 6976 6572 2e63    dsn = driver.c
+00002590: 6f72 652e 5f63 6f6e 6e65 6374 5f68 656c  ore._connect_hel
+000025a0: 7065 7228 4e6f 6e65 2c20 4e50 4950 455f  per(None, NPIPE_
+000025b0: 484f 5354 2c20 4e6f 6e65 2c20 4442 5f41  HOST, None, DB_A
+000025c0: 4c49 4153 2c20 4e6f 6e65 290a 2020 2020  LIAS, None).    
+000025d0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000025e0: 7175 616c 2864 736e 2c20 6627 7b4e 5049  qual(dsn, f'{NPI
+000025f0: 5045 5f48 4f53 547d 5c5c 7b44 425f 414c  PE_HOST}\\{DB_AL
+00002600: 4941 537d 2729 0a20 2020 2020 2020 2064  IAS}').        d
+00002610: 736e 203d 2064 7269 7665 722e 636f 7265  sn = driver.core
+00002620: 2e5f 636f 6e6e 6563 745f 6865 6c70 6572  ._connect_helper
+00002630: 284e 6f6e 652c 204e 5049 5045 5f48 4f53  (None, NPIPE_HOS
+00002640: 542c 2053 5643 5f4e 414d 452c 2044 425f  T, SVC_NAME, DB_
+00002650: 5749 4e5f 5041 5448 2c20 4e6f 6e65 290a  WIN_PATH, None).
+00002660: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00002670: 6572 7445 7175 616c 2864 736e 2c20 6627  ertEqual(dsn, f'
+00002680: 7b4e 5049 5045 5f48 4f53 547d 407b 5356  {NPIPE_HOST}@{SV
+00002690: 435f 4e41 4d45 7d5c 5c7b 4442 5f57 494e  C_NAME}\\{DB_WIN
+000026a0: 5f50 4154 487d 2729 0a20 2020 2020 2020  _PATH}').       
+000026b0: 2023 2055 524c 2d53 7479 6c65 2043 6f6e   # URL-Style Con
+000026c0: 6e65 6374 696f 6e20 5374 7269 6e67 7320  nection Strings 
+000026d0: 2877 6974 6820 7072 6f74 6f63 6f6c 290a  (with protocol).
+000026e0: 2020 2020 2020 2020 2320 312e 204c 6f6f          # 1. Loo
+000026f0: 7062 6163 6b20 636f 6e6e 6563 7469 6f6e  pback connection
+00002700: 0a20 2020 2020 2020 2064 736e 203d 2064  .        dsn = d
+00002710: 7269 7665 722e 636f 7265 2e5f 636f 6e6e  river.core._conn
+00002720: 6563 745f 6865 6c70 6572 284e 6f6e 652c  ect_helper(None,
+00002730: 204e 6f6e 652c 204e 6f6e 652c 2044 425f   None, None, DB_
+00002740: 414c 4941 532c 204e 6574 5072 6f74 6f63  ALIAS, NetProtoc
+00002750: 6f6c 2e49 4e45 5429 0a20 2020 2020 2020  ol.INET).       
+00002760: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00002770: 6c28 6473 6e2c 2066 2769 6e65 743a 2f2f  l(dsn, f'inet://
+00002780: 7b44 425f 414c 4941 537d 2729 0a20 2020  {DB_ALIAS}').   
+00002790: 2020 2020 2064 736e 203d 2064 7269 7665       dsn = drive
+000027a0: 722e 636f 7265 2e5f 636f 6e6e 6563 745f  r.core._connect_
+000027b0: 6865 6c70 6572 284e 6f6e 652c 204e 6f6e  helper(None, Non
+000027c0: 652c 204e 6f6e 652c 2044 425f 4c49 4e55  e, None, DB_LINU
+000027d0: 585f 5041 5448 2c20 4e65 7450 726f 746f  X_PATH, NetProto
+000027e0: 636f 6c2e 494e 4554 290a 2020 2020 2020  col.INET).      
+000027f0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00002800: 616c 2864 736e 2c20 6627 696e 6574 3a2f  al(dsn, f'inet:/
+00002810: 2f7b 4442 5f4c 494e 5558 5f50 4154 487d  /{DB_LINUX_PATH}
+00002820: 2729 0a20 2020 2020 2020 2064 736e 203d  ').        dsn =
+00002830: 2064 7269 7665 722e 636f 7265 2e5f 636f   driver.core._co
+00002840: 6e6e 6563 745f 6865 6c70 6572 284e 6f6e  nnect_helper(Non
+00002850: 652c 204e 6f6e 652c 204e 6f6e 652c 2044  e, None, None, D
+00002860: 425f 5749 4e5f 5041 5448 2c20 4e65 7450  B_WIN_PATH, NetP
+00002870: 726f 746f 636f 6c2e 494e 4554 290a 2020  rotocol.INET).  
+00002880: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00002890: 7445 7175 616c 2864 736e 2c20 6627 696e  tEqual(dsn, f'in
+000028a0: 6574 3a2f 2f7b 4442 5f57 494e 5f50 4154  et://{DB_WIN_PAT
+000028b0: 487d 2729 0a20 2020 2020 2020 2064 736e  H}').        dsn
+000028c0: 203d 2064 7269 7665 722e 636f 7265 2e5f   = driver.core._
+000028d0: 636f 6e6e 6563 745f 6865 6c70 6572 284e  connect_helper(N
+000028e0: 6f6e 652c 204e 6f6e 652c 204e 6f6e 652c  one, None, None,
+000028f0: 2044 425f 414c 4941 532c 204e 6574 5072   DB_ALIAS, NetPr
+00002900: 6f74 6f63 6f6c 2e57 4e45 5429 0a20 2020  otocol.WNET).   
+00002910: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00002920: 4571 7561 6c28 6473 6e2c 2066 2777 6e65  Equal(dsn, f'wne
+00002930: 743a 2f2f 7b44 425f 414c 4941 537d 2729  t://{DB_ALIAS}')
+00002940: 0a20 2020 2020 2020 2064 736e 203d 2064  .        dsn = d
+00002950: 7269 7665 722e 636f 7265 2e5f 636f 6e6e  river.core._conn
+00002960: 6563 745f 6865 6c70 6572 284e 6f6e 652c  ect_helper(None,
+00002970: 204e 6f6e 652c 204e 6f6e 652c 2044 425f   None, None, DB_
+00002980: 414c 4941 532c 204e 6574 5072 6f74 6f63  ALIAS, NetProtoc
+00002990: 6f6c 2e58 4e45 5429 0a20 2020 2020 2020  ol.XNET).       
+000029a0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000029b0: 6c28 6473 6e2c 2066 2778 6e65 743a 2f2f  l(dsn, f'xnet://
+000029c0: 7b44 425f 414c 4941 537d 2729 0a20 2020  {DB_ALIAS}').   
+000029d0: 2020 2020 2023 2032 2e20 5443 502f 4950       # 2. TCP/IP
+000029e0: 0a20 2020 2020 2020 2064 736e 203d 2064  .        dsn = d
+000029f0: 7269 7665 722e 636f 7265 2e5f 636f 6e6e  river.core._conn
+00002a00: 6563 745f 6865 6c70 6572 284e 6f6e 652c  ect_helper(None,
+00002a10: 2048 4f53 542c 204e 6f6e 652c 2044 425f   HOST, None, DB_
+00002a20: 414c 4941 532c 204e 6574 5072 6f74 6f63  ALIAS, NetProtoc
+00002a30: 6f6c 2e49 4e45 5429 0a20 2020 2020 2020  ol.INET).       
+00002a40: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00002a50: 6c28 6473 6e2c 2066 2769 6e65 743a 2f2f  l(dsn, f'inet://
+00002a60: 7b48 4f53 547d 2f7b 4442 5f41 4c49 4153  {HOST}/{DB_ALIAS
+00002a70: 7d27 290a 2020 2020 2020 2020 6473 6e20  }').        dsn 
+00002a80: 3d20 6472 6976 6572 2e63 6f72 652e 5f63  = driver.core._c
+00002a90: 6f6e 6e65 6374 5f68 656c 7065 7228 4e6f  onnect_helper(No
+00002aa0: 6e65 2c20 4950 2c20 4e6f 6e65 2c20 4442  ne, IP, None, DB
+00002ab0: 5f4c 494e 5558 5f50 4154 482c 204e 6574  _LINUX_PATH, Net
+00002ac0: 5072 6f74 6f63 6f6c 2e49 4e45 5429 0a20  Protocol.INET). 
+00002ad0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00002ae0: 7274 4571 7561 6c28 6473 6e2c 2066 2769  rtEqual(dsn, f'i
+00002af0: 6e65 743a 2f2f 7b49 507d 2f7b 4442 5f4c  net://{IP}/{DB_L
+00002b00: 494e 5558 5f50 4154 487d 2729 0a20 2020  INUX_PATH}').   
+00002b10: 2020 2020 2064 736e 203d 2064 7269 7665       dsn = drive
+00002b20: 722e 636f 7265 2e5f 636f 6e6e 6563 745f  r.core._connect_
+00002b30: 6865 6c70 6572 284e 6f6e 652c 2048 4f53  helper(None, HOS
+00002b40: 542c 204e 6f6e 652c 2044 425f 5749 4e5f  T, None, DB_WIN_
+00002b50: 5041 5448 2c20 4e65 7450 726f 746f 636f  PATH, NetProtoco
+00002b60: 6c2e 494e 4554 290a 2020 2020 2020 2020  l.INET).        
+00002b70: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00002b80: 2864 736e 2c20 6627 696e 6574 3a2f 2f7b  (dsn, f'inet://{
+00002b90: 484f 5354 7d2f 7b44 425f 5749 4e5f 5041  HOST}/{DB_WIN_PA
+00002ba0: 5448 7d27 290a 2020 2020 2020 2020 2320  TH}').        # 
+00002bb0: 332e 2054 4350 2f49 5020 7769 7468 2050  3. TCP/IP with P
+00002bc0: 6f72 740a 2020 2020 2020 2020 6473 6e20  ort.        dsn 
+00002bd0: 3d20 6472 6976 6572 2e63 6f72 652e 5f63  = driver.core._c
+00002be0: 6f6e 6e65 6374 5f68 656c 7065 7228 4e6f  onnect_helper(No
+00002bf0: 6e65 2c20 484f 5354 2c20 504f 5254 2c20  ne, HOST, PORT, 
+00002c00: 4442 5f41 4c49 4153 2c20 4e65 7450 726f  DB_ALIAS, NetPro
+00002c10: 746f 636f 6c2e 494e 4554 290a 2020 2020  tocol.INET).    
+00002c20: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00002c30: 7175 616c 2864 736e 2c20 6627 696e 6574  qual(dsn, f'inet
+00002c40: 3a2f 2f7b 484f 5354 7d3a 7b50 4f52 547d  ://{HOST}:{PORT}
+00002c50: 2f7b 4442 5f41 4c49 4153 7d27 290a 2020  /{DB_ALIAS}').  
+00002c60: 2020 2020 2020 6473 6e20 3d20 6472 6976        dsn = driv
+00002c70: 6572 2e63 6f72 652e 5f63 6f6e 6e65 6374  er.core._connect
+00002c80: 5f68 656c 7065 7228 4e6f 6e65 2c20 4950  _helper(None, IP
+00002c90: 2c20 504f 5254 2c20 4442 5f4c 494e 5558  , PORT, DB_LINUX
+00002ca0: 5f50 4154 482c 204e 6574 5072 6f74 6f63  _PATH, NetProtoc
+00002cb0: 6f6c 2e49 4e45 5429 0a20 2020 2020 2020  ol.INET).       
+00002cc0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00002cd0: 6c28 6473 6e2c 2066 2769 6e65 743a 2f2f  l(dsn, f'inet://
+00002ce0: 7b49 507d 3a7b 504f 5254 7d2f 7b44 425f  {IP}:{PORT}/{DB_
+00002cf0: 4c49 4e55 585f 5041 5448 7d27 290a 2020  LINUX_PATH}').  
+00002d00: 2020 2020 2020 6473 6e20 3d20 6472 6976        dsn = driv
+00002d10: 6572 2e63 6f72 652e 5f63 6f6e 6e65 6374  er.core._connect
+00002d20: 5f68 656c 7065 7228 4e6f 6e65 2c20 484f  _helper(None, HO
+00002d30: 5354 2c20 5356 435f 4e41 4d45 2c20 4442  ST, SVC_NAME, DB
+00002d40: 5f57 494e 5f50 4154 482c 204e 6574 5072  _WIN_PATH, NetPr
+00002d50: 6f74 6f63 6f6c 2e49 4e45 5429 0a20 2020  otocol.INET).   
+00002d60: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00002d70: 4571 7561 6c28 6473 6e2c 2066 2769 6e65  Equal(dsn, f'ine
+00002d80: 743a 2f2f 7b48 4f53 547d 3a7b 5356 435f  t://{HOST}:{SVC_
+00002d90: 4e41 4d45 7d2f 7b44 425f 5749 4e5f 5041  NAME}/{DB_WIN_PA
+00002da0: 5448 7d27 290a 2020 2020 2020 2020 2320  TH}').        # 
+00002db0: 342e 204e 616d 6564 2070 6970 6573 0a20  4. Named pipes. 
+00002dc0: 2020 2020 2020 2064 736e 203d 2064 7269         dsn = dri
+00002dd0: 7665 722e 636f 7265 2e5f 636f 6e6e 6563  ver.core._connec
+00002de0: 745f 6865 6c70 6572 284e 6f6e 652c 204e  t_helper(None, N
+00002df0: 5049 5045 5f48 4f53 542c 204e 6f6e 652c  PIPE_HOST, None,
+00002e00: 2044 425f 414c 4941 532c 204e 6574 5072   DB_ALIAS, NetPr
+00002e10: 6f74 6f63 6f6c 2e57 4e45 5429 0a20 2020  otocol.WNET).   
+00002e20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00002e30: 4571 7561 6c28 6473 6e2c 6627 776e 6574  Equal(dsn,f'wnet
+00002e40: 3a2f 2f7b 4e50 4950 455f 484f 5354 7d2f  ://{NPIPE_HOST}/
+00002e50: 7b44 425f 414c 4941 537d 2729 0a20 2020  {DB_ALIAS}').   
+00002e60: 2020 2020 2064 736e 203d 2064 7269 7665       dsn = drive
+00002e70: 722e 636f 7265 2e5f 636f 6e6e 6563 745f  r.core._connect_
+00002e80: 6865 6c70 6572 284e 6f6e 652c 204e 5049  helper(None, NPI
+00002e90: 5045 5f48 4f53 542c 2053 5643 5f4e 414d  PE_HOST, SVC_NAM
+00002ea0: 452c 2044 425f 5749 4e5f 5041 5448 2c20  E, DB_WIN_PATH, 
+00002eb0: 4e65 7450 726f 746f 636f 6c2e 574e 4554  NetProtocol.WNET
+00002ec0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00002ed0: 7373 6572 7445 7175 616c 2864 736e 2c20  ssertEqual(dsn, 
+00002ee0: 6627 776e 6574 3a2f 2f7b 4e50 4950 455f  f'wnet://{NPIPE_
+00002ef0: 484f 5354 7d3a 7b53 5643 5f4e 414d 457d  HOST}:{SVC_NAME}
+00002f00: 2f7b 4442 5f57 494e 5f50 4154 487d 2729  /{DB_WIN_PATH}')
+00002f10: 0a20 2020 2064 6566 2074 6573 745f 636f  .    def test_co
+00002f20: 6e6e 6563 745f 6473 6e28 7365 6c66 293a  nnect_dsn(self):
+00002f30: 0a20 2020 2020 2020 2077 6974 6820 636f  .        with co
+00002f40: 6e6e 6563 7428 7365 6c66 2e64 6266 696c  nnect(self.dbfil
+00002f50: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
+00002f60: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+00002f70: 5445 5354 5f50 4153 5357 4f52 4429 2061  TEST_PASSWORD) a
+00002f80: 7320 636f 6e3a 0a20 2020 2020 2020 2020  s con:.         
+00002f90: 2020 2063 6f6e 2e5f 6c6f 6767 696e 675f     con._logging_
+00002fa0: 6964 5f20 3d20 7365 6c66 2e5f 5f63 6c61  id_ = self.__cla
+00002fb0: 7373 5f5f 2e5f 5f6e 616d 655f 5f0a 2020  ss__.__name__.  
+00002fc0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00002fd0: 7373 6572 7449 734e 6f74 4e6f 6e65 2863  ssertIsNotNone(c
+00002fe0: 6f6e 2e5f 6174 7429 0a20 2020 2020 2020  on._att).       
+00002ff0: 2020 2020 2064 7062 203d 205b 312c 2030       dpb = [1, 0
+00003000: 7831 632c 206c 656e 2846 4254 4553 545f  x1c, len(FBTEST_
+00003010: 5553 4552 295d 0a20 2020 2020 2020 2020  USER)].         
+00003020: 2020 2064 7062 2e65 7874 656e 6428 6f72     dpb.extend(or
+00003030: 6428 7829 2066 6f72 2078 2069 6e20 4642  d(x) for x in FB
+00003040: 5445 5354 5f55 5345 5229 0a20 2020 2020  TEST_USER).     
+00003050: 2020 2020 2020 2064 7062 2e65 7874 656e         dpb.exten
+00003060: 6428 2830 7831 642c 206c 656e 2846 4254  d((0x1d, len(FBT
+00003070: 4553 545f 5041 5353 574f 5244 2929 290a  EST_PASSWORD))).
+00003080: 2020 2020 2020 2020 2020 2020 6470 622e              dpb.
+00003090: 6578 7465 6e64 286f 7264 2878 2920 666f  extend(ord(x) fo
+000030a0: 7220 7820 696e 2046 4254 4553 545f 5041  r x in FBTEST_PA
+000030b0: 5353 574f 5244 290a 2020 2020 2020 2020  SSWORD).        
+000030c0: 2020 2020 6470 622e 6578 7465 6e64 2828      dpb.extend((
+000030d0: 6f72 6428 273f 2729 2c20 342c 2033 2c20  ord('?'), 4, 3, 
+000030e0: 302c 2030 2c20 3029 290a 2020 2020 2020  0, 0, 0)).      
+000030f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00003100: 7445 7175 616c 2863 6f6e 2e5f 6470 622c  tEqual(con._dpb,
+00003110: 2062 7974 6573 2864 7062 2929 0a20 2020   bytes(dpb)).   
+00003120: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00003130: 7365 7274 4571 7561 6c28 636f 6e2e 6473  sertEqual(con.ds
+00003140: 6e2c 2073 656c 662e 6462 6669 6c65 290a  n, self.dbfile).
+00003150: 2020 2020 6465 6620 7465 7374 5f63 6f6e      def test_con
+00003160: 6e65 6374 5f63 6f6e 6669 6728 7365 6c66  nect_config(self
+00003170: 293a 0a20 2020 2020 2020 2073 7276 5f63  ):.        srv_c
+00003180: 6f6e 6669 6720 3d20 6622 2222 0a20 2020  onfig = f""".   
+00003190: 2020 2020 205b 7365 7276 6572 2e6c 6f63       [server.loc
+000031a0: 616c 5d0a 2020 2020 2020 2020 686f 7374  al].        host
+000031b0: 203d 207b 4642 5445 5354 5f48 4f53 547d   = {FBTEST_HOST}
+000031c0: 0a20 2020 2020 2020 2075 7365 7220 3d20  .        user = 
+000031d0: 7b46 4254 4553 545f 5553 4552 7d0a 2020  {FBTEST_USER}.  
+000031e0: 2020 2020 2020 7061 7373 776f 7264 203d        password =
+000031f0: 207b 4642 5445 5354 5f50 4153 5357 4f52   {FBTEST_PASSWOR
+00003200: 447d 0a20 2020 2020 2020 2070 6f72 7420  D}.        port 
+00003210: 3d20 3330 3530 0a20 2020 2020 2020 2022  = 3050.        "
+00003220: 2222 0a20 2020 2020 2020 2064 625f 636f  "".        db_co
+00003230: 6e66 6967 203d 2066 2222 220a 2020 2020  nfig = f""".    
+00003240: 2020 2020 5b74 6573 745f 6462 315d 0a20      [test_db1]. 
+00003250: 2020 2020 2020 2073 6572 7665 7220 3d20         server = 
+00003260: 7365 7276 6572 2e6c 6f63 616c 0a20 2020  server.local.   
+00003270: 2020 2020 2064 6174 6162 6173 6520 3d20       database = 
+00003280: 7b73 656c 662e 6462 6669 6c65 7d0a 2020  {self.dbfile}.  
+00003290: 2020 2020 2020 7573 6572 203d 207b 4642        user = {FB
+000032a0: 5445 5354 5f55 5345 527d 0a20 2020 2020  TEST_USER}.     
+000032b0: 2020 2070 6173 7377 6f72 6420 3d20 7b46     password = {F
+000032c0: 4254 4553 545f 5041 5353 574f 5244 7d0a  BTEST_PASSWORD}.
+000032d0: 2020 2020 2020 2020 7574 6638 6669 6c65          utf8file
+000032e0: 6e61 6d65 203d 2074 7275 650a 2020 2020  name = true.    
+000032f0: 2020 2020 6368 6172 7365 7420 3d20 5554      charset = UT
+00003300: 4638 0a20 2020 2020 2020 2073 716c 5f64  F8.        sql_d
+00003310: 6961 6c65 6374 203d 2033 0a20 2020 2020  ialect = 3.     
+00003320: 2020 2022 2222 0a20 2020 2020 2020 2064     """.        d
+00003330: 7269 7665 725f 636f 6e66 6967 2e72 6567  river_config.reg
+00003340: 6973 7465 725f 7365 7276 6572 2827 7365  ister_server('se
+00003350: 7276 6572 2e6c 6f63 616c 272c 2073 7276  rver.local', srv
+00003360: 5f63 6f6e 6669 6729 0a20 2020 2020 2020  _config).       
+00003370: 2064 7269 7665 725f 636f 6e66 6967 2e72   driver_config.r
+00003380: 6567 6973 7465 725f 6461 7461 6261 7365  egister_database
+00003390: 2827 7465 7374 5f64 6231 272c 2064 625f  ('test_db1', db_
+000033a0: 636f 6e66 6967 290a 2020 2020 2020 2020  config).        
+000033b0: 230a 2020 2020 2020 2020 7769 7468 2063  #.        with c
+000033c0: 6f6e 6e65 6374 2827 7465 7374 5f64 6231  onnect('test_db1
+000033d0: 2729 2061 7320 636f 6e3a 0a20 2020 2020  ') as con:.     
+000033e0: 2020 2020 2020 2063 6f6e 2e5f 6c6f 6767         con._logg
+000033f0: 696e 675f 6964 5f20 3d20 7365 6c66 2e5f  ing_id_ = self._
+00003400: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+00003410: 5f0a 2020 2020 2020 2020 2020 2020 7365  _.            se
+00003420: 6c66 2e61 7373 6572 7449 734e 6f74 4e6f  lf.assertIsNotNo
+00003430: 6e65 2863 6f6e 2e5f 6174 7429 0a20 2020  ne(con._att).   
+00003440: 2020 2020 2020 2020 2064 7062 203d 205b           dpb = [
+00003450: 312c 2030 7831 632c 206c 656e 2846 4254  1, 0x1c, len(FBT
+00003460: 4553 545f 5553 4552 295d 0a20 2020 2020  EST_USER)].     
+00003470: 2020 2020 2020 2064 7062 2e65 7874 656e         dpb.exten
+00003480: 6428 6f72 6428 7829 2066 6f72 2078 2069  d(ord(x) for x i
+00003490: 6e20 4642 5445 5354 5f55 5345 5229 0a20  n FBTEST_USER). 
+000034a0: 2020 2020 2020 2020 2020 2064 7062 2e65             dpb.e
+000034b0: 7874 656e 6428 2830 7831 642c 206c 656e  xtend((0x1d, len
+000034c0: 2846 4254 4553 545f 5041 5353 574f 5244  (FBTEST_PASSWORD
+000034d0: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+000034e0: 6470 622e 6578 7465 6e64 286f 7264 2878  dpb.extend(ord(x
+000034f0: 2920 666f 7220 7820 696e 2046 4254 4553  ) for x in FBTES
+00003500: 545f 5041 5353 574f 5244 290a 2020 2020  T_PASSWORD).    
+00003510: 2020 2020 2020 2020 6470 622e 6578 7465          dpb.exte
+00003520: 6e64 2828 6f72 6428 273f 2729 2c20 342c  nd((ord('?'), 4,
+00003530: 2033 2c20 302c 2030 2c20 3029 290a 2020   3, 0, 0, 0)).  
+00003540: 2020 2020 2020 2020 2020 6470 622e 6578            dpb.ex
+00003550: 7465 6e64 2828 6f72 6428 2730 2729 2c20  tend((ord('0'), 
+00003560: 342c 206f 7264 2827 5527 292c 206f 7264  4, ord('U'), ord
+00003570: 2827 5427 292c 206f 7264 2827 4627 292c  ('T'), ord('F'),
+00003580: 206f 7264 2827 3827 2929 290a 2020 2020   ord('8'))).    
+00003590: 2020 2020 2020 2020 6470 622e 6578 7465          dpb.exte
+000035a0: 6e64 2828 3737 2c20 342c 2031 2c20 302c  nd((77, 4, 1, 0,
+000035b0: 2030 2c20 3029 290a 2020 2020 2020 2020   0, 0)).        
+000035c0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000035d0: 7175 616c 2863 6f6e 2e5f 6470 622c 2062  qual(con._dpb, b
+000035e0: 7974 6573 2864 7062 2929 0a20 2020 2020  ytes(dpb)).     
+000035f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00003600: 7274 4571 7561 6c28 636f 6e2e 6473 6e2c  rtEqual(con.dsn,
+00003610: 2066 277b 4642 5445 5354 5f48 4f53 547d   f'{FBTEST_HOST}
+00003620: 2f33 3035 303a 7b73 656c 662e 6462 6669  /3050:{self.dbfi
+00003630: 6c65 7d27 290a 2020 2020 2020 2020 7769  le}').        wi
+00003640: 7468 2063 6f6e 6e65 6374 2827 7465 7374  th connect('test
+00003650: 5f64 6231 272c 206e 6f5f 6763 3d31 2c20  _db1', no_gc=1, 
+00003660: 6e6f 5f64 625f 7472 6967 6765 7273 3d31  no_db_triggers=1
+00003670: 2920 6173 2063 6f6e 3a0a 2020 2020 2020  ) as con:.      
+00003680: 2020 2020 2020 636f 6e2e 5f6c 6f67 6769        con._loggi
+00003690: 6e67 5f69 645f 203d 2073 656c 662e 5f5f  ng_id_ = self.__
+000036a0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+000036b0: 0a20 2020 2020 2020 2020 2020 2064 7062  .            dpb
+000036c0: 203d 205b 312c 2030 7831 632c 206c 656e   = [1, 0x1c, len
+000036d0: 2846 4254 4553 545f 5553 4552 295d 0a20  (FBTEST_USER)]. 
+000036e0: 2020 2020 2020 2020 2020 2064 7062 2e65             dpb.e
+000036f0: 7874 656e 6428 6f72 6428 7829 2066 6f72  xtend(ord(x) for
+00003700: 2078 2069 6e20 4642 5445 5354 5f55 5345   x in FBTEST_USE
+00003710: 5229 0a20 2020 2020 2020 2020 2020 2064  R).            d
+00003720: 7062 2e65 7874 656e 6428 2830 7831 642c  pb.extend((0x1d,
+00003730: 206c 656e 2846 4254 4553 545f 5041 5353   len(FBTEST_PASS
+00003740: 574f 5244 2929 290a 2020 2020 2020 2020  WORD))).        
+00003750: 2020 2020 6470 622e 6578 7465 6e64 286f      dpb.extend(o
+00003760: 7264 2878 2920 666f 7220 7820 696e 2046  rd(x) for x in F
+00003770: 4254 4553 545f 5041 5353 574f 5244 290a  BTEST_PASSWORD).
+00003780: 2020 2020 2020 2020 2020 2020 6470 622e              dpb.
+00003790: 6578 7465 6e64 2828 6f72 6428 273f 2729  extend((ord('?')
+000037a0: 2c20 342c 2033 2c20 302c 2030 2c20 3029  , 4, 3, 0, 0, 0)
+000037b0: 290a 2020 2020 2020 2020 2020 2020 6470  ).            dp
+000037c0: 622e 6578 7465 6e64 2828 6f72 6428 2730  b.extend((ord('0
+000037d0: 2729 2c20 342c 206f 7264 2827 5527 292c  '), 4, ord('U'),
+000037e0: 206f 7264 2827 5427 292c 206f 7264 2827   ord('T'), ord('
+000037f0: 4627 292c 206f 7264 2827 3827 2929 290a  F'), ord('8'))).
+00003800: 2020 2020 2020 2020 2020 2020 6470 622e              dpb.
+00003810: 6578 7465 6e64 285b 7479 7065 732e 4450  extend([types.DP
+00003820: 4249 7465 6d2e 4e4f 5f47 4152 4241 4745  BItem.NO_GARBAGE
+00003830: 5f43 4f4c 4c45 4354 2c20 342c 2031 2c20  _COLLECT, 4, 1, 
+00003840: 302c 2030 2c20 305d 290a 2020 2020 2020  0, 0, 0]).      
+00003850: 2020 2020 2020 6470 622e 6578 7465 6e64        dpb.extend
+00003860: 2828 7479 7065 732e 4450 4249 7465 6d2e  ((types.DPBItem.
+00003870: 5554 4638 5f46 494c 454e 414d 452c 2034  UTF8_FILENAME, 4
+00003880: 2c20 312c 2030 2c20 302c 2030 2929 0a20  , 1, 0, 0, 0)). 
+00003890: 2020 2020 2020 2020 2020 2064 7062 2e65             dpb.e
+000038a0: 7874 656e 6428 5b74 7970 6573 2e44 5042  xtend([types.DPB
+000038b0: 4974 656d 2e4e 4f5f 4442 5f54 5249 4747  Item.NO_DB_TRIGG
+000038c0: 4552 532c 2034 2c20 312c 2030 2c20 302c  ERS, 4, 1, 0, 0,
+000038d0: 2030 5d29 0a20 2020 2020 2020 2020 2020   0]).           
+000038e0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000038f0: 6c28 636f 6e2e 5f64 7062 2c20 6279 7465  l(con._dpb, byte
+00003900: 7328 6470 6229 290a 2020 2020 2020 2020  s(dpb)).        
+00003910: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00003920: 7175 616c 2863 6f6e 2e64 736e 2c20 6627  qual(con.dsn, f'
+00003930: 7b46 4254 4553 545f 484f 5354 7d2f 3330  {FBTEST_HOST}/30
+00003940: 3530 3a7b 7365 6c66 2e64 6266 696c 657d  50:{self.dbfile}
+00003950: 2729 0a20 2020 2020 2020 2023 2070 726f  ').        # pro
+00003960: 746f 636f 6c73 0a20 2020 2020 2020 2063  tocols.        c
+00003970: 6667 203d 2064 7269 7665 725f 636f 6e66  fg = driver_conf
+00003980: 6967 2e67 6574 5f64 6174 6162 6173 6528  ig.get_database(
+00003990: 2774 6573 745f 6462 3127 290a 2020 2020  'test_db1').    
+000039a0: 2020 2020 6366 672e 7072 6f74 6f63 6f6c      cfg.protocol
+000039b0: 2e76 616c 7565 203d 204e 6574 5072 6f74  .value = NetProt
+000039c0: 6f63 6f6c 2e49 4e45 540a 2020 2020 2020  ocol.INET.      
+000039d0: 2020 7769 7468 2063 6f6e 6e65 6374 2827    with connect('
+000039e0: 7465 7374 5f64 6231 2729 2061 7320 636f  test_db1') as co
+000039f0: 6e3a 0a20 2020 2020 2020 2020 2020 2063  n:.            c
+00003a00: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
+00003a10: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
+00003a20: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
+00003a30: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00003a40: 7449 734e 6f74 4e6f 6e65 2863 6f6e 2e5f  tIsNotNone(con._
+00003a50: 6174 7429 0a20 2020 2020 2020 2020 2020  att).           
+00003a60: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00003a70: 6c28 636f 6e2e 6473 6e2c 2066 2769 6e65  l(con.dsn, f'ine
+00003a80: 743a 2f2f 7b46 4254 4553 545f 484f 5354  t://{FBTEST_HOST
+00003a90: 7d3a 3330 3530 2f7b 7365 6c66 2e64 6266  }:3050/{self.dbf
+00003aa0: 696c 657d 2729 0a20 2020 2020 2020 2063  ile}').        c
+00003ab0: 6667 2e70 726f 746f 636f 6c2e 7661 6c75  fg.protocol.valu
+00003ac0: 6520 3d20 4e65 7450 726f 746f 636f 6c2e  e = NetProtocol.
+00003ad0: 494e 4554 340a 2020 2020 2020 2020 7769  INET4.        wi
+00003ae0: 7468 2063 6f6e 6e65 6374 2827 7465 7374  th connect('test
+00003af0: 5f64 6231 2729 2061 7320 636f 6e3a 0a20  _db1') as con:. 
+00003b00: 2020 2020 2020 2020 2020 2063 6f6e 2e5f             con._
+00003b10: 6c6f 6767 696e 675f 6964 5f20 3d20 7365  logging_id_ = se
+00003b20: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+00003b30: 616d 655f 5f0a 2020 2020 2020 2020 2020  ame__.          
+00003b40: 2020 7365 6c66 2e61 7373 6572 7449 734e    self.assertIsN
+00003b50: 6f74 4e6f 6e65 2863 6f6e 2e5f 6174 7429  otNone(con._att)
+00003b60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00003b70: 662e 6173 7365 7274 4571 7561 6c28 636f  f.assertEqual(co
+00003b80: 6e2e 6473 6e2c 2066 2769 6e65 7434 3a2f  n.dsn, f'inet4:/
+00003b90: 2f7b 4642 5445 5354 5f48 4f53 547d 3a33  /{FBTEST_HOST}:3
+00003ba0: 3035 302f 7b73 656c 662e 6462 6669 6c65  050/{self.dbfile
+00003bb0: 7d27 290a 2020 2020 6465 6620 7465 7374  }').    def test
+00003bc0: 5f70 726f 7065 7274 6965 7328 7365 6c66  _properties(self
+00003bd0: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
+00003be0: 636f 6e6e 6563 7428 7365 6c66 2e64 6266  connect(self.dbf
+00003bf0: 696c 652c 2075 7365 723d 4642 5445 5354  ile, user=FBTEST
+00003c00: 5f55 5345 522c 2070 6173 7377 6f72 643d  _USER, password=
+00003c10: 4642 5445 5354 5f50 4153 5357 4f52 4429  FBTEST_PASSWORD)
+00003c20: 2061 7320 636f 6e3a 0a20 2020 2020 2020   as con:.       
+00003c30: 2020 2020 2063 6f6e 2e5f 6c6f 6767 696e       con._loggin
+00003c40: 675f 6964 5f20 3d20 7365 6c66 2e5f 5f63  g_id_ = self.__c
+00003c50: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f0a  lass__.__name__.
+00003c60: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00003c70: 6f6e 2e69 6e66 6f2e 656e 6769 6e65 5f76  on.info.engine_v
+00003c80: 6572 7369 6f6e 203e 3d20 332e 303a 0a20  ersion >= 3.0:. 
+00003c90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003ca0: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
+00003cb0: 616e 6365 2863 6f6e 2e69 6e66 6f2c 2064  ance(con.info, d
+00003cc0: 7269 7665 722e 636f 7265 2e44 6174 6162  river.core.Datab
+00003cd0: 6173 6549 6e66 6f50 726f 7669 6465 7233  aseInfoProvider3
+00003ce0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00003cf0: 2063 6f6e 2e69 6e66 6f2e 656e 6769 6e65   con.info.engine
+00003d00: 5f76 6572 7369 6f6e 203e 3d20 342e 303a  _version >= 4.0:
+00003d10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003d20: 2073 656c 662e 6173 7365 7274 4973 496e   self.assertIsIn
+00003d30: 7374 616e 6365 2863 6f6e 2e69 6e66 6f2c  stance(con.info,
+00003d40: 2064 7269 7665 722e 636f 7265 2e44 6174   driver.core.Dat
+00003d50: 6162 6173 6549 6e66 6f50 726f 7669 6465  abaseInfoProvide
+00003d60: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
+00003d70: 656c 662e 6173 7365 7274 4973 4e6f 6e65  elf.assertIsNone
+00003d80: 2863 6f6e 2e63 6861 7273 6574 290a 2020  (con.charset).  
+00003d90: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00003da0: 7373 6572 7445 7175 616c 2863 6f6e 2e73  ssertEqual(con.s
+00003db0: 716c 5f64 6961 6c65 6374 2c20 3329 0a20  ql_dialect, 3). 
 00003dc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00003dd0: 6173 7365 7274 4571 7561 6c28 6c65 6e28  assertEqual(len(
-00003de0: 636f 6e2e 7472 616e 7361 6374 696f 6e73  con.transactions
-00003df0: 292c 2032 290a 2020 2020 2020 2020 2020  ), 2).          
-00003e00: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00003e10: 616c 2863 6f6e 2e64 6566 6175 6c74 5f74  al(con.default_t
-00003e20: 7062 2c20 7470 6228 4973 6f6c 6174 696f  pb, tpb(Isolatio
-00003e30: 6e2e 534e 4150 5348 4f54 2929 0a20 2020  n.SNAPSHOT)).   
-00003e40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00003e50: 7365 7274 4661 6c73 6528 636f 6e2e 6973  sertFalse(con.is
-00003e60: 5f61 6374 6976 6528 2929 0a20 2020 2020  _active()).     
-00003e70: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00003e80: 7274 4661 6c73 6528 636f 6e2e 6973 5f63  rtFalse(con.is_c
-00003e90: 6c6f 7365 6428 2929 0a20 2020 2064 6566  losed()).    def
-00003ea0: 2074 6573 745f 636f 6e6e 6563 745f 726f   test_connect_ro
-00003eb0: 6c65 2873 656c 6629 3a0a 2020 2020 2020  le(self):.      
-00003ec0: 2020 726f 6c65 6e61 6d65 203d 2027 726f    rolename = 'ro
-00003ed0: 6c65 270a 2020 2020 2020 2020 7769 7468  le'.        with
-00003ee0: 2063 6f6e 6e65 6374 2873 656c 662e 6462   connect(self.db
-00003ef0: 6669 6c65 2c20 7573 6572 3d46 4254 4553  file, user=FBTES
-00003f00: 545f 5553 4552 2c0a 2020 2020 2020 2020  T_USER,.        
-00003f10: 2020 2020 2020 2020 2020 2020 2070 6173               pas
-00003f20: 7377 6f72 643d 4642 5445 5354 5f50 4153  sword=FBTEST_PAS
-00003f30: 5357 4f52 442c 2072 6f6c 653d 726f 6c65  SWORD, role=role
-00003f40: 6e61 6d65 2920 6173 2063 6f6e 3a0a 2020  name) as con:.  
-00003f50: 2020 2020 2020 2020 2020 636f 6e2e 5f6c            con._l
-00003f60: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
-00003f70: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00003f80: 6d65 5f5f 0a20 2020 2020 2020 2020 2020  me__.           
-00003f90: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
-00003fa0: 744e 6f6e 6528 636f 6e2e 5f61 7474 290a  tNone(con._att).
-00003fb0: 2020 2020 2020 2020 2020 2020 6470 6220              dpb 
-00003fc0: 3d20 5b31 2c20 3078 3163 2c20 6c65 6e28  = [1, 0x1c, len(
-00003fd0: 4642 5445 5354 5f55 5345 5229 5d0a 2020  FBTEST_USER)].  
-00003fe0: 2020 2020 2020 2020 2020 6470 622e 6578            dpb.ex
-00003ff0: 7465 6e64 286f 7264 2878 2920 666f 7220  tend(ord(x) for 
-00004000: 7820 696e 2046 4254 4553 545f 5553 4552  x in FBTEST_USER
-00004010: 290a 2020 2020 2020 2020 2020 2020 6470  ).            dp
-00004020: 622e 6578 7465 6e64 2828 3078 3164 2c20  b.extend((0x1d, 
-00004030: 6c65 6e28 4642 5445 5354 5f50 4153 5357  len(FBTEST_PASSW
-00004040: 4f52 4429 2929 0a20 2020 2020 2020 2020  ORD))).         
-00004050: 2020 2064 7062 2e65 7874 656e 6428 6f72     dpb.extend(or
-00004060: 6428 7829 2066 6f72 2078 2069 6e20 4642  d(x) for x in FB
-00004070: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
-00004080: 2020 2020 2020 2020 2020 2064 7062 2e65             dpb.e
-00004090: 7874 656e 6428 286f 7264 2827 3c27 292c  xtend((ord('<'),
-000040a0: 206c 656e 2872 6f6c 656e 616d 6529 2929   len(rolename)))
-000040b0: 0a20 2020 2020 2020 2020 2020 2064 7062  .            dpb
-000040c0: 2e65 7874 656e 6428 6f72 6428 7829 2066  .extend(ord(x) f
-000040d0: 6f72 2078 2069 6e20 726f 6c65 6e61 6d65  or x in rolename
-000040e0: 290a 2020 2020 2020 2020 2020 2020 6470  ).            dp
-000040f0: 622e 6578 7465 6e64 2828 6f72 6428 273f  b.extend((ord('?
-00004100: 2729 2c20 342c 2033 2c20 302c 2030 2c20  '), 4, 3, 0, 0, 
-00004110: 3029 290a 2020 2020 2020 2020 2020 2020  0)).            
-00004120: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00004130: 2863 6f6e 2e5f 6470 622c 2062 7974 6573  (con._dpb, bytes
-00004140: 2864 7062 2929 0a20 2020 2064 6566 2074  (dpb)).    def t
-00004150: 6573 745f 7472 616e 7361 6374 696f 6e28  est_transaction(
-00004160: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
-00004170: 6974 6820 636f 6e6e 6563 7428 7365 6c66  ith connect(self
-00004180: 2e64 6266 696c 652c 2075 7365 723d 4642  .dbfile, user=FB
-00004190: 5445 5354 5f55 5345 522c 2070 6173 7377  TEST_USER, passw
-000041a0: 6f72 643d 4642 5445 5354 5f50 4153 5357  ord=FBTEST_PASSW
-000041b0: 4f52 4429 2061 7320 636f 6e3a 0a20 2020  ORD) as con:.   
-000041c0: 2020 2020 2020 2020 2063 6f6e 2e5f 6c6f           con._lo
-000041d0: 6767 696e 675f 6964 5f20 3d20 7365 6c66  gging_id_ = self
-000041e0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-000041f0: 655f 5f0a 2020 2020 2020 2020 2020 2020  e__.            
-00004200: 7365 6c66 2e61 7373 6572 7449 734e 6f74  self.assertIsNot
-00004210: 4e6f 6e65 2863 6f6e 2e6d 6169 6e5f 7472  None(con.main_tr
-00004220: 616e 7361 6374 696f 6e29 0a20 2020 2020  ansaction).     
-00004230: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00004240: 7274 4661 6c73 6528 636f 6e2e 6d61 696e  rtFalse(con.main
-00004250: 5f74 7261 6e73 6163 7469 6f6e 2e69 735f  _transaction.is_
-00004260: 6163 7469 7665 2829 290a 2020 2020 2020  active()).      
-00004270: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00004280: 7446 616c 7365 2863 6f6e 2e6d 6169 6e5f  tFalse(con.main_
-00004290: 7472 616e 7361 6374 696f 6e2e 6973 5f63  transaction.is_c
-000042a0: 6c6f 7365 6428 2929 0a20 2020 2020 2020  losed()).       
-000042b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000042c0: 4571 7561 6c28 636f 6e2e 6d61 696e 5f74  Equal(con.main_t
-000042d0: 7261 6e73 6163 7469 6f6e 2e64 6566 6175  ransaction.defau
-000042e0: 6c74 5f61 6374 696f 6e2c 2044 6566 6175  lt_action, Defau
-000042f0: 6c74 4163 7469 6f6e 2e43 4f4d 4d49 5429  ltAction.COMMIT)
-00004300: 0a20 2020 2020 2020 2020 2020 2023 7365  .            #se
-00004310: 6c66 2e61 7373 6572 7445 7175 616c 286c  lf.assertEqual(l
-00004320: 656e 2863 6f6e 2e6d 6169 6e5f 7472 616e  en(con.main_tran
-00004330: 7361 6374 696f 6e2e 5f63 6f6e 6e65 6374  saction._connect
-00004340: 696f 6e73 292c 2031 290a 2020 2020 2020  ions), 1).      
-00004350: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00004360: 7445 7175 616c 2863 6f6e 2e6d 6169 6e5f  tEqual(con.main_
-00004370: 7472 616e 7361 6374 696f 6e2e 5f63 6f6e  transaction._con
-00004380: 6e65 6374 696f 6e28 292c 2063 6f6e 290a  nection(), con).
-00004390: 2020 2020 2020 2020 2020 2020 636f 6e2e              con.
-000043a0: 6265 6769 6e28 290a 2020 2020 2020 2020  begin().        
-000043b0: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
-000043c0: 616c 7365 2863 6f6e 2e6d 6169 6e5f 7472  alse(con.main_tr
-000043d0: 616e 7361 6374 696f 6e2e 6973 5f63 6c6f  ansaction.is_clo
-000043e0: 7365 6428 2929 0a20 2020 2020 2020 2020  sed()).         
-000043f0: 2020 2063 6f6e 2e63 6f6d 6d69 7428 290a     con.commit().
-00004400: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00004410: 2e61 7373 6572 7446 616c 7365 2863 6f6e  .assertFalse(con
-00004420: 2e6d 6169 6e5f 7472 616e 7361 6374 696f  .main_transactio
-00004430: 6e2e 6973 5f61 6374 6976 6528 2929 0a20  n.is_active()). 
-00004440: 2020 2020 2020 2020 2020 2063 6f6e 2e62             con.b
-00004450: 6567 696e 2829 0a20 2020 2020 2020 2020  egin().         
-00004460: 2020 2063 6f6e 2e72 6f6c 6c62 6163 6b28     con.rollback(
-00004470: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00004480: 6c66 2e61 7373 6572 7446 616c 7365 2863  lf.assertFalse(c
-00004490: 6f6e 2e6d 6169 6e5f 7472 616e 7361 6374  on.main_transact
-000044a0: 696f 6e2e 6973 5f61 6374 6976 6528 2929  ion.is_active())
-000044b0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-000044c0: 2e62 6567 696e 2829 0a20 2020 2020 2020  .begin().       
-000044d0: 2020 2020 2063 6f6e 2e63 6f6d 6d69 7428       con.commit(
-000044e0: 7265 7461 696e 696e 673d 5472 7565 290a  retaining=True).
-000044f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00004500: 2e61 7373 6572 7454 7275 6528 636f 6e2e  .assertTrue(con.
-00004510: 6d61 696e 5f74 7261 6e73 6163 7469 6f6e  main_transaction
-00004520: 2e69 735f 6163 7469 7665 2829 290a 2020  .is_active()).  
-00004530: 2020 2020 2020 2020 2020 636f 6e2e 726f            con.ro
-00004540: 6c6c 6261 636b 2872 6574 6169 6e69 6e67  llback(retaining
-00004550: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
-00004560: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-00004570: 7565 2863 6f6e 2e6d 6169 6e5f 7472 616e  ue(con.main_tran
-00004580: 7361 6374 696f 6e2e 6973 5f61 6374 6976  saction.is_activ
-00004590: 6528 2929 0a20 2020 2020 2020 2020 2020  e()).           
-000045a0: 2074 7220 3d20 636f 6e2e 7472 616e 7361   tr = con.transa
-000045b0: 6374 696f 6e5f 6d61 6e61 6765 7228 290a  ction_manager().
-000045c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000045d0: 2e61 7373 6572 7449 7349 6e73 7461 6e63  .assertIsInstanc
-000045e0: 6528 7472 2c20 6472 6976 6572 2e63 6f72  e(tr, driver.cor
-000045f0: 652e 5472 616e 7361 6374 696f 6e4d 616e  e.TransactionMan
-00004600: 6167 6572 290a 2020 2020 2020 2020 2020  ager).          
-00004610: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
-00004620: 7365 2863 6f6e 2e6d 6169 6e5f 7472 616e  se(con.main_tran
-00004630: 7361 6374 696f 6e2e 6973 5f63 6c6f 7365  saction.is_close
-00004640: 6428 2929 0a20 2020 2020 2020 2020 2020  d()).           
-00004650: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00004660: 6c28 6c65 6e28 636f 6e2e 7472 616e 7361  l(len(con.transa
-00004670: 6374 696f 6e73 292c 2033 290a 2020 2020  ctions), 3).    
-00004680: 2020 2020 2020 2020 7472 2e62 6567 696e          tr.begin
-00004690: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-000046a0: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
-000046b0: 7472 2e69 735f 636c 6f73 6564 2829 290a  tr.is_closed()).
-000046c0: 2020 2020 2020 2020 2020 2020 636f 6e2e              con.
-000046d0: 6265 6769 6e28 290a 2020 2020 2020 2020  begin().        
-000046e0: 2020 2020 636f 6e2e 636c 6f73 6528 290a      con.close().
-000046f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00004700: 2e61 7373 6572 7446 616c 7365 2863 6f6e  .assertFalse(con
-00004710: 2e6d 6169 6e5f 7472 616e 7361 6374 696f  .main_transactio
-00004720: 6e2e 6973 5f61 6374 6976 6528 2929 0a20  n.is_active()). 
-00004730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00004740: 6173 7365 7274 5472 7565 2863 6f6e 2e6d  assertTrue(con.m
-00004750: 6169 6e5f 7472 616e 7361 6374 696f 6e2e  ain_transaction.
-00004760: 6973 5f63 6c6f 7365 6428 2929 0a20 2020  is_closed()).   
-00004770: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00004780: 7365 7274 4661 6c73 6528 7472 2e69 735f  sertFalse(tr.is_
-00004790: 6163 7469 7665 2829 290a 2020 2020 2020  active()).      
-000047a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000047b0: 7454 7275 6528 7472 2e69 735f 636c 6f73  tTrue(tr.is_clos
-000047c0: 6564 2829 290a 2020 2020 6465 6620 7465  ed()).    def te
-000047d0: 7374 5f65 7865 6375 7465 5f69 6d6d 6564  st_execute_immed
-000047e0: 6961 7465 2873 656c 6629 3a0a 2020 2020  iate(self):.    
-000047f0: 2020 2020 7769 7468 2063 6f6e 6e65 6374      with connect
-00004800: 2873 656c 662e 6462 6669 6c65 2c20 7573  (self.dbfile, us
-00004810: 6572 3d46 4254 4553 545f 5553 4552 2c20  er=FBTEST_USER, 
-00004820: 7061 7373 776f 7264 3d46 4254 4553 545f  password=FBTEST_
-00004830: 5041 5353 574f 5244 2920 6173 2063 6f6e  PASSWORD) as con
-00004840: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00004850: 6e2e 5f6c 6f67 6769 6e67 5f69 645f 203d  n._logging_id_ =
-00004860: 2073 656c 662e 5f5f 636c 6173 735f 5f2e   self.__class__.
-00004870: 5f5f 6e61 6d65 5f5f 0a20 2020 2020 2020  __name__.       
-00004880: 2020 2020 2023 636f 6e2e 6578 6563 7574       #con.execut
-00004890: 655f 696d 6d65 6469 6174 6528 2272 6563  e_immediate("rec
-000048a0: 7265 6174 6520 7461 626c 6520 7420 2863  reate table t (c
-000048b0: 3120 696e 7465 6765 7229 2229 0a20 2020  1 integer)").   
-000048c0: 2020 2020 2020 2020 2023 636f 6e2e 636f           #con.co
-000048d0: 6d6d 6974 2829 0a20 2020 2020 2020 2020  mmit().         
-000048e0: 2020 2063 6f6e 2e65 7865 6375 7465 5f69     con.execute_i
-000048f0: 6d6d 6564 6961 7465 2822 6465 6c65 7465  mmediate("delete
-00004900: 2066 726f 6d20 7422 290a 2020 2020 2020   from t").      
-00004910: 2020 2020 2020 636f 6e2e 636f 6d6d 6974        con.commit
-00004920: 2829 0a20 2020 2064 6566 2074 6573 745f  ().    def test_
-00004930: 6462 5f69 6e66 6f28 7365 6c66 293a 0a20  db_info(self):. 
-00004940: 2020 2020 2020 2077 6974 6820 636f 6e6e         with conn
-00004950: 6563 7428 7365 6c66 2e64 6266 696c 652c  ect(self.dbfile,
-00004960: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
-00004970: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
-00004980: 5354 5f50 4153 5357 4f52 4429 2061 7320  ST_PASSWORD) as 
-00004990: 636f 6e3a 0a20 2020 2020 2020 2020 2020  con:.           
-000049a0: 2063 6f6e 2e5f 6c6f 6767 696e 675f 6964   con._logging_id
-000049b0: 5f20 3d20 7365 6c66 2e5f 5f63 6c61 7373  _ = self.__class
-000049c0: 5f5f 2e5f 5f6e 616d 655f 5f0a 2020 2020  __.__name__.    
-000049d0: 2020 2020 2020 2020 2320 5265 7369 7a65          # Resize
-000049e0: 2072 6573 706f 6e73 6520 6275 6666 6572   response buffer
-000049f0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00004a00: 2e69 6e66 6f2e 7265 7370 6f6e 7365 2e72  .info.response.r
-00004a10: 6573 697a 6528 3529 0a20 2020 2020 2020  esize(5).       
-00004a20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00004a30: 4571 7561 6c28 6c65 6e28 636f 6e2e 696e  Equal(len(con.in
-00004a40: 666f 2e72 6573 706f 6e73 652e 7261 7729  fo.response.raw)
-00004a50: 2c20 3529 0a20 2020 2020 2020 2020 2020  , 5).           
-00004a60: 2063 6f6e 2e69 6e66 6f2e 6765 745f 696e   con.info.get_in
-00004a70: 666f 2844 6249 6e66 6f43 6f64 652e 5553  fo(DbInfoCode.US
-00004a80: 4552 5f4e 414d 4553 290a 2020 2020 2020  ER_NAMES).      
-00004a90: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00004aa0: 7447 7265 6174 6572 286c 656e 2863 6f6e  tGreater(len(con
-00004ab0: 2e69 6e66 6f2e 7265 7370 6f6e 7365 2e72  .info.response.r
-00004ac0: 6177 292c 2035 290a 2020 2020 2020 2020  aw), 5).        
-00004ad0: 2020 2020 2320 5072 6f70 6572 7469 6573      # Properties
-00004ae0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00004af0: 662e 6173 7365 7274 496e 2827 4669 7265  f.assertIn('Fire
-00004b00: 6269 7264 272c 2063 6f6e 2e69 6e66 6f2e  bird', con.info.
-00004b10: 7365 7276 6572 5f76 6572 7369 6f6e 290a  server_version).
-00004b20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00004b30: 2e61 7373 6572 7449 6e28 2746 6972 6562  .assertIn('Fireb
-00004b40: 6972 6427 2c20 636f 6e2e 696e 666f 2e66  ird', con.info.f
-00004b50: 6972 6562 6972 645f 7665 7273 696f 6e29  irebird_version)
-00004b60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00004b70: 662e 6173 7365 7274 4973 496e 7374 616e  f.assertIsInstan
-00004b80: 6365 2863 6f6e 2e69 6e66 6f2e 7665 7273  ce(con.info.vers
-00004b90: 696f 6e2c 2073 7472 290a 2020 2020 2020  ion, str).      
-00004ba0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00004bb0: 7447 7265 6174 6572 4571 7561 6c28 636f  tGreaterEqual(co
-00004bc0: 6e2e 696e 666f 2e65 6e67 696e 655f 7665  n.info.engine_ve
-00004bd0: 7273 696f 6e2c 2033 2e30 290a 2020 2020  rsion, 3.0).    
-00004be0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00004bf0: 6572 7447 7265 6174 6572 4571 7561 6c28  ertGreaterEqual(
-00004c00: 636f 6e2e 696e 666f 2e6f 6473 2c20 3132  con.info.ods, 12
-00004c10: 2e30 290a 2020 2020 2020 2020 2020 2020  .0).            
-00004c20: 230a 2020 2020 2020 2020 2020 2020 7365  #.            se
-00004c30: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
-00004c40: 6f6e 2e69 6e66 6f2e 7061 6765 5f73 697a  on.info.page_siz
-00004c50: 652c 2038 3139 3229 0a20 2020 2020 2020  e, 8192).       
-00004c60: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00004c70: 4772 6561 7465 7228 636f 6e2e 696e 666f  Greater(con.info
-00004c80: 2e69 642c 2030 290a 2020 2020 2020 2020  .id, 0).        
-00004c90: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00004ca0: 7175 616c 2863 6f6e 2e69 6e66 6f2e 7371  qual(con.info.sq
-00004cb0: 6c5f 6469 616c 6563 742c 2033 290a 2020  l_dialect, 3).  
-00004cc0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00004cd0: 7373 6572 7445 7175 616c 2863 6f6e 2e69  ssertEqual(con.i
-00004ce0: 6e66 6f2e 6e61 6d65 2e75 7070 6572 2829  nfo.name.upper()
-00004cf0: 2c20 7365 6c66 2e64 6266 696c 652e 7570  , self.dbfile.up
-00004d00: 7065 7228 2929 0a20 2020 2020 2020 2020  per()).         
-00004d10: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
-00004d20: 496e 7374 616e 6365 2863 6f6e 2e69 6e66  Instance(con.inf
-00004d30: 6f2e 7369 7465 2c20 7374 7229 0a20 2020  o.site, str).   
-00004d40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00004d50: 7365 7274 4973 496e 7374 616e 6365 2863  sertIsInstance(c
-00004d60: 6f6e 2e69 6e66 6f2e 696d 706c 656d 656e  on.info.implemen
-00004d70: 7461 7469 6f6e 2c20 6472 6976 6572 2e74  tation, driver.t
-00004d80: 7970 6573 2e49 6d70 6c65 6d65 6e74 6174  ypes.Implementat
-00004d90: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
-00004da0: 2073 656c 662e 6173 7365 7274 4973 496e   self.assertIsIn
-00004db0: 7374 616e 6365 2863 6f6e 2e69 6e66 6f2e  stance(con.info.
-00004dc0: 7072 6f76 6964 6572 2c20 6472 6976 6572  provider, driver
-00004dd0: 2e74 7970 6573 2e44 6250 726f 7669 6465  .types.DbProvide
-00004de0: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
-00004df0: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
-00004e00: 616e 6365 2863 6f6e 2e69 6e66 6f2e 6462  ance(con.info.db
-00004e10: 5f63 6c61 7373 2c20 6472 6976 6572 2e74  _class, driver.t
-00004e20: 7970 6573 2e44 6243 6c61 7373 290a 2020  ypes.DbClass).  
-00004e30: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00004e40: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-00004e50: 636f 6e2e 696e 666f 2e63 7265 6174 696f  con.info.creatio
-00004e60: 6e5f 6461 7465 2c20 6461 7465 7469 6d65  n_date, datetime
-00004e70: 2e64 6174 6529 0a20 2020 2020 2020 2020  .date).         
-00004e80: 2020 2073 656c 662e 6173 7365 7274 4772     self.assertGr
-00004e90: 6561 7465 7245 7175 616c 2863 6f6e 2e69  eaterEqual(con.i
-00004ea0: 6e66 6f2e 6f64 735f 7665 7273 696f 6e2c  nfo.ods_version,
-00004eb0: 2031 3129 0a20 2020 2020 2020 2020 2020   11).           
-00004ec0: 2073 656c 662e 6173 7365 7274 4772 6561   self.assertGrea
-00004ed0: 7465 7245 7175 616c 2863 6f6e 2e69 6e66  terEqual(con.inf
-00004ee0: 6f2e 6f64 735f 6d69 6e6f 725f 7665 7273  o.ods_minor_vers
-00004ef0: 696f 6e2c 2030 290a 2020 2020 2020 2020  ion, 0).        
-00004f00: 2020 2020 7365 6c66 2e61 7373 6572 7447      self.assertG
-00004f10: 7265 6174 6572 4571 7561 6c28 636f 6e2e  reaterEqual(con.
-00004f20: 696e 666f 2e70 6167 655f 6361 6368 655f  info.page_cache_
-00004f30: 7369 7a65 2c20 3735 290a 2020 2020 2020  size, 75).      
-00004f40: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00004f50: 7273 696f 6e20 3d3d 2046 4233 303a 0a20  rsion == FB30:. 
-00004f60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00004f70: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00004f80: 636f 6e2e 696e 666f 2e70 6167 6573 5f61  con.info.pages_a
-00004f90: 6c6c 6f63 6174 6564 2c20 3336 3729 0a20  llocated, 367). 
-00004fa0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00004fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004fc0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00004fd0: 6c28 636f 6e2e 696e 666f 2e70 6167 6573  l(con.info.pages
-00004fe0: 5f61 6c6c 6f63 6174 6564 2c20 3338 3929  _allocated, 389)
-00004ff0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005000: 662e 6173 7365 7274 4772 6561 7465 7228  f.assertGreater(
-00005010: 636f 6e2e 696e 666f 2e70 6167 6573 5f75  con.info.pages_u
-00005020: 7365 642c 2033 3030 290a 2020 2020 2020  sed, 300).      
-00005030: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00005040: 7447 7265 6174 6572 4571 7561 6c28 636f  tGreaterEqual(co
-00005050: 6e2e 696e 666f 2e70 6167 6573 5f66 7265  n.info.pages_fre
-00005060: 652c 2030 290a 2020 2020 2020 2020 2020  e, 0).          
-00005070: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00005080: 616c 2863 6f6e 2e69 6e66 6f2e 7377 6565  al(con.info.swee
-00005090: 705f 696e 7465 7276 616c 2c20 3230 3030  p_interval, 2000
-000050a0: 3029 0a20 2020 2020 2020 2020 2020 2073  0).            s
-000050b0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000050c0: 636f 6e2e 696e 666f 2e61 6363 6573 735f  con.info.access_
-000050d0: 6d6f 6465 2c20 4462 4163 6365 7373 4d6f  mode, DbAccessMo
-000050e0: 6465 2e52 4541 445f 5752 4954 4529 0a20  de.READ_WRITE). 
-000050f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005100: 6173 7365 7274 4571 7561 6c28 636f 6e2e  assertEqual(con.
-00005110: 696e 666f 2e73 7061 6365 5f72 6573 6572  info.space_reser
-00005120: 7661 7469 6f6e 2c20 4462 5370 6163 6552  vation, DbSpaceR
-00005130: 6573 6572 7661 7469 6f6e 2e52 4553 4552  eservation.RESER
-00005140: 5645 290a 2020 2020 2020 2020 2020 2020  VE).            
-00005150: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00005160: 2863 6f6e 2e69 6e66 6f2e 7772 6974 655f  (con.info.write_
-00005170: 6d6f 6465 2c20 4462 5772 6974 654d 6f64  mode, DbWriteMod
-00005180: 652e 5359 4e43 290a 2020 2020 2020 2020  e.SYNC).        
-00005190: 2020 2020 7365 6c66 2e61 7373 6572 7447      self.assertG
-000051a0: 7265 6174 6572 2863 6f6e 2e69 6e66 6f2e  reater(con.info.
-000051b0: 6375 7272 656e 745f 6d65 6d6f 7279 2c20  current_memory, 
-000051c0: 3029 0a20 2020 2020 2020 2020 2020 2073  0).            s
-000051d0: 656c 662e 6173 7365 7274 4772 6561 7465  elf.assertGreate
-000051e0: 7228 636f 6e2e 696e 666f 2e6d 6178 5f6d  r(con.info.max_m
-000051f0: 656d 6f72 792c 2030 290a 2020 2020 2020  emory, 0).      
-00005200: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00005210: 7447 7265 6174 6572 4571 7561 6c28 636f  tGreaterEqual(co
-00005220: 6e2e 696e 666f 2e6d 6178 5f6d 656d 6f72  n.info.max_memor
-00005230: 792c 2063 6f6e 2e69 6e66 6f2e 6375 7272  y, con.info.curr
-00005240: 656e 745f 6d65 6d6f 7279 290a 2020 2020  ent_memory).    
-00005250: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00005260: 6572 7447 7265 6174 6572 2863 6f6e 2e69  ertGreater(con.i
-00005270: 6e66 6f2e 6f69 742c 2031 290a 2020 2020  nfo.oit, 1).    
-00005280: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00005290: 6572 7447 7265 6174 6572 2863 6f6e 2e69  ertGreater(con.i
-000052a0: 6e66 6f2e 6f61 742c 2031 290a 2020 2020  nfo.oat, 1).    
-000052b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000052c0: 6572 7447 7265 6174 6572 2863 6f6e 2e69  ertGreater(con.i
-000052d0: 6e66 6f2e 6f73 742c 2031 290a 2020 2020  nfo.ost, 1).    
-000052e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000052f0: 6572 7447 7265 6174 6572 2863 6f6e 2e69  ertGreater(con.i
-00005300: 6e66 6f2e 6e65 7874 5f74 7261 6e73 6163  nfo.next_transac
-00005310: 7469 6f6e 2c20 3129 0a20 2020 2020 2020  tion, 1).       
-00005320: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00005330: 4c65 7373 4571 7561 6c28 636f 6e2e 696e  LessEqual(con.in
-00005340: 666f 2e6f 6974 2c20 636f 6e2e 696e 666f  fo.oit, con.info
-00005350: 2e6f 6174 290a 2020 2020 2020 2020 2020  .oat).          
-00005360: 2020 7365 6c66 2e61 7373 6572 744c 6573    self.assertLes
-00005370: 7345 7175 616c 2863 6f6e 2e69 6e66 6f2e  sEqual(con.info.
-00005380: 6f69 742c 2063 6f6e 2e69 6e66 6f2e 6f73  oit, con.info.os
-00005390: 7429 0a20 2020 2020 2020 2020 2020 2073  t).            s
-000053a0: 656c 662e 6173 7365 7274 4c65 7373 4571  elf.assertLessEq
-000053b0: 7561 6c28 636f 6e2e 696e 666f 2e6f 6974  ual(con.info.oit
-000053c0: 2c20 636f 6e2e 696e 666f 2e6e 6578 745f  , con.info.next_
-000053d0: 7472 616e 7361 6374 696f 6e29 0a20 2020  transaction).   
-000053e0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-000053f0: 7365 7274 4c65 7373 4571 7561 6c28 636f  sertLessEqual(co
-00005400: 6e2e 696e 666f 2e6f 6174 2c20 636f 6e2e  n.info.oat, con.
-00005410: 696e 666f 2e6e 6578 745f 7472 616e 7361  info.next_transa
-00005420: 6374 696f 6e29 0a20 2020 2020 2020 2020  ction).         
-00005430: 2020 2073 656c 662e 6173 7365 7274 4c65     self.assertLe
-00005440: 7373 4571 7561 6c28 636f 6e2e 696e 666f  ssEqual(con.info
-00005450: 2e6f 7374 2c20 636f 6e2e 696e 666f 2e6e  .ost, con.info.n
-00005460: 6578 745f 7472 616e 7361 6374 696f 6e29  ext_transaction)
-00005470: 0a20 2020 2020 2020 2020 2020 2023 0a20  .            #. 
-00005480: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005490: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
-000054a0: 2863 6f6e 2e69 6e66 6f2e 7265 6164 732c  (con.info.reads,
-000054b0: 2069 6e74 290a 2020 2020 2020 2020 2020   int).          
-000054c0: 2020 7365 6c66 2e61 7373 6572 7449 7349    self.assertIsI
-000054d0: 6e73 7461 6e63 6528 636f 6e2e 696e 666f  nstance(con.info
-000054e0: 2e66 6574 6368 6573 2c20 696e 7429 0a20  .fetches, int). 
-000054f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005500: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
-00005510: 2863 6f6e 2e69 6e66 6f2e 7772 6974 6573  (con.info.writes
-00005520: 2c20 696e 7429 0a20 2020 2020 2020 2020  , int).         
-00005530: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
-00005540: 496e 7374 616e 6365 2863 6f6e 2e69 6e66  Instance(con.inf
-00005550: 6f2e 6d61 726b 732c 2069 6e74 290a 2020  o.marks, int).  
-00005560: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00005570: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-00005580: 636f 6e2e 696e 666f 2e63 6163 6865 5f68  con.info.cache_h
-00005590: 6974 5f72 6174 696f 2c20 666c 6f61 7429  it_ratio, float)
-000055a0: 0a20 2020 2020 2020 2020 2020 2023 2046  .            # F
-000055b0: 756e 6374 696f 6e73 0a20 2020 2020 2020  unctions.       
-000055c0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000055d0: 4571 7561 6c28 6c65 6e28 636f 6e2e 696e  Equal(len(con.in
-000055e0: 666f 2e67 6574 5f70 6167 655f 636f 6e74  fo.get_page_cont
-000055f0: 656e 7428 3029 292c 2063 6f6e 2e69 6e66  ent(0)), con.inf
-00005600: 6f2e 7061 6765 5f73 697a 6529 0a20 2020  o.page_size).   
-00005610: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00005620: 7365 7274 4973 496e 7374 616e 6365 2863  sertIsInstance(c
-00005630: 6f6e 2e69 6e66 6f2e 6973 5f63 6f6d 7072  on.info.is_compr
-00005640: 6573 7365 6428 292c 2062 6f6f 6c29 0a20  essed(), bool). 
-00005650: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005660: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
-00005670: 2863 6f6e 2e69 6e66 6f2e 6973 5f65 6e63  (con.info.is_enc
-00005680: 7279 7074 6564 2829 2c20 626f 6f6c 290a  rypted(), bool).
-00005690: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000056a0: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
-000056b0: 2863 6f6e 2e69 6e66 6f2e 6765 745f 6163  (con.info.get_ac
-000056c0: 7469 7665 5f74 7261 6e73 6163 7469 6f6e  tive_transaction
-000056d0: 5f69 6473 2829 2c20 5b5d 290a 2020 2020  _ids(), []).    
-000056e0: 2020 2020 2020 2020 7769 7468 2063 6f6e          with con
-000056f0: 2e74 7261 6e73 6163 7469 6f6e 5f6d 616e  .transaction_man
-00005700: 6167 6572 2829 2061 7320 7431 2c20 636f  ager() as t1, co
-00005710: 6e2e 7472 616e 7361 6374 696f 6e5f 6d61  n.transaction_ma
-00005720: 6e61 6765 7228 2920 6173 2074 323a 0a20  nager() as t2:. 
-00005730: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00005740: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
-00005750: 7561 6c28 636f 6e2e 696e 666f 2e67 6574  ual(con.info.get
-00005760: 5f61 6374 6976 655f 7472 616e 7361 6374  _active_transact
-00005770: 696f 6e5f 6964 7328 292c 0a20 2020 2020  ion_ids(),.     
-00005780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000057a0: 5b74 312e 696e 666f 2e69 642c 2074 322e  [t1.info.id, t2.
-000057b0: 696e 666f 2e69 645d 290a 2020 2020 2020  info.id]).      
-000057c0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000057d0: 7373 6572 7445 7175 616c 2863 6f6e 2e69  ssertEqual(con.i
-000057e0: 6e66 6f2e 6765 745f 6163 7469 7665 5f74  nfo.get_active_t
-000057f0: 7261 6e73 6163 7469 6f6e 5f63 6f75 6e74  ransaction_count
-00005800: 2829 2c20 3229 0a20 2020 2020 2020 2020  (), 2).         
-00005810: 2020 2073 203d 2063 6f6e 2e69 6e66 6f2e     s = con.info.
-00005820: 6765 745f 7461 626c 655f 6163 6365 7373  get_table_access
-00005830: 5f73 7461 7473 2829 0a20 2020 2020 2020  _stats().       
-00005840: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00005850: 496e 286c 656e 2873 292c 205b 362c 3132  In(len(s), [6,12
-00005860: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
-00005870: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
-00005880: 616e 6365 2873 5b30 5d2c 2064 7269 7665  ance(s[0], drive
-00005890: 722e 7479 7065 732e 5461 626c 6541 6363  r.types.TableAcc
-000058a0: 6573 7353 7461 7473 290a 2020 2020 2020  essStats).      
-000058b0: 2020 2020 2020 2320 4c6f 7720 6c65 7665        # Low leve
-000058c0: 6c20 696e 666f 2063 616c 6c73 0a20 2020  l info calls.   
-000058d0: 2020 2020 2020 2020 2077 6974 6820 636f           with co
-000058e0: 6e2e 7472 616e 7361 6374 696f 6e5f 6d61  n.transaction_ma
-000058f0: 6e61 6765 7228 2920 6173 2074 312c 2063  nager() as t1, c
-00005900: 6f6e 2e74 7261 6e73 6163 7469 6f6e 5f6d  on.transaction_m
-00005910: 616e 6167 6572 2829 2061 7320 7432 3a0a  anager() as t2:.
-00005920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005930: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
-00005940: 7175 616c 2863 6f6e 2e69 6e66 6f2e 6765  qual(con.info.ge
-00005950: 745f 696e 666f 2844 6249 6e66 6f43 6f64  t_info(DbInfoCod
-00005960: 652e 4143 5449 5645 5f54 5241 4e53 4143  e.ACTIVE_TRANSAC
-00005970: 5449 4f4e 5329 2c0a 2020 2020 2020 2020  TIONS),.        
-00005980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005990: 2020 2020 2020 2020 2020 2020 205b 7431               [t1
-000059a0: 2e69 6e66 6f2e 6964 2c20 7432 2e69 6e66  .info.id, t2.inf
-000059b0: 6f2e 6964 5d29 0a20 2020 2020 2020 2020  o.id]).         
-000059c0: 2020 2023 0a20 2020 2020 2020 2020 2020     #.           
-000059d0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000059e0: 6c28 636f 6e2e 696e 666f 2e67 6574 5f69  l(con.info.get_i
-000059f0: 6e66 6f28 4462 496e 666f 436f 6465 2e50  nfo(DbInfoCode.P
-00005a00: 4147 455f 5349 5a45 292c 2038 3139 3229  AGE_SIZE), 8192)
-00005a10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005a20: 662e 6173 7365 7274 4571 7561 6c28 636f  f.assertEqual(co
-00005a30: 6e2e 696e 666f 2e67 6574 5f69 6e66 6f28  n.info.get_info(
-00005a40: 4462 496e 666f 436f 6465 2e44 425f 5245  DbInfoCode.DB_RE
-00005a50: 4144 5f4f 4e4c 5929 2c20 3029 0a20 2020  AD_ONLY), 0).   
-00005a60: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00005a70: 7365 7274 4571 7561 6c28 636f 6e2e 696e  sertEqual(con.in
-00005a80: 666f 2e67 6574 5f69 6e66 6f28 4462 496e  fo.get_info(DbIn
-00005a90: 666f 436f 6465 2e44 425f 5351 4c5f 4449  foCode.DB_SQL_DI
-00005aa0: 414c 4543 5429 2c20 3329 0a20 2020 2020  ALECT), 3).     
-00005ab0: 2020 2020 2020 2072 6573 203d 2063 6f6e         res = con
-00005ac0: 2e69 6e66 6f2e 6765 745f 696e 666f 2844  .info.get_info(D
-00005ad0: 6249 6e66 6f43 6f64 652e 5553 4552 5f4e  bInfoCode.USER_N
-00005ae0: 414d 4553 290a 2020 2020 2020 2020 2020  AMES).          
-00005af0: 2020 7365 6c66 2e61 7373 6572 7444 6963    self.assertDic
-00005b00: 7445 7175 616c 2872 6573 2c20 7b27 5359  tEqual(res, {'SY
-00005b10: 5344 4241 273a 2031 7d29 0a20 2020 2020  SDBA': 1}).     
-00005b20: 2020 2020 2020 2072 6573 203d 2063 6f6e         res = con
-00005b30: 2e69 6e66 6f2e 6765 745f 696e 666f 2844  .info.get_info(D
-00005b40: 6249 6e66 6f43 6f64 652e 5245 4144 5f53  bInfoCode.READ_S
-00005b50: 4551 5f43 4f55 4e54 290a 2020 2020 2020  EQ_COUNT).      
-00005b60: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00005b70: 744c 6973 7445 7175 616c 286c 6973 7428  tListEqual(list(
-00005b80: 7265 7329 2c20 5b30 2c20 315d 290a 2020  res), [0, 1]).  
-00005b90: 2020 2020 2020 2020 2020 230a 2020 2020            #.    
-00005ba0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00005bb0: 6572 7449 7349 6e73 7461 6e63 6528 636f  ertIsInstance(co
-00005bc0: 6e2e 696e 666f 2e67 6574 5f69 6e66 6f28  n.info.get_info(
-00005bd0: 4462 496e 666f 436f 6465 2e41 4c4c 4f43  DbInfoCode.ALLOC
-00005be0: 4154 494f 4e29 2c20 696e 7429 0a20 2020  ATION), int).   
-00005bf0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00005c00: 7365 7274 4973 496e 7374 616e 6365 2863  sertIsInstance(c
-00005c10: 6f6e 2e69 6e66 6f2e 6765 745f 696e 666f  on.info.get_info
-00005c20: 2844 6249 6e66 6f43 6f64 652e 4241 5345  (DbInfoCode.BASE
-00005c30: 5f4c 4556 454c 292c 2069 6e74 290a 2020  _LEVEL), int).  
-00005c40: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
-00005c50: 636f 6e2e 696e 666f 2e67 6574 5f69 6e66  con.info.get_inf
-00005c60: 6f28 4462 496e 666f 436f 6465 2e44 425f  o(DbInfoCode.DB_
-00005c70: 4944 290a 2020 2020 2020 2020 2020 2020  ID).            
-00005c80: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
-00005c90: 7461 6e63 6528 7265 732c 206c 6973 7429  tance(res, list)
-00005ca0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005cb0: 662e 6173 7365 7274 4571 7561 6c28 7265  f.assertEqual(re
-00005cc0: 735b 305d 2e75 7070 6572 2829 2c20 7365  s[0].upper(), se
-00005cd0: 6c66 2e64 6266 696c 652e 7570 7065 7228  lf.dbfile.upper(
-00005ce0: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-00005cf0: 6573 203d 2063 6f6e 2e69 6e66 6f2e 6765  es = con.info.ge
-00005d00: 745f 696e 666f 2844 6249 6e66 6f43 6f64  t_info(DbInfoCod
-00005d10: 652e 494d 504c 454d 454e 5441 5449 4f4e  e.IMPLEMENTATION
-00005d20: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00005d30: 6c66 2e61 7373 6572 7449 7349 6e73 7461  lf.assertIsInsta
-00005d40: 6e63 6528 7265 732c 2074 7570 6c65 290a  nce(res, tuple).
-00005d50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005d60: 2e61 7373 6572 7445 7175 616c 286c 656e  .assertEqual(len
-00005d70: 2872 6573 292c 2034 290a 2020 2020 2020  (res), 4).      
-00005d80: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00005d90: 7449 7349 6e73 7461 6e63 6528 7265 735b  tIsInstance(res[
-00005da0: 305d 2c20 6472 6976 6572 2e74 7970 6573  0], driver.types
-00005db0: 2e49 6d70 4350 5529 0a20 2020 2020 2020  .ImpCPU).       
-00005dc0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00005dd0: 4973 496e 7374 616e 6365 2872 6573 5b31  IsInstance(res[1
-00005de0: 5d2c 2064 7269 7665 722e 7479 7065 732e  ], driver.types.
-00005df0: 496d 704f 5329 0a20 2020 2020 2020 2020  ImpOS).         
-00005e00: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
-00005e10: 496e 7374 616e 6365 2872 6573 5b32 5d2c  Instance(res[2],
-00005e20: 2064 7269 7665 722e 7479 7065 732e 496d   driver.types.Im
-00005e30: 7043 6f6d 7069 6c65 7229 0a20 2020 2020  pCompiler).     
-00005e40: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00005e50: 7274 4973 496e 7374 616e 6365 2872 6573  rtIsInstance(res
-00005e60: 5b33 5d2c 2064 7269 7665 722e 7479 7065  [3], driver.type
-00005e70: 732e 496d 7046 6c61 6773 290a 2020 2020  s.ImpFlags).    
-00005e80: 2020 2020 2020 2020 7265 7320 3d20 636f          res = co
-00005e90: 6e2e 696e 666f 2e67 6574 5f69 6e66 6f28  n.info.get_info(
-00005ea0: 4462 496e 666f 436f 6465 2e49 4d50 4c45  DbInfoCode.IMPLE
-00005eb0: 4d45 4e54 4154 494f 4e5f 4f4c 4429 0a20  MENTATION_OLD). 
-00005ec0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005ed0: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
-00005ee0: 2872 6573 2c20 7475 706c 6529 0a20 2020  (res, tuple).   
-00005ef0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00005f00: 7365 7274 4571 7561 6c28 6c65 6e28 7265  sertEqual(len(re
-00005f10: 7329 2c20 3229 0a20 2020 2020 2020 2020  s), 2).         
-00005f20: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
-00005f30: 496e 7374 616e 6365 2872 6573 5b30 5d2c  Instance(res[0],
-00005f40: 2069 6e74 290a 2020 2020 2020 2020 2020   int).          
-00005f50: 2020 7365 6c66 2e61 7373 6572 7449 7349    self.assertIsI
-00005f60: 6e73 7461 6e63 6528 7265 735b 315d 2c20  nstance(res[1], 
-00005f70: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
-00005f80: 2073 656c 662e 6173 7365 7274 496e 2872   self.assertIn(r
-00005f90: 6573 5b30 5d2c 2064 7269 7665 722e 7479  es[0], driver.ty
-00005fa0: 7065 732e 496d 706c 656d 656e 7461 7469  pes.Implementati
-00005fb0: 6f6e 2e5f 7661 6c75 6532 6d65 6d62 6572  on._value2member
-00005fc0: 5f6d 6170 5f29 0a20 2020 2020 2020 2020  _map_).         
-00005fd0: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-00005fe0: 2827 4669 7265 6269 7264 272c 2063 6f6e  ('Firebird', con
-00005ff0: 2e69 6e66 6f2e 6765 745f 696e 666f 2844  .info.get_info(D
-00006000: 6249 6e66 6f43 6f64 652e 5645 5253 494f  bInfoCode.VERSIO
-00006010: 4e29 290a 2020 2020 2020 2020 2020 2020  N)).            
-00006020: 7365 6c66 2e61 7373 6572 7449 6e28 2746  self.assertIn('F
-00006030: 6972 6562 6972 6427 2c20 636f 6e2e 696e  irebird', con.in
-00006040: 666f 2e67 6574 5f69 6e66 6f28 4462 496e  fo.get_info(DbIn
-00006050: 666f 436f 6465 2e46 4952 4542 4952 445f  foCode.FIREBIRD_
-00006060: 5645 5253 494f 4e29 290a 2020 2020 2020  VERSION)).      
-00006070: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00006080: 7449 6e28 636f 6e2e 696e 666f 2e67 6574  tIn(con.info.get
-00006090: 5f69 6e66 6f28 4462 496e 666f 436f 6465  _info(DbInfoCode
-000060a0: 2e4e 4f5f 5245 5345 5256 4529 2c20 2830  .NO_RESERVE), (0
-000060b0: 2c20 3129 290a 2020 2020 2020 2020 2020  , 1)).          
-000060c0: 2020 7365 6c66 2e61 7373 6572 7449 6e28    self.assertIn(
-000060d0: 636f 6e2e 696e 666f 2e67 6574 5f69 6e66  con.info.get_inf
-000060e0: 6f28 4462 496e 666f 436f 6465 2e46 4f52  o(DbInfoCode.FOR
-000060f0: 4345 445f 5752 4954 4553 292c 2028 302c  CED_WRITES), (0,
-00006100: 2031 2929 0a20 2020 2020 2020 2020 2020   1)).           
-00006110: 2073 656c 662e 6173 7365 7274 4973 496e   self.assertIsIn
-00006120: 7374 616e 6365 2863 6f6e 2e69 6e66 6f2e  stance(con.info.
-00006130: 6765 745f 696e 666f 2844 6249 6e66 6f43  get_info(DbInfoC
-00006140: 6f64 652e 4241 5345 5f4c 4556 454c 292c  ode.BASE_LEVEL),
-00006150: 2069 6e74 290a 2020 2020 2020 2020 2020   int).          
-00006160: 2020 7365 6c66 2e61 7373 6572 7449 7349    self.assertIsI
-00006170: 6e73 7461 6e63 6528 636f 6e2e 696e 666f  nstance(con.info
-00006180: 2e67 6574 5f69 6e66 6f28 4462 496e 666f  .get_info(DbInfo
-00006190: 436f 6465 2e4f 4453 5f56 4552 5349 4f4e  Code.ODS_VERSION
-000061a0: 292c 2069 6e74 290a 2020 2020 2020 2020  ), int).        
-000061b0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-000061c0: 7349 6e73 7461 6e63 6528 636f 6e2e 696e  sInstance(con.in
-000061d0: 666f 2e67 6574 5f69 6e66 6f28 4462 496e  fo.get_info(DbIn
-000061e0: 666f 436f 6465 2e4f 4453 5f4d 494e 4f52  foCode.ODS_MINOR
-000061f0: 5f56 4552 5349 4f4e 292c 2069 6e74 290a  _VERSION), int).
-00006200: 2020 2020 2020 2020 2020 2020 230a 0a0a              #...
-00006210: 636c 6173 7320 5465 7374 5472 616e 7361  class TestTransa
-00006220: 6374 696f 6e28 4472 6976 6572 5465 7374  ction(DriverTest
-00006230: 4261 7365 293a 0a20 2020 2064 6566 2073  Base):.    def s
-00006240: 6574 5570 2873 656c 6629 3a0a 2020 2020  etUp(self):.    
-00006250: 2020 2020 7375 7065 7228 292e 7365 7455      super().setU
-00006260: 7028 290a 2020 2020 2020 2020 7365 6c66  p().        self
-00006270: 2e64 6266 696c 6520 3d20 6f73 2e70 6174  .dbfile = os.pat
-00006280: 682e 6a6f 696e 2873 656c 662e 6462 7061  h.join(self.dbpa
-00006290: 7468 2c20 7365 6c66 2e46 4254 4553 545f  th, self.FBTEST_
-000062a0: 4442 290a 2020 2020 2020 2020 7365 6c66  DB).        self
-000062b0: 2e63 6f6e 203d 2063 6f6e 6e65 6374 2866  .con = connect(f
-000062c0: 277b 4642 5445 5354 5f48 4f53 547d 3a7b  '{FBTEST_HOST}:{
-000062d0: 7365 6c66 2e64 6266 696c 657d 272c 2075  self.dbfile}', u
-000062e0: 7365 723d 4642 5445 5354 5f55 5345 522c  ser=FBTEST_USER,
-000062f0: 2070 6173 7377 6f72 643d 4642 5445 5354   password=FBTEST
-00006300: 5f50 4153 5357 4f52 4429 0a20 2020 2020  _PASSWORD).     
-00006310: 2020 2073 656c 662e 636f 6e2e 5f6c 6f67     self.con._log
-00006320: 6769 6e67 5f69 645f 203d 2073 656c 662e  ging_id_ = self.
-00006330: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00006340: 5f5f 0a20 2020 2020 2020 2023 7365 6c66  __.        #self
-00006350: 2e63 6f6e 2e65 7865 6375 7465 5f69 6d6d  .con.execute_imm
-00006360: 6564 6961 7465 2822 7265 6372 6561 7465  ediate("recreate
-00006370: 2074 6162 6c65 2074 2028 6331 2069 6e74   table t (c1 int
-00006380: 6567 6572 2922 290a 2020 2020 2020 2020  eger)").        
-00006390: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
-000063a0: 5f69 6d6d 6564 6961 7465 2822 6465 6c65  _immediate("dele
-000063b0: 7465 2066 726f 6d20 7422 290a 2020 2020  te from t").    
-000063c0: 2020 2020 7365 6c66 2e63 6f6e 2e63 6f6d      self.con.com
-000063d0: 6d69 7428 290a 2020 2020 6465 6620 7465  mit().    def te
-000063e0: 6172 446f 776e 2873 656c 6629 3a0a 2020  arDown(self):.  
-000063f0: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
-00006400: 6c6f 7365 2829 0a20 2020 2064 6566 2074  lose().    def t
-00006410: 6573 745f 6375 7273 6f72 2873 656c 6629  est_cursor(self)
-00006420: 3a0a 2020 2020 2020 2020 7769 7468 2073  :.        with s
-00006430: 656c 662e 636f 6e3a 0a20 2020 2020 2020  elf.con:.       
-00006440: 2020 2020 2074 7220 3d20 7365 6c66 2e63       tr = self.c
-00006450: 6f6e 2e6d 6169 6e5f 7472 616e 7361 6374  on.main_transact
-00006460: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00006470: 7472 2e62 6567 696e 2829 0a20 2020 2020  tr.begin().     
-00006480: 2020 2020 2020 2077 6974 6820 7472 2e63         with tr.c
-00006490: 7572 736f 7228 2920 6173 2063 7572 3a0a  ursor() as cur:.
-000064a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000064b0: 6375 722e 6578 6563 7574 6528 2269 6e73  cur.execute("ins
-000064c0: 6572 7420 696e 746f 2074 2028 6331 2920  ert into t (c1) 
-000064d0: 7661 6c75 6573 2028 3129 2229 0a20 2020  values (1)").   
-000064e0: 2020 2020 2020 2020 2020 2020 2074 722e               tr.
-000064f0: 636f 6d6d 6974 2829 0a20 2020 2020 2020  commit().       
-00006500: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-00006510: 6375 7465 2822 7365 6c65 6374 202a 2066  cute("select * f
-00006520: 726f 6d20 7422 290a 2020 2020 2020 2020  rom t").        
-00006530: 2020 2020 2020 2020 726f 7773 203d 2063          rows = c
-00006540: 7572 2e66 6574 6368 616c 6c28 290a 2020  ur.fetchall().  
-00006550: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00006560: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-00006570: 616c 2872 6f77 732c 205b 2831 2c29 5d29  al(rows, [(1,)])
-00006580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006590: 2063 7572 2e65 7865 6375 7465 2822 6465   cur.execute("de
-000065a0: 6c65 7465 2066 726f 6d20 7422 290a 2020  lete from t").  
-000065b0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-000065c0: 2e63 6f6d 6d69 7428 290a 2020 2020 2020  .commit().      
-000065d0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000065e0: 7373 6572 7445 7175 616c 286c 656e 2874  ssertEqual(len(t
-000065f0: 722e 6375 7273 6f72 7329 2c20 3129 0a20  r.cursors), 1). 
-00006600: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00006610: 656c 662e 6173 7365 7274 4973 2874 722e  elf.assertIs(tr.
-00006620: 6375 7273 6f72 735b 305d 2c20 6375 7229  cursors[0], cur)
-00006630: 0a20 2020 2064 6566 2074 6573 745f 636f  .    def test_co
-00006640: 6e74 6578 745f 6d61 6e61 6765 7228 7365  ntext_manager(se
-00006650: 6c66 293a 0a20 2020 2020 2020 2077 6974  lf):.        wit
-00006660: 6820 7365 6c66 2e63 6f6e 2e63 7572 736f  h self.con.curso
-00006670: 7228 2920 6173 2063 7572 3a0a 2020 2020  r() as cur:.    
-00006680: 2020 2020 2020 2020 7769 7468 2074 7261          with tra
-00006690: 6e73 6163 7469 6f6e 2873 656c 662e 636f  nsaction(self.co
-000066a0: 6e29 3a0a 2020 2020 2020 2020 2020 2020  n):.            
-000066b0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
-000066c0: 2269 6e73 6572 7420 696e 746f 2074 2028  "insert into t (
-000066d0: 6331 2920 7661 6c75 6573 2028 3129 2229  c1) values (1)")
-000066e0: 0a0a 2020 2020 2020 2020 2020 2020 6375  ..            cu
-000066f0: 722e 6578 6563 7574 6528 2273 656c 6563  r.execute("selec
-00006700: 7420 2a20 6672 6f6d 2074 2229 0a20 2020  t * from t").   
-00006710: 2020 2020 2020 2020 2072 6f77 7320 3d20           rows = 
-00006720: 6375 722e 6665 7463 6861 6c6c 2829 0a20  cur.fetchall(). 
-00006730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006740: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
-00006750: 726f 7773 2c20 5b28 312c 295d 290a 0a20  rows, [(1,)]).. 
-00006760: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00006770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006780: 7769 7468 2074 7261 6e73 6163 7469 6f6e  with transaction
-00006790: 2873 656c 662e 636f 6e29 3a0a 2020 2020  (self.con):.    
-000067a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000067b0: 6375 722e 6578 6563 7574 6528 2264 656c  cur.execute("del
-000067c0: 6574 6520 6672 6f6d 2074 2229 0a20 2020  ete from t").   
-000067d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000067e0: 2072 6169 7365 2045 7863 6570 7469 6f6e   raise Exception
-000067f0: 2829 0a20 2020 2020 2020 2020 2020 2065  ().            e
-00006800: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
-00006810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006820: 2070 6173 730a 0a20 2020 2020 2020 2020   pass..         
-00006830: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
-00006840: 7365 6c65 6374 202a 2066 726f 6d20 7422  select * from t"
-00006850: 290a 2020 2020 2020 2020 2020 2020 726f  ).            ro
-00006860: 7773 203d 2063 7572 2e66 6574 6368 616c  ws = cur.fetchal
-00006870: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
-00006880: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
-00006890: 7175 616c 2872 6f77 732c 205b 2831 2c29  qual(rows, [(1,)
-000068a0: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-000068b0: 7769 7468 2074 7261 6e73 6163 7469 6f6e  with transaction
-000068c0: 2873 656c 662e 636f 6e29 3a0a 2020 2020  (self.con):.    
-000068d0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-000068e0: 6578 6563 7574 6528 2264 656c 6574 6520  execute("delete 
-000068f0: 6672 6f6d 2074 2229 0a0a 2020 2020 2020  from t")..      
-00006900: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
-00006910: 6528 2273 656c 6563 7420 2a20 6672 6f6d  e("select * from
-00006920: 2074 2229 0a20 2020 2020 2020 2020 2020   t").           
-00006930: 2072 6f77 7320 3d20 6375 722e 6665 7463   rows = cur.fetc
-00006940: 6861 6c6c 2829 0a20 2020 2020 2020 2020  hall().         
-00006950: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
-00006960: 7374 4571 7561 6c28 726f 7773 2c20 5b5d  stEqual(rows, []
-00006970: 290a 2020 2020 6465 6620 7465 7374 5f73  ).    def test_s
-00006980: 6176 6570 6f69 6e74 2873 656c 6629 3a0a  avepoint(self):.
-00006990: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
-000069a0: 2e62 6567 696e 2829 0a20 2020 2020 2020  .begin().       
-000069b0: 2074 7220 3d20 7365 6c66 2e63 6f6e 2e6d   tr = self.con.m
-000069c0: 6169 6e5f 7472 616e 7361 6374 696f 6e0a  ain_transaction.
-000069d0: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
-000069e0: 2e65 7865 6375 7465 5f69 6d6d 6564 6961  .execute_immedia
-000069f0: 7465 2822 696e 7365 7274 2069 6e74 6f20  te("insert into 
-00006a00: 7420 2863 3129 2076 616c 7565 7320 2831  t (c1) values (1
-00006a10: 2922 290a 2020 2020 2020 2020 7472 2e73  )").        tr.s
-00006a20: 6176 6570 6f69 6e74 2827 7465 7374 2729  avepoint('test')
-00006a30: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-00006a40: 6e2e 6578 6563 7574 655f 696d 6d65 6469  n.execute_immedi
-00006a50: 6174 6528 2269 6e73 6572 7420 696e 746f  ate("insert into
-00006a60: 2074 2028 6331 2920 7661 6c75 6573 2028   t (c1) values (
-00006a70: 3229 2229 0a20 2020 2020 2020 2074 722e  2)").        tr.
-00006a80: 726f 6c6c 6261 636b 2873 6176 6570 6f69  rollback(savepoi
-00006a90: 6e74 3d27 7465 7374 2729 0a20 2020 2020  nt='test').     
-00006aa0: 2020 2074 722e 636f 6d6d 6974 2829 0a20     tr.commit(). 
-00006ab0: 2020 2020 2020 2077 6974 6820 7472 2e63         with tr.c
-00006ac0: 7572 736f 7228 2920 6173 2063 7572 3a0a  ursor() as cur:.
-00006ad0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-00006ae0: 6578 6563 7574 6528 2273 656c 6563 7420  execute("select 
-00006af0: 2a20 6672 6f6d 2074 2229 0a20 2020 2020  * from t").     
-00006b00: 2020 2020 2020 2072 6f77 7320 3d20 6375         rows = cu
-00006b10: 722e 6665 7463 6861 6c6c 2829 0a20 2020  r.fetchall().   
-00006b20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00006b30: 4c69 7374 4571 7561 6c28 726f 7773 2c20  ListEqual(rows, 
-00006b40: 5b28 312c 295d 290a 2020 2020 6465 6620  [(1,)]).    def 
-00006b50: 7465 7374 5f66 6574 6368 5f61 6674 6572  test_fetch_after
-00006b60: 5f63 6f6d 6d69 7428 7365 6c66 293a 0a20  _commit(self):. 
-00006b70: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
-00006b80: 6578 6563 7574 655f 696d 6d65 6469 6174  execute_immediat
-00006b90: 6528 2269 6e73 6572 7420 696e 746f 2074  e("insert into t
-00006ba0: 2028 6331 2920 7661 6c75 6573 2028 3129   (c1) values (1)
-00006bb0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00006bc0: 636f 6e2e 636f 6d6d 6974 2829 0a20 2020  con.commit().   
-00006bd0: 2020 2020 2077 6974 6820 7365 6c66 2e63       with self.c
-00006be0: 6f6e 2e63 7572 736f 7228 2920 6173 2063  on.cursor() as c
-00006bf0: 7572 3a0a 2020 2020 2020 2020 2020 2020  ur:.            
-00006c00: 6375 722e 6578 6563 7574 6528 2273 656c  cur.execute("sel
-00006c10: 6563 7420 2a20 6672 6f6d 2074 2229 0a20  ect * from t"). 
-00006c20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006c30: 636f 6e2e 636f 6d6d 6974 2829 0a20 2020  con.commit().   
-00006c40: 2020 2020 2020 2020 2077 6974 6820 7365           with se
-00006c50: 6c66 2e61 7373 6572 7452 6169 7365 7328  lf.assertRaises(
-00006c60: 496e 7465 7266 6163 6545 7272 6f72 2920  InterfaceError) 
-00006c70: 6173 2063 6d3a 0a20 2020 2020 2020 2020  as cm:.         
-00006c80: 2020 2020 2020 2063 7572 2e66 6574 6368         cur.fetch
-00006c90: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
-00006ca0: 2020 7365 6c66 2e61 7373 6572 7454 7570    self.assertTup
-00006cb0: 6c65 4571 7561 6c28 636d 2e65 7863 6570  leEqual(cm.excep
-00006cc0: 7469 6f6e 2e61 7267 732c 2028 2743 616e  tion.args, ('Can
-00006cd0: 6e6f 7420 6665 7463 6820 6672 6f6d 2063  not fetch from c
-00006ce0: 7572 736f 7220 7468 6174 2064 6964 206e  ursor that did n
-00006cf0: 6f74 2065 7865 6375 7465 6420 6120 7374  ot executed a st
-00006d00: 6174 656d 656e 742e 272c 2929 0a20 2020  atement.',)).   
-00006d10: 2064 6566 2074 6573 745f 6665 7463 685f   def test_fetch_
-00006d20: 6166 7465 725f 726f 6c6c 6261 636b 2873  after_rollback(s
-00006d30: 656c 6629 3a0a 2020 2020 2020 2020 7365  elf):.        se
-00006d40: 6c66 2e63 6f6e 2e65 7865 6375 7465 5f69  lf.con.execute_i
-00006d50: 6d6d 6564 6961 7465 2822 696e 7365 7274  mmediate("insert
-00006d60: 2069 6e74 6f20 7420 2863 3129 2076 616c   into t (c1) val
-00006d70: 7565 7320 2831 2922 290a 2020 2020 2020  ues (1)").      
-00006d80: 2020 7365 6c66 2e63 6f6e 2e72 6f6c 6c62    self.con.rollb
-00006d90: 6163 6b28 290a 2020 2020 2020 2020 7769  ack().        wi
-00006da0: 7468 2073 656c 662e 636f 6e2e 6375 7273  th self.con.curs
-00006db0: 6f72 2829 2061 7320 6375 723a 0a20 2020  or() as cur:.   
-00006dc0: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-00006dd0: 6375 7465 2822 7365 6c65 6374 202a 2066  cute("select * f
-00006de0: 726f 6d20 7422 290a 2020 2020 2020 2020  rom t").        
-00006df0: 2020 2020 7365 6c66 2e63 6f6e 2e63 6f6d      self.con.com
-00006e00: 6d69 7428 290a 2020 2020 2020 2020 2020  mit().          
-00006e10: 2020 7769 7468 2073 656c 662e 6173 7365    with self.asse
-00006e20: 7274 5261 6973 6573 2849 6e74 6572 6661  rtRaises(Interfa
-00006e30: 6365 4572 726f 7229 2061 7320 636d 3a0a  ceError) as cm:.
-00006e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e50: 6375 722e 6665 7463 6861 6c6c 2829 0a20  cur.fetchall(). 
-00006e60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006e70: 6173 7365 7274 5475 706c 6545 7175 616c  assertTupleEqual
-00006e80: 2863 6d2e 6578 6365 7074 696f 6e2e 6172  (cm.exception.ar
-00006e90: 6773 2c20 2827 4361 6e6e 6f74 2066 6574  gs, ('Cannot fet
-00006ea0: 6368 2066 726f 6d20 6375 7273 6f72 2074  ch from cursor t
-00006eb0: 6861 7420 6469 6420 6e6f 7420 6578 6563  hat did not exec
-00006ec0: 7574 6564 2061 2073 7461 7465 6d65 6e74  uted a statement
-00006ed0: 2e27 2c29 290a 2020 2020 6465 6620 7465  .',)).    def te
-00006ee0: 7374 5f74 7062 2873 656c 6629 3a0a 2020  st_tpb(self):.  
-00006ef0: 2020 2020 2020 7470 6220 3d20 5450 4228        tpb = TPB(
-00006f00: 6973 6f6c 6174 696f 6e3d 4973 6f6c 6174  isolation=Isolat
-00006f10: 696f 6e2e 5245 4144 5f43 4f4d 4d49 5454  ion.READ_COMMITT
-00006f20: 4544 2c20 6e6f 5f61 7574 6f5f 756e 646f  ED, no_auto_undo
-00006f30: 3d54 7275 6529 0a20 2020 2020 2020 2074  =True).        t
-00006f40: 7062 2e6c 6f63 6b5f 7469 6d65 6f75 7420  pb.lock_timeout 
-00006f50: 3d20 3130 0a20 2020 2020 2020 2074 7062  = 10.        tpb
-00006f60: 2e72 6573 6572 7665 5f74 6162 6c65 2827  .reserve_table('
-00006f70: 434f 554e 5452 5927 2c20 5461 626c 6553  COUNTRY', TableS
-00006f80: 6861 7265 4d6f 6465 2e50 524f 5445 4354  hareMode.PROTECT
-00006f90: 4544 2c20 5461 626c 6541 6363 6573 734d  ED, TableAccessM
-00006fa0: 6f64 652e 4c4f 434b 5f57 5249 5445 290a  ode.LOCK_WRITE).
-00006fb0: 2020 2020 2020 2020 7470 625f 6275 6666          tpb_buff
-00006fc0: 6572 203d 2074 7062 2e67 6574 5f62 7566  er = tpb.get_buf
-00006fd0: 6665 7228 290a 2020 2020 2020 2020 7769  fer().        wi
-00006fe0: 7468 2073 656c 662e 636f 6e2e 7472 616e  th self.con.tran
-00006ff0: 7361 6374 696f 6e5f 6d61 6e61 6765 7228  saction_manager(
-00007000: 7470 625f 6275 6666 6572 2920 6173 2074  tpb_buffer) as t
-00007010: 723a 0a20 2020 2020 2020 2020 2020 2069  r:.            i
-00007020: 6e66 6f20 3d20 7472 2e69 6e66 6f2e 6765  nfo = tr.info.ge
-00007030: 745f 696e 666f 2854 7261 496e 666f 436f  t_info(TraInfoCo
-00007040: 6465 2e49 534f 4c41 5449 4f4e 290a 2020  de.ISOLATION).  
-00007050: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00007060: 662e 7665 7273 696f 6e20 3d3d 2046 4234  f.version == FB4
-00007070: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-00007080: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-00007090: 2869 6e66 6f2c 205b 4973 6f6c 6174 696f  (info, [Isolatio
-000070a0: 6e2e 5245 4144 5f43 4f4d 4d49 5454 4544  n.READ_COMMITTED
-000070b0: 5f52 4541 445f 434f 4e53 4953 5445 4e43  _READ_CONSISTENC
-000070c0: 592c 0a20 2020 2020 2020 2020 2020 2020  Y,.             
-000070d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000070e0: 2020 2020 2020 2020 4973 6f6c 6174 696f          Isolatio
-000070f0: 6e2e 5245 4144 5f43 4f4d 4d49 5454 4544  n.READ_COMMITTED
-00007100: 5f52 4543 4f52 445f 5645 5253 494f 4e5d  _RECORD_VERSION]
-00007110: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00007120: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00007130: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00007140: 7175 616c 2869 6e66 6f2c 2049 736f 6c61  qual(info, Isola
-00007150: 7469 6f6e 2e52 4541 445f 434f 4d4d 4954  tion.READ_COMMIT
-00007160: 5445 445f 5245 434f 5244 5f56 4552 5349  TED_RECORD_VERSI
-00007170: 4f4e 290a 2020 2020 2020 2020 2020 2020  ON).            
-00007180: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00007190: 2874 722e 696e 666f 2e67 6574 5f69 6e66  (tr.info.get_inf
-000071a0: 6f28 5472 6149 6e66 6f43 6f64 652e 4143  o(TraInfoCode.AC
-000071b0: 4345 5353 292c 2054 7261 496e 666f 4163  CESS), TraInfoAc
-000071c0: 6365 7373 2e52 4541 445f 5752 4954 4529  cess.READ_WRITE)
-000071d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000071e0: 662e 6173 7365 7274 4571 7561 6c28 7472  f.assertEqual(tr
-000071f0: 2e69 6e66 6f2e 6c6f 636b 5f74 696d 656f  .info.lock_timeo
-00007200: 7574 2c20 3130 290a 2020 2020 2020 2020  ut, 10).        
-00007210: 6465 6c20 7470 620a 2020 2020 2020 2020  del tpb.        
-00007220: 7470 6220 3d20 5450 4228 290a 2020 2020  tpb = TPB().    
-00007230: 2020 2020 7470 622e 7061 7273 655f 6275      tpb.parse_bu
-00007240: 6666 6572 2874 7062 5f62 7566 6665 7229  ffer(tpb_buffer)
-00007250: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00007260: 7365 7274 4571 7561 6c28 7470 622e 6163  sertEqual(tpb.ac
-00007270: 6365 7373 5f6d 6f64 652c 2054 7261 4163  cess_mode, TraAc
-00007280: 6365 7373 4d6f 6465 2e57 5249 5445 290a  cessMode.WRITE).
-00007290: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000072a0: 6572 7445 7175 616c 2874 7062 2e69 736f  ertEqual(tpb.iso
-000072b0: 6c61 7469 6f6e 2c20 4973 6f6c 6174 696f  lation, Isolatio
-000072c0: 6e2e 5245 4144 5f43 4f4d 4d49 5454 4544  n.READ_COMMITTED
-000072d0: 5f52 4543 4f52 445f 5645 5253 494f 4e29  _RECORD_VERSION)
-000072e0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000072f0: 7365 7274 4571 7561 6c28 7470 622e 6c6f  sertEqual(tpb.lo
-00007300: 636b 5f74 696d 656f 7574 2c20 3130 290a  ck_timeout, 10).
-00007310: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00007320: 6572 7446 616c 7365 2874 7062 2e61 7574  ertFalse(tpb.aut
-00007330: 6f5f 636f 6d6d 6974 290a 2020 2020 2020  o_commit).      
-00007340: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00007350: 6528 7470 622e 6e6f 5f61 7574 6f5f 756e  e(tpb.no_auto_un
-00007360: 646f 290a 2020 2020 2020 2020 7365 6c66  do).        self
-00007370: 2e61 7373 6572 7446 616c 7365 2874 7062  .assertFalse(tpb
-00007380: 2e69 676e 6f72 655f 6c69 6d62 6f29 0a20  .ignore_limbo). 
-00007390: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000073a0: 7274 4c69 7374 4571 7561 6c28 7470 622e  rtListEqual(tpb.
-000073b0: 5f74 6162 6c65 5f72 6573 6572 7661 7469  _table_reservati
-000073c0: 6f6e 2c20 5b28 2743 4f55 4e54 5259 272c  on, [('COUNTRY',
-000073d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000073e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007400: 2020 2020 2020 2020 5461 626c 6553 6861          TableSha
-00007410: 7265 4d6f 6465 2e50 524f 5445 4354 4544  reMode.PROTECTED
-00007420: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00007430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007450: 2020 2020 2020 2020 2054 6162 6c65 4163           TableAc
-00007460: 6365 7373 4d6f 6465 2e4c 4f43 4b5f 5752  cessMode.LOCK_WR
-00007470: 4954 4529 5d29 0a20 2020 2064 6566 2074  ITE)]).    def t
-00007480: 6573 745f 7472 616e 7361 6374 696f 6e5f  est_transaction_
-00007490: 696e 666f 2873 656c 6629 3a0a 2020 2020  info(self):.    
-000074a0: 2020 2020 7365 6c66 2e63 6f6e 2e62 6567      self.con.beg
-000074b0: 696e 2829 0a20 2020 2020 2020 2077 6974  in().        wit
-000074c0: 6820 7365 6c66 2e63 6f6e 2e6d 6169 6e5f  h self.con.main_
-000074d0: 7472 616e 7361 6374 696f 6e20 6173 2074  transaction as t
-000074e0: 723a 0a20 2020 2020 2020 2020 2020 2073  r:.            s
-000074f0: 656c 662e 6173 7365 7274 5472 7565 2874  elf.assertTrue(t
-00007500: 722e 6973 5f61 6374 6976 6528 2929 0a20  r.is_active()). 
-00007510: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00007520: 6173 7365 7274 496e 2873 656c 662e 6462  assertIn(self.db
-00007530: 6669 6c65 2c20 7472 2e69 6e66 6f2e 6461  file, tr.info.da
-00007540: 7461 6261 7365 290a 2020 2020 2020 2020  tabase).        
-00007550: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00007560: 7175 616c 2874 722e 696e 666f 2e69 736f  qual(tr.info.iso
-00007570: 6c61 7469 6f6e 2c20 4973 6f6c 6174 696f  lation, Isolatio
-00007580: 6e2e 534e 4150 5348 4f54 290a 2020 2020  n.SNAPSHOT).    
-00007590: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
-000075a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000075b0: 7447 7265 6174 6572 2874 722e 696e 666f  tGreater(tr.info
-000075c0: 2e69 642c 2030 290a 2020 2020 2020 2020  .id, 0).        
-000075d0: 2020 2020 7365 6c66 2e61 7373 6572 7447      self.assertG
-000075e0: 7265 6174 6572 2874 722e 696e 666f 2e6f  reater(tr.info.o
-000075f0: 6974 2c20 3029 0a20 2020 2020 2020 2020  it, 0).         
-00007600: 2020 2073 656c 662e 6173 7365 7274 4772     self.assertGr
-00007610: 6561 7465 7228 7472 2e69 6e66 6f2e 6f61  eater(tr.info.oa
-00007620: 742c 2030 290a 2020 2020 2020 2020 2020  t, 0).          
-00007630: 2020 7365 6c66 2e61 7373 6572 7447 7265    self.assertGre
-00007640: 6174 6572 2874 722e 696e 666f 2e6f 7374  ater(tr.info.ost
+00003dd0: 6173 7365 7274 496e 2863 6f6e 2e6d 6169  assertIn(con.mai
+00003de0: 6e5f 7472 616e 7361 6374 696f 6e2c 2063  n_transaction, c
+00003df0: 6f6e 2e74 7261 6e73 6163 7469 6f6e 7329  on.transactions)
+00003e00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00003e10: 662e 6173 7365 7274 496e 2863 6f6e 2e71  f.assertIn(con.q
+00003e20: 7565 7279 5f74 7261 6e73 6163 7469 6f6e  uery_transaction
+00003e30: 2c20 636f 6e2e 7472 616e 7361 6374 696f  , con.transactio
+00003e40: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
+00003e50: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00003e60: 286c 656e 2863 6f6e 2e74 7261 6e73 6163  (len(con.transac
+00003e70: 7469 6f6e 7329 2c20 3229 0a20 2020 2020  tions), 2).     
+00003e80: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00003e90: 7274 4571 7561 6c28 636f 6e2e 6465 6661  rtEqual(con.defa
+00003ea0: 756c 745f 7470 622c 2074 7062 2849 736f  ult_tpb, tpb(Iso
+00003eb0: 6c61 7469 6f6e 2e53 4e41 5053 484f 5429  lation.SNAPSHOT)
+00003ec0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00003ed0: 6c66 2e61 7373 6572 7446 616c 7365 2863  lf.assertFalse(c
+00003ee0: 6f6e 2e69 735f 6163 7469 7665 2829 290a  on.is_active()).
+00003ef0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00003f00: 2e61 7373 6572 7446 616c 7365 2863 6f6e  .assertFalse(con
+00003f10: 2e69 735f 636c 6f73 6564 2829 290a 2020  .is_closed()).  
+00003f20: 2020 6465 6620 7465 7374 5f63 6f6e 6e65    def test_conne
+00003f30: 6374 5f72 6f6c 6528 7365 6c66 293a 0a20  ct_role(self):. 
+00003f40: 2020 2020 2020 2072 6f6c 656e 616d 6520         rolename 
+00003f50: 3d20 2772 6f6c 6527 0a20 2020 2020 2020  = 'role'.       
+00003f60: 2077 6974 6820 636f 6e6e 6563 7428 7365   with connect(se
+00003f70: 6c66 2e64 6266 696c 652c 2075 7365 723d  lf.dbfile, user=
+00003f80: 4642 5445 5354 5f55 5345 522c 0a20 2020  FBTEST_USER,.   
+00003f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003fa0: 2020 7061 7373 776f 7264 3d46 4254 4553    password=FBTES
+00003fb0: 545f 5041 5353 574f 5244 2c20 726f 6c65  T_PASSWORD, role
+00003fc0: 3d72 6f6c 656e 616d 6529 2061 7320 636f  =rolename) as co
+00003fd0: 6e3a 0a20 2020 2020 2020 2020 2020 2063  n:.            c
+00003fe0: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
+00003ff0: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
+00004000: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
+00004010: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00004020: 7449 734e 6f74 4e6f 6e65 2863 6f6e 2e5f  tIsNotNone(con._
+00004030: 6174 7429 0a20 2020 2020 2020 2020 2020  att).           
+00004040: 2064 7062 203d 205b 312c 2030 7831 632c   dpb = [1, 0x1c,
+00004050: 206c 656e 2846 4254 4553 545f 5553 4552   len(FBTEST_USER
+00004060: 295d 0a20 2020 2020 2020 2020 2020 2064  )].            d
+00004070: 7062 2e65 7874 656e 6428 6f72 6428 7829  pb.extend(ord(x)
+00004080: 2066 6f72 2078 2069 6e20 4642 5445 5354   for x in FBTEST
+00004090: 5f55 5345 5229 0a20 2020 2020 2020 2020  _USER).         
+000040a0: 2020 2064 7062 2e65 7874 656e 6428 2830     dpb.extend((0
+000040b0: 7831 642c 206c 656e 2846 4254 4553 545f  x1d, len(FBTEST_
+000040c0: 5041 5353 574f 5244 2929 290a 2020 2020  PASSWORD))).    
+000040d0: 2020 2020 2020 2020 6470 622e 6578 7465          dpb.exte
+000040e0: 6e64 286f 7264 2878 2920 666f 7220 7820  nd(ord(x) for x 
+000040f0: 696e 2046 4254 4553 545f 5041 5353 574f  in FBTEST_PASSWO
+00004100: 5244 290a 2020 2020 2020 2020 2020 2020  RD).            
+00004110: 6470 622e 6578 7465 6e64 2828 6f72 6428  dpb.extend((ord(
+00004120: 273c 2729 2c20 6c65 6e28 726f 6c65 6e61  '<'), len(rolena
+00004130: 6d65 2929 290a 2020 2020 2020 2020 2020  me))).          
+00004140: 2020 6470 622e 6578 7465 6e64 286f 7264    dpb.extend(ord
+00004150: 2878 2920 666f 7220 7820 696e 2072 6f6c  (x) for x in rol
+00004160: 656e 616d 6529 0a20 2020 2020 2020 2020  ename).         
+00004170: 2020 2064 7062 2e65 7874 656e 6428 286f     dpb.extend((o
+00004180: 7264 2827 3f27 292c 2034 2c20 332c 2030  rd('?'), 4, 3, 0
+00004190: 2c20 302c 2030 2929 0a20 2020 2020 2020  , 0, 0)).       
+000041a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000041b0: 4571 7561 6c28 636f 6e2e 5f64 7062 2c20  Equal(con._dpb, 
+000041c0: 6279 7465 7328 6470 6229 290a 2020 2020  bytes(dpb)).    
+000041d0: 6465 6620 7465 7374 5f74 7261 6e73 6163  def test_transac
+000041e0: 7469 6f6e 2873 656c 6629 3a0a 2020 2020  tion(self):.    
+000041f0: 2020 2020 7769 7468 2063 6f6e 6e65 6374      with connect
+00004200: 2873 656c 662e 6462 6669 6c65 2c20 7573  (self.dbfile, us
+00004210: 6572 3d46 4254 4553 545f 5553 4552 2c20  er=FBTEST_USER, 
+00004220: 7061 7373 776f 7264 3d46 4254 4553 545f  password=FBTEST_
+00004230: 5041 5353 574f 5244 2920 6173 2063 6f6e  PASSWORD) as con
+00004240: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+00004250: 6e2e 5f6c 6f67 6769 6e67 5f69 645f 203d  n._logging_id_ =
+00004260: 2073 656c 662e 5f5f 636c 6173 735f 5f2e   self.__class__.
+00004270: 5f5f 6e61 6d65 5f5f 0a20 2020 2020 2020  __name__.       
+00004280: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00004290: 4973 4e6f 744e 6f6e 6528 636f 6e2e 6d61  IsNotNone(con.ma
+000042a0: 696e 5f74 7261 6e73 6163 7469 6f6e 290a  in_transaction).
+000042b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000042c0: 2e61 7373 6572 7446 616c 7365 2863 6f6e  .assertFalse(con
+000042d0: 2e6d 6169 6e5f 7472 616e 7361 6374 696f  .main_transactio
+000042e0: 6e2e 6973 5f61 6374 6976 6528 2929 0a20  n.is_active()). 
+000042f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00004300: 6173 7365 7274 4661 6c73 6528 636f 6e2e  assertFalse(con.
+00004310: 6d61 696e 5f74 7261 6e73 6163 7469 6f6e  main_transaction
+00004320: 2e69 735f 636c 6f73 6564 2829 290a 2020  .is_closed()).  
+00004330: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00004340: 7373 6572 7445 7175 616c 2863 6f6e 2e6d  ssertEqual(con.m
+00004350: 6169 6e5f 7472 616e 7361 6374 696f 6e2e  ain_transaction.
+00004360: 6465 6661 756c 745f 6163 7469 6f6e 2c20  default_action, 
+00004370: 4465 6661 756c 7441 6374 696f 6e2e 434f  DefaultAction.CO
+00004380: 4d4d 4954 290a 2020 2020 2020 2020 2020  MMIT).          
+00004390: 2020 2373 656c 662e 6173 7365 7274 4571    #self.assertEq
+000043a0: 7561 6c28 6c65 6e28 636f 6e2e 6d61 696e  ual(len(con.main
+000043b0: 5f74 7261 6e73 6163 7469 6f6e 2e5f 636f  _transaction._co
+000043c0: 6e6e 6563 7469 6f6e 7329 2c20 3129 0a20  nnections), 1). 
+000043d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000043e0: 6173 7365 7274 4571 7561 6c28 636f 6e2e  assertEqual(con.
+000043f0: 6d61 696e 5f74 7261 6e73 6163 7469 6f6e  main_transaction
+00004400: 2e5f 636f 6e6e 6563 7469 6f6e 2829 2c20  ._connection(), 
+00004410: 636f 6e29 0a20 2020 2020 2020 2020 2020  con).           
+00004420: 2063 6f6e 2e62 6567 696e 2829 0a20 2020   con.begin().   
+00004430: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00004440: 7365 7274 4661 6c73 6528 636f 6e2e 6d61  sertFalse(con.ma
+00004450: 696e 5f74 7261 6e73 6163 7469 6f6e 2e69  in_transaction.i
+00004460: 735f 636c 6f73 6564 2829 290a 2020 2020  s_closed()).    
+00004470: 2020 2020 2020 2020 636f 6e2e 636f 6d6d          con.comm
+00004480: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
+00004490: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
+000044a0: 6528 636f 6e2e 6d61 696e 5f74 7261 6e73  e(con.main_trans
+000044b0: 6163 7469 6f6e 2e69 735f 6163 7469 7665  action.is_active
+000044c0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+000044d0: 636f 6e2e 6265 6769 6e28 290a 2020 2020  con.begin().    
+000044e0: 2020 2020 2020 2020 636f 6e2e 726f 6c6c          con.roll
+000044f0: 6261 636b 2829 0a20 2020 2020 2020 2020  back().         
+00004500: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
+00004510: 6c73 6528 636f 6e2e 6d61 696e 5f74 7261  lse(con.main_tra
+00004520: 6e73 6163 7469 6f6e 2e69 735f 6163 7469  nsaction.is_acti
+00004530: 7665 2829 290a 2020 2020 2020 2020 2020  ve()).          
+00004540: 2020 636f 6e2e 6265 6769 6e28 290a 2020    con.begin().  
+00004550: 2020 2020 2020 2020 2020 636f 6e2e 636f            con.co
+00004560: 6d6d 6974 2872 6574 6169 6e69 6e67 3d54  mmit(retaining=T
+00004570: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+00004580: 2073 656c 662e 6173 7365 7274 5472 7565   self.assertTrue
+00004590: 2863 6f6e 2e6d 6169 6e5f 7472 616e 7361  (con.main_transa
+000045a0: 6374 696f 6e2e 6973 5f61 6374 6976 6528  ction.is_active(
+000045b0: 2929 0a20 2020 2020 2020 2020 2020 2063  )).            c
+000045c0: 6f6e 2e72 6f6c 6c62 6163 6b28 7265 7461  on.rollback(reta
+000045d0: 696e 696e 673d 5472 7565 290a 2020 2020  ining=True).    
+000045e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000045f0: 6572 7454 7275 6528 636f 6e2e 6d61 696e  ertTrue(con.main
+00004600: 5f74 7261 6e73 6163 7469 6f6e 2e69 735f  _transaction.is_
+00004610: 6163 7469 7665 2829 290a 2020 2020 2020  active()).      
+00004620: 2020 2020 2020 7472 203d 2063 6f6e 2e74        tr = con.t
+00004630: 7261 6e73 6163 7469 6f6e 5f6d 616e 6167  ransaction_manag
+00004640: 6572 2829 0a20 2020 2020 2020 2020 2020  er().           
+00004650: 2073 656c 662e 6173 7365 7274 4973 496e   self.assertIsIn
+00004660: 7374 616e 6365 2874 722c 2064 7269 7665  stance(tr, drive
+00004670: 722e 636f 7265 2e54 7261 6e73 6163 7469  r.core.Transacti
+00004680: 6f6e 4d61 6e61 6765 7229 0a20 2020 2020  onManager).     
+00004690: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000046a0: 7274 4661 6c73 6528 636f 6e2e 6d61 696e  rtFalse(con.main
+000046b0: 5f74 7261 6e73 6163 7469 6f6e 2e69 735f  _transaction.is_
+000046c0: 636c 6f73 6564 2829 290a 2020 2020 2020  closed()).      
+000046d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000046e0: 7445 7175 616c 286c 656e 2863 6f6e 2e74  tEqual(len(con.t
+000046f0: 7261 6e73 6163 7469 6f6e 7329 2c20 3329  ransactions), 3)
+00004700: 0a20 2020 2020 2020 2020 2020 2074 722e  .            tr.
+00004710: 6265 6769 6e28 290a 2020 2020 2020 2020  begin().        
+00004720: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+00004730: 616c 7365 2874 722e 6973 5f63 6c6f 7365  alse(tr.is_close
+00004740: 6428 2929 0a20 2020 2020 2020 2020 2020  d()).           
+00004750: 2063 6f6e 2e62 6567 696e 2829 0a20 2020   con.begin().   
+00004760: 2020 2020 2020 2020 2063 6f6e 2e63 6c6f           con.clo
+00004770: 7365 2829 0a20 2020 2020 2020 2020 2020  se().           
+00004780: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
+00004790: 6528 636f 6e2e 6d61 696e 5f74 7261 6e73  e(con.main_trans
+000047a0: 6163 7469 6f6e 2e69 735f 6163 7469 7665  action.is_active
+000047b0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+000047c0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
+000047d0: 636f 6e2e 6d61 696e 5f74 7261 6e73 6163  con.main_transac
+000047e0: 7469 6f6e 2e69 735f 636c 6f73 6564 2829  tion.is_closed()
+000047f0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00004800: 6c66 2e61 7373 6572 7446 616c 7365 2874  lf.assertFalse(t
+00004810: 722e 6973 5f61 6374 6976 6528 2929 0a20  r.is_active()). 
+00004820: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00004830: 6173 7365 7274 5472 7565 2874 722e 6973  assertTrue(tr.is
+00004840: 5f63 6c6f 7365 6428 2929 0a20 2020 2064  _closed()).    d
+00004850: 6566 2074 6573 745f 6578 6563 7574 655f  ef test_execute_
+00004860: 696d 6d65 6469 6174 6528 7365 6c66 293a  immediate(self):
+00004870: 0a20 2020 2020 2020 2077 6974 6820 636f  .        with co
+00004880: 6e6e 6563 7428 7365 6c66 2e64 6266 696c  nnect(self.dbfil
+00004890: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
+000048a0: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+000048b0: 5445 5354 5f50 4153 5357 4f52 4429 2061  TEST_PASSWORD) a
+000048c0: 7320 636f 6e3a 0a20 2020 2020 2020 2020  s con:.         
+000048d0: 2020 2063 6f6e 2e5f 6c6f 6767 696e 675f     con._logging_
+000048e0: 6964 5f20 3d20 7365 6c66 2e5f 5f63 6c61  id_ = self.__cla
+000048f0: 7373 5f5f 2e5f 5f6e 616d 655f 5f0a 2020  ss__.__name__.  
+00004900: 2020 2020 2020 2020 2020 2363 6f6e 2e65            #con.e
+00004910: 7865 6375 7465 5f69 6d6d 6564 6961 7465  xecute_immediate
+00004920: 2822 7265 6372 6561 7465 2074 6162 6c65  ("recreate table
+00004930: 2074 2028 6331 2069 6e74 6567 6572 2922   t (c1 integer)"
+00004940: 290a 2020 2020 2020 2020 2020 2020 2363  ).            #c
+00004950: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
+00004960: 2020 2020 2020 2020 636f 6e2e 6578 6563          con.exec
+00004970: 7574 655f 696d 6d65 6469 6174 6528 2264  ute_immediate("d
+00004980: 656c 6574 6520 6672 6f6d 2074 2229 0a20  elete from t"). 
+00004990: 2020 2020 2020 2020 2020 2063 6f6e 2e63             con.c
+000049a0: 6f6d 6d69 7428 290a 2020 2020 6465 6620  ommit().    def 
+000049b0: 7465 7374 5f64 625f 696e 666f 2873 656c  test_db_info(sel
+000049c0: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
+000049d0: 2063 6f6e 6e65 6374 2873 656c 662e 6462   connect(self.db
+000049e0: 6669 6c65 2c20 7573 6572 3d46 4254 4553  file, user=FBTES
+000049f0: 545f 5553 4552 2c20 7061 7373 776f 7264  T_USER, password
+00004a00: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
+00004a10: 2920 6173 2063 6f6e 3a0a 2020 2020 2020  ) as con:.      
+00004a20: 2020 2020 2020 636f 6e2e 5f6c 6f67 6769        con._loggi
+00004a30: 6e67 5f69 645f 203d 2073 656c 662e 5f5f  ng_id_ = self.__
+00004a40: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+00004a50: 0a20 2020 2020 2020 2020 2020 2023 2052  .            # R
+00004a60: 6573 697a 6520 7265 7370 6f6e 7365 2062  esize response b
+00004a70: 7566 6665 720a 2020 2020 2020 2020 2020  uffer.          
+00004a80: 2020 636f 6e2e 696e 666f 2e72 6573 706f    con.info.respo
+00004a90: 6e73 652e 7265 7369 7a65 2835 290a 2020  nse.resize(5).  
+00004aa0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00004ab0: 7373 6572 7445 7175 616c 286c 656e 2863  ssertEqual(len(c
+00004ac0: 6f6e 2e69 6e66 6f2e 7265 7370 6f6e 7365  on.info.response
+00004ad0: 2e72 6177 292c 2035 290a 2020 2020 2020  .raw), 5).      
+00004ae0: 2020 2020 2020 636f 6e2e 696e 666f 2e67        con.info.g
+00004af0: 6574 5f69 6e66 6f28 4462 496e 666f 436f  et_info(DbInfoCo
+00004b00: 6465 2e55 5345 525f 4e41 4d45 5329 0a20  de.USER_NAMES). 
+00004b10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00004b20: 6173 7365 7274 4772 6561 7465 7228 6c65  assertGreater(le
+00004b30: 6e28 636f 6e2e 696e 666f 2e72 6573 706f  n(con.info.respo
+00004b40: 6e73 652e 7261 7729 2c20 3529 0a20 2020  nse.raw), 5).   
+00004b50: 2020 2020 2020 2020 2023 2050 726f 7065           # Prope
+00004b60: 7274 6965 730a 2020 2020 2020 2020 2020  rties.          
+00004b70: 2020 7365 6c66 2e61 7373 6572 7449 6e28    self.assertIn(
+00004b80: 2746 6972 6562 6972 6427 2c20 636f 6e2e  'Firebird', con.
+00004b90: 696e 666f 2e73 6572 7665 725f 7665 7273  info.server_vers
+00004ba0: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
+00004bb0: 2073 656c 662e 6173 7365 7274 496e 2827   self.assertIn('
+00004bc0: 4669 7265 6269 7264 272c 2063 6f6e 2e69  Firebird', con.i
+00004bd0: 6e66 6f2e 6669 7265 6269 7264 5f76 6572  nfo.firebird_ver
+00004be0: 7369 6f6e 290a 2020 2020 2020 2020 2020  sion).          
+00004bf0: 2020 7365 6c66 2e61 7373 6572 7449 7349    self.assertIsI
+00004c00: 6e73 7461 6e63 6528 636f 6e2e 696e 666f  nstance(con.info
+00004c10: 2e76 6572 7369 6f6e 2c20 7374 7229 0a20  .version, str). 
+00004c20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00004c30: 6173 7365 7274 4772 6561 7465 7245 7175  assertGreaterEqu
+00004c40: 616c 2863 6f6e 2e69 6e66 6f2e 656e 6769  al(con.info.engi
+00004c50: 6e65 5f76 6572 7369 6f6e 2c20 332e 3029  ne_version, 3.0)
+00004c60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00004c70: 662e 6173 7365 7274 4772 6561 7465 7245  f.assertGreaterE
+00004c80: 7175 616c 2863 6f6e 2e69 6e66 6f2e 6f64  qual(con.info.od
+00004c90: 732c 2031 322e 3029 0a20 2020 2020 2020  s, 12.0).       
+00004ca0: 2020 2020 2023 0a20 2020 2020 2020 2020       #.         
+00004cb0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00004cc0: 7561 6c28 636f 6e2e 696e 666f 2e70 6167  ual(con.info.pag
+00004cd0: 655f 7369 7a65 2c20 3831 3932 290a 2020  e_size, 8192).  
+00004ce0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00004cf0: 7373 6572 7447 7265 6174 6572 2863 6f6e  ssertGreater(con
+00004d00: 2e69 6e66 6f2e 6964 2c20 3029 0a20 2020  .info.id, 0).   
+00004d10: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00004d20: 7365 7274 4571 7561 6c28 636f 6e2e 696e  sertEqual(con.in
+00004d30: 666f 2e73 716c 5f64 6961 6c65 6374 2c20  fo.sql_dialect, 
+00004d40: 3329 0a20 2020 2020 2020 2020 2020 2073  3).            s
+00004d50: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00004d60: 636f 6e2e 696e 666f 2e6e 616d 652e 7570  con.info.name.up
+00004d70: 7065 7228 292c 2073 656c 662e 6462 6669  per(), self.dbfi
+00004d80: 6c65 2e75 7070 6572 2829 290a 2020 2020  le.upper()).    
+00004d90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00004da0: 6572 7449 7349 6e73 7461 6e63 6528 636f  ertIsInstance(co
+00004db0: 6e2e 696e 666f 2e73 6974 652c 2073 7472  n.info.site, str
+00004dc0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00004dd0: 6c66 2e61 7373 6572 7449 7349 6e73 7461  lf.assertIsInsta
+00004de0: 6e63 6528 636f 6e2e 696e 666f 2e69 6d70  nce(con.info.imp
+00004df0: 6c65 6d65 6e74 6174 696f 6e2c 2064 7269  lementation, dri
+00004e00: 7665 722e 7479 7065 732e 496d 706c 656d  ver.types.Implem
+00004e10: 656e 7461 7469 6f6e 290a 2020 2020 2020  entation).      
+00004e20: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00004e30: 7449 7349 6e73 7461 6e63 6528 636f 6e2e  tIsInstance(con.
+00004e40: 696e 666f 2e70 726f 7669 6465 722c 2064  info.provider, d
+00004e50: 7269 7665 722e 7479 7065 732e 4462 5072  river.types.DbPr
+00004e60: 6f76 6964 6572 290a 2020 2020 2020 2020  ovider).        
+00004e70: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+00004e80: 7349 6e73 7461 6e63 6528 636f 6e2e 696e  sInstance(con.in
+00004e90: 666f 2e64 625f 636c 6173 732c 2064 7269  fo.db_class, dri
+00004ea0: 7665 722e 7479 7065 732e 4462 436c 6173  ver.types.DbClas
+00004eb0: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
+00004ec0: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
+00004ed0: 616e 6365 2863 6f6e 2e69 6e66 6f2e 6372  ance(con.info.cr
+00004ee0: 6561 7469 6f6e 5f64 6174 652c 2064 6174  eation_date, dat
+00004ef0: 6574 696d 652e 6461 7465 290a 2020 2020  etime.date).    
+00004f00: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00004f10: 6572 7447 7265 6174 6572 4571 7561 6c28  ertGreaterEqual(
+00004f20: 636f 6e2e 696e 666f 2e6f 6473 5f76 6572  con.info.ods_ver
+00004f30: 7369 6f6e 2c20 3131 290a 2020 2020 2020  sion, 11).      
+00004f40: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00004f50: 7447 7265 6174 6572 4571 7561 6c28 636f  tGreaterEqual(co
+00004f60: 6e2e 696e 666f 2e6f 6473 5f6d 696e 6f72  n.info.ods_minor
+00004f70: 5f76 6572 7369 6f6e 2c20 3029 0a20 2020  _version, 0).   
+00004f80: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00004f90: 7365 7274 4772 6561 7465 7245 7175 616c  sertGreaterEqual
+00004fa0: 2863 6f6e 2e69 6e66 6f2e 7061 6765 5f63  (con.info.page_c
+00004fb0: 6163 6865 5f73 697a 652c 2037 3529 0a20  ache_size, 75). 
+00004fc0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00004fd0: 6c66 2e76 6572 7369 6f6e 203d 3d20 4642  lf.version == FB
+00004fe0: 3330 3a0a 2020 2020 2020 2020 2020 2020  30:.            
+00004ff0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00005000: 7175 616c 2863 6f6e 2e69 6e66 6f2e 7061  qual(con.info.pa
+00005010: 6765 735f 616c 6c6f 6361 7465 642c 2033  ges_allocated, 3
+00005020: 3637 290a 2020 2020 2020 2020 2020 2020  67).            
+00005030: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00005040: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00005050: 7445 7175 616c 2863 6f6e 2e69 6e66 6f2e  tEqual(con.info.
+00005060: 7061 6765 735f 616c 6c6f 6361 7465 642c  pages_allocated,
+00005070: 2033 3839 290a 2020 2020 2020 2020 2020   389).          
+00005080: 2020 7365 6c66 2e61 7373 6572 7447 7265    self.assertGre
+00005090: 6174 6572 2863 6f6e 2e69 6e66 6f2e 7061  ater(con.info.pa
+000050a0: 6765 735f 7573 6564 2c20 3330 3029 0a20  ges_used, 300). 
+000050b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000050c0: 6173 7365 7274 4772 6561 7465 7245 7175  assertGreaterEqu
+000050d0: 616c 2863 6f6e 2e69 6e66 6f2e 7061 6765  al(con.info.page
+000050e0: 735f 6672 6565 2c20 3029 0a20 2020 2020  s_free, 0).     
+000050f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00005100: 7274 4571 7561 6c28 636f 6e2e 696e 666f  rtEqual(con.info
+00005110: 2e73 7765 6570 5f69 6e74 6572 7661 6c2c  .sweep_interval,
+00005120: 2032 3030 3030 290a 2020 2020 2020 2020   20000).        
+00005130: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00005140: 7175 616c 2863 6f6e 2e69 6e66 6f2e 6163  qual(con.info.ac
+00005150: 6365 7373 5f6d 6f64 652c 2044 6241 6363  cess_mode, DbAcc
+00005160: 6573 734d 6f64 652e 5245 4144 5f57 5249  essMode.READ_WRI
+00005170: 5445 290a 2020 2020 2020 2020 2020 2020  TE).            
+00005180: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00005190: 2863 6f6e 2e69 6e66 6f2e 7370 6163 655f  (con.info.space_
+000051a0: 7265 7365 7276 6174 696f 6e2c 2044 6253  reservation, DbS
+000051b0: 7061 6365 5265 7365 7276 6174 696f 6e2e  paceReservation.
+000051c0: 5245 5345 5256 4529 0a20 2020 2020 2020  RESERVE).       
+000051d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000051e0: 4571 7561 6c28 636f 6e2e 696e 666f 2e77  Equal(con.info.w
+000051f0: 7269 7465 5f6d 6f64 652c 2044 6257 7269  rite_mode, DbWri
+00005200: 7465 4d6f 6465 2e53 594e 4329 0a20 2020  teMode.SYNC).   
+00005210: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00005220: 7365 7274 4772 6561 7465 7228 636f 6e2e  sertGreater(con.
+00005230: 696e 666f 2e63 7572 7265 6e74 5f6d 656d  info.current_mem
+00005240: 6f72 792c 2030 290a 2020 2020 2020 2020  ory, 0).        
+00005250: 2020 2020 7365 6c66 2e61 7373 6572 7447      self.assertG
+00005260: 7265 6174 6572 2863 6f6e 2e69 6e66 6f2e  reater(con.info.
+00005270: 6d61 785f 6d65 6d6f 7279 2c20 3029 0a20  max_memory, 0). 
+00005280: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005290: 6173 7365 7274 4772 6561 7465 7245 7175  assertGreaterEqu
+000052a0: 616c 2863 6f6e 2e69 6e66 6f2e 6d61 785f  al(con.info.max_
+000052b0: 6d65 6d6f 7279 2c20 636f 6e2e 696e 666f  memory, con.info
+000052c0: 2e63 7572 7265 6e74 5f6d 656d 6f72 7929  .current_memory)
+000052d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000052e0: 662e 6173 7365 7274 4772 6561 7465 7228  f.assertGreater(
+000052f0: 636f 6e2e 696e 666f 2e6f 6974 2c20 3129  con.info.oit, 1)
+00005300: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005310: 662e 6173 7365 7274 4772 6561 7465 7228  f.assertGreater(
+00005320: 636f 6e2e 696e 666f 2e6f 6174 2c20 3129  con.info.oat, 1)
+00005330: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005340: 662e 6173 7365 7274 4772 6561 7465 7228  f.assertGreater(
+00005350: 636f 6e2e 696e 666f 2e6f 7374 2c20 3129  con.info.ost, 1)
+00005360: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005370: 662e 6173 7365 7274 4772 6561 7465 7228  f.assertGreater(
+00005380: 636f 6e2e 696e 666f 2e6e 6578 745f 7472  con.info.next_tr
+00005390: 616e 7361 6374 696f 6e2c 2031 290a 2020  ansaction, 1).  
+000053a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000053b0: 7373 6572 744c 6573 7345 7175 616c 2863  ssertLessEqual(c
+000053c0: 6f6e 2e69 6e66 6f2e 6f69 742c 2063 6f6e  on.info.oit, con
+000053d0: 2e69 6e66 6f2e 6f61 7429 0a20 2020 2020  .info.oat).     
+000053e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000053f0: 7274 4c65 7373 4571 7561 6c28 636f 6e2e  rtLessEqual(con.
+00005400: 696e 666f 2e6f 6974 2c20 636f 6e2e 696e  info.oit, con.in
+00005410: 666f 2e6f 7374 290a 2020 2020 2020 2020  fo.ost).        
+00005420: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
+00005430: 6573 7345 7175 616c 2863 6f6e 2e69 6e66  essEqual(con.inf
+00005440: 6f2e 6f69 742c 2063 6f6e 2e69 6e66 6f2e  o.oit, con.info.
+00005450: 6e65 7874 5f74 7261 6e73 6163 7469 6f6e  next_transaction
+00005460: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00005470: 6c66 2e61 7373 6572 744c 6573 7345 7175  lf.assertLessEqu
+00005480: 616c 2863 6f6e 2e69 6e66 6f2e 6f61 742c  al(con.info.oat,
+00005490: 2063 6f6e 2e69 6e66 6f2e 6e65 7874 5f74   con.info.next_t
+000054a0: 7261 6e73 6163 7469 6f6e 290a 2020 2020  ransaction).    
+000054b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000054c0: 6572 744c 6573 7345 7175 616c 2863 6f6e  ertLessEqual(con
+000054d0: 2e69 6e66 6f2e 6f73 742c 2063 6f6e 2e69  .info.ost, con.i
+000054e0: 6e66 6f2e 6e65 7874 5f74 7261 6e73 6163  nfo.next_transac
+000054f0: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+00005500: 2020 230a 2020 2020 2020 2020 2020 2020    #.            
+00005510: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
+00005520: 7461 6e63 6528 636f 6e2e 696e 666f 2e72  tance(con.info.r
+00005530: 6561 6473 2c20 696e 7429 0a20 2020 2020  eads, int).     
+00005540: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00005550: 7274 4973 496e 7374 616e 6365 2863 6f6e  rtIsInstance(con
+00005560: 2e69 6e66 6f2e 6665 7463 6865 732c 2069  .info.fetches, i
+00005570: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
+00005580: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
+00005590: 7461 6e63 6528 636f 6e2e 696e 666f 2e77  tance(con.info.w
+000055a0: 7269 7465 732c 2069 6e74 290a 2020 2020  rites, int).    
+000055b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000055c0: 6572 7449 7349 6e73 7461 6e63 6528 636f  ertIsInstance(co
+000055d0: 6e2e 696e 666f 2e6d 6172 6b73 2c20 696e  n.info.marks, in
+000055e0: 7429 0a20 2020 2020 2020 2020 2020 2073  t).            s
+000055f0: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
+00005600: 616e 6365 2863 6f6e 2e69 6e66 6f2e 6361  ance(con.info.ca
+00005610: 6368 655f 6869 745f 7261 7469 6f2c 2066  che_hit_ratio, f
+00005620: 6c6f 6174 290a 2020 2020 2020 2020 2020  loat).          
+00005630: 2020 2320 4675 6e63 7469 6f6e 730a 2020    # Functions.  
+00005640: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00005650: 7373 6572 7445 7175 616c 286c 656e 2863  ssertEqual(len(c
+00005660: 6f6e 2e69 6e66 6f2e 6765 745f 7061 6765  on.info.get_page
+00005670: 5f63 6f6e 7465 6e74 2830 2929 2c20 636f  _content(0)), co
+00005680: 6e2e 696e 666f 2e70 6167 655f 7369 7a65  n.info.page_size
+00005690: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+000056a0: 6c66 2e61 7373 6572 7449 7349 6e73 7461  lf.assertIsInsta
+000056b0: 6e63 6528 636f 6e2e 696e 666f 2e69 735f  nce(con.info.is_
+000056c0: 636f 6d70 7265 7373 6564 2829 2c20 626f  compressed(), bo
+000056d0: 6f6c 290a 2020 2020 2020 2020 2020 2020  ol).            
+000056e0: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
+000056f0: 7461 6e63 6528 636f 6e2e 696e 666f 2e69  tance(con.info.i
+00005700: 735f 656e 6372 7970 7465 6428 292c 2062  s_encrypted(), b
+00005710: 6f6f 6c29 0a20 2020 2020 2020 2020 2020  ool).           
+00005720: 2073 656c 662e 6173 7365 7274 4c69 7374   self.assertList
+00005730: 4571 7561 6c28 636f 6e2e 696e 666f 2e67  Equal(con.info.g
+00005740: 6574 5f61 6374 6976 655f 7472 616e 7361  et_active_transa
+00005750: 6374 696f 6e5f 6964 7328 292c 205b 5d29  ction_ids(), [])
+00005760: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+00005770: 6820 636f 6e2e 7472 616e 7361 6374 696f  h con.transactio
+00005780: 6e5f 6d61 6e61 6765 7228 2920 6173 2074  n_manager() as t
+00005790: 312c 2063 6f6e 2e74 7261 6e73 6163 7469  1, con.transacti
+000057a0: 6f6e 5f6d 616e 6167 6572 2829 2061 7320  on_manager() as 
+000057b0: 7432 3a0a 2020 2020 2020 2020 2020 2020  t2:.            
+000057c0: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
+000057d0: 6973 7445 7175 616c 2863 6f6e 2e69 6e66  istEqual(con.inf
+000057e0: 6f2e 6765 745f 6163 7469 7665 5f74 7261  o.get_active_tra
+000057f0: 6e73 6163 7469 6f6e 5f69 6473 2829 2c0a  nsaction_ids(),.
+00005800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005820: 2020 2020 205b 7431 2e69 6e66 6f2e 6964       [t1.info.id
+00005830: 2c20 7432 2e69 6e66 6f2e 6964 5d29 0a20  , t2.info.id]). 
+00005840: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00005850: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00005860: 636f 6e2e 696e 666f 2e67 6574 5f61 6374  con.info.get_act
+00005870: 6976 655f 7472 616e 7361 6374 696f 6e5f  ive_transaction_
+00005880: 636f 756e 7428 292c 2032 290a 2020 2020  count(), 2).    
+00005890: 2020 2020 2020 2020 7320 3d20 636f 6e2e          s = con.
+000058a0: 696e 666f 2e67 6574 5f74 6162 6c65 5f61  info.get_table_a
+000058b0: 6363 6573 735f 7374 6174 7328 290a 2020  ccess_stats().  
+000058c0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000058d0: 7373 6572 7449 6e28 6c65 6e28 7329 2c20  ssertIn(len(s), 
+000058e0: 5b36 2c31 325d 290a 2020 2020 2020 2020  [6,12]).        
+000058f0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+00005900: 7349 6e73 7461 6e63 6528 735b 305d 2c20  sInstance(s[0], 
+00005910: 6472 6976 6572 2e74 7970 6573 2e54 6162  driver.types.Tab
+00005920: 6c65 4163 6365 7373 5374 6174 7329 0a20  leAccessStats). 
+00005930: 2020 2020 2020 2020 2020 2023 204c 6f77             # Low
+00005940: 206c 6576 656c 2069 6e66 6f20 6361 6c6c   level info call
+00005950: 730a 2020 2020 2020 2020 2020 2020 7769  s.            wi
+00005960: 7468 2063 6f6e 2e74 7261 6e73 6163 7469  th con.transacti
+00005970: 6f6e 5f6d 616e 6167 6572 2829 2061 7320  on_manager() as 
+00005980: 7431 2c20 636f 6e2e 7472 616e 7361 6374  t1, con.transact
+00005990: 696f 6e5f 6d61 6e61 6765 7228 2920 6173  ion_manager() as
+000059a0: 2074 323a 0a20 2020 2020 2020 2020 2020   t2:.           
+000059b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000059c0: 4c69 7374 4571 7561 6c28 636f 6e2e 696e  ListEqual(con.in
+000059d0: 666f 2e67 6574 5f69 6e66 6f28 4462 496e  fo.get_info(DbIn
+000059e0: 666f 436f 6465 2e41 4354 4956 455f 5452  foCode.ACTIVE_TR
+000059f0: 414e 5341 4354 494f 4e53 292c 0a20 2020  ANSACTIONS),.   
+00005a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a20: 2020 5b74 312e 696e 666f 2e69 642c 2074    [t1.info.id, t
+00005a30: 322e 696e 666f 2e69 645d 290a 2020 2020  2.info.id]).    
+00005a40: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
+00005a50: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00005a60: 7445 7175 616c 2863 6f6e 2e69 6e66 6f2e  tEqual(con.info.
+00005a70: 6765 745f 696e 666f 2844 6249 6e66 6f43  get_info(DbInfoC
+00005a80: 6f64 652e 5041 4745 5f53 495a 4529 2c20  ode.PAGE_SIZE), 
+00005a90: 3831 3932 290a 2020 2020 2020 2020 2020  8192).          
+00005aa0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00005ab0: 616c 2863 6f6e 2e69 6e66 6f2e 6765 745f  al(con.info.get_
+00005ac0: 696e 666f 2844 6249 6e66 6f43 6f64 652e  info(DbInfoCode.
+00005ad0: 4442 5f52 4541 445f 4f4e 4c59 292c 2030  DB_READ_ONLY), 0
+00005ae0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00005af0: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
+00005b00: 6f6e 2e69 6e66 6f2e 6765 745f 696e 666f  on.info.get_info
+00005b10: 2844 6249 6e66 6f43 6f64 652e 4442 5f53  (DbInfoCode.DB_S
+00005b20: 514c 5f44 4941 4c45 4354 292c 2033 290a  QL_DIALECT), 3).
+00005b30: 2020 2020 2020 2020 2020 2020 7265 7320              res 
+00005b40: 3d20 636f 6e2e 696e 666f 2e67 6574 5f69  = con.info.get_i
+00005b50: 6e66 6f28 4462 496e 666f 436f 6465 2e55  nfo(DbInfoCode.U
+00005b60: 5345 525f 4e41 4d45 5329 0a20 2020 2020  SER_NAMES).     
+00005b70: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00005b80: 7274 4469 6374 4571 7561 6c28 7265 732c  rtDictEqual(res,
+00005b90: 207b 2753 5953 4442 4127 3a20 317d 290a   {'SYSDBA': 1}).
+00005ba0: 2020 2020 2020 2020 2020 2020 7265 7320              res 
+00005bb0: 3d20 636f 6e2e 696e 666f 2e67 6574 5f69  = con.info.get_i
+00005bc0: 6e66 6f28 4462 496e 666f 436f 6465 2e52  nfo(DbInfoCode.R
+00005bd0: 4541 445f 5345 515f 434f 554e 5429 0a20  EAD_SEQ_COUNT). 
+00005be0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005bf0: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
+00005c00: 6c69 7374 2872 6573 292c 205b 302c 2031  list(res), [0, 1
+00005c10: 5d29 0a20 2020 2020 2020 2020 2020 2023  ]).            #
+00005c20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005c30: 662e 6173 7365 7274 4973 496e 7374 616e  f.assertIsInstan
+00005c40: 6365 2863 6f6e 2e69 6e66 6f2e 6765 745f  ce(con.info.get_
+00005c50: 696e 666f 2844 6249 6e66 6f43 6f64 652e  info(DbInfoCode.
+00005c60: 414c 4c4f 4341 5449 4f4e 292c 2069 6e74  ALLOCATION), int
+00005c70: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00005c80: 6c66 2e61 7373 6572 7449 7349 6e73 7461  lf.assertIsInsta
+00005c90: 6e63 6528 636f 6e2e 696e 666f 2e67 6574  nce(con.info.get
+00005ca0: 5f69 6e66 6f28 4462 496e 666f 436f 6465  _info(DbInfoCode
+00005cb0: 2e42 4153 455f 4c45 5645 4c29 2c20 696e  .BASE_LEVEL), in
+00005cc0: 7429 0a20 2020 2020 2020 2020 2020 2072  t).            r
+00005cd0: 6573 203d 2063 6f6e 2e69 6e66 6f2e 6765  es = con.info.ge
+00005ce0: 745f 696e 666f 2844 6249 6e66 6f43 6f64  t_info(DbInfoCod
+00005cf0: 652e 4442 5f49 4429 0a20 2020 2020 2020  e.DB_ID).       
+00005d00: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00005d10: 4973 496e 7374 616e 6365 2872 6573 2c20  IsInstance(res, 
+00005d20: 6c69 7374 290a 2020 2020 2020 2020 2020  list).          
+00005d30: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00005d40: 616c 2872 6573 5b30 5d2e 7570 7065 7228  al(res[0].upper(
+00005d50: 292c 2073 656c 662e 6462 6669 6c65 2e75  ), self.dbfile.u
+00005d60: 7070 6572 2829 290a 2020 2020 2020 2020  pper()).        
+00005d70: 2020 2020 7265 7320 3d20 636f 6e2e 696e      res = con.in
+00005d80: 666f 2e67 6574 5f69 6e66 6f28 4462 496e  fo.get_info(DbIn
+00005d90: 666f 436f 6465 2e49 4d50 4c45 4d45 4e54  foCode.IMPLEMENT
+00005da0: 4154 494f 4e29 0a20 2020 2020 2020 2020  ATION).         
+00005db0: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+00005dc0: 496e 7374 616e 6365 2872 6573 2c20 7475  Instance(res, tu
+00005dd0: 706c 6529 0a20 2020 2020 2020 2020 2020  ple).           
+00005de0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00005df0: 6c28 6c65 6e28 7265 7329 2c20 3429 0a20  l(len(res), 4). 
+00005e00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005e10: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
+00005e20: 2872 6573 5b30 5d2c 2064 7269 7665 722e  (res[0], driver.
+00005e30: 7479 7065 732e 496d 7043 5055 290a 2020  types.ImpCPU).  
+00005e40: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00005e50: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
+00005e60: 7265 735b 315d 2c20 6472 6976 6572 2e74  res[1], driver.t
+00005e70: 7970 6573 2e49 6d70 4f53 290a 2020 2020  ypes.ImpOS).    
+00005e80: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00005e90: 6572 7449 7349 6e73 7461 6e63 6528 7265  ertIsInstance(re
+00005ea0: 735b 325d 2c20 6472 6976 6572 2e74 7970  s[2], driver.typ
+00005eb0: 6573 2e49 6d70 436f 6d70 696c 6572 290a  es.ImpCompiler).
+00005ec0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005ed0: 2e61 7373 6572 7449 7349 6e73 7461 6e63  .assertIsInstanc
+00005ee0: 6528 7265 735b 335d 2c20 6472 6976 6572  e(res[3], driver
+00005ef0: 2e74 7970 6573 2e49 6d70 466c 6167 7329  .types.ImpFlags)
+00005f00: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00005f10: 203d 2063 6f6e 2e69 6e66 6f2e 6765 745f   = con.info.get_
+00005f20: 696e 666f 2844 6249 6e66 6f43 6f64 652e  info(DbInfoCode.
+00005f30: 494d 504c 454d 454e 5441 5449 4f4e 5f4f  IMPLEMENTATION_O
+00005f40: 4c44 290a 2020 2020 2020 2020 2020 2020  LD).            
+00005f50: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
+00005f60: 7461 6e63 6528 7265 732c 2074 7570 6c65  tance(res, tuple
+00005f70: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00005f80: 6c66 2e61 7373 6572 7445 7175 616c 286c  lf.assertEqual(l
+00005f90: 656e 2872 6573 292c 2032 290a 2020 2020  en(res), 2).    
+00005fa0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00005fb0: 6572 7449 7349 6e73 7461 6e63 6528 7265  ertIsInstance(re
+00005fc0: 735b 305d 2c20 696e 7429 0a20 2020 2020  s[0], int).     
+00005fd0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00005fe0: 7274 4973 496e 7374 616e 6365 2872 6573  rtIsInstance(res
+00005ff0: 5b31 5d2c 2069 6e74 290a 2020 2020 2020  [1], int).      
+00006000: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00006010: 7449 6e28 7265 735b 305d 2c20 6472 6976  tIn(res[0], driv
+00006020: 6572 2e74 7970 6573 2e49 6d70 6c65 6d65  er.types.Impleme
+00006030: 6e74 6174 696f 6e2e 5f76 616c 7565 326d  ntation._value2m
+00006040: 656d 6265 725f 6d61 705f 290a 2020 2020  ember_map_).    
+00006050: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00006060: 6572 7449 6e28 2746 6972 6562 6972 6427  ertIn('Firebird'
+00006070: 2c20 636f 6e2e 696e 666f 2e67 6574 5f69  , con.info.get_i
+00006080: 6e66 6f28 4462 496e 666f 436f 6465 2e56  nfo(DbInfoCode.V
+00006090: 4552 5349 4f4e 2929 0a20 2020 2020 2020  ERSION)).       
+000060a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000060b0: 496e 2827 4669 7265 6269 7264 272c 2063  In('Firebird', c
+000060c0: 6f6e 2e69 6e66 6f2e 6765 745f 696e 666f  on.info.get_info
+000060d0: 2844 6249 6e66 6f43 6f64 652e 4649 5245  (DbInfoCode.FIRE
+000060e0: 4249 5244 5f56 4552 5349 4f4e 2929 0a20  BIRD_VERSION)). 
+000060f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00006100: 6173 7365 7274 496e 2863 6f6e 2e69 6e66  assertIn(con.inf
+00006110: 6f2e 6765 745f 696e 666f 2844 6249 6e66  o.get_info(DbInf
+00006120: 6f43 6f64 652e 4e4f 5f52 4553 4552 5645  oCode.NO_RESERVE
+00006130: 292c 2028 302c 2031 2929 0a20 2020 2020  ), (0, 1)).     
+00006140: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00006150: 7274 496e 2863 6f6e 2e69 6e66 6f2e 6765  rtIn(con.info.ge
+00006160: 745f 696e 666f 2844 6249 6e66 6f43 6f64  t_info(DbInfoCod
+00006170: 652e 464f 5243 4544 5f57 5249 5445 5329  e.FORCED_WRITES)
+00006180: 2c20 2830 2c20 3129 290a 2020 2020 2020  , (0, 1)).      
+00006190: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000061a0: 7449 7349 6e73 7461 6e63 6528 636f 6e2e  tIsInstance(con.
+000061b0: 696e 666f 2e67 6574 5f69 6e66 6f28 4462  info.get_info(Db
+000061c0: 496e 666f 436f 6465 2e42 4153 455f 4c45  InfoCode.BASE_LE
+000061d0: 5645 4c29 2c20 696e 7429 0a20 2020 2020  VEL), int).     
+000061e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+000061f0: 7274 4973 496e 7374 616e 6365 2863 6f6e  rtIsInstance(con
+00006200: 2e69 6e66 6f2e 6765 745f 696e 666f 2844  .info.get_info(D
+00006210: 6249 6e66 6f43 6f64 652e 4f44 535f 5645  bInfoCode.ODS_VE
+00006220: 5253 494f 4e29 2c20 696e 7429 0a20 2020  RSION), int).   
+00006230: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00006240: 7365 7274 4973 496e 7374 616e 6365 2863  sertIsInstance(c
+00006250: 6f6e 2e69 6e66 6f2e 6765 745f 696e 666f  on.info.get_info
+00006260: 2844 6249 6e66 6f43 6f64 652e 4f44 535f  (DbInfoCode.ODS_
+00006270: 4d49 4e4f 525f 5645 5253 494f 4e29 2c20  MINOR_VERSION), 
+00006280: 696e 7429 0a20 2020 2020 2020 2020 2020  int).           
+00006290: 2023 0a0a 0a63 6c61 7373 2054 6573 7454   #...class TestT
+000062a0: 7261 6e73 6163 7469 6f6e 2844 7269 7665  ransaction(Drive
+000062b0: 7254 6573 7442 6173 6529 3a0a 2020 2020  rTestBase):.    
+000062c0: 6465 6620 7365 7455 7028 7365 6c66 293a  def setUp(self):
+000062d0: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
+000062e0: 2e73 6574 5570 2829 0a20 2020 2020 2020  .setUp().       
+000062f0: 2073 656c 662e 6462 6669 6c65 203d 206f   self.dbfile = o
+00006300: 732e 7061 7468 2e6a 6f69 6e28 7365 6c66  s.path.join(self
+00006310: 2e64 6270 6174 682c 2073 656c 662e 4642  .dbpath, self.FB
+00006320: 5445 5354 5f44 4229 0a20 2020 2020 2020  TEST_DB).       
+00006330: 2073 656c 662e 636f 6e20 3d20 636f 6e6e   self.con = conn
+00006340: 6563 7428 6627 7b46 4254 4553 545f 484f  ect(f'{FBTEST_HO
+00006350: 5354 7d3a 7b73 656c 662e 6462 6669 6c65  ST}:{self.dbfile
+00006360: 7d27 2c20 7573 6572 3d46 4254 4553 545f  }', user=FBTEST_
+00006370: 5553 4552 2c20 7061 7373 776f 7264 3d46  USER, password=F
+00006380: 4254 4553 545f 5041 5353 574f 5244 290a  BTEST_PASSWORD).
+00006390: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+000063a0: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
+000063b0: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
+000063c0: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
+000063d0: 2373 656c 662e 636f 6e2e 6578 6563 7574  #self.con.execut
+000063e0: 655f 696d 6d65 6469 6174 6528 2272 6563  e_immediate("rec
+000063f0: 7265 6174 6520 7461 626c 6520 7420 2863  reate table t (c
+00006400: 3120 696e 7465 6765 7229 2229 0a20 2020  1 integer)").   
+00006410: 2020 2020 2073 656c 662e 636f 6e2e 6578       self.con.ex
+00006420: 6563 7574 655f 696d 6d65 6469 6174 6528  ecute_immediate(
+00006430: 2264 656c 6574 6520 6672 6f6d 2074 2229  "delete from t")
+00006440: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+00006450: 6e2e 636f 6d6d 6974 2829 0a20 2020 2064  n.commit().    d
+00006460: 6566 2074 6561 7244 6f77 6e28 7365 6c66  ef tearDown(self
+00006470: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+00006480: 636f 6e2e 636c 6f73 6528 290a 2020 2020  con.close().    
+00006490: 6465 6620 7465 7374 5f63 7572 736f 7228  def test_cursor(
+000064a0: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
+000064b0: 6974 6820 7365 6c66 2e63 6f6e 3a0a 2020  ith self.con:.  
+000064c0: 2020 2020 2020 2020 2020 7472 203d 2073            tr = s
+000064d0: 656c 662e 636f 6e2e 6d61 696e 5f74 7261  elf.con.main_tra
+000064e0: 6e73 6163 7469 6f6e 0a20 2020 2020 2020  nsaction.       
+000064f0: 2020 2020 2074 722e 6265 6769 6e28 290a       tr.begin().
+00006500: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00006510: 2074 722e 6375 7273 6f72 2829 2061 7320   tr.cursor() as 
+00006520: 6375 723a 0a20 2020 2020 2020 2020 2020  cur:.           
+00006530: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+00006540: 2822 696e 7365 7274 2069 6e74 6f20 7420  ("insert into t 
+00006550: 2863 3129 2076 616c 7565 7320 2831 2922  (c1) values (1)"
+00006560: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006570: 2020 7472 2e63 6f6d 6d69 7428 290a 2020    tr.commit().  
+00006580: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+00006590: 722e 6578 6563 7574 6528 2273 656c 6563  r.execute("selec
+000065a0: 7420 2a20 6672 6f6d 2074 2229 0a20 2020  t * from t").   
+000065b0: 2020 2020 2020 2020 2020 2020 2072 6f77               row
+000065c0: 7320 3d20 6375 722e 6665 7463 6861 6c6c  s = cur.fetchall
+000065d0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+000065e0: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
+000065f0: 7374 4571 7561 6c28 726f 7773 2c20 5b28  stEqual(rows, [(
+00006600: 312c 295d 290a 2020 2020 2020 2020 2020  1,)]).          
+00006610: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+00006620: 6528 2264 656c 6574 6520 6672 6f6d 2074  e("delete from t
+00006630: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00006640: 2020 2074 722e 636f 6d6d 6974 2829 0a20     tr.commit(). 
+00006650: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00006660: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00006670: 6c65 6e28 7472 2e63 7572 736f 7273 292c  len(tr.cursors),
+00006680: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
+00006690: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+000066a0: 7328 7472 2e63 7572 736f 7273 5b30 5d2c  s(tr.cursors[0],
+000066b0: 2063 7572 290a 2020 2020 6465 6620 7465   cur).    def te
+000066c0: 7374 5f63 6f6e 7465 7874 5f6d 616e 6167  st_context_manag
+000066d0: 6572 2873 656c 6629 3a0a 2020 2020 2020  er(self):.      
+000066e0: 2020 7769 7468 2073 656c 662e 636f 6e2e    with self.con.
+000066f0: 6375 7273 6f72 2829 2061 7320 6375 723a  cursor() as cur:
+00006700: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+00006710: 6820 7472 616e 7361 6374 696f 6e28 7365  h transaction(se
+00006720: 6c66 2e63 6f6e 293a 0a20 2020 2020 2020  lf.con):.       
+00006730: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
+00006740: 6375 7465 2822 696e 7365 7274 2069 6e74  cute("insert int
+00006750: 6f20 7420 2863 3129 2076 616c 7565 7320  o t (c1) values 
+00006760: 2831 2922 290a 0a20 2020 2020 2020 2020  (1)")..         
+00006770: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
+00006780: 7365 6c65 6374 202a 2066 726f 6d20 7422  select * from t"
+00006790: 290a 2020 2020 2020 2020 2020 2020 726f  ).            ro
+000067a0: 7773 203d 2063 7572 2e66 6574 6368 616c  ws = cur.fetchal
+000067b0: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
+000067c0: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
+000067d0: 7175 616c 2872 6f77 732c 205b 2831 2c29  qual(rows, [(1,)
+000067e0: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
+000067f0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00006800: 2020 2020 2077 6974 6820 7472 616e 7361       with transa
+00006810: 6374 696f 6e28 7365 6c66 2e63 6f6e 293a  ction(self.con):
+00006820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006830: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+00006840: 2822 6465 6c65 7465 2066 726f 6d20 7422  ("delete from t"
+00006850: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006860: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
+00006870: 7074 696f 6e28 290a 2020 2020 2020 2020  ption().        
+00006880: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+00006890: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+000068a0: 2020 2020 2020 7061 7373 0a0a 2020 2020        pass..    
+000068b0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
+000068c0: 7574 6528 2273 656c 6563 7420 2a20 6672  ute("select * fr
+000068d0: 6f6d 2074 2229 0a20 2020 2020 2020 2020  om t").         
+000068e0: 2020 2072 6f77 7320 3d20 6375 722e 6665     rows = cur.fe
+000068f0: 7463 6861 6c6c 2829 0a20 2020 2020 2020  tchall().       
+00006900: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00006910: 4c69 7374 4571 7561 6c28 726f 7773 2c20  ListEqual(rows, 
+00006920: 5b28 312c 295d 290a 0a20 2020 2020 2020  [(1,)])..       
+00006930: 2020 2020 2077 6974 6820 7472 616e 7361       with transa
+00006940: 6374 696f 6e28 7365 6c66 2e63 6f6e 293a  ction(self.con):
+00006950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006960: 2063 7572 2e65 7865 6375 7465 2822 6465   cur.execute("de
+00006970: 6c65 7465 2066 726f 6d20 7422 290a 0a20  lete from t").. 
+00006980: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+00006990: 7865 6375 7465 2822 7365 6c65 6374 202a  xecute("select *
+000069a0: 2066 726f 6d20 7422 290a 2020 2020 2020   from t").      
+000069b0: 2020 2020 2020 726f 7773 203d 2063 7572        rows = cur
+000069c0: 2e66 6574 6368 616c 6c28 290a 2020 2020  .fetchall().    
+000069d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000069e0: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
+000069f0: 732c 205b 5d29 0a20 2020 2064 6566 2074  s, []).    def t
+00006a00: 6573 745f 7361 7665 706f 696e 7428 7365  est_savepoint(se
+00006a10: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
+00006a20: 662e 636f 6e2e 6265 6769 6e28 290a 2020  f.con.begin().  
+00006a30: 2020 2020 2020 7472 203d 2073 656c 662e        tr = self.
+00006a40: 636f 6e2e 6d61 696e 5f74 7261 6e73 6163  con.main_transac
+00006a50: 7469 6f6e 0a20 2020 2020 2020 2073 656c  tion.        sel
+00006a60: 662e 636f 6e2e 6578 6563 7574 655f 696d  f.con.execute_im
+00006a70: 6d65 6469 6174 6528 2269 6e73 6572 7420  mediate("insert 
+00006a80: 696e 746f 2074 2028 6331 2920 7661 6c75  into t (c1) valu
+00006a90: 6573 2028 3129 2229 0a20 2020 2020 2020  es (1)").       
+00006aa0: 2074 722e 7361 7665 706f 696e 7428 2774   tr.savepoint('t
+00006ab0: 6573 7427 290a 2020 2020 2020 2020 7365  est').        se
+00006ac0: 6c66 2e63 6f6e 2e65 7865 6375 7465 5f69  lf.con.execute_i
+00006ad0: 6d6d 6564 6961 7465 2822 696e 7365 7274  mmediate("insert
+00006ae0: 2069 6e74 6f20 7420 2863 3129 2076 616c   into t (c1) val
+00006af0: 7565 7320 2832 2922 290a 2020 2020 2020  ues (2)").      
+00006b00: 2020 7472 2e72 6f6c 6c62 6163 6b28 7361    tr.rollback(sa
+00006b10: 7665 706f 696e 743d 2774 6573 7427 290a  vepoint='test').
+00006b20: 2020 2020 2020 2020 7472 2e63 6f6d 6d69          tr.commi
+00006b30: 7428 290a 2020 2020 2020 2020 7769 7468  t().        with
+00006b40: 2074 722e 6375 7273 6f72 2829 2061 7320   tr.cursor() as 
+00006b50: 6375 723a 0a20 2020 2020 2020 2020 2020  cur:.           
+00006b60: 2063 7572 2e65 7865 6375 7465 2822 7365   cur.execute("se
+00006b70: 6c65 6374 202a 2066 726f 6d20 7422 290a  lect * from t").
+00006b80: 2020 2020 2020 2020 2020 2020 726f 7773              rows
+00006b90: 203d 2063 7572 2e66 6574 6368 616c 6c28   = cur.fetchall(
+00006ba0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00006bb0: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
+00006bc0: 6f77 732c 205b 2831 2c29 5d29 0a20 2020  ows, [(1,)]).   
+00006bd0: 2064 6566 2074 6573 745f 6665 7463 685f   def test_fetch_
+00006be0: 6166 7465 725f 636f 6d6d 6974 2873 656c  after_commit(sel
+00006bf0: 6629 3a0a 2020 2020 2020 2020 7365 6c66  f):.        self
+00006c00: 2e63 6f6e 2e65 7865 6375 7465 5f69 6d6d  .con.execute_imm
+00006c10: 6564 6961 7465 2822 696e 7365 7274 2069  ediate("insert i
+00006c20: 6e74 6f20 7420 2863 3129 2076 616c 7565  nto t (c1) value
+00006c30: 7320 2831 2922 290a 2020 2020 2020 2020  s (1)").        
+00006c40: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
+00006c50: 290a 2020 2020 2020 2020 7769 7468 2073  ).        with s
+00006c60: 656c 662e 636f 6e2e 6375 7273 6f72 2829  elf.con.cursor()
+00006c70: 2061 7320 6375 723a 0a20 2020 2020 2020   as cur:.       
+00006c80: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+00006c90: 2822 7365 6c65 6374 202a 2066 726f 6d20  ("select * from 
+00006ca0: 7422 290a 2020 2020 2020 2020 2020 2020  t").            
+00006cb0: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
+00006cc0: 290a 2020 2020 2020 2020 2020 2020 7769  ).            wi
+00006cd0: 7468 2073 656c 662e 6173 7365 7274 5261  th self.assertRa
+00006ce0: 6973 6573 2849 6e74 6572 6661 6365 4572  ises(InterfaceEr
+00006cf0: 726f 7229 2061 7320 636d 3a0a 2020 2020  ror) as cm:.    
+00006d00: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+00006d10: 6665 7463 6861 6c6c 2829 0a20 2020 2020  fetchall().     
+00006d20: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00006d30: 7274 5475 706c 6545 7175 616c 2863 6d2e  rtTupleEqual(cm.
+00006d40: 6578 6365 7074 696f 6e2e 6172 6773 2c20  exception.args, 
+00006d50: 2827 4361 6e6e 6f74 2066 6574 6368 2066  ('Cannot fetch f
+00006d60: 726f 6d20 6375 7273 6f72 2074 6861 7420  rom cursor that 
+00006d70: 6469 6420 6e6f 7420 6578 6563 7574 6564  did not executed
+00006d80: 2061 2073 7461 7465 6d65 6e74 2e27 2c29   a statement.',)
+00006d90: 290a 2020 2020 6465 6620 7465 7374 5f66  ).    def test_f
+00006da0: 6574 6368 5f61 6674 6572 5f72 6f6c 6c62  etch_after_rollb
+00006db0: 6163 6b28 7365 6c66 293a 0a20 2020 2020  ack(self):.     
+00006dc0: 2020 2073 656c 662e 636f 6e2e 6578 6563     self.con.exec
+00006dd0: 7574 655f 696d 6d65 6469 6174 6528 2269  ute_immediate("i
+00006de0: 6e73 6572 7420 696e 746f 2074 2028 6331  nsert into t (c1
+00006df0: 2920 7661 6c75 6573 2028 3129 2229 0a20  ) values (1)"). 
+00006e00: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+00006e10: 726f 6c6c 6261 636b 2829 0a20 2020 2020  rollback().     
+00006e20: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
+00006e30: 2e63 7572 736f 7228 2920 6173 2063 7572  .cursor() as cur
+00006e40: 3a0a 2020 2020 2020 2020 2020 2020 6375  :.            cu
+00006e50: 722e 6578 6563 7574 6528 2273 656c 6563  r.execute("selec
+00006e60: 7420 2a20 6672 6f6d 2074 2229 0a20 2020  t * from t").   
+00006e70: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
+00006e80: 6e2e 636f 6d6d 6974 2829 0a20 2020 2020  n.commit().     
+00006e90: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
+00006ea0: 2e61 7373 6572 7452 6169 7365 7328 496e  .assertRaises(In
+00006eb0: 7465 7266 6163 6545 7272 6f72 2920 6173  terfaceError) as
+00006ec0: 2063 6d3a 0a20 2020 2020 2020 2020 2020   cm:.           
+00006ed0: 2020 2020 2063 7572 2e66 6574 6368 616c       cur.fetchal
+00006ee0: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
+00006ef0: 7365 6c66 2e61 7373 6572 7454 7570 6c65  self.assertTuple
+00006f00: 4571 7561 6c28 636d 2e65 7863 6570 7469  Equal(cm.excepti
+00006f10: 6f6e 2e61 7267 732c 2028 2743 616e 6e6f  on.args, ('Canno
+00006f20: 7420 6665 7463 6820 6672 6f6d 2063 7572  t fetch from cur
+00006f30: 736f 7220 7468 6174 2064 6964 206e 6f74  sor that did not
+00006f40: 2065 7865 6375 7465 6420 6120 7374 6174   executed a stat
+00006f50: 656d 656e 742e 272c 2929 0a20 2020 2064  ement.',)).    d
+00006f60: 6566 2074 6573 745f 7470 6228 7365 6c66  ef test_tpb(self
+00006f70: 293a 0a20 2020 2020 2020 2074 7062 203d  ):.        tpb =
+00006f80: 2054 5042 2869 736f 6c61 7469 6f6e 3d49   TPB(isolation=I
+00006f90: 736f 6c61 7469 6f6e 2e52 4541 445f 434f  solation.READ_CO
+00006fa0: 4d4d 4954 5445 442c 206e 6f5f 6175 746f  MMITTED, no_auto
+00006fb0: 5f75 6e64 6f3d 5472 7565 290a 2020 2020  _undo=True).    
+00006fc0: 2020 2020 7470 622e 6c6f 636b 5f74 696d      tpb.lock_tim
+00006fd0: 656f 7574 203d 2031 300a 2020 2020 2020  eout = 10.      
+00006fe0: 2020 7470 622e 7265 7365 7276 655f 7461    tpb.reserve_ta
+00006ff0: 626c 6528 2743 4f55 4e54 5259 272c 2054  ble('COUNTRY', T
+00007000: 6162 6c65 5368 6172 654d 6f64 652e 5052  ableShareMode.PR
+00007010: 4f54 4543 5445 442c 2054 6162 6c65 4163  OTECTED, TableAc
+00007020: 6365 7373 4d6f 6465 2e4c 4f43 4b5f 5752  cessMode.LOCK_WR
+00007030: 4954 4529 0a20 2020 2020 2020 2074 7062  ITE).        tpb
+00007040: 5f62 7566 6665 7220 3d20 7470 622e 6765  _buffer = tpb.ge
+00007050: 745f 6275 6666 6572 2829 0a20 2020 2020  t_buffer().     
+00007060: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
+00007070: 2e74 7261 6e73 6163 7469 6f6e 5f6d 616e  .transaction_man
+00007080: 6167 6572 2874 7062 5f62 7566 6665 7229  ager(tpb_buffer)
+00007090: 2061 7320 7472 3a0a 2020 2020 2020 2020   as tr:.        
+000070a0: 2020 2020 696e 666f 203d 2074 722e 696e      info = tr.in
+000070b0: 666f 2e67 6574 5f69 6e66 6f28 5472 6149  fo.get_info(TraI
+000070c0: 6e66 6f43 6f64 652e 4953 4f4c 4154 494f  nfoCode.ISOLATIO
+000070d0: 4e29 0a20 2020 2020 2020 2020 2020 2069  N).            i
+000070e0: 6620 7365 6c66 2e76 6572 7369 6f6e 2069  f self.version i
+000070f0: 6e20 5b46 4234 302c 2046 4235 305d 3a0a  n [FB40, FB50]:.
+00007100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007110: 7365 6c66 2e61 7373 6572 7449 6e28 696e  self.assertIn(in
+00007120: 666f 2c20 5b49 736f 6c61 7469 6f6e 2e52  fo, [Isolation.R
+00007130: 4541 445f 434f 4d4d 4954 5445 445f 5245  EAD_COMMITTED_RE
+00007140: 4144 5f43 4f4e 5349 5354 454e 4359 2c0a  AD_CONSISTENCY,.
+00007150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007170: 2020 2020 2049 736f 6c61 7469 6f6e 2e52       Isolation.R
+00007180: 4541 445f 434f 4d4d 4954 5445 445f 5245  EAD_COMMITTED_RE
+00007190: 434f 5244 5f56 4552 5349 4f4e 5d29 0a20  CORD_VERSION]). 
+000071a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000071b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000071c0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000071d0: 6c28 696e 666f 2c20 4973 6f6c 6174 696f  l(info, Isolatio
+000071e0: 6e2e 5245 4144 5f43 4f4d 4d49 5454 4544  n.READ_COMMITTED
+000071f0: 5f52 4543 4f52 445f 5645 5253 494f 4e29  _RECORD_VERSION)
+00007200: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00007210: 662e 6173 7365 7274 4571 7561 6c28 7472  f.assertEqual(tr
+00007220: 2e69 6e66 6f2e 6765 745f 696e 666f 2854  .info.get_info(T
+00007230: 7261 496e 666f 436f 6465 2e41 4343 4553  raInfoCode.ACCES
+00007240: 5329 2c20 5472 6149 6e66 6f41 6363 6573  S), TraInfoAcces
+00007250: 732e 5245 4144 5f57 5249 5445 290a 2020  s.READ_WRITE).  
+00007260: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00007270: 7373 6572 7445 7175 616c 2874 722e 696e  ssertEqual(tr.in
+00007280: 666f 2e6c 6f63 6b5f 7469 6d65 6f75 742c  fo.lock_timeout,
+00007290: 2031 3029 0a20 2020 2020 2020 2064 656c   10).        del
+000072a0: 2074 7062 0a20 2020 2020 2020 2074 7062   tpb.        tpb
+000072b0: 203d 2054 5042 2829 0a20 2020 2020 2020   = TPB().       
+000072c0: 2074 7062 2e70 6172 7365 5f62 7566 6665   tpb.parse_buffe
+000072d0: 7228 7470 625f 6275 6666 6572 290a 2020  r(tpb_buffer).  
+000072e0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000072f0: 7445 7175 616c 2874 7062 2e61 6363 6573  tEqual(tpb.acces
+00007300: 735f 6d6f 6465 2c20 5472 6141 6363 6573  s_mode, TraAcces
+00007310: 734d 6f64 652e 5752 4954 4529 0a20 2020  sMode.WRITE).   
+00007320: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00007330: 4571 7561 6c28 7470 622e 6973 6f6c 6174  Equal(tpb.isolat
+00007340: 696f 6e2c 2049 736f 6c61 7469 6f6e 2e52  ion, Isolation.R
+00007350: 4541 445f 434f 4d4d 4954 5445 445f 5245  EAD_COMMITTED_RE
+00007360: 434f 5244 5f56 4552 5349 4f4e 290a 2020  CORD_VERSION).  
+00007370: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007380: 7445 7175 616c 2874 7062 2e6c 6f63 6b5f  tEqual(tpb.lock_
+00007390: 7469 6d65 6f75 742c 2031 3029 0a20 2020  timeout, 10).   
+000073a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000073b0: 4661 6c73 6528 7470 622e 6175 746f 5f63  False(tpb.auto_c
+000073c0: 6f6d 6d69 7429 0a20 2020 2020 2020 2073  ommit).        s
+000073d0: 656c 662e 6173 7365 7274 5472 7565 2874  elf.assertTrue(t
+000073e0: 7062 2e6e 6f5f 6175 746f 5f75 6e64 6f29  pb.no_auto_undo)
+000073f0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00007400: 7365 7274 4661 6c73 6528 7470 622e 6967  sertFalse(tpb.ig
+00007410: 6e6f 7265 5f6c 696d 626f 290a 2020 2020  nore_limbo).    
+00007420: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
+00007430: 6973 7445 7175 616c 2874 7062 2e5f 7461  istEqual(tpb._ta
+00007440: 626c 655f 7265 7365 7276 6174 696f 6e2c  ble_reservation,
+00007450: 205b 2827 434f 554e 5452 5927 2c0a 2020   [('COUNTRY',.  
+00007460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007490: 2020 2020 2054 6162 6c65 5368 6172 654d       TableShareM
+000074a0: 6f64 652e 5052 4f54 4543 5445 442c 0a20  ode.PROTECTED,. 
+000074b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074e0: 2020 2020 2020 5461 626c 6541 6363 6573        TableAcces
+000074f0: 734d 6f64 652e 4c4f 434b 5f57 5249 5445  sMode.LOCK_WRITE
+00007500: 295d 290a 2020 2020 6465 6620 7465 7374  )]).    def test
+00007510: 5f74 7261 6e73 6163 7469 6f6e 5f69 6e66  _transaction_inf
+00007520: 6f28 7365 6c66 293a 0a20 2020 2020 2020  o(self):.       
+00007530: 2073 656c 662e 636f 6e2e 6265 6769 6e28   self.con.begin(
+00007540: 290a 2020 2020 2020 2020 7769 7468 2073  ).        with s
+00007550: 656c 662e 636f 6e2e 6d61 696e 5f74 7261  elf.con.main_tra
+00007560: 6e73 6163 7469 6f6e 2061 7320 7472 3a0a  nsaction as tr:.
+00007570: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00007580: 2e61 7373 6572 7454 7275 6528 7472 2e69  .assertTrue(tr.i
+00007590: 735f 6163 7469 7665 2829 290a 2020 2020  s_active()).    
+000075a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000075b0: 6572 7449 6e28 7365 6c66 2e64 6266 696c  ertIn(self.dbfil
+000075c0: 652c 2074 722e 696e 666f 2e64 6174 6162  e, tr.info.datab
+000075d0: 6173 6529 0a20 2020 2020 2020 2020 2020  ase).           
+000075e0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000075f0: 6c28 7472 2e69 6e66 6f2e 6973 6f6c 6174  l(tr.info.isolat
+00007600: 696f 6e2c 2049 736f 6c61 7469 6f6e 2e53  ion, Isolation.S
+00007610: 4e41 5053 484f 5429 0a20 2020 2020 2020  NAPSHOT).       
+00007620: 2020 2020 2023 0a20 2020 2020 2020 2020       #.         
+00007630: 2020 2073 656c 662e 6173 7365 7274 4772     self.assertGr
+00007640: 6561 7465 7228 7472 2e69 6e66 6f2e 6964  eater(tr.info.id
 00007650: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
-00007660: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00007670: 6c28 7472 2e69 6e66 6f2e 6c6f 636b 5f74  l(tr.info.lock_t
-00007680: 696d 656f 7574 2c20 2d31 2920 2023 204e  imeout, -1)  # N
-00007690: 4f5f 5741 4954 2028 5741 4954 203d 2030  O_WAIT (WAIT = 0
-000076a0: 7866 6666 6666 6666 6629 0a20 2020 2020  xffffffff).     
-000076b0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000076c0: 7274 4571 7561 6c28 7472 2e69 6e66 6f2e  rtEqual(tr.info.
-000076d0: 6973 6f6c 6174 696f 6e2c 2049 736f 6c61  isolation, Isola
-000076e0: 7469 6f6e 2e53 4e41 5053 484f 5429 0a0a  tion.SNAPSHOT)..
-000076f0: 636c 6173 7320 5465 7374 4469 7374 7269  class TestDistri
-00007700: 6275 7465 6454 7261 6e73 6163 7469 6f6e  butedTransaction
-00007710: 2844 7269 7665 7254 6573 7442 6173 6529  (DriverTestBase)
-00007720: 3a0a 2020 2020 6465 6620 7365 7455 7028  :.    def setUp(
-00007730: 7365 6c66 293a 0a20 2020 2020 2020 2073  self):.        s
-00007740: 7570 6572 2829 2e73 6574 5570 2829 0a20  uper().setUp(). 
-00007750: 2020 2020 2020 2073 656c 662e 6462 6669         self.dbfi
-00007760: 6c65 203d 206f 732e 7061 7468 2e6a 6f69  le = os.path.joi
-00007770: 6e28 7365 6c66 2e64 6270 6174 682c 2073  n(self.dbpath, s
-00007780: 656c 662e 4642 5445 5354 5f44 4229 0a20  elf.FBTEST_DB). 
-00007790: 2020 2020 2020 2073 656c 662e 6462 3120         self.db1 
-000077a0: 3d20 6f73 2e70 6174 682e 6a6f 696e 2873  = os.path.join(s
-000077b0: 656c 662e 6462 7061 7468 2c20 2766 6274  elf.dbpath, 'fbt
-000077c0: 6573 742d 312e 6664 6227 290a 2020 2020  est-1.fdb').    
-000077d0: 2020 2020 6366 6720 3d20 6472 6976 6572      cfg = driver
-000077e0: 5f63 6f6e 6669 672e 6765 745f 6461 7461  _config.get_data
-000077f0: 6261 7365 2827 6474 732d 3127 290a 2020  base('dts-1').  
-00007800: 2020 2020 2020 6966 2063 6667 2069 7320        if cfg is 
-00007810: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00007820: 2020 6366 6720 3d20 6472 6976 6572 5f63    cfg = driver_c
-00007830: 6f6e 6669 672e 7265 6769 7374 6572 5f64  onfig.register_d
-00007840: 6174 6162 6173 6528 2764 7473 2d31 2729  atabase('dts-1')
-00007850: 0a20 2020 2020 2020 2063 6667 2e73 6572  .        cfg.ser
-00007860: 7665 722e 7661 6c75 6520 3d20 2746 4254  ver.value = 'FBT
-00007870: 4553 545f 484f 5354 270a 2020 2020 2020  EST_HOST'.      
-00007880: 2020 6366 672e 6461 7461 6261 7365 2e76    cfg.database.v
-00007890: 616c 7565 203d 2073 656c 662e 6462 310a  alue = self.db1.
-000078a0: 2020 2020 2020 2020 6366 672e 6e6f 5f6c          cfg.no_l
-000078b0: 696e 6765 722e 7661 6c75 6520 3d20 5472  inger.value = Tr
-000078c0: 7565 0a20 2020 2020 2020 2073 656c 662e  ue.        self.
-000078d0: 636f 6e31 203d 2063 7265 6174 655f 6461  con1 = create_da
-000078e0: 7461 6261 7365 2827 6474 732d 3127 2c20  tabase('dts-1', 
-000078f0: 7573 6572 3d46 4254 4553 545f 5553 4552  user=FBTEST_USER
-00007900: 2c20 7061 7373 776f 7264 3d46 4254 4553  , password=FBTES
-00007910: 545f 5041 5353 574f 5244 2c20 6f76 6572  T_PASSWORD, over
-00007920: 7772 6974 653d 5472 7565 290a 2020 2020  write=True).    
-00007930: 2020 2020 7365 6c66 2e63 6f6e 312e 5f6c      self.con1._l
-00007940: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
-00007950: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00007960: 6d65 5f5f 0a20 2020 2020 2020 2073 656c  me__.        sel
-00007970: 662e 636f 6e31 2e65 7865 6375 7465 5f69  f.con1.execute_i
-00007980: 6d6d 6564 6961 7465 2822 7265 6372 6561  mmediate("recrea
-00007990: 7465 2074 6162 6c65 2054 2028 504b 2069  te table T (PK i
-000079a0: 6e74 6567 6572 2c20 4331 2069 6e74 6567  nteger, C1 integ
-000079b0: 6572 2922 290a 2020 2020 2020 2020 7365  er)").        se
-000079c0: 6c66 2e63 6f6e 312e 636f 6d6d 6974 2829  lf.con1.commit()
-000079d0: 0a0a 2020 2020 2020 2020 7365 6c66 2e64  ..        self.d
-000079e0: 6232 203d 206f 732e 7061 7468 2e6a 6f69  b2 = os.path.joi
-000079f0: 6e28 7365 6c66 2e64 6270 6174 682c 2027  n(self.dbpath, '
-00007a00: 6662 7465 7374 2d32 2e66 6462 2729 0a20  fbtest-2.fdb'). 
-00007a10: 2020 2020 2020 2063 6667 203d 2064 7269         cfg = dri
-00007a20: 7665 725f 636f 6e66 6967 2e67 6574 5f64  ver_config.get_d
-00007a30: 6174 6162 6173 6528 2764 7473 2d32 2729  atabase('dts-2')
-00007a40: 0a20 2020 2020 2020 2069 6620 6366 6720  .        if cfg 
-00007a50: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00007a60: 2020 2020 2063 6667 203d 2064 7269 7665       cfg = drive
-00007a70: 725f 636f 6e66 6967 2e72 6567 6973 7465  r_config.registe
-00007a80: 725f 6461 7461 6261 7365 2827 6474 732d  r_database('dts-
-00007a90: 3227 290a 2020 2020 2020 2020 6366 672e  2').        cfg.
-00007aa0: 7365 7276 6572 2e76 616c 7565 203d 2027  server.value = '
-00007ab0: 4642 5445 5354 5f48 4f53 5427 0a20 2020  FBTEST_HOST'.   
-00007ac0: 2020 2020 2063 6667 2e64 6174 6162 6173       cfg.databas
-00007ad0: 652e 7661 6c75 6520 3d20 7365 6c66 2e64  e.value = self.d
-00007ae0: 6232 0a20 2020 2020 2020 2063 6667 2e6e  b2.        cfg.n
-00007af0: 6f5f 6c69 6e67 6572 2e76 616c 7565 203d  o_linger.value =
-00007b00: 2054 7275 650a 2020 2020 2020 2020 7365   True.        se
-00007b10: 6c66 2e63 6f6e 3220 3d20 6372 6561 7465  lf.con2 = create
-00007b20: 5f64 6174 6162 6173 6528 2764 7473 2d32  _database('dts-2
-00007b30: 272c 2075 7365 723d 4642 5445 5354 5f55  ', user=FBTEST_U
-00007b40: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
-00007b50: 5445 5354 5f50 4153 5357 4f52 442c 206f  TEST_PASSWORD, o
-00007b60: 7665 7277 7269 7465 3d54 7275 6529 0a20  verwrite=True). 
-00007b70: 2020 2020 2020 2073 656c 662e 636f 6e32         self.con2
-00007b80: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
-00007b90: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-00007ba0: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
-00007bb0: 7365 6c66 2e63 6f6e 322e 6578 6563 7574  self.con2.execut
-00007bc0: 655f 696d 6d65 6469 6174 6528 2272 6563  e_immediate("rec
-00007bd0: 7265 6174 6520 7461 626c 6520 5420 2850  reate table T (P
-00007be0: 4b20 696e 7465 6765 722c 2043 3120 696e  K integer, C1 in
-00007bf0: 7465 6765 7229 2229 0a20 2020 2020 2020  teger)").       
-00007c00: 2073 656c 662e 636f 6e32 2e63 6f6d 6d69   self.con2.commi
-00007c10: 7428 290a 2020 2020 6465 6620 7465 6172  t().    def tear
-00007c20: 446f 776e 2873 656c 6629 3a0a 2020 2020  Down(self):.    
-00007c30: 2020 2020 2369 6620 7365 6c66 2e63 6f6e      #if self.con
-00007c40: 3120 616e 6420 7365 6c66 2e63 6f6e 312e  1 and self.con1.
-00007c50: 6772 6f75 703a 0a20 2020 2020 2020 2020  group:.         
-00007c60: 2020 2023 2320 5765 2063 616e 2774 2064     ## We can't d
-00007c70: 726f 7020 6461 7461 6261 7365 2076 6961  rop database via
-00007c80: 2063 6f6e 6e65 6374 696f 6e20 696e 2067   connection in g
-00007c90: 726f 7570 0a20 2020 2020 2020 2020 2020  roup.           
-00007ca0: 2023 7365 6c66 2e63 6f6e 312e 6772 6f75   #self.con1.grou
-00007cb0: 702e 6469 7362 616e 6428 290a 2020 2020  p.disband().    
-00007cc0: 2020 2020 6966 2073 656c 662e 636f 6e31      if self.con1
-00007cd0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00007ce0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-00007cf0: 6f6e 312e 636c 6f73 6528 290a 2020 2020  on1.close().    
-00007d00: 2020 2020 6966 2073 656c 662e 636f 6e32      if self.con2
-00007d10: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00007d20: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-00007d30: 6f6e 322e 636c 6f73 6528 290a 2020 2020  on2.close().    
-00007d40: 2020 2020 230a 2020 2020 2020 2020 7769      #.        wi
-00007d50: 7468 2063 6f6e 6e65 6374 5f73 6572 7665  th connect_serve
-00007d60: 7228 2746 4254 4553 545f 484f 5354 2729  r('FBTEST_HOST')
-00007d70: 2061 7320 7372 763a 0a20 2020 2020 2020   as srv:.       
-00007d80: 2020 2020 2073 7276 2e64 6174 6162 6173       srv.databas
-00007d90: 652e 7368 7574 646f 776e 2864 6174 6162  e.shutdown(datab
-00007da0: 6173 653d 7365 6c66 2e64 6231 2c20 6d6f  ase=self.db1, mo
-00007db0: 6465 3d53 6875 7464 6f77 6e4d 6f64 652e  de=ShutdownMode.
-00007dc0: 4655 4c4c 2c0a 2020 2020 2020 2020 2020  FULL,.          
-00007dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007de0: 2020 2020 2020 2020 6d65 7468 6f64 3d53          method=S
-00007df0: 6875 7464 6f77 6e4d 6574 686f 642e 464f  hutdownMethod.FO
-00007e00: 5243 4544 2c20 7469 6d65 6f75 743d 3029  RCED, timeout=0)
-00007e10: 0a20 2020 2020 2020 2020 2020 2073 7276  .            srv
-00007e20: 2e64 6174 6162 6173 652e 6272 696e 675f  .database.bring_
-00007e30: 6f6e 6c69 6e65 2864 6174 6162 6173 653d  online(database=
-00007e40: 7365 6c66 2e64 6231 290a 2020 2020 2020  self.db1).      
-00007e50: 2020 7769 7468 2063 6f6e 6e65 6374 2827    with connect('
-00007e60: 6474 732d 3127 2920 6173 2063 6f6e 3a0a  dts-1') as con:.
-00007e70: 2020 2020 2020 2020 2020 2020 636f 6e2e              con.
-00007e80: 6472 6f70 5f64 6174 6162 6173 6528 290a  drop_database().
-00007e90: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
-00007ea0: 2020 7769 7468 2063 6f6e 6e65 6374 5f73    with connect_s
-00007eb0: 6572 7665 7228 2746 4254 4553 545f 484f  erver('FBTEST_HO
-00007ec0: 5354 2729 2061 7320 7372 763a 0a20 2020  ST') as srv:.   
-00007ed0: 2020 2020 2020 2020 2073 7276 2e64 6174           srv.dat
-00007ee0: 6162 6173 652e 7368 7574 646f 776e 2864  abase.shutdown(d
-00007ef0: 6174 6162 6173 653d 7365 6c66 2e64 6232  atabase=self.db2
-00007f00: 2c20 6d6f 6465 3d53 6875 7464 6f77 6e4d  , mode=ShutdownM
-00007f10: 6f64 652e 4655 4c4c 2c0a 2020 2020 2020  ode.FULL,.      
-00007f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f30: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00007f40: 6f64 3d53 6875 7464 6f77 6e4d 6574 686f  od=ShutdownMetho
-00007f50: 642e 464f 5243 4544 2c20 7469 6d65 6f75  d.FORCED, timeou
-00007f60: 743d 3029 0a20 2020 2020 2020 2020 2020  t=0).           
-00007f70: 2073 7276 2e64 6174 6162 6173 652e 6272   srv.database.br
-00007f80: 696e 675f 6f6e 6c69 6e65 2864 6174 6162  ing_online(datab
-00007f90: 6173 653d 7365 6c66 2e64 6232 290a 2020  ase=self.db2).  
-00007fa0: 2020 2020 2020 7769 7468 2063 6f6e 6e65        with conne
-00007fb0: 6374 2827 6474 732d 3227 2920 6173 2063  ct('dts-2') as c
-00007fc0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00007fd0: 636f 6e2e 6472 6f70 5f64 6174 6162 6173  con.drop_databas
-00007fe0: 6528 290a 2020 2020 6465 6620 7465 7374  e().    def test
-00007ff0: 5f63 6f6e 7465 7874 5f6d 616e 6167 6572  _context_manager
-00008000: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00008010: 7769 7468 2044 6973 7472 6962 7574 6564  with Distributed
-00008020: 5472 616e 7361 6374 696f 6e4d 616e 6167  TransactionManag
-00008030: 6572 2828 7365 6c66 2e63 6f6e 312c 2073  er((self.con1, s
-00008040: 656c 662e 636f 6e32 2929 2061 7320 6474  elf.con2)) as dt
-00008050: 3a0a 2020 2020 2020 2020 2020 2020 7120  :.            q 
-00008060: 3d20 2773 656c 6563 7420 2a20 6672 6f6d  = 'select * from
-00008070: 2054 206f 7264 6572 2062 7920 706b 270a   T order by pk'.
-00008080: 2020 2020 2020 2020 2020 2020 7769 7468              with
-00008090: 2064 742e 6375 7273 6f72 2873 656c 662e   dt.cursor(self.
-000080a0: 636f 6e31 2920 6173 2063 312c 2073 656c  con1) as c1, sel
-000080b0: 662e 636f 6e31 2e63 7572 736f 7228 2920  f.con1.cursor() 
-000080c0: 6173 2063 6331 2c20 5c0a 2020 2020 2020  as cc1, \.      
-000080d0: 2020 2020 2020 2020 2020 2064 742e 6375             dt.cu
-000080e0: 7273 6f72 2873 656c 662e 636f 6e32 2920  rsor(self.con2) 
-000080f0: 6173 2063 322c 2073 656c 662e 636f 6e32  as c2, self.con2
-00008100: 2e63 7572 736f 7228 2920 6173 2063 6332  .cursor() as cc2
-00008110: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00008120: 2020 2023 2044 6973 7472 6962 7574 6564     # Distributed
-00008130: 2074 7261 6e73 6163 7469 6f6e 3a20 434f   transaction: CO
-00008140: 4d4d 4954 0a20 2020 2020 2020 2020 2020  MMIT.           
-00008150: 2020 2020 2077 6974 6820 7472 616e 7361       with transa
-00008160: 6374 696f 6e28 6474 293a 0a20 2020 2020  ction(dt):.     
-00008170: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00008180: 312e 6578 6563 7574 6528 2769 6e73 6572  1.execute('inser
-00008190: 7420 696e 746f 2074 2028 706b 2920 7661  t into t (pk) va
-000081a0: 6c75 6573 2028 3129 2729 0a20 2020 2020  lues (1)').     
-000081b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000081c0: 322e 6578 6563 7574 6528 2769 6e73 6572  2.execute('inser
-000081d0: 7420 696e 746f 2074 2028 706b 2920 7661  t into t (pk) va
-000081e0: 6c75 6573 2028 3129 2729 0a0a 2020 2020  lues (1)')..    
-000081f0: 2020 2020 2020 2020 2020 2020 7769 7468              with
-00008200: 2074 7261 6e73 6163 7469 6f6e 2873 656c   transaction(sel
-00008210: 662e 636f 6e31 293a 0a20 2020 2020 2020  f.con1):.       
-00008220: 2020 2020 2020 2020 2020 2020 2063 6331               cc1
-00008230: 2e65 7865 6375 7465 2871 290a 2020 2020  .execute(q).    
-00008240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008250: 7265 7375 6c74 203d 2063 6331 2e66 6574  result = cc1.fet
-00008260: 6368 616c 6c28 290a 2020 2020 2020 2020  chall().        
-00008270: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00008280: 6572 744c 6973 7445 7175 616c 2872 6573  ertListEqual(res
-00008290: 756c 742c 205b 2831 2c20 4e6f 6e65 295d  ult, [(1, None)]
-000082a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000082b0: 2020 7769 7468 2074 7261 6e73 6163 7469    with transacti
-000082c0: 6f6e 2873 656c 662e 636f 6e32 293a 0a20  on(self.con2):. 
-000082d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000082e0: 2020 2063 6332 2e65 7865 6375 7465 2871     cc2.execute(q
-000082f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00008300: 2020 2020 2020 7265 7375 6c74 203d 2063        result = c
-00008310: 6332 2e66 6574 6368 616c 6c28 290a 2020  c2.fetchall().  
-00008320: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00008330: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-00008340: 616c 2872 6573 756c 742c 205b 2831 2c20  al(result, [(1, 
-00008350: 4e6f 6e65 295d 290a 0a20 2020 2020 2020  None)])..       
-00008360: 2020 2020 2020 2020 2023 2044 6973 7472           # Distr
-00008370: 6962 7574 6564 2074 7261 6e73 6163 7469  ibuted transacti
-00008380: 6f6e 3a20 524f 4c4c 4241 434b 0a20 2020  on: ROLLBACK.   
-00008390: 2020 2020 2020 2020 2020 2020 2074 7279               try
-000083a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000083b0: 2020 2020 2020 7769 7468 2074 7261 6e73        with trans
-000083c0: 6163 7469 6f6e 2864 7429 3a0a 2020 2020  action(dt):.    
-000083d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083e0: 2020 2020 6331 2e65 7865 6375 7465 2827      c1.execute('
-000083f0: 696e 7365 7274 2069 6e74 6f20 7420 2870  insert into t (p
-00008400: 6b29 2076 616c 7565 7320 2832 2927 290a  k) values (2)').
-00008410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008420: 2020 2020 2020 2020 6332 2e65 7865 6375          c2.execu
-00008430: 7465 2827 696e 7365 7274 2069 6e74 6f20  te('insert into 
-00008440: 7420 2870 6b29 2076 616c 7565 7320 2832  t (pk) values (2
-00008450: 2927 290a 2020 2020 2020 2020 2020 2020  )').            
-00008460: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00008470: 6520 4578 6365 7074 696f 6e28 290a 2020  e Exception().  
-00008480: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-00008490: 6365 7074 2045 7863 6570 7469 6f6e 3a0a  cept Exception:.
+00007660: 2073 656c 662e 6173 7365 7274 4772 6561   self.assertGrea
+00007670: 7465 7228 7472 2e69 6e66 6f2e 6f69 742c  ter(tr.info.oit,
+00007680: 2030 290a 2020 2020 2020 2020 2020 2020   0).            
+00007690: 7365 6c66 2e61 7373 6572 7447 7265 6174  self.assertGreat
+000076a0: 6572 2874 722e 696e 666f 2e6f 6174 2c20  er(tr.info.oat, 
+000076b0: 3029 0a20 2020 2020 2020 2020 2020 2073  0).            s
+000076c0: 656c 662e 6173 7365 7274 4772 6561 7465  elf.assertGreate
+000076d0: 7228 7472 2e69 6e66 6f2e 6f73 742c 2030  r(tr.info.ost, 0
+000076e0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+000076f0: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
+00007700: 722e 696e 666f 2e6c 6f63 6b5f 7469 6d65  r.info.lock_time
+00007710: 6f75 742c 202d 3129 2020 2320 4e4f 5f57  out, -1)  # NO_W
+00007720: 4149 5420 2857 4149 5420 3d20 3078 6666  AIT (WAIT = 0xff
+00007730: 6666 6666 6666 290a 2020 2020 2020 2020  ffffff).        
+00007740: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00007750: 7175 616c 2874 722e 696e 666f 2e69 736f  qual(tr.info.iso
+00007760: 6c61 7469 6f6e 2c20 4973 6f6c 6174 696f  lation, Isolatio
+00007770: 6e2e 534e 4150 5348 4f54 290a 0a63 6c61  n.SNAPSHOT)..cla
+00007780: 7373 2054 6573 7444 6973 7472 6962 7574  ss TestDistribut
+00007790: 6564 5472 616e 7361 6374 696f 6e28 4472  edTransaction(Dr
+000077a0: 6976 6572 5465 7374 4261 7365 293a 0a20  iverTestBase):. 
+000077b0: 2020 2064 6566 2073 6574 5570 2873 656c     def setUp(sel
+000077c0: 6629 3a0a 2020 2020 2020 2020 7375 7065  f):.        supe
+000077d0: 7228 292e 7365 7455 7028 290a 2020 2020  r().setUp().    
+000077e0: 2020 2020 7365 6c66 2e64 6266 696c 6520      self.dbfile 
+000077f0: 3d20 6f73 2e70 6174 682e 6a6f 696e 2873  = os.path.join(s
+00007800: 656c 662e 6462 7061 7468 2c20 7365 6c66  elf.dbpath, self
+00007810: 2e46 4254 4553 545f 4442 290a 2020 2020  .FBTEST_DB).    
+00007820: 2020 2020 7365 6c66 2e64 6231 203d 206f      self.db1 = o
+00007830: 732e 7061 7468 2e6a 6f69 6e28 7365 6c66  s.path.join(self
+00007840: 2e64 6270 6174 682c 2027 6662 7465 7374  .dbpath, 'fbtest
+00007850: 2d31 2e66 6462 2729 0a20 2020 2020 2020  -1.fdb').       
+00007860: 2063 6667 203d 2064 7269 7665 725f 636f   cfg = driver_co
+00007870: 6e66 6967 2e67 6574 5f64 6174 6162 6173  nfig.get_databas
+00007880: 6528 2764 7473 2d31 2729 0a20 2020 2020  e('dts-1').     
+00007890: 2020 2069 6620 6366 6720 6973 204e 6f6e     if cfg is Non
+000078a0: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+000078b0: 6667 203d 2064 7269 7665 725f 636f 6e66  fg = driver_conf
+000078c0: 6967 2e72 6567 6973 7465 725f 6461 7461  ig.register_data
+000078d0: 6261 7365 2827 6474 732d 3127 290a 2020  base('dts-1').  
+000078e0: 2020 2020 2020 6366 672e 7365 7276 6572        cfg.server
+000078f0: 2e76 616c 7565 203d 2027 4642 5445 5354  .value = 'FBTEST
+00007900: 5f48 4f53 5427 0a20 2020 2020 2020 2063  _HOST'.        c
+00007910: 6667 2e64 6174 6162 6173 652e 7661 6c75  fg.database.valu
+00007920: 6520 3d20 7365 6c66 2e64 6231 0a20 2020  e = self.db1.   
+00007930: 2020 2020 2063 6667 2e6e 6f5f 6c69 6e67       cfg.no_ling
+00007940: 6572 2e76 616c 7565 203d 2054 7275 650a  er.value = True.
+00007950: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+00007960: 3120 3d20 6372 6561 7465 5f64 6174 6162  1 = create_datab
+00007970: 6173 6528 2764 7473 2d31 272c 2075 7365  ase('dts-1', use
+00007980: 723d 4642 5445 5354 5f55 5345 522c 2070  r=FBTEST_USER, p
+00007990: 6173 7377 6f72 643d 4642 5445 5354 5f50  assword=FBTEST_P
+000079a0: 4153 5357 4f52 442c 206f 7665 7277 7269  ASSWORD, overwri
+000079b0: 7465 3d54 7275 6529 0a20 2020 2020 2020  te=True).       
+000079c0: 2073 656c 662e 636f 6e31 2e5f 6c6f 6767   self.con1._logg
+000079d0: 696e 675f 6964 5f20 3d20 7365 6c66 2e5f  ing_id_ = self._
+000079e0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+000079f0: 5f0a 2020 2020 2020 2020 7365 6c66 2e63  _.        self.c
+00007a00: 6f6e 312e 6578 6563 7574 655f 696d 6d65  on1.execute_imme
+00007a10: 6469 6174 6528 2272 6563 7265 6174 6520  diate("recreate 
+00007a20: 7461 626c 6520 5420 2850 4b20 696e 7465  table T (PK inte
+00007a30: 6765 722c 2043 3120 696e 7465 6765 7229  ger, C1 integer)
+00007a40: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00007a50: 636f 6e31 2e63 6f6d 6d69 7428 290a 0a20  con1.commit().. 
+00007a60: 2020 2020 2020 2073 656c 662e 6462 3220         self.db2 
+00007a70: 3d20 6f73 2e70 6174 682e 6a6f 696e 2873  = os.path.join(s
+00007a80: 656c 662e 6462 7061 7468 2c20 2766 6274  elf.dbpath, 'fbt
+00007a90: 6573 742d 322e 6664 6227 290a 2020 2020  est-2.fdb').    
+00007aa0: 2020 2020 6366 6720 3d20 6472 6976 6572      cfg = driver
+00007ab0: 5f63 6f6e 6669 672e 6765 745f 6461 7461  _config.get_data
+00007ac0: 6261 7365 2827 6474 732d 3227 290a 2020  base('dts-2').  
+00007ad0: 2020 2020 2020 6966 2063 6667 2069 7320        if cfg is 
+00007ae0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00007af0: 2020 6366 6720 3d20 6472 6976 6572 5f63    cfg = driver_c
+00007b00: 6f6e 6669 672e 7265 6769 7374 6572 5f64  onfig.register_d
+00007b10: 6174 6162 6173 6528 2764 7473 2d32 2729  atabase('dts-2')
+00007b20: 0a20 2020 2020 2020 2063 6667 2e73 6572  .        cfg.ser
+00007b30: 7665 722e 7661 6c75 6520 3d20 2746 4254  ver.value = 'FBT
+00007b40: 4553 545f 484f 5354 270a 2020 2020 2020  EST_HOST'.      
+00007b50: 2020 6366 672e 6461 7461 6261 7365 2e76    cfg.database.v
+00007b60: 616c 7565 203d 2073 656c 662e 6462 320a  alue = self.db2.
+00007b70: 2020 2020 2020 2020 6366 672e 6e6f 5f6c          cfg.no_l
+00007b80: 696e 6765 722e 7661 6c75 6520 3d20 5472  inger.value = Tr
+00007b90: 7565 0a20 2020 2020 2020 2073 656c 662e  ue.        self.
+00007ba0: 636f 6e32 203d 2063 7265 6174 655f 6461  con2 = create_da
+00007bb0: 7461 6261 7365 2827 6474 732d 3227 2c20  tabase('dts-2', 
+00007bc0: 7573 6572 3d46 4254 4553 545f 5553 4552  user=FBTEST_USER
+00007bd0: 2c20 7061 7373 776f 7264 3d46 4254 4553  , password=FBTES
+00007be0: 545f 5041 5353 574f 5244 2c20 6f76 6572  T_PASSWORD, over
+00007bf0: 7772 6974 653d 5472 7565 290a 2020 2020  write=True).    
+00007c00: 2020 2020 7365 6c66 2e63 6f6e 322e 5f6c      self.con2._l
+00007c10: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
+00007c20: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+00007c30: 6d65 5f5f 0a20 2020 2020 2020 2073 656c  me__.        sel
+00007c40: 662e 636f 6e32 2e65 7865 6375 7465 5f69  f.con2.execute_i
+00007c50: 6d6d 6564 6961 7465 2822 7265 6372 6561  mmediate("recrea
+00007c60: 7465 2074 6162 6c65 2054 2028 504b 2069  te table T (PK i
+00007c70: 6e74 6567 6572 2c20 4331 2069 6e74 6567  nteger, C1 integ
+00007c80: 6572 2922 290a 2020 2020 2020 2020 7365  er)").        se
+00007c90: 6c66 2e63 6f6e 322e 636f 6d6d 6974 2829  lf.con2.commit()
+00007ca0: 0a20 2020 2064 6566 2074 6561 7244 6f77  .    def tearDow
+00007cb0: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
+00007cc0: 2023 6966 2073 656c 662e 636f 6e31 2061   #if self.con1 a
+00007cd0: 6e64 2073 656c 662e 636f 6e31 2e67 726f  nd self.con1.gro
+00007ce0: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
+00007cf0: 2323 2057 6520 6361 6e27 7420 6472 6f70  ## We can't drop
+00007d00: 2064 6174 6162 6173 6520 7669 6120 636f   database via co
+00007d10: 6e6e 6563 7469 6f6e 2069 6e20 6772 6f75  nnection in grou
+00007d20: 700a 2020 2020 2020 2020 2020 2020 2373  p.            #s
+00007d30: 656c 662e 636f 6e31 2e67 726f 7570 2e64  elf.con1.group.d
+00007d40: 6973 6261 6e64 2829 0a20 2020 2020 2020  isband().       
+00007d50: 2069 6620 7365 6c66 2e63 6f6e 3120 6973   if self.con1 is
+00007d60: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00007d70: 2020 2020 2020 2073 656c 662e 636f 6e31         self.con1
+00007d80: 2e63 6c6f 7365 2829 0a20 2020 2020 2020  .close().       
+00007d90: 2069 6620 7365 6c66 2e63 6f6e 3220 6973   if self.con2 is
+00007da0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00007db0: 2020 2020 2020 2073 656c 662e 636f 6e32         self.con2
+00007dc0: 2e63 6c6f 7365 2829 0a20 2020 2020 2020  .close().       
+00007dd0: 2023 0a20 2020 2020 2020 2077 6974 6820   #.        with 
+00007de0: 636f 6e6e 6563 745f 7365 7276 6572 2827  connect_server('
+00007df0: 4642 5445 5354 5f48 4f53 5427 2920 6173  FBTEST_HOST') as
+00007e00: 2073 7276 3a0a 2020 2020 2020 2020 2020   srv:.          
+00007e10: 2020 7372 762e 6461 7461 6261 7365 2e73    srv.database.s
+00007e20: 6875 7464 6f77 6e28 6461 7461 6261 7365  hutdown(database
+00007e30: 3d73 656c 662e 6462 312c 206d 6f64 653d  =self.db1, mode=
+00007e40: 5368 7574 646f 776e 4d6f 6465 2e46 554c  ShutdownMode.FUL
+00007e50: 4c2c 0a20 2020 2020 2020 2020 2020 2020  L,.             
+00007e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007e70: 2020 2020 206d 6574 686f 643d 5368 7574       method=Shut
+00007e80: 646f 776e 4d65 7468 6f64 2e46 4f52 4345  downMethod.FORCE
+00007e90: 442c 2074 696d 656f 7574 3d30 290a 2020  D, timeout=0).  
+00007ea0: 2020 2020 2020 2020 2020 7372 762e 6461            srv.da
+00007eb0: 7461 6261 7365 2e62 7269 6e67 5f6f 6e6c  tabase.bring_onl
+00007ec0: 696e 6528 6461 7461 6261 7365 3d73 656c  ine(database=sel
+00007ed0: 662e 6462 3129 0a20 2020 2020 2020 2077  f.db1).        w
+00007ee0: 6974 6820 636f 6e6e 6563 7428 2764 7473  ith connect('dts
+00007ef0: 2d31 2729 2061 7320 636f 6e3a 0a20 2020  -1') as con:.   
+00007f00: 2020 2020 2020 2020 2063 6f6e 2e64 726f           con.dro
+00007f10: 705f 6461 7461 6261 7365 2829 0a20 2020  p_database().   
+00007f20: 2020 2020 2023 0a20 2020 2020 2020 2077       #.        w
+00007f30: 6974 6820 636f 6e6e 6563 745f 7365 7276  ith connect_serv
+00007f40: 6572 2827 4642 5445 5354 5f48 4f53 5427  er('FBTEST_HOST'
+00007f50: 2920 6173 2073 7276 3a0a 2020 2020 2020  ) as srv:.      
+00007f60: 2020 2020 2020 7372 762e 6461 7461 6261        srv.databa
+00007f70: 7365 2e73 6875 7464 6f77 6e28 6461 7461  se.shutdown(data
+00007f80: 6261 7365 3d73 656c 662e 6462 322c 206d  base=self.db2, m
+00007f90: 6f64 653d 5368 7574 646f 776e 4d6f 6465  ode=ShutdownMode
+00007fa0: 2e46 554c 4c2c 0a20 2020 2020 2020 2020  .FULL,.         
+00007fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007fc0: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+00007fd0: 5368 7574 646f 776e 4d65 7468 6f64 2e46  ShutdownMethod.F
+00007fe0: 4f52 4345 442c 2074 696d 656f 7574 3d30  ORCED, timeout=0
+00007ff0: 290a 2020 2020 2020 2020 2020 2020 7372  ).            sr
+00008000: 762e 6461 7461 6261 7365 2e62 7269 6e67  v.database.bring
+00008010: 5f6f 6e6c 696e 6528 6461 7461 6261 7365  _online(database
+00008020: 3d73 656c 662e 6462 3229 0a20 2020 2020  =self.db2).     
+00008030: 2020 2077 6974 6820 636f 6e6e 6563 7428     with connect(
+00008040: 2764 7473 2d32 2729 2061 7320 636f 6e3a  'dts-2') as con:
+00008050: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00008060: 2e64 726f 705f 6461 7461 6261 7365 2829  .drop_database()
+00008070: 0a20 2020 2064 6566 2074 6573 745f 636f  .    def test_co
+00008080: 6e74 6578 745f 6d61 6e61 6765 7228 7365  ntext_manager(se
+00008090: 6c66 293a 0a20 2020 2020 2020 2077 6974  lf):.        wit
+000080a0: 6820 4469 7374 7269 6275 7465 6454 7261  h DistributedTra
+000080b0: 6e73 6163 7469 6f6e 4d61 6e61 6765 7228  nsactionManager(
+000080c0: 2873 656c 662e 636f 6e31 2c20 7365 6c66  (self.con1, self
+000080d0: 2e63 6f6e 3229 2920 6173 2064 743a 0a20  .con2)) as dt:. 
+000080e0: 2020 2020 2020 2020 2020 2071 203d 2027             q = '
+000080f0: 7365 6c65 6374 202a 2066 726f 6d20 5420  select * from T 
+00008100: 6f72 6465 7220 6279 2070 6b27 0a20 2020  order by pk'.   
+00008110: 2020 2020 2020 2020 2077 6974 6820 6474           with dt
+00008120: 2e63 7572 736f 7228 7365 6c66 2e63 6f6e  .cursor(self.con
+00008130: 3129 2061 7320 6331 2c20 7365 6c66 2e63  1) as c1, self.c
+00008140: 6f6e 312e 6375 7273 6f72 2829 2061 7320  on1.cursor() as 
+00008150: 6363 312c 205c 0a20 2020 2020 2020 2020  cc1, \.         
+00008160: 2020 2020 2020 2020 6474 2e63 7572 736f          dt.curso
+00008170: 7228 7365 6c66 2e63 6f6e 3229 2061 7320  r(self.con2) as 
+00008180: 6332 2c20 7365 6c66 2e63 6f6e 322e 6375  c2, self.con2.cu
+00008190: 7273 6f72 2829 2061 7320 6363 323a 0a0a  rsor() as cc2:..
+000081a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081b0: 2320 4469 7374 7269 6275 7465 6420 7472  # Distributed tr
+000081c0: 616e 7361 6374 696f 6e3a 2043 4f4d 4d49  ansaction: COMMI
+000081d0: 540a 2020 2020 2020 2020 2020 2020 2020  T.              
+000081e0: 2020 7769 7468 2074 7261 6e73 6163 7469    with transacti
+000081f0: 6f6e 2864 7429 3a0a 2020 2020 2020 2020  on(dt):.        
+00008200: 2020 2020 2020 2020 2020 2020 6331 2e65              c1.e
+00008210: 7865 6375 7465 2827 696e 7365 7274 2069  xecute('insert i
+00008220: 6e74 6f20 7420 2870 6b29 2076 616c 7565  nto t (pk) value
+00008230: 7320 2831 2927 290a 2020 2020 2020 2020  s (1)').        
+00008240: 2020 2020 2020 2020 2020 2020 6332 2e65              c2.e
+00008250: 7865 6375 7465 2827 696e 7365 7274 2069  xecute('insert i
+00008260: 6e74 6f20 7420 2870 6b29 2076 616c 7565  nto t (pk) value
+00008270: 7320 2831 2927 290a 0a20 2020 2020 2020  s (1)')..       
+00008280: 2020 2020 2020 2020 2077 6974 6820 7472           with tr
+00008290: 616e 7361 6374 696f 6e28 7365 6c66 2e63  ansaction(self.c
+000082a0: 6f6e 3129 3a0a 2020 2020 2020 2020 2020  on1):.          
+000082b0: 2020 2020 2020 2020 2020 6363 312e 6578            cc1.ex
+000082c0: 6563 7574 6528 7129 0a20 2020 2020 2020  ecute(q).       
+000082d0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+000082e0: 756c 7420 3d20 6363 312e 6665 7463 6861  ult = cc1.fetcha
+000082f0: 6c6c 2829 0a20 2020 2020 2020 2020 2020  ll().           
+00008300: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00008310: 4c69 7374 4571 7561 6c28 7265 7375 6c74  ListEqual(result
+00008320: 2c20 5b28 312c 204e 6f6e 6529 5d29 0a20  , [(1, None)]). 
+00008330: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00008340: 6974 6820 7472 616e 7361 6374 696f 6e28  ith transaction(
+00008350: 7365 6c66 2e63 6f6e 3229 3a0a 2020 2020  self.con2):.    
+00008360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008370: 6363 322e 6578 6563 7574 6528 7129 0a20  cc2.execute(q). 
+00008380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008390: 2020 2072 6573 756c 7420 3d20 6363 322e     result = cc2.
+000083a0: 6665 7463 6861 6c6c 2829 0a20 2020 2020  fetchall().     
+000083b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000083c0: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
+000083d0: 7265 7375 6c74 2c20 5b28 312c 204e 6f6e  result, [(1, Non
+000083e0: 6529 5d29 0a0a 2020 2020 2020 2020 2020  e)])..          
+000083f0: 2020 2020 2020 2320 4469 7374 7269 6275        # Distribu
+00008400: 7465 6420 7472 616e 7361 6374 696f 6e3a  ted transaction:
+00008410: 2052 4f4c 4c42 4143 4b0a 2020 2020 2020   ROLLBACK.      
+00008420: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+00008430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008440: 2020 2077 6974 6820 7472 616e 7361 6374     with transact
+00008450: 696f 6e28 6474 293a 0a20 2020 2020 2020  ion(dt):.       
+00008460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008470: 2063 312e 6578 6563 7574 6528 2769 6e73   c1.execute('ins
+00008480: 6572 7420 696e 746f 2074 2028 706b 2920  ert into t (pk) 
+00008490: 7661 6c75 6573 2028 3229 2729 0a20 2020  values (2)').   
 000084a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000084b0: 2020 2020 7061 7373 0a0a 2020 2020 2020      pass..      
-000084c0: 2020 2020 2020 2020 2020 6331 2e65 7865            c1.exe
-000084d0: 6375 7465 2871 290a 2020 2020 2020 2020  cute(q).        
-000084e0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-000084f0: 2063 312e 6665 7463 6861 6c6c 2829 0a20   c1.fetchall(). 
-00008500: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00008510: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
-00008520: 7561 6c28 7265 7375 6c74 2c20 5b28 312c  ual(result, [(1,
-00008530: 204e 6f6e 6529 5d29 0a20 2020 2020 2020   None)]).       
-00008540: 2020 2020 2020 2020 2063 322e 6578 6563           c2.exec
-00008550: 7574 6528 7129 0a20 2020 2020 2020 2020  ute(q).         
-00008560: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00008570: 6332 2e66 6574 6368 616c 6c28 290a 2020  c2.fetchall().  
-00008580: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00008590: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-000085a0: 616c 2872 6573 756c 742c 205b 2831 2c20  al(result, [(1, 
-000085b0: 4e6f 6e65 295d 290a 2020 2020 6465 6620  None)]).    def 
-000085c0: 7465 7374 5f73 696d 706c 655f 6474 2873  test_simple_dt(s
-000085d0: 656c 6629 3a0a 2020 2020 2020 2020 7769  elf):.        wi
-000085e0: 7468 2044 6973 7472 6962 7574 6564 5472  th DistributedTr
-000085f0: 616e 7361 6374 696f 6e4d 616e 6167 6572  ansactionManager
-00008600: 2828 7365 6c66 2e63 6f6e 312c 2073 656c  ((self.con1, sel
-00008610: 662e 636f 6e32 2929 2061 7320 6474 3a0a  f.con2)) as dt:.
-00008620: 2020 2020 2020 2020 2020 2020 7120 3d20              q = 
-00008630: 2773 656c 6563 7420 2a20 6672 6f6d 2054  'select * from T
-00008640: 206f 7264 6572 2062 7920 706b 270a 2020   order by pk'.  
-00008650: 2020 2020 2020 2020 2020 7769 7468 2064            with d
-00008660: 742e 6375 7273 6f72 2873 656c 662e 636f  t.cursor(self.co
-00008670: 6e31 2920 6173 2063 312c 2073 656c 662e  n1) as c1, self.
-00008680: 636f 6e31 2e63 7572 736f 7228 2920 6173  con1.cursor() as
-00008690: 2063 6331 2c20 5c0a 2020 2020 2020 2020   cc1, \.        
-000086a0: 2020 2020 2020 2020 2064 742e 6375 7273           dt.curs
-000086b0: 6f72 2873 656c 662e 636f 6e32 2920 6173  or(self.con2) as
-000086c0: 2063 322c 2073 656c 662e 636f 6e32 2e63   c2, self.con2.c
-000086d0: 7572 736f 7228 2920 6173 2063 6332 3a0a  ursor() as cc2:.
-000086e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000086f0: 2320 4469 7374 7269 6275 7465 6420 7472  # Distributed tr
-00008700: 616e 7361 6374 696f 6e3a 2043 4f4d 4d49  ansaction: COMMI
-00008710: 540a 2020 2020 2020 2020 2020 2020 2020  T.              
-00008720: 2020 6331 2e65 7865 6375 7465 2827 696e    c1.execute('in
-00008730: 7365 7274 2069 6e74 6f20 7420 2870 6b29  sert into t (pk)
-00008740: 2076 616c 7565 7320 2831 2927 290a 2020   values (1)').  
-00008750: 2020 2020 2020 2020 2020 2020 2020 6332                c2
-00008760: 2e65 7865 6375 7465 2827 696e 7365 7274  .execute('insert
-00008770: 2069 6e74 6f20 7420 2870 6b29 2076 616c   into t (pk) val
-00008780: 7565 7320 2831 2927 290a 2020 2020 2020  ues (1)').      
-00008790: 2020 2020 2020 2020 2020 6474 2e63 6f6d            dt.com
-000087a0: 6d69 7428 290a 0a20 2020 2020 2020 2020  mit()..         
-000087b0: 2020 2020 2020 2077 6974 6820 7472 616e         with tran
-000087c0: 7361 6374 696f 6e28 7365 6c66 2e63 6f6e  saction(self.con
-000087d0: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
-000087e0: 2020 2020 2020 2020 6363 312e 6578 6563          cc1.exec
-000087f0: 7574 6528 7129 0a20 2020 2020 2020 2020  ute(q).         
-00008800: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00008810: 7420 3d20 6363 312e 6665 7463 6861 6c6c  t = cc1.fetchall
-00008820: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00008830: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
-00008840: 7374 4571 7561 6c28 7265 7375 6c74 2c20  stEqual(result, 
-00008850: 5b28 312c 204e 6f6e 6529 5d29 0a20 2020  [(1, None)]).   
-00008860: 2020 2020 2020 2020 2020 2020 2077 6974               wit
-00008870: 6820 7472 616e 7361 6374 696f 6e28 7365  h transaction(se
-00008880: 6c66 2e63 6f6e 3229 3a0a 2020 2020 2020  lf.con2):.      
-00008890: 2020 2020 2020 2020 2020 2020 2020 6363                cc
-000088a0: 322e 6578 6563 7574 6528 7129 0a20 2020  2.execute(q).   
+000084b0: 2020 2020 2063 322e 6578 6563 7574 6528       c2.execute(
+000084c0: 2769 6e73 6572 7420 696e 746f 2074 2028  'insert into t (
+000084d0: 706b 2920 7661 6c75 6573 2028 3229 2729  pk) values (2)')
+000084e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000084f0: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
+00008500: 7863 6570 7469 6f6e 2829 0a20 2020 2020  xception().     
+00008510: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00008520: 7420 4578 6365 7074 696f 6e3a 0a20 2020  t Exception:.   
+00008530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008540: 2070 6173 730a 0a20 2020 2020 2020 2020   pass..         
+00008550: 2020 2020 2020 2063 312e 6578 6563 7574         c1.execut
+00008560: 6528 7129 0a20 2020 2020 2020 2020 2020  e(q).           
+00008570: 2020 2020 2072 6573 756c 7420 3d20 6331       result = c1
+00008580: 2e66 6574 6368 616c 6c28 290a 2020 2020  .fetchall().    
+00008590: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000085a0: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
+000085b0: 2872 6573 756c 742c 205b 2831 2c20 4e6f  (result, [(1, No
+000085c0: 6e65 295d 290a 2020 2020 2020 2020 2020  ne)]).          
+000085d0: 2020 2020 2020 6332 2e65 7865 6375 7465        c2.execute
+000085e0: 2871 290a 2020 2020 2020 2020 2020 2020  (q).            
+000085f0: 2020 2020 7265 7375 6c74 203d 2063 322e      result = c2.
+00008600: 6665 7463 6861 6c6c 2829 0a20 2020 2020  fetchall().     
+00008610: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00008620: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
+00008630: 7265 7375 6c74 2c20 5b28 312c 204e 6f6e  result, [(1, Non
+00008640: 6529 5d29 0a20 2020 2064 6566 2074 6573  e)]).    def tes
+00008650: 745f 7369 6d70 6c65 5f64 7428 7365 6c66  t_simple_dt(self
+00008660: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
+00008670: 4469 7374 7269 6275 7465 6454 7261 6e73  DistributedTrans
+00008680: 6163 7469 6f6e 4d61 6e61 6765 7228 2873  actionManager((s
+00008690: 656c 662e 636f 6e31 2c20 7365 6c66 2e63  elf.con1, self.c
+000086a0: 6f6e 3229 2920 6173 2064 743a 0a20 2020  on2)) as dt:.   
+000086b0: 2020 2020 2020 2020 2071 203d 2027 7365           q = 'se
+000086c0: 6c65 6374 202a 2066 726f 6d20 5420 6f72  lect * from T or
+000086d0: 6465 7220 6279 2070 6b27 0a20 2020 2020  der by pk'.     
+000086e0: 2020 2020 2020 2077 6974 6820 6474 2e63         with dt.c
+000086f0: 7572 736f 7228 7365 6c66 2e63 6f6e 3129  ursor(self.con1)
+00008700: 2061 7320 6331 2c20 7365 6c66 2e63 6f6e   as c1, self.con
+00008710: 312e 6375 7273 6f72 2829 2061 7320 6363  1.cursor() as cc
+00008720: 312c 205c 0a20 2020 2020 2020 2020 2020  1, \.           
+00008730: 2020 2020 2020 6474 2e63 7572 736f 7228        dt.cursor(
+00008740: 7365 6c66 2e63 6f6e 3229 2061 7320 6332  self.con2) as c2
+00008750: 2c20 7365 6c66 2e63 6f6e 322e 6375 7273  , self.con2.curs
+00008760: 6f72 2829 2061 7320 6363 323a 0a20 2020  or() as cc2:.   
+00008770: 2020 2020 2020 2020 2020 2020 2023 2044               # D
+00008780: 6973 7472 6962 7574 6564 2074 7261 6e73  istributed trans
+00008790: 6163 7469 6f6e 3a20 434f 4d4d 4954 0a20  action: COMMIT. 
+000087a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000087b0: 312e 6578 6563 7574 6528 2769 6e73 6572  1.execute('inser
+000087c0: 7420 696e 746f 2074 2028 706b 2920 7661  t into t (pk) va
+000087d0: 6c75 6573 2028 3129 2729 0a20 2020 2020  lues (1)').     
+000087e0: 2020 2020 2020 2020 2020 2063 322e 6578             c2.ex
+000087f0: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
+00008800: 746f 2074 2028 706b 2920 7661 6c75 6573  to t (pk) values
+00008810: 2028 3129 2729 0a20 2020 2020 2020 2020   (1)').         
+00008820: 2020 2020 2020 2064 742e 636f 6d6d 6974         dt.commit
+00008830: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+00008840: 2020 2020 7769 7468 2074 7261 6e73 6163      with transac
+00008850: 7469 6f6e 2873 656c 662e 636f 6e31 293a  tion(self.con1):
+00008860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008870: 2020 2020 2063 6331 2e65 7865 6375 7465       cc1.execute
+00008880: 2871 290a 2020 2020 2020 2020 2020 2020  (q).            
+00008890: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+000088a0: 2063 6331 2e66 6574 6368 616c 6c28 290a   cc1.fetchall().
 000088b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088c0: 2072 6573 756c 7420 3d20 6363 322e 6665   result = cc2.fe
-000088d0: 7463 6861 6c6c 2829 0a20 2020 2020 2020  tchall().       
-000088e0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-000088f0: 7365 7274 4c69 7374 4571 7561 6c28 7265  sertListEqual(re
-00008900: 7375 6c74 2c20 5b28 312c 204e 6f6e 6529  sult, [(1, None)
-00008910: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-00008920: 2020 2020 2320 4469 7374 7269 6275 7465      # Distribute
-00008930: 6420 7472 616e 7361 6374 696f 6e3a 2050  d transaction: P
-00008940: 5245 5041 5245 2b43 4f4d 4d49 540a 2020  REPARE+COMMIT.  
-00008950: 2020 2020 2020 2020 2020 2020 2020 6331                c1
-00008960: 2e65 7865 6375 7465 2827 696e 7365 7274  .execute('insert
-00008970: 2069 6e74 6f20 7420 2870 6b29 2076 616c   into t (pk) val
-00008980: 7565 7320 2832 2927 290a 2020 2020 2020  ues (2)').      
-00008990: 2020 2020 2020 2020 2020 6332 2e65 7865            c2.exe
-000089a0: 6375 7465 2827 696e 7365 7274 2069 6e74  cute('insert int
-000089b0: 6f20 7420 2870 6b29 2076 616c 7565 7320  o t (pk) values 
-000089c0: 2832 2927 290a 2020 2020 2020 2020 2020  (2)').          
-000089d0: 2020 2020 2020 6474 2e70 7265 7061 7265        dt.prepare
-000089e0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-000089f0: 2020 2064 742e 636f 6d6d 6974 2829 0a0a     dt.commit()..
-00008a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a10: 7769 7468 2074 7261 6e73 6163 7469 6f6e  with transaction
-00008a20: 2873 656c 662e 636f 6e31 293a 0a20 2020  (self.con1):.   
-00008a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a40: 2063 6331 2e65 7865 6375 7465 2871 290a   cc1.execute(q).
-00008a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a60: 2020 2020 7265 7375 6c74 203d 2063 6331      result = cc1
-00008a70: 2e66 6574 6368 616c 6c28 290a 2020 2020  .fetchall().    
-00008a80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00008a90: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
-00008aa0: 2872 6573 756c 742c 205b 2831 2c20 4e6f  (result, [(1, No
-00008ab0: 6e65 292c 2028 322c 204e 6f6e 6529 5d29  ne), (2, None)])
-00008ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008ad0: 2077 6974 6820 7472 616e 7361 6374 696f   with transactio
-00008ae0: 6e28 7365 6c66 2e63 6f6e 3229 3a0a 2020  n(self.con2):.  
-00008af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b00: 2020 6363 322e 6578 6563 7574 6528 7129    cc2.execute(q)
-00008b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008b20: 2020 2020 2072 6573 756c 7420 3d20 6363       result = cc
-00008b30: 322e 6665 7463 6861 6c6c 2829 0a20 2020  2.fetchall().   
-00008b40: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00008b50: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-00008b60: 6c28 7265 7375 6c74 2c20 5b28 312c 204e  l(result, [(1, N
-00008b70: 6f6e 6529 2c20 2832 2c20 4e6f 6e65 295d  one), (2, None)]
-00008b80: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008b90: 2020 2023 2044 6973 7472 6962 7574 6564     # Distributed
-00008ba0: 2074 7261 6e73 6163 7469 6f6e 3a20 5341   transaction: SA
-00008bb0: 5645 504f 494e 542b 524f 4c4c 4241 434b  VEPOINT+ROLLBACK
-00008bc0: 2074 6f20 6974 0a20 2020 2020 2020 2020   to it.         
-00008bd0: 2020 2020 2020 2063 312e 6578 6563 7574         c1.execut
-00008be0: 6528 2769 6e73 6572 7420 696e 746f 2074  e('insert into t
-00008bf0: 2028 706b 2920 7661 6c75 6573 2028 3329   (pk) values (3)
-00008c00: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-00008c10: 2020 2064 742e 7361 7665 706f 696e 7428     dt.savepoint(
-00008c20: 2743 475f 5341 5645 504f 494e 5427 290a  'CG_SAVEPOINT').
-00008c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c40: 6332 2e65 7865 6375 7465 2827 696e 7365  c2.execute('inse
-00008c50: 7274 2069 6e74 6f20 7420 2870 6b29 2076  rt into t (pk) v
-00008c60: 616c 7565 7320 2833 2927 290a 2020 2020  alues (3)').    
-00008c70: 2020 2020 2020 2020 2020 2020 6474 2e72              dt.r
-00008c80: 6f6c 6c62 6163 6b28 7361 7665 706f 696e  ollback(savepoin
-00008c90: 743d 2743 475f 5341 5645 504f 494e 5427  t='CG_SAVEPOINT'
-00008ca0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008cb0: 2020 2063 312e 6578 6563 7574 6528 7129     c1.execute(q)
-00008cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008cd0: 2072 6573 756c 7420 3d20 6331 2e66 6574   result = c1.fet
-00008ce0: 6368 616c 6c28 290a 2020 2020 2020 2020  chall().        
-00008cf0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00008d00: 6572 744c 6973 7445 7175 616c 2872 6573  ertListEqual(res
-00008d10: 756c 742c 205b 2831 2c20 4e6f 6e65 292c  ult, [(1, None),
-00008d20: 2028 322c 204e 6f6e 6529 2c20 2833 2c20   (2, None), (3, 
-00008d30: 4e6f 6e65 295d 290a 2020 2020 2020 2020  None)]).        
-00008d40: 2020 2020 2020 2020 6332 2e65 7865 6375          c2.execu
-00008d50: 7465 2871 290a 2020 2020 2020 2020 2020  te(q).          
-00008d60: 2020 2020 2020 7265 7375 6c74 203d 2063        result = c
-00008d70: 322e 6665 7463 6861 6c6c 2829 0a20 2020  2.fetchall().   
-00008d80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00008d90: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-00008da0: 6c28 7265 7375 6c74 2c20 5b28 312c 204e  l(result, [(1, N
-00008db0: 6f6e 6529 2c20 2832 2c20 4e6f 6e65 295d  one), (2, None)]
-00008dc0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008dd0: 2020 2023 2044 6973 7472 6962 7574 6564     # Distributed
-00008de0: 2074 7261 6e73 6163 7469 6f6e 3a20 524f   transaction: RO
-00008df0: 4c4c 4241 434b 0a20 2020 2020 2020 2020  LLBACK.         
-00008e00: 2020 2020 2020 2064 742e 726f 6c6c 6261         dt.rollba
-00008e10: 636b 2829 0a0a 2020 2020 2020 2020 2020  ck()..          
-00008e20: 2020 2020 2020 7769 7468 2074 7261 6e73        with trans
-00008e30: 6163 7469 6f6e 2873 656c 662e 636f 6e31  action(self.con1
-00008e40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00008e50: 2020 2020 2020 2063 6331 2e65 7865 6375         cc1.execu
-00008e60: 7465 2871 290a 2020 2020 2020 2020 2020  te(q).          
-00008e70: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00008e80: 203d 2063 6331 2e66 6574 6368 616c 6c28   = cc1.fetchall(
-00008e90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00008ea0: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
-00008eb0: 7445 7175 616c 2872 6573 756c 742c 205b  tEqual(result, [
-00008ec0: 2831 2c20 4e6f 6e65 292c 2028 322c 204e  (1, None), (2, N
-00008ed0: 6f6e 6529 5d29 0a20 2020 2020 2020 2020  one)]).         
-00008ee0: 2020 2020 2020 2077 6974 6820 7472 616e         with tran
-00008ef0: 7361 6374 696f 6e28 7365 6c66 2e63 6f6e  saction(self.con
-00008f00: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
-00008f10: 2020 2020 2020 2020 6363 322e 6578 6563          cc2.exec
-00008f20: 7574 6528 7129 0a20 2020 2020 2020 2020  ute(q).         
-00008f30: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00008f40: 7420 3d20 6363 322e 6665 7463 6861 6c6c  t = cc2.fetchall
-00008f50: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00008f60: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
-00008f70: 7374 4571 7561 6c28 7265 7375 6c74 2c20  stEqual(result, 
-00008f80: 5b28 312c 204e 6f6e 6529 2c20 2832 2c20  [(1, None), (2, 
-00008f90: 4e6f 6e65 295d 290a 0a20 2020 2020 2020  None)])..       
-00008fa0: 2020 2020 2020 2020 2023 2044 6973 7472           # Distr
-00008fb0: 6962 7574 6564 2074 7261 6e73 6163 7469  ibuted transacti
-00008fc0: 6f6e 3a20 4558 4543 5554 455f 494d 4d45  on: EXECUTE_IMME
-00008fd0: 4449 4154 450a 2020 2020 2020 2020 2020  DIATE.          
-00008fe0: 2020 2020 2020 6474 2e65 7865 6375 7465        dt.execute
-00008ff0: 5f69 6d6d 6564 6961 7465 2827 696e 7365  _immediate('inse
-00009000: 7274 2069 6e74 6f20 7420 2870 6b29 2076  rt into t (pk) v
-00009010: 616c 7565 7320 2833 2927 290a 2020 2020  alues (3)').    
-00009020: 2020 2020 2020 2020 2020 2020 6474 2e63              dt.c
-00009030: 6f6d 6d69 7428 290a 0a20 2020 2020 2020  ommit()..       
-00009040: 2020 2020 2020 2020 2077 6974 6820 7472           with tr
-00009050: 616e 7361 6374 696f 6e28 7365 6c66 2e63  ansaction(self.c
-00009060: 6f6e 3129 3a0a 2020 2020 2020 2020 2020  on1):.          
-00009070: 2020 2020 2020 2020 2020 6363 312e 6578            cc1.ex
-00009080: 6563 7574 6528 7129 0a20 2020 2020 2020  ecute(q).       
-00009090: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000090a0: 756c 7420 3d20 6363 312e 6665 7463 6861  ult = cc1.fetcha
-000090b0: 6c6c 2829 0a20 2020 2020 2020 2020 2020  ll().           
-000090c0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000090d0: 4c69 7374 4571 7561 6c28 7265 7375 6c74  ListEqual(result
-000090e0: 2c20 5b28 312c 204e 6f6e 6529 2c20 2832  , [(1, None), (2
-000090f0: 2c20 4e6f 6e65 292c 2028 332c 204e 6f6e  , None), (3, Non
-00009100: 6529 5d29 0a20 2020 2020 2020 2020 2020  e)]).           
-00009110: 2020 2020 2077 6974 6820 7472 616e 7361       with transa
-00009120: 6374 696f 6e28 7365 6c66 2e63 6f6e 3229  ction(self.con2)
-00009130: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00009140: 2020 2020 2020 6363 322e 6578 6563 7574        cc2.execut
-00009150: 6528 7129 0a20 2020 2020 2020 2020 2020  e(q).           
-00009160: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00009170: 3d20 6363 322e 6665 7463 6861 6c6c 2829  = cc2.fetchall()
-00009180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009190: 2073 656c 662e 6173 7365 7274 4c69 7374   self.assertList
-000091a0: 4571 7561 6c28 7265 7375 6c74 2c20 5b28  Equal(result, [(
-000091b0: 312c 204e 6f6e 6529 2c20 2832 2c20 4e6f  1, None), (2, No
-000091c0: 6e65 292c 2028 332c 204e 6f6e 6529 5d29  ne), (3, None)])
-000091d0: 0a20 2020 2064 6566 2074 6573 745f 6c69  .    def test_li
-000091e0: 6d62 6f5f 7472 616e 7361 6374 696f 6e73  mbo_transactions
-000091f0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00009200: 7365 6c66 2e73 6b69 7054 6573 7428 274e  self.skipTest('N
-00009210: 6f74 2069 6d70 6c65 6d65 6e74 6564 2079  ot implemented y
-00009220: 6574 2729 0a20 2020 2020 2020 2023 7265  et').        #re
-00009230: 7475 726e 0a20 2020 2020 2020 2023 7769  turn.        #wi
-00009240: 7468 2063 6f6e 6e65 6374 5f73 6572 7665  th connect_serve
-00009250: 7228 2746 4254 4553 545f 484f 5354 2729  r('FBTEST_HOST')
-00009260: 2061 7320 7376 633a 0a20 2020 2020 2020   as svc:.       
-00009270: 2020 2020 2023 6474 203d 2044 6973 7472       #dt = Distr
-00009280: 6962 7574 6564 5472 616e 7361 6374 696f  ibutedTransactio
-00009290: 6e4d 616e 6167 6572 285b 7365 6c66 2e63  nManager([self.c
-000092a0: 6f6e 312c 2073 656c 662e 636f 6e32 5d29  on1, self.con2])
-000092b0: 0a20 2020 2020 2020 2020 2020 2023 6964  .            #id
-000092c0: 7331 203d 2073 7663 2e64 6174 6162 6173  s1 = svc.databas
-000092d0: 652e 6765 745f 6c69 6d62 6f5f 7472 616e  e.get_limbo_tran
-000092e0: 7361 6374 696f 6e5f 6964 7328 6461 7461  saction_ids(data
-000092f0: 6261 7365 3d73 656c 662e 6462 3129 0a20  base=self.db1). 
-00009300: 2020 2020 2020 2020 2020 2023 7365 6c66             #self
-00009310: 2e61 7373 6572 7445 7175 616c 2869 6473  .assertEqual(ids
-00009320: 312c 205b 5d29 0a20 2020 2020 2020 2020  1, []).         
-00009330: 2020 2023 6964 7332 203d 2073 7663 2e64     #ids2 = svc.d
-00009340: 6174 6162 6173 652e 6765 745f 6c69 6d62  atabase.get_limb
-00009350: 6f5f 7472 616e 7361 6374 696f 6e5f 6964  o_transaction_id
-00009360: 7328 6461 7461 6261 7365 3d73 656c 662e  s(database=self.
-00009370: 6462 3229 0a20 2020 2020 2020 2020 2020  db2).           
-00009380: 2023 7365 6c66 2e61 7373 6572 7445 7175   #self.assertEqu
-00009390: 616c 2869 6473 322c 205b 5d29 0a20 2020  al(ids2, []).   
-000093a0: 2020 2020 2020 2020 2023 6474 2e65 7865           #dt.exe
-000093b0: 6375 7465 5f69 6d6d 6564 6961 7465 2827  cute_immediate('
-000093c0: 696e 7365 7274 2069 6e74 6f20 7420 2870  insert into t (p
-000093d0: 6b29 2076 616c 7565 7320 2833 2927 290a  k) values (3)').
-000093e0: 2020 2020 2020 2020 2020 2020 2364 742e              #dt.
-000093f0: 7072 6570 6172 6528 290a 2020 2020 2020  prepare().      
-00009400: 2020 2020 2020 2323 2046 6f72 6365 206f        ## Force o
-00009410: 7574 2062 6f74 6820 636f 6e6e 6563 7469  ut both connecti
-00009420: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
-00009430: 2364 742e 5f74 7261 2e72 656c 6561 7365  #dt._tra.release
-00009440: 2829 0a20 2020 2020 2020 2020 2020 2023  ().            #
-00009450: 6474 2e5f 7472 6120 3d20 4e6f 6e65 0a20  dt._tra = None. 
-00009460: 2020 2020 2020 2020 2020 2023 6474 2e63             #dt.c
-00009470: 6c6f 7365 2829 0a20 2020 2020 2020 2020  lose().         
-00009480: 2020 2023 7365 6c66 2e63 6f6e 312e 636c     #self.con1.cl
-00009490: 6f73 6528 290a 2020 2020 2020 2020 2020  ose().          
-000094a0: 2020 2373 656c 662e 636f 6e32 2e63 6c6f    #self.con2.clo
-000094b0: 7365 2829 0a20 2020 2020 2020 2020 2020  se().           
-000094c0: 2023 230a 2020 2020 2020 2020 2020 2020   ##.            
-000094d0: 2373 656c 662e 636f 6e31 203d 2063 6f6e  #self.con1 = con
-000094e0: 6e65 6374 2827 6474 732d 3127 290a 2020  nect('dts-1').  
-000094f0: 2020 2020 2020 2020 2020 2373 656c 662e            #self.
-00009500: 636f 6e32 203d 2063 6f6e 6e65 6374 2827  con2 = connect('
-00009510: 6474 732d 3227 290a 2020 2020 2020 2020  dts-2').        
-00009520: 2020 2020 2369 6473 3120 3d20 7376 632e      #ids1 = svc.
-00009530: 6461 7461 6261 7365 2e67 6574 5f6c 696d  database.get_lim
-00009540: 626f 5f74 7261 6e73 6163 7469 6f6e 5f69  bo_transaction_i
-00009550: 6473 2864 6174 6162 6173 653d 7365 6c66  ds(database=self
-00009560: 2e64 6231 290a 2020 2020 2020 2020 2020  .db1).          
-00009570: 2020 2369 6431 203d 2069 6473 315b 305d    #id1 = ids1[0]
-00009580: 0a20 2020 2020 2020 2020 2020 2023 6964  .            #id
-00009590: 7332 203d 2073 7663 2e64 6174 6162 6173  s2 = svc.databas
-000095a0: 652e 6765 745f 6c69 6d62 6f5f 7472 616e  e.get_limbo_tran
-000095b0: 7361 6374 696f 6e5f 6964 7328 6461 7461  saction_ids(data
-000095c0: 6261 7365 3d73 656c 662e 6462 3229 0a20  base=self.db2). 
-000095d0: 2020 2020 2020 2020 2020 2023 6964 3220             #id2 
-000095e0: 3d20 6964 7332 5b30 5d0a 2020 2020 2020  = ids2[0].      
-000095f0: 2020 2020 2020 2323 2044 6174 6120 7368        ## Data sh
-00009600: 6f75 6c64 2062 6520 626c 6f63 6b65 6420  ould be blocked 
-00009610: 6279 206c 696d 626f 2074 7261 6e73 6163  by limbo transac
-00009620: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00009630: 2023 6331 203d 2073 656c 662e 636f 6e31   #c1 = self.con1
-00009640: 2e63 7572 736f 7228 290a 2020 2020 2020  .cursor().      
-00009650: 2020 2020 2020 2363 312e 6578 6563 7574        #c1.execut
-00009660: 6528 2773 656c 6563 7420 2a20 6672 6f6d  e('select * from
-00009670: 2074 2729 0a20 2020 2020 2020 2020 2020   t').           
-00009680: 2023 7769 7468 2073 656c 662e 6173 7365   #with self.asse
-00009690: 7274 5261 6973 6573 2844 6174 6162 6173  rtRaises(Databas
-000096a0: 6545 7272 6f72 2920 6173 2063 6d3a 0a20  eError) as cm:. 
-000096b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000096c0: 726f 7720 3d20 6331 2e66 6574 6368 616c  row = c1.fetchal
-000096d0: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
-000096e0: 2373 656c 662e 6173 7365 7274 5475 706c  #self.assertTupl
-000096f0: 6545 7175 616c 2863 6d2e 6578 6365 7074  eEqual(cm.except
-00009700: 696f 6e2e 6172 6773 2c0a 2020 2020 2020  ion.args,.      
-00009710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009720: 2020 2020 2020 2020 2020 2020 2328 2743              #('C
-00009730: 7572 736f 722e 6665 7463 686f 6e65 3a5c  ursor.fetchone:\
-00009740: 6e2d 2053 514c 434f 4445 3a20 2d39 3131  n- SQLCODE: -911
-00009750: 5c6e 2d20 7265 636f 7264 2066 726f 6d20  \n- record from 
-00009760: 7472 616e 7361 6374 696f 6e20 2569 2069  transaction %i i
-00009770: 7320 7374 7563 6b20 696e 206c 696d 626f  s stuck in limbo
-00009780: 2720 2520 6964 312c 202d 3931 312c 2033  ' % id1, -911, 3
-00009790: 3335 3534 3434 3539 2929 0a20 2020 2020  35544459)).     
-000097a0: 2020 2020 2020 2023 6332 203d 2073 656c         #c2 = sel
-000097b0: 662e 636f 6e32 2e63 7572 736f 7228 290a  f.con2.cursor().
-000097c0: 2020 2020 2020 2020 2020 2020 2363 322e              #c2.
-000097d0: 6578 6563 7574 6528 2773 656c 6563 7420  execute('select 
-000097e0: 2a20 6672 6f6d 2074 2729 0a20 2020 2020  * from t').     
-000097f0: 2020 2020 2020 2023 7769 7468 2073 656c         #with sel
-00009800: 662e 6173 7365 7274 5261 6973 6573 2844  f.assertRaises(D
-00009810: 6174 6162 6173 6545 7272 6f72 2920 6173  atabaseError) as
-00009820: 2063 6d3a 0a20 2020 2020 2020 2020 2020   cm:.           
-00009830: 2020 2020 2023 726f 7720 3d20 6332 2e66       #row = c2.f
-00009840: 6574 6368 616c 6c28 290a 2020 2020 2020  etchall().      
-00009850: 2020 2020 2020 2373 656c 662e 6173 7365        #self.asse
-00009860: 7274 5475 706c 6545 7175 616c 2863 6d2e  rtTupleEqual(cm.
-00009870: 6578 6365 7074 696f 6e2e 6172 6773 2c0a  exception.args,.
-00009880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000098a0: 2020 2328 2743 7572 736f 722e 6665 7463    #('Cursor.fetc
-000098b0: 686f 6e65 3a5c 6e2d 2053 514c 434f 4445  hone:\n- SQLCODE
-000098c0: 3a20 2d39 3131 5c6e 2d20 7265 636f 7264  : -911\n- record
-000098d0: 2066 726f 6d20 7472 616e 7361 6374 696f   from transactio
-000098e0: 6e20 2569 2069 7320 7374 7563 6b20 696e  n %i is stuck in
-000098f0: 206c 696d 626f 2720 2520 6964 322c 202d   limbo' % id2, -
-00009900: 3931 312c 2033 3335 3534 3434 3539 2929  911, 335544459))
-00009910: 0a20 2020 2020 2020 2020 2020 2023 2320  .            ## 
-00009920: 7265 736f 6c76 6520 7669 6120 7365 7276  resolve via serv
-00009930: 6963 650a 2020 2020 2020 2020 2020 2020  ice.            
-00009940: 2373 7663 203d 2063 6f6e 6e65 6374 5f73  #svc = connect_s
-00009950: 6572 7665 7228 686f 7374 3d46 4254 4553  erver(host=FBTES
-00009960: 545f 484f 5354 2c20 7061 7373 776f 7264  T_HOST, password
-00009970: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
-00009980: 290a 2020 2020 2020 2020 2020 2020 2373  ).            #s
-00009990: 7663 2e64 6174 6162 6173 652e 636f 6d6d  vc.database.comm
-000099a0: 6974 5f6c 696d 626f 5f74 7261 6e73 6163  it_limbo_transac
-000099b0: 7469 6f6e 2864 6174 6162 6173 653d 7365  tion(database=se
-000099c0: 6c66 2e64 6231 2c20 7472 616e 7361 6374  lf.db1, transact
-000099d0: 696f 6e5f 6964 3d69 6431 290a 2020 2020  ion_id=id1).    
-000099e0: 2020 2020 2020 2020 2373 7663 2e64 6174          #svc.dat
-000099f0: 6162 6173 652e 726f 6c6c 6261 636b 5f6c  abase.rollback_l
-00009a00: 696d 626f 5f74 7261 6e73 6163 7469 6f6e  imbo_transaction
-00009a10: 2864 6174 6162 6173 653d 7365 6c66 2e64  (database=self.d
-00009a20: 6232 2c20 7472 616e 7361 6374 696f 6e5f  b2, transaction_
-00009a30: 6964 3d69 6432 290a 0a20 2020 2020 2020  id=id2)..       
-00009a40: 2020 2020 2023 2320 6368 6563 6b20 7468       ## check th
-00009a50: 6520 7265 736f 6c75 7469 6f6e 0a20 2020  e resolution.   
-00009a60: 2020 2020 2020 2020 2023 6331 203d 2073           #c1 = s
-00009a70: 656c 662e 636f 6e31 2e63 7572 736f 7228  elf.con1.cursor(
-00009a80: 290a 2020 2020 2020 2020 2020 2020 2363  ).            #c
-00009a90: 312e 6578 6563 7574 6528 2773 656c 6563  1.execute('selec
-00009aa0: 7420 2a20 6672 6f6d 2074 2729 0a20 2020  t * from t').   
-00009ab0: 2020 2020 2020 2020 2023 726f 7720 3d20           #row = 
-00009ac0: 6331 2e66 6574 6368 616c 6c28 290a 2020  c1.fetchall().  
-00009ad0: 2020 2020 2020 2020 2020 2373 656c 662e            #self.
-00009ae0: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
-00009af0: 726f 772c 205b 2833 2c20 4e6f 6e65 295d  row, [(3, None)]
-00009b00: 290a 2020 2020 2020 2020 2020 2020 2363  ).            #c
-00009b10: 3220 3d20 7365 6c66 2e63 6f6e 322e 6375  2 = self.con2.cu
-00009b20: 7273 6f72 2829 0a20 2020 2020 2020 2020  rsor().         
-00009b30: 2020 2023 6332 2e65 7865 6375 7465 2827     #c2.execute('
-00009b40: 7365 6c65 6374 202a 2066 726f 6d20 7427  select * from t'
-00009b50: 290a 2020 2020 2020 2020 2020 2020 2372  ).            #r
-00009b60: 6f77 203d 2063 322e 6665 7463 6861 6c6c  ow = c2.fetchall
-00009b70: 2829 0a20 2020 2020 2020 2020 2020 2023  ().            #
-00009b80: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
-00009b90: 7175 616c 2872 6f77 2c20 5b5d 290a 0a63  qual(row, [])..c
-00009ba0: 6c61 7373 2054 6573 7443 7572 736f 7228  lass TestCursor(
-00009bb0: 4472 6976 6572 5465 7374 4261 7365 293a  DriverTestBase):
-00009bc0: 0a20 2020 2064 6566 2073 6574 5570 2873  .    def setUp(s
-00009bd0: 656c 6629 3a0a 2020 2020 2020 2020 7375  elf):.        su
-00009be0: 7065 7228 292e 7365 7455 7028 290a 2020  per().setUp().  
-00009bf0: 2020 2020 2020 7365 6c66 2e64 6266 696c        self.dbfil
-00009c00: 6520 3d20 6f73 2e70 6174 682e 6a6f 696e  e = os.path.join
-00009c10: 2873 656c 662e 6462 7061 7468 2c20 7365  (self.dbpath, se
-00009c20: 6c66 2e46 4254 4553 545f 4442 290a 2020  lf.FBTEST_DB).  
-00009c30: 2020 2020 2020 7365 6c66 2e63 6f6e 203d        self.con =
-00009c40: 2063 6f6e 6e65 6374 2873 656c 662e 6462   connect(self.db
-00009c50: 6669 6c65 2c20 7573 6572 3d46 4254 4553  file, user=FBTES
-00009c60: 545f 5553 4552 2c20 7061 7373 776f 7264  T_USER, password
-00009c70: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
-00009c80: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
-00009c90: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
-00009ca0: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
-00009cb0: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
-00009cc0: 2020 2373 656c 662e 636f 6e2e 6578 6563    #self.con.exec
-00009cd0: 7574 655f 696d 6d65 6469 6174 6528 2272  ute_immediate("r
-00009ce0: 6563 7265 6174 6520 7461 626c 6520 7420  ecreate table t 
-00009cf0: 2863 3120 696e 7465 6765 7220 7072 696d  (c1 integer prim
-00009d00: 6172 7920 6b65 7929 2229 0a20 2020 2020  ary key)").     
-00009d10: 2020 2073 656c 662e 636f 6e2e 6578 6563     self.con.exec
-00009d20: 7574 655f 696d 6d65 6469 6174 6528 2264  ute_immediate("d
-00009d30: 656c 6574 6520 6672 6f6d 2074 2229 0a20  elete from t"). 
-00009d40: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
-00009d50: 636f 6d6d 6974 2829 0a20 2020 2064 6566  commit().    def
-00009d60: 2074 6561 7244 6f77 6e28 7365 6c66 293a   tearDown(self):
-00009d70: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-00009d80: 6e2e 636c 6f73 6528 290a 2020 2020 6465  n.close().    de
-00009d90: 6620 7465 7374 5f65 7865 6375 7465 2873  f test_execute(s
-00009da0: 656c 6629 3a0a 2020 2020 2020 2020 7769  elf):.        wi
-00009db0: 7468 2073 656c 662e 636f 6e2e 6375 7273  th self.con.curs
-00009dc0: 6f72 2829 2061 7320 6375 723a 0a20 2020  or() as cur:.   
-00009dd0: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-00009de0: 6375 7465 2827 7365 6c65 6374 202a 2066  cute('select * f
-00009df0: 726f 6d20 636f 756e 7472 7927 290a 2020  rom country').  
-00009e00: 2020 2020 2020 2020 2020 726f 7720 3d20            row = 
-00009e10: 6375 722e 6665 7463 686f 6e65 2829 0a20  cur.fetchone(). 
-00009e20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009e30: 6173 7365 7274 5475 706c 6545 7175 616c  assertTupleEqual
-00009e40: 2872 6f77 2c20 2827 5553 4127 2c20 2744  (row, ('USA', 'D
-00009e50: 6f6c 6c61 7227 2929 0a20 2020 2020 2020  ollar')).       
-00009e60: 2020 2020 2023 2061 6761 696e 2074 6865       # again the
-00009e70: 2073 616d 6520 5351 4c20 2873 686f 756c   same SQL (shoul
-00009e80: 6420 7573 6520 7468 6520 7361 6d65 2053  d use the same S
-00009e90: 7461 7465 6d65 6e74 290a 2020 2020 2020  tatement).      
-00009ea0: 2020 2020 2020 7374 6d74 203d 2063 7572        stmt = cur
-00009eb0: 2e5f 7374 6d74 0a20 2020 2020 2020 2020  ._stmt.         
-00009ec0: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
-00009ed0: 7365 6c65 6374 202a 2066 726f 6d20 636f  select * from co
-00009ee0: 756e 7472 7927 290a 2020 2020 2020 2020  untry').        
-00009ef0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-00009f00: 7328 7374 6d74 2c20 6375 722e 5f73 746d  s(stmt, cur._stm
-00009f10: 7429 0a20 2020 2020 2020 2020 2020 2072  t).            r
-00009f20: 6f77 203d 2063 7572 2e66 6574 6368 6f6e  ow = cur.fetchon
-00009f30: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00009f40: 7365 6c66 2e61 7373 6572 7454 7570 6c65  self.assertTuple
-00009f50: 4571 7561 6c28 726f 772c 2028 2755 5341  Equal(row, ('USA
-00009f60: 272c 2027 446f 6c6c 6172 2729 290a 2020  ', 'Dollar')).  
-00009f70: 2020 2020 2020 2020 2020 2320 7072 6570            # prep
-00009f80: 6172 6564 2073 7461 7465 6d65 6e74 0a20  ared statement. 
-00009f90: 2020 2020 2020 2020 2020 2070 7320 3d20             ps = 
-00009fa0: 6375 722e 7072 6570 6172 6528 2773 656c  cur.prepare('sel
-00009fb0: 6563 7420 2a20 6672 6f6d 2063 6f75 6e74  ect * from count
-00009fc0: 7279 2729 0a20 2020 2020 2020 2020 2020  ry').           
-00009fd0: 2063 7572 2e65 7865 6375 7465 2870 7329   cur.execute(ps)
-00009fe0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00009ff0: 662e 6173 7365 7274 4973 4e6f 7428 7374  f.assertIsNot(st
-0000a000: 6d74 2c20 6375 722e 5f73 746d 7429 0a20  mt, cur._stmt). 
-0000a010: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-0000a020: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
-0000a030: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a040: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
-0000a050: 6c28 726f 772c 2028 2755 5341 272c 2027  l(row, ('USA', '
-0000a060: 446f 6c6c 6172 2729 290a 2020 2020 6465  Dollar')).    de
-0000a070: 6620 7465 7374 5f65 7865 6375 7465 6d61  f test_executema
-0000a080: 6e79 2873 656c 6629 3a0a 2020 2020 2020  ny(self):.      
-0000a090: 2020 7769 7468 2073 656c 662e 636f 6e2e    with self.con.
-0000a0a0: 6375 7273 6f72 2829 2061 7320 6375 723a  cursor() as cur:
-0000a0b0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0000a0c0: 2e65 7865 6375 7465 6d61 6e79 2822 696e  .executemany("in
-0000a0d0: 7365 7274 2069 6e74 6f20 7420 7661 6c75  sert into t valu
-0000a0e0: 6573 283f 2922 2c20 5b28 312c 292c 2028  es(?)", [(1,), (
-0000a0f0: 322c 295d 290a 2020 2020 2020 2020 2020  2,)]).          
-0000a100: 2020 6375 722e 6578 6563 7574 656d 616e    cur.executeman
-0000a110: 7928 2269 6e73 6572 7420 696e 746f 2074  y("insert into t
-0000a120: 2076 616c 7565 7328 3f29 222c 205b 2833   values(?)", [(3
-0000a130: 2c29 5d29 0a20 2020 2020 2020 2020 2020  ,)]).           
-0000a140: 2063 7572 2e65 7865 6375 7465 6d61 6e79   cur.executemany
-0000a150: 2822 696e 7365 7274 2069 6e74 6f20 7420  ("insert into t 
-0000a160: 7661 6c75 6573 283f 2922 2c20 5b28 342c  values(?)", [(4,
-0000a170: 292c 2028 352c 292c 2028 362c 295d 290a  ), (5,), (6,)]).
-0000a180: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a190: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 2020  .con.commit().  
-0000a1a0: 2020 2020 2020 2020 2020 7020 3d20 6375            p = cu
-0000a1b0: 722e 7072 6570 6172 6528 2269 6e73 6572  r.prepare("inser
-0000a1c0: 7420 696e 746f 2074 2076 616c 7565 7328  t into t values(
-0000a1d0: 3f29 2229 0a20 2020 2020 2020 2020 2020  ?)").           
-0000a1e0: 2063 7572 2e65 7865 6375 7465 6d61 6e79   cur.executemany
-0000a1f0: 2870 2c20 5b28 372c 292c 2028 382c 295d  (p, [(7,), (8,)]
-0000a200: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-0000a210: 722e 6578 6563 7574 656d 616e 7928 702c  r.executemany(p,
-0000a220: 205b 2839 2c29 5d29 0a20 2020 2020 2020   [(9,)]).       
-0000a230: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0000a240: 6d61 6e79 2870 2c20 5b28 3130 2c29 2c20  many(p, [(10,), 
-0000a250: 2831 312c 292c 2028 3132 2c29 5d29 0a20  (11,), (12,)]). 
-0000a260: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a270: 636f 6e2e 636f 6d6d 6974 2829 0a20 2020  con.commit().   
-0000a280: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-0000a290: 6375 7465 2822 7365 6c65 6374 202a 2066  cute("select * f
-0000a2a0: 726f 6d20 5420 6f72 6465 7220 6279 2063  rom T order by c
-0000a2b0: 3122 290a 2020 2020 2020 2020 2020 2020  1").            
-0000a2c0: 726f 7773 203d 2063 7572 2e66 6574 6368  rows = cur.fetch
-0000a2d0: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
-0000a2e0: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
-0000a2f0: 7445 7175 616c 2872 6f77 732c 205b 2831  tEqual(rows, [(1
-0000a300: 2c29 2c20 2832 2c29 2c20 2833 2c29 2c20  ,), (2,), (3,), 
-0000a310: 2834 2c29 2c0a 2020 2020 2020 2020 2020  (4,),.          
-0000a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a330: 2020 2020 2020 2020 2020 2020 2020 2835                (5
-0000a340: 2c29 2c20 2836 2c29 2c20 2837 2c29 2c20  ,), (6,), (7,), 
-0000a350: 2838 2c29 2c0a 2020 2020 2020 2020 2020  (8,),.          
-0000a360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a370: 2020 2020 2020 2020 2020 2020 2020 2839                (9
-0000a380: 2c29 2c20 2831 302c 292c 2028 3131 2c29  ,), (10,), (11,)
-0000a390: 2c20 2831 322c 295d 290a 2020 2020 6465  , (12,)]).    de
-0000a3a0: 6620 7465 7374 5f69 7465 7261 7469 6f6e  f test_iteration
-0000a3b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000a3c0: 6461 7461 203d 205b 2827 5553 4127 2c20  data = [('USA', 
-0000a3d0: 2744 6f6c 6c61 7227 292c 2028 2745 6e67  'Dollar'), ('Eng
-0000a3e0: 6c61 6e64 272c 2027 506f 756e 6427 292c  land', 'Pound'),
-0000a3f0: 2028 2743 616e 6164 6127 2c20 2743 646e   ('Canada', 'Cdn
-0000a400: 446c 7227 292c 0a20 2020 2020 2020 2020  Dlr'),.         
-0000a410: 2020 2020 2020 2028 2753 7769 747a 6572         ('Switzer
-0000a420: 6c61 6e64 272c 2027 5346 7261 6e63 2729  land', 'SFranc')
-0000a430: 2c20 2827 4a61 7061 6e27 2c20 2759 656e  , ('Japan', 'Yen
-0000a440: 2729 2c20 2827 4974 616c 7927 2c20 2745  '), ('Italy', 'E
-0000a450: 7572 6f27 292c 0a20 2020 2020 2020 2020  uro'),.         
-0000a460: 2020 2020 2020 2028 2746 7261 6e63 6527         ('France'
-0000a470: 2c20 2745 7572 6f27 292c 2028 2747 6572  , 'Euro'), ('Ger
-0000a480: 6d61 6e79 272c 2027 4575 726f 2729 2c20  many', 'Euro'), 
-0000a490: 2827 4175 7374 7261 6c69 6127 2c20 2741  ('Australia', 'A
-0000a4a0: 446f 6c6c 6172 2729 2c0a 2020 2020 2020  Dollar'),.      
-0000a4b0: 2020 2020 2020 2020 2020 2827 486f 6e67            ('Hong
-0000a4c0: 204b 6f6e 6727 2c20 2748 4b44 6f6c 6c61   Kong', 'HKDolla
-0000a4d0: 7227 292c 2028 274e 6574 6865 726c 616e  r'), ('Netherlan
-0000a4e0: 6473 272c 2027 4575 726f 2729 2c20 2827  ds', 'Euro'), ('
-0000a4f0: 4265 6c67 6975 6d27 2c20 2745 7572 6f27  Belgium', 'Euro'
-0000a500: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000a510: 2020 2028 2741 7573 7472 6961 272c 2027     ('Austria', '
-0000a520: 4575 726f 2729 2c20 2827 4669 6a69 272c  Euro'), ('Fiji',
-0000a530: 2027 4644 6f6c 6c61 7227 292c 2028 2752   'FDollar'), ('R
-0000a540: 7573 7369 6127 2c20 2752 7562 6c65 2729  ussia', 'Ruble')
-0000a550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000a560: 2020 2827 526f 6d61 6e69 6127 2c20 2752    ('Romania', 'R
-0000a570: 4c65 7527 295d 0a20 2020 2020 2020 2077  Leu')].        w
-0000a580: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-0000a590: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-0000a5a0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-0000a5b0: 6563 7574 6528 2773 656c 6563 7420 2a20  ecute('select * 
-0000a5c0: 6672 6f6d 2063 6f75 6e74 7279 2729 0a20  from country'). 
-0000a5d0: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
-0000a5e0: 3d20 5b72 6f77 2066 6f72 2072 6f77 2069  = [row for row i
-0000a5f0: 6e20 6375 725d 0a20 2020 2020 2020 2020  n cur].         
-0000a600: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0000a610: 7561 6c28 6c65 6e28 726f 7773 292c 206c  ual(len(rows), l
-0000a620: 656e 2864 6174 6129 290a 2020 2020 2020  en(data)).      
-0000a630: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000a640: 744c 6973 7445 7175 616c 2872 6f77 732c  tListEqual(rows,
-0000a650: 2064 6174 6129 0a20 2020 2020 2020 2020   data).         
-0000a660: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
-0000a670: 7365 6c65 6374 202a 2066 726f 6d20 636f  select * from co
-0000a680: 756e 7472 7927 290a 2020 2020 2020 2020  untry').        
-0000a690: 2020 2020 726f 7773 203d 205b 5d0a 2020      rows = [].  
-0000a6a0: 2020 2020 2020 2020 2020 666f 7220 726f            for ro
-0000a6b0: 7720 696e 2063 7572 3a0a 2020 2020 2020  w in cur:.      
-0000a6c0: 2020 2020 2020 2020 2020 726f 7773 2e61            rows.a
-0000a6d0: 7070 656e 6428 726f 7729 0a20 2020 2020  ppend(row).     
-0000a6e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000a6f0: 7274 4571 7561 6c28 6c65 6e28 726f 7773  rtEqual(len(rows
-0000a700: 292c 206c 656e 2864 6174 6129 290a 2020  ), len(data)).  
-0000a710: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0000a720: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
-0000a730: 6f77 732c 2064 6174 6129 0a20 2020 2020  ows, data).     
-0000a740: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
-0000a750: 7465 2827 7365 6c65 6374 202a 2066 726f  te('select * fro
-0000a760: 6d20 636f 756e 7472 7927 290a 2020 2020  m country').    
-0000a770: 2020 2020 2020 2020 6920 3d20 300a 2020          i = 0.  
-0000a780: 2020 2020 2020 2020 2020 666f 7220 726f            for ro
-0000a790: 7720 696e 2063 7572 3a0a 2020 2020 2020  w in cur:.      
-0000a7a0: 2020 2020 2020 2020 2020 6920 2b3d 2031            i += 1
-0000a7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a7c0: 2073 656c 662e 6173 7365 7274 496e 2872   self.assertIn(r
-0000a7d0: 6f77 2c20 6461 7461 290a 2020 2020 2020  ow, data).      
-0000a7e0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000a7f0: 7445 7175 616c 2869 2c20 6c65 6e28 6461  tEqual(i, len(da
-0000a800: 7461 2929 0a20 2020 2064 6566 2074 6573  ta)).    def tes
-0000a810: 745f 6465 7363 7269 7074 696f 6e28 7365  t_description(se
-0000a820: 6c66 293a 0a20 2020 2020 2020 2077 6974  lf):.        wit
-0000a830: 6820 7365 6c66 2e63 6f6e 2e63 7572 736f  h self.con.curso
-0000a840: 7228 2920 6173 2063 7572 3a0a 2020 2020  r() as cur:.    
-0000a850: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-0000a860: 7574 6528 2773 656c 6563 7420 2a20 6672  ute('select * fr
-0000a870: 6f6d 2063 6f75 6e74 7279 2729 0a20 2020  om country').   
-0000a880: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000a890: 7365 7274 4571 7561 6c28 6c65 6e28 6375  sertEqual(len(cu
-0000a8a0: 722e 6465 7363 7269 7074 696f 6e29 2c20  r.description), 
-0000a8b0: 3229 0a20 2020 2020 2020 2020 2020 2073  2).            s
-0000a8c0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000a8d0: 7265 7072 2863 7572 2e64 6573 6372 6970  repr(cur.descrip
-0000a8e0: 7469 6f6e 292c 0a20 2020 2020 2020 2020  tion),.         
-0000a8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a900: 2020 2020 2228 2827 434f 554e 5452 5927      "(('COUNTRY'
-0000a910: 2c20 3c63 6c61 7373 2027 7374 7227 3e2c  , <class 'str'>,
-0000a920: 2031 352c 2031 352c 2030 2c20 302c 2046   15, 15, 0, 0, F
-0000a930: 616c 7365 292c 2022 205c 0a20 2020 2020  alse), " \.     
-0000a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a950: 2020 2020 2020 2020 2228 2743 5552 5245          "('CURRE
-0000a960: 4e43 5927 2c20 3c63 6c61 7373 2027 7374  NCY', <class 'st
-0000a970: 7227 3e2c 2031 302c 2031 302c 2030 2c20  r'>, 10, 10, 0, 
-0000a980: 302c 2046 616c 7365 2929 2229 0a20 2020  0, False))").   
-0000a990: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-0000a9a0: 6375 7465 2827 7365 6c65 6374 2063 6f75  cute('select cou
-0000a9b0: 6e74 7279 2061 7320 4354 2c20 6375 7272  ntry as CT, curr
-0000a9c0: 656e 6379 2061 7320 4355 5220 6672 6f6d  ency as CUR from
-0000a9d0: 2063 6f75 6e74 7279 2729 0a20 2020 2020   country').     
-0000a9e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000a9f0: 7274 4571 7561 6c28 6c65 6e28 6375 722e  rtEqual(len(cur.
-0000aa00: 6465 7363 7269 7074 696f 6e29 2c20 3229  description), 2)
-0000aa10: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0000aa20: 2e65 7865 6375 7465 2827 7365 6c65 6374  .execute('select
-0000aa30: 202a 2066 726f 6d20 6375 7374 6f6d 6572   * from customer
-0000aa40: 2729 0a20 2020 2020 2020 2020 2020 2073  ').            s
-0000aa50: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000aa60: 7265 7072 2863 7572 2e64 6573 6372 6970  repr(cur.descrip
-0000aa70: 7469 6f6e 292c 0a20 2020 2020 2020 2020  tion),.         
-0000aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa90: 2020 2020 2228 2827 4355 5354 5f4e 4f27      "(('CUST_NO'
-0000aaa0: 2c20 3c63 6c61 7373 2027 696e 7427 3e2c  , <class 'int'>,
-0000aab0: 2031 312c 2034 2c20 302c 2030 2c20 4661   11, 4, 0, 0, Fa
-0000aac0: 6c73 6529 2c20 2220 5c0a 2020 2020 2020  lse), " \.      
-0000aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aae0: 2020 2020 2020 2022 2827 4355 5354 4f4d         "('CUSTOM
-0000aaf0: 4552 272c 203c 636c 6173 7320 2773 7472  ER', <class 'str
-0000ab00: 273e 2c20 3235 2c20 3235 2c20 302c 2030  '>, 25, 25, 0, 0
-0000ab10: 2c20 4661 6c73 6529 2c20 2220 5c0a 2020  , False), " \.  
-0000ab20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab30: 2020 2020 2020 2020 2020 2022 2827 434f             "('CO
-0000ab40: 4e54 4143 545f 4649 5253 5427 2c20 3c63  NTACT_FIRST', <c
-0000ab50: 6c61 7373 2027 7374 7227 3e2c 2031 352c  lass 'str'>, 15,
-0000ab60: 2031 352c 2030 2c20 302c 2054 7275 6529   15, 0, 0, True)
-0000ab70: 2c20 2220 5c0a 2020 2020 2020 2020 2020  , " \.          
-0000ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab90: 2020 2022 2827 434f 4e54 4143 545f 4c41     "('CONTACT_LA
-0000aba0: 5354 272c 203c 636c 6173 7320 2773 7472  ST', <class 'str
-0000abb0: 273e 2c20 3230 2c20 3230 2c20 302c 2030  '>, 20, 20, 0, 0
-0000abc0: 2c20 5472 7565 292c 2022 205c 0a20 2020  , True), " \.   
-0000abd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000abe0: 2020 2020 2020 2020 2020 2228 2750 484f            "('PHO
-0000abf0: 4e45 5f4e 4f27 2c20 3c63 6c61 7373 2027  NE_NO', <class '
-0000ac00: 7374 7227 3e2c 2032 302c 2032 302c 2030  str'>, 20, 20, 0
-0000ac10: 2c20 302c 2054 7275 6529 2c20 2220 5c0a  , 0, True), " \.
-0000ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac30: 2020 2020 2020 2020 2020 2020 2022 2827               "('
-0000ac40: 4144 4452 4553 535f 4c49 4e45 3127 2c20  ADDRESS_LINE1', 
-0000ac50: 3c63 6c61 7373 2027 7374 7227 3e2c 2033  <class 'str'>, 3
-0000ac60: 302c 2033 302c 2030 2c20 302c 2054 7275  0, 30, 0, 0, Tru
-0000ac70: 6529 2c20 2220 5c0a 2020 2020 2020 2020  e), " \.        
-0000ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac90: 2020 2020 2022 2827 4144 4452 4553 535f       "('ADDRESS_
-0000aca0: 4c49 4e45 3227 2c20 3c63 6c61 7373 2027  LINE2', <class '
-0000acb0: 7374 7227 3e2c 2033 302c 2033 302c 2030  str'>, 30, 30, 0
-0000acc0: 2c20 302c 2054 7275 6529 2c20 2220 5c0a  , 0, True), " \.
-0000acd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ace0: 2020 2020 2020 2020 2020 2020 2022 2827               "('
-0000acf0: 4349 5459 272c 203c 636c 6173 7320 2773  CITY', <class 's
-0000ad00: 7472 273e 2c20 3235 2c20 3235 2c20 302c  tr'>, 25, 25, 0,
-0000ad10: 2030 2c20 5472 7565 292c 2022 205c 0a20   0, True), " \. 
-0000ad20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad30: 2020 2020 2020 2020 2020 2020 2228 2753              "('S
-0000ad40: 5441 5445 5f50 524f 5649 4e43 4527 2c20  TATE_PROVINCE', 
-0000ad50: 3c63 6c61 7373 2027 7374 7227 3e2c 2031  <class 'str'>, 1
-0000ad60: 352c 2031 352c 2030 2c20 302c 2054 7275  5, 15, 0, 0, Tru
-0000ad70: 6529 2c20 2220 5c0a 2020 2020 2020 2020  e), " \.        
-0000ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad90: 2020 2020 2022 2827 434f 554e 5452 5927       "('COUNTRY'
-0000ada0: 2c20 3c63 6c61 7373 2027 7374 7227 3e2c  , <class 'str'>,
-0000adb0: 2031 352c 2031 352c 2030 2c20 302c 2054   15, 15, 0, 0, T
-0000adc0: 7275 6529 2c20 2220 5c0a 2020 2020 2020  rue), " \.      
-0000add0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ade0: 2020 2020 2020 2022 2827 504f 5354 414c         "('POSTAL
-0000adf0: 5f43 4f44 4527 2c20 3c63 6c61 7373 2027  _CODE', <class '
-0000ae00: 7374 7227 3e2c 2031 322c 2031 322c 2030  str'>, 12, 12, 0
-0000ae10: 2c20 302c 2054 7275 6529 2c20 2220 5c0a  , 0, True), " \.
-0000ae20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae30: 2020 2020 2020 2020 2020 2020 2022 2827               "('
-0000ae40: 4f4e 5f48 4f4c 4427 2c20 3c63 6c61 7373  ON_HOLD', <class
-0000ae50: 2027 7374 7227 3e2c 2031 2c20 312c 2030   'str'>, 1, 1, 0
-0000ae60: 2c20 302c 2054 7275 6529 2922 290a 2020  , 0, True))").  
-0000ae70: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-0000ae80: 6563 7574 6528 2773 656c 6563 7420 2a20  ecute('select * 
-0000ae90: 6672 6f6d 206a 6f62 2729 0a20 2020 2020  from job').     
-0000aea0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000aeb0: 7274 4571 7561 6c28 7265 7072 2863 7572  rtEqual(repr(cur
-0000aec0: 2e64 6573 6372 6970 7469 6f6e 292c 0a20  .description),. 
-0000aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aee0: 2020 2020 2020 2020 2020 2020 2228 2827              "(('
-0000aef0: 4a4f 425f 434f 4445 272c 203c 636c 6173  JOB_CODE', <clas
-0000af00: 7320 2773 7472 273e 2c20 352c 2035 2c20  s 'str'>, 5, 5, 
-0000af10: 302c 2030 2c20 4661 6c73 6529 2c20 2220  0, 0, False), " 
-0000af20: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0000af30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000af40: 2827 4a4f 425f 4752 4144 4527 2c20 3c63  ('JOB_GRADE', <c
-0000af50: 6c61 7373 2027 696e 7427 3e2c 2036 2c20  lass 'int'>, 6, 
-0000af60: 322c 2030 2c20 302c 2046 616c 7365 292c  2, 0, 0, False),
-0000af70: 2022 205c 0a20 2020 2020 2020 2020 2020   " \.           
-0000af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af90: 2020 2228 274a 4f42 5f43 4f55 4e54 5259    "('JOB_COUNTRY
-0000afa0: 272c 203c 636c 6173 7320 2773 7472 273e  ', <class 'str'>
-0000afb0: 2c20 3135 2c20 3135 2c20 302c 2030 2c20  , 15, 15, 0, 0, 
-0000afc0: 4661 6c73 6529 2c20 2220 5c0a 2020 2020  False), " \.    
-0000afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000afe0: 2020 2020 2020 2020 2022 2827 4a4f 425f           "('JOB_
-0000aff0: 5449 544c 4527 2c20 3c63 6c61 7373 2027  TITLE', <class '
-0000b000: 7374 7227 3e2c 2032 352c 2032 352c 2030  str'>, 25, 25, 0
-0000b010: 2c20 302c 2046 616c 7365 292c 2022 205c  , 0, False), " \
-0000b020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b030: 2020 2020 2020 2020 2020 2020 2020 2228                "(
-0000b040: 274d 494e 5f53 414c 4152 5927 2c20 3c63  'MIN_SALARY', <c
-0000b050: 6c61 7373 2027 6465 6369 6d61 6c2e 4465  lass 'decimal.De
-0000b060: 6369 6d61 6c27 3e2c 2032 302c 2038 2c20  cimal'>, 20, 8, 
-0000b070: 3130 2c20 2d32 2c20 4661 6c73 6529 2c20  10, -2, False), 
-0000b080: 2220 5c0a 2020 2020 2020 2020 2020 2020  " \.            
-0000b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b0a0: 2022 2827 4d41 585f 5341 4c41 5259 272c   "('MAX_SALARY',
-0000b0b0: 203c 636c 6173 7320 2764 6563 696d 616c   <class 'decimal
-0000b0c0: 2e44 6563 696d 616c 273e 2c20 3230 2c20  .Decimal'>, 20, 
-0000b0d0: 382c 2031 302c 202d 322c 2046 616c 7365  8, 10, -2, False
-0000b0e0: 292c 2022 205c 0a20 2020 2020 2020 2020  ), " \.         
-0000b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b100: 2020 2020 2228 274a 4f42 5f52 4551 5549      "('JOB_REQUI
-0000b110: 5245 4d45 4e54 272c 203c 636c 6173 7320  REMENT', <class 
-0000b120: 2773 7472 273e 2c20 302c 2038 2c20 302c  'str'>, 0, 8, 0,
-0000b130: 2031 2c20 5472 7565 292c 2022 205c 0a20   1, True), " \. 
-0000b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b150: 2020 2020 2020 2020 2020 2020 2228 274c              "('L
-0000b160: 414e 4755 4147 455f 5245 5127 2c20 3c63  ANGUAGE_REQ', <c
-0000b170: 6c61 7373 2027 6c69 7374 273e 2c20 2d31  lass 'list'>, -1
-0000b180: 2c20 382c 2030 2c20 302c 2054 7275 6529  , 8, 0, 0, True)
-0000b190: 2922 290a 2020 2020 2020 2020 2020 2020  )").            
-0000b1a0: 6375 722e 6578 6563 7574 6528 2773 656c  cur.execute('sel
-0000b1b0: 6563 7420 2a20 6672 6f6d 2070 726f 6a5f  ect * from proj_
-0000b1c0: 6465 7074 5f62 7564 6765 7427 290a 2020  dept_budget').  
-0000b1d0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0000b1e0: 7373 6572 7445 7175 616c 2872 6570 7228  ssertEqual(repr(
-0000b1f0: 6375 722e 6465 7363 7269 7074 696f 6e29  cur.description)
-0000b200: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b210: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000b220: 2828 2746 4953 4341 4c5f 5945 4152 272c  (('FISCAL_YEAR',
-0000b230: 203c 636c 6173 7320 2769 6e74 273e 2c20   <class 'int'>, 
-0000b240: 3131 2c20 342c 2030 2c20 302c 2046 616c  11, 4, 0, 0, Fal
-0000b250: 7365 292c 2022 205c 0a20 2020 2020 2020  se), " \.       
-0000b260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b270: 2020 2020 2020 2228 2750 524f 4a5f 4944        "('PROJ_ID
-0000b280: 272c 203c 636c 6173 7320 2773 7472 273e  ', <class 'str'>
-0000b290: 2c20 352c 2035 2c20 302c 2030 2c20 4661  , 5, 5, 0, 0, Fa
-0000b2a0: 6c73 6529 2c20 2220 5c0a 2020 2020 2020  lse), " \.      
-0000b2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b2c0: 2020 2020 2020 2022 2827 4445 5054 5f4e         "('DEPT_N
-0000b2d0: 4f27 2c20 3c63 6c61 7373 2027 7374 7227  O', <class 'str'
-0000b2e0: 3e2c 2033 2c20 332c 2030 2c20 302c 2046  >, 3, 3, 0, 0, F
-0000b2f0: 616c 7365 292c 2022 205c 0a20 2020 2020  alse), " \.     
-0000b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b310: 2020 2020 2020 2020 2228 2751 5541 5254          "('QUART
-0000b320: 5f48 4541 445f 434e 5427 2c20 3c63 6c61  _HEAD_CNT', <cla
-0000b330: 7373 2027 6c69 7374 273e 2c20 2d31 2c20  ss 'list'>, -1, 
-0000b340: 382c 2030 2c20 302c 2054 7275 6529 2c20  8, 0, 0, True), 
-0000b350: 2220 5c0a 2020 2020 2020 2020 2020 2020  " \.            
-0000b360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b370: 2022 2827 5052 4f4a 4543 5445 445f 4255   "('PROJECTED_BU
-0000b380: 4447 4554 272c 203c 636c 6173 7320 2764  DGET', <class 'd
-0000b390: 6563 696d 616c 2e44 6563 696d 616c 273e  ecimal.Decimal'>
-0000b3a0: 2c20 3230 2c20 382c 2031 322c 202d 322c  , 20, 8, 12, -2,
-0000b3b0: 2054 7275 6529 2922 290a 2020 2020 2020   True))").      
-0000b3c0: 2020 2320 4368 6563 6b20 666f 7220 7072    # Check for pr
-0000b3d0: 6563 6973 696f 6e20 6361 6368 650a 2020  ecision cache.  
-0000b3e0: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
-0000b3f0: 636f 6e2e 6375 7273 6f72 2829 2061 7320  con.cursor() as 
-0000b400: 6375 7232 3a0a 2020 2020 2020 2020 2020  cur2:.          
-0000b410: 2020 6375 7232 2e65 7865 6375 7465 2827    cur2.execute('
-0000b420: 7365 6c65 6374 202a 2066 726f 6d20 7072  select * from pr
-0000b430: 6f6a 5f64 6570 745f 6275 6467 6574 2729  oj_dept_budget')
-0000b440: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000b450: 662e 6173 7365 7274 4571 7561 6c28 7265  f.assertEqual(re
-0000b460: 7072 2863 7572 322e 6465 7363 7269 7074  pr(cur2.descript
-0000b470: 696f 6e29 2c0a 2020 2020 2020 2020 2020  ion),.          
-0000b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b490: 2020 2022 2828 2746 4953 4341 4c5f 5945     "(('FISCAL_YE
-0000b4a0: 4152 272c 203c 636c 6173 7320 2769 6e74  AR', <class 'int
-0000b4b0: 273e 2c20 3131 2c20 342c 2030 2c20 302c  '>, 11, 4, 0, 0,
-0000b4c0: 2046 616c 7365 292c 2022 205c 0a20 2020   False), " \.   
-0000b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b4e0: 2020 2020 2020 2020 2020 2228 2750 524f            "('PRO
-0000b4f0: 4a5f 4944 272c 203c 636c 6173 7320 2773  J_ID', <class 's
-0000b500: 7472 273e 2c20 352c 2035 2c20 302c 2030  tr'>, 5, 5, 0, 0
-0000b510: 2c20 4661 6c73 6529 2c20 2220 5c0a 2020  , False), " \.  
-0000b520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b530: 2020 2020 2020 2020 2020 2022 2827 4445             "('DE
-0000b540: 5054 5f4e 4f27 2c20 3c63 6c61 7373 2027  PT_NO', <class '
-0000b550: 7374 7227 3e2c 2033 2c20 332c 2030 2c20  str'>, 3, 3, 0, 
-0000b560: 302c 2046 616c 7365 292c 2022 205c 0a20  0, False), " \. 
-0000b570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b580: 2020 2020 2020 2020 2020 2020 2228 2751              "('Q
-0000b590: 5541 5254 5f48 4541 445f 434e 5427 2c20  UART_HEAD_CNT', 
-0000b5a0: 3c63 6c61 7373 2027 6c69 7374 273e 2c20  <class 'list'>, 
-0000b5b0: 2d31 2c20 382c 2030 2c20 302c 2054 7275  -1, 8, 0, 0, Tru
-0000b5c0: 6529 2c20 2220 5c0a 2020 2020 2020 2020  e), " \.        
-0000b5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b5e0: 2020 2020 2022 2827 5052 4f4a 4543 5445       "('PROJECTE
-0000b5f0: 445f 4255 4447 4554 272c 203c 636c 6173  D_BUDGET', <clas
-0000b600: 7320 2764 6563 696d 616c 2e44 6563 696d  s 'decimal.Decim
-0000b610: 616c 273e 2c20 3230 2c20 382c 2031 322c  al'>, 20, 8, 12,
-0000b620: 202d 322c 2054 7275 6529 2922 290a 2020   -2, True))").  
-0000b630: 2020 6465 6620 7465 7374 5f65 7865 635f    def test_exec_
-0000b640: 6166 7465 725f 636c 6f73 6528 7365 6c66  after_close(self
-0000b650: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
-0000b660: 7365 6c66 2e63 6f6e 2e63 7572 736f 7228  self.con.cursor(
-0000b670: 2920 6173 2063 7572 3a0a 2020 2020 2020  ) as cur:.      
-0000b680: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
-0000b690: 6528 2773 656c 6563 7420 2a20 6672 6f6d  e('select * from
-0000b6a0: 2063 6f75 6e74 7279 2729 0a20 2020 2020   country').     
-0000b6b0: 2020 2020 2020 2072 6f77 203d 2063 7572         row = cur
-0000b6c0: 2e66 6574 6368 6f6e 6528 290a 2020 2020  .fetchone().    
-0000b6d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000b6e0: 6572 7454 7570 6c65 4571 7561 6c28 726f  ertTupleEqual(ro
-0000b6f0: 772c 2028 2755 5341 272c 2027 446f 6c6c  w, ('USA', 'Doll
-0000b700: 6172 2729 290a 2020 2020 2020 2020 2020  ar')).          
-0000b710: 2020 6375 722e 636c 6f73 6528 290a 2020    cur.close().  
-0000b720: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-0000b730: 6563 7574 6528 2773 656c 6563 7420 2a20  ecute('select * 
-0000b740: 6672 6f6d 2063 6f75 6e74 7279 2729 0a20  from country'). 
-0000b750: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-0000b760: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
-0000b770: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000b780: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
-0000b790: 6c28 726f 772c 2028 2755 5341 272c 2027  l(row, ('USA', '
-0000b7a0: 446f 6c6c 6172 2729 290a 2020 2020 6465  Dollar')).    de
-0000b7b0: 6620 7465 7374 5f66 6574 6368 6f6e 6528  f test_fetchone(
-0000b7c0: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
-0000b7d0: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-0000b7e0: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-0000b7f0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-0000b800: 6563 7574 6528 2773 656c 6563 7420 2a20  ecute('select * 
-0000b810: 6672 6f6d 2063 6f75 6e74 7279 2729 0a20  from country'). 
-0000b820: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-0000b830: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
-0000b840: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000b850: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
-0000b860: 6c28 726f 772c 2028 2755 5341 272c 2027  l(row, ('USA', '
-0000b870: 446f 6c6c 6172 2729 290a 2020 2020 6465  Dollar')).    de
-0000b880: 6620 7465 7374 5f66 6574 6368 616c 6c28  f test_fetchall(
-0000b890: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
-0000b8a0: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-0000b8b0: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-0000b8c0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-0000b8d0: 6563 7574 6528 2773 656c 6563 7420 2a20  ecute('select * 
-0000b8e0: 6672 6f6d 2063 6f75 6e74 7279 2729 0a20  from country'). 
-0000b8f0: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
-0000b900: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
-0000b910: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000b920: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-0000b930: 6c28 726f 7773 2c0a 2020 2020 2020 2020  l(rows,.        
-0000b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b950: 2020 2020 2020 2020 205b 2827 5553 4127           [('USA'
-0000b960: 2c20 2744 6f6c 6c61 7227 292c 2028 2745  , 'Dollar'), ('E
-0000b970: 6e67 6c61 6e64 272c 2027 506f 756e 6427  ngland', 'Pound'
-0000b980: 292c 2028 2743 616e 6164 6127 2c20 2743  ), ('Canada', 'C
-0000b990: 646e 446c 7227 292c 0a20 2020 2020 2020  dnDlr'),.       
-0000b9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b9b0: 2020 2020 2020 2020 2020 2028 2753 7769             ('Swi
-0000b9c0: 747a 6572 6c61 6e64 272c 2027 5346 7261  tzerland', 'SFra
-0000b9d0: 6e63 2729 2c20 2827 4a61 7061 6e27 2c20  nc'), ('Japan', 
-0000b9e0: 2759 656e 2729 2c20 2827 4974 616c 7927  'Yen'), ('Italy'
-0000b9f0: 2c20 2745 7572 6f27 292c 0a20 2020 2020  , 'Euro'),.     
-0000ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba10: 2020 2020 2020 2020 2020 2020 2028 2746               ('F
-0000ba20: 7261 6e63 6527 2c20 2745 7572 6f27 292c  rance', 'Euro'),
-0000ba30: 2028 2747 6572 6d61 6e79 272c 2027 4575   ('Germany', 'Eu
-0000ba40: 726f 2729 2c20 2827 4175 7374 7261 6c69  ro'), ('Australi
-0000ba50: 6127 2c20 2741 446f 6c6c 6172 2729 2c0a  a', 'ADollar'),.
-0000ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba80: 2020 2827 486f 6e67 204b 6f6e 6727 2c20    ('Hong Kong', 
-0000ba90: 2748 4b44 6f6c 6c61 7227 292c 2028 274e  'HKDollar'), ('N
-0000baa0: 6574 6865 726c 616e 6473 272c 2027 4575  etherlands', 'Eu
-0000bab0: 726f 2729 2c0a 2020 2020 2020 2020 2020  ro'),.          
-0000bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bad0: 2020 2020 2020 2020 2827 4265 6c67 6975          ('Belgiu
-0000bae0: 6d27 2c20 2745 7572 6f27 292c 2028 2741  m', 'Euro'), ('A
-0000baf0: 7573 7472 6961 272c 2027 4575 726f 2729  ustria', 'Euro')
-0000bb00: 2c20 2827 4669 6a69 272c 2027 4644 6f6c  , ('Fiji', 'FDol
-0000bb10: 6c61 7227 292c 0a20 2020 2020 2020 2020  lar'),.         
-0000bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb30: 2020 2020 2020 2020 2028 2752 7573 7369           ('Russi
-0000bb40: 6127 2c20 2752 7562 6c65 2729 2c20 2827  a', 'Ruble'), ('
-0000bb50: 526f 6d61 6e69 6127 2c20 2752 4c65 7527  Romania', 'RLeu'
-0000bb60: 295d 290a 2020 2020 6465 6620 7465 7374  )]).    def test
-0000bb70: 5f66 6574 6368 6d61 6e79 2873 656c 6629  _fetchmany(self)
-0000bb80: 3a0a 2020 2020 2020 2020 7769 7468 2073  :.        with s
-0000bb90: 656c 662e 636f 6e2e 6375 7273 6f72 2829  elf.con.cursor()
-0000bba0: 2061 7320 6375 723a 0a20 2020 2020 2020   as cur:.       
-0000bbb0: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0000bbc0: 2827 7365 6c65 6374 202a 2066 726f 6d20  ('select * from 
-0000bbd0: 636f 756e 7472 7927 290a 2020 2020 2020  country').      
-0000bbe0: 2020 2020 2020 726f 7773 203d 2063 7572        rows = cur
-0000bbf0: 2e66 6574 6368 6d61 6e79 2831 3029 0a20  .fetchmany(10). 
-0000bc00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000bc10: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
-0000bc20: 726f 7773 2c0a 2020 2020 2020 2020 2020  rows,.          
-0000bc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc40: 2020 2020 2020 205b 2827 5553 4127 2c20         [('USA', 
-0000bc50: 2744 6f6c 6c61 7227 292c 2028 2745 6e67  'Dollar'), ('Eng
-0000bc60: 6c61 6e64 272c 2027 506f 756e 6427 292c  land', 'Pound'),
-0000bc70: 2028 2743 616e 6164 6127 2c20 2743 646e   ('Canada', 'Cdn
-0000bc80: 446c 7227 292c 0a20 2020 2020 2020 2020  Dlr'),.         
-0000bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bca0: 2020 2020 2020 2020 2028 2753 7769 747a           ('Switz
-0000bcb0: 6572 6c61 6e64 272c 2027 5346 7261 6e63  erland', 'SFranc
-0000bcc0: 2729 2c20 2827 4a61 7061 6e27 2c20 2759  '), ('Japan', 'Y
-0000bcd0: 656e 2729 2c20 2827 4974 616c 7927 2c20  en'), ('Italy', 
-0000bce0: 2745 7572 6f27 292c 0a20 2020 2020 2020  'Euro'),.       
-0000bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd00: 2020 2020 2020 2020 2020 2028 2746 7261             ('Fra
-0000bd10: 6e63 6527 2c20 2745 7572 6f27 292c 2028  nce', 'Euro'), (
-0000bd20: 2747 6572 6d61 6e79 272c 2027 4575 726f  'Germany', 'Euro
-0000bd30: 2729 2c20 2827 4175 7374 7261 6c69 6127  '), ('Australia'
-0000bd40: 2c20 2741 446f 6c6c 6172 2729 2c0a 2020  , 'ADollar'),.  
-0000bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd70: 2827 486f 6e67 204b 6f6e 6727 2c20 2748  ('Hong Kong', 'H
-0000bd80: 4b44 6f6c 6c61 7227 295d 290a 2020 2020  KDollar')]).    
-0000bd90: 2020 2020 2020 2020 726f 7773 203d 2063          rows = c
-0000bda0: 7572 2e66 6574 6368 6d61 6e79 2831 3029  ur.fetchmany(10)
-0000bdb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000bdc0: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-0000bdd0: 6c28 726f 7773 2c0a 2020 2020 2020 2020  l(rows,.        
+000088c0: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
+000088d0: 7175 616c 2872 6573 756c 742c 205b 2831  qual(result, [(1
+000088e0: 2c20 4e6f 6e65 295d 290a 2020 2020 2020  , None)]).      
+000088f0: 2020 2020 2020 2020 2020 7769 7468 2074            with t
+00008900: 7261 6e73 6163 7469 6f6e 2873 656c 662e  ransaction(self.
+00008910: 636f 6e32 293a 0a20 2020 2020 2020 2020  con2):.         
+00008920: 2020 2020 2020 2020 2020 2063 6332 2e65             cc2.e
+00008930: 7865 6375 7465 2871 290a 2020 2020 2020  xecute(q).      
+00008940: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00008950: 7375 6c74 203d 2063 6332 2e66 6574 6368  sult = cc2.fetch
+00008960: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
+00008970: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00008980: 744c 6973 7445 7175 616c 2872 6573 756c  tListEqual(resul
+00008990: 742c 205b 2831 2c20 4e6f 6e65 295d 290a  t, [(1, None)]).
+000089a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000089b0: 2023 2044 6973 7472 6962 7574 6564 2074   # Distributed t
+000089c0: 7261 6e73 6163 7469 6f6e 3a20 5052 4550  ransaction: PREP
+000089d0: 4152 452b 434f 4d4d 4954 0a20 2020 2020  ARE+COMMIT.     
+000089e0: 2020 2020 2020 2020 2020 2063 312e 6578             c1.ex
+000089f0: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
+00008a00: 746f 2074 2028 706b 2920 7661 6c75 6573  to t (pk) values
+00008a10: 2028 3229 2729 0a20 2020 2020 2020 2020   (2)').         
+00008a20: 2020 2020 2020 2063 322e 6578 6563 7574         c2.execut
+00008a30: 6528 2769 6e73 6572 7420 696e 746f 2074  e('insert into t
+00008a40: 2028 706b 2920 7661 6c75 6573 2028 3229   (pk) values (2)
+00008a50: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+00008a60: 2020 2064 742e 7072 6570 6172 6528 290a     dt.prepare().
+00008a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a80: 6474 2e63 6f6d 6d69 7428 290a 0a20 2020  dt.commit()..   
+00008a90: 2020 2020 2020 2020 2020 2020 2077 6974               wit
+00008aa0: 6820 7472 616e 7361 6374 696f 6e28 7365  h transaction(se
+00008ab0: 6c66 2e63 6f6e 3129 3a0a 2020 2020 2020  lf.con1):.      
+00008ac0: 2020 2020 2020 2020 2020 2020 2020 6363                cc
+00008ad0: 312e 6578 6563 7574 6528 7129 0a20 2020  1.execute(q).   
+00008ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008af0: 2072 6573 756c 7420 3d20 6363 312e 6665   result = cc1.fe
+00008b00: 7463 6861 6c6c 2829 0a20 2020 2020 2020  tchall().       
+00008b10: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00008b20: 7365 7274 4c69 7374 4571 7561 6c28 7265  sertListEqual(re
+00008b30: 7375 6c74 2c20 5b28 312c 204e 6f6e 6529  sult, [(1, None)
+00008b40: 2c20 2832 2c20 4e6f 6e65 295d 290a 2020  , (2, None)]).  
+00008b50: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00008b60: 7468 2074 7261 6e73 6163 7469 6f6e 2873  th transaction(s
+00008b70: 656c 662e 636f 6e32 293a 0a20 2020 2020  elf.con2):.     
+00008b80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00008b90: 6332 2e65 7865 6375 7465 2871 290a 2020  c2.execute(q).  
+00008ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008bb0: 2020 7265 7375 6c74 203d 2063 6332 2e66    result = cc2.f
+00008bc0: 6574 6368 616c 6c28 290a 2020 2020 2020  etchall().      
+00008bd0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00008be0: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
+00008bf0: 6573 756c 742c 205b 2831 2c20 4e6f 6e65  esult, [(1, None
+00008c00: 292c 2028 322c 204e 6f6e 6529 5d29 0a0a  ), (2, None)])..
+00008c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c20: 2320 4469 7374 7269 6275 7465 6420 7472  # Distributed tr
+00008c30: 616e 7361 6374 696f 6e3a 2053 4156 4550  ansaction: SAVEP
+00008c40: 4f49 4e54 2b52 4f4c 4c42 4143 4b20 746f  OINT+ROLLBACK to
+00008c50: 2069 740a 2020 2020 2020 2020 2020 2020   it.            
+00008c60: 2020 2020 6331 2e65 7865 6375 7465 2827      c1.execute('
+00008c70: 696e 7365 7274 2069 6e74 6f20 7420 2870  insert into t (p
+00008c80: 6b29 2076 616c 7565 7320 2833 2927 290a  k) values (3)').
+00008c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ca0: 6474 2e73 6176 6570 6f69 6e74 2827 4347  dt.savepoint('CG
+00008cb0: 5f53 4156 4550 4f49 4e54 2729 0a20 2020  _SAVEPOINT').   
+00008cc0: 2020 2020 2020 2020 2020 2020 2063 322e               c2.
+00008cd0: 6578 6563 7574 6528 2769 6e73 6572 7420  execute('insert 
+00008ce0: 696e 746f 2074 2028 706b 2920 7661 6c75  into t (pk) valu
+00008cf0: 6573 2028 3329 2729 0a20 2020 2020 2020  es (3)').       
+00008d00: 2020 2020 2020 2020 2064 742e 726f 6c6c           dt.roll
+00008d10: 6261 636b 2873 6176 6570 6f69 6e74 3d27  back(savepoint='
+00008d20: 4347 5f53 4156 4550 4f49 4e54 2729 0a0a  CG_SAVEPOINT')..
+00008d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008d40: 6331 2e65 7865 6375 7465 2871 290a 2020  c1.execute(q).  
+00008d50: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00008d60: 7375 6c74 203d 2063 312e 6665 7463 6861  sult = c1.fetcha
+00008d70: 6c6c 2829 0a20 2020 2020 2020 2020 2020  ll().           
+00008d80: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00008d90: 4c69 7374 4571 7561 6c28 7265 7375 6c74  ListEqual(result
+00008da0: 2c20 5b28 312c 204e 6f6e 6529 2c20 2832  , [(1, None), (2
+00008db0: 2c20 4e6f 6e65 292c 2028 332c 204e 6f6e  , None), (3, Non
+00008dc0: 6529 5d29 0a20 2020 2020 2020 2020 2020  e)]).           
+00008dd0: 2020 2020 2063 322e 6578 6563 7574 6528       c2.execute(
+00008de0: 7129 0a20 2020 2020 2020 2020 2020 2020  q).             
+00008df0: 2020 2072 6573 756c 7420 3d20 6332 2e66     result = c2.f
+00008e00: 6574 6368 616c 6c28 290a 2020 2020 2020  etchall().      
+00008e10: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00008e20: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
+00008e30: 6573 756c 742c 205b 2831 2c20 4e6f 6e65  esult, [(1, None
+00008e40: 292c 2028 322c 204e 6f6e 6529 5d29 0a0a  ), (2, None)])..
+00008e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e60: 2320 4469 7374 7269 6275 7465 6420 7472  # Distributed tr
+00008e70: 616e 7361 6374 696f 6e3a 2052 4f4c 4c42  ansaction: ROLLB
+00008e80: 4143 4b0a 2020 2020 2020 2020 2020 2020  ACK.            
+00008e90: 2020 2020 6474 2e72 6f6c 6c62 6163 6b28      dt.rollback(
+00008ea0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00008eb0: 2020 2077 6974 6820 7472 616e 7361 6374     with transact
+00008ec0: 696f 6e28 7365 6c66 2e63 6f6e 3129 3a0a  ion(self.con1):.
+00008ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ee0: 2020 2020 6363 312e 6578 6563 7574 6528      cc1.execute(
+00008ef0: 7129 0a20 2020 2020 2020 2020 2020 2020  q).             
+00008f00: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00008f10: 6363 312e 6665 7463 6861 6c6c 2829 0a20  cc1.fetchall(). 
+00008f20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00008f30: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
+00008f40: 7561 6c28 7265 7375 6c74 2c20 5b28 312c  ual(result, [(1,
+00008f50: 204e 6f6e 6529 2c20 2832 2c20 4e6f 6e65   None), (2, None
+00008f60: 295d 290a 2020 2020 2020 2020 2020 2020  )]).            
+00008f70: 2020 2020 7769 7468 2074 7261 6e73 6163      with transac
+00008f80: 7469 6f6e 2873 656c 662e 636f 6e32 293a  tion(self.con2):
+00008f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008fa0: 2020 2020 2063 6332 2e65 7865 6375 7465       cc2.execute
+00008fb0: 2871 290a 2020 2020 2020 2020 2020 2020  (q).            
+00008fc0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00008fd0: 2063 6332 2e66 6574 6368 616c 6c28 290a   cc2.fetchall().
+00008fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008ff0: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
+00009000: 7175 616c 2872 6573 756c 742c 205b 2831  qual(result, [(1
+00009010: 2c20 4e6f 6e65 292c 2028 322c 204e 6f6e  , None), (2, Non
+00009020: 6529 5d29 0a0a 2020 2020 2020 2020 2020  e)])..          
+00009030: 2020 2020 2020 2320 4469 7374 7269 6275        # Distribu
+00009040: 7465 6420 7472 616e 7361 6374 696f 6e3a  ted transaction:
+00009050: 2045 5845 4355 5445 5f49 4d4d 4544 4941   EXECUTE_IMMEDIA
+00009060: 5445 0a20 2020 2020 2020 2020 2020 2020  TE.             
+00009070: 2020 2064 742e 6578 6563 7574 655f 696d     dt.execute_im
+00009080: 6d65 6469 6174 6528 2769 6e73 6572 7420  mediate('insert 
+00009090: 696e 746f 2074 2028 706b 2920 7661 6c75  into t (pk) valu
+000090a0: 6573 2028 3329 2729 0a20 2020 2020 2020  es (3)').       
+000090b0: 2020 2020 2020 2020 2064 742e 636f 6d6d           dt.comm
+000090c0: 6974 2829 0a0a 2020 2020 2020 2020 2020  it()..          
+000090d0: 2020 2020 2020 7769 7468 2074 7261 6e73        with trans
+000090e0: 6163 7469 6f6e 2873 656c 662e 636f 6e31  action(self.con1
+000090f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00009100: 2020 2020 2020 2063 6331 2e65 7865 6375         cc1.execu
+00009110: 7465 2871 290a 2020 2020 2020 2020 2020  te(q).          
+00009120: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00009130: 203d 2063 6331 2e66 6574 6368 616c 6c28   = cc1.fetchall(
+00009140: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00009150: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
+00009160: 7445 7175 616c 2872 6573 756c 742c 205b  tEqual(result, [
+00009170: 2831 2c20 4e6f 6e65 292c 2028 322c 204e  (1, None), (2, N
+00009180: 6f6e 6529 2c20 2833 2c20 4e6f 6e65 295d  one), (3, None)]
+00009190: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000091a0: 2020 7769 7468 2074 7261 6e73 6163 7469    with transacti
+000091b0: 6f6e 2873 656c 662e 636f 6e32 293a 0a20  on(self.con2):. 
+000091c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000091d0: 2020 2063 6332 2e65 7865 6375 7465 2871     cc2.execute(q
+000091e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000091f0: 2020 2020 2020 7265 7375 6c74 203d 2063        result = c
+00009200: 6332 2e66 6574 6368 616c 6c28 290a 2020  c2.fetchall().  
+00009210: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00009220: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
+00009230: 616c 2872 6573 756c 742c 205b 2831 2c20  al(result, [(1, 
+00009240: 4e6f 6e65 292c 2028 322c 204e 6f6e 6529  None), (2, None)
+00009250: 2c20 2833 2c20 4e6f 6e65 295d 290a 2020  , (3, None)]).  
+00009260: 2020 6465 6620 7465 7374 5f6c 696d 626f    def test_limbo
+00009270: 5f74 7261 6e73 6163 7469 6f6e 7328 7365  _transactions(se
+00009280: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
+00009290: 662e 736b 6970 5465 7374 2827 4e6f 7420  f.skipTest('Not 
+000092a0: 696d 706c 656d 656e 7465 6420 7965 7427  implemented yet'
+000092b0: 290a 2020 2020 2020 2020 2372 6574 7572  ).        #retur
+000092c0: 6e0a 2020 2020 2020 2020 2377 6974 6820  n.        #with 
+000092d0: 636f 6e6e 6563 745f 7365 7276 6572 2827  connect_server('
+000092e0: 4642 5445 5354 5f48 4f53 5427 2920 6173  FBTEST_HOST') as
+000092f0: 2073 7663 3a0a 2020 2020 2020 2020 2020   svc:.          
+00009300: 2020 2364 7420 3d20 4469 7374 7269 6275    #dt = Distribu
+00009310: 7465 6454 7261 6e73 6163 7469 6f6e 4d61  tedTransactionMa
+00009320: 6e61 6765 7228 5b73 656c 662e 636f 6e31  nager([self.con1
+00009330: 2c20 7365 6c66 2e63 6f6e 325d 290a 2020  , self.con2]).  
+00009340: 2020 2020 2020 2020 2020 2369 6473 3120            #ids1 
+00009350: 3d20 7376 632e 6461 7461 6261 7365 2e67  = svc.database.g
+00009360: 6574 5f6c 696d 626f 5f74 7261 6e73 6163  et_limbo_transac
+00009370: 7469 6f6e 5f69 6473 2864 6174 6162 6173  tion_ids(databas
+00009380: 653d 7365 6c66 2e64 6231 290a 2020 2020  e=self.db1).    
+00009390: 2020 2020 2020 2020 2373 656c 662e 6173          #self.as
+000093a0: 7365 7274 4571 7561 6c28 6964 7331 2c20  sertEqual(ids1, 
+000093b0: 5b5d 290a 2020 2020 2020 2020 2020 2020  []).            
+000093c0: 2369 6473 3220 3d20 7376 632e 6461 7461  #ids2 = svc.data
+000093d0: 6261 7365 2e67 6574 5f6c 696d 626f 5f74  base.get_limbo_t
+000093e0: 7261 6e73 6163 7469 6f6e 5f69 6473 2864  ransaction_ids(d
+000093f0: 6174 6162 6173 653d 7365 6c66 2e64 6232  atabase=self.db2
+00009400: 290a 2020 2020 2020 2020 2020 2020 2373  ).            #s
+00009410: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00009420: 6964 7332 2c20 5b5d 290a 2020 2020 2020  ids2, []).      
+00009430: 2020 2020 2020 2364 742e 6578 6563 7574        #dt.execut
+00009440: 655f 696d 6d65 6469 6174 6528 2769 6e73  e_immediate('ins
+00009450: 6572 7420 696e 746f 2074 2028 706b 2920  ert into t (pk) 
+00009460: 7661 6c75 6573 2028 3329 2729 0a20 2020  values (3)').   
+00009470: 2020 2020 2020 2020 2023 6474 2e70 7265           #dt.pre
+00009480: 7061 7265 2829 0a20 2020 2020 2020 2020  pare().         
+00009490: 2020 2023 2320 466f 7263 6520 6f75 7420     ## Force out 
+000094a0: 626f 7468 2063 6f6e 6e65 6374 696f 6e73  both connections
+000094b0: 0a20 2020 2020 2020 2020 2020 2023 6474  .            #dt
+000094c0: 2e5f 7472 612e 7265 6c65 6173 6528 290a  ._tra.release().
+000094d0: 2020 2020 2020 2020 2020 2020 2364 742e              #dt.
+000094e0: 5f74 7261 203d 204e 6f6e 650a 2020 2020  _tra = None.    
+000094f0: 2020 2020 2020 2020 2364 742e 636c 6f73          #dt.clos
+00009500: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+00009510: 2373 656c 662e 636f 6e31 2e63 6c6f 7365  #self.con1.close
+00009520: 2829 0a20 2020 2020 2020 2020 2020 2023  ().            #
+00009530: 7365 6c66 2e63 6f6e 322e 636c 6f73 6528  self.con2.close(
+00009540: 290a 2020 2020 2020 2020 2020 2020 2323  ).            ##
+00009550: 0a20 2020 2020 2020 2020 2020 2023 7365  .            #se
+00009560: 6c66 2e63 6f6e 3120 3d20 636f 6e6e 6563  lf.con1 = connec
+00009570: 7428 2764 7473 2d31 2729 0a20 2020 2020  t('dts-1').     
+00009580: 2020 2020 2020 2023 7365 6c66 2e63 6f6e         #self.con
+00009590: 3220 3d20 636f 6e6e 6563 7428 2764 7473  2 = connect('dts
+000095a0: 2d32 2729 0a20 2020 2020 2020 2020 2020  -2').           
+000095b0: 2023 6964 7331 203d 2073 7663 2e64 6174   #ids1 = svc.dat
+000095c0: 6162 6173 652e 6765 745f 6c69 6d62 6f5f  abase.get_limbo_
+000095d0: 7472 616e 7361 6374 696f 6e5f 6964 7328  transaction_ids(
+000095e0: 6461 7461 6261 7365 3d73 656c 662e 6462  database=self.db
+000095f0: 3129 0a20 2020 2020 2020 2020 2020 2023  1).            #
+00009600: 6964 3120 3d20 6964 7331 5b30 5d0a 2020  id1 = ids1[0].  
+00009610: 2020 2020 2020 2020 2020 2369 6473 3220            #ids2 
+00009620: 3d20 7376 632e 6461 7461 6261 7365 2e67  = svc.database.g
+00009630: 6574 5f6c 696d 626f 5f74 7261 6e73 6163  et_limbo_transac
+00009640: 7469 6f6e 5f69 6473 2864 6174 6162 6173  tion_ids(databas
+00009650: 653d 7365 6c66 2e64 6232 290a 2020 2020  e=self.db2).    
+00009660: 2020 2020 2020 2020 2369 6432 203d 2069          #id2 = i
+00009670: 6473 325b 305d 0a20 2020 2020 2020 2020  ds2[0].         
+00009680: 2020 2023 2320 4461 7461 2073 686f 756c     ## Data shoul
+00009690: 6420 6265 2062 6c6f 636b 6564 2062 7920  d be blocked by 
+000096a0: 6c69 6d62 6f20 7472 616e 7361 6374 696f  limbo transactio
+000096b0: 6e0a 2020 2020 2020 2020 2020 2020 2363  n.            #c
+000096c0: 3120 3d20 7365 6c66 2e63 6f6e 312e 6375  1 = self.con1.cu
+000096d0: 7273 6f72 2829 0a20 2020 2020 2020 2020  rsor().         
+000096e0: 2020 2023 6331 2e65 7865 6375 7465 2827     #c1.execute('
+000096f0: 7365 6c65 6374 202a 2066 726f 6d20 7427  select * from t'
+00009700: 290a 2020 2020 2020 2020 2020 2020 2377  ).            #w
+00009710: 6974 6820 7365 6c66 2e61 7373 6572 7452  ith self.assertR
+00009720: 6169 7365 7328 4461 7461 6261 7365 4572  aises(DatabaseEr
+00009730: 726f 7229 2061 7320 636d 3a0a 2020 2020  ror) as cm:.    
+00009740: 2020 2020 2020 2020 2020 2020 2372 6f77              #row
+00009750: 203d 2063 312e 6665 7463 6861 6c6c 2829   = c1.fetchall()
+00009760: 0a20 2020 2020 2020 2020 2020 2023 7365  .            #se
+00009770: 6c66 2e61 7373 6572 7454 7570 6c65 4571  lf.assertTupleEq
+00009780: 7561 6c28 636d 2e65 7863 6570 7469 6f6e  ual(cm.exception
+00009790: 2e61 7267 732c 0a20 2020 2020 2020 2020  .args,.         
+000097a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000097b0: 2020 2020 2020 2020 2023 2827 4375 7273           #('Curs
+000097c0: 6f72 2e66 6574 6368 6f6e 653a 5c6e 2d20  or.fetchone:\n- 
+000097d0: 5351 4c43 4f44 453a 202d 3931 315c 6e2d  SQLCODE: -911\n-
+000097e0: 2072 6563 6f72 6420 6672 6f6d 2074 7261   record from tra
+000097f0: 6e73 6163 7469 6f6e 2025 6920 6973 2073  nsaction %i is s
+00009800: 7475 636b 2069 6e20 6c69 6d62 6f27 2025  tuck in limbo' %
+00009810: 2069 6431 2c20 2d39 3131 2c20 3333 3535   id1, -911, 3355
+00009820: 3434 3435 3929 290a 2020 2020 2020 2020  44459)).        
+00009830: 2020 2020 2363 3220 3d20 7365 6c66 2e63      #c2 = self.c
+00009840: 6f6e 322e 6375 7273 6f72 2829 0a20 2020  on2.cursor().   
+00009850: 2020 2020 2020 2020 2023 6332 2e65 7865           #c2.exe
+00009860: 6375 7465 2827 7365 6c65 6374 202a 2066  cute('select * f
+00009870: 726f 6d20 7427 290a 2020 2020 2020 2020  rom t').        
+00009880: 2020 2020 2377 6974 6820 7365 6c66 2e61      #with self.a
+00009890: 7373 6572 7452 6169 7365 7328 4461 7461  ssertRaises(Data
+000098a0: 6261 7365 4572 726f 7229 2061 7320 636d  baseError) as cm
+000098b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000098c0: 2020 2372 6f77 203d 2063 322e 6665 7463    #row = c2.fetc
+000098d0: 6861 6c6c 2829 0a20 2020 2020 2020 2020  hall().         
+000098e0: 2020 2023 7365 6c66 2e61 7373 6572 7454     #self.assertT
+000098f0: 7570 6c65 4571 7561 6c28 636d 2e65 7863  upleEqual(cm.exc
+00009900: 6570 7469 6f6e 2e61 7267 732c 0a20 2020  eption.args,.   
+00009910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009920: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00009930: 2827 4375 7273 6f72 2e66 6574 6368 6f6e  ('Cursor.fetchon
+00009940: 653a 5c6e 2d20 5351 4c43 4f44 453a 202d  e:\n- SQLCODE: -
+00009950: 3931 315c 6e2d 2072 6563 6f72 6420 6672  911\n- record fr
+00009960: 6f6d 2074 7261 6e73 6163 7469 6f6e 2025  om transaction %
+00009970: 6920 6973 2073 7475 636b 2069 6e20 6c69  i is stuck in li
+00009980: 6d62 6f27 2025 2069 6432 2c20 2d39 3131  mbo' % id2, -911
+00009990: 2c20 3333 3535 3434 3435 3929 290a 2020  , 335544459)).  
+000099a0: 2020 2020 2020 2020 2020 2323 2072 6573            ## res
+000099b0: 6f6c 7665 2076 6961 2073 6572 7669 6365  olve via service
+000099c0: 0a20 2020 2020 2020 2020 2020 2023 7376  .            #sv
+000099d0: 6320 3d20 636f 6e6e 6563 745f 7365 7276  c = connect_serv
+000099e0: 6572 2868 6f73 743d 4642 5445 5354 5f48  er(host=FBTEST_H
+000099f0: 4f53 542c 2070 6173 7377 6f72 643d 4642  OST, password=FB
+00009a00: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
+00009a10: 2020 2020 2020 2020 2020 2023 7376 632e             #svc.
+00009a20: 6461 7461 6261 7365 2e63 6f6d 6d69 745f  database.commit_
+00009a30: 6c69 6d62 6f5f 7472 616e 7361 6374 696f  limbo_transactio
+00009a40: 6e28 6461 7461 6261 7365 3d73 656c 662e  n(database=self.
+00009a50: 6462 312c 2074 7261 6e73 6163 7469 6f6e  db1, transaction
+00009a60: 5f69 643d 6964 3129 0a20 2020 2020 2020  _id=id1).       
+00009a70: 2020 2020 2023 7376 632e 6461 7461 6261       #svc.databa
+00009a80: 7365 2e72 6f6c 6c62 6163 6b5f 6c69 6d62  se.rollback_limb
+00009a90: 6f5f 7472 616e 7361 6374 696f 6e28 6461  o_transaction(da
+00009aa0: 7461 6261 7365 3d73 656c 662e 6462 322c  tabase=self.db2,
+00009ab0: 2074 7261 6e73 6163 7469 6f6e 5f69 643d   transaction_id=
+00009ac0: 6964 3229 0a0a 2020 2020 2020 2020 2020  id2)..          
+00009ad0: 2020 2323 2063 6865 636b 2074 6865 2072    ## check the r
+00009ae0: 6573 6f6c 7574 696f 6e0a 2020 2020 2020  esolution.      
+00009af0: 2020 2020 2020 2363 3120 3d20 7365 6c66        #c1 = self
+00009b00: 2e63 6f6e 312e 6375 7273 6f72 2829 0a20  .con1.cursor(). 
+00009b10: 2020 2020 2020 2020 2020 2023 6331 2e65             #c1.e
+00009b20: 7865 6375 7465 2827 7365 6c65 6374 202a  xecute('select *
+00009b30: 2066 726f 6d20 7427 290a 2020 2020 2020   from t').      
+00009b40: 2020 2020 2020 2372 6f77 203d 2063 312e        #row = c1.
+00009b50: 6665 7463 6861 6c6c 2829 0a20 2020 2020  fetchall().     
+00009b60: 2020 2020 2020 2023 7365 6c66 2e61 7373         #self.ass
+00009b70: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
+00009b80: 2c20 5b28 332c 204e 6f6e 6529 5d29 0a20  , [(3, None)]). 
+00009b90: 2020 2020 2020 2020 2020 2023 6332 203d             #c2 =
+00009ba0: 2073 656c 662e 636f 6e32 2e63 7572 736f   self.con2.curso
+00009bb0: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
+00009bc0: 2363 322e 6578 6563 7574 6528 2773 656c  #c2.execute('sel
+00009bd0: 6563 7420 2a20 6672 6f6d 2074 2729 0a20  ect * from t'). 
+00009be0: 2020 2020 2020 2020 2020 2023 726f 7720             #row 
+00009bf0: 3d20 6332 2e66 6574 6368 616c 6c28 290a  = c2.fetchall().
+00009c00: 2020 2020 2020 2020 2020 2020 2373 656c              #sel
+00009c10: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
+00009c20: 6c28 726f 772c 205b 5d29 0a0a 636c 6173  l(row, [])..clas
+00009c30: 7320 5465 7374 4375 7273 6f72 2844 7269  s TestCursor(Dri
+00009c40: 7665 7254 6573 7442 6173 6529 3a0a 2020  verTestBase):.  
+00009c50: 2020 6465 6620 7365 7455 7028 7365 6c66    def setUp(self
+00009c60: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
+00009c70: 2829 2e73 6574 5570 2829 0a20 2020 2020  ().setUp().     
+00009c80: 2020 2073 656c 662e 6462 6669 6c65 203d     self.dbfile =
+00009c90: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
+00009ca0: 6c66 2e64 6270 6174 682c 2073 656c 662e  lf.dbpath, self.
+00009cb0: 4642 5445 5354 5f44 4229 0a20 2020 2020  FBTEST_DB).     
+00009cc0: 2020 2073 656c 662e 636f 6e20 3d20 636f     self.con = co
+00009cd0: 6e6e 6563 7428 7365 6c66 2e64 6266 696c  nnect(self.dbfil
+00009ce0: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
+00009cf0: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+00009d00: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
+00009d10: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+00009d20: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
+00009d30: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+00009d40: 6e61 6d65 5f5f 0a20 2020 2020 2020 2023  name__.        #
+00009d50: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
+00009d60: 5f69 6d6d 6564 6961 7465 2822 7265 6372  _immediate("recr
+00009d70: 6561 7465 2074 6162 6c65 2074 2028 6331  eate table t (c1
+00009d80: 2069 6e74 6567 6572 2070 7269 6d61 7279   integer primary
+00009d90: 206b 6579 2922 290a 2020 2020 2020 2020   key)").        
+00009da0: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
+00009db0: 5f69 6d6d 6564 6961 7465 2822 6465 6c65  _immediate("dele
+00009dc0: 7465 2066 726f 6d20 7422 290a 2020 2020  te from t").    
+00009dd0: 2020 2020 7365 6c66 2e63 6f6e 2e63 6f6d      self.con.com
+00009de0: 6d69 7428 290a 2020 2020 6465 6620 7465  mit().    def te
+00009df0: 6172 446f 776e 2873 656c 6629 3a0a 2020  arDown(self):.  
+00009e00: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
+00009e10: 6c6f 7365 2829 0a20 2020 2064 6566 2074  lose().    def t
+00009e20: 6573 745f 6578 6563 7574 6528 7365 6c66  est_execute(self
+00009e30: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
+00009e40: 7365 6c66 2e63 6f6e 2e63 7572 736f 7228  self.con.cursor(
+00009e50: 2920 6173 2063 7572 3a0a 2020 2020 2020  ) as cur:.      
+00009e60: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+00009e70: 6528 2773 656c 6563 7420 2a20 6672 6f6d  e('select * from
+00009e80: 2063 6f75 6e74 7279 2729 0a20 2020 2020   country').     
+00009e90: 2020 2020 2020 2072 6f77 203d 2063 7572         row = cur
+00009ea0: 2e66 6574 6368 6f6e 6528 290a 2020 2020  .fetchone().    
+00009eb0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00009ec0: 6572 7454 7570 6c65 4571 7561 6c28 726f  ertTupleEqual(ro
+00009ed0: 772c 2028 2755 5341 272c 2027 446f 6c6c  w, ('USA', 'Doll
+00009ee0: 6172 2729 290a 2020 2020 2020 2020 2020  ar')).          
+00009ef0: 2020 2320 6167 6169 6e20 7468 6520 7361    # again the sa
+00009f00: 6d65 2053 514c 2028 7368 6f75 6c64 2075  me SQL (should u
+00009f10: 7365 2074 6865 2073 616d 6520 5374 6174  se the same Stat
+00009f20: 656d 656e 7429 0a20 2020 2020 2020 2020  ement).         
+00009f30: 2020 2073 746d 7420 3d20 6375 722e 5f73     stmt = cur._s
+00009f40: 746d 740a 2020 2020 2020 2020 2020 2020  tmt.            
+00009f50: 6375 722e 6578 6563 7574 6528 2773 656c  cur.execute('sel
+00009f60: 6563 7420 2a20 6672 6f6d 2063 6f75 6e74  ect * from count
+00009f70: 7279 2729 0a20 2020 2020 2020 2020 2020  ry').           
+00009f80: 2073 656c 662e 6173 7365 7274 4973 2873   self.assertIs(s
+00009f90: 746d 742c 2063 7572 2e5f 7374 6d74 290a  tmt, cur._stmt).
+00009fa0: 2020 2020 2020 2020 2020 2020 726f 7720              row 
+00009fb0: 3d20 6375 722e 6665 7463 686f 6e65 2829  = cur.fetchone()
+00009fc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00009fd0: 662e 6173 7365 7274 5475 706c 6545 7175  f.assertTupleEqu
+00009fe0: 616c 2872 6f77 2c20 2827 5553 4127 2c20  al(row, ('USA', 
+00009ff0: 2744 6f6c 6c61 7227 2929 0a20 2020 2020  'Dollar')).     
+0000a000: 2020 2020 2020 2023 2070 7265 7061 7265         # prepare
+0000a010: 6420 7374 6174 656d 656e 740a 2020 2020  d statement.    
+0000a020: 2020 2020 2020 2020 7073 203d 2063 7572          ps = cur
+0000a030: 2e70 7265 7061 7265 2827 7365 6c65 6374  .prepare('select
+0000a040: 202a 2066 726f 6d20 636f 756e 7472 7927   * from country'
+0000a050: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+0000a060: 722e 6578 6563 7574 6528 7073 290a 2020  r.execute(ps).  
+0000a070: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000a080: 7373 6572 7449 734e 6f74 2873 746d 742c  ssertIsNot(stmt,
+0000a090: 2063 7572 2e5f 7374 6d74 290a 2020 2020   cur._stmt).    
+0000a0a0: 2020 2020 2020 2020 726f 7720 3d20 6375          row = cu
+0000a0b0: 722e 6665 7463 686f 6e65 2829 0a20 2020  r.fetchone().   
+0000a0c0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0000a0d0: 7365 7274 5475 706c 6545 7175 616c 2872  sertTupleEqual(r
+0000a0e0: 6f77 2c20 2827 5553 4127 2c20 2744 6f6c  ow, ('USA', 'Dol
+0000a0f0: 6c61 7227 2929 0a20 2020 2064 6566 2074  lar')).    def t
+0000a100: 6573 745f 6578 6563 7574 656d 616e 7928  est_executemany(
+0000a110: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
+0000a120: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
+0000a130: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
+0000a140: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+0000a150: 6563 7574 656d 616e 7928 2269 6e73 6572  ecutemany("inser
+0000a160: 7420 696e 746f 2074 2076 616c 7565 7328  t into t values(
+0000a170: 3f29 222c 205b 2831 2c29 2c20 2832 2c29  ?)", [(1,), (2,)
+0000a180: 5d29 0a20 2020 2020 2020 2020 2020 2063  ]).            c
+0000a190: 7572 2e65 7865 6375 7465 6d61 6e79 2822  ur.executemany("
+0000a1a0: 696e 7365 7274 2069 6e74 6f20 7420 7661  insert into t va
+0000a1b0: 6c75 6573 283f 2922 2c20 5b28 332c 295d  lues(?)", [(3,)]
+0000a1c0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+0000a1d0: 722e 6578 6563 7574 656d 616e 7928 2269  r.executemany("i
+0000a1e0: 6e73 6572 7420 696e 746f 2074 2076 616c  nsert into t val
+0000a1f0: 7565 7328 3f29 222c 205b 2834 2c29 2c20  ues(?)", [(4,), 
+0000a200: 2835 2c29 2c20 2836 2c29 5d29 0a20 2020  (5,), (6,)]).   
+0000a210: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
+0000a220: 6e2e 636f 6d6d 6974 2829 0a20 2020 2020  n.commit().     
+0000a230: 2020 2020 2020 2070 203d 2063 7572 2e70         p = cur.p
+0000a240: 7265 7061 7265 2822 696e 7365 7274 2069  repare("insert i
+0000a250: 6e74 6f20 7420 7661 6c75 6573 283f 2922  nto t values(?)"
+0000a260: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+0000a270: 722e 6578 6563 7574 656d 616e 7928 702c  r.executemany(p,
+0000a280: 205b 2837 2c29 2c20 2838 2c29 5d29 0a20   [(7,), (8,)]). 
+0000a290: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+0000a2a0: 7865 6375 7465 6d61 6e79 2870 2c20 5b28  xecutemany(p, [(
+0000a2b0: 392c 295d 290a 2020 2020 2020 2020 2020  9,)]).          
+0000a2c0: 2020 6375 722e 6578 6563 7574 656d 616e    cur.executeman
+0000a2d0: 7928 702c 205b 2831 302c 292c 2028 3131  y(p, [(10,), (11
+0000a2e0: 2c29 2c20 2831 322c 295d 290a 2020 2020  ,), (12,)]).    
+0000a2f0: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+0000a300: 2e63 6f6d 6d69 7428 290a 2020 2020 2020  .commit().      
+0000a310: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+0000a320: 6528 2273 656c 6563 7420 2a20 6672 6f6d  e("select * from
+0000a330: 2054 206f 7264 6572 2062 7920 6331 2229   T order by c1")
+0000a340: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+0000a350: 7320 3d20 6375 722e 6665 7463 6861 6c6c  s = cur.fetchall
+0000a360: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+0000a370: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
+0000a380: 7561 6c28 726f 7773 2c20 5b28 312c 292c  ual(rows, [(1,),
+0000a390: 2028 322c 292c 2028 332c 292c 2028 342c   (2,), (3,), (4,
+0000a3a0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3c0: 2020 2020 2020 2020 2020 2028 352c 292c             (5,),
+0000a3d0: 2028 362c 292c 2028 372c 292c 2028 382c   (6,), (7,), (8,
+0000a3e0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a400: 2020 2020 2020 2020 2020 2028 392c 292c             (9,),
+0000a410: 2028 3130 2c29 2c20 2831 312c 292c 2028   (10,), (11,), (
+0000a420: 3132 2c29 5d29 0a20 2020 2064 6566 2074  12,)]).    def t
+0000a430: 6573 745f 6974 6572 6174 696f 6e28 7365  est_iteration(se
+0000a440: 6c66 293a 0a20 2020 2020 2020 2064 6174  lf):.        dat
+0000a450: 6120 3d20 5b28 2755 5341 272c 2027 446f  a = [('USA', 'Do
+0000a460: 6c6c 6172 2729 2c20 2827 456e 676c 616e  llar'), ('Englan
+0000a470: 6427 2c20 2750 6f75 6e64 2729 2c20 2827  d', 'Pound'), ('
+0000a480: 4361 6e61 6461 272c 2027 4364 6e44 6c72  Canada', 'CdnDlr
+0000a490: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+0000a4a0: 2020 2020 2827 5377 6974 7a65 726c 616e      ('Switzerlan
+0000a4b0: 6427 2c20 2753 4672 616e 6327 292c 2028  d', 'SFranc'), (
+0000a4c0: 274a 6170 616e 272c 2027 5965 6e27 292c  'Japan', 'Yen'),
+0000a4d0: 2028 2749 7461 6c79 272c 2027 4575 726f   ('Italy', 'Euro
+0000a4e0: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+0000a4f0: 2020 2020 2827 4672 616e 6365 272c 2027      ('France', '
+0000a500: 4575 726f 2729 2c20 2827 4765 726d 616e  Euro'), ('German
+0000a510: 7927 2c20 2745 7572 6f27 292c 2028 2741  y', 'Euro'), ('A
+0000a520: 7573 7472 616c 6961 272c 2027 4144 6f6c  ustralia', 'ADol
+0000a530: 6c61 7227 292c 0a20 2020 2020 2020 2020  lar'),.         
+0000a540: 2020 2020 2020 2028 2748 6f6e 6720 4b6f         ('Hong Ko
+0000a550: 6e67 272c 2027 484b 446f 6c6c 6172 2729  ng', 'HKDollar')
+0000a560: 2c20 2827 4e65 7468 6572 6c61 6e64 7327  , ('Netherlands'
+0000a570: 2c20 2745 7572 6f27 292c 2028 2742 656c  , 'Euro'), ('Bel
+0000a580: 6769 756d 272c 2027 4575 726f 2729 2c0a  gium', 'Euro'),.
+0000a590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a5a0: 2827 4175 7374 7269 6127 2c20 2745 7572  ('Austria', 'Eur
+0000a5b0: 6f27 292c 2028 2746 696a 6927 2c20 2746  o'), ('Fiji', 'F
+0000a5c0: 446f 6c6c 6172 2729 2c20 2827 5275 7373  Dollar'), ('Russ
+0000a5d0: 6961 272c 2027 5275 626c 6527 292c 0a20  ia', 'Ruble'),. 
+0000a5e0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0000a5f0: 2752 6f6d 616e 6961 272c 2027 524c 6575  'Romania', 'RLeu
+0000a600: 2729 5d0a 2020 2020 2020 2020 7769 7468  ')].        with
+0000a610: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
+0000a620: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
+0000a630: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0000a640: 7465 2827 7365 6c65 6374 202a 2066 726f  te('select * fro
+0000a650: 6d20 636f 756e 7472 7927 290a 2020 2020  m country').    
+0000a660: 2020 2020 2020 2020 726f 7773 203d 205b          rows = [
+0000a670: 726f 7720 666f 7220 726f 7720 696e 2063  row for row in c
+0000a680: 7572 5d0a 2020 2020 2020 2020 2020 2020  ur].            
+0000a690: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0000a6a0: 286c 656e 2872 6f77 7329 2c20 6c65 6e28  (len(rows), len(
+0000a6b0: 6461 7461 2929 0a20 2020 2020 2020 2020  data)).         
+0000a6c0: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
+0000a6d0: 7374 4571 7561 6c28 726f 7773 2c20 6461  stEqual(rows, da
+0000a6e0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
+0000a6f0: 6375 722e 6578 6563 7574 6528 2773 656c  cur.execute('sel
+0000a700: 6563 7420 2a20 6672 6f6d 2063 6f75 6e74  ect * from count
+0000a710: 7279 2729 0a20 2020 2020 2020 2020 2020  ry').           
+0000a720: 2072 6f77 7320 3d20 5b5d 0a20 2020 2020   rows = [].     
+0000a730: 2020 2020 2020 2066 6f72 2072 6f77 2069         for row i
+0000a740: 6e20 6375 723a 0a20 2020 2020 2020 2020  n cur:.         
+0000a750: 2020 2020 2020 2072 6f77 732e 6170 7065         rows.appe
+0000a760: 6e64 2872 6f77 290a 2020 2020 2020 2020  nd(row).        
+0000a770: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0000a780: 7175 616c 286c 656e 2872 6f77 7329 2c20  qual(len(rows), 
+0000a790: 6c65 6e28 6461 7461 2929 0a20 2020 2020  len(data)).     
+0000a7a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000a7b0: 7274 4c69 7374 4571 7561 6c28 726f 7773  rtListEqual(rows
+0000a7c0: 2c20 6461 7461 290a 2020 2020 2020 2020  , data).        
+0000a7d0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+0000a7e0: 2773 656c 6563 7420 2a20 6672 6f6d 2063  'select * from c
+0000a7f0: 6f75 6e74 7279 2729 0a20 2020 2020 2020  ountry').       
+0000a800: 2020 2020 2069 203d 2030 0a20 2020 2020       i = 0.     
+0000a810: 2020 2020 2020 2066 6f72 2072 6f77 2069         for row i
+0000a820: 6e20 6375 723a 0a20 2020 2020 2020 2020  n cur:.         
+0000a830: 2020 2020 2020 2069 202b 3d20 310a 2020         i += 1.  
+0000a840: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000a850: 6c66 2e61 7373 6572 7449 6e28 726f 772c  lf.assertIn(row,
+0000a860: 2064 6174 6129 0a20 2020 2020 2020 2020   data).         
+0000a870: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0000a880: 7561 6c28 692c 206c 656e 2864 6174 6129  ual(i, len(data)
+0000a890: 290a 2020 2020 6465 6620 7465 7374 5f64  ).    def test_d
+0000a8a0: 6573 6372 6970 7469 6f6e 2873 656c 6629  escription(self)
+0000a8b0: 3a0a 2020 2020 2020 2020 7769 7468 2073  :.        with s
+0000a8c0: 656c 662e 636f 6e2e 6375 7273 6f72 2829  elf.con.cursor()
+0000a8d0: 2061 7320 6375 723a 0a20 2020 2020 2020   as cur:.       
+0000a8e0: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+0000a8f0: 2827 7365 6c65 6374 202a 2066 726f 6d20  ('select * from 
+0000a900: 636f 756e 7472 7927 290a 2020 2020 2020  country').      
+0000a910: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000a920: 7445 7175 616c 286c 656e 2863 7572 2e64  tEqual(len(cur.d
+0000a930: 6573 6372 6970 7469 6f6e 292c 2032 290a  escription), 2).
+0000a940: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a950: 2e61 7373 6572 7445 7175 616c 2872 6570  .assertEqual(rep
+0000a960: 7228 6375 722e 6465 7363 7269 7074 696f  r(cur.descriptio
+0000a970: 6e29 2c0a 2020 2020 2020 2020 2020 2020  n),.            
+0000a980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a990: 2022 2828 2743 4f55 4e54 5259 272c 203c   "(('COUNTRY', <
+0000a9a0: 636c 6173 7320 2773 7472 273e 2c20 3135  class 'str'>, 15
+0000a9b0: 2c20 3135 2c20 302c 2030 2c20 4661 6c73  , 15, 0, 0, Fals
+0000a9c0: 6529 2c20 2220 5c0a 2020 2020 2020 2020  e), " \.        
+0000a9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a9e0: 2020 2020 2022 2827 4355 5252 454e 4359       "('CURRENCY
+0000a9f0: 272c 203c 636c 6173 7320 2773 7472 273e  ', <class 'str'>
+0000aa00: 2c20 3130 2c20 3130 2c20 302c 2030 2c20  , 10, 10, 0, 0, 
+0000aa10: 4661 6c73 6529 2922 290a 2020 2020 2020  False))").      
+0000aa20: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+0000aa30: 6528 2773 656c 6563 7420 636f 756e 7472  e('select countr
+0000aa40: 7920 6173 2043 542c 2063 7572 7265 6e63  y as CT, currenc
+0000aa50: 7920 6173 2043 5552 2066 726f 6d20 636f  y as CUR from co
+0000aa60: 756e 7472 7927 290a 2020 2020 2020 2020  untry').        
+0000aa70: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0000aa80: 7175 616c 286c 656e 2863 7572 2e64 6573  qual(len(cur.des
+0000aa90: 6372 6970 7469 6f6e 292c 2032 290a 2020  cription), 2).  
+0000aaa0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+0000aab0: 6563 7574 6528 2773 656c 6563 7420 2a20  ecute('select * 
+0000aac0: 6672 6f6d 2063 7573 746f 6d65 7227 290a  from customer').
+0000aad0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000aae0: 2e61 7373 6572 7445 7175 616c 2872 6570  .assertEqual(rep
+0000aaf0: 7228 6375 722e 6465 7363 7269 7074 696f  r(cur.descriptio
+0000ab00: 6e29 2c0a 2020 2020 2020 2020 2020 2020  n),.            
+0000ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab20: 2022 2828 2743 5553 545f 4e4f 272c 203c   "(('CUST_NO', <
+0000ab30: 636c 6173 7320 2769 6e74 273e 2c20 3131  class 'int'>, 11
+0000ab40: 2c20 342c 2030 2c20 302c 2046 616c 7365  , 4, 0, 0, False
+0000ab50: 292c 2022 205c 0a20 2020 2020 2020 2020  ), " \.         
+0000ab60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab70: 2020 2020 2228 2743 5553 544f 4d45 5227      "('CUSTOMER'
+0000ab80: 2c20 3c63 6c61 7373 2027 7374 7227 3e2c  , <class 'str'>,
+0000ab90: 2032 352c 2032 352c 2030 2c20 302c 2046   25, 25, 0, 0, F
+0000aba0: 616c 7365 292c 2022 205c 0a20 2020 2020  alse), " \.     
+0000abb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000abc0: 2020 2020 2020 2020 2228 2743 4f4e 5441          "('CONTA
+0000abd0: 4354 5f46 4952 5354 272c 203c 636c 6173  CT_FIRST', <clas
+0000abe0: 7320 2773 7472 273e 2c20 3135 2c20 3135  s 'str'>, 15, 15
+0000abf0: 2c20 302c 2030 2c20 5472 7565 292c 2022  , 0, 0, True), "
+0000ac00: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0000ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac20: 2228 2743 4f4e 5441 4354 5f4c 4153 5427  "('CONTACT_LAST'
+0000ac30: 2c20 3c63 6c61 7373 2027 7374 7227 3e2c  , <class 'str'>,
+0000ac40: 2032 302c 2032 302c 2030 2c20 302c 2054   20, 20, 0, 0, T
+0000ac50: 7275 6529 2c20 2220 5c0a 2020 2020 2020  rue), " \.      
+0000ac60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac70: 2020 2020 2020 2022 2827 5048 4f4e 455f         "('PHONE_
+0000ac80: 4e4f 272c 203c 636c 6173 7320 2773 7472  NO', <class 'str
+0000ac90: 273e 2c20 3230 2c20 3230 2c20 302c 2030  '>, 20, 20, 0, 0
+0000aca0: 2c20 5472 7565 292c 2022 205c 0a20 2020  , True), " \.   
+0000acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000acc0: 2020 2020 2020 2020 2020 2228 2741 4444            "('ADD
+0000acd0: 5245 5353 5f4c 494e 4531 272c 203c 636c  RESS_LINE1', <cl
+0000ace0: 6173 7320 2773 7472 273e 2c20 3330 2c20  ass 'str'>, 30, 
+0000acf0: 3330 2c20 302c 2030 2c20 5472 7565 292c  30, 0, 0, True),
+0000ad00: 2022 205c 0a20 2020 2020 2020 2020 2020   " \.           
+0000ad10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad20: 2020 2228 2741 4444 5245 5353 5f4c 494e    "('ADDRESS_LIN
+0000ad30: 4532 272c 203c 636c 6173 7320 2773 7472  E2', <class 'str
+0000ad40: 273e 2c20 3330 2c20 3330 2c20 302c 2030  '>, 30, 30, 0, 0
+0000ad50: 2c20 5472 7565 292c 2022 205c 0a20 2020  , True), " \.   
+0000ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad70: 2020 2020 2020 2020 2020 2228 2743 4954            "('CIT
+0000ad80: 5927 2c20 3c63 6c61 7373 2027 7374 7227  Y', <class 'str'
+0000ad90: 3e2c 2032 352c 2032 352c 2030 2c20 302c  >, 25, 25, 0, 0,
+0000ada0: 2054 7275 6529 2c20 2220 5c0a 2020 2020   True), " \.    
+0000adb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000adc0: 2020 2020 2020 2020 2022 2827 5354 4154           "('STAT
+0000add0: 455f 5052 4f56 494e 4345 272c 203c 636c  E_PROVINCE', <cl
+0000ade0: 6173 7320 2773 7472 273e 2c20 3135 2c20  ass 'str'>, 15, 
+0000adf0: 3135 2c20 302c 2030 2c20 5472 7565 292c  15, 0, 0, True),
+0000ae00: 2022 205c 0a20 2020 2020 2020 2020 2020   " \.           
+0000ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae20: 2020 2228 2743 4f55 4e54 5259 272c 203c    "('COUNTRY', <
+0000ae30: 636c 6173 7320 2773 7472 273e 2c20 3135  class 'str'>, 15
+0000ae40: 2c20 3135 2c20 302c 2030 2c20 5472 7565  , 15, 0, 0, True
+0000ae50: 292c 2022 205c 0a20 2020 2020 2020 2020  ), " \.         
+0000ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae70: 2020 2020 2228 2750 4f53 5441 4c5f 434f      "('POSTAL_CO
+0000ae80: 4445 272c 203c 636c 6173 7320 2773 7472  DE', <class 'str
+0000ae90: 273e 2c20 3132 2c20 3132 2c20 302c 2030  '>, 12, 12, 0, 0
+0000aea0: 2c20 5472 7565 292c 2022 205c 0a20 2020  , True), " \.   
+0000aeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aec0: 2020 2020 2020 2020 2020 2228 274f 4e5f            "('ON_
+0000aed0: 484f 4c44 272c 203c 636c 6173 7320 2773  HOLD', <class 's
+0000aee0: 7472 273e 2c20 312c 2031 2c20 302c 2030  tr'>, 1, 1, 0, 0
+0000aef0: 2c20 5472 7565 2929 2229 0a20 2020 2020  , True))").     
+0000af00: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0000af10: 7465 2827 7365 6c65 6374 202a 2066 726f  te('select * fro
+0000af20: 6d20 6a6f 6227 290a 2020 2020 2020 2020  m job').        
+0000af30: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0000af40: 7175 616c 2872 6570 7228 6375 722e 6465  qual(repr(cur.de
+0000af50: 7363 7269 7074 696f 6e29 2c0a 2020 2020  scription),.    
+0000af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af70: 2020 2020 2020 2020 2022 2828 274a 4f42           "(('JOB
+0000af80: 5f43 4f44 4527 2c20 3c63 6c61 7373 2027  _CODE', <class '
+0000af90: 7374 7227 3e2c 2035 2c20 352c 2030 2c20  str'>, 5, 5, 0, 
+0000afa0: 302c 2046 616c 7365 292c 2022 205c 0a20  0, False), " \. 
+0000afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000afc0: 2020 2020 2020 2020 2020 2020 2228 274a              "('J
+0000afd0: 4f42 5f47 5241 4445 272c 203c 636c 6173  OB_GRADE', <clas
+0000afe0: 7320 2769 6e74 273e 2c20 362c 2032 2c20  s 'int'>, 6, 2, 
+0000aff0: 302c 2030 2c20 4661 6c73 6529 2c20 2220  0, 0, False), " 
+0000b000: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0000b010: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000b020: 2827 4a4f 425f 434f 554e 5452 5927 2c20  ('JOB_COUNTRY', 
+0000b030: 3c63 6c61 7373 2027 7374 7227 3e2c 2031  <class 'str'>, 1
+0000b040: 352c 2031 352c 2030 2c20 302c 2046 616c  5, 15, 0, 0, Fal
+0000b050: 7365 292c 2022 205c 0a20 2020 2020 2020  se), " \.       
+0000b060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b070: 2020 2020 2020 2228 274a 4f42 5f54 4954        "('JOB_TIT
+0000b080: 4c45 272c 203c 636c 6173 7320 2773 7472  LE', <class 'str
+0000b090: 273e 2c20 3235 2c20 3235 2c20 302c 2030  '>, 25, 25, 0, 0
+0000b0a0: 2c20 4661 6c73 6529 2c20 2220 5c0a 2020  , False), " \.  
+0000b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0c0: 2020 2020 2020 2020 2020 2022 2827 4d49             "('MI
+0000b0d0: 4e5f 5341 4c41 5259 272c 203c 636c 6173  N_SALARY', <clas
+0000b0e0: 7320 2764 6563 696d 616c 2e44 6563 696d  s 'decimal.Decim
+0000b0f0: 616c 273e 2c20 3230 2c20 382c 2031 302c  al'>, 20, 8, 10,
+0000b100: 202d 322c 2046 616c 7365 292c 2022 205c   -2, False), " \
+0000b110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b120: 2020 2020 2020 2020 2020 2020 2020 2228                "(
+0000b130: 274d 4158 5f53 414c 4152 5927 2c20 3c63  'MAX_SALARY', <c
+0000b140: 6c61 7373 2027 6465 6369 6d61 6c2e 4465  lass 'decimal.De
+0000b150: 6369 6d61 6c27 3e2c 2032 302c 2038 2c20  cimal'>, 20, 8, 
+0000b160: 3130 2c20 2d32 2c20 4661 6c73 6529 2c20  10, -2, False), 
+0000b170: 2220 5c0a 2020 2020 2020 2020 2020 2020  " \.            
+0000b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b190: 2022 2827 4a4f 425f 5245 5155 4952 454d   "('JOB_REQUIREM
+0000b1a0: 454e 5427 2c20 3c63 6c61 7373 2027 7374  ENT', <class 'st
+0000b1b0: 7227 3e2c 2030 2c20 382c 2030 2c20 312c  r'>, 0, 8, 0, 1,
+0000b1c0: 2054 7275 6529 2c20 2220 5c0a 2020 2020   True), " \.    
+0000b1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b1e0: 2020 2020 2020 2020 2022 2827 4c41 4e47           "('LANG
+0000b1f0: 5541 4745 5f52 4551 272c 203c 636c 6173  UAGE_REQ', <clas
+0000b200: 7320 276c 6973 7427 3e2c 202d 312c 2038  s 'list'>, -1, 8
+0000b210: 2c20 302c 2030 2c20 5472 7565 2929 2229  , 0, 0, True))")
+0000b220: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+0000b230: 2e65 7865 6375 7465 2827 7365 6c65 6374  .execute('select
+0000b240: 202a 2066 726f 6d20 7072 6f6a 5f64 6570   * from proj_dep
+0000b250: 745f 6275 6467 6574 2729 0a20 2020 2020  t_budget').     
+0000b260: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000b270: 7274 4571 7561 6c28 7265 7072 2863 7572  rtEqual(repr(cur
+0000b280: 2e64 6573 6372 6970 7469 6f6e 292c 0a20  .description),. 
+0000b290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b2a0: 2020 2020 2020 2020 2020 2020 2228 2827              "(('
+0000b2b0: 4649 5343 414c 5f59 4541 5227 2c20 3c63  FISCAL_YEAR', <c
+0000b2c0: 6c61 7373 2027 696e 7427 3e2c 2031 312c  lass 'int'>, 11,
+0000b2d0: 2034 2c20 302c 2030 2c20 4661 6c73 6529   4, 0, 0, False)
+0000b2e0: 2c20 2220 5c0a 2020 2020 2020 2020 2020  , " \.          
+0000b2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b300: 2020 2022 2827 5052 4f4a 5f49 4427 2c20     "('PROJ_ID', 
+0000b310: 3c63 6c61 7373 2027 7374 7227 3e2c 2035  <class 'str'>, 5
+0000b320: 2c20 352c 2030 2c20 302c 2046 616c 7365  , 5, 0, 0, False
+0000b330: 292c 2022 205c 0a20 2020 2020 2020 2020  ), " \.         
+0000b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b350: 2020 2020 2228 2744 4550 545f 4e4f 272c      "('DEPT_NO',
+0000b360: 203c 636c 6173 7320 2773 7472 273e 2c20   <class 'str'>, 
+0000b370: 332c 2033 2c20 302c 2030 2c20 4661 6c73  3, 3, 0, 0, Fals
+0000b380: 6529 2c20 2220 5c0a 2020 2020 2020 2020  e), " \.        
+0000b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b3a0: 2020 2020 2022 2827 5155 4152 545f 4845       "('QUART_HE
+0000b3b0: 4144 5f43 4e54 272c 203c 636c 6173 7320  AD_CNT', <class 
+0000b3c0: 276c 6973 7427 3e2c 202d 312c 2038 2c20  'list'>, -1, 8, 
+0000b3d0: 302c 2030 2c20 5472 7565 292c 2022 205c  0, 0, True), " \
+0000b3e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b3f0: 2020 2020 2020 2020 2020 2020 2020 2228                "(
+0000b400: 2750 524f 4a45 4354 4544 5f42 5544 4745  'PROJECTED_BUDGE
+0000b410: 5427 2c20 3c63 6c61 7373 2027 6465 6369  T', <class 'deci
+0000b420: 6d61 6c2e 4465 6369 6d61 6c27 3e2c 2032  mal.Decimal'>, 2
+0000b430: 302c 2038 2c20 3132 2c20 2d32 2c20 5472  0, 8, 12, -2, Tr
+0000b440: 7565 2929 2229 0a20 2020 2020 2020 2023  ue))").        #
+0000b450: 2043 6865 636b 2066 6f72 2070 7265 6369   Check for preci
+0000b460: 7369 6f6e 2063 6163 6865 0a20 2020 2020  sion cache.     
+0000b470: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
+0000b480: 2e63 7572 736f 7228 2920 6173 2063 7572  .cursor() as cur
+0000b490: 323a 0a20 2020 2020 2020 2020 2020 2063  2:.            c
+0000b4a0: 7572 322e 6578 6563 7574 6528 2773 656c  ur2.execute('sel
+0000b4b0: 6563 7420 2a20 6672 6f6d 2070 726f 6a5f  ect * from proj_
+0000b4c0: 6465 7074 5f62 7564 6765 7427 290a 2020  dept_budget').  
+0000b4d0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000b4e0: 7373 6572 7445 7175 616c 2872 6570 7228  ssertEqual(repr(
+0000b4f0: 6375 7232 2e64 6573 6372 6970 7469 6f6e  cur2.description
+0000b500: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000b510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b520: 2228 2827 4649 5343 414c 5f59 4541 5227  "(('FISCAL_YEAR'
+0000b530: 2c20 3c63 6c61 7373 2027 696e 7427 3e2c  , <class 'int'>,
+0000b540: 2031 312c 2034 2c20 302c 2030 2c20 4661   11, 4, 0, 0, Fa
+0000b550: 6c73 6529 2c20 2220 5c0a 2020 2020 2020  lse), " \.      
+0000b560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b570: 2020 2020 2020 2022 2827 5052 4f4a 5f49         "('PROJ_I
+0000b580: 4427 2c20 3c63 6c61 7373 2027 7374 7227  D', <class 'str'
+0000b590: 3e2c 2035 2c20 352c 2030 2c20 302c 2046  >, 5, 5, 0, 0, F
+0000b5a0: 616c 7365 292c 2022 205c 0a20 2020 2020  alse), " \.     
+0000b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b5c0: 2020 2020 2020 2020 2228 2744 4550 545f          "('DEPT_
+0000b5d0: 4e4f 272c 203c 636c 6173 7320 2773 7472  NO', <class 'str
+0000b5e0: 273e 2c20 332c 2033 2c20 302c 2030 2c20  '>, 3, 3, 0, 0, 
+0000b5f0: 4661 6c73 6529 2c20 2220 5c0a 2020 2020  False), " \.    
+0000b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b610: 2020 2020 2020 2020 2022 2827 5155 4152           "('QUAR
+0000b620: 545f 4845 4144 5f43 4e54 272c 203c 636c  T_HEAD_CNT', <cl
+0000b630: 6173 7320 276c 6973 7427 3e2c 202d 312c  ass 'list'>, -1,
+0000b640: 2038 2c20 302c 2030 2c20 5472 7565 292c   8, 0, 0, True),
+0000b650: 2022 205c 0a20 2020 2020 2020 2020 2020   " \.           
+0000b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b670: 2020 2228 2750 524f 4a45 4354 4544 5f42    "('PROJECTED_B
+0000b680: 5544 4745 5427 2c20 3c63 6c61 7373 2027  UDGET', <class '
+0000b690: 6465 6369 6d61 6c2e 4465 6369 6d61 6c27  decimal.Decimal'
+0000b6a0: 3e2c 2032 302c 2038 2c20 3132 2c20 2d32  >, 20, 8, 12, -2
+0000b6b0: 2c20 5472 7565 2929 2229 0a20 2020 2064  , True))").    d
+0000b6c0: 6566 2074 6573 745f 6578 6563 5f61 6674  ef test_exec_aft
+0000b6d0: 6572 5f63 6c6f 7365 2873 656c 6629 3a0a  er_close(self):.
+0000b6e0: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
+0000b6f0: 662e 636f 6e2e 6375 7273 6f72 2829 2061  f.con.cursor() a
+0000b700: 7320 6375 723a 0a20 2020 2020 2020 2020  s cur:.         
+0000b710: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
+0000b720: 7365 6c65 6374 202a 2066 726f 6d20 636f  select * from co
+0000b730: 756e 7472 7927 290a 2020 2020 2020 2020  untry').        
+0000b740: 2020 2020 726f 7720 3d20 6375 722e 6665      row = cur.fe
+0000b750: 7463 686f 6e65 2829 0a20 2020 2020 2020  tchone().       
+0000b760: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000b770: 5475 706c 6545 7175 616c 2872 6f77 2c20  TupleEqual(row, 
+0000b780: 2827 5553 4127 2c20 2744 6f6c 6c61 7227  ('USA', 'Dollar'
+0000b790: 2929 0a20 2020 2020 2020 2020 2020 2063  )).            c
+0000b7a0: 7572 2e63 6c6f 7365 2829 0a20 2020 2020  ur.close().     
+0000b7b0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0000b7c0: 7465 2827 7365 6c65 6374 202a 2066 726f  te('select * fro
+0000b7d0: 6d20 636f 756e 7472 7927 290a 2020 2020  m country').    
+0000b7e0: 2020 2020 2020 2020 726f 7720 3d20 6375          row = cu
+0000b7f0: 722e 6665 7463 686f 6e65 2829 0a20 2020  r.fetchone().   
+0000b800: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0000b810: 7365 7274 5475 706c 6545 7175 616c 2872  sertTupleEqual(r
+0000b820: 6f77 2c20 2827 5553 4127 2c20 2744 6f6c  ow, ('USA', 'Dol
+0000b830: 6c61 7227 2929 0a20 2020 2064 6566 2074  lar')).    def t
+0000b840: 6573 745f 6665 7463 686f 6e65 2873 656c  est_fetchone(sel
+0000b850: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
+0000b860: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
+0000b870: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
+0000b880: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0000b890: 7465 2827 7365 6c65 6374 202a 2066 726f  te('select * fro
+0000b8a0: 6d20 636f 756e 7472 7927 290a 2020 2020  m country').    
+0000b8b0: 2020 2020 2020 2020 726f 7720 3d20 6375          row = cu
+0000b8c0: 722e 6665 7463 686f 6e65 2829 0a20 2020  r.fetchone().   
+0000b8d0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0000b8e0: 7365 7274 5475 706c 6545 7175 616c 2872  sertTupleEqual(r
+0000b8f0: 6f77 2c20 2827 5553 4127 2c20 2744 6f6c  ow, ('USA', 'Dol
+0000b900: 6c61 7227 2929 0a20 2020 2064 6566 2074  lar')).    def t
+0000b910: 6573 745f 6665 7463 6861 6c6c 2873 656c  est_fetchall(sel
+0000b920: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
+0000b930: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
+0000b940: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
+0000b950: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0000b960: 7465 2827 7365 6c65 6374 202a 2066 726f  te('select * fro
+0000b970: 6d20 636f 756e 7472 7927 290a 2020 2020  m country').    
+0000b980: 2020 2020 2020 2020 726f 7773 203d 2063          rows = c
+0000b990: 7572 2e66 6574 6368 616c 6c28 290a 2020  ur.fetchall().  
+0000b9a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000b9b0: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
+0000b9c0: 6f77 732c 0a20 2020 2020 2020 2020 2020  ows,.           
+0000b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b9e0: 2020 2020 2020 5b28 2755 5341 272c 2027        [('USA', '
+0000b9f0: 446f 6c6c 6172 2729 2c20 2827 456e 676c  Dollar'), ('Engl
+0000ba00: 616e 6427 2c20 2750 6f75 6e64 2729 2c20  and', 'Pound'), 
+0000ba10: 2827 4361 6e61 6461 272c 2027 4364 6e44  ('Canada', 'CdnD
+0000ba20: 6c72 2729 2c0a 2020 2020 2020 2020 2020  lr'),.          
+0000ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba40: 2020 2020 2020 2020 2827 5377 6974 7a65          ('Switze
+0000ba50: 726c 616e 6427 2c20 2753 4672 616e 6327  rland', 'SFranc'
+0000ba60: 292c 2028 274a 6170 616e 272c 2027 5965  ), ('Japan', 'Ye
+0000ba70: 6e27 292c 2028 2749 7461 6c79 272c 2027  n'), ('Italy', '
+0000ba80: 4575 726f 2729 2c0a 2020 2020 2020 2020  Euro'),.        
+0000ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000baa0: 2020 2020 2020 2020 2020 2827 4672 616e            ('Fran
+0000bab0: 6365 272c 2027 4575 726f 2729 2c20 2827  ce', 'Euro'), ('
+0000bac0: 4765 726d 616e 7927 2c20 2745 7572 6f27  Germany', 'Euro'
+0000bad0: 292c 2028 2741 7573 7472 616c 6961 272c  ), ('Australia',
+0000bae0: 2027 4144 6f6c 6c61 7227 292c 0a20 2020   'ADollar'),.   
+0000baf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bb00: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0000bb10: 2748 6f6e 6720 4b6f 6e67 272c 2027 484b  'Hong Kong', 'HK
+0000bb20: 446f 6c6c 6172 2729 2c20 2827 4e65 7468  Dollar'), ('Neth
+0000bb30: 6572 6c61 6e64 7327 2c20 2745 7572 6f27  erlands', 'Euro'
+0000bb40: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bb60: 2020 2020 2028 2742 656c 6769 756d 272c       ('Belgium',
+0000bb70: 2027 4575 726f 2729 2c20 2827 4175 7374   'Euro'), ('Aust
+0000bb80: 7269 6127 2c20 2745 7572 6f27 292c 2028  ria', 'Euro'), (
+0000bb90: 2746 696a 6927 2c20 2746 446f 6c6c 6172  'Fiji', 'FDollar
+0000bba0: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+0000bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bbc0: 2020 2020 2020 2827 5275 7373 6961 272c        ('Russia',
+0000bbd0: 2027 5275 626c 6527 292c 2028 2752 6f6d   'Ruble'), ('Rom
+0000bbe0: 616e 6961 272c 2027 524c 6575 2729 5d29  ania', 'RLeu')])
+0000bbf0: 0a20 2020 2064 6566 2074 6573 745f 6665  .    def test_fe
+0000bc00: 7463 686d 616e 7928 7365 6c66 293a 0a20  tchmany(self):. 
+0000bc10: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
+0000bc20: 2e63 6f6e 2e63 7572 736f 7228 2920 6173  .con.cursor() as
+0000bc30: 2063 7572 3a0a 2020 2020 2020 2020 2020   cur:.          
+0000bc40: 2020 6375 722e 6578 6563 7574 6528 2773    cur.execute('s
+0000bc50: 656c 6563 7420 2a20 6672 6f6d 2063 6f75  elect * from cou
+0000bc60: 6e74 7279 2729 0a20 2020 2020 2020 2020  ntry').         
+0000bc70: 2020 2072 6f77 7320 3d20 6375 722e 6665     rows = cur.fe
+0000bc80: 7463 686d 616e 7928 3130 290a 2020 2020  tchmany(10).    
+0000bc90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000bca0: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
+0000bcb0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0000bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bcd0: 2020 2020 5b28 2755 5341 272c 2027 446f      [('USA', 'Do
+0000bce0: 6c6c 6172 2729 2c20 2827 456e 676c 616e  llar'), ('Englan
+0000bcf0: 6427 2c20 2750 6f75 6e64 2729 2c20 2827  d', 'Pound'), ('
+0000bd00: 4361 6e61 6461 272c 2027 4364 6e44 6c72  Canada', 'CdnDlr
+0000bd10: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+0000bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bd30: 2020 2020 2020 2827 5377 6974 7a65 726c        ('Switzerl
+0000bd40: 616e 6427 2c20 2753 4672 616e 6327 292c  and', 'SFranc'),
+0000bd50: 2028 274a 6170 616e 272c 2027 5965 6e27   ('Japan', 'Yen'
+0000bd60: 292c 2028 2749 7461 6c79 272c 2027 4575  ), ('Italy', 'Eu
+0000bd70: 726f 2729 2c0a 2020 2020 2020 2020 2020  ro'),.          
+0000bd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bd90: 2020 2020 2020 2020 2827 4672 616e 6365          ('France
+0000bda0: 272c 2027 4575 726f 2729 2c20 2827 4765  ', 'Euro'), ('Ge
+0000bdb0: 726d 616e 7927 2c20 2745 7572 6f27 292c  rmany', 'Euro'),
+0000bdc0: 2028 2741 7573 7472 616c 6961 272c 2027   ('Australia', '
+0000bdd0: 4144 6f6c 6c61 7227 292c 0a20 2020 2020  ADollar'),.     
 0000bde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bdf0: 2020 2020 2020 2020 205b 2827 4e65 7468           [('Neth
-0000be00: 6572 6c61 6e64 7327 2c20 2745 7572 6f27  erlands', 'Euro'
-0000be10: 292c 2028 2742 656c 6769 756d 272c 2027  ), ('Belgium', '
-0000be20: 4575 726f 2729 2c20 2827 4175 7374 7269  Euro'), ('Austri
-0000be30: 6127 2c20 2745 7572 6f27 292c 0a20 2020  a', 'Euro'),.   
-0000be40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be50: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0000be60: 2746 696a 6927 2c20 2746 446f 6c6c 6172  'Fiji', 'FDollar
-0000be70: 2729 2c20 2827 5275 7373 6961 272c 2027  '), ('Russia', '
-0000be80: 5275 626c 6527 292c 2028 2752 6f6d 616e  Ruble'), ('Roman
-0000be90: 6961 272c 2027 524c 6575 2729 5d29 0a20  ia', 'RLeu')]). 
-0000bea0: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
-0000beb0: 3d20 6375 722e 6665 7463 686d 616e 7928  = cur.fetchmany(
-0000bec0: 3130 290a 2020 2020 2020 2020 2020 2020  10).            
-0000bed0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000bee0: 286c 656e 2872 6f77 7329 2c20 3029 0a20  (len(rows), 0). 
-0000bef0: 2020 2064 6566 2074 6573 745f 6166 6665     def test_affe
-0000bf00: 6374 6564 5f72 6f77 7328 7365 6c66 293a  cted_rows(self):
-0000bf10: 0a20 2020 2020 2020 2077 6974 6820 7365  .        with se
-0000bf20: 6c66 2e63 6f6e 2e63 7572 736f 7228 2920  lf.con.cursor() 
-0000bf30: 6173 2063 7572 3a0a 2020 2020 2020 2020  as cur:.        
-0000bf40: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0000bf50: 7175 616c 2863 7572 2e61 6666 6563 7465  qual(cur.affecte
-0000bf60: 645f 726f 7773 2c20 2d31 290a 2020 2020  d_rows, -1).    
-0000bf70: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-0000bf80: 7574 6528 2773 656c 6563 7420 2a20 6672  ute('select * fr
-0000bf90: 6f6d 2070 726f 6a65 6374 2729 0a20 2020  om project').   
-0000bfa0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000bfb0: 7365 7274 4571 7561 6c28 6375 722e 6166  sertEqual(cur.af
-0000bfc0: 6665 6374 6564 5f72 6f77 732c 2030 290a  fected_rows, 0).
-0000bfd0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-0000bfe0: 6665 7463 686f 6e65 2829 0a20 2020 2020  fetchone().     
-0000bff0: 2020 2020 2020 2069 6620 7379 732e 706c         if sys.pl
-0000c000: 6174 666f 726d 203d 3d20 2777 696e 3332  atform == 'win32
-0000c010: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-0000c020: 2020 2072 636f 756e 7420 3d20 360a 2020     rcount = 6.  
-0000c030: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c050: 7263 6f75 6e74 203d 2031 0a20 2020 2020  rcount = 1.     
-0000c060: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000c070: 7274 4571 7561 6c28 6375 722e 6166 6665  rtEqual(cur.affe
-0000c080: 6374 6564 5f72 6f77 732c 2072 636f 756e  cted_rows, rcoun
-0000c090: 7429 0a20 2020 2020 2020 2020 2020 2073  t).            s
-0000c0a0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000c0b0: 6375 722e 726f 7763 6f75 6e74 2c20 7263  cur.rowcount, rc
-0000c0c0: 6f75 6e74 290a 2020 2020 6465 6620 7465  ount).    def te
-0000c0d0: 7374 5f6e 616d 6528 7365 6c66 293a 0a20  st_name(self):. 
-0000c0e0: 2020 2020 2020 2064 6566 2061 7373 6967         def assig
-0000c0f0: 6e5f 6e61 6d65 2829 3a0a 2020 2020 2020  n_name():.      
-0000c100: 2020 2020 2020 6375 722e 7365 745f 6375        cur.set_cu
-0000c110: 7273 6f72 5f6e 616d 6528 2774 6573 7478  rsor_name('testx
-0000c120: 2729 0a20 2020 2020 2020 2077 6974 6820  ').        with 
-0000c130: 7365 6c66 2e63 6f6e 2e63 7572 736f 7228  self.con.cursor(
-0000c140: 2920 6173 2063 7572 3a0a 2020 2020 2020  ) as cur:.      
-0000c150: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000c160: 7449 734e 6f6e 6528 6375 722e 6e61 6d65  tIsNone(cur.name
-0000c170: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000c180: 6c66 2e61 7373 6572 7452 6169 7365 7328  lf.assertRaises(
-0000c190: 496e 7465 7266 6163 6545 7272 6f72 2c20  InterfaceError, 
-0000c1a0: 6173 7369 676e 5f6e 616d 6529 0a20 2020  assign_name).   
-0000c1b0: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-0000c1c0: 6375 7465 2827 7365 6c65 6374 202a 2066  cute('select * f
-0000c1d0: 726f 6d20 636f 756e 7472 7927 290a 2020  rom country').  
-0000c1e0: 2020 2020 2020 2020 2020 6375 722e 7365            cur.se
-0000c1f0: 745f 6375 7273 6f72 5f6e 616d 6528 2774  t_cursor_name('t
-0000c200: 6573 7427 290a 2020 2020 2020 2020 2020  est').          
-0000c210: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000c220: 616c 2863 7572 2e6e 616d 652c 2027 7465  al(cur.name, 'te
-0000c230: 7374 2729 0a20 2020 2020 2020 2020 2020  st').           
-0000c240: 2073 656c 662e 6173 7365 7274 5261 6973   self.assertRais
-0000c250: 6573 2849 6e74 6572 6661 6365 4572 726f  es(InterfaceErro
-0000c260: 722c 2061 7373 6967 6e5f 6e61 6d65 290a  r, assign_name).
-0000c270: 2020 2020 6465 6620 7465 7374 5f75 7365      def test_use
-0000c280: 5f61 6674 6572 5f63 6c6f 7365 2873 656c  _after_close(sel
-0000c290: 6629 3a0a 2020 2020 2020 2020 636d 6420  f):.        cmd 
-0000c2a0: 3d20 2773 656c 6563 7420 2a20 6672 6f6d  = 'select * from
-0000c2b0: 2063 6f75 6e74 7279 270a 2020 2020 2020   country'.      
-0000c2c0: 2020 7769 7468 2073 656c 662e 636f 6e2e    with self.con.
-0000c2d0: 6375 7273 6f72 2829 2061 7320 6375 723a  cursor() as cur:
-0000c2e0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0000c2f0: 2e65 7865 6375 7465 2863 6d64 290a 2020  .execute(cmd).  
-0000c300: 2020 2020 2020 2020 2020 6375 722e 636c            cur.cl
-0000c310: 6f73 6528 290a 2020 2020 2020 2020 2020  ose().          
-0000c320: 2020 7769 7468 2073 656c 662e 6173 7365    with self.asse
-0000c330: 7274 5261 6973 6573 2849 6e74 6572 6661  rtRaises(Interfa
-0000c340: 6365 4572 726f 7229 2061 7320 636d 3a0a  ceError) as cm:.
-0000c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c360: 6375 722e 6665 7463 686f 6e65 2829 0a20  cur.fetchone(). 
-0000c370: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000c380: 6173 7365 7274 5475 706c 6545 7175 616c  assertTupleEqual
-0000c390: 2863 6d2e 6578 6365 7074 696f 6e2e 6172  (cm.exception.ar
-0000c3a0: 6773 2c20 2827 4361 6e6e 6f74 2066 6574  gs, ('Cannot fet
-0000c3b0: 6368 2066 726f 6d20 6375 7273 6f72 2074  ch from cursor t
-0000c3c0: 6861 7420 6469 6420 6e6f 7420 6578 6563  hat did not exec
-0000c3d0: 7574 6564 2061 2073 7461 7465 6d65 6e74  uted a statement
-0000c3e0: 2e27 2c29 290a 2020 2020 6465 6620 746f  .',)).    def to
-0000c3f0: 5f64 6963 7428 7365 6c66 293a 0a20 2020  _dict(self):.   
-0000c400: 2020 2020 2063 6d64 203d 2027 7365 6c65       cmd = 'sele
-0000c410: 6374 202a 2066 726f 6d20 636f 756e 7472  ct * from countr
-0000c420: 7927 0a20 2020 2020 2020 2073 616d 706c  y'.        sampl
-0000c430: 6520 3d20 7b27 434f 554e 5452 5927 3a20  e = {'COUNTRY': 
-0000c440: 2755 5341 272c 2027 4355 5252 454e 4359  'USA', 'CURRENCY
-0000c450: 273a 2027 446f 6c6c 6172 277d 0a20 2020  ': 'Dollar'}.   
-0000c460: 2020 2020 2077 6974 6820 7365 6c66 2e63       with self.c
-0000c470: 6f6e 2e63 7572 736f 7228 2920 6173 2063  on.cursor() as c
-0000c480: 7572 3a0a 2020 2020 2020 2020 2020 2020  ur:.            
-0000c490: 6375 722e 6578 6563 7574 6528 636d 6429  cur.execute(cmd)
-0000c4a0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-0000c4b0: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-0000c4c0: 290a 2020 2020 2020 2020 2020 2020 6420  ).            d 
-0000c4d0: 3d20 6375 722e 746f 5f64 6963 7428 726f  = cur.to_dict(ro
-0000c4e0: 7729 0a20 2020 2020 2020 2020 2020 2073  w).            s
-0000c4f0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000c500: 6c65 6e28 6429 2c20 3229 0a20 2020 2020  len(d), 2).     
-0000c510: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000c520: 7274 4469 6374 4571 7561 6c28 642c 2073  rtDictEqual(d, s
-0000c530: 616d 706c 6529 0a20 2020 2020 2020 2020  ample).         
-0000c540: 2020 2064 203d 207b 2743 4f55 4e54 5259     d = {'COUNTRY
-0000c550: 273a 2027 554e 4b4e 4f57 4e27 2c20 2743  ': 'UNKNOWN', 'C
-0000c560: 5552 5245 4e43 5927 3a20 2755 4e4b 4e4f  URRENCY': 'UNKNO
-0000c570: 574e 277d 0a20 2020 2020 2020 2020 2020  WN'}.           
-0000c580: 2064 3220 3d20 6375 722e 746f 5f64 6963   d2 = cur.to_dic
-0000c590: 7428 726f 772c 2064 290a 2020 2020 2020  t(row, d).      
-0000c5a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000c5b0: 7444 6963 7445 7175 616c 2864 322c 2073  tDictEqual(d2, s
-0000c5c0: 616d 706c 6529 0a20 2020 2020 2020 2020  ample).         
-0000c5d0: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
-0000c5e0: 2864 2c20 6432 290a 2020 2020 2020 2020  (d, d2).        
-0000c5f0: 2020 2020 7769 7468 2073 656c 662e 6173      with self.as
-0000c600: 7365 7274 5261 6973 6573 2841 7373 6572  sertRaises(Asser
-0000c610: 7469 6f6e 4572 726f 7229 2061 7320 636d  tionError) as cm
-0000c620: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000c630: 2020 6375 722e 746f 5f64 6963 7428 5b31    cur.to_dict([1
-0000c640: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-0000c650: 2020 2063 7572 2e74 6f5f 6469 6374 285b     cur.to_dict([
-0000c660: 312c 2032 2c20 335d 290a 2020 2020 2020  1, 2, 3]).      
-0000c670: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000c680: 7454 7570 6c65 4571 7561 6c28 636d 2e65  tTupleEqual(cm.e
-0000c690: 7863 6570 7469 6f6e 2e61 7267 732c 2028  xception.args, (
-0000c6a0: 274c 656e 6774 6820 6f66 2064 6174 6120  'Length of data 
-0000c6b0: 6d75 7374 206d 6174 6368 206e 756d 6265  must match numbe
-0000c6c0: 7220 6f66 2066 6965 6c64 7327 2c29 290a  r of fields',)).
-0000c6d0: 0a0a 636c 6173 7320 5465 7374 5363 726f  ..class TestScro
-0000c6e0: 6c6c 6162 6c65 4375 7273 6f72 2844 7269  llableCursor(Dri
-0000c6f0: 7665 7254 6573 7442 6173 6529 3a0a 2020  verTestBase):.  
-0000c700: 2020 6465 6620 7365 7455 7028 7365 6c66    def setUp(self
-0000c710: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
-0000c720: 2829 2e73 6574 5570 2829 0a20 2020 2020  ().setUp().     
-0000c730: 2020 2073 656c 662e 6462 6669 6c65 203d     self.dbfile =
-0000c740: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
-0000c750: 6c66 2e64 6270 6174 682c 2073 656c 662e  lf.dbpath, self.
-0000c760: 4642 5445 5354 5f44 4229 0a20 2020 2020  FBTEST_DB).     
-0000c770: 2020 2073 656c 662e 636f 6e20 3d20 636f     self.con = co
-0000c780: 6e6e 6563 7428 6461 7461 6261 7365 3d73  nnect(database=s
-0000c790: 656c 662e 6462 6669 6c65 2c0a 2020 2020  elf.dbfile,.    
-0000c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7b0: 2020 2020 2020 2075 7365 723d 4642 5445         user=FBTE
-0000c7c0: 5354 5f55 5345 522c 2070 6173 7377 6f72  ST_USER, passwor
-0000c7d0: 643d 4642 5445 5354 5f50 4153 5357 4f52  d=FBTEST_PASSWOR
-0000c7e0: 4429 0a20 2020 2020 2020 2073 656c 662e  D).        self.
-0000c7f0: 636f 6e2e 5f6c 6f67 6769 6e67 5f69 645f  con._logging_id_
-0000c800: 203d 2073 656c 662e 5f5f 636c 6173 735f   = self.__class_
-0000c810: 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020 2020  _.__name__.     
-0000c820: 2020 2023 7365 6c66 2e63 6f6e 2e65 7865     #self.con.exe
-0000c830: 6375 7465 5f69 6d6d 6564 6961 7465 2822  cute_immediate("
-0000c840: 7265 6372 6561 7465 2074 6162 6c65 2074  recreate table t
-0000c850: 2028 6331 2069 6e74 6567 6572 2070 7269   (c1 integer pri
-0000c860: 6d61 7279 206b 6579 2922 290a 2020 2020  mary key)").    
-0000c870: 2020 2020 2373 656c 662e 636f 6e2e 6578      #self.con.ex
-0000c880: 6563 7574 655f 696d 6d65 6469 6174 6528  ecute_immediate(
-0000c890: 2264 656c 6574 6520 6672 6f6d 2074 2229  "delete from t")
-0000c8a0: 0a20 2020 2020 2020 2023 7365 6c66 2e63  .        #self.c
-0000c8b0: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
-0000c8c0: 6465 6620 7465 6172 446f 776e 2873 656c  def tearDown(sel
-0000c8d0: 6629 3a0a 2020 2020 2020 2020 7365 6c66  f):.        self
-0000c8e0: 2e63 6f6e 2e63 6c6f 7365 2829 0a20 2020  .con.close().   
-0000c8f0: 2064 6566 2074 6573 745f 7363 726f 6c6c   def test_scroll
-0000c900: 6162 6c65 2873 656c 6629 3a0a 2020 2020  able(self):.    
-0000c910: 2020 2020 6966 2073 7973 2e70 6c61 7466      if sys.platf
-0000c920: 6f72 6d20 3d3d 2027 7769 6e33 3227 3a0a  orm == 'win32':.
-0000c930: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000c940: 2e73 6b69 7054 6573 7428 2744 6f65 7320  .skipTest('Does 
-0000c950: 6e6f 7420 776f 726b 206f 6e20 5769 6e64  not work on Wind
-0000c960: 6f77 7327 290a 2020 2020 2020 2020 726f  ows').        ro
-0000c970: 7773 203d 205b 2827 5553 4127 2c20 2744  ws = [('USA', 'D
-0000c980: 6f6c 6c61 7227 292c 2028 2745 6e67 6c61  ollar'), ('Engla
-0000c990: 6e64 272c 2027 506f 756e 6427 292c 2028  nd', 'Pound'), (
-0000c9a0: 2743 616e 6164 6127 2c20 2743 646e 446c  'Canada', 'CdnDl
-0000c9b0: 7227 292c 0a20 2020 2020 2020 2020 2020  r'),.           
-0000c9c0: 2020 2020 2028 2753 7769 747a 6572 6c61       ('Switzerla
-0000c9d0: 6e64 272c 2027 5346 7261 6e63 2729 2c20  nd', 'SFranc'), 
-0000c9e0: 2827 4a61 7061 6e27 2c20 2759 656e 2729  ('Japan', 'Yen')
-0000c9f0: 2c20 2827 4974 616c 7927 2c20 2745 7572  , ('Italy', 'Eur
-0000ca00: 6f27 292c 0a20 2020 2020 2020 2020 2020  o'),.           
-0000ca10: 2020 2020 2028 2746 7261 6e63 6527 2c20       ('France', 
-0000ca20: 2745 7572 6f27 292c 2028 2747 6572 6d61  'Euro'), ('Germa
-0000ca30: 6e79 272c 2027 4575 726f 2729 2c20 2827  ny', 'Euro'), ('
-0000ca40: 4175 7374 7261 6c69 6127 2c20 2741 446f  Australia', 'ADo
-0000ca50: 6c6c 6172 2729 2c0a 2020 2020 2020 2020  llar'),.        
-0000ca60: 2020 2020 2020 2020 2827 486f 6e67 204b          ('Hong K
-0000ca70: 6f6e 6727 2c20 2748 4b44 6f6c 6c61 7227  ong', 'HKDollar'
-0000ca80: 292c 2028 274e 6574 6865 726c 616e 6473  ), ('Netherlands
-0000ca90: 272c 2027 4575 726f 2729 2c0a 2020 2020  ', 'Euro'),.    
-0000caa0: 2020 2020 2020 2020 2020 2020 2827 4265              ('Be
-0000cab0: 6c67 6975 6d27 2c20 2745 7572 6f27 292c  lgium', 'Euro'),
-0000cac0: 2028 2741 7573 7472 6961 272c 2027 4575   ('Austria', 'Eu
-0000cad0: 726f 2729 2c20 2827 4669 6a69 272c 2027  ro'), ('Fiji', '
-0000cae0: 4644 6f6c 6c61 7227 292c 0a20 2020 2020  FDollar'),.     
-0000caf0: 2020 2020 2020 2020 2020 2028 2752 7573             ('Rus
-0000cb00: 7369 6127 2c20 2752 7562 6c65 2729 2c20  sia', 'Ruble'), 
-0000cb10: 2827 526f 6d61 6e69 6127 2c20 2752 4c65  ('Romania', 'RLe
-0000cb20: 7527 295d 0a20 2020 2020 2020 2077 6974  u')].        wit
-0000cb30: 6820 7365 6c66 2e63 6f6e 2e63 7572 736f  h self.con.curso
-0000cb40: 7228 2920 6173 2063 7572 3a0a 2020 2020  r() as cur:.    
-0000cb50: 2020 2020 2020 2020 6375 722e 6f70 656e          cur.open
-0000cb60: 2827 7365 6c65 6374 202a 2066 726f 6d20  ('select * from 
-0000cb70: 636f 756e 7472 7927 290a 2020 2020 2020  country').      
-0000cb80: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000cb90: 7454 7275 6528 6375 722e 6973 5f62 6f66  tTrue(cur.is_bof
-0000cba0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-0000cbb0: 7365 6c66 2e61 7373 6572 7446 616c 7365  self.assertFalse
-0000cbc0: 2863 7572 2e69 735f 656f 6628 2929 0a20  (cur.is_eof()). 
-0000cbd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000cbe0: 6173 7365 7274 5475 706c 6545 7175 616c  assertTupleEqual
-0000cbf0: 2863 7572 2e66 6574 6368 5f66 6972 7374  (cur.fetch_first
-0000cc00: 2829 2c20 726f 7773 5b30 5d29 0a20 2020  (), rows[0]).   
-0000cc10: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000cc20: 7365 7274 5475 706c 6545 7175 616c 2863  sertTupleEqual(c
-0000cc30: 7572 2e66 6574 6368 5f6e 6578 7428 292c  ur.fetch_next(),
-0000cc40: 2072 6f77 735b 315d 290a 2020 2020 2020   rows[1]).      
-0000cc50: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000cc60: 7454 7570 6c65 4571 7561 6c28 6375 722e  tTupleEqual(cur.
-0000cc70: 6665 7463 685f 7072 696f 7228 292c 2072  fetch_prior(), r
-0000cc80: 6f77 735b 305d 290a 2020 2020 2020 2020  ows[0]).        
-0000cc90: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-0000cca0: 7570 6c65 4571 7561 6c28 6375 722e 6665  upleEqual(cur.fe
-0000ccb0: 7463 685f 6c61 7374 2829 2c20 726f 7773  tch_last(), rows
-0000ccc0: 5b2d 315d 290a 2020 2020 2020 2020 2020  [-1]).          
-0000ccd0: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
-0000cce0: 7365 2863 7572 2e69 735f 626f 6628 2929  se(cur.is_bof())
-0000ccf0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000cd00: 662e 6173 7365 7274 4973 4e6f 6e65 2863  f.assertIsNone(c
-0000cd10: 7572 2e66 6574 6368 5f6e 6578 7428 2929  ur.fetch_next())
-0000cd20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000cd30: 662e 6173 7365 7274 5472 7565 2863 7572  f.assertTrue(cur
-0000cd40: 2e69 735f 656f 6628 2929 0a20 2020 2020  .is_eof()).     
+0000bdf0: 2020 2020 2020 2020 2020 2020 2028 2748               ('H
+0000be00: 6f6e 6720 4b6f 6e67 272c 2027 484b 446f  ong Kong', 'HKDo
+0000be10: 6c6c 6172 2729 5d29 0a20 2020 2020 2020  llar')]).       
+0000be20: 2020 2020 2072 6f77 7320 3d20 6375 722e       rows = cur.
+0000be30: 6665 7463 686d 616e 7928 3130 290a 2020  fetchmany(10).  
+0000be40: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000be50: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
+0000be60: 6f77 732c 0a20 2020 2020 2020 2020 2020  ows,.           
+0000be70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000be80: 2020 2020 2020 5b28 274e 6574 6865 726c        [('Netherl
+0000be90: 616e 6473 272c 2027 4575 726f 2729 2c20  ands', 'Euro'), 
+0000bea0: 2827 4265 6c67 6975 6d27 2c20 2745 7572  ('Belgium', 'Eur
+0000beb0: 6f27 292c 2028 2741 7573 7472 6961 272c  o'), ('Austria',
+0000bec0: 2027 4575 726f 2729 2c0a 2020 2020 2020   'Euro'),.      
+0000bed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bee0: 2020 2020 2020 2020 2020 2020 2827 4669              ('Fi
+0000bef0: 6a69 272c 2027 4644 6f6c 6c61 7227 292c  ji', 'FDollar'),
+0000bf00: 2028 2752 7573 7369 6127 2c20 2752 7562   ('Russia', 'Rub
+0000bf10: 6c65 2729 2c20 2827 526f 6d61 6e69 6127  le'), ('Romania'
+0000bf20: 2c20 2752 4c65 7527 295d 290a 2020 2020  , 'RLeu')]).    
+0000bf30: 2020 2020 2020 2020 726f 7773 203d 2063          rows = c
+0000bf40: 7572 2e66 6574 6368 6d61 6e79 2831 3029  ur.fetchmany(10)
+0000bf50: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000bf60: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
+0000bf70: 6e28 726f 7773 292c 2030 290a 2020 2020  n(rows), 0).    
+0000bf80: 6465 6620 7465 7374 5f61 6666 6563 7465  def test_affecte
+0000bf90: 645f 726f 7773 2873 656c 6629 3a0a 2020  d_rows(self):.  
+0000bfa0: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
+0000bfb0: 636f 6e2e 6375 7273 6f72 2829 2061 7320  con.cursor() as 
+0000bfc0: 6375 723a 0a20 2020 2020 2020 2020 2020  cur:.           
+0000bfd0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000bfe0: 6c28 6375 722e 6166 6665 6374 6564 5f72  l(cur.affected_r
+0000bff0: 6f77 732c 202d 3129 0a20 2020 2020 2020  ows, -1).       
+0000c000: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+0000c010: 2827 7365 6c65 6374 202a 2066 726f 6d20  ('select * from 
+0000c020: 7072 6f6a 6563 7427 290a 2020 2020 2020  project').      
+0000c030: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000c040: 7445 7175 616c 2863 7572 2e61 6666 6563  tEqual(cur.affec
+0000c050: 7465 645f 726f 7773 2c20 3029 0a20 2020  ted_rows, 0).   
+0000c060: 2020 2020 2020 2020 2063 7572 2e66 6574           cur.fet
+0000c070: 6368 6f6e 6528 290a 2020 2020 2020 2020  chone().        
+0000c080: 2020 2020 6966 2073 7973 2e70 6c61 7466      if sys.platf
+0000c090: 6f72 6d20 3d3d 2027 7769 6e33 3227 3a0a  orm == 'win32':.
+0000c0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c0b0: 7263 6f75 6e74 203d 2036 0a20 2020 2020  rcount = 6.     
+0000c0c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000c0d0: 2020 2020 2020 2020 2020 2020 2072 636f               rco
+0000c0e0: 756e 7420 3d20 310a 2020 2020 2020 2020  unt = 1.        
+0000c0f0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0000c100: 7175 616c 2863 7572 2e61 6666 6563 7465  qual(cur.affecte
+0000c110: 645f 726f 7773 2c20 7263 6f75 6e74 290a  d_rows, rcount).
+0000c120: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000c130: 2e61 7373 6572 7445 7175 616c 2863 7572  .assertEqual(cur
+0000c140: 2e72 6f77 636f 756e 742c 2072 636f 756e  .rowcount, rcoun
+0000c150: 7429 0a20 2020 2064 6566 2074 6573 745f  t).    def test_
+0000c160: 6e61 6d65 2873 656c 6629 3a0a 2020 2020  name(self):.    
+0000c170: 2020 2020 6465 6620 6173 7369 676e 5f6e      def assign_n
+0000c180: 616d 6528 293a 0a20 2020 2020 2020 2020  ame():.         
+0000c190: 2020 2063 7572 2e73 6574 5f63 7572 736f     cur.set_curso
+0000c1a0: 725f 6e61 6d65 2827 7465 7374 7827 290a  r_name('testx').
+0000c1b0: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
+0000c1c0: 662e 636f 6e2e 6375 7273 6f72 2829 2061  f.con.cursor() a
+0000c1d0: 7320 6375 723a 0a20 2020 2020 2020 2020  s cur:.         
+0000c1e0: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+0000c1f0: 4e6f 6e65 2863 7572 2e6e 616d 6529 0a20  None(cur.name). 
+0000c200: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000c210: 6173 7365 7274 5261 6973 6573 2849 6e74  assertRaises(Int
+0000c220: 6572 6661 6365 4572 726f 722c 2061 7373  erfaceError, ass
+0000c230: 6967 6e5f 6e61 6d65 290a 2020 2020 2020  ign_name).      
+0000c240: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+0000c250: 6528 2773 656c 6563 7420 2a20 6672 6f6d  e('select * from
+0000c260: 2063 6f75 6e74 7279 2729 0a20 2020 2020   country').     
+0000c270: 2020 2020 2020 2063 7572 2e73 6574 5f63         cur.set_c
+0000c280: 7572 736f 725f 6e61 6d65 2827 7465 7374  ursor_name('test
+0000c290: 2729 0a20 2020 2020 2020 2020 2020 2073  ').            s
+0000c2a0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0000c2b0: 6375 722e 6e61 6d65 2c20 2774 6573 7427  cur.name, 'test'
+0000c2c0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000c2d0: 6c66 2e61 7373 6572 7452 6169 7365 7328  lf.assertRaises(
+0000c2e0: 496e 7465 7266 6163 6545 7272 6f72 2c20  InterfaceError, 
+0000c2f0: 6173 7369 676e 5f6e 616d 6529 0a20 2020  assign_name).   
+0000c300: 2064 6566 2074 6573 745f 7573 655f 6166   def test_use_af
+0000c310: 7465 725f 636c 6f73 6528 7365 6c66 293a  ter_close(self):
+0000c320: 0a20 2020 2020 2020 2063 6d64 203d 2027  .        cmd = '
+0000c330: 7365 6c65 6374 202a 2066 726f 6d20 636f  select * from co
+0000c340: 756e 7472 7927 0a20 2020 2020 2020 2077  untry'.        w
+0000c350: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
+0000c360: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
+0000c370: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+0000c380: 6563 7574 6528 636d 6429 0a20 2020 2020  ecute(cmd).     
+0000c390: 2020 2020 2020 2063 7572 2e63 6c6f 7365         cur.close
+0000c3a0: 2829 0a20 2020 2020 2020 2020 2020 2077  ().            w
+0000c3b0: 6974 6820 7365 6c66 2e61 7373 6572 7452  ith self.assertR
+0000c3c0: 6169 7365 7328 496e 7465 7266 6163 6545  aises(InterfaceE
+0000c3d0: 7272 6f72 2920 6173 2063 6d3a 0a20 2020  rror) as cm:.   
+0000c3e0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+0000c3f0: 2e66 6574 6368 6f6e 6528 290a 2020 2020  .fetchone().    
+0000c400: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000c410: 6572 7454 7570 6c65 4571 7561 6c28 636d  ertTupleEqual(cm
+0000c420: 2e65 7863 6570 7469 6f6e 2e61 7267 732c  .exception.args,
+0000c430: 2028 2743 616e 6e6f 7420 6665 7463 6820   ('Cannot fetch 
+0000c440: 6672 6f6d 2063 7572 736f 7220 7468 6174  from cursor that
+0000c450: 2064 6964 206e 6f74 2065 7865 6375 7465   did not execute
+0000c460: 6420 6120 7374 6174 656d 656e 742e 272c  d a statement.',
+0000c470: 2929 0a20 2020 2064 6566 2074 6573 745f  )).    def test_
+0000c480: 746f 5f64 6963 7428 7365 6c66 293a 0a20  to_dict(self):. 
+0000c490: 2020 2020 2020 2063 6d64 203d 2027 7365         cmd = 'se
+0000c4a0: 6c65 6374 202a 2066 726f 6d20 636f 756e  lect * from coun
+0000c4b0: 7472 7927 0a20 2020 2020 2020 2073 616d  try'.        sam
+0000c4c0: 706c 6520 3d20 7b27 434f 554e 5452 5927  ple = {'COUNTRY'
+0000c4d0: 3a20 2755 5341 272c 2027 4355 5252 454e  : 'USA', 'CURREN
+0000c4e0: 4359 273a 2027 446f 6c6c 6172 277d 0a20  CY': 'Dollar'}. 
+0000c4f0: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
+0000c500: 2e63 6f6e 2e63 7572 736f 7228 2920 6173  .con.cursor() as
+0000c510: 2063 7572 3a0a 2020 2020 2020 2020 2020   cur:.          
+0000c520: 2020 6375 722e 6578 6563 7574 6528 636d    cur.execute(cm
+0000c530: 6429 0a20 2020 2020 2020 2020 2020 2072  d).            r
+0000c540: 6f77 203d 2063 7572 2e66 6574 6368 6f6e  ow = cur.fetchon
+0000c550: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0000c560: 6420 3d20 6375 722e 746f 5f64 6963 7428  d = cur.to_dict(
+0000c570: 726f 7729 0a20 2020 2020 2020 2020 2020  row).           
+0000c580: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000c590: 6c28 6c65 6e28 6429 2c20 3229 0a20 2020  l(len(d), 2).   
+0000c5a0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0000c5b0: 7365 7274 4469 6374 4571 7561 6c28 642c  sertDictEqual(d,
+0000c5c0: 2073 616d 706c 6529 0a20 2020 2020 2020   sample).       
+0000c5d0: 2020 2020 2064 203d 207b 2743 4f55 4e54       d = {'COUNT
+0000c5e0: 5259 273a 2027 554e 4b4e 4f57 4e27 2c20  RY': 'UNKNOWN', 
+0000c5f0: 2743 5552 5245 4e43 5927 3a20 2755 4e4b  'CURRENCY': 'UNK
+0000c600: 4e4f 574e 277d 0a20 2020 2020 2020 2020  NOWN'}.         
+0000c610: 2020 2064 3220 3d20 6375 722e 746f 5f64     d2 = cur.to_d
+0000c620: 6963 7428 726f 772c 2064 290a 2020 2020  ict(row, d).    
+0000c630: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000c640: 6572 7444 6963 7445 7175 616c 2864 322c  ertDictEqual(d2,
+0000c650: 2073 616d 706c 6529 0a20 2020 2020 2020   sample).       
+0000c660: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000c670: 4973 2864 2c20 6432 290a 2020 2020 2020  Is(d, d2).      
+0000c680: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
+0000c690: 6173 7365 7274 5261 6973 6573 2841 7373  assertRaises(Ass
+0000c6a0: 6572 7469 6f6e 4572 726f 7229 2061 7320  ertionError) as 
+0000c6b0: 636d 3a0a 2020 2020 2020 2020 2020 2020  cm:.            
+0000c6c0: 2020 2020 6375 722e 746f 5f64 6963 7428      cur.to_dict(
+0000c6d0: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+0000c6e0: 2020 2020 2063 7572 2e74 6f5f 6469 6374       cur.to_dict
+0000c6f0: 285b 312c 2032 2c20 335d 290a 2020 2020  ([1, 2, 3]).    
+0000c700: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000c710: 6572 7454 7570 6c65 4571 7561 6c28 636d  ertTupleEqual(cm
+0000c720: 2e65 7863 6570 7469 6f6e 2e61 7267 732c  .exception.args,
+0000c730: 2028 274c 656e 6774 6820 6f66 2064 6174   ('Length of dat
+0000c740: 6120 6d75 7374 206d 6174 6368 206e 756d  a must match num
+0000c750: 6265 7220 6f66 2066 6965 6c64 7327 2c29  ber of fields',)
+0000c760: 290a 0a0a 636c 6173 7320 5465 7374 5363  )...class TestSc
+0000c770: 726f 6c6c 6162 6c65 4375 7273 6f72 2844  rollableCursor(D
+0000c780: 7269 7665 7254 6573 7442 6173 6529 3a0a  riverTestBase):.
+0000c790: 2020 2020 6465 6620 7465 7374 5f65 6d62      def test_emb
+0000c7a0: 6564 5f73 6372 6f6c 6c61 626c 6528 7365  ed_scrollable(se
+0000c7b0: 6c66 293a 0a20 2020 2020 2020 2069 6620  lf):.        if 
+0000c7c0: 7379 732e 706c 6174 666f 726d 203d 3d20  sys.platform == 
+0000c7d0: 2777 696e 3332 273a 0a20 2020 2020 2020  'win32':.       
+0000c7e0: 2020 2020 2073 656c 662e 736b 6970 5465       self.skipTe
+0000c7f0: 7374 2827 446f 6573 206e 6f74 2077 6f72  st('Does not wor
+0000c800: 6b20 6f6e 2057 696e 646f 7773 2729 0a20  k on Windows'). 
+0000c810: 2020 2020 2020 2073 656c 662e 6462 6669         self.dbfi
+0000c820: 6c65 203d 206f 732e 7061 7468 2e6a 6f69  le = os.path.joi
+0000c830: 6e28 7365 6c66 2e64 6270 6174 682c 2073  n(self.dbpath, s
+0000c840: 656c 662e 4642 5445 5354 5f44 4229 0a20  elf.FBTEST_DB). 
+0000c850: 2020 2020 2020 2072 6f77 7320 3d20 5b28         rows = [(
+0000c860: 2755 5341 272c 2027 446f 6c6c 6172 2729  'USA', 'Dollar')
+0000c870: 2c20 2827 456e 676c 616e 6427 2c20 2750  , ('England', 'P
+0000c880: 6f75 6e64 2729 2c20 2827 4361 6e61 6461  ound'), ('Canada
+0000c890: 272c 2027 4364 6e44 6c72 2729 2c0a 2020  ', 'CdnDlr'),.  
+0000c8a0: 2020 2020 2020 2020 2020 2020 2020 2827                ('
+0000c8b0: 5377 6974 7a65 726c 616e 6427 2c20 2753  Switzerland', 'S
+0000c8c0: 4672 616e 6327 292c 2028 274a 6170 616e  Franc'), ('Japan
+0000c8d0: 272c 2027 5965 6e27 292c 2028 2749 7461  ', 'Yen'), ('Ita
+0000c8e0: 6c79 272c 2027 4575 726f 2729 2c0a 2020  ly', 'Euro'),.  
+0000c8f0: 2020 2020 2020 2020 2020 2020 2020 2827                ('
+0000c900: 4672 616e 6365 272c 2027 4575 726f 2729  France', 'Euro')
+0000c910: 2c20 2827 4765 726d 616e 7927 2c20 2745  , ('Germany', 'E
+0000c920: 7572 6f27 292c 2028 2741 7573 7472 616c  uro'), ('Austral
+0000c930: 6961 272c 2027 4144 6f6c 6c61 7227 292c  ia', 'ADollar'),
+0000c940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c950: 2028 2748 6f6e 6720 4b6f 6e67 272c 2027   ('Hong Kong', '
+0000c960: 484b 446f 6c6c 6172 2729 2c20 2827 4e65  HKDollar'), ('Ne
+0000c970: 7468 6572 6c61 6e64 7327 2c20 2745 7572  therlands', 'Eur
+0000c980: 6f27 292c 0a20 2020 2020 2020 2020 2020  o'),.           
+0000c990: 2020 2020 2028 2742 656c 6769 756d 272c       ('Belgium',
+0000c9a0: 2027 4575 726f 2729 2c20 2827 4175 7374   'Euro'), ('Aust
+0000c9b0: 7269 6127 2c20 2745 7572 6f27 292c 2028  ria', 'Euro'), (
+0000c9c0: 2746 696a 6927 2c20 2746 446f 6c6c 6172  'Fiji', 'FDollar
+0000c9d0: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+0000c9e0: 2020 2020 2827 5275 7373 6961 272c 2027      ('Russia', '
+0000c9f0: 5275 626c 6527 292c 2028 2752 6f6d 616e  Ruble'), ('Roman
+0000ca00: 6961 272c 2027 524c 6575 2729 5d0a 2020  ia', 'RLeu')].  
+0000ca10: 2020 2020 2020 7769 7468 2063 6f6e 6e65        with conne
+0000ca20: 6374 2864 6174 6162 6173 653d 7365 6c66  ct(database=self
+0000ca30: 2e64 6266 696c 652c 2075 7365 723d 4642  .dbfile, user=FB
+0000ca40: 5445 5354 5f55 5345 522c 2070 6173 7377  TEST_USER, passw
+0000ca50: 6f72 643d 4642 5445 5354 5f50 4153 5357  ord=FBTEST_PASSW
+0000ca60: 4f52 4429 2061 7320 636f 6e3a 0a20 2020  ORD) as con:.   
+0000ca70: 2020 2020 2020 2020 2077 6974 6820 636f           with co
+0000ca80: 6e2e 6375 7273 6f72 2829 2061 7320 6375  n.cursor() as cu
+0000ca90: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0000caa0: 2020 2063 7572 2e6f 7065 6e28 2773 656c     cur.open('sel
+0000cab0: 6563 7420 2a20 6672 6f6d 2063 6f75 6e74  ect * from count
+0000cac0: 7279 2729 0a20 2020 2020 2020 2020 2020  ry').           
+0000cad0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000cae0: 5472 7565 2863 7572 2e69 735f 626f 6628  True(cur.is_bof(
+0000caf0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0000cb00: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
+0000cb10: 6c73 6528 6375 722e 6973 5f65 6f66 2829  lse(cur.is_eof()
+0000cb20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000cb30: 2020 7365 6c66 2e61 7373 6572 7454 7570    self.assertTup
+0000cb40: 6c65 4571 7561 6c28 6375 722e 6665 7463  leEqual(cur.fetc
+0000cb50: 685f 6669 7273 7428 292c 2072 6f77 735b  h_first(), rows[
+0000cb60: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
+0000cb70: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+0000cb80: 7570 6c65 4571 7561 6c28 6375 722e 6665  upleEqual(cur.fe
+0000cb90: 7463 685f 6e65 7874 2829 2c20 726f 7773  tch_next(), rows
+0000cba0: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+0000cbb0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000cbc0: 5475 706c 6545 7175 616c 2863 7572 2e66  TupleEqual(cur.f
+0000cbd0: 6574 6368 5f70 7269 6f72 2829 2c20 726f  etch_prior(), ro
+0000cbe0: 7773 5b30 5d29 0a20 2020 2020 2020 2020  ws[0]).         
+0000cbf0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000cc00: 7274 5475 706c 6545 7175 616c 2863 7572  rtTupleEqual(cur
+0000cc10: 2e66 6574 6368 5f6c 6173 7428 292c 2072  .fetch_last(), r
+0000cc20: 6f77 735b 2d31 5d29 0a20 2020 2020 2020  ows[-1]).       
+0000cc30: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0000cc40: 7365 7274 4661 6c73 6528 6375 722e 6973  sertFalse(cur.is
+0000cc50: 5f62 6f66 2829 290a 2020 2020 2020 2020  _bof()).        
+0000cc60: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000cc70: 6572 7449 734e 6f6e 6528 6375 722e 6665  ertIsNone(cur.fe
+0000cc80: 7463 685f 6e65 7874 2829 290a 2020 2020  tch_next()).    
+0000cc90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000cca0: 2e61 7373 6572 7454 7275 6528 6375 722e  .assertTrue(cur.
+0000ccb0: 6973 5f65 6f66 2829 290a 2020 2020 2020  is_eof()).      
+0000ccc0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000ccd0: 7373 6572 7454 7570 6c65 4571 7561 6c28  ssertTupleEqual(
+0000cce0: 6375 722e 6665 7463 685f 6162 736f 6c75  cur.fetch_absolu
+0000ccf0: 7465 2837 292c 2072 6f77 735b 365d 290a  te(7), rows[6]).
+0000cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cd10: 7365 6c66 2e61 7373 6572 7454 7570 6c65  self.assertTuple
+0000cd20: 4571 7561 6c28 6375 722e 6665 7463 685f  Equal(cur.fetch_
+0000cd30: 7265 6c61 7469 7665 282d 3129 2c20 726f  relative(-1), ro
+0000cd40: 7773 5b35 5d29 0a20 2020 2020 2020 2020  ws[5]).         
 0000cd50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
 0000cd60: 7274 5475 706c 6545 7175 616c 2863 7572  rtTupleEqual(cur
-0000cd70: 2e66 6574 6368 5f61 6273 6f6c 7574 6528  .fetch_absolute(
-0000cd80: 3729 2c20 726f 7773 5b36 5d29 0a20 2020  7), rows[6]).   
-0000cd90: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000cda0: 7365 7274 5475 706c 6545 7175 616c 2863  sertTupleEqual(c
-0000cdb0: 7572 2e66 6574 6368 5f72 656c 6174 6976  ur.fetch_relativ
-0000cdc0: 6528 2d31 292c 2072 6f77 735b 355d 290a  e(-1), rows[5]).
-0000cdd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000cde0: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
-0000cdf0: 6c28 6375 722e 6665 7463 686f 6e65 2829  l(cur.fetchone()
-0000ce00: 2c20 726f 7773 5b36 5d29 0a20 2020 2020  , rows[6]).     
-0000ce10: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000ce20: 7274 4c69 7374 4571 7561 6c28 6375 722e  rtListEqual(cur.
-0000ce30: 6665 7463 6861 6c6c 2829 2c20 726f 7773  fetchall(), rows
-0000ce40: 5b37 3a5d 290a 2020 2020 2020 2020 2020  [7:]).          
-0000ce50: 2020 6375 722e 6665 7463 685f 6162 736f    cur.fetch_abso
-0000ce60: 6c75 7465 2837 290a 2020 2020 2020 2020  lute(7).        
-0000ce70: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
-0000ce80: 6973 7445 7175 616c 2863 7572 2e66 6574  istEqual(cur.fet
-0000ce90: 6368 616c 6c28 292c 2072 6f77 735b 373a  chall(), rows[7:
-0000cea0: 5d29 0a0a 636c 6173 7320 5465 7374 5072  ])..class TestPr
-0000ceb0: 6570 6172 6564 5374 6174 656d 656e 7428  eparedStatement(
-0000cec0: 4472 6976 6572 5465 7374 4261 7365 293a  DriverTestBase):
-0000ced0: 0a20 2020 2064 6566 2073 6574 5570 2873  .    def setUp(s
-0000cee0: 656c 6629 3a0a 2020 2020 2020 2020 7375  elf):.        su
-0000cef0: 7065 7228 292e 7365 7455 7028 290a 2020  per().setUp().  
-0000cf00: 2020 2020 2020 7365 6c66 2e64 6266 696c        self.dbfil
-0000cf10: 6520 3d20 6f73 2e70 6174 682e 6a6f 696e  e = os.path.join
-0000cf20: 2873 656c 662e 6462 7061 7468 2c20 7365  (self.dbpath, se
-0000cf30: 6c66 2e46 4254 4553 545f 4442 290a 2020  lf.FBTEST_DB).  
-0000cf40: 2020 2020 2020 7365 6c66 2e63 6f6e 203d        self.con =
-0000cf50: 2063 6f6e 6e65 6374 2873 656c 662e 6462   connect(self.db
-0000cf60: 6669 6c65 2c20 7573 6572 3d46 4254 4553  file, user=FBTES
-0000cf70: 545f 5553 4552 2c20 7061 7373 776f 7264  T_USER, password
-0000cf80: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
-0000cf90: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
-0000cfa0: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
-0000cfb0: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
-0000cfc0: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
-0000cfd0: 2020 7365 6c66 2e63 6f6e 3220 3d20 636f    self.con2 = co
-0000cfe0: 6e6e 6563 7428 7365 6c66 2e64 6266 696c  nnect(self.dbfil
-0000cff0: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
-0000d000: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
-0000d010: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
-0000d020: 2020 2020 2020 2073 656c 662e 636f 6e32         self.con2
-0000d030: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
-0000d040: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-0000d050: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
-0000d060: 2373 656c 662e 636f 6e2e 6578 6563 7574  #self.con.execut
-0000d070: 655f 696d 6d65 6469 6174 6528 2272 6563  e_immediate("rec
-0000d080: 7265 6174 6520 7461 626c 6520 7420 2863  reate table t (c
-0000d090: 3120 696e 7465 6765 7229 2229 0a20 2020  1 integer)").   
-0000d0a0: 2020 2020 2073 656c 662e 636f 6e2e 6578       self.con.ex
-0000d0b0: 6563 7574 655f 696d 6d65 6469 6174 6528  ecute_immediate(
-0000d0c0: 2264 656c 6574 6520 6672 6f6d 2074 2229  "delete from t")
-0000d0d0: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-0000d0e0: 6e2e 636f 6d6d 6974 2829 0a20 2020 2064  n.commit().    d
-0000d0f0: 6566 2074 6561 7244 6f77 6e28 7365 6c66  ef tearDown(self
-0000d100: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-0000d110: 636f 6e2e 636c 6f73 6528 290a 2020 2020  con.close().    
-0000d120: 2020 2020 7365 6c66 2e63 6f6e 322e 636c      self.con2.cl
-0000d130: 6f73 6528 290a 2020 2020 6465 6620 7465  ose().    def te
-0000d140: 7374 5f62 6173 6963 2873 656c 6629 3a0a  st_basic(self):.
-0000d150: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000d160: 6572 744c 6973 7445 7175 616c 2873 656c  ertListEqual(sel
-0000d170: 662e 636f 6e2e 5f73 7461 7465 6d65 6e74  f.con._statement
-0000d180: 732c 205b 5d29 0a20 2020 2020 2020 2077  s, []).        w
-0000d190: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-0000d1a0: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-0000d1b0: 2020 2020 2020 2020 2020 7073 203d 2063            ps = c
-0000d1c0: 7572 2e70 7265 7061 7265 2827 7365 6c65  ur.prepare('sele
-0000d1d0: 6374 202a 2066 726f 6d20 636f 756e 7472  ct * from countr
-0000d1e0: 7927 290a 2020 2020 2020 2020 2020 2020  y').            
-0000d1f0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000d200: 286c 656e 2873 656c 662e 636f 6e2e 5f73  (len(self.con._s
-0000d210: 7461 7465 6d65 6e74 7329 2c20 3129 0a20  tatements), 1). 
-0000d220: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d230: 6173 7365 7274 4571 7561 6c28 7073 2e5f  assertEqual(ps._
-0000d240: 696e 5f63 6e74 2c20 3029 0a20 2020 2020  in_cnt, 0).     
-0000d250: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000d260: 7274 4571 7561 6c28 7073 2e5f 6f75 745f  rtEqual(ps._out_
-0000d270: 636e 742c 2032 290a 2020 2020 2020 2020  cnt, 2).        
-0000d280: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0000d290: 7175 616c 2870 732e 7479 7065 2c20 5374  qual(ps.type, St
-0000d2a0: 6174 656d 656e 7454 7970 652e 5345 4c45  atementType.SELE
-0000d2b0: 4354 290a 2020 2020 2020 2020 2020 2020  CT).            
-0000d2c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000d2d0: 2870 732e 7371 6c2c 2027 7365 6c65 6374  (ps.sql, 'select
-0000d2e0: 202a 2066 726f 6d20 636f 756e 7472 7927   * from country'
-0000d2f0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000d300: 6c66 2e63 6f6e 2e63 6c6f 7365 2829 0a20  lf.con.close(). 
-0000d310: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d320: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
-0000d330: 2e63 6f6e 2e5f 7374 6174 656d 656e 7473  .con._statements
-0000d340: 2c20 5b5d 290a 2020 2020 6465 6620 7465  , []).    def te
-0000d350: 7374 5f67 6574 5f70 6c61 6e28 7365 6c66  st_get_plan(self
-0000d360: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
-0000d370: 7365 6c66 2e63 6f6e 2e63 7572 736f 7228  self.con.cursor(
-0000d380: 2920 6173 2063 7572 3a0a 2020 2020 2020  ) as cur:.      
-0000d390: 2020 2020 2020 7073 203d 2063 7572 2e70        ps = cur.p
-0000d3a0: 7265 7061 7265 2827 7365 6c65 6374 202a  repare('select *
-0000d3b0: 2066 726f 6d20 6a6f 6227 290a 2020 2020   from job').    
-0000d3c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000d3d0: 6572 7445 7175 616c 2870 732e 706c 616e  ertEqual(ps.plan
-0000d3e0: 2c20 2250 4c41 4e20 284a 4f42 204e 4154  , "PLAN (JOB NAT
-0000d3f0: 5552 414c 2922 290a 2020 2020 6465 6620  URAL)").    def 
-0000d400: 7465 7374 5f65 7865 6375 7469 6f6e 2873  test_execution(s
-0000d410: 656c 6629 3a0a 2020 2020 2020 2020 7769  elf):.        wi
-0000d420: 7468 2073 656c 662e 636f 6e2e 6375 7273  th self.con.curs
-0000d430: 6f72 2829 2061 7320 6375 723a 0a20 2020  or() as cur:.   
-0000d440: 2020 2020 2020 2020 2070 7320 3d20 6375           ps = cu
-0000d450: 722e 7072 6570 6172 6528 2773 656c 6563  r.prepare('selec
-0000d460: 7420 2a20 6672 6f6d 2063 6f75 6e74 7279  t * from country
-0000d470: 2729 0a20 2020 2020 2020 2020 2020 2063  ').            c
-0000d480: 7572 2e65 7865 6375 7465 2870 7329 0a20  ur.execute(ps). 
-0000d490: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-0000d4a0: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
-0000d4b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000d4c0: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
-0000d4d0: 6c28 726f 772c 2028 2755 5341 272c 2027  l(row, ('USA', '
-0000d4e0: 446f 6c6c 6172 2729 290a 2020 2020 6465  Dollar')).    de
-0000d4f0: 6620 7465 7374 5f77 726f 6e67 5f63 7572  f test_wrong_cur
-0000d500: 736f 7228 7365 6c66 293a 0a20 2020 2020  sor(self):.     
-0000d510: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
-0000d520: 2e63 7572 736f 7228 2920 6173 2063 7572  .cursor() as cur
-0000d530: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
-0000d540: 7468 2073 656c 662e 636f 6e32 2e63 7572  th self.con2.cur
-0000d550: 736f 7228 2920 6173 2063 7572 323a 0a20  sor() as cur2:. 
-0000d560: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000d570: 7320 3d20 6375 722e 7072 6570 6172 6528  s = cur.prepare(
-0000d580: 2773 656c 6563 7420 2a20 6672 6f6d 2063  'select * from c
-0000d590: 6f75 6e74 7279 2729 0a20 2020 2020 2020  ountry').       
-0000d5a0: 2020 2020 2020 2020 2077 6974 6820 7365           with se
-0000d5b0: 6c66 2e61 7373 6572 7452 6169 7365 7328  lf.assertRaises(
-0000d5c0: 496e 7465 7266 6163 6545 7272 6f72 2920  InterfaceError) 
-0000d5d0: 6173 2063 6d3a 0a20 2020 2020 2020 2020  as cm:.         
-0000d5e0: 2020 2020 2020 2020 2020 2063 7572 322e             cur2.
-0000d5f0: 6578 6563 7574 6528 7073 290a 2020 2020  execute(ps).    
-0000d600: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000d610: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
-0000d620: 6c28 636d 2e65 7863 6570 7469 6f6e 2e61  l(cm.exception.a
-0000d630: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0000d640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d650: 2020 2020 2020 2020 2020 2028 2743 616e             ('Can
-0000d660: 6e6f 7420 6578 6563 7574 6520 5374 6174  not execute Stat
-0000d670: 656d 656e 7420 7468 6174 2077 6173 2063  ement that was c
-0000d680: 7265 6174 6564 2062 7920 6469 6666 6572  reated by differ
-0000d690: 656e 7420 436f 6e6e 6563 7469 6f6e 2e27  ent Connection.'
-0000d6a0: 2c29 290a 0a63 6c61 7373 2054 6573 7441  ,))..class TestA
-0000d6b0: 7272 6179 7328 4472 6976 6572 5465 7374  rrays(DriverTest
-0000d6c0: 4261 7365 293a 0a20 2020 2064 6566 2073  Base):.    def s
-0000d6d0: 6574 5570 2873 656c 6629 3a0a 2020 2020  etUp(self):.    
-0000d6e0: 2020 2020 7375 7065 7228 292e 7365 7455      super().setU
-0000d6f0: 7028 290a 2020 2020 2020 2020 7365 6c66  p().        self
-0000d700: 2e64 6266 696c 6520 3d20 6f73 2e70 6174  .dbfile = os.pat
-0000d710: 682e 6a6f 696e 2873 656c 662e 6462 7061  h.join(self.dbpa
-0000d720: 7468 2c20 7365 6c66 2e46 4254 4553 545f  th, self.FBTEST_
-0000d730: 4442 290a 2020 2020 2020 2020 7365 6c66  DB).        self
-0000d740: 2e63 6f6e 203d 2063 6f6e 6e65 6374 2873  .con = connect(s
-0000d750: 656c 662e 6462 6669 6c65 2c20 7573 6572  elf.dbfile, user
-0000d760: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
-0000d770: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
-0000d780: 5353 574f 5244 290a 2020 2020 2020 2020  SSWORD).        
-0000d790: 7365 6c66 2e63 6f6e 2e5f 6c6f 6767 696e  self.con._loggin
-0000d7a0: 675f 6964 5f20 3d20 7365 6c66 2e5f 5f63  g_id_ = self.__c
-0000d7b0: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f0a  lass__.__name__.
-0000d7c0: 2020 2020 2020 2020 7462 6c20 3d20 2222          tbl = ""
-0000d7d0: 2272 6563 7265 6174 6520 7461 626c 6520  "recreate table 
-0000d7e0: 4152 2028 6331 2069 6e74 6567 6572 2c0a  AR (c1 integer,.
-0000d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d810: 2020 2020 6332 2069 6e74 6567 6572 5b31      c2 integer[1
-0000d820: 3a34 2c30 3a33 2c31 3a32 5d2c 0a20 2020  :4,0:3,1:2],.   
-0000d830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d850: 2063 3320 7661 7263 6861 7228 3135 295b   c3 varchar(15)[
-0000d860: 303a 352c 313a 325d 2c0a 2020 2020 2020  0:5,1:2],.      
-0000d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d880: 2020 2020 2020 2020 2020 2020 2020 6334                c4
-0000d890: 2063 6861 7228 3529 5b35 5d2c 0a20 2020   char(5)[5],.   
-0000d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d8c0: 2063 3520 7469 6d65 7374 616d 705b 325d   c5 timestamp[2]
-0000d8d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d8f0: 2020 2020 2020 6336 2074 696d 655b 325d        c6 time[2]
-0000d900: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d920: 2020 2020 2020 6337 2064 6563 696d 616c        c7 decimal
-0000d930: 2831 302c 3229 5b32 5d2c 0a20 2020 2020  (10,2)[2],.     
-0000d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d950: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000d960: 3820 6e75 6d65 7269 6328 3130 2c32 295b  8 numeric(10,2)[
-0000d970: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
-0000d980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d990: 2020 2020 2020 2020 6339 2073 6d61 6c6c          c9 small
-0000d9a0: 696e 745b 325d 2c0a 2020 2020 2020 2020  int[2],.        
-0000d9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d9c0: 2020 2020 2020 2020 2020 2020 6331 3020              c10 
-0000d9d0: 6269 6769 6e74 5b32 5d2c 0a20 2020 2020  bigint[2],.     
-0000d9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d9f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000da00: 3131 2066 6c6f 6174 5b32 5d2c 0a20 2020  11 float[2],.   
-0000da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da30: 2063 3132 2064 6f75 626c 6520 7072 6563   c12 double prec
-0000da40: 6973 696f 6e5b 325d 2c0a 2020 2020 2020  ision[2],.      
-0000da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da60: 2020 2020 2020 2020 2020 2020 2020 6331                c1
-0000da70: 3320 6465 6369 6d61 6c28 3130 2c31 295b  3 decimal(10,1)[
-0000da80: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
-0000da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000daa0: 2020 2020 2020 2020 6331 3420 6465 6369          c14 deci
-0000dab0: 6d61 6c28 3130 2c35 295b 325d 2c0a 2020  mal(10,5)[2],.  
-0000dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dae0: 2020 6331 3520 6465 6369 6d61 6c28 3138    c15 decimal(18
-0000daf0: 2c35 295b 325d 0a20 2020 2020 2020 2020  ,5)[2].         
-0000db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db10: 2020 2020 2020 2020 2020 2029 0a22 2222             )."""
-0000db20: 0a20 2020 2020 2020 2023 0a20 2020 2020  .        #.     
-0000db30: 2020 2073 656c 662e 6332 203d 205b 5b5b     self.c2 = [[[
-0000db40: 312c 2031 5d2c 205b 322c 2032 5d2c 205b  1, 1], [2, 2], [
-0000db50: 332c 2033 5d2c 205b 342c 2034 5d5d 2c20  3, 3], [4, 4]], 
-0000db60: 5b5b 352c 2035 5d2c 205b 362c 2036 5d2c  [[5, 5], [6, 6],
-0000db70: 205b 372c 2037 5d2c 205b 382c 2038 5d5d   [7, 7], [8, 8]]
-0000db80: 2c20 5b5b 392c 2039 5d2c 205b 3130 2c20  , [[9, 9], [10, 
-0000db90: 3130 5d2c 205b 3131 2c20 3131 5d2c 205b  10], [11, 11], [
-0000dba0: 3132 2c20 3132 5d5d 2c20 5b5b 3133 2c20  12, 12]], [[13, 
-0000dbb0: 3133 5d2c 205b 3134 2c20 3134 5d2c 205b  13], [14, 14], [
-0000dbc0: 3135 2c20 3135 5d2c 205b 3136 2c20 3136  15, 15], [16, 16
-0000dbd0: 5d5d 5d0a 2020 2020 2020 2020 7365 6c66  ]]].        self
-0000dbe0: 2e63 3320 3d20 5b5b 2761 272c 2027 6127  .c3 = [['a', 'a'
-0000dbf0: 5d2c 205b 2762 6227 2c20 2762 6227 5d2c  ], ['bb', 'bb'],
-0000dc00: 205b 2763 6363 272c 2027 6363 6327 5d2c   ['ccc', 'ccc'],
-0000dc10: 205b 2764 6464 6427 2c20 2764 6464 6427   ['dddd', 'dddd'
-0000dc20: 5d2c 205b 2765 6565 6565 272c 2027 6565  ], ['eeeee', 'ee
-0000dc30: 6565 6527 5d2c 205b 2766 6666 6666 6666  eee'], ['fffffff
-0000dc40: 3738 3930 3132 3334 272c 2027 6666 6666  78901234', 'ffff
-0000dc50: 6666 6637 3839 3031 3233 3427 5d5d 0a20  fff78901234']]. 
-0000dc60: 2020 2020 2020 2073 656c 662e 6334 203d         self.c4 =
-0000dc70: 205b 2761 2020 2020 272c 2027 6262 2020   ['a    ', 'bb  
-0000dc80: 2027 2c20 2763 6363 2020 272c 2027 6464   ', 'ccc  ', 'dd
-0000dc90: 6464 2027 2c20 2765 6565 6565 275d 0a20  dd ', 'eeeee']. 
-0000dca0: 2020 2020 2020 2073 656c 662e 6335 203d         self.c5 =
-0000dcb0: 205b 6461 7465 7469 6d65 2e64 6174 6574   [datetime.datet
-0000dcc0: 696d 6528 3230 3132 2c20 3131 2c20 3232  ime(2012, 11, 22
-0000dcd0: 2c20 3132 2c20 382c 2032 342c 2034 3734  , 12, 8, 24, 474
-0000dce0: 3830 3029 2c20 6461 7465 7469 6d65 2e64  800), datetime.d
-0000dcf0: 6174 6574 696d 6528 3230 3132 2c20 3131  atetime(2012, 11
-0000dd00: 2c20 3232 2c20 3132 2c20 382c 2032 342c  , 22, 12, 8, 24,
-0000dd10: 2034 3734 3830 3029 5d0a 2020 2020 2020   474800)].      
-0000dd20: 2020 7365 6c66 2e63 3620 3d20 5b64 6174    self.c6 = [dat
-0000dd30: 6574 696d 652e 7469 6d65 2831 322c 2038  etime.time(12, 8
-0000dd40: 2c20 3234 2c20 3437 3438 3030 292c 2064  , 24, 474800), d
-0000dd50: 6174 6574 696d 652e 7469 6d65 2831 322c  atetime.time(12,
-0000dd60: 2038 2c20 3234 2c20 3437 3438 3030 295d   8, 24, 474800)]
-0000dd70: 0a20 2020 2020 2020 2073 656c 662e 6337  .        self.c7
-0000dd80: 203d 205b 6465 6369 6d61 6c2e 4465 6369   = [decimal.Deci
-0000dd90: 6d61 6c28 2731 302e 3232 2729 2c20 6465  mal('10.22'), de
-0000dda0: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
-0000ddb0: 3030 3030 302e 3333 2729 5d0a 2020 2020  00000.33')].    
-0000ddc0: 2020 2020 7365 6c66 2e63 3820 3d20 5b64      self.c8 = [d
-0000ddd0: 6563 696d 616c 2e44 6563 696d 616c 2827  ecimal.Decimal('
-0000dde0: 3130 2e32 3227 292c 2064 6563 696d 616c  10.22'), decimal
-0000ddf0: 2e44 6563 696d 616c 2827 3130 3030 3030  .Decimal('100000
-0000de00: 2e33 3327 295d 0a20 2020 2020 2020 2073  .33')].        s
-0000de10: 656c 662e 6339 203d 205b 312c 2030 5d0a  elf.c9 = [1, 0].
-0000de20: 2020 2020 2020 2020 7365 6c66 2e63 3130          self.c10
-0000de30: 203d 205b 3535 3535 3535 352c 2037 3737   = [5555555, 777
-0000de40: 3737 3737 5d0a 2020 2020 2020 2020 7365  7777].        se
-0000de50: 6c66 2e63 3131 203d 205b 332e 3134 3030  lf.c11 = [3.1400
-0000de60: 3030 3130 3439 3034 3137 352c 2033 2e31  00104904175, 3.1
-0000de70: 3430 3030 3031 3034 3930 3431 3735 5d0a  40000104904175].
-0000de80: 2020 2020 2020 2020 7365 6c66 2e63 3132          self.c12
-0000de90: 203d 205b 332e 3134 2c20 332e 3134 5d0a   = [3.14, 3.14].
-0000dea0: 2020 2020 2020 2020 7365 6c66 2e63 3133          self.c13
-0000deb0: 203d 205b 6465 6369 6d61 6c2e 4465 6369   = [decimal.Deci
-0000dec0: 6d61 6c28 2731 302e 3227 292c 2064 6563  mal('10.2'), dec
-0000ded0: 696d 616c 2e44 6563 696d 616c 2827 3130  imal.Decimal('10
-0000dee0: 3030 3030 2e33 2729 5d0a 2020 2020 2020  0000.3')].      
-0000def0: 2020 7365 6c66 2e63 3134 203d 205b 6465    self.c14 = [de
-0000df00: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
-0000df10: 302e 3232 3232 3227 292c 2064 6563 696d  0.22222'), decim
-0000df20: 616c 2e44 6563 696d 616c 2827 3130 3030  al.Decimal('1000
-0000df30: 3030 2e33 3333 2729 5d0a 2020 2020 2020  00.333')].      
-0000df40: 2020 7365 6c66 2e63 3135 203d 205b 6465    self.c15 = [de
-0000df50: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
-0000df60: 3030 3030 3030 3030 3030 3030 2e32 3232  000000000000.222
-0000df70: 3232 2729 2c20 6465 6369 6d61 6c2e 4465  22'), decimal.De
-0000df80: 6369 6d61 6c28 2731 3030 3030 3030 3030  cimal('100000000
-0000df90: 3030 3030 2e33 3333 2729 5d0a 2020 2020  0000.333')].    
-0000dfa0: 2020 2020 7365 6c66 2e63 3136 203d 205b      self.c16 = [
-0000dfb0: 5472 7565 2c20 4661 6c73 652c 2054 7275  True, False, Tru
-0000dfc0: 655d 0a20 2020 2020 2020 2023 7365 6c66  e].        #self
-0000dfd0: 2e63 6f6e 2e65 7865 6375 7465 5f69 6d6d  .con.execute_imm
-0000dfe0: 6564 6961 7465 2874 626c 290a 2020 2020  ediate(tbl).    
-0000dff0: 2020 2020 7365 6c66 2e63 6f6e 2e65 7865      self.con.exe
-0000e000: 6375 7465 5f69 6d6d 6564 6961 7465 2822  cute_immediate("
-0000e010: 6465 6c65 7465 2066 726f 6d20 4152 2077  delete from AR w
-0000e020: 6865 7265 2063 313e 3d31 3030 2229 0a20  here c1>=100"). 
-0000e030: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
-0000e040: 636f 6d6d 6974 2829 0a20 2020 2020 2020  commit().       
-0000e050: 2023 6375 7220 3d20 7365 6c66 2e63 6f6e   #cur = self.con
-0000e060: 2e63 7572 736f 7228 290a 2020 2020 2020  .cursor().      
-0000e070: 2020 2363 7572 2e65 7865 6375 7465 2822    #cur.execute("
-0000e080: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
-0000e090: 6331 2c63 322c 6333 2c63 342c 6335 2c63  c1,c2,c3,c4,c5,c
-0000e0a0: 362c 6337 2c63 382c 6339 2c63 3130 2c63  6,c7,c8,c9,c10,c
-0000e0b0: 3131 2c63 3132 2920 7661 6c75 6573 2028  11,c12) values (
-0000e0c0: 312c 3f2c 3f2c 3f2c 3f2c 3f2c 3f2c 3f2c  1,?,?,?,?,?,?,?,
-0000e0d0: 3f2c 3f2c 3f2c 3f29 222c 0a20 2020 2020  ?,?,?,?)",.     
-0000e0e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000e0f0: 5b73 656c 662e 6332 2c73 656c 662e 6333  [self.c2,self.c3
-0000e100: 2c73 656c 662e 6334 2c73 656c 662e 6335  ,self.c4,self.c5
-0000e110: 2c73 656c 662e 6336 2c73 656c 662e 6337  ,self.c6,self.c7
-0000e120: 2c73 656c 662e 6338 2c73 656c 662e 6339  ,self.c8,self.c9
-0000e130: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000e140: 2020 2020 2020 2020 2020 2373 656c 662e            #self.
-0000e150: 6331 302c 7365 6c66 2e63 3131 2c73 656c  c10,self.c11,sel
-0000e160: 662e 6331 325d 290a 2020 2020 2020 2020  f.c12]).        
-0000e170: 2363 7572 2e65 7865 6375 7465 2822 696e  #cur.execute("in
-0000e180: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
-0000e190: 2c63 3229 2076 616c 7565 7320 2832 2c3f  ,c2) values (2,?
-0000e1a0: 2922 2c5b 7365 6c66 2e63 325d 290a 2020  )",[self.c2]).  
-0000e1b0: 2020 2020 2020 2363 7572 2e65 7865 6375        #cur.execu
-0000e1c0: 7465 2822 696e 7365 7274 2069 6e74 6f20  te("insert into 
-0000e1d0: 6172 2028 6331 2c63 3329 2076 616c 7565  ar (c1,c3) value
-0000e1e0: 7320 2833 2c3f 2922 2c5b 7365 6c66 2e63  s (3,?)",[self.c
-0000e1f0: 335d 290a 2020 2020 2020 2020 2363 7572  3]).        #cur
-0000e200: 2e65 7865 6375 7465 2822 696e 7365 7274  .execute("insert
-0000e210: 2069 6e74 6f20 6172 2028 6331 2c63 3429   into ar (c1,c4)
-0000e220: 2076 616c 7565 7320 2834 2c3f 2922 2c5b   values (4,?)",[
-0000e230: 7365 6c66 2e63 345d 290a 2020 2020 2020  self.c4]).      
-0000e240: 2020 2363 7572 2e65 7865 6375 7465 2822    #cur.execute("
-0000e250: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
-0000e260: 6331 2c63 3529 2076 616c 7565 7320 2835  c1,c5) values (5
-0000e270: 2c3f 2922 2c5b 7365 6c66 2e63 355d 290a  ,?)",[self.c5]).
-0000e280: 2020 2020 2020 2020 2363 7572 2e65 7865          #cur.exe
-0000e290: 6375 7465 2822 696e 7365 7274 2069 6e74  cute("insert int
-0000e2a0: 6f20 6172 2028 6331 2c63 3629 2076 616c  o ar (c1,c6) val
-0000e2b0: 7565 7320 2836 2c3f 2922 2c5b 7365 6c66  ues (6,?)",[self
-0000e2c0: 2e63 365d 290a 2020 2020 2020 2020 2363  .c6]).        #c
-0000e2d0: 7572 2e65 7865 6375 7465 2822 696e 7365  ur.execute("inse
-0000e2e0: 7274 2069 6e74 6f20 6172 2028 6331 2c63  rt into ar (c1,c
-0000e2f0: 3729 2076 616c 7565 7320 2837 2c3f 2922  7) values (7,?)"
-0000e300: 2c5b 7365 6c66 2e63 375d 290a 2020 2020  ,[self.c7]).    
-0000e310: 2020 2020 2363 7572 2e65 7865 6375 7465      #cur.execute
-0000e320: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
-0000e330: 2028 6331 2c63 3829 2076 616c 7565 7320   (c1,c8) values 
-0000e340: 2838 2c3f 2922 2c5b 7365 6c66 2e63 385d  (8,?)",[self.c8]
-0000e350: 290a 2020 2020 2020 2020 2363 7572 2e65  ).        #cur.e
-0000e360: 7865 6375 7465 2822 696e 7365 7274 2069  xecute("insert i
-0000e370: 6e74 6f20 6172 2028 6331 2c63 3929 2076  nto ar (c1,c9) v
-0000e380: 616c 7565 7320 2839 2c3f 2922 2c5b 7365  alues (9,?)",[se
-0000e390: 6c66 2e63 395d 290a 2020 2020 2020 2020  lf.c9]).        
-0000e3a0: 2363 7572 2e65 7865 6375 7465 2822 696e  #cur.execute("in
-0000e3b0: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
-0000e3c0: 2c63 3130 2920 7661 6c75 6573 2028 3130  ,c10) values (10
-0000e3d0: 2c3f 2922 2c5b 7365 6c66 2e63 3130 5d29  ,?)",[self.c10])
-0000e3e0: 0a20 2020 2020 2020 2023 6375 722e 6578  .        #cur.ex
-0000e3f0: 6563 7574 6528 2269 6e73 6572 7420 696e  ecute("insert in
-0000e400: 746f 2061 7220 2863 312c 6331 3129 2076  to ar (c1,c11) v
-0000e410: 616c 7565 7320 2831 312c 3f29 222c 5b73  alues (11,?)",[s
-0000e420: 656c 662e 6331 315d 290a 2020 2020 2020  elf.c11]).      
-0000e430: 2020 2363 7572 2e65 7865 6375 7465 2822    #cur.execute("
-0000e440: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
-0000e450: 6331 2c63 3132 2920 7661 6c75 6573 2028  c1,c12) values (
-0000e460: 3132 2c3f 2922 2c5b 7365 6c66 2e63 3132  12,?)",[self.c12
-0000e470: 5d29 0a20 2020 2020 2020 2023 6375 722e  ]).        #cur.
-0000e480: 6578 6563 7574 6528 2269 6e73 6572 7420  execute("insert 
-0000e490: 696e 746f 2061 7220 2863 312c 6331 3329  into ar (c1,c13)
-0000e4a0: 2076 616c 7565 7320 2831 332c 3f29 222c   values (13,?)",
-0000e4b0: 5b73 656c 662e 6331 335d 290a 2020 2020  [self.c13]).    
-0000e4c0: 2020 2020 2363 7572 2e65 7865 6375 7465      #cur.execute
-0000e4d0: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
-0000e4e0: 2028 6331 2c63 3134 2920 7661 6c75 6573   (c1,c14) values
-0000e4f0: 2028 3134 2c3f 2922 2c5b 7365 6c66 2e63   (14,?)",[self.c
-0000e500: 3134 5d29 0a20 2020 2020 2020 2023 6375  14]).        #cu
-0000e510: 722e 6578 6563 7574 6528 2269 6e73 6572  r.execute("inser
-0000e520: 7420 696e 746f 2061 7220 2863 312c 6331  t into ar (c1,c1
-0000e530: 3529 2076 616c 7565 7320 2831 352c 3f29  5) values (15,?)
-0000e540: 222c 5b73 656c 662e 6331 355d 290a 2020  ",[self.c15]).  
-0000e550: 2020 2020 2020 2373 656c 662e 636f 6e2e        #self.con.
-0000e560: 636f 6d6d 6974 2829 0a20 2020 2064 6566  commit().    def
-0000e570: 2074 6561 7244 6f77 6e28 7365 6c66 293a   tearDown(self):
-0000e580: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-0000e590: 6e2e 636c 6f73 6528 290a 2020 2020 6465  n.close().    de
-0000e5a0: 6620 7465 7374 5f62 6173 6963 2873 656c  f test_basic(sel
-0000e5b0: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
-0000e5c0: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
-0000e5d0: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
-0000e5e0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
-0000e5f0: 7465 2822 7365 6c65 6374 204c 414e 4755  te("select LANGU
-0000e600: 4147 455f 5245 5120 6672 6f6d 206a 6f62  AGE_REQ from job
-0000e610: 2022 5c0a 2020 2020 2020 2020 2020 2020   "\.            
-0000e620: 2020 2020 2020 2020 2020 2020 2277 6865              "whe
-0000e630: 7265 206a 6f62 5f63 6f64 653d 2745 6e67  re job_code='Eng
-0000e640: 2720 616e 6420 6a6f 625f 6772 6164 653d  ' and job_grade=
-0000e650: 3320 616e 6420 6a6f 625f 636f 756e 7472  3 and job_countr
-0000e660: 793d 274a 6170 616e 2722 290a 2020 2020  y='Japan'").    
-0000e670: 2020 2020 2020 2020 726f 7720 3d20 6375          row = cu
-0000e680: 722e 6665 7463 686f 6e65 2829 0a20 2020  r.fetchone().   
-0000e690: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000e6a0: 7365 7274 5475 706c 6545 7175 616c 2872  sertTupleEqual(r
-0000e6b0: 6f77 2c0a 2020 2020 2020 2020 2020 2020  ow,.            
-0000e6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6d0: 2020 2020 2020 285b 274a 6170 616e 6573        (['Japanes
-0000e6e0: 655c 6e27 2c20 274d 616e 6461 7269 6e5c  e\n', 'Mandarin\
-0000e6f0: 6e27 2c20 2745 6e67 6c69 7368 5c6e 272c  n', 'English\n',
-0000e700: 2027 5c6e 272c 2027 5c6e 275d 2c29 290a   '\n', '\n'],)).
-0000e710: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-0000e720: 6578 6563 7574 6528 2773 656c 6563 7420  execute('select 
-0000e730: 5155 4152 545f 4845 4144 5f43 4e54 2066  QUART_HEAD_CNT f
-0000e740: 726f 6d20 7072 6f6a 5f64 6570 745f 6275  rom proj_dept_bu
-0000e750: 6467 6574 2729 0a20 2020 2020 2020 2020  dget').         
-0000e760: 2020 2072 6f77 203d 2063 7572 2e66 6574     row = cur.fet
-0000e770: 6368 616c 6c28 290a 2020 2020 2020 2020  chall().        
-0000e780: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
-0000e790: 6973 7445 7175 616c 2872 6f77 2c0a 2020  istEqual(row,.  
-0000e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7b0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0000e7c0: 285b 312c 2031 2c20 312c 2030 5d2c 292c  ([1, 1, 1, 0],),
-0000e7d0: 2028 5b33 2c20 322c 2031 2c20 305d 2c29   ([3, 2, 1, 0],)
-0000e7e0: 2c20 285b 302c 2030 2c20 302c 2031 5d2c  , ([0, 0, 0, 1],
-0000e7f0: 292c 2028 5b32 2c20 312c 2030 2c20 305d  ), ([2, 1, 0, 0]
-0000e800: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
-0000e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e820: 2020 2020 2020 285b 312c 2031 2c20 302c        ([1, 1, 0,
-0000e830: 2030 5d2c 292c 2028 5b31 2c20 312c 2030   0],), ([1, 1, 0
-0000e840: 2c20 305d 2c29 2c20 285b 312c 2031 2c20  , 0],), ([1, 1, 
-0000e850: 312c 2031 5d2c 292c 2028 5b32 2c20 332c  1, 1],), ([2, 3,
-0000e860: 2032 2c20 315d 2c29 2c0a 2020 2020 2020   2, 1],),.      
-0000e870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e880: 2020 2020 2020 2020 2020 2020 285b 312c              ([1,
-0000e890: 2031 2c20 322c 2032 5d2c 292c 2028 5b31   1, 2, 2],), ([1
-0000e8a0: 2c20 312c 2031 2c20 325d 2c29 2c20 285b  , 1, 1, 2],), ([
-0000e8b0: 312c 2031 2c20 312c 2032 5d2c 292c 2028  1, 1, 1, 2],), (
-0000e8c0: 5b34 2c20 352c 2036 2c20 365d 2c29 2c0a  [4, 5, 6, 6],),.
-0000e8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8f0: 2020 285b 322c 2032 2c20 302c 2033 5d2c    ([2, 2, 0, 3],
-0000e900: 292c 2028 5b31 2c20 312c 2032 2c20 325d  ), ([1, 1, 2, 2]
-0000e910: 2c29 2c20 285b 372c 2037 2c20 342c 2034  ,), ([7, 7, 4, 4
-0000e920: 5d2c 292c 2028 5b32 2c20 332c 2033 2c20  ],), ([2, 3, 3, 
-0000e930: 335d 2c29 2c0a 2020 2020 2020 2020 2020  3],),.          
-0000e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e950: 2020 2020 2020 2020 285b 342c 2035 2c20          ([4, 5, 
-0000e960: 362c 2036 5d2c 292c 2028 5b31 2c20 312c  6, 6],), ([1, 1,
-0000e970: 2031 2c20 315d 2c29 2c20 285b 342c 2035   1, 1],), ([4, 5
-0000e980: 2c20 352c 2033 5d2c 292c 2028 5b34 2c20  , 5, 3],), ([4, 
-0000e990: 332c 2032 2c20 325d 2c29 2c0a 2020 2020  3, 2, 2],),.    
-0000e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e9b0: 2020 2020 2020 2020 2020 2020 2020 285b                ([
-0000e9c0: 322c 2032 2c20 322c 2031 5d2c 292c 2028  2, 2, 2, 1],), (
-0000e9d0: 5b31 2c20 312c 2032 2c20 335d 2c29 2c20  [1, 1, 2, 3],), 
-0000e9e0: 285b 332c 2033 2c20 312c 2031 5d2c 292c  ([3, 3, 1, 1],),
-0000e9f0: 2028 5b31 2c20 312c 2030 2c20 305d 2c29   ([1, 1, 0, 0],)
-0000ea00: 5d29 0a20 2020 2064 6566 2074 6573 745f  ]).    def test_
-0000ea10: 7265 6164 5f66 756c 6c28 7365 6c66 293a  read_full(self):
-0000ea20: 0a20 2020 2020 2020 2077 6974 6820 7365  .        with se
-0000ea30: 6c66 2e63 6f6e 2e63 7572 736f 7228 2920  lf.con.cursor() 
-0000ea40: 6173 2063 7572 3a0a 2020 2020 2020 2020  as cur:.        
-0000ea50: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
-0000ea60: 2273 656c 6563 7420 6331 2c63 3220 6672  "select c1,c2 fr
-0000ea70: 6f6d 2061 7220 7768 6572 6520 6331 3d32  om ar where c1=2
-0000ea80: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000ea90: 6f77 203d 2063 7572 2e66 6574 6368 6f6e  ow = cur.fetchon
-0000eaa0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-0000eab0: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
-0000eac0: 7175 616c 2872 6f77 5b31 5d2c 2073 656c  qual(row[1], sel
-0000ead0: 662e 6332 290a 2020 2020 2020 2020 2020  f.c2).          
-0000eae0: 2020 6375 722e 6578 6563 7574 6528 2273    cur.execute("s
-0000eaf0: 656c 6563 7420 6331 2c63 3320 6672 6f6d  elect c1,c3 from
-0000eb00: 2061 7220 7768 6572 6520 6331 3d33 2229   ar where c1=3")
-0000eb10: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-0000eb20: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-0000eb30: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000eb40: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-0000eb50: 616c 2872 6f77 5b31 5d2c 2073 656c 662e  al(row[1], self.
-0000eb60: 6333 290a 2020 2020 2020 2020 2020 2020  c3).            
-0000eb70: 6375 722e 6578 6563 7574 6528 2273 656c  cur.execute("sel
-0000eb80: 6563 7420 6331 2c63 3420 6672 6f6d 2061  ect c1,c4 from a
-0000eb90: 7220 7768 6572 6520 6331 3d34 2229 0a20  r where c1=4"). 
-0000eba0: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-0000ebb0: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
-0000ebc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000ebd0: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
-0000ebe0: 2872 6f77 5b31 5d2c 2073 656c 662e 6334  (row[1], self.c4
-0000ebf0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-0000ec00: 722e 6578 6563 7574 6528 2273 656c 6563  r.execute("selec
-0000ec10: 7420 6331 2c63 3520 6672 6f6d 2061 7220  t c1,c5 from ar 
-0000ec20: 7768 6572 6520 6331 3d35 2229 0a20 2020  where c1=5").   
-0000ec30: 2020 2020 2020 2020 2072 6f77 203d 2063           row = c
-0000ec40: 7572 2e66 6574 6368 6f6e 6528 290a 2020  ur.fetchone().  
-0000ec50: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0000ec60: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
-0000ec70: 6f77 5b31 5d2c 2073 656c 662e 6335 290a  ow[1], self.c5).
-0000ec80: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-0000ec90: 6578 6563 7574 6528 2273 656c 6563 7420  execute("select 
-0000eca0: 6331 2c63 3620 6672 6f6d 2061 7220 7768  c1,c6 from ar wh
-0000ecb0: 6572 6520 6331 3d36 2229 0a20 2020 2020  ere c1=6").     
-0000ecc0: 2020 2020 2020 2072 6f77 203d 2063 7572         row = cur
-0000ecd0: 2e66 6574 6368 6f6e 6528 290a 2020 2020  .fetchone().    
-0000ece0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000ecf0: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
-0000ed00: 5b31 5d2c 2073 656c 662e 6336 290a 2020  [1], self.c6).  
-0000ed10: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-0000ed20: 6563 7574 6528 2273 656c 6563 7420 6331  ecute("select c1
-0000ed30: 2c63 3720 6672 6f6d 2061 7220 7768 6572  ,c7 from ar wher
-0000ed40: 6520 6331 3d37 2229 0a20 2020 2020 2020  e c1=7").       
-0000ed50: 2020 2020 2072 6f77 203d 2063 7572 2e66       row = cur.f
-0000ed60: 6574 6368 6f6e 6528 290a 2020 2020 2020  etchone().      
-0000ed70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000ed80: 744c 6973 7445 7175 616c 2872 6f77 5b31  tListEqual(row[1
-0000ed90: 5d2c 2073 656c 662e 6337 290a 2020 2020  ], self.c7).    
-0000eda0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-0000edb0: 7574 6528 2273 656c 6563 7420 6331 2c63  ute("select c1,c
-0000edc0: 3820 6672 6f6d 2061 7220 7768 6572 6520  8 from ar where 
-0000edd0: 6331 3d38 2229 0a20 2020 2020 2020 2020  c1=8").         
-0000ede0: 2020 2072 6f77 203d 2063 7572 2e66 6574     row = cur.fet
-0000edf0: 6368 6f6e 6528 290a 2020 2020 2020 2020  chone().        
-0000ee00: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
-0000ee10: 6973 7445 7175 616c 2872 6f77 5b31 5d2c  istEqual(row[1],
-0000ee20: 2073 656c 662e 6338 290a 2020 2020 2020   self.c8).      
-0000ee30: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
-0000ee40: 6528 2273 656c 6563 7420 6331 2c63 3920  e("select c1,c9 
-0000ee50: 6672 6f6d 2061 7220 7768 6572 6520 6331  from ar where c1
-0000ee60: 3d39 2229 0a20 2020 2020 2020 2020 2020  =9").           
-0000ee70: 2072 6f77 203d 2063 7572 2e66 6574 6368   row = cur.fetch
-0000ee80: 6f6e 6528 290a 2020 2020 2020 2020 2020  one().          
-0000ee90: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
-0000eea0: 7445 7175 616c 2872 6f77 5b31 5d2c 2073  tEqual(row[1], s
-0000eeb0: 656c 662e 6339 290a 2020 2020 2020 2020  elf.c9).        
-0000eec0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
-0000eed0: 2273 656c 6563 7420 6331 2c63 3130 2066  "select c1,c10 f
-0000eee0: 726f 6d20 6172 2077 6865 7265 2063 313d  rom ar where c1=
-0000eef0: 3130 2229 0a20 2020 2020 2020 2020 2020  10").           
-0000ef00: 2072 6f77 203d 2063 7572 2e66 6574 6368   row = cur.fetch
-0000ef10: 6f6e 6528 290a 2020 2020 2020 2020 2020  one().          
-0000ef20: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
-0000ef30: 7445 7175 616c 2872 6f77 5b31 5d2c 2073  tEqual(row[1], s
-0000ef40: 656c 662e 6331 3029 0a20 2020 2020 2020  elf.c10).       
-0000ef50: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0000ef60: 2822 7365 6c65 6374 2063 312c 6331 3120  ("select c1,c11 
-0000ef70: 6672 6f6d 2061 7220 7768 6572 6520 6331  from ar where c1
-0000ef80: 3d31 3122 290a 2020 2020 2020 2020 2020  =11").          
-0000ef90: 2020 726f 7720 3d20 6375 722e 6665 7463    row = cur.fetc
-0000efa0: 686f 6e65 2829 0a20 2020 2020 2020 2020  hone().         
-0000efb0: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
-0000efc0: 7374 4571 7561 6c28 726f 775b 315d 2c20  stEqual(row[1], 
-0000efd0: 7365 6c66 2e63 3131 290a 2020 2020 2020  self.c11).      
-0000efe0: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
-0000eff0: 6528 2273 656c 6563 7420 6331 2c63 3132  e("select c1,c12
-0000f000: 2066 726f 6d20 6172 2077 6865 7265 2063   from ar where c
-0000f010: 313d 3132 2229 0a20 2020 2020 2020 2020  1=12").         
-0000f020: 2020 2072 6f77 203d 2063 7572 2e66 6574     row = cur.fet
-0000f030: 6368 6f6e 6528 290a 2020 2020 2020 2020  chone().        
-0000f040: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
-0000f050: 6973 7445 7175 616c 2872 6f77 5b31 5d2c  istEqual(row[1],
-0000f060: 2073 656c 662e 6331 3229 0a20 2020 2020   self.c12).     
-0000f070: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
-0000f080: 7465 2822 7365 6c65 6374 2063 312c 6331  te("select c1,c1
-0000f090: 3320 6672 6f6d 2061 7220 7768 6572 6520  3 from ar where 
-0000f0a0: 6331 3d31 3322 290a 2020 2020 2020 2020  c1=13").        
-0000f0b0: 2020 2020 726f 7720 3d20 6375 722e 6665      row = cur.fe
-0000f0c0: 7463 686f 6e65 2829 0a20 2020 2020 2020  tchone().       
-0000f0d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000f0e0: 4c69 7374 4571 7561 6c28 726f 775b 315d  ListEqual(row[1]
-0000f0f0: 2c20 7365 6c66 2e63 3133 290a 2020 2020  , self.c13).    
-0000f100: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-0000f110: 7574 6528 2273 656c 6563 7420 6331 2c63  ute("select c1,c
-0000f120: 3134 2066 726f 6d20 6172 2077 6865 7265  14 from ar where
-0000f130: 2063 313d 3134 2229 0a20 2020 2020 2020   c1=14").       
-0000f140: 2020 2020 2072 6f77 203d 2063 7572 2e66       row = cur.f
-0000f150: 6574 6368 6f6e 6528 290a 2020 2020 2020  etchone().      
-0000f160: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000f170: 744c 6973 7445 7175 616c 2872 6f77 5b31  tListEqual(row[1
-0000f180: 5d2c 2073 656c 662e 6331 3429 0a20 2020  ], self.c14).   
-0000f190: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-0000f1a0: 6375 7465 2822 7365 6c65 6374 2063 312c  cute("select c1,
-0000f1b0: 6331 3520 6672 6f6d 2061 7220 7768 6572  c15 from ar wher
-0000f1c0: 6520 6331 3d31 3522 290a 2020 2020 2020  e c1=15").      
-0000f1d0: 2020 2020 2020 726f 7720 3d20 6375 722e        row = cur.
-0000f1e0: 6665 7463 686f 6e65 2829 0a20 2020 2020  fetchone().     
-0000f1f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000f200: 7274 4c69 7374 4571 7561 6c28 726f 775b  rtListEqual(row[
-0000f210: 315d 2c20 7365 6c66 2e63 3135 290a 2020  1], self.c15).  
-0000f220: 2020 6465 6620 7465 7374 5f77 7269 7465    def test_write
-0000f230: 5f66 756c 6c28 7365 6c66 293a 0a20 2020  _full(self):.   
-0000f240: 2020 2020 2077 6974 6820 7365 6c66 2e63       with self.c
-0000f250: 6f6e 2e63 7572 736f 7228 2920 6173 2063  on.cursor() as c
-0000f260: 7572 3a0a 2020 2020 2020 2020 2020 2020  ur:.            
-0000f270: 2320 494e 5445 4745 520a 2020 2020 2020  # INTEGER.      
-0000f280: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
-0000f290: 6528 2269 6e73 6572 7420 696e 746f 2061  e("insert into a
-0000f2a0: 7220 2863 312c 6332 2920 7661 6c75 6573  r (c1,c2) values
-0000f2b0: 2028 3130 322c 3f29 222c 205b 7365 6c66   (102,?)", [self
-0000f2c0: 2e63 325d 290a 2020 2020 2020 2020 2020  .c2]).          
-0000f2d0: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
-0000f2e0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-0000f2f0: 6375 722e 6578 6563 7574 6528 2273 656c  cur.execute("sel
-0000f300: 6563 7420 6331 2c63 3220 6672 6f6d 2061  ect c1,c2 from a
-0000f310: 7220 7768 6572 6520 6331 3d31 3032 2229  r where c1=102")
-0000f320: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-0000f330: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-0000f340: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000f350: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-0000f360: 616c 2872 6f77 5b31 5d2c 2073 656c 662e  al(row[1], self.
-0000f370: 6332 290a 2020 2020 2020 2020 2020 2020  c2).            
-0000f380: 2320 5641 5243 4841 520a 2020 2020 2020  # VARCHAR.      
-0000f390: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
-0000f3a0: 6528 2269 6e73 6572 7420 696e 746f 2061  e("insert into a
-0000f3b0: 7220 2863 312c 6333 2920 7661 6c75 6573  r (c1,c3) values
-0000f3c0: 2028 3130 332c 3f29 222c 205b 7365 6c66   (103,?)", [self
-0000f3d0: 2e63 335d 290a 2020 2020 2020 2020 2020  .c3]).          
-0000f3e0: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
-0000f3f0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-0000f400: 6375 722e 6578 6563 7574 6528 2273 656c  cur.execute("sel
-0000f410: 6563 7420 6331 2c63 3320 6672 6f6d 2061  ect c1,c3 from a
-0000f420: 7220 7768 6572 6520 6331 3d31 3033 2229  r where c1=103")
-0000f430: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-0000f440: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-0000f450: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000f460: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-0000f470: 616c 2872 6f77 5b31 5d2c 2073 656c 662e  al(row[1], self.
-0000f480: 6333 290a 2020 2020 2020 2020 2020 2020  c3).            
-0000f490: 2320 4348 4152 0a20 2020 2020 2020 2020  # CHAR.         
-0000f4a0: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
-0000f4b0: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
-0000f4c0: 6331 2c63 3429 2076 616c 7565 7320 2831  c1,c4) values (1
-0000f4d0: 3034 2c3f 2922 2c20 5b73 656c 662e 6334  04,?)", [self.c4
-0000f4e0: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
-0000f4f0: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
-0000f500: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0000f510: 2e65 7865 6375 7465 2822 7365 6c65 6374  .execute("select
-0000f520: 2063 312c 6334 2066 726f 6d20 6172 2077   c1,c4 from ar w
-0000f530: 6865 7265 2063 313d 3130 3422 290a 2020  here c1=104").  
-0000f540: 2020 2020 2020 2020 2020 726f 7720 3d20            row = 
-0000f550: 6375 722e 6665 7463 686f 6e65 2829 0a20  cur.fetchone(). 
-0000f560: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000f570: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
-0000f580: 726f 775b 315d 2c20 7365 6c66 2e63 3429  row[1], self.c4)
-0000f590: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
-0000f5a0: 494d 4553 5441 4d50 0a20 2020 2020 2020  IMESTAMP.       
-0000f5b0: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0000f5c0: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
-0000f5d0: 2028 6331 2c63 3529 2076 616c 7565 7320   (c1,c5) values 
-0000f5e0: 2831 3035 2c3f 2922 2c20 5b73 656c 662e  (105,?)", [self.
-0000f5f0: 6335 5d29 0a20 2020 2020 2020 2020 2020  c5]).           
-0000f600: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
-0000f610: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
-0000f620: 7572 2e65 7865 6375 7465 2822 7365 6c65  ur.execute("sele
-0000f630: 6374 2063 312c 6335 2066 726f 6d20 6172  ct c1,c5 from ar
-0000f640: 2077 6865 7265 2063 313d 3130 3522 290a   where c1=105").
-0000f650: 2020 2020 2020 2020 2020 2020 726f 7720              row 
-0000f660: 3d20 6375 722e 6665 7463 686f 6e65 2829  = cur.fetchone()
-0000f670: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f680: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-0000f690: 6c28 726f 775b 315d 2c20 7365 6c66 2e63  l(row[1], self.c
-0000f6a0: 3529 0a20 2020 2020 2020 2020 2020 2023  5).            #
-0000f6b0: 2054 494d 4520 4f4b 0a20 2020 2020 2020   TIME OK.       
-0000f6c0: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0000f6d0: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
-0000f6e0: 2028 6331 2c63 3629 2076 616c 7565 7320   (c1,c6) values 
-0000f6f0: 2831 3036 2c3f 2922 2c20 5b73 656c 662e  (106,?)", [self.
-0000f700: 6336 5d29 0a20 2020 2020 2020 2020 2020  c6]).           
-0000f710: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
-0000f720: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
-0000f730: 7572 2e65 7865 6375 7465 2822 7365 6c65  ur.execute("sele
-0000f740: 6374 2063 312c 6336 2066 726f 6d20 6172  ct c1,c6 from ar
-0000f750: 2077 6865 7265 2063 313d 3130 3622 290a   where c1=106").
-0000f760: 2020 2020 2020 2020 2020 2020 726f 7720              row 
-0000f770: 3d20 6375 722e 6665 7463 686f 6e65 2829  = cur.fetchone()
-0000f780: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f790: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-0000f7a0: 6c28 726f 775b 315d 2c20 7365 6c66 2e63  l(row[1], self.c
-0000f7b0: 3629 0a20 2020 2020 2020 2020 2020 2023  6).            #
-0000f7c0: 2044 4543 494d 414c 2831 302c 3229 0a20   DECIMAL(10,2). 
-0000f7d0: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-0000f7e0: 7865 6375 7465 2822 696e 7365 7274 2069  xecute("insert i
-0000f7f0: 6e74 6f20 6172 2028 6331 2c63 3729 2076  nto ar (c1,c7) v
-0000f800: 616c 7565 7320 2831 3037 2c3f 2922 2c20  alues (107,?)", 
-0000f810: 5b73 656c 662e 6337 5d29 0a20 2020 2020  [self.c7]).     
-0000f820: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
-0000f830: 636f 6d6d 6974 2829 0a20 2020 2020 2020  commit().       
-0000f840: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0000f850: 2822 7365 6c65 6374 2063 312c 6337 2066  ("select c1,c7 f
-0000f860: 726f 6d20 6172 2077 6865 7265 2063 313d  rom ar where c1=
-0000f870: 3130 3722 290a 2020 2020 2020 2020 2020  107").          
-0000f880: 2020 726f 7720 3d20 6375 722e 6665 7463    row = cur.fetc
-0000f890: 686f 6e65 2829 0a20 2020 2020 2020 2020  hone().         
-0000f8a0: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
-0000f8b0: 7374 4571 7561 6c28 726f 775b 315d 2c20  stEqual(row[1], 
-0000f8c0: 7365 6c66 2e63 3729 0a20 2020 2020 2020  self.c7).       
-0000f8d0: 2020 2020 2023 204e 554d 4552 4943 2831       # NUMERIC(1
-0000f8e0: 302c 3229 0a20 2020 2020 2020 2020 2020  0,2).           
-0000f8f0: 2063 7572 2e65 7865 6375 7465 2822 696e   cur.execute("in
-0000f900: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
-0000f910: 2c63 3829 2076 616c 7565 7320 2831 3038  ,c8) values (108
-0000f920: 2c3f 2922 2c20 5b73 656c 662e 6338 5d29  ,?)", [self.c8])
-0000f930: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f940: 662e 636f 6e2e 636f 6d6d 6974 2829 0a20  f.con.commit(). 
-0000f950: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-0000f960: 7865 6375 7465 2822 7365 6c65 6374 2063  xecute("select c
-0000f970: 312c 6338 2066 726f 6d20 6172 2077 6865  1,c8 from ar whe
-0000f980: 7265 2063 313d 3130 3822 290a 2020 2020  re c1=108").    
-0000f990: 2020 2020 2020 2020 726f 7720 3d20 6375          row = cu
-0000f9a0: 722e 6665 7463 686f 6e65 2829 0a20 2020  r.fetchone().   
-0000f9b0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000f9c0: 7365 7274 4c69 7374 4571 7561 6c28 726f  sertListEqual(ro
-0000f9d0: 775b 315d 2c20 7365 6c66 2e63 3829 0a20  w[1], self.c8). 
-0000f9e0: 2020 2020 2020 2020 2020 2023 2053 4d41             # SMA
-0000f9f0: 4c4c 494e 540a 2020 2020 2020 2020 2020  LLINT.          
-0000fa00: 2020 6375 722e 6578 6563 7574 6528 2269    cur.execute("i
-0000fa10: 6e73 6572 7420 696e 746f 2061 7220 2863  nsert into ar (c
-0000fa20: 312c 6339 2920 7661 6c75 6573 2028 3130  1,c9) values (10
-0000fa30: 392c 3f29 222c 205b 7365 6c66 2e63 395d  9,?)", [self.c9]
-0000fa40: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000fa50: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
-0000fa60: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-0000fa70: 6578 6563 7574 6528 2273 656c 6563 7420  execute("select 
-0000fa80: 6331 2c63 3920 6672 6f6d 2061 7220 7768  c1,c9 from ar wh
-0000fa90: 6572 6520 6331 3d31 3039 2229 0a20 2020  ere c1=109").   
-0000faa0: 2020 2020 2020 2020 2072 6f77 203d 2063           row = c
-0000fab0: 7572 2e66 6574 6368 6f6e 6528 290a 2020  ur.fetchone().  
-0000fac0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0000fad0: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
-0000fae0: 6f77 5b31 5d2c 2073 656c 662e 6339 290a  ow[1], self.c9).
-0000faf0: 2020 2020 2020 2020 2020 2020 2320 4249              # BI
-0000fb00: 4749 4e54 0a20 2020 2020 2020 2020 2020  GINT.           
-0000fb10: 2063 7572 2e65 7865 6375 7465 2822 696e   cur.execute("in
-0000fb20: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
-0000fb30: 2c63 3130 2920 7661 6c75 6573 2028 3131  ,c10) values (11
-0000fb40: 302c 3f29 222c 205b 7365 6c66 2e63 3130  0,?)", [self.c10
-0000fb50: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
-0000fb60: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
-0000fb70: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0000fb80: 2e65 7865 6375 7465 2822 7365 6c65 6374  .execute("select
-0000fb90: 2063 312c 6331 3020 6672 6f6d 2061 7220   c1,c10 from ar 
-0000fba0: 7768 6572 6520 6331 3d31 3130 2229 0a20  where c1=110"). 
-0000fbb0: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-0000fbc0: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
-0000fbd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000fbe0: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
-0000fbf0: 2872 6f77 5b31 5d2c 2073 656c 662e 6331  (row[1], self.c1
-0000fc00: 3029 0a20 2020 2020 2020 2020 2020 2023  0).            #
-0000fc10: 2046 4c4f 4154 0a20 2020 2020 2020 2020   FLOAT.         
-0000fc20: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
-0000fc30: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
-0000fc40: 6331 2c63 3131 2920 7661 6c75 6573 2028  c1,c11) values (
-0000fc50: 3131 312c 3f29 222c 205b 7365 6c66 2e63  111,?)", [self.c
-0000fc60: 3131 5d29 0a20 2020 2020 2020 2020 2020  11]).           
-0000fc70: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
-0000fc80: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
-0000fc90: 7572 2e65 7865 6375 7465 2822 7365 6c65  ur.execute("sele
-0000fca0: 6374 2063 312c 6331 3120 6672 6f6d 2061  ct c1,c11 from a
-0000fcb0: 7220 7768 6572 6520 6331 3d31 3131 2229  r where c1=111")
-0000fcc0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-0000fcd0: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-0000fce0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000fcf0: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-0000fd00: 616c 2872 6f77 5b31 5d2c 2073 656c 662e  al(row[1], self.
-0000fd10: 6331 3129 0a20 2020 2020 2020 2020 2020  c11).           
-0000fd20: 2023 2044 4f55 424c 4520 5052 4543 4953   # DOUBLE PRECIS
-0000fd30: 494f 4e0a 2020 2020 2020 2020 2020 2020  ION.            
-0000fd40: 6375 722e 6578 6563 7574 6528 2269 6e73  cur.execute("ins
-0000fd50: 6572 7420 696e 746f 2061 7220 2863 312c  ert into ar (c1,
-0000fd60: 6331 3229 2076 616c 7565 7320 2831 3132  c12) values (112
-0000fd70: 2c3f 2922 2c20 5b73 656c 662e 6331 325d  ,?)", [self.c12]
-0000fd80: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000fd90: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
-0000fda0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-0000fdb0: 6578 6563 7574 6528 2273 656c 6563 7420  execute("select 
-0000fdc0: 6331 2c63 3132 2066 726f 6d20 6172 2077  c1,c12 from ar w
-0000fdd0: 6865 7265 2063 313d 3131 3222 290a 2020  here c1=112").  
-0000fde0: 2020 2020 2020 2020 2020 726f 7720 3d20            row = 
-0000fdf0: 6375 722e 6665 7463 686f 6e65 2829 0a20  cur.fetchone(). 
-0000fe00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000fe10: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
-0000fe20: 726f 775b 315d 2c20 7365 6c66 2e63 3132  row[1], self.c12
-0000fe30: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0000fe40: 4445 4349 4d41 4c28 3130 2c31 2920 4f4b  DECIMAL(10,1) OK
-0000fe50: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0000fe60: 2e65 7865 6375 7465 2822 696e 7365 7274  .execute("insert
-0000fe70: 2069 6e74 6f20 6172 2028 6331 2c63 3133   into ar (c1,c13
-0000fe80: 2920 7661 6c75 6573 2028 3131 332c 3f29  ) values (113,?)
-0000fe90: 222c 205b 7365 6c66 2e63 3133 5d29 0a20  ", [self.c13]). 
-0000fea0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000feb0: 636f 6e2e 636f 6d6d 6974 2829 0a20 2020  con.commit().   
-0000fec0: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-0000fed0: 6375 7465 2822 7365 6c65 6374 2063 312c  cute("select c1,
-0000fee0: 6331 3320 6672 6f6d 2061 7220 7768 6572  c13 from ar wher
-0000fef0: 6520 6331 3d31 3133 2229 0a20 2020 2020  e c1=113").     
-0000ff00: 2020 2020 2020 2072 6f77 203d 2063 7572         row = cur
-0000ff10: 2e66 6574 6368 6f6e 6528 290a 2020 2020  .fetchone().    
-0000ff20: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000ff30: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
-0000ff40: 5b31 5d2c 2073 656c 662e 6331 3329 0a20  [1], self.c13). 
-0000ff50: 2020 2020 2020 2020 2020 2023 2044 4543             # DEC
-0000ff60: 494d 414c 2831 302c 3529 0a20 2020 2020  IMAL(10,5).     
-0000ff70: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
-0000ff80: 7465 2822 696e 7365 7274 2069 6e74 6f20  te("insert into 
-0000ff90: 6172 2028 6331 2c63 3134 2920 7661 6c75  ar (c1,c14) valu
-0000ffa0: 6573 2028 3131 342c 3f29 222c 205b 7365  es (114,?)", [se
-0000ffb0: 6c66 2e63 3134 5d29 0a20 2020 2020 2020  lf.c14]).       
-0000ffc0: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
-0000ffd0: 6d6d 6974 2829 0a20 2020 2020 2020 2020  mmit().         
-0000ffe0: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
-0000fff0: 7365 6c65 6374 2063 312c 6331 3420 6672  select c1,c14 fr
-00010000: 6f6d 2061 7220 7768 6572 6520 6331 3d31  om ar where c1=1
-00010010: 3134 2229 0a20 2020 2020 2020 2020 2020  14").           
-00010020: 2072 6f77 203d 2063 7572 2e66 6574 6368   row = cur.fetch
-00010030: 6f6e 6528 290a 2020 2020 2020 2020 2020  one().          
-00010040: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
-00010050: 7445 7175 616c 2872 6f77 5b31 5d2c 2073  tEqual(row[1], s
-00010060: 656c 662e 6331 3429 0a20 2020 2020 2020  elf.c14).       
-00010070: 2020 2020 2023 2044 4543 494d 414c 2831       # DECIMAL(1
-00010080: 382c 3529 0a20 2020 2020 2020 2020 2020  8,5).           
-00010090: 2063 7572 2e65 7865 6375 7465 2822 696e   cur.execute("in
-000100a0: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
-000100b0: 2c63 3135 2920 7661 6c75 6573 2028 3131  ,c15) values (11
-000100c0: 352c 3f29 222c 205b 7365 6c66 2e63 3135  5,?)", [self.c15
-000100d0: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
-000100e0: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
-000100f0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-00010100: 2e65 7865 6375 7465 2822 7365 6c65 6374  .execute("select
-00010110: 2063 312c 6331 3520 6672 6f6d 2061 7220   c1,c15 from ar 
-00010120: 7768 6572 6520 6331 3d31 3135 2229 0a20  where c1=115"). 
-00010130: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-00010140: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
-00010150: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010160: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
-00010170: 2872 6f77 5b31 5d2c 2073 656c 662e 6331  (row[1], self.c1
-00010180: 3529 0a20 2020 2020 2020 2020 2020 2023  5).            #
-00010190: 2042 4f4f 4c45 414e 0a20 2020 2020 2020   BOOLEAN.       
-000101a0: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-000101b0: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
-000101c0: 2028 6331 2c63 3136 2920 7661 6c75 6573   (c1,c16) values
-000101d0: 2028 3131 362c 3f29 222c 205b 7365 6c66   (116,?)", [self
-000101e0: 2e63 3136 5d29 0a20 2020 2020 2020 2020  .c16]).         
-000101f0: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
-00010200: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
-00010210: 2063 7572 2e65 7865 6375 7465 2822 7365   cur.execute("se
-00010220: 6c65 6374 2063 312c 6331 3620 6672 6f6d  lect c1,c16 from
-00010230: 2061 7220 7768 6572 6520 6331 3d31 3136   ar where c1=116
-00010240: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-00010250: 6f77 203d 2063 7572 2e66 6574 6368 6f6e  ow = cur.fetchon
-00010260: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00010270: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
-00010280: 7175 616c 2872 6f77 5b31 5d2c 2073 656c  qual(row[1], sel
-00010290: 662e 6331 3629 0a20 2020 2064 6566 2074  f.c16).    def t
-000102a0: 6573 745f 7772 6974 655f 7772 6f6e 6728  est_write_wrong(
-000102b0: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
-000102c0: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-000102d0: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-000102e0: 2020 2020 2020 2020 2020 7769 7468 2073            with s
-000102f0: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
-00010300: 2856 616c 7565 4572 726f 7229 2061 7320  (ValueError) as 
-00010310: 636d 3a0a 2020 2020 2020 2020 2020 2020  cm:.            
-00010320: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
-00010330: 2269 6e73 6572 7420 696e 746f 2061 7220  "insert into ar 
-00010340: 2863 312c 6332 2920 7661 6c75 6573 2028  (c1,c2) values (
-00010350: 3130 322c 3f29 222c 205b 7365 6c66 2e63  102,?)", [self.c
-00010360: 335d 290a 2020 2020 2020 2020 2020 2020  3]).            
-00010370: 7365 6c66 2e61 7373 6572 7454 7570 6c65  self.assertTuple
-00010380: 4571 7561 6c28 636d 2e65 7863 6570 7469  Equal(cm.excepti
-00010390: 6f6e 2e61 7267 732c 2028 2749 6e63 6f72  on.args, ('Incor
-000103a0: 7265 6374 2041 5252 4159 2066 6965 6c64  rect ARRAY field
-000103b0: 2076 616c 7565 2e27 2c29 290a 2020 2020   value.',)).    
-000103c0: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-000103d0: 662e 6173 7365 7274 5261 6973 6573 2856  f.assertRaises(V
-000103e0: 616c 7565 4572 726f 7229 2061 7320 636d  alueError) as cm
-000103f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010400: 2020 6375 722e 6578 6563 7574 6528 2269    cur.execute("i
-00010410: 6e73 6572 7420 696e 746f 2061 7220 2863  nsert into ar (c
-00010420: 312c 6332 2920 7661 6c75 6573 2028 3130  1,c2) values (10
-00010430: 322c 3f29 222c 205b 7365 6c66 2e63 325b  2,?)", [self.c2[
-00010440: 3a2d 315d 5d29 0a20 2020 2020 2020 2020  :-1]]).         
-00010450: 2020 2073 656c 662e 6173 7365 7274 5475     self.assertTu
-00010460: 706c 6545 7175 616c 2863 6d2e 6578 6365  pleEqual(cm.exce
-00010470: 7074 696f 6e2e 6172 6773 2c20 2827 496e  ption.args, ('In
-00010480: 636f 7272 6563 7420 4152 5241 5920 6669  correct ARRAY fi
-00010490: 656c 6420 7661 6c75 652e 272c 2929 0a0a  eld value.',))..
-000104a0: 636c 6173 7320 5465 7374 496e 7365 7274  class TestInsert
-000104b0: 4461 7461 2844 7269 7665 7254 6573 7442  Data(DriverTestB
-000104c0: 6173 6529 3a0a 2020 2020 6465 6620 7365  ase):.    def se
-000104d0: 7455 7028 7365 6c66 293a 0a20 2020 2020  tUp(self):.     
-000104e0: 2020 2073 7570 6572 2829 2e73 6574 5570     super().setUp
-000104f0: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-00010500: 6462 6669 6c65 203d 206f 732e 7061 7468  dbfile = os.path
-00010510: 2e6a 6f69 6e28 7365 6c66 2e64 6270 6174  .join(self.dbpat
-00010520: 682c 2073 656c 662e 4642 5445 5354 5f44  h, self.FBTEST_D
-00010530: 4229 0a20 2020 2020 2020 2073 656c 662e  B).        self.
-00010540: 636f 6e20 3d20 636f 6e6e 6563 7428 7365  con = connect(se
-00010550: 6c66 2e64 6266 696c 652c 2075 7365 723d  lf.dbfile, user=
-00010560: 4642 5445 5354 5f55 5345 522c 2070 6173  FBTEST_USER, pas
-00010570: 7377 6f72 643d 4642 5445 5354 5f50 4153  sword=FBTEST_PAS
-00010580: 5357 4f52 4429 0a20 2020 2020 2020 2073  SWORD).        s
-00010590: 656c 662e 636f 6e2e 5f6c 6f67 6769 6e67  elf.con._logging
-000105a0: 5f69 645f 203d 2073 656c 662e 5f5f 636c  _id_ = self.__cl
-000105b0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20  ass__.__name__. 
-000105c0: 2020 2020 2020 2073 656c 662e 636f 6e32         self.con2
-000105d0: 203d 2063 6f6e 6e65 6374 2873 656c 662e   = connect(self.
-000105e0: 6462 6669 6c65 2c20 7573 6572 3d46 4254  dbfile, user=FBT
-000105f0: 4553 545f 5553 4552 2c20 7061 7373 776f  EST_USER, passwo
-00010600: 7264 3d46 4254 4553 545f 5041 5353 574f  rd=FBTEST_PASSWO
-00010610: 5244 2c20 6368 6172 7365 743d 2775 7466  RD, charset='utf
-00010620: 2d38 2729 0a20 2020 2020 2020 2073 656c  -8').        sel
-00010630: 662e 636f 6e32 2e5f 6c6f 6767 696e 675f  f.con2._logging_
-00010640: 6964 5f20 3d20 7365 6c66 2e5f 5f63 6c61  id_ = self.__cla
-00010650: 7373 5f5f 2e5f 5f6e 616d 655f 5f0a 2020  ss__.__name__.  
-00010660: 2020 2020 2020 2373 656c 662e 636f 6e2e        #self.con.
-00010670: 6578 6563 7574 655f 696d 6d65 6469 6174  execute_immediat
-00010680: 6528 2272 6563 7265 6174 6520 7461 626c  e("recreate tabl
-00010690: 6520 7420 2863 3120 696e 7465 6765 7229  e t (c1 integer)
-000106a0: 2229 0a20 2020 2020 2020 2023 7365 6c66  ").        #self
-000106b0: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 2020  .con.commit().  
-000106c0: 2020 2020 2020 2373 656c 662e 636f 6e2e        #self.con.
-000106d0: 6578 6563 7574 655f 696d 6d65 6469 6174  execute_immediat
-000106e0: 6528 2252 4543 5245 4154 4520 5441 424c  e("RECREATE TABL
-000106f0: 4520 5432 2028 4331 2053 6d61 6c6c 696e  E T2 (C1 Smallin
-00010700: 742c 4332 2049 6e74 6567 6572 2c43 3320  t,C2 Integer,C3 
-00010710: 4269 6769 6e74 2c43 3420 4368 6172 2835  Bigint,C4 Char(5
-00010720: 292c 4335 2056 6172 6368 6172 2831 3029  ),C5 Varchar(10)
-00010730: 2c43 3620 4461 7465 2c43 3720 5469 6d65  ,C6 Date,C7 Time
-00010740: 2c43 3820 5469 6d65 7374 616d 702c 4339  ,C8 Timestamp,C9
-00010750: 2042 6c6f 6220 7375 625f 7479 7065 2031   Blob sub_type 1
-00010760: 2c43 3130 204e 756d 6572 6963 2831 382c  ,C10 Numeric(18,
-00010770: 3229 2c43 3131 2044 6563 696d 616c 2831  2),C11 Decimal(1
-00010780: 382c 3229 2c43 3132 2046 6c6f 6174 2c43  8,2),C12 Float,C
-00010790: 3133 2044 6f75 626c 6520 7072 6563 6973  13 Double precis
-000107a0: 696f 6e2c 4331 3420 4e75 6d65 7269 6328  ion,C14 Numeric(
-000107b0: 382c 3429 2c43 3135 2044 6563 696d 616c  8,4),C15 Decimal
-000107c0: 2838 2c34 2929 2229 0a20 2020 2020 2020  (8,4))").       
-000107d0: 2073 656c 662e 636f 6e2e 6578 6563 7574   self.con.execut
-000107e0: 655f 696d 6d65 6469 6174 6528 2264 656c  e_immediate("del
-000107f0: 6574 6520 6672 6f6d 2074 2229 0a20 2020  ete from t").   
-00010800: 2020 2020 2073 656c 662e 636f 6e2e 6578       self.con.ex
-00010810: 6563 7574 655f 696d 6d65 6469 6174 6528  ecute_immediate(
-00010820: 2264 656c 6574 6520 6672 6f6d 2074 3222  "delete from t2"
-00010830: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
-00010840: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
-00010850: 6465 6620 7465 6172 446f 776e 2873 656c  def tearDown(sel
-00010860: 6629 3a0a 2020 2020 2020 2020 7365 6c66  f):.        self
-00010870: 2e63 6f6e 322e 636c 6f73 6528 290a 2020  .con2.close().  
-00010880: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
-00010890: 6c6f 7365 2829 0a20 2020 2064 6566 2074  lose().    def t
-000108a0: 6573 745f 696e 7365 7274 5f69 6e74 6567  est_insert_integ
-000108b0: 6572 7328 7365 6c66 293a 0a20 2020 2020  ers(self):.     
-000108c0: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
-000108d0: 2e63 7572 736f 7228 2920 6173 2063 7572  .cursor() as cur
-000108e0: 3a0a 2020 2020 2020 2020 2020 2020 6375  :.            cu
-000108f0: 722e 6578 6563 7574 6528 2769 6e73 6572  r.execute('inser
-00010900: 7420 696e 746f 2054 3220 2843 312c 4332  t into T2 (C1,C2
-00010910: 2c43 3329 2076 616c 7565 7320 283f 2c3f  ,C3) values (?,?
-00010920: 2c3f 2927 2c20 5b31 2c20 312c 2031 5d29  ,?)', [1, 1, 1])
-00010930: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00010940: 662e 636f 6e2e 636f 6d6d 6974 2829 0a20  f.con.commit(). 
-00010950: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-00010960: 7865 6375 7465 2827 7365 6c65 6374 2043  xecute('select C
-00010970: 312c 4332 2c43 3320 6672 6f6d 2054 3220  1,C2,C3 from T2 
-00010980: 7768 6572 6520 4331 203d 2031 2729 0a20  where C1 = 1'). 
-00010990: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
-000109a0: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
-000109b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000109c0: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-000109d0: 6c28 726f 7773 2c20 5b28 312c 2031 2c20  l(rows, [(1, 1, 
-000109e0: 3129 5d29 0a20 2020 2020 2020 2020 2020  1)]).           
-000109f0: 2063 7572 2e65 7865 6375 7465 2827 696e   cur.execute('in
-00010a00: 7365 7274 2069 6e74 6f20 5432 2028 4331  sert into T2 (C1
-00010a10: 2c43 322c 4333 2920 7661 6c75 6573 2028  ,C2,C3) values (
-00010a20: 3f2c 3f2c 3f29 272c 0a20 2020 2020 2020  ?,?,?)',.       
-00010a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a40: 205b 322c 2031 2c20 3932 3233 3337 3230   [2, 1, 92233720
-00010a50: 3336 3835 3437 3735 3830 375d 290a 2020  36854775807]).  
-00010a60: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-00010a70: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
-00010a80: 746f 2054 3220 2843 312c 4332 2c43 3329  to T2 (C1,C2,C3)
-00010a90: 2076 616c 7565 7320 283f 2c3f 2c3f 2927   values (?,?,?)'
-00010aa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010ab0: 2020 2020 2020 2020 2020 5b32 2c20 312c            [2, 1,
-00010ac0: 202d 3932 3233 3337 3230 3336 3835 3437   -92233720368547
-00010ad0: 3735 3830 372d 315d 290a 2020 2020 2020  75807-1]).      
-00010ae0: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
-00010af0: 6f6d 6d69 7428 290a 2020 2020 2020 2020  ommit().        
-00010b00: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
-00010b10: 2773 656c 6563 7420 4331 2c43 322c 4333  'select C1,C2,C3
-00010b20: 2066 726f 6d20 5432 2077 6865 7265 2043   from T2 where C
-00010b30: 3120 3d20 3227 290a 2020 2020 2020 2020  1 = 2').        
-00010b40: 2020 2020 726f 7773 203d 2063 7572 2e66      rows = cur.f
-00010b50: 6574 6368 616c 6c28 290a 2020 2020 2020  etchall().      
-00010b60: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00010b70: 744c 6973 7445 7175 616c 2872 6f77 732c  tListEqual(rows,
-00010b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ba0: 2020 5b28 322c 2031 2c20 3932 3233 3337    [(2, 1, 922337
-00010bb0: 3230 3336 3835 3437 3735 3830 3729 2c20  2036854775807), 
-00010bc0: 2832 2c20 312c 202d 3932 3233 3337 3230  (2, 1, -92233720
-00010bd0: 3336 3835 3437 3735 3830 3829 5d29 0a20  36854775808)]). 
-00010be0: 2020 2064 6566 2074 6573 745f 696e 7365     def test_inse
-00010bf0: 7274 5f63 6861 725f 7661 7263 6861 7228  rt_char_varchar(
-00010c00: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
-00010c10: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-00010c20: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-00010c30: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-00010c40: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
-00010c50: 746f 2054 3220 2843 312c 4334 2c43 3529  to T2 (C1,C4,C5)
-00010c60: 2076 616c 7565 7320 283f 2c3f 2c3f 2927   values (?,?,?)'
-00010c70: 2c20 5b32 2c20 2741 4127 2c20 2741 4127  , [2, 'AA', 'AA'
-00010c80: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
-00010c90: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
-00010ca0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-00010cb0: 2e65 7865 6375 7465 2827 7365 6c65 6374  .execute('select
-00010cc0: 2043 312c 4334 2c43 3520 6672 6f6d 2054   C1,C4,C5 from T
-00010cd0: 3220 7768 6572 6520 4331 203d 2032 2729  2 where C1 = 2')
-00010ce0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-00010cf0: 7320 3d20 6375 722e 6665 7463 6861 6c6c  s = cur.fetchall
-00010d00: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-00010d10: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
-00010d20: 7561 6c28 726f 7773 2c20 5b28 322c 2027  ual(rows, [(2, '
-00010d30: 4141 2020 2027 2c20 2741 4127 295d 290a  AA   ', 'AA')]).
-00010d40: 2020 2020 2020 2020 2020 2020 2320 546f              # To
-00010d50: 6f20 6c6f 6e67 2076 616c 7565 730a 2020  o long values.  
-00010d60: 2020 2020 2020 2020 2020 7769 7468 2073            with s
-00010d70: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
-00010d80: 2844 6174 6162 6173 6545 7272 6f72 2920  (DatabaseError) 
-00010d90: 6173 2063 6d3a 0a20 2020 2020 2020 2020  as cm:.         
-00010da0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
-00010db0: 7465 2827 696e 7365 7274 2069 6e74 6f20  te('insert into 
-00010dc0: 5432 2028 4331 2c43 3429 2076 616c 7565  T2 (C1,C4) value
-00010dd0: 7320 283f 2c3f 2927 2c20 5b33 2c20 2731  s (?,?)', [3, '1
-00010de0: 3233 3435 3627 5d29 0a20 2020 2020 2020  23456']).       
-00010df0: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-00010e00: 6e2e 636f 6d6d 6974 2829 0a20 2020 2020  n.commit().     
-00010e10: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00010e20: 7274 5475 706c 6545 7175 616c 2863 6d2e  rtTupleEqual(cm.
-00010e30: 6578 6365 7074 696f 6e2e 6172 6773 2c0a  exception.args,.
-00010e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e60: 2020 2827 4479 6e61 6d69 6320 5351 4c20    ('Dynamic SQL 
-00010e70: 4572 726f 725c 6e2d 5351 4c20 6572 726f  Error\n-SQL erro
-00010e80: 7220 636f 6465 203d 202d 3330 335c 6e2d  r code = -303\n-
-00010e90: 6172 6974 686d 6574 6963 2065 7863 6570  arithmetic excep
-00010ea0: 7469 6f6e 2c20 6e75 6d65 7269 6320 6f76  tion, numeric ov
-00010eb0: 6572 666c 6f77 2c20 6f72 2073 7472 696e  erflow, or strin
-00010ec0: 6720 7472 756e 6361 7469 6f6e 5c6e 2d73  g truncation\n-s
-00010ed0: 7472 696e 6720 7269 6768 7420 7472 756e  tring right trun
-00010ee0: 6361 7469 6f6e 5c6e 2d65 7870 6563 7465  cation\n-expecte
-00010ef0: 6420 6c65 6e67 7468 2035 2c20 6163 7475  d length 5, actu
-00010f00: 616c 2036 272c 2929 0a20 2020 2020 2020  al 6',)).       
-00010f10: 2020 2020 2077 6974 6820 7365 6c66 2e61       with self.a
-00010f20: 7373 6572 7452 6169 7365 7328 4461 7461  ssertRaises(Data
-00010f30: 6261 7365 4572 726f 7229 2061 7320 636d  baseError) as cm
-00010f40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010f50: 2020 6375 722e 6578 6563 7574 6528 2769    cur.execute('i
-00010f60: 6e73 6572 7420 696e 746f 2054 3220 2843  nsert into T2 (C
-00010f70: 312c 4335 2920 7661 6c75 6573 2028 3f2c  1,C5) values (?,
-00010f80: 3f29 272c 205b 332c 2027 3132 3334 3536  ?)', [3, '123456
-00010f90: 3738 3930 3127 5d29 0a20 2020 2020 2020  78901']).       
-00010fa0: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-00010fb0: 6e2e 636f 6d6d 6974 2829 0a20 2020 2020  n.commit().     
-00010fc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00010fd0: 6173 7365 7274 5475 706c 6545 7175 616c  assertTupleEqual
-00010fe0: 2863 6d2e 6578 6365 7074 696f 6e2e 6172  (cm.exception.ar
-00010ff0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00011000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011010: 2020 2020 2020 2020 2020 2827 4479 6e61            ('Dyna
-00011020: 6d69 6320 5351 4c20 4572 726f 725c 6e2d  mic SQL Error\n-
-00011030: 5351 4c20 6572 726f 7220 636f 6465 203d  SQL error code =
-00011040: 202d 3330 335c 6e2d 6172 6974 686d 6574   -303\n-arithmet
-00011050: 6963 2065 7863 6570 7469 6f6e 2c20 6e75  ic exception, nu
-00011060: 6d65 7269 6320 6f76 6572 666c 6f77 2c20  meric overflow, 
-00011070: 6f72 2073 7472 696e 6720 7472 756e 6361  or string trunca
-00011080: 7469 6f6e 5c6e 2d73 7472 696e 6720 7269  tion\n-string ri
-00011090: 6768 7420 7472 756e 6361 7469 6f6e 5c6e  ght truncation\n
-000110a0: 2d65 7870 6563 7465 6420 6c65 6e67 7468  -expected length
-000110b0: 2031 302c 2061 6374 7561 6c20 3131 272c   10, actual 11',
-000110c0: 2929 0a20 2020 2064 6566 2074 6573 745f  )).    def test_
-000110d0: 696e 7365 7274 5f64 6174 6574 696d 6528  insert_datetime(
-000110e0: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
-000110f0: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-00011100: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-00011110: 2020 2020 2020 2020 2020 6e6f 7720 3d20            now = 
-00011120: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
-00011130: 6528 3230 3131 2c20 3131 2c20 3133 2c20  e(2011, 11, 13, 
-00011140: 3135 2c20 3030 2c20 312c 2032 3030 3030  15, 00, 1, 20000
-00011150: 3029 0a20 2020 2020 2020 2020 2020 2063  0).            c
-00011160: 7572 2e65 7865 6375 7465 2827 696e 7365  ur.execute('inse
-00011170: 7274 2069 6e74 6f20 5432 2028 4331 2c43  rt into T2 (C1,C
-00011180: 362c 4337 2c43 3829 2076 616c 7565 7320  6,C7,C8) values 
-00011190: 283f 2c3f 2c3f 2c3f 2927 2c20 5b33 2c20  (?,?,?,?)', [3, 
-000111a0: 6e6f 772e 6461 7465 2829 2c20 6e6f 772e  now.date(), now.
-000111b0: 7469 6d65 2829 2c20 6e6f 775d 290a 2020  time(), now]).  
-000111c0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-000111d0: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
-000111e0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-000111f0: 7574 6528 2773 656c 6563 7420 4331 2c43  ute('select C1,C
-00011200: 362c 4337 2c43 3820 6672 6f6d 2054 3220  6,C7,C8 from T2 
-00011210: 7768 6572 6520 4331 203d 2033 2729 0a20  where C1 = 3'). 
-00011220: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
-00011230: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
-00011240: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00011250: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-00011260: 6c28 726f 7773 2c0a 2020 2020 2020 2020  l(rows,.        
+0000cd70: 2e66 6574 6368 6f6e 6528 292c 2072 6f77  .fetchone(), row
+0000cd80: 735b 365d 290a 2020 2020 2020 2020 2020  s[6]).          
+0000cd90: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000cda0: 744c 6973 7445 7175 616c 2863 7572 2e66  tListEqual(cur.f
+0000cdb0: 6574 6368 616c 6c28 292c 2072 6f77 735b  etchall(), rows[
+0000cdc0: 373a 5d29 0a20 2020 2020 2020 2020 2020  7:]).           
+0000cdd0: 2020 2020 2063 7572 2e66 6574 6368 5f61       cur.fetch_a
+0000cde0: 6273 6f6c 7574 6528 3729 0a20 2020 2020  bsolute(7).     
+0000cdf0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ce00: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
+0000ce10: 6375 722e 6665 7463 6861 6c6c 2829 2c20  cur.fetchall(), 
+0000ce20: 726f 7773 5b37 3a5d 290a 2020 2020 6465  rows[7:]).    de
+0000ce30: 6620 7465 7374 5f72 656d 6f74 655f 7363  f test_remote_sc
+0000ce40: 726f 6c6c 6162 6c65 2873 656c 6629 3a0a  rollable(self):.
+0000ce50: 2020 2020 2020 2020 7365 6c66 2e64 6266          self.dbf
+0000ce60: 696c 6520 3d20 6f73 2e70 6174 682e 6a6f  ile = os.path.jo
+0000ce70: 696e 2873 656c 662e 6462 7061 7468 2c20  in(self.dbpath, 
+0000ce80: 7365 6c66 2e46 4254 4553 545f 4442 290a  self.FBTEST_DB).
+0000ce90: 2020 2020 2020 2020 6462 5f63 6f6e 6669          db_confi
+0000cea0: 6720 3d20 6622 2222 0a20 2020 2020 2020  g = f""".       
+0000ceb0: 205b 7265 6d6f 7465 5f73 6372 6f6c 6c61   [remote_scrolla
+0000cec0: 626c 655d 0a20 2020 2020 2020 2064 6174  ble].        dat
+0000ced0: 6162 6173 6520 3d20 7b73 656c 662e 6462  abase = {self.db
+0000cee0: 6669 6c65 7d0a 2020 2020 2020 2020 7365  file}.        se
+0000cef0: 7276 6572 203d 2046 4254 4553 545f 484f  rver = FBTEST_HO
+0000cf00: 5354 0a20 2020 2020 2020 2022 2222 0a20  ST.        """. 
+0000cf10: 2020 2020 2020 2064 7269 7665 725f 636f         driver_co
+0000cf20: 6e66 6967 2e72 6567 6973 7465 725f 6461  nfig.register_da
+0000cf30: 7461 6261 7365 2827 7265 6d6f 7465 5f73  tabase('remote_s
+0000cf40: 6372 6f6c 6c61 626c 6527 2c20 6462 5f63  crollable', db_c
+0000cf50: 6f6e 6669 6729 0a20 2020 2020 2020 2023  onfig).        #
+0000cf60: 0a20 2020 2020 2020 2072 6f77 7320 3d20  .        rows = 
+0000cf70: 5b28 2755 5341 272c 2027 446f 6c6c 6172  [('USA', 'Dollar
+0000cf80: 2729 2c20 2827 456e 676c 616e 6427 2c20  '), ('England', 
+0000cf90: 2750 6f75 6e64 2729 2c20 2827 4361 6e61  'Pound'), ('Cana
+0000cfa0: 6461 272c 2027 4364 6e44 6c72 2729 2c0a  da', 'CdnDlr'),.
+0000cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cfc0: 2827 5377 6974 7a65 726c 616e 6427 2c20  ('Switzerland', 
+0000cfd0: 2753 4672 616e 6327 292c 2028 274a 6170  'SFranc'), ('Jap
+0000cfe0: 616e 272c 2027 5965 6e27 292c 2028 2749  an', 'Yen'), ('I
+0000cff0: 7461 6c79 272c 2027 4575 726f 2729 2c0a  taly', 'Euro'),.
+0000d000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d010: 2827 4672 616e 6365 272c 2027 4575 726f  ('France', 'Euro
+0000d020: 2729 2c20 2827 4765 726d 616e 7927 2c20  '), ('Germany', 
+0000d030: 2745 7572 6f27 292c 2028 2741 7573 7472  'Euro'), ('Austr
+0000d040: 616c 6961 272c 2027 4144 6f6c 6c61 7227  alia', 'ADollar'
+0000d050: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000d060: 2020 2028 2748 6f6e 6720 4b6f 6e67 272c     ('Hong Kong',
+0000d070: 2027 484b 446f 6c6c 6172 2729 2c20 2827   'HKDollar'), ('
+0000d080: 4e65 7468 6572 6c61 6e64 7327 2c20 2745  Netherlands', 'E
+0000d090: 7572 6f27 292c 0a20 2020 2020 2020 2020  uro'),.         
+0000d0a0: 2020 2020 2020 2028 2742 656c 6769 756d         ('Belgium
+0000d0b0: 272c 2027 4575 726f 2729 2c20 2827 4175  ', 'Euro'), ('Au
+0000d0c0: 7374 7269 6127 2c20 2745 7572 6f27 292c  stria', 'Euro'),
+0000d0d0: 2028 2746 696a 6927 2c20 2746 446f 6c6c   ('Fiji', 'FDoll
+0000d0e0: 6172 2729 2c0a 2020 2020 2020 2020 2020  ar'),.          
+0000d0f0: 2020 2020 2020 2827 5275 7373 6961 272c        ('Russia',
+0000d100: 2027 5275 626c 6527 292c 2028 2752 6f6d   'Ruble'), ('Rom
+0000d110: 616e 6961 272c 2027 524c 6575 2729 5d0a  ania', 'RLeu')].
+0000d120: 2020 2020 2020 2020 7769 7468 2063 6f6e          with con
+0000d130: 6e65 6374 2827 7265 6d6f 7465 5f73 6372  nect('remote_scr
+0000d140: 6f6c 6c61 626c 6527 2920 6173 2063 6f6e  ollable') as con
+0000d150: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000d160: 2063 6f6e 2e69 6e66 6f2e 656e 6769 6e65   con.info.engine
+0000d170: 5f76 6572 7369 6f6e 203c 2035 2e30 3a0a  _version < 5.0:.
+0000d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d190: 7365 6c66 2e73 6b69 7054 6573 7428 2752  self.skipTest('R
+0000d1a0: 6571 7569 7265 7320 4669 7265 6269 7264  equires Firebird
+0000d1b0: 2035 2e30 2b27 290a 2020 2020 2020 2020   5.0+').        
+0000d1c0: 2020 2020 230a 2020 2020 2020 2020 2020      #.          
+0000d1d0: 2020 7769 7468 2063 6f6e 2e63 7572 736f    with con.curso
+0000d1e0: 7228 2920 6173 2063 7572 3a0a 2020 2020  r() as cur:.    
+0000d1f0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+0000d200: 6f70 656e 2827 7365 6c65 6374 202a 2066  open('select * f
+0000d210: 726f 6d20 636f 756e 7472 7927 290a 2020  rom country').  
+0000d220: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000d230: 6c66 2e61 7373 6572 7454 7275 6528 6375  lf.assertTrue(cu
+0000d240: 722e 6973 5f62 6f66 2829 290a 2020 2020  r.is_bof()).    
+0000d250: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000d260: 2e61 7373 6572 7446 616c 7365 2863 7572  .assertFalse(cur
+0000d270: 2e69 735f 656f 6628 2929 0a20 2020 2020  .is_eof()).     
+0000d280: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d290: 6173 7365 7274 5475 706c 6545 7175 616c  assertTupleEqual
+0000d2a0: 2863 7572 2e66 6574 6368 5f66 6972 7374  (cur.fetch_first
+0000d2b0: 2829 2c20 726f 7773 5b30 5d29 0a20 2020  (), rows[0]).   
+0000d2c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000d2d0: 662e 6173 7365 7274 5475 706c 6545 7175  f.assertTupleEqu
+0000d2e0: 616c 2863 7572 2e66 6574 6368 5f6e 6578  al(cur.fetch_nex
+0000d2f0: 7428 292c 2072 6f77 735b 315d 290a 2020  t(), rows[1]).  
+0000d300: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000d310: 6c66 2e61 7373 6572 7454 7570 6c65 4571  lf.assertTupleEq
+0000d320: 7561 6c28 6375 722e 6665 7463 685f 7072  ual(cur.fetch_pr
+0000d330: 696f 7228 292c 2072 6f77 735b 305d 290a  ior(), rows[0]).
+0000d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d350: 7365 6c66 2e61 7373 6572 7454 7570 6c65  self.assertTuple
+0000d360: 4571 7561 6c28 6375 722e 6665 7463 685f  Equal(cur.fetch_
+0000d370: 6c61 7374 2829 2c20 726f 7773 5b2d 315d  last(), rows[-1]
+0000d380: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000d390: 2020 7365 6c66 2e61 7373 6572 7446 616c    self.assertFal
+0000d3a0: 7365 2863 7572 2e69 735f 626f 6628 2929  se(cur.is_bof())
+0000d3b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d3c0: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
+0000d3d0: 6e65 2863 7572 2e66 6574 6368 5f6e 6578  ne(cur.fetch_nex
+0000d3e0: 7428 2929 0a20 2020 2020 2020 2020 2020  t()).           
+0000d3f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000d400: 5472 7565 2863 7572 2e69 735f 656f 6628  True(cur.is_eof(
+0000d410: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0000d420: 2020 2073 656c 662e 6173 7365 7274 5475     self.assertTu
+0000d430: 706c 6545 7175 616c 2863 7572 2e66 6574  pleEqual(cur.fet
+0000d440: 6368 5f61 6273 6f6c 7574 6528 3729 2c20  ch_absolute(7), 
+0000d450: 726f 7773 5b36 5d29 0a20 2020 2020 2020  rows[6]).       
+0000d460: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0000d470: 7365 7274 5475 706c 6545 7175 616c 2863  sertTupleEqual(c
+0000d480: 7572 2e66 6574 6368 5f72 656c 6174 6976  ur.fetch_relativ
+0000d490: 6528 2d31 292c 2072 6f77 735b 355d 290a  e(-1), rows[5]).
+0000d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d4b0: 7365 6c66 2e61 7373 6572 7454 7570 6c65  self.assertTuple
+0000d4c0: 4571 7561 6c28 6375 722e 6665 7463 686f  Equal(cur.fetcho
+0000d4d0: 6e65 2829 2c20 726f 7773 5b36 5d29 0a20  ne(), rows[6]). 
+0000d4e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000d4f0: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
+0000d500: 7561 6c28 6375 722e 6665 7463 6861 6c6c  ual(cur.fetchall
+0000d510: 2829 2c20 726f 7773 5b37 3a5d 290a 2020  (), rows[7:]).  
+0000d520: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+0000d530: 722e 6665 7463 685f 6162 736f 6c75 7465  r.fetch_absolute
+0000d540: 2837 290a 2020 2020 2020 2020 2020 2020  (7).            
+0000d550: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
+0000d560: 6973 7445 7175 616c 2863 7572 2e66 6574  istEqual(cur.fet
+0000d570: 6368 616c 6c28 292c 2072 6f77 735b 373a  chall(), rows[7:
+0000d580: 5d29 0a0a 636c 6173 7320 5465 7374 5072  ])..class TestPr
+0000d590: 6570 6172 6564 5374 6174 656d 656e 7428  eparedStatement(
+0000d5a0: 4472 6976 6572 5465 7374 4261 7365 293a  DriverTestBase):
+0000d5b0: 0a20 2020 2064 6566 2073 6574 5570 2873  .    def setUp(s
+0000d5c0: 656c 6629 3a0a 2020 2020 2020 2020 7375  elf):.        su
+0000d5d0: 7065 7228 292e 7365 7455 7028 290a 2020  per().setUp().  
+0000d5e0: 2020 2020 2020 7365 6c66 2e64 6266 696c        self.dbfil
+0000d5f0: 6520 3d20 6f73 2e70 6174 682e 6a6f 696e  e = os.path.join
+0000d600: 2873 656c 662e 6462 7061 7468 2c20 7365  (self.dbpath, se
+0000d610: 6c66 2e46 4254 4553 545f 4442 290a 2020  lf.FBTEST_DB).  
+0000d620: 2020 2020 2020 7365 6c66 2e63 6f6e 203d        self.con =
+0000d630: 2063 6f6e 6e65 6374 2873 656c 662e 6462   connect(self.db
+0000d640: 6669 6c65 2c20 7573 6572 3d46 4254 4553  file, user=FBTES
+0000d650: 545f 5553 4552 2c20 7061 7373 776f 7264  T_USER, password
+0000d660: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
+0000d670: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
+0000d680: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
+0000d690: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
+0000d6a0: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
+0000d6b0: 2020 7365 6c66 2e63 6f6e 3220 3d20 636f    self.con2 = co
+0000d6c0: 6e6e 6563 7428 7365 6c66 2e64 6266 696c  nnect(self.dbfil
+0000d6d0: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
+0000d6e0: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+0000d6f0: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
+0000d700: 2020 2020 2020 2073 656c 662e 636f 6e32         self.con2
+0000d710: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
+0000d720: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
+0000d730: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
+0000d740: 2373 656c 662e 636f 6e2e 6578 6563 7574  #self.con.execut
+0000d750: 655f 696d 6d65 6469 6174 6528 2272 6563  e_immediate("rec
+0000d760: 7265 6174 6520 7461 626c 6520 7420 2863  reate table t (c
+0000d770: 3120 696e 7465 6765 7229 2229 0a20 2020  1 integer)").   
+0000d780: 2020 2020 2073 656c 662e 636f 6e2e 6578       self.con.ex
+0000d790: 6563 7574 655f 696d 6d65 6469 6174 6528  ecute_immediate(
+0000d7a0: 2264 656c 6574 6520 6672 6f6d 2074 2229  "delete from t")
+0000d7b0: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+0000d7c0: 6e2e 636f 6d6d 6974 2829 0a20 2020 2064  n.commit().    d
+0000d7d0: 6566 2074 6561 7244 6f77 6e28 7365 6c66  ef tearDown(self
+0000d7e0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+0000d7f0: 636f 6e2e 636c 6f73 6528 290a 2020 2020  con.close().    
+0000d800: 2020 2020 7365 6c66 2e63 6f6e 322e 636c      self.con2.cl
+0000d810: 6f73 6528 290a 2020 2020 6465 6620 7465  ose().    def te
+0000d820: 7374 5f62 6173 6963 2873 656c 6629 3a0a  st_basic(self):.
+0000d830: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000d840: 6572 744c 6973 7445 7175 616c 2873 656c  ertListEqual(sel
+0000d850: 662e 636f 6e2e 5f73 7461 7465 6d65 6e74  f.con._statement
+0000d860: 732c 205b 5d29 0a20 2020 2020 2020 2077  s, []).        w
+0000d870: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
+0000d880: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
+0000d890: 2020 2020 2020 2020 2020 7073 203d 2063            ps = c
+0000d8a0: 7572 2e70 7265 7061 7265 2827 7365 6c65  ur.prepare('sele
+0000d8b0: 6374 202a 2066 726f 6d20 636f 756e 7472  ct * from countr
+0000d8c0: 7927 290a 2020 2020 2020 2020 2020 2020  y').            
+0000d8d0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0000d8e0: 286c 656e 2873 656c 662e 636f 6e2e 5f73  (len(self.con._s
+0000d8f0: 7461 7465 6d65 6e74 7329 2c20 3129 0a20  tatements), 1). 
+0000d900: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d910: 6173 7365 7274 4571 7561 6c28 7073 2e5f  assertEqual(ps._
+0000d920: 696e 5f63 6e74 2c20 3029 0a20 2020 2020  in_cnt, 0).     
+0000d930: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000d940: 7274 4571 7561 6c28 7073 2e5f 6f75 745f  rtEqual(ps._out_
+0000d950: 636e 742c 2032 290a 2020 2020 2020 2020  cnt, 2).        
+0000d960: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0000d970: 7175 616c 2870 732e 7479 7065 2c20 5374  qual(ps.type, St
+0000d980: 6174 656d 656e 7454 7970 652e 5345 4c45  atementType.SELE
+0000d990: 4354 290a 2020 2020 2020 2020 2020 2020  CT).            
+0000d9a0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0000d9b0: 2870 732e 7371 6c2c 2027 7365 6c65 6374  (ps.sql, 'select
+0000d9c0: 202a 2066 726f 6d20 636f 756e 7472 7927   * from country'
+0000d9d0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000d9e0: 6c66 2e63 6f6e 2e63 6c6f 7365 2829 0a20  lf.con.close(). 
+0000d9f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000da00: 6173 7365 7274 4571 7561 6c28 7365 6c66  assertEqual(self
+0000da10: 2e63 6f6e 2e5f 7374 6174 656d 656e 7473  .con._statements
+0000da20: 2c20 5b5d 290a 2020 2020 6465 6620 7465  , []).    def te
+0000da30: 7374 5f67 6574 5f70 6c61 6e28 7365 6c66  st_get_plan(self
+0000da40: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
+0000da50: 7365 6c66 2e63 6f6e 2e63 7572 736f 7228  self.con.cursor(
+0000da60: 2920 6173 2063 7572 3a0a 2020 2020 2020  ) as cur:.      
+0000da70: 2020 2020 2020 7073 203d 2063 7572 2e70        ps = cur.p
+0000da80: 7265 7061 7265 2827 7365 6c65 6374 202a  repare('select *
+0000da90: 2066 726f 6d20 6a6f 6227 290a 2020 2020   from job').    
+0000daa0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000dab0: 6572 7445 7175 616c 2870 732e 706c 616e  ertEqual(ps.plan
+0000dac0: 2c20 2250 4c41 4e20 284a 4f42 204e 4154  , "PLAN (JOB NAT
+0000dad0: 5552 414c 2922 290a 2020 2020 6465 6620  URAL)").    def 
+0000dae0: 7465 7374 5f65 7865 6375 7469 6f6e 2873  test_execution(s
+0000daf0: 656c 6629 3a0a 2020 2020 2020 2020 7769  elf):.        wi
+0000db00: 7468 2073 656c 662e 636f 6e2e 6375 7273  th self.con.curs
+0000db10: 6f72 2829 2061 7320 6375 723a 0a20 2020  or() as cur:.   
+0000db20: 2020 2020 2020 2020 2070 7320 3d20 6375           ps = cu
+0000db30: 722e 7072 6570 6172 6528 2773 656c 6563  r.prepare('selec
+0000db40: 7420 2a20 6672 6f6d 2063 6f75 6e74 7279  t * from country
+0000db50: 2729 0a20 2020 2020 2020 2020 2020 2063  ').            c
+0000db60: 7572 2e65 7865 6375 7465 2870 7329 0a20  ur.execute(ps). 
+0000db70: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
+0000db80: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
+0000db90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000dba0: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
+0000dbb0: 6c28 726f 772c 2028 2755 5341 272c 2027  l(row, ('USA', '
+0000dbc0: 446f 6c6c 6172 2729 290a 2020 2020 6465  Dollar')).    de
+0000dbd0: 6620 7465 7374 5f77 726f 6e67 5f63 7572  f test_wrong_cur
+0000dbe0: 736f 7228 7365 6c66 293a 0a20 2020 2020  sor(self):.     
+0000dbf0: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
+0000dc00: 2e63 7572 736f 7228 2920 6173 2063 7572  .cursor() as cur
+0000dc10: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
+0000dc20: 7468 2073 656c 662e 636f 6e32 2e63 7572  th self.con2.cur
+0000dc30: 736f 7228 2920 6173 2063 7572 323a 0a20  sor() as cur2:. 
+0000dc40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000dc50: 7320 3d20 6375 722e 7072 6570 6172 6528  s = cur.prepare(
+0000dc60: 2773 656c 6563 7420 2a20 6672 6f6d 2063  'select * from c
+0000dc70: 6f75 6e74 7279 2729 0a20 2020 2020 2020  ountry').       
+0000dc80: 2020 2020 2020 2020 2077 6974 6820 7365           with se
+0000dc90: 6c66 2e61 7373 6572 7452 6169 7365 7328  lf.assertRaises(
+0000dca0: 496e 7465 7266 6163 6545 7272 6f72 2920  InterfaceError) 
+0000dcb0: 6173 2063 6d3a 0a20 2020 2020 2020 2020  as cm:.         
+0000dcc0: 2020 2020 2020 2020 2020 2063 7572 322e             cur2.
+0000dcd0: 6578 6563 7574 6528 7073 290a 2020 2020  execute(ps).    
+0000dce0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000dcf0: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
+0000dd00: 6c28 636d 2e65 7863 6570 7469 6f6e 2e61  l(cm.exception.a
+0000dd10: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0000dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd30: 2020 2020 2020 2020 2020 2028 2743 616e             ('Can
+0000dd40: 6e6f 7420 6578 6563 7574 6520 5374 6174  not execute Stat
+0000dd50: 656d 656e 7420 7468 6174 2077 6173 2063  ement that was c
+0000dd60: 7265 6174 6564 2062 7920 6469 6666 6572  reated by differ
+0000dd70: 656e 7420 436f 6e6e 6563 7469 6f6e 2e27  ent Connection.'
+0000dd80: 2c29 290a 0a63 6c61 7373 2054 6573 7441  ,))..class TestA
+0000dd90: 7272 6179 7328 4472 6976 6572 5465 7374  rrays(DriverTest
+0000dda0: 4261 7365 293a 0a20 2020 2064 6566 2073  Base):.    def s
+0000ddb0: 6574 5570 2873 656c 6629 3a0a 2020 2020  etUp(self):.    
+0000ddc0: 2020 2020 7375 7065 7228 292e 7365 7455      super().setU
+0000ddd0: 7028 290a 2020 2020 2020 2020 7365 6c66  p().        self
+0000dde0: 2e64 6266 696c 6520 3d20 6f73 2e70 6174  .dbfile = os.pat
+0000ddf0: 682e 6a6f 696e 2873 656c 662e 6462 7061  h.join(self.dbpa
+0000de00: 7468 2c20 7365 6c66 2e46 4254 4553 545f  th, self.FBTEST_
+0000de10: 4442 290a 2020 2020 2020 2020 7365 6c66  DB).        self
+0000de20: 2e63 6f6e 203d 2063 6f6e 6e65 6374 2873  .con = connect(s
+0000de30: 656c 662e 6462 6669 6c65 2c20 7573 6572  elf.dbfile, user
+0000de40: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
+0000de50: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+0000de60: 5353 574f 5244 290a 2020 2020 2020 2020  SSWORD).        
+0000de70: 7365 6c66 2e63 6f6e 2e5f 6c6f 6767 696e  self.con._loggin
+0000de80: 675f 6964 5f20 3d20 7365 6c66 2e5f 5f63  g_id_ = self.__c
+0000de90: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f0a  lass__.__name__.
+0000dea0: 2020 2020 2020 2020 7462 6c20 3d20 2222          tbl = ""
+0000deb0: 2272 6563 7265 6174 6520 7461 626c 6520  "recreate table 
+0000dec0: 4152 2028 6331 2069 6e74 6567 6572 2c0a  AR (c1 integer,.
+0000ded0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000def0: 2020 2020 6332 2069 6e74 6567 6572 5b31      c2 integer[1
+0000df00: 3a34 2c30 3a33 2c31 3a32 5d2c 0a20 2020  :4,0:3,1:2],.   
+0000df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df30: 2063 3320 7661 7263 6861 7228 3135 295b   c3 varchar(15)[
+0000df40: 303a 352c 313a 325d 2c0a 2020 2020 2020  0:5,1:2],.      
+0000df50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df60: 2020 2020 2020 2020 2020 2020 2020 6334                c4
+0000df70: 2063 6861 7228 3529 5b35 5d2c 0a20 2020   char(5)[5],.   
+0000df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dfa0: 2063 3520 7469 6d65 7374 616d 705b 325d   c5 timestamp[2]
+0000dfb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dfd0: 2020 2020 2020 6336 2074 696d 655b 325d        c6 time[2]
+0000dfe0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e000: 2020 2020 2020 6337 2064 6563 696d 616c        c7 decimal
+0000e010: 2831 302c 3229 5b32 5d2c 0a20 2020 2020  (10,2)[2],.     
+0000e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e030: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000e040: 3820 6e75 6d65 7269 6328 3130 2c32 295b  8 numeric(10,2)[
+0000e050: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
+0000e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e070: 2020 2020 2020 2020 6339 2073 6d61 6c6c          c9 small
+0000e080: 696e 745b 325d 2c0a 2020 2020 2020 2020  int[2],.        
+0000e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e0a0: 2020 2020 2020 2020 2020 2020 6331 3020              c10 
+0000e0b0: 6269 6769 6e74 5b32 5d2c 0a20 2020 2020  bigint[2],.     
+0000e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e0d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000e0e0: 3131 2066 6c6f 6174 5b32 5d2c 0a20 2020  11 float[2],.   
+0000e0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e110: 2063 3132 2064 6f75 626c 6520 7072 6563   c12 double prec
+0000e120: 6973 696f 6e5b 325d 2c0a 2020 2020 2020  ision[2],.      
+0000e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e140: 2020 2020 2020 2020 2020 2020 2020 6331                c1
+0000e150: 3320 6465 6369 6d61 6c28 3130 2c31 295b  3 decimal(10,1)[
+0000e160: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
+0000e170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e180: 2020 2020 2020 2020 6331 3420 6465 6369          c14 deci
+0000e190: 6d61 6c28 3130 2c35 295b 325d 2c0a 2020  mal(10,5)[2],.  
+0000e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1c0: 2020 6331 3520 6465 6369 6d61 6c28 3138    c15 decimal(18
+0000e1d0: 2c35 295b 325d 0a20 2020 2020 2020 2020  ,5)[2].         
+0000e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1f0: 2020 2020 2020 2020 2020 2029 0a22 2222             )."""
+0000e200: 0a20 2020 2020 2020 2023 0a20 2020 2020  .        #.     
+0000e210: 2020 2073 656c 662e 6332 203d 205b 5b5b     self.c2 = [[[
+0000e220: 312c 2031 5d2c 205b 322c 2032 5d2c 205b  1, 1], [2, 2], [
+0000e230: 332c 2033 5d2c 205b 342c 2034 5d5d 2c20  3, 3], [4, 4]], 
+0000e240: 5b5b 352c 2035 5d2c 205b 362c 2036 5d2c  [[5, 5], [6, 6],
+0000e250: 205b 372c 2037 5d2c 205b 382c 2038 5d5d   [7, 7], [8, 8]]
+0000e260: 2c20 5b5b 392c 2039 5d2c 205b 3130 2c20  , [[9, 9], [10, 
+0000e270: 3130 5d2c 205b 3131 2c20 3131 5d2c 205b  10], [11, 11], [
+0000e280: 3132 2c20 3132 5d5d 2c20 5b5b 3133 2c20  12, 12]], [[13, 
+0000e290: 3133 5d2c 205b 3134 2c20 3134 5d2c 205b  13], [14, 14], [
+0000e2a0: 3135 2c20 3135 5d2c 205b 3136 2c20 3136  15, 15], [16, 16
+0000e2b0: 5d5d 5d0a 2020 2020 2020 2020 7365 6c66  ]]].        self
+0000e2c0: 2e63 3320 3d20 5b5b 2761 272c 2027 6127  .c3 = [['a', 'a'
+0000e2d0: 5d2c 205b 2762 6227 2c20 2762 6227 5d2c  ], ['bb', 'bb'],
+0000e2e0: 205b 2763 6363 272c 2027 6363 6327 5d2c   ['ccc', 'ccc'],
+0000e2f0: 205b 2764 6464 6427 2c20 2764 6464 6427   ['dddd', 'dddd'
+0000e300: 5d2c 205b 2765 6565 6565 272c 2027 6565  ], ['eeeee', 'ee
+0000e310: 6565 6527 5d2c 205b 2766 6666 6666 6666  eee'], ['fffffff
+0000e320: 3738 3930 3132 3334 272c 2027 6666 6666  78901234', 'ffff
+0000e330: 6666 6637 3839 3031 3233 3427 5d5d 0a20  fff78901234']]. 
+0000e340: 2020 2020 2020 2073 656c 662e 6334 203d         self.c4 =
+0000e350: 205b 2761 2020 2020 272c 2027 6262 2020   ['a    ', 'bb  
+0000e360: 2027 2c20 2763 6363 2020 272c 2027 6464   ', 'ccc  ', 'dd
+0000e370: 6464 2027 2c20 2765 6565 6565 275d 0a20  dd ', 'eeeee']. 
+0000e380: 2020 2020 2020 2073 656c 662e 6335 203d         self.c5 =
+0000e390: 205b 6461 7465 7469 6d65 2e64 6174 6574   [datetime.datet
+0000e3a0: 696d 6528 3230 3132 2c20 3131 2c20 3232  ime(2012, 11, 22
+0000e3b0: 2c20 3132 2c20 382c 2032 342c 2034 3734  , 12, 8, 24, 474
+0000e3c0: 3830 3029 2c20 6461 7465 7469 6d65 2e64  800), datetime.d
+0000e3d0: 6174 6574 696d 6528 3230 3132 2c20 3131  atetime(2012, 11
+0000e3e0: 2c20 3232 2c20 3132 2c20 382c 2032 342c  , 22, 12, 8, 24,
+0000e3f0: 2034 3734 3830 3029 5d0a 2020 2020 2020   474800)].      
+0000e400: 2020 7365 6c66 2e63 3620 3d20 5b64 6174    self.c6 = [dat
+0000e410: 6574 696d 652e 7469 6d65 2831 322c 2038  etime.time(12, 8
+0000e420: 2c20 3234 2c20 3437 3438 3030 292c 2064  , 24, 474800), d
+0000e430: 6174 6574 696d 652e 7469 6d65 2831 322c  atetime.time(12,
+0000e440: 2038 2c20 3234 2c20 3437 3438 3030 295d   8, 24, 474800)]
+0000e450: 0a20 2020 2020 2020 2073 656c 662e 6337  .        self.c7
+0000e460: 203d 205b 6465 6369 6d61 6c2e 4465 6369   = [decimal.Deci
+0000e470: 6d61 6c28 2731 302e 3232 2729 2c20 6465  mal('10.22'), de
+0000e480: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
+0000e490: 3030 3030 302e 3333 2729 5d0a 2020 2020  00000.33')].    
+0000e4a0: 2020 2020 7365 6c66 2e63 3820 3d20 5b64      self.c8 = [d
+0000e4b0: 6563 696d 616c 2e44 6563 696d 616c 2827  ecimal.Decimal('
+0000e4c0: 3130 2e32 3227 292c 2064 6563 696d 616c  10.22'), decimal
+0000e4d0: 2e44 6563 696d 616c 2827 3130 3030 3030  .Decimal('100000
+0000e4e0: 2e33 3327 295d 0a20 2020 2020 2020 2073  .33')].        s
+0000e4f0: 656c 662e 6339 203d 205b 312c 2030 5d0a  elf.c9 = [1, 0].
+0000e500: 2020 2020 2020 2020 7365 6c66 2e63 3130          self.c10
+0000e510: 203d 205b 3535 3535 3535 352c 2037 3737   = [5555555, 777
+0000e520: 3737 3737 5d0a 2020 2020 2020 2020 7365  7777].        se
+0000e530: 6c66 2e63 3131 203d 205b 332e 3134 3030  lf.c11 = [3.1400
+0000e540: 3030 3130 3439 3034 3137 352c 2033 2e31  00104904175, 3.1
+0000e550: 3430 3030 3031 3034 3930 3431 3735 5d0a  40000104904175].
+0000e560: 2020 2020 2020 2020 7365 6c66 2e63 3132          self.c12
+0000e570: 203d 205b 332e 3134 2c20 332e 3134 5d0a   = [3.14, 3.14].
+0000e580: 2020 2020 2020 2020 7365 6c66 2e63 3133          self.c13
+0000e590: 203d 205b 6465 6369 6d61 6c2e 4465 6369   = [decimal.Deci
+0000e5a0: 6d61 6c28 2731 302e 3227 292c 2064 6563  mal('10.2'), dec
+0000e5b0: 696d 616c 2e44 6563 696d 616c 2827 3130  imal.Decimal('10
+0000e5c0: 3030 3030 2e33 2729 5d0a 2020 2020 2020  0000.3')].      
+0000e5d0: 2020 7365 6c66 2e63 3134 203d 205b 6465    self.c14 = [de
+0000e5e0: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
+0000e5f0: 302e 3232 3232 3227 292c 2064 6563 696d  0.22222'), decim
+0000e600: 616c 2e44 6563 696d 616c 2827 3130 3030  al.Decimal('1000
+0000e610: 3030 2e33 3333 2729 5d0a 2020 2020 2020  00.333')].      
+0000e620: 2020 7365 6c66 2e63 3135 203d 205b 6465    self.c15 = [de
+0000e630: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
+0000e640: 3030 3030 3030 3030 3030 3030 2e32 3232  000000000000.222
+0000e650: 3232 2729 2c20 6465 6369 6d61 6c2e 4465  22'), decimal.De
+0000e660: 6369 6d61 6c28 2731 3030 3030 3030 3030  cimal('100000000
+0000e670: 3030 3030 2e33 3333 2729 5d0a 2020 2020  0000.333')].    
+0000e680: 2020 2020 7365 6c66 2e63 3136 203d 205b      self.c16 = [
+0000e690: 5472 7565 2c20 4661 6c73 652c 2054 7275  True, False, Tru
+0000e6a0: 655d 0a20 2020 2020 2020 2023 7365 6c66  e].        #self
+0000e6b0: 2e63 6f6e 2e65 7865 6375 7465 5f69 6d6d  .con.execute_imm
+0000e6c0: 6564 6961 7465 2874 626c 290a 2020 2020  ediate(tbl).    
+0000e6d0: 2020 2020 7365 6c66 2e63 6f6e 2e65 7865      self.con.exe
+0000e6e0: 6375 7465 5f69 6d6d 6564 6961 7465 2822  cute_immediate("
+0000e6f0: 6465 6c65 7465 2066 726f 6d20 4152 2077  delete from AR w
+0000e700: 6865 7265 2063 313e 3d31 3030 2229 0a20  here c1>=100"). 
+0000e710: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+0000e720: 636f 6d6d 6974 2829 0a20 2020 2020 2020  commit().       
+0000e730: 2023 6375 7220 3d20 7365 6c66 2e63 6f6e   #cur = self.con
+0000e740: 2e63 7572 736f 7228 290a 2020 2020 2020  .cursor().      
+0000e750: 2020 2363 7572 2e65 7865 6375 7465 2822    #cur.execute("
+0000e760: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
+0000e770: 6331 2c63 322c 6333 2c63 342c 6335 2c63  c1,c2,c3,c4,c5,c
+0000e780: 362c 6337 2c63 382c 6339 2c63 3130 2c63  6,c7,c8,c9,c10,c
+0000e790: 3131 2c63 3132 2920 7661 6c75 6573 2028  11,c12) values (
+0000e7a0: 312c 3f2c 3f2c 3f2c 3f2c 3f2c 3f2c 3f2c  1,?,?,?,?,?,?,?,
+0000e7b0: 3f2c 3f2c 3f2c 3f29 222c 0a20 2020 2020  ?,?,?,?)",.     
+0000e7c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000e7d0: 5b73 656c 662e 6332 2c73 656c 662e 6333  [self.c2,self.c3
+0000e7e0: 2c73 656c 662e 6334 2c73 656c 662e 6335  ,self.c4,self.c5
+0000e7f0: 2c73 656c 662e 6336 2c73 656c 662e 6337  ,self.c6,self.c7
+0000e800: 2c73 656c 662e 6338 2c73 656c 662e 6339  ,self.c8,self.c9
+0000e810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000e820: 2020 2020 2020 2020 2020 2373 656c 662e            #self.
+0000e830: 6331 302c 7365 6c66 2e63 3131 2c73 656c  c10,self.c11,sel
+0000e840: 662e 6331 325d 290a 2020 2020 2020 2020  f.c12]).        
+0000e850: 2363 7572 2e65 7865 6375 7465 2822 696e  #cur.execute("in
+0000e860: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
+0000e870: 2c63 3229 2076 616c 7565 7320 2832 2c3f  ,c2) values (2,?
+0000e880: 2922 2c5b 7365 6c66 2e63 325d 290a 2020  )",[self.c2]).  
+0000e890: 2020 2020 2020 2363 7572 2e65 7865 6375        #cur.execu
+0000e8a0: 7465 2822 696e 7365 7274 2069 6e74 6f20  te("insert into 
+0000e8b0: 6172 2028 6331 2c63 3329 2076 616c 7565  ar (c1,c3) value
+0000e8c0: 7320 2833 2c3f 2922 2c5b 7365 6c66 2e63  s (3,?)",[self.c
+0000e8d0: 335d 290a 2020 2020 2020 2020 2363 7572  3]).        #cur
+0000e8e0: 2e65 7865 6375 7465 2822 696e 7365 7274  .execute("insert
+0000e8f0: 2069 6e74 6f20 6172 2028 6331 2c63 3429   into ar (c1,c4)
+0000e900: 2076 616c 7565 7320 2834 2c3f 2922 2c5b   values (4,?)",[
+0000e910: 7365 6c66 2e63 345d 290a 2020 2020 2020  self.c4]).      
+0000e920: 2020 2363 7572 2e65 7865 6375 7465 2822    #cur.execute("
+0000e930: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
+0000e940: 6331 2c63 3529 2076 616c 7565 7320 2835  c1,c5) values (5
+0000e950: 2c3f 2922 2c5b 7365 6c66 2e63 355d 290a  ,?)",[self.c5]).
+0000e960: 2020 2020 2020 2020 2363 7572 2e65 7865          #cur.exe
+0000e970: 6375 7465 2822 696e 7365 7274 2069 6e74  cute("insert int
+0000e980: 6f20 6172 2028 6331 2c63 3629 2076 616c  o ar (c1,c6) val
+0000e990: 7565 7320 2836 2c3f 2922 2c5b 7365 6c66  ues (6,?)",[self
+0000e9a0: 2e63 365d 290a 2020 2020 2020 2020 2363  .c6]).        #c
+0000e9b0: 7572 2e65 7865 6375 7465 2822 696e 7365  ur.execute("inse
+0000e9c0: 7274 2069 6e74 6f20 6172 2028 6331 2c63  rt into ar (c1,c
+0000e9d0: 3729 2076 616c 7565 7320 2837 2c3f 2922  7) values (7,?)"
+0000e9e0: 2c5b 7365 6c66 2e63 375d 290a 2020 2020  ,[self.c7]).    
+0000e9f0: 2020 2020 2363 7572 2e65 7865 6375 7465      #cur.execute
+0000ea00: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
+0000ea10: 2028 6331 2c63 3829 2076 616c 7565 7320   (c1,c8) values 
+0000ea20: 2838 2c3f 2922 2c5b 7365 6c66 2e63 385d  (8,?)",[self.c8]
+0000ea30: 290a 2020 2020 2020 2020 2363 7572 2e65  ).        #cur.e
+0000ea40: 7865 6375 7465 2822 696e 7365 7274 2069  xecute("insert i
+0000ea50: 6e74 6f20 6172 2028 6331 2c63 3929 2076  nto ar (c1,c9) v
+0000ea60: 616c 7565 7320 2839 2c3f 2922 2c5b 7365  alues (9,?)",[se
+0000ea70: 6c66 2e63 395d 290a 2020 2020 2020 2020  lf.c9]).        
+0000ea80: 2363 7572 2e65 7865 6375 7465 2822 696e  #cur.execute("in
+0000ea90: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
+0000eaa0: 2c63 3130 2920 7661 6c75 6573 2028 3130  ,c10) values (10
+0000eab0: 2c3f 2922 2c5b 7365 6c66 2e63 3130 5d29  ,?)",[self.c10])
+0000eac0: 0a20 2020 2020 2020 2023 6375 722e 6578  .        #cur.ex
+0000ead0: 6563 7574 6528 2269 6e73 6572 7420 696e  ecute("insert in
+0000eae0: 746f 2061 7220 2863 312c 6331 3129 2076  to ar (c1,c11) v
+0000eaf0: 616c 7565 7320 2831 312c 3f29 222c 5b73  alues (11,?)",[s
+0000eb00: 656c 662e 6331 315d 290a 2020 2020 2020  elf.c11]).      
+0000eb10: 2020 2363 7572 2e65 7865 6375 7465 2822    #cur.execute("
+0000eb20: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
+0000eb30: 6331 2c63 3132 2920 7661 6c75 6573 2028  c1,c12) values (
+0000eb40: 3132 2c3f 2922 2c5b 7365 6c66 2e63 3132  12,?)",[self.c12
+0000eb50: 5d29 0a20 2020 2020 2020 2023 6375 722e  ]).        #cur.
+0000eb60: 6578 6563 7574 6528 2269 6e73 6572 7420  execute("insert 
+0000eb70: 696e 746f 2061 7220 2863 312c 6331 3329  into ar (c1,c13)
+0000eb80: 2076 616c 7565 7320 2831 332c 3f29 222c   values (13,?)",
+0000eb90: 5b73 656c 662e 6331 335d 290a 2020 2020  [self.c13]).    
+0000eba0: 2020 2020 2363 7572 2e65 7865 6375 7465      #cur.execute
+0000ebb0: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
+0000ebc0: 2028 6331 2c63 3134 2920 7661 6c75 6573   (c1,c14) values
+0000ebd0: 2028 3134 2c3f 2922 2c5b 7365 6c66 2e63   (14,?)",[self.c
+0000ebe0: 3134 5d29 0a20 2020 2020 2020 2023 6375  14]).        #cu
+0000ebf0: 722e 6578 6563 7574 6528 2269 6e73 6572  r.execute("inser
+0000ec00: 7420 696e 746f 2061 7220 2863 312c 6331  t into ar (c1,c1
+0000ec10: 3529 2076 616c 7565 7320 2831 352c 3f29  5) values (15,?)
+0000ec20: 222c 5b73 656c 662e 6331 355d 290a 2020  ",[self.c15]).  
+0000ec30: 2020 2020 2020 2373 656c 662e 636f 6e2e        #self.con.
+0000ec40: 636f 6d6d 6974 2829 0a20 2020 2064 6566  commit().    def
+0000ec50: 2074 6561 7244 6f77 6e28 7365 6c66 293a   tearDown(self):
+0000ec60: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+0000ec70: 6e2e 636c 6f73 6528 290a 2020 2020 6465  n.close().    de
+0000ec80: 6620 7465 7374 5f62 6173 6963 2873 656c  f test_basic(sel
+0000ec90: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
+0000eca0: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
+0000ecb0: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
+0000ecc0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0000ecd0: 7465 2822 7365 6c65 6374 204c 414e 4755  te("select LANGU
+0000ece0: 4147 455f 5245 5120 6672 6f6d 206a 6f62  AGE_REQ from job
+0000ecf0: 2022 5c0a 2020 2020 2020 2020 2020 2020   "\.            
+0000ed00: 2020 2020 2020 2020 2020 2020 2277 6865              "whe
+0000ed10: 7265 206a 6f62 5f63 6f64 653d 2745 6e67  re job_code='Eng
+0000ed20: 2720 616e 6420 6a6f 625f 6772 6164 653d  ' and job_grade=
+0000ed30: 3320 616e 6420 6a6f 625f 636f 756e 7472  3 and job_countr
+0000ed40: 793d 274a 6170 616e 2722 290a 2020 2020  y='Japan'").    
+0000ed50: 2020 2020 2020 2020 726f 7720 3d20 6375          row = cu
+0000ed60: 722e 6665 7463 686f 6e65 2829 0a20 2020  r.fetchone().   
+0000ed70: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0000ed80: 7365 7274 5475 706c 6545 7175 616c 2872  sertTupleEqual(r
+0000ed90: 6f77 2c0a 2020 2020 2020 2020 2020 2020  ow,.            
+0000eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000edb0: 2020 2020 2020 285b 274a 6170 616e 6573        (['Japanes
+0000edc0: 655c 6e27 2c20 274d 616e 6461 7269 6e5c  e\n', 'Mandarin\
+0000edd0: 6e27 2c20 2745 6e67 6c69 7368 5c6e 272c  n', 'English\n',
+0000ede0: 2027 5c6e 272c 2027 5c6e 275d 2c29 290a   '\n', '\n'],)).
+0000edf0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+0000ee00: 6578 6563 7574 6528 2773 656c 6563 7420  execute('select 
+0000ee10: 5155 4152 545f 4845 4144 5f43 4e54 2066  QUART_HEAD_CNT f
+0000ee20: 726f 6d20 7072 6f6a 5f64 6570 745f 6275  rom proj_dept_bu
+0000ee30: 6467 6574 2729 0a20 2020 2020 2020 2020  dget').         
+0000ee40: 2020 2072 6f77 203d 2063 7572 2e66 6574     row = cur.fet
+0000ee50: 6368 616c 6c28 290a 2020 2020 2020 2020  chall().        
+0000ee60: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
+0000ee70: 6973 7445 7175 616c 2872 6f77 2c0a 2020  istEqual(row,.  
+0000ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee90: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0000eea0: 285b 312c 2031 2c20 312c 2030 5d2c 292c  ([1, 1, 1, 0],),
+0000eeb0: 2028 5b33 2c20 322c 2031 2c20 305d 2c29   ([3, 2, 1, 0],)
+0000eec0: 2c20 285b 302c 2030 2c20 302c 2031 5d2c  , ([0, 0, 0, 1],
+0000eed0: 292c 2028 5b32 2c20 312c 2030 2c20 305d  ), ([2, 1, 0, 0]
+0000eee0: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
+0000eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef00: 2020 2020 2020 285b 312c 2031 2c20 302c        ([1, 1, 0,
+0000ef10: 2030 5d2c 292c 2028 5b31 2c20 312c 2030   0],), ([1, 1, 0
+0000ef20: 2c20 305d 2c29 2c20 285b 312c 2031 2c20  , 0],), ([1, 1, 
+0000ef30: 312c 2031 5d2c 292c 2028 5b32 2c20 332c  1, 1],), ([2, 3,
+0000ef40: 2032 2c20 315d 2c29 2c0a 2020 2020 2020   2, 1],),.      
+0000ef50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef60: 2020 2020 2020 2020 2020 2020 285b 312c              ([1,
+0000ef70: 2031 2c20 322c 2032 5d2c 292c 2028 5b31   1, 2, 2],), ([1
+0000ef80: 2c20 312c 2031 2c20 325d 2c29 2c20 285b  , 1, 1, 2],), ([
+0000ef90: 312c 2031 2c20 312c 2032 5d2c 292c 2028  1, 1, 1, 2],), (
+0000efa0: 5b34 2c20 352c 2036 2c20 365d 2c29 2c0a  [4, 5, 6, 6],),.
+0000efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efd0: 2020 285b 322c 2032 2c20 302c 2033 5d2c    ([2, 2, 0, 3],
+0000efe0: 292c 2028 5b31 2c20 312c 2032 2c20 325d  ), ([1, 1, 2, 2]
+0000eff0: 2c29 2c20 285b 372c 2037 2c20 342c 2034  ,), ([7, 7, 4, 4
+0000f000: 5d2c 292c 2028 5b32 2c20 332c 2033 2c20  ],), ([2, 3, 3, 
+0000f010: 335d 2c29 2c0a 2020 2020 2020 2020 2020  3],),.          
+0000f020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f030: 2020 2020 2020 2020 285b 342c 2035 2c20          ([4, 5, 
+0000f040: 362c 2036 5d2c 292c 2028 5b31 2c20 312c  6, 6],), ([1, 1,
+0000f050: 2031 2c20 315d 2c29 2c20 285b 342c 2035   1, 1],), ([4, 5
+0000f060: 2c20 352c 2033 5d2c 292c 2028 5b34 2c20  , 5, 3],), ([4, 
+0000f070: 332c 2032 2c20 325d 2c29 2c0a 2020 2020  3, 2, 2],),.    
+0000f080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f090: 2020 2020 2020 2020 2020 2020 2020 285b                ([
+0000f0a0: 322c 2032 2c20 322c 2031 5d2c 292c 2028  2, 2, 2, 1],), (
+0000f0b0: 5b31 2c20 312c 2032 2c20 335d 2c29 2c20  [1, 1, 2, 3],), 
+0000f0c0: 285b 332c 2033 2c20 312c 2031 5d2c 292c  ([3, 3, 1, 1],),
+0000f0d0: 2028 5b31 2c20 312c 2030 2c20 305d 2c29   ([1, 1, 0, 0],)
+0000f0e0: 5d29 0a20 2020 2064 6566 2074 6573 745f  ]).    def test_
+0000f0f0: 7265 6164 5f66 756c 6c28 7365 6c66 293a  read_full(self):
+0000f100: 0a20 2020 2020 2020 2077 6974 6820 7365  .        with se
+0000f110: 6c66 2e63 6f6e 2e63 7572 736f 7228 2920  lf.con.cursor() 
+0000f120: 6173 2063 7572 3a0a 2020 2020 2020 2020  as cur:.        
+0000f130: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+0000f140: 2273 656c 6563 7420 6331 2c63 3220 6672  "select c1,c2 fr
+0000f150: 6f6d 2061 7220 7768 6572 6520 6331 3d32  om ar where c1=2
+0000f160: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0000f170: 6f77 203d 2063 7572 2e66 6574 6368 6f6e  ow = cur.fetchon
+0000f180: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0000f190: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
+0000f1a0: 7175 616c 2872 6f77 5b31 5d2c 2073 656c  qual(row[1], sel
+0000f1b0: 662e 6332 290a 2020 2020 2020 2020 2020  f.c2).          
+0000f1c0: 2020 6375 722e 6578 6563 7574 6528 2273    cur.execute("s
+0000f1d0: 656c 6563 7420 6331 2c63 3320 6672 6f6d  elect c1,c3 from
+0000f1e0: 2061 7220 7768 6572 6520 6331 3d33 2229   ar where c1=3")
+0000f1f0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+0000f200: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
+0000f210: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000f220: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
+0000f230: 616c 2872 6f77 5b31 5d2c 2073 656c 662e  al(row[1], self.
+0000f240: 6333 290a 2020 2020 2020 2020 2020 2020  c3).            
+0000f250: 6375 722e 6578 6563 7574 6528 2273 656c  cur.execute("sel
+0000f260: 6563 7420 6331 2c63 3420 6672 6f6d 2061  ect c1,c4 from a
+0000f270: 7220 7768 6572 6520 6331 3d34 2229 0a20  r where c1=4"). 
+0000f280: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
+0000f290: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
+0000f2a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000f2b0: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
+0000f2c0: 2872 6f77 5b31 5d2c 2073 656c 662e 6334  (row[1], self.c4
+0000f2d0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+0000f2e0: 722e 6578 6563 7574 6528 2273 656c 6563  r.execute("selec
+0000f2f0: 7420 6331 2c63 3520 6672 6f6d 2061 7220  t c1,c5 from ar 
+0000f300: 7768 6572 6520 6331 3d35 2229 0a20 2020  where c1=5").   
+0000f310: 2020 2020 2020 2020 2072 6f77 203d 2063           row = c
+0000f320: 7572 2e66 6574 6368 6f6e 6528 290a 2020  ur.fetchone().  
+0000f330: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000f340: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
+0000f350: 6f77 5b31 5d2c 2073 656c 662e 6335 290a  ow[1], self.c5).
+0000f360: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+0000f370: 6578 6563 7574 6528 2273 656c 6563 7420  execute("select 
+0000f380: 6331 2c63 3620 6672 6f6d 2061 7220 7768  c1,c6 from ar wh
+0000f390: 6572 6520 6331 3d36 2229 0a20 2020 2020  ere c1=6").     
+0000f3a0: 2020 2020 2020 2072 6f77 203d 2063 7572         row = cur
+0000f3b0: 2e66 6574 6368 6f6e 6528 290a 2020 2020  .fetchone().    
+0000f3c0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000f3d0: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
+0000f3e0: 5b31 5d2c 2073 656c 662e 6336 290a 2020  [1], self.c6).  
+0000f3f0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+0000f400: 6563 7574 6528 2273 656c 6563 7420 6331  ecute("select c1
+0000f410: 2c63 3720 6672 6f6d 2061 7220 7768 6572  ,c7 from ar wher
+0000f420: 6520 6331 3d37 2229 0a20 2020 2020 2020  e c1=7").       
+0000f430: 2020 2020 2072 6f77 203d 2063 7572 2e66       row = cur.f
+0000f440: 6574 6368 6f6e 6528 290a 2020 2020 2020  etchone().      
+0000f450: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000f460: 744c 6973 7445 7175 616c 2872 6f77 5b31  tListEqual(row[1
+0000f470: 5d2c 2073 656c 662e 6337 290a 2020 2020  ], self.c7).    
+0000f480: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
+0000f490: 7574 6528 2273 656c 6563 7420 6331 2c63  ute("select c1,c
+0000f4a0: 3820 6672 6f6d 2061 7220 7768 6572 6520  8 from ar where 
+0000f4b0: 6331 3d38 2229 0a20 2020 2020 2020 2020  c1=8").         
+0000f4c0: 2020 2072 6f77 203d 2063 7572 2e66 6574     row = cur.fet
+0000f4d0: 6368 6f6e 6528 290a 2020 2020 2020 2020  chone().        
+0000f4e0: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
+0000f4f0: 6973 7445 7175 616c 2872 6f77 5b31 5d2c  istEqual(row[1],
+0000f500: 2073 656c 662e 6338 290a 2020 2020 2020   self.c8).      
+0000f510: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+0000f520: 6528 2273 656c 6563 7420 6331 2c63 3920  e("select c1,c9 
+0000f530: 6672 6f6d 2061 7220 7768 6572 6520 6331  from ar where c1
+0000f540: 3d39 2229 0a20 2020 2020 2020 2020 2020  =9").           
+0000f550: 2072 6f77 203d 2063 7572 2e66 6574 6368   row = cur.fetch
+0000f560: 6f6e 6528 290a 2020 2020 2020 2020 2020  one().          
+0000f570: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
+0000f580: 7445 7175 616c 2872 6f77 5b31 5d2c 2073  tEqual(row[1], s
+0000f590: 656c 662e 6339 290a 2020 2020 2020 2020  elf.c9).        
+0000f5a0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+0000f5b0: 2273 656c 6563 7420 6331 2c63 3130 2066  "select c1,c10 f
+0000f5c0: 726f 6d20 6172 2077 6865 7265 2063 313d  rom ar where c1=
+0000f5d0: 3130 2229 0a20 2020 2020 2020 2020 2020  10").           
+0000f5e0: 2072 6f77 203d 2063 7572 2e66 6574 6368   row = cur.fetch
+0000f5f0: 6f6e 6528 290a 2020 2020 2020 2020 2020  one().          
+0000f600: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
+0000f610: 7445 7175 616c 2872 6f77 5b31 5d2c 2073  tEqual(row[1], s
+0000f620: 656c 662e 6331 3029 0a20 2020 2020 2020  elf.c10).       
+0000f630: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+0000f640: 2822 7365 6c65 6374 2063 312c 6331 3120  ("select c1,c11 
+0000f650: 6672 6f6d 2061 7220 7768 6572 6520 6331  from ar where c1
+0000f660: 3d31 3122 290a 2020 2020 2020 2020 2020  =11").          
+0000f670: 2020 726f 7720 3d20 6375 722e 6665 7463    row = cur.fetc
+0000f680: 686f 6e65 2829 0a20 2020 2020 2020 2020  hone().         
+0000f690: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
+0000f6a0: 7374 4571 7561 6c28 726f 775b 315d 2c20  stEqual(row[1], 
+0000f6b0: 7365 6c66 2e63 3131 290a 2020 2020 2020  self.c11).      
+0000f6c0: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+0000f6d0: 6528 2273 656c 6563 7420 6331 2c63 3132  e("select c1,c12
+0000f6e0: 2066 726f 6d20 6172 2077 6865 7265 2063   from ar where c
+0000f6f0: 313d 3132 2229 0a20 2020 2020 2020 2020  1=12").         
+0000f700: 2020 2072 6f77 203d 2063 7572 2e66 6574     row = cur.fet
+0000f710: 6368 6f6e 6528 290a 2020 2020 2020 2020  chone().        
+0000f720: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
+0000f730: 6973 7445 7175 616c 2872 6f77 5b31 5d2c  istEqual(row[1],
+0000f740: 2073 656c 662e 6331 3229 0a20 2020 2020   self.c12).     
+0000f750: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0000f760: 7465 2822 7365 6c65 6374 2063 312c 6331  te("select c1,c1
+0000f770: 3320 6672 6f6d 2061 7220 7768 6572 6520  3 from ar where 
+0000f780: 6331 3d31 3322 290a 2020 2020 2020 2020  c1=13").        
+0000f790: 2020 2020 726f 7720 3d20 6375 722e 6665      row = cur.fe
+0000f7a0: 7463 686f 6e65 2829 0a20 2020 2020 2020  tchone().       
+0000f7b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000f7c0: 4c69 7374 4571 7561 6c28 726f 775b 315d  ListEqual(row[1]
+0000f7d0: 2c20 7365 6c66 2e63 3133 290a 2020 2020  , self.c13).    
+0000f7e0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
+0000f7f0: 7574 6528 2273 656c 6563 7420 6331 2c63  ute("select c1,c
+0000f800: 3134 2066 726f 6d20 6172 2077 6865 7265  14 from ar where
+0000f810: 2063 313d 3134 2229 0a20 2020 2020 2020   c1=14").       
+0000f820: 2020 2020 2072 6f77 203d 2063 7572 2e66       row = cur.f
+0000f830: 6574 6368 6f6e 6528 290a 2020 2020 2020  etchone().      
+0000f840: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000f850: 744c 6973 7445 7175 616c 2872 6f77 5b31  tListEqual(row[1
+0000f860: 5d2c 2073 656c 662e 6331 3429 0a20 2020  ], self.c14).   
+0000f870: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
+0000f880: 6375 7465 2822 7365 6c65 6374 2063 312c  cute("select c1,
+0000f890: 6331 3520 6672 6f6d 2061 7220 7768 6572  c15 from ar wher
+0000f8a0: 6520 6331 3d31 3522 290a 2020 2020 2020  e c1=15").      
+0000f8b0: 2020 2020 2020 726f 7720 3d20 6375 722e        row = cur.
+0000f8c0: 6665 7463 686f 6e65 2829 0a20 2020 2020  fetchone().     
+0000f8d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000f8e0: 7274 4c69 7374 4571 7561 6c28 726f 775b  rtListEqual(row[
+0000f8f0: 315d 2c20 7365 6c66 2e63 3135 290a 2020  1], self.c15).  
+0000f900: 2020 6465 6620 7465 7374 5f77 7269 7465    def test_write
+0000f910: 5f66 756c 6c28 7365 6c66 293a 0a20 2020  _full(self):.   
+0000f920: 2020 2020 2077 6974 6820 7365 6c66 2e63       with self.c
+0000f930: 6f6e 2e63 7572 736f 7228 2920 6173 2063  on.cursor() as c
+0000f940: 7572 3a0a 2020 2020 2020 2020 2020 2020  ur:.            
+0000f950: 2320 494e 5445 4745 520a 2020 2020 2020  # INTEGER.      
+0000f960: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+0000f970: 6528 2269 6e73 6572 7420 696e 746f 2061  e("insert into a
+0000f980: 7220 2863 312c 6332 2920 7661 6c75 6573  r (c1,c2) values
+0000f990: 2028 3130 322c 3f29 222c 205b 7365 6c66   (102,?)", [self
+0000f9a0: 2e63 325d 290a 2020 2020 2020 2020 2020  .c2]).          
+0000f9b0: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
+0000f9c0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+0000f9d0: 6375 722e 6578 6563 7574 6528 2273 656c  cur.execute("sel
+0000f9e0: 6563 7420 6331 2c63 3220 6672 6f6d 2061  ect c1,c2 from a
+0000f9f0: 7220 7768 6572 6520 6331 3d31 3032 2229  r where c1=102")
+0000fa00: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+0000fa10: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
+0000fa20: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000fa30: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
+0000fa40: 616c 2872 6f77 5b31 5d2c 2073 656c 662e  al(row[1], self.
+0000fa50: 6332 290a 2020 2020 2020 2020 2020 2020  c2).            
+0000fa60: 2320 5641 5243 4841 520a 2020 2020 2020  # VARCHAR.      
+0000fa70: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+0000fa80: 6528 2269 6e73 6572 7420 696e 746f 2061  e("insert into a
+0000fa90: 7220 2863 312c 6333 2920 7661 6c75 6573  r (c1,c3) values
+0000faa0: 2028 3130 332c 3f29 222c 205b 7365 6c66   (103,?)", [self
+0000fab0: 2e63 335d 290a 2020 2020 2020 2020 2020  .c3]).          
+0000fac0: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
+0000fad0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+0000fae0: 6375 722e 6578 6563 7574 6528 2273 656c  cur.execute("sel
+0000faf0: 6563 7420 6331 2c63 3320 6672 6f6d 2061  ect c1,c3 from a
+0000fb00: 7220 7768 6572 6520 6331 3d31 3033 2229  r where c1=103")
+0000fb10: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+0000fb20: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
+0000fb30: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000fb40: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
+0000fb50: 616c 2872 6f77 5b31 5d2c 2073 656c 662e  al(row[1], self.
+0000fb60: 6333 290a 2020 2020 2020 2020 2020 2020  c3).            
+0000fb70: 2320 4348 4152 0a20 2020 2020 2020 2020  # CHAR.         
+0000fb80: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
+0000fb90: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
+0000fba0: 6331 2c63 3429 2076 616c 7565 7320 2831  c1,c4) values (1
+0000fbb0: 3034 2c3f 2922 2c20 5b73 656c 662e 6334  04,?)", [self.c4
+0000fbc0: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
+0000fbd0: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
+0000fbe0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+0000fbf0: 2e65 7865 6375 7465 2822 7365 6c65 6374  .execute("select
+0000fc00: 2063 312c 6334 2066 726f 6d20 6172 2077   c1,c4 from ar w
+0000fc10: 6865 7265 2063 313d 3130 3422 290a 2020  here c1=104").  
+0000fc20: 2020 2020 2020 2020 2020 726f 7720 3d20            row = 
+0000fc30: 6375 722e 6665 7463 686f 6e65 2829 0a20  cur.fetchone(). 
+0000fc40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000fc50: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
+0000fc60: 726f 775b 315d 2c20 7365 6c66 2e63 3429  row[1], self.c4)
+0000fc70: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
+0000fc80: 494d 4553 5441 4d50 0a20 2020 2020 2020  IMESTAMP.       
+0000fc90: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+0000fca0: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
+0000fcb0: 2028 6331 2c63 3529 2076 616c 7565 7320   (c1,c5) values 
+0000fcc0: 2831 3035 2c3f 2922 2c20 5b73 656c 662e  (105,?)", [self.
+0000fcd0: 6335 5d29 0a20 2020 2020 2020 2020 2020  c5]).           
+0000fce0: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
+0000fcf0: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+0000fd00: 7572 2e65 7865 6375 7465 2822 7365 6c65  ur.execute("sele
+0000fd10: 6374 2063 312c 6335 2066 726f 6d20 6172  ct c1,c5 from ar
+0000fd20: 2077 6865 7265 2063 313d 3130 3522 290a   where c1=105").
+0000fd30: 2020 2020 2020 2020 2020 2020 726f 7720              row 
+0000fd40: 3d20 6375 722e 6665 7463 686f 6e65 2829  = cur.fetchone()
+0000fd50: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000fd60: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
+0000fd70: 6c28 726f 775b 315d 2c20 7365 6c66 2e63  l(row[1], self.c
+0000fd80: 3529 0a20 2020 2020 2020 2020 2020 2023  5).            #
+0000fd90: 2054 494d 4520 4f4b 0a20 2020 2020 2020   TIME OK.       
+0000fda0: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+0000fdb0: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
+0000fdc0: 2028 6331 2c63 3629 2076 616c 7565 7320   (c1,c6) values 
+0000fdd0: 2831 3036 2c3f 2922 2c20 5b73 656c 662e  (106,?)", [self.
+0000fde0: 6336 5d29 0a20 2020 2020 2020 2020 2020  c6]).           
+0000fdf0: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
+0000fe00: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+0000fe10: 7572 2e65 7865 6375 7465 2822 7365 6c65  ur.execute("sele
+0000fe20: 6374 2063 312c 6336 2066 726f 6d20 6172  ct c1,c6 from ar
+0000fe30: 2077 6865 7265 2063 313d 3130 3622 290a   where c1=106").
+0000fe40: 2020 2020 2020 2020 2020 2020 726f 7720              row 
+0000fe50: 3d20 6375 722e 6665 7463 686f 6e65 2829  = cur.fetchone()
+0000fe60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000fe70: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
+0000fe80: 6c28 726f 775b 315d 2c20 7365 6c66 2e63  l(row[1], self.c
+0000fe90: 3629 0a20 2020 2020 2020 2020 2020 2023  6).            #
+0000fea0: 2044 4543 494d 414c 2831 302c 3229 0a20   DECIMAL(10,2). 
+0000feb0: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+0000fec0: 7865 6375 7465 2822 696e 7365 7274 2069  xecute("insert i
+0000fed0: 6e74 6f20 6172 2028 6331 2c63 3729 2076  nto ar (c1,c7) v
+0000fee0: 616c 7565 7320 2831 3037 2c3f 2922 2c20  alues (107,?)", 
+0000fef0: 5b73 656c 662e 6337 5d29 0a20 2020 2020  [self.c7]).     
+0000ff00: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+0000ff10: 636f 6d6d 6974 2829 0a20 2020 2020 2020  commit().       
+0000ff20: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+0000ff30: 2822 7365 6c65 6374 2063 312c 6337 2066  ("select c1,c7 f
+0000ff40: 726f 6d20 6172 2077 6865 7265 2063 313d  rom ar where c1=
+0000ff50: 3130 3722 290a 2020 2020 2020 2020 2020  107").          
+0000ff60: 2020 726f 7720 3d20 6375 722e 6665 7463    row = cur.fetc
+0000ff70: 686f 6e65 2829 0a20 2020 2020 2020 2020  hone().         
+0000ff80: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
+0000ff90: 7374 4571 7561 6c28 726f 775b 315d 2c20  stEqual(row[1], 
+0000ffa0: 7365 6c66 2e63 3729 0a20 2020 2020 2020  self.c7).       
+0000ffb0: 2020 2020 2023 204e 554d 4552 4943 2831       # NUMERIC(1
+0000ffc0: 302c 3229 0a20 2020 2020 2020 2020 2020  0,2).           
+0000ffd0: 2063 7572 2e65 7865 6375 7465 2822 696e   cur.execute("in
+0000ffe0: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
+0000fff0: 2c63 3829 2076 616c 7565 7320 2831 3038  ,c8) values (108
+00010000: 2c3f 2922 2c20 5b73 656c 662e 6338 5d29  ,?)", [self.c8])
+00010010: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00010020: 662e 636f 6e2e 636f 6d6d 6974 2829 0a20  f.con.commit(). 
+00010030: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+00010040: 7865 6375 7465 2822 7365 6c65 6374 2063  xecute("select c
+00010050: 312c 6338 2066 726f 6d20 6172 2077 6865  1,c8 from ar whe
+00010060: 7265 2063 313d 3130 3822 290a 2020 2020  re c1=108").    
+00010070: 2020 2020 2020 2020 726f 7720 3d20 6375          row = cu
+00010080: 722e 6665 7463 686f 6e65 2829 0a20 2020  r.fetchone().   
+00010090: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+000100a0: 7365 7274 4c69 7374 4571 7561 6c28 726f  sertListEqual(ro
+000100b0: 775b 315d 2c20 7365 6c66 2e63 3829 0a20  w[1], self.c8). 
+000100c0: 2020 2020 2020 2020 2020 2023 2053 4d41             # SMA
+000100d0: 4c4c 494e 540a 2020 2020 2020 2020 2020  LLINT.          
+000100e0: 2020 6375 722e 6578 6563 7574 6528 2269    cur.execute("i
+000100f0: 6e73 6572 7420 696e 746f 2061 7220 2863  nsert into ar (c
+00010100: 312c 6339 2920 7661 6c75 6573 2028 3130  1,c9) values (10
+00010110: 392c 3f29 222c 205b 7365 6c66 2e63 395d  9,?)", [self.c9]
+00010120: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00010130: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
+00010140: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+00010150: 6578 6563 7574 6528 2273 656c 6563 7420  execute("select 
+00010160: 6331 2c63 3920 6672 6f6d 2061 7220 7768  c1,c9 from ar wh
+00010170: 6572 6520 6331 3d31 3039 2229 0a20 2020  ere c1=109").   
+00010180: 2020 2020 2020 2020 2072 6f77 203d 2063           row = c
+00010190: 7572 2e66 6574 6368 6f6e 6528 290a 2020  ur.fetchone().  
+000101a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000101b0: 7373 6572 744c 6973 7445 7175 616c 2872  ssertListEqual(r
+000101c0: 6f77 5b31 5d2c 2073 656c 662e 6339 290a  ow[1], self.c9).
+000101d0: 2020 2020 2020 2020 2020 2020 2320 4249              # BI
+000101e0: 4749 4e54 0a20 2020 2020 2020 2020 2020  GINT.           
+000101f0: 2063 7572 2e65 7865 6375 7465 2822 696e   cur.execute("in
+00010200: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
+00010210: 2c63 3130 2920 7661 6c75 6573 2028 3131  ,c10) values (11
+00010220: 302c 3f29 222c 205b 7365 6c66 2e63 3130  0,?)", [self.c10
+00010230: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
+00010240: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
+00010250: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+00010260: 2e65 7865 6375 7465 2822 7365 6c65 6374  .execute("select
+00010270: 2063 312c 6331 3020 6672 6f6d 2061 7220   c1,c10 from ar 
+00010280: 7768 6572 6520 6331 3d31 3130 2229 0a20  where c1=110"). 
+00010290: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
+000102a0: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
+000102b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000102c0: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
+000102d0: 2872 6f77 5b31 5d2c 2073 656c 662e 6331  (row[1], self.c1
+000102e0: 3029 0a20 2020 2020 2020 2020 2020 2023  0).            #
+000102f0: 2046 4c4f 4154 0a20 2020 2020 2020 2020   FLOAT.         
+00010300: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
+00010310: 696e 7365 7274 2069 6e74 6f20 6172 2028  insert into ar (
+00010320: 6331 2c63 3131 2920 7661 6c75 6573 2028  c1,c11) values (
+00010330: 3131 312c 3f29 222c 205b 7365 6c66 2e63  111,?)", [self.c
+00010340: 3131 5d29 0a20 2020 2020 2020 2020 2020  11]).           
+00010350: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
+00010360: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+00010370: 7572 2e65 7865 6375 7465 2822 7365 6c65  ur.execute("sele
+00010380: 6374 2063 312c 6331 3120 6672 6f6d 2061  ct c1,c11 from a
+00010390: 7220 7768 6572 6520 6331 3d31 3131 2229  r where c1=111")
+000103a0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+000103b0: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
+000103c0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+000103d0: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
+000103e0: 616c 2872 6f77 5b31 5d2c 2073 656c 662e  al(row[1], self.
+000103f0: 6331 3129 0a20 2020 2020 2020 2020 2020  c11).           
+00010400: 2023 2044 4f55 424c 4520 5052 4543 4953   # DOUBLE PRECIS
+00010410: 494f 4e0a 2020 2020 2020 2020 2020 2020  ION.            
+00010420: 6375 722e 6578 6563 7574 6528 2269 6e73  cur.execute("ins
+00010430: 6572 7420 696e 746f 2061 7220 2863 312c  ert into ar (c1,
+00010440: 6331 3229 2076 616c 7565 7320 2831 3132  c12) values (112
+00010450: 2c3f 2922 2c20 5b73 656c 662e 6331 325d  ,?)", [self.c12]
+00010460: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00010470: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
+00010480: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+00010490: 6578 6563 7574 6528 2273 656c 6563 7420  execute("select 
+000104a0: 6331 2c63 3132 2066 726f 6d20 6172 2077  c1,c12 from ar w
+000104b0: 6865 7265 2063 313d 3131 3222 290a 2020  here c1=112").  
+000104c0: 2020 2020 2020 2020 2020 726f 7720 3d20            row = 
+000104d0: 6375 722e 6665 7463 686f 6e65 2829 0a20  cur.fetchone(). 
+000104e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000104f0: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
+00010500: 726f 775b 315d 2c20 7365 6c66 2e63 3132  row[1], self.c12
+00010510: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00010520: 4445 4349 4d41 4c28 3130 2c31 2920 4f4b  DECIMAL(10,1) OK
+00010530: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+00010540: 2e65 7865 6375 7465 2822 696e 7365 7274  .execute("insert
+00010550: 2069 6e74 6f20 6172 2028 6331 2c63 3133   into ar (c1,c13
+00010560: 2920 7661 6c75 6573 2028 3131 332c 3f29  ) values (113,?)
+00010570: 222c 205b 7365 6c66 2e63 3133 5d29 0a20  ", [self.c13]). 
+00010580: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00010590: 636f 6e2e 636f 6d6d 6974 2829 0a20 2020  con.commit().   
+000105a0: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
+000105b0: 6375 7465 2822 7365 6c65 6374 2063 312c  cute("select c1,
+000105c0: 6331 3320 6672 6f6d 2061 7220 7768 6572  c13 from ar wher
+000105d0: 6520 6331 3d31 3133 2229 0a20 2020 2020  e c1=113").     
+000105e0: 2020 2020 2020 2072 6f77 203d 2063 7572         row = cur
+000105f0: 2e66 6574 6368 6f6e 6528 290a 2020 2020  .fetchone().    
+00010600: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00010610: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
+00010620: 5b31 5d2c 2073 656c 662e 6331 3329 0a20  [1], self.c13). 
+00010630: 2020 2020 2020 2020 2020 2023 2044 4543             # DEC
+00010640: 494d 414c 2831 302c 3529 0a20 2020 2020  IMAL(10,5).     
+00010650: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+00010660: 7465 2822 696e 7365 7274 2069 6e74 6f20  te("insert into 
+00010670: 6172 2028 6331 2c63 3134 2920 7661 6c75  ar (c1,c14) valu
+00010680: 6573 2028 3131 342c 3f29 222c 205b 7365  es (114,?)", [se
+00010690: 6c66 2e63 3134 5d29 0a20 2020 2020 2020  lf.c14]).       
+000106a0: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
+000106b0: 6d6d 6974 2829 0a20 2020 2020 2020 2020  mmit().         
+000106c0: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
+000106d0: 7365 6c65 6374 2063 312c 6331 3420 6672  select c1,c14 fr
+000106e0: 6f6d 2061 7220 7768 6572 6520 6331 3d31  om ar where c1=1
+000106f0: 3134 2229 0a20 2020 2020 2020 2020 2020  14").           
+00010700: 2072 6f77 203d 2063 7572 2e66 6574 6368   row = cur.fetch
+00010710: 6f6e 6528 290a 2020 2020 2020 2020 2020  one().          
+00010720: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
+00010730: 7445 7175 616c 2872 6f77 5b31 5d2c 2073  tEqual(row[1], s
+00010740: 656c 662e 6331 3429 0a20 2020 2020 2020  elf.c14).       
+00010750: 2020 2020 2023 2044 4543 494d 414c 2831       # DECIMAL(1
+00010760: 382c 3529 0a20 2020 2020 2020 2020 2020  8,5).           
+00010770: 2063 7572 2e65 7865 6375 7465 2822 696e   cur.execute("in
+00010780: 7365 7274 2069 6e74 6f20 6172 2028 6331  sert into ar (c1
+00010790: 2c63 3135 2920 7661 6c75 6573 2028 3131  ,c15) values (11
+000107a0: 352c 3f29 222c 205b 7365 6c66 2e63 3135  5,?)", [self.c15
+000107b0: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
+000107c0: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
+000107d0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+000107e0: 2e65 7865 6375 7465 2822 7365 6c65 6374  .execute("select
+000107f0: 2063 312c 6331 3520 6672 6f6d 2061 7220   c1,c15 from ar 
+00010800: 7768 6572 6520 6331 3d31 3135 2229 0a20  where c1=115"). 
+00010810: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
+00010820: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
+00010830: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00010840: 2e61 7373 6572 744c 6973 7445 7175 616c  .assertListEqual
+00010850: 2872 6f77 5b31 5d2c 2073 656c 662e 6331  (row[1], self.c1
+00010860: 3529 0a20 2020 2020 2020 2020 2020 2023  5).            #
+00010870: 2042 4f4f 4c45 414e 0a20 2020 2020 2020   BOOLEAN.       
+00010880: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+00010890: 2822 696e 7365 7274 2069 6e74 6f20 6172  ("insert into ar
+000108a0: 2028 6331 2c63 3136 2920 7661 6c75 6573   (c1,c16) values
+000108b0: 2028 3131 362c 3f29 222c 205b 7365 6c66   (116,?)", [self
+000108c0: 2e63 3136 5d29 0a20 2020 2020 2020 2020  .c16]).         
+000108d0: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
+000108e0: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
+000108f0: 2063 7572 2e65 7865 6375 7465 2822 7365   cur.execute("se
+00010900: 6c65 6374 2063 312c 6331 3620 6672 6f6d  lect c1,c16 from
+00010910: 2061 7220 7768 6572 6520 6331 3d31 3136   ar where c1=116
+00010920: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+00010930: 6f77 203d 2063 7572 2e66 6574 6368 6f6e  ow = cur.fetchon
+00010940: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+00010950: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
+00010960: 7175 616c 2872 6f77 5b31 5d2c 2073 656c  qual(row[1], sel
+00010970: 662e 6331 3629 0a20 2020 2064 6566 2074  f.c16).    def t
+00010980: 6573 745f 7772 6974 655f 7772 6f6e 6728  est_write_wrong(
+00010990: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
+000109a0: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
+000109b0: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
+000109c0: 2020 2020 2020 2020 2020 7769 7468 2073            with s
+000109d0: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
+000109e0: 2856 616c 7565 4572 726f 7229 2061 7320  (ValueError) as 
+000109f0: 636d 3a0a 2020 2020 2020 2020 2020 2020  cm:.            
+00010a00: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+00010a10: 2269 6e73 6572 7420 696e 746f 2061 7220  "insert into ar 
+00010a20: 2863 312c 6332 2920 7661 6c75 6573 2028  (c1,c2) values (
+00010a30: 3130 322c 3f29 222c 205b 7365 6c66 2e63  102,?)", [self.c
+00010a40: 335d 290a 2020 2020 2020 2020 2020 2020  3]).            
+00010a50: 7365 6c66 2e61 7373 6572 7454 7570 6c65  self.assertTuple
+00010a60: 4571 7561 6c28 636d 2e65 7863 6570 7469  Equal(cm.excepti
+00010a70: 6f6e 2e61 7267 732c 2028 2749 6e63 6f72  on.args, ('Incor
+00010a80: 7265 6374 2041 5252 4159 2066 6965 6c64  rect ARRAY field
+00010a90: 2076 616c 7565 2e27 2c29 290a 2020 2020   value.',)).    
+00010aa0: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
+00010ab0: 662e 6173 7365 7274 5261 6973 6573 2856  f.assertRaises(V
+00010ac0: 616c 7565 4572 726f 7229 2061 7320 636d  alueError) as cm
+00010ad0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010ae0: 2020 6375 722e 6578 6563 7574 6528 2269    cur.execute("i
+00010af0: 6e73 6572 7420 696e 746f 2061 7220 2863  nsert into ar (c
+00010b00: 312c 6332 2920 7661 6c75 6573 2028 3130  1,c2) values (10
+00010b10: 322c 3f29 222c 205b 7365 6c66 2e63 325b  2,?)", [self.c2[
+00010b20: 3a2d 315d 5d29 0a20 2020 2020 2020 2020  :-1]]).         
+00010b30: 2020 2073 656c 662e 6173 7365 7274 5475     self.assertTu
+00010b40: 706c 6545 7175 616c 2863 6d2e 6578 6365  pleEqual(cm.exce
+00010b50: 7074 696f 6e2e 6172 6773 2c20 2827 496e  ption.args, ('In
+00010b60: 636f 7272 6563 7420 4152 5241 5920 6669  correct ARRAY fi
+00010b70: 656c 6420 7661 6c75 652e 272c 2929 0a0a  eld value.',))..
+00010b80: 636c 6173 7320 5465 7374 496e 7365 7274  class TestInsert
+00010b90: 4461 7461 2844 7269 7665 7254 6573 7442  Data(DriverTestB
+00010ba0: 6173 6529 3a0a 2020 2020 6465 6620 7365  ase):.    def se
+00010bb0: 7455 7028 7365 6c66 293a 0a20 2020 2020  tUp(self):.     
+00010bc0: 2020 2073 7570 6572 2829 2e73 6574 5570     super().setUp
+00010bd0: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00010be0: 6462 6669 6c65 203d 206f 732e 7061 7468  dbfile = os.path
+00010bf0: 2e6a 6f69 6e28 7365 6c66 2e64 6270 6174  .join(self.dbpat
+00010c00: 682c 2073 656c 662e 4642 5445 5354 5f44  h, self.FBTEST_D
+00010c10: 4229 0a20 2020 2020 2020 2073 656c 662e  B).        self.
+00010c20: 636f 6e20 3d20 636f 6e6e 6563 7428 7365  con = connect(se
+00010c30: 6c66 2e64 6266 696c 652c 2075 7365 723d  lf.dbfile, user=
+00010c40: 4642 5445 5354 5f55 5345 522c 2070 6173  FBTEST_USER, pas
+00010c50: 7377 6f72 643d 4642 5445 5354 5f50 4153  sword=FBTEST_PAS
+00010c60: 5357 4f52 4429 0a20 2020 2020 2020 2073  SWORD).        s
+00010c70: 656c 662e 636f 6e2e 5f6c 6f67 6769 6e67  elf.con._logging
+00010c80: 5f69 645f 203d 2073 656c 662e 5f5f 636c  _id_ = self.__cl
+00010c90: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20  ass__.__name__. 
+00010ca0: 2020 2020 2020 2073 656c 662e 636f 6e32         self.con2
+00010cb0: 203d 2063 6f6e 6e65 6374 2873 656c 662e   = connect(self.
+00010cc0: 6462 6669 6c65 2c20 7573 6572 3d46 4254  dbfile, user=FBT
+00010cd0: 4553 545f 5553 4552 2c20 7061 7373 776f  EST_USER, passwo
+00010ce0: 7264 3d46 4254 4553 545f 5041 5353 574f  rd=FBTEST_PASSWO
+00010cf0: 5244 2c20 6368 6172 7365 743d 2775 7466  RD, charset='utf
+00010d00: 2d38 2729 0a20 2020 2020 2020 2073 656c  -8').        sel
+00010d10: 662e 636f 6e32 2e5f 6c6f 6767 696e 675f  f.con2._logging_
+00010d20: 6964 5f20 3d20 7365 6c66 2e5f 5f63 6c61  id_ = self.__cla
+00010d30: 7373 5f5f 2e5f 5f6e 616d 655f 5f0a 2020  ss__.__name__.  
+00010d40: 2020 2020 2020 2373 656c 662e 636f 6e2e        #self.con.
+00010d50: 6578 6563 7574 655f 696d 6d65 6469 6174  execute_immediat
+00010d60: 6528 2272 6563 7265 6174 6520 7461 626c  e("recreate tabl
+00010d70: 6520 7420 2863 3120 696e 7465 6765 7229  e t (c1 integer)
+00010d80: 2229 0a20 2020 2020 2020 2023 7365 6c66  ").        #self
+00010d90: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 2020  .con.commit().  
+00010da0: 2020 2020 2020 2373 656c 662e 636f 6e2e        #self.con.
+00010db0: 6578 6563 7574 655f 696d 6d65 6469 6174  execute_immediat
+00010dc0: 6528 2252 4543 5245 4154 4520 5441 424c  e("RECREATE TABL
+00010dd0: 4520 5432 2028 4331 2053 6d61 6c6c 696e  E T2 (C1 Smallin
+00010de0: 742c 4332 2049 6e74 6567 6572 2c43 3320  t,C2 Integer,C3 
+00010df0: 4269 6769 6e74 2c43 3420 4368 6172 2835  Bigint,C4 Char(5
+00010e00: 292c 4335 2056 6172 6368 6172 2831 3029  ),C5 Varchar(10)
+00010e10: 2c43 3620 4461 7465 2c43 3720 5469 6d65  ,C6 Date,C7 Time
+00010e20: 2c43 3820 5469 6d65 7374 616d 702c 4339  ,C8 Timestamp,C9
+00010e30: 2042 6c6f 6220 7375 625f 7479 7065 2031   Blob sub_type 1
+00010e40: 2c43 3130 204e 756d 6572 6963 2831 382c  ,C10 Numeric(18,
+00010e50: 3229 2c43 3131 2044 6563 696d 616c 2831  2),C11 Decimal(1
+00010e60: 382c 3229 2c43 3132 2046 6c6f 6174 2c43  8,2),C12 Float,C
+00010e70: 3133 2044 6f75 626c 6520 7072 6563 6973  13 Double precis
+00010e80: 696f 6e2c 4331 3420 4e75 6d65 7269 6328  ion,C14 Numeric(
+00010e90: 382c 3429 2c43 3135 2044 6563 696d 616c  8,4),C15 Decimal
+00010ea0: 2838 2c34 2929 2229 0a20 2020 2020 2020  (8,4))").       
+00010eb0: 2073 656c 662e 636f 6e2e 6578 6563 7574   self.con.execut
+00010ec0: 655f 696d 6d65 6469 6174 6528 2264 656c  e_immediate("del
+00010ed0: 6574 6520 6672 6f6d 2074 2229 0a20 2020  ete from t").   
+00010ee0: 2020 2020 2073 656c 662e 636f 6e2e 6578       self.con.ex
+00010ef0: 6563 7574 655f 696d 6d65 6469 6174 6528  ecute_immediate(
+00010f00: 2264 656c 6574 6520 6672 6f6d 2074 3222  "delete from t2"
+00010f10: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
+00010f20: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
+00010f30: 6465 6620 7465 6172 446f 776e 2873 656c  def tearDown(sel
+00010f40: 6629 3a0a 2020 2020 2020 2020 7365 6c66  f):.        self
+00010f50: 2e63 6f6e 322e 636c 6f73 6528 290a 2020  .con2.close().  
+00010f60: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
+00010f70: 6c6f 7365 2829 0a20 2020 2064 6566 2074  lose().    def t
+00010f80: 6573 745f 696e 7365 7274 5f69 6e74 6567  est_insert_integ
+00010f90: 6572 7328 7365 6c66 293a 0a20 2020 2020  ers(self):.     
+00010fa0: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
+00010fb0: 2e63 7572 736f 7228 2920 6173 2063 7572  .cursor() as cur
+00010fc0: 3a0a 2020 2020 2020 2020 2020 2020 6375  :.            cu
+00010fd0: 722e 6578 6563 7574 6528 2769 6e73 6572  r.execute('inser
+00010fe0: 7420 696e 746f 2054 3220 2843 312c 4332  t into T2 (C1,C2
+00010ff0: 2c43 3329 2076 616c 7565 7320 283f 2c3f  ,C3) values (?,?
+00011000: 2c3f 2927 2c20 5b31 2c20 312c 2031 5d29  ,?)', [1, 1, 1])
+00011010: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011020: 662e 636f 6e2e 636f 6d6d 6974 2829 0a20  f.con.commit(). 
+00011030: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+00011040: 7865 6375 7465 2827 7365 6c65 6374 2043  xecute('select C
+00011050: 312c 4332 2c43 3320 6672 6f6d 2054 3220  1,C2,C3 from T2 
+00011060: 7768 6572 6520 4331 203d 2031 2729 0a20  where C1 = 1'). 
+00011070: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
+00011080: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
+00011090: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000110a0: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
+000110b0: 6c28 726f 7773 2c20 5b28 312c 2031 2c20  l(rows, [(1, 1, 
+000110c0: 3129 5d29 0a20 2020 2020 2020 2020 2020  1)]).           
+000110d0: 2063 7572 2e65 7865 6375 7465 2827 696e   cur.execute('in
+000110e0: 7365 7274 2069 6e74 6f20 5432 2028 4331  sert into T2 (C1
+000110f0: 2c43 322c 4333 2920 7661 6c75 6573 2028  ,C2,C3) values (
+00011100: 3f2c 3f2c 3f29 272c 0a20 2020 2020 2020  ?,?,?)',.       
+00011110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011120: 205b 322c 2031 2c20 3932 3233 3337 3230   [2, 1, 92233720
+00011130: 3336 3835 3437 3735 3830 375d 290a 2020  36854775807]).  
+00011140: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+00011150: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
+00011160: 746f 2054 3220 2843 312c 4332 2c43 3329  to T2 (C1,C2,C3)
+00011170: 2076 616c 7565 7320 283f 2c3f 2c3f 2927   values (?,?,?)'
+00011180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011190: 2020 2020 2020 2020 2020 5b32 2c20 312c            [2, 1,
+000111a0: 202d 3932 3233 3337 3230 3336 3835 3437   -92233720368547
+000111b0: 3735 3830 372d 315d 290a 2020 2020 2020  75807-1]).      
+000111c0: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
+000111d0: 6f6d 6d69 7428 290a 2020 2020 2020 2020  ommit().        
+000111e0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+000111f0: 2773 656c 6563 7420 4331 2c43 322c 4333  'select C1,C2,C3
+00011200: 2066 726f 6d20 5432 2077 6865 7265 2043   from T2 where C
+00011210: 3120 3d20 3227 290a 2020 2020 2020 2020  1 = 2').        
+00011220: 2020 2020 726f 7773 203d 2063 7572 2e66      rows = cur.f
+00011230: 6574 6368 616c 6c28 290a 2020 2020 2020  etchall().      
+00011240: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00011250: 744c 6973 7445 7175 616c 2872 6f77 732c  tListEqual(rows,
+00011260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00011270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011280: 2020 2020 2020 2020 205b 2833 2c20 6461           [(3, da
-00011290: 7465 7469 6d65 2e64 6174 6528 3230 3131  tetime.date(2011
-000112a0: 2c20 3131 2c20 3133 292c 2064 6174 6574  , 11, 13), datet
-000112b0: 696d 652e 7469 6d65 2831 352c 2030 2c20  ime.time(15, 0, 
-000112c0: 312c 2032 3030 3030 3029 2c0a 2020 2020  1, 200000),.    
-000112d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000112f0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
-00011300: 2832 3031 312c 2031 312c 2031 332c 2031  (2011, 11, 13, 1
-00011310: 352c 2030 2c20 312c 2032 3030 3030 3029  5, 0, 1, 200000)
-00011320: 295d 290a 0a20 2020 2020 2020 2020 2020  )])..           
-00011330: 2063 7572 2e65 7865 6375 7465 2827 696e   cur.execute('in
-00011340: 7365 7274 2069 6e74 6f20 5432 2028 4331  sert into T2 (C1
-00011350: 2c43 362c 4337 2c43 3829 2076 616c 7565  ,C6,C7,C8) value
-00011360: 7320 283f 2c3f 2c3f 2c3f 2927 2c20 5b34  s (?,?,?,?)', [4
-00011370: 2c20 2732 3031 312d 3131 2d31 3327 2c20  , '2011-11-13', 
-00011380: 2731 353a 303a 313a 3230 3027 2c20 2732  '15:0:1:200', '2
-00011390: 3031 312d 3131 2d31 3320 3135 3a30 3a31  011-11-13 15:0:1
-000113a0: 3a32 3030 3027 5d29 0a20 2020 2020 2020  :2000']).       
-000113b0: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
-000113c0: 6d6d 6974 2829 0a20 2020 2020 2020 2020  mmit().         
-000113d0: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
-000113e0: 7365 6c65 6374 2043 312c 4336 2c43 372c  select C1,C6,C7,
-000113f0: 4338 2066 726f 6d20 5432 2077 6865 7265  C8 from T2 where
-00011400: 2043 3120 3d20 3427 290a 2020 2020 2020   C1 = 4').      
-00011410: 2020 2020 2020 726f 7773 203d 2063 7572        rows = cur
-00011420: 2e66 6574 6368 616c 6c28 290a 2020 2020  .fetchall().    
-00011430: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00011440: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
-00011450: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00011460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011470: 2020 2020 5b28 342c 2064 6174 6574 696d      [(4, datetim
-00011480: 652e 6461 7465 2832 3031 312c 2031 312c  e.date(2011, 11,
-00011490: 2031 3329 2c20 6461 7465 7469 6d65 2e74   13), datetime.t
-000114a0: 696d 6528 3135 2c20 302c 2031 2c20 3230  ime(15, 0, 1, 20
-000114b0: 3030 3030 292c 0a20 2020 2020 2020 2020  0000),.         
-000114c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114d0: 2020 2020 2020 2020 2020 6461 7465 7469            dateti
-000114e0: 6d65 2e64 6174 6574 696d 6528 3230 3131  me.datetime(2011
-000114f0: 2c20 3131 2c20 3133 2c20 3135 2c20 302c  , 11, 13, 15, 0,
-00011500: 2031 2c20 3230 3030 3030 2929 5d29 0a20   1, 200000))]). 
-00011510: 2020 2064 6566 2074 6573 745f 696e 7365     def test_inse
-00011520: 7274 5f62 6c6f 6228 7365 6c66 293a 0a20  rt_blob(self):. 
-00011530: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
-00011540: 2e63 6f6e 2e63 7572 736f 7228 2920 6173  .con.cursor() as
-00011550: 2063 7572 2c20 7365 6c66 2e63 6f6e 322e   cur, self.con2.
-00011560: 6375 7273 6f72 2829 2061 7320 6375 7232  cursor() as cur2
-00011570: 3a0a 2020 2020 2020 2020 2020 2020 6375  :.            cu
-00011580: 722e 6578 6563 7574 6528 2769 6e73 6572  r.execute('inser
-00011590: 7420 696e 746f 2054 3220 2843 312c 4339  t into T2 (C1,C9
-000115a0: 2920 7661 6c75 6573 2028 3f2c 3f29 272c  ) values (?,?)',
-000115b0: 205b 342c 2027 5468 6973 2069 7320 6120   [4, 'This is a 
-000115c0: 424c 4f42 2127 5d29 0a20 2020 2020 2020  BLOB!']).       
-000115d0: 2020 2020 2063 7572 2e74 7261 6e73 6163       cur.transac
-000115e0: 7469 6f6e 2e63 6f6d 6d69 7428 290a 2020  tion.commit().  
-000115f0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-00011600: 6563 7574 6528 2773 656c 6563 7420 4331  ecute('select C1
-00011610: 2c43 3920 6672 6f6d 2054 3220 7768 6572  ,C9 from T2 wher
-00011620: 6520 4331 203d 2034 2729 0a20 2020 2020  e C1 = 4').     
-00011630: 2020 2020 2020 2072 6f77 7320 3d20 6375         rows = cu
-00011640: 722e 6665 7463 6861 6c6c 2829 0a20 2020  r.fetchall().   
-00011650: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00011660: 7365 7274 4c69 7374 4571 7561 6c28 726f  sertListEqual(ro
-00011670: 7773 2c20 5b28 342c 2027 5468 6973 2069  ws, [(4, 'This i
-00011680: 7320 6120 424c 4f42 2127 295d 290a 2020  s a BLOB!')]).  
-00011690: 2020 2020 2020 2020 2020 2320 4e6f 6e2d            # Non-
-000116a0: 7465 7874 7561 6c20 424c 4f42 0a20 2020  textual BLOB.   
-000116b0: 2020 2020 2020 2020 2062 6c6f 625f 6461           blob_da
-000116c0: 7461 203d 2062 7974 6573 285b 302c 2031  ta = bytes([0, 1
-000116d0: 2c20 322c 2033 2c20 342c 2035 2c20 362c  , 2, 3, 4, 5, 6,
-000116e0: 2037 2c20 382c 2039 2c20 3130 5d29 0a20   7, 8, 9, 10]). 
-000116f0: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-00011700: 7865 6375 7465 2827 696e 7365 7274 2069  xecute('insert i
-00011710: 6e74 6f20 5432 2028 4331 2c43 3136 2920  nto T2 (C1,C16) 
-00011720: 7661 6c75 6573 2028 3f2c 3f29 272c 205b  values (?,?)', [
-00011730: 382c 2062 6c6f 625f 6461 7461 5d29 0a20  8, blob_data]). 
-00011740: 2020 2020 2020 2020 2020 2063 7572 2e74             cur.t
-00011750: 7261 6e73 6163 7469 6f6e 2e63 6f6d 6d69  ransaction.commi
-00011760: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-00011770: 6375 722e 6578 6563 7574 6528 2773 656c  cur.execute('sel
-00011780: 6563 7420 4331 2c43 3136 2066 726f 6d20  ect C1,C16 from 
-00011790: 5432 2077 6865 7265 2043 3120 3d20 3827  T2 where C1 = 8'
-000117a0: 290a 2020 2020 2020 2020 2020 2020 726f  ).            ro
-000117b0: 7773 203d 2063 7572 2e66 6574 6368 616c  ws = cur.fetchal
-000117c0: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
-000117d0: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
-000117e0: 7175 616c 2872 6f77 732c 205b 2838 2c20  qual(rows, [(8, 
-000117f0: 626c 6f62 5f64 6174 6129 5d29 0a20 2020  blob_data)]).   
-00011800: 2020 2020 2020 2020 2023 2042 4c4f 4220           # BLOB 
-00011810: 6269 6767 6572 2074 6861 6e20 7374 7265  bigger than stre
-00011820: 616d 5f62 6c6f 625f 7468 7265 7368 6f6c  am_blob_threshol
-00011830: 640a 2020 2020 2020 2020 2020 2020 6269  d.            bi
-00011840: 675f 626c 6f62 203d 2027 3132 3334 3536  g_blob = '123456
-00011850: 3738 3927 202a 2031 3030 3030 0a20 2020  789' * 10000.   
-00011860: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-00011870: 6375 7465 2827 696e 7365 7274 2069 6e74  cute('insert int
-00011880: 6f20 5432 2028 4331 2c43 3929 2076 616c  o T2 (C1,C9) val
-00011890: 7565 7320 283f 2c3f 2927 2c20 5b35 2c20  ues (?,?)', [5, 
-000118a0: 6269 675f 626c 6f62 5d29 0a20 2020 2020  big_blob]).     
-000118b0: 2020 2020 2020 2063 7572 2e74 7261 6e73         cur.trans
-000118c0: 6163 7469 6f6e 2e63 6f6d 6d69 7428 290a  action.commit().
-000118d0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-000118e0: 6578 6563 7574 6528 2773 656c 6563 7420  execute('select 
-000118f0: 4331 2c43 3920 6672 6f6d 2054 3220 7768  C1,C9 from T2 wh
-00011900: 6572 6520 4331 203d 2035 2729 0a20 2020  ere C1 = 5').   
-00011910: 2020 2020 2020 2020 2072 6f77 203d 2063           row = c
-00011920: 7572 2e66 6574 6368 6f6e 6528 290a 2020  ur.fetchone().  
-00011930: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00011940: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-00011950: 726f 775b 315d 2c20 6472 6976 6572 2e63  row[1], driver.c
-00011960: 6f72 652e 426c 6f62 5265 6164 6572 290a  ore.BlobReader).
-00011970: 2020 2020 2020 2020 2020 2020 2373 656c              #sel
-00011980: 662e 6173 7365 7274 4571 7561 6c28 726f  f.assertEqual(ro
-00011990: 775b 315d 2e72 6561 6428 292c 2062 6967  w[1].read(), big
-000119a0: 5f62 6c6f 6229 0a20 2020 2020 2020 2020  _blob).         
-000119b0: 2020 2023 2055 6e69 636f 6465 2069 6e20     # Unicode in 
-000119c0: 424c 4f42 0a20 2020 2020 2020 2020 2020  BLOB.           
-000119d0: 2062 6c6f 625f 7465 7874 203d 2027 5468   blob_text = 'Th
-000119e0: 6973 2069 7320 6120 424c 4f42 2077 6974  is is a BLOB wit
-000119f0: 6820 6368 6172 6163 7465 7273 2062 6579  h characters bey
-00011a00: 6f6e 6420 6173 6369 693a 20c4 9bc5 a1c4  ond ascii: .....
-00011a10: 8dc5 99c5 bec3 bdc3 a1c3 adc3 a927 0a20  .............'. 
-00011a20: 2020 2020 2020 2020 2020 2063 7572 322e             cur2.
-00011a30: 6578 6563 7574 6528 2769 6e73 6572 7420  execute('insert 
-00011a40: 696e 746f 2054 3220 2843 312c 4339 2920  into T2 (C1,C9) 
-00011a50: 7661 6c75 6573 2028 3f2c 3f29 272c 205b  values (?,?)', [
-00011a60: 362c 2062 6c6f 625f 7465 7874 5d29 0a20  6, blob_text]). 
-00011a70: 2020 2020 2020 2020 2020 2063 7572 322e             cur2.
-00011a80: 7472 616e 7361 6374 696f 6e2e 636f 6d6d  transaction.comm
-00011a90: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
-00011aa0: 2063 7572 322e 6578 6563 7574 6528 2773   cur2.execute('s
-00011ab0: 656c 6563 7420 4331 2c43 3920 6672 6f6d  elect C1,C9 from
-00011ac0: 2054 3220 7768 6572 6520 4331 203d 2036   T2 where C1 = 6
-00011ad0: 2729 0a20 2020 2020 2020 2020 2020 2072  ').            r
-00011ae0: 6f77 7320 3d20 6375 7232 2e66 6574 6368  ows = cur2.fetch
-00011af0: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
-00011b00: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
-00011b10: 7445 7175 616c 2872 6f77 732c 205b 2836  tEqual(rows, [(6
-00011b20: 2c20 626c 6f62 5f74 6578 7429 5d29 0a20  , blob_text)]). 
-00011b30: 2020 2020 2020 2020 2020 2023 2055 6e69             # Uni
-00011b40: 636f 6465 206e 6f6e 2d74 6578 7475 616c  code non-textual
-00011b50: 2042 4c4f 420a 2020 2020 2020 2020 2020   BLOB.          
-00011b60: 2020 7769 7468 2073 656c 662e 6173 7365    with self.asse
-00011b70: 7274 5261 6973 6573 2854 7970 6545 7272  rtRaises(TypeErr
-00011b80: 6f72 2920 6173 2063 6d3a 0a20 2020 2020  or) as cm:.     
-00011b90: 2020 2020 2020 2020 2020 2063 7572 322e             cur2.
-00011ba0: 6578 6563 7574 6528 2769 6e73 6572 7420  execute('insert 
-00011bb0: 696e 746f 2054 3220 2843 312c 4331 3629  into T2 (C1,C16)
-00011bc0: 2076 616c 7565 7320 283f 2c3f 2927 2c20   values (?,?)', 
-00011bd0: 5b37 2c20 626c 6f62 5f74 6578 745d 290a  [7, blob_text]).
-00011be0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00011bf0: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
-00011c00: 6c28 636d 2e65 7863 6570 7469 6f6e 2e61  l(cm.exception.a
-00011c10: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-00011c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c30: 2020 2020 2020 2028 2253 7472 696e 6720         ("String 
-00011c40: 7661 6c75 6520 6973 206e 6f74 2061 6363  value is not acc
-00011c50: 6570 7461 626c 6520 7479 7065 2066 6f72  eptable type for
-00011c60: 2061 206e 6f6e 2d74 6578 7475 616c 2042   a non-textual B
-00011c70: 4c4f 4220 636f 6c75 6d6e 2e22 2c29 290a  LOB column.",)).
-00011c80: 2020 2020 6465 6620 7465 7374 5f69 6e73      def test_ins
-00011c90: 6572 745f 666c 6f61 745f 646f 7562 6c65  ert_float_double
-00011ca0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00011cb0: 7769 7468 2073 656c 662e 636f 6e2e 6375  with self.con.cu
-00011cc0: 7273 6f72 2829 2061 7320 6375 723a 0a20  rsor() as cur:. 
-00011cd0: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-00011ce0: 7865 6375 7465 2827 696e 7365 7274 2069  xecute('insert i
-00011cf0: 6e74 6f20 5432 2028 4331 2c43 3132 2c43  nto T2 (C1,C12,C
-00011d00: 3133 2920 7661 6c75 6573 2028 3f2c 3f2c  13) values (?,?,
-00011d10: 3f29 272c 205b 352c 2031 2e30 2c20 312e  ?)', [5, 1.0, 1.
-00011d20: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00011d30: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
-00011d40: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-00011d50: 722e 6578 6563 7574 6528 2773 656c 6563  r.execute('selec
-00011d60: 7420 4331 2c43 3132 2c43 3133 2066 726f  t C1,C12,C13 fro
-00011d70: 6d20 5432 2077 6865 7265 2043 3120 3d20  m T2 where C1 = 
-00011d80: 3527 290a 2020 2020 2020 2020 2020 2020  5').            
-00011d90: 726f 7773 203d 2063 7572 2e66 6574 6368  rows = cur.fetch
-00011da0: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
-00011db0: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
-00011dc0: 7445 7175 616c 2872 6f77 732c 205b 2835  tEqual(rows, [(5
-00011dd0: 2c20 312e 302c 2031 2e30 295d 290a 2020  , 1.0, 1.0)]).  
-00011de0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-00011df0: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
-00011e00: 746f 2054 3220 2843 312c 4331 322c 4331  to T2 (C1,C12,C1
-00011e10: 3329 2076 616c 7565 7320 283f 2c3f 2c3f  3) values (?,?,?
-00011e20: 2927 2c20 5b36 2c20 312c 2031 5d29 0a20  )', [6, 1, 1]). 
-00011e30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011e40: 636f 6e2e 636f 6d6d 6974 2829 0a20 2020  con.commit().   
-00011e50: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-00011e60: 6375 7465 2827 7365 6c65 6374 2043 312c  cute('select C1,
-00011e70: 4331 322c 4331 3320 6672 6f6d 2054 3220  C12,C13 from T2 
-00011e80: 7768 6572 6520 4331 203d 2036 2729 0a20  where C1 = 6'). 
-00011e90: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
-00011ea0: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
-00011eb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00011ec0: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-00011ed0: 6c28 726f 7773 2c20 5b28 362c 2031 2e30  l(rows, [(6, 1.0
-00011ee0: 2c20 312e 3029 5d29 0a20 2020 2064 6566  , 1.0)]).    def
-00011ef0: 2074 6573 745f 696e 7365 7274 5f6e 756d   test_insert_num
-00011f00: 6572 6963 5f64 6563 696d 616c 2873 656c  eric_decimal(sel
-00011f10: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
-00011f20: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
-00011f30: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
-00011f40: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
-00011f50: 7465 2827 696e 7365 7274 2069 6e74 6f20  te('insert into 
-00011f60: 5432 2028 4331 2c43 3130 2c43 3131 2920  T2 (C1,C10,C11) 
-00011f70: 7661 6c75 6573 2028 3f2c 3f2c 3f29 272c  values (?,?,?)',
-00011f80: 205b 362c 2031 2e31 2c20 312e 315d 290a   [6, 1.1, 1.1]).
-00011f90: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-00011fa0: 6578 6563 7574 6528 2769 6e73 6572 7420  execute('insert 
-00011fb0: 696e 746f 2054 3220 2843 312c 4331 302c  into T2 (C1,C10,
-00011fc0: 4331 3129 2076 616c 7565 7320 283f 2c3f  C11) values (?,?
-00011fd0: 2c3f 2927 2c20 5b36 2c20 6465 6369 6d61  ,?)', [6, decima
-00011fe0: 6c2e 4465 6369 6d61 6c28 2731 3030 2e31  l.Decimal('100.1
-00011ff0: 3127 292c 2064 6563 696d 616c 2e44 6563  1'), decimal.Dec
-00012000: 696d 616c 2827 3130 302e 3131 2729 5d29  imal('100.11')])
-00012010: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012020: 662e 636f 6e2e 636f 6d6d 6974 2829 0a20  f.con.commit(). 
-00012030: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-00012040: 7865 6375 7465 2827 7365 6c65 6374 2043  xecute('select C
-00012050: 312c 4331 302c 4331 3120 6672 6f6d 2054  1,C10,C11 from T
-00012060: 3220 7768 6572 6520 4331 203d 2036 2729  2 where C1 = 6')
-00012070: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-00012080: 7320 3d20 6375 722e 6665 7463 6861 6c6c  s = cur.fetchall
-00012090: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-000120a0: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
-000120b0: 7561 6c28 726f 7773 2c0a 2020 2020 2020  ual(rows,.      
-000120c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120d0: 2020 2020 2020 2020 2020 205b 2836 2c20             [(6, 
-000120e0: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
-000120f0: 2731 2e31 2729 2c20 6465 6369 6d61 6c2e  '1.1'), decimal.
-00012100: 4465 6369 6d61 6c28 2731 2e31 2729 292c  Decimal('1.1')),
-00012110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012130: 2020 2028 362c 2064 6563 696d 616c 2e44     (6, decimal.D
-00012140: 6563 696d 616c 2827 3130 302e 3131 2729  ecimal('100.11')
-00012150: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
-00012160: 6c28 2731 3030 2e31 3127 2929 5d29 0a20  l('100.11'))]). 
-00012170: 2020 2064 6566 2074 6573 745f 696e 7365     def test_inse
-00012180: 7274 5f72 6574 7572 6e69 6e67 2873 656c  rt_returning(sel
-00012190: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
-000121a0: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
-000121b0: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
-000121c0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
-000121d0: 7465 2827 696e 7365 7274 2069 6e74 6f20  te('insert into 
-000121e0: 5432 2028 4331 2c43 3130 2c43 3131 2920  T2 (C1,C10,C11) 
-000121f0: 7661 6c75 6573 2028 3f2c 3f2c 3f29 2072  values (?,?,?) r
-00012200: 6574 7572 6e69 6e67 2043 3127 2c20 5b37  eturning C1', [7
-00012210: 2c20 312e 312c 2031 2e31 5d29 0a20 2020  , 1.1, 1.1]).   
-00012220: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00012230: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
-00012240: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012250: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-00012260: 6c28 7265 7375 6c74 2c20 5b28 372c 295d  l(result, [(7,)]
-00012270: 290a 2020 2020 6465 6620 7465 7374 5f69  ).    def test_i
-00012280: 6e73 6572 745f 626f 6f6c 6561 6e28 7365  nsert_boolean(se
-00012290: 6c66 293a 0a20 2020 2020 2020 2077 6974  lf):.        wit
-000122a0: 6820 7365 6c66 2e63 6f6e 2e63 7572 736f  h self.con.curso
-000122b0: 7228 2920 6173 2063 7572 3a0a 2020 2020  r() as cur:.    
-000122c0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-000122d0: 7574 6528 2769 6e73 6572 7420 696e 746f  ute('insert into
-000122e0: 2054 3220 2843 312c 4331 3729 2076 616c   T2 (C1,C17) val
-000122f0: 7565 7320 283f 2c3f 2920 7265 7475 726e  ues (?,?) return
-00012300: 696e 6720 4331 272c 205b 382c 2054 7275  ing C1', [8, Tru
-00012310: 655d 290a 2020 2020 2020 2020 2020 2020  e]).            
-00012320: 6375 722e 7374 6174 656d 656e 742e 5f6c  cur.statement._l
-00012330: 6f67 6769 6e67 5f69 645f 203d 2027 5374  ogging_id_ = 'St
-00012340: 6d74 5b31 5d27 0a20 2020 2020 2020 2020  mt[1]'.         
-00012350: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
-00012360: 696e 7365 7274 2069 6e74 6f20 5432 2028  insert into T2 (
-00012370: 4331 2c43 3137 2920 7661 6c75 6573 2028  C1,C17) values (
-00012380: 3f2c 3f29 2072 6574 7572 6e69 6e67 2043  ?,?) returning C
-00012390: 3127 2c20 5b38 2c20 4661 6c73 655d 290a  1', [8, False]).
-000123a0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-000123b0: 6578 6563 7574 6528 2773 656c 6563 7420  execute('select 
-000123c0: 4331 2c43 3137 2066 726f 6d20 5432 2077  C1,C17 from T2 w
-000123d0: 6865 7265 2043 3120 3d20 3827 290a 2020  here C1 = 8').  
-000123e0: 2020 2020 2020 2020 2020 6375 722e 7374            cur.st
-000123f0: 6174 656d 656e 742e 5f6c 6f67 6769 6e67  atement._logging
-00012400: 5f69 645f 203d 2027 5374 6d74 5b32 5d27  _id_ = 'Stmt[2]'
-00012410: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00012420: 756c 7420 3d20 6375 722e 6665 7463 6861  ult = cur.fetcha
-00012430: 6c6c 2829 0a20 2020 2020 2020 2020 2020  ll().           
-00012440: 2073 656c 662e 6173 7365 7274 4c69 7374   self.assertList
-00012450: 4571 7561 6c28 7265 7375 6c74 2c20 5b28  Equal(result, [(
-00012460: 382c 2054 7275 6529 2c20 2838 2c20 4661  8, True), (8, Fa
-00012470: 6c73 6529 5d29 0a0a 636c 6173 7320 5465  lse)])..class Te
-00012480: 7374 5374 6f72 6564 5072 6f63 2844 7269  stStoredProc(Dri
-00012490: 7665 7254 6573 7442 6173 6529 3a0a 2020  verTestBase):.  
-000124a0: 2020 6465 6620 7365 7455 7028 7365 6c66    def setUp(self
-000124b0: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
-000124c0: 2829 2e73 6574 5570 2829 0a20 2020 2020  ().setUp().     
-000124d0: 2020 2073 656c 662e 6462 6669 6c65 203d     self.dbfile =
-000124e0: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
-000124f0: 6c66 2e64 6270 6174 682c 2073 656c 662e  lf.dbpath, self.
-00012500: 4642 5445 5354 5f44 4229 0a20 2020 2020  FBTEST_DB).     
-00012510: 2020 2073 656c 662e 636f 6e20 3d20 636f     self.con = co
-00012520: 6e6e 6563 7428 7365 6c66 2e64 6266 696c  nnect(self.dbfil
-00012530: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
-00012540: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
-00012550: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
-00012560: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
-00012570: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
-00012580: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
-00012590: 6e61 6d65 5f5f 0a20 2020 2020 2020 2073  name__.        s
-000125a0: 656c 662e 636f 6e2e 6578 6563 7574 655f  elf.con.execute_
-000125b0: 696d 6d65 6469 6174 6528 2264 656c 6574  immediate("delet
-000125c0: 6520 6672 6f6d 2074 2229 0a20 2020 2020  e from t").     
-000125d0: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
-000125e0: 6974 2829 0a20 2020 2064 6566 2074 6561  it().    def tea
-000125f0: 7244 6f77 6e28 7365 6c66 293a 0a20 2020  rDown(self):.   
-00012600: 2020 2020 2073 656c 662e 636f 6e2e 636c       self.con.cl
-00012610: 6f73 6528 290a 2020 2020 6465 6620 7465  ose().    def te
-00012620: 7374 5f63 616c 6c70 726f 6328 7365 6c66  st_callproc(self
-00012630: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
-00012640: 7365 6c66 2e63 6f6e 2e63 7572 736f 7228  self.con.cursor(
-00012650: 2920 6173 2063 7572 3a0a 2020 2020 2020  ) as cur:.      
-00012660: 2020 2020 2020 6375 722e 6361 6c6c 7072        cur.callpr
-00012670: 6f63 2827 7375 625f 746f 745f 6275 6467  oc('sub_tot_budg
-00012680: 6574 272c 205b 2731 3030 275d 290a 2020  et', ['100']).  
-00012690: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-000126a0: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-000126b0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-000126c0: 6c66 2e61 7373 6572 7454 7570 6c65 4571  lf.assertTupleEq
-000126d0: 7561 6c28 7265 7375 6c74 2c20 2864 6563  ual(result, (dec
-000126e0: 696d 616c 2e44 6563 696d 616c 2827 3338  imal.Decimal('38
-000126f0: 3030 3030 3027 292c 2064 6563 696d 616c  00000'), decimal
-00012700: 2e44 6563 696d 616c 2827 3736 3030 3030  .Decimal('760000
-00012710: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
-00012720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012730: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00012740: 6563 696d 616c 2e44 6563 696d 616c 2827  ecimal.Decimal('
-00012750: 3530 3030 3030 2729 2c20 6465 6369 6d61  500000'), decima
-00012760: 6c2e 4465 6369 6d61 6c28 2731 3530 3030  l.Decimal('15000
-00012770: 3030 2729 2929 0a20 2020 2020 2020 2020  00'))).         
-00012780: 2020 2023 0a20 2020 2020 2020 2020 2020     #.           
-00012790: 2063 7572 2e63 616c 6c70 726f 6328 2773   cur.callproc('s
-000127a0: 7562 5f74 6f74 5f62 7564 6765 7427 2c20  ub_tot_budget', 
-000127b0: 5b31 3030 5d29 0a20 2020 2020 2020 2020  [100]).         
-000127c0: 2020 2072 6573 756c 7420 3d20 6375 722e     result = cur.
-000127d0: 6665 7463 686f 6e65 2829 0a20 2020 2020  fetchone().     
-000127e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000127f0: 7274 5475 706c 6545 7175 616c 2872 6573  rtTupleEqual(res
-00012800: 756c 742c 2028 6465 6369 6d61 6c2e 4465  ult, (decimal.De
-00012810: 6369 6d61 6c28 2733 3830 3030 3030 2729  cimal('3800000')
-00012820: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
-00012830: 6c28 2737 3630 3030 3027 292c 0a20 2020  l('760000'),.   
-00012840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012860: 2020 2020 2020 2020 6465 6369 6d61 6c2e          decimal.
-00012870: 4465 6369 6d61 6c28 2735 3030 3030 3027  Decimal('500000'
-00012880: 292c 2064 6563 696d 616c 2e44 6563 696d  ), decimal.Decim
-00012890: 616c 2827 3135 3030 3030 3027 2929 290a  al('1500000'))).
-000128a0: 2020 2020 2020 2020 2020 2020 230a 2020              #.  
-000128b0: 2020 2020 2020 2020 2020 6375 722e 6361            cur.ca
-000128c0: 6c6c 7072 6f63 2827 7072 6f63 5f74 6573  llproc('proc_tes
-000128d0: 7427 2c20 5b31 305d 290a 2020 2020 2020  t', [10]).      
-000128e0: 2020 2020 2020 7265 7375 6c74 203d 2063        result = c
-000128f0: 7572 2e66 6574 6368 6f6e 6528 290a 2020  ur.fetchone().  
-00012900: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00012910: 7373 6572 7449 734e 6f6e 6528 7265 7375  ssertIsNone(resu
-00012920: 6c74 290a 2020 2020 2020 2020 2020 2020  lt).            
-00012930: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
-00012940: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-00012950: 722e 6578 6563 7574 6528 2773 656c 6563  r.execute('selec
-00012960: 7420 6331 2066 726f 6d20 7427 290a 2020  t c1 from t').  
-00012970: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00012980: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-00012990: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-000129a0: 6c66 2e61 7373 6572 7454 7570 6c65 4571  lf.assertTupleEq
-000129b0: 7561 6c28 7265 7375 6c74 2c20 7475 706c  ual(result, tupl
-000129c0: 6528 5b31 305d 2929 0a0a 636c 6173 7320  e([10]))..class 
-000129d0: 5465 7374 5365 7276 6572 5374 616e 6461  TestServerStanda
-000129e0: 7264 2844 7269 7665 7254 6573 7442 6173  rd(DriverTestBas
-000129f0: 6529 3a0a 2020 2020 6465 6620 7365 7455  e):.    def setU
-00012a00: 7028 7365 6c66 293a 0a20 2020 2020 2020  p(self):.       
-00012a10: 2073 7570 6572 2829 2e73 6574 5570 2829   super().setUp()
-00012a20: 0a20 2020 2020 2020 2073 656c 662e 6462  .        self.db
-00012a30: 6669 6c65 203d 206f 732e 7061 7468 2e6a  file = os.path.j
-00012a40: 6f69 6e28 7365 6c66 2e64 6270 6174 682c  oin(self.dbpath,
-00012a50: 2073 656c 662e 4642 5445 5354 5f44 4229   self.FBTEST_DB)
-00012a60: 0a20 2020 2064 6566 2074 6573 745f 6174  .    def test_at
-00012a70: 7461 6368 2873 656c 6629 3a0a 2020 2020  tach(self):.    
-00012a80: 2020 2020 7376 6320 3d20 636f 6e6e 6563      svc = connec
-00012a90: 745f 7365 7276 6572 2846 4254 4553 545f  t_server(FBTEST_
-00012aa0: 484f 5354 2c20 7573 6572 3d27 5359 5344  HOST, user='SYSD
-00012ab0: 4241 272c 2070 6173 7377 6f72 643d 4642  BA', password=FB
-00012ac0: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
-00012ad0: 2020 2020 2020 2073 7663 2e63 6c6f 7365         svc.close
-00012ae0: 2829 0a20 2020 2064 6566 2074 6573 745f  ().    def test_
-00012af0: 7175 6572 7928 7365 6c66 293a 0a20 2020  query(self):.   
-00012b00: 2020 2020 2077 6974 6820 636f 6e6e 6563       with connec
-00012b10: 745f 7365 7276 6572 2846 4254 4553 545f  t_server(FBTEST_
-00012b20: 484f 5354 2c20 7573 6572 3d27 5359 5344  HOST, user='SYSD
-00012b30: 4241 272c 2070 6173 7377 6f72 643d 4642  BA', password=FB
-00012b40: 5445 5354 5f50 4153 5357 4f52 4429 2061  TEST_PASSWORD) a
-00012b50: 7320 7376 633a 0a20 2020 2020 2020 2020  s svc:.         
-00012b60: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00012b70: 7561 6c28 7376 632e 696e 666f 2e6d 616e  ual(svc.info.man
-00012b80: 6167 6572 5f76 6572 7369 6f6e 2c20 3229  ager_version, 2)
-00012b90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012ba0: 662e 6173 7365 7274 5472 7565 2873 7663  f.assertTrue(svc
-00012bb0: 2e69 6e66 6f2e 7665 7273 696f 6e2e 7374  .info.version.st
-00012bc0: 6172 7473 7769 7468 2873 656c 662e 7665  artswith(self.ve
-00012bd0: 7273 696f 6e29 290a 2020 2020 2020 2020  rsion)).        
-00012be0: 2020 2020 7365 6c66 2e61 7373 6572 7447      self.assertG
-00012bf0: 7265 6174 6572 4571 7561 6c28 666c 6f61  reaterEqual(floa
-00012c00: 7428 7365 6c66 2e76 6572 7369 6f6e 292c  t(self.version),
-00012c10: 2073 7663 2e69 6e66 6f2e 656e 6769 6e65   svc.info.engine
-00012c20: 5f76 6572 7369 6f6e 290a 2020 2020 2020  _version).      
-00012c30: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00012c40: 7449 6e28 2746 6972 6562 6972 6427 2c20  tIn('Firebird', 
-00012c50: 7376 632e 696e 666f 2e61 7263 6869 7465  svc.info.archite
-00012c60: 6374 7572 6529 0a20 2020 2020 2020 2020  cture).         
-00012c70: 2020 2078 203d 2073 7663 2e69 6e66 6f2e     x = svc.info.
-00012c80: 686f 6d65 5f64 6972 6563 746f 7279 0a20  home_directory. 
-00012c90: 2020 2020 2020 2020 2020 2023 204f 6e20             # On 
-00012ca0: 5769 6e64 6f77 7320 6974 2072 6574 7572  Windows it retur
-00012cb0: 6e73 2027 7365 6375 7269 7479 2e64 6227  ns 'security.db'
-00012cc0: 2c20 6120 6275 673f 0a20 2020 2020 2020  , a bug?.       
-00012cd0: 2020 2020 2023 7365 6c66 2e61 7373 6572       #self.asser
-00012ce0: 7449 6e28 2773 6563 7572 6974 792e 6462  tIn('security.db
-00012cf0: 272c 2073 7663 2e69 6e66 6f2e 7365 6375  ', svc.info.secu
-00012d00: 7269 7479 5f64 6174 6162 6173 6529 0a20  rity_database). 
-00012d10: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00012d20: 6c66 2e76 6572 7369 6f6e 203d 3d20 4642  lf.version == FB
-00012d30: 3430 3a0a 2020 2020 2020 2020 2020 2020  40:.            
-00012d40: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-00012d50: 6e28 2773 6563 7572 6974 7934 2e66 6462  n('security4.fdb
-00012d60: 272e 7570 7065 7228 292c 2073 7663 2e69  '.upper(), svc.i
-00012d70: 6e66 6f2e 7365 6375 7269 7479 5f64 6174  nfo.security_dat
-00012d80: 6162 6173 652e 7570 7065 7228 2929 0a20  abase.upper()). 
-00012d90: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00012da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012db0: 2073 656c 662e 6173 7365 7274 496e 2827   self.assertIn('
-00012dc0: 7365 6375 7269 7479 332e 6664 6227 2c20  security3.fdb', 
-00012dd0: 7376 632e 696e 666f 2e73 6563 7572 6974  svc.info.securit
-00012de0: 795f 6461 7461 6261 7365 290a 2020 2020  y_database).    
-00012df0: 2020 2020 2020 2020 7820 3d20 7376 632e          x = svc.
-00012e00: 696e 666f 2e6c 6f63 6b5f 6469 7265 6374  info.lock_direct
-00012e10: 6f72 790a 2020 2020 2020 2020 2020 2020  ory.            
-00012e20: 7820 3d20 7376 632e 696e 666f 2e63 6170  x = svc.info.cap
-00012e30: 6162 696c 6974 6965 730a 2020 2020 2020  abilities.      
-00012e40: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00012e50: 7449 6e28 5365 7276 6572 4361 7061 6269  tIn(ServerCapabi
-00012e60: 6c69 7479 2e52 454d 4f54 455f 484f 502c  lity.REMOTE_HOP,
-00012e70: 2078 290a 2020 2020 2020 2020 2020 2020   x).            
-00012e80: 7365 6c66 2e61 7373 6572 744e 6f74 496e  self.assertNotIn
-00012e90: 2853 6572 7665 7243 6170 6162 696c 6974  (ServerCapabilit
-00012ea0: 792e 4e4f 5f46 4f52 4345 445f 5752 4954  y.NO_FORCED_WRIT
-00012eb0: 452c 2078 290a 2020 2020 2020 2020 2020  E, x).          
-00012ec0: 2020 7820 3d20 7376 632e 696e 666f 2e6d    x = svc.info.m
-00012ed0: 6573 7361 6765 5f64 6972 6563 746f 7279  essage_directory
-00012ee0: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
-00012ef0: 6820 636f 6e6e 6563 7428 6622 7b46 4254  h connect(f"{FBT
-00012f00: 4553 545f 484f 5354 7d3a 7b73 656c 662e  EST_HOST}:{self.
-00012f10: 6462 6669 6c65 7d22 2c20 7573 6572 3d46  dbfile}", user=F
-00012f20: 4254 4553 545f 5553 4552 2c20 7061 7373  BTEST_USER, pass
-00012f30: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
-00012f40: 574f 5244 2920 6173 2063 6f6e 313a 0a20  WORD) as con1:. 
-00012f50: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00012f60: 6f6e 312e 5f6c 6f67 6769 6e67 5f69 645f  on1._logging_id_
-00012f70: 203d 2073 656c 662e 5f5f 636c 6173 735f   = self.__class_
-00012f80: 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020 2020  _.__name__.     
-00012f90: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00012fa0: 636f 6e6e 6563 7428 6627 7b46 4254 4553  connect(f'{FBTES
-00012fb0: 545f 484f 5354 7d3a 656d 706c 6f79 6565  T_HOST}:employee
-00012fc0: 272c 2075 7365 723d 4642 5445 5354 5f55  ', user=FBTEST_U
-00012fd0: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
-00012fe0: 5445 5354 5f50 4153 5357 4f52 4429 2061  TEST_PASSWORD) a
-00012ff0: 7320 636f 6e32 3a0a 2020 2020 2020 2020  s con2:.        
-00013000: 2020 2020 2020 2020 2020 2020 636f 6e32              con2
-00013010: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
-00013020: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-00013030: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
-00013040: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00013050: 2e61 7373 6572 7447 7265 6174 6572 4571  .assertGreaterEq
-00013060: 7561 6c28 6c65 6e28 7376 632e 696e 666f  ual(len(svc.info
-00013070: 2e61 7474 6163 6865 645f 6461 7461 6261  .attached_databa
-00013080: 7365 7329 2c20 322c 0a20 2020 2020 2020  ses), 2,.       
-00013090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000130a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000130b0: 2020 2020 2022 5368 6f75 6c64 2077 6f72       "Should wor
-000130c0: 6b20 666f 7220 5375 7065 7273 6572 7665  k for Superserve
-000130d0: 722c 206d 6179 2066 6169 6c20 7769 7468  r, may fail with
-000130e0: 2076 616c 7565 2030 2066 6f72 2043 6c61   value 0 for Cla
-000130f0: 7373 6963 2229 0a20 2020 2020 2020 2020  ssic").         
-00013100: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00013110: 6173 7365 7274 496e 2873 656c 662e 6462  assertIn(self.db
-00013120: 6669 6c65 2e75 7070 6572 2829 2c0a 2020  file.upper(),.  
-00013130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013150: 5b73 2e75 7070 6572 2829 2066 6f72 2073  [s.upper() for s
-00013160: 2069 6e20 7376 632e 696e 666f 2e61 7474   in svc.info.att
-00013170: 6163 6865 645f 6461 7461 6261 7365 735d  ached_databases]
-00013180: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00013190: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000131a0: 7447 7265 6174 6572 4571 7561 6c28 7376  tGreaterEqual(sv
-000131b0: 632e 696e 666f 2e63 6f6e 6e65 6374 696f  c.info.connectio
-000131c0: 6e5f 636f 756e 742c 2032 290a 2020 2020  n_count, 2).    
-000131d0: 2020 2020 2020 2020 2320 4241 4420 7265          # BAD re
-000131e0: 7175 6573 7420 636f 6465 0a20 2020 2020  quest code.     
-000131f0: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
-00013200: 2e61 7373 6572 7452 6169 7365 7328 4572  .assertRaises(Er
-00013210: 726f 7229 2061 7320 636d 3a0a 2020 2020  ror) as cm:.    
-00013220: 2020 2020 2020 2020 2020 2020 7376 632e              svc.
-00013230: 696e 666f 2e67 6574 5f69 6e66 6f28 3235  info.get_info(25
-00013240: 3529 0a20 2020 2020 2020 2020 2020 2073  5).            s
-00013250: 656c 662e 6173 7365 7274 5475 706c 6545  elf.assertTupleE
-00013260: 7175 616c 2863 6d2e 6578 6365 7074 696f  qual(cm.exceptio
-00013270: 6e2e 6172 6773 2c0a 2020 2020 2020 2020  n.args,.        
-00013280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013290: 2020 2020 2020 2020 2020 2822 6665 6174            ("feat
-000132a0: 7572 6520 6973 206e 6f74 2073 7570 706f  ure is not suppo
-000132b0: 7274 6564 222c 2929 0a0a 2020 2020 6465  rted",))..    de
-000132c0: 6620 7465 7374 5f72 756e 6e69 6e67 2873  f test_running(s
-000132d0: 656c 6629 3a0a 2020 2020 2020 2020 7769  elf):.        wi
-000132e0: 7468 2063 6f6e 6e65 6374 5f73 6572 7665  th connect_serve
-000132f0: 7228 4642 5445 5354 5f48 4f53 542c 2075  r(FBTEST_HOST, u
-00013300: 7365 723d 2753 5953 4442 4127 2c20 7061  ser='SYSDBA', pa
-00013310: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
-00013320: 5353 574f 5244 2920 6173 2073 7663 3a0a  SSWORD) as svc:.
-00013330: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00013340: 2e61 7373 6572 7446 616c 7365 2873 7663  .assertFalse(svc
-00013350: 2e69 735f 7275 6e6e 696e 6728 2929 0a20  .is_running()). 
-00013360: 2020 2020 2020 2020 2020 2073 7663 2e69             svc.i
-00013370: 6e66 6f2e 6765 745f 6c6f 6728 290a 2020  nfo.get_log().  
-00013380: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00013390: 7373 6572 7454 7275 6528 7376 632e 6973  ssertTrue(svc.is
-000133a0: 5f72 756e 6e69 6e67 2829 290a 2020 2020  _running()).    
-000133b0: 2020 2020 2020 2020 2320 6665 7463 6820          # fetch 
-000133c0: 6d61 7465 7269 616c 697a 6564 0a20 2020  materialized.   
-000133d0: 2020 2020 2020 2020 2073 7663 2e72 6561           svc.rea
-000133e0: 646c 696e 6573 2829 0a20 2020 2020 2020  dlines().       
-000133f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00013400: 4661 6c73 6528 7376 632e 6973 5f72 756e  False(svc.is_run
-00013410: 6e69 6e67 2829 290a 2020 2020 6465 6620  ning()).    def 
-00013420: 7465 7374 5f77 6169 7428 7365 6c66 293a  test_wait(self):
-00013430: 0a20 2020 2020 2020 2077 6974 6820 636f  .        with co
-00013440: 6e6e 6563 745f 7365 7276 6572 2846 4254  nnect_server(FBT
-00013450: 4553 545f 484f 5354 2c20 7573 6572 3d27  EST_HOST, user='
-00013460: 5359 5344 4241 272c 2070 6173 7377 6f72  SYSDBA', passwor
-00013470: 643d 4642 5445 5354 5f50 4153 5357 4f52  d=FBTEST_PASSWOR
-00013480: 4429 2061 7320 7376 633a 0a20 2020 2020  D) as svc:.     
-00013490: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000134a0: 7274 4661 6c73 6528 7376 632e 6973 5f72  rtFalse(svc.is_r
-000134b0: 756e 6e69 6e67 2829 290a 2020 2020 2020  unning()).      
-000134c0: 2020 2020 2020 7376 632e 696e 666f 2e67        svc.info.g
-000134d0: 6574 5f6c 6f67 2829 0a20 2020 2020 2020  et_log().       
-000134e0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000134f0: 5472 7565 2873 7663 2e69 735f 7275 6e6e  True(svc.is_runn
-00013500: 696e 6728 2929 0a20 2020 2020 2020 2020  ing()).         
-00013510: 2020 2073 7663 2e77 6169 7428 290a 2020     svc.wait().  
-00013520: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00013530: 7373 6572 7446 616c 7365 2873 7663 2e69  ssertFalse(svc.i
-00013540: 735f 7275 6e6e 696e 6728 2929 0a0a 636c  s_running())..cl
-00013550: 6173 7320 5465 7374 5365 7276 6572 5365  ass TestServerSe
-00013560: 7276 6963 6573 2844 7269 7665 7254 6573  rvices(DriverTes
-00013570: 7442 6173 6529 3a0a 2020 2020 6465 6620  tBase):.    def 
-00013580: 7365 7455 7028 7365 6c66 293a 0a20 2020  setUp(self):.   
-00013590: 2020 2020 2073 7570 6572 2829 2e73 6574       super().set
-000135a0: 5570 2829 0a20 2020 2020 2020 2073 656c  Up().        sel
-000135b0: 662e 6462 6669 6c65 203d 206f 732e 7061  f.dbfile = os.pa
-000135c0: 7468 2e6a 6f69 6e28 7365 6c66 2e64 6270  th.join(self.dbp
-000135d0: 6174 682c 2073 656c 662e 4642 5445 5354  ath, self.FBTEST
-000135e0: 5f44 4229 0a20 2020 2020 2020 2073 656c  _DB).        sel
-000135f0: 662e 6662 6b20 3d20 6f73 2e70 6174 682e  f.fbk = os.path.
-00013600: 6a6f 696e 2873 656c 662e 6462 7061 7468  join(self.dbpath
-00013610: 2c20 2774 6573 745f 656d 706c 6f79 6565  , 'test_employee
-00013620: 2e66 626b 2729 0a20 2020 2020 2020 2073  .fbk').        s
-00013630: 656c 662e 6662 6b32 203d 206f 732e 7061  elf.fbk2 = os.pa
-00013640: 7468 2e6a 6f69 6e28 7365 6c66 2e64 6270  th.join(self.dbp
-00013650: 6174 682c 2027 7465 7374 5f65 6d70 6c6f  ath, 'test_emplo
-00013660: 7965 652e 6662 6b32 2729 0a20 2020 2020  yee.fbk2').     
-00013670: 2020 2073 656c 662e 7266 6462 203d 206f     self.rfdb = o
-00013680: 732e 7061 7468 2e6a 6f69 6e28 7365 6c66  s.path.join(self
-00013690: 2e64 6270 6174 682c 2027 7465 7374 5f65  .dbpath, 'test_e
-000136a0: 6d70 6c6f 7965 652e 6664 6227 290a 2020  mployee.fdb').  
-000136b0: 2020 2020 2020 7365 6c66 2e73 7663 203d        self.svc =
-000136c0: 2063 6f6e 6e65 6374 5f73 6572 7665 7228   connect_server(
-000136d0: 4642 5445 5354 5f48 4f53 542c 2075 7365  FBTEST_HOST, use
-000136e0: 723d 2753 5953 4442 4127 2c20 7061 7373  r='SYSDBA', pass
-000136f0: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
-00013700: 574f 5244 290a 2020 2020 2020 2020 7365  WORD).        se
-00013710: 6c66 2e63 6f6e 203d 2063 6f6e 6e65 6374  lf.con = connect
-00013720: 2873 656c 662e 6462 6669 6c65 2c20 7573  (self.dbfile, us
-00013730: 6572 3d46 4254 4553 545f 5553 4552 2c20  er=FBTEST_USER, 
-00013740: 7061 7373 776f 7264 3d46 4254 4553 545f  password=FBTEST_
-00013750: 5041 5353 574f 5244 290a 2020 2020 2020  PASSWORD).      
-00013760: 2020 7365 6c66 2e63 6f6e 2e5f 6c6f 6767    self.con._logg
-00013770: 696e 675f 6964 5f20 3d20 7365 6c66 2e5f  ing_id_ = self._
-00013780: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-00013790: 5f0a 2020 2020 2020 2020 7365 6c66 2e63  _.        self.c
-000137a0: 6f6e 2e65 7865 6375 7465 5f69 6d6d 6564  on.execute_immed
-000137b0: 6961 7465 2822 6465 6c65 7465 2066 726f  iate("delete fro
-000137c0: 6d20 7422 290a 2020 2020 2020 2020 7365  m t").        se
-000137d0: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
-000137e0: 2020 2020 2020 2020 6320 3d20 6372 6561          c = crea
-000137f0: 7465 5f64 6174 6162 6173 6528 6622 7b46  te_database(f"{F
-00013800: 4254 4553 545f 484f 5354 7d3a 7b73 656c  BTEST_HOST}:{sel
-00013810: 662e 7266 6462 7d22 2c0a 2020 2020 2020  f.rfdb}",.      
-00013820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013830: 2020 2020 2020 7573 6572 3d46 4254 4553        user=FBTES
-00013840: 545f 5553 4552 2c20 7061 7373 776f 7264  T_USER, password
-00013850: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
-00013860: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013870: 2020 2020 2020 2020 2020 2020 2020 6f76                ov
-00013880: 6572 7772 6974 653d 5472 7565 290a 2020  erwrite=True).  
-00013890: 2020 2020 2020 632e 636c 6f73 6528 290a        c.close().
-000138a0: 2020 2020 6465 6620 7465 6172 446f 776e      def tearDown
-000138b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000138c0: 7365 6c66 2e73 7663 2e63 6c6f 7365 2829  self.svc.close()
-000138d0: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-000138e0: 6e2e 636c 6f73 6528 290a 2020 2020 2020  n.close().      
-000138f0: 2020 6966 206f 732e 7061 7468 2e65 7869    if os.path.exi
-00013900: 7374 7328 7365 6c66 2e72 6664 6229 3a0a  sts(self.rfdb):.
-00013910: 2020 2020 2020 2020 2020 2020 6f73 2e72              os.r
-00013920: 656d 6f76 6528 7365 6c66 2e72 6664 6229  emove(self.rfdb)
-00013930: 0a20 2020 2020 2020 2069 6620 6f73 2e70  .        if os.p
-00013940: 6174 682e 6578 6973 7473 2873 656c 662e  ath.exists(self.
-00013950: 6662 6b29 3a0a 2020 2020 2020 2020 2020  fbk):.          
-00013960: 2020 6f73 2e72 656d 6f76 6528 7365 6c66    os.remove(self
-00013970: 2e66 626b 290a 2020 2020 2020 2020 6966  .fbk).        if
-00013980: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
-00013990: 7365 6c66 2e66 626b 3229 3a0a 2020 2020  self.fbk2):.    
-000139a0: 2020 2020 2020 2020 6f73 2e72 656d 6f76          os.remov
-000139b0: 6528 7365 6c66 2e66 626b 3229 0a20 2020  e(self.fbk2).   
-000139c0: 2064 6566 2074 6573 745f 3031 5f6f 7574   def test_01_out
-000139d0: 7075 745f 6279 5f6c 696e 6528 7365 6c66  put_by_line(self
-000139e0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-000139f0: 7376 632e 6d6f 6465 203d 2053 7276 496e  svc.mode = SrvIn
-00013a00: 666f 436f 6465 2e4c 494e 450a 2020 2020  foCode.LINE.    
-00013a10: 2020 2020 7365 6c66 2e74 6573 745f 3033      self.test_03
-00013a20: 5f6c 6f67 2829 0a20 2020 2064 6566 2074  _log().    def t
-00013a30: 6573 745f 3032 5f6f 7574 7075 745f 746f  est_02_output_to
-00013a40: 5f65 6f66 2873 656c 6629 3a0a 2020 2020  _eof(self):.    
-00013a50: 2020 2020 7365 6c66 2e73 7663 2e6d 6f64      self.svc.mod
-00013a60: 6520 3d20 5372 7649 6e66 6f43 6f64 652e  e = SrvInfoCode.
-00013a70: 544f 5f45 4f46 0a20 2020 2020 2020 2073  TO_EOF.        s
-00013a80: 656c 662e 7465 7374 5f30 335f 6c6f 6728  elf.test_03_log(
-00013a90: 290a 2020 2020 6465 6620 7465 7374 5f30  ).    def test_0
-00013aa0: 335f 6c6f 6728 7365 6c66 293a 0a20 2020  3_log(self):.   
-00013ab0: 2020 2020 2064 6566 2066 6574 6368 6c69       def fetchli
-00013ac0: 6e65 286c 696e 6529 3a0a 2020 2020 2020  ne(line):.      
-00013ad0: 2020 2020 2020 6f75 7470 7574 2e61 7070        output.app
-00013ae0: 656e 6428 6c69 6e65 290a 0a20 2020 2020  end(line)..     
-00013af0: 2020 2073 656c 662e 7376 632e 696e 666f     self.svc.info
-00013b00: 2e67 6574 5f6c 6f67 2829 0a20 2020 2020  .get_log().     
-00013b10: 2020 2023 2066 6574 6368 206d 6174 6572     # fetch mater
-00013b20: 6961 6c69 7a65 640a 2020 2020 2020 2020  ialized.        
-00013b30: 6c6f 6720 3d20 7365 6c66 2e73 7663 2e72  log = self.svc.r
+00011280: 2020 5b28 322c 2031 2c20 3932 3233 3337    [(2, 1, 922337
+00011290: 3230 3336 3835 3437 3735 3830 3729 2c20  2036854775807), 
+000112a0: 2832 2c20 312c 202d 3932 3233 3337 3230  (2, 1, -92233720
+000112b0: 3336 3835 3437 3735 3830 3829 5d29 0a20  36854775808)]). 
+000112c0: 2020 2064 6566 2074 6573 745f 696e 7365     def test_inse
+000112d0: 7274 5f63 6861 725f 7661 7263 6861 7228  rt_char_varchar(
+000112e0: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
+000112f0: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
+00011300: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
+00011310: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+00011320: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
+00011330: 746f 2054 3220 2843 312c 4334 2c43 3529  to T2 (C1,C4,C5)
+00011340: 2076 616c 7565 7320 283f 2c3f 2c3f 2927   values (?,?,?)'
+00011350: 2c20 5b32 2c20 2741 4127 2c20 2741 4127  , [2, 'AA', 'AA'
+00011360: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
+00011370: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
+00011380: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+00011390: 2e65 7865 6375 7465 2827 7365 6c65 6374  .execute('select
+000113a0: 2043 312c 4334 2c43 3520 6672 6f6d 2054   C1,C4,C5 from T
+000113b0: 3220 7768 6572 6520 4331 203d 2032 2729  2 where C1 = 2')
+000113c0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+000113d0: 7320 3d20 6375 722e 6665 7463 6861 6c6c  s = cur.fetchall
+000113e0: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+000113f0: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
+00011400: 7561 6c28 726f 7773 2c20 5b28 322c 2027  ual(rows, [(2, '
+00011410: 4141 2020 2027 2c20 2741 4127 295d 290a  AA   ', 'AA')]).
+00011420: 2020 2020 2020 2020 2020 2020 2320 546f              # To
+00011430: 6f20 6c6f 6e67 2076 616c 7565 730a 2020  o long values.  
+00011440: 2020 2020 2020 2020 2020 7769 7468 2073            with s
+00011450: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
+00011460: 2844 6174 6162 6173 6545 7272 6f72 2920  (DatabaseError) 
+00011470: 6173 2063 6d3a 0a20 2020 2020 2020 2020  as cm:.         
+00011480: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+00011490: 7465 2827 696e 7365 7274 2069 6e74 6f20  te('insert into 
+000114a0: 5432 2028 4331 2c43 3429 2076 616c 7565  T2 (C1,C4) value
+000114b0: 7320 283f 2c3f 2927 2c20 5b33 2c20 2731  s (?,?)', [3, '1
+000114c0: 3233 3435 3627 5d29 0a20 2020 2020 2020  23456']).       
+000114d0: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
+000114e0: 6e2e 636f 6d6d 6974 2829 0a20 2020 2020  n.commit().     
+000114f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00011500: 7274 5475 706c 6545 7175 616c 2863 6d2e  rtTupleEqual(cm.
+00011510: 6578 6365 7074 696f 6e2e 6172 6773 2c0a  exception.args,.
+00011520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011540: 2020 2827 4479 6e61 6d69 6320 5351 4c20    ('Dynamic SQL 
+00011550: 4572 726f 725c 6e2d 5351 4c20 6572 726f  Error\n-SQL erro
+00011560: 7220 636f 6465 203d 202d 3330 335c 6e2d  r code = -303\n-
+00011570: 6172 6974 686d 6574 6963 2065 7863 6570  arithmetic excep
+00011580: 7469 6f6e 2c20 6e75 6d65 7269 6320 6f76  tion, numeric ov
+00011590: 6572 666c 6f77 2c20 6f72 2073 7472 696e  erflow, or strin
+000115a0: 6720 7472 756e 6361 7469 6f6e 5c6e 2d73  g truncation\n-s
+000115b0: 7472 696e 6720 7269 6768 7420 7472 756e  tring right trun
+000115c0: 6361 7469 6f6e 5c6e 2d65 7870 6563 7465  cation\n-expecte
+000115d0: 6420 6c65 6e67 7468 2035 2c20 6163 7475  d length 5, actu
+000115e0: 616c 2036 272c 2929 0a20 2020 2020 2020  al 6',)).       
+000115f0: 2020 2020 2077 6974 6820 7365 6c66 2e61       with self.a
+00011600: 7373 6572 7452 6169 7365 7328 4461 7461  ssertRaises(Data
+00011610: 6261 7365 4572 726f 7229 2061 7320 636d  baseError) as cm
+00011620: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00011630: 2020 6375 722e 6578 6563 7574 6528 2769    cur.execute('i
+00011640: 6e73 6572 7420 696e 746f 2054 3220 2843  nsert into T2 (C
+00011650: 312c 4335 2920 7661 6c75 6573 2028 3f2c  1,C5) values (?,
+00011660: 3f29 272c 205b 332c 2027 3132 3334 3536  ?)', [3, '123456
+00011670: 3738 3930 3127 5d29 0a20 2020 2020 2020  78901']).       
+00011680: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
+00011690: 6e2e 636f 6d6d 6974 2829 0a20 2020 2020  n.commit().     
+000116a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000116b0: 6173 7365 7274 5475 706c 6545 7175 616c  assertTupleEqual
+000116c0: 2863 6d2e 6578 6365 7074 696f 6e2e 6172  (cm.exception.ar
+000116d0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+000116e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000116f0: 2020 2020 2020 2020 2020 2827 4479 6e61            ('Dyna
+00011700: 6d69 6320 5351 4c20 4572 726f 725c 6e2d  mic SQL Error\n-
+00011710: 5351 4c20 6572 726f 7220 636f 6465 203d  SQL error code =
+00011720: 202d 3330 335c 6e2d 6172 6974 686d 6574   -303\n-arithmet
+00011730: 6963 2065 7863 6570 7469 6f6e 2c20 6e75  ic exception, nu
+00011740: 6d65 7269 6320 6f76 6572 666c 6f77 2c20  meric overflow, 
+00011750: 6f72 2073 7472 696e 6720 7472 756e 6361  or string trunca
+00011760: 7469 6f6e 5c6e 2d73 7472 696e 6720 7269  tion\n-string ri
+00011770: 6768 7420 7472 756e 6361 7469 6f6e 5c6e  ght truncation\n
+00011780: 2d65 7870 6563 7465 6420 6c65 6e67 7468  -expected length
+00011790: 2031 302c 2061 6374 7561 6c20 3131 272c   10, actual 11',
+000117a0: 2929 0a20 2020 2064 6566 2074 6573 745f  )).    def test_
+000117b0: 696e 7365 7274 5f64 6174 6574 696d 6528  insert_datetime(
+000117c0: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
+000117d0: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
+000117e0: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
+000117f0: 2020 2020 2020 2020 2020 6e6f 7720 3d20            now = 
+00011800: 6461 7465 7469 6d65 2e64 6174 6574 696d  datetime.datetim
+00011810: 6528 3230 3131 2c20 3131 2c20 3133 2c20  e(2011, 11, 13, 
+00011820: 3135 2c20 3030 2c20 312c 2032 3030 3030  15, 00, 1, 20000
+00011830: 3029 0a20 2020 2020 2020 2020 2020 2063  0).            c
+00011840: 7572 2e65 7865 6375 7465 2827 696e 7365  ur.execute('inse
+00011850: 7274 2069 6e74 6f20 5432 2028 4331 2c43  rt into T2 (C1,C
+00011860: 362c 4337 2c43 3829 2076 616c 7565 7320  6,C7,C8) values 
+00011870: 283f 2c3f 2c3f 2c3f 2927 2c20 5b33 2c20  (?,?,?,?)', [3, 
+00011880: 6e6f 772e 6461 7465 2829 2c20 6e6f 772e  now.date(), now.
+00011890: 7469 6d65 2829 2c20 6e6f 775d 290a 2020  time(), now]).  
+000118a0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+000118b0: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
+000118c0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
+000118d0: 7574 6528 2773 656c 6563 7420 4331 2c43  ute('select C1,C
+000118e0: 362c 4337 2c43 3820 6672 6f6d 2054 3220  6,C7,C8 from T2 
+000118f0: 7768 6572 6520 4331 203d 2033 2729 0a20  where C1 = 3'). 
+00011900: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
+00011910: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
+00011920: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011930: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
+00011940: 6c28 726f 7773 2c0a 2020 2020 2020 2020  l(rows,.        
+00011950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011960: 2020 2020 2020 2020 205b 2833 2c20 6461           [(3, da
+00011970: 7465 7469 6d65 2e64 6174 6528 3230 3131  tetime.date(2011
+00011980: 2c20 3131 2c20 3133 292c 2064 6174 6574  , 11, 13), datet
+00011990: 696d 652e 7469 6d65 2831 352c 2030 2c20  ime.time(15, 0, 
+000119a0: 312c 2032 3030 3030 3029 2c0a 2020 2020  1, 200000),.    
+000119b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119c0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000119d0: 6174 6574 696d 652e 6461 7465 7469 6d65  atetime.datetime
+000119e0: 2832 3031 312c 2031 312c 2031 332c 2031  (2011, 11, 13, 1
+000119f0: 352c 2030 2c20 312c 2032 3030 3030 3029  5, 0, 1, 200000)
+00011a00: 295d 290a 0a20 2020 2020 2020 2020 2020  )])..           
+00011a10: 2063 7572 2e65 7865 6375 7465 2827 696e   cur.execute('in
+00011a20: 7365 7274 2069 6e74 6f20 5432 2028 4331  sert into T2 (C1
+00011a30: 2c43 362c 4337 2c43 3829 2076 616c 7565  ,C6,C7,C8) value
+00011a40: 7320 283f 2c3f 2c3f 2c3f 2927 2c20 5b34  s (?,?,?,?)', [4
+00011a50: 2c20 2732 3031 312d 3131 2d31 3327 2c20  , '2011-11-13', 
+00011a60: 2731 353a 303a 313a 3230 3027 2c20 2732  '15:0:1:200', '2
+00011a70: 3031 312d 3131 2d31 3320 3135 3a30 3a31  011-11-13 15:0:1
+00011a80: 3a32 3030 3027 5d29 0a20 2020 2020 2020  :2000']).       
+00011a90: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
+00011aa0: 6d6d 6974 2829 0a20 2020 2020 2020 2020  mmit().         
+00011ab0: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
+00011ac0: 7365 6c65 6374 2043 312c 4336 2c43 372c  select C1,C6,C7,
+00011ad0: 4338 2066 726f 6d20 5432 2077 6865 7265  C8 from T2 where
+00011ae0: 2043 3120 3d20 3427 290a 2020 2020 2020   C1 = 4').      
+00011af0: 2020 2020 2020 726f 7773 203d 2063 7572        rows = cur
+00011b00: 2e66 6574 6368 616c 6c28 290a 2020 2020  .fetchall().    
+00011b10: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00011b20: 6572 744c 6973 7445 7175 616c 2872 6f77  ertListEqual(row
+00011b30: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00011b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b50: 2020 2020 5b28 342c 2064 6174 6574 696d      [(4, datetim
+00011b60: 652e 6461 7465 2832 3031 312c 2031 312c  e.date(2011, 11,
+00011b70: 2031 3329 2c20 6461 7465 7469 6d65 2e74   13), datetime.t
+00011b80: 696d 6528 3135 2c20 302c 2031 2c20 3230  ime(15, 0, 1, 20
+00011b90: 3030 3030 292c 0a20 2020 2020 2020 2020  0000),.         
+00011ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011bb0: 2020 2020 2020 2020 2020 6461 7465 7469            dateti
+00011bc0: 6d65 2e64 6174 6574 696d 6528 3230 3131  me.datetime(2011
+00011bd0: 2c20 3131 2c20 3133 2c20 3135 2c20 302c  , 11, 13, 15, 0,
+00011be0: 2031 2c20 3230 3030 3030 2929 5d29 0a20   1, 200000))]). 
+00011bf0: 2020 2064 6566 2074 6573 745f 696e 7365     def test_inse
+00011c00: 7274 5f62 6c6f 6228 7365 6c66 293a 0a20  rt_blob(self):. 
+00011c10: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
+00011c20: 2e63 6f6e 2e63 7572 736f 7228 2920 6173  .con.cursor() as
+00011c30: 2063 7572 2c20 7365 6c66 2e63 6f6e 322e   cur, self.con2.
+00011c40: 6375 7273 6f72 2829 2061 7320 6375 7232  cursor() as cur2
+00011c50: 3a0a 2020 2020 2020 2020 2020 2020 6375  :.            cu
+00011c60: 722e 6578 6563 7574 6528 2769 6e73 6572  r.execute('inser
+00011c70: 7420 696e 746f 2054 3220 2843 312c 4339  t into T2 (C1,C9
+00011c80: 2920 7661 6c75 6573 2028 3f2c 3f29 272c  ) values (?,?)',
+00011c90: 205b 342c 2027 5468 6973 2069 7320 6120   [4, 'This is a 
+00011ca0: 424c 4f42 2127 5d29 0a20 2020 2020 2020  BLOB!']).       
+00011cb0: 2020 2020 2063 7572 2e74 7261 6e73 6163       cur.transac
+00011cc0: 7469 6f6e 2e63 6f6d 6d69 7428 290a 2020  tion.commit().  
+00011cd0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+00011ce0: 6563 7574 6528 2773 656c 6563 7420 4331  ecute('select C1
+00011cf0: 2c43 3920 6672 6f6d 2054 3220 7768 6572  ,C9 from T2 wher
+00011d00: 6520 4331 203d 2034 2729 0a20 2020 2020  e C1 = 4').     
+00011d10: 2020 2020 2020 2072 6f77 7320 3d20 6375         rows = cu
+00011d20: 722e 6665 7463 6861 6c6c 2829 0a20 2020  r.fetchall().   
+00011d30: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00011d40: 7365 7274 4c69 7374 4571 7561 6c28 726f  sertListEqual(ro
+00011d50: 7773 2c20 5b28 342c 2027 5468 6973 2069  ws, [(4, 'This i
+00011d60: 7320 6120 424c 4f42 2127 295d 290a 2020  s a BLOB!')]).  
+00011d70: 2020 2020 2020 2020 2020 2320 4e6f 6e2d            # Non-
+00011d80: 7465 7874 7561 6c20 424c 4f42 0a20 2020  textual BLOB.   
+00011d90: 2020 2020 2020 2020 2062 6c6f 625f 6461           blob_da
+00011da0: 7461 203d 2062 7974 6573 285b 302c 2031  ta = bytes([0, 1
+00011db0: 2c20 322c 2033 2c20 342c 2035 2c20 362c  , 2, 3, 4, 5, 6,
+00011dc0: 2037 2c20 382c 2039 2c20 3130 5d29 0a20   7, 8, 9, 10]). 
+00011dd0: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+00011de0: 7865 6375 7465 2827 696e 7365 7274 2069  xecute('insert i
+00011df0: 6e74 6f20 5432 2028 4331 2c43 3136 2920  nto T2 (C1,C16) 
+00011e00: 7661 6c75 6573 2028 3f2c 3f29 272c 205b  values (?,?)', [
+00011e10: 382c 2062 6c6f 625f 6461 7461 5d29 0a20  8, blob_data]). 
+00011e20: 2020 2020 2020 2020 2020 2063 7572 2e74             cur.t
+00011e30: 7261 6e73 6163 7469 6f6e 2e63 6f6d 6d69  ransaction.commi
+00011e40: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+00011e50: 6375 722e 6578 6563 7574 6528 2773 656c  cur.execute('sel
+00011e60: 6563 7420 4331 2c43 3136 2066 726f 6d20  ect C1,C16 from 
+00011e70: 5432 2077 6865 7265 2043 3120 3d20 3827  T2 where C1 = 8'
+00011e80: 290a 2020 2020 2020 2020 2020 2020 726f  ).            ro
+00011e90: 7773 203d 2063 7572 2e66 6574 6368 616c  ws = cur.fetchal
+00011ea0: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
+00011eb0: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
+00011ec0: 7175 616c 2872 6f77 732c 205b 2838 2c20  qual(rows, [(8, 
+00011ed0: 626c 6f62 5f64 6174 6129 5d29 0a20 2020  blob_data)]).   
+00011ee0: 2020 2020 2020 2020 2023 2042 4c4f 4220           # BLOB 
+00011ef0: 6269 6767 6572 2074 6861 6e20 7374 7265  bigger than stre
+00011f00: 616d 5f62 6c6f 625f 7468 7265 7368 6f6c  am_blob_threshol
+00011f10: 640a 2020 2020 2020 2020 2020 2020 6269  d.            bi
+00011f20: 675f 626c 6f62 203d 2027 3132 3334 3536  g_blob = '123456
+00011f30: 3738 3927 202a 2031 3030 3030 0a20 2020  789' * 10000.   
+00011f40: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
+00011f50: 6375 7465 2827 696e 7365 7274 2069 6e74  cute('insert int
+00011f60: 6f20 5432 2028 4331 2c43 3929 2076 616c  o T2 (C1,C9) val
+00011f70: 7565 7320 283f 2c3f 2927 2c20 5b35 2c20  ues (?,?)', [5, 
+00011f80: 6269 675f 626c 6f62 5d29 0a20 2020 2020  big_blob]).     
+00011f90: 2020 2020 2020 2063 7572 2e74 7261 6e73         cur.trans
+00011fa0: 6163 7469 6f6e 2e63 6f6d 6d69 7428 290a  action.commit().
+00011fb0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+00011fc0: 6578 6563 7574 6528 2773 656c 6563 7420  execute('select 
+00011fd0: 4331 2c43 3920 6672 6f6d 2054 3220 7768  C1,C9 from T2 wh
+00011fe0: 6572 6520 4331 203d 2035 2729 0a20 2020  ere C1 = 5').   
+00011ff0: 2020 2020 2020 2020 2072 6f77 203d 2063           row = c
+00012000: 7572 2e66 6574 6368 6f6e 6528 290a 2020  ur.fetchone().  
+00012010: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00012020: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
+00012030: 726f 775b 315d 2c20 6472 6976 6572 2e63  row[1], driver.c
+00012040: 6f72 652e 426c 6f62 5265 6164 6572 290a  ore.BlobReader).
+00012050: 2020 2020 2020 2020 2020 2020 2373 656c              #sel
+00012060: 662e 6173 7365 7274 4571 7561 6c28 726f  f.assertEqual(ro
+00012070: 775b 315d 2e72 6561 6428 292c 2062 6967  w[1].read(), big
+00012080: 5f62 6c6f 6229 0a20 2020 2020 2020 2020  _blob).         
+00012090: 2020 2023 2055 6e69 636f 6465 2069 6e20     # Unicode in 
+000120a0: 424c 4f42 0a20 2020 2020 2020 2020 2020  BLOB.           
+000120b0: 2062 6c6f 625f 7465 7874 203d 2027 5468   blob_text = 'Th
+000120c0: 6973 2069 7320 6120 424c 4f42 2077 6974  is is a BLOB wit
+000120d0: 6820 6368 6172 6163 7465 7273 2062 6579  h characters bey
+000120e0: 6f6e 6420 6173 6369 693a 20c4 9bc5 a1c4  ond ascii: .....
+000120f0: 8dc5 99c5 bec3 bdc3 a1c3 adc3 a927 0a20  .............'. 
+00012100: 2020 2020 2020 2020 2020 2063 7572 322e             cur2.
+00012110: 6578 6563 7574 6528 2769 6e73 6572 7420  execute('insert 
+00012120: 696e 746f 2054 3220 2843 312c 4339 2920  into T2 (C1,C9) 
+00012130: 7661 6c75 6573 2028 3f2c 3f29 272c 205b  values (?,?)', [
+00012140: 362c 2062 6c6f 625f 7465 7874 5d29 0a20  6, blob_text]). 
+00012150: 2020 2020 2020 2020 2020 2063 7572 322e             cur2.
+00012160: 7472 616e 7361 6374 696f 6e2e 636f 6d6d  transaction.comm
+00012170: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
+00012180: 2063 7572 322e 6578 6563 7574 6528 2773   cur2.execute('s
+00012190: 656c 6563 7420 4331 2c43 3920 6672 6f6d  elect C1,C9 from
+000121a0: 2054 3220 7768 6572 6520 4331 203d 2036   T2 where C1 = 6
+000121b0: 2729 0a20 2020 2020 2020 2020 2020 2072  ').            r
+000121c0: 6f77 7320 3d20 6375 7232 2e66 6574 6368  ows = cur2.fetch
+000121d0: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
+000121e0: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
+000121f0: 7445 7175 616c 2872 6f77 732c 205b 2836  tEqual(rows, [(6
+00012200: 2c20 626c 6f62 5f74 6578 7429 5d29 0a20  , blob_text)]). 
+00012210: 2020 2020 2020 2020 2020 2023 2055 6e69             # Uni
+00012220: 636f 6465 206e 6f6e 2d74 6578 7475 616c  code non-textual
+00012230: 2042 4c4f 420a 2020 2020 2020 2020 2020   BLOB.          
+00012240: 2020 7769 7468 2073 656c 662e 6173 7365    with self.asse
+00012250: 7274 5261 6973 6573 2854 7970 6545 7272  rtRaises(TypeErr
+00012260: 6f72 2920 6173 2063 6d3a 0a20 2020 2020  or) as cm:.     
+00012270: 2020 2020 2020 2020 2020 2063 7572 322e             cur2.
+00012280: 6578 6563 7574 6528 2769 6e73 6572 7420  execute('insert 
+00012290: 696e 746f 2054 3220 2843 312c 4331 3629  into T2 (C1,C16)
+000122a0: 2076 616c 7565 7320 283f 2c3f 2927 2c20   values (?,?)', 
+000122b0: 5b37 2c20 626c 6f62 5f74 6578 745d 290a  [7, blob_text]).
+000122c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000122d0: 2e61 7373 6572 7454 7570 6c65 4571 7561  .assertTupleEqua
+000122e0: 6c28 636d 2e65 7863 6570 7469 6f6e 2e61  l(cm.exception.a
+000122f0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+00012300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012310: 2020 2020 2020 2028 2253 7472 696e 6720         ("String 
+00012320: 7661 6c75 6520 6973 206e 6f74 2061 6363  value is not acc
+00012330: 6570 7461 626c 6520 7479 7065 2066 6f72  eptable type for
+00012340: 2061 206e 6f6e 2d74 6578 7475 616c 2042   a non-textual B
+00012350: 4c4f 4220 636f 6c75 6d6e 2e22 2c29 290a  LOB column.",)).
+00012360: 2020 2020 6465 6620 7465 7374 5f69 6e73      def test_ins
+00012370: 6572 745f 666c 6f61 745f 646f 7562 6c65  ert_float_double
+00012380: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00012390: 7769 7468 2073 656c 662e 636f 6e2e 6375  with self.con.cu
+000123a0: 7273 6f72 2829 2061 7320 6375 723a 0a20  rsor() as cur:. 
+000123b0: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+000123c0: 7865 6375 7465 2827 696e 7365 7274 2069  xecute('insert i
+000123d0: 6e74 6f20 5432 2028 4331 2c43 3132 2c43  nto T2 (C1,C12,C
+000123e0: 3133 2920 7661 6c75 6573 2028 3f2c 3f2c  13) values (?,?,
+000123f0: 3f29 272c 205b 352c 2031 2e30 2c20 312e  ?)', [5, 1.0, 1.
+00012400: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
+00012410: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
+00012420: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+00012430: 722e 6578 6563 7574 6528 2773 656c 6563  r.execute('selec
+00012440: 7420 4331 2c43 3132 2c43 3133 2066 726f  t C1,C12,C13 fro
+00012450: 6d20 5432 2077 6865 7265 2043 3120 3d20  m T2 where C1 = 
+00012460: 3527 290a 2020 2020 2020 2020 2020 2020  5').            
+00012470: 726f 7773 203d 2063 7572 2e66 6574 6368  rows = cur.fetch
+00012480: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
+00012490: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
+000124a0: 7445 7175 616c 2872 6f77 732c 205b 2835  tEqual(rows, [(5
+000124b0: 2c20 312e 302c 2031 2e30 295d 290a 2020  , 1.0, 1.0)]).  
+000124c0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+000124d0: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
+000124e0: 746f 2054 3220 2843 312c 4331 322c 4331  to T2 (C1,C12,C1
+000124f0: 3329 2076 616c 7565 7320 283f 2c3f 2c3f  3) values (?,?,?
+00012500: 2927 2c20 5b36 2c20 312c 2031 5d29 0a20  )', [6, 1, 1]). 
+00012510: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012520: 636f 6e2e 636f 6d6d 6974 2829 0a20 2020  con.commit().   
+00012530: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
+00012540: 6375 7465 2827 7365 6c65 6374 2043 312c  cute('select C1,
+00012550: 4331 322c 4331 3320 6672 6f6d 2054 3220  C12,C13 from T2 
+00012560: 7768 6572 6520 4331 203d 2036 2729 0a20  where C1 = 6'). 
+00012570: 2020 2020 2020 2020 2020 2072 6f77 7320             rows 
+00012580: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
+00012590: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000125a0: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
+000125b0: 6c28 726f 7773 2c20 5b28 362c 2031 2e30  l(rows, [(6, 1.0
+000125c0: 2c20 312e 3029 5d29 0a20 2020 2064 6566  , 1.0)]).    def
+000125d0: 2074 6573 745f 696e 7365 7274 5f6e 756d   test_insert_num
+000125e0: 6572 6963 5f64 6563 696d 616c 2873 656c  eric_decimal(sel
+000125f0: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
+00012600: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
+00012610: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
+00012620: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+00012630: 7465 2827 696e 7365 7274 2069 6e74 6f20  te('insert into 
+00012640: 5432 2028 4331 2c43 3130 2c43 3131 2920  T2 (C1,C10,C11) 
+00012650: 7661 6c75 6573 2028 3f2c 3f2c 3f29 272c  values (?,?,?)',
+00012660: 205b 362c 2031 2e31 2c20 312e 315d 290a   [6, 1.1, 1.1]).
+00012670: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+00012680: 6578 6563 7574 6528 2769 6e73 6572 7420  execute('insert 
+00012690: 696e 746f 2054 3220 2843 312c 4331 302c  into T2 (C1,C10,
+000126a0: 4331 3129 2076 616c 7565 7320 283f 2c3f  C11) values (?,?
+000126b0: 2c3f 2927 2c20 5b36 2c20 6465 6369 6d61  ,?)', [6, decima
+000126c0: 6c2e 4465 6369 6d61 6c28 2731 3030 2e31  l.Decimal('100.1
+000126d0: 3127 292c 2064 6563 696d 616c 2e44 6563  1'), decimal.Dec
+000126e0: 696d 616c 2827 3130 302e 3131 2729 5d29  imal('100.11')])
+000126f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00012700: 662e 636f 6e2e 636f 6d6d 6974 2829 0a20  f.con.commit(). 
+00012710: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+00012720: 7865 6375 7465 2827 7365 6c65 6374 2043  xecute('select C
+00012730: 312c 4331 302c 4331 3120 6672 6f6d 2054  1,C10,C11 from T
+00012740: 3220 7768 6572 6520 4331 203d 2036 2729  2 where C1 = 6')
+00012750: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+00012760: 7320 3d20 6375 722e 6665 7463 6861 6c6c  s = cur.fetchall
+00012770: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00012780: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
+00012790: 7561 6c28 726f 7773 2c0a 2020 2020 2020  ual(rows,.      
+000127a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000127b0: 2020 2020 2020 2020 2020 205b 2836 2c20             [(6, 
+000127c0: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
+000127d0: 2731 2e31 2729 2c20 6465 6369 6d61 6c2e  '1.1'), decimal.
+000127e0: 4465 6369 6d61 6c28 2731 2e31 2729 292c  Decimal('1.1')),
+000127f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012810: 2020 2028 362c 2064 6563 696d 616c 2e44     (6, decimal.D
+00012820: 6563 696d 616c 2827 3130 302e 3131 2729  ecimal('100.11')
+00012830: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
+00012840: 6c28 2731 3030 2e31 3127 2929 5d29 0a20  l('100.11'))]). 
+00012850: 2020 2064 6566 2074 6573 745f 696e 7365     def test_inse
+00012860: 7274 5f72 6574 7572 6e69 6e67 2873 656c  rt_returning(sel
+00012870: 6629 3a0a 2020 2020 2020 2020 7769 7468  f):.        with
+00012880: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
+00012890: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
+000128a0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+000128b0: 7465 2827 696e 7365 7274 2069 6e74 6f20  te('insert into 
+000128c0: 5432 2028 4331 2c43 3130 2c43 3131 2920  T2 (C1,C10,C11) 
+000128d0: 7661 6c75 6573 2028 3f2c 3f2c 3f29 2072  values (?,?,?) r
+000128e0: 6574 7572 6e69 6e67 2043 3127 2c20 5b37  eturning C1', [7
+000128f0: 2c20 312e 312c 2031 2e31 5d29 0a20 2020  , 1.1, 1.1]).   
+00012900: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00012910: 3d20 6375 722e 6665 7463 6861 6c6c 2829  = cur.fetchall()
+00012920: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00012930: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
+00012940: 6c28 7265 7375 6c74 2c20 5b28 372c 295d  l(result, [(7,)]
+00012950: 290a 2020 2020 6465 6620 7465 7374 5f69  ).    def test_i
+00012960: 6e73 6572 745f 626f 6f6c 6561 6e28 7365  nsert_boolean(se
+00012970: 6c66 293a 0a20 2020 2020 2020 2077 6974  lf):.        wit
+00012980: 6820 7365 6c66 2e63 6f6e 2e63 7572 736f  h self.con.curso
+00012990: 7228 2920 6173 2063 7572 3a0a 2020 2020  r() as cur:.    
+000129a0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
+000129b0: 7574 6528 2769 6e73 6572 7420 696e 746f  ute('insert into
+000129c0: 2054 3220 2843 312c 4331 3729 2076 616c   T2 (C1,C17) val
+000129d0: 7565 7320 283f 2c3f 2920 7265 7475 726e  ues (?,?) return
+000129e0: 696e 6720 4331 272c 205b 382c 2054 7275  ing C1', [8, Tru
+000129f0: 655d 290a 2020 2020 2020 2020 2020 2020  e]).            
+00012a00: 6375 722e 7374 6174 656d 656e 742e 5f6c  cur.statement._l
+00012a10: 6f67 6769 6e67 5f69 645f 203d 2027 5374  ogging_id_ = 'St
+00012a20: 6d74 5b31 5d27 0a20 2020 2020 2020 2020  mt[1]'.         
+00012a30: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
+00012a40: 696e 7365 7274 2069 6e74 6f20 5432 2028  insert into T2 (
+00012a50: 4331 2c43 3137 2920 7661 6c75 6573 2028  C1,C17) values (
+00012a60: 3f2c 3f29 2072 6574 7572 6e69 6e67 2043  ?,?) returning C
+00012a70: 3127 2c20 5b38 2c20 4661 6c73 655d 290a  1', [8, False]).
+00012a80: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+00012a90: 6578 6563 7574 6528 2773 656c 6563 7420  execute('select 
+00012aa0: 4331 2c43 3137 2066 726f 6d20 5432 2077  C1,C17 from T2 w
+00012ab0: 6865 7265 2043 3120 3d20 3827 290a 2020  here C1 = 8').  
+00012ac0: 2020 2020 2020 2020 2020 6375 722e 7374            cur.st
+00012ad0: 6174 656d 656e 742e 5f6c 6f67 6769 6e67  atement._logging
+00012ae0: 5f69 645f 203d 2027 5374 6d74 5b32 5d27  _id_ = 'Stmt[2]'
+00012af0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00012b00: 756c 7420 3d20 6375 722e 6665 7463 6861  ult = cur.fetcha
+00012b10: 6c6c 2829 0a20 2020 2020 2020 2020 2020  ll().           
+00012b20: 2073 656c 662e 6173 7365 7274 4c69 7374   self.assertList
+00012b30: 4571 7561 6c28 7265 7375 6c74 2c20 5b28  Equal(result, [(
+00012b40: 382c 2054 7275 6529 2c20 2838 2c20 4661  8, True), (8, Fa
+00012b50: 6c73 6529 5d29 0a0a 636c 6173 7320 5465  lse)])..class Te
+00012b60: 7374 5374 6f72 6564 5072 6f63 2844 7269  stStoredProc(Dri
+00012b70: 7665 7254 6573 7442 6173 6529 3a0a 2020  verTestBase):.  
+00012b80: 2020 6465 6620 7365 7455 7028 7365 6c66    def setUp(self
+00012b90: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
+00012ba0: 2829 2e73 6574 5570 2829 0a20 2020 2020  ().setUp().     
+00012bb0: 2020 2073 656c 662e 6462 6669 6c65 203d     self.dbfile =
+00012bc0: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
+00012bd0: 6c66 2e64 6270 6174 682c 2073 656c 662e  lf.dbpath, self.
+00012be0: 4642 5445 5354 5f44 4229 0a20 2020 2020  FBTEST_DB).     
+00012bf0: 2020 2073 656c 662e 636f 6e20 3d20 636f     self.con = co
+00012c00: 6e6e 6563 7428 7365 6c66 2e64 6266 696c  nnect(self.dbfil
+00012c10: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
+00012c20: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+00012c30: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
+00012c40: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+00012c50: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
+00012c60: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+00012c70: 6e61 6d65 5f5f 0a20 2020 2020 2020 2073  name__.        s
+00012c80: 656c 662e 636f 6e2e 6578 6563 7574 655f  elf.con.execute_
+00012c90: 696d 6d65 6469 6174 6528 2264 656c 6574  immediate("delet
+00012ca0: 6520 6672 6f6d 2074 2229 0a20 2020 2020  e from t").     
+00012cb0: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
+00012cc0: 6974 2829 0a20 2020 2064 6566 2074 6561  it().    def tea
+00012cd0: 7244 6f77 6e28 7365 6c66 293a 0a20 2020  rDown(self):.   
+00012ce0: 2020 2020 2073 656c 662e 636f 6e2e 636c       self.con.cl
+00012cf0: 6f73 6528 290a 2020 2020 6465 6620 7465  ose().    def te
+00012d00: 7374 5f63 616c 6c70 726f 6328 7365 6c66  st_callproc(self
+00012d10: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
+00012d20: 7365 6c66 2e63 6f6e 2e63 7572 736f 7228  self.con.cursor(
+00012d30: 2920 6173 2063 7572 3a0a 2020 2020 2020  ) as cur:.      
+00012d40: 2020 2020 2020 6375 722e 6361 6c6c 7072        cur.callpr
+00012d50: 6f63 2827 7375 625f 746f 745f 6275 6467  oc('sub_tot_budg
+00012d60: 6574 272c 205b 2731 3030 275d 290a 2020  et', ['100']).  
+00012d70: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00012d80: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
+00012d90: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00012da0: 6c66 2e61 7373 6572 7454 7570 6c65 4571  lf.assertTupleEq
+00012db0: 7561 6c28 7265 7375 6c74 2c20 2864 6563  ual(result, (dec
+00012dc0: 696d 616c 2e44 6563 696d 616c 2827 3338  imal.Decimal('38
+00012dd0: 3030 3030 3027 292c 2064 6563 696d 616c  00000'), decimal
+00012de0: 2e44 6563 696d 616c 2827 3736 3030 3030  .Decimal('760000
+00012df0: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+00012e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012e10: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00012e20: 6563 696d 616c 2e44 6563 696d 616c 2827  ecimal.Decimal('
+00012e30: 3530 3030 3030 2729 2c20 6465 6369 6d61  500000'), decima
+00012e40: 6c2e 4465 6369 6d61 6c28 2731 3530 3030  l.Decimal('15000
+00012e50: 3030 2729 2929 0a20 2020 2020 2020 2020  00'))).         
+00012e60: 2020 2023 0a20 2020 2020 2020 2020 2020     #.           
+00012e70: 2063 7572 2e63 616c 6c70 726f 6328 2773   cur.callproc('s
+00012e80: 7562 5f74 6f74 5f62 7564 6765 7427 2c20  ub_tot_budget', 
+00012e90: 5b31 3030 5d29 0a20 2020 2020 2020 2020  [100]).         
+00012ea0: 2020 2072 6573 756c 7420 3d20 6375 722e     result = cur.
+00012eb0: 6665 7463 686f 6e65 2829 0a20 2020 2020  fetchone().     
+00012ec0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00012ed0: 7274 5475 706c 6545 7175 616c 2872 6573  rtTupleEqual(res
+00012ee0: 756c 742c 2028 6465 6369 6d61 6c2e 4465  ult, (decimal.De
+00012ef0: 6369 6d61 6c28 2733 3830 3030 3030 2729  cimal('3800000')
+00012f00: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
+00012f10: 6c28 2737 3630 3030 3027 292c 0a20 2020  l('760000'),.   
+00012f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f40: 2020 2020 2020 2020 6465 6369 6d61 6c2e          decimal.
+00012f50: 4465 6369 6d61 6c28 2735 3030 3030 3027  Decimal('500000'
+00012f60: 292c 2064 6563 696d 616c 2e44 6563 696d  ), decimal.Decim
+00012f70: 616c 2827 3135 3030 3030 3027 2929 290a  al('1500000'))).
+00012f80: 2020 2020 2020 2020 2020 2020 230a 2020              #.  
+00012f90: 2020 2020 2020 2020 2020 6375 722e 6361            cur.ca
+00012fa0: 6c6c 7072 6f63 2827 7072 6f63 5f74 6573  llproc('proc_tes
+00012fb0: 7427 2c20 5b31 305d 290a 2020 2020 2020  t', [10]).      
+00012fc0: 2020 2020 2020 7265 7375 6c74 203d 2063        result = c
+00012fd0: 7572 2e66 6574 6368 6f6e 6528 290a 2020  ur.fetchone().  
+00012fe0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00012ff0: 7373 6572 7449 734e 6f6e 6528 7265 7375  ssertIsNone(resu
+00013000: 6c74 290a 2020 2020 2020 2020 2020 2020  lt).            
+00013010: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
+00013020: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+00013030: 722e 6578 6563 7574 6528 2773 656c 6563  r.execute('selec
+00013040: 7420 6331 2066 726f 6d20 7427 290a 2020  t c1 from t').  
+00013050: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00013060: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
+00013070: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00013080: 6c66 2e61 7373 6572 7454 7570 6c65 4571  lf.assertTupleEq
+00013090: 7561 6c28 7265 7375 6c74 2c20 7475 706c  ual(result, tupl
+000130a0: 6528 5b31 305d 2929 0a0a 636c 6173 7320  e([10]))..class 
+000130b0: 5465 7374 5365 7276 6572 5374 616e 6461  TestServerStanda
+000130c0: 7264 2844 7269 7665 7254 6573 7442 6173  rd(DriverTestBas
+000130d0: 6529 3a0a 2020 2020 6465 6620 7365 7455  e):.    def setU
+000130e0: 7028 7365 6c66 293a 0a20 2020 2020 2020  p(self):.       
+000130f0: 2073 7570 6572 2829 2e73 6574 5570 2829   super().setUp()
+00013100: 0a20 2020 2020 2020 2073 656c 662e 6462  .        self.db
+00013110: 6669 6c65 203d 206f 732e 7061 7468 2e6a  file = os.path.j
+00013120: 6f69 6e28 7365 6c66 2e64 6270 6174 682c  oin(self.dbpath,
+00013130: 2073 656c 662e 4642 5445 5354 5f44 4229   self.FBTEST_DB)
+00013140: 0a20 2020 2064 6566 2074 6573 745f 6174  .    def test_at
+00013150: 7461 6368 2873 656c 6629 3a0a 2020 2020  tach(self):.    
+00013160: 2020 2020 7376 6320 3d20 636f 6e6e 6563      svc = connec
+00013170: 745f 7365 7276 6572 2846 4254 4553 545f  t_server(FBTEST_
+00013180: 484f 5354 2c20 7573 6572 3d27 5359 5344  HOST, user='SYSD
+00013190: 4241 272c 2070 6173 7377 6f72 643d 4642  BA', password=FB
+000131a0: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
+000131b0: 2020 2020 2020 2073 7663 2e63 6c6f 7365         svc.close
+000131c0: 2829 0a20 2020 2064 6566 2074 6573 745f  ().    def test_
+000131d0: 7175 6572 7928 7365 6c66 293a 0a20 2020  query(self):.   
+000131e0: 2020 2020 2077 6974 6820 636f 6e6e 6563       with connec
+000131f0: 745f 7365 7276 6572 2846 4254 4553 545f  t_server(FBTEST_
+00013200: 484f 5354 2c20 7573 6572 3d27 5359 5344  HOST, user='SYSD
+00013210: 4241 272c 2070 6173 7377 6f72 643d 4642  BA', password=FB
+00013220: 5445 5354 5f50 4153 5357 4f52 4429 2061  TEST_PASSWORD) a
+00013230: 7320 7376 633a 0a20 2020 2020 2020 2020  s svc:.         
+00013240: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00013250: 7561 6c28 7376 632e 696e 666f 2e6d 616e  ual(svc.info.man
+00013260: 6167 6572 5f76 6572 7369 6f6e 2c20 3229  ager_version, 2)
+00013270: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00013280: 662e 6173 7365 7274 5472 7565 2873 7663  f.assertTrue(svc
+00013290: 2e69 6e66 6f2e 7665 7273 696f 6e2e 7374  .info.version.st
+000132a0: 6172 7473 7769 7468 2873 656c 662e 7665  artswith(self.ve
+000132b0: 7273 696f 6e29 290a 2020 2020 2020 2020  rsion)).        
+000132c0: 2020 2020 7365 6c66 2e61 7373 6572 7447      self.assertG
+000132d0: 7265 6174 6572 4571 7561 6c28 666c 6f61  reaterEqual(floa
+000132e0: 7428 7365 6c66 2e76 6572 7369 6f6e 292c  t(self.version),
+000132f0: 2073 7663 2e69 6e66 6f2e 656e 6769 6e65   svc.info.engine
+00013300: 5f76 6572 7369 6f6e 290a 2020 2020 2020  _version).      
+00013310: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00013320: 7449 6e28 2746 6972 6562 6972 6427 2c20  tIn('Firebird', 
+00013330: 7376 632e 696e 666f 2e61 7263 6869 7465  svc.info.archite
+00013340: 6374 7572 6529 0a20 2020 2020 2020 2020  cture).         
+00013350: 2020 2078 203d 2073 7663 2e69 6e66 6f2e     x = svc.info.
+00013360: 686f 6d65 5f64 6972 6563 746f 7279 0a20  home_directory. 
+00013370: 2020 2020 2020 2020 2020 2023 204f 6e20             # On 
+00013380: 5769 6e64 6f77 7320 6974 2072 6574 7572  Windows it retur
+00013390: 6e73 2027 7365 6375 7269 7479 2e64 6227  ns 'security.db'
+000133a0: 2c20 6120 6275 673f 0a20 2020 2020 2020  , a bug?.       
+000133b0: 2020 2020 2023 7365 6c66 2e61 7373 6572       #self.asser
+000133c0: 7449 6e28 2773 6563 7572 6974 792e 6462  tIn('security.db
+000133d0: 272c 2073 7663 2e69 6e66 6f2e 7365 6375  ', svc.info.secu
+000133e0: 7269 7479 5f64 6174 6162 6173 6529 0a20  rity_database). 
+000133f0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00013400: 6c66 2e76 6572 7369 6f6e 203d 3d20 4642  lf.version == FB
+00013410: 3430 3a0a 2020 2020 2020 2020 2020 2020  40:.            
+00013420: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+00013430: 6e28 2773 6563 7572 6974 7934 2e66 6462  n('security4.fdb
+00013440: 272e 7570 7065 7228 292c 2073 7663 2e69  '.upper(), svc.i
+00013450: 6e66 6f2e 7365 6375 7269 7479 5f64 6174  nfo.security_dat
+00013460: 6162 6173 652e 7570 7065 7228 2929 0a20  abase.upper()). 
+00013470: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00013480: 7365 6c66 2e76 6572 7369 6f6e 203d 3d20  self.version == 
+00013490: 4642 3530 3a0a 2020 2020 2020 2020 2020  FB50:.          
+000134a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000134b0: 7449 6e28 2773 6563 7572 6974 7935 2e66  tIn('security5.f
+000134c0: 6462 272e 7570 7065 7228 292c 2073 7663  db'.upper(), svc
+000134d0: 2e69 6e66 6f2e 7365 6375 7269 7479 5f64  .info.security_d
+000134e0: 6174 6162 6173 652e 7570 7065 7228 2929  atabase.upper())
+000134f0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00013500: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00013510: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
+00013520: 2827 7365 6375 7269 7479 332e 6664 6227  ('security3.fdb'
+00013530: 2c20 7376 632e 696e 666f 2e73 6563 7572  , svc.info.secur
+00013540: 6974 795f 6461 7461 6261 7365 290a 2020  ity_database).  
+00013550: 2020 2020 2020 2020 2020 7820 3d20 7376            x = sv
+00013560: 632e 696e 666f 2e6c 6f63 6b5f 6469 7265  c.info.lock_dire
+00013570: 6374 6f72 790a 2020 2020 2020 2020 2020  ctory.          
+00013580: 2020 7820 3d20 7376 632e 696e 666f 2e63    x = svc.info.c
+00013590: 6170 6162 696c 6974 6965 730a 2020 2020  apabilities.    
+000135a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000135b0: 6572 7449 6e28 5365 7276 6572 4361 7061  ertIn(ServerCapa
+000135c0: 6269 6c69 7479 2e52 454d 4f54 455f 484f  bility.REMOTE_HO
+000135d0: 502c 2078 290a 2020 2020 2020 2020 2020  P, x).          
+000135e0: 2020 7365 6c66 2e61 7373 6572 744e 6f74    self.assertNot
+000135f0: 496e 2853 6572 7665 7243 6170 6162 696c  In(ServerCapabil
+00013600: 6974 792e 4e4f 5f46 4f52 4345 445f 5752  ity.NO_FORCED_WR
+00013610: 4954 452c 2078 290a 2020 2020 2020 2020  ITE, x).        
+00013620: 2020 2020 7820 3d20 7376 632e 696e 666f      x = svc.info
+00013630: 2e6d 6573 7361 6765 5f64 6972 6563 746f  .message_directo
+00013640: 7279 0a20 2020 2020 2020 2020 2020 2077  ry.            w
+00013650: 6974 6820 636f 6e6e 6563 7428 6622 7b46  ith connect(f"{F
+00013660: 4254 4553 545f 484f 5354 7d3a 7b73 656c  BTEST_HOST}:{sel
+00013670: 662e 6462 6669 6c65 7d22 2c20 7573 6572  f.dbfile}", user
+00013680: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
+00013690: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+000136a0: 5353 574f 5244 2920 6173 2063 6f6e 313a  SSWORD) as con1:
+000136b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000136c0: 2063 6f6e 312e 5f6c 6f67 6769 6e67 5f69   con1._logging_i
+000136d0: 645f 203d 2073 656c 662e 5f5f 636c 6173  d_ = self.__clas
+000136e0: 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020  s__.__name__.   
+000136f0: 2020 2020 2020 2020 2020 2020 2077 6974               wit
+00013700: 6820 636f 6e6e 6563 7428 6627 7b46 4254  h connect(f'{FBT
+00013710: 4553 545f 484f 5354 7d3a 656d 706c 6f79  EST_HOST}:employ
+00013720: 6565 272c 2075 7365 723d 4642 5445 5354  ee', user=FBTEST
+00013730: 5f55 5345 522c 2070 6173 7377 6f72 643d  _USER, password=
+00013740: 4642 5445 5354 5f50 4153 5357 4f52 4429  FBTEST_PASSWORD)
+00013750: 2061 7320 636f 6e32 3a0a 2020 2020 2020   as con2:.      
+00013760: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00013770: 6e32 2e5f 6c6f 6767 696e 675f 6964 5f20  n2._logging_id_ 
+00013780: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
+00013790: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
+000137a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000137b0: 6c66 2e61 7373 6572 7447 7265 6174 6572  lf.assertGreater
+000137c0: 4571 7561 6c28 6c65 6e28 7376 632e 696e  Equal(len(svc.in
+000137d0: 666f 2e61 7474 6163 6865 645f 6461 7461  fo.attached_data
+000137e0: 6261 7365 7329 2c20 322c 0a20 2020 2020  bases), 2,.     
+000137f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013810: 2020 2020 2020 2022 5368 6f75 6c64 2077         "Should w
+00013820: 6f72 6b20 666f 7220 5375 7065 7273 6572  ork for Superser
+00013830: 7665 722c 206d 6179 2066 6169 6c20 7769  ver, may fail wi
+00013840: 7468 2076 616c 7565 2030 2066 6f72 2043  th value 0 for C
+00013850: 6c61 7373 6963 2229 0a20 2020 2020 2020  lassic").       
+00013860: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00013870: 662e 6173 7365 7274 496e 2873 656c 662e  f.assertIn(self.
+00013880: 6462 6669 6c65 2e75 7070 6572 2829 2c0a  dbfile.upper(),.
+00013890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138b0: 2020 5b73 2e75 7070 6572 2829 2066 6f72    [s.upper() for
+000138c0: 2073 2069 6e20 7376 632e 696e 666f 2e61   s in svc.info.a
+000138d0: 7474 6163 6865 645f 6461 7461 6261 7365  ttached_database
+000138e0: 735d 290a 2020 2020 2020 2020 2020 2020  s]).            
+000138f0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00013900: 6572 7447 7265 6174 6572 4571 7561 6c28  ertGreaterEqual(
+00013910: 7376 632e 696e 666f 2e63 6f6e 6e65 6374  svc.info.connect
+00013920: 696f 6e5f 636f 756e 742c 2032 290a 2020  ion_count, 2).  
+00013930: 2020 2020 2020 2020 2020 2320 4241 4420            # BAD 
+00013940: 7265 7175 6573 7420 636f 6465 0a20 2020  request code.   
+00013950: 2020 2020 2020 2020 2077 6974 6820 7365           with se
+00013960: 6c66 2e61 7373 6572 7452 6169 7365 7328  lf.assertRaises(
+00013970: 4572 726f 7229 2061 7320 636d 3a0a 2020  Error) as cm:.  
+00013980: 2020 2020 2020 2020 2020 2020 2020 7376                sv
+00013990: 632e 696e 666f 2e67 6574 5f69 6e66 6f28  c.info.get_info(
+000139a0: 3235 3529 0a20 2020 2020 2020 2020 2020  255).           
+000139b0: 2073 656c 662e 6173 7365 7274 5475 706c   self.assertTupl
+000139c0: 6545 7175 616c 2863 6d2e 6578 6365 7074  eEqual(cm.except
+000139d0: 696f 6e2e 6172 6773 2c0a 2020 2020 2020  ion.args,.      
+000139e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139f0: 2020 2020 2020 2020 2020 2020 2822 6665              ("fe
+00013a00: 6174 7572 6520 6973 206e 6f74 2073 7570  ature is not sup
+00013a10: 706f 7274 6564 222c 2929 0a0a 2020 2020  ported",))..    
+00013a20: 6465 6620 7465 7374 5f72 756e 6e69 6e67  def test_running
+00013a30: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00013a40: 7769 7468 2063 6f6e 6e65 6374 5f73 6572  with connect_ser
+00013a50: 7665 7228 4642 5445 5354 5f48 4f53 542c  ver(FBTEST_HOST,
+00013a60: 2075 7365 723d 2753 5953 4442 4127 2c20   user='SYSDBA', 
+00013a70: 7061 7373 776f 7264 3d46 4254 4553 545f  password=FBTEST_
+00013a80: 5041 5353 574f 5244 2920 6173 2073 7663  PASSWORD) as svc
+00013a90: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00013aa0: 6c66 2e61 7373 6572 7446 616c 7365 2873  lf.assertFalse(s
+00013ab0: 7663 2e69 735f 7275 6e6e 696e 6728 2929  vc.is_running())
+00013ac0: 0a20 2020 2020 2020 2020 2020 2073 7663  .            svc
+00013ad0: 2e69 6e66 6f2e 6765 745f 6c6f 6728 290a  .info.get_log().
+00013ae0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00013af0: 2e61 7373 6572 7454 7275 6528 7376 632e  .assertTrue(svc.
+00013b00: 6973 5f72 756e 6e69 6e67 2829 290a 2020  is_running()).  
+00013b10: 2020 2020 2020 2020 2020 2320 6665 7463            # fetc
+00013b20: 6820 6d61 7465 7269 616c 697a 6564 0a20  h materialized. 
+00013b30: 2020 2020 2020 2020 2020 2073 7663 2e72             svc.r
 00013b40: 6561 646c 696e 6573 2829 0a20 2020 2020  eadlines().     
-00013b50: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-00013b60: 7565 286c 6f67 290a 2020 2020 2020 2020  ue(log).        
-00013b70: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
-00013b80: 7461 6e63 6528 6c6f 672c 2074 7970 6528  tance(log, type(
-00013b90: 6c69 7374 2829 2929 0a20 2020 2020 2020  list())).       
-00013ba0: 2023 2069 7465 7261 7465 206f 7665 7220   # iterate over 
-00013bb0: 7265 7375 6c74 0a20 2020 2020 2020 2073  result.        s
-00013bc0: 656c 662e 7376 632e 696e 666f 2e67 6574  elf.svc.info.get
-00013bd0: 5f6c 6f67 2829 0a20 2020 2020 2020 2066  _log().        f
-00013be0: 6f72 206c 696e 6520 696e 2073 656c 662e  or line in self.
-00013bf0: 7376 633a 0a20 2020 2020 2020 2020 2020  svc:.           
-00013c00: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
-00013c10: 744e 6f6e 6528 6c69 6e65 290a 2020 2020  tNone(line).    
-00013c20: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00013c30: 6572 7449 7349 6e73 7461 6e63 6528 6c69  ertIsInstance(li
-00013c40: 6e65 2c20 7374 7229 0a20 2020 2020 2020  ne, str).       
-00013c50: 2023 2063 616c 6c62 6163 6b0a 2020 2020   # callback.    
-00013c60: 2020 2020 6f75 7470 7574 203d 205b 5d0a      output = [].
-00013c70: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
-00013c80: 2e69 6e66 6f2e 6765 745f 6c6f 6728 6361  .info.get_log(ca
-00013c90: 6c6c 6261 636b 3d66 6574 6368 6c69 6e65  llback=fetchline
-00013ca0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00013cb0: 7373 6572 7447 7265 6174 6572 286c 656e  ssertGreater(len
-00013cc0: 286f 7574 7075 7429 2c20 3029 0a20 2020  (output), 0).   
-00013cd0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00013ce0: 4571 7561 6c28 6f75 7470 7574 2c20 6c6f  Equal(output, lo
-00013cf0: 6729 0a20 2020 2064 6566 2074 6573 745f  g).    def test_
-00013d00: 3034 5f67 6574 5f6c 696d 626f 5f74 7261  04_get_limbo_tra
-00013d10: 6e73 6163 7469 6f6e 5f69 6473 2873 656c  nsaction_ids(sel
-00013d20: 6629 3a0a 2020 2020 2020 2020 7365 6c66  f):.        self
-00013d30: 2e73 6b69 7054 6573 7428 274e 6f74 2069  .skipTest('Not i
-00013d40: 6d70 6c65 6d65 6e74 6564 2079 6574 2729  mplemented yet')
-00013d50: 0a20 2020 2020 2020 2069 6473 203d 2073  .        ids = s
-00013d60: 656c 662e 7376 632e 6461 7461 6261 7365  elf.svc.database
-00013d70: 2e67 6574 5f6c 696d 626f 5f74 7261 6e73  .get_limbo_trans
-00013d80: 6163 7469 6f6e 5f69 6473 2864 6174 6162  action_ids(datab
-00013d90: 6173 653d 2765 6d70 6c6f 7965 6527 290a  ase='employee').
-00013da0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00013db0: 6572 7449 7349 6e73 7461 6e63 6528 6964  ertIsInstance(id
-00013dc0: 732c 2074 7970 6528 6c69 7374 2829 2929  s, type(list()))
-00013dd0: 0a20 2020 2064 6566 2074 6573 745f 3035  .    def test_05
-00013de0: 5f74 7261 6365 2873 656c 6629 3a0a 2020  _trace(self):.  
-00013df0: 2020 2020 2020 2373 656c 662e 736b 6970        #self.skip
-00013e00: 5465 7374 2827 4e6f 7420 696d 706c 656d  Test('Not implem
-00013e10: 656e 7465 6420 7965 7427 290a 2020 2020  ented yet').    
-00013e20: 2020 2020 7472 6163 655f 636f 6e66 6967      trace_config
-00013e30: 203d 2022 2222 6461 7461 6261 7365 203d   = """database =
-00013e40: 2025 730a 2020 2020 2020 2020 7b0a 2020   %s.        {.  
-00013e50: 2020 2020 2020 2020 656e 6162 6c65 6420          enabled 
-00013e60: 3d20 7472 7565 0a20 2020 2020 2020 2020  = true.         
-00013e70: 206c 6f67 5f73 7461 7465 6d65 6e74 5f66   log_statement_f
-00013e80: 696e 6973 6820 3d20 7472 7565 0a20 2020  inish = true.   
-00013e90: 2020 2020 2020 2070 7269 6e74 5f70 6c61         print_pla
-00013ea0: 6e20 3d20 7472 7565 0a20 2020 2020 2020  n = true.       
-00013eb0: 2020 2069 6e63 6c75 6465 5f66 696c 7465     include_filte
-00013ec0: 7220 3d20 2525 5345 4c45 4354 2525 0a20  r = %%SELECT%%. 
-00013ed0: 2020 2020 2020 2020 2065 7863 6c75 6465           exclude
-00013ee0: 5f66 696c 7465 7220 3d20 2525 5244 4224  _filter = %%RDB$
-00013ef0: 2525 0a20 2020 2020 2020 2020 2074 696d  %%.          tim
-00013f00: 655f 7468 7265 7368 6f6c 6420 3d20 300a  e_threshold = 0.
-00013f10: 2020 2020 2020 2020 2020 6d61 785f 7371            max_sq
-00013f20: 6c5f 6c65 6e67 7468 203d 2032 3034 380a  l_length = 2048.
-00013f30: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00013f40: 2020 2222 2220 2520 7365 6c66 2e64 6266    """ % self.dbf
-00013f50: 696c 650a 2020 2020 2020 2020 7769 7468  ile.        with
-00013f60: 2063 6f6e 6e65 6374 5f73 6572 7665 7228   connect_server(
-00013f70: 4642 5445 5354 5f48 4f53 542c 2075 7365  FBTEST_HOST, use
-00013f80: 723d 2753 5953 4442 4127 2c20 7061 7373  r='SYSDBA', pass
-00013f90: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
-00013fa0: 574f 5244 2920 6173 2073 7663 322c 205c  WORD) as svc2, \
-00013fb0: 0a20 2020 2020 2020 2020 2020 2020 636f  .             co
-00013fc0: 6e6e 6563 745f 7365 7276 6572 2846 4254  nnect_server(FBT
-00013fd0: 4553 545f 484f 5354 2c20 7573 6572 3d27  EST_HOST, user='
-00013fe0: 5359 5344 4241 272c 2070 6173 7377 6f72  SYSDBA', passwor
-00013ff0: 643d 4642 5445 5354 5f50 4153 5357 4f52  d=FBTEST_PASSWOR
-00014000: 4429 2061 7320 7376 6378 3a0a 2020 2020  D) as svcx:.    
-00014010: 2020 2020 2020 2020 2320 5374 6172 7420          # Start 
-00014020: 7472 6163 6520 7365 7373 696f 6e73 0a20  trace sessions. 
-00014030: 2020 2020 2020 2020 2020 2074 7261 6365             trace
-00014040: 315f 6964 203d 2073 656c 662e 7376 632e  1_id = self.svc.
-00014050: 7472 6163 652e 7374 6172 7428 636f 6e66  trace.start(conf
-00014060: 6967 3d74 7261 6365 5f63 6f6e 6669 672c  ig=trace_config,
-00014070: 206e 616d 653d 2774 6573 745f 7472 6163   name='test_trac
-00014080: 655f 3127 290a 2020 2020 2020 2020 2020  e_1').          
-00014090: 2020 7472 6163 6532 5f69 6420 3d20 7376    trace2_id = sv
-000140a0: 6332 2e74 7261 6365 2e73 7461 7274 2863  c2.trace.start(c
-000140b0: 6f6e 6669 673d 7472 6163 655f 636f 6e66  onfig=trace_conf
-000140c0: 6967 290a 2020 2020 2020 2020 2020 2020  ig).            
-000140d0: 2320 6368 6563 6b20 7365 7373 696f 6e73  # check sessions
-000140e0: 0a20 2020 2020 2020 2020 2020 2073 6573  .            ses
-000140f0: 7369 6f6e 7320 3d20 7376 6378 2e74 7261  sions = svcx.tra
-00014100: 6365 2e73 6573 7369 6f6e 730a 2020 2020  ce.sessions.    
-00014110: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00014120: 6572 7449 6e28 7472 6163 6531 5f69 642c  ertIn(trace1_id,
-00014130: 2073 6573 7369 6f6e 7329 0a20 2020 2020   sessions).     
-00014140: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00014150: 7274 4571 7561 6c28 7365 7373 696f 6e73  rtEqual(sessions
-00014160: 5b74 7261 6365 315f 6964 5d2e 6e61 6d65  [trace1_id].name
-00014170: 2c20 2774 6573 745f 7472 6163 655f 3127  , 'test_trace_1'
-00014180: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00014190: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-000141a0: 6573 7369 6f6e 735b 7472 6163 6532 5f69  essions[trace2_i
-000141b0: 645d 2e6e 616d 652c 2027 2729 0a20 2020  d].name, '').   
-000141c0: 2020 2020 2020 2020 2023 2057 696e 646f           # Windo
-000141d0: 7773 2072 6574 7572 6e73 2053 5953 4442  ws returns SYSDB
-000141e0: 410a 2020 2020 2020 2020 2020 2020 2369  A.            #i
-000141f0: 6620 7379 732e 706c 6174 666f 726d 203d  f sys.platform =
-00014200: 3d20 2777 696e 3332 273a 0a20 2020 2020  = 'win32':.     
-00014210: 2020 2020 2020 2020 2020 2023 7365 6c66             #self
-00014220: 2e61 7373 6572 7445 7175 616c 2873 6573  .assertEqual(ses
-00014230: 7369 6f6e 735b 7472 6163 6531 5f69 645d  sions[trace1_id]
-00014240: 2e75 7365 722c 2027 5359 5344 4241 2729  .user, 'SYSDBA')
-00014250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014260: 2023 7365 6c66 2e61 7373 6572 7445 7175   #self.assertEqu
-00014270: 616c 2873 6573 7369 6f6e 735b 7472 6163  al(sessions[trac
-00014280: 6532 5f69 645d 2e75 7365 722c 2027 5359  e2_id].user, 'SY
-00014290: 5344 4241 2729 0a20 2020 2020 2020 2020  SDBA').         
-000142a0: 2020 2023 656c 7365 3a0a 2020 2020 2020     #else:.      
-000142b0: 2020 2020 2020 2020 2020 2373 656c 662e            #self.
-000142c0: 6173 7365 7274 4571 7561 6c28 7365 7373  assertEqual(sess
-000142d0: 696f 6e73 5b74 7261 6365 315f 6964 5d2e  ions[trace1_id].
-000142e0: 7573 6572 2c20 2727 290a 2020 2020 2020  user, '').      
-000142f0: 2020 2020 2020 2020 2020 2373 656c 662e            #self.
-00014300: 6173 7365 7274 4571 7561 6c28 7365 7373  assertEqual(sess
-00014310: 696f 6e73 5b74 7261 6365 325f 6964 5d2e  ions[trace2_id].
-00014320: 7573 6572 2c20 2727 290a 2020 2020 2020  user, '').      
-00014330: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00014340: 7445 7175 616c 2873 6573 7369 6f6e 735b  tEqual(sessions[
-00014350: 7472 6163 6531 5f69 645d 2e75 7365 722c  trace1_id].user,
-00014360: 2027 5359 5344 4241 2729 0a20 2020 2020   'SYSDBA').     
-00014370: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00014380: 7274 4571 7561 6c28 7365 7373 696f 6e73  rtEqual(sessions
-00014390: 5b74 7261 6365 325f 6964 5d2e 7573 6572  [trace2_id].user
-000143a0: 2c20 2753 5953 4442 4127 290a 2020 2020  , 'SYSDBA').    
-000143b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000143c0: 6572 7449 6e28 7472 6163 6532 5f69 642c  ertIn(trace2_id,
-000143d0: 2073 6573 7369 6f6e 7329 0a20 2020 2020   sessions).     
-000143e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000143f0: 7274 4c69 7374 4571 7561 6c28 7365 7373  rtListEqual(sess
-00014400: 696f 6e73 5b74 7261 6365 315f 6964 5d2e  ions[trace1_id].
-00014410: 666c 6167 732c 205b 2761 6374 6976 6527  flags, ['active'
-00014420: 2c20 2720 7472 6163 6527 5d29 0a20 2020  , ' trace']).   
-00014430: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00014440: 7365 7274 4c69 7374 4571 7561 6c28 7365  sertListEqual(se
-00014450: 7373 696f 6e73 5b74 7261 6365 325f 6964  ssions[trace2_id
-00014460: 5d2e 666c 6167 732c 205b 2761 6374 6976  ].flags, ['activ
-00014470: 6527 2c20 2720 7472 6163 6527 5d29 0a20  e', ' trace']). 
-00014480: 2020 2020 2020 2020 2020 2023 2050 6175             # Pau
-00014490: 7365 2073 6573 7369 6f6e 0a20 2020 2020  se session.     
-000144a0: 2020 2020 2020 2073 7663 782e 7472 6163         svcx.trac
-000144b0: 652e 7375 7370 656e 6428 7365 7373 696f  e.suspend(sessio
-000144c0: 6e5f 6964 3d74 7261 6365 325f 6964 290a  n_id=trace2_id).
-000144d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000144e0: 2e61 7373 6572 7449 6e28 2773 7573 7065  .assertIn('suspe
-000144f0: 6e64 272c 2073 7663 782e 7472 6163 652e  nd', svcx.trace.
-00014500: 7365 7373 696f 6e73 5b74 7261 6365 325f  sessions[trace2_
-00014510: 6964 5d2e 666c 6167 7329 0a20 2020 2020  id].flags).     
-00014520: 2020 2020 2020 2023 2052 6573 756d 6520         # Resume 
-00014530: 7365 7373 696f 6e0a 2020 2020 2020 2020  session.        
-00014540: 2020 2020 7376 6378 2e74 7261 6365 2e72      svcx.trace.r
-00014550: 6573 756d 6528 7365 7373 696f 6e5f 6964  esume(session_id
-00014560: 3d74 7261 6365 325f 6964 290a 2020 2020  =trace2_id).    
-00014570: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00014580: 6572 7449 6e28 2761 6374 6976 6527 2c20  ertIn('active', 
-00014590: 7376 6378 2e74 7261 6365 2e73 6573 7369  svcx.trace.sessi
-000145a0: 6f6e 735b 7472 6163 6532 5f69 645d 2e66  ons[trace2_id].f
-000145b0: 6c61 6773 290a 2020 2020 2020 2020 2020  lags).          
-000145c0: 2020 2320 5374 6f70 2073 6573 7369 6f6e    # Stop session
-000145d0: 0a20 2020 2020 2020 2020 2020 2073 7663  .            svc
-000145e0: 782e 7472 6163 652e 7374 6f70 2873 6573  x.trace.stop(ses
-000145f0: 7369 6f6e 5f69 643d 7472 6163 6532 5f69  sion_id=trace2_i
-00014600: 6429 0a20 2020 2020 2020 2020 2020 2073  d).            s
-00014610: 656c 662e 6173 7365 7274 4e6f 7449 6e28  elf.assertNotIn(
-00014620: 7472 6163 6532 5f69 642c 2073 7663 782e  trace2_id, svcx.
-00014630: 7472 6163 652e 7365 7373 696f 6e73 290a  trace.sessions).
-00014640: 2020 2020 2020 2020 2020 2020 2320 4669              # Fi
-00014650: 6e61 6c69 7a65 0a20 2020 2020 2020 2020  nalize.         
-00014660: 2020 2073 7663 782e 7472 6163 652e 7374     svcx.trace.st
-00014670: 6f70 2873 6573 7369 6f6e 5f69 643d 7472  op(session_id=tr
-00014680: 6163 6531 5f69 6429 0a20 2020 2064 6566  ace1_id).    def
-00014690: 2074 6573 745f 3036 5f67 6574 5f75 7365   test_06_get_use
-000146a0: 7273 2873 656c 6629 3a0a 2020 2020 2020  rs(self):.      
-000146b0: 2020 7573 6572 7320 3d20 7365 6c66 2e73    users = self.s
-000146c0: 7663 2e75 7365 722e 6765 745f 616c 6c28  vc.user.get_all(
-000146d0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000146e0: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-000146f0: 7573 6572 732c 2074 7970 6528 6c69 7374  users, type(list
-00014700: 2829 2929 0a20 2020 2020 2020 2073 656c  ())).        sel
-00014710: 662e 6173 7365 7274 4973 496e 7374 616e  f.assertIsInstan
-00014720: 6365 2875 7365 7273 5b30 5d2c 2064 7269  ce(users[0], dri
-00014730: 7665 722e 636f 7265 2e55 7365 7249 6e66  ver.core.UserInf
-00014740: 6f29 0a20 2020 2020 2020 2073 656c 662e  o).        self.
-00014750: 6173 7365 7274 4571 7561 6c28 7573 6572  assertEqual(user
-00014760: 735b 305d 2e75 7365 725f 6e61 6d65 2c20  s[0].user_name, 
-00014770: 2753 5953 4442 4127 290a 2020 2020 6465  'SYSDBA').    de
-00014780: 6620 7465 7374 5f30 375f 6d61 6e61 6765  f test_07_manage
-00014790: 5f75 7365 7228 7365 6c66 293a 0a20 2020  _user(self):.   
-000147a0: 2020 2020 2055 5345 525f 4e41 4d45 203d       USER_NAME =
-000147b0: 2027 4452 4956 4552 5f54 4553 5427 0a20   'DRIVER_TEST'. 
-000147c0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-000147d0: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
-000147e0: 2e75 7365 722e 6465 6c65 7465 2855 5345  .user.delete(USE
-000147f0: 525f 4e41 4d45 290a 2020 2020 2020 2020  R_NAME).        
-00014800: 6578 6365 7074 2044 6174 6162 6173 6545  except DatabaseE
-00014810: 7272 6f72 2061 7320 653a 0a20 2020 2020  rror as e:.     
-00014820: 2020 2020 2020 2069 6620 652e 7371 6c73         if e.sqls
-00014830: 7461 7465 203d 3d20 2732 3830 3030 273a  tate == '28000':
-00014840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014850: 2070 6173 730a 2020 2020 2020 2020 2020   pass.          
-00014860: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00014870: 2020 2020 2020 2020 7261 6973 650a 2020          raise.  
-00014880: 2020 2020 2020 2320 4164 6420 7573 6572        # Add user
-00014890: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
-000148a0: 632e 7573 6572 2e61 6464 2875 7365 725f  c.user.add(user_
-000148b0: 6e61 6d65 3d55 5345 525f 4e41 4d45 2c20  name=USER_NAME, 
-000148c0: 7061 7373 776f 7264 3d27 4452 4956 4552  password='DRIVER
-000148d0: 5f54 4553 5427 2c0a 2020 2020 2020 2020  _TEST',.        
-000148e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000148f0: 2020 6669 7273 745f 6e61 6d65 3d27 4669    first_name='Fi
-00014900: 7265 6269 7264 272c 206d 6964 646c 655f  rebird', middle_
-00014910: 6e61 6d65 3d27 4472 6976 6572 272c 206c  name='Driver', l
-00014920: 6173 745f 6e61 6d65 3d27 5465 7374 2729  ast_name='Test')
-00014930: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00014940: 7365 7274 5472 7565 2873 656c 662e 7376  sertTrue(self.sv
-00014950: 632e 7573 6572 2e65 7869 7374 7328 5553  c.user.exists(US
-00014960: 4552 5f4e 414d 4529 290a 2020 2020 2020  ER_NAME)).      
-00014970: 2020 7573 6572 7320 3d20 5b75 2066 6f72    users = [u for
-00014980: 2075 2069 6e20 7365 6c66 2e73 7663 2e75   u in self.svc.u
-00014990: 7365 722e 6765 745f 616c 6c28 2920 6966  ser.get_all() if
-000149a0: 2075 2e75 7365 725f 6e61 6d65 203d 3d20   u.user_name == 
-000149b0: 5553 4552 5f4e 414d 455d 0a20 2020 2020  USER_NAME].     
-000149c0: 2020 2073 656c 662e 6173 7365 7274 5472     self.assertTr
-000149d0: 7565 2875 7365 7273 290a 2020 2020 2020  ue(users).      
-000149e0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000149f0: 616c 286c 656e 2875 7365 7273 292c 2031  al(len(users), 1
-00014a00: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00014a10: 7373 6572 7445 7175 616c 2875 7365 7273  ssertEqual(users
-00014a20: 5b30 5d2e 6669 7273 745f 6e61 6d65 2c20  [0].first_name, 
-00014a30: 2746 6972 6562 6972 6427 290a 2020 2020  'Firebird').    
-00014a40: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00014a50: 7175 616c 2875 7365 7273 5b30 5d2e 6d69  qual(users[0].mi
-00014a60: 6464 6c65 5f6e 616d 652c 2027 4472 6976  ddle_name, 'Driv
-00014a70: 6572 2729 0a20 2020 2020 2020 2073 656c  er').        sel
-00014a80: 662e 6173 7365 7274 4571 7561 6c28 7573  f.assertEqual(us
-00014a90: 6572 735b 305d 2e6c 6173 745f 6e61 6d65  ers[0].last_name
-00014aa0: 2c20 2754 6573 7427 290a 2020 2020 2020  , 'Test').      
-00014ab0: 2020 2320 4d6f 6469 6679 2075 7365 720a    # Modify user.
-00014ac0: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
-00014ad0: 2e75 7365 722e 7570 6461 7465 2855 5345  .user.update(USE
-00014ae0: 525f 4e41 4d45 2c20 6669 7273 745f 6e61  R_NAME, first_na
-00014af0: 6d65 3d27 5846 6972 6562 6972 6427 2c20  me='XFirebird', 
-00014b00: 6d69 6464 6c65 5f6e 616d 653d 2758 4472  middle_name='XDr
-00014b10: 6976 6572 272c 206c 6173 745f 6e61 6d65  iver', last_name
-00014b20: 3d27 5854 6573 7427 290a 2020 2020 2020  ='XTest').      
-00014b30: 2020 7573 6572 203d 2073 656c 662e 7376    user = self.sv
-00014b40: 632e 7573 6572 2e67 6574 2855 5345 525f  c.user.get(USER_
-00014b50: 4e41 4d45 290a 2020 2020 2020 2020 7365  NAME).        se
-00014b60: 6c66 2e61 7373 6572 7445 7175 616c 2875  lf.assertEqual(u
-00014b70: 7365 722e 7573 6572 5f6e 616d 652c 2055  ser.user_name, U
-00014b80: 5345 525f 4e41 4d45 290a 2020 2020 2020  SER_NAME).      
-00014b90: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00014ba0: 616c 2875 7365 722e 6669 7273 745f 6e61  al(user.first_na
-00014bb0: 6d65 2c20 2758 4669 7265 6269 7264 2729  me, 'XFirebird')
-00014bc0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00014bd0: 7365 7274 4571 7561 6c28 7573 6572 2e6d  sertEqual(user.m
-00014be0: 6964 646c 655f 6e61 6d65 2c20 2758 4472  iddle_name, 'XDr
-00014bf0: 6976 6572 2729 0a20 2020 2020 2020 2073  iver').        s
-00014c00: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00014c10: 7573 6572 2e6c 6173 745f 6e61 6d65 2c20  user.last_name, 
-00014c20: 2758 5465 7374 2729 0a20 2020 2020 2020  'XTest').       
-00014c30: 2023 2044 656c 6574 6520 7573 6572 0a20   # Delete user. 
-00014c40: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
-00014c50: 7573 6572 2e64 656c 6574 6528 5553 4552  user.delete(USER
-00014c60: 5f4e 414d 4529 0a20 2020 2020 2020 2073  _NAME).        s
-00014c70: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
-00014c80: 7365 6c66 2e73 7663 2e75 7365 722e 6578  self.svc.user.ex
-00014c90: 6973 7473 2855 5345 525f 4e41 4d45 2929  ists(USER_NAME))
-00014ca0: 0a0a 636c 6173 7320 5465 7374 5365 7276  ..class TestServ
-00014cb0: 6572 4461 7461 6261 7365 5365 7276 6963  erDatabaseServic
-00014cc0: 6573 2844 7269 7665 7254 6573 7442 6173  es(DriverTestBas
-00014cd0: 6529 3a0a 2020 2020 6465 6620 7365 7455  e):.    def setU
-00014ce0: 7028 7365 6c66 293a 0a20 2020 2020 2020  p(self):.       
-00014cf0: 2073 7570 6572 2829 2e73 6574 5570 2829   super().setUp()
-00014d00: 0a20 2020 2020 2020 2023 2066 227b 4642  .        # f"{FB
-00014d10: 5445 5354 5f48 4f53 547d 3a7b 6f73 2e70  TEST_HOST}:{os.p
-00014d20: 6174 682e 6a6f 696e 2873 656c 662e 6462  ath.join(self.db
-00014d30: 7061 7468 2c20 2774 6573 745f 656d 706c  path, 'test_empl
-00014d40: 6f79 6565 2e66 6462 2729 7d22 0a20 2020  oyee.fdb')}".   
-00014d50: 2020 2020 2073 656c 662e 6462 6669 6c65       self.dbfile
-00014d60: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00014d70: 7365 6c66 2e64 6270 6174 682c 2073 656c  self.dbpath, sel
-00014d80: 662e 4642 5445 5354 5f44 4229 0a20 2020  f.FBTEST_DB).   
-00014d90: 2020 2020 2073 656c 662e 6662 6b20 3d20       self.fbk = 
-00014da0: 6f73 2e70 6174 682e 6a6f 696e 2873 656c  os.path.join(sel
-00014db0: 662e 6462 7061 7468 2c20 2774 6573 745f  f.dbpath, 'test_
-00014dc0: 656d 706c 6f79 6565 2e66 626b 2729 0a20  employee.fbk'). 
-00014dd0: 2020 2020 2020 2073 656c 662e 6662 6b32         self.fbk2
-00014de0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00014df0: 7365 6c66 2e64 6270 6174 682c 2027 7465  self.dbpath, 'te
-00014e00: 7374 5f65 6d70 6c6f 7965 652e 6662 6b32  st_employee.fbk2
-00014e10: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
-00014e20: 7266 6462 203d 206f 732e 7061 7468 2e6a  rfdb = os.path.j
-00014e30: 6f69 6e28 7365 6c66 2e64 6270 6174 682c  oin(self.dbpath,
-00014e40: 2027 7465 7374 5f65 6d70 6c6f 7965 652e   'test_employee.
-00014e50: 6664 6227 290a 2020 2020 2020 2020 7365  fdb').        se
-00014e60: 6c66 2e73 7663 203d 2063 6f6e 6e65 6374  lf.svc = connect
-00014e70: 5f73 6572 7665 7228 4642 5445 5354 5f48  _server(FBTEST_H
-00014e80: 4f53 542c 2075 7365 723d 2753 5953 4442  OST, user='SYSDB
-00014e90: 4127 2c20 7061 7373 776f 7264 3d46 4254  A', password=FBT
-00014ea0: 4553 545f 5041 5353 574f 5244 290a 2020  EST_PASSWORD).  
-00014eb0: 2020 2020 2020 7365 6c66 2e63 6f6e 203d        self.con =
-00014ec0: 2063 6f6e 6e65 6374 2866 227b 4642 5445   connect(f"{FBTE
-00014ed0: 5354 5f48 4f53 547d 3a7b 7365 6c66 2e64  ST_HOST}:{self.d
-00014ee0: 6266 696c 657d 222c 0a20 2020 2020 2020  bfile}",.       
-00014ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f00: 2020 2020 7573 6572 3d46 4254 4553 545f      user=FBTEST_
-00014f10: 5553 4552 2c20 7061 7373 776f 7264 3d46  USER, password=F
-00014f20: 4254 4553 545f 5041 5353 574f 5244 290a  BTEST_PASSWORD).
-00014f30: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
-00014f40: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
-00014f50: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-00014f60: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
-00014f70: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
-00014f80: 5f69 6d6d 6564 6961 7465 2822 6465 6c65  _immediate("dele
-00014f90: 7465 2066 726f 6d20 7422 290a 2020 2020  te from t").    
-00014fa0: 2020 2020 7365 6c66 2e63 6f6e 2e63 6f6d      self.con.com
-00014fb0: 6d69 7428 290a 2020 2020 2020 2020 6320  mit().        c 
-00014fc0: 3d20 6372 6561 7465 5f64 6174 6162 6173  = create_databas
-00014fd0: 6528 6622 7b46 4254 4553 545f 484f 5354  e(f"{FBTEST_HOST
-00014fe0: 7d3a 7b73 656c 662e 7266 6462 7d22 2c0a  }:{self.rfdb}",.
-00014ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015000: 2020 2020 2020 2020 2020 2020 7573 6572              user
-00015010: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
-00015020: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
-00015030: 5353 574f 5244 2c0a 2020 2020 2020 2020  SSWORD,.        
+00013b50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00013b60: 7274 4661 6c73 6528 7376 632e 6973 5f72  rtFalse(svc.is_r
+00013b70: 756e 6e69 6e67 2829 290a 2020 2020 6465  unning()).    de
+00013b80: 6620 7465 7374 5f77 6169 7428 7365 6c66  f test_wait(self
+00013b90: 293a 0a20 2020 2020 2020 2077 6974 6820  ):.        with 
+00013ba0: 636f 6e6e 6563 745f 7365 7276 6572 2846  connect_server(F
+00013bb0: 4254 4553 545f 484f 5354 2c20 7573 6572  BTEST_HOST, user
+00013bc0: 3d27 5359 5344 4241 272c 2070 6173 7377  ='SYSDBA', passw
+00013bd0: 6f72 643d 4642 5445 5354 5f50 4153 5357  ord=FBTEST_PASSW
+00013be0: 4f52 4429 2061 7320 7376 633a 0a20 2020  ORD) as svc:.   
+00013bf0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00013c00: 7365 7274 4661 6c73 6528 7376 632e 6973  sertFalse(svc.is
+00013c10: 5f72 756e 6e69 6e67 2829 290a 2020 2020  _running()).    
+00013c20: 2020 2020 2020 2020 7376 632e 696e 666f          svc.info
+00013c30: 2e67 6574 5f6c 6f67 2829 0a20 2020 2020  .get_log().     
+00013c40: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00013c50: 7274 5472 7565 2873 7663 2e69 735f 7275  rtTrue(svc.is_ru
+00013c60: 6e6e 696e 6728 2929 0a20 2020 2020 2020  nning()).       
+00013c70: 2020 2020 2073 7663 2e77 6169 7428 290a       svc.wait().
+00013c80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00013c90: 2e61 7373 6572 7446 616c 7365 2873 7663  .assertFalse(svc
+00013ca0: 2e69 735f 7275 6e6e 696e 6728 2929 0a0a  .is_running())..
+00013cb0: 636c 6173 7320 5465 7374 5365 7276 6572  class TestServer
+00013cc0: 5365 7276 6963 6573 2844 7269 7665 7254  Services(DriverT
+00013cd0: 6573 7442 6173 6529 3a0a 2020 2020 6465  estBase):.    de
+00013ce0: 6620 7365 7455 7028 7365 6c66 293a 0a20  f setUp(self):. 
+00013cf0: 2020 2020 2020 2073 7570 6572 2829 2e73         super().s
+00013d00: 6574 5570 2829 0a20 2020 2020 2020 2073  etUp().        s
+00013d10: 656c 662e 6462 6669 6c65 203d 206f 732e  elf.dbfile = os.
+00013d20: 7061 7468 2e6a 6f69 6e28 7365 6c66 2e64  path.join(self.d
+00013d30: 6270 6174 682c 2073 656c 662e 4642 5445  bpath, self.FBTE
+00013d40: 5354 5f44 4229 0a20 2020 2020 2020 2073  ST_DB).        s
+00013d50: 656c 662e 6662 6b20 3d20 6f73 2e70 6174  elf.fbk = os.pat
+00013d60: 682e 6a6f 696e 2873 656c 662e 6462 7061  h.join(self.dbpa
+00013d70: 7468 2c20 2774 6573 745f 656d 706c 6f79  th, 'test_employ
+00013d80: 6565 2e66 626b 2729 0a20 2020 2020 2020  ee.fbk').       
+00013d90: 2073 656c 662e 6662 6b32 203d 206f 732e   self.fbk2 = os.
+00013da0: 7061 7468 2e6a 6f69 6e28 7365 6c66 2e64  path.join(self.d
+00013db0: 6270 6174 682c 2027 7465 7374 5f65 6d70  bpath, 'test_emp
+00013dc0: 6c6f 7965 652e 6662 6b32 2729 0a20 2020  loyee.fbk2').   
+00013dd0: 2020 2020 2073 656c 662e 7266 6462 203d       self.rfdb =
+00013de0: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
+00013df0: 6c66 2e64 6270 6174 682c 2027 7465 7374  lf.dbpath, 'test
+00013e00: 5f65 6d70 6c6f 7965 652e 6664 6227 290a  _employee.fdb').
+00013e10: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
+00013e20: 203d 2063 6f6e 6e65 6374 5f73 6572 7665   = connect_serve
+00013e30: 7228 4642 5445 5354 5f48 4f53 542c 2075  r(FBTEST_HOST, u
+00013e40: 7365 723d 2753 5953 4442 4127 2c20 7061  ser='SYSDBA', pa
+00013e50: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+00013e60: 5353 574f 5244 290a 2020 2020 2020 2020  SSWORD).        
+00013e70: 7365 6c66 2e63 6f6e 203d 2063 6f6e 6e65  self.con = conne
+00013e80: 6374 2873 656c 662e 6462 6669 6c65 2c20  ct(self.dbfile, 
+00013e90: 7573 6572 3d46 4254 4553 545f 5553 4552  user=FBTEST_USER
+00013ea0: 2c20 7061 7373 776f 7264 3d46 4254 4553  , password=FBTES
+00013eb0: 545f 5041 5353 574f 5244 290a 2020 2020  T_PASSWORD).    
+00013ec0: 2020 2020 7365 6c66 2e63 6f6e 2e5f 6c6f      self.con._lo
+00013ed0: 6767 696e 675f 6964 5f20 3d20 7365 6c66  gging_id_ = self
+00013ee0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
+00013ef0: 655f 5f0a 2020 2020 2020 2020 7365 6c66  e__.        self
+00013f00: 2e63 6f6e 2e65 7865 6375 7465 5f69 6d6d  .con.execute_imm
+00013f10: 6564 6961 7465 2822 6465 6c65 7465 2066  ediate("delete f
+00013f20: 726f 6d20 7422 290a 2020 2020 2020 2020  rom t").        
+00013f30: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
+00013f40: 290a 2020 2020 2020 2020 6320 3d20 6372  ).        c = cr
+00013f50: 6561 7465 5f64 6174 6162 6173 6528 6622  eate_database(f"
+00013f60: 7b46 4254 4553 545f 484f 5354 7d3a 7b73  {FBTEST_HOST}:{s
+00013f70: 656c 662e 7266 6462 7d22 2c0a 2020 2020  elf.rfdb}",.    
+00013f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f90: 2020 2020 2020 2020 7573 6572 3d46 4254          user=FBT
+00013fa0: 4553 545f 5553 4552 2c20 7061 7373 776f  EST_USER, passwo
+00013fb0: 7264 3d46 4254 4553 545f 5041 5353 574f  rd=FBTEST_PASSWO
+00013fc0: 5244 2c0a 2020 2020 2020 2020 2020 2020  RD,.            
+00013fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fe0: 6f76 6572 7772 6974 653d 5472 7565 290a  overwrite=True).
+00013ff0: 2020 2020 2020 2020 632e 636c 6f73 6528          c.close(
+00014000: 290a 2020 2020 6465 6620 7465 6172 446f  ).    def tearDo
+00014010: 776e 2873 656c 6629 3a0a 2020 2020 2020  wn(self):.      
+00014020: 2020 7365 6c66 2e73 7663 2e63 6c6f 7365    self.svc.close
+00014030: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00014040: 636f 6e2e 636c 6f73 6528 290a 2020 2020  con.close().    
+00014050: 2020 2020 6966 206f 732e 7061 7468 2e65      if os.path.e
+00014060: 7869 7374 7328 7365 6c66 2e72 6664 6229  xists(self.rfdb)
+00014070: 3a0a 2020 2020 2020 2020 2020 2020 6f73  :.            os
+00014080: 2e72 656d 6f76 6528 7365 6c66 2e72 6664  .remove(self.rfd
+00014090: 6229 0a20 2020 2020 2020 2069 6620 6f73  b).        if os
+000140a0: 2e70 6174 682e 6578 6973 7473 2873 656c  .path.exists(sel
+000140b0: 662e 6662 6b29 3a0a 2020 2020 2020 2020  f.fbk):.        
+000140c0: 2020 2020 6f73 2e72 656d 6f76 6528 7365      os.remove(se
+000140d0: 6c66 2e66 626b 290a 2020 2020 2020 2020  lf.fbk).        
+000140e0: 6966 206f 732e 7061 7468 2e65 7869 7374  if os.path.exist
+000140f0: 7328 7365 6c66 2e66 626b 3229 3a0a 2020  s(self.fbk2):.  
+00014100: 2020 2020 2020 2020 2020 6f73 2e72 656d            os.rem
+00014110: 6f76 6528 7365 6c66 2e66 626b 3229 0a20  ove(self.fbk2). 
+00014120: 2020 2064 6566 2074 6573 745f 3031 5f6f     def test_01_o
+00014130: 7574 7075 745f 6279 5f6c 696e 6528 7365  utput_by_line(se
+00014140: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
+00014150: 662e 7376 632e 6d6f 6465 203d 2053 7276  f.svc.mode = Srv
+00014160: 496e 666f 436f 6465 2e4c 494e 450a 2020  InfoCode.LINE.  
+00014170: 2020 2020 2020 7365 6c66 2e74 6573 745f        self.test_
+00014180: 3033 5f6c 6f67 2829 0a20 2020 2064 6566  03_log().    def
+00014190: 2074 6573 745f 3032 5f6f 7574 7075 745f   test_02_output_
+000141a0: 746f 5f65 6f66 2873 656c 6629 3a0a 2020  to_eof(self):.  
+000141b0: 2020 2020 2020 7365 6c66 2e73 7663 2e6d        self.svc.m
+000141c0: 6f64 6520 3d20 5372 7649 6e66 6f43 6f64  ode = SrvInfoCod
+000141d0: 652e 544f 5f45 4f46 0a20 2020 2020 2020  e.TO_EOF.       
+000141e0: 2073 656c 662e 7465 7374 5f30 335f 6c6f   self.test_03_lo
+000141f0: 6728 290a 2020 2020 6465 6620 7465 7374  g().    def test
+00014200: 5f30 335f 6c6f 6728 7365 6c66 293a 0a20  _03_log(self):. 
+00014210: 2020 2020 2020 2064 6566 2066 6574 6368         def fetch
+00014220: 6c69 6e65 286c 696e 6529 3a0a 2020 2020  line(line):.    
+00014230: 2020 2020 2020 2020 6f75 7470 7574 2e61          output.a
+00014240: 7070 656e 6428 6c69 6e65 290a 0a20 2020  ppend(line)..   
+00014250: 2020 2020 2073 656c 662e 7376 632e 696e       self.svc.in
+00014260: 666f 2e67 6574 5f6c 6f67 2829 0a20 2020  fo.get_log().   
+00014270: 2020 2020 2023 2066 6574 6368 206d 6174       # fetch mat
+00014280: 6572 6961 6c69 7a65 640a 2020 2020 2020  erialized.      
+00014290: 2020 6c6f 6720 3d20 7365 6c66 2e73 7663    log = self.svc
+000142a0: 2e72 6561 646c 696e 6573 2829 0a20 2020  .readlines().   
+000142b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000142c0: 5472 7565 286c 6f67 290a 2020 2020 2020  True(log).      
+000142d0: 2020 7365 6c66 2e61 7373 6572 7449 7349    self.assertIsI
+000142e0: 6e73 7461 6e63 6528 6c6f 672c 2074 7970  nstance(log, typ
+000142f0: 6528 6c69 7374 2829 2929 0a20 2020 2020  e(list())).     
+00014300: 2020 2023 2069 7465 7261 7465 206f 7665     # iterate ove
+00014310: 7220 7265 7375 6c74 0a20 2020 2020 2020  r result.       
+00014320: 2073 656c 662e 7376 632e 696e 666f 2e67   self.svc.info.g
+00014330: 6574 5f6c 6f67 2829 0a20 2020 2020 2020  et_log().       
+00014340: 2066 6f72 206c 696e 6520 696e 2073 656c   for line in sel
+00014350: 662e 7376 633a 0a20 2020 2020 2020 2020  f.svc:.         
+00014360: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+00014370: 4e6f 744e 6f6e 6528 6c69 6e65 290a 2020  NotNone(line).  
+00014380: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00014390: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
+000143a0: 6c69 6e65 2c20 7374 7229 0a20 2020 2020  line, str).     
+000143b0: 2020 2023 2063 616c 6c62 6163 6b0a 2020     # callback.  
+000143c0: 2020 2020 2020 6f75 7470 7574 203d 205b        output = [
+000143d0: 5d0a 2020 2020 2020 2020 7365 6c66 2e73  ].        self.s
+000143e0: 7663 2e69 6e66 6f2e 6765 745f 6c6f 6728  vc.info.get_log(
+000143f0: 6361 6c6c 6261 636b 3d66 6574 6368 6c69  callback=fetchli
+00014400: 6e65 290a 2020 2020 2020 2020 7365 6c66  ne).        self
+00014410: 2e61 7373 6572 7447 7265 6174 6572 286c  .assertGreater(l
+00014420: 656e 286f 7574 7075 7429 2c20 3029 0a20  en(output), 0). 
+00014430: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00014440: 7274 4571 7561 6c28 6f75 7470 7574 2c20  rtEqual(output, 
+00014450: 6c6f 6729 0a20 2020 2064 6566 2074 6573  log).    def tes
+00014460: 745f 3034 5f67 6574 5f6c 696d 626f 5f74  t_04_get_limbo_t
+00014470: 7261 6e73 6163 7469 6f6e 5f69 6473 2873  ransaction_ids(s
+00014480: 656c 6629 3a0a 2020 2020 2020 2020 7365  elf):.        se
+00014490: 6c66 2e73 6b69 7054 6573 7428 274e 6f74  lf.skipTest('Not
+000144a0: 2069 6d70 6c65 6d65 6e74 6564 2079 6574   implemented yet
+000144b0: 2729 0a20 2020 2020 2020 2069 6473 203d  ').        ids =
+000144c0: 2073 656c 662e 7376 632e 6461 7461 6261   self.svc.databa
+000144d0: 7365 2e67 6574 5f6c 696d 626f 5f74 7261  se.get_limbo_tra
+000144e0: 6e73 6163 7469 6f6e 5f69 6473 2864 6174  nsaction_ids(dat
+000144f0: 6162 6173 653d 2765 6d70 6c6f 7965 6527  abase='employee'
+00014500: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00014510: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
+00014520: 6964 732c 2074 7970 6528 6c69 7374 2829  ids, type(list()
+00014530: 2929 0a20 2020 2064 6566 2074 6573 745f  )).    def test_
+00014540: 3035 5f74 7261 6365 2873 656c 6629 3a0a  05_trace(self):.
+00014550: 2020 2020 2020 2020 2373 656c 662e 736b          #self.sk
+00014560: 6970 5465 7374 2827 4e6f 7420 696d 706c  ipTest('Not impl
+00014570: 656d 656e 7465 6420 7965 7427 290a 2020  emented yet').  
+00014580: 2020 2020 2020 7472 6163 655f 636f 6e66        trace_conf
+00014590: 6967 203d 2022 2222 6461 7461 6261 7365  ig = """database
+000145a0: 203d 2025 730a 2020 2020 2020 2020 7b0a   = %s.        {.
+000145b0: 2020 2020 2020 2020 2020 656e 6162 6c65            enable
+000145c0: 6420 3d20 7472 7565 0a20 2020 2020 2020  d = true.       
+000145d0: 2020 206c 6f67 5f73 7461 7465 6d65 6e74     log_statement
+000145e0: 5f66 696e 6973 6820 3d20 7472 7565 0a20  _finish = true. 
+000145f0: 2020 2020 2020 2020 2070 7269 6e74 5f70           print_p
+00014600: 6c61 6e20 3d20 7472 7565 0a20 2020 2020  lan = true.     
+00014610: 2020 2020 2069 6e63 6c75 6465 5f66 696c       include_fil
+00014620: 7465 7220 3d20 2525 5345 4c45 4354 2525  ter = %%SELECT%%
+00014630: 0a20 2020 2020 2020 2020 2065 7863 6c75  .          exclu
+00014640: 6465 5f66 696c 7465 7220 3d20 2525 5244  de_filter = %%RD
+00014650: 4224 2525 0a20 2020 2020 2020 2020 2074  B$%%.          t
+00014660: 696d 655f 7468 7265 7368 6f6c 6420 3d20  ime_threshold = 
+00014670: 300a 2020 2020 2020 2020 2020 6d61 785f  0.          max_
+00014680: 7371 6c5f 6c65 6e67 7468 203d 2032 3034  sql_length = 204
+00014690: 380a 2020 2020 2020 2020 7d0a 2020 2020  8.        }.    
+000146a0: 2020 2020 2222 2220 2520 7365 6c66 2e64      """ % self.d
+000146b0: 6266 696c 650a 2020 2020 2020 2020 7769  bfile.        wi
+000146c0: 7468 2063 6f6e 6e65 6374 5f73 6572 7665  th connect_serve
+000146d0: 7228 4642 5445 5354 5f48 4f53 542c 2075  r(FBTEST_HOST, u
+000146e0: 7365 723d 2753 5953 4442 4127 2c20 7061  ser='SYSDBA', pa
+000146f0: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+00014700: 5353 574f 5244 2920 6173 2073 7663 322c  SSWORD) as svc2,
+00014710: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+00014720: 636f 6e6e 6563 745f 7365 7276 6572 2846  connect_server(F
+00014730: 4254 4553 545f 484f 5354 2c20 7573 6572  BTEST_HOST, user
+00014740: 3d27 5359 5344 4241 272c 2070 6173 7377  ='SYSDBA', passw
+00014750: 6f72 643d 4642 5445 5354 5f50 4153 5357  ord=FBTEST_PASSW
+00014760: 4f52 4429 2061 7320 7376 6378 3a0a 2020  ORD) as svcx:.  
+00014770: 2020 2020 2020 2020 2020 2320 5374 6172            # Star
+00014780: 7420 7472 6163 6520 7365 7373 696f 6e73  t trace sessions
+00014790: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
+000147a0: 6365 315f 6964 203d 2073 656c 662e 7376  ce1_id = self.sv
+000147b0: 632e 7472 6163 652e 7374 6172 7428 636f  c.trace.start(co
+000147c0: 6e66 6967 3d74 7261 6365 5f63 6f6e 6669  nfig=trace_confi
+000147d0: 672c 206e 616d 653d 2774 6573 745f 7472  g, name='test_tr
+000147e0: 6163 655f 3127 290a 2020 2020 2020 2020  ace_1').        
+000147f0: 2020 2020 7472 6163 6532 5f69 6420 3d20      trace2_id = 
+00014800: 7376 6332 2e74 7261 6365 2e73 7461 7274  svc2.trace.start
+00014810: 2863 6f6e 6669 673d 7472 6163 655f 636f  (config=trace_co
+00014820: 6e66 6967 290a 2020 2020 2020 2020 2020  nfig).          
+00014830: 2020 2320 6368 6563 6b20 7365 7373 696f    # check sessio
+00014840: 6e73 0a20 2020 2020 2020 2020 2020 2073  ns.            s
+00014850: 6573 7369 6f6e 7320 3d20 7376 6378 2e74  essions = svcx.t
+00014860: 7261 6365 2e73 6573 7369 6f6e 730a 2020  race.sessions.  
+00014870: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00014880: 7373 6572 7449 6e28 7472 6163 6531 5f69  ssertIn(trace1_i
+00014890: 642c 2073 6573 7369 6f6e 7329 0a20 2020  d, sessions).   
+000148a0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+000148b0: 7365 7274 4571 7561 6c28 7365 7373 696f  sertEqual(sessio
+000148c0: 6e73 5b74 7261 6365 315f 6964 5d2e 6e61  ns[trace1_id].na
+000148d0: 6d65 2c20 2774 6573 745f 7472 6163 655f  me, 'test_trace_
+000148e0: 3127 290a 2020 2020 2020 2020 2020 2020  1').            
+000148f0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00014900: 2873 6573 7369 6f6e 735b 7472 6163 6532  (sessions[trace2
+00014910: 5f69 645d 2e6e 616d 652c 2027 2729 0a20  _id].name, ''). 
+00014920: 2020 2020 2020 2020 2020 2023 2057 696e             # Win
+00014930: 646f 7773 2072 6574 7572 6e73 2053 5953  dows returns SYS
+00014940: 4442 410a 2020 2020 2020 2020 2020 2020  DBA.            
+00014950: 2369 6620 7379 732e 706c 6174 666f 726d  #if sys.platform
+00014960: 203d 3d20 2777 696e 3332 273a 0a20 2020   == 'win32':.   
+00014970: 2020 2020 2020 2020 2020 2020 2023 7365               #se
+00014980: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
+00014990: 6573 7369 6f6e 735b 7472 6163 6531 5f69  essions[trace1_i
+000149a0: 645d 2e75 7365 722c 2027 5359 5344 4241  d].user, 'SYSDBA
+000149b0: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
+000149c0: 2020 2023 7365 6c66 2e61 7373 6572 7445     #self.assertE
+000149d0: 7175 616c 2873 6573 7369 6f6e 735b 7472  qual(sessions[tr
+000149e0: 6163 6532 5f69 645d 2e75 7365 722c 2027  ace2_id].user, '
+000149f0: 5359 5344 4241 2729 0a20 2020 2020 2020  SYSDBA').       
+00014a00: 2020 2020 2023 656c 7365 3a0a 2020 2020       #else:.    
+00014a10: 2020 2020 2020 2020 2020 2020 2373 656c              #sel
+00014a20: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00014a30: 7373 696f 6e73 5b74 7261 6365 315f 6964  ssions[trace1_id
+00014a40: 5d2e 7573 6572 2c20 2727 290a 2020 2020  ].user, '').    
+00014a50: 2020 2020 2020 2020 2020 2020 2373 656c              #sel
+00014a60: 662e 6173 7365 7274 4571 7561 6c28 7365  f.assertEqual(se
+00014a70: 7373 696f 6e73 5b74 7261 6365 325f 6964  ssions[trace2_id
+00014a80: 5d2e 7573 6572 2c20 2727 290a 2020 2020  ].user, '').    
+00014a90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00014aa0: 6572 7445 7175 616c 2873 6573 7369 6f6e  ertEqual(session
+00014ab0: 735b 7472 6163 6531 5f69 645d 2e75 7365  s[trace1_id].use
+00014ac0: 722c 2027 5359 5344 4241 2729 0a20 2020  r, 'SYSDBA').   
+00014ad0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00014ae0: 7365 7274 4571 7561 6c28 7365 7373 696f  sertEqual(sessio
+00014af0: 6e73 5b74 7261 6365 325f 6964 5d2e 7573  ns[trace2_id].us
+00014b00: 6572 2c20 2753 5953 4442 4127 290a 2020  er, 'SYSDBA').  
+00014b10: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00014b20: 7373 6572 7449 6e28 7472 6163 6532 5f69  ssertIn(trace2_i
+00014b30: 642c 2073 6573 7369 6f6e 7329 0a20 2020  d, sessions).   
+00014b40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00014b50: 7365 7274 4c69 7374 4571 7561 6c28 7365  sertListEqual(se
+00014b60: 7373 696f 6e73 5b74 7261 6365 315f 6964  ssions[trace1_id
+00014b70: 5d2e 666c 6167 732c 205b 2761 6374 6976  ].flags, ['activ
+00014b80: 6527 2c20 2720 7472 6163 6527 5d29 0a20  e', ' trace']). 
+00014b90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00014ba0: 6173 7365 7274 4c69 7374 4571 7561 6c28  assertListEqual(
+00014bb0: 7365 7373 696f 6e73 5b74 7261 6365 325f  sessions[trace2_
+00014bc0: 6964 5d2e 666c 6167 732c 205b 2761 6374  id].flags, ['act
+00014bd0: 6976 6527 2c20 2720 7472 6163 6527 5d29  ive', ' trace'])
+00014be0: 0a20 2020 2020 2020 2020 2020 2023 2050  .            # P
+00014bf0: 6175 7365 2073 6573 7369 6f6e 0a20 2020  ause session.   
+00014c00: 2020 2020 2020 2020 2073 7663 782e 7472           svcx.tr
+00014c10: 6163 652e 7375 7370 656e 6428 7365 7373  ace.suspend(sess
+00014c20: 696f 6e5f 6964 3d74 7261 6365 325f 6964  ion_id=trace2_id
+00014c30: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00014c40: 6c66 2e61 7373 6572 7449 6e28 2773 7573  lf.assertIn('sus
+00014c50: 7065 6e64 272c 2073 7663 782e 7472 6163  pend', svcx.trac
+00014c60: 652e 7365 7373 696f 6e73 5b74 7261 6365  e.sessions[trace
+00014c70: 325f 6964 5d2e 666c 6167 7329 0a20 2020  2_id].flags).   
+00014c80: 2020 2020 2020 2020 2023 2052 6573 756d           # Resum
+00014c90: 6520 7365 7373 696f 6e0a 2020 2020 2020  e session.      
+00014ca0: 2020 2020 2020 7376 6378 2e74 7261 6365        svcx.trace
+00014cb0: 2e72 6573 756d 6528 7365 7373 696f 6e5f  .resume(session_
+00014cc0: 6964 3d74 7261 6365 325f 6964 290a 2020  id=trace2_id).  
+00014cd0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00014ce0: 7373 6572 7449 6e28 2761 6374 6976 6527  ssertIn('active'
+00014cf0: 2c20 7376 6378 2e74 7261 6365 2e73 6573  , svcx.trace.ses
+00014d00: 7369 6f6e 735b 7472 6163 6532 5f69 645d  sions[trace2_id]
+00014d10: 2e66 6c61 6773 290a 2020 2020 2020 2020  .flags).        
+00014d20: 2020 2020 2320 5374 6f70 2073 6573 7369      # Stop sessi
+00014d30: 6f6e 0a20 2020 2020 2020 2020 2020 2073  on.            s
+00014d40: 7663 782e 7472 6163 652e 7374 6f70 2873  vcx.trace.stop(s
+00014d50: 6573 7369 6f6e 5f69 643d 7472 6163 6532  ession_id=trace2
+00014d60: 5f69 6429 0a20 2020 2020 2020 2020 2020  _id).           
+00014d70: 2073 656c 662e 6173 7365 7274 4e6f 7449   self.assertNotI
+00014d80: 6e28 7472 6163 6532 5f69 642c 2073 7663  n(trace2_id, svc
+00014d90: 782e 7472 6163 652e 7365 7373 696f 6e73  x.trace.sessions
+00014da0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00014db0: 4669 6e61 6c69 7a65 0a20 2020 2020 2020  Finalize.       
+00014dc0: 2020 2020 2073 7663 782e 7472 6163 652e       svcx.trace.
+00014dd0: 7374 6f70 2873 6573 7369 6f6e 5f69 643d  stop(session_id=
+00014de0: 7472 6163 6531 5f69 6429 0a20 2020 2064  trace1_id).    d
+00014df0: 6566 2074 6573 745f 3036 5f67 6574 5f75  ef test_06_get_u
+00014e00: 7365 7273 2873 656c 6629 3a0a 2020 2020  sers(self):.    
+00014e10: 2020 2020 7573 6572 7320 3d20 7365 6c66      users = self
+00014e20: 2e73 7663 2e75 7365 722e 6765 745f 616c  .svc.user.get_al
+00014e30: 6c28 290a 2020 2020 2020 2020 7365 6c66  l().        self
+00014e40: 2e61 7373 6572 7449 7349 6e73 7461 6e63  .assertIsInstanc
+00014e50: 6528 7573 6572 732c 2074 7970 6528 6c69  e(users, type(li
+00014e60: 7374 2829 2929 0a20 2020 2020 2020 2073  st())).        s
+00014e70: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
+00014e80: 616e 6365 2875 7365 7273 5b30 5d2c 2064  ance(users[0], d
+00014e90: 7269 7665 722e 636f 7265 2e55 7365 7249  river.core.UserI
+00014ea0: 6e66 6f29 0a20 2020 2020 2020 2073 656c  nfo).        sel
+00014eb0: 662e 6173 7365 7274 4571 7561 6c28 7573  f.assertEqual(us
+00014ec0: 6572 735b 305d 2e75 7365 725f 6e61 6d65  ers[0].user_name
+00014ed0: 2c20 2753 5953 4442 4127 290a 2020 2020  , 'SYSDBA').    
+00014ee0: 6465 6620 7465 7374 5f30 375f 6d61 6e61  def test_07_mana
+00014ef0: 6765 5f75 7365 7228 7365 6c66 293a 0a20  ge_user(self):. 
+00014f00: 2020 2020 2020 2055 5345 525f 4e41 4d45         USER_NAME
+00014f10: 203d 2027 4452 4956 4552 5f54 4553 5427   = 'DRIVER_TEST'
+00014f20: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00014f30: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+00014f40: 7663 2e75 7365 722e 6465 6c65 7465 2855  vc.user.delete(U
+00014f50: 5345 525f 4e41 4d45 290a 2020 2020 2020  SER_NAME).      
+00014f60: 2020 6578 6365 7074 2044 6174 6162 6173    except Databas
+00014f70: 6545 7272 6f72 2061 7320 653a 0a20 2020  eError as e:.   
+00014f80: 2020 2020 2020 2020 2069 6620 652e 7371           if e.sq
+00014f90: 6c73 7461 7465 203d 3d20 2732 3830 3030  lstate == '28000
+00014fa0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
+00014fb0: 2020 2070 6173 730a 2020 2020 2020 2020     pass.        
+00014fc0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00014fd0: 2020 2020 2020 2020 2020 7261 6973 650a            raise.
+00014fe0: 2020 2020 2020 2020 2320 4164 6420 7573          # Add us
+00014ff0: 6572 0a20 2020 2020 2020 2073 656c 662e  er.        self.
+00015000: 7376 632e 7573 6572 2e61 6464 2875 7365  svc.user.add(use
+00015010: 725f 6e61 6d65 3d55 5345 525f 4e41 4d45  r_name=USER_NAME
+00015020: 2c20 7061 7373 776f 7264 3d27 4452 4956  , password='DRIV
+00015030: 4552 5f54 4553 5427 2c0a 2020 2020 2020  ER_TEST',.      
 00015040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015050: 2020 2020 6f76 6572 7772 6974 653d 5472      overwrite=Tr
-00015060: 7565 290a 2020 2020 2020 2020 632e 636c  ue).        c.cl
-00015070: 6f73 6528 290a 2020 2020 6465 6620 7465  ose().    def te
-00015080: 6172 446f 776e 2873 656c 6629 3a0a 2020  arDown(self):.  
-00015090: 2020 2020 2020 7365 6c66 2e73 7663 2e63        self.svc.c
-000150a0: 6c6f 7365 2829 0a20 2020 2020 2020 2073  lose().        s
-000150b0: 656c 662e 636f 6e2e 636c 6f73 6528 290a  elf.con.close().
-000150c0: 2020 2020 2020 2020 6966 206f 732e 7061          if os.pa
-000150d0: 7468 2e65 7869 7374 7328 7365 6c66 2e72  th.exists(self.r
-000150e0: 6664 6229 3a0a 2020 2020 2020 2020 2020  fdb):.          
-000150f0: 2020 6f73 2e72 656d 6f76 6528 7365 6c66    os.remove(self
-00015100: 2e72 6664 6229 0a20 2020 2020 2020 2069  .rfdb).        i
-00015110: 6620 6f73 2e70 6174 682e 6578 6973 7473  f os.path.exists
-00015120: 2873 656c 662e 6662 6b29 3a0a 2020 2020  (self.fbk):.    
-00015130: 2020 2020 2020 2020 6f73 2e72 656d 6f76          os.remov
-00015140: 6528 7365 6c66 2e66 626b 290a 2020 2020  e(self.fbk).    
-00015150: 2020 2020 6966 206f 732e 7061 7468 2e65      if os.path.e
-00015160: 7869 7374 7328 7365 6c66 2e66 626b 3229  xists(self.fbk2)
-00015170: 3a0a 2020 2020 2020 2020 2020 2020 6f73  :.            os
-00015180: 2e72 656d 6f76 6528 7365 6c66 2e66 626b  .remove(self.fbk
-00015190: 3229 0a20 2020 2064 6566 2074 6573 745f  2).    def test_
-000151a0: 6765 745f 7374 6174 6973 7469 6373 2873  get_statistics(s
-000151b0: 656c 6629 3a0a 2020 2020 2020 2020 6465  elf):.        de
-000151c0: 6620 6665 7463 686c 696e 6528 6c69 6e65  f fetchline(line
-000151d0: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
-000151e0: 7574 7075 742e 6170 7065 6e64 286c 696e  utput.append(lin
-000151f0: 6529 0a0a 2020 2020 2020 2020 2373 656c  e)..        #sel
-00015200: 662e 736b 6970 5465 7374 2827 4e6f 7420  f.skipTest('Not 
-00015210: 696d 706c 656d 656e 7465 6420 7965 7427  implemented yet'
-00015220: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
-00015230: 7663 2e64 6174 6162 6173 652e 6765 745f  vc.database.get_
-00015240: 7374 6174 6973 7469 6373 2864 6174 6162  statistics(datab
-00015250: 6173 653d 2765 6d70 6c6f 7965 6527 290a  ase='employee').
-00015260: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00015270: 6572 7454 7275 6528 7365 6c66 2e73 7663  ertTrue(self.svc
-00015280: 2e69 735f 7275 6e6e 696e 6728 2929 0a20  .is_running()). 
-00015290: 2020 2020 2020 2023 2066 6574 6368 206d         # fetch m
-000152a0: 6174 6572 6961 6c69 7a65 640a 2020 2020  aterialized.    
-000152b0: 2020 2020 7374 6174 7320 3d20 7365 6c66      stats = self
-000152c0: 2e73 7663 2e72 6561 646c 696e 6573 2829  .svc.readlines()
-000152d0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000152e0: 7365 7274 4661 6c73 6528 7365 6c66 2e73  sertFalse(self.s
-000152f0: 7663 2e69 735f 7275 6e6e 696e 6728 2929  vc.is_running())
-00015300: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00015310: 7365 7274 4973 496e 7374 616e 6365 2873  sertIsInstance(s
-00015320: 7461 7473 2c20 7479 7065 286c 6973 7428  tats, type(list(
-00015330: 2929 290a 2020 2020 2020 2020 2320 6974  ))).        # it
-00015340: 6572 6174 6520 6f76 6572 2072 6573 756c  erate over resul
-00015350: 740a 2020 2020 2020 2020 7365 6c66 2e73  t.        self.s
-00015360: 7663 2e64 6174 6162 6173 652e 6765 745f  vc.database.get_
-00015370: 7374 6174 6973 7469 6373 2864 6174 6162  statistics(datab
-00015380: 6173 653d 2765 6d70 6c6f 7965 6527 2c0a  ase='employee',.
-00015390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000153a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000153b0: 2020 2020 2020 2020 2066 6c61 6773 3d28           flags=(
-000153c0: 5372 7653 7461 7446 6c61 672e 4445 4641  SrvStatFlag.DEFA
-000153d0: 554c 540a 2020 2020 2020 2020 2020 2020  ULT.            
-000153e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000153f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015400: 2020 2020 7c20 5372 7653 7461 7446 6c61      | SrvStatFla
-00015410: 672e 5359 535f 5245 4c41 5449 4f4e 530a  g.SYS_RELATIONS.
-00015420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015450: 7c20 5372 7653 7461 7446 6c61 672e 5245  | SrvStatFlag.RE
-00015460: 434f 5244 5f56 4552 5349 4f4e 5329 290a  CORD_VERSIONS)).
-00015470: 2020 2020 2020 2020 666f 7220 6c69 6e65          for line
-00015480: 2069 6e20 7365 6c66 2e73 7663 3a0a 2020   in self.svc:.  
-00015490: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000154a0: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-000154b0: 6c69 6e65 2c20 7374 7229 0a20 2020 2020  line, str).     
-000154c0: 2020 2023 2063 616c 6c62 6163 6b0a 2020     # callback.  
-000154d0: 2020 2020 2020 6f75 7470 7574 203d 205b        output = [
-000154e0: 5d0a 2020 2020 2020 2020 7365 6c66 2e73  ].        self.s
-000154f0: 7663 2e64 6174 6162 6173 652e 6765 745f  vc.database.get_
-00015500: 7374 6174 6973 7469 6373 2864 6174 6162  statistics(datab
-00015510: 6173 653d 2765 6d70 6c6f 7965 6527 2c20  ase='employee', 
-00015520: 6361 6c6c 6261 636b 3d66 6574 6368 6c69  callback=fetchli
-00015530: 6e65 290a 2020 2020 2020 2020 7365 6c66  ne).        self
-00015540: 2e61 7373 6572 7447 7265 6174 6572 286c  .assertGreater(l
-00015550: 656e 286f 7574 7075 7429 2c20 3029 0a20  en(output), 0). 
-00015560: 2020 2020 2020 2023 2066 6574 6368 206f         # fetch o
-00015570: 6e6c 7920 7365 6c65 6374 6564 2074 6162  nly selected tab
-00015580: 6c65 730a 2020 2020 2020 2020 7374 6174  les.        stat
-00015590: 7320 3d20 7365 6c66 2e73 7663 2e64 6174  s = self.svc.dat
-000155a0: 6162 6173 652e 6765 745f 7374 6174 6973  abase.get_statis
-000155b0: 7469 6373 2864 6174 6162 6173 653d 2765  tics(database='e
-000155c0: 6d70 6c6f 7965 6527 2c0a 2020 2020 2020  mployee',.      
-000155d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155f0: 2020 2020 2020 2020 2020 2066 6c61 6773             flags
-00015600: 3d53 7276 5374 6174 466c 6167 2e44 4154  =SrvStatFlag.DAT
-00015610: 415f 5041 4745 532c 0a20 2020 2020 2020  A_PAGES,.       
-00015620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015640: 2020 2020 2020 2020 2020 7461 626c 6573            tables
-00015650: 3d5b 2743 4f55 4e54 5259 275d 290a 2020  =['COUNTRY']).  
-00015660: 2020 2020 2020 7374 6174 7320 3d20 275c        stats = '\
-00015670: 6e27 2e6a 6f69 6e28 7365 6c66 2e73 7663  n'.join(self.svc
-00015680: 2e72 6561 646c 696e 6573 2829 290a 2020  .readlines()).  
-00015690: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000156a0: 7449 6e28 2743 4f55 4e54 5259 272c 2073  tIn('COUNTRY', s
-000156b0: 7461 7473 290a 2020 2020 2020 2020 7365  tats).        se
-000156c0: 6c66 2e61 7373 6572 744e 6f74 496e 2827  lf.assertNotIn('
-000156d0: 4a4f 4227 2c20 7374 6174 7329 0a20 2020  JOB', stats).   
-000156e0: 2020 2020 2023 0a20 2020 2020 2020 2073       #.        s
-000156f0: 7461 7473 203d 2073 656c 662e 7376 632e  tats = self.svc.
-00015700: 6461 7461 6261 7365 2e67 6574 5f73 7461  database.get_sta
-00015710: 7469 7374 6963 7328 6461 7461 6261 7365  tistics(database
-00015720: 3d27 656d 706c 6f79 6565 272c 0a20 2020  ='employee',.   
-00015730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015750: 2020 2020 2020 2020 2020 2020 2020 666c                fl
-00015760: 6167 733d 5372 7653 7461 7446 6c61 672e  ags=SrvStatFlag.
-00015770: 4441 5441 5f50 4147 4553 2c0a 2020 2020  DATA_PAGES,.    
-00015780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000157a0: 2020 2020 2020 2020 2020 2020 2074 6162               tab
-000157b0: 6c65 733d 2827 434f 554e 5452 5927 2c20  les=('COUNTRY', 
-000157c0: 2750 524f 4a45 4354 2729 290a 2020 2020  'PROJECT')).    
-000157d0: 2020 2020 7374 6174 7320 3d20 275c 6e27      stats = '\n'
-000157e0: 2e6a 6f69 6e28 7365 6c66 2e73 7663 2e72  .join(self.svc.r
-000157f0: 6561 646c 696e 6573 2829 290a 2020 2020  eadlines()).    
-00015800: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-00015810: 6e28 2743 4f55 4e54 5259 272c 2073 7461  n('COUNTRY', sta
-00015820: 7473 290a 2020 2020 2020 2020 7365 6c66  ts).        self
-00015830: 2e61 7373 6572 7449 6e28 2750 524f 4a45  .assertIn('PROJE
-00015840: 4354 272c 2073 7461 7473 290a 2020 2020  CT', stats).    
-00015850: 2020 2020 7365 6c66 2e61 7373 6572 744e      self.assertN
-00015860: 6f74 496e 2827 4a4f 4227 2c20 7374 6174  otIn('JOB', stat
-00015870: 7329 0a20 2020 2064 6566 2074 6573 745f  s).    def test_
-00015880: 6261 636b 7570 2873 656c 6629 3a0a 2020  backup(self):.  
-00015890: 2020 2020 2020 6465 6620 6665 7463 686c        def fetchl
-000158a0: 696e 6528 6c69 6e65 293a 0a20 2020 2020  ine(line):.     
-000158b0: 2020 2020 2020 206f 7574 7075 742e 6170         output.ap
-000158c0: 7065 6e64 286c 696e 6529 0a0a 2020 2020  pend(line)..    
-000158d0: 2020 2020 2373 656c 662e 736b 6970 5465      #self.skipTe
-000158e0: 7374 2827 4e6f 7420 696d 706c 656d 656e  st('Not implemen
-000158f0: 7465 6420 7965 7427 290a 2020 2020 2020  ted yet').      
-00015900: 2020 7365 6c66 2e73 7663 2e64 6174 6162    self.svc.datab
-00015910: 6173 652e 6261 636b 7570 2864 6174 6162  ase.backup(datab
-00015920: 6173 653d 2765 6d70 6c6f 7965 6527 2c20  ase='employee', 
-00015930: 6261 636b 7570 3d73 656c 662e 6662 6b29  backup=self.fbk)
-00015940: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00015950: 7365 7274 5472 7565 2873 656c 662e 7376  sertTrue(self.sv
-00015960: 632e 6973 5f72 756e 6e69 6e67 2829 290a  c.is_running()).
-00015970: 2020 2020 2020 2020 2320 6665 7463 6820          # fetch 
-00015980: 6d61 7465 7269 616c 697a 6564 0a20 2020  materialized.   
-00015990: 2020 2020 2072 6570 6f72 7420 3d20 7365       report = se
-000159a0: 6c66 2e73 7663 2e72 6561 646c 696e 6573  lf.svc.readlines
-000159b0: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-000159c0: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
-000159d0: 2e73 7663 2e69 735f 7275 6e6e 696e 6728  .svc.is_running(
-000159e0: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-000159f0: 6173 7365 7274 5472 7565 286f 732e 7061  assertTrue(os.pa
-00015a00: 7468 2e65 7869 7374 7328 7365 6c66 2e66  th.exists(self.f
-00015a10: 626b 2929 0a20 2020 2020 2020 2073 656c  bk)).        sel
-00015a20: 662e 6173 7365 7274 4973 496e 7374 616e  f.assertIsInstan
-00015a30: 6365 2872 6570 6f72 742c 2074 7970 6528  ce(report, type(
-00015a40: 6c69 7374 2829 2929 0a20 2020 2020 2020  list())).       
-00015a50: 2073 656c 662e 6173 7365 7274 4c69 7374   self.assertList
-00015a60: 4571 7561 6c28 7265 706f 7274 2c20 5b5d  Equal(report, []
-00015a70: 290a 2020 2020 2020 2020 2320 6974 6572  ).        # iter
-00015a80: 6174 6520 6f76 6572 2072 6573 756c 740a  ate over result.
-00015a90: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
-00015aa0: 2e64 6174 6162 6173 652e 6261 636b 7570  .database.backup
-00015ab0: 2864 6174 6162 6173 653d 2765 6d70 6c6f  (database='emplo
-00015ac0: 7965 6527 2c20 6261 636b 7570 3d73 656c  yee', backup=sel
-00015ad0: 662e 6662 6b2c 0a20 2020 2020 2020 2020  f.fbk,.         
-00015ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015af0: 2020 2020 2020 2020 666c 6167 733d 2853          flags=(S
-00015b00: 7276 4261 636b 7570 466c 6167 2e43 4f4e  rvBackupFlag.CON
-00015b10: 5645 5254 0a20 2020 2020 2020 2020 2020  VERT.           
-00015b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b30: 2020 2020 2020 2020 2020 2020 207c 2053               | S
-00015b40: 7276 4261 636b 7570 466c 6167 2e49 474e  rvBackupFlag.IGN
-00015b50: 4f52 455f 4c49 4d42 4f0a 2020 2020 2020  ORE_LIMBO.      
-00015b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b80: 2020 7c20 5372 7642 6163 6b75 7046 6c61    | SrvBackupFla
-00015b90: 672e 4947 4e4f 5245 5f43 4845 434b 5355  g.IGNORE_CHECKSU
-00015ba0: 4d53 0a20 2020 2020 2020 2020 2020 2020  MS.             
-00015bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bc0: 2020 2020 2020 2020 2020 207c 2053 7276             | Srv
-00015bd0: 4261 636b 7570 466c 6167 2e4d 4554 4144  BackupFlag.METAD
-00015be0: 4154 415f 4f4e 4c59 292c 2076 6572 626f  ATA_ONLY), verbo
-00015bf0: 7365 3d54 7275 6529 0a20 2020 2020 2020  se=True).       
-00015c00: 2066 6f72 206c 696e 6520 696e 2073 656c   for line in sel
-00015c10: 662e 7376 633a 0a20 2020 2020 2020 2020  f.svc:.         
-00015c20: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
-00015c30: 4e6f 744e 6f6e 6528 6c69 6e65 290a 2020  NotNone(line).  
-00015c40: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00015c50: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-00015c60: 6c69 6e65 2c20 7374 7229 0a20 2020 2020  line, str).     
-00015c70: 2020 2023 2063 616c 6c62 6163 6b0a 2020     # callback.  
-00015c80: 2020 2020 2020 6f75 7470 7574 203d 205b        output = [
-00015c90: 5d0a 2020 2020 2020 2020 7365 6c66 2e73  ].        self.s
-00015ca0: 7663 2e64 6174 6162 6173 652e 6261 636b  vc.database.back
-00015cb0: 7570 2864 6174 6162 6173 653d 2765 6d70  up(database='emp
-00015cc0: 6c6f 7965 6527 2c20 6261 636b 7570 3d73  loyee', backup=s
-00015cd0: 656c 662e 6662 6b2c 2063 616c 6c62 6163  elf.fbk, callbac
-00015ce0: 6b3d 6665 7463 686c 696e 652c 0a20 2020  k=fetchline,.   
-00015cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d00: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00015d10: 7262 6f73 653d 5472 7565 290a 2020 2020  rbose=True).    
-00015d20: 2020 2020 7365 6c66 2e61 7373 6572 7447      self.assertG
-00015d30: 7265 6174 6572 286c 656e 286f 7574 7075  reater(len(outpu
-00015d40: 7429 2c20 3029 0a20 2020 2020 2020 2023  t), 0).        #
-00015d50: 2046 6972 6562 6972 6420 332e 3020 7374   Firebird 3.0 st
-00015d60: 6174 730a 2020 2020 2020 2020 6f75 7470  ats.        outp
-00015d70: 7574 203d 205b 5d0a 2020 2020 2020 2020  ut = [].        
-00015d80: 7365 6c66 2e73 7663 2e64 6174 6162 6173  self.svc.databas
-00015d90: 652e 6261 636b 7570 2864 6174 6162 6173  e.backup(databas
-00015da0: 653d 2765 6d70 6c6f 7965 6527 2c20 6261  e='employee', ba
-00015db0: 636b 7570 3d73 656c 662e 6662 6b2c 2063  ckup=self.fbk, c
-00015dc0: 616c 6c62 6163 6b3d 6665 7463 686c 696e  allback=fetchlin
-00015dd0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00015de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015df0: 2020 2020 7374 6174 733d 2754 4452 5727      stats='TDRW'
-00015e00: 2c20 7665 7262 6f73 653d 5472 7565 290a  , verbose=True).
-00015e10: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00015e20: 6572 7447 7265 6174 6572 286c 656e 286f  ertGreater(len(o
-00015e30: 7574 7075 7429 2c20 3029 0a20 2020 2020  utput), 0).     
-00015e40: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-00015e50: 2827 6762 616b 3a20 7469 6d65 2020 2020  ('gbak: time    
-00015e60: 2064 656c 7461 2020 7265 6164 7320 2077   delta  reads  w
-00015e70: 7269 7465 7320 5c6e 272c 206f 7574 7075  rites \n', outpu
-00015e80: 7429 0a20 2020 2020 2020 2023 2053 6b69  t).        # Ski
-00015e90: 7020 6461 7461 206f 7074 696f 6e0a 2020  p data option.  
-00015ea0: 2020 2020 2020 7365 6c66 2e73 7663 2e64        self.svc.d
-00015eb0: 6174 6162 6173 652e 6261 636b 7570 2864  atabase.backup(d
-00015ec0: 6174 6162 6173 653d 2765 6d70 6c6f 7965  atabase='employe
-00015ed0: 6527 2c20 6261 636b 7570 3d73 656c 662e  e', backup=self.
-00015ee0: 6662 6b2c 2073 6b69 705f 6461 7461 3d27  fbk, skip_data='
-00015ef0: 2873 616c 6573 7c63 7573 746f 6d65 7229  (sales|customer)
-00015f00: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
-00015f10: 7376 632e 7761 6974 2829 0a20 2020 2020  svc.wait().     
-00015f20: 2020 2073 656c 662e 7376 632e 6461 7461     self.svc.data
-00015f30: 6261 7365 2e72 6573 746f 7265 2862 6163  base.restore(bac
-00015f40: 6b75 703d 7365 6c66 2e66 626b 2c20 6461  kup=self.fbk, da
-00015f50: 7461 6261 7365 3d73 656c 662e 7266 6462  tabase=self.rfdb
-00015f60: 2c20 666c 6167 733d 5372 7652 6573 746f  , flags=SrvResto
-00015f70: 7265 466c 6167 2e52 4550 4c41 4345 290a  reFlag.REPLACE).
-00015f80: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
-00015f90: 2e77 6169 7428 290a 2020 2020 2020 2020  .wait().        
-00015fa0: 7769 7468 2063 6f6e 6e65 6374 2866 227b  with connect(f"{
-00015fb0: 4642 5445 5354 5f48 4f53 547d 3a7b 7365  FBTEST_HOST}:{se
-00015fc0: 6c66 2e72 6664 627d 222c 2075 7365 723d  lf.rfdb}", user=
-00015fd0: 4642 5445 5354 5f55 5345 522c 2070 6173  FBTEST_USER, pas
-00015fe0: 7377 6f72 643d 4642 5445 5354 5f50 4153  sword=FBTEST_PAS
-00015ff0: 5357 4f52 4429 2061 7320 7263 6f6e 3a0a  SWORD) as rcon:.
-00016000: 2020 2020 2020 2020 2020 2020 7263 6f6e              rcon
-00016010: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
-00016020: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-00016030: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
-00016040: 2020 2020 7769 7468 2072 636f 6e2e 6375      with rcon.cu
-00016050: 7273 6f72 2829 2061 7320 633a 0a20 2020  rsor() as c:.   
-00016060: 2020 2020 2020 2020 2020 2020 2063 2e65               c.e
-00016070: 7865 6375 7465 2827 7365 6c65 6374 202a  xecute('select *
-00016080: 2066 726f 6d20 7361 6c65 7327 290a 2020   from sales').  
-00016090: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000160a0: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-000160b0: 616c 2863 2e66 6574 6368 616c 6c28 292c  al(c.fetchall(),
-000160c0: 205b 5d29 0a20 2020 2020 2020 2020 2020   []).           
-000160d0: 2020 2020 2063 2e65 7865 6375 7465 2827       c.execute('
-000160e0: 7365 6c65 6374 202a 2066 726f 6d20 636f  select * from co
-000160f0: 756e 7472 7927 290a 2020 2020 2020 2020  untry').        
-00016100: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00016110: 6572 7447 7265 6174 6572 286c 656e 2863  ertGreater(len(c
-00016120: 2e66 6574 6368 616c 6c28 2929 2c20 3029  .fetchall()), 0)
-00016130: 0a20 2020 2064 6566 2074 6573 745f 7265  .    def test_re
-00016140: 7374 6f72 6528 7365 6c66 293a 0a20 2020  store(self):.   
-00016150: 2020 2020 2064 6566 2066 6574 6368 6c69       def fetchli
-00016160: 6e65 286c 696e 6529 3a0a 2020 2020 2020  ne(line):.      
-00016170: 2020 2020 2020 6f75 7470 7574 2e61 7070        output.app
-00016180: 656e 6428 6c69 6e65 290a 0a20 2020 2020  end(line)..     
-00016190: 2020 206f 7574 7075 7420 3d20 5b5d 0a20     output = []. 
-000161a0: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
-000161b0: 6461 7461 6261 7365 2e62 6163 6b75 7028  database.backup(
-000161c0: 6461 7461 6261 7365 3d27 656d 706c 6f79  database='employ
-000161d0: 6565 272c 2062 6163 6b75 703d 7365 6c66  ee', backup=self
-000161e0: 2e66 626b 2c20 6361 6c6c 6261 636b 3d66  .fbk, callback=f
-000161f0: 6574 6368 6c69 6e65 290a 2020 2020 2020  etchline).      
-00016200: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00016210: 6528 6f73 2e70 6174 682e 6578 6973 7473  e(os.path.exists
-00016220: 2873 656c 662e 6662 6b29 290a 2020 2020  (self.fbk)).    
-00016230: 2020 2020 7365 6c66 2e73 7663 2e64 6174      self.svc.dat
-00016240: 6162 6173 652e 7265 7374 6f72 6528 6261  abase.restore(ba
-00016250: 636b 7570 3d73 656c 662e 6662 6b2c 2064  ckup=self.fbk, d
-00016260: 6174 6162 6173 653d 7365 6c66 2e72 6664  atabase=self.rfd
-00016270: 622c 2066 6c61 6773 3d53 7276 5265 7374  b, flags=SrvRest
-00016280: 6f72 6546 6c61 672e 5245 504c 4143 4529  oreFlag.REPLACE)
-00016290: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000162a0: 7365 7274 5472 7565 2873 656c 662e 7376  sertTrue(self.sv
-000162b0: 632e 6973 5f72 756e 6e69 6e67 2829 290a  c.is_running()).
-000162c0: 2020 2020 2020 2020 2320 6665 7463 6820          # fetch 
-000162d0: 6d61 7465 7269 616c 697a 6564 0a20 2020  materialized.   
-000162e0: 2020 2020 2072 6570 6f72 7420 3d20 7365       report = se
-000162f0: 6c66 2e73 7663 2e72 6561 646c 696e 6573  lf.svc.readlines
-00016300: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-00016310: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
-00016320: 2e73 7663 2e69 735f 7275 6e6e 696e 6728  .svc.is_running(
-00016330: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-00016340: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
-00016350: 2872 6570 6f72 742c 2074 7970 6528 6c69  (report, type(li
-00016360: 7374 2829 2929 0a20 2020 2020 2020 2023  st())).        #
-00016370: 2069 7465 7261 7465 206f 7665 7220 7265   iterate over re
-00016380: 7375 6c74 0a20 2020 2020 2020 2073 656c  sult.        sel
-00016390: 662e 7376 632e 6461 7461 6261 7365 2e72  f.svc.database.r
-000163a0: 6573 746f 7265 2862 6163 6b75 703d 7365  estore(backup=se
-000163b0: 6c66 2e66 626b 2c20 6461 7461 6261 7365  lf.fbk, database
-000163c0: 3d73 656c 662e 7266 6462 2c20 666c 6167  =self.rfdb, flag
-000163d0: 733d 5372 7652 6573 746f 7265 466c 6167  s=SrvRestoreFlag
-000163e0: 2e52 4550 4c41 4345 290a 2020 2020 2020  .REPLACE).      
-000163f0: 2020 666f 7220 6c69 6e65 2069 6e20 7365    for line in se
-00016400: 6c66 2e73 7663 3a0a 2020 2020 2020 2020  lf.svc:.        
-00016410: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-00016420: 734e 6f74 4e6f 6e65 286c 696e 6529 0a20  sNotNone(line). 
-00016430: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00016440: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
-00016450: 286c 696e 652c 2073 7472 290a 2020 2020  (line, str).    
-00016460: 2020 2020 2320 6361 6c6c 6261 636b 0a20      # callback. 
-00016470: 2020 2020 2020 206f 7574 7075 7420 3d20         output = 
-00016480: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
-00016490: 7376 632e 6461 7461 6261 7365 2e72 6573  svc.database.res
-000164a0: 746f 7265 2862 6163 6b75 703d 7365 6c66  tore(backup=self
-000164b0: 2e66 626b 2c20 6461 7461 6261 7365 3d73  .fbk, database=s
-000164c0: 656c 662e 7266 6462 2c20 7665 7262 6f73  elf.rfdb, verbos
-000164d0: 653d 5472 7565 2c0a 2020 2020 2020 2020  e=True,.        
-000164e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000164f0: 2020 2020 2020 2020 2020 666c 6167 733d            flags=
-00016500: 5372 7652 6573 746f 7265 466c 6167 2e52  SrvRestoreFlag.R
-00016510: 4550 4c41 4345 2c20 6361 6c6c 6261 636b  EPLACE, callback
-00016520: 3d66 6574 6368 6c69 6e65 290a 2020 2020  =fetchline).    
-00016530: 2020 2020 7365 6c66 2e61 7373 6572 7447      self.assertG
-00016540: 7265 6174 6572 286c 656e 286f 7574 7075  reater(len(outpu
-00016550: 7429 2c20 3029 0a20 2020 2020 2020 2023  t), 0).        #
-00016560: 2046 6972 6562 6972 6420 332e 3020 7374   Firebird 3.0 st
-00016570: 6174 730a 2020 2020 2020 2020 6f75 7470  ats.        outp
-00016580: 7574 203d 205b 5d0a 2020 2020 2020 2020  ut = [].        
-00016590: 7365 6c66 2e73 7663 2e64 6174 6162 6173  self.svc.databas
-000165a0: 652e 7265 7374 6f72 6528 6261 636b 7570  e.restore(backup
-000165b0: 3d73 656c 662e 6662 6b2c 2064 6174 6162  =self.fbk, datab
-000165c0: 6173 653d 7365 6c66 2e72 6664 622c 0a20  ase=self.rfdb,. 
-000165d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165f0: 2066 6c61 6773 3d53 7276 5265 7374 6f72   flags=SrvRestor
-00016600: 6546 6c61 672e 5245 504c 4143 452c 2063  eFlag.REPLACE, c
-00016610: 616c 6c62 6163 6b3d 6665 7463 686c 696e  allback=fetchlin
-00016620: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00016630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016640: 2020 2020 2073 7461 7473 3d27 5444 5257       stats='TDRW
-00016650: 272c 2076 6572 626f 7365 3d54 7275 6529  ', verbose=True)
-00016660: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00016670: 7365 7274 4772 6561 7465 7228 6c65 6e28  sertGreater(len(
-00016680: 6f75 7470 7574 292c 2030 290a 2020 2020  output), 0).    
-00016690: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-000166a0: 6e28 2767 6261 6b3a 2074 696d 6520 2020  n('gbak: time   
-000166b0: 2020 6465 6c74 6120 2072 6561 6473 2020    delta  reads  
-000166c0: 7772 6974 6573 205c 6e27 2c20 6f75 7470  writes \n', outp
-000166d0: 7574 290a 2020 2020 2020 2020 2320 536b  ut).        # Sk
-000166e0: 6970 2064 6174 6120 6f70 7469 6f6e 0a20  ip data option. 
-000166f0: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
-00016700: 6461 7461 6261 7365 2e72 6573 746f 7265  database.restore
-00016710: 2862 6163 6b75 703d 7365 6c66 2e66 626b  (backup=self.fbk
-00016720: 2c20 6461 7461 6261 7365 3d73 656c 662e  , database=self.
-00016730: 7266 6462 2c0a 2020 2020 2020 2020 2020  rfdb,.          
-00016740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016750: 2020 2020 2020 2020 666c 6167 733d 5372          flags=Sr
-00016760: 7652 6573 746f 7265 466c 6167 2e52 4550  vRestoreFlag.REP
-00016770: 4c41 4345 2c20 736b 6970 5f64 6174 613d  LACE, skip_data=
-00016780: 2728 7361 6c65 737c 6375 7374 6f6d 6572  '(sales|customer
-00016790: 2927 290a 2020 2020 2020 2020 7365 6c66  )').        self
-000167a0: 2e73 7663 2e77 6169 7428 290a 2020 2020  .svc.wait().    
-000167b0: 2020 2020 7769 7468 2063 6f6e 6e65 6374      with connect
-000167c0: 2866 227b 4642 5445 5354 5f48 4f53 547d  (f"{FBTEST_HOST}
-000167d0: 3a7b 7365 6c66 2e72 6664 627d 222c 2075  :{self.rfdb}", u
-000167e0: 7365 723d 4642 5445 5354 5f55 5345 522c  ser=FBTEST_USER,
-000167f0: 2070 6173 7377 6f72 643d 4642 5445 5354   password=FBTEST
-00016800: 5f50 4153 5357 4f52 4429 2061 7320 7263  _PASSWORD) as rc
-00016810: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00016820: 7263 6f6e 2e5f 6c6f 6767 696e 675f 6964  rcon._logging_id
-00016830: 5f20 3d20 7365 6c66 2e5f 5f63 6c61 7373  _ = self.__class
-00016840: 5f5f 2e5f 5f6e 616d 655f 5f0a 2020 2020  __.__name__.    
-00016850: 2020 2020 2020 2020 7769 7468 2072 636f          with rco
-00016860: 6e2e 6375 7273 6f72 2829 2061 7320 633a  n.cursor() as c:
-00016870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016880: 2063 2e65 7865 6375 7465 2827 7365 6c65   c.execute('sele
-00016890: 6374 202a 2066 726f 6d20 7361 6c65 7327  ct * from sales'
-000168a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000168b0: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
-000168c0: 7445 7175 616c 2863 2e66 6574 6368 616c  tEqual(c.fetchal
-000168d0: 6c28 292c 205b 5d29 0a20 2020 2020 2020  l(), []).       
-000168e0: 2020 2020 2020 2020 2063 2e65 7865 6375           c.execu
-000168f0: 7465 2827 7365 6c65 6374 202a 2066 726f  te('select * fro
-00016900: 6d20 636f 756e 7472 7927 290a 2020 2020  m country').    
-00016910: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00016920: 2e61 7373 6572 7447 7265 6174 6572 286c  .assertGreater(l
-00016930: 656e 2863 2e66 6574 6368 616c 6c28 2929  en(c.fetchall())
-00016940: 2c20 3029 0a20 2020 2064 6566 2074 6573  , 0).    def tes
-00016950: 745f 6c6f 6361 6c5f 6261 636b 7570 2873  t_local_backup(s
-00016960: 656c 6629 3a0a 2020 2020 2020 2020 7365  elf):.        se
-00016970: 6c66 2e73 7663 2e64 6174 6162 6173 652e  lf.svc.database.
-00016980: 6261 636b 7570 2864 6174 6162 6173 653d  backup(database=
-00016990: 2765 6d70 6c6f 7965 6527 2c20 6261 636b  'employee', back
-000169a0: 7570 3d73 656c 662e 6662 6b29 0a20 2020  up=self.fbk).   
-000169b0: 2020 2020 2073 656c 662e 7376 632e 7761       self.svc.wa
-000169c0: 6974 2829 0a20 2020 2020 2020 2077 6974  it().        wit
-000169d0: 6820 6f70 656e 2873 656c 662e 6662 6b2c  h open(self.fbk,
-000169e0: 206d 6f64 653d 2772 6227 2920 6173 2066   mode='rb') as f
-000169f0: 3a0a 2020 2020 2020 2020 2020 2020 662e  :.            f.
-00016a00: 7365 656b 2836 3829 2020 2320 5765 6520  seek(68)  # Wee 
-00016a10: 6d75 7374 2073 6b69 7020 6166 7465 7220  must skip after 
-00016a20: 6261 636b 7570 2063 7265 6174 696f 6e20  backup creation 
-00016a30: 7469 6d65 2028 3638 2920 7468 6174 2077  time (68) that w
-00016a40: 696c 6c20 6469 6666 6572 0a20 2020 2020  ill differ.     
-00016a50: 2020 2020 2020 2062 6b70 203d 2066 2e72         bkp = f.r
-00016a60: 6561 6428 290a 2020 2020 2020 2020 6261  ead().        ba
-00016a70: 636b 7570 5f73 7472 6561 6d20 3d20 4279  ckup_stream = By
-00016a80: 7465 7349 4f28 290a 2020 2020 2020 2020  tesIO().        
-00016a90: 7365 6c66 2e73 7663 2e64 6174 6162 6173  self.svc.databas
-00016aa0: 652e 6c6f 6361 6c5f 6261 636b 7570 2864  e.local_backup(d
-00016ab0: 6174 6162 6173 653d 2765 6d70 6c6f 7965  atabase='employe
-00016ac0: 6527 2c20 6261 636b 7570 5f73 7472 6561  e', backup_strea
-00016ad0: 6d3d 6261 636b 7570 5f73 7472 6561 6d29  m=backup_stream)
-00016ae0: 0a20 2020 2020 2020 2062 6163 6b75 705f  .        backup_
-00016af0: 7374 7265 616d 2e73 6565 6b28 3638 290a  stream.seek(68).
-00016b00: 2020 2020 2020 2020 6c62 6b70 203d 2062          lbkp = b
-00016b10: 6163 6b75 705f 7374 7265 616d 2e72 6561  ackup_stream.rea
-00016b20: 6428 290a 2020 2020 2020 2020 7374 6f70  d().        stop
-00016b30: 203d 206d 696e 286c 656e 2862 6b70 292c   = min(len(bkp),
-00016b40: 206c 656e 286c 626b 7029 290a 2020 2020   len(lbkp)).    
-00016b50: 2020 2020 6920 3d20 300a 2020 2020 2020      i = 0.      
-00016b60: 2020 7768 696c 6520 6920 3c20 7374 6f70    while i < stop
-00016b70: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00016b80: 6c66 2e61 7373 6572 7445 7175 616c 2862  lf.assertEqual(b
-00016b90: 6b70 5b69 5d2c 206c 626b 705b 695d 2c20  kp[i], lbkp[i], 
-00016ba0: 6622 6279 7465 7320 6469 6666 6572 2061  f"bytes differ a
-00016bb0: 7420 7b69 7d20 287b 692b 3638 7d29 2229  t {i} ({i+68})")
-00016bc0: 0a20 2020 2020 2020 2020 2020 2069 202b  .            i +
-00016bd0: 3d20 310a 2020 2020 2020 2020 6465 6c20  = 1.        del 
-00016be0: 626b 700a 2020 2020 6465 6620 7465 7374  bkp.    def test
-00016bf0: 5f6c 6f63 616c 5f72 6573 746f 7265 2873  _local_restore(s
-00016c00: 656c 6629 3a0a 2020 2020 2020 2020 6261  elf):.        ba
-00016c10: 636b 7570 5f73 7472 6561 6d20 3d20 4279  ckup_stream = By
-00016c20: 7465 7349 4f28 290a 2020 2020 2020 2020  tesIO().        
-00016c30: 7365 6c66 2e73 7663 2e64 6174 6162 6173  self.svc.databas
-00016c40: 652e 6c6f 6361 6c5f 6261 636b 7570 2864  e.local_backup(d
-00016c50: 6174 6162 6173 653d 2765 6d70 6c6f 7965  atabase='employe
-00016c60: 6527 2c20 6261 636b 7570 5f73 7472 6561  e', backup_strea
-00016c70: 6d3d 6261 636b 7570 5f73 7472 6561 6d29  m=backup_stream)
-00016c80: 0a20 2020 2020 2020 2062 6163 6b75 705f  .        backup_
-00016c90: 7374 7265 616d 2e73 6565 6b28 3029 0a20  stream.seek(0). 
-00016ca0: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
-00016cb0: 6461 7461 6261 7365 2e6c 6f63 616c 5f72  database.local_r
-00016cc0: 6573 746f 7265 2862 6163 6b75 705f 7374  estore(backup_st
-00016cd0: 7265 616d 3d62 6163 6b75 705f 7374 7265  ream=backup_stre
-00016ce0: 616d 2c20 6461 7461 6261 7365 3d73 656c  am, database=sel
-00016cf0: 662e 7266 6462 2c0a 2020 2020 2020 2020  f.rfdb,.        
-00016d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d20: 666c 6167 733d 5372 7652 6573 746f 7265  flags=SrvRestore
-00016d30: 466c 6167 2e52 4550 4c41 4345 290a 2020  Flag.REPLACE).  
-00016d40: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00016d50: 7454 7275 6528 6f73 2e70 6174 682e 6578  tTrue(os.path.ex
-00016d60: 6973 7473 2873 656c 662e 7266 6462 2929  ists(self.rfdb))
-00016d70: 0a20 2020 2064 6566 2074 6573 745f 6e62  .    def test_nb
-00016d80: 6163 6b75 7028 7365 6c66 293a 0a20 2020  ackup(self):.   
-00016d90: 2020 2020 2073 656c 662e 7376 632e 6461       self.svc.da
-00016da0: 7461 6261 7365 2e6e 6261 636b 7570 2864  tabase.nbackup(d
-00016db0: 6174 6162 6173 653d 2765 6d70 6c6f 7965  atabase='employe
-00016dc0: 6527 2c20 6261 636b 7570 3d73 656c 662e  e', backup=self.
-00016dd0: 6662 6b29 0a20 2020 2020 2020 2073 656c  fbk).        sel
-00016de0: 662e 6173 7365 7274 5472 7565 286f 732e  f.assertTrue(os.
-00016df0: 7061 7468 2e65 7869 7374 7328 7365 6c66  path.exists(self
-00016e00: 2e66 626b 2929 0a20 2020 2020 2020 2073  .fbk)).        s
-00016e10: 656c 662e 7376 632e 6461 7461 6261 7365  elf.svc.database
-00016e20: 2e6e 6261 636b 7570 2864 6174 6162 6173  .nbackup(databas
-00016e30: 653d 2765 6d70 6c6f 7965 6527 2c20 6261  e='employee', ba
-00016e40: 636b 7570 3d73 656c 662e 6662 6b32 2c20  ckup=self.fbk2, 
-00016e50: 6c65 7665 6c3d 312c 0a20 2020 2020 2020  level=1,.       
-00016e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e70: 2020 2020 2020 2020 2020 2064 6972 6563             direc
-00016e80: 743d 5472 7565 2c20 666c 6167 733d 5372  t=True, flags=Sr
-00016e90: 764e 4261 636b 7570 466c 6167 2e4e 4f5f  vNBackupFlag.NO_
-00016ea0: 5452 4947 4745 5253 290a 2020 2020 2020  TRIGGERS).      
-00016eb0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
-00016ec0: 6528 6f73 2e70 6174 682e 6578 6973 7473  e(os.path.exists
-00016ed0: 2873 656c 662e 6662 6b32 2929 0a20 2020  (self.fbk2)).   
-00016ee0: 2064 6566 2074 6573 745f 6e72 6573 746f   def test_nresto
-00016ef0: 7265 2873 656c 6629 3a0a 2020 2020 2020  re(self):.      
-00016f00: 2020 7365 6c66 2e74 6573 745f 6e62 6163    self.test_nbac
-00016f10: 6b75 7028 290a 2020 2020 2020 2020 6966  kup().        if
-00016f20: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
-00016f30: 7365 6c66 2e72 6664 6229 3a0a 2020 2020  self.rfdb):.    
-00016f40: 2020 2020 2020 2020 6f73 2e72 656d 6f76          os.remov
-00016f50: 6528 7365 6c66 2e72 6664 6229 0a20 2020  e(self.rfdb).   
-00016f60: 2020 2020 2073 656c 662e 7376 632e 6461       self.svc.da
-00016f70: 7461 6261 7365 2e6e 7265 7374 6f72 6528  tabase.nrestore(
-00016f80: 6261 636b 7570 733d 5b73 656c 662e 6662  backups=[self.fb
-00016f90: 6b5d 2c20 6461 7461 6261 7365 3d73 656c  k], database=sel
-00016fa0: 662e 7266 6462 290a 2020 2020 2020 2020  f.rfdb).        
-00016fb0: 7365 6c66 2e61 7373 6572 7454 7275 6528  self.assertTrue(
-00016fc0: 6f73 2e70 6174 682e 6578 6973 7473 2873  os.path.exists(s
-00016fd0: 656c 662e 7266 6462 2929 0a20 2020 2020  elf.rfdb)).     
-00016fe0: 2020 2069 6620 6f73 2e70 6174 682e 6578     if os.path.ex
-00016ff0: 6973 7473 2873 656c 662e 7266 6462 293a  ists(self.rfdb):
-00017000: 0a20 2020 2020 2020 2020 2020 206f 732e  .            os.
-00017010: 7265 6d6f 7665 2873 656c 662e 7266 6462  remove(self.rfdb
-00017020: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
-00017030: 7663 2e64 6174 6162 6173 652e 6e72 6573  vc.database.nres
-00017040: 746f 7265 2862 6163 6b75 7073 3d5b 7365  tore(backups=[se
-00017050: 6c66 2e66 626b 2c20 7365 6c66 2e66 626b  lf.fbk, self.fbk
-00017060: 325d 2c20 6461 7461 6261 7365 3d73 656c  2], database=sel
-00017070: 662e 7266 6462 2c0a 2020 2020 2020 2020  f.rfdb,.        
-00017080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017090: 2020 6469 7265 6374 3d54 7275 652c 2066    direct=True, f
-000170a0: 6c61 6773 3d53 7276 4e42 6163 6b75 7046  lags=SrvNBackupF
-000170b0: 6c61 672e 4e4f 5f54 5249 4747 4552 5329  lag.NO_TRIGGERS)
-000170c0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-000170d0: 7365 7274 5472 7565 286f 732e 7061 7468  sertTrue(os.path
-000170e0: 2e65 7869 7374 7328 7365 6c66 2e72 6664  .exists(self.rfd
-000170f0: 6229 290a 2020 2020 6465 6620 7465 7374  b)).    def test
-00017100: 5f73 6574 5f64 6566 6175 6c74 5f63 6163  _set_default_cac
-00017110: 6865 5f73 697a 6528 7365 6c66 293a 0a20  he_size(self):. 
-00017120: 2020 2020 2020 2077 6974 6820 636f 6e6e         with conn
-00017130: 6563 7428 6622 7b46 4254 4553 545f 484f  ect(f"{FBTEST_HO
-00017140: 5354 7d3a 7b73 656c 662e 7266 6462 7d22  ST}:{self.rfdb}"
-00017150: 2c20 7573 6572 3d46 4254 4553 545f 5553  , user=FBTEST_US
-00017160: 4552 2c20 7061 7373 776f 7264 3d46 4254  ER, password=FBT
-00017170: 4553 545f 5041 5353 574f 5244 2920 6173  EST_PASSWORD) as
-00017180: 2063 6f6e 3a0a 2020 2020 2020 2020 2020   con:.          
-00017190: 2020 636f 6e2e 5f6c 6f67 6769 6e67 5f69    con._logging_i
-000171a0: 645f 203d 2073 656c 662e 5f5f 636c 6173  d_ = self.__clas
-000171b0: 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020  s__.__name__.   
-000171c0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-000171d0: 7365 7274 4e6f 7445 7175 616c 2863 6f6e  sertNotEqual(con
-000171e0: 2e69 6e66 6f2e 7061 6765 5f63 6163 6865  .info.page_cache
-000171f0: 5f73 697a 652c 2031 3030 290a 2020 2020  _size, 100).    
-00017200: 2020 2020 7365 6c66 2e73 7663 2e64 6174      self.svc.dat
-00017210: 6162 6173 652e 7365 745f 6465 6661 756c  abase.set_defaul
-00017220: 745f 6361 6368 655f 7369 7a65 2864 6174  t_cache_size(dat
-00017230: 6162 6173 653d 7365 6c66 2e72 6664 622c  abase=self.rfdb,
-00017240: 2073 697a 653d 3130 3029 0a20 2020 2020   size=100).     
-00017250: 2020 2077 6974 6820 636f 6e6e 6563 7428     with connect(
-00017260: 6622 7b46 4254 4553 545f 484f 5354 7d3a  f"{FBTEST_HOST}:
-00017270: 7b73 656c 662e 7266 6462 7d22 2c20 7573  {self.rfdb}", us
-00017280: 6572 3d46 4254 4553 545f 5553 4552 2c20  er=FBTEST_USER, 
-00017290: 7061 7373 776f 7264 3d46 4254 4553 545f  password=FBTEST_
-000172a0: 5041 5353 574f 5244 2920 6173 2063 6f6e  PASSWORD) as con
-000172b0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-000172c0: 6e2e 5f6c 6f67 6769 6e67 5f69 645f 203d  n._logging_id_ =
-000172d0: 2073 656c 662e 5f5f 636c 6173 735f 5f2e   self.__class__.
-000172e0: 5f5f 6e61 6d65 5f5f 0a20 2020 2020 2020  __name__.       
-000172f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00017300: 4571 7561 6c28 636f 6e2e 696e 666f 2e70  Equal(con.info.p
-00017310: 6167 655f 6361 6368 655f 7369 7a65 2c20  age_cache_size, 
-00017320: 3130 3029 0a20 2020 2020 2020 2073 656c  100).        sel
-00017330: 662e 7376 632e 6461 7461 6261 7365 2e73  f.svc.database.s
-00017340: 6574 5f64 6566 6175 6c74 5f63 6163 6865  et_default_cache
-00017350: 5f73 697a 6528 6461 7461 6261 7365 3d73  _size(database=s
-00017360: 656c 662e 7266 6462 2c20 7369 7a65 3d35  elf.rfdb, size=5
-00017370: 3030 3029 0a20 2020 2020 2020 2077 6974  000).        wit
-00017380: 6820 636f 6e6e 6563 7428 6622 7b46 4254  h connect(f"{FBT
-00017390: 4553 545f 484f 5354 7d3a 7b73 656c 662e  EST_HOST}:{self.
-000173a0: 7266 6462 7d22 2c20 7573 6572 3d46 4254  rfdb}", user=FBT
-000173b0: 4553 545f 5553 4552 2c20 7061 7373 776f  EST_USER, passwo
-000173c0: 7264 3d46 4254 4553 545f 5041 5353 574f  rd=FBTEST_PASSWO
-000173d0: 5244 2920 6173 2063 6f6e 3a0a 2020 2020  RD) as con:.    
-000173e0: 2020 2020 2020 2020 636f 6e2e 5f6c 6f67          con._log
-000173f0: 6769 6e67 5f69 645f 203d 2073 656c 662e  ging_id_ = self.
-00017400: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00017410: 5f5f 0a20 2020 2020 2020 2020 2020 2073  __.            s
-00017420: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00017430: 636f 6e2e 696e 666f 2e70 6167 655f 6361  con.info.page_ca
-00017440: 6368 655f 7369 7a65 2c20 3530 3030 290a  che_size, 5000).
-00017450: 2020 2020 6465 6620 7465 7374 5f73 6574      def test_set
-00017460: 5f73 7765 6570 5f69 6e74 6572 7661 6c28  _sweep_interval(
-00017470: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
-00017480: 6974 6820 636f 6e6e 6563 7428 6622 7b46  ith connect(f"{F
-00017490: 4254 4553 545f 484f 5354 7d3a 7b73 656c  BTEST_HOST}:{sel
-000174a0: 662e 7266 6462 7d22 2c20 7573 6572 3d46  f.rfdb}", user=F
-000174b0: 4254 4553 545f 5553 4552 2c20 7061 7373  BTEST_USER, pass
-000174c0: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
-000174d0: 574f 5244 2920 6173 2063 6f6e 3a0a 2020  WORD) as con:.  
-000174e0: 2020 2020 2020 2020 2020 636f 6e2e 5f6c            con._l
-000174f0: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
-00017500: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00017510: 6d65 5f5f 0a20 2020 2020 2020 2020 2020  me__.           
-00017520: 2073 656c 662e 6173 7365 7274 4e6f 7445   self.assertNotE
-00017530: 7175 616c 2863 6f6e 2e69 6e66 6f2e 7377  qual(con.info.sw
-00017540: 6565 705f 696e 7465 7276 616c 2c20 3130  eep_interval, 10
-00017550: 3030 3029 0a20 2020 2020 2020 2073 656c  000).        sel
-00017560: 662e 7376 632e 6461 7461 6261 7365 2e73  f.svc.database.s
-00017570: 6574 5f73 7765 6570 5f69 6e74 6572 7661  et_sweep_interva
-00017580: 6c28 6461 7461 6261 7365 3d73 656c 662e  l(database=self.
-00017590: 7266 6462 2c20 696e 7465 7276 616c 3d31  rfdb, interval=1
-000175a0: 3030 3030 290a 2020 2020 2020 2020 7769  0000).        wi
-000175b0: 7468 2063 6f6e 6e65 6374 2866 227b 4642  th connect(f"{FB
-000175c0: 5445 5354 5f48 4f53 547d 3a7b 7365 6c66  TEST_HOST}:{self
-000175d0: 2e72 6664 627d 222c 2075 7365 723d 4642  .rfdb}", user=FB
-000175e0: 5445 5354 5f55 5345 522c 2070 6173 7377  TEST_USER, passw
-000175f0: 6f72 643d 4642 5445 5354 5f50 4153 5357  ord=FBTEST_PASSW
-00017600: 4f52 4429 2061 7320 636f 6e3a 0a20 2020  ORD) as con:.   
-00017610: 2020 2020 2020 2020 2063 6f6e 2e5f 6c6f           con._lo
-00017620: 6767 696e 675f 6964 5f20 3d20 7365 6c66  gging_id_ = self
-00017630: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00017640: 655f 5f0a 2020 2020 2020 2020 2020 2020  e__.            
-00017650: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00017660: 2863 6f6e 2e69 6e66 6f2e 7377 6565 705f  (con.info.sweep_
-00017670: 696e 7465 7276 616c 2c20 3130 3030 3029  interval, 10000)
-00017680: 0a20 2020 2064 6566 2074 6573 745f 7368  .    def test_sh
-00017690: 7574 646f 776e 5f62 7269 6e67 5f6f 6e6c  utdown_bring_onl
-000176a0: 696e 6528 7365 6c66 293a 0a20 2020 2020  ine(self):.     
-000176b0: 2020 2023 7365 6c66 2e73 6b69 7054 6573     #self.skipTes
-000176c0: 7428 274e 6f74 2069 6d70 6c65 6d65 6e74  t('Not implement
-000176d0: 6564 2079 6574 2729 0a20 2020 2020 2020  ed yet').       
-000176e0: 2023 2053 6875 7464 6f77 6e20 6461 7461   # Shutdown data
-000176f0: 6261 7365 2074 6f20 7369 6e67 6c65 2d75  base to single-u
-00017700: 7365 7220 6d61 696e 7465 6e61 6e63 6520  ser maintenance 
-00017710: 6d6f 6465 0a20 2020 2020 2020 2073 656c  mode.        sel
-00017720: 662e 7376 632e 6461 7461 6261 7365 2e73  f.svc.database.s
-00017730: 6875 7464 6f77 6e28 6461 7461 6261 7365  hutdown(database
-00017740: 3d73 656c 662e 7266 6462 2c6d 6f64 653d  =self.rfdb,mode=
-00017750: 5368 7574 646f 776e 4d6f 6465 2e53 494e  ShutdownMode.SIN
-00017760: 474c 452c 0a20 2020 2020 2020 2020 2020  GLE,.           
-00017770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017780: 2020 2020 2020 2020 6d65 7468 6f64 3d53          method=S
-00017790: 6875 7464 6f77 6e4d 6574 686f 642e 464f  hutdownMethod.FO
-000177a0: 5243 4544 2c20 7469 6d65 6f75 743d 3029  RCED, timeout=0)
-000177b0: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
-000177c0: 632e 6461 7461 6261 7365 2e67 6574 5f73  c.database.get_s
-000177d0: 7461 7469 7374 6963 7328 6461 7461 6261  tatistics(databa
-000177e0: 7365 3d73 656c 662e 7266 6462 2c20 666c  se=self.rfdb, fl
-000177f0: 6167 733d 5372 7653 7461 7446 6c61 672e  ags=SrvStatFlag.
-00017800: 4844 525f 5041 4745 5329 0a20 2020 2020  HDR_PAGES).     
-00017810: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-00017820: 2827 7369 6e67 6c65 2d75 7365 7220 6d61  ('single-user ma
-00017830: 696e 7465 6e61 6e63 6527 2c20 2727 2e6a  intenance', ''.j
-00017840: 6f69 6e28 7365 6c66 2e73 7663 2e72 6561  oin(self.svc.rea
-00017850: 646c 696e 6573 2829 2929 0a20 2020 2020  dlines())).     
-00017860: 2020 2023 2045 6e61 626c 6520 6d75 6c74     # Enable mult
-00017870: 692d 7573 6572 206d 6169 6e74 656e 616e  i-user maintenan
-00017880: 6365 0a20 2020 2020 2020 2073 656c 662e  ce.        self.
-00017890: 7376 632e 6461 7461 6261 7365 2e62 7269  svc.database.bri
-000178a0: 6e67 5f6f 6e6c 696e 6528 6461 7461 6261  ng_online(databa
-000178b0: 7365 3d73 656c 662e 7266 6462 2c20 6d6f  se=self.rfdb, mo
-000178c0: 6465 3d4f 6e6c 696e 654d 6f64 652e 4d55  de=OnlineMode.MU
-000178d0: 4c54 4929 0a20 2020 2020 2020 2073 656c  LTI).        sel
-000178e0: 662e 7376 632e 6461 7461 6261 7365 2e67  f.svc.database.g
-000178f0: 6574 5f73 7461 7469 7374 6963 7328 6461  et_statistics(da
-00017900: 7461 6261 7365 3d73 656c 662e 7266 6462  tabase=self.rfdb
-00017910: 2c20 666c 6167 733d 5372 7653 7461 7446  , flags=SrvStatF
-00017920: 6c61 672e 4844 525f 5041 4745 5329 0a20  lag.HDR_PAGES). 
-00017930: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00017940: 7274 496e 2827 6d75 6c74 692d 7573 6572  rtIn('multi-user
-00017950: 206d 6169 6e74 656e 616e 6365 272c 2027   maintenance', '
-00017960: 272e 6a6f 696e 2873 656c 662e 7376 632e  '.join(self.svc.
-00017970: 7265 6164 6c69 6e65 7328 2929 290a 2020  readlines())).  
-00017980: 2020 2020 2020 2320 476f 2074 6f20 6675        # Go to fu
-00017990: 6c6c 2073 6875 7464 6f77 6e20 6d6f 6465  ll shutdown mode
-000179a0: 2c20 6469 7361 626c 696e 6720 6e65 7720  , disabling new 
-000179b0: 6174 7461 6368 6d65 6e74 7320 6475 7269  attachments duri
-000179c0: 6e67 2035 2073 6563 6f6e 6473 0a20 2020  ng 5 seconds.   
-000179d0: 2020 2020 2073 656c 662e 7376 632e 6461       self.svc.da
-000179e0: 7461 6261 7365 2e73 6875 7464 6f77 6e28  tabase.shutdown(
-000179f0: 6461 7461 6261 7365 3d73 656c 662e 7266  database=self.rf
-00017a00: 6462 2c20 6d6f 6465 3d53 6875 7464 6f77  db, mode=Shutdow
-00017a10: 6e4d 6f64 652e 4655 4c4c 2c0a 2020 2020  nMode.FULL,.    
-00017a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a30: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00017a40: 6574 686f 643d 5368 7574 646f 776e 4d65  ethod=ShutdownMe
-00017a50: 7468 6f64 2e44 454e 595f 4154 5441 4348  thod.DENY_ATTACH
-00017a60: 4d45 4e54 532c 2074 696d 656f 7574 3d35  MENTS, timeout=5
-00017a70: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
-00017a80: 7663 2e64 6174 6162 6173 652e 6765 745f  vc.database.get_
-00017a90: 7374 6174 6973 7469 6373 2864 6174 6162  statistics(datab
-00017aa0: 6173 653d 7365 6c66 2e72 6664 622c 2066  ase=self.rfdb, f
-00017ab0: 6c61 6773 3d53 7276 5374 6174 466c 6167  lags=SrvStatFlag
-00017ac0: 2e48 4452 5f50 4147 4553 290a 2020 2020  .HDR_PAGES).    
-00017ad0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-00017ae0: 6e28 2766 756c 6c20 7368 7574 646f 776e  n('full shutdown
-00017af0: 272c 2027 272e 6a6f 696e 2873 656c 662e  ', ''.join(self.
-00017b00: 7376 632e 7265 6164 6c69 6e65 7328 2929  svc.readlines())
-00017b10: 290a 2020 2020 2020 2020 2320 456e 6162  ).        # Enab
-00017b20: 6c65 2073 696e 676c 652d 7573 6572 206d  le single-user m
-00017b30: 6169 6e74 656e 616e 6365 0a20 2020 2020  aintenance.     
-00017b40: 2020 2073 656c 662e 7376 632e 6461 7461     self.svc.data
-00017b50: 6261 7365 2e62 7269 6e67 5f6f 6e6c 696e  base.bring_onlin
-00017b60: 6528 6461 7461 6261 7365 3d73 656c 662e  e(database=self.
-00017b70: 7266 6462 2c20 6d6f 6465 3d4f 6e6c 696e  rfdb, mode=Onlin
-00017b80: 654d 6f64 652e 5349 4e47 4c45 290a 2020  eMode.SINGLE).  
-00017b90: 2020 2020 2020 7365 6c66 2e73 7663 2e64        self.svc.d
-00017ba0: 6174 6162 6173 652e 6765 745f 7374 6174  atabase.get_stat
-00017bb0: 6973 7469 6373 2864 6174 6162 6173 653d  istics(database=
-00017bc0: 7365 6c66 2e72 6664 622c 2066 6c61 6773  self.rfdb, flags
-00017bd0: 3d53 7276 5374 6174 466c 6167 2e48 4452  =SrvStatFlag.HDR
-00017be0: 5f50 4147 4553 290a 2020 2020 2020 2020  _PAGES).        
-00017bf0: 7365 6c66 2e61 7373 6572 7449 6e28 2773  self.assertIn('s
-00017c00: 696e 676c 652d 7573 6572 206d 6169 6e74  ingle-user maint
-00017c10: 656e 616e 6365 272c 2027 272e 6a6f 696e  enance', ''.join
-00017c20: 2873 656c 662e 7376 632e 7265 6164 6c69  (self.svc.readli
-00017c30: 6e65 7328 2929 290a 2020 2020 2020 2020  nes())).        
-00017c40: 2320 5265 7475 726e 2074 6f20 6e6f 726d  # Return to norm
-00017c50: 616c 2073 7461 7465 0a20 2020 2020 2020  al state.       
-00017c60: 2073 656c 662e 7376 632e 6461 7461 6261   self.svc.databa
-00017c70: 7365 2e62 7269 6e67 5f6f 6e6c 696e 6528  se.bring_online(
-00017c80: 6461 7461 6261 7365 3d73 656c 662e 7266  database=self.rf
-00017c90: 6462 290a 2020 2020 6465 6620 7465 7374  db).    def test
-00017ca0: 5f73 6574 5f73 7061 6365 5f72 6573 6572  _set_space_reser
-00017cb0: 7661 7469 6f6e 2873 656c 6629 3a0a 2020  vation(self):.  
-00017cc0: 2020 2020 2020 7769 7468 2063 6f6e 6e65        with conne
-00017cd0: 6374 2866 227b 4642 5445 5354 5f48 4f53  ct(f"{FBTEST_HOS
-00017ce0: 547d 3a7b 7365 6c66 2e72 6664 627d 222c  T}:{self.rfdb}",
-00017cf0: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
-00017d00: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
-00017d10: 5354 5f50 4153 5357 4f52 4429 2061 7320  ST_PASSWORD) as 
-00017d20: 636f 6e3a 0a20 2020 2020 2020 2020 2020  con:.           
-00017d30: 2063 6f6e 2e5f 6c6f 6767 696e 675f 6964   con._logging_id
-00017d40: 5f20 3d20 7365 6c66 2e5f 5f63 6c61 7373  _ = self.__class
-00017d50: 5f5f 2e5f 5f6e 616d 655f 5f0a 2020 2020  __.__name__.    
-00017d60: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00017d70: 6572 7445 7175 616c 2863 6f6e 2e69 6e66  ertEqual(con.inf
-00017d80: 6f2e 7370 6163 655f 7265 7365 7276 6174  o.space_reservat
-00017d90: 696f 6e2c 2044 6253 7061 6365 5265 7365  ion, DbSpaceRese
-00017da0: 7276 6174 696f 6e2e 5245 5345 5256 4529  rvation.RESERVE)
-00017db0: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
-00017dc0: 632e 6461 7461 6261 7365 2e73 6574 5f73  c.database.set_s
-00017dd0: 7061 6365 5f72 6573 6572 7661 7469 6f6e  pace_reservation
-00017de0: 2864 6174 6162 6173 653d 7365 6c66 2e72  (database=self.r
-00017df0: 6664 622c 206d 6f64 653d 4462 5370 6163  fdb, mode=DbSpac
-00017e00: 6552 6573 6572 7661 7469 6f6e 2e55 5345  eReservation.USE
-00017e10: 5f46 554c 4c29 0a20 2020 2020 2020 2077  _FULL).        w
-00017e20: 6974 6820 636f 6e6e 6563 7428 6622 7b46  ith connect(f"{F
-00017e30: 4254 4553 545f 484f 5354 7d3a 7b73 656c  BTEST_HOST}:{sel
-00017e40: 662e 7266 6462 7d22 2c20 7573 6572 3d46  f.rfdb}", user=F
-00017e50: 4254 4553 545f 5553 4552 2c20 7061 7373  BTEST_USER, pass
-00017e60: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
-00017e70: 574f 5244 2920 6173 2063 6f6e 3a0a 2020  WORD) as con:.  
-00017e80: 2020 2020 2020 2020 2020 636f 6e2e 5f6c            con._l
-00017e90: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
-00017ea0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00017eb0: 6d65 5f5f 0a20 2020 2020 2020 2020 2020  me__.           
-00017ec0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00017ed0: 6c28 636f 6e2e 696e 666f 2e73 7061 6365  l(con.info.space
-00017ee0: 5f72 6573 6572 7661 7469 6f6e 2c20 4462  _reservation, Db
-00017ef0: 5370 6163 6552 6573 6572 7661 7469 6f6e  SpaceReservation
-00017f00: 2e55 5345 5f46 554c 4c29 0a20 2020 2064  .USE_FULL).    d
-00017f10: 6566 2074 6573 745f 7365 745f 7772 6974  ef test_set_writ
-00017f20: 655f 6d6f 6465 2873 656c 6629 3a0a 2020  e_mode(self):.  
-00017f30: 2020 2020 2020 7769 7468 2063 6f6e 6e65        with conne
-00017f40: 6374 2866 227b 4642 5445 5354 5f48 4f53  ct(f"{FBTEST_HOS
-00017f50: 547d 3a7b 7365 6c66 2e72 6664 627d 222c  T}:{self.rfdb}",
-00017f60: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
-00017f70: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
-00017f80: 5354 5f50 4153 5357 4f52 4429 2061 7320  ST_PASSWORD) as 
-00017f90: 636f 6e3a 0a20 2020 2020 2020 2020 2020  con:.           
-00017fa0: 2063 6f6e 2e5f 6c6f 6767 696e 675f 6964   con._logging_id
-00017fb0: 5f20 3d20 7365 6c66 2e5f 5f63 6c61 7373  _ = self.__class
-00017fc0: 5f5f 2e5f 5f6e 616d 655f 5f0a 2020 2020  __.__name__.    
-00017fd0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00017fe0: 6572 7445 7175 616c 2863 6f6e 2e69 6e66  ertEqual(con.inf
-00017ff0: 6f2e 7772 6974 655f 6d6f 6465 2c20 4462  o.write_mode, Db
-00018000: 5772 6974 654d 6f64 652e 5359 4e43 290a  WriteMode.SYNC).
-00018010: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
-00018020: 2e64 6174 6162 6173 652e 7365 745f 7772  .database.set_wr
-00018030: 6974 655f 6d6f 6465 2864 6174 6162 6173  ite_mode(databas
-00018040: 653d 7365 6c66 2e72 6664 622c 206d 6f64  e=self.rfdb, mod
-00018050: 653d 4462 5772 6974 654d 6f64 652e 4153  e=DbWriteMode.AS
-00018060: 594e 4329 0a20 2020 2020 2020 2077 6974  YNC).        wit
-00018070: 6820 636f 6e6e 6563 7428 6622 7b46 4254  h connect(f"{FBT
-00018080: 4553 545f 484f 5354 7d3a 7b73 656c 662e  EST_HOST}:{self.
-00018090: 7266 6462 7d22 2c20 7573 6572 3d46 4254  rfdb}", user=FBT
-000180a0: 4553 545f 5553 4552 2c20 7061 7373 776f  EST_USER, passwo
-000180b0: 7264 3d46 4254 4553 545f 5041 5353 574f  rd=FBTEST_PASSWO
-000180c0: 5244 2920 6173 2063 6f6e 3a0a 2020 2020  RD) as con:.    
-000180d0: 2020 2020 2020 2020 636f 6e2e 5f6c 6f67          con._log
-000180e0: 6769 6e67 5f69 645f 203d 2073 656c 662e  ging_id_ = self.
-000180f0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00018100: 5f5f 0a20 2020 2020 2020 2020 2020 2073  __.            s
-00018110: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00018120: 636f 6e2e 696e 666f 2e77 7269 7465 5f6d  con.info.write_m
-00018130: 6f64 652c 2044 6257 7269 7465 4d6f 6465  ode, DbWriteMode
-00018140: 2e41 5359 4e43 290a 2020 2020 6465 6620  .ASYNC).    def 
-00018150: 7465 7374 5f73 6574 5f61 6363 6573 735f  test_set_access_
-00018160: 6d6f 6465 2873 656c 6629 3a0a 2020 2020  mode(self):.    
-00018170: 2020 2020 7769 7468 2063 6f6e 6e65 6374      with connect
-00018180: 2866 227b 4642 5445 5354 5f48 4f53 547d  (f"{FBTEST_HOST}
-00018190: 3a7b 7365 6c66 2e72 6664 627d 222c 2075  :{self.rfdb}", u
-000181a0: 7365 723d 4642 5445 5354 5f55 5345 522c  ser=FBTEST_USER,
-000181b0: 2070 6173 7377 6f72 643d 4642 5445 5354   password=FBTEST
-000181c0: 5f50 4153 5357 4f52 4429 2061 7320 636f  _PASSWORD) as co
-000181d0: 6e3a 0a20 2020 2020 2020 2020 2020 2063  n:.            c
-000181e0: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
-000181f0: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
-00018200: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
-00018210: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00018220: 7445 7175 616c 2863 6f6e 2e69 6e66 6f2e  tEqual(con.info.
-00018230: 6163 6365 7373 5f6d 6f64 652c 2044 6241  access_mode, DbA
-00018240: 6363 6573 734d 6f64 652e 5245 4144 5f57  ccessMode.READ_W
-00018250: 5249 5445 290a 2020 2020 2020 2020 7365  RITE).        se
-00018260: 6c66 2e73 7663 2e64 6174 6162 6173 652e  lf.svc.database.
-00018270: 7365 745f 6163 6365 7373 5f6d 6f64 6528  set_access_mode(
-00018280: 6461 7461 6261 7365 3d73 656c 662e 7266  database=self.rf
-00018290: 6462 2c20 6d6f 6465 3d44 6241 6363 6573  db, mode=DbAcces
-000182a0: 734d 6f64 652e 5245 4144 5f4f 4e4c 5929  sMode.READ_ONLY)
-000182b0: 0a20 2020 2020 2020 2077 6974 6820 636f  .        with co
-000182c0: 6e6e 6563 7428 6622 7b46 4254 4553 545f  nnect(f"{FBTEST_
-000182d0: 484f 5354 7d3a 7b73 656c 662e 7266 6462  HOST}:{self.rfdb
-000182e0: 7d22 2c20 7573 6572 3d46 4254 4553 545f  }", user=FBTEST_
-000182f0: 5553 4552 2c20 7061 7373 776f 7264 3d46  USER, password=F
-00018300: 4254 4553 545f 5041 5353 574f 5244 2920  BTEST_PASSWORD) 
-00018310: 6173 2063 6f6e 3a0a 2020 2020 2020 2020  as con:.        
-00018320: 2020 2020 636f 6e2e 5f6c 6f67 6769 6e67      con._logging
-00018330: 5f69 645f 203d 2073 656c 662e 5f5f 636c  _id_ = self.__cl
-00018340: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20  ass__.__name__. 
-00018350: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00018360: 6173 7365 7274 4571 7561 6c28 636f 6e2e  assertEqual(con.
-00018370: 696e 666f 2e61 6363 6573 735f 6d6f 6465  info.access_mode
-00018380: 2c20 4462 4163 6365 7373 4d6f 6465 2e52  , DbAccessMode.R
-00018390: 4541 445f 4f4e 4c59 290a 2020 2020 6465  EAD_ONLY).    de
-000183a0: 6620 7465 7374 5f73 6574 5f73 716c 5f64  f test_set_sql_d
-000183b0: 6961 6c65 6374 2873 656c 6629 3a0a 2020  ialect(self):.  
-000183c0: 2020 2020 2020 7769 7468 2063 6f6e 6e65        with conne
-000183d0: 6374 2866 227b 4642 5445 5354 5f48 4f53  ct(f"{FBTEST_HOS
-000183e0: 547d 3a7b 7365 6c66 2e72 6664 627d 222c  T}:{self.rfdb}",
-000183f0: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
-00018400: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
-00018410: 5354 5f50 4153 5357 4f52 4429 2061 7320  ST_PASSWORD) as 
-00018420: 636f 6e3a 0a20 2020 2020 2020 2020 2020  con:.           
-00018430: 2063 6f6e 2e5f 6c6f 6767 696e 675f 6964   con._logging_id
-00018440: 5f20 3d20 7365 6c66 2e5f 5f63 6c61 7373  _ = self.__class
-00018450: 5f5f 2e5f 5f6e 616d 655f 5f0a 2020 2020  __.__name__.    
-00018460: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00018470: 6572 7445 7175 616c 2863 6f6e 2e69 6e66  ertEqual(con.inf
-00018480: 6f2e 7371 6c5f 6469 616c 6563 742c 2033  o.sql_dialect, 3
-00018490: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
-000184a0: 7663 2e64 6174 6162 6173 652e 7365 745f  vc.database.set_
-000184b0: 7371 6c5f 6469 616c 6563 7428 6461 7461  sql_dialect(data
-000184c0: 6261 7365 3d73 656c 662e 7266 6462 2c20  base=self.rfdb, 
-000184d0: 6469 616c 6563 743d 3129 0a20 2020 2020  dialect=1).     
-000184e0: 2020 2077 6974 6820 636f 6e6e 6563 7428     with connect(
-000184f0: 6622 7b46 4254 4553 545f 484f 5354 7d3a  f"{FBTEST_HOST}:
-00018500: 7b73 656c 662e 7266 6462 7d22 2c20 7573  {self.rfdb}", us
-00018510: 6572 3d46 4254 4553 545f 5553 4552 2c20  er=FBTEST_USER, 
-00018520: 7061 7373 776f 7264 3d46 4254 4553 545f  password=FBTEST_
-00018530: 5041 5353 574f 5244 2920 6173 2063 6f6e  PASSWORD) as con
-00018540: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00018550: 6e2e 5f6c 6f67 6769 6e67 5f69 645f 203d  n._logging_id_ =
-00018560: 2073 656c 662e 5f5f 636c 6173 735f 5f2e   self.__class__.
-00018570: 5f5f 6e61 6d65 5f5f 0a20 2020 2020 2020  __name__.       
-00018580: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00018590: 4571 7561 6c28 636f 6e2e 696e 666f 2e73  Equal(con.info.s
-000185a0: 716c 5f64 6961 6c65 6374 2c20 3129 0a20  ql_dialect, 1). 
-000185b0: 2020 2064 6566 2074 6573 745f 6163 7469     def test_acti
-000185c0: 7661 7465 5f73 6861 646f 7728 7365 6c66  vate_shadow(self
-000185d0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-000185e0: 7376 632e 6461 7461 6261 7365 2e61 6374  svc.database.act
-000185f0: 6976 6174 655f 7368 6164 6f77 2864 6174  ivate_shadow(dat
-00018600: 6162 6173 653d 7365 6c66 2e72 6664 6229  abase=self.rfdb)
-00018610: 0a20 2020 2064 6566 2074 6573 745f 6e6f  .    def test_no
-00018620: 5f6c 696e 6765 7228 7365 6c66 293a 0a20  _linger(self):. 
-00018630: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
-00018640: 6461 7461 6261 7365 2e6e 6f5f 6c69 6e67  database.no_ling
-00018650: 6572 2864 6174 6162 6173 653d 7365 6c66  er(database=self
-00018660: 2e72 6664 6229 0a20 2020 2064 6566 2074  .rfdb).    def t
-00018670: 6573 745f 7377 6565 7028 7365 6c66 293a  est_sweep(self):
-00018680: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
-00018690: 632e 6461 7461 6261 7365 2e73 7765 6570  c.database.sweep
-000186a0: 2864 6174 6162 6173 653d 7365 6c66 2e72  (database=self.r
-000186b0: 6664 6229 0a20 2020 2064 6566 2074 6573  fdb).    def tes
-000186c0: 745f 7265 7061 6972 2873 656c 6629 3a0a  t_repair(self):.
-000186d0: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
-000186e0: 2e64 6174 6162 6173 652e 7265 7061 6972  .database.repair
-000186f0: 2864 6174 6162 6173 653d 7365 6c66 2e72  (database=self.r
-00018700: 6664 622c 2066 6c61 6773 3d53 7276 5265  fdb, flags=SrvRe
-00018710: 7061 6972 466c 6167 2e43 4f52 5255 5054  pairFlag.CORRUPT
-00018720: 494f 4e5f 4348 4543 4b29 0a20 2020 2020  ION_CHECK).     
-00018730: 2020 2073 656c 662e 7376 632e 6461 7461     self.svc.data
-00018740: 6261 7365 2e72 6570 6169 7228 6461 7461  base.repair(data
-00018750: 6261 7365 3d73 656c 662e 7266 6462 2c20  base=self.rfdb, 
-00018760: 666c 6167 733d 5372 7652 6570 6169 7246  flags=SrvRepairF
-00018770: 6c61 672e 5245 5041 4952 290a 2020 2020  lag.REPAIR).    
-00018780: 6465 6620 7465 7374 5f76 616c 6964 6174  def test_validat
-00018790: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-000187a0: 2064 6566 2066 6574 6368 6c69 6e65 286c   def fetchline(l
-000187b0: 696e 6529 3a0a 2020 2020 2020 2020 2020  ine):.          
-000187c0: 2020 6f75 7470 7574 2e61 7070 656e 6428    output.append(
-000187d0: 6c69 6e65 290a 0a20 2020 2020 2020 206f  line)..        o
-000187e0: 7574 7075 7420 3d20 5b5d 0a20 2020 2020  utput = [].     
-000187f0: 2020 2073 656c 662e 7376 632e 6461 7461     self.svc.data
-00018800: 6261 7365 2e76 616c 6964 6174 6528 6461  base.validate(da
-00018810: 7461 6261 7365 3d73 656c 662e 6462 6669  tabase=self.dbfi
-00018820: 6c65 290a 2020 2020 2020 2020 2320 6665  le).        # fe
-00018830: 7463 6820 6d61 7465 7269 616c 697a 6564  tch materialized
-00018840: 0a20 2020 2020 2020 2072 6570 6f72 7420  .        report 
-00018850: 3d20 7365 6c66 2e73 7663 2e72 6561 646c  = self.svc.readl
-00018860: 696e 6573 2829 0a20 2020 2020 2020 2073  ines().        s
-00018870: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
-00018880: 7365 6c66 2e73 7663 2e69 735f 7275 6e6e  self.svc.is_runn
-00018890: 696e 6728 2929 0a20 2020 2020 2020 2073  ing()).        s
-000188a0: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
-000188b0: 616e 6365 2872 6570 6f72 742c 2074 7970  ance(report, typ
-000188c0: 6528 6c69 7374 2829 2929 0a20 2020 2020  e(list())).     
-000188d0: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-000188e0: 2827 5661 6c69 6461 7469 6f6e 2073 7461  ('Validation sta
-000188f0: 7274 6564 272c 2027 2f6e 272e 6a6f 696e  rted', '/n'.join
-00018900: 2872 6570 6f72 7429 290a 2020 2020 2020  (report)).      
-00018910: 2020 7365 6c66 2e61 7373 6572 7449 6e28    self.assertIn(
-00018920: 2756 616c 6964 6174 696f 6e20 6669 6e69  'Validation fini
-00018930: 7368 6564 272c 2027 2f6e 272e 6a6f 696e  shed', '/n'.join
-00018940: 2872 6570 6f72 7429 290a 2020 2020 2020  (report)).      
-00018950: 2020 2320 6974 6572 6174 6520 6f76 6572    # iterate over
-00018960: 2072 6573 756c 740a 2020 2020 2020 2020   result.        
-00018970: 7365 6c66 2e73 7663 2e64 6174 6162 6173  self.svc.databas
-00018980: 652e 7661 6c69 6461 7465 2864 6174 6162  e.validate(datab
-00018990: 6173 653d 7365 6c66 2e64 6266 696c 6529  ase=self.dbfile)
-000189a0: 0a20 2020 2020 2020 2066 6f72 206c 696e  .        for lin
-000189b0: 6520 696e 2073 656c 662e 7376 633a 0a20  e in self.svc:. 
-000189c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000189d0: 6173 7365 7274 4973 4e6f 744e 6f6e 6528  assertIsNotNone(
-000189e0: 6c69 6e65 290a 2020 2020 2020 2020 2020  line).          
-000189f0: 2020 7365 6c66 2e61 7373 6572 7449 7349    self.assertIsI
-00018a00: 6e73 7461 6e63 6528 6c69 6e65 2c20 7374  nstance(line, st
-00018a10: 7229 0a20 2020 2020 2020 2023 2063 616c  r).        # cal
-00018a20: 6c62 6163 6b0a 2020 2020 2020 2020 6f75  lback.        ou
-00018a30: 7470 7574 203d 205b 5d0a 2020 2020 2020  tput = [].      
-00018a40: 2020 7365 6c66 2e73 7663 2e64 6174 6162    self.svc.datab
-00018a50: 6173 652e 7661 6c69 6461 7465 2864 6174  ase.validate(dat
-00018a60: 6162 6173 653d 7365 6c66 2e64 6266 696c  abase=self.dbfil
-00018a70: 652c 2063 616c 6c62 6163 6b3d 6665 7463  e, callback=fetc
-00018a80: 686c 696e 6529 0a20 2020 2020 2020 2073  hline).        s
-00018a90: 656c 662e 6173 7365 7274 4772 6561 7465  elf.assertGreate
-00018aa0: 7228 6c65 6e28 6f75 7470 7574 292c 2030  r(len(output), 0
-00018ab0: 290a 2020 2020 2020 2020 2320 5061 7261  ).        # Para
-00018ac0: 6d65 7465 7273 0a20 2020 2020 2020 2073  meters.        s
-00018ad0: 656c 662e 7376 632e 6461 7461 6261 7365  elf.svc.database
-00018ae0: 2e76 616c 6964 6174 6528 6461 7461 6261  .validate(databa
-00018af0: 7365 3d73 656c 662e 6462 6669 6c65 2c20  se=self.dbfile, 
-00018b00: 696e 636c 7564 655f 7461 626c 653d 2743  include_table='C
-00018b10: 4f55 4e54 5259 7c53 414c 4553 272c 0a20  OUNTRY|SALES',. 
-00018b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b30: 2020 2020 2020 2020 2069 6e63 6c75 6465           include
-00018b40: 5f69 6e64 6578 3d27 5341 4c45 5354 4154  _index='SALESTAT
-00018b50: 5827 2c20 6c6f 636b 5f74 696d 656f 7574  X', lock_timeout
-00018b60: 3d2d 3129 0a20 2020 2020 2020 2072 6570  =-1).        rep
-00018b70: 6f72 7420 3d20 272f 6e27 2e6a 6f69 6e28  ort = '/n'.join(
-00018b80: 7365 6c66 2e73 7663 2e72 6561 646c 696e  self.svc.readlin
-00018b90: 6573 2829 290a 2020 2020 2020 2020 7365  es()).        se
-00018ba0: 6c66 2e61 7373 6572 744e 6f74 496e 2827  lf.assertNotIn('
-00018bb0: 284a 4f42 2927 2c20 7265 706f 7274 290a  (JOB)', report).
-00018bc0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00018bd0: 6572 7449 6e28 2728 434f 554e 5452 5929  ertIn('(COUNTRY)
-00018be0: 272c 2072 6570 6f72 7429 0a20 2020 2020  ', report).     
-00018bf0: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-00018c00: 2827 2853 414c 4553 2927 2c20 7265 706f  ('(SALES)', repo
-00018c10: 7274 290a 2020 2020 2020 2020 6966 2073  rt).        if s
-00018c20: 656c 662e 7665 7273 696f 6e20 213d 2046  elf.version != F
-00018c30: 4234 303a 0a20 2020 2020 2020 2020 2020  B40:.           
-00018c40: 2073 656c 662e 6173 7365 7274 496e 2827   self.assertIn('
-00018c50: 2853 414c 4553 5441 5458 2927 2c20 7265  (SALESTATX)', re
-00018c60: 706f 7274 290a 0a63 6c61 7373 2054 6573  port)..class Tes
-00018c70: 7445 7665 6e74 7328 4472 6976 6572 5465  tEvents(DriverTe
-00018c80: 7374 4261 7365 293a 0a20 2020 2064 6566  stBase):.    def
-00018c90: 2073 6574 5570 2873 656c 6629 3a0a 2020   setUp(self):.  
-00018ca0: 2020 2020 2020 7375 7065 7228 292e 7365        super().se
-00018cb0: 7455 7028 290a 2020 2020 2020 2020 7365  tUp().        se
-00018cc0: 6c66 2e64 6266 696c 6520 3d20 6f73 2e70  lf.dbfile = os.p
-00018cd0: 6174 682e 6a6f 696e 2873 656c 662e 6462  ath.join(self.db
-00018ce0: 7061 7468 2c20 2766 6265 7665 6e74 732e  path, 'fbevents.
-00018cf0: 6664 6227 290a 2020 2020 2020 2020 6966  fdb').        if
-00018d00: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
-00018d10: 7365 6c66 2e64 6266 696c 6529 3a0a 2020  self.dbfile):.  
-00018d20: 2020 2020 2020 2020 2020 6f73 2e72 656d            os.rem
-00018d30: 6f76 6528 7365 6c66 2e64 6266 696c 6529  ove(self.dbfile)
-00018d40: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-00018d50: 6e20 3d20 6372 6561 7465 5f64 6174 6162  n = create_datab
-00018d60: 6173 6528 7365 6c66 2e64 6266 696c 652c  ase(self.dbfile,
-00018d70: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
-00018d80: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
-00018d90: 5354 5f50 4153 5357 4f52 4429 0a20 2020  ST_PASSWORD).   
-00018da0: 2020 2020 2077 6974 6820 7365 6c66 2e63       with self.c
-00018db0: 6f6e 2e63 7572 736f 7228 2920 6173 2063  on.cursor() as c
-00018dc0: 7572 3a0a 2020 2020 2020 2020 2020 2020  ur:.            
-00018dd0: 6375 722e 6578 6563 7574 6528 2243 5245  cur.execute("CRE
-00018de0: 4154 4520 5441 424c 4520 5420 2850 4b20  ATE TABLE T (PK 
-00018df0: 496e 7465 6765 722c 2043 3120 496e 7465  Integer, C1 Inte
-00018e00: 6765 7229 2229 0a20 2020 2020 2020 2020  ger)").         
-00018e10: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
-00018e20: 2222 4352 4541 5445 2054 5249 4747 4552  ""CREATE TRIGGER
-00018e30: 2045 5645 4e54 535f 4155 2046 4f52 2054   EVENTS_AU FOR T
-00018e40: 2041 4354 4956 450a 2020 2020 4245 464f   ACTIVE.    BEFO
-00018e50: 5245 2055 5044 4154 4520 504f 5349 5449  RE UPDATE POSITI
-00018e60: 4f4e 2030 0a20 2020 2041 530a 2020 2020  ON 0.    AS.    
-00018e70: 4245 4749 4e0a 2020 2020 2020 2020 6966  BEGIN.        if
-00018e80: 2028 6f6c 642e 4331 203c 3e20 6e65 772e   (old.C1 <> new.
-00018e90: 4331 2920 7468 656e 0a20 2020 2020 2020  C1) then.       
-00018ea0: 2020 2020 2070 6f73 745f 6576 656e 7420       post_event 
-00018eb0: 2763 315f 7570 6461 7465 6427 203b 0a20  'c1_updated' ;. 
-00018ec0: 2020 2045 4e44 2222 2229 0a20 2020 2020     END""").     
-00018ed0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
-00018ee0: 7465 2822 2222 4352 4541 5445 2054 5249  te("""CREATE TRI
-00018ef0: 4747 4552 2045 5645 4e54 535f 4149 2046  GGER EVENTS_AI F
-00018f00: 4f52 2054 2041 4354 4956 450a 2020 2020  OR T ACTIVE.    
-00018f10: 4146 5445 5220 494e 5345 5254 2050 4f53  AFTER INSERT POS
-00018f20: 4954 494f 4e20 300a 2020 2020 4153 0a20  ITION 0.    AS. 
-00018f30: 2020 2042 4547 494e 0a20 2020 2020 2020     BEGIN.       
-00018f40: 2069 6620 286e 6577 2e63 3120 3d20 3129   if (new.c1 = 1)
-00018f50: 2074 6865 6e0a 2020 2020 2020 2020 2020   then.          
-00018f60: 2020 706f 7374 5f65 7665 6e74 2027 696e    post_event 'in
-00018f70: 7365 7274 5f31 2720 3b0a 2020 2020 2020  sert_1' ;.      
-00018f80: 2020 656c 7365 2069 6620 286e 6577 2e63    else if (new.c
-00018f90: 3120 3d20 3229 2074 6865 6e0a 2020 2020  1 = 2) then.    
-00018fa0: 2020 2020 2020 2020 706f 7374 5f65 7665          post_eve
-00018fb0: 6e74 2027 696e 7365 7274 5f32 2720 3b0a  nt 'insert_2' ;.
-00018fc0: 2020 2020 2020 2020 656c 7365 2069 6620          else if 
-00018fd0: 286e 6577 2e63 3120 3d20 3329 2074 6865  (new.c1 = 3) the
-00018fe0: 6e0a 2020 2020 2020 2020 2020 2020 706f  n.            po
-00018ff0: 7374 5f65 7665 6e74 2027 696e 7365 7274  st_event 'insert
-00019000: 5f33 2720 3b0a 2020 2020 2020 2020 656c  _3' ;.        el
-00019010: 7365 0a20 2020 2020 2020 2020 2020 2070  se.            p
-00019020: 6f73 745f 6576 656e 7420 2769 6e73 6572  ost_event 'inser
-00019030: 745f 6f74 6865 7227 203b 0a20 2020 2045  t_other' ;.    E
-00019040: 4e44 2222 2229 0a20 2020 2020 2020 2020  ND""").         
-00019050: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
-00019060: 6974 2829 0a20 2020 2064 6566 2074 6561  it().    def tea
-00019070: 7244 6f77 6e28 7365 6c66 293a 0a20 2020  rDown(self):.   
-00019080: 2020 2020 2073 656c 662e 636f 6e2e 6472       self.con.dr
-00019090: 6f70 5f64 6174 6162 6173 6528 290a 2020  op_database().  
-000190a0: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
-000190b0: 6c6f 7365 2829 0a20 2020 2064 6566 2074  lose().    def t
-000190c0: 6573 745f 6f6e 655f 6576 656e 7428 7365  est_one_event(se
-000190d0: 6c66 293a 0a20 2020 2020 2020 2064 6566  lf):.        def
-000190e0: 2073 656e 645f 6576 656e 7473 2863 6f6d   send_events(com
-000190f0: 6d61 6e64 5f6c 6973 7429 3a0a 2020 2020  mand_list):.    
-00019100: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-00019110: 662e 636f 6e2e 6375 7273 6f72 2829 2061  f.con.cursor() a
-00019120: 7320 6375 723a 0a20 2020 2020 2020 2020  s cur:.         
-00019130: 2020 2020 2020 2066 6f72 2063 6d64 2069         for cmd i
-00019140: 6e20 636f 6d6d 616e 645f 6c69 7374 3a0a  n command_list:.
-00019150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019160: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
-00019170: 636d 6429 0a20 2020 2020 2020 2020 2020  cmd).           
-00019180: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
-00019190: 6d6d 6974 2829 0a0a 2020 2020 2020 2020  mmit()..        
-000191a0: 6520 3d20 7b7d 0a20 2020 2020 2020 2074  e = {}.        t
-000191b0: 696d 6564 5f65 7665 6e74 203d 2074 6872  imed_event = thr
-000191c0: 6561 6469 6e67 2e54 696d 6572 2833 2e30  eading.Timer(3.0
-000191d0: 2c20 7365 6e64 5f65 7665 6e74 732c 2061  , send_events, a
-000191e0: 7267 733d 5b5b 2269 6e73 6572 7420 696e  rgs=[["insert in
-000191f0: 746f 2054 2028 504b 2c43 3129 2076 616c  to T (PK,C1) val
-00019200: 7565 7320 2831 2c31 2922 2c5d 5d29 0a20  ues (1,1)",]]). 
-00019210: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
-00019220: 2e63 6f6e 2e65 7665 6e74 5f63 6f6c 6c65  .con.event_colle
-00019230: 6374 6f72 285b 2769 6e73 6572 745f 3127  ctor(['insert_1'
-00019240: 5d29 2061 7320 6576 656e 7473 3a0a 2020  ]) as events:.  
-00019250: 2020 2020 2020 2020 2020 7469 6d65 645f            timed_
-00019260: 6576 656e 742e 7374 6172 7428 290a 2020  event.start().  
-00019270: 2020 2020 2020 2020 2020 6520 3d20 6576            e = ev
-00019280: 656e 7473 2e77 6169 7428 290a 2020 2020  ents.wait().    
-00019290: 2020 2020 7469 6d65 645f 6576 656e 742e      timed_event.
-000192a0: 6a6f 696e 2829 0a20 2020 2020 2020 2073  join().        s
-000192b0: 656c 662e 6173 7365 7274 4469 6374 4571  elf.assertDictEq
-000192c0: 7561 6c28 652c 207b 2769 6e73 6572 745f  ual(e, {'insert_
-000192d0: 3127 3a20 317d 290a 2020 2020 6465 6620  1': 1}).    def 
-000192e0: 7465 7374 5f6d 756c 7469 706c 655f 6576  test_multiple_ev
-000192f0: 656e 7473 2873 656c 6629 3a0a 2020 2020  ents(self):.    
-00019300: 2020 2020 6465 6620 7365 6e64 5f65 7665      def send_eve
-00019310: 6e74 7328 636f 6d6d 616e 645f 6c69 7374  nts(command_list
-00019320: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-00019330: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-00019340: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-00019350: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00019360: 7220 636d 6420 696e 2063 6f6d 6d61 6e64  r cmd in command
-00019370: 5f6c 6973 743a 0a20 2020 2020 2020 2020  _list:.         
-00019380: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-00019390: 7865 6375 7465 2863 6d64 290a 2020 2020  xecute(cmd).    
-000193a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000193b0: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 0a20  .con.commit().. 
-000193c0: 2020 2020 2020 2063 6d64 7320 3d20 5b22         cmds = ["
-000193d0: 696e 7365 7274 2069 6e74 6f20 5420 2850  insert into T (P
-000193e0: 4b2c 4331 2920 7661 6c75 6573 2028 312c  K,C1) values (1,
-000193f0: 3129 222c 0a20 2020 2020 2020 2020 2020  1)",.           
-00019400: 2020 2020 2022 696e 7365 7274 2069 6e74       "insert int
-00019410: 6f20 5420 2850 4b2c 4331 2920 7661 6c75  o T (PK,C1) valu
-00019420: 6573 2028 312c 3229 222c 0a20 2020 2020  es (1,2)",.     
-00019430: 2020 2020 2020 2020 2020 2022 696e 7365             "inse
-00019440: 7274 2069 6e74 6f20 5420 2850 4b2c 4331  rt into T (PK,C1
-00019450: 2920 7661 6c75 6573 2028 312c 3329 222c  ) values (1,3)",
-00019460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019470: 2022 696e 7365 7274 2069 6e74 6f20 5420   "insert into T 
-00019480: 2850 4b2c 4331 2920 7661 6c75 6573 2028  (PK,C1) values (
-00019490: 312c 3129 222c 0a20 2020 2020 2020 2020  1,1)",.         
-000194a0: 2020 2020 2020 2022 696e 7365 7274 2069         "insert i
-000194b0: 6e74 6f20 5420 2850 4b2c 4331 2920 7661  nto T (PK,C1) va
-000194c0: 6c75 6573 2028 312c 3229 222c 5d0a 2020  lues (1,2)",].  
-000194d0: 2020 2020 2020 7469 6d65 645f 6576 656e        timed_even
-000194e0: 7420 3d20 7468 7265 6164 696e 672e 5469  t = threading.Ti
-000194f0: 6d65 7228 332e 302c 2073 656e 645f 6576  mer(3.0, send_ev
-00019500: 656e 7473 2c20 6172 6773 3d5b 636d 6473  ents, args=[cmds
-00019510: 5d29 0a20 2020 2020 2020 2077 6974 6820  ]).        with 
-00019520: 7365 6c66 2e63 6f6e 2e65 7665 6e74 5f63  self.con.event_c
-00019530: 6f6c 6c65 6374 6f72 285b 2769 6e73 6572  ollector(['inser
-00019540: 745f 3127 2c20 2769 6e73 6572 745f 3327  t_1', 'insert_3'
-00019550: 5d29 2061 7320 6576 656e 7473 3a0a 2020  ]) as events:.  
-00019560: 2020 2020 2020 2020 2020 7469 6d65 645f            timed_
-00019570: 6576 656e 742e 7374 6172 7428 290a 2020  event.start().  
-00019580: 2020 2020 2020 2020 2020 6520 3d20 6576            e = ev
-00019590: 656e 7473 2e77 6169 7428 290a 2020 2020  ents.wait().    
-000195a0: 2020 2020 7469 6d65 645f 6576 656e 742e      timed_event.
-000195b0: 6a6f 696e 2829 0a20 2020 2020 2020 2073  join().        s
-000195c0: 656c 662e 6173 7365 7274 4469 6374 4571  elf.assertDictEq
-000195d0: 7561 6c28 652c 207b 2769 6e73 6572 745f  ual(e, {'insert_
-000195e0: 3327 3a20 312c 2027 696e 7365 7274 5f31  3': 1, 'insert_1
-000195f0: 273a 2032 7d29 0a20 2020 2064 6566 2074  ': 2}).    def t
-00019600: 6573 745f 3230 5f65 7665 6e74 7328 7365  est_20_events(se
-00019610: 6c66 293a 0a20 2020 2020 2020 2064 6566  lf):.        def
-00019620: 2073 656e 645f 6576 656e 7473 2863 6f6d   send_events(com
-00019630: 6d61 6e64 5f6c 6973 7429 3a0a 2020 2020  mand_list):.    
-00019640: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-00019650: 662e 636f 6e2e 6375 7273 6f72 2829 2061  f.con.cursor() a
-00019660: 7320 6375 723a 0a20 2020 2020 2020 2020  s cur:.         
-00019670: 2020 2020 2020 2066 6f72 2063 6d64 2069         for cmd i
-00019680: 6e20 636f 6d6d 616e 645f 6c69 7374 3a0a  n command_list:.
-00019690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000196a0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
-000196b0: 636d 6429 0a20 2020 2020 2020 2020 2020  cmd).           
-000196c0: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
-000196d0: 6d6d 6974 2829 0a0a 2020 2020 2020 2020  mmit()..        
-000196e0: 636d 6473 203d 205b 2269 6e73 6572 7420  cmds = ["insert 
-000196f0: 696e 746f 2054 2028 504b 2c43 3129 2076  into T (PK,C1) v
-00019700: 616c 7565 7320 2831 2c31 2922 2c0a 2020  alues (1,1)",.  
-00019710: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00019720: 6e73 6572 7420 696e 746f 2054 2028 504b  nsert into T (PK
-00019730: 2c43 3129 2076 616c 7565 7320 2831 2c32  ,C1) values (1,2
-00019740: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
-00019750: 2020 2020 2269 6e73 6572 7420 696e 746f      "insert into
-00019760: 2054 2028 504b 2c43 3129 2076 616c 7565   T (PK,C1) value
-00019770: 7320 2831 2c33 2922 2c0a 2020 2020 2020  s (1,3)",.      
-00019780: 2020 2020 2020 2020 2020 2269 6e73 6572            "inser
-00019790: 7420 696e 746f 2054 2028 504b 2c43 3129  t into T (PK,C1)
-000197a0: 2076 616c 7565 7320 2831 2c31 2922 2c0a   values (1,1)",.
-000197b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000197c0: 2269 6e73 6572 7420 696e 746f 2054 2028  "insert into T (
-000197d0: 504b 2c43 3129 2076 616c 7565 7320 2831  PK,C1) values (1
-000197e0: 2c32 2922 2c5d 0a20 2020 2020 2020 2073  ,2)",].        s
-000197f0: 656c 662e 6520 3d20 7b7d 0a20 2020 2020  elf.e = {}.     
-00019800: 2020 2074 696d 6564 5f65 7665 6e74 203d     timed_event =
-00019810: 2074 6872 6561 6469 6e67 2e54 696d 6572   threading.Timer
-00019820: 2831 2e30 2c20 7365 6e64 5f65 7665 6e74  (1.0, send_event
-00019830: 732c 2061 7267 733d 5b63 6d64 735d 290a  s, args=[cmds]).
-00019840: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-00019850: 662e 636f 6e2e 6576 656e 745f 636f 6c6c  f.con.event_coll
-00019860: 6563 746f 7228 5b27 696e 7365 7274 5f31  ector(['insert_1
-00019870: 272c 2027 4127 2c20 2742 272c 2027 4327  ', 'A', 'B', 'C'
-00019880: 2c20 2744 272c 0a20 2020 2020 2020 2020  , 'D',.         
-00019890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198a0: 2020 2020 2020 2020 2020 2020 2745 272c              'E',
-000198b0: 2027 4627 2c20 2747 272c 2027 4827 2c20   'F', 'G', 'H', 
-000198c0: 2749 272c 2027 4a27 2c20 274b 272c 2027  'I', 'J', 'K', '
-000198d0: 4c27 2c20 274d 272c 0a20 2020 2020 2020  L', 'M',.       
-000198e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198f0: 2020 2020 2020 2020 2020 2020 2020 274e                'N
-00019900: 272c 2027 4f27 2c20 2750 272c 2027 5127  ', 'O', 'P', 'Q'
-00019910: 2c20 2752 272c 2027 696e 7365 7274 5f33  , 'R', 'insert_3
-00019920: 275d 2920 6173 2065 7665 6e74 733a 0a20  ']) as events:. 
-00019930: 2020 2020 2020 2020 2020 2074 696d 6564             timed
-00019940: 5f65 7665 6e74 2e73 7461 7274 2829 0a20  _event.start(). 
-00019950: 2020 2020 2020 2020 2020 2074 696d 652e             time.
-00019960: 736c 6565 7028 3329 0a20 2020 2020 2020  sleep(3).       
-00019970: 2020 2020 2065 203d 2065 7665 6e74 732e       e = events.
-00019980: 7761 6974 2829 0a20 2020 2020 2020 2074  wait().        t
-00019990: 696d 6564 5f65 7665 6e74 2e6a 6f69 6e28  imed_event.join(
-000199a0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000199b0: 7373 6572 7444 6963 7445 7175 616c 2865  ssertDictEqual(e
-000199c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000199d0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-000199e0: 2741 273a 2030 2c20 2743 273a 2030 2c20  'A': 0, 'C': 0, 
-000199f0: 2742 273a 2030 2c20 2745 273a 2030 2c20  'B': 0, 'E': 0, 
-00019a00: 2744 273a 2030 2c20 2747 273a 2030 2c20  'D': 0, 'G': 0, 
-00019a10: 2769 6e73 6572 745f 3127 3a20 322c 0a20  'insert_1': 2,. 
-00019a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019a30: 2020 2020 2020 2020 2020 2020 2027 4927               'I'
-00019a40: 3a20 302c 2027 4827 3a20 302c 2027 4b27  : 0, 'H': 0, 'K'
-00019a50: 3a20 302c 2027 4a27 3a20 302c 2027 4d27  : 0, 'J': 0, 'M'
-00019a60: 3a20 302c 2027 4c27 3a20 302c 2027 4f27  : 0, 'L': 0, 'O'
-00019a70: 3a20 302c 2027 4e27 3a20 302c 0a20 2020  : 0, 'N': 0,.   
-00019a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019a90: 2020 2020 2020 2020 2020 2027 5127 3a20             'Q': 
-00019aa0: 302c 2027 5027 3a20 302c 2027 5227 3a20  0, 'P': 0, 'R': 
-00019ab0: 302c 2027 696e 7365 7274 5f33 273a 2031  0, 'insert_3': 1
-00019ac0: 2c20 2746 273a 2030 7d29 0a20 2020 2064  , 'F': 0}).    d
-00019ad0: 6566 2074 6573 745f 666c 7573 685f 6576  ef test_flush_ev
-00019ae0: 656e 7473 2873 656c 6629 3a0a 2020 2020  ents(self):.    
-00019af0: 2020 2020 6465 6620 7365 6e64 5f65 7665      def send_eve
-00019b00: 6e74 7328 636f 6d6d 616e 645f 6c69 7374  nts(command_list
-00019b10: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-00019b20: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-00019b30: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-00019b40: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00019b50: 7220 636d 6420 696e 2063 6f6d 6d61 6e64  r cmd in command
-00019b60: 5f6c 6973 743a 0a20 2020 2020 2020 2020  _list:.         
-00019b70: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-00019b80: 7865 6375 7465 2863 6d64 290a 2020 2020  xecute(cmd).    
-00019b90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00019ba0: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 0a20  .con.commit().. 
-00019bb0: 2020 2020 2020 2074 696d 6564 5f65 7665         timed_eve
-00019bc0: 6e74 203d 2074 6872 6561 6469 6e67 2e54  nt = threading.T
-00019bd0: 696d 6572 2833 2e30 2c20 7365 6e64 5f65  imer(3.0, send_e
-00019be0: 7665 6e74 732c 2061 7267 733d 5b5b 2269  vents, args=[["i
-00019bf0: 6e73 6572 7420 696e 746f 2054 2028 504b  nsert into T (PK
-00019c00: 2c43 3129 2076 616c 7565 7320 2831 2c31  ,C1) values (1,1
-00019c10: 2922 2c5d 5d29 0a20 2020 2020 2020 2077  )",]]).        w
-00019c20: 6974 6820 7365 6c66 2e63 6f6e 2e65 7665  ith self.con.eve
-00019c30: 6e74 5f63 6f6c 6c65 6374 6f72 285b 2769  nt_collector(['i
-00019c40: 6e73 6572 745f 3127 5d29 2061 7320 6576  nsert_1']) as ev
-00019c50: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
-00019c60: 2020 7365 6e64 5f65 7665 6e74 7328 5b22    send_events(["
-00019c70: 696e 7365 7274 2069 6e74 6f20 5420 2850  insert into T (P
-00019c80: 4b2c 4331 2920 7661 6c75 6573 2028 312c  K,C1) values (1,
-00019c90: 3129 222c 0a20 2020 2020 2020 2020 2020  1)",.           
-00019ca0: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00019cb0: 6e73 6572 7420 696e 746f 2054 2028 504b  nsert into T (PK
-00019cc0: 2c43 3129 2076 616c 7565 7320 2831 2c31  ,C1) values (1,1
-00019cd0: 2922 5d29 0a20 2020 2020 2020 2020 2020  )"]).           
-00019ce0: 2074 696d 652e 736c 6565 7028 3229 0a20   time.sleep(2). 
-00019cf0: 2020 2020 2020 2020 2020 2065 7665 6e74             event
-00019d00: 732e 666c 7573 6828 290a 2020 2020 2020  s.flush().      
-00019d10: 2020 2020 2020 7469 6d65 645f 6576 656e        timed_even
-00019d20: 742e 7374 6172 7428 290a 2020 2020 2020  t.start().      
-00019d30: 2020 2020 2020 6520 3d20 6576 656e 7473        e = events
-00019d40: 2e77 6169 7428 290a 2020 2020 2020 2020  .wait().        
-00019d50: 7469 6d65 645f 6576 656e 742e 6a6f 696e  timed_event.join
-00019d60: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-00019d70: 6173 7365 7274 4469 6374 4571 7561 6c28  assertDictEqual(
-00019d80: 652c 207b 2769 6e73 6572 745f 3127 3a20  e, {'insert_1': 
-00019d90: 317d 290a 0a63 6c61 7373 2054 6573 7453  1})..class TestS
-00019da0: 7472 6561 6d42 4c4f 4273 2844 7269 7665  treamBLOBs(Drive
-00019db0: 7254 6573 7442 6173 6529 3a0a 2020 2020  rTestBase):.    
-00019dc0: 6465 6620 7365 7455 7028 7365 6c66 293a  def setUp(self):
-00019dd0: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
-00019de0: 2e73 6574 5570 2829 0a20 2020 2020 2020  .setUp().       
-00019df0: 2073 656c 662e 6462 6669 6c65 203d 206f   self.dbfile = o
-00019e00: 732e 7061 7468 2e6a 6f69 6e28 7365 6c66  s.path.join(self
-00019e10: 2e64 6270 6174 682c 2073 656c 662e 4642  .dbpath, self.FB
-00019e20: 5445 5354 5f44 4229 0a20 2020 2020 2020  TEST_DB).       
-00019e30: 2073 656c 662e 636f 6e20 3d20 636f 6e6e   self.con = conn
-00019e40: 6563 7428 7365 6c66 2e64 6266 696c 652c  ect(self.dbfile,
-00019e50: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
-00019e60: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
-00019e70: 5354 5f50 4153 5357 4f52 4429 0a20 2020  ST_PASSWORD).   
-00019e80: 2020 2020 2073 656c 662e 636f 6e2e 5f6c       self.con._l
-00019e90: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
-00019ea0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00019eb0: 6d65 5f5f 0a20 2020 2020 2020 2023 7365  me__.        #se
-00019ec0: 6c66 2e63 6f6e 2e65 7865 6375 7465 5f69  lf.con.execute_i
-00019ed0: 6d6d 6564 6961 7465 2822 7265 6372 6561  mmediate("recrea
-00019ee0: 7465 2074 6162 6c65 2074 2028 6331 2069  te table t (c1 i
-00019ef0: 6e74 6567 6572 2922 290a 2020 2020 2020  nteger)").      
-00019f00: 2020 2373 656c 662e 636f 6e2e 636f 6d6d    #self.con.comm
-00019f10: 6974 2829 0a20 2020 2020 2020 2023 7365  it().        #se
-00019f20: 6c66 2e63 6f6e 2e65 7865 6375 7465 5f69  lf.con.execute_i
-00019f30: 6d6d 6564 6961 7465 2822 5245 4352 4541  mmediate("RECREA
-00019f40: 5445 2054 4142 4c45 2054 3220 2843 3120  TE TABLE T2 (C1 
-00019f50: 536d 616c 6c69 6e74 2c43 3220 496e 7465  Smallint,C2 Inte
-00019f60: 6765 722c 4333 2042 6967 696e 742c 4334  ger,C3 Bigint,C4
-00019f70: 2043 6861 7228 3529 2c43 3520 5661 7263   Char(5),C5 Varc
-00019f80: 6861 7228 3130 292c 4336 2044 6174 652c  har(10),C6 Date,
-00019f90: 4337 2054 696d 652c 4338 2054 696d 6573  C7 Time,C8 Times
-00019fa0: 7461 6d70 2c43 3920 426c 6f62 2073 7562  tamp,C9 Blob sub
-00019fb0: 5f74 7970 6520 312c 4331 3020 4e75 6d65  _type 1,C10 Nume
-00019fc0: 7269 6328 3138 2c32 292c 4331 3120 4465  ric(18,2),C11 De
-00019fd0: 6369 6d61 6c28 3138 2c32 292c 4331 3220  cimal(18,2),C12 
-00019fe0: 466c 6f61 742c 4331 3320 446f 7562 6c65  Float,C13 Double
-00019ff0: 2070 7265 6369 7369 6f6e 2c43 3134 204e   precision,C14 N
-0001a000: 756d 6572 6963 2838 2c34 292c 4331 3520  umeric(8,4),C15 
-0001a010: 4465 6369 6d61 6c28 382c 3429 2922 290a  Decimal(8,4))").
-0001a020: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
-0001a030: 2e65 7865 6375 7465 5f69 6d6d 6564 6961  .execute_immedia
-0001a040: 7465 2822 6465 6c65 7465 2066 726f 6d20  te("delete from 
-0001a050: 7422 290a 2020 2020 2020 2020 7365 6c66  t").        self
-0001a060: 2e63 6f6e 2e65 7865 6375 7465 5f69 6d6d  .con.execute_imm
-0001a070: 6564 6961 7465 2822 6465 6c65 7465 2066  ediate("delete f
-0001a080: 726f 6d20 7432 2229 0a20 2020 2020 2020  rom t2").       
-0001a090: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
-0001a0a0: 2829 0a20 2020 2064 6566 2074 6561 7244  ().    def tearD
-0001a0b0: 6f77 6e28 7365 6c66 293a 0a20 2020 2020  own(self):.     
-0001a0c0: 2020 2073 656c 662e 636f 6e2e 636c 6f73     self.con.clos
-0001a0d0: 6528 290a 2020 2020 6465 6620 7465 7374  e().    def test
-0001a0e0: 426c 6f62 4261 7369 6328 7365 6c66 293a  BlobBasic(self):
-0001a0f0: 0a20 2020 2020 2020 2062 6c6f 6220 3d20  .        blob = 
-0001a100: 2222 2246 6972 6562 6972 6420 7375 7070  """Firebird supp
-0001a110: 6f72 7473 2074 776f 2074 7970 6573 206f  orts two types o
-0001a120: 6620 626c 6f62 732c 2073 7472 6561 6d20  f blobs, stream 
-0001a130: 616e 6420 7365 676d 656e 7465 642e 0a54  and segmented..T
-0001a140: 6865 2064 6174 6162 6173 6520 7374 6f72  he database stor
-0001a150: 6573 2073 6567 6d65 6e74 6564 2062 6c6f  es segmented blo
-0001a160: 6273 2069 6e20 6368 756e 6b73 2e0a 4561  bs in chunks..Ea
-0001a170: 6368 2063 6875 6e6b 2073 7461 7274 7320  ch chunk starts 
-0001a180: 7769 7468 2061 2074 776f 2062 7974 6520  with a two byte 
-0001a190: 6c65 6e67 7468 2069 6e64 6963 6174 6f72  length indicator
-0001a1a0: 2066 6f6c 6c6f 7765 6420 6279 2068 6f77   followed by how
-0001a1b0: 6576 6572 206d 616e 7920 6279 7465 7320  ever many bytes 
-0001a1c0: 6f66 2064 6174 6120 7765 7265 2070 6173  of data were pas
-0001a1d0: 7365 6420 6173 2061 2073 6567 6d65 6e74  sed as a segment
-0001a1e0: 2e0a 5374 7265 616d 2062 6c6f 6273 2061  ..Stream blobs a
-0001a1f0: 7265 2073 746f 7265 6420 6173 2061 2063  re stored as a c
-0001a200: 6f6e 7469 6e75 6f75 7320 6172 7261 7920  ontinuous array 
-0001a210: 6f66 2064 6174 6120 6279 7465 7320 7769  of data bytes wi
-0001a220: 7468 206e 6f20 6c65 6e67 7468 2069 6e64  th no length ind
-0001a230: 6963 6174 6f72 7320 696e 636c 7564 6564  icators included
-0001a240: 2e22 2222 0a20 2020 2020 2020 2062 6c6f  .""".        blo
-0001a250: 625f 6c69 6e65 7320 3d20 5374 7269 6e67  b_lines = String
-0001a260: 494f 2862 6c6f 6229 2e72 6561 646c 696e  IO(blob).readlin
-0001a270: 6573 2829 0a20 2020 2020 2020 2077 6974  es().        wit
-0001a280: 6820 7365 6c66 2e63 6f6e 2e63 7572 736f  h self.con.curso
-0001a290: 7228 2920 6173 2063 7572 3a0a 2020 2020  r() as cur:.    
-0001a2a0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-0001a2b0: 7574 6528 2769 6e73 6572 7420 696e 746f  ute('insert into
-0001a2c0: 2054 3220 2843 312c 4339 2920 7661 6c75   T2 (C1,C9) valu
-0001a2d0: 6573 2028 3f2c 3f29 272c 205b 342c 2053  es (?,?)', [4, S
-0001a2e0: 7472 696e 6749 4f28 626c 6f62 295d 290a  tringIO(blob)]).
-0001a2f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001a300: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 2020  .con.commit().  
-0001a310: 2020 2020 2020 2020 2020 7020 3d20 6375            p = cu
-0001a320: 722e 7072 6570 6172 6528 2773 656c 6563  r.prepare('selec
-0001a330: 7420 4331 2c43 3920 6672 6f6d 2054 3220  t C1,C9 from T2 
-0001a340: 7768 6572 6520 4331 203d 2034 2729 0a20  where C1 = 4'). 
-0001a350: 2020 2020 2020 2020 2020 2063 7572 2e73             cur.s
-0001a360: 7472 6561 6d5f 626c 6f62 732e 6170 7065  tream_blobs.appe
-0001a370: 6e64 2827 4339 2729 0a20 2020 2020 2020  nd('C9').       
-0001a380: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0001a390: 2870 290a 2020 2020 2020 2020 2020 2020  (p).            
-0001a3a0: 726f 7720 3d20 6375 722e 6665 7463 686f  row = cur.fetcho
-0001a3b0: 6e65 2829 0a20 2020 2020 2020 2020 2020  ne().           
-0001a3c0: 2062 6c6f 625f 7265 6164 6572 203d 2072   blob_reader = r
-0001a3d0: 6f77 5b31 5d0a 2020 2020 2020 2020 2020  ow[1].          
-0001a3e0: 2020 7769 7468 2062 6c6f 625f 7265 6164    with blob_read
-0001a3f0: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
-0001a400: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-0001a410: 7349 6e73 7461 6e63 6528 626c 6f62 5f72  sInstance(blob_r
-0001a420: 6561 6465 722e 626c 6f62 5f69 642c 2066  eader.blob_id, f
-0001a430: 6261 7069 2e49 5343 5f51 5541 4429 0a20  bapi.ISC_QUAD). 
-0001a440: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001a450: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0001a460: 626c 6f62 5f72 6561 6465 722e 626c 6f62  blob_reader.blob
-0001a470: 5f74 7970 652c 2042 6c6f 6254 7970 652e  _type, BlobType.
-0001a480: 5354 5245 414d 290a 2020 2020 2020 2020  STREAM).        
-0001a490: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001a4a0: 6572 7454 7275 6528 626c 6f62 5f72 6561  ertTrue(blob_rea
-0001a4b0: 6465 722e 6973 5f74 6578 7429 0a20 2020  der.is_text).   
-0001a4c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001a4d0: 662e 6173 7365 7274 4571 7561 6c28 626c  f.assertEqual(bl
-0001a4e0: 6f62 5f72 6561 6465 722e 7265 6164 2832  ob_reader.read(2
-0001a4f0: 3029 2c20 2746 6972 6562 6972 6420 7375  0), 'Firebird su
-0001a500: 7070 6f72 7473 2074 7727 290a 2020 2020  pports tw').    
-0001a510: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001a520: 2e61 7373 6572 7445 7175 616c 2862 6c6f  .assertEqual(blo
-0001a530: 625f 7265 6164 6572 2e72 6561 6428 3230  b_reader.read(20
-0001a540: 292c 2027 6f20 7479 7065 7320 6f66 2062  ), 'o types of b
-0001a550: 6c6f 6273 2c20 7374 2729 0a20 2020 2020  lobs, st').     
-0001a560: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a570: 6173 7365 7274 4571 7561 6c28 626c 6f62  assertEqual(blob
-0001a580: 5f72 6561 6465 722e 7265 6164 2834 3030  _reader.read(400
-0001a590: 292c 2027 7265 616d 2061 6e64 2073 6567  ), 'ream and seg
-0001a5a0: 6d65 6e74 6564 2e5c 6e54 6865 2064 6174  mented.\nThe dat
-0001a5b0: 6162 6173 6520 7374 6f72 6573 2073 6567  abase stores seg
-0001a5c0: 6d65 6e74 6564 2062 6c6f 6273 2069 6e20  mented blobs in 
-0001a5d0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-0001a5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a5f0: 2020 2027 6368 756e 6b73 2e5c 6e45 6163     'chunks.\nEac
-0001a600: 6820 6368 756e 6b20 7374 6172 7473 2077  h chunk starts w
-0001a610: 6974 6820 6120 7477 6f20 6279 7465 206c  ith a two byte l
-0001a620: 656e 6774 6820 696e 6469 6361 746f 7220  ength indicator 
-0001a630: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-0001a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a650: 2020 2027 666f 6c6c 6f77 6564 2062 7920     'followed by 
-0001a660: 686f 7765 7665 7220 6d61 6e79 2062 7974  however many byt
-0001a670: 6573 206f 6620 6461 7461 2077 6572 6520  es of data were 
-0001a680: 7061 7373 6564 2061 7320 270a 2020 2020  passed as '.    
-0001a690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a6a0: 2020 2020 2020 2020 2020 2020 2027 6120               'a 
-0001a6b0: 7365 676d 656e 742e 5c6e 5374 7265 616d  segment.\nStream
-0001a6c0: 2062 6c6f 6273 2061 7265 2073 746f 7265   blobs are store
-0001a6d0: 6420 6173 2061 2063 6f6e 7469 6e75 6f75  d as a continuou
-0001a6e0: 7320 6172 7261 7920 270a 2020 2020 2020  s array '.      
-0001a6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a700: 2020 2020 2020 2020 2020 2027 6f66 2064             'of d
-0001a710: 6174 6120 6279 7465 7320 7769 7468 206e  ata bytes with n
-0001a720: 6f20 6c65 6e67 7468 2069 6e64 6963 6174  o length indicat
-0001a730: 6f72 7320 696e 636c 7564 6564 2e27 290a  ors included.').
-0001a740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a750: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0001a760: 2862 6c6f 625f 7265 6164 6572 2e72 6561  (blob_reader.rea
-0001a770: 6428 3230 292c 2027 2729 0a20 2020 2020  d(20), '').     
-0001a780: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a790: 6173 7365 7274 4571 7561 6c28 626c 6f62  assertEqual(blob
-0001a7a0: 5f72 6561 6465 722e 7465 6c6c 2829 2c20  _reader.tell(), 
-0001a7b0: 3331 3829 0a20 2020 2020 2020 2020 2020  318).           
-0001a7c0: 2020 2020 2062 6c6f 625f 7265 6164 6572       blob_reader
-0001a7d0: 2e73 6565 6b28 3230 290a 2020 2020 2020  .seek(20).      
-0001a7e0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001a7f0: 7373 6572 7445 7175 616c 2862 6c6f 625f  ssertEqual(blob_
-0001a800: 7265 6164 6572 2e74 656c 6c28 292c 2032  reader.tell(), 2
-0001a810: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
-0001a820: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0001a830: 7561 6c28 626c 6f62 5f72 6561 6465 722e  ual(blob_reader.
-0001a840: 7265 6164 2832 3029 2c20 276f 2074 7970  read(20), 'o typ
-0001a850: 6573 206f 6620 626c 6f62 732c 2073 7427  es of blobs, st'
-0001a860: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001a870: 2020 626c 6f62 5f72 6561 6465 722e 7365    blob_reader.se
-0001a880: 656b 2830 290a 2020 2020 2020 2020 2020  ek(0).          
-0001a890: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0001a8a0: 7445 7175 616c 2862 6c6f 625f 7265 6164  tEqual(blob_read
-0001a8b0: 6572 2e74 656c 6c28 292c 2030 290a 2020  er.tell(), 0).  
-0001a8c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001a8d0: 6c66 2e61 7373 6572 744c 6973 7445 7175  lf.assertListEqu
-0001a8e0: 616c 2862 6c6f 625f 7265 6164 6572 2e72  al(blob_reader.r
-0001a8f0: 6561 646c 696e 6573 2829 2c20 5374 7269  eadlines(), Stri
-0001a900: 6e67 494f 2862 6c6f 6229 2e72 6561 646c  ngIO(blob).readl
-0001a910: 696e 6573 2829 290a 2020 2020 2020 2020  ines()).        
-0001a920: 2020 2020 2020 2020 626c 6f62 5f72 6561          blob_rea
-0001a930: 6465 722e 7365 656b 2830 290a 2020 2020  der.seek(0).    
-0001a940: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001a950: 6c69 6e65 2069 6e20 626c 6f62 5f72 6561  line in blob_rea
-0001a960: 6465 723a 0a20 2020 2020 2020 2020 2020  der:.           
-0001a970: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001a980: 7365 7274 496e 286c 696e 652c 2062 6c6f  sertIn(line, blo
-0001a990: 625f 6c69 6e65 7329 0a20 2020 2020 2020  b_lines).       
-0001a9a0: 2020 2020 2020 2020 2062 6c6f 625f 7265           blob_re
-0001a9b0: 6164 6572 2e73 6565 6b28 3029 0a20 2020  ader.seek(0).   
-0001a9c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001a9d0: 662e 6173 7365 7274 4c69 7374 4571 7561  f.assertListEqua
-0001a9e0: 6c28 626c 6f62 5f72 6561 6465 722e 7265  l(blob_reader.re
-0001a9f0: 6164 6c69 6e65 7328 3329 2c20 626c 6f62  adlines(3), blob
-0001aa00: 5f6c 696e 6573 5b3a 335d 290a 2020 2020  _lines[:3]).    
-0001aa10: 2020 2020 2020 2020 2020 2020 626c 6f62              blob
-0001aa20: 5f72 6561 6465 722e 7365 656b 2830 290a  _reader.seek(0).
-0001aa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aa40: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0001aa50: 2862 6c6f 625f 7265 6164 6572 2e72 6561  (blob_reader.rea
-0001aa60: 6428 292c 2062 6c6f 6229 0a20 2020 2020  d(), blob).     
-0001aa70: 2020 2020 2020 2020 2020 2062 6c6f 625f             blob_
-0001aa80: 7265 6164 6572 2e73 6565 6b28 2d39 2c20  reader.seek(-9, 
-0001aa90: 6f73 2e53 4545 4b5f 454e 4429 0a20 2020  os.SEEK_END).   
-0001aaa0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001aab0: 662e 6173 7365 7274 4571 7561 6c28 626c  f.assertEqual(bl
-0001aac0: 6f62 5f72 6561 6465 722e 7265 6164 2829  ob_reader.read()
-0001aad0: 2c20 2769 6e63 6c75 6465 642e 2729 0a20  , 'included.'). 
-0001aae0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0001aaf0: 6c6f 625f 7265 6164 6572 2e73 6565 6b28  lob_reader.seek(
-0001ab00: 2d32 302c 206f 732e 5345 454b 5f45 4e44  -20, os.SEEK_END
-0001ab10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001ab20: 2020 626c 6f62 5f72 6561 6465 722e 7365    blob_reader.se
-0001ab30: 656b 2831 312c 206f 732e 5345 454b 5f43  ek(11, os.SEEK_C
-0001ab40: 5552 290a 2020 2020 2020 2020 2020 2020  UR).            
-0001ab50: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001ab60: 7175 616c 2862 6c6f 625f 7265 6164 6572  qual(blob_reader
-0001ab70: 2e72 6561 6428 292c 2027 696e 636c 7564  .read(), 'includ
-0001ab80: 6564 2e27 290a 2020 2020 2020 2020 2020  ed.').          
-0001ab90: 2020 2020 2020 626c 6f62 5f72 6561 6465        blob_reade
-0001aba0: 722e 7365 656b 2836 3029 0a20 2020 2020  r.seek(60).     
-0001abb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001abc0: 6173 7365 7274 4571 7561 6c28 626c 6f62  assertEqual(blob
-0001abd0: 5f72 6561 6465 722e 7265 6164 6c69 6e65  _reader.readline
-0001abe0: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
-0001abf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac00: 2020 2020 2027 5468 6520 6461 7461 6261       'The databa
-0001ac10: 7365 2073 746f 7265 7320 7365 676d 656e  se stores segmen
-0001ac20: 7465 6420 626c 6f62 7320 696e 2063 6875  ted blobs in chu
-0001ac30: 6e6b 732e 5c6e 2729 0a20 2020 2020 2020  nks.\n').       
-0001ac40: 2020 2020 2020 2020 2062 6c6f 625f 7265           blob_re
-0001ac50: 6164 6572 2e73 6565 6b28 3029 0a20 2020  ader.seek(0).   
-0001ac60: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001ac70: 662e 6173 7365 7274 4571 7561 6c28 626c  f.assertEqual(bl
-0001ac80: 6f62 5f72 6561 6465 722e 7265 6164 6c69  ob_reader.readli
-0001ac90: 6e65 2832 3029 2c20 2746 6972 6562 6972  ne(20), 'Firebir
-0001aca0: 6420 7375 7070 6f72 7473 2074 7727 290a  d supports tw').
-0001acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001acc0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0001acd0: 2862 6c6f 625f 7265 6164 6572 2e72 6561  (blob_reader.rea
-0001ace0: 646c 696e 6528 292c 2027 6f20 7479 7065  dline(), 'o type
-0001acf0: 7320 6f66 2062 6c6f 6273 2c20 7374 7265  s of blobs, stre
-0001ad00: 616d 2061 6e64 2073 6567 6d65 6e74 6564  am and segmented
-0001ad10: 2e5c 6e27 290a 2020 2020 2020 2020 2020  .\n').          
-0001ad20: 2020 2020 2020 626c 6f62 5f72 6561 6465        blob_reade
-0001ad30: 722e 7365 656b 2830 290a 2020 2020 2020  r.seek(0).      
-0001ad40: 2020 2020 2020 2020 2020 626c 6f62 5f72            blob_r
-0001ad50: 6561 6465 722e 6e65 776c 696e 6520 3d20  eader.newline = 
-0001ad60: 275c 725c 6e27 0a20 2020 2020 2020 2020  '\r\n'.         
-0001ad70: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001ad80: 7274 4571 7561 6c28 626c 6f62 5f72 6561  rtEqual(blob_rea
-0001ad90: 6465 722e 7265 6164 6c69 6e65 2829 2c20  der.readline(), 
-0001ada0: 2746 6972 6562 6972 6420 7375 7070 6f72  'Firebird suppor
-0001adb0: 7473 2074 776f 2074 7970 6573 206f 6620  ts two types of 
-0001adc0: 626c 6f62 732c 2073 7472 6561 6d20 616e  blobs, stream an
-0001add0: 6420 7365 676d 656e 7465 642e 5c72 5c6e  d segmented.\r\n
-0001ade0: 2729 0a20 2020 2064 6566 2074 6573 7442  ').    def testB
-0001adf0: 6c6f 6245 7874 656e 6465 6428 7365 6c66  lobExtended(self
-0001ae00: 293a 0a20 2020 2020 2020 2062 6c6f 6220  ):.        blob 
-0001ae10: 3d20 2222 2246 6972 6562 6972 6420 7375  = """Firebird su
-0001ae20: 7070 6f72 7473 2074 776f 2074 7970 6573  pports two types
-0001ae30: 206f 6620 626c 6f62 732c 2073 7472 6561   of blobs, strea
-0001ae40: 6d20 616e 6420 7365 676d 656e 7465 642e  m and segmented.
-0001ae50: 0a54 6865 2064 6174 6162 6173 6520 7374  .The database st
-0001ae60: 6f72 6573 2073 6567 6d65 6e74 6564 2062  ores segmented b
-0001ae70: 6c6f 6273 2069 6e20 6368 756e 6b73 2e0a  lobs in chunks..
-0001ae80: 4561 6368 2063 6875 6e6b 2073 7461 7274  Each chunk start
-0001ae90: 7320 7769 7468 2061 2074 776f 2062 7974  s with a two byt
-0001aea0: 6520 6c65 6e67 7468 2069 6e64 6963 6174  e length indicat
-0001aeb0: 6f72 2066 6f6c 6c6f 7765 6420 6279 2068  or followed by h
-0001aec0: 6f77 6576 6572 206d 616e 7920 6279 7465  owever many byte
-0001aed0: 7320 6f66 2064 6174 6120 7765 7265 2070  s of data were p
-0001aee0: 6173 7365 6420 6173 2061 2073 6567 6d65  assed as a segme
-0001aef0: 6e74 2e0a 5374 7265 616d 2062 6c6f 6273  nt..Stream blobs
-0001af00: 2061 7265 2073 746f 7265 6420 6173 2061   are stored as a
-0001af10: 2063 6f6e 7469 6e75 6f75 7320 6172 7261   continuous arra
-0001af20: 7920 6f66 2064 6174 6120 6279 7465 7320  y of data bytes 
-0001af30: 7769 7468 206e 6f20 6c65 6e67 7468 2069  with no length i
-0001af40: 6e64 6963 6174 6f72 7320 696e 636c 7564  ndicators includ
-0001af50: 6564 2e22 2222 0a20 2020 2020 2020 2077  ed.""".        w
-0001af60: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
-0001af70: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
-0001af80: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-0001af90: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
-0001afa0: 746f 2054 3220 2843 312c 4339 2920 7661  to T2 (C1,C9) va
-0001afb0: 6c75 6573 2028 3f2c 3f29 272c 205b 312c  lues (?,?)', [1,
-0001afc0: 2053 7472 696e 6749 4f28 626c 6f62 295d   StringIO(blob)]
-0001afd0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-0001afe0: 722e 6578 6563 7574 6528 2769 6e73 6572  r.execute('inser
-0001aff0: 7420 696e 746f 2054 3220 2843 312c 4339  t into T2 (C1,C9
-0001b000: 2920 7661 6c75 6573 2028 3f2c 3f29 272c  ) values (?,?)',
-0001b010: 205b 322c 2053 7472 696e 6749 4f28 626c   [2, StringIO(bl
-0001b020: 6f62 295d 290a 2020 2020 2020 2020 2020  ob)]).          
-0001b030: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
-0001b040: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-0001b050: 7020 3d20 6375 722e 7072 6570 6172 6528  p = cur.prepare(
-0001b060: 2773 656c 6563 7420 4331 2c43 3920 6672  'select C1,C9 fr
-0001b070: 6f6d 2054 3227 290a 2020 2020 2020 2020  om T2').        
-0001b080: 2020 2020 6375 722e 7374 7265 616d 5f62      cur.stream_b
-0001b090: 6c6f 6273 2e61 7070 656e 6428 2743 3927  lobs.append('C9'
-0001b0a0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-0001b0b0: 722e 6578 6563 7574 6528 7029 0a20 2020  r.execute(p).   
-0001b0c0: 2020 2020 2020 2020 2066 6f72 2072 6f77           for row
-0001b0d0: 2069 6e20 6375 723a 0a20 2020 2020 2020   in cur:.       
-0001b0e0: 2020 2020 2020 2020 2062 6c6f 625f 7265           blob_re
-0001b0f0: 6164 6572 203d 2072 6f77 5b31 5d0a 2020  ader = row[1].  
-0001b100: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-0001b110: 7468 2062 6c6f 625f 7265 6164 6572 3a0a  th blob_reader:.
-0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b130: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001b140: 7175 616c 2862 6c6f 625f 7265 6164 6572  qual(blob_reader
-0001b150: 2e72 6561 6428 3230 292c 2027 4669 7265  .read(20), 'Fire
-0001b160: 6269 7264 2073 7570 706f 7274 7320 7477  bird supports tw
-0001b170: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-0001b180: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001b190: 7274 4571 7561 6c28 626c 6f62 5f72 6561  rtEqual(blob_rea
-0001b1a0: 6465 722e 7265 6164 2832 3029 2c20 276f  der.read(20), 'o
-0001b1b0: 2074 7970 6573 206f 6620 626c 6f62 732c   types of blobs,
-0001b1c0: 2073 7427 290a 2020 2020 2020 2020 2020   st').          
-0001b1d0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001b1e0: 7373 6572 7445 7175 616c 2862 6c6f 625f  ssertEqual(blob_
-0001b1f0: 7265 6164 6572 2e72 6561 6428 3430 3029  reader.read(400)
-0001b200: 2c20 2772 6561 6d20 616e 6420 7365 676d  , 'ream and segm
-0001b210: 656e 7465 642e 5c6e 5468 6520 6461 7461  ented.\nThe data
-0001b220: 6261 7365 2073 746f 7265 7320 7365 676d  base stores segm
-0001b230: 656e 7465 6420 626c 6f62 7320 270a 2020  ented blobs '.  
-0001b240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b260: 2020 2027 696e 2063 6875 6e6b 732e 5c6e     'in chunks.\n
-0001b270: 4561 6368 2063 6875 6e6b 2073 7461 7274  Each chunk start
-0001b280: 7320 7769 7468 2061 2074 776f 2062 7974  s with a two byt
-0001b290: 6520 6c65 6e67 7468 2027 0a20 2020 2020  e length '.     
-0001b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2c0: 2769 6e64 6963 6174 6f72 2066 6f6c 6c6f  'indicator follo
-0001b2d0: 7765 6420 6279 2068 6f77 6576 6572 206d  wed by however m
-0001b2e0: 616e 7920 6279 7465 7320 6f66 2064 6174  any bytes of dat
-0001b2f0: 6120 7765 7265 2027 0a20 2020 2020 2020  a were '.       
-0001b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b310: 2020 2020 2020 2020 2020 2020 2020 2770                'p
-0001b320: 6173 7365 6420 6173 2061 2073 6567 6d65  assed as a segme
-0001b330: 6e74 2e5c 6e53 7472 6561 6d20 626c 6f62  nt.\nStream blob
-0001b340: 7320 6172 6520 7374 6f72 6564 2061 7320  s are stored as 
-0001b350: 6120 270a 2020 2020 2020 2020 2020 2020  a '.            
-0001b360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b370: 2020 2020 2020 2020 2027 636f 6e74 696e           'contin
-0001b380: 756f 7573 2061 7272 6179 206f 6620 6461  uous array of da
-0001b390: 7461 2062 7974 6573 2077 6974 6820 6e6f  ta bytes with no
-0001b3a0: 206c 656e 6774 6820 696e 6469 6361 746f   length indicato
-0001b3b0: 7273 2027 0a20 2020 2020 2020 2020 2020  rs '.           
-0001b3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b3d0: 2020 2020 2020 2020 2020 2769 6e63 6c75            'inclu
-0001b3e0: 6465 642e 2729 0a20 2020 2020 2020 2020  ded.').         
-0001b3f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001b400: 6173 7365 7274 4571 7561 6c28 626c 6f62  assertEqual(blob
-0001b410: 5f72 6561 6465 722e 7265 6164 2832 3029  _reader.read(20)
-0001b420: 2c20 2727 290a 2020 2020 2020 2020 2020  , '').          
-0001b430: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001b440: 7373 6572 7445 7175 616c 2862 6c6f 625f  ssertEqual(blob_
-0001b450: 7265 6164 6572 2e74 656c 6c28 292c 2033  reader.tell(), 3
-0001b460: 3138 290a 2020 2020 2020 2020 2020 2020  18).            
-0001b470: 2020 2020 2020 2020 626c 6f62 5f72 6561          blob_rea
-0001b480: 6465 722e 7365 656b 2832 3029 0a20 2020  der.seek(20).   
-0001b490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4a0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0001b4b0: 6c28 626c 6f62 5f72 6561 6465 722e 7465  l(blob_reader.te
-0001b4c0: 6c6c 2829 2c20 3230 290a 2020 2020 2020  ll(), 20).      
-0001b4d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001b4e0: 6c66 2e61 7373 6572 7445 7175 616c 2862  lf.assertEqual(b
-0001b4f0: 6c6f 625f 7265 6164 6572 2e72 6561 6428  lob_reader.read(
-0001b500: 3230 292c 2027 6f20 7479 7065 7320 6f66  20), 'o types of
-0001b510: 2062 6c6f 6273 2c20 7374 2729 0a20 2020   blobs, st').   
-0001b520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b530: 2062 6c6f 625f 7265 6164 6572 2e73 6565   blob_reader.see
-0001b540: 6b28 3029 0a20 2020 2020 2020 2020 2020  k(0).           
-0001b550: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001b560: 7365 7274 4571 7561 6c28 626c 6f62 5f72  sertEqual(blob_r
-0001b570: 6561 6465 722e 7465 6c6c 2829 2c20 3029  eader.tell(), 0)
-0001b580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b590: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001b5a0: 4c69 7374 4571 7561 6c28 626c 6f62 5f72  ListEqual(blob_r
-0001b5b0: 6561 6465 722e 7265 6164 6c69 6e65 7328  eader.readlines(
-0001b5c0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0001b5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b5e0: 2020 2020 2020 2020 2020 2020 5374 7269              Stri
-0001b5f0: 6e67 494f 2862 6c6f 6229 2e72 6561 646c  ngIO(blob).readl
-0001b600: 696e 6573 2829 290a 2020 2020 2020 2020  ines()).        
-0001b610: 2020 2020 2020 2020 2020 2020 626c 6f62              blob
-0001b620: 5f72 6561 6465 722e 7365 656b 2830 290a  _reader.seek(0).
-0001b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b640: 2020 2020 666f 7220 6c69 6e65 2069 6e20      for line in 
-0001b650: 626c 6f62 5f72 6561 6465 723a 0a20 2020  blob_reader:.   
-0001b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b670: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001b680: 496e 286c 696e 652e 7273 7472 6970 2827  In(line.rstrip('
-0001b690: 5c6e 2729 2c20 626c 6f62 2e73 706c 6974  \n'), blob.split
-0001b6a0: 2827 5c6e 2729 290a 2020 2020 2020 2020  ('\n')).        
-0001b6b0: 2020 2020 2020 2020 2020 2020 626c 6f62              blob
-0001b6c0: 5f72 6561 6465 722e 7365 656b 2830 290a  _reader.seek(0).
-0001b6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b6e0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001b6f0: 7175 616c 2862 6c6f 625f 7265 6164 6572  qual(blob_reader
-0001b700: 2e72 6561 6428 292c 2062 6c6f 6229 0a20  .read(), blob). 
-0001b710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b720: 2020 2062 6c6f 625f 7265 6164 6572 2e73     blob_reader.s
-0001b730: 6565 6b28 2d39 2c20 6f73 2e53 4545 4b5f  eek(-9, os.SEEK_
-0001b740: 454e 4429 0a20 2020 2020 2020 2020 2020  END).           
-0001b750: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001b760: 7365 7274 4571 7561 6c28 626c 6f62 5f72  sertEqual(blob_r
-0001b770: 6561 6465 722e 7265 6164 2829 2c20 2769  eader.read(), 'i
-0001b780: 6e63 6c75 6465 642e 2729 0a20 2020 2020  ncluded.').     
-0001b790: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0001b7a0: 6c6f 625f 7265 6164 6572 2e73 6565 6b28  lob_reader.seek(
-0001b7b0: 2d32 302c 206f 732e 5345 454b 5f45 4e44  -20, os.SEEK_END
-0001b7c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001b7d0: 2020 2020 2020 626c 6f62 5f72 6561 6465        blob_reade
-0001b7e0: 722e 7365 656b 2831 312c 206f 732e 5345  r.seek(11, os.SE
-0001b7f0: 454b 5f43 5552 290a 2020 2020 2020 2020  EK_CUR).        
-0001b800: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001b810: 2e61 7373 6572 7445 7175 616c 2862 6c6f  .assertEqual(blo
-0001b820: 625f 7265 6164 6572 2e72 6561 6428 292c  b_reader.read(),
-0001b830: 2027 696e 636c 7564 6564 2e27 290a 2020   'included.').  
-0001b840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b850: 2020 626c 6f62 5f72 6561 6465 722e 7365    blob_reader.se
-0001b860: 656b 2836 3029 0a20 2020 2020 2020 2020  ek(60).         
-0001b870: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001b880: 6173 7365 7274 4571 7561 6c28 626c 6f62  assertEqual(blob
-0001b890: 5f72 6561 6465 722e 7265 6164 6c69 6e65  _reader.readline
-0001b8a0: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
-0001b8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b8c0: 2020 2020 2020 2020 2027 5468 6520 6461           'The da
-0001b8d0: 7461 6261 7365 2073 746f 7265 7320 7365  tabase stores se
-0001b8e0: 676d 656e 7465 6420 626c 6f62 7320 696e  gmented blobs in
-0001b8f0: 2063 6875 6e6b 732e 5c6e 2729 0a0a 636c   chunks.\n')..cl
-0001b900: 6173 7320 5465 7374 4368 6172 7365 7443  ass TestCharsetC
-0001b910: 6f6e 7665 7273 696f 6e28 4472 6976 6572  onversion(Driver
-0001b920: 5465 7374 4261 7365 293a 0a20 2020 2064  TestBase):.    d
-0001b930: 6566 2073 6574 5570 2873 656c 6629 3a0a  ef setUp(self):.
-0001b940: 2020 2020 2020 2020 7375 7065 7228 292e          super().
-0001b950: 7365 7455 7028 290a 2020 2020 2020 2020  setUp().        
-0001b960: 7365 6c66 2e64 6266 696c 6520 3d20 6f73  self.dbfile = os
-0001b970: 2e70 6174 682e 6a6f 696e 2873 656c 662e  .path.join(self.
-0001b980: 6462 7061 7468 2c20 7365 6c66 2e46 4254  dbpath, self.FBT
-0001b990: 4553 545f 4442 290a 2020 2020 2020 2020  EST_DB).        
-0001b9a0: 7365 6c66 2e63 6f6e 203d 2063 6f6e 6e65  self.con = conne
-0001b9b0: 6374 2873 656c 662e 6462 6669 6c65 2c20  ct(self.dbfile, 
-0001b9c0: 7573 6572 3d46 4254 4553 545f 5553 4552  user=FBTEST_USER
-0001b9d0: 2c20 7061 7373 776f 7264 3d46 4254 4553  , password=FBTES
-0001b9e0: 545f 5041 5353 574f 5244 2c20 6368 6172  T_PASSWORD, char
-0001b9f0: 7365 743d 2775 7466 3827 290a 2020 2020  set='utf8').    
-0001ba00: 2020 2020 7365 6c66 2e63 6f6e 2e5f 6c6f      self.con._lo
-0001ba10: 6767 696e 675f 6964 5f20 3d20 7365 6c66  gging_id_ = self
-0001ba20: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-0001ba30: 655f 5f0a 2020 2020 2020 2020 2373 656c  e__.        #sel
-0001ba40: 662e 636f 6e2e 6578 6563 7574 655f 696d  f.con.execute_im
-0001ba50: 6d65 6469 6174 6528 2272 6563 7265 6174  mediate("recreat
-0001ba60: 6520 7461 626c 6520 7420 2863 3120 696e  e table t (c1 in
-0001ba70: 7465 6765 7229 2229 0a20 2020 2020 2020  teger)").       
-0001ba80: 2023 7365 6c66 2e63 6f6e 2e63 6f6d 6d69   #self.con.commi
-0001ba90: 7428 290a 2020 2020 2020 2020 2373 656c  t().        #sel
-0001baa0: 662e 636f 6e2e 6578 6563 7574 655f 696d  f.con.execute_im
-0001bab0: 6d65 6469 6174 6528 2252 4543 5245 4154  mediate("RECREAT
-0001bac0: 4520 5441 424c 4520 5432 2028 4331 2053  E TABLE T2 (C1 S
-0001bad0: 6d61 6c6c 696e 742c 4332 2049 6e74 6567  mallint,C2 Integ
-0001bae0: 6572 2c43 3320 4269 6769 6e74 2c43 3420  er,C3 Bigint,C4 
-0001baf0: 4368 6172 2835 292c 4335 2056 6172 6368  Char(5),C5 Varch
-0001bb00: 6172 2831 3029 2c43 3620 4461 7465 2c43  ar(10),C6 Date,C
-0001bb10: 3720 5469 6d65 2c43 3820 5469 6d65 7374  7 Time,C8 Timest
-0001bb20: 616d 702c 4339 2042 6c6f 6220 7375 625f  amp,C9 Blob sub_
-0001bb30: 7479 7065 2031 2c43 3130 204e 756d 6572  type 1,C10 Numer
-0001bb40: 6963 2831 382c 3229 2c43 3131 2044 6563  ic(18,2),C11 Dec
-0001bb50: 696d 616c 2831 382c 3229 2c43 3132 2046  imal(18,2),C12 F
-0001bb60: 6c6f 6174 2c43 3133 2044 6f75 626c 6520  loat,C13 Double 
-0001bb70: 7072 6563 6973 696f 6e2c 4331 3420 4e75  precision,C14 Nu
-0001bb80: 6d65 7269 6328 382c 3429 2c43 3135 2044  meric(8,4),C15 D
-0001bb90: 6563 696d 616c 2838 2c34 2929 2229 0a20  ecimal(8,4))"). 
-0001bba0: 2020 2020 2020 2023 7365 6c66 2e63 6f6e         #self.con
-0001bbb0: 2e63 6f6d 6d69 7428 290a 2020 2020 2020  .commit().      
-0001bbc0: 2020 7365 6c66 2e63 6f6e 2e65 7865 6375    self.con.execu
-0001bbd0: 7465 5f69 6d6d 6564 6961 7465 2822 6465  te_immediate("de
-0001bbe0: 6c65 7465 2066 726f 6d20 7433 2229 0a20  lete from t3"). 
-0001bbf0: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
-0001bc00: 6578 6563 7574 655f 696d 6d65 6469 6174  execute_immediat
-0001bc10: 6528 2264 656c 6574 6520 6672 6f6d 2074  e("delete from t
-0001bc20: 3422 290a 2020 2020 2020 2020 7365 6c66  4").        self
-0001bc30: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 2020  .con.commit().  
-0001bc40: 2020 6465 6620 7465 6172 446f 776e 2873    def tearDown(s
-0001bc50: 656c 6629 3a0a 2020 2020 2020 2020 7365  elf):.        se
-0001bc60: 6c66 2e63 6f6e 2e63 6c6f 7365 2829 0a20  lf.con.close(). 
-0001bc70: 2020 2064 6566 2074 6573 745f 6f63 7465     def test_octe
-0001bc80: 7473 2873 656c 6629 3a0a 2020 2020 2020  ts(self):.      
-0001bc90: 2020 6279 7465 7374 7269 6e67 203d 2062    bytestring = b
-0001bca0: 7974 6573 285b 312c 2032 2c20 332c 2034  ytes([1, 2, 3, 4
-0001bcb0: 2c20 355d 290a 2020 2020 2020 2020 7769  , 5]).        wi
-0001bcc0: 7468 2073 656c 662e 636f 6e2e 6375 7273  th self.con.curs
-0001bcd0: 6f72 2829 2061 7320 6375 723a 0a20 2020  or() as cur:.   
-0001bce0: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-0001bcf0: 6375 7465 2822 696e 7365 7274 2069 6e74  cute("insert int
-0001bd00: 6f20 5434 2028 4331 2c20 435f 4f43 5445  o T4 (C1, C_OCTE
-0001bd10: 5453 2c20 565f 4f43 5445 5453 2920 7661  TS, V_OCTETS) va
-0001bd20: 6c75 6573 2028 3f2c 3f2c 3f29 222c 0a20  lues (?,?,?)",. 
+00015050: 2020 2020 6669 7273 745f 6e61 6d65 3d27      first_name='
+00015060: 4669 7265 6269 7264 272c 206d 6964 646c  Firebird', middl
+00015070: 655f 6e61 6d65 3d27 4472 6976 6572 272c  e_name='Driver',
+00015080: 206c 6173 745f 6e61 6d65 3d27 5465 7374   last_name='Test
+00015090: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
+000150a0: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+000150b0: 7376 632e 7573 6572 2e65 7869 7374 7328  svc.user.exists(
+000150c0: 5553 4552 5f4e 414d 4529 290a 2020 2020  USER_NAME)).    
+000150d0: 2020 2020 7573 6572 7320 3d20 5b75 2066      users = [u f
+000150e0: 6f72 2075 2069 6e20 7365 6c66 2e73 7663  or u in self.svc
+000150f0: 2e75 7365 722e 6765 745f 616c 6c28 2920  .user.get_all() 
+00015100: 6966 2075 2e75 7365 725f 6e61 6d65 203d  if u.user_name =
+00015110: 3d20 5553 4552 5f4e 414d 455d 0a20 2020  = USER_NAME].   
+00015120: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00015130: 5472 7565 2875 7365 7273 290a 2020 2020  True(users).    
+00015140: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00015150: 7175 616c 286c 656e 2875 7365 7273 292c  qual(len(users),
+00015160: 2031 290a 2020 2020 2020 2020 7365 6c66   1).        self
+00015170: 2e61 7373 6572 7445 7175 616c 2875 7365  .assertEqual(use
+00015180: 7273 5b30 5d2e 6669 7273 745f 6e61 6d65  rs[0].first_name
+00015190: 2c20 2746 6972 6562 6972 6427 290a 2020  , 'Firebird').  
+000151a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000151b0: 7445 7175 616c 2875 7365 7273 5b30 5d2e  tEqual(users[0].
+000151c0: 6d69 6464 6c65 5f6e 616d 652c 2027 4472  middle_name, 'Dr
+000151d0: 6976 6572 2729 0a20 2020 2020 2020 2073  iver').        s
+000151e0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000151f0: 7573 6572 735b 305d 2e6c 6173 745f 6e61  users[0].last_na
+00015200: 6d65 2c20 2754 6573 7427 290a 2020 2020  me, 'Test').    
+00015210: 2020 2020 2320 4d6f 6469 6679 2075 7365      # Modify use
+00015220: 720a 2020 2020 2020 2020 7365 6c66 2e73  r.        self.s
+00015230: 7663 2e75 7365 722e 7570 6461 7465 2855  vc.user.update(U
+00015240: 5345 525f 4e41 4d45 2c20 6669 7273 745f  SER_NAME, first_
+00015250: 6e61 6d65 3d27 5846 6972 6562 6972 6427  name='XFirebird'
+00015260: 2c20 6d69 6464 6c65 5f6e 616d 653d 2758  , middle_name='X
+00015270: 4472 6976 6572 272c 206c 6173 745f 6e61  Driver', last_na
+00015280: 6d65 3d27 5854 6573 7427 290a 2020 2020  me='XTest').    
+00015290: 2020 2020 7573 6572 203d 2073 656c 662e      user = self.
+000152a0: 7376 632e 7573 6572 2e67 6574 2855 5345  svc.user.get(USE
+000152b0: 525f 4e41 4d45 290a 2020 2020 2020 2020  R_NAME).        
+000152c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+000152d0: 2875 7365 722e 7573 6572 5f6e 616d 652c  (user.user_name,
+000152e0: 2055 5345 525f 4e41 4d45 290a 2020 2020   USER_NAME).    
+000152f0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00015300: 7175 616c 2875 7365 722e 6669 7273 745f  qual(user.first_
+00015310: 6e61 6d65 2c20 2758 4669 7265 6269 7264  name, 'XFirebird
+00015320: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
+00015330: 6173 7365 7274 4571 7561 6c28 7573 6572  assertEqual(user
+00015340: 2e6d 6964 646c 655f 6e61 6d65 2c20 2758  .middle_name, 'X
+00015350: 4472 6976 6572 2729 0a20 2020 2020 2020  Driver').       
+00015360: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00015370: 6c28 7573 6572 2e6c 6173 745f 6e61 6d65  l(user.last_name
+00015380: 2c20 2758 5465 7374 2729 0a20 2020 2020  , 'XTest').     
+00015390: 2020 2023 2044 656c 6574 6520 7573 6572     # Delete user
+000153a0: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
+000153b0: 632e 7573 6572 2e64 656c 6574 6528 5553  c.user.delete(US
+000153c0: 4552 5f4e 414d 4529 0a20 2020 2020 2020  ER_NAME).       
+000153d0: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
+000153e0: 6528 7365 6c66 2e73 7663 2e75 7365 722e  e(self.svc.user.
+000153f0: 6578 6973 7473 2855 5345 525f 4e41 4d45  exists(USER_NAME
+00015400: 2929 0a0a 636c 6173 7320 5465 7374 5365  ))..class TestSe
+00015410: 7276 6572 4461 7461 6261 7365 5365 7276  rverDatabaseServ
+00015420: 6963 6573 2844 7269 7665 7254 6573 7442  ices(DriverTestB
+00015430: 6173 6529 3a0a 2020 2020 6465 6620 7365  ase):.    def se
+00015440: 7455 7028 7365 6c66 293a 0a20 2020 2020  tUp(self):.     
+00015450: 2020 2073 7570 6572 2829 2e73 6574 5570     super().setUp
+00015460: 2829 0a20 2020 2020 2020 2023 2066 227b  ().        # f"{
+00015470: 4642 5445 5354 5f48 4f53 547d 3a7b 6f73  FBTEST_HOST}:{os
+00015480: 2e70 6174 682e 6a6f 696e 2873 656c 662e  .path.join(self.
+00015490: 6462 7061 7468 2c20 2774 6573 745f 656d  dbpath, 'test_em
+000154a0: 706c 6f79 6565 2e66 6462 2729 7d22 0a20  ployee.fdb')}". 
+000154b0: 2020 2020 2020 2073 656c 662e 6462 6669         self.dbfi
+000154c0: 6c65 203d 206f 732e 7061 7468 2e6a 6f69  le = os.path.joi
+000154d0: 6e28 7365 6c66 2e64 6270 6174 682c 2073  n(self.dbpath, s
+000154e0: 656c 662e 4642 5445 5354 5f44 4229 0a20  elf.FBTEST_DB). 
+000154f0: 2020 2020 2020 2073 656c 662e 6662 6b20         self.fbk 
+00015500: 3d20 6f73 2e70 6174 682e 6a6f 696e 2873  = os.path.join(s
+00015510: 656c 662e 6462 7061 7468 2c20 2774 6573  elf.dbpath, 'tes
+00015520: 745f 656d 706c 6f79 6565 2e66 626b 2729  t_employee.fbk')
+00015530: 0a20 2020 2020 2020 2073 656c 662e 6662  .        self.fb
+00015540: 6b32 203d 206f 732e 7061 7468 2e6a 6f69  k2 = os.path.joi
+00015550: 6e28 7365 6c66 2e64 6270 6174 682c 2027  n(self.dbpath, '
+00015560: 7465 7374 5f65 6d70 6c6f 7965 652e 6662  test_employee.fb
+00015570: 6b32 2729 0a20 2020 2020 2020 2073 656c  k2').        sel
+00015580: 662e 7266 6462 203d 206f 732e 7061 7468  f.rfdb = os.path
+00015590: 2e6a 6f69 6e28 7365 6c66 2e64 6270 6174  .join(self.dbpat
+000155a0: 682c 2027 7465 7374 5f65 6d70 6c6f 7965  h, 'test_employe
+000155b0: 652e 6664 6227 290a 2020 2020 2020 2020  e.fdb').        
+000155c0: 7365 6c66 2e73 7663 203d 2063 6f6e 6e65  self.svc = conne
+000155d0: 6374 5f73 6572 7665 7228 4642 5445 5354  ct_server(FBTEST
+000155e0: 5f48 4f53 542c 2075 7365 723d 2753 5953  _HOST, user='SYS
+000155f0: 4442 4127 2c20 7061 7373 776f 7264 3d46  DBA', password=F
+00015600: 4254 4553 545f 5041 5353 574f 5244 290a  BTEST_PASSWORD).
+00015610: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+00015620: 203d 2063 6f6e 6e65 6374 2866 227b 4642   = connect(f"{FB
+00015630: 5445 5354 5f48 4f53 547d 3a7b 7365 6c66  TEST_HOST}:{self
+00015640: 2e64 6266 696c 657d 222c 0a20 2020 2020  .dbfile}",.     
+00015650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015660: 2020 2020 2020 7573 6572 3d46 4254 4553        user=FBTES
+00015670: 545f 5553 4552 2c20 7061 7373 776f 7264  T_USER, password
+00015680: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
+00015690: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
+000156a0: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
+000156b0: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
+000156c0: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
+000156d0: 2020 7365 6c66 2e63 6f6e 2e65 7865 6375    self.con.execu
+000156e0: 7465 5f69 6d6d 6564 6961 7465 2822 6465  te_immediate("de
+000156f0: 6c65 7465 2066 726f 6d20 7422 290a 2020  lete from t").  
+00015700: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
+00015710: 6f6d 6d69 7428 290a 2020 2020 2020 2020  ommit().        
+00015720: 6320 3d20 6372 6561 7465 5f64 6174 6162  c = create_datab
+00015730: 6173 6528 6622 7b46 4254 4553 545f 484f  ase(f"{FBTEST_HO
+00015740: 5354 7d3a 7b73 656c 662e 7266 6462 7d22  ST}:{self.rfdb}"
+00015750: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015760: 2020 2020 2020 2020 2020 2020 2020 7573                us
+00015770: 6572 3d46 4254 4553 545f 5553 4552 2c20  er=FBTEST_USER, 
+00015780: 7061 7373 776f 7264 3d46 4254 4553 545f  password=FBTEST_
+00015790: 5041 5353 574f 5244 2c0a 2020 2020 2020  PASSWORD,.      
+000157a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000157b0: 2020 2020 2020 6f76 6572 7772 6974 653d        overwrite=
+000157c0: 5472 7565 290a 2020 2020 2020 2020 632e  True).        c.
+000157d0: 636c 6f73 6528 290a 2020 2020 6465 6620  close().    def 
+000157e0: 7465 6172 446f 776e 2873 656c 6629 3a0a  tearDown(self):.
+000157f0: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
+00015800: 2e63 6c6f 7365 2829 0a20 2020 2020 2020  .close().       
+00015810: 2073 656c 662e 636f 6e2e 636c 6f73 6528   self.con.close(
+00015820: 290a 2020 2020 2020 2020 6966 206f 732e  ).        if os.
+00015830: 7061 7468 2e65 7869 7374 7328 7365 6c66  path.exists(self
+00015840: 2e72 6664 6229 3a0a 2020 2020 2020 2020  .rfdb):.        
+00015850: 2020 2020 6f73 2e72 656d 6f76 6528 7365      os.remove(se
+00015860: 6c66 2e72 6664 6229 0a20 2020 2020 2020  lf.rfdb).       
+00015870: 2069 6620 6f73 2e70 6174 682e 6578 6973   if os.path.exis
+00015880: 7473 2873 656c 662e 6662 6b29 3a0a 2020  ts(self.fbk):.  
+00015890: 2020 2020 2020 2020 2020 6f73 2e72 656d            os.rem
+000158a0: 6f76 6528 7365 6c66 2e66 626b 290a 2020  ove(self.fbk).  
+000158b0: 2020 2020 2020 6966 206f 732e 7061 7468        if os.path
+000158c0: 2e65 7869 7374 7328 7365 6c66 2e66 626b  .exists(self.fbk
+000158d0: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
+000158e0: 6f73 2e72 656d 6f76 6528 7365 6c66 2e66  os.remove(self.f
+000158f0: 626b 3229 0a20 2020 2064 6566 2074 6573  bk2).    def tes
+00015900: 745f 6765 745f 7374 6174 6973 7469 6373  t_get_statistics
+00015910: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00015920: 6465 6620 6665 7463 686c 696e 6528 6c69  def fetchline(li
+00015930: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
+00015940: 206f 7574 7075 742e 6170 7065 6e64 286c   output.append(l
+00015950: 696e 6529 0a0a 2020 2020 2020 2020 2373  ine)..        #s
+00015960: 656c 662e 736b 6970 5465 7374 2827 4e6f  elf.skipTest('No
+00015970: 7420 696d 706c 656d 656e 7465 6420 7965  t implemented ye
+00015980: 7427 290a 2020 2020 2020 2020 7365 6c66  t').        self
+00015990: 2e73 7663 2e64 6174 6162 6173 652e 6765  .svc.database.ge
+000159a0: 745f 7374 6174 6973 7469 6373 2864 6174  t_statistics(dat
+000159b0: 6162 6173 653d 2765 6d70 6c6f 7965 6527  abase='employee'
+000159c0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000159d0: 7373 6572 7454 7275 6528 7365 6c66 2e73  ssertTrue(self.s
+000159e0: 7663 2e69 735f 7275 6e6e 696e 6728 2929  vc.is_running())
+000159f0: 0a20 2020 2020 2020 2023 2066 6574 6368  .        # fetch
+00015a00: 206d 6174 6572 6961 6c69 7a65 640a 2020   materialized.  
+00015a10: 2020 2020 2020 7374 6174 7320 3d20 7365        stats = se
+00015a20: 6c66 2e73 7663 2e72 6561 646c 696e 6573  lf.svc.readlines
+00015a30: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00015a40: 6173 7365 7274 4661 6c73 6528 7365 6c66  assertFalse(self
+00015a50: 2e73 7663 2e69 735f 7275 6e6e 696e 6728  .svc.is_running(
+00015a60: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+00015a70: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
+00015a80: 2873 7461 7473 2c20 7479 7065 286c 6973  (stats, type(lis
+00015a90: 7428 2929 290a 2020 2020 2020 2020 2320  t())).        # 
+00015aa0: 6974 6572 6174 6520 6f76 6572 2072 6573  iterate over res
+00015ab0: 756c 740a 2020 2020 2020 2020 7365 6c66  ult.        self
+00015ac0: 2e73 7663 2e64 6174 6162 6173 652e 6765  .svc.database.ge
+00015ad0: 745f 7374 6174 6973 7469 6373 2864 6174  t_statistics(dat
+00015ae0: 6162 6173 653d 2765 6d70 6c6f 7965 6527  abase='employee'
+00015af0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b10: 2020 2020 2020 2020 2020 2066 6c61 6773             flags
+00015b20: 3d28 5372 7653 7461 7446 6c61 672e 4445  =(SrvStatFlag.DE
+00015b30: 4641 554c 540a 2020 2020 2020 2020 2020  FAULT.          
+00015b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b60: 2020 2020 2020 7c20 5372 7653 7461 7446        | SrvStatF
+00015b70: 6c61 672e 5359 535f 5245 4c41 5449 4f4e  lag.SYS_RELATION
+00015b80: 530a 2020 2020 2020 2020 2020 2020 2020  S.              
+00015b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015bb0: 2020 7c20 5372 7653 7461 7446 6c61 672e    | SrvStatFlag.
+00015bc0: 5245 434f 5244 5f56 4552 5349 4f4e 5329  RECORD_VERSIONS)
+00015bd0: 290a 2020 2020 2020 2020 666f 7220 6c69  ).        for li
+00015be0: 6e65 2069 6e20 7365 6c66 2e73 7663 3a0a  ne in self.svc:.
+00015bf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00015c00: 2e61 7373 6572 7449 7349 6e73 7461 6e63  .assertIsInstanc
+00015c10: 6528 6c69 6e65 2c20 7374 7229 0a20 2020  e(line, str).   
+00015c20: 2020 2020 2023 2063 616c 6c62 6163 6b0a       # callback.
+00015c30: 2020 2020 2020 2020 6f75 7470 7574 203d          output =
+00015c40: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
+00015c50: 2e73 7663 2e64 6174 6162 6173 652e 6765  .svc.database.ge
+00015c60: 745f 7374 6174 6973 7469 6373 2864 6174  t_statistics(dat
+00015c70: 6162 6173 653d 2765 6d70 6c6f 7965 6527  abase='employee'
+00015c80: 2c20 6361 6c6c 6261 636b 3d66 6574 6368  , callback=fetch
+00015c90: 6c69 6e65 290a 2020 2020 2020 2020 7365  line).        se
+00015ca0: 6c66 2e61 7373 6572 7447 7265 6174 6572  lf.assertGreater
+00015cb0: 286c 656e 286f 7574 7075 7429 2c20 3029  (len(output), 0)
+00015cc0: 0a20 2020 2020 2020 2023 2066 6574 6368  .        # fetch
+00015cd0: 206f 6e6c 7920 7365 6c65 6374 6564 2074   only selected t
+00015ce0: 6162 6c65 730a 2020 2020 2020 2020 7374  ables.        st
+00015cf0: 6174 7320 3d20 7365 6c66 2e73 7663 2e64  ats = self.svc.d
+00015d00: 6174 6162 6173 652e 6765 745f 7374 6174  atabase.get_stat
+00015d10: 6973 7469 6373 2864 6174 6162 6173 653d  istics(database=
+00015d20: 2765 6d70 6c6f 7965 6527 2c0a 2020 2020  'employee',.    
+00015d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d50: 2020 2020 2020 2020 2020 2020 2066 6c61               fla
+00015d60: 6773 3d53 7276 5374 6174 466c 6167 2e44  gs=SrvStatFlag.D
+00015d70: 4154 415f 5041 4745 532c 0a20 2020 2020  ATA_PAGES,.     
+00015d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015da0: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
+00015db0: 6573 3d5b 2743 4f55 4e54 5259 275d 290a  es=['COUNTRY']).
+00015dc0: 2020 2020 2020 2020 7374 6174 7320 3d20          stats = 
+00015dd0: 275c 6e27 2e6a 6f69 6e28 7365 6c66 2e73  '\n'.join(self.s
+00015de0: 7663 2e72 6561 646c 696e 6573 2829 290a  vc.readlines()).
+00015df0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00015e00: 6572 7449 6e28 2743 4f55 4e54 5259 272c  ertIn('COUNTRY',
+00015e10: 2073 7461 7473 290a 2020 2020 2020 2020   stats).        
+00015e20: 7365 6c66 2e61 7373 6572 744e 6f74 496e  self.assertNotIn
+00015e30: 2827 4a4f 4227 2c20 7374 6174 7329 0a20  ('JOB', stats). 
+00015e40: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
+00015e50: 2073 7461 7473 203d 2073 656c 662e 7376   stats = self.sv
+00015e60: 632e 6461 7461 6261 7365 2e67 6574 5f73  c.database.get_s
+00015e70: 7461 7469 7374 6963 7328 6461 7461 6261  tatistics(databa
+00015e80: 7365 3d27 656d 706c 6f79 6565 272c 0a20  se='employee',. 
+00015e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ec0: 666c 6167 733d 5372 7653 7461 7446 6c61  flags=SrvStatFla
+00015ed0: 672e 4441 5441 5f50 4147 4553 2c0a 2020  g.DATA_PAGES,.  
+00015ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f00: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00015f10: 6162 6c65 733d 2827 434f 554e 5452 5927  ables=('COUNTRY'
+00015f20: 2c20 2750 524f 4a45 4354 2729 290a 2020  , 'PROJECT')).  
+00015f30: 2020 2020 2020 7374 6174 7320 3d20 275c        stats = '\
+00015f40: 6e27 2e6a 6f69 6e28 7365 6c66 2e73 7663  n'.join(self.svc
+00015f50: 2e72 6561 646c 696e 6573 2829 290a 2020  .readlines()).  
+00015f60: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00015f70: 7449 6e28 2743 4f55 4e54 5259 272c 2073  tIn('COUNTRY', s
+00015f80: 7461 7473 290a 2020 2020 2020 2020 7365  tats).        se
+00015f90: 6c66 2e61 7373 6572 7449 6e28 2750 524f  lf.assertIn('PRO
+00015fa0: 4a45 4354 272c 2073 7461 7473 290a 2020  JECT', stats).  
+00015fb0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00015fc0: 744e 6f74 496e 2827 4a4f 4227 2c20 7374  tNotIn('JOB', st
+00015fd0: 6174 7329 0a20 2020 2064 6566 2074 6573  ats).    def tes
+00015fe0: 745f 6261 636b 7570 2873 656c 6629 3a0a  t_backup(self):.
+00015ff0: 2020 2020 2020 2020 6465 6620 6665 7463          def fetc
+00016000: 686c 696e 6528 6c69 6e65 293a 0a20 2020  hline(line):.   
+00016010: 2020 2020 2020 2020 206f 7574 7075 742e           output.
+00016020: 6170 7065 6e64 286c 696e 6529 0a0a 2020  append(line)..  
+00016030: 2020 2020 2020 2373 656c 662e 736b 6970        #self.skip
+00016040: 5465 7374 2827 4e6f 7420 696d 706c 656d  Test('Not implem
+00016050: 656e 7465 6420 7965 7427 290a 2020 2020  ented yet').    
+00016060: 2020 2020 7365 6c66 2e73 7663 2e64 6174      self.svc.dat
+00016070: 6162 6173 652e 6261 636b 7570 2864 6174  abase.backup(dat
+00016080: 6162 6173 653d 2765 6d70 6c6f 7965 6527  abase='employee'
+00016090: 2c20 6261 636b 7570 3d73 656c 662e 6662  , backup=self.fb
+000160a0: 6b29 0a20 2020 2020 2020 2073 656c 662e  k).        self.
+000160b0: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+000160c0: 7376 632e 6973 5f72 756e 6e69 6e67 2829  svc.is_running()
+000160d0: 290a 2020 2020 2020 2020 2320 6665 7463  ).        # fetc
+000160e0: 6820 6d61 7465 7269 616c 697a 6564 0a20  h materialized. 
+000160f0: 2020 2020 2020 2072 6570 6f72 7420 3d20         report = 
+00016100: 7365 6c66 2e73 7663 2e72 6561 646c 696e  self.svc.readlin
+00016110: 6573 2829 0a20 2020 2020 2020 2073 656c  es().        sel
+00016120: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
+00016130: 6c66 2e73 7663 2e69 735f 7275 6e6e 696e  lf.svc.is_runnin
+00016140: 6728 2929 0a20 2020 2020 2020 2073 656c  g()).        sel
+00016150: 662e 6173 7365 7274 5472 7565 286f 732e  f.assertTrue(os.
+00016160: 7061 7468 2e65 7869 7374 7328 7365 6c66  path.exists(self
+00016170: 2e66 626b 2929 0a20 2020 2020 2020 2073  .fbk)).        s
+00016180: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
+00016190: 616e 6365 2872 6570 6f72 742c 2074 7970  ance(report, typ
+000161a0: 6528 6c69 7374 2829 2929 0a20 2020 2020  e(list())).     
+000161b0: 2020 2073 656c 662e 6173 7365 7274 4c69     self.assertLi
+000161c0: 7374 4571 7561 6c28 7265 706f 7274 2c20  stEqual(report, 
+000161d0: 5b5d 290a 2020 2020 2020 2020 2320 6974  []).        # it
+000161e0: 6572 6174 6520 6f76 6572 2072 6573 756c  erate over resul
+000161f0: 740a 2020 2020 2020 2020 7365 6c66 2e73  t.        self.s
+00016200: 7663 2e64 6174 6162 6173 652e 6261 636b  vc.database.back
+00016210: 7570 2864 6174 6162 6173 653d 2765 6d70  up(database='emp
+00016220: 6c6f 7965 6527 2c20 6261 636b 7570 3d73  loyee', backup=s
+00016230: 656c 662e 6662 6b2c 0a20 2020 2020 2020  elf.fbk,.       
+00016240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016250: 2020 2020 2020 2020 2020 666c 6167 733d            flags=
+00016260: 2853 7276 4261 636b 7570 466c 6167 2e43  (SrvBackupFlag.C
+00016270: 4f4e 5645 5254 0a20 2020 2020 2020 2020  ONVERT.         
+00016280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016290: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+000162a0: 2053 7276 4261 636b 7570 466c 6167 2e49   SrvBackupFlag.I
+000162b0: 474e 4f52 455f 4c49 4d42 4f0a 2020 2020  GNORE_LIMBO.    
+000162c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000162e0: 2020 2020 7c20 5372 7642 6163 6b75 7046      | SrvBackupF
+000162f0: 6c61 672e 4947 4e4f 5245 5f43 4845 434b  lag.IGNORE_CHECK
+00016300: 5355 4d53 0a20 2020 2020 2020 2020 2020  SUMS.           
+00016310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016320: 2020 2020 2020 2020 2020 2020 207c 2053               | S
+00016330: 7276 4261 636b 7570 466c 6167 2e4d 4554  rvBackupFlag.MET
+00016340: 4144 4154 415f 4f4e 4c59 292c 2076 6572  ADATA_ONLY), ver
+00016350: 626f 7365 3d54 7275 6529 0a20 2020 2020  bose=True).     
+00016360: 2020 2066 6f72 206c 696e 6520 696e 2073     for line in s
+00016370: 656c 662e 7376 633a 0a20 2020 2020 2020  elf.svc:.       
+00016380: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00016390: 4973 4e6f 744e 6f6e 6528 6c69 6e65 290a  IsNotNone(line).
+000163a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000163b0: 2e61 7373 6572 7449 7349 6e73 7461 6e63  .assertIsInstanc
+000163c0: 6528 6c69 6e65 2c20 7374 7229 0a20 2020  e(line, str).   
+000163d0: 2020 2020 2023 2063 616c 6c62 6163 6b0a       # callback.
+000163e0: 2020 2020 2020 2020 6f75 7470 7574 203d          output =
+000163f0: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
+00016400: 2e73 7663 2e64 6174 6162 6173 652e 6261  .svc.database.ba
+00016410: 636b 7570 2864 6174 6162 6173 653d 2765  ckup(database='e
+00016420: 6d70 6c6f 7965 6527 2c20 6261 636b 7570  mployee', backup
+00016430: 3d73 656c 662e 6662 6b2c 2063 616c 6c62  =self.fbk, callb
+00016440: 6163 6b3d 6665 7463 686c 696e 652c 0a20  ack=fetchline,. 
+00016450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016470: 7665 7262 6f73 653d 5472 7565 290a 2020  verbose=True).  
+00016480: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00016490: 7447 7265 6174 6572 286c 656e 286f 7574  tGreater(len(out
+000164a0: 7075 7429 2c20 3029 0a20 2020 2020 2020  put), 0).       
+000164b0: 2023 2046 6972 6562 6972 6420 332e 3020   # Firebird 3.0 
+000164c0: 7374 6174 730a 2020 2020 2020 2020 6f75  stats.        ou
+000164d0: 7470 7574 203d 205b 5d0a 2020 2020 2020  tput = [].      
+000164e0: 2020 7365 6c66 2e73 7663 2e64 6174 6162    self.svc.datab
+000164f0: 6173 652e 6261 636b 7570 2864 6174 6162  ase.backup(datab
+00016500: 6173 653d 2765 6d70 6c6f 7965 6527 2c20  ase='employee', 
+00016510: 6261 636b 7570 3d73 656c 662e 6662 6b2c  backup=self.fbk,
+00016520: 2063 616c 6c62 6163 6b3d 6665 7463 686c   callback=fetchl
+00016530: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+00016540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016550: 2020 2020 2020 7374 6174 733d 2754 4452        stats='TDR
+00016560: 5727 2c20 7665 7262 6f73 653d 5472 7565  W', verbose=True
+00016570: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00016580: 7373 6572 7447 7265 6174 6572 286c 656e  ssertGreater(len
+00016590: 286f 7574 7075 7429 2c20 3029 0a20 2020  (output), 0).   
+000165a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000165b0: 496e 2827 6762 616b 3a20 7469 6d65 2020  In('gbak: time  
+000165c0: 2020 2064 656c 7461 2020 7265 6164 7320     delta  reads 
+000165d0: 2077 7269 7465 7320 5c6e 272c 206f 7574   writes \n', out
+000165e0: 7075 7429 0a20 2020 2020 2020 2023 2053  put).        # S
+000165f0: 6b69 7020 6461 7461 206f 7074 696f 6e0a  kip data option.
+00016600: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
+00016610: 2e64 6174 6162 6173 652e 6261 636b 7570  .database.backup
+00016620: 2864 6174 6162 6173 653d 2765 6d70 6c6f  (database='emplo
+00016630: 7965 6527 2c20 6261 636b 7570 3d73 656c  yee', backup=sel
+00016640: 662e 6662 6b2c 2073 6b69 705f 6461 7461  f.fbk, skip_data
+00016650: 3d27 2873 616c 6573 7c63 7573 746f 6d65  ='(sales|custome
+00016660: 7229 2729 0a20 2020 2020 2020 2073 656c  r)').        sel
+00016670: 662e 7376 632e 7761 6974 2829 0a20 2020  f.svc.wait().   
+00016680: 2020 2020 2073 656c 662e 7376 632e 6461       self.svc.da
+00016690: 7461 6261 7365 2e72 6573 746f 7265 2862  tabase.restore(b
+000166a0: 6163 6b75 703d 7365 6c66 2e66 626b 2c20  ackup=self.fbk, 
+000166b0: 6461 7461 6261 7365 3d73 656c 662e 7266  database=self.rf
+000166c0: 6462 2c20 666c 6167 733d 5372 7652 6573  db, flags=SrvRes
+000166d0: 746f 7265 466c 6167 2e52 4550 4c41 4345  toreFlag.REPLACE
+000166e0: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
+000166f0: 7663 2e77 6169 7428 290a 2020 2020 2020  vc.wait().      
+00016700: 2020 7769 7468 2063 6f6e 6e65 6374 2866    with connect(f
+00016710: 227b 4642 5445 5354 5f48 4f53 547d 3a7b  "{FBTEST_HOST}:{
+00016720: 7365 6c66 2e72 6664 627d 222c 2075 7365  self.rfdb}", use
+00016730: 723d 4642 5445 5354 5f55 5345 522c 2070  r=FBTEST_USER, p
+00016740: 6173 7377 6f72 643d 4642 5445 5354 5f50  assword=FBTEST_P
+00016750: 4153 5357 4f52 4429 2061 7320 7263 6f6e  ASSWORD) as rcon
+00016760: 3a0a 2020 2020 2020 2020 2020 2020 7263  :.            rc
+00016770: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
+00016780: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
+00016790: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
+000167a0: 2020 2020 2020 7769 7468 2072 636f 6e2e        with rcon.
+000167b0: 6375 7273 6f72 2829 2061 7320 633a 0a20  cursor() as c:. 
+000167c0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000167d0: 2e65 7865 6375 7465 2827 7365 6c65 6374  .execute('select
+000167e0: 202a 2066 726f 6d20 7361 6c65 7327 290a   * from sales').
+000167f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016800: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
+00016810: 7175 616c 2863 2e66 6574 6368 616c 6c28  qual(c.fetchall(
+00016820: 292c 205b 5d29 0a20 2020 2020 2020 2020  ), []).         
+00016830: 2020 2020 2020 2063 2e65 7865 6375 7465         c.execute
+00016840: 2827 7365 6c65 6374 202a 2066 726f 6d20  ('select * from 
+00016850: 636f 756e 7472 7927 290a 2020 2020 2020  country').      
+00016860: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00016870: 7373 6572 7447 7265 6174 6572 286c 656e  ssertGreater(len
+00016880: 2863 2e66 6574 6368 616c 6c28 2929 2c20  (c.fetchall()), 
+00016890: 3029 0a20 2020 2064 6566 2074 6573 745f  0).    def test_
+000168a0: 7265 7374 6f72 6528 7365 6c66 293a 0a20  restore(self):. 
+000168b0: 2020 2020 2020 2064 6566 2066 6574 6368         def fetch
+000168c0: 6c69 6e65 286c 696e 6529 3a0a 2020 2020  line(line):.    
+000168d0: 2020 2020 2020 2020 6f75 7470 7574 2e61          output.a
+000168e0: 7070 656e 6428 6c69 6e65 290a 0a20 2020  ppend(line)..   
+000168f0: 2020 2020 206f 7574 7075 7420 3d20 5b5d       output = []
+00016900: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
+00016910: 632e 6461 7461 6261 7365 2e62 6163 6b75  c.database.backu
+00016920: 7028 6461 7461 6261 7365 3d27 656d 706c  p(database='empl
+00016930: 6f79 6565 272c 2062 6163 6b75 703d 7365  oyee', backup=se
+00016940: 6c66 2e66 626b 2c20 6361 6c6c 6261 636b  lf.fbk, callback
+00016950: 3d66 6574 6368 6c69 6e65 290a 2020 2020  =fetchline).    
+00016960: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00016970: 7275 6528 6f73 2e70 6174 682e 6578 6973  rue(os.path.exis
+00016980: 7473 2873 656c 662e 6662 6b29 290a 2020  ts(self.fbk)).  
+00016990: 2020 2020 2020 7365 6c66 2e73 7663 2e64        self.svc.d
+000169a0: 6174 6162 6173 652e 7265 7374 6f72 6528  atabase.restore(
+000169b0: 6261 636b 7570 3d73 656c 662e 6662 6b2c  backup=self.fbk,
+000169c0: 2064 6174 6162 6173 653d 7365 6c66 2e72   database=self.r
+000169d0: 6664 622c 2066 6c61 6773 3d53 7276 5265  fdb, flags=SrvRe
+000169e0: 7374 6f72 6546 6c61 672e 5245 504c 4143  storeFlag.REPLAC
+000169f0: 4529 0a20 2020 2020 2020 2073 656c 662e  E).        self.
+00016a00: 6173 7365 7274 5472 7565 2873 656c 662e  assertTrue(self.
+00016a10: 7376 632e 6973 5f72 756e 6e69 6e67 2829  svc.is_running()
+00016a20: 290a 2020 2020 2020 2020 2320 6665 7463  ).        # fetc
+00016a30: 6820 6d61 7465 7269 616c 697a 6564 0a20  h materialized. 
+00016a40: 2020 2020 2020 2072 6570 6f72 7420 3d20         report = 
+00016a50: 7365 6c66 2e73 7663 2e72 6561 646c 696e  self.svc.readlin
+00016a60: 6573 2829 0a20 2020 2020 2020 2073 656c  es().        sel
+00016a70: 662e 6173 7365 7274 4661 6c73 6528 7365  f.assertFalse(se
+00016a80: 6c66 2e73 7663 2e69 735f 7275 6e6e 696e  lf.svc.is_runnin
+00016a90: 6728 2929 0a20 2020 2020 2020 2073 656c  g()).        sel
+00016aa0: 662e 6173 7365 7274 4973 496e 7374 616e  f.assertIsInstan
+00016ab0: 6365 2872 6570 6f72 742c 2074 7970 6528  ce(report, type(
+00016ac0: 6c69 7374 2829 2929 0a20 2020 2020 2020  list())).       
+00016ad0: 2023 2069 7465 7261 7465 206f 7665 7220   # iterate over 
+00016ae0: 7265 7375 6c74 0a20 2020 2020 2020 2073  result.        s
+00016af0: 656c 662e 7376 632e 6461 7461 6261 7365  elf.svc.database
+00016b00: 2e72 6573 746f 7265 2862 6163 6b75 703d  .restore(backup=
+00016b10: 7365 6c66 2e66 626b 2c20 6461 7461 6261  self.fbk, databa
+00016b20: 7365 3d73 656c 662e 7266 6462 2c20 666c  se=self.rfdb, fl
+00016b30: 6167 733d 5372 7652 6573 746f 7265 466c  ags=SrvRestoreFl
+00016b40: 6167 2e52 4550 4c41 4345 290a 2020 2020  ag.REPLACE).    
+00016b50: 2020 2020 666f 7220 6c69 6e65 2069 6e20      for line in 
+00016b60: 7365 6c66 2e73 7663 3a0a 2020 2020 2020  self.svc:.      
+00016b70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00016b80: 7449 734e 6f74 4e6f 6e65 286c 696e 6529  tIsNotNone(line)
+00016b90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00016ba0: 662e 6173 7365 7274 4973 496e 7374 616e  f.assertIsInstan
+00016bb0: 6365 286c 696e 652c 2073 7472 290a 2020  ce(line, str).  
+00016bc0: 2020 2020 2020 2320 6361 6c6c 6261 636b        # callback
+00016bd0: 0a20 2020 2020 2020 206f 7574 7075 7420  .        output 
+00016be0: 3d20 5b5d 0a20 2020 2020 2020 2073 656c  = [].        sel
+00016bf0: 662e 7376 632e 6461 7461 6261 7365 2e72  f.svc.database.r
+00016c00: 6573 746f 7265 2862 6163 6b75 703d 7365  estore(backup=se
+00016c10: 6c66 2e66 626b 2c20 6461 7461 6261 7365  lf.fbk, database
+00016c20: 3d73 656c 662e 7266 6462 2c20 7665 7262  =self.rfdb, verb
+00016c30: 6f73 653d 5472 7565 2c0a 2020 2020 2020  ose=True,.      
+00016c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c50: 2020 2020 2020 2020 2020 2020 666c 6167              flag
+00016c60: 733d 5372 7652 6573 746f 7265 466c 6167  s=SrvRestoreFlag
+00016c70: 2e52 4550 4c41 4345 2c20 6361 6c6c 6261  .REPLACE, callba
+00016c80: 636b 3d66 6574 6368 6c69 6e65 290a 2020  ck=fetchline).  
+00016c90: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00016ca0: 7447 7265 6174 6572 286c 656e 286f 7574  tGreater(len(out
+00016cb0: 7075 7429 2c20 3029 0a20 2020 2020 2020  put), 0).       
+00016cc0: 2023 2046 6972 6562 6972 6420 332e 3020   # Firebird 3.0 
+00016cd0: 7374 6174 730a 2020 2020 2020 2020 6f75  stats.        ou
+00016ce0: 7470 7574 203d 205b 5d0a 2020 2020 2020  tput = [].      
+00016cf0: 2020 7365 6c66 2e73 7663 2e64 6174 6162    self.svc.datab
+00016d00: 6173 652e 7265 7374 6f72 6528 6261 636b  ase.restore(back
+00016d10: 7570 3d73 656c 662e 6662 6b2c 2064 6174  up=self.fbk, dat
+00016d20: 6162 6173 653d 7365 6c66 2e72 6664 622c  abase=self.rfdb,
+00016d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d50: 2020 2066 6c61 6773 3d53 7276 5265 7374     flags=SrvRest
+00016d60: 6f72 6546 6c61 672e 5245 504c 4143 452c  oreFlag.REPLACE,
+00016d70: 2063 616c 6c62 6163 6b3d 6665 7463 686c   callback=fetchl
+00016d80: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+00016d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016da0: 2020 2020 2020 2073 7461 7473 3d27 5444         stats='TD
+00016db0: 5257 272c 2076 6572 626f 7365 3d54 7275  RW', verbose=Tru
+00016dc0: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+00016dd0: 6173 7365 7274 4772 6561 7465 7228 6c65  assertGreater(le
+00016de0: 6e28 6f75 7470 7574 292c 2030 290a 2020  n(output), 0).  
+00016df0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00016e00: 7449 6e28 2767 6261 6b3a 2074 696d 6520  tIn('gbak: time 
+00016e10: 2020 2020 6465 6c74 6120 2072 6561 6473      delta  reads
+00016e20: 2020 7772 6974 6573 205c 6e27 2c20 6f75    writes \n', ou
+00016e30: 7470 7574 290a 2020 2020 2020 2020 2320  tput).        # 
+00016e40: 536b 6970 2064 6174 6120 6f70 7469 6f6e  Skip data option
+00016e50: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
+00016e60: 632e 6461 7461 6261 7365 2e72 6573 746f  c.database.resto
+00016e70: 7265 2862 6163 6b75 703d 7365 6c66 2e66  re(backup=self.f
+00016e80: 626b 2c20 6461 7461 6261 7365 3d73 656c  bk, database=sel
+00016e90: 662e 7266 6462 2c0a 2020 2020 2020 2020  f.rfdb,.        
+00016ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016eb0: 2020 2020 2020 2020 2020 666c 6167 733d            flags=
+00016ec0: 5372 7652 6573 746f 7265 466c 6167 2e52  SrvRestoreFlag.R
+00016ed0: 4550 4c41 4345 2c20 736b 6970 5f64 6174  EPLACE, skip_dat
+00016ee0: 613d 2728 7361 6c65 737c 6375 7374 6f6d  a='(sales|custom
+00016ef0: 6572 2927 290a 2020 2020 2020 2020 7365  er)').        se
+00016f00: 6c66 2e73 7663 2e77 6169 7428 290a 2020  lf.svc.wait().  
+00016f10: 2020 2020 2020 7769 7468 2063 6f6e 6e65        with conne
+00016f20: 6374 2866 227b 4642 5445 5354 5f48 4f53  ct(f"{FBTEST_HOS
+00016f30: 547d 3a7b 7365 6c66 2e72 6664 627d 222c  T}:{self.rfdb}",
+00016f40: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
+00016f50: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
+00016f60: 5354 5f50 4153 5357 4f52 4429 2061 7320  ST_PASSWORD) as 
+00016f70: 7263 6f6e 3a0a 2020 2020 2020 2020 2020  rcon:.          
+00016f80: 2020 7263 6f6e 2e5f 6c6f 6767 696e 675f    rcon._logging_
+00016f90: 6964 5f20 3d20 7365 6c66 2e5f 5f63 6c61  id_ = self.__cla
+00016fa0: 7373 5f5f 2e5f 5f6e 616d 655f 5f0a 2020  ss__.__name__.  
+00016fb0: 2020 2020 2020 2020 2020 7769 7468 2072            with r
+00016fc0: 636f 6e2e 6375 7273 6f72 2829 2061 7320  con.cursor() as 
+00016fd0: 633a 0a20 2020 2020 2020 2020 2020 2020  c:.             
+00016fe0: 2020 2063 2e65 7865 6375 7465 2827 7365     c.execute('se
+00016ff0: 6c65 6374 202a 2066 726f 6d20 7361 6c65  lect * from sale
+00017000: 7327 290a 2020 2020 2020 2020 2020 2020  s').            
+00017010: 2020 2020 7365 6c66 2e61 7373 6572 744c      self.assertL
+00017020: 6973 7445 7175 616c 2863 2e66 6574 6368  istEqual(c.fetch
+00017030: 616c 6c28 292c 205b 5d29 0a20 2020 2020  all(), []).     
+00017040: 2020 2020 2020 2020 2020 2063 2e65 7865             c.exe
+00017050: 6375 7465 2827 7365 6c65 6374 202a 2066  cute('select * f
+00017060: 726f 6d20 636f 756e 7472 7927 290a 2020  rom country').  
+00017070: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00017080: 6c66 2e61 7373 6572 7447 7265 6174 6572  lf.assertGreater
+00017090: 286c 656e 2863 2e66 6574 6368 616c 6c28  (len(c.fetchall(
+000170a0: 2929 2c20 3029 0a20 2020 2064 6566 2074  )), 0).    def t
+000170b0: 6573 745f 6c6f 6361 6c5f 6261 636b 7570  est_local_backup
+000170c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000170d0: 7365 6c66 2e73 7663 2e64 6174 6162 6173  self.svc.databas
+000170e0: 652e 6261 636b 7570 2864 6174 6162 6173  e.backup(databas
+000170f0: 653d 2765 6d70 6c6f 7965 6527 2c20 6261  e='employee', ba
+00017100: 636b 7570 3d73 656c 662e 6662 6b29 0a20  ckup=self.fbk). 
+00017110: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
+00017120: 7761 6974 2829 0a20 2020 2020 2020 2077  wait().        w
+00017130: 6974 6820 6f70 656e 2873 656c 662e 6662  ith open(self.fb
+00017140: 6b2c 206d 6f64 653d 2772 6227 2920 6173  k, mode='rb') as
+00017150: 2066 3a0a 2020 2020 2020 2020 2020 2020   f:.            
+00017160: 662e 7365 656b 2836 3829 2020 2320 5765  f.seek(68)  # We
+00017170: 6520 6d75 7374 2073 6b69 7020 6166 7465  e must skip afte
+00017180: 7220 6261 636b 7570 2063 7265 6174 696f  r backup creatio
+00017190: 6e20 7469 6d65 2028 3638 2920 7468 6174  n time (68) that
+000171a0: 2077 696c 6c20 6469 6666 6572 0a20 2020   will differ.   
+000171b0: 2020 2020 2020 2020 2062 6b70 203d 2066           bkp = f
+000171c0: 2e72 6561 6428 290a 2020 2020 2020 2020  .read().        
+000171d0: 6261 636b 7570 5f73 7472 6561 6d20 3d20  backup_stream = 
+000171e0: 4279 7465 7349 4f28 290a 2020 2020 2020  BytesIO().      
+000171f0: 2020 7365 6c66 2e73 7663 2e64 6174 6162    self.svc.datab
+00017200: 6173 652e 6c6f 6361 6c5f 6261 636b 7570  ase.local_backup
+00017210: 2864 6174 6162 6173 653d 2765 6d70 6c6f  (database='emplo
+00017220: 7965 6527 2c20 6261 636b 7570 5f73 7472  yee', backup_str
+00017230: 6561 6d3d 6261 636b 7570 5f73 7472 6561  eam=backup_strea
+00017240: 6d29 0a20 2020 2020 2020 2062 6163 6b75  m).        backu
+00017250: 705f 7374 7265 616d 2e73 6565 6b28 3638  p_stream.seek(68
+00017260: 290a 2020 2020 2020 2020 6c62 6b70 203d  ).        lbkp =
+00017270: 2062 6163 6b75 705f 7374 7265 616d 2e72   backup_stream.r
+00017280: 6561 6428 290a 2020 2020 2020 2020 7374  ead().        st
+00017290: 6f70 203d 206d 696e 286c 656e 2862 6b70  op = min(len(bkp
+000172a0: 292c 206c 656e 286c 626b 7029 290a 2020  ), len(lbkp)).  
+000172b0: 2020 2020 2020 6920 3d20 300a 2020 2020        i = 0.    
+000172c0: 2020 2020 7768 696c 6520 6920 3c20 7374      while i < st
+000172d0: 6f70 3a0a 2020 2020 2020 2020 2020 2020  op:.            
+000172e0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+000172f0: 2862 6b70 5b69 5d2c 206c 626b 705b 695d  (bkp[i], lbkp[i]
+00017300: 2c20 6622 6279 7465 7320 6469 6666 6572  , f"bytes differ
+00017310: 2061 7420 7b69 7d20 287b 692b 3638 7d29   at {i} ({i+68})
+00017320: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
+00017330: 202b 3d20 310a 2020 2020 2020 2020 6465   += 1.        de
+00017340: 6c20 626b 700a 2020 2020 6465 6620 7465  l bkp.    def te
+00017350: 7374 5f6c 6f63 616c 5f72 6573 746f 7265  st_local_restore
+00017360: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00017370: 6261 636b 7570 5f73 7472 6561 6d20 3d20  backup_stream = 
+00017380: 4279 7465 7349 4f28 290a 2020 2020 2020  BytesIO().      
+00017390: 2020 7365 6c66 2e73 7663 2e64 6174 6162    self.svc.datab
+000173a0: 6173 652e 6c6f 6361 6c5f 6261 636b 7570  ase.local_backup
+000173b0: 2864 6174 6162 6173 653d 2765 6d70 6c6f  (database='emplo
+000173c0: 7965 6527 2c20 6261 636b 7570 5f73 7472  yee', backup_str
+000173d0: 6561 6d3d 6261 636b 7570 5f73 7472 6561  eam=backup_strea
+000173e0: 6d29 0a20 2020 2020 2020 2062 6163 6b75  m).        backu
+000173f0: 705f 7374 7265 616d 2e73 6565 6b28 3029  p_stream.seek(0)
+00017400: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
+00017410: 632e 6461 7461 6261 7365 2e6c 6f63 616c  c.database.local
+00017420: 5f72 6573 746f 7265 2862 6163 6b75 705f  _restore(backup_
+00017430: 7374 7265 616d 3d62 6163 6b75 705f 7374  stream=backup_st
+00017440: 7265 616d 2c20 6461 7461 6261 7365 3d73  ream, database=s
+00017450: 656c 662e 7266 6462 2c0a 2020 2020 2020  elf.rfdb,.      
+00017460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017480: 2020 666c 6167 733d 5372 7652 6573 746f    flags=SrvResto
+00017490: 7265 466c 6167 2e52 4550 4c41 4345 290a  reFlag.REPLACE).
+000174a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000174b0: 6572 7454 7275 6528 6f73 2e70 6174 682e  ertTrue(os.path.
+000174c0: 6578 6973 7473 2873 656c 662e 7266 6462  exists(self.rfdb
+000174d0: 2929 0a20 2020 2064 6566 2074 6573 745f  )).    def test_
+000174e0: 6e62 6163 6b75 7028 7365 6c66 293a 0a20  nbackup(self):. 
+000174f0: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
+00017500: 6461 7461 6261 7365 2e6e 6261 636b 7570  database.nbackup
+00017510: 2864 6174 6162 6173 653d 2765 6d70 6c6f  (database='emplo
+00017520: 7965 6527 2c20 6261 636b 7570 3d73 656c  yee', backup=sel
+00017530: 662e 6662 6b29 0a20 2020 2020 2020 2073  f.fbk).        s
+00017540: 656c 662e 6173 7365 7274 5472 7565 286f  elf.assertTrue(o
+00017550: 732e 7061 7468 2e65 7869 7374 7328 7365  s.path.exists(se
+00017560: 6c66 2e66 626b 2929 0a20 2020 2020 2020  lf.fbk)).       
+00017570: 2073 656c 662e 7376 632e 6461 7461 6261   self.svc.databa
+00017580: 7365 2e6e 6261 636b 7570 2864 6174 6162  se.nbackup(datab
+00017590: 6173 653d 2765 6d70 6c6f 7965 6527 2c20  ase='employee', 
+000175a0: 6261 636b 7570 3d73 656c 662e 6662 6b32  backup=self.fbk2
+000175b0: 2c20 6c65 7665 6c3d 312c 0a20 2020 2020  , level=1,.     
+000175c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000175d0: 2020 2020 2020 2020 2020 2020 2064 6972               dir
+000175e0: 6563 743d 5472 7565 2c20 666c 6167 733d  ect=True, flags=
+000175f0: 5372 764e 4261 636b 7570 466c 6167 2e4e  SrvNBackupFlag.N
+00017600: 4f5f 5452 4947 4745 5253 290a 2020 2020  O_TRIGGERS).    
+00017610: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+00017620: 7275 6528 6f73 2e70 6174 682e 6578 6973  rue(os.path.exis
+00017630: 7473 2873 656c 662e 6662 6b32 2929 0a20  ts(self.fbk2)). 
+00017640: 2020 2064 6566 2074 6573 745f 6e72 6573     def test_nres
+00017650: 746f 7265 2873 656c 6629 3a0a 2020 2020  tore(self):.    
+00017660: 2020 2020 7365 6c66 2e74 6573 745f 6e62      self.test_nb
+00017670: 6163 6b75 7028 290a 2020 2020 2020 2020  ackup().        
+00017680: 6966 206f 732e 7061 7468 2e65 7869 7374  if os.path.exist
+00017690: 7328 7365 6c66 2e72 6664 6229 3a0a 2020  s(self.rfdb):.  
+000176a0: 2020 2020 2020 2020 2020 6f73 2e72 656d            os.rem
+000176b0: 6f76 6528 7365 6c66 2e72 6664 6229 0a20  ove(self.rfdb). 
+000176c0: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
+000176d0: 6461 7461 6261 7365 2e6e 7265 7374 6f72  database.nrestor
+000176e0: 6528 6261 636b 7570 733d 5b73 656c 662e  e(backups=[self.
+000176f0: 6662 6b5d 2c20 6461 7461 6261 7365 3d73  fbk], database=s
+00017700: 656c 662e 7266 6462 290a 2020 2020 2020  elf.rfdb).      
+00017710: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+00017720: 6528 6f73 2e70 6174 682e 6578 6973 7473  e(os.path.exists
+00017730: 2873 656c 662e 7266 6462 2929 0a20 2020  (self.rfdb)).   
+00017740: 2020 2020 2069 6620 6f73 2e70 6174 682e       if os.path.
+00017750: 6578 6973 7473 2873 656c 662e 7266 6462  exists(self.rfdb
+00017760: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
+00017770: 732e 7265 6d6f 7665 2873 656c 662e 7266  s.remove(self.rf
+00017780: 6462 290a 2020 2020 2020 2020 7365 6c66  db).        self
+00017790: 2e73 7663 2e64 6174 6162 6173 652e 6e72  .svc.database.nr
+000177a0: 6573 746f 7265 2862 6163 6b75 7073 3d5b  estore(backups=[
+000177b0: 7365 6c66 2e66 626b 2c20 7365 6c66 2e66  self.fbk, self.f
+000177c0: 626b 325d 2c20 6461 7461 6261 7365 3d73  bk2], database=s
+000177d0: 656c 662e 7266 6462 2c0a 2020 2020 2020  elf.rfdb,.      
+000177e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177f0: 2020 2020 6469 7265 6374 3d54 7275 652c      direct=True,
+00017800: 2066 6c61 6773 3d53 7276 4e42 6163 6b75   flags=SrvNBacku
+00017810: 7046 6c61 672e 4e4f 5f54 5249 4747 4552  pFlag.NO_TRIGGER
+00017820: 5329 0a20 2020 2020 2020 2073 656c 662e  S).        self.
+00017830: 6173 7365 7274 5472 7565 286f 732e 7061  assertTrue(os.pa
+00017840: 7468 2e65 7869 7374 7328 7365 6c66 2e72  th.exists(self.r
+00017850: 6664 6229 290a 2020 2020 6465 6620 7465  fdb)).    def te
+00017860: 7374 5f73 6574 5f64 6566 6175 6c74 5f63  st_set_default_c
+00017870: 6163 6865 5f73 697a 6528 7365 6c66 293a  ache_size(self):
+00017880: 0a20 2020 2020 2020 2077 6974 6820 636f  .        with co
+00017890: 6e6e 6563 7428 6622 7b46 4254 4553 545f  nnect(f"{FBTEST_
+000178a0: 484f 5354 7d3a 7b73 656c 662e 7266 6462  HOST}:{self.rfdb
+000178b0: 7d22 2c20 7573 6572 3d46 4254 4553 545f  }", user=FBTEST_
+000178c0: 5553 4552 2c20 7061 7373 776f 7264 3d46  USER, password=F
+000178d0: 4254 4553 545f 5041 5353 574f 5244 2920  BTEST_PASSWORD) 
+000178e0: 6173 2063 6f6e 3a0a 2020 2020 2020 2020  as con:.        
+000178f0: 2020 2020 636f 6e2e 5f6c 6f67 6769 6e67      con._logging
+00017900: 5f69 645f 203d 2073 656c 662e 5f5f 636c  _id_ = self.__cl
+00017910: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20  ass__.__name__. 
+00017920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00017930: 6173 7365 7274 4e6f 7445 7175 616c 2863  assertNotEqual(c
+00017940: 6f6e 2e69 6e66 6f2e 7061 6765 5f63 6163  on.info.page_cac
+00017950: 6865 5f73 697a 652c 2031 3030 290a 2020  he_size, 100).  
+00017960: 2020 2020 2020 7365 6c66 2e73 7663 2e64        self.svc.d
+00017970: 6174 6162 6173 652e 7365 745f 6465 6661  atabase.set_defa
+00017980: 756c 745f 6361 6368 655f 7369 7a65 2864  ult_cache_size(d
+00017990: 6174 6162 6173 653d 7365 6c66 2e72 6664  atabase=self.rfd
+000179a0: 622c 2073 697a 653d 3130 3029 0a20 2020  b, size=100).   
+000179b0: 2020 2020 2077 6974 6820 636f 6e6e 6563       with connec
+000179c0: 7428 6622 7b46 4254 4553 545f 484f 5354  t(f"{FBTEST_HOST
+000179d0: 7d3a 7b73 656c 662e 7266 6462 7d22 2c20  }:{self.rfdb}", 
+000179e0: 7573 6572 3d46 4254 4553 545f 5553 4552  user=FBTEST_USER
+000179f0: 2c20 7061 7373 776f 7264 3d46 4254 4553  , password=FBTES
+00017a00: 545f 5041 5353 574f 5244 2920 6173 2063  T_PASSWORD) as c
+00017a10: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00017a20: 636f 6e2e 5f6c 6f67 6769 6e67 5f69 645f  con._logging_id_
+00017a30: 203d 2073 656c 662e 5f5f 636c 6173 735f   = self.__class_
+00017a40: 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020 2020  _.__name__.     
+00017a50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00017a60: 7274 4571 7561 6c28 636f 6e2e 696e 666f  rtEqual(con.info
+00017a70: 2e70 6167 655f 6361 6368 655f 7369 7a65  .page_cache_size
+00017a80: 2c20 3130 3029 0a20 2020 2020 2020 2073  , 100).        s
+00017a90: 656c 662e 7376 632e 6461 7461 6261 7365  elf.svc.database
+00017aa0: 2e73 6574 5f64 6566 6175 6c74 5f63 6163  .set_default_cac
+00017ab0: 6865 5f73 697a 6528 6461 7461 6261 7365  he_size(database
+00017ac0: 3d73 656c 662e 7266 6462 2c20 7369 7a65  =self.rfdb, size
+00017ad0: 3d35 3030 3029 0a20 2020 2020 2020 2077  =5000).        w
+00017ae0: 6974 6820 636f 6e6e 6563 7428 6622 7b46  ith connect(f"{F
+00017af0: 4254 4553 545f 484f 5354 7d3a 7b73 656c  BTEST_HOST}:{sel
+00017b00: 662e 7266 6462 7d22 2c20 7573 6572 3d46  f.rfdb}", user=F
+00017b10: 4254 4553 545f 5553 4552 2c20 7061 7373  BTEST_USER, pass
+00017b20: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
+00017b30: 574f 5244 2920 6173 2063 6f6e 3a0a 2020  WORD) as con:.  
+00017b40: 2020 2020 2020 2020 2020 636f 6e2e 5f6c            con._l
+00017b50: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
+00017b60: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+00017b70: 6d65 5f5f 0a20 2020 2020 2020 2020 2020  me__.           
+00017b80: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00017b90: 6c28 636f 6e2e 696e 666f 2e70 6167 655f  l(con.info.page_
+00017ba0: 6361 6368 655f 7369 7a65 2c20 3530 3030  cache_size, 5000
+00017bb0: 290a 2020 2020 6465 6620 7465 7374 5f73  ).    def test_s
+00017bc0: 6574 5f73 7765 6570 5f69 6e74 6572 7661  et_sweep_interva
+00017bd0: 6c28 7365 6c66 293a 0a20 2020 2020 2020  l(self):.       
+00017be0: 2077 6974 6820 636f 6e6e 6563 7428 6622   with connect(f"
+00017bf0: 7b46 4254 4553 545f 484f 5354 7d3a 7b73  {FBTEST_HOST}:{s
+00017c00: 656c 662e 7266 6462 7d22 2c20 7573 6572  elf.rfdb}", user
+00017c10: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
+00017c20: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+00017c30: 5353 574f 5244 2920 6173 2063 6f6e 3a0a  SSWORD) as con:.
+00017c40: 2020 2020 2020 2020 2020 2020 636f 6e2e              con.
+00017c50: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
+00017c60: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+00017c70: 6e61 6d65 5f5f 0a20 2020 2020 2020 2020  name__.         
+00017c80: 2020 2073 656c 662e 6173 7365 7274 4e6f     self.assertNo
+00017c90: 7445 7175 616c 2863 6f6e 2e69 6e66 6f2e  tEqual(con.info.
+00017ca0: 7377 6565 705f 696e 7465 7276 616c 2c20  sweep_interval, 
+00017cb0: 3130 3030 3029 0a20 2020 2020 2020 2073  10000).        s
+00017cc0: 656c 662e 7376 632e 6461 7461 6261 7365  elf.svc.database
+00017cd0: 2e73 6574 5f73 7765 6570 5f69 6e74 6572  .set_sweep_inter
+00017ce0: 7661 6c28 6461 7461 6261 7365 3d73 656c  val(database=sel
+00017cf0: 662e 7266 6462 2c20 696e 7465 7276 616c  f.rfdb, interval
+00017d00: 3d31 3030 3030 290a 2020 2020 2020 2020  =10000).        
+00017d10: 7769 7468 2063 6f6e 6e65 6374 2866 227b  with connect(f"{
+00017d20: 4642 5445 5354 5f48 4f53 547d 3a7b 7365  FBTEST_HOST}:{se
+00017d30: 6c66 2e72 6664 627d 222c 2075 7365 723d  lf.rfdb}", user=
+00017d40: 4642 5445 5354 5f55 5345 522c 2070 6173  FBTEST_USER, pas
+00017d50: 7377 6f72 643d 4642 5445 5354 5f50 4153  sword=FBTEST_PAS
+00017d60: 5357 4f52 4429 2061 7320 636f 6e3a 0a20  SWORD) as con:. 
+00017d70: 2020 2020 2020 2020 2020 2063 6f6e 2e5f             con._
+00017d80: 6c6f 6767 696e 675f 6964 5f20 3d20 7365  logging_id_ = se
+00017d90: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+00017da0: 616d 655f 5f0a 2020 2020 2020 2020 2020  ame__.          
+00017db0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00017dc0: 616c 2863 6f6e 2e69 6e66 6f2e 7377 6565  al(con.info.swee
+00017dd0: 705f 696e 7465 7276 616c 2c20 3130 3030  p_interval, 1000
+00017de0: 3029 0a20 2020 2064 6566 2074 6573 745f  0).    def test_
+00017df0: 7368 7574 646f 776e 5f62 7269 6e67 5f6f  shutdown_bring_o
+00017e00: 6e6c 696e 6528 7365 6c66 293a 0a20 2020  nline(self):.   
+00017e10: 2020 2020 2023 7365 6c66 2e73 6b69 7054       #self.skipT
+00017e20: 6573 7428 274e 6f74 2069 6d70 6c65 6d65  est('Not impleme
+00017e30: 6e74 6564 2079 6574 2729 0a20 2020 2020  nted yet').     
+00017e40: 2020 2023 2053 6875 7464 6f77 6e20 6461     # Shutdown da
+00017e50: 7461 6261 7365 2074 6f20 7369 6e67 6c65  tabase to single
+00017e60: 2d75 7365 7220 6d61 696e 7465 6e61 6e63  -user maintenanc
+00017e70: 6520 6d6f 6465 0a20 2020 2020 2020 2073  e mode.        s
+00017e80: 656c 662e 7376 632e 6461 7461 6261 7365  elf.svc.database
+00017e90: 2e73 6875 7464 6f77 6e28 6461 7461 6261  .shutdown(databa
+00017ea0: 7365 3d73 656c 662e 7266 6462 2c6d 6f64  se=self.rfdb,mod
+00017eb0: 653d 5368 7574 646f 776e 4d6f 6465 2e53  e=ShutdownMode.S
+00017ec0: 494e 474c 452c 0a20 2020 2020 2020 2020  INGLE,.         
+00017ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ee0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00017ef0: 3d53 6875 7464 6f77 6e4d 6574 686f 642e  =ShutdownMethod.
+00017f00: 464f 5243 4544 2c20 7469 6d65 6f75 743d  FORCED, timeout=
+00017f10: 3029 0a20 2020 2020 2020 2073 656c 662e  0).        self.
+00017f20: 7376 632e 6461 7461 6261 7365 2e67 6574  svc.database.get
+00017f30: 5f73 7461 7469 7374 6963 7328 6461 7461  _statistics(data
+00017f40: 6261 7365 3d73 656c 662e 7266 6462 2c20  base=self.rfdb, 
+00017f50: 666c 6167 733d 5372 7653 7461 7446 6c61  flags=SrvStatFla
+00017f60: 672e 4844 525f 5041 4745 5329 0a20 2020  g.HDR_PAGES).   
+00017f70: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00017f80: 496e 2827 7369 6e67 6c65 2d75 7365 7220  In('single-user 
+00017f90: 6d61 696e 7465 6e61 6e63 6527 2c20 2727  maintenance', ''
+00017fa0: 2e6a 6f69 6e28 7365 6c66 2e73 7663 2e72  .join(self.svc.r
+00017fb0: 6561 646c 696e 6573 2829 2929 0a20 2020  eadlines())).   
+00017fc0: 2020 2020 2023 2045 6e61 626c 6520 6d75       # Enable mu
+00017fd0: 6c74 692d 7573 6572 206d 6169 6e74 656e  lti-user mainten
+00017fe0: 616e 6365 0a20 2020 2020 2020 2073 656c  ance.        sel
+00017ff0: 662e 7376 632e 6461 7461 6261 7365 2e62  f.svc.database.b
+00018000: 7269 6e67 5f6f 6e6c 696e 6528 6461 7461  ring_online(data
+00018010: 6261 7365 3d73 656c 662e 7266 6462 2c20  base=self.rfdb, 
+00018020: 6d6f 6465 3d4f 6e6c 696e 654d 6f64 652e  mode=OnlineMode.
+00018030: 4d55 4c54 4929 0a20 2020 2020 2020 2073  MULTI).        s
+00018040: 656c 662e 7376 632e 6461 7461 6261 7365  elf.svc.database
+00018050: 2e67 6574 5f73 7461 7469 7374 6963 7328  .get_statistics(
+00018060: 6461 7461 6261 7365 3d73 656c 662e 7266  database=self.rf
+00018070: 6462 2c20 666c 6167 733d 5372 7653 7461  db, flags=SrvSta
+00018080: 7446 6c61 672e 4844 525f 5041 4745 5329  tFlag.HDR_PAGES)
+00018090: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000180a0: 7365 7274 496e 2827 6d75 6c74 692d 7573  sertIn('multi-us
+000180b0: 6572 206d 6169 6e74 656e 616e 6365 272c  er maintenance',
+000180c0: 2027 272e 6a6f 696e 2873 656c 662e 7376   ''.join(self.sv
+000180d0: 632e 7265 6164 6c69 6e65 7328 2929 290a  c.readlines())).
+000180e0: 2020 2020 2020 2020 2320 476f 2074 6f20          # Go to 
+000180f0: 6675 6c6c 2073 6875 7464 6f77 6e20 6d6f  full shutdown mo
+00018100: 6465 2c20 6469 7361 626c 696e 6720 6e65  de, disabling ne
+00018110: 7720 6174 7461 6368 6d65 6e74 7320 6475  w attachments du
+00018120: 7269 6e67 2035 2073 6563 6f6e 6473 0a20  ring 5 seconds. 
+00018130: 2020 2020 2020 2073 656c 662e 7376 632e         self.svc.
+00018140: 6461 7461 6261 7365 2e73 6875 7464 6f77  database.shutdow
+00018150: 6e28 6461 7461 6261 7365 3d73 656c 662e  n(database=self.
+00018160: 7266 6462 2c20 6d6f 6465 3d53 6875 7464  rfdb, mode=Shutd
+00018170: 6f77 6e4d 6f64 652e 4655 4c4c 2c0a 2020  ownMode.FULL,.  
+00018180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181a0: 206d 6574 686f 643d 5368 7574 646f 776e   method=Shutdown
+000181b0: 4d65 7468 6f64 2e44 454e 595f 4154 5441  Method.DENY_ATTA
+000181c0: 4348 4d45 4e54 532c 2074 696d 656f 7574  CHMENTS, timeout
+000181d0: 3d35 290a 2020 2020 2020 2020 7365 6c66  =5).        self
+000181e0: 2e73 7663 2e64 6174 6162 6173 652e 6765  .svc.database.ge
+000181f0: 745f 7374 6174 6973 7469 6373 2864 6174  t_statistics(dat
+00018200: 6162 6173 653d 7365 6c66 2e72 6664 622c  abase=self.rfdb,
+00018210: 2066 6c61 6773 3d53 7276 5374 6174 466c   flags=SrvStatFl
+00018220: 6167 2e48 4452 5f50 4147 4553 290a 2020  ag.HDR_PAGES).  
+00018230: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00018240: 7449 6e28 2766 756c 6c20 7368 7574 646f  tIn('full shutdo
+00018250: 776e 272c 2027 272e 6a6f 696e 2873 656c  wn', ''.join(sel
+00018260: 662e 7376 632e 7265 6164 6c69 6e65 7328  f.svc.readlines(
+00018270: 2929 290a 2020 2020 2020 2020 2320 456e  ))).        # En
+00018280: 6162 6c65 2073 696e 676c 652d 7573 6572  able single-user
+00018290: 206d 6169 6e74 656e 616e 6365 0a20 2020   maintenance.   
+000182a0: 2020 2020 2073 656c 662e 7376 632e 6461       self.svc.da
+000182b0: 7461 6261 7365 2e62 7269 6e67 5f6f 6e6c  tabase.bring_onl
+000182c0: 696e 6528 6461 7461 6261 7365 3d73 656c  ine(database=sel
+000182d0: 662e 7266 6462 2c20 6d6f 6465 3d4f 6e6c  f.rfdb, mode=Onl
+000182e0: 696e 654d 6f64 652e 5349 4e47 4c45 290a  ineMode.SINGLE).
+000182f0: 2020 2020 2020 2020 7365 6c66 2e73 7663          self.svc
+00018300: 2e64 6174 6162 6173 652e 6765 745f 7374  .database.get_st
+00018310: 6174 6973 7469 6373 2864 6174 6162 6173  atistics(databas
+00018320: 653d 7365 6c66 2e72 6664 622c 2066 6c61  e=self.rfdb, fla
+00018330: 6773 3d53 7276 5374 6174 466c 6167 2e48  gs=SrvStatFlag.H
+00018340: 4452 5f50 4147 4553 290a 2020 2020 2020  DR_PAGES).      
+00018350: 2020 7365 6c66 2e61 7373 6572 7449 6e28    self.assertIn(
+00018360: 2773 696e 676c 652d 7573 6572 206d 6169  'single-user mai
+00018370: 6e74 656e 616e 6365 272c 2027 272e 6a6f  ntenance', ''.jo
+00018380: 696e 2873 656c 662e 7376 632e 7265 6164  in(self.svc.read
+00018390: 6c69 6e65 7328 2929 290a 2020 2020 2020  lines())).      
+000183a0: 2020 2320 5265 7475 726e 2074 6f20 6e6f    # Return to no
+000183b0: 726d 616c 2073 7461 7465 0a20 2020 2020  rmal state.     
+000183c0: 2020 2073 656c 662e 7376 632e 6461 7461     self.svc.data
+000183d0: 6261 7365 2e62 7269 6e67 5f6f 6e6c 696e  base.bring_onlin
+000183e0: 6528 6461 7461 6261 7365 3d73 656c 662e  e(database=self.
+000183f0: 7266 6462 290a 2020 2020 6465 6620 7465  rfdb).    def te
+00018400: 7374 5f73 6574 5f73 7061 6365 5f72 6573  st_set_space_res
+00018410: 6572 7661 7469 6f6e 2873 656c 6629 3a0a  ervation(self):.
+00018420: 2020 2020 2020 2020 7769 7468 2063 6f6e          with con
+00018430: 6e65 6374 2866 227b 4642 5445 5354 5f48  nect(f"{FBTEST_H
+00018440: 4f53 547d 3a7b 7365 6c66 2e72 6664 627d  OST}:{self.rfdb}
+00018450: 222c 2075 7365 723d 4642 5445 5354 5f55  ", user=FBTEST_U
+00018460: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+00018470: 5445 5354 5f50 4153 5357 4f52 4429 2061  TEST_PASSWORD) a
+00018480: 7320 636f 6e3a 0a20 2020 2020 2020 2020  s con:.         
+00018490: 2020 2063 6f6e 2e5f 6c6f 6767 696e 675f     con._logging_
+000184a0: 6964 5f20 3d20 7365 6c66 2e5f 5f63 6c61  id_ = self.__cla
+000184b0: 7373 5f5f 2e5f 5f6e 616d 655f 5f0a 2020  ss__.__name__.  
+000184c0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000184d0: 7373 6572 7445 7175 616c 2863 6f6e 2e69  ssertEqual(con.i
+000184e0: 6e66 6f2e 7370 6163 655f 7265 7365 7276  nfo.space_reserv
+000184f0: 6174 696f 6e2c 2044 6253 7061 6365 5265  ation, DbSpaceRe
+00018500: 7365 7276 6174 696f 6e2e 5245 5345 5256  servation.RESERV
+00018510: 4529 0a20 2020 2020 2020 2073 656c 662e  E).        self.
+00018520: 7376 632e 6461 7461 6261 7365 2e73 6574  svc.database.set
+00018530: 5f73 7061 6365 5f72 6573 6572 7661 7469  _space_reservati
+00018540: 6f6e 2864 6174 6162 6173 653d 7365 6c66  on(database=self
+00018550: 2e72 6664 622c 206d 6f64 653d 4462 5370  .rfdb, mode=DbSp
+00018560: 6163 6552 6573 6572 7661 7469 6f6e 2e55  aceReservation.U
+00018570: 5345 5f46 554c 4c29 0a20 2020 2020 2020  SE_FULL).       
+00018580: 2077 6974 6820 636f 6e6e 6563 7428 6622   with connect(f"
+00018590: 7b46 4254 4553 545f 484f 5354 7d3a 7b73  {FBTEST_HOST}:{s
+000185a0: 656c 662e 7266 6462 7d22 2c20 7573 6572  elf.rfdb}", user
+000185b0: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
+000185c0: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+000185d0: 5353 574f 5244 2920 6173 2063 6f6e 3a0a  SSWORD) as con:.
+000185e0: 2020 2020 2020 2020 2020 2020 636f 6e2e              con.
+000185f0: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
+00018600: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+00018610: 6e61 6d65 5f5f 0a20 2020 2020 2020 2020  name__.         
+00018620: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00018630: 7561 6c28 636f 6e2e 696e 666f 2e73 7061  ual(con.info.spa
+00018640: 6365 5f72 6573 6572 7661 7469 6f6e 2c20  ce_reservation, 
+00018650: 4462 5370 6163 6552 6573 6572 7661 7469  DbSpaceReservati
+00018660: 6f6e 2e55 5345 5f46 554c 4c29 0a20 2020  on.USE_FULL).   
+00018670: 2064 6566 2074 6573 745f 7365 745f 7772   def test_set_wr
+00018680: 6974 655f 6d6f 6465 2873 656c 6629 3a0a  ite_mode(self):.
+00018690: 2020 2020 2020 2020 7769 7468 2063 6f6e          with con
+000186a0: 6e65 6374 2866 227b 4642 5445 5354 5f48  nect(f"{FBTEST_H
+000186b0: 4f53 547d 3a7b 7365 6c66 2e72 6664 627d  OST}:{self.rfdb}
+000186c0: 222c 2075 7365 723d 4642 5445 5354 5f55  ", user=FBTEST_U
+000186d0: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+000186e0: 5445 5354 5f50 4153 5357 4f52 4429 2061  TEST_PASSWORD) a
+000186f0: 7320 636f 6e3a 0a20 2020 2020 2020 2020  s con:.         
+00018700: 2020 2063 6f6e 2e5f 6c6f 6767 696e 675f     con._logging_
+00018710: 6964 5f20 3d20 7365 6c66 2e5f 5f63 6c61  id_ = self.__cla
+00018720: 7373 5f5f 2e5f 5f6e 616d 655f 5f0a 2020  ss__.__name__.  
+00018730: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00018740: 7373 6572 7445 7175 616c 2863 6f6e 2e69  ssertEqual(con.i
+00018750: 6e66 6f2e 7772 6974 655f 6d6f 6465 2c20  nfo.write_mode, 
+00018760: 4462 5772 6974 654d 6f64 652e 5359 4e43  DbWriteMode.SYNC
+00018770: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
+00018780: 7663 2e64 6174 6162 6173 652e 7365 745f  vc.database.set_
+00018790: 7772 6974 655f 6d6f 6465 2864 6174 6162  write_mode(datab
+000187a0: 6173 653d 7365 6c66 2e72 6664 622c 206d  ase=self.rfdb, m
+000187b0: 6f64 653d 4462 5772 6974 654d 6f64 652e  ode=DbWriteMode.
+000187c0: 4153 594e 4329 0a20 2020 2020 2020 2077  ASYNC).        w
+000187d0: 6974 6820 636f 6e6e 6563 7428 6622 7b46  ith connect(f"{F
+000187e0: 4254 4553 545f 484f 5354 7d3a 7b73 656c  BTEST_HOST}:{sel
+000187f0: 662e 7266 6462 7d22 2c20 7573 6572 3d46  f.rfdb}", user=F
+00018800: 4254 4553 545f 5553 4552 2c20 7061 7373  BTEST_USER, pass
+00018810: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
+00018820: 574f 5244 2920 6173 2063 6f6e 3a0a 2020  WORD) as con:.  
+00018830: 2020 2020 2020 2020 2020 636f 6e2e 5f6c            con._l
+00018840: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
+00018850: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+00018860: 6d65 5f5f 0a20 2020 2020 2020 2020 2020  me__.           
+00018870: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00018880: 6c28 636f 6e2e 696e 666f 2e77 7269 7465  l(con.info.write
+00018890: 5f6d 6f64 652c 2044 6257 7269 7465 4d6f  _mode, DbWriteMo
+000188a0: 6465 2e41 5359 4e43 290a 2020 2020 6465  de.ASYNC).    de
+000188b0: 6620 7465 7374 5f73 6574 5f61 6363 6573  f test_set_acces
+000188c0: 735f 6d6f 6465 2873 656c 6629 3a0a 2020  s_mode(self):.  
+000188d0: 2020 2020 2020 7769 7468 2063 6f6e 6e65        with conne
+000188e0: 6374 2866 227b 4642 5445 5354 5f48 4f53  ct(f"{FBTEST_HOS
+000188f0: 547d 3a7b 7365 6c66 2e72 6664 627d 222c  T}:{self.rfdb}",
+00018900: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
+00018910: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
+00018920: 5354 5f50 4153 5357 4f52 4429 2061 7320  ST_PASSWORD) as 
+00018930: 636f 6e3a 0a20 2020 2020 2020 2020 2020  con:.           
+00018940: 2063 6f6e 2e5f 6c6f 6767 696e 675f 6964   con._logging_id
+00018950: 5f20 3d20 7365 6c66 2e5f 5f63 6c61 7373  _ = self.__class
+00018960: 5f5f 2e5f 5f6e 616d 655f 5f0a 2020 2020  __.__name__.    
+00018970: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00018980: 6572 7445 7175 616c 2863 6f6e 2e69 6e66  ertEqual(con.inf
+00018990: 6f2e 6163 6365 7373 5f6d 6f64 652c 2044  o.access_mode, D
+000189a0: 6241 6363 6573 734d 6f64 652e 5245 4144  bAccessMode.READ
+000189b0: 5f57 5249 5445 290a 2020 2020 2020 2020  _WRITE).        
+000189c0: 7365 6c66 2e73 7663 2e64 6174 6162 6173  self.svc.databas
+000189d0: 652e 7365 745f 6163 6365 7373 5f6d 6f64  e.set_access_mod
+000189e0: 6528 6461 7461 6261 7365 3d73 656c 662e  e(database=self.
+000189f0: 7266 6462 2c20 6d6f 6465 3d44 6241 6363  rfdb, mode=DbAcc
+00018a00: 6573 734d 6f64 652e 5245 4144 5f4f 4e4c  essMode.READ_ONL
+00018a10: 5929 0a20 2020 2020 2020 2077 6974 6820  Y).        with 
+00018a20: 636f 6e6e 6563 7428 6622 7b46 4254 4553  connect(f"{FBTES
+00018a30: 545f 484f 5354 7d3a 7b73 656c 662e 7266  T_HOST}:{self.rf
+00018a40: 6462 7d22 2c20 7573 6572 3d46 4254 4553  db}", user=FBTES
+00018a50: 545f 5553 4552 2c20 7061 7373 776f 7264  T_USER, password
+00018a60: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
+00018a70: 2920 6173 2063 6f6e 3a0a 2020 2020 2020  ) as con:.      
+00018a80: 2020 2020 2020 636f 6e2e 5f6c 6f67 6769        con._loggi
+00018a90: 6e67 5f69 645f 203d 2073 656c 662e 5f5f  ng_id_ = self.__
+00018aa0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+00018ab0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00018ac0: 662e 6173 7365 7274 4571 7561 6c28 636f  f.assertEqual(co
+00018ad0: 6e2e 696e 666f 2e61 6363 6573 735f 6d6f  n.info.access_mo
+00018ae0: 6465 2c20 4462 4163 6365 7373 4d6f 6465  de, DbAccessMode
+00018af0: 2e52 4541 445f 4f4e 4c59 290a 2020 2020  .READ_ONLY).    
+00018b00: 6465 6620 7465 7374 5f73 6574 5f73 716c  def test_set_sql
+00018b10: 5f64 6961 6c65 6374 2873 656c 6629 3a0a  _dialect(self):.
+00018b20: 2020 2020 2020 2020 7769 7468 2063 6f6e          with con
+00018b30: 6e65 6374 2866 227b 4642 5445 5354 5f48  nect(f"{FBTEST_H
+00018b40: 4f53 547d 3a7b 7365 6c66 2e72 6664 627d  OST}:{self.rfdb}
+00018b50: 222c 2075 7365 723d 4642 5445 5354 5f55  ", user=FBTEST_U
+00018b60: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+00018b70: 5445 5354 5f50 4153 5357 4f52 4429 2061  TEST_PASSWORD) a
+00018b80: 7320 636f 6e3a 0a20 2020 2020 2020 2020  s con:.         
+00018b90: 2020 2063 6f6e 2e5f 6c6f 6767 696e 675f     con._logging_
+00018ba0: 6964 5f20 3d20 7365 6c66 2e5f 5f63 6c61  id_ = self.__cla
+00018bb0: 7373 5f5f 2e5f 5f6e 616d 655f 5f0a 2020  ss__.__name__.  
+00018bc0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00018bd0: 7373 6572 7445 7175 616c 2863 6f6e 2e69  ssertEqual(con.i
+00018be0: 6e66 6f2e 7371 6c5f 6469 616c 6563 742c  nfo.sql_dialect,
+00018bf0: 2033 290a 2020 2020 2020 2020 7365 6c66   3).        self
+00018c00: 2e73 7663 2e64 6174 6162 6173 652e 7365  .svc.database.se
+00018c10: 745f 7371 6c5f 6469 616c 6563 7428 6461  t_sql_dialect(da
+00018c20: 7461 6261 7365 3d73 656c 662e 7266 6462  tabase=self.rfdb
+00018c30: 2c20 6469 616c 6563 743d 3129 0a20 2020  , dialect=1).   
+00018c40: 2020 2020 2077 6974 6820 636f 6e6e 6563       with connec
+00018c50: 7428 6622 7b46 4254 4553 545f 484f 5354  t(f"{FBTEST_HOST
+00018c60: 7d3a 7b73 656c 662e 7266 6462 7d22 2c20  }:{self.rfdb}", 
+00018c70: 7573 6572 3d46 4254 4553 545f 5553 4552  user=FBTEST_USER
+00018c80: 2c20 7061 7373 776f 7264 3d46 4254 4553  , password=FBTES
+00018c90: 545f 5041 5353 574f 5244 2920 6173 2063  T_PASSWORD) as c
+00018ca0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00018cb0: 636f 6e2e 5f6c 6f67 6769 6e67 5f69 645f  con._logging_id_
+00018cc0: 203d 2073 656c 662e 5f5f 636c 6173 735f   = self.__class_
+00018cd0: 5f2e 5f5f 6e61 6d65 5f5f 0a20 2020 2020  _.__name__.     
+00018ce0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00018cf0: 7274 4571 7561 6c28 636f 6e2e 696e 666f  rtEqual(con.info
+00018d00: 2e73 716c 5f64 6961 6c65 6374 2c20 3129  .sql_dialect, 1)
+00018d10: 0a20 2020 2064 6566 2074 6573 745f 6163  .    def test_ac
+00018d20: 7469 7661 7465 5f73 6861 646f 7728 7365  tivate_shadow(se
+00018d30: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
+00018d40: 662e 7376 632e 6461 7461 6261 7365 2e61  f.svc.database.a
+00018d50: 6374 6976 6174 655f 7368 6164 6f77 2864  ctivate_shadow(d
+00018d60: 6174 6162 6173 653d 7365 6c66 2e72 6664  atabase=self.rfd
+00018d70: 6229 0a20 2020 2064 6566 2074 6573 745f  b).    def test_
+00018d80: 6e6f 5f6c 696e 6765 7228 7365 6c66 293a  no_linger(self):
+00018d90: 0a20 2020 2020 2020 2073 656c 662e 7376  .        self.sv
+00018da0: 632e 6461 7461 6261 7365 2e6e 6f5f 6c69  c.database.no_li
+00018db0: 6e67 6572 2864 6174 6162 6173 653d 7365  nger(database=se
+00018dc0: 6c66 2e72 6664 6229 0a20 2020 2064 6566  lf.rfdb).    def
+00018dd0: 2074 6573 745f 7377 6565 7028 7365 6c66   test_sweep(self
+00018de0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+00018df0: 7376 632e 6461 7461 6261 7365 2e73 7765  svc.database.swe
+00018e00: 6570 2864 6174 6162 6173 653d 7365 6c66  ep(database=self
+00018e10: 2e72 6664 6229 0a20 2020 2064 6566 2074  .rfdb).    def t
+00018e20: 6573 745f 7265 7061 6972 2873 656c 6629  est_repair(self)
+00018e30: 3a0a 2020 2020 2020 2020 7365 6c66 2e73  :.        self.s
+00018e40: 7663 2e64 6174 6162 6173 652e 7265 7061  vc.database.repa
+00018e50: 6972 2864 6174 6162 6173 653d 7365 6c66  ir(database=self
+00018e60: 2e72 6664 622c 2066 6c61 6773 3d53 7276  .rfdb, flags=Srv
+00018e70: 5265 7061 6972 466c 6167 2e43 4f52 5255  RepairFlag.CORRU
+00018e80: 5054 494f 4e5f 4348 4543 4b29 0a20 2020  PTION_CHECK).   
+00018e90: 2020 2020 2073 656c 662e 7376 632e 6461       self.svc.da
+00018ea0: 7461 6261 7365 2e72 6570 6169 7228 6461  tabase.repair(da
+00018eb0: 7461 6261 7365 3d73 656c 662e 7266 6462  tabase=self.rfdb
+00018ec0: 2c20 666c 6167 733d 5372 7652 6570 6169  , flags=SrvRepai
+00018ed0: 7246 6c61 672e 5245 5041 4952 290a 2020  rFlag.REPAIR).  
+00018ee0: 2020 6465 6620 7465 7374 5f76 616c 6964    def test_valid
+00018ef0: 6174 6528 7365 6c66 293a 0a20 2020 2020  ate(self):.     
+00018f00: 2020 2064 6566 2066 6574 6368 6c69 6e65     def fetchline
+00018f10: 286c 696e 6529 3a0a 2020 2020 2020 2020  (line):.        
+00018f20: 2020 2020 6f75 7470 7574 2e61 7070 656e      output.appen
+00018f30: 6428 6c69 6e65 290a 0a20 2020 2020 2020  d(line)..       
+00018f40: 206f 7574 7075 7420 3d20 5b5d 0a20 2020   output = [].   
+00018f50: 2020 2020 2073 656c 662e 7376 632e 6461       self.svc.da
+00018f60: 7461 6261 7365 2e76 616c 6964 6174 6528  tabase.validate(
+00018f70: 6461 7461 6261 7365 3d73 656c 662e 6462  database=self.db
+00018f80: 6669 6c65 290a 2020 2020 2020 2020 2320  file).        # 
+00018f90: 6665 7463 6820 6d61 7465 7269 616c 697a  fetch materializ
+00018fa0: 6564 0a20 2020 2020 2020 2072 6570 6f72  ed.        repor
+00018fb0: 7420 3d20 7365 6c66 2e73 7663 2e72 6561  t = self.svc.rea
+00018fc0: 646c 696e 6573 2829 0a20 2020 2020 2020  dlines().       
+00018fd0: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
+00018fe0: 6528 7365 6c66 2e73 7663 2e69 735f 7275  e(self.svc.is_ru
+00018ff0: 6e6e 696e 6728 2929 0a20 2020 2020 2020  nning()).       
+00019000: 2073 656c 662e 6173 7365 7274 4973 496e   self.assertIsIn
+00019010: 7374 616e 6365 2872 6570 6f72 742c 2074  stance(report, t
+00019020: 7970 6528 6c69 7374 2829 2929 0a20 2020  ype(list())).   
+00019030: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00019040: 496e 2827 5661 6c69 6461 7469 6f6e 2073  In('Validation s
+00019050: 7461 7274 6564 272c 2027 2f6e 272e 6a6f  tarted', '/n'.jo
+00019060: 696e 2872 6570 6f72 7429 290a 2020 2020  in(report)).    
+00019070: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+00019080: 6e28 2756 616c 6964 6174 696f 6e20 6669  n('Validation fi
+00019090: 6e69 7368 6564 272c 2027 2f6e 272e 6a6f  nished', '/n'.jo
+000190a0: 696e 2872 6570 6f72 7429 290a 2020 2020  in(report)).    
+000190b0: 2020 2020 2320 6974 6572 6174 6520 6f76      # iterate ov
+000190c0: 6572 2072 6573 756c 740a 2020 2020 2020  er result.      
+000190d0: 2020 7365 6c66 2e73 7663 2e64 6174 6162    self.svc.datab
+000190e0: 6173 652e 7661 6c69 6461 7465 2864 6174  ase.validate(dat
+000190f0: 6162 6173 653d 7365 6c66 2e64 6266 696c  abase=self.dbfil
+00019100: 6529 0a20 2020 2020 2020 2066 6f72 206c  e).        for l
+00019110: 696e 6520 696e 2073 656c 662e 7376 633a  ine in self.svc:
+00019120: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019130: 662e 6173 7365 7274 4973 4e6f 744e 6f6e  f.assertIsNotNon
+00019140: 6528 6c69 6e65 290a 2020 2020 2020 2020  e(line).        
+00019150: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+00019160: 7349 6e73 7461 6e63 6528 6c69 6e65 2c20  sInstance(line, 
+00019170: 7374 7229 0a20 2020 2020 2020 2023 2063  str).        # c
+00019180: 616c 6c62 6163 6b0a 2020 2020 2020 2020  allback.        
+00019190: 6f75 7470 7574 203d 205b 5d0a 2020 2020  output = [].    
+000191a0: 2020 2020 7365 6c66 2e73 7663 2e64 6174      self.svc.dat
+000191b0: 6162 6173 652e 7661 6c69 6461 7465 2864  abase.validate(d
+000191c0: 6174 6162 6173 653d 7365 6c66 2e64 6266  atabase=self.dbf
+000191d0: 696c 652c 2063 616c 6c62 6163 6b3d 6665  ile, callback=fe
+000191e0: 7463 686c 696e 6529 0a20 2020 2020 2020  tchline).       
+000191f0: 2073 656c 662e 6173 7365 7274 4772 6561   self.assertGrea
+00019200: 7465 7228 6c65 6e28 6f75 7470 7574 292c  ter(len(output),
+00019210: 2030 290a 2020 2020 2020 2020 2320 5061   0).        # Pa
+00019220: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00019230: 2073 656c 662e 7376 632e 6461 7461 6261   self.svc.databa
+00019240: 7365 2e76 616c 6964 6174 6528 6461 7461  se.validate(data
+00019250: 6261 7365 3d73 656c 662e 6462 6669 6c65  base=self.dbfile
+00019260: 2c20 696e 636c 7564 655f 7461 626c 653d  , include_table=
+00019270: 2743 4f55 4e54 5259 7c53 414c 4553 272c  'COUNTRY|SALES',
+00019280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019290: 2020 2020 2020 2020 2020 2069 6e63 6c75             inclu
+000192a0: 6465 5f69 6e64 6578 3d27 5341 4c45 5354  de_index='SALEST
+000192b0: 4154 5827 2c20 6c6f 636b 5f74 696d 656f  ATX', lock_timeo
+000192c0: 7574 3d2d 3129 0a20 2020 2020 2020 2072  ut=-1).        r
+000192d0: 6570 6f72 7420 3d20 272f 6e27 2e6a 6f69  eport = '/n'.joi
+000192e0: 6e28 7365 6c66 2e73 7663 2e72 6561 646c  n(self.svc.readl
+000192f0: 696e 6573 2829 290a 2020 2020 2020 2020  ines()).        
+00019300: 7365 6c66 2e61 7373 6572 744e 6f74 496e  self.assertNotIn
+00019310: 2827 284a 4f42 2927 2c20 7265 706f 7274  ('(JOB)', report
+00019320: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00019330: 7373 6572 7449 6e28 2728 434f 554e 5452  ssertIn('(COUNTR
+00019340: 5929 272c 2072 6570 6f72 7429 0a20 2020  Y)', report).   
+00019350: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00019360: 496e 2827 2853 414c 4553 2927 2c20 7265  In('(SALES)', re
+00019370: 706f 7274 290a 2020 2020 2020 2020 6966  port).        if
+00019380: 2073 656c 662e 7665 7273 696f 6e20 213d   self.version !=
+00019390: 2046 4234 303a 0a20 2020 2020 2020 2020   FB40:.         
+000193a0: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
+000193b0: 2827 2853 414c 4553 5441 5458 2927 2c20  ('(SALESTATX)', 
+000193c0: 7265 706f 7274 290a 0a63 6c61 7373 2054  report)..class T
+000193d0: 6573 7445 7665 6e74 7328 4472 6976 6572  estEvents(Driver
+000193e0: 5465 7374 4261 7365 293a 0a20 2020 2064  TestBase):.    d
+000193f0: 6566 2073 6574 5570 2873 656c 6629 3a0a  ef setUp(self):.
+00019400: 2020 2020 2020 2020 7375 7065 7228 292e          super().
+00019410: 7365 7455 7028 290a 2020 2020 2020 2020  setUp().        
+00019420: 7365 6c66 2e64 6266 696c 6520 3d20 6f73  self.dbfile = os
+00019430: 2e70 6174 682e 6a6f 696e 2873 656c 662e  .path.join(self.
+00019440: 6462 7061 7468 2c20 2766 6265 7665 6e74  dbpath, 'fbevent
+00019450: 732e 6664 6227 290a 2020 2020 2020 2020  s.fdb').        
+00019460: 6966 206f 732e 7061 7468 2e65 7869 7374  if os.path.exist
+00019470: 7328 7365 6c66 2e64 6266 696c 6529 3a0a  s(self.dbfile):.
+00019480: 2020 2020 2020 2020 2020 2020 6f73 2e72              os.r
+00019490: 656d 6f76 6528 7365 6c66 2e64 6266 696c  emove(self.dbfil
+000194a0: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
+000194b0: 636f 6e20 3d20 6372 6561 7465 5f64 6174  con = create_dat
+000194c0: 6162 6173 6528 7365 6c66 2e64 6266 696c  abase(self.dbfil
+000194d0: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
+000194e0: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+000194f0: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
+00019500: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
+00019510: 2e63 6f6e 2e63 7572 736f 7228 2920 6173  .con.cursor() as
+00019520: 2063 7572 3a0a 2020 2020 2020 2020 2020   cur:.          
+00019530: 2020 6375 722e 6578 6563 7574 6528 2243    cur.execute("C
+00019540: 5245 4154 4520 5441 424c 4520 5420 2850  REATE TABLE T (P
+00019550: 4b20 496e 7465 6765 722c 2043 3120 496e  K Integer, C1 In
+00019560: 7465 6765 7229 2229 0a20 2020 2020 2020  teger)").       
+00019570: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+00019580: 2822 2222 4352 4541 5445 2054 5249 4747  ("""CREATE TRIGG
+00019590: 4552 2045 5645 4e54 535f 4155 2046 4f52  ER EVENTS_AU FOR
+000195a0: 2054 2041 4354 4956 450a 2020 2020 4245   T ACTIVE.    BE
+000195b0: 464f 5245 2055 5044 4154 4520 504f 5349  FORE UPDATE POSI
+000195c0: 5449 4f4e 2030 0a20 2020 2041 530a 2020  TION 0.    AS.  
+000195d0: 2020 4245 4749 4e0a 2020 2020 2020 2020    BEGIN.        
+000195e0: 6966 2028 6f6c 642e 4331 203c 3e20 6e65  if (old.C1 <> ne
+000195f0: 772e 4331 2920 7468 656e 0a20 2020 2020  w.C1) then.     
+00019600: 2020 2020 2020 2070 6f73 745f 6576 656e         post_even
+00019610: 7420 2763 315f 7570 6461 7465 6427 203b  t 'c1_updated' ;
+00019620: 0a20 2020 2045 4e44 2222 2229 0a20 2020  .    END""").   
+00019630: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
+00019640: 6375 7465 2822 2222 4352 4541 5445 2054  cute("""CREATE T
+00019650: 5249 4747 4552 2045 5645 4e54 535f 4149  RIGGER EVENTS_AI
+00019660: 2046 4f52 2054 2041 4354 4956 450a 2020   FOR T ACTIVE.  
+00019670: 2020 4146 5445 5220 494e 5345 5254 2050    AFTER INSERT P
+00019680: 4f53 4954 494f 4e20 300a 2020 2020 4153  OSITION 0.    AS
+00019690: 0a20 2020 2042 4547 494e 0a20 2020 2020  .    BEGIN.     
+000196a0: 2020 2069 6620 286e 6577 2e63 3120 3d20     if (new.c1 = 
+000196b0: 3129 2074 6865 6e0a 2020 2020 2020 2020  1) then.        
+000196c0: 2020 2020 706f 7374 5f65 7665 6e74 2027      post_event '
+000196d0: 696e 7365 7274 5f31 2720 3b0a 2020 2020  insert_1' ;.    
+000196e0: 2020 2020 656c 7365 2069 6620 286e 6577      else if (new
+000196f0: 2e63 3120 3d20 3229 2074 6865 6e0a 2020  .c1 = 2) then.  
+00019700: 2020 2020 2020 2020 2020 706f 7374 5f65            post_e
+00019710: 7665 6e74 2027 696e 7365 7274 5f32 2720  vent 'insert_2' 
+00019720: 3b0a 2020 2020 2020 2020 656c 7365 2069  ;.        else i
+00019730: 6620 286e 6577 2e63 3120 3d20 3329 2074  f (new.c1 = 3) t
+00019740: 6865 6e0a 2020 2020 2020 2020 2020 2020  hen.            
+00019750: 706f 7374 5f65 7665 6e74 2027 696e 7365  post_event 'inse
+00019760: 7274 5f33 2720 3b0a 2020 2020 2020 2020  rt_3' ;.        
+00019770: 656c 7365 0a20 2020 2020 2020 2020 2020  else.           
+00019780: 2070 6f73 745f 6576 656e 7420 2769 6e73   post_event 'ins
+00019790: 6572 745f 6f74 6865 7227 203b 0a20 2020  ert_other' ;.   
+000197a0: 2045 4e44 2222 2229 0a20 2020 2020 2020   END""").       
+000197b0: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
+000197c0: 6d6d 6974 2829 0a20 2020 2064 6566 2074  mmit().    def t
+000197d0: 6561 7244 6f77 6e28 7365 6c66 293a 0a20  earDown(self):. 
+000197e0: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+000197f0: 6472 6f70 5f64 6174 6162 6173 6528 290a  drop_database().
+00019800: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+00019810: 2e63 6c6f 7365 2829 0a20 2020 2064 6566  .close().    def
+00019820: 2074 6573 745f 6f6e 655f 6576 656e 7428   test_one_event(
+00019830: 7365 6c66 293a 0a20 2020 2020 2020 2064  self):.        d
+00019840: 6566 2073 656e 645f 6576 656e 7473 2863  ef send_events(c
+00019850: 6f6d 6d61 6e64 5f6c 6973 7429 3a0a 2020  ommand_list):.  
+00019860: 2020 2020 2020 2020 2020 7769 7468 2073            with s
+00019870: 656c 662e 636f 6e2e 6375 7273 6f72 2829  elf.con.cursor()
+00019880: 2061 7320 6375 723a 0a20 2020 2020 2020   as cur:.       
+00019890: 2020 2020 2020 2020 2066 6f72 2063 6d64           for cmd
+000198a0: 2069 6e20 636f 6d6d 616e 645f 6c69 7374   in command_list
+000198b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000198c0: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+000198d0: 6528 636d 6429 0a20 2020 2020 2020 2020  e(cmd).         
+000198e0: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+000198f0: 636f 6d6d 6974 2829 0a0a 2020 2020 2020  commit()..      
+00019900: 2020 6520 3d20 7b7d 0a20 2020 2020 2020    e = {}.       
+00019910: 2074 696d 6564 5f65 7665 6e74 203d 2074   timed_event = t
+00019920: 6872 6561 6469 6e67 2e54 696d 6572 2833  hreading.Timer(3
+00019930: 2e30 2c20 7365 6e64 5f65 7665 6e74 732c  .0, send_events,
+00019940: 2061 7267 733d 5b5b 2269 6e73 6572 7420   args=[["insert 
+00019950: 696e 746f 2054 2028 504b 2c43 3129 2076  into T (PK,C1) v
+00019960: 616c 7565 7320 2831 2c31 2922 2c5d 5d29  alues (1,1)",]])
+00019970: 0a20 2020 2020 2020 2077 6974 6820 7365  .        with se
+00019980: 6c66 2e63 6f6e 2e65 7665 6e74 5f63 6f6c  lf.con.event_col
+00019990: 6c65 6374 6f72 285b 2769 6e73 6572 745f  lector(['insert_
+000199a0: 3127 5d29 2061 7320 6576 656e 7473 3a0a  1']) as events:.
+000199b0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+000199c0: 645f 6576 656e 742e 7374 6172 7428 290a  d_event.start().
+000199d0: 2020 2020 2020 2020 2020 2020 6520 3d20              e = 
+000199e0: 6576 656e 7473 2e77 6169 7428 290a 2020  events.wait().  
+000199f0: 2020 2020 2020 7469 6d65 645f 6576 656e        timed_even
+00019a00: 742e 6a6f 696e 2829 0a20 2020 2020 2020  t.join().       
+00019a10: 2073 656c 662e 6173 7365 7274 4469 6374   self.assertDict
+00019a20: 4571 7561 6c28 652c 207b 2769 6e73 6572  Equal(e, {'inser
+00019a30: 745f 3127 3a20 317d 290a 2020 2020 6465  t_1': 1}).    de
+00019a40: 6620 7465 7374 5f6d 756c 7469 706c 655f  f test_multiple_
+00019a50: 6576 656e 7473 2873 656c 6629 3a0a 2020  events(self):.  
+00019a60: 2020 2020 2020 6465 6620 7365 6e64 5f65        def send_e
+00019a70: 7665 6e74 7328 636f 6d6d 616e 645f 6c69  vents(command_li
+00019a80: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
+00019a90: 2077 6974 6820 7365 6c66 2e63 6f6e 2e63   with self.con.c
+00019aa0: 7572 736f 7228 2920 6173 2063 7572 3a0a  ursor() as cur:.
+00019ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ac0: 666f 7220 636d 6420 696e 2063 6f6d 6d61  for cmd in comma
+00019ad0: 6e64 5f6c 6973 743a 0a20 2020 2020 2020  nd_list:.       
+00019ae0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+00019af0: 2e65 7865 6375 7465 2863 6d64 290a 2020  .execute(cmd).  
+00019b00: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00019b10: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
+00019b20: 0a20 2020 2020 2020 2063 6d64 7320 3d20  .        cmds = 
+00019b30: 5b22 696e 7365 7274 2069 6e74 6f20 5420  ["insert into T 
+00019b40: 2850 4b2c 4331 2920 7661 6c75 6573 2028  (PK,C1) values (
+00019b50: 312c 3129 222c 0a20 2020 2020 2020 2020  1,1)",.         
+00019b60: 2020 2020 2020 2022 696e 7365 7274 2069         "insert i
+00019b70: 6e74 6f20 5420 2850 4b2c 4331 2920 7661  nto T (PK,C1) va
+00019b80: 6c75 6573 2028 312c 3229 222c 0a20 2020  lues (1,2)",.   
+00019b90: 2020 2020 2020 2020 2020 2020 2022 696e               "in
+00019ba0: 7365 7274 2069 6e74 6f20 5420 2850 4b2c  sert into T (PK,
+00019bb0: 4331 2920 7661 6c75 6573 2028 312c 3329  C1) values (1,3)
+00019bc0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00019bd0: 2020 2022 696e 7365 7274 2069 6e74 6f20     "insert into 
+00019be0: 5420 2850 4b2c 4331 2920 7661 6c75 6573  T (PK,C1) values
+00019bf0: 2028 312c 3129 222c 0a20 2020 2020 2020   (1,1)",.       
+00019c00: 2020 2020 2020 2020 2022 696e 7365 7274           "insert
+00019c10: 2069 6e74 6f20 5420 2850 4b2c 4331 2920   into T (PK,C1) 
+00019c20: 7661 6c75 6573 2028 312c 3229 222c 5d0a  values (1,2)",].
+00019c30: 2020 2020 2020 2020 7469 6d65 645f 6576          timed_ev
+00019c40: 656e 7420 3d20 7468 7265 6164 696e 672e  ent = threading.
+00019c50: 5469 6d65 7228 332e 302c 2073 656e 645f  Timer(3.0, send_
+00019c60: 6576 656e 7473 2c20 6172 6773 3d5b 636d  events, args=[cm
+00019c70: 6473 5d29 0a20 2020 2020 2020 2077 6974  ds]).        wit
+00019c80: 6820 7365 6c66 2e63 6f6e 2e65 7665 6e74  h self.con.event
+00019c90: 5f63 6f6c 6c65 6374 6f72 285b 2769 6e73  _collector(['ins
+00019ca0: 6572 745f 3127 2c20 2769 6e73 6572 745f  ert_1', 'insert_
+00019cb0: 3327 5d29 2061 7320 6576 656e 7473 3a0a  3']) as events:.
+00019cc0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+00019cd0: 645f 6576 656e 742e 7374 6172 7428 290a  d_event.start().
+00019ce0: 2020 2020 2020 2020 2020 2020 6520 3d20              e = 
+00019cf0: 6576 656e 7473 2e77 6169 7428 290a 2020  events.wait().  
+00019d00: 2020 2020 2020 7469 6d65 645f 6576 656e        timed_even
+00019d10: 742e 6a6f 696e 2829 0a20 2020 2020 2020  t.join().       
+00019d20: 2073 656c 662e 6173 7365 7274 4469 6374   self.assertDict
+00019d30: 4571 7561 6c28 652c 207b 2769 6e73 6572  Equal(e, {'inser
+00019d40: 745f 3327 3a20 312c 2027 696e 7365 7274  t_3': 1, 'insert
+00019d50: 5f31 273a 2032 7d29 0a20 2020 2064 6566  _1': 2}).    def
+00019d60: 2074 6573 745f 3230 5f65 7665 6e74 7328   test_20_events(
+00019d70: 7365 6c66 293a 0a20 2020 2020 2020 2064  self):.        d
+00019d80: 6566 2073 656e 645f 6576 656e 7473 2863  ef send_events(c
+00019d90: 6f6d 6d61 6e64 5f6c 6973 7429 3a0a 2020  ommand_list):.  
+00019da0: 2020 2020 2020 2020 2020 7769 7468 2073            with s
+00019db0: 656c 662e 636f 6e2e 6375 7273 6f72 2829  elf.con.cursor()
+00019dc0: 2061 7320 6375 723a 0a20 2020 2020 2020   as cur:.       
+00019dd0: 2020 2020 2020 2020 2066 6f72 2063 6d64           for cmd
+00019de0: 2069 6e20 636f 6d6d 616e 645f 6c69 7374   in command_list
+00019df0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019e00: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
+00019e10: 6528 636d 6429 0a20 2020 2020 2020 2020  e(cmd).         
+00019e20: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+00019e30: 636f 6d6d 6974 2829 0a0a 2020 2020 2020  commit()..      
+00019e40: 2020 636d 6473 203d 205b 2269 6e73 6572    cmds = ["inser
+00019e50: 7420 696e 746f 2054 2028 504b 2c43 3129  t into T (PK,C1)
+00019e60: 2076 616c 7565 7320 2831 2c31 2922 2c0a   values (1,1)",.
+00019e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019e80: 2269 6e73 6572 7420 696e 746f 2054 2028  "insert into T (
+00019e90: 504b 2c43 3129 2076 616c 7565 7320 2831  PK,C1) values (1
+00019ea0: 2c32 2922 2c0a 2020 2020 2020 2020 2020  ,2)",.          
+00019eb0: 2020 2020 2020 2269 6e73 6572 7420 696e        "insert in
+00019ec0: 746f 2054 2028 504b 2c43 3129 2076 616c  to T (PK,C1) val
+00019ed0: 7565 7320 2831 2c33 2922 2c0a 2020 2020  ues (1,3)",.    
+00019ee0: 2020 2020 2020 2020 2020 2020 2269 6e73              "ins
+00019ef0: 6572 7420 696e 746f 2054 2028 504b 2c43  ert into T (PK,C
+00019f00: 3129 2076 616c 7565 7320 2831 2c31 2922  1) values (1,1)"
+00019f10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019f20: 2020 2269 6e73 6572 7420 696e 746f 2054    "insert into T
+00019f30: 2028 504b 2c43 3129 2076 616c 7565 7320   (PK,C1) values 
+00019f40: 2831 2c32 2922 2c5d 0a20 2020 2020 2020  (1,2)",].       
+00019f50: 2073 656c 662e 6520 3d20 7b7d 0a20 2020   self.e = {}.   
+00019f60: 2020 2020 2074 696d 6564 5f65 7665 6e74       timed_event
+00019f70: 203d 2074 6872 6561 6469 6e67 2e54 696d   = threading.Tim
+00019f80: 6572 2831 2e30 2c20 7365 6e64 5f65 7665  er(1.0, send_eve
+00019f90: 6e74 732c 2061 7267 733d 5b63 6d64 735d  nts, args=[cmds]
+00019fa0: 290a 2020 2020 2020 2020 7769 7468 2073  ).        with s
+00019fb0: 656c 662e 636f 6e2e 6576 656e 745f 636f  elf.con.event_co
+00019fc0: 6c6c 6563 746f 7228 5b27 696e 7365 7274  llector(['insert
+00019fd0: 5f31 272c 2027 4127 2c20 2742 272c 2027  _1', 'A', 'B', '
+00019fe0: 4327 2c20 2744 272c 0a20 2020 2020 2020  C', 'D',.       
+00019ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a000: 2020 2020 2020 2020 2020 2020 2020 2745                'E
+0001a010: 272c 2027 4627 2c20 2747 272c 2027 4827  ', 'F', 'G', 'H'
+0001a020: 2c20 2749 272c 2027 4a27 2c20 274b 272c  , 'I', 'J', 'K',
+0001a030: 2027 4c27 2c20 274d 272c 0a20 2020 2020   'L', 'M',.     
+0001a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a060: 274e 272c 2027 4f27 2c20 2750 272c 2027  'N', 'O', 'P', '
+0001a070: 5127 2c20 2752 272c 2027 696e 7365 7274  Q', 'R', 'insert
+0001a080: 5f33 275d 2920 6173 2065 7665 6e74 733a  _3']) as events:
+0001a090: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+0001a0a0: 6564 5f65 7665 6e74 2e73 7461 7274 2829  ed_event.start()
+0001a0b0: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+0001a0c0: 652e 736c 6565 7028 3329 0a20 2020 2020  e.sleep(3).     
+0001a0d0: 2020 2020 2020 2065 203d 2065 7665 6e74         e = event
+0001a0e0: 732e 7761 6974 2829 0a20 2020 2020 2020  s.wait().       
+0001a0f0: 2074 696d 6564 5f65 7665 6e74 2e6a 6f69   timed_event.joi
+0001a100: 6e28 290a 2020 2020 2020 2020 7365 6c66  n().        self
+0001a110: 2e61 7373 6572 7444 6963 7445 7175 616c  .assertDictEqual
+0001a120: 2865 2c0a 2020 2020 2020 2020 2020 2020  (e,.            
+0001a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a140: 207b 2741 273a 2030 2c20 2743 273a 2030   {'A': 0, 'C': 0
+0001a150: 2c20 2742 273a 2030 2c20 2745 273a 2030  , 'B': 0, 'E': 0
+0001a160: 2c20 2744 273a 2030 2c20 2747 273a 2030  , 'D': 0, 'G': 0
+0001a170: 2c20 2769 6e73 6572 745f 3127 3a20 322c  , 'insert_1': 2,
+0001a180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a190: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001a1a0: 4927 3a20 302c 2027 4827 3a20 302c 2027  I': 0, 'H': 0, '
+0001a1b0: 4b27 3a20 302c 2027 4a27 3a20 302c 2027  K': 0, 'J': 0, '
+0001a1c0: 4d27 3a20 302c 2027 4c27 3a20 302c 2027  M': 0, 'L': 0, '
+0001a1d0: 4f27 3a20 302c 2027 4e27 3a20 302c 0a20  O': 0, 'N': 0,. 
+0001a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a1f0: 2020 2020 2020 2020 2020 2020 2027 5127               'Q'
+0001a200: 3a20 302c 2027 5027 3a20 302c 2027 5227  : 0, 'P': 0, 'R'
+0001a210: 3a20 302c 2027 696e 7365 7274 5f33 273a  : 0, 'insert_3':
+0001a220: 2031 2c20 2746 273a 2030 7d29 0a20 2020   1, 'F': 0}).   
+0001a230: 2064 6566 2074 6573 745f 666c 7573 685f   def test_flush_
+0001a240: 6576 656e 7473 2873 656c 6629 3a0a 2020  events(self):.  
+0001a250: 2020 2020 2020 6465 6620 7365 6e64 5f65        def send_e
+0001a260: 7665 6e74 7328 636f 6d6d 616e 645f 6c69  vents(command_li
+0001a270: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
+0001a280: 2077 6974 6820 7365 6c66 2e63 6f6e 2e63   with self.con.c
+0001a290: 7572 736f 7228 2920 6173 2063 7572 3a0a  ursor() as cur:.
+0001a2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a2b0: 666f 7220 636d 6420 696e 2063 6f6d 6d61  for cmd in comma
+0001a2c0: 6e64 5f6c 6973 743a 0a20 2020 2020 2020  nd_list:.       
+0001a2d0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+0001a2e0: 2e65 7865 6375 7465 2863 6d64 290a 2020  .execute(cmd).  
+0001a2f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001a300: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
+0001a310: 0a20 2020 2020 2020 2074 696d 6564 5f65  .        timed_e
+0001a320: 7665 6e74 203d 2074 6872 6561 6469 6e67  vent = threading
+0001a330: 2e54 696d 6572 2833 2e30 2c20 7365 6e64  .Timer(3.0, send
+0001a340: 5f65 7665 6e74 732c 2061 7267 733d 5b5b  _events, args=[[
+0001a350: 2269 6e73 6572 7420 696e 746f 2054 2028  "insert into T (
+0001a360: 504b 2c43 3129 2076 616c 7565 7320 2831  PK,C1) values (1
+0001a370: 2c31 2922 2c5d 5d29 0a20 2020 2020 2020  ,1)",]]).       
+0001a380: 2077 6974 6820 7365 6c66 2e63 6f6e 2e65   with self.con.e
+0001a390: 7665 6e74 5f63 6f6c 6c65 6374 6f72 285b  vent_collector([
+0001a3a0: 2769 6e73 6572 745f 3127 5d29 2061 7320  'insert_1']) as 
+0001a3b0: 6576 656e 7473 3a0a 2020 2020 2020 2020  events:.        
+0001a3c0: 2020 2020 7365 6e64 5f65 7665 6e74 7328      send_events(
+0001a3d0: 5b22 696e 7365 7274 2069 6e74 6f20 5420  ["insert into T 
+0001a3e0: 2850 4b2c 4331 2920 7661 6c75 6573 2028  (PK,C1) values (
+0001a3f0: 312c 3129 222c 0a20 2020 2020 2020 2020  1,1)",.         
+0001a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a410: 2269 6e73 6572 7420 696e 746f 2054 2028  "insert into T (
+0001a420: 504b 2c43 3129 2076 616c 7565 7320 2831  PK,C1) values (1
+0001a430: 2c31 2922 5d29 0a20 2020 2020 2020 2020  ,1)"]).         
+0001a440: 2020 2074 696d 652e 736c 6565 7028 3229     time.sleep(2)
+0001a450: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
+0001a460: 6e74 732e 666c 7573 6828 290a 2020 2020  nts.flush().    
+0001a470: 2020 2020 2020 2020 7469 6d65 645f 6576          timed_ev
+0001a480: 656e 742e 7374 6172 7428 290a 2020 2020  ent.start().    
+0001a490: 2020 2020 2020 2020 6520 3d20 6576 656e          e = even
+0001a4a0: 7473 2e77 6169 7428 290a 2020 2020 2020  ts.wait().      
+0001a4b0: 2020 7469 6d65 645f 6576 656e 742e 6a6f    timed_event.jo
+0001a4c0: 696e 2829 0a20 2020 2020 2020 2073 656c  in().        sel
+0001a4d0: 662e 6173 7365 7274 4469 6374 4571 7561  f.assertDictEqua
+0001a4e0: 6c28 652c 207b 2769 6e73 6572 745f 3127  l(e, {'insert_1'
+0001a4f0: 3a20 317d 290a 0a63 6c61 7373 2054 6573  : 1})..class Tes
+0001a500: 7453 7472 6561 6d42 4c4f 4273 2844 7269  tStreamBLOBs(Dri
+0001a510: 7665 7254 6573 7442 6173 6529 3a0a 2020  verTestBase):.  
+0001a520: 2020 6465 6620 7365 7455 7028 7365 6c66    def setUp(self
+0001a530: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
+0001a540: 2829 2e73 6574 5570 2829 0a20 2020 2020  ().setUp().     
+0001a550: 2020 2073 656c 662e 6462 6669 6c65 203d     self.dbfile =
+0001a560: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
+0001a570: 6c66 2e64 6270 6174 682c 2073 656c 662e  lf.dbpath, self.
+0001a580: 4642 5445 5354 5f44 4229 0a20 2020 2020  FBTEST_DB).     
+0001a590: 2020 2073 656c 662e 636f 6e20 3d20 636f     self.con = co
+0001a5a0: 6e6e 6563 7428 7365 6c66 2e64 6266 696c  nnect(self.dbfil
+0001a5b0: 652c 2075 7365 723d 4642 5445 5354 5f55  e, user=FBTEST_U
+0001a5c0: 5345 522c 2070 6173 7377 6f72 643d 4642  SER, password=FB
+0001a5d0: 5445 5354 5f50 4153 5357 4f52 4429 0a20  TEST_PASSWORD). 
+0001a5e0: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
+0001a5f0: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
+0001a600: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+0001a610: 6e61 6d65 5f5f 0a20 2020 2020 2020 2023  name__.        #
+0001a620: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
+0001a630: 5f69 6d6d 6564 6961 7465 2822 7265 6372  _immediate("recr
+0001a640: 6561 7465 2074 6162 6c65 2074 2028 6331  eate table t (c1
+0001a650: 2069 6e74 6567 6572 2922 290a 2020 2020   integer)").    
+0001a660: 2020 2020 2373 656c 662e 636f 6e2e 636f      #self.con.co
+0001a670: 6d6d 6974 2829 0a20 2020 2020 2020 2023  mmit().        #
+0001a680: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
+0001a690: 5f69 6d6d 6564 6961 7465 2822 5245 4352  _immediate("RECR
+0001a6a0: 4541 5445 2054 4142 4c45 2054 3220 2843  EATE TABLE T2 (C
+0001a6b0: 3120 536d 616c 6c69 6e74 2c43 3220 496e  1 Smallint,C2 In
+0001a6c0: 7465 6765 722c 4333 2042 6967 696e 742c  teger,C3 Bigint,
+0001a6d0: 4334 2043 6861 7228 3529 2c43 3520 5661  C4 Char(5),C5 Va
+0001a6e0: 7263 6861 7228 3130 292c 4336 2044 6174  rchar(10),C6 Dat
+0001a6f0: 652c 4337 2054 696d 652c 4338 2054 696d  e,C7 Time,C8 Tim
+0001a700: 6573 7461 6d70 2c43 3920 426c 6f62 2073  estamp,C9 Blob s
+0001a710: 7562 5f74 7970 6520 312c 4331 3020 4e75  ub_type 1,C10 Nu
+0001a720: 6d65 7269 6328 3138 2c32 292c 4331 3120  meric(18,2),C11 
+0001a730: 4465 6369 6d61 6c28 3138 2c32 292c 4331  Decimal(18,2),C1
+0001a740: 3220 466c 6f61 742c 4331 3320 446f 7562  2 Float,C13 Doub
+0001a750: 6c65 2070 7265 6369 7369 6f6e 2c43 3134  le precision,C14
+0001a760: 204e 756d 6572 6963 2838 2c34 292c 4331   Numeric(8,4),C1
+0001a770: 3520 4465 6369 6d61 6c28 382c 3429 2922  5 Decimal(8,4))"
+0001a780: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
+0001a790: 6f6e 2e65 7865 6375 7465 5f69 6d6d 6564  on.execute_immed
+0001a7a0: 6961 7465 2822 6465 6c65 7465 2066 726f  iate("delete fro
+0001a7b0: 6d20 7422 290a 2020 2020 2020 2020 7365  m t").        se
+0001a7c0: 6c66 2e63 6f6e 2e65 7865 6375 7465 5f69  lf.con.execute_i
+0001a7d0: 6d6d 6564 6961 7465 2822 6465 6c65 7465  mmediate("delete
+0001a7e0: 2066 726f 6d20 7432 2229 0a20 2020 2020   from t2").     
+0001a7f0: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
+0001a800: 6974 2829 0a20 2020 2064 6566 2074 6561  it().    def tea
+0001a810: 7244 6f77 6e28 7365 6c66 293a 0a20 2020  rDown(self):.   
+0001a820: 2020 2020 2073 656c 662e 636f 6e2e 636c       self.con.cl
+0001a830: 6f73 6528 290a 2020 2020 6465 6620 7465  ose().    def te
+0001a840: 7374 426c 6f62 4261 7369 6328 7365 6c66  stBlobBasic(self
+0001a850: 293a 0a20 2020 2020 2020 2062 6c6f 6220  ):.        blob 
+0001a860: 3d20 2222 2246 6972 6562 6972 6420 7375  = """Firebird su
+0001a870: 7070 6f72 7473 2074 776f 2074 7970 6573  pports two types
+0001a880: 206f 6620 626c 6f62 732c 2073 7472 6561   of blobs, strea
+0001a890: 6d20 616e 6420 7365 676d 656e 7465 642e  m and segmented.
+0001a8a0: 0a54 6865 2064 6174 6162 6173 6520 7374  .The database st
+0001a8b0: 6f72 6573 2073 6567 6d65 6e74 6564 2062  ores segmented b
+0001a8c0: 6c6f 6273 2069 6e20 6368 756e 6b73 2e0a  lobs in chunks..
+0001a8d0: 4561 6368 2063 6875 6e6b 2073 7461 7274  Each chunk start
+0001a8e0: 7320 7769 7468 2061 2074 776f 2062 7974  s with a two byt
+0001a8f0: 6520 6c65 6e67 7468 2069 6e64 6963 6174  e length indicat
+0001a900: 6f72 2066 6f6c 6c6f 7765 6420 6279 2068  or followed by h
+0001a910: 6f77 6576 6572 206d 616e 7920 6279 7465  owever many byte
+0001a920: 7320 6f66 2064 6174 6120 7765 7265 2070  s of data were p
+0001a930: 6173 7365 6420 6173 2061 2073 6567 6d65  assed as a segme
+0001a940: 6e74 2e0a 5374 7265 616d 2062 6c6f 6273  nt..Stream blobs
+0001a950: 2061 7265 2073 746f 7265 6420 6173 2061   are stored as a
+0001a960: 2063 6f6e 7469 6e75 6f75 7320 6172 7261   continuous arra
+0001a970: 7920 6f66 2064 6174 6120 6279 7465 7320  y of data bytes 
+0001a980: 7769 7468 206e 6f20 6c65 6e67 7468 2069  with no length i
+0001a990: 6e64 6963 6174 6f72 7320 696e 636c 7564  ndicators includ
+0001a9a0: 6564 2e22 2222 0a20 2020 2020 2020 2062  ed.""".        b
+0001a9b0: 6c6f 625f 6c69 6e65 7320 3d20 5374 7269  lob_lines = Stri
+0001a9c0: 6e67 494f 2862 6c6f 6229 2e72 6561 646c  ngIO(blob).readl
+0001a9d0: 696e 6573 2829 0a20 2020 2020 2020 2077  ines().        w
+0001a9e0: 6974 6820 7365 6c66 2e63 6f6e 2e63 7572  ith self.con.cur
+0001a9f0: 736f 7228 2920 6173 2063 7572 3a0a 2020  sor() as cur:.  
+0001aa00: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+0001aa10: 6563 7574 6528 2769 6e73 6572 7420 696e  ecute('insert in
+0001aa20: 746f 2054 3220 2843 312c 4339 2920 7661  to T2 (C1,C9) va
+0001aa30: 6c75 6573 2028 3f2c 3f29 272c 205b 342c  lues (?,?)', [4,
+0001aa40: 2053 7472 696e 6749 4f28 626c 6f62 295d   StringIO(blob)]
+0001aa50: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0001aa60: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
+0001aa70: 2020 2020 2020 2020 2020 2020 7020 3d20              p = 
+0001aa80: 6375 722e 7072 6570 6172 6528 2773 656c  cur.prepare('sel
+0001aa90: 6563 7420 4331 2c43 3920 6672 6f6d 2054  ect C1,C9 from T
+0001aaa0: 3220 7768 6572 6520 4331 203d 2034 2729  2 where C1 = 4')
+0001aab0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+0001aac0: 2e73 7472 6561 6d5f 626c 6f62 732e 6170  .stream_blobs.ap
+0001aad0: 7065 6e64 2827 4339 2729 0a20 2020 2020  pend('C9').     
+0001aae0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0001aaf0: 7465 2870 290a 2020 2020 2020 2020 2020  te(p).          
+0001ab00: 2020 726f 7720 3d20 6375 722e 6665 7463    row = cur.fetc
+0001ab10: 686f 6e65 2829 0a20 2020 2020 2020 2020  hone().         
+0001ab20: 2020 2062 6c6f 625f 7265 6164 6572 203d     blob_reader =
+0001ab30: 2072 6f77 5b31 5d0a 2020 2020 2020 2020   row[1].        
+0001ab40: 2020 2020 7769 7468 2062 6c6f 625f 7265      with blob_re
+0001ab50: 6164 6572 3a0a 2020 2020 2020 2020 2020  ader:.          
+0001ab60: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001ab70: 7449 7349 6e73 7461 6e63 6528 626c 6f62  tIsInstance(blob
+0001ab80: 5f72 6561 6465 722e 626c 6f62 5f69 642c  _reader.blob_id,
+0001ab90: 2066 6261 7069 2e49 5343 5f51 5541 4429   fbapi.ISC_QUAD)
+0001aba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001abb0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0001abc0: 6c28 626c 6f62 5f72 6561 6465 722e 626c  l(blob_reader.bl
+0001abd0: 6f62 5f74 7970 652c 2042 6c6f 6254 7970  ob_type, BlobTyp
+0001abe0: 652e 5354 5245 414d 290a 2020 2020 2020  e.STREAM).      
+0001abf0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0001ac00: 7373 6572 7454 7275 6528 626c 6f62 5f72  ssertTrue(blob_r
+0001ac10: 6561 6465 722e 6973 5f74 6578 7429 0a20  eader.is_text). 
+0001ac20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001ac30: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001ac40: 626c 6f62 5f72 6561 6465 722e 7265 6164  blob_reader.read
+0001ac50: 2832 3029 2c20 2746 6972 6562 6972 6420  (20), 'Firebird 
+0001ac60: 7375 7070 6f72 7473 2074 7727 290a 2020  supports tw').  
+0001ac70: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001ac80: 6c66 2e61 7373 6572 7445 7175 616c 2862  lf.assertEqual(b
+0001ac90: 6c6f 625f 7265 6164 6572 2e72 6561 6428  lob_reader.read(
+0001aca0: 3230 292c 2027 6f20 7479 7065 7320 6f66  20), 'o types of
+0001acb0: 2062 6c6f 6273 2c20 7374 2729 0a20 2020   blobs, st').   
+0001acc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001acd0: 662e 6173 7365 7274 4571 7561 6c28 626c  f.assertEqual(bl
+0001ace0: 6f62 5f72 6561 6465 722e 7265 6164 2834  ob_reader.read(4
+0001acf0: 3030 292c 2027 7265 616d 2061 6e64 2073  00), 'ream and s
+0001ad00: 6567 6d65 6e74 6564 2e5c 6e54 6865 2064  egmented.\nThe d
+0001ad10: 6174 6162 6173 6520 7374 6f72 6573 2073  atabase stores s
+0001ad20: 6567 6d65 6e74 6564 2062 6c6f 6273 2069  egmented blobs i
+0001ad30: 6e20 270a 2020 2020 2020 2020 2020 2020  n '.            
+0001ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad50: 2020 2020 2027 6368 756e 6b73 2e5c 6e45       'chunks.\nE
+0001ad60: 6163 6820 6368 756e 6b20 7374 6172 7473  ach chunk starts
+0001ad70: 2077 6974 6820 6120 7477 6f20 6279 7465   with a two byte
+0001ad80: 206c 656e 6774 6820 696e 6469 6361 746f   length indicato
+0001ad90: 7220 270a 2020 2020 2020 2020 2020 2020  r '.            
+0001ada0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001adb0: 2020 2020 2027 666f 6c6c 6f77 6564 2062       'followed b
+0001adc0: 7920 686f 7765 7665 7220 6d61 6e79 2062  y however many b
+0001add0: 7974 6573 206f 6620 6461 7461 2077 6572  ytes of data wer
+0001ade0: 6520 7061 7373 6564 2061 7320 270a 2020  e passed as '.  
+0001adf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae00: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001ae10: 6120 7365 676d 656e 742e 5c6e 5374 7265  a segment.\nStre
+0001ae20: 616d 2062 6c6f 6273 2061 7265 2073 746f  am blobs are sto
+0001ae30: 7265 6420 6173 2061 2063 6f6e 7469 6e75  red as a continu
+0001ae40: 6f75 7320 6172 7261 7920 270a 2020 2020  ous array '.    
+0001ae50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae60: 2020 2020 2020 2020 2020 2020 2027 6f66               'of
+0001ae70: 2064 6174 6120 6279 7465 7320 7769 7468   data bytes with
+0001ae80: 206e 6f20 6c65 6e67 7468 2069 6e64 6963   no length indic
+0001ae90: 6174 6f72 7320 696e 636c 7564 6564 2e27  ators included.'
+0001aea0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001aeb0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001aec0: 616c 2862 6c6f 625f 7265 6164 6572 2e72  al(blob_reader.r
+0001aed0: 6561 6428 3230 292c 2027 2729 0a20 2020  ead(20), '').   
+0001aee0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001aef0: 662e 6173 7365 7274 4571 7561 6c28 626c  f.assertEqual(bl
+0001af00: 6f62 5f72 6561 6465 722e 7465 6c6c 2829  ob_reader.tell()
+0001af10: 2c20 3331 3829 0a20 2020 2020 2020 2020  , 318).         
+0001af20: 2020 2020 2020 2062 6c6f 625f 7265 6164         blob_read
+0001af30: 6572 2e73 6565 6b28 3230 290a 2020 2020  er.seek(20).    
+0001af40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001af50: 2e61 7373 6572 7445 7175 616c 2862 6c6f  .assertEqual(blo
+0001af60: 625f 7265 6164 6572 2e74 656c 6c28 292c  b_reader.tell(),
+0001af70: 2032 3029 0a20 2020 2020 2020 2020 2020   20).           
+0001af80: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001af90: 4571 7561 6c28 626c 6f62 5f72 6561 6465  Equal(blob_reade
+0001afa0: 722e 7265 6164 2832 3029 2c20 276f 2074  r.read(20), 'o t
+0001afb0: 7970 6573 206f 6620 626c 6f62 732c 2073  ypes of blobs, s
+0001afc0: 7427 290a 2020 2020 2020 2020 2020 2020  t').            
+0001afd0: 2020 2020 626c 6f62 5f72 6561 6465 722e      blob_reader.
+0001afe0: 7365 656b 2830 290a 2020 2020 2020 2020  seek(0).        
+0001aff0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0001b000: 6572 7445 7175 616c 2862 6c6f 625f 7265  ertEqual(blob_re
+0001b010: 6164 6572 2e74 656c 6c28 292c 2030 290a  ader.tell(), 0).
+0001b020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b030: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
+0001b040: 7175 616c 2862 6c6f 625f 7265 6164 6572  qual(blob_reader
+0001b050: 2e72 6561 646c 696e 6573 2829 2c20 5374  .readlines(), St
+0001b060: 7269 6e67 494f 2862 6c6f 6229 2e72 6561  ringIO(blob).rea
+0001b070: 646c 696e 6573 2829 290a 2020 2020 2020  dlines()).      
+0001b080: 2020 2020 2020 2020 2020 626c 6f62 5f72            blob_r
+0001b090: 6561 6465 722e 7365 656b 2830 290a 2020  eader.seek(0).  
+0001b0a0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001b0b0: 7220 6c69 6e65 2069 6e20 626c 6f62 5f72  r line in blob_r
+0001b0c0: 6561 6465 723a 0a20 2020 2020 2020 2020  eader:.         
+0001b0d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001b0e0: 6173 7365 7274 496e 286c 696e 652c 2062  assertIn(line, b
+0001b0f0: 6c6f 625f 6c69 6e65 7329 0a20 2020 2020  lob_lines).     
+0001b100: 2020 2020 2020 2020 2020 2062 6c6f 625f             blob_
+0001b110: 7265 6164 6572 2e73 6565 6b28 3029 0a20  reader.seek(0). 
+0001b120: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001b130: 656c 662e 6173 7365 7274 4c69 7374 4571  elf.assertListEq
+0001b140: 7561 6c28 626c 6f62 5f72 6561 6465 722e  ual(blob_reader.
+0001b150: 7265 6164 6c69 6e65 7328 3329 2c20 626c  readlines(3), bl
+0001b160: 6f62 5f6c 696e 6573 5b3a 335d 290a 2020  ob_lines[:3]).  
+0001b170: 2020 2020 2020 2020 2020 2020 2020 626c                bl
+0001b180: 6f62 5f72 6561 6465 722e 7365 656b 2830  ob_reader.seek(0
+0001b190: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001b1a0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001b1b0: 616c 2862 6c6f 625f 7265 6164 6572 2e72  al(blob_reader.r
+0001b1c0: 6561 6428 292c 2062 6c6f 6229 0a20 2020  ead(), blob).   
+0001b1d0: 2020 2020 2020 2020 2020 2020 2062 6c6f               blo
+0001b1e0: 625f 7265 6164 6572 2e73 6565 6b28 2d39  b_reader.seek(-9
+0001b1f0: 2c20 6f73 2e53 4545 4b5f 454e 4429 0a20  , os.SEEK_END). 
+0001b200: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001b210: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001b220: 626c 6f62 5f72 6561 6465 722e 7265 6164  blob_reader.read
+0001b230: 2829 2c20 2769 6e63 6c75 6465 642e 2729  (), 'included.')
+0001b240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b250: 2062 6c6f 625f 7265 6164 6572 2e73 6565   blob_reader.see
+0001b260: 6b28 2d32 302c 206f 732e 5345 454b 5f45  k(-20, os.SEEK_E
+0001b270: 4e44 290a 2020 2020 2020 2020 2020 2020  ND).            
+0001b280: 2020 2020 626c 6f62 5f72 6561 6465 722e      blob_reader.
+0001b290: 7365 656b 2831 312c 206f 732e 5345 454b  seek(11, os.SEEK
+0001b2a0: 5f43 5552 290a 2020 2020 2020 2020 2020  _CUR).          
+0001b2b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001b2c0: 7445 7175 616c 2862 6c6f 625f 7265 6164  tEqual(blob_read
+0001b2d0: 6572 2e72 6561 6428 292c 2027 696e 636c  er.read(), 'incl
+0001b2e0: 7564 6564 2e27 290a 2020 2020 2020 2020  uded.').        
+0001b2f0: 2020 2020 2020 2020 626c 6f62 5f72 6561          blob_rea
+0001b300: 6465 722e 7365 656b 2836 3029 0a20 2020  der.seek(60).   
+0001b310: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001b320: 662e 6173 7365 7274 4571 7561 6c28 626c  f.assertEqual(bl
+0001b330: 6f62 5f72 6561 6465 722e 7265 6164 6c69  ob_reader.readli
+0001b340: 6e65 2829 2c0a 2020 2020 2020 2020 2020  ne(),.          
+0001b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b360: 2020 2020 2020 2027 5468 6520 6461 7461         'The data
+0001b370: 6261 7365 2073 746f 7265 7320 7365 676d  base stores segm
+0001b380: 656e 7465 6420 626c 6f62 7320 696e 2063  ented blobs in c
+0001b390: 6875 6e6b 732e 5c6e 2729 0a20 2020 2020  hunks.\n').     
+0001b3a0: 2020 2020 2020 2020 2020 2062 6c6f 625f             blob_
+0001b3b0: 7265 6164 6572 2e73 6565 6b28 3029 0a20  reader.seek(0). 
+0001b3c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001b3d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001b3e0: 626c 6f62 5f72 6561 6465 722e 7265 6164  blob_reader.read
+0001b3f0: 6c69 6e65 2832 3029 2c20 2746 6972 6562  line(20), 'Fireb
+0001b400: 6972 6420 7375 7070 6f72 7473 2074 7727  ird supports tw'
+0001b410: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001b420: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001b430: 616c 2862 6c6f 625f 7265 6164 6572 2e72  al(blob_reader.r
+0001b440: 6561 646c 696e 6528 292c 2027 6f20 7479  eadline(), 'o ty
+0001b450: 7065 7320 6f66 2062 6c6f 6273 2c20 7374  pes of blobs, st
+0001b460: 7265 616d 2061 6e64 2073 6567 6d65 6e74  ream and segment
+0001b470: 6564 2e5c 6e27 290a 2020 2020 2020 2020  ed.\n').        
+0001b480: 2020 2020 2020 2020 626c 6f62 5f72 6561          blob_rea
+0001b490: 6465 722e 7365 656b 2830 290a 2020 2020  der.seek(0).    
+0001b4a0: 2020 2020 2020 2020 2020 2020 626c 6f62              blob
+0001b4b0: 5f72 6561 6465 722e 6e65 776c 696e 6520  _reader.newline 
+0001b4c0: 3d20 275c 725c 6e27 0a20 2020 2020 2020  = '\r\n'.       
+0001b4d0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0001b4e0: 7365 7274 4571 7561 6c28 626c 6f62 5f72  sertEqual(blob_r
+0001b4f0: 6561 6465 722e 7265 6164 6c69 6e65 2829  eader.readline()
+0001b500: 2c20 2746 6972 6562 6972 6420 7375 7070  , 'Firebird supp
+0001b510: 6f72 7473 2074 776f 2074 7970 6573 206f  orts two types o
+0001b520: 6620 626c 6f62 732c 2073 7472 6561 6d20  f blobs, stream 
+0001b530: 616e 6420 7365 676d 656e 7465 642e 5c72  and segmented.\r
+0001b540: 5c6e 2729 0a20 2020 2064 6566 2074 6573  \n').    def tes
+0001b550: 7442 6c6f 6245 7874 656e 6465 6428 7365  tBlobExtended(se
+0001b560: 6c66 293a 0a20 2020 2020 2020 2062 6c6f  lf):.        blo
+0001b570: 6220 3d20 2222 2246 6972 6562 6972 6420  b = """Firebird 
+0001b580: 7375 7070 6f72 7473 2074 776f 2074 7970  supports two typ
+0001b590: 6573 206f 6620 626c 6f62 732c 2073 7472  es of blobs, str
+0001b5a0: 6561 6d20 616e 6420 7365 676d 656e 7465  eam and segmente
+0001b5b0: 642e 0a54 6865 2064 6174 6162 6173 6520  d..The database 
+0001b5c0: 7374 6f72 6573 2073 6567 6d65 6e74 6564  stores segmented
+0001b5d0: 2062 6c6f 6273 2069 6e20 6368 756e 6b73   blobs in chunks
+0001b5e0: 2e0a 4561 6368 2063 6875 6e6b 2073 7461  ..Each chunk sta
+0001b5f0: 7274 7320 7769 7468 2061 2074 776f 2062  rts with a two b
+0001b600: 7974 6520 6c65 6e67 7468 2069 6e64 6963  yte length indic
+0001b610: 6174 6f72 2066 6f6c 6c6f 7765 6420 6279  ator followed by
+0001b620: 2068 6f77 6576 6572 206d 616e 7920 6279   however many by
+0001b630: 7465 7320 6f66 2064 6174 6120 7765 7265  tes of data were
+0001b640: 2070 6173 7365 6420 6173 2061 2073 6567   passed as a seg
+0001b650: 6d65 6e74 2e0a 5374 7265 616d 2062 6c6f  ment..Stream blo
+0001b660: 6273 2061 7265 2073 746f 7265 6420 6173  bs are stored as
+0001b670: 2061 2063 6f6e 7469 6e75 6f75 7320 6172   a continuous ar
+0001b680: 7261 7920 6f66 2064 6174 6120 6279 7465  ray of data byte
+0001b690: 7320 7769 7468 206e 6f20 6c65 6e67 7468  s with no length
+0001b6a0: 2069 6e64 6963 6174 6f72 7320 696e 636c   indicators incl
+0001b6b0: 7564 6564 2e22 2222 0a20 2020 2020 2020  uded.""".       
+0001b6c0: 2077 6974 6820 7365 6c66 2e63 6f6e 2e63   with self.con.c
+0001b6d0: 7572 736f 7228 2920 6173 2063 7572 3a0a  ursor() as cur:.
+0001b6e0: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+0001b6f0: 6578 6563 7574 6528 2769 6e73 6572 7420  execute('insert 
+0001b700: 696e 746f 2054 3220 2843 312c 4339 2920  into T2 (C1,C9) 
+0001b710: 7661 6c75 6573 2028 3f2c 3f29 272c 205b  values (?,?)', [
+0001b720: 312c 2053 7472 696e 6749 4f28 626c 6f62  1, StringIO(blob
+0001b730: 295d 290a 2020 2020 2020 2020 2020 2020  )]).            
+0001b740: 6375 722e 6578 6563 7574 6528 2769 6e73  cur.execute('ins
+0001b750: 6572 7420 696e 746f 2054 3220 2843 312c  ert into T2 (C1,
+0001b760: 4339 2920 7661 6c75 6573 2028 3f2c 3f29  C9) values (?,?)
+0001b770: 272c 205b 322c 2053 7472 696e 6749 4f28  ', [2, StringIO(
+0001b780: 626c 6f62 295d 290a 2020 2020 2020 2020  blob)]).        
+0001b790: 2020 2020 7365 6c66 2e63 6f6e 2e63 6f6d      self.con.com
+0001b7a0: 6d69 7428 290a 2020 2020 2020 2020 2020  mit().          
+0001b7b0: 2020 7020 3d20 6375 722e 7072 6570 6172    p = cur.prepar
+0001b7c0: 6528 2773 656c 6563 7420 4331 2c43 3920  e('select C1,C9 
+0001b7d0: 6672 6f6d 2054 3227 290a 2020 2020 2020  from T2').      
+0001b7e0: 2020 2020 2020 6375 722e 7374 7265 616d        cur.stream
+0001b7f0: 5f62 6c6f 6273 2e61 7070 656e 6428 2743  _blobs.append('C
+0001b800: 3927 290a 2020 2020 2020 2020 2020 2020  9').            
+0001b810: 6375 722e 6578 6563 7574 6528 7029 0a20  cur.execute(p). 
+0001b820: 2020 2020 2020 2020 2020 2066 6f72 2072             for r
+0001b830: 6f77 2069 6e20 6375 723a 0a20 2020 2020  ow in cur:.     
+0001b840: 2020 2020 2020 2020 2020 2062 6c6f 625f             blob_
+0001b850: 7265 6164 6572 203d 2072 6f77 5b31 5d0a  reader = row[1].
+0001b860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b870: 7769 7468 2062 6c6f 625f 7265 6164 6572  with blob_reader
+0001b880: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001b890: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001b8a0: 7445 7175 616c 2862 6c6f 625f 7265 6164  tEqual(blob_read
+0001b8b0: 6572 2e72 6561 6428 3230 292c 2027 4669  er.read(20), 'Fi
+0001b8c0: 7265 6269 7264 2073 7570 706f 7274 7320  rebird supports 
+0001b8d0: 7477 2729 0a20 2020 2020 2020 2020 2020  tw').           
+0001b8e0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0001b8f0: 7365 7274 4571 7561 6c28 626c 6f62 5f72  sertEqual(blob_r
+0001b900: 6561 6465 722e 7265 6164 2832 3029 2c20  eader.read(20), 
+0001b910: 276f 2074 7970 6573 206f 6620 626c 6f62  'o types of blob
+0001b920: 732c 2073 7427 290a 2020 2020 2020 2020  s, st').        
+0001b930: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001b940: 2e61 7373 6572 7445 7175 616c 2862 6c6f  .assertEqual(blo
+0001b950: 625f 7265 6164 6572 2e72 6561 6428 3430  b_reader.read(40
+0001b960: 3029 2c20 2772 6561 6d20 616e 6420 7365  0), 'ream and se
+0001b970: 676d 656e 7465 642e 5c6e 5468 6520 6461  gmented.\nThe da
+0001b980: 7461 6261 7365 2073 746f 7265 7320 7365  tabase stores se
+0001b990: 676d 656e 7465 6420 626c 6f62 7320 270a  gmented blobs '.
+0001b9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b9c0: 2020 2020 2027 696e 2063 6875 6e6b 732e       'in chunks.
+0001b9d0: 5c6e 4561 6368 2063 6875 6e6b 2073 7461  \nEach chunk sta
+0001b9e0: 7274 7320 7769 7468 2061 2074 776f 2062  rts with a two b
+0001b9f0: 7974 6520 6c65 6e67 7468 2027 0a20 2020  yte length '.   
+0001ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba20: 2020 2769 6e64 6963 6174 6f72 2066 6f6c    'indicator fol
+0001ba30: 6c6f 7765 6420 6279 2068 6f77 6576 6572  lowed by however
+0001ba40: 206d 616e 7920 6279 7465 7320 6f66 2064   many bytes of d
+0001ba50: 6174 6120 7765 7265 2027 0a20 2020 2020  ata were '.     
+0001ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba80: 2770 6173 7365 6420 6173 2061 2073 6567  'passed as a seg
+0001ba90: 6d65 6e74 2e5c 6e53 7472 6561 6d20 626c  ment.\nStream bl
+0001baa0: 6f62 7320 6172 6520 7374 6f72 6564 2061  obs are stored a
+0001bab0: 7320 6120 270a 2020 2020 2020 2020 2020  s a '.          
+0001bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bad0: 2020 2020 2020 2020 2020 2027 636f 6e74             'cont
+0001bae0: 696e 756f 7573 2061 7272 6179 206f 6620  inuous array of 
+0001baf0: 6461 7461 2062 7974 6573 2077 6974 6820  data bytes with 
+0001bb00: 6e6f 206c 656e 6774 6820 696e 6469 6361  no length indica
+0001bb10: 746f 7273 2027 0a20 2020 2020 2020 2020  tors '.         
+0001bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bb30: 2020 2020 2020 2020 2020 2020 2769 6e63              'inc
+0001bb40: 6c75 6465 642e 2729 0a20 2020 2020 2020  luded.').       
+0001bb50: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001bb60: 662e 6173 7365 7274 4571 7561 6c28 626c  f.assertEqual(bl
+0001bb70: 6f62 5f72 6561 6465 722e 7265 6164 2832  ob_reader.read(2
+0001bb80: 3029 2c20 2727 290a 2020 2020 2020 2020  0), '').        
+0001bb90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001bba0: 2e61 7373 6572 7445 7175 616c 2862 6c6f  .assertEqual(blo
+0001bbb0: 625f 7265 6164 6572 2e74 656c 6c28 292c  b_reader.tell(),
+0001bbc0: 2033 3138 290a 2020 2020 2020 2020 2020   318).          
+0001bbd0: 2020 2020 2020 2020 2020 626c 6f62 5f72            blob_r
+0001bbe0: 6561 6465 722e 7365 656b 2832 3029 0a20  eader.seek(20). 
+0001bbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc00: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001bc10: 7561 6c28 626c 6f62 5f72 6561 6465 722e  ual(blob_reader.
+0001bc20: 7465 6c6c 2829 2c20 3230 290a 2020 2020  tell(), 20).    
+0001bc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc40: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0001bc50: 2862 6c6f 625f 7265 6164 6572 2e72 6561  (blob_reader.rea
+0001bc60: 6428 3230 292c 2027 6f20 7479 7065 7320  d(20), 'o types 
+0001bc70: 6f66 2062 6c6f 6273 2c20 7374 2729 0a20  of blobs, st'). 
+0001bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc90: 2020 2062 6c6f 625f 7265 6164 6572 2e73     blob_reader.s
+0001bca0: 6565 6b28 3029 0a20 2020 2020 2020 2020  eek(0).         
+0001bcb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001bcc0: 6173 7365 7274 4571 7561 6c28 626c 6f62  assertEqual(blob
+0001bcd0: 5f72 6561 6465 722e 7465 6c6c 2829 2c20  _reader.tell(), 
+0001bce0: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
+0001bcf0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001bd00: 7274 4c69 7374 4571 7561 6c28 626c 6f62  rtListEqual(blob
+0001bd10: 5f72 6561 6465 722e 7265 6164 6c69 6e65  _reader.readline
+0001bd20: 7328 292c 0a20 2020 2020 2020 2020 2020  s(),.           
 0001bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd40: 2020 2020 2020 2028 312c 2062 7974 6573         (1, bytes
-0001bd50: 7472 696e 672c 2062 7974 6573 7472 696e  tring, bytestrin
-0001bd60: 6729 290a 2020 2020 2020 2020 2020 2020  g)).            
-0001bd70: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
-0001bd80: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-0001bd90: 722e 6578 6563 7574 6528 2273 656c 6563  r.execute("selec
-0001bda0: 7420 4331 2c20 435f 4f43 5445 5453 2c20  t C1, C_OCTETS, 
-0001bdb0: 565f 4f43 5445 5453 2066 726f 6d20 5434  V_OCTETS from T4
-0001bdc0: 2077 6865 7265 2043 3120 3d20 3122 290a   where C1 = 1").
-0001bdd0: 2020 2020 2020 2020 2020 2020 726f 7720              row 
-0001bde0: 3d20 6375 722e 6665 7463 686f 6e65 2829  = cur.fetchone()
-0001bdf0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001be00: 662e 6173 7365 7274 5475 706c 6545 7175  f.assertTupleEqu
-0001be10: 616c 2872 6f77 2c0a 2020 2020 2020 2020  al(row,.        
-0001be20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be30: 2020 2020 2020 2020 2020 2831 2c20 6227            (1, b'
-0001be40: 5c78 3031 5c78 3032 5c78 3033 5c78 3034  \x01\x02\x03\x04
-0001be50: 5c78 3035 272c 2062 275c 7830 315c 7830  \x05', b'\x01\x0
-0001be60: 325c 7830 335c 7830 345c 7830 3527 2929  2\x03\x04\x05'))
-0001be70: 0a20 2020 2064 6566 2074 6573 745f 7574  .    def test_ut
-0001be80: 6638 3277 696e 3132 3530 2873 656c 6629  f82win1250(self)
-0001be90: 3a0a 2020 2020 2020 2020 7335 203d 2027  :.        s5 = '
-0001bea0: c49b c5a1 c48d c599 c5be 270a 2020 2020  ..........'.    
-0001beb0: 2020 2020 7333 3020 3d20 27c4 9bc5 a1c4      s30 = '.....
-0001bec0: 8dc5 99c5 bec3 bdc3 a1c3 adc3 a9c3 bac5  ................
-0001bed0: afc4 8fc5 a5c5 88c3 b3c4 9ac5 a0c4 8cc5  ................
-0001bee0: 98c5 bdc3 9dc3 81c3 8dc3 89c3 9ac5 aec4  ................
-0001bef0: 8ec5 a4c5 87c3 9327 0a0a 2020 2020 2020  .......'..      
-0001bf00: 2020 7769 7468 2063 6f6e 6e65 6374 2873    with connect(s
-0001bf10: 656c 662e 6462 6669 6c65 2c20 7573 6572  elf.dbfile, user
-0001bf20: 3d46 4254 4553 545f 5553 4552 2c0a 2020  =FBTEST_USER,.  
-0001bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf40: 2020 2070 6173 7377 6f72 643d 4642 5445     password=FBTE
-0001bf50: 5354 5f50 4153 5357 4f52 442c 2063 6861  ST_PASSWORD, cha
-0001bf60: 7273 6574 3d27 7769 6e31 3235 3027 2920  rset='win1250') 
-0001bf70: 6173 2063 6f6e 3132 3530 3a0a 2020 2020  as con1250:.    
-0001bf80: 2020 2020 2020 2020 636f 6e31 3235 302e          con1250.
-0001bf90: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
-0001bfa0: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
-0001bfb0: 6e61 6d65 5f5f 0a20 2020 2020 2020 2020  name__.         
-0001bfc0: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
-0001bfd0: 2e63 7572 736f 7228 2920 6173 2063 5f75  .cursor() as c_u
-0001bfe0: 7466 382c 2063 6f6e 3132 3530 2e63 7572  tf8, con1250.cur
-0001bff0: 736f 7228 2920 6173 2063 5f77 696e 3132  sor() as c_win12
-0001c000: 3530 3a0a 2020 2020 2020 2020 2020 2020  50:.            
-0001c010: 2020 2020 2320 496e 7365 7274 2075 6e69      # Insert uni
-0001c020: 636f 6465 2064 6174 610a 2020 2020 2020  code data.      
-0001c030: 2020 2020 2020 2020 2020 635f 7574 6638            c_utf8
-0001c040: 2e65 7865 6375 7465 2822 696e 7365 7274  .execute("insert
-0001c050: 2069 6e74 6f20 5434 2028 4331 2c20 435f   into T4 (C1, C_
-0001c060: 5749 4e31 3235 302c 2056 5f57 494e 3132  WIN1250, V_WIN12
-0001c070: 3530 2c20 435f 5554 4638 2c20 565f 5554  50, C_UTF8, V_UT
-0001c080: 4638 2922 0a20 2020 2020 2020 2020 2020  F8)".           
-0001c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0a0: 2020 2020 2276 616c 7565 7320 283f 2c3f      "values (?,?
-0001c0b0: 2c3f 2c3f 2c3f 2922 2c0a 2020 2020 2020  ,?,?,?)",.      
-0001c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0d0: 2020 2020 2020 2020 2028 312c 2073 352c           (1, s5,
-0001c0e0: 2073 3330 2c20 7335 2c20 7333 3029 290a   s30, s5, s30)).
-0001c0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c100: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
-0001c110: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0001c120: 2020 2023 2053 686f 756c 6420 7265 7475     # Should retu
-0001c130: 726e 2074 6865 2073 616d 6520 756e 6963  rn the same unic
-0001c140: 6f64 6520 636f 6e74 656e 7420 7768 656e  ode content when
-0001c150: 2072 6561 6420 6672 6f6d 2077 696e 3132   read from win12
-0001c160: 3530 206f 7220 7574 6638 2063 6f6e 6e65  50 or utf8 conne
-0001c170: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
-0001c180: 2020 2020 2020 635f 7769 6e31 3235 302e        c_win1250.
-0001c190: 6578 6563 7574 6528 2273 656c 6563 7420  execute("select 
-0001c1a0: 4331 2c20 435f 5749 4e31 3235 302c 2056  C1, C_WIN1250, V
-0001c1b0: 5f57 494e 3132 3530 2c22 0a20 2020 2020  _WIN1250,".     
-0001c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1d0: 2020 2020 2020 2020 2020 2020 2022 435f               "C_
-0001c1e0: 5554 4638 2c20 565f 5554 4638 2066 726f  UTF8, V_UTF8 fro
-0001c1f0: 6d20 5434 2077 6865 7265 2043 3120 3d20  m T4 where C1 = 
-0001c200: 3122 290a 2020 2020 2020 2020 2020 2020  1").            
-0001c210: 2020 2020 726f 7720 3d20 635f 7769 6e31      row = c_win1
-0001c220: 3235 302e 6665 7463 686f 6e65 2829 0a20  250.fetchone(). 
-0001c230: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001c240: 656c 662e 6173 7365 7274 5475 706c 6545  elf.assertTupleE
-0001c250: 7175 616c 2872 6f77 2c20 2831 2c20 7335  qual(row, (1, s5
-0001c260: 2c20 7333 302c 2073 352c 2073 3330 2929  , s30, s5, s30))
-0001c270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c280: 2063 5f75 7466 382e 6578 6563 7574 6528   c_utf8.execute(
-0001c290: 2273 656c 6563 7420 4331 2c20 435f 5749  "select C1, C_WI
-0001c2a0: 4e31 3235 302c 2056 5f57 494e 3132 3530  N1250, V_WIN1250
-0001c2b0: 2c22 0a20 2020 2020 2020 2020 2020 2020  ,".             
-0001c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2d0: 2020 2243 5f55 5446 382c 2056 5f55 5446    "C_UTF8, V_UTF
-0001c2e0: 3820 6672 6f6d 2054 3420 7768 6572 6520  8 from T4 where 
-0001c2f0: 4331 203d 2031 2229 0a20 2020 2020 2020  C1 = 1").       
-0001c300: 2020 2020 2020 2020 2072 6f77 203d 2063           row = c
-0001c310: 5f75 7466 382e 6665 7463 686f 6e65 2829  _utf8.fetchone()
-0001c320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c330: 2073 656c 662e 6173 7365 7274 5475 706c   self.assertTupl
-0001c340: 6545 7175 616c 2872 6f77 2c20 2831 2c20  eEqual(row, (1, 
-0001c350: 7335 2c20 7333 302c 2073 352c 2073 3330  s5, s30, s5, s30
-0001c360: 2929 0a20 2020 2064 6566 2074 6573 7443  )).    def testC
-0001c370: 6861 7256 6172 6368 6172 2873 656c 6629  harVarchar(self)
-0001c380: 3a0a 2020 2020 2020 2020 7320 3d20 2749  :.        s = 'I
-0001c390: 6e74 726f 6475 c3a7 c3a3 6f27 0a20 2020  ntrodu....o'.   
-0001c3a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001c3b0: 4571 7561 6c28 6c65 6e28 7329 2c20 3130  Equal(len(s), 10
-0001c3c0: 290a 2020 2020 2020 2020 6461 7461 203d  ).        data =
-0001c3d0: 2074 7570 6c65 285b 312c 2073 2c20 735d   tuple([1, s, s]
-0001c3e0: 290a 2020 2020 2020 2020 7769 7468 2073  ).        with s
-0001c3f0: 656c 662e 636f 6e2e 6375 7273 6f72 2829  elf.con.cursor()
-0001c400: 2061 7320 6375 723a 0a20 2020 2020 2020   as cur:.       
-0001c410: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0001c420: 2827 696e 7365 7274 2069 6e74 6f20 5433  ('insert into T3
-0001c430: 2028 4331 2c43 322c 4333 2920 7661 6c75   (C1,C2,C3) valu
-0001c440: 6573 2028 3f2c 3f2c 3f29 272c 2064 6174  es (?,?,?)', dat
-0001c450: 6129 0a20 2020 2020 2020 2020 2020 2073  a).            s
-0001c460: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
-0001c470: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0001c480: 2e65 7865 6375 7465 2827 7365 6c65 6374  .execute('select
-0001c490: 2043 312c 4332 2c43 3320 6672 6f6d 2054   C1,C2,C3 from T
-0001c4a0: 3320 7768 6572 6520 4331 203d 2031 2729  3 where C1 = 1')
-0001c4b0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-0001c4c0: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-0001c4d0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0001c4e0: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
-0001c4f0: 6f77 2c20 6461 7461 290a 2020 2020 6465  ow, data).    de
-0001c500: 6620 7465 7374 426c 6f62 2873 656c 6629  f testBlob(self)
-0001c510: 3a0a 2020 2020 2020 2020 7320 3d20 2222  :.        s = ""
-0001c520: 2249 6e74 726f 6475 c3a7 c3a3 6f0a 0a45  "Introdu....o..E
-0001c530: 7374 6520 6172 7469 676f 2064 6573 6372  ste artigo descr
-0001c540: 6576 6520 636f 6d6f 2076 6f63 c3aa 2070  eve como voc.. p
-0001c550: 6f64 6520 6661 7a65 7220 6f20 496e 7465  ode fazer o Inte
-0001c560: 7242 6173 6520 6520 6f20 4669 7265 6269  rBase e o Firebi
-0001c570: 7264 2031 2e35 0a63 6f65 6861 6269 7461  rd 1.5.coehabita
-0001c580: 7265 6d20 7061 6369 6669 6361 6d65 6e74  rem pacificament
-0001c590: 6520 7365 7520 636f 6d70 7574 6164 6f72  e seu computador
-0001c5a0: 2057 696e 646f 7773 2e20 506f 7220 6661   Windows. Por fa
-0001c5b0: 766f 722c 206e 6f74 6520 7175 6520 6573  vor, note que es
-0001c5c0: 7461 0a73 6f6c 75c3 a7c3 a36f 206e c3a3  ta.solu....o n..
-0001c5d0: 6f20 7065 726d 6974 6972 c3a1 2071 7565  o permitir.. que
-0001c5e0: 206f 2049 6e74 6572 6261 7365 2065 206f   o Interbase e o
-0001c5f0: 2046 6972 6562 6972 6420 726f 6465 6d20   Firebird rodem 
-0001c600: 616f 206d 6573 6d6f 2074 656d 706f 2e0a  ao mesmo tempo..
-0001c610: 506f 72c3 a96d 2076 6f63 c3aa 2070 6f64  Por..m voc.. pod
-0001c620: 6572 c3a1 2074 726f 6361 7220 656e 7472  er.. trocar entr
-0001c630: 6520 616d 626f 7320 636f 6d20 756d 206d  e ambos com um m
-0001c640: c3ad 6e69 6d6f 2064 6520 6c75 7461 2e20  ..nimo de luta. 
-0001c650: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-0001c660: 2e61 7373 6572 7445 7175 616c 286c 656e  .assertEqual(len
-0001c670: 2873 292c 2032 3932 290a 2020 2020 2020  (s), 292).      
-0001c680: 2020 6461 7461 203d 2074 7570 6c65 285b    data = tuple([
-0001c690: 322c 2073 5d29 0a20 2020 2020 2020 2062  2, s]).        b
-0001c6a0: 5f64 6174 6120 3d20 7475 706c 6528 5b33  _data = tuple([3
-0001c6b0: 2c20 6227 6279 7465 7374 7269 6e67 275d  , b'bytestring']
-0001c6c0: 290a 2020 2020 2020 2020 7769 7468 2073  ).        with s
-0001c6d0: 656c 662e 636f 6e2e 6375 7273 6f72 2829  elf.con.cursor()
-0001c6e0: 2061 7320 6375 723a 0a20 2020 2020 2020   as cur:.       
-0001c6f0: 2020 2020 2023 2054 6578 7420 424c 4f42       # Text BLOB
-0001c700: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0001c710: 2e65 7865 6375 7465 2827 696e 7365 7274  .execute('insert
-0001c720: 2069 6e74 6f20 5433 2028 4331 2c43 3429   into T3 (C1,C4)
-0001c730: 2076 616c 7565 7320 283f 2c3f 2927 2c20   values (?,?)', 
-0001c740: 6461 7461 290a 2020 2020 2020 2020 2020  data).          
-0001c750: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
-0001c760: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
-0001c770: 6375 722e 6578 6563 7574 6528 2773 656c  cur.execute('sel
-0001c780: 6563 7420 4331 2c43 3420 6672 6f6d 2054  ect C1,C4 from T
-0001c790: 3320 7768 6572 6520 4331 203d 2032 2729  3 where C1 = 2')
-0001c7a0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-0001c7b0: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
-0001c7c0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0001c7d0: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
-0001c7e0: 6f77 2c20 6461 7461 290a 2020 2020 2020  ow, data).      
-0001c7f0: 2020 2020 2020 2320 496e 7365 7274 2055        # Insert U
-0001c800: 6e69 636f 6465 2069 6e74 6f20 6e6f 6e2d  nicode into non-
-0001c810: 7465 7874 7561 6c20 424c 4f42 0a20 2020  textual BLOB.   
-0001c820: 2020 2020 2020 2020 2077 6974 6820 7365           with se
-0001c830: 6c66 2e61 7373 6572 7452 6169 7365 7328  lf.assertRaises(
-0001c840: 5479 7065 4572 726f 7229 2061 7320 636d  TypeError) as cm
-0001c850: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001c860: 2020 6375 722e 6578 6563 7574 6528 2769    cur.execute('i
-0001c870: 6e73 6572 7420 696e 746f 2054 3320 2843  nsert into T3 (C
-0001c880: 312c 4335 2920 7661 6c75 6573 2028 3f2c  1,C5) values (?,
-0001c890: 3f29 272c 2064 6174 6129 0a20 2020 2020  ?)', data).     
-0001c8a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001c8b0: 636f 6e2e 636f 6d6d 6974 2829 0a20 2020  con.commit().   
-0001c8c0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001c8d0: 7365 7274 5475 706c 6545 7175 616c 2863  sertTupleEqual(c
-0001c8e0: 6d2e 6578 6365 7074 696f 6e2e 6172 6773  m.exception.args
-0001c8f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c910: 2020 2020 2822 5374 7269 6e67 2076 616c      ("String val
-0001c920: 7565 2069 7320 6e6f 7420 6163 6365 7074  ue is not accept
-0001c930: 6162 6c65 2074 7970 6520 666f 7220 6120  able type for a 
-0001c940: 6e6f 6e2d 7465 7874 7561 6c20 424c 4f42  non-textual BLOB
-0001c950: 2063 6f6c 756d 6e2e 222c 2929 0a20 2020   column.",)).   
-0001c960: 2020 2020 2020 2020 2023 2052 6561 6420           # Read 
-0001c970: 6269 6e61 7279 2066 726f 6d20 6e6f 6e2d  binary from non-
-0001c980: 7465 7874 7561 6c20 424c 4f42 0a20 2020  textual BLOB.   
-0001c990: 2020 2020 2020 2020 2063 7572 2e65 7865           cur.exe
-0001c9a0: 6375 7465 2827 696e 7365 7274 2069 6e74  cute('insert int
-0001c9b0: 6f20 5433 2028 4331 2c43 3529 2076 616c  o T3 (C1,C5) val
-0001c9c0: 7565 7320 283f 2c3f 2927 2c20 625f 6461  ues (?,?)', b_da
-0001c9d0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-0001c9e0: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
-0001c9f0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-0001ca00: 722e 6578 6563 7574 6528 2773 656c 6563  r.execute('selec
-0001ca10: 7420 4331 2c43 3520 6672 6f6d 2054 3320  t C1,C5 from T3 
-0001ca20: 7768 6572 6520 4331 203d 2033 2729 0a20  where C1 = 3'). 
-0001ca30: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
-0001ca40: 2063 7572 2e66 6574 6368 6f6e 6528 290a   cur.fetchone().
-0001ca50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001ca60: 2e61 7373 6572 7445 7175 616c 2872 6f77  .assertEqual(row
-0001ca70: 2c20 625f 6461 7461 290a 0a63 6c61 7373  , b_data)..class
-0001ca80: 2054 6573 7448 6f6f 6b73 2844 7269 7665   TestHooks(Drive
-0001ca90: 7254 6573 7442 6173 6529 3a0a 2020 2020  rTestBase):.    
-0001caa0: 6465 6620 7365 7455 7028 7365 6c66 293a  def setUp(self):
-0001cab0: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
-0001cac0: 2e73 6574 5570 2829 0a20 2020 2020 2020  .setUp().       
-0001cad0: 2073 656c 662e 6462 6669 6c65 203d 206f   self.dbfile = o
-0001cae0: 732e 7061 7468 2e6a 6f69 6e28 7365 6c66  s.path.join(self
-0001caf0: 2e64 6270 6174 682c 2073 656c 662e 4642  .dbpath, self.FB
-0001cb00: 5445 5354 5f44 4229 0a20 2020 2020 2020  TEST_DB).       
-0001cb10: 2068 6f6f 6b5f 6d61 6e61 6765 722e 7265   hook_manager.re
-0001cb20: 6d6f 7665 5f61 6c6c 5f68 6f6f 6b73 2829  move_all_hooks()
-0001cb30: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
-0001cb40: 6220 3d20 4e6f 6e65 0a20 2020 2020 2020  b = None.       
-0001cb50: 2073 656c 662e 5f73 7663 203d 204e 6f6e   self._svc = Non
-0001cb60: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-0001cb70: 686f 6f6b 5f63 6f6e 203d 204e 6f6e 650a  hook_con = None.
-0001cb80: 2020 2020 6465 6620 7465 6172 446f 776e      def tearDown
-0001cb90: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001cba0: 666f 7220 6974 656d 2069 6e20 5b73 656c  for item in [sel
-0001cbb0: 662e 5f64 622c 2073 656c 662e 5f73 7663  f._db, self._svc
-0001cbc0: 2c20 7365 6c66 2e5f 686f 6f6b 5f63 6f6e  , self._hook_con
-0001cbd0: 5d3a 0a20 2020 2020 2020 2020 2020 2069  ]:.            i
-0001cbe0: 6620 6974 656d 3a0a 2020 2020 2020 2020  f item:.        
-0001cbf0: 2020 2020 2020 2020 6974 656d 2e63 6c6f          item.clo
-0001cc00: 7365 2829 0a20 2020 2064 6566 205f 5f68  se().    def __h
-0001cc10: 6f6f 6b5f 7365 7276 6963 655f 6174 7461  ook_service_atta
-0001cc20: 6368 6564 2873 656c 662c 2063 6f6e 293a  ched(self, con):
-0001cc30: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
-0001cc40: 7663 203d 2063 6f6e 0a20 2020 2020 2020  vc = con.       
-0001cc50: 2072 6574 7572 6e20 636f 6e0a 2020 2020   return con.    
-0001cc60: 6465 6620 5f5f 686f 6f6b 5f64 625f 6174  def __hook_db_at
-0001cc70: 7461 6368 6564 2873 656c 662c 2063 6f6e  tached(self, con
-0001cc80: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-0001cc90: 5f64 6220 3d20 636f 6e0a 2020 2020 2020  _db = con.      
-0001cca0: 2020 7265 7475 726e 2063 6f6e 0a20 2020    return con.   
-0001ccb0: 2064 6566 205f 5f68 6f6f 6b5f 6462 5f63   def __hook_db_c
-0001ccc0: 6c6f 7365 6428 7365 6c66 2c20 636f 6e29  losed(self, con)
-0001ccd0: 3a0a 2020 2020 2020 2020 7365 6c66 2e5f  :.        self._
-0001cce0: 6462 203d 2063 6f6e 0a20 2020 2064 6566  db = con.    def
-0001ccf0: 205f 5f68 6f6f 6b5f 6462 5f64 6574 6163   __hook_db_detac
-0001cd00: 685f 7265 7175 6573 745f 6128 7365 6c66  h_request_a(self
-0001cd10: 2c20 636f 6e29 3a0a 2020 2020 2020 2020  , con):.        
-0001cd20: 2320 7265 7461 696e 0a20 2020 2020 2020  # retain.       
-0001cd30: 2073 656c 662e 5f64 6220 3d20 636f 6e0a   self._db = con.
-0001cd40: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-0001cd50: 7275 650a 2020 2020 6465 6620 5f5f 686f  rue.    def __ho
-0001cd60: 6f6b 5f64 625f 6465 7461 6368 5f72 6571  ok_db_detach_req
-0001cd70: 7565 7374 5f62 2873 656c 662c 2063 6f6e  uest_b(self, con
-0001cd80: 293a 0a20 2020 2020 2020 2023 206e 6f20  ):.        # no 
-0001cd90: 7265 7461 696e 0a20 2020 2020 2020 2073  retain.        s
-0001cda0: 656c 662e 5f64 6220 3d20 636f 6e0a 2020  elf._db = con.  
-0001cdb0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
-0001cdc0: 7365 0a20 2020 2064 6566 205f 5f68 6f6f  se.    def __hoo
-0001cdd0: 6b5f 6462 5f61 7474 6163 685f 7265 7175  k_db_attach_requ
-0001cde0: 6573 745f 6128 7365 6c66 2c20 6473 6e2c  est_a(self, dsn,
-0001cdf0: 2064 7062 293a 0a20 2020 2020 2020 2072   dpb):.        r
-0001ce00: 6574 7572 6e20 4e6f 6e65 0a20 2020 2064  eturn None.    d
-0001ce10: 6566 205f 5f68 6f6f 6b5f 6462 5f61 7474  ef __hook_db_att
-0001ce20: 6163 685f 7265 7175 6573 745f 6228 7365  ach_request_b(se
-0001ce30: 6c66 2c20 6473 6e2c 2064 7062 293a 0a20  lf, dsn, dpb):. 
-0001ce40: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001ce50: 6c66 2e5f 686f 6f6b 5f63 6f6e 0a20 2020  lf._hook_con.   
-0001ce60: 2064 6566 2074 6573 745f 686f 6f6b 5f64   def test_hook_d
-0001ce70: 625f 6174 7461 6368 6564 2873 656c 6629  b_attached(self)
-0001ce80: 3a0a 2020 2020 2020 2020 6164 645f 686f  :.        add_ho
-0001ce90: 6f6b 2843 6f6e 6e65 6374 696f 6e48 6f6f  ok(ConnectionHoo
-0001cea0: 6b2e 4154 5441 4348 4544 2c20 6472 6976  k.ATTACHED, driv
-0001ceb0: 6572 2e43 6f6e 6e65 6374 696f 6e2c 2073  er.Connection, s
-0001cec0: 656c 662e 5f5f 686f 6f6b 5f64 625f 6174  elf.__hook_db_at
-0001ced0: 7461 6368 6564 290a 2020 2020 2020 2020  tached).        
-0001cee0: 7769 7468 2063 6f6e 6e65 6374 2873 656c  with connect(sel
-0001cef0: 662e 6462 6669 6c65 2c20 7573 6572 3d46  f.dbfile, user=F
-0001cf00: 4254 4553 545f 5553 4552 2c20 7061 7373  BTEST_USER, pass
-0001cf10: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
-0001cf20: 574f 5244 2920 6173 2063 6f6e 3a0a 2020  WORD) as con:.  
-0001cf30: 2020 2020 2020 2020 2020 636f 6e2e 5f6c            con._l
-0001cf40: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
-0001cf50: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-0001cf60: 6d65 5f5f 0a20 2020 2020 2020 2020 2020  me__.           
-0001cf70: 2073 656c 662e 6173 7365 7274 4973 2863   self.assertIs(c
-0001cf80: 6f6e 2c20 7365 6c66 2e5f 6462 290a 2020  on, self._db).  
-0001cf90: 2020 6465 6620 7465 7374 5f68 6f6f 6b5f    def test_hook_
-0001cfa0: 6462 5f61 7474 6163 685f 7265 7175 6573  db_attach_reques
-0001cfb0: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-0001cfc0: 2073 656c 662e 5f68 6f6f 6b5f 636f 6e20   self._hook_con 
-0001cfd0: 3d20 636f 6e6e 6563 7428 7365 6c66 2e64  = connect(self.d
-0001cfe0: 6266 696c 652c 2075 7365 723d 4642 5445  bfile, user=FBTE
-0001cff0: 5354 5f55 5345 522c 2070 6173 7377 6f72  ST_USER, passwor
-0001d000: 643d 4642 5445 5354 5f50 4153 5357 4f52  d=FBTEST_PASSWOR
-0001d010: 4429 0a20 2020 2020 2020 2073 656c 662e  D).        self.
-0001d020: 5f68 6f6f 6b5f 636f 6e2e 5f6c 6f67 6769  _hook_con._loggi
-0001d030: 6e67 5f69 645f 203d 2073 656c 662e 5f5f  ng_id_ = self.__
-0001d040: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-0001d050: 0a20 2020 2020 2020 2061 6464 5f68 6f6f  .        add_hoo
-0001d060: 6b28 436f 6e6e 6563 7469 6f6e 486f 6f6b  k(ConnectionHook
-0001d070: 2e41 5454 4143 485f 5245 5155 4553 542c  .ATTACH_REQUEST,
-0001d080: 2064 7269 7665 722e 436f 6e6e 6563 7469   driver.Connecti
-0001d090: 6f6e 2c20 7365 6c66 2e5f 5f68 6f6f 6b5f  on, self.__hook_
-0001d0a0: 6462 5f61 7474 6163 685f 7265 7175 6573  db_attach_reques
-0001d0b0: 745f 6129 0a20 2020 2020 2020 2061 6464  t_a).        add
-0001d0c0: 5f68 6f6f 6b28 436f 6e6e 6563 7469 6f6e  _hook(Connection
-0001d0d0: 486f 6f6b 2e41 5454 4143 485f 5245 5155  Hook.ATTACH_REQU
-0001d0e0: 4553 542c 2064 7269 7665 722e 436f 6e6e  EST, driver.Conn
-0001d0f0: 6563 7469 6f6e 2c20 7365 6c66 2e5f 5f68  ection, self.__h
-0001d100: 6f6f 6b5f 6462 5f61 7474 6163 685f 7265  ook_db_attach_re
-0001d110: 7175 6573 745f 6229 0a20 2020 2020 2020  quest_b).       
-0001d120: 2077 6974 6820 636f 6e6e 6563 7428 7365   with connect(se
-0001d130: 6c66 2e64 6266 696c 652c 2075 7365 723d  lf.dbfile, user=
-0001d140: 4642 5445 5354 5f55 5345 522c 2070 6173  FBTEST_USER, pas
-0001d150: 7377 6f72 643d 4642 5445 5354 5f50 4153  sword=FBTEST_PAS
-0001d160: 5357 4f52 4429 2061 7320 636f 6e3a 0a20  SWORD) as con:. 
-0001d170: 2020 2020 2020 2020 2020 2063 6f6e 2e5f             con._
-0001d180: 6c6f 6767 696e 675f 6964 5f20 3d20 7365  logging_id_ = se
-0001d190: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-0001d1a0: 616d 655f 5f0a 2020 2020 2020 2020 2020  ame__.          
-0001d1b0: 2020 7365 6c66 2e61 7373 6572 7449 7328    self.assertIs(
-0001d1c0: 636f 6e2c 2073 656c 662e 5f68 6f6f 6b5f  con, self._hook_
-0001d1d0: 636f 6e29 0a20 2020 2020 2020 2073 656c  con).        sel
-0001d1e0: 662e 5f68 6f6f 6b5f 636f 6e2e 636c 6f73  f._hook_con.clos
-0001d1f0: 6528 290a 2020 2020 6465 6620 7465 7374  e().    def test
-0001d200: 5f68 6f6f 6b5f 6462 5f63 6c6f 7365 6428  _hook_db_closed(
-0001d210: 7365 6c66 293a 0a20 2020 2020 2020 2077  self):.        w
-0001d220: 6974 6820 636f 6e6e 6563 7428 7365 6c66  ith connect(self
-0001d230: 2e64 6266 696c 652c 2075 7365 723d 4642  .dbfile, user=FB
-0001d240: 5445 5354 5f55 5345 522c 2070 6173 7377  TEST_USER, passw
-0001d250: 6f72 643d 4642 5445 5354 5f50 4153 5357  ord=FBTEST_PASSW
-0001d260: 4f52 4429 2061 7320 636f 6e3a 0a20 2020  ORD) as con:.   
-0001d270: 2020 2020 2020 2020 2063 6f6e 2e5f 6c6f           con._lo
-0001d280: 6767 696e 675f 6964 5f20 3d20 7365 6c66  gging_id_ = self
-0001d290: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-0001d2a0: 655f 5f0a 2020 2020 2020 2020 2020 2020  e__.            
-0001d2b0: 6164 645f 686f 6f6b 2843 6f6e 6e65 6374  add_hook(Connect
-0001d2c0: 696f 6e48 6f6f 6b2e 434c 4f53 4544 2c20  ionHook.CLOSED, 
-0001d2d0: 636f 6e2c 2073 656c 662e 5f5f 686f 6f6b  con, self.__hook
-0001d2e0: 5f64 625f 636c 6f73 6564 290a 2020 2020  _db_closed).    
-0001d2f0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-0001d300: 7328 636f 6e2c 2073 656c 662e 5f64 6229  s(con, self._db)
-0001d310: 0a20 2020 2064 6566 2074 6573 745f 686f  .    def test_ho
-0001d320: 6f6b 5f64 625f 6465 7461 6368 5f72 6571  ok_db_detach_req
-0001d330: 7565 7374 2873 656c 6629 3a0a 2020 2020  uest(self):.    
-0001d340: 2020 2020 2320 7265 6a65 6374 2064 6574      # reject det
-0001d350: 6163 680a 2020 2020 2020 2020 636f 6e20  ach.        con 
-0001d360: 3d20 636f 6e6e 6563 7428 7365 6c66 2e64  = connect(self.d
-0001d370: 6266 696c 652c 2075 7365 723d 4642 5445  bfile, user=FBTE
-0001d380: 5354 5f55 5345 522c 2070 6173 7377 6f72  ST_USER, passwor
-0001d390: 643d 4642 5445 5354 5f50 4153 5357 4f52  d=FBTEST_PASSWOR
-0001d3a0: 4429 0a20 2020 2020 2020 2063 6f6e 2e5f  D).        con._
-0001d3b0: 6c6f 6767 696e 675f 6964 5f20 3d20 7365  logging_id_ = se
-0001d3c0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-0001d3d0: 616d 655f 5f0a 2020 2020 2020 2020 6164  ame__.        ad
-0001d3e0: 645f 686f 6f6b 2843 6f6e 6e65 6374 696f  d_hook(Connectio
-0001d3f0: 6e48 6f6f 6b2e 4445 5441 4348 5f52 4551  nHook.DETACH_REQ
-0001d400: 5545 5354 2c20 636f 6e2c 2073 656c 662e  UEST, con, self.
-0001d410: 5f5f 686f 6f6b 5f64 625f 6465 7461 6368  __hook_db_detach
-0001d420: 5f72 6571 7565 7374 5f61 290a 2020 2020  _request_a).    
-0001d430: 2020 2020 636f 6e2e 636c 6f73 6528 290a      con.close().
-0001d440: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001d450: 6572 7449 7328 636f 6e2c 2073 656c 662e  ertIs(con, self.
-0001d460: 5f64 6229 0a20 2020 2020 2020 2073 656c  _db).        sel
-0001d470: 662e 6173 7365 7274 4661 6c73 6528 636f  f.assertFalse(co
-0001d480: 6e2e 6973 5f63 6c6f 7365 6428 2929 0a20  n.is_closed()). 
-0001d490: 2020 2020 2020 2068 6f6f 6b5f 6d61 6e61         hook_mana
-0001d4a0: 6765 722e 7265 6d6f 7665 5f68 6f6f 6b28  ger.remove_hook(
-0001d4b0: 436f 6e6e 6563 7469 6f6e 486f 6f6b 2e44  ConnectionHook.D
-0001d4c0: 4554 4143 485f 5245 5155 4553 542c 2063  ETACH_REQUEST, c
-0001d4d0: 6f6e 2c20 7365 6c66 2e5f 5f68 6f6f 6b5f  on, self.__hook_
-0001d4e0: 6462 5f64 6574 6163 685f 7265 7175 6573  db_detach_reques
-0001d4f0: 745f 6129 0a20 2020 2020 2020 2023 2061  t_a).        # a
-0001d500: 6363 6570 7420 636c 6f73 650a 2020 2020  ccept close.    
-0001d510: 2020 2020 7365 6c66 2e5f 6462 203d 204e      self._db = N
-0001d520: 6f6e 650a 2020 2020 2020 2020 6164 645f  one.        add_
-0001d530: 686f 6f6b 2843 6f6e 6e65 6374 696f 6e48  hook(ConnectionH
-0001d540: 6f6f 6b2e 4445 5441 4348 5f52 4551 5545  ook.DETACH_REQUE
-0001d550: 5354 2c20 636f 6e2c 2073 656c 662e 5f5f  ST, con, self.__
-0001d560: 686f 6f6b 5f64 625f 6465 7461 6368 5f72  hook_db_detach_r
-0001d570: 6571 7565 7374 5f62 290a 2020 2020 2020  equest_b).      
-0001d580: 2020 636f 6e2e 636c 6f73 6528 290a 2020    con.close().  
-0001d590: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0001d5a0: 7449 7328 636f 6e2c 2073 656c 662e 5f64  tIs(con, self._d
-0001d5b0: 6229 0a20 2020 2020 2020 2073 656c 662e  b).        self.
-0001d5c0: 6173 7365 7274 5472 7565 2863 6f6e 2e69  assertTrue(con.i
-0001d5d0: 735f 636c 6f73 6564 2829 290a 2020 2020  s_closed()).    
-0001d5e0: 6465 6620 7465 7374 5f68 6f6f 6b5f 7365  def test_hook_se
-0001d5f0: 7276 6963 655f 6174 7461 6368 6564 2873  rvice_attached(s
-0001d600: 656c 6629 3a0a 2020 2020 2020 2020 6164  elf):.        ad
-0001d610: 645f 686f 6f6b 2853 6572 7665 7248 6f6f  d_hook(ServerHoo
-0001d620: 6b2e 4154 5441 4348 4544 2c20 6472 6976  k.ATTACHED, driv
-0001d630: 6572 2e53 6572 7665 722c 2073 656c 662e  er.Server, self.
-0001d640: 5f5f 686f 6f6b 5f73 6572 7669 6365 5f61  __hook_service_a
-0001d650: 7474 6163 6865 6429 0a20 2020 2020 2020  ttached).       
-0001d660: 2077 6974 6820 636f 6e6e 6563 745f 7365   with connect_se
-0001d670: 7276 6572 2846 4254 4553 545f 484f 5354  rver(FBTEST_HOST
-0001d680: 2c20 7573 6572 3d46 4254 4553 545f 5553  , user=FBTEST_US
-0001d690: 4552 2c20 7061 7373 776f 7264 3d46 4254  ER, password=FBT
-0001d6a0: 4553 545f 5041 5353 574f 5244 2920 6173  EST_PASSWORD) as
-0001d6b0: 2073 7663 3a0a 2020 2020 2020 2020 2020   svc:.          
-0001d6c0: 2020 7365 6c66 2e61 7373 6572 7449 7328    self.assertIs(
-0001d6d0: 7376 632c 2073 656c 662e 5f73 7663 290a  svc, self._svc).
-0001d6e0: 0a0a 636c 6173 7320 5465 7374 4642 3428  ..class TestFB4(
-0001d6f0: 4472 6976 6572 5465 7374 4261 7365 293a  DriverTestBase):
-0001d700: 0a20 2020 2064 6566 2073 6574 5570 2873  .    def setUp(s
-0001d710: 656c 6629 3a0a 2020 2020 2020 2020 7375  elf):.        su
-0001d720: 7065 7228 292e 7365 7455 7028 290a 2020  per().setUp().  
-0001d730: 2020 2020 2020 7365 6c66 2e64 6266 696c        self.dbfil
-0001d740: 6520 3d20 6f73 2e70 6174 682e 6a6f 696e  e = os.path.join
-0001d750: 2873 656c 662e 6462 7061 7468 2c20 7365  (self.dbpath, se
-0001d760: 6c66 2e46 4254 4553 545f 4442 290a 2020  lf.FBTEST_DB).  
-0001d770: 2020 2020 2020 7365 6c66 2e63 6f6e 203d        self.con =
-0001d780: 2063 6f6e 6e65 6374 2873 656c 662e 6462   connect(self.db
-0001d790: 6669 6c65 2c20 7573 6572 3d46 4254 4553  file, user=FBTES
-0001d7a0: 545f 5553 4552 2c20 7061 7373 776f 7264  T_USER, password
-0001d7b0: 3d46 4254 4553 545f 5041 5353 574f 5244  =FBTEST_PASSWORD
-0001d7c0: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
-0001d7d0: 6f6e 2e5f 6c6f 6767 696e 675f 6964 5f20  on._logging_id_ 
-0001d7e0: 3d20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  = self.__class__
-0001d7f0: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
-0001d800: 2020 230a 2020 2020 2020 2020 6966 2073    #.        if s
-0001d810: 656c 662e 636f 6e2e 696e 666f 2e65 6e67  elf.con.info.eng
-0001d820: 696e 655f 7665 7273 696f 6e20 3c20 342e  ine_version < 4.
-0001d830: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
-0001d840: 656c 662e 736b 6970 5465 7374 2827 5265  elf.skipTest('Re
-0001d850: 7175 6972 6573 2046 6972 6562 6972 6420  quires Firebird 
-0001d860: 342e 302b 2729 0a20 2020 2020 2020 2023  4.0+').        #
-0001d870: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-0001d880: 6e32 203d 2063 6f6e 6e65 6374 2873 656c  n2 = connect(sel
-0001d890: 662e 6462 6669 6c65 2c20 7573 6572 3d46  f.dbfile, user=F
-0001d8a0: 4254 4553 545f 5553 4552 2c20 7061 7373  BTEST_USER, pass
-0001d8b0: 776f 7264 3d46 4254 4553 545f 5041 5353  word=FBTEST_PASS
-0001d8c0: 574f 5244 2c20 6368 6172 7365 743d 2775  WORD, charset='u
-0001d8d0: 7466 2d38 2729 0a20 2020 2020 2020 2073  tf-8').        s
-0001d8e0: 656c 662e 636f 6e32 2e5f 6c6f 6767 696e  elf.con2._loggin
-0001d8f0: 675f 6964 5f20 3d20 7365 6c66 2e5f 5f63  g_id_ = self.__c
-0001d900: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f0a  lass__.__name__.
-0001d910: 2020 2020 2020 2020 2373 656c 662e 636f          #self.co
-0001d920: 6e2e 6578 6563 7574 655f 696d 6d65 6469  n.execute_immedi
-0001d930: 6174 6528 2243 5245 4154 4520 5441 424c  ate("CREATE TABL
-0001d940: 4520 4642 3420 2850 4b20 696e 7465 6765  E FB4 (PK intege
-0001d950: 722c 545f 545a 2054 494d 4520 5749 5448  r,T_TZ TIME WITH
-0001d960: 2054 494d 4520 5a4f 4e45 2c54 535f 545a   TIME ZONE,TS_TZ
-0001d970: 2074 696d 6573 7461 6d70 2077 6974 6820   timestamp with 
-0001d980: 7469 6d65 207a 6f6e 652c 5420 7469 6d65  time zone,T time
-0001d990: 2c54 5320 7469 6d65 7374 616d 702c 4446  ,TS timestamp,DF
-0001d9a0: 2064 6563 666c 6f61 742c 4446 3136 2064   decfloat,DF16 d
-0001d9b0: 6563 666c 6f61 7428 3136 292c 4446 3334  ecfloat(16),DF34
-0001d9c0: 2064 6563 666c 6f61 7428 3334 292c 4e31   decfloat(34),N1
-0001d9d0: 3238 206e 756d 6572 6963 2833 342c 3629  28 numeric(34,6)
-0001d9e0: 2c44 3132 3820 6465 6369 6d61 6c28 3334  ,D128 decimal(34
-0001d9f0: 2c36 2929 2229 0a20 2020 2020 2020 2023  ,6))").        #
-0001da00: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
-0001da10: 5f69 6d6d 6564 6961 7465 2822 6465 6c65  _immediate("dele
-0001da20: 7465 2066 726f 6d20 5422 290a 2020 2020  te from T").    
-0001da30: 2020 2020 7365 6c66 2e63 6f6e 2e65 7865      self.con.exe
-0001da40: 6375 7465 5f69 6d6d 6564 6961 7465 2822  cute_immediate("
-0001da50: 6465 6c65 7465 2066 726f 6d20 4642 3422  delete from FB4"
-0001da60: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
-0001da70: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
-0001da80: 6465 6620 7465 6172 446f 776e 2873 656c  def tearDown(sel
-0001da90: 6629 3a0a 2020 2020 2020 2020 7365 6c66  f):.        self
-0001daa0: 2e63 6f6e 322e 636c 6f73 6528 290a 2020  .con2.close().  
-0001dab0: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
-0001dac0: 6c6f 7365 2829 0a20 2020 2064 6566 2074  lose().    def t
-0001dad0: 6573 745f 3031 5f73 656c 6563 745f 7769  est_01_select_wi
-0001dae0: 7468 5f74 696d 657a 6f6e 655f 7265 6769  th_timezone_regi
-0001daf0: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
-0001db00: 2020 6461 7461 203d 207b 313a 2028 3230    data = {1: (20
-0001db10: 3230 2c20 312c 2033 312c 2031 312c 2035  20, 1, 31, 11, 5
-0001db20: 352c 2033 352c 2031 3233 3430 302c 2027  5, 35, 123400, '
-0001db30: 4575 726f 7065 2f50 7261 6775 6527 292c  Europe/Prague'),
-0001db40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001db50: 2032 3a20 2832 3032 302c 2036 2c20 312c   2: (2020, 6, 1,
-0001db60: 2031 2c20 3535 2c20 3335 2c20 3132 3334   1, 55, 35, 1234
-0001db70: 3030 2c20 2745 7572 6f70 652f 5072 6167  00, 'Europe/Prag
-0001db80: 7565 2729 2c0a 2020 2020 2020 2020 2020  ue'),.          
-0001db90: 2020 2020 2020 333a 2028 3230 3230 2c20        3: (2020, 
-0001dba0: 3132 2c20 3331 2c20 3233 2c20 3535 2c20  12, 31, 23, 55, 
-0001dbb0: 3335 2c20 3132 3334 3030 2c20 2745 7572  35, 123400, 'Eur
-0001dbc0: 6f70 652f 5072 6167 7565 2729 2c7d 0a20  ope/Prague'),}. 
-0001dbd0: 2020 2020 2020 2077 6974 6820 7365 6c66         with self
-0001dbe0: 2e63 6f6e 2e63 7572 736f 7228 2920 6173  .con.cursor() as
-0001dbf0: 2063 7572 3a0a 2020 2020 2020 2020 2020   cur:.          
-0001dc00: 2020 6375 722e 6578 6563 7574 6528 2269    cur.execute("i
-0001dc10: 6e73 6572 7420 696e 746f 2046 4234 2028  nsert into FB4 (
-0001dc20: 504b 2c54 5f54 5a2c 5453 5f54 5a29 2076  PK,T_TZ,TS_TZ) v
-0001dc30: 616c 7565 7320 2831 2c20 2731 313a 3535  alues (1, '11:55
-0001dc40: 3a33 352e 3132 3334 2045 7572 6f70 652f  :35.1234 Europe/
-0001dc50: 5072 6167 7565 272c 2027 3230 3230 2d30  Prague', '2020-0
-0001dc60: 312d 3331 2031 313a 3535 3a33 352e 3132  1-31 11:55:35.12
-0001dc70: 3334 2045 7572 6f70 652f 5072 6167 7565  34 Europe/Prague
-0001dc80: 2729 2229 0a20 2020 2020 2020 2020 2020  ')").           
-0001dc90: 2063 7572 2e65 7865 6375 7465 2822 696e   cur.execute("in
-0001dca0: 7365 7274 2069 6e74 6f20 4642 3420 2850  sert into FB4 (P
-0001dcb0: 4b2c 545f 545a 2c54 535f 545a 2920 7661  K,T_TZ,TS_TZ) va
-0001dcc0: 6c75 6573 2028 322c 2027 3031 3a35 353a  lues (2, '01:55:
-0001dcd0: 3335 2e31 3233 3420 4575 726f 7065 2f50  35.1234 Europe/P
-0001dce0: 7261 6775 6527 2c20 2732 3032 302d 3036  rague', '2020-06
-0001dcf0: 2d30 3120 3031 3a35 353a 3335 2e31 3233  -01 01:55:35.123
-0001dd00: 3420 4575 726f 7065 2f50 7261 6775 6527  4 Europe/Prague'
-0001dd10: 2922 290a 2020 2020 2020 2020 2020 2020  )").            
-0001dd20: 6375 722e 6578 6563 7574 6528 2269 6e73  cur.execute("ins
-0001dd30: 6572 7420 696e 746f 2046 4234 2028 504b  ert into FB4 (PK
-0001dd40: 2c54 5f54 5a2c 5453 5f54 5a29 2076 616c  ,T_TZ,TS_TZ) val
-0001dd50: 7565 7320 2833 2c20 2732 333a 3535 3a33  ues (3, '23:55:3
-0001dd60: 352e 3132 3334 2045 7572 6f70 652f 5072  5.1234 Europe/Pr
-0001dd70: 6167 7565 272c 2027 3230 3230 2d31 322d  ague', '2020-12-
-0001dd80: 3331 2032 333a 3535 3a33 352e 3132 3334  31 23:55:35.1234
-0001dd90: 2045 7572 6f70 652f 5072 6167 7565 2729   Europe/Prague')
-0001dda0: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
-0001ddb0: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
-0001ddc0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0001ddd0: 2e65 7865 6375 7465 2827 7365 6c65 6374  .execute('select
-0001dde0: 2050 4b2c 545f 545a 2c54 535f 545a 2066   PK,T_TZ,TS_TZ f
-0001ddf0: 726f 6d20 4642 3420 7768 6572 6520 504b  rom FB4 where PK
-0001de00: 2062 6574 7765 656e 2031 2061 6e64 2033   between 1 and 3
-0001de10: 206f 7264 6572 2062 7920 504b 2729 0a20   order by PK'). 
-0001de20: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-0001de30: 6b2c 2074 5f74 7a2c 2074 735f 747a 2069  k, t_tz, ts_tz i
-0001de40: 6e20 6375 723a 0a20 2020 2020 2020 2020  n cur:.         
-0001de50: 2020 2020 2020 2064 203d 2064 6174 615b         d = data[
-0001de60: 706b 5d0a 2020 2020 2020 2020 2020 2020  pk].            
-0001de70: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-0001de80: 7349 6e73 7461 6e63 6528 745f 747a 2c20  sInstance(t_tz, 
-0001de90: 6461 7465 7469 6d65 2e74 696d 6529 0a20  datetime.time). 
-0001dea0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001deb0: 656c 662e 6173 7365 7274 4973 4e6f 744e  elf.assertIsNotN
-0001dec0: 6f6e 6528 745f 747a 2e74 7a69 6e66 6f29  one(t_tz.tzinfo)
-0001ded0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001dee0: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
-0001def0: 744e 6f6e 6528 6765 7461 7474 7228 745f  tNone(getattr(t_
-0001df00: 747a 2e74 7a69 6e66 6f2c 2027 5f74 696d  tz.tzinfo, '_tim
-0001df10: 657a 6f6e 655f 2729 290a 2020 2020 2020  ezone_')).      
-0001df20: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001df30: 7373 6572 7445 7175 616c 2874 5f74 7a2e  ssertEqual(t_tz.
-0001df40: 686f 7572 2c20 645b 335d 290a 2020 2020  hour, d[3]).    
-0001df50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001df60: 2e61 7373 6572 7445 7175 616c 2874 5f74  .assertEqual(t_t
-0001df70: 7a2e 6d69 6e75 7465 2c20 645b 345d 290a  z.minute, d[4]).
-0001df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df90: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0001dfa0: 2874 5f74 7a2e 7365 636f 6e64 2c20 645b  (t_tz.second, d[
-0001dfb0: 355d 290a 2020 2020 2020 2020 2020 2020  5]).            
-0001dfc0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001dfd0: 7175 616c 2874 5f74 7a2e 6d69 6372 6f73  qual(t_tz.micros
-0001dfe0: 6563 6f6e 642c 2064 5b36 5d29 0a20 2020  econd, d[6]).   
-0001dff0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001e000: 662e 6173 7365 7274 4571 7561 6c28 745f  f.assertEqual(t_
-0001e010: 747a 2e74 7a69 6e66 6f2e 5f74 696d 657a  tz.tzinfo._timez
-0001e020: 6f6e 655f 2c20 645b 375d 290a 2020 2020  one_, d[7]).    
-0001e030: 2020 2020 2020 2020 2020 2020 230a 2020              #.  
-0001e040: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001e050: 6c66 2e61 7373 6572 7449 7349 6e73 7461  lf.assertIsInsta
-0001e060: 6e63 6528 7473 5f74 7a2c 2064 6174 6574  nce(ts_tz, datet
-0001e070: 696d 652e 6461 7465 7469 6d65 290a 2020  ime.datetime).  
-0001e080: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001e090: 6c66 2e61 7373 6572 7449 734e 6f74 4e6f  lf.assertIsNotNo
-0001e0a0: 6e65 2874 735f 747a 2e74 7a69 6e66 6f29  ne(ts_tz.tzinfo)
-0001e0b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e0c0: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
-0001e0d0: 744e 6f6e 6528 6765 7461 7474 7228 7473  tNone(getattr(ts
-0001e0e0: 5f74 7a2e 747a 696e 666f 2c20 275f 7469  _tz.tzinfo, '_ti
-0001e0f0: 6d65 7a6f 6e65 5f27 2929 0a20 2020 2020  mezone_')).     
-0001e100: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001e110: 6173 7365 7274 4571 7561 6c28 7473 5f74  assertEqual(ts_t
-0001e120: 7a2e 7965 6172 2c20 645b 305d 290a 2020  z.year, d[0]).  
-0001e130: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001e140: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
-0001e150: 735f 747a 2e6d 6f6e 7468 2c20 645b 315d  s_tz.month, d[1]
-0001e160: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001e170: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0001e180: 616c 2874 735f 747a 2e64 6179 2c20 645b  al(ts_tz.day, d[
-0001e190: 325d 290a 2020 2020 2020 2020 2020 2020  2]).            
-0001e1a0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001e1b0: 7175 616c 2874 735f 747a 2e68 6f75 722c  qual(ts_tz.hour,
-0001e1c0: 2064 5b33 5d29 0a20 2020 2020 2020 2020   d[3]).         
-0001e1d0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001e1e0: 7274 4571 7561 6c28 7473 5f74 7a2e 6d69  rtEqual(ts_tz.mi
-0001e1f0: 6e75 7465 2c20 645b 345d 290a 2020 2020  nute, d[4]).    
-0001e200: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001e210: 2e61 7373 6572 7445 7175 616c 2874 735f  .assertEqual(ts_
-0001e220: 747a 2e73 6563 6f6e 642c 2064 5b35 5d29  tz.second, d[5])
-0001e230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e240: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0001e250: 6c28 7473 5f74 7a2e 6d69 6372 6f73 6563  l(ts_tz.microsec
-0001e260: 6f6e 642c 2064 5b36 5d29 0a20 2020 2020  ond, d[6]).     
-0001e270: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001e280: 6173 7365 7274 4571 7561 6c28 7473 5f74  assertEqual(ts_t
-0001e290: 7a2e 747a 696e 666f 2e5f 7469 6d65 7a6f  z.tzinfo._timezo
-0001e2a0: 6e65 5f2c 2064 5b37 5d29 0a20 2020 2064  ne_, d[7]).    d
-0001e2b0: 6566 2074 6573 745f 3032 5f73 656c 6563  ef test_02_selec
-0001e2c0: 745f 7769 7468 5f74 696d 657a 6f6e 655f  t_with_timezone_
-0001e2d0: 6f66 6673 6574 2873 656c 6629 3a0a 2020  offset(self):.  
-0001e2e0: 2020 2020 2020 6461 7461 203d 207b 313a        data = {1:
-0001e2f0: 2028 3230 3230 2c20 312c 2033 312c 2031   (2020, 1, 31, 1
-0001e300: 312c 2035 352c 2033 352c 2031 3233 3430  1, 55, 35, 12340
-0001e310: 302c 2027 2b30 313a 3030 2729 2c0a 2020  0, '+01:00'),.  
-0001e320: 2020 2020 2020 2020 2020 2020 2020 323a                2:
-0001e330: 2028 3230 3230 2c20 362c 2031 2c20 312c   (2020, 6, 1, 1,
-0001e340: 2035 352c 2033 352c 2031 3233 3430 302c   55, 35, 123400,
-0001e350: 2027 2b30 323a 3030 2729 2c0a 2020 2020   '+02:00'),.    
-0001e360: 2020 2020 2020 2020 2020 2020 333a 2028              3: (
-0001e370: 3230 3230 2c20 3132 2c20 3331 2c20 3233  2020, 12, 31, 23
-0001e380: 2c20 3535 2c20 3335 2c20 3132 3334 3030  , 55, 35, 123400
-0001e390: 2c20 272b 3031 3a30 3027 292c 7d0a 2020  , '+01:00'),}.  
-0001e3a0: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
-0001e3b0: 636f 6e2e 6375 7273 6f72 2829 2061 7320  con.cursor() as 
-0001e3c0: 6375 723a 0a20 2020 2020 2020 2020 2020  cur:.           
-0001e3d0: 2063 7572 2e65 7865 6375 7465 2822 696e   cur.execute("in
-0001e3e0: 7365 7274 2069 6e74 6f20 4642 3420 2850  sert into FB4 (P
-0001e3f0: 4b2c 545f 545a 2c54 535f 545a 2920 7661  K,T_TZ,TS_TZ) va
-0001e400: 6c75 6573 2028 312c 2027 3131 3a35 353a  lues (1, '11:55:
-0001e410: 3335 2e31 3233 3420 2b30 313a 3030 272c  35.1234 +01:00',
-0001e420: 2027 3230 3230 2d30 312d 3331 2031 313a   '2020-01-31 11:
-0001e430: 3535 3a33 352e 3132 3334 202b 3031 3a30  55:35.1234 +01:0
-0001e440: 3027 2922 290a 2020 2020 2020 2020 2020  0')").          
-0001e450: 2020 6375 722e 6578 6563 7574 6528 2269    cur.execute("i
-0001e460: 6e73 6572 7420 696e 746f 2046 4234 2028  nsert into FB4 (
-0001e470: 504b 2c54 5f54 5a2c 5453 5f54 5a29 2076  PK,T_TZ,TS_TZ) v
-0001e480: 616c 7565 7320 2832 2c20 2730 313a 3535  alues (2, '01:55
-0001e490: 3a33 352e 3132 3334 202b 3032 3a30 3027  :35.1234 +02:00'
-0001e4a0: 2c20 2732 3032 302d 3036 2d30 3120 3031  , '2020-06-01 01
-0001e4b0: 3a35 353a 3335 2e31 3233 3420 2b30 323a  :55:35.1234 +02:
-0001e4c0: 3030 2729 2229 0a20 2020 2020 2020 2020  00')").         
-0001e4d0: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
-0001e4e0: 696e 7365 7274 2069 6e74 6f20 4642 3420  insert into FB4 
-0001e4f0: 2850 4b2c 545f 545a 2c54 535f 545a 2920  (PK,T_TZ,TS_TZ) 
-0001e500: 7661 6c75 6573 2028 332c 2027 3233 3a35  values (3, '23:5
-0001e510: 353a 3335 2e31 3233 3420 2b30 313a 3030  5:35.1234 +01:00
-0001e520: 272c 2027 3230 3230 2d31 322d 3331 2032  ', '2020-12-31 2
-0001e530: 333a 3535 3a33 352e 3132 3334 202b 3031  3:55:35.1234 +01
-0001e540: 3a30 3027 2922 290a 2020 2020 2020 2020  :00')").        
-0001e550: 2020 2020 7365 6c66 2e63 6f6e 2e63 6f6d      self.con.com
-0001e560: 6d69 7428 290a 2020 2020 2020 2020 2020  mit().          
-0001e570: 2020 6375 722e 6578 6563 7574 6528 2773    cur.execute('s
-0001e580: 656c 6563 7420 504b 2c54 5f54 5a2c 5453  elect PK,T_TZ,TS
-0001e590: 5f54 5a20 6672 6f6d 2046 4234 2077 6865  _TZ from FB4 whe
-0001e5a0: 7265 2050 4b20 6265 7477 6565 6e20 3120  re PK between 1 
-0001e5b0: 616e 6420 3320 6f72 6465 7220 6279 2050  and 3 order by P
-0001e5c0: 4b27 290a 2020 2020 2020 2020 2020 2020  K').            
-0001e5d0: 666f 7220 706b 2c20 745f 747a 2c20 7473  for pk, t_tz, ts
-0001e5e0: 5f74 7a20 696e 2063 7572 3a0a 2020 2020  _tz in cur:.    
-0001e5f0: 2020 2020 2020 2020 2020 2020 6420 3d20              d = 
-0001e600: 6461 7461 5b70 6b5d 0a20 2020 2020 2020  data[pk].       
-0001e610: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001e620: 7365 7274 4973 496e 7374 616e 6365 2874  sertIsInstance(t
-0001e630: 5f74 7a2c 2064 6174 6574 696d 652e 7469  _tz, datetime.ti
-0001e640: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
-0001e650: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-0001e660: 734e 6f74 4e6f 6e65 2874 5f74 7a2e 747a  sNotNone(t_tz.tz
-0001e670: 696e 666f 290a 2020 2020 2020 2020 2020  info).          
-0001e680: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0001e690: 7449 734e 6f74 4e6f 6e65 2867 6574 6174  tIsNotNone(getat
-0001e6a0: 7472 2874 5f74 7a2e 747a 696e 666f 2c20  tr(t_tz.tzinfo, 
-0001e6b0: 275f 7469 6d65 7a6f 6e65 5f27 2c20 4e6f  '_timezone_', No
-0001e6c0: 6e65 2929 0a20 2020 2020 2020 2020 2020  ne)).           
-0001e6d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001e6e0: 4571 7561 6c28 745f 747a 2e68 6f75 722c  Equal(t_tz.hour,
-0001e6f0: 2064 5b33 5d29 0a20 2020 2020 2020 2020   d[3]).         
-0001e700: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001e710: 7274 4571 7561 6c28 745f 747a 2e6d 696e  rtEqual(t_tz.min
-0001e720: 7574 652c 2064 5b34 5d29 0a20 2020 2020  ute, d[4]).     
-0001e730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001e740: 6173 7365 7274 4571 7561 6c28 745f 747a  assertEqual(t_tz
-0001e750: 2e73 6563 6f6e 642c 2064 5b35 5d29 0a20  .second, d[5]). 
-0001e760: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001e770: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0001e780: 745f 747a 2e6d 6963 726f 7365 636f 6e64  t_tz.microsecond
-0001e790: 2c20 645b 365d 290a 2020 2020 2020 2020  , d[6]).        
-0001e7a0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001e7b0: 6572 7445 7175 616c 2874 5f74 7a2e 747a  ertEqual(t_tz.tz
-0001e7c0: 696e 666f 2e5f 7469 6d65 7a6f 6e65 5f2c  info._timezone_,
-0001e7d0: 2064 5b37 5d29 0a20 2020 2020 2020 2020   d[7]).         
-0001e7e0: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
-0001e7f0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001e800: 7365 7274 4973 496e 7374 616e 6365 2874  sertIsInstance(t
-0001e810: 735f 747a 2c20 6461 7465 7469 6d65 2e64  s_tz, datetime.d
-0001e820: 6174 6574 696d 6529 0a20 2020 2020 2020  atetime).       
-0001e830: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001e840: 7365 7274 4973 4e6f 744e 6f6e 6528 7473  sertIsNotNone(ts
-0001e850: 5f74 7a2e 747a 696e 666f 290a 2020 2020  _tz.tzinfo).    
-0001e860: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001e870: 2e61 7373 6572 7449 734e 6f74 4e6f 6e65  .assertIsNotNone
-0001e880: 2867 6574 6174 7472 2874 735f 747a 2e74  (getattr(ts_tz.t
-0001e890: 7a69 6e66 6f2c 2027 5f74 696d 657a 6f6e  zinfo, '_timezon
-0001e8a0: 655f 272c 204e 6f6e 6529 290a 2020 2020  e_', None)).    
-0001e8b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001e8c0: 2e61 7373 6572 7445 7175 616c 2874 735f  .assertEqual(ts_
-0001e8d0: 747a 2e79 6561 722c 2064 5b30 5d29 0a20  tz.year, d[0]). 
-0001e8e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001e8f0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0001e900: 7473 5f74 7a2e 6d6f 6e74 682c 2064 5b31  ts_tz.month, d[1
-0001e910: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-0001e920: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-0001e930: 7561 6c28 7473 5f74 7a2e 6461 792c 2064  ual(ts_tz.day, d
-0001e940: 5b32 5d29 0a20 2020 2020 2020 2020 2020  [2]).           
-0001e950: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001e960: 4571 7561 6c28 7473 5f74 7a2e 686f 7572  Equal(ts_tz.hour
-0001e970: 2c20 645b 335d 290a 2020 2020 2020 2020  , d[3]).        
-0001e980: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001e990: 6572 7445 7175 616c 2874 735f 747a 2e6d  ertEqual(ts_tz.m
-0001e9a0: 696e 7574 652c 2064 5b34 5d29 0a20 2020  inute, d[4]).   
-0001e9b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001e9c0: 662e 6173 7365 7274 4571 7561 6c28 7473  f.assertEqual(ts
-0001e9d0: 5f74 7a2e 7365 636f 6e64 2c20 645b 355d  _tz.second, d[5]
-0001e9e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001e9f0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0001ea00: 616c 2874 735f 747a 2e6d 6963 726f 7365  al(ts_tz.microse
-0001ea10: 636f 6e64 2c20 645b 365d 290a 2020 2020  cond, d[6]).    
-0001ea20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001ea30: 2e61 7373 6572 7445 7175 616c 2874 735f  .assertEqual(ts_
-0001ea40: 747a 2e74 7a69 6e66 6f2e 5f74 696d 657a  tz.tzinfo._timez
-0001ea50: 6f6e 655f 2c20 645b 375d 290a 2020 2020  one_, d[7]).    
-0001ea60: 6465 6620 7465 7374 5f30 335f 696e 7365  def test_03_inse
-0001ea70: 7274 5f77 6974 685f 7469 6d65 7a6f 6e65  rt_with_timezone
-0001ea80: 5f72 6567 696f 6e28 7365 6c66 293a 0a20  _region(self):. 
-0001ea90: 2020 2020 2020 2064 6174 6120 3d20 7b31         data = {1
-0001eaa0: 3a20 2832 3032 302c 2031 2c20 3331 2c20  : (2020, 1, 31, 
-0001eab0: 3131 2c20 3535 2c20 3335 2c20 3132 3334  11, 55, 35, 1234
-0001eac0: 3030 2c20 2745 7572 6f70 652f 5072 6167  00, 'Europe/Prag
-0001ead0: 7565 2729 2c0a 2020 2020 2020 2020 2020  ue'),.          
-0001eae0: 2020 2020 2020 323a 2028 3230 3230 2c20        2: (2020, 
-0001eaf0: 362c 2031 2c20 312c 2035 352c 2033 352c  6, 1, 1, 55, 35,
-0001eb00: 2031 3233 3430 302c 2027 4575 726f 7065   123400, 'Europe
-0001eb10: 2f50 7261 6775 6527 292c 0a20 2020 2020  /Prague'),.     
-0001eb20: 2020 2020 2020 2020 2020 2033 3a20 2832             3: (2
-0001eb30: 3032 302c 2031 322c 2033 312c 2032 332c  020, 12, 31, 23,
-0001eb40: 2035 352c 2033 352c 2031 3233 3430 302c   55, 35, 123400,
-0001eb50: 2027 4575 726f 7065 2f50 7261 6775 6527   'Europe/Prague'
-0001eb60: 292c 7d0a 2020 2020 2020 2020 7769 7468  ),}.        with
-0001eb70: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
-0001eb80: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
-0001eb90: 2020 2020 2020 2066 6f72 2070 6b2c 2064         for pk, d
-0001eba0: 2069 6e20 6461 7461 2e69 7465 6d73 2829   in data.items()
-0001ebb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ebc0: 2020 7a6f 6e65 203d 2067 6574 5f74 696d    zone = get_tim
-0001ebd0: 657a 6f6e 6528 645b 375d 290a 2020 2020  ezone(d[7]).    
-0001ebe0: 2020 2020 2020 2020 2020 2020 7473 203d              ts =
-0001ebf0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-0001ec00: 6d65 2864 5b30 5d2c 2064 5b31 5d2c 2064  me(d[0], d[1], d
-0001ec10: 5b32 5d2c 2064 5b33 5d2c 2064 5b34 5d2c  [2], d[3], d[4],
-0001ec20: 2064 5b35 5d2c 2064 5b36 5d2c 207a 6f6e   d[5], d[6], zon
-0001ec30: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0001ec40: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
-0001ec50: 696e 7365 7274 2069 6e74 6f20 4642 3420  insert into FB4 
-0001ec60: 2850 4b2c 545f 545a 2c54 535f 545a 2920  (PK,T_TZ,TS_TZ) 
-0001ec70: 7661 6c75 6573 2028 3f2c 203f 2c20 3f29  values (?, ?, ?)
-0001ec80: 222c 2028 706b 2c20 7473 2e74 696d 6574  ", (pk, ts.timet
-0001ec90: 7a28 292c 2074 7329 290a 2020 2020 2020  z(), ts)).      
-0001eca0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0001ecb0: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
-0001ecc0: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-0001ecd0: 7574 6528 2773 656c 6563 7420 504b 2c54  ute('select PK,T
-0001ece0: 5f54 5a2c 5453 5f54 5a20 6672 6f6d 2046  _TZ,TS_TZ from F
-0001ecf0: 4234 2077 6865 7265 2050 4b20 6265 7477  B4 where PK betw
-0001ed00: 6565 6e20 3120 616e 6420 3320 6f72 6465  een 1 and 3 orde
-0001ed10: 7220 6279 2050 4b27 290a 2020 2020 2020  r by PK').      
-0001ed20: 2020 2020 2020 666f 7220 706b 2c20 745f        for pk, t_
-0001ed30: 747a 2c20 7473 5f74 7a20 696e 2063 7572  tz, ts_tz in cur
-0001ed40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ed50: 2020 6420 3d20 6461 7461 5b70 6b5d 0a20    d = data[pk]. 
-0001ed60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001ed70: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
-0001ed80: 616e 6365 2874 5f74 7a2c 2064 6174 6574  ance(t_tz, datet
-0001ed90: 696d 652e 7469 6d65 290a 2020 2020 2020  ime.time).      
-0001eda0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001edb0: 7373 6572 7449 734e 6f74 4e6f 6e65 2874  ssertIsNotNone(t
-0001edc0: 5f74 7a2e 747a 696e 666f 290a 2020 2020  _tz.tzinfo).    
-0001edd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001ede0: 2e61 7373 6572 7449 734e 6f74 4e6f 6e65  .assertIsNotNone
-0001edf0: 2867 6574 6174 7472 2874 5f74 7a2e 747a  (getattr(t_tz.tz
-0001ee00: 696e 666f 2c20 275f 7469 6d65 7a6f 6e65  info, '_timezone
-0001ee10: 5f27 2929 0a20 2020 2020 2020 2020 2020  _')).           
-0001ee20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001ee30: 4571 7561 6c28 745f 747a 2e68 6f75 722c  Equal(t_tz.hour,
-0001ee40: 2064 5b33 5d29 0a20 2020 2020 2020 2020   d[3]).         
-0001ee50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001ee60: 7274 4571 7561 6c28 745f 747a 2e6d 696e  rtEqual(t_tz.min
-0001ee70: 7574 652c 2064 5b34 5d29 0a20 2020 2020  ute, d[4]).     
-0001ee80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001ee90: 6173 7365 7274 4571 7561 6c28 745f 747a  assertEqual(t_tz
-0001eea0: 2e73 6563 6f6e 642c 2064 5b35 5d29 0a20  .second, d[5]). 
-0001eeb0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001eec0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0001eed0: 745f 747a 2e6d 6963 726f 7365 636f 6e64  t_tz.microsecond
-0001eee0: 2c20 645b 365d 290a 2020 2020 2020 2020  , d[6]).        
-0001eef0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0001ef00: 6572 7445 7175 616c 2874 5f74 7a2e 747a  ertEqual(t_tz.tz
-0001ef10: 696e 666f 2e5f 7469 6d65 7a6f 6e65 5f2c  info._timezone_,
-0001ef20: 2064 5b37 5d29 0a20 2020 2020 2020 2020   d[7]).         
-0001ef30: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
-0001ef40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001ef50: 7365 7274 4973 496e 7374 616e 6365 2874  sertIsInstance(t
-0001ef60: 735f 747a 2c20 6461 7465 7469 6d65 2e64  s_tz, datetime.d
-0001ef70: 6174 6574 696d 6529 0a20 2020 2020 2020  atetime).       
-0001ef80: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001ef90: 7365 7274 4973 4e6f 744e 6f6e 6528 7473  sertIsNotNone(ts
-0001efa0: 5f74 7a2e 747a 696e 666f 290a 2020 2020  _tz.tzinfo).    
-0001efb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001efc0: 2e61 7373 6572 7449 734e 6f74 4e6f 6e65  .assertIsNotNone
-0001efd0: 2867 6574 6174 7472 2874 735f 747a 2e74  (getattr(ts_tz.t
-0001efe0: 7a69 6e66 6f2c 2027 5f74 696d 657a 6f6e  zinfo, '_timezon
-0001eff0: 655f 2729 290a 2020 2020 2020 2020 2020  e_')).          
-0001f000: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0001f010: 7445 7175 616c 2874 735f 747a 2e79 6561  tEqual(ts_tz.yea
-0001f020: 722c 2064 5b30 5d29 0a20 2020 2020 2020  r, d[0]).       
-0001f030: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001f040: 7365 7274 4571 7561 6c28 7473 5f74 7a2e  sertEqual(ts_tz.
-0001f050: 6d6f 6e74 682c 2064 5b31 5d29 0a20 2020  month, d[1]).   
-0001f060: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001f070: 662e 6173 7365 7274 4571 7561 6c28 7473  f.assertEqual(ts
-0001f080: 5f74 7a2e 6461 792c 2064 5b32 5d29 0a20  _tz.day, d[2]). 
-0001f090: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f0a0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0001f0b0: 7473 5f74 7a2e 686f 7572 2c20 645b 335d  ts_tz.hour, d[3]
-0001f0c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001f0d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0001f0e0: 616c 2874 735f 747a 2e6d 696e 7574 652c  al(ts_tz.minute,
-0001f0f0: 2064 5b34 5d29 0a20 2020 2020 2020 2020   d[4]).         
-0001f100: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001f110: 7274 4571 7561 6c28 7473 5f74 7a2e 7365  rtEqual(ts_tz.se
-0001f120: 636f 6e64 2c20 645b 355d 290a 2020 2020  cond, d[5]).    
-0001f130: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001f140: 2e61 7373 6572 7445 7175 616c 2874 735f  .assertEqual(ts_
-0001f150: 747a 2e6d 6963 726f 7365 636f 6e64 2c20  tz.microsecond, 
-0001f160: 645b 365d 290a 2020 2020 2020 2020 2020  d[6]).          
-0001f170: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0001f180: 7445 7175 616c 2874 735f 747a 2e74 7a69  tEqual(ts_tz.tzi
-0001f190: 6e66 6f2e 5f74 696d 657a 6f6e 655f 2c20  nfo._timezone_, 
-0001f1a0: 645b 375d 290a 2020 2020 6465 6620 7465  d[7]).    def te
-0001f1b0: 7374 5f30 345f 696e 7365 7274 5f77 6974  st_04_insert_wit
-0001f1c0: 685f 7469 6d65 7a6f 6e65 5f6f 6666 7365  h_timezone_offse
-0001f1d0: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-0001f1e0: 2064 6174 6120 3d20 7b31 3a20 2832 3032   data = {1: (202
-0001f1f0: 302c 2031 2c20 3331 2c20 3131 2c20 3535  0, 1, 31, 11, 55
-0001f200: 2c20 3335 2c20 3132 3334 3030 2c20 272b  , 35, 123400, '+
-0001f210: 3031 3a30 3027 292c 0a20 2020 2020 2020  01:00'),.       
-0001f220: 2020 2020 2020 2020 2032 3a20 2832 3032           2: (202
-0001f230: 302c 2036 2c20 312c 2031 2c20 3535 2c20  0, 6, 1, 1, 55, 
-0001f240: 3335 2c20 3132 3334 3030 2c20 272b 3032  35, 123400, '+02
-0001f250: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
-0001f260: 2020 2020 2020 2033 3a20 2832 3032 302c         3: (2020,
-0001f270: 2031 322c 2033 312c 2032 332c 2035 352c   12, 31, 23, 55,
-0001f280: 2033 352c 2031 3233 3430 302c 2027 2b30   35, 123400, '+0
-0001f290: 313a 3030 2729 2c7d 0a20 2020 2020 2020  1:00'),}.       
-0001f2a0: 2077 6974 6820 7365 6c66 2e63 6f6e 2e63   with self.con.c
-0001f2b0: 7572 736f 7228 2920 6173 2063 7572 3a0a  ursor() as cur:.
-0001f2c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001f2d0: 706b 2c20 6420 696e 2064 6174 612e 6974  pk, d in data.it
-0001f2e0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-0001f2f0: 2020 2020 2020 207a 6f6e 6520 3d20 6765         zone = ge
-0001f300: 745f 7469 6d65 7a6f 6e65 2864 5b37 5d29  t_timezone(d[7])
-0001f310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f320: 2074 7320 3d20 6461 7465 7469 6d65 2e64   ts = datetime.d
-0001f330: 6174 6574 696d 6528 645b 305d 2c20 645b  atetime(d[0], d[
-0001f340: 315d 2c20 645b 325d 2c20 645b 335d 2c20  1], d[2], d[3], 
-0001f350: 645b 345d 2c20 645b 355d 2c20 645b 365d  d[4], d[5], d[6]
-0001f360: 2c20 7a6f 6e65 290a 2020 2020 2020 2020  , zone).        
-0001f370: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
-0001f380: 7574 6528 2269 6e73 6572 7420 696e 746f  ute("insert into
-0001f390: 2046 4234 2028 504b 2c54 5f54 5a2c 5453   FB4 (PK,T_TZ,TS
-0001f3a0: 5f54 5a29 2076 616c 7565 7320 283f 2c20  _TZ) values (?, 
-0001f3b0: 3f2c 203f 2922 2c20 2870 6b2c 2074 732e  ?, ?)", (pk, ts.
-0001f3c0: 7469 6d65 747a 2829 2c20 7473 2929 0a20  timetz(), ts)). 
-0001f3d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f3e0: 656c 662e 636f 6e2e 636f 6d6d 6974 2829  elf.con.commit()
-0001f3f0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-0001f400: 2e65 7865 6375 7465 2827 7365 6c65 6374  .execute('select
-0001f410: 2050 4b2c 545f 545a 2c54 535f 545a 2066   PK,T_TZ,TS_TZ f
-0001f420: 726f 6d20 4642 3420 7768 6572 6520 504b  rom FB4 where PK
-0001f430: 2062 6574 7765 656e 2031 2061 6e64 2033   between 1 and 3
-0001f440: 206f 7264 6572 2062 7920 504b 2729 0a20   order by PK'). 
-0001f450: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-0001f460: 6b2c 2074 5f74 7a2c 2074 735f 747a 2069  k, t_tz, ts_tz i
-0001f470: 6e20 6375 723a 0a20 2020 2020 2020 2020  n cur:.         
-0001f480: 2020 2020 2020 2064 203d 2064 6174 615b         d = data[
-0001f490: 706b 5d0a 2020 2020 2020 2020 2020 2020  pk].            
-0001f4a0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-0001f4b0: 7349 6e73 7461 6e63 6528 745f 747a 2c20  sInstance(t_tz, 
-0001f4c0: 6461 7465 7469 6d65 2e74 696d 6529 0a20  datetime.time). 
-0001f4d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f4e0: 656c 662e 6173 7365 7274 4973 4e6f 744e  elf.assertIsNotN
-0001f4f0: 6f6e 6528 745f 747a 2e74 7a69 6e66 6f29  one(t_tz.tzinfo)
-0001f500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f510: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
-0001f520: 744e 6f6e 6528 6765 7461 7474 7228 745f  tNone(getattr(t_
-0001f530: 747a 2e74 7a69 6e66 6f2c 2027 5f74 696d  tz.tzinfo, '_tim
-0001f540: 657a 6f6e 655f 2729 290a 2020 2020 2020  ezone_')).      
-0001f550: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001f560: 7373 6572 7445 7175 616c 2874 5f74 7a2e  ssertEqual(t_tz.
-0001f570: 686f 7572 2c20 645b 335d 290a 2020 2020  hour, d[3]).    
-0001f580: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001f590: 2e61 7373 6572 7445 7175 616c 2874 5f74  .assertEqual(t_t
-0001f5a0: 7a2e 6d69 6e75 7465 2c20 645b 345d 290a  z.minute, d[4]).
-0001f5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f5c0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0001f5d0: 2874 5f74 7a2e 7365 636f 6e64 2c20 645b  (t_tz.second, d[
-0001f5e0: 355d 290a 2020 2020 2020 2020 2020 2020  5]).            
-0001f5f0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001f600: 7175 616c 2874 5f74 7a2e 6d69 6372 6f73  qual(t_tz.micros
-0001f610: 6563 6f6e 642c 2064 5b36 5d29 0a20 2020  econd, d[6]).   
-0001f620: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001f630: 662e 6173 7365 7274 4571 7561 6c28 745f  f.assertEqual(t_
-0001f640: 747a 2e74 7a69 6e66 6f2e 5f74 696d 657a  tz.tzinfo._timez
-0001f650: 6f6e 655f 2c20 645b 375d 290a 2020 2020  one_, d[7]).    
-0001f660: 2020 2020 2020 2020 2020 2020 230a 2020              #.  
-0001f670: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001f680: 6c66 2e61 7373 6572 7449 7349 6e73 7461  lf.assertIsInsta
-0001f690: 6e63 6528 7473 5f74 7a2c 2064 6174 6574  nce(ts_tz, datet
-0001f6a0: 696d 652e 6461 7465 7469 6d65 290a 2020  ime.datetime).  
-0001f6b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001f6c0: 6c66 2e61 7373 6572 7449 734e 6f74 4e6f  lf.assertIsNotNo
-0001f6d0: 6e65 2874 735f 747a 2e74 7a69 6e66 6f29  ne(ts_tz.tzinfo)
-0001f6e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f6f0: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
-0001f700: 744e 6f6e 6528 6765 7461 7474 7228 7473  tNone(getattr(ts
-0001f710: 5f74 7a2e 747a 696e 666f 2c20 275f 7469  _tz.tzinfo, '_ti
-0001f720: 6d65 7a6f 6e65 5f27 2929 0a20 2020 2020  mezone_')).     
-0001f730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001f740: 6173 7365 7274 4571 7561 6c28 7473 5f74  assertEqual(ts_t
-0001f750: 7a2e 7965 6172 2c20 645b 305d 290a 2020  z.year, d[0]).  
-0001f760: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001f770: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
-0001f780: 735f 747a 2e6d 6f6e 7468 2c20 645b 315d  s_tz.month, d[1]
-0001f790: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001f7a0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0001f7b0: 616c 2874 735f 747a 2e64 6179 2c20 645b  al(ts_tz.day, d[
-0001f7c0: 325d 290a 2020 2020 2020 2020 2020 2020  2]).            
-0001f7d0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001f7e0: 7175 616c 2874 735f 747a 2e68 6f75 722c  qual(ts_tz.hour,
-0001f7f0: 2064 5b33 5d29 0a20 2020 2020 2020 2020   d[3]).         
-0001f800: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001f810: 7274 4571 7561 6c28 7473 5f74 7a2e 6d69  rtEqual(ts_tz.mi
-0001f820: 6e75 7465 2c20 645b 345d 290a 2020 2020  nute, d[4]).    
-0001f830: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001f840: 2e61 7373 6572 7445 7175 616c 2874 735f  .assertEqual(ts_
-0001f850: 747a 2e73 6563 6f6e 642c 2064 5b35 5d29  tz.second, d[5])
-0001f860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f870: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0001f880: 6c28 7473 5f74 7a2e 6d69 6372 6f73 6563  l(ts_tz.microsec
-0001f890: 6f6e 642c 2064 5b36 5d29 0a20 2020 2020  ond, d[6]).     
-0001f8a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001f8b0: 6173 7365 7274 4571 7561 6c28 7473 5f74  assertEqual(ts_t
-0001f8c0: 7a2e 747a 696e 666f 2e5f 7469 6d65 7a6f  z.tzinfo._timezo
-0001f8d0: 6e65 5f2c 2064 5b37 5d29 0a20 2020 2064  ne_, d[7]).    d
-0001f8e0: 6566 2074 6573 745f 3035 5f73 656c 6563  ef test_05_selec
-0001f8f0: 745f 6465 666c 6f61 7428 7365 6c66 293a  t_defloat(self):
-0001f900: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-0001f910: 7b34 3a20 2864 6563 696d 616c 2e44 6563  {4: (decimal.Dec
-0001f920: 696d 616c 2827 3131 3131 3131 3131 3131  imal('1111111111
-0001f930: 3232 3232 3232 3232 3232 3333 3333 3333  2222222222333333
-0001f940: 3333 3333 3434 3434 2729 2c0a 2020 2020  33334444'),.    
-0001f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f960: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
-0001f970: 2731 3131 3131 3131 3131 3132 3232 3232  '111111111122222
-0001f980: 3227 292c 0a20 2020 2020 2020 2020 2020  2'),.           
-0001f990: 2020 2020 2020 2020 2064 6563 696d 616c           decimal
-0001f9a0: 2e44 6563 696d 616c 2827 3131 3131 3131  .Decimal('111111
-0001f9b0: 3131 3131 3232 3232 3232 3232 3232 3333  1111222222222233
-0001f9c0: 3333 3333 3333 3333 3434 3434 2729 292c  333333334444')),
-0001f9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f9e0: 207d 0a20 2020 2020 2020 2077 6974 6820   }.        with 
-0001f9f0: 7365 6c66 2e63 6f6e 2e63 7572 736f 7228  self.con.cursor(
-0001fa00: 2920 6173 2063 7572 3a0a 2020 2020 2020  ) as cur:.      
-0001fa10: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
-0001fa20: 6528 2269 6e73 6572 7420 696e 746f 2046  e("insert into F
-0001fa30: 4234 2028 504b 2c44 462c 4446 3136 2c44  B4 (PK,DF,DF16,D
-0001fa40: 4633 3429 2076 616c 7565 7320 2834 2c20  F34) values (4, 
-0001fa50: 3131 3131 3131 3131 3131 3232 3232 3232  1111111111222222
-0001fa60: 3232 3232 3333 3333 3333 3333 3333 3434  2222333333333344
-0001fa70: 3434 2c20 3131 3131 3131 3131 3131 3232  44, 111111111122
-0001fa80: 3232 3232 2c20 3131 3131 3131 3131 3131  2222, 1111111111
-0001fa90: 3232 3232 3232 3232 3232 3333 3333 3333  2222222222333333
-0001faa0: 3333 3333 3434 3434 2922 290a 2020 2020  33334444)").    
-0001fab0: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
-0001fac0: 2e63 6f6d 6d69 7428 290a 2020 2020 2020  .commit().      
-0001fad0: 2020 2020 2020 6375 722e 6578 6563 7574        cur.execut
-0001fae0: 6528 2773 656c 6563 7420 504b 2c44 462c  e('select PK,DF,
-0001faf0: 4446 3136 2c44 4633 3420 6672 6f6d 2046  DF16,DF34 from F
-0001fb00: 4234 2077 6865 7265 2050 4b20 3d20 3427  B4 where PK = 4'
-0001fb10: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-0001fb20: 7220 706b 2c20 6466 2c20 6466 3136 2c20  r pk, df, df16, 
-0001fb30: 6466 3334 2069 6e20 6375 723a 0a20 2020  df34 in cur:.   
-0001fb40: 2020 2020 2020 2020 2020 2020 2064 203d               d =
-0001fb50: 2064 6174 615b 706b 5d0a 2020 2020 2020   data[pk].      
-0001fb60: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001fb70: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-0001fb80: 6466 2c20 6465 6369 6d61 6c2e 4465 6369  df, decimal.Deci
-0001fb90: 6d61 6c29 0a20 2020 2020 2020 2020 2020  mal).           
-0001fba0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0001fbb0: 4571 7561 6c28 6466 2c20 645b 305d 290a  Equal(df, d[0]).
-0001fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbd0: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
-0001fbe0: 7461 6e63 6528 6466 3136 2c20 6465 6369  tance(df16, deci
-0001fbf0: 6d61 6c2e 4465 6369 6d61 6c29 0a20 2020  mal.Decimal).   
-0001fc00: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001fc10: 662e 6173 7365 7274 4571 7561 6c28 6466  f.assertEqual(df
-0001fc20: 3136 2c20 645b 315d 290a 2020 2020 2020  16, d[1]).      
-0001fc30: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001fc40: 7373 6572 7449 7349 6e73 7461 6e63 6528  ssertIsInstance(
-0001fc50: 6466 3334 2c20 6465 6369 6d61 6c2e 4465  df34, decimal.De
-0001fc60: 6369 6d61 6c29 0a20 2020 2020 2020 2020  cimal).         
-0001fc70: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0001fc80: 7274 4571 7561 6c28 6466 3334 2c20 645b  rtEqual(df34, d[
-0001fc90: 325d 290a 2020 2020 6465 6620 7465 7374  2]).    def test
-0001fca0: 5f30 365f 696e 7365 7274 5f64 6566 6c6f  _06_insert_deflo
-0001fcb0: 6174 2873 656c 6629 3a0a 2020 2020 2020  at(self):.      
-0001fcc0: 2020 6461 7461 203d 207b 343a 2028 6465    data = {4: (de
-0001fcd0: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
-0001fce0: 3131 3131 3131 3131 3132 3232 3232 3232  1111111112222222
-0001fcf0: 3232 3233 3333 3333 3333 3333 3334 3434  2223333333333444
-0001fd00: 3427 292c 0a20 2020 2020 2020 2020 2020  4'),.           
-0001fd10: 2020 2020 2020 2020 2064 6563 696d 616c           decimal
-0001fd20: 2e44 6563 696d 616c 2827 3131 3131 3131  .Decimal('111111
-0001fd30: 3131 3131 3232 3232 3232 2729 2c0a 2020  1111222222'),.  
-0001fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd50: 2020 6465 6369 6d61 6c2e 4465 6369 6d61    decimal.Decima
-0001fd60: 6c28 2731 3131 3131 3131 3131 3132 3232  l('1111111111222
-0001fd70: 3232 3232 3232 3233 3333 3333 3333 3333  2222222333333333
-0001fd80: 3334 3434 3427 2929 2c0a 2020 2020 2020  34444')),.      
-0001fd90: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-0001fda0: 2020 2020 7769 7468 2073 656c 662e 636f      with self.co
-0001fdb0: 6e2e 6375 7273 6f72 2829 2061 7320 6375  n.cursor() as cu
-0001fdc0: 723a 0a20 2020 2020 2020 2020 2020 2066  r:.            f
-0001fdd0: 6f72 2070 6b2c 2064 2069 6e20 6461 7461  or pk, d in data
-0001fde0: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-0001fdf0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
-0001fe00: 6563 7574 6528 2269 6e73 6572 7420 696e  ecute("insert in
-0001fe10: 746f 2046 4234 2028 504b 2c44 462c 4446  to FB4 (PK,DF,DF
-0001fe20: 3136 2c44 4633 3429 2076 616c 7565 7320  16,DF34) values 
-0001fe30: 283f 2c20 3f2c 203f 2c20 3f29 222c 2028  (?, ?, ?, ?)", (
-0001fe40: 706b 2c20 645b 305d 2c20 645b 315d 2c20  pk, d[0], d[1], 
-0001fe50: 645b 325d 2929 0a20 2020 2020 2020 2020  d[2])).         
-0001fe60: 2020 2020 2020 2073 656c 662e 636f 6e2e         self.con.
-0001fe70: 636f 6d6d 6974 2829 0a20 2020 2020 2020  commit().       
-0001fe80: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
-0001fe90: 2827 7365 6c65 6374 2050 4b2c 4446 2c44  ('select PK,DF,D
-0001fea0: 4631 362c 4446 3334 2066 726f 6d20 4642  F16,DF34 from FB
-0001feb0: 3420 7768 6572 6520 504b 203d 2034 2729  4 where PK = 4')
-0001fec0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0001fed0: 2070 6b2c 2064 662c 2064 6631 362c 2064   pk, df, df16, d
-0001fee0: 6633 3420 696e 2063 7572 3a0a 2020 2020  f34 in cur:.    
-0001fef0: 2020 2020 2020 2020 2020 2020 6420 3d20              d = 
-0001ff00: 6461 7461 5b70 6b5d 0a20 2020 2020 2020  data[pk].       
-0001ff10: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001ff20: 7365 7274 4973 496e 7374 616e 6365 2864  sertIsInstance(d
-0001ff30: 662c 2064 6563 696d 616c 2e44 6563 696d  f, decimal.Decim
-0001ff40: 616c 290a 2020 2020 2020 2020 2020 2020  al).            
-0001ff50: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-0001ff60: 7175 616c 2864 662c 2064 5b30 5d29 0a20  qual(df, d[0]). 
-0001ff70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001ff80: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
-0001ff90: 616e 6365 2864 6631 362c 2064 6563 696d  ance(df16, decim
-0001ffa0: 616c 2e44 6563 696d 616c 290a 2020 2020  al.Decimal).    
-0001ffb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001ffc0: 2e61 7373 6572 7445 7175 616c 2864 6631  .assertEqual(df1
-0001ffd0: 362c 2064 5b31 5d29 0a20 2020 2020 2020  6, d[1]).       
-0001ffe0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0001fff0: 7365 7274 4973 496e 7374 616e 6365 2864  sertIsInstance(d
-00020000: 6633 342c 2064 6563 696d 616c 2e44 6563  f34, decimal.Dec
-00020010: 696d 616c 290a 2020 2020 2020 2020 2020  imal).          
-00020020: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00020030: 7445 7175 616c 2864 6633 342c 2064 5b32  tEqual(df34, d[2
-00020040: 5d29 0a20 2020 2064 6566 2074 6573 745f  ]).    def test_
-00020050: 3037 5f73 656c 6563 745f 696e 7431 3238  07_select_int128
-00020060: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00020070: 6461 7461 203d 207b 353a 2064 6563 696d  data = {5: decim
-00020080: 616c 2e44 6563 696d 616c 2827 3131 3131  al.Decimal('1111
-00020090: 3131 3131 3131 3232 3232 3232 3232 3232  1111112222222222
-000200a0: 3333 3333 3333 3333 2e33 3334 3434 3427  33333333.334444'
-000200b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000200c0: 2020 2036 3a20 6465 6369 6d61 6c2e 4465     6: decimal.De
-000200d0: 6369 6d61 6c28 2731 3131 3131 3131 3131  cimal('111111111
-000200e0: 3132 3232 3232 3232 3232 3233 3333 3333  1222222222233333
-000200f0: 3333 3333 332e 3434 3434 2729 2c0a 2020  33333.4444'),.  
-00020100: 2020 2020 2020 2020 2020 2020 2020 373a                7:
-00020110: 2064 6563 696d 616c 2e44 6563 696d 616c   decimal.Decimal
-00020120: 2827 3131 3131 3131 3131 3131 3232 3232  ('11111111112222
-00020130: 3232 3232 3232 3333 3333 3333 3333 3333  2222223333333333
-00020140: 2e34 3434 3435 3527 292c 0a20 2020 2020  .444455'),.     
-00020150: 2020 2020 2020 2020 2020 2038 3a20 6465             8: de
-00020160: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
-00020170: 3131 3131 3131 3131 3132 3232 3232 3232  1111111112222222
-00020180: 3232 3233 3333 3333 3333 3333 332e 3434  2223333333333.44
-00020190: 3434 3536 2729 2c0a 2020 2020 2020 2020  4456'),.        
-000201a0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-000201b0: 2020 7769 7468 2073 656c 662e 636f 6e2e    with self.con.
-000201c0: 6375 7273 6f72 2829 2061 7320 6375 723a  cursor() as cur:
-000201d0: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-000201e0: 2e65 7865 6375 7465 2822 696e 7365 7274  .execute("insert
-000201f0: 2069 6e74 6f20 4642 3420 2850 4b2c 4e31   into FB4 (PK,N1
-00020200: 3238 2c44 3132 3829 2076 616c 7565 7320  28,D128) values 
-00020210: 2835 2c20 3131 3131 3131 3131 3131 3232  (5, 111111111122
-00020220: 3232 3232 3232 3232 3333 3333 3333 3333  2222222233333333
-00020230: 2e33 3334 3434 342c 2031 3131 3131 3131  .334444, 1111111
-00020240: 3131 3132 3232 3232 3232 3232 3233 3333  1112222222222333
-00020250: 3333 3333 332e 3333 3434 3434 2922 290a  33333.334444)").
-00020260: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
-00020270: 6578 6563 7574 6528 2269 6e73 6572 7420  execute("insert 
-00020280: 696e 746f 2046 4234 2028 504b 2c4e 3132  into FB4 (PK,N12
-00020290: 382c 4431 3238 2920 7661 6c75 6573 2028  8,D128) values (
-000202a0: 362c 2031 3131 3131 3131 3131 3132 3232  6, 1111111111222
-000202b0: 3232 3232 3232 3233 3333 3333 3333 3333  2222222333333333
-000202c0: 332e 3434 3434 2c20 3131 3131 3131 3131  3.4444, 11111111
-000202d0: 3131 3232 3232 3232 3232 3232 3333 3333  1122222222223333
-000202e0: 3333 3333 3333 2e34 3434 3429 2229 0a20  333333.4444)"). 
-000202f0: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
-00020300: 7865 6375 7465 2822 696e 7365 7274 2069  xecute("insert i
-00020310: 6e74 6f20 4642 3420 2850 4b2c 4e31 3238  nto FB4 (PK,N128
-00020320: 2c44 3132 3829 2076 616c 7565 7320 2837  ,D128) values (7
-00020330: 2c20 3131 3131 3131 3131 3131 3232 3232  , 11111111112222
-00020340: 3232 3232 3232 3333 3333 3333 3333 3333  2222223333333333
-00020350: 2e34 3434 3435 352c 2031 3131 3131 3131  .444455, 1111111
-00020360: 3131 3132 3232 3232 3232 3232 3233 3333  1112222222222333
-00020370: 3333 3333 3333 332e 3434 3434 3535 2922  3333333.444455)"
-00020380: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-00020390: 722e 6578 6563 7574 6528 2269 6e73 6572  r.execute("inser
-000203a0: 7420 696e 746f 2046 4234 2028 504b 2c4e  t into FB4 (PK,N
-000203b0: 3132 382c 4431 3238 2920 7661 6c75 6573  128,D128) values
-000203c0: 2028 382c 2031 3131 3131 3131 3131 3132   (8, 11111111112
-000203d0: 3232 3232 3232 3232 3233 3333 3333 3333  2222222223333333
-000203e0: 3333 332e 3434 3434 3535 392c 2031 3131  333.4444559, 111
-000203f0: 3131 3131 3131 3132 3232 3232 3232 3232  1111111222222222
-00020400: 3233 3333 3333 3333 3333 332e 3434 3434  23333333333.4444
-00020410: 3535 3929 2229 0a20 2020 2020 2020 2020  559)").         
-00020420: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
-00020430: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
-00020440: 2063 7572 2e65 7865 6375 7465 2827 7365   cur.execute('se
-00020450: 6c65 6374 2050 4b2c 4e31 3238 2c44 3132  lect PK,N128,D12
-00020460: 3820 6672 6f6d 2046 4234 2077 6865 7265  8 from FB4 where
-00020470: 2050 4b20 6265 7477 6565 6e20 3520 616e   PK between 5 an
-00020480: 6420 3820 6f72 6465 7220 6279 2070 6b27  d 8 order by pk'
-00020490: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-000204a0: 7220 706b 2c20 6e31 3238 2c20 6431 3238  r pk, n128, d128
-000204b0: 2069 6e20 6375 723a 0a20 2020 2020 2020   in cur:.       
-000204c0: 2020 2020 2020 2020 2064 203d 2064 6174           d = dat
-000204d0: 615b 706b 5d0a 2020 2020 2020 2020 2020  a[pk].          
-000204e0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000204f0: 7449 7349 6e73 7461 6e63 6528 6e31 3238  tIsInstance(n128
-00020500: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
-00020510: 6c29 0a20 2020 2020 2020 2020 2020 2020  l).             
-00020520: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00020530: 7561 6c28 6e31 3238 2c20 6429 0a20 2020  ual(n128, d).   
-00020540: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00020550: 662e 6173 7365 7274 4973 496e 7374 616e  f.assertIsInstan
-00020560: 6365 2864 3132 382c 2064 6563 696d 616c  ce(d128, decimal
-00020570: 2e44 6563 696d 616c 290a 2020 2020 2020  .Decimal).      
-00020580: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00020590: 7373 6572 7445 7175 616c 2864 3132 382c  ssertEqual(d128,
-000205a0: 2064 290a 2020 2020 6465 6620 7465 7374   d).    def test
-000205b0: 5f30 385f 7365 6c65 6374 5f69 6e74 3132  _08_select_int12
-000205c0: 3828 7365 6c66 293a 0a20 2020 2020 2020  8(self):.       
-000205d0: 2064 6174 6120 3d20 7b35 3a20 2864 6563   data = {5: (dec
-000205e0: 696d 616c 2e44 6563 696d 616c 2827 3131  imal.Decimal('11
-000205f0: 3131 3131 3131 3131 3232 3232 3232 3232  1111111122222222
-00020600: 3232 3333 3333 3333 3333 2e33 3334 3434  2233333333.33444
-00020610: 3427 292c 6465 6369 6d61 6c2e 4465 6369  4'),decimal.Deci
-00020620: 6d61 6c28 2731 3131 3131 3131 3131 3132  mal('11111111112
-00020630: 3232 3232 3232 3232 3233 3333 3333 3333  2222222223333333
-00020640: 332e 3333 3434 3434 2729 292c 0a20 2020  3.334444')),.   
-00020650: 2020 2020 2020 2020 2020 2020 2036 3a20               6: 
-00020660: 2864 6563 696d 616c 2e44 6563 696d 616c  (decimal.Decimal
-00020670: 2827 3131 3131 3131 3131 3131 3232 3232  ('11111111112222
-00020680: 3232 3232 3232 3333 3333 3333 3333 3333  2222223333333333
-00020690: 2e34 3434 3427 292c 6465 6369 6d61 6c2e  .4444'),decimal.
-000206a0: 4465 6369 6d61 6c28 2731 3131 3131 3131  Decimal('1111111
-000206b0: 3131 3132 3232 3232 3232 3232 3233 3333  1112222222222333
-000206c0: 3333 3333 3333 332e 3434 3434 2729 292c  3333333.4444')),
+0001bd40: 2020 2020 2020 2020 2020 2020 2020 5374                St
+0001bd50: 7269 6e67 494f 2862 6c6f 6229 2e72 6561  ringIO(blob).rea
+0001bd60: 646c 696e 6573 2829 290a 2020 2020 2020  dlines()).      
+0001bd70: 2020 2020 2020 2020 2020 2020 2020 626c                bl
+0001bd80: 6f62 5f72 6561 6465 722e 7365 656b 2830  ob_reader.seek(0
+0001bd90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001bda0: 2020 2020 2020 666f 7220 6c69 6e65 2069        for line i
+0001bdb0: 6e20 626c 6f62 5f72 6561 6465 723a 0a20  n blob_reader:. 
+0001bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bdd0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001bde0: 7274 496e 286c 696e 652e 7273 7472 6970  rtIn(line.rstrip
+0001bdf0: 2827 5c6e 2729 2c20 626c 6f62 2e73 706c  ('\n'), blob.spl
+0001be00: 6974 2827 5c6e 2729 290a 2020 2020 2020  it('\n')).      
+0001be10: 2020 2020 2020 2020 2020 2020 2020 626c                bl
+0001be20: 6f62 5f72 6561 6465 722e 7365 656b 2830  ob_reader.seek(0
+0001be30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001be40: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001be50: 7445 7175 616c 2862 6c6f 625f 7265 6164  tEqual(blob_read
+0001be60: 6572 2e72 6561 6428 292c 2062 6c6f 6229  er.read(), blob)
+0001be70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001be80: 2020 2020 2062 6c6f 625f 7265 6164 6572       blob_reader
+0001be90: 2e73 6565 6b28 2d39 2c20 6f73 2e53 4545  .seek(-9, os.SEE
+0001bea0: 4b5f 454e 4429 0a20 2020 2020 2020 2020  K_END).         
+0001beb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001bec0: 6173 7365 7274 4571 7561 6c28 626c 6f62  assertEqual(blob
+0001bed0: 5f72 6561 6465 722e 7265 6164 2829 2c20  _reader.read(), 
+0001bee0: 2769 6e63 6c75 6465 642e 2729 0a20 2020  'included.').   
+0001bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf00: 2062 6c6f 625f 7265 6164 6572 2e73 6565   blob_reader.see
+0001bf10: 6b28 2d32 302c 206f 732e 5345 454b 5f45  k(-20, os.SEEK_E
+0001bf20: 4e44 290a 2020 2020 2020 2020 2020 2020  ND).            
+0001bf30: 2020 2020 2020 2020 626c 6f62 5f72 6561          blob_rea
+0001bf40: 6465 722e 7365 656b 2831 312c 206f 732e  der.seek(11, os.
+0001bf50: 5345 454b 5f43 5552 290a 2020 2020 2020  SEEK_CUR).      
+0001bf60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001bf70: 6c66 2e61 7373 6572 7445 7175 616c 2862  lf.assertEqual(b
+0001bf80: 6c6f 625f 7265 6164 6572 2e72 6561 6428  lob_reader.read(
+0001bf90: 292c 2027 696e 636c 7564 6564 2e27 290a  ), 'included.').
+0001bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bfb0: 2020 2020 626c 6f62 5f72 6561 6465 722e      blob_reader.
+0001bfc0: 7365 656b 2836 3029 0a20 2020 2020 2020  seek(60).       
+0001bfd0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001bfe0: 662e 6173 7365 7274 4571 7561 6c28 626c  f.assertEqual(bl
+0001bff0: 6f62 5f72 6561 6465 722e 7265 6164 6c69  ob_reader.readli
+0001c000: 6e65 2829 2c0a 2020 2020 2020 2020 2020  ne(),.          
+0001c010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c020: 2020 2020 2020 2020 2020 2027 5468 6520             'The 
+0001c030: 6461 7461 6261 7365 2073 746f 7265 7320  database stores 
+0001c040: 7365 676d 656e 7465 6420 626c 6f62 7320  segmented blobs 
+0001c050: 696e 2063 6875 6e6b 732e 5c6e 2729 0a0a  in chunks.\n')..
+0001c060: 636c 6173 7320 5465 7374 4368 6172 7365  class TestCharse
+0001c070: 7443 6f6e 7665 7273 696f 6e28 4472 6976  tConversion(Driv
+0001c080: 6572 5465 7374 4261 7365 293a 0a20 2020  erTestBase):.   
+0001c090: 2064 6566 2073 6574 5570 2873 656c 6629   def setUp(self)
+0001c0a0: 3a0a 2020 2020 2020 2020 7375 7065 7228  :.        super(
+0001c0b0: 292e 7365 7455 7028 290a 2020 2020 2020  ).setUp().      
+0001c0c0: 2020 7365 6c66 2e64 6266 696c 6520 3d20    self.dbfile = 
+0001c0d0: 6f73 2e70 6174 682e 6a6f 696e 2873 656c  os.path.join(sel
+0001c0e0: 662e 6462 7061 7468 2c20 7365 6c66 2e46  f.dbpath, self.F
+0001c0f0: 4254 4553 545f 4442 290a 2020 2020 2020  BTEST_DB).      
+0001c100: 2020 7365 6c66 2e63 6f6e 203d 2063 6f6e    self.con = con
+0001c110: 6e65 6374 2873 656c 662e 6462 6669 6c65  nect(self.dbfile
+0001c120: 2c20 7573 6572 3d46 4254 4553 545f 5553  , user=FBTEST_US
+0001c130: 4552 2c20 7061 7373 776f 7264 3d46 4254  ER, password=FBT
+0001c140: 4553 545f 5041 5353 574f 5244 2c20 6368  EST_PASSWORD, ch
+0001c150: 6172 7365 743d 2775 7466 3827 290a 2020  arset='utf8').  
+0001c160: 2020 2020 2020 7365 6c66 2e63 6f6e 2e5f        self.con._
+0001c170: 6c6f 6767 696e 675f 6964 5f20 3d20 7365  logging_id_ = se
+0001c180: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+0001c190: 616d 655f 5f0a 2020 2020 2020 2020 2373  ame__.        #s
+0001c1a0: 656c 662e 636f 6e2e 6578 6563 7574 655f  elf.con.execute_
+0001c1b0: 696d 6d65 6469 6174 6528 2272 6563 7265  immediate("recre
+0001c1c0: 6174 6520 7461 626c 6520 7420 2863 3120  ate table t (c1 
+0001c1d0: 696e 7465 6765 7229 2229 0a20 2020 2020  integer)").     
+0001c1e0: 2020 2023 7365 6c66 2e63 6f6e 2e63 6f6d     #self.con.com
+0001c1f0: 6d69 7428 290a 2020 2020 2020 2020 2373  mit().        #s
+0001c200: 656c 662e 636f 6e2e 6578 6563 7574 655f  elf.con.execute_
+0001c210: 696d 6d65 6469 6174 6528 2252 4543 5245  immediate("RECRE
+0001c220: 4154 4520 5441 424c 4520 5432 2028 4331  ATE TABLE T2 (C1
+0001c230: 2053 6d61 6c6c 696e 742c 4332 2049 6e74   Smallint,C2 Int
+0001c240: 6567 6572 2c43 3320 4269 6769 6e74 2c43  eger,C3 Bigint,C
+0001c250: 3420 4368 6172 2835 292c 4335 2056 6172  4 Char(5),C5 Var
+0001c260: 6368 6172 2831 3029 2c43 3620 4461 7465  char(10),C6 Date
+0001c270: 2c43 3720 5469 6d65 2c43 3820 5469 6d65  ,C7 Time,C8 Time
+0001c280: 7374 616d 702c 4339 2042 6c6f 6220 7375  stamp,C9 Blob su
+0001c290: 625f 7479 7065 2031 2c43 3130 204e 756d  b_type 1,C10 Num
+0001c2a0: 6572 6963 2831 382c 3229 2c43 3131 2044  eric(18,2),C11 D
+0001c2b0: 6563 696d 616c 2831 382c 3229 2c43 3132  ecimal(18,2),C12
+0001c2c0: 2046 6c6f 6174 2c43 3133 2044 6f75 626c   Float,C13 Doubl
+0001c2d0: 6520 7072 6563 6973 696f 6e2c 4331 3420  e precision,C14 
+0001c2e0: 4e75 6d65 7269 6328 382c 3429 2c43 3135  Numeric(8,4),C15
+0001c2f0: 2044 6563 696d 616c 2838 2c34 2929 2229   Decimal(8,4))")
+0001c300: 0a20 2020 2020 2020 2023 7365 6c66 2e63  .        #self.c
+0001c310: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
+0001c320: 2020 2020 7365 6c66 2e63 6f6e 2e65 7865      self.con.exe
+0001c330: 6375 7465 5f69 6d6d 6564 6961 7465 2822  cute_immediate("
+0001c340: 6465 6c65 7465 2066 726f 6d20 7433 2229  delete from t3")
+0001c350: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+0001c360: 6e2e 6578 6563 7574 655f 696d 6d65 6469  n.execute_immedi
+0001c370: 6174 6528 2264 656c 6574 6520 6672 6f6d  ate("delete from
+0001c380: 2074 3422 290a 2020 2020 2020 2020 7365   t4").        se
+0001c390: 6c66 2e63 6f6e 2e63 6f6d 6d69 7428 290a  lf.con.commit().
+0001c3a0: 2020 2020 6465 6620 7465 6172 446f 776e      def tearDown
+0001c3b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001c3c0: 7365 6c66 2e63 6f6e 2e63 6c6f 7365 2829  self.con.close()
+0001c3d0: 0a20 2020 2064 6566 2074 6573 745f 6f63  .    def test_oc
+0001c3e0: 7465 7473 2873 656c 6629 3a0a 2020 2020  tets(self):.    
+0001c3f0: 2020 2020 6279 7465 7374 7269 6e67 203d      bytestring =
+0001c400: 2062 7974 6573 285b 312c 2032 2c20 332c   bytes([1, 2, 3,
+0001c410: 2034 2c20 355d 290a 2020 2020 2020 2020   4, 5]).        
+0001c420: 7769 7468 2073 656c 662e 636f 6e2e 6375  with self.con.cu
+0001c430: 7273 6f72 2829 2061 7320 6375 723a 0a20  rsor() as cur:. 
+0001c440: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+0001c450: 7865 6375 7465 2822 696e 7365 7274 2069  xecute("insert i
+0001c460: 6e74 6f20 5434 2028 4331 2c20 435f 4f43  nto T4 (C1, C_OC
+0001c470: 5445 5453 2c20 565f 4f43 5445 5453 2920  TETS, V_OCTETS) 
+0001c480: 7661 6c75 6573 2028 3f2c 3f2c 3f29 222c  values (?,?,?)",
+0001c490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c4a0: 2020 2020 2020 2020 2028 312c 2062 7974           (1, byt
+0001c4b0: 6573 7472 696e 672c 2062 7974 6573 7472  estring, bytestr
+0001c4c0: 696e 6729 290a 2020 2020 2020 2020 2020  ing)).          
+0001c4d0: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
+0001c4e0: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+0001c4f0: 6375 722e 6578 6563 7574 6528 2273 656c  cur.execute("sel
+0001c500: 6563 7420 4331 2c20 435f 4f43 5445 5453  ect C1, C_OCTETS
+0001c510: 2c20 565f 4f43 5445 5453 2066 726f 6d20  , V_OCTETS from 
+0001c520: 5434 2077 6865 7265 2043 3120 3d20 3122  T4 where C1 = 1"
+0001c530: 290a 2020 2020 2020 2020 2020 2020 726f  ).            ro
+0001c540: 7720 3d20 6375 722e 6665 7463 686f 6e65  w = cur.fetchone
+0001c550: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+0001c560: 656c 662e 6173 7365 7274 5475 706c 6545  elf.assertTupleE
+0001c570: 7175 616c 2872 6f77 2c0a 2020 2020 2020  qual(row,.      
+0001c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c590: 2020 2020 2020 2020 2020 2020 2831 2c20              (1, 
+0001c5a0: 6227 5c78 3031 5c78 3032 5c78 3033 5c78  b'\x01\x02\x03\x
+0001c5b0: 3034 5c78 3035 272c 2062 275c 7830 315c  04\x05', b'\x01\
+0001c5c0: 7830 325c 7830 335c 7830 345c 7830 3527  x02\x03\x04\x05'
+0001c5d0: 2929 0a20 2020 2064 6566 2074 6573 745f  )).    def test_
+0001c5e0: 7574 6638 3277 696e 3132 3530 2873 656c  utf82win1250(sel
+0001c5f0: 6629 3a0a 2020 2020 2020 2020 7335 203d  f):.        s5 =
+0001c600: 2027 c49b c5a1 c48d c599 c5be 270a 2020   '..........'.  
+0001c610: 2020 2020 2020 7333 3020 3d20 27c4 9bc5        s30 = '...
+0001c620: a1c4 8dc5 99c5 bec3 bdc3 a1c3 adc3 a9c3  ................
+0001c630: bac5 afc4 8fc5 a5c5 88c3 b3c4 9ac5 a0c4  ................
+0001c640: 8cc5 98c5 bdc3 9dc3 81c3 8dc3 89c3 9ac5  ................
+0001c650: aec4 8ec5 a4c5 87c3 9327 0a0a 2020 2020  .........'..    
+0001c660: 2020 2020 7769 7468 2063 6f6e 6e65 6374      with connect
+0001c670: 2873 656c 662e 6462 6669 6c65 2c20 7573  (self.dbfile, us
+0001c680: 6572 3d46 4254 4553 545f 5553 4552 2c0a  er=FBTEST_USER,.
+0001c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c6a0: 2020 2020 2070 6173 7377 6f72 643d 4642       password=FB
+0001c6b0: 5445 5354 5f50 4153 5357 4f52 442c 2063  TEST_PASSWORD, c
+0001c6c0: 6861 7273 6574 3d27 7769 6e31 3235 3027  harset='win1250'
+0001c6d0: 2920 6173 2063 6f6e 3132 3530 3a0a 2020  ) as con1250:.  
+0001c6e0: 2020 2020 2020 2020 2020 636f 6e31 3235            con125
+0001c6f0: 302e 5f6c 6f67 6769 6e67 5f69 645f 203d  0._logging_id_ =
+0001c700: 2073 656c 662e 5f5f 636c 6173 735f 5f2e   self.__class__.
+0001c710: 5f5f 6e61 6d65 5f5f 0a20 2020 2020 2020  __name__.       
+0001c720: 2020 2020 2077 6974 6820 7365 6c66 2e63       with self.c
+0001c730: 6f6e 2e63 7572 736f 7228 2920 6173 2063  on.cursor() as c
+0001c740: 5f75 7466 382c 2063 6f6e 3132 3530 2e63  _utf8, con1250.c
+0001c750: 7572 736f 7228 2920 6173 2063 5f77 696e  ursor() as c_win
+0001c760: 3132 3530 3a0a 2020 2020 2020 2020 2020  1250:.          
+0001c770: 2020 2020 2020 2320 496e 7365 7274 2075        # Insert u
+0001c780: 6e69 636f 6465 2064 6174 610a 2020 2020  nicode data.    
+0001c790: 2020 2020 2020 2020 2020 2020 635f 7574              c_ut
+0001c7a0: 6638 2e65 7865 6375 7465 2822 696e 7365  f8.execute("inse
+0001c7b0: 7274 2069 6e74 6f20 5434 2028 4331 2c20  rt into T4 (C1, 
+0001c7c0: 435f 5749 4e31 3235 302c 2056 5f57 494e  C_WIN1250, V_WIN
+0001c7d0: 3132 3530 2c20 435f 5554 4638 2c20 565f  1250, C_UTF8, V_
+0001c7e0: 5554 4638 2922 0a20 2020 2020 2020 2020  UTF8)".         
+0001c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c800: 2020 2020 2020 2276 616c 7565 7320 283f        "values (?
+0001c810: 2c3f 2c3f 2c3f 2c3f 2922 2c0a 2020 2020  ,?,?,?,?)",.    
+0001c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c830: 2020 2020 2020 2020 2020 2028 312c 2073             (1, s
+0001c840: 352c 2073 3330 2c20 7335 2c20 7333 3029  5, s30, s5, s30)
+0001c850: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001c860: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
+0001c870: 7428 290a 0a20 2020 2020 2020 2020 2020  t()..           
+0001c880: 2020 2020 2023 2053 686f 756c 6420 7265       # Should re
+0001c890: 7475 726e 2074 6865 2073 616d 6520 756e  turn the same un
+0001c8a0: 6963 6f64 6520 636f 6e74 656e 7420 7768  icode content wh
+0001c8b0: 656e 2072 6561 6420 6672 6f6d 2077 696e  en read from win
+0001c8c0: 3132 3530 206f 7220 7574 6638 2063 6f6e  1250 or utf8 con
+0001c8d0: 6e65 6374 696f 6e0a 2020 2020 2020 2020  nection.        
+0001c8e0: 2020 2020 2020 2020 635f 7769 6e31 3235          c_win125
+0001c8f0: 302e 6578 6563 7574 6528 2273 656c 6563  0.execute("selec
+0001c900: 7420 4331 2c20 435f 5749 4e31 3235 302c  t C1, C_WIN1250,
+0001c910: 2056 5f57 494e 3132 3530 2c22 0a20 2020   V_WIN1250,".   
+0001c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c930: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001c940: 435f 5554 4638 2c20 565f 5554 4638 2066  C_UTF8, V_UTF8 f
+0001c950: 726f 6d20 5434 2077 6865 7265 2043 3120  rom T4 where C1 
+0001c960: 3d20 3122 290a 2020 2020 2020 2020 2020  = 1").          
+0001c970: 2020 2020 2020 726f 7720 3d20 635f 7769        row = c_wi
+0001c980: 6e31 3235 302e 6665 7463 686f 6e65 2829  n1250.fetchone()
+0001c990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c9a0: 2073 656c 662e 6173 7365 7274 5475 706c   self.assertTupl
+0001c9b0: 6545 7175 616c 2872 6f77 2c20 2831 2c20  eEqual(row, (1, 
+0001c9c0: 7335 2c20 7333 302c 2073 352c 2073 3330  s5, s30, s5, s30
+0001c9d0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0001c9e0: 2020 2063 5f75 7466 382e 6578 6563 7574     c_utf8.execut
+0001c9f0: 6528 2273 656c 6563 7420 4331 2c20 435f  e("select C1, C_
+0001ca00: 5749 4e31 3235 302c 2056 5f57 494e 3132  WIN1250, V_WIN12
+0001ca10: 3530 2c22 0a20 2020 2020 2020 2020 2020  50,".           
+0001ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca30: 2020 2020 2243 5f55 5446 382c 2056 5f55      "C_UTF8, V_U
+0001ca40: 5446 3820 6672 6f6d 2054 3420 7768 6572  TF8 from T4 wher
+0001ca50: 6520 4331 203d 2031 2229 0a20 2020 2020  e C1 = 1").     
+0001ca60: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
+0001ca70: 2063 5f75 7466 382e 6665 7463 686f 6e65   c_utf8.fetchone
+0001ca80: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+0001ca90: 2020 2073 656c 662e 6173 7365 7274 5475     self.assertTu
+0001caa0: 706c 6545 7175 616c 2872 6f77 2c20 2831  pleEqual(row, (1
+0001cab0: 2c20 7335 2c20 7333 302c 2073 352c 2073  , s5, s30, s5, s
+0001cac0: 3330 2929 0a20 2020 2064 6566 2074 6573  30)).    def tes
+0001cad0: 7443 6861 7256 6172 6368 6172 2873 656c  tCharVarchar(sel
+0001cae0: 6629 3a0a 2020 2020 2020 2020 7320 3d20  f):.        s = 
+0001caf0: 2749 6e74 726f 6475 c3a7 c3a3 6f27 0a20  'Introdu....o'. 
+0001cb00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001cb10: 7274 4571 7561 6c28 6c65 6e28 7329 2c20  rtEqual(len(s), 
+0001cb20: 3130 290a 2020 2020 2020 2020 6461 7461  10).        data
+0001cb30: 203d 2074 7570 6c65 285b 312c 2073 2c20   = tuple([1, s, 
+0001cb40: 735d 290a 2020 2020 2020 2020 7769 7468  s]).        with
+0001cb50: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
+0001cb60: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
+0001cb70: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+0001cb80: 7465 2827 696e 7365 7274 2069 6e74 6f20  te('insert into 
+0001cb90: 5433 2028 4331 2c43 322c 4333 2920 7661  T3 (C1,C2,C3) va
+0001cba0: 6c75 6573 2028 3f2c 3f2c 3f29 272c 2064  lues (?,?,?)', d
+0001cbb0: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
+0001cbc0: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
+0001cbd0: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+0001cbe0: 7572 2e65 7865 6375 7465 2827 7365 6c65  ur.execute('sele
+0001cbf0: 6374 2043 312c 4332 2c43 3320 6672 6f6d  ct C1,C2,C3 from
+0001cc00: 2054 3320 7768 6572 6520 4331 203d 2031   T3 where C1 = 1
+0001cc10: 2729 0a20 2020 2020 2020 2020 2020 2072  ').            r
+0001cc20: 6f77 203d 2063 7572 2e66 6574 6368 6f6e  ow = cur.fetchon
+0001cc30: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0001cc40: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0001cc50: 2872 6f77 2c20 6461 7461 290a 2020 2020  (row, data).    
+0001cc60: 6465 6620 7465 7374 426c 6f62 2873 656c  def testBlob(sel
+0001cc70: 6629 3a0a 2020 2020 2020 2020 7320 3d20  f):.        s = 
+0001cc80: 2222 2249 6e74 726f 6475 c3a7 c3a3 6f0a  """Introdu....o.
+0001cc90: 0a45 7374 6520 6172 7469 676f 2064 6573  .Este artigo des
+0001cca0: 6372 6576 6520 636f 6d6f 2076 6f63 c3aa  creve como voc..
+0001ccb0: 2070 6f64 6520 6661 7a65 7220 6f20 496e   pode fazer o In
+0001ccc0: 7465 7242 6173 6520 6520 6f20 4669 7265  terBase e o Fire
+0001ccd0: 6269 7264 2031 2e35 0a63 6f65 6861 6269  bird 1.5.coehabi
+0001cce0: 7461 7265 6d20 7061 6369 6669 6361 6d65  tarem pacificame
+0001ccf0: 6e74 6520 7365 7520 636f 6d70 7574 6164  nte seu computad
+0001cd00: 6f72 2057 696e 646f 7773 2e20 506f 7220  or Windows. Por 
+0001cd10: 6661 766f 722c 206e 6f74 6520 7175 6520  favor, note que 
+0001cd20: 6573 7461 0a73 6f6c 75c3 a7c3 a36f 206e  esta.solu....o n
+0001cd30: c3a3 6f20 7065 726d 6974 6972 c3a1 2071  ..o permitir.. q
+0001cd40: 7565 206f 2049 6e74 6572 6261 7365 2065  ue o Interbase e
+0001cd50: 206f 2046 6972 6562 6972 6420 726f 6465   o Firebird rode
+0001cd60: 6d20 616f 206d 6573 6d6f 2074 656d 706f  m ao mesmo tempo
+0001cd70: 2e0a 506f 72c3 a96d 2076 6f63 c3aa 2070  ..Por..m voc.. p
+0001cd80: 6f64 6572 c3a1 2074 726f 6361 7220 656e  oder.. trocar en
+0001cd90: 7472 6520 616d 626f 7320 636f 6d20 756d  tre ambos com um
+0001cda0: 206d c3ad 6e69 6d6f 2064 6520 6c75 7461   m..nimo de luta
+0001cdb0: 2e20 2222 220a 2020 2020 2020 2020 7365  . """.        se
+0001cdc0: 6c66 2e61 7373 6572 7445 7175 616c 286c  lf.assertEqual(l
+0001cdd0: 656e 2873 292c 2032 3932 290a 2020 2020  en(s), 292).    
+0001cde0: 2020 2020 6461 7461 203d 2074 7570 6c65      data = tuple
+0001cdf0: 285b 322c 2073 5d29 0a20 2020 2020 2020  ([2, s]).       
+0001ce00: 2062 5f64 6174 6120 3d20 7475 706c 6528   b_data = tuple(
+0001ce10: 5b33 2c20 6227 6279 7465 7374 7269 6e67  [3, b'bytestring
+0001ce20: 275d 290a 2020 2020 2020 2020 7769 7468  ']).        with
+0001ce30: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
+0001ce40: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
+0001ce50: 2020 2020 2020 2023 2054 6578 7420 424c         # Text BL
+0001ce60: 4f42 0a20 2020 2020 2020 2020 2020 2063  OB.            c
+0001ce70: 7572 2e65 7865 6375 7465 2827 696e 7365  ur.execute('inse
+0001ce80: 7274 2069 6e74 6f20 5433 2028 4331 2c43  rt into T3 (C1,C
+0001ce90: 3429 2076 616c 7565 7320 283f 2c3f 2927  4) values (?,?)'
+0001cea0: 2c20 6461 7461 290a 2020 2020 2020 2020  , data).        
+0001ceb0: 2020 2020 7365 6c66 2e63 6f6e 2e63 6f6d      self.con.com
+0001cec0: 6d69 7428 290a 2020 2020 2020 2020 2020  mit().          
+0001ced0: 2020 6375 722e 6578 6563 7574 6528 2773    cur.execute('s
+0001cee0: 656c 6563 7420 4331 2c43 3420 6672 6f6d  elect C1,C4 from
+0001cef0: 2054 3320 7768 6572 6520 4331 203d 2032   T3 where C1 = 2
+0001cf00: 2729 0a20 2020 2020 2020 2020 2020 2072  ').            r
+0001cf10: 6f77 203d 2063 7572 2e66 6574 6368 6f6e  ow = cur.fetchon
+0001cf20: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0001cf30: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0001cf40: 2872 6f77 2c20 6461 7461 290a 2020 2020  (row, data).    
+0001cf50: 2020 2020 2020 2020 2320 496e 7365 7274          # Insert
+0001cf60: 2055 6e69 636f 6465 2069 6e74 6f20 6e6f   Unicode into no
+0001cf70: 6e2d 7465 7874 7561 6c20 424c 4f42 0a20  n-textual BLOB. 
+0001cf80: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+0001cf90: 7365 6c66 2e61 7373 6572 7452 6169 7365  self.assertRaise
+0001cfa0: 7328 5479 7065 4572 726f 7229 2061 7320  s(TypeError) as 
+0001cfb0: 636d 3a0a 2020 2020 2020 2020 2020 2020  cm:.            
+0001cfc0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+0001cfd0: 2769 6e73 6572 7420 696e 746f 2054 3320  'insert into T3 
+0001cfe0: 2843 312c 4335 2920 7661 6c75 6573 2028  (C1,C5) values (
+0001cff0: 3f2c 3f29 272c 2064 6174 6129 0a20 2020  ?,?)', data).   
+0001d000: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001d010: 662e 636f 6e2e 636f 6d6d 6974 2829 0a20  f.con.commit(). 
+0001d020: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001d030: 6173 7365 7274 5475 706c 6545 7175 616c  assertTupleEqual
+0001d040: 2863 6d2e 6578 6365 7074 696f 6e2e 6172  (cm.exception.ar
+0001d050: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+0001d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d070: 2020 2020 2020 2822 5374 7269 6e67 2076        ("String v
+0001d080: 616c 7565 2069 7320 6e6f 7420 6163 6365  alue is not acce
+0001d090: 7074 6162 6c65 2074 7970 6520 666f 7220  ptable type for 
+0001d0a0: 6120 6e6f 6e2d 7465 7874 7561 6c20 424c  a non-textual BL
+0001d0b0: 4f42 2063 6f6c 756d 6e2e 222c 2929 0a20  OB column.",)). 
+0001d0c0: 2020 2020 2020 2020 2020 2023 2052 6561             # Rea
+0001d0d0: 6420 6269 6e61 7279 2066 726f 6d20 6e6f  d binary from no
+0001d0e0: 6e2d 7465 7874 7561 6c20 424c 4f42 0a20  n-textual BLOB. 
+0001d0f0: 2020 2020 2020 2020 2020 2063 7572 2e65             cur.e
+0001d100: 7865 6375 7465 2827 696e 7365 7274 2069  xecute('insert i
+0001d110: 6e74 6f20 5433 2028 4331 2c43 3529 2076  nto T3 (C1,C5) v
+0001d120: 616c 7565 7320 283f 2c3f 2927 2c20 625f  alues (?,?)', b_
+0001d130: 6461 7461 290a 2020 2020 2020 2020 2020  data).          
+0001d140: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
+0001d150: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+0001d160: 6375 722e 6578 6563 7574 6528 2773 656c  cur.execute('sel
+0001d170: 6563 7420 4331 2c43 3520 6672 6f6d 2054  ect C1,C5 from T
+0001d180: 3320 7768 6572 6520 4331 203d 2033 2729  3 where C1 = 3')
+0001d190: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+0001d1a0: 203d 2063 7572 2e66 6574 6368 6f6e 6528   = cur.fetchone(
+0001d1b0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0001d1c0: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
+0001d1d0: 6f77 2c20 625f 6461 7461 290a 0a63 6c61  ow, b_data)..cla
+0001d1e0: 7373 2054 6573 7448 6f6f 6b73 2844 7269  ss TestHooks(Dri
+0001d1f0: 7665 7254 6573 7442 6173 6529 3a0a 2020  verTestBase):.  
+0001d200: 2020 6465 6620 7365 7455 7028 7365 6c66    def setUp(self
+0001d210: 293a 0a20 2020 2020 2020 2073 7570 6572  ):.        super
+0001d220: 2829 2e73 6574 5570 2829 0a20 2020 2020  ().setUp().     
+0001d230: 2020 2073 656c 662e 6462 6669 6c65 203d     self.dbfile =
+0001d240: 206f 732e 7061 7468 2e6a 6f69 6e28 7365   os.path.join(se
+0001d250: 6c66 2e64 6270 6174 682c 2073 656c 662e  lf.dbpath, self.
+0001d260: 4642 5445 5354 5f44 4229 0a20 2020 2020  FBTEST_DB).     
+0001d270: 2020 2068 6f6f 6b5f 6d61 6e61 6765 722e     hook_manager.
+0001d280: 7265 6d6f 7665 5f61 6c6c 5f68 6f6f 6b73  remove_all_hooks
+0001d290: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+0001d2a0: 5f64 6220 3d20 4e6f 6e65 0a20 2020 2020  _db = None.     
+0001d2b0: 2020 2073 656c 662e 5f73 7663 203d 204e     self._svc = N
+0001d2c0: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
+0001d2d0: 2e5f 686f 6f6b 5f63 6f6e 203d 204e 6f6e  ._hook_con = Non
+0001d2e0: 650a 2020 2020 6465 6620 7465 6172 446f  e.    def tearDo
+0001d2f0: 776e 2873 656c 6629 3a0a 2020 2020 2020  wn(self):.      
+0001d300: 2020 666f 7220 6974 656d 2069 6e20 5b73    for item in [s
+0001d310: 656c 662e 5f64 622c 2073 656c 662e 5f73  elf._db, self._s
+0001d320: 7663 2c20 7365 6c66 2e5f 686f 6f6b 5f63  vc, self._hook_c
+0001d330: 6f6e 5d3a 0a20 2020 2020 2020 2020 2020  on]:.           
+0001d340: 2069 6620 6974 656d 3a0a 2020 2020 2020   if item:.      
+0001d350: 2020 2020 2020 2020 2020 6974 656d 2e63            item.c
+0001d360: 6c6f 7365 2829 0a20 2020 2064 6566 205f  lose().    def _
+0001d370: 5f68 6f6f 6b5f 7365 7276 6963 655f 6174  _hook_service_at
+0001d380: 7461 6368 6564 2873 656c 662c 2063 6f6e  tached(self, con
+0001d390: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+0001d3a0: 5f73 7663 203d 2063 6f6e 0a20 2020 2020  _svc = con.     
+0001d3b0: 2020 2072 6574 7572 6e20 636f 6e0a 2020     return con.  
+0001d3c0: 2020 6465 6620 5f5f 686f 6f6b 5f64 625f    def __hook_db_
+0001d3d0: 6174 7461 6368 6564 2873 656c 662c 2063  attached(self, c
+0001d3e0: 6f6e 293a 0a20 2020 2020 2020 2073 656c  on):.        sel
+0001d3f0: 662e 5f64 6220 3d20 636f 6e0a 2020 2020  f._db = con.    
+0001d400: 2020 2020 7265 7475 726e 2063 6f6e 0a20      return con. 
+0001d410: 2020 2064 6566 205f 5f68 6f6f 6b5f 6462     def __hook_db
+0001d420: 5f63 6c6f 7365 6428 7365 6c66 2c20 636f  _closed(self, co
+0001d430: 6e29 3a0a 2020 2020 2020 2020 7365 6c66  n):.        self
+0001d440: 2e5f 6462 203d 2063 6f6e 0a20 2020 2064  ._db = con.    d
+0001d450: 6566 205f 5f68 6f6f 6b5f 6462 5f64 6574  ef __hook_db_det
+0001d460: 6163 685f 7265 7175 6573 745f 6128 7365  ach_request_a(se
+0001d470: 6c66 2c20 636f 6e29 3a0a 2020 2020 2020  lf, con):.      
+0001d480: 2020 2320 7265 7461 696e 0a20 2020 2020    # retain.     
+0001d490: 2020 2073 656c 662e 5f64 6220 3d20 636f     self._db = co
+0001d4a0: 6e0a 2020 2020 2020 2020 7265 7475 726e  n.        return
+0001d4b0: 2054 7275 650a 2020 2020 6465 6620 5f5f   True.    def __
+0001d4c0: 686f 6f6b 5f64 625f 6465 7461 6368 5f72  hook_db_detach_r
+0001d4d0: 6571 7565 7374 5f62 2873 656c 662c 2063  equest_b(self, c
+0001d4e0: 6f6e 293a 0a20 2020 2020 2020 2023 206e  on):.        # n
+0001d4f0: 6f20 7265 7461 696e 0a20 2020 2020 2020  o retain.       
+0001d500: 2073 656c 662e 5f64 6220 3d20 636f 6e0a   self._db = con.
+0001d510: 2020 2020 2020 2020 7265 7475 726e 2046          return F
+0001d520: 616c 7365 0a20 2020 2064 6566 205f 5f68  alse.    def __h
+0001d530: 6f6f 6b5f 6462 5f61 7474 6163 685f 7265  ook_db_attach_re
+0001d540: 7175 6573 745f 6128 7365 6c66 2c20 6473  quest_a(self, ds
+0001d550: 6e2c 2064 7062 293a 0a20 2020 2020 2020  n, dpb):.       
+0001d560: 2072 6574 7572 6e20 4e6f 6e65 0a20 2020   return None.   
+0001d570: 2064 6566 205f 5f68 6f6f 6b5f 6462 5f61   def __hook_db_a
+0001d580: 7474 6163 685f 7265 7175 6573 745f 6228  ttach_request_b(
+0001d590: 7365 6c66 2c20 6473 6e2c 2064 7062 293a  self, dsn, dpb):
+0001d5a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001d5b0: 7365 6c66 2e5f 686f 6f6b 5f63 6f6e 0a20  self._hook_con. 
+0001d5c0: 2020 2064 6566 2074 6573 745f 686f 6f6b     def test_hook
+0001d5d0: 5f64 625f 6174 7461 6368 6564 2873 656c  _db_attached(sel
+0001d5e0: 6629 3a0a 2020 2020 2020 2020 6164 645f  f):.        add_
+0001d5f0: 686f 6f6b 2843 6f6e 6e65 6374 696f 6e48  hook(ConnectionH
+0001d600: 6f6f 6b2e 4154 5441 4348 4544 2c20 6472  ook.ATTACHED, dr
+0001d610: 6976 6572 2e43 6f6e 6e65 6374 696f 6e2c  iver.Connection,
+0001d620: 2073 656c 662e 5f5f 686f 6f6b 5f64 625f   self.__hook_db_
+0001d630: 6174 7461 6368 6564 290a 2020 2020 2020  attached).      
+0001d640: 2020 7769 7468 2063 6f6e 6e65 6374 2873    with connect(s
+0001d650: 656c 662e 6462 6669 6c65 2c20 7573 6572  elf.dbfile, user
+0001d660: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
+0001d670: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+0001d680: 5353 574f 5244 2920 6173 2063 6f6e 3a0a  SSWORD) as con:.
+0001d690: 2020 2020 2020 2020 2020 2020 636f 6e2e              con.
+0001d6a0: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
+0001d6b0: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+0001d6c0: 6e61 6d65 5f5f 0a20 2020 2020 2020 2020  name__.         
+0001d6d0: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+0001d6e0: 2863 6f6e 2c20 7365 6c66 2e5f 6462 290a  (con, self._db).
+0001d6f0: 2020 2020 6465 6620 7465 7374 5f68 6f6f      def test_hoo
+0001d700: 6b5f 6462 5f61 7474 6163 685f 7265 7175  k_db_attach_requ
+0001d710: 6573 7428 7365 6c66 293a 0a20 2020 2020  est(self):.     
+0001d720: 2020 2073 656c 662e 5f68 6f6f 6b5f 636f     self._hook_co
+0001d730: 6e20 3d20 636f 6e6e 6563 7428 7365 6c66  n = connect(self
+0001d740: 2e64 6266 696c 652c 2075 7365 723d 4642  .dbfile, user=FB
+0001d750: 5445 5354 5f55 5345 522c 2070 6173 7377  TEST_USER, passw
+0001d760: 6f72 643d 4642 5445 5354 5f50 4153 5357  ord=FBTEST_PASSW
+0001d770: 4f52 4429 0a20 2020 2020 2020 2073 656c  ORD).        sel
+0001d780: 662e 5f68 6f6f 6b5f 636f 6e2e 5f6c 6f67  f._hook_con._log
+0001d790: 6769 6e67 5f69 645f 203d 2073 656c 662e  ging_id_ = self.
+0001d7a0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+0001d7b0: 5f5f 0a20 2020 2020 2020 2061 6464 5f68  __.        add_h
+0001d7c0: 6f6f 6b28 436f 6e6e 6563 7469 6f6e 486f  ook(ConnectionHo
+0001d7d0: 6f6b 2e41 5454 4143 485f 5245 5155 4553  ok.ATTACH_REQUES
+0001d7e0: 542c 2064 7269 7665 722e 436f 6e6e 6563  T, driver.Connec
+0001d7f0: 7469 6f6e 2c20 7365 6c66 2e5f 5f68 6f6f  tion, self.__hoo
+0001d800: 6b5f 6462 5f61 7474 6163 685f 7265 7175  k_db_attach_requ
+0001d810: 6573 745f 6129 0a20 2020 2020 2020 2061  est_a).        a
+0001d820: 6464 5f68 6f6f 6b28 436f 6e6e 6563 7469  dd_hook(Connecti
+0001d830: 6f6e 486f 6f6b 2e41 5454 4143 485f 5245  onHook.ATTACH_RE
+0001d840: 5155 4553 542c 2064 7269 7665 722e 436f  QUEST, driver.Co
+0001d850: 6e6e 6563 7469 6f6e 2c20 7365 6c66 2e5f  nnection, self._
+0001d860: 5f68 6f6f 6b5f 6462 5f61 7474 6163 685f  _hook_db_attach_
+0001d870: 7265 7175 6573 745f 6229 0a20 2020 2020  request_b).     
+0001d880: 2020 2077 6974 6820 636f 6e6e 6563 7428     with connect(
+0001d890: 7365 6c66 2e64 6266 696c 652c 2075 7365  self.dbfile, use
+0001d8a0: 723d 4642 5445 5354 5f55 5345 522c 2070  r=FBTEST_USER, p
+0001d8b0: 6173 7377 6f72 643d 4642 5445 5354 5f50  assword=FBTEST_P
+0001d8c0: 4153 5357 4f52 4429 2061 7320 636f 6e3a  ASSWORD) as con:
+0001d8d0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0001d8e0: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
+0001d8f0: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
+0001d900: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
+0001d910: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+0001d920: 7328 636f 6e2c 2073 656c 662e 5f68 6f6f  s(con, self._hoo
+0001d930: 6b5f 636f 6e29 0a20 2020 2020 2020 2073  k_con).        s
+0001d940: 656c 662e 5f68 6f6f 6b5f 636f 6e2e 636c  elf._hook_con.cl
+0001d950: 6f73 6528 290a 2020 2020 6465 6620 7465  ose().    def te
+0001d960: 7374 5f68 6f6f 6b5f 6462 5f63 6c6f 7365  st_hook_db_close
+0001d970: 6428 7365 6c66 293a 0a20 2020 2020 2020  d(self):.       
+0001d980: 2077 6974 6820 636f 6e6e 6563 7428 7365   with connect(se
+0001d990: 6c66 2e64 6266 696c 652c 2075 7365 723d  lf.dbfile, user=
+0001d9a0: 4642 5445 5354 5f55 5345 522c 2070 6173  FBTEST_USER, pas
+0001d9b0: 7377 6f72 643d 4642 5445 5354 5f50 4153  sword=FBTEST_PAS
+0001d9c0: 5357 4f52 4429 2061 7320 636f 6e3a 0a20  SWORD) as con:. 
+0001d9d0: 2020 2020 2020 2020 2020 2063 6f6e 2e5f             con._
+0001d9e0: 6c6f 6767 696e 675f 6964 5f20 3d20 7365  logging_id_ = se
+0001d9f0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+0001da00: 616d 655f 5f0a 2020 2020 2020 2020 2020  ame__.          
+0001da10: 2020 6164 645f 686f 6f6b 2843 6f6e 6e65    add_hook(Conne
+0001da20: 6374 696f 6e48 6f6f 6b2e 434c 4f53 4544  ctionHook.CLOSED
+0001da30: 2c20 636f 6e2c 2073 656c 662e 5f5f 686f  , con, self.__ho
+0001da40: 6f6b 5f64 625f 636c 6f73 6564 290a 2020  ok_db_closed).  
+0001da50: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001da60: 7449 7328 636f 6e2c 2073 656c 662e 5f64  tIs(con, self._d
+0001da70: 6229 0a20 2020 2064 6566 2074 6573 745f  b).    def test_
+0001da80: 686f 6f6b 5f64 625f 6465 7461 6368 5f72  hook_db_detach_r
+0001da90: 6571 7565 7374 2873 656c 6629 3a0a 2020  equest(self):.  
+0001daa0: 2020 2020 2020 2320 7265 6a65 6374 2064        # reject d
+0001dab0: 6574 6163 680a 2020 2020 2020 2020 636f  etach.        co
+0001dac0: 6e20 3d20 636f 6e6e 6563 7428 7365 6c66  n = connect(self
+0001dad0: 2e64 6266 696c 652c 2075 7365 723d 4642  .dbfile, user=FB
+0001dae0: 5445 5354 5f55 5345 522c 2070 6173 7377  TEST_USER, passw
+0001daf0: 6f72 643d 4642 5445 5354 5f50 4153 5357  ord=FBTEST_PASSW
+0001db00: 4f52 4429 0a20 2020 2020 2020 2063 6f6e  ORD).        con
+0001db10: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
+0001db20: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
+0001db30: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
+0001db40: 6164 645f 686f 6f6b 2843 6f6e 6e65 6374  add_hook(Connect
+0001db50: 696f 6e48 6f6f 6b2e 4445 5441 4348 5f52  ionHook.DETACH_R
+0001db60: 4551 5545 5354 2c20 636f 6e2c 2073 656c  EQUEST, con, sel
+0001db70: 662e 5f5f 686f 6f6b 5f64 625f 6465 7461  f.__hook_db_deta
+0001db80: 6368 5f72 6571 7565 7374 5f61 290a 2020  ch_request_a).  
+0001db90: 2020 2020 2020 636f 6e2e 636c 6f73 6528        con.close(
+0001dba0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0001dbb0: 7373 6572 7449 7328 636f 6e2c 2073 656c  ssertIs(con, sel
+0001dbc0: 662e 5f64 6229 0a20 2020 2020 2020 2073  f._db).        s
+0001dbd0: 656c 662e 6173 7365 7274 4661 6c73 6528  elf.assertFalse(
+0001dbe0: 636f 6e2e 6973 5f63 6c6f 7365 6428 2929  con.is_closed())
+0001dbf0: 0a20 2020 2020 2020 2068 6f6f 6b5f 6d61  .        hook_ma
+0001dc00: 6e61 6765 722e 7265 6d6f 7665 5f68 6f6f  nager.remove_hoo
+0001dc10: 6b28 436f 6e6e 6563 7469 6f6e 486f 6f6b  k(ConnectionHook
+0001dc20: 2e44 4554 4143 485f 5245 5155 4553 542c  .DETACH_REQUEST,
+0001dc30: 2063 6f6e 2c20 7365 6c66 2e5f 5f68 6f6f   con, self.__hoo
+0001dc40: 6b5f 6462 5f64 6574 6163 685f 7265 7175  k_db_detach_requ
+0001dc50: 6573 745f 6129 0a20 2020 2020 2020 2023  est_a).        #
+0001dc60: 2061 6363 6570 7420 636c 6f73 650a 2020   accept close.  
+0001dc70: 2020 2020 2020 7365 6c66 2e5f 6462 203d        self._db =
+0001dc80: 204e 6f6e 650a 2020 2020 2020 2020 6164   None.        ad
+0001dc90: 645f 686f 6f6b 2843 6f6e 6e65 6374 696f  d_hook(Connectio
+0001dca0: 6e48 6f6f 6b2e 4445 5441 4348 5f52 4551  nHook.DETACH_REQ
+0001dcb0: 5545 5354 2c20 636f 6e2c 2073 656c 662e  UEST, con, self.
+0001dcc0: 5f5f 686f 6f6b 5f64 625f 6465 7461 6368  __hook_db_detach
+0001dcd0: 5f72 6571 7565 7374 5f62 290a 2020 2020  _request_b).    
+0001dce0: 2020 2020 636f 6e2e 636c 6f73 6528 290a      con.close().
+0001dcf0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0001dd00: 6572 7449 7328 636f 6e2c 2073 656c 662e  ertIs(con, self.
+0001dd10: 5f64 6229 0a20 2020 2020 2020 2073 656c  _db).        sel
+0001dd20: 662e 6173 7365 7274 5472 7565 2863 6f6e  f.assertTrue(con
+0001dd30: 2e69 735f 636c 6f73 6564 2829 290a 2020  .is_closed()).  
+0001dd40: 2020 6465 6620 7465 7374 5f68 6f6f 6b5f    def test_hook_
+0001dd50: 7365 7276 6963 655f 6174 7461 6368 6564  service_attached
+0001dd60: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001dd70: 6164 645f 686f 6f6b 2853 6572 7665 7248  add_hook(ServerH
+0001dd80: 6f6f 6b2e 4154 5441 4348 4544 2c20 6472  ook.ATTACHED, dr
+0001dd90: 6976 6572 2e53 6572 7665 722c 2073 656c  iver.Server, sel
+0001dda0: 662e 5f5f 686f 6f6b 5f73 6572 7669 6365  f.__hook_service
+0001ddb0: 5f61 7474 6163 6865 6429 0a20 2020 2020  _attached).     
+0001ddc0: 2020 2077 6974 6820 636f 6e6e 6563 745f     with connect_
+0001ddd0: 7365 7276 6572 2846 4254 4553 545f 484f  server(FBTEST_HO
+0001dde0: 5354 2c20 7573 6572 3d46 4254 4553 545f  ST, user=FBTEST_
+0001ddf0: 5553 4552 2c20 7061 7373 776f 7264 3d46  USER, password=F
+0001de00: 4254 4553 545f 5041 5353 574f 5244 2920  BTEST_PASSWORD) 
+0001de10: 6173 2073 7663 3a0a 2020 2020 2020 2020  as svc:.        
+0001de20: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+0001de30: 7328 7376 632c 2073 656c 662e 5f73 7663  s(svc, self._svc
+0001de40: 290a 0a0a 636c 6173 7320 5465 7374 4642  )...class TestFB
+0001de50: 3428 4472 6976 6572 5465 7374 4261 7365  4(DriverTestBase
+0001de60: 293a 0a20 2020 2064 6566 2073 6574 5570  ):.    def setUp
+0001de70: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001de80: 7375 7065 7228 292e 7365 7455 7028 290a  super().setUp().
+0001de90: 2020 2020 2020 2020 7365 6c66 2e64 6266          self.dbf
+0001dea0: 696c 6520 3d20 6f73 2e70 6174 682e 6a6f  ile = os.path.jo
+0001deb0: 696e 2873 656c 662e 6462 7061 7468 2c20  in(self.dbpath, 
+0001dec0: 7365 6c66 2e46 4254 4553 545f 4442 290a  self.FBTEST_DB).
+0001ded0: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+0001dee0: 203d 2063 6f6e 6e65 6374 2873 656c 662e   = connect(self.
+0001def0: 6462 6669 6c65 2c20 7573 6572 3d46 4254  dbfile, user=FBT
+0001df00: 4553 545f 5553 4552 2c20 7061 7373 776f  EST_USER, passwo
+0001df10: 7264 3d46 4254 4553 545f 5041 5353 574f  rd=FBTEST_PASSWO
+0001df20: 5244 290a 2020 2020 2020 2020 7365 6c66  RD).        self
+0001df30: 2e63 6f6e 2e5f 6c6f 6767 696e 675f 6964  .con._logging_id
+0001df40: 5f20 3d20 7365 6c66 2e5f 5f63 6c61 7373  _ = self.__class
+0001df50: 5f5f 2e5f 5f6e 616d 655f 5f0a 2020 2020  __.__name__.    
+0001df60: 2020 2020 230a 2020 2020 2020 2020 6966      #.        if
+0001df70: 2073 656c 662e 636f 6e2e 696e 666f 2e65   self.con.info.e
+0001df80: 6e67 696e 655f 7665 7273 696f 6e20 3c20  ngine_version < 
+0001df90: 342e 303a 0a20 2020 2020 2020 2020 2020  4.0:.           
+0001dfa0: 2073 656c 662e 736b 6970 5465 7374 2827   self.skipTest('
+0001dfb0: 5265 7175 6972 6573 2046 6972 6562 6972  Requires Firebir
+0001dfc0: 6420 342e 302b 2729 0a20 2020 2020 2020  d 4.0+').       
+0001dfd0: 2023 0a20 2020 2020 2020 2073 656c 662e   #.        self.
+0001dfe0: 636f 6e32 203d 2063 6f6e 6e65 6374 2873  con2 = connect(s
+0001dff0: 656c 662e 6462 6669 6c65 2c20 7573 6572  elf.dbfile, user
+0001e000: 3d46 4254 4553 545f 5553 4552 2c20 7061  =FBTEST_USER, pa
+0001e010: 7373 776f 7264 3d46 4254 4553 545f 5041  ssword=FBTEST_PA
+0001e020: 5353 574f 5244 2c20 6368 6172 7365 743d  SSWORD, charset=
+0001e030: 2775 7466 2d38 2729 0a20 2020 2020 2020  'utf-8').       
+0001e040: 2073 656c 662e 636f 6e32 2e5f 6c6f 6767   self.con2._logg
+0001e050: 696e 675f 6964 5f20 3d20 7365 6c66 2e5f  ing_id_ = self._
+0001e060: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+0001e070: 5f0a 2020 2020 2020 2020 2373 656c 662e  _.        #self.
+0001e080: 636f 6e2e 6578 6563 7574 655f 696d 6d65  con.execute_imme
+0001e090: 6469 6174 6528 2243 5245 4154 4520 5441  diate("CREATE TA
+0001e0a0: 424c 4520 4642 3420 2850 4b20 696e 7465  BLE FB4 (PK inte
+0001e0b0: 6765 722c 545f 545a 2054 494d 4520 5749  ger,T_TZ TIME WI
+0001e0c0: 5448 2054 494d 4520 5a4f 4e45 2c54 535f  TH TIME ZONE,TS_
+0001e0d0: 545a 2074 696d 6573 7461 6d70 2077 6974  TZ timestamp wit
+0001e0e0: 6820 7469 6d65 207a 6f6e 652c 5420 7469  h time zone,T ti
+0001e0f0: 6d65 2c54 5320 7469 6d65 7374 616d 702c  me,TS timestamp,
+0001e100: 4446 2064 6563 666c 6f61 742c 4446 3136  DF decfloat,DF16
+0001e110: 2064 6563 666c 6f61 7428 3136 292c 4446   decfloat(16),DF
+0001e120: 3334 2064 6563 666c 6f61 7428 3334 292c  34 decfloat(34),
+0001e130: 4e31 3238 206e 756d 6572 6963 2833 342c  N128 numeric(34,
+0001e140: 3629 2c44 3132 3820 6465 6369 6d61 6c28  6),D128 decimal(
+0001e150: 3334 2c36 2929 2229 0a20 2020 2020 2020  34,6))").       
+0001e160: 2023 7365 6c66 2e63 6f6e 2e65 7865 6375   #self.con.execu
+0001e170: 7465 5f69 6d6d 6564 6961 7465 2822 6465  te_immediate("de
+0001e180: 6c65 7465 2066 726f 6d20 5422 290a 2020  lete from T").  
+0001e190: 2020 2020 2020 7365 6c66 2e63 6f6e 2e65        self.con.e
+0001e1a0: 7865 6375 7465 5f69 6d6d 6564 6961 7465  xecute_immediate
+0001e1b0: 2822 6465 6c65 7465 2066 726f 6d20 4642  ("delete from FB
+0001e1c0: 3422 290a 2020 2020 2020 2020 7365 6c66  4").        self
+0001e1d0: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 2020  .con.commit().  
+0001e1e0: 2020 6465 6620 7465 6172 446f 776e 2873    def tearDown(s
+0001e1f0: 656c 6629 3a0a 2020 2020 2020 2020 7365  elf):.        se
+0001e200: 6c66 2e63 6f6e 322e 636c 6f73 6528 290a  lf.con2.close().
+0001e210: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+0001e220: 2e63 6c6f 7365 2829 0a20 2020 2064 6566  .close().    def
+0001e230: 2074 6573 745f 3031 5f73 656c 6563 745f   test_01_select_
+0001e240: 7769 7468 5f74 696d 657a 6f6e 655f 7265  with_timezone_re
+0001e250: 6769 6f6e 2873 656c 6629 3a0a 2020 2020  gion(self):.    
+0001e260: 2020 2020 6461 7461 203d 207b 313a 2028      data = {1: (
+0001e270: 3230 3230 2c20 312c 2033 312c 2031 312c  2020, 1, 31, 11,
+0001e280: 2035 352c 2033 352c 2031 3233 3430 302c   55, 35, 123400,
+0001e290: 2027 4575 726f 7065 2f50 7261 6775 6527   'Europe/Prague'
+0001e2a0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001e2b0: 2020 2032 3a20 2832 3032 302c 2036 2c20     2: (2020, 6, 
+0001e2c0: 312c 2031 2c20 3535 2c20 3335 2c20 3132  1, 1, 55, 35, 12
+0001e2d0: 3334 3030 2c20 2745 7572 6f70 652f 5072  3400, 'Europe/Pr
+0001e2e0: 6167 7565 2729 2c0a 2020 2020 2020 2020  ague'),.        
+0001e2f0: 2020 2020 2020 2020 333a 2028 3230 3230          3: (2020
+0001e300: 2c20 3132 2c20 3331 2c20 3233 2c20 3535  , 12, 31, 23, 55
+0001e310: 2c20 3335 2c20 3132 3334 3030 2c20 2745  , 35, 123400, 'E
+0001e320: 7572 6f70 652f 5072 6167 7565 2729 2c7d  urope/Prague'),}
+0001e330: 0a20 2020 2020 2020 2077 6974 6820 7365  .        with se
+0001e340: 6c66 2e63 6f6e 2e63 7572 736f 7228 2920  lf.con.cursor() 
+0001e350: 6173 2063 7572 3a0a 2020 2020 2020 2020  as cur:.        
+0001e360: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+0001e370: 2269 6e73 6572 7420 696e 746f 2046 4234  "insert into FB4
+0001e380: 2028 504b 2c54 5f54 5a2c 5453 5f54 5a29   (PK,T_TZ,TS_TZ)
+0001e390: 2076 616c 7565 7320 2831 2c20 2731 313a   values (1, '11:
+0001e3a0: 3535 3a33 352e 3132 3334 2045 7572 6f70  55:35.1234 Europ
+0001e3b0: 652f 5072 6167 7565 272c 2027 3230 3230  e/Prague', '2020
+0001e3c0: 2d30 312d 3331 2031 313a 3535 3a33 352e  -01-31 11:55:35.
+0001e3d0: 3132 3334 2045 7572 6f70 652f 5072 6167  1234 Europe/Prag
+0001e3e0: 7565 2729 2229 0a20 2020 2020 2020 2020  ue')").         
+0001e3f0: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
+0001e400: 696e 7365 7274 2069 6e74 6f20 4642 3420  insert into FB4 
+0001e410: 2850 4b2c 545f 545a 2c54 535f 545a 2920  (PK,T_TZ,TS_TZ) 
+0001e420: 7661 6c75 6573 2028 322c 2027 3031 3a35  values (2, '01:5
+0001e430: 353a 3335 2e31 3233 3420 4575 726f 7065  5:35.1234 Europe
+0001e440: 2f50 7261 6775 6527 2c20 2732 3032 302d  /Prague', '2020-
+0001e450: 3036 2d30 3120 3031 3a35 353a 3335 2e31  06-01 01:55:35.1
+0001e460: 3233 3420 4575 726f 7065 2f50 7261 6775  234 Europe/Pragu
+0001e470: 6527 2922 290a 2020 2020 2020 2020 2020  e')").          
+0001e480: 2020 6375 722e 6578 6563 7574 6528 2269    cur.execute("i
+0001e490: 6e73 6572 7420 696e 746f 2046 4234 2028  nsert into FB4 (
+0001e4a0: 504b 2c54 5f54 5a2c 5453 5f54 5a29 2076  PK,T_TZ,TS_TZ) v
+0001e4b0: 616c 7565 7320 2833 2c20 2732 333a 3535  alues (3, '23:55
+0001e4c0: 3a33 352e 3132 3334 2045 7572 6f70 652f  :35.1234 Europe/
+0001e4d0: 5072 6167 7565 272c 2027 3230 3230 2d31  Prague', '2020-1
+0001e4e0: 322d 3331 2032 333a 3535 3a33 352e 3132  2-31 23:55:35.12
+0001e4f0: 3334 2045 7572 6f70 652f 5072 6167 7565  34 Europe/Prague
+0001e500: 2729 2229 0a20 2020 2020 2020 2020 2020  ')").           
+0001e510: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
+0001e520: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+0001e530: 7572 2e65 7865 6375 7465 2827 7365 6c65  ur.execute('sele
+0001e540: 6374 2050 4b2c 545f 545a 2c54 535f 545a  ct PK,T_TZ,TS_TZ
+0001e550: 2066 726f 6d20 4642 3420 7768 6572 6520   from FB4 where 
+0001e560: 504b 2062 6574 7765 656e 2031 2061 6e64  PK between 1 and
+0001e570: 2033 206f 7264 6572 2062 7920 504b 2729   3 order by PK')
+0001e580: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001e590: 2070 6b2c 2074 5f74 7a2c 2074 735f 747a   pk, t_tz, ts_tz
+0001e5a0: 2069 6e20 6375 723a 0a20 2020 2020 2020   in cur:.       
+0001e5b0: 2020 2020 2020 2020 2064 203d 2064 6174           d = dat
+0001e5c0: 615b 706b 5d0a 2020 2020 2020 2020 2020  a[pk].          
+0001e5d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001e5e0: 7449 7349 6e73 7461 6e63 6528 745f 747a  tIsInstance(t_tz
+0001e5f0: 2c20 6461 7465 7469 6d65 2e74 696d 6529  , datetime.time)
+0001e600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e610: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
+0001e620: 744e 6f6e 6528 745f 747a 2e74 7a69 6e66  tNone(t_tz.tzinf
+0001e630: 6f29 0a20 2020 2020 2020 2020 2020 2020  o).             
+0001e640: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+0001e650: 4e6f 744e 6f6e 6528 6765 7461 7474 7228  NotNone(getattr(
+0001e660: 745f 747a 2e74 7a69 6e66 6f2c 2027 5f74  t_tz.tzinfo, '_t
+0001e670: 696d 657a 6f6e 655f 2729 290a 2020 2020  imezone_')).    
+0001e680: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001e690: 2e61 7373 6572 7445 7175 616c 2874 5f74  .assertEqual(t_t
+0001e6a0: 7a2e 686f 7572 2c20 645b 335d 290a 2020  z.hour, d[3]).  
+0001e6b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001e6c0: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
+0001e6d0: 5f74 7a2e 6d69 6e75 7465 2c20 645b 345d  _tz.minute, d[4]
+0001e6e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001e6f0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001e700: 616c 2874 5f74 7a2e 7365 636f 6e64 2c20  al(t_tz.second, 
+0001e710: 645b 355d 290a 2020 2020 2020 2020 2020  d[5]).          
+0001e720: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001e730: 7445 7175 616c 2874 5f74 7a2e 6d69 6372  tEqual(t_tz.micr
+0001e740: 6f73 6563 6f6e 642c 2064 5b36 5d29 0a20  osecond, d[6]). 
+0001e750: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001e760: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001e770: 745f 747a 2e74 7a69 6e66 6f2e 5f74 696d  t_tz.tzinfo._tim
+0001e780: 657a 6f6e 655f 2c20 645b 375d 290a 2020  ezone_, d[7]).  
+0001e790: 2020 2020 2020 2020 2020 2020 2020 230a                #.
+0001e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e7b0: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
+0001e7c0: 7461 6e63 6528 7473 5f74 7a2c 2064 6174  tance(ts_tz, dat
+0001e7d0: 6574 696d 652e 6461 7465 7469 6d65 290a  etime.datetime).
+0001e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e7f0: 7365 6c66 2e61 7373 6572 7449 734e 6f74  self.assertIsNot
+0001e800: 4e6f 6e65 2874 735f 747a 2e74 7a69 6e66  None(ts_tz.tzinf
+0001e810: 6f29 0a20 2020 2020 2020 2020 2020 2020  o).             
+0001e820: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+0001e830: 4e6f 744e 6f6e 6528 6765 7461 7474 7228  NotNone(getattr(
+0001e840: 7473 5f74 7a2e 747a 696e 666f 2c20 275f  ts_tz.tzinfo, '_
+0001e850: 7469 6d65 7a6f 6e65 5f27 2929 0a20 2020  timezone_')).   
+0001e860: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001e870: 662e 6173 7365 7274 4571 7561 6c28 7473  f.assertEqual(ts
+0001e880: 5f74 7a2e 7965 6172 2c20 645b 305d 290a  _tz.year, d[0]).
+0001e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e8a0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0001e8b0: 2874 735f 747a 2e6d 6f6e 7468 2c20 645b  (ts_tz.month, d[
+0001e8c0: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
+0001e8d0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001e8e0: 7175 616c 2874 735f 747a 2e64 6179 2c20  qual(ts_tz.day, 
+0001e8f0: 645b 325d 290a 2020 2020 2020 2020 2020  d[2]).          
+0001e900: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001e910: 7445 7175 616c 2874 735f 747a 2e68 6f75  tEqual(ts_tz.hou
+0001e920: 722c 2064 5b33 5d29 0a20 2020 2020 2020  r, d[3]).       
+0001e930: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0001e940: 7365 7274 4571 7561 6c28 7473 5f74 7a2e  sertEqual(ts_tz.
+0001e950: 6d69 6e75 7465 2c20 645b 345d 290a 2020  minute, d[4]).  
+0001e960: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001e970: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
+0001e980: 735f 747a 2e73 6563 6f6e 642c 2064 5b35  s_tz.second, d[5
+0001e990: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0001e9a0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001e9b0: 7561 6c28 7473 5f74 7a2e 6d69 6372 6f73  ual(ts_tz.micros
+0001e9c0: 6563 6f6e 642c 2064 5b36 5d29 0a20 2020  econd, d[6]).   
+0001e9d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001e9e0: 662e 6173 7365 7274 4571 7561 6c28 7473  f.assertEqual(ts
+0001e9f0: 5f74 7a2e 747a 696e 666f 2e5f 7469 6d65  _tz.tzinfo._time
+0001ea00: 7a6f 6e65 5f2c 2064 5b37 5d29 0a20 2020  zone_, d[7]).   
+0001ea10: 2064 6566 2074 6573 745f 3032 5f73 656c   def test_02_sel
+0001ea20: 6563 745f 7769 7468 5f74 696d 657a 6f6e  ect_with_timezon
+0001ea30: 655f 6f66 6673 6574 2873 656c 6629 3a0a  e_offset(self):.
+0001ea40: 2020 2020 2020 2020 6461 7461 203d 207b          data = {
+0001ea50: 313a 2028 3230 3230 2c20 312c 2033 312c  1: (2020, 1, 31,
+0001ea60: 2031 312c 2035 352c 2033 352c 2031 3233   11, 55, 35, 123
+0001ea70: 3430 302c 2027 2b30 313a 3030 2729 2c0a  400, '+01:00'),.
+0001ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea90: 323a 2028 3230 3230 2c20 362c 2031 2c20  2: (2020, 6, 1, 
+0001eaa0: 312c 2035 352c 2033 352c 2031 3233 3430  1, 55, 35, 12340
+0001eab0: 302c 2027 2b30 323a 3030 2729 2c0a 2020  0, '+02:00'),.  
+0001eac0: 2020 2020 2020 2020 2020 2020 2020 333a                3:
+0001ead0: 2028 3230 3230 2c20 3132 2c20 3331 2c20   (2020, 12, 31, 
+0001eae0: 3233 2c20 3535 2c20 3335 2c20 3132 3334  23, 55, 35, 1234
+0001eaf0: 3030 2c20 272b 3031 3a30 3027 292c 7d0a  00, '+01:00'),}.
+0001eb00: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
+0001eb10: 662e 636f 6e2e 6375 7273 6f72 2829 2061  f.con.cursor() a
+0001eb20: 7320 6375 723a 0a20 2020 2020 2020 2020  s cur:.         
+0001eb30: 2020 2063 7572 2e65 7865 6375 7465 2822     cur.execute("
+0001eb40: 696e 7365 7274 2069 6e74 6f20 4642 3420  insert into FB4 
+0001eb50: 2850 4b2c 545f 545a 2c54 535f 545a 2920  (PK,T_TZ,TS_TZ) 
+0001eb60: 7661 6c75 6573 2028 312c 2027 3131 3a35  values (1, '11:5
+0001eb70: 353a 3335 2e31 3233 3420 2b30 313a 3030  5:35.1234 +01:00
+0001eb80: 272c 2027 3230 3230 2d30 312d 3331 2031  ', '2020-01-31 1
+0001eb90: 313a 3535 3a33 352e 3132 3334 202b 3031  1:55:35.1234 +01
+0001eba0: 3a30 3027 2922 290a 2020 2020 2020 2020  :00')").        
+0001ebb0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+0001ebc0: 2269 6e73 6572 7420 696e 746f 2046 4234  "insert into FB4
+0001ebd0: 2028 504b 2c54 5f54 5a2c 5453 5f54 5a29   (PK,T_TZ,TS_TZ)
+0001ebe0: 2076 616c 7565 7320 2832 2c20 2730 313a   values (2, '01:
+0001ebf0: 3535 3a33 352e 3132 3334 202b 3032 3a30  55:35.1234 +02:0
+0001ec00: 3027 2c20 2732 3032 302d 3036 2d30 3120  0', '2020-06-01 
+0001ec10: 3031 3a35 353a 3335 2e31 3233 3420 2b30  01:55:35.1234 +0
+0001ec20: 323a 3030 2729 2229 0a20 2020 2020 2020  2:00')").       
+0001ec30: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+0001ec40: 2822 696e 7365 7274 2069 6e74 6f20 4642  ("insert into FB
+0001ec50: 3420 2850 4b2c 545f 545a 2c54 535f 545a  4 (PK,T_TZ,TS_TZ
+0001ec60: 2920 7661 6c75 6573 2028 332c 2027 3233  ) values (3, '23
+0001ec70: 3a35 353a 3335 2e31 3233 3420 2b30 313a  :55:35.1234 +01:
+0001ec80: 3030 272c 2027 3230 3230 2d31 322d 3331  00', '2020-12-31
+0001ec90: 2032 333a 3535 3a33 352e 3132 3334 202b   23:55:35.1234 +
+0001eca0: 3031 3a30 3027 2922 290a 2020 2020 2020  01:00')").      
+0001ecb0: 2020 2020 2020 7365 6c66 2e63 6f6e 2e63        self.con.c
+0001ecc0: 6f6d 6d69 7428 290a 2020 2020 2020 2020  ommit().        
+0001ecd0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+0001ece0: 2773 656c 6563 7420 504b 2c54 5f54 5a2c  'select PK,T_TZ,
+0001ecf0: 5453 5f54 5a20 6672 6f6d 2046 4234 2077  TS_TZ from FB4 w
+0001ed00: 6865 7265 2050 4b20 6265 7477 6565 6e20  here PK between 
+0001ed10: 3120 616e 6420 3320 6f72 6465 7220 6279  1 and 3 order by
+0001ed20: 2050 4b27 290a 2020 2020 2020 2020 2020   PK').          
+0001ed30: 2020 666f 7220 706b 2c20 745f 747a 2c20    for pk, t_tz, 
+0001ed40: 7473 5f74 7a20 696e 2063 7572 3a0a 2020  ts_tz in cur:.  
+0001ed50: 2020 2020 2020 2020 2020 2020 2020 6420                d 
+0001ed60: 3d20 6461 7461 5b70 6b5d 0a20 2020 2020  = data[pk].     
+0001ed70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001ed80: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
+0001ed90: 2874 5f74 7a2c 2064 6174 6574 696d 652e  (t_tz, datetime.
+0001eda0: 7469 6d65 290a 2020 2020 2020 2020 2020  time).          
+0001edb0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001edc0: 7449 734e 6f74 4e6f 6e65 2874 5f74 7a2e  tIsNotNone(t_tz.
+0001edd0: 747a 696e 666f 290a 2020 2020 2020 2020  tzinfo).        
+0001ede0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0001edf0: 6572 7449 734e 6f74 4e6f 6e65 2867 6574  ertIsNotNone(get
+0001ee00: 6174 7472 2874 5f74 7a2e 747a 696e 666f  attr(t_tz.tzinfo
+0001ee10: 2c20 275f 7469 6d65 7a6f 6e65 5f27 2c20  , '_timezone_', 
+0001ee20: 4e6f 6e65 2929 0a20 2020 2020 2020 2020  None)).         
+0001ee30: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001ee40: 7274 4571 7561 6c28 745f 747a 2e68 6f75  rtEqual(t_tz.hou
+0001ee50: 722c 2064 5b33 5d29 0a20 2020 2020 2020  r, d[3]).       
+0001ee60: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0001ee70: 7365 7274 4571 7561 6c28 745f 747a 2e6d  sertEqual(t_tz.m
+0001ee80: 696e 7574 652c 2064 5b34 5d29 0a20 2020  inute, d[4]).   
+0001ee90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001eea0: 662e 6173 7365 7274 4571 7561 6c28 745f  f.assertEqual(t_
+0001eeb0: 747a 2e73 6563 6f6e 642c 2064 5b35 5d29  tz.second, d[5])
+0001eec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eed0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0001eee0: 6c28 745f 747a 2e6d 6963 726f 7365 636f  l(t_tz.microseco
+0001eef0: 6e64 2c20 645b 365d 290a 2020 2020 2020  nd, d[6]).      
+0001ef00: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0001ef10: 7373 6572 7445 7175 616c 2874 5f74 7a2e  ssertEqual(t_tz.
+0001ef20: 747a 696e 666f 2e5f 7469 6d65 7a6f 6e65  tzinfo._timezone
+0001ef30: 5f2c 2064 5b37 5d29 0a20 2020 2020 2020  _, d[7]).       
+0001ef40: 2020 2020 2020 2020 2023 0a20 2020 2020           #.     
+0001ef50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001ef60: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
+0001ef70: 2874 735f 747a 2c20 6461 7465 7469 6d65  (ts_tz, datetime
+0001ef80: 2e64 6174 6574 696d 6529 0a20 2020 2020  .datetime).     
+0001ef90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001efa0: 6173 7365 7274 4973 4e6f 744e 6f6e 6528  assertIsNotNone(
+0001efb0: 7473 5f74 7a2e 747a 696e 666f 290a 2020  ts_tz.tzinfo).  
+0001efc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001efd0: 6c66 2e61 7373 6572 7449 734e 6f74 4e6f  lf.assertIsNotNo
+0001efe0: 6e65 2867 6574 6174 7472 2874 735f 747a  ne(getattr(ts_tz
+0001eff0: 2e74 7a69 6e66 6f2c 2027 5f74 696d 657a  .tzinfo, '_timez
+0001f000: 6f6e 655f 272c 204e 6f6e 6529 290a 2020  one_', None)).  
+0001f010: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001f020: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
+0001f030: 735f 747a 2e79 6561 722c 2064 5b30 5d29  s_tz.year, d[0])
+0001f040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f050: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0001f060: 6c28 7473 5f74 7a2e 6d6f 6e74 682c 2064  l(ts_tz.month, d
+0001f070: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+0001f080: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0001f090: 4571 7561 6c28 7473 5f74 7a2e 6461 792c  Equal(ts_tz.day,
+0001f0a0: 2064 5b32 5d29 0a20 2020 2020 2020 2020   d[2]).         
+0001f0b0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001f0c0: 7274 4571 7561 6c28 7473 5f74 7a2e 686f  rtEqual(ts_tz.ho
+0001f0d0: 7572 2c20 645b 335d 290a 2020 2020 2020  ur, d[3]).      
+0001f0e0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0001f0f0: 7373 6572 7445 7175 616c 2874 735f 747a  ssertEqual(ts_tz
+0001f100: 2e6d 696e 7574 652c 2064 5b34 5d29 0a20  .minute, d[4]). 
+0001f110: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001f120: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001f130: 7473 5f74 7a2e 7365 636f 6e64 2c20 645b  ts_tz.second, d[
+0001f140: 355d 290a 2020 2020 2020 2020 2020 2020  5]).            
+0001f150: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001f160: 7175 616c 2874 735f 747a 2e6d 6963 726f  qual(ts_tz.micro
+0001f170: 7365 636f 6e64 2c20 645b 365d 290a 2020  second, d[6]).  
+0001f180: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001f190: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
+0001f1a0: 735f 747a 2e74 7a69 6e66 6f2e 5f74 696d  s_tz.tzinfo._tim
+0001f1b0: 657a 6f6e 655f 2c20 645b 375d 290a 2020  ezone_, d[7]).  
+0001f1c0: 2020 6465 6620 7465 7374 5f30 335f 696e    def test_03_in
+0001f1d0: 7365 7274 5f77 6974 685f 7469 6d65 7a6f  sert_with_timezo
+0001f1e0: 6e65 5f72 6567 696f 6e28 7365 6c66 293a  ne_region(self):
+0001f1f0: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+0001f200: 7b31 3a20 2832 3032 302c 2031 2c20 3331  {1: (2020, 1, 31
+0001f210: 2c20 3131 2c20 3535 2c20 3335 2c20 3132  , 11, 55, 35, 12
+0001f220: 3334 3030 2c20 2745 7572 6f70 652f 5072  3400, 'Europe/Pr
+0001f230: 6167 7565 2729 2c0a 2020 2020 2020 2020  ague'),.        
+0001f240: 2020 2020 2020 2020 323a 2028 3230 3230          2: (2020
+0001f250: 2c20 362c 2031 2c20 312c 2035 352c 2033  , 6, 1, 1, 55, 3
+0001f260: 352c 2031 3233 3430 302c 2027 4575 726f  5, 123400, 'Euro
+0001f270: 7065 2f50 7261 6775 6527 292c 0a20 2020  pe/Prague'),.   
+0001f280: 2020 2020 2020 2020 2020 2020 2033 3a20               3: 
+0001f290: 2832 3032 302c 2031 322c 2033 312c 2032  (2020, 12, 31, 2
+0001f2a0: 332c 2035 352c 2033 352c 2031 3233 3430  3, 55, 35, 12340
+0001f2b0: 302c 2027 4575 726f 7065 2f50 7261 6775  0, 'Europe/Pragu
+0001f2c0: 6527 292c 7d0a 2020 2020 2020 2020 7769  e'),}.        wi
+0001f2d0: 7468 2073 656c 662e 636f 6e2e 6375 7273  th self.con.curs
+0001f2e0: 6f72 2829 2061 7320 6375 723a 0a20 2020  or() as cur:.   
+0001f2f0: 2020 2020 2020 2020 2066 6f72 2070 6b2c           for pk,
+0001f300: 2064 2069 6e20 6461 7461 2e69 7465 6d73   d in data.items
+0001f310: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0001f320: 2020 2020 7a6f 6e65 203d 2067 6574 5f74      zone = get_t
+0001f330: 696d 657a 6f6e 6528 645b 375d 290a 2020  imezone(d[7]).  
+0001f340: 2020 2020 2020 2020 2020 2020 2020 7473                ts
+0001f350: 203d 2064 6174 6574 696d 652e 6461 7465   = datetime.date
+0001f360: 7469 6d65 2864 5b30 5d2c 2064 5b31 5d2c  time(d[0], d[1],
+0001f370: 2064 5b32 5d2c 2064 5b33 5d2c 2064 5b34   d[2], d[3], d[4
+0001f380: 5d2c 2064 5b35 5d2c 2064 5b36 5d2c 207a  ], d[5], d[6], z
+0001f390: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
+0001f3a0: 2020 2020 2063 7572 2e65 7865 6375 7465       cur.execute
+0001f3b0: 2822 696e 7365 7274 2069 6e74 6f20 4642  ("insert into FB
+0001f3c0: 3420 2850 4b2c 545f 545a 2c54 535f 545a  4 (PK,T_TZ,TS_TZ
+0001f3d0: 2920 7661 6c75 6573 2028 3f2c 203f 2c20  ) values (?, ?, 
+0001f3e0: 3f29 222c 2028 706b 2c20 7473 2e74 696d  ?)", (pk, ts.tim
+0001f3f0: 6574 7a28 292c 2074 7329 290a 2020 2020  etz(), ts)).    
+0001f400: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001f410: 2e63 6f6e 2e63 6f6d 6d69 7428 290a 2020  .con.commit().  
+0001f420: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+0001f430: 6563 7574 6528 2773 656c 6563 7420 504b  ecute('select PK
+0001f440: 2c54 5f54 5a2c 5453 5f54 5a20 6672 6f6d  ,T_TZ,TS_TZ from
+0001f450: 2046 4234 2077 6865 7265 2050 4b20 6265   FB4 where PK be
+0001f460: 7477 6565 6e20 3120 616e 6420 3320 6f72  tween 1 and 3 or
+0001f470: 6465 7220 6279 2050 4b27 290a 2020 2020  der by PK').    
+0001f480: 2020 2020 2020 2020 666f 7220 706b 2c20          for pk, 
+0001f490: 745f 747a 2c20 7473 5f74 7a20 696e 2063  t_tz, ts_tz in c
+0001f4a0: 7572 3a0a 2020 2020 2020 2020 2020 2020  ur:.            
+0001f4b0: 2020 2020 6420 3d20 6461 7461 5b70 6b5d      d = data[pk]
+0001f4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f4d0: 2073 656c 662e 6173 7365 7274 4973 496e   self.assertIsIn
+0001f4e0: 7374 616e 6365 2874 5f74 7a2c 2064 6174  stance(t_tz, dat
+0001f4f0: 6574 696d 652e 7469 6d65 290a 2020 2020  etime.time).    
+0001f500: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001f510: 2e61 7373 6572 7449 734e 6f74 4e6f 6e65  .assertIsNotNone
+0001f520: 2874 5f74 7a2e 747a 696e 666f 290a 2020  (t_tz.tzinfo).  
+0001f530: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001f540: 6c66 2e61 7373 6572 7449 734e 6f74 4e6f  lf.assertIsNotNo
+0001f550: 6e65 2867 6574 6174 7472 2874 5f74 7a2e  ne(getattr(t_tz.
+0001f560: 747a 696e 666f 2c20 275f 7469 6d65 7a6f  tzinfo, '_timezo
+0001f570: 6e65 5f27 2929 0a20 2020 2020 2020 2020  ne_')).         
+0001f580: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0001f590: 7274 4571 7561 6c28 745f 747a 2e68 6f75  rtEqual(t_tz.hou
+0001f5a0: 722c 2064 5b33 5d29 0a20 2020 2020 2020  r, d[3]).       
+0001f5b0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0001f5c0: 7365 7274 4571 7561 6c28 745f 747a 2e6d  sertEqual(t_tz.m
+0001f5d0: 696e 7574 652c 2064 5b34 5d29 0a20 2020  inute, d[4]).   
+0001f5e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001f5f0: 662e 6173 7365 7274 4571 7561 6c28 745f  f.assertEqual(t_
+0001f600: 747a 2e73 6563 6f6e 642c 2064 5b35 5d29  tz.second, d[5])
+0001f610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f620: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0001f630: 6c28 745f 747a 2e6d 6963 726f 7365 636f  l(t_tz.microseco
+0001f640: 6e64 2c20 645b 365d 290a 2020 2020 2020  nd, d[6]).      
+0001f650: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0001f660: 7373 6572 7445 7175 616c 2874 5f74 7a2e  ssertEqual(t_tz.
+0001f670: 747a 696e 666f 2e5f 7469 6d65 7a6f 6e65  tzinfo._timezone
+0001f680: 5f2c 2064 5b37 5d29 0a20 2020 2020 2020  _, d[7]).       
+0001f690: 2020 2020 2020 2020 2023 0a20 2020 2020           #.     
+0001f6a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001f6b0: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
+0001f6c0: 2874 735f 747a 2c20 6461 7465 7469 6d65  (ts_tz, datetime
+0001f6d0: 2e64 6174 6574 696d 6529 0a20 2020 2020  .datetime).     
+0001f6e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001f6f0: 6173 7365 7274 4973 4e6f 744e 6f6e 6528  assertIsNotNone(
+0001f700: 7473 5f74 7a2e 747a 696e 666f 290a 2020  ts_tz.tzinfo).  
+0001f710: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001f720: 6c66 2e61 7373 6572 7449 734e 6f74 4e6f  lf.assertIsNotNo
+0001f730: 6e65 2867 6574 6174 7472 2874 735f 747a  ne(getattr(ts_tz
+0001f740: 2e74 7a69 6e66 6f2c 2027 5f74 696d 657a  .tzinfo, '_timez
+0001f750: 6f6e 655f 2729 290a 2020 2020 2020 2020  one_')).        
+0001f760: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0001f770: 6572 7445 7175 616c 2874 735f 747a 2e79  ertEqual(ts_tz.y
+0001f780: 6561 722c 2064 5b30 5d29 0a20 2020 2020  ear, d[0]).     
+0001f790: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001f7a0: 6173 7365 7274 4571 7561 6c28 7473 5f74  assertEqual(ts_t
+0001f7b0: 7a2e 6d6f 6e74 682c 2064 5b31 5d29 0a20  z.month, d[1]). 
+0001f7c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001f7d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001f7e0: 7473 5f74 7a2e 6461 792c 2064 5b32 5d29  ts_tz.day, d[2])
+0001f7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f800: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0001f810: 6c28 7473 5f74 7a2e 686f 7572 2c20 645b  l(ts_tz.hour, d[
+0001f820: 335d 290a 2020 2020 2020 2020 2020 2020  3]).            
+0001f830: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001f840: 7175 616c 2874 735f 747a 2e6d 696e 7574  qual(ts_tz.minut
+0001f850: 652c 2064 5b34 5d29 0a20 2020 2020 2020  e, d[4]).       
+0001f860: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0001f870: 7365 7274 4571 7561 6c28 7473 5f74 7a2e  sertEqual(ts_tz.
+0001f880: 7365 636f 6e64 2c20 645b 355d 290a 2020  second, d[5]).  
+0001f890: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001f8a0: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
+0001f8b0: 735f 747a 2e6d 6963 726f 7365 636f 6e64  s_tz.microsecond
+0001f8c0: 2c20 645b 365d 290a 2020 2020 2020 2020  , d[6]).        
+0001f8d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0001f8e0: 6572 7445 7175 616c 2874 735f 747a 2e74  ertEqual(ts_tz.t
+0001f8f0: 7a69 6e66 6f2e 5f74 696d 657a 6f6e 655f  zinfo._timezone_
+0001f900: 2c20 645b 375d 290a 2020 2020 6465 6620  , d[7]).    def 
+0001f910: 7465 7374 5f30 345f 696e 7365 7274 5f77  test_04_insert_w
+0001f920: 6974 685f 7469 6d65 7a6f 6e65 5f6f 6666  ith_timezone_off
+0001f930: 7365 7428 7365 6c66 293a 0a20 2020 2020  set(self):.     
+0001f940: 2020 2064 6174 6120 3d20 7b31 3a20 2832     data = {1: (2
+0001f950: 3032 302c 2031 2c20 3331 2c20 3131 2c20  020, 1, 31, 11, 
+0001f960: 3535 2c20 3335 2c20 3132 3334 3030 2c20  55, 35, 123400, 
+0001f970: 272b 3031 3a30 3027 292c 0a20 2020 2020  '+01:00'),.     
+0001f980: 2020 2020 2020 2020 2020 2032 3a20 2832             2: (2
+0001f990: 3032 302c 2036 2c20 312c 2031 2c20 3535  020, 6, 1, 1, 55
+0001f9a0: 2c20 3335 2c20 3132 3334 3030 2c20 272b  , 35, 123400, '+
+0001f9b0: 3032 3a30 3027 292c 0a20 2020 2020 2020  02:00'),.       
+0001f9c0: 2020 2020 2020 2020 2033 3a20 2832 3032           3: (202
+0001f9d0: 302c 2031 322c 2033 312c 2032 332c 2035  0, 12, 31, 23, 5
+0001f9e0: 352c 2033 352c 2031 3233 3430 302c 2027  5, 35, 123400, '
+0001f9f0: 2b30 313a 3030 2729 2c7d 0a20 2020 2020  +01:00'),}.     
+0001fa00: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
+0001fa10: 2e63 7572 736f 7228 2920 6173 2063 7572  .cursor() as cur
+0001fa20: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+0001fa30: 7220 706b 2c20 6420 696e 2064 6174 612e  r pk, d in data.
+0001fa40: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+0001fa50: 2020 2020 2020 2020 207a 6f6e 6520 3d20           zone = 
+0001fa60: 6765 745f 7469 6d65 7a6f 6e65 2864 5b37  get_timezone(d[7
+0001fa70: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0001fa80: 2020 2074 7320 3d20 6461 7465 7469 6d65     ts = datetime
+0001fa90: 2e64 6174 6574 696d 6528 645b 305d 2c20  .datetime(d[0], 
+0001faa0: 645b 315d 2c20 645b 325d 2c20 645b 335d  d[1], d[2], d[3]
+0001fab0: 2c20 645b 345d 2c20 645b 355d 2c20 645b  , d[4], d[5], d[
+0001fac0: 365d 2c20 7a6f 6e65 290a 2020 2020 2020  6], zone).      
+0001fad0: 2020 2020 2020 2020 2020 6375 722e 6578            cur.ex
+0001fae0: 6563 7574 6528 2269 6e73 6572 7420 696e  ecute("insert in
+0001faf0: 746f 2046 4234 2028 504b 2c54 5f54 5a2c  to FB4 (PK,T_TZ,
+0001fb00: 5453 5f54 5a29 2076 616c 7565 7320 283f  TS_TZ) values (?
+0001fb10: 2c20 3f2c 203f 2922 2c20 2870 6b2c 2074  , ?, ?)", (pk, t
+0001fb20: 732e 7469 6d65 747a 2829 2c20 7473 2929  s.timetz(), ts))
+0001fb30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fb40: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
+0001fb50: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+0001fb60: 7572 2e65 7865 6375 7465 2827 7365 6c65  ur.execute('sele
+0001fb70: 6374 2050 4b2c 545f 545a 2c54 535f 545a  ct PK,T_TZ,TS_TZ
+0001fb80: 2066 726f 6d20 4642 3420 7768 6572 6520   from FB4 where 
+0001fb90: 504b 2062 6574 7765 656e 2031 2061 6e64  PK between 1 and
+0001fba0: 2033 206f 7264 6572 2062 7920 504b 2729   3 order by PK')
+0001fbb0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001fbc0: 2070 6b2c 2074 5f74 7a2c 2074 735f 747a   pk, t_tz, ts_tz
+0001fbd0: 2069 6e20 6375 723a 0a20 2020 2020 2020   in cur:.       
+0001fbe0: 2020 2020 2020 2020 2064 203d 2064 6174           d = dat
+0001fbf0: 615b 706b 5d0a 2020 2020 2020 2020 2020  a[pk].          
+0001fc00: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001fc10: 7449 7349 6e73 7461 6e63 6528 745f 747a  tIsInstance(t_tz
+0001fc20: 2c20 6461 7465 7469 6d65 2e74 696d 6529  , datetime.time)
+0001fc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fc40: 2073 656c 662e 6173 7365 7274 4973 4e6f   self.assertIsNo
+0001fc50: 744e 6f6e 6528 745f 747a 2e74 7a69 6e66  tNone(t_tz.tzinf
+0001fc60: 6f29 0a20 2020 2020 2020 2020 2020 2020  o).             
+0001fc70: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+0001fc80: 4e6f 744e 6f6e 6528 6765 7461 7474 7228  NotNone(getattr(
+0001fc90: 745f 747a 2e74 7a69 6e66 6f2c 2027 5f74  t_tz.tzinfo, '_t
+0001fca0: 696d 657a 6f6e 655f 2729 290a 2020 2020  imezone_')).    
+0001fcb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001fcc0: 2e61 7373 6572 7445 7175 616c 2874 5f74  .assertEqual(t_t
+0001fcd0: 7a2e 686f 7572 2c20 645b 335d 290a 2020  z.hour, d[3]).  
+0001fce0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001fcf0: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
+0001fd00: 5f74 7a2e 6d69 6e75 7465 2c20 645b 345d  _tz.minute, d[4]
+0001fd10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001fd20: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0001fd30: 616c 2874 5f74 7a2e 7365 636f 6e64 2c20  al(t_tz.second, 
+0001fd40: 645b 355d 290a 2020 2020 2020 2020 2020  d[5]).          
+0001fd50: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001fd60: 7445 7175 616c 2874 5f74 7a2e 6d69 6372  tEqual(t_tz.micr
+0001fd70: 6f73 6563 6f6e 642c 2064 5b36 5d29 0a20  osecond, d[6]). 
+0001fd80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001fd90: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0001fda0: 745f 747a 2e74 7a69 6e66 6f2e 5f74 696d  t_tz.tzinfo._tim
+0001fdb0: 657a 6f6e 655f 2c20 645b 375d 290a 2020  ezone_, d[7]).  
+0001fdc0: 2020 2020 2020 2020 2020 2020 2020 230a                #.
+0001fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fde0: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
+0001fdf0: 7461 6e63 6528 7473 5f74 7a2c 2064 6174  tance(ts_tz, dat
+0001fe00: 6574 696d 652e 6461 7465 7469 6d65 290a  etime.datetime).
+0001fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fe20: 7365 6c66 2e61 7373 6572 7449 734e 6f74  self.assertIsNot
+0001fe30: 4e6f 6e65 2874 735f 747a 2e74 7a69 6e66  None(ts_tz.tzinf
+0001fe40: 6f29 0a20 2020 2020 2020 2020 2020 2020  o).             
+0001fe50: 2020 2073 656c 662e 6173 7365 7274 4973     self.assertIs
+0001fe60: 4e6f 744e 6f6e 6528 6765 7461 7474 7228  NotNone(getattr(
+0001fe70: 7473 5f74 7a2e 747a 696e 666f 2c20 275f  ts_tz.tzinfo, '_
+0001fe80: 7469 6d65 7a6f 6e65 5f27 2929 0a20 2020  timezone_')).   
+0001fe90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001fea0: 662e 6173 7365 7274 4571 7561 6c28 7473  f.assertEqual(ts
+0001feb0: 5f74 7a2e 7965 6172 2c20 645b 305d 290a  _tz.year, d[0]).
+0001fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fed0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0001fee0: 2874 735f 747a 2e6d 6f6e 7468 2c20 645b  (ts_tz.month, d[
+0001fef0: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
+0001ff00: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+0001ff10: 7175 616c 2874 735f 747a 2e64 6179 2c20  qual(ts_tz.day, 
+0001ff20: 645b 325d 290a 2020 2020 2020 2020 2020  d[2]).          
+0001ff30: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0001ff40: 7445 7175 616c 2874 735f 747a 2e68 6f75  tEqual(ts_tz.hou
+0001ff50: 722c 2064 5b33 5d29 0a20 2020 2020 2020  r, d[3]).       
+0001ff60: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+0001ff70: 7365 7274 4571 7561 6c28 7473 5f74 7a2e  sertEqual(ts_tz.
+0001ff80: 6d69 6e75 7465 2c20 645b 345d 290a 2020  minute, d[4]).  
+0001ff90: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001ffa0: 6c66 2e61 7373 6572 7445 7175 616c 2874  lf.assertEqual(t
+0001ffb0: 735f 747a 2e73 6563 6f6e 642c 2064 5b35  s_tz.second, d[5
+0001ffc0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0001ffd0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0001ffe0: 7561 6c28 7473 5f74 7a2e 6d69 6372 6f73  ual(ts_tz.micros
+0001fff0: 6563 6f6e 642c 2064 5b36 5d29 0a20 2020  econd, d[6]).   
+00020000: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00020010: 662e 6173 7365 7274 4571 7561 6c28 7473  f.assertEqual(ts
+00020020: 5f74 7a2e 747a 696e 666f 2e5f 7469 6d65  _tz.tzinfo._time
+00020030: 7a6f 6e65 5f2c 2064 5b37 5d29 0a20 2020  zone_, d[7]).   
+00020040: 2064 6566 2074 6573 745f 3035 5f73 656c   def test_05_sel
+00020050: 6563 745f 6465 666c 6f61 7428 7365 6c66  ect_defloat(self
+00020060: 293a 0a20 2020 2020 2020 2064 6174 6120  ):.        data 
+00020070: 3d20 7b34 3a20 2864 6563 696d 616c 2e44  = {4: (decimal.D
+00020080: 6563 696d 616c 2827 3131 3131 3131 3131  ecimal('11111111
+00020090: 3131 3232 3232 3232 3232 3232 3333 3333  1122222222223333
+000200a0: 3333 3333 3333 3434 3434 2729 2c0a 2020  3333334444'),.  
+000200b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000200c0: 2020 6465 6369 6d61 6c2e 4465 6369 6d61    decimal.Decima
+000200d0: 6c28 2731 3131 3131 3131 3131 3132 3232  l('1111111111222
+000200e0: 3232 3227 292c 0a20 2020 2020 2020 2020  222'),.         
+000200f0: 2020 2020 2020 2020 2020 2064 6563 696d             decim
+00020100: 616c 2e44 6563 696d 616c 2827 3131 3131  al.Decimal('1111
+00020110: 3131 3131 3131 3232 3232 3232 3232 3232  1111112222222222
+00020120: 3333 3333 3333 3333 3333 3434 3434 2729  33333333334444')
+00020130: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00020140: 2020 207d 0a20 2020 2020 2020 2077 6974     }.        wit
+00020150: 6820 7365 6c66 2e63 6f6e 2e63 7572 736f  h self.con.curso
+00020160: 7228 2920 6173 2063 7572 3a0a 2020 2020  r() as cur:.    
+00020170: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
+00020180: 7574 6528 2269 6e73 6572 7420 696e 746f  ute("insert into
+00020190: 2046 4234 2028 504b 2c44 462c 4446 3136   FB4 (PK,DF,DF16
+000201a0: 2c44 4633 3429 2076 616c 7565 7320 2834  ,DF34) values (4
+000201b0: 2c20 3131 3131 3131 3131 3131 3232 3232  , 11111111112222
+000201c0: 3232 3232 3232 3333 3333 3333 3333 3333  2222223333333333
+000201d0: 3434 3434 2c20 3131 3131 3131 3131 3131  4444, 1111111111
+000201e0: 3232 3232 3232 2c20 3131 3131 3131 3131  222222, 11111111
+000201f0: 3131 3232 3232 3232 3232 3232 3333 3333  1122222222223333
+00020200: 3333 3333 3333 3434 3434 2922 290a 2020  3333334444)").  
+00020210: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+00020220: 6f6e 2e63 6f6d 6d69 7428 290a 2020 2020  on.commit().    
+00020230: 2020 2020 2020 2020 6375 722e 6578 6563          cur.exec
+00020240: 7574 6528 2773 656c 6563 7420 504b 2c44  ute('select PK,D
+00020250: 462c 4446 3136 2c44 4633 3420 6672 6f6d  F,DF16,DF34 from
+00020260: 2046 4234 2077 6865 7265 2050 4b20 3d20   FB4 where PK = 
+00020270: 3427 290a 2020 2020 2020 2020 2020 2020  4').            
+00020280: 666f 7220 706b 2c20 6466 2c20 6466 3136  for pk, df, df16
+00020290: 2c20 6466 3334 2069 6e20 6375 723a 0a20  , df34 in cur:. 
+000202a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000202b0: 203d 2064 6174 615b 706b 5d0a 2020 2020   = data[pk].    
+000202c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000202d0: 2e61 7373 6572 7449 7349 6e73 7461 6e63  .assertIsInstanc
+000202e0: 6528 6466 2c20 6465 6369 6d61 6c2e 4465  e(df, decimal.De
+000202f0: 6369 6d61 6c29 0a20 2020 2020 2020 2020  cimal).         
+00020300: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00020310: 7274 4571 7561 6c28 6466 2c20 645b 305d  rtEqual(df, d[0]
+00020320: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00020330: 2020 7365 6c66 2e61 7373 6572 7449 7349    self.assertIsI
+00020340: 6e73 7461 6e63 6528 6466 3136 2c20 6465  nstance(df16, de
+00020350: 6369 6d61 6c2e 4465 6369 6d61 6c29 0a20  cimal.Decimal). 
+00020360: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00020370: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00020380: 6466 3136 2c20 645b 315d 290a 2020 2020  df16, d[1]).    
+00020390: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000203a0: 2e61 7373 6572 7449 7349 6e73 7461 6e63  .assertIsInstanc
+000203b0: 6528 6466 3334 2c20 6465 6369 6d61 6c2e  e(df34, decimal.
+000203c0: 4465 6369 6d61 6c29 0a20 2020 2020 2020  Decimal).       
+000203d0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+000203e0: 7365 7274 4571 7561 6c28 6466 3334 2c20  sertEqual(df34, 
+000203f0: 645b 325d 290a 2020 2020 6465 6620 7465  d[2]).    def te
+00020400: 7374 5f30 365f 696e 7365 7274 5f64 6566  st_06_insert_def
+00020410: 6c6f 6174 2873 656c 6629 3a0a 2020 2020  loat(self):.    
+00020420: 2020 2020 6461 7461 203d 207b 343a 2028      data = {4: (
+00020430: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
+00020440: 2731 3131 3131 3131 3131 3132 3232 3232  '111111111122222
+00020450: 3232 3232 3233 3333 3333 3333 3333 3334  2222233333333334
+00020460: 3434 3427 292c 0a20 2020 2020 2020 2020  444'),.         
+00020470: 2020 2020 2020 2020 2020 2064 6563 696d             decim
+00020480: 616c 2e44 6563 696d 616c 2827 3131 3131  al.Decimal('1111
+00020490: 3131 3131 3131 3232 3232 3232 2729 2c0a  111111222222'),.
+000204a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000204b0: 2020 2020 6465 6369 6d61 6c2e 4465 6369      decimal.Deci
+000204c0: 6d61 6c28 2731 3131 3131 3131 3131 3132  mal('11111111112
+000204d0: 3232 3232 3232 3232 3233 3333 3333 3333  2222222223333333
+000204e0: 3333 3334 3434 3427 2929 2c0a 2020 2020  3334444')),.    
+000204f0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00020500: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
+00020510: 636f 6e2e 6375 7273 6f72 2829 2061 7320  con.cursor() as 
+00020520: 6375 723a 0a20 2020 2020 2020 2020 2020  cur:.           
+00020530: 2066 6f72 2070 6b2c 2064 2069 6e20 6461   for pk, d in da
+00020540: 7461 2e69 7465 6d73 2829 3a0a 2020 2020  ta.items():.    
+00020550: 2020 2020 2020 2020 2020 2020 6375 722e              cur.
+00020560: 6578 6563 7574 6528 2269 6e73 6572 7420  execute("insert 
+00020570: 696e 746f 2046 4234 2028 504b 2c44 462c  into FB4 (PK,DF,
+00020580: 4446 3136 2c44 4633 3429 2076 616c 7565  DF16,DF34) value
+00020590: 7320 283f 2c20 3f2c 203f 2c20 3f29 222c  s (?, ?, ?, ?)",
+000205a0: 2028 706b 2c20 645b 305d 2c20 645b 315d   (pk, d[0], d[1]
+000205b0: 2c20 645b 325d 2929 0a20 2020 2020 2020  , d[2])).       
+000205c0: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
+000205d0: 6e2e 636f 6d6d 6974 2829 0a20 2020 2020  n.commit().     
+000205e0: 2020 2020 2020 2063 7572 2e65 7865 6375         cur.execu
+000205f0: 7465 2827 7365 6c65 6374 2050 4b2c 4446  te('select PK,DF
+00020600: 2c44 4631 362c 4446 3334 2066 726f 6d20  ,DF16,DF34 from 
+00020610: 4642 3420 7768 6572 6520 504b 203d 2034  FB4 where PK = 4
+00020620: 2729 0a20 2020 2020 2020 2020 2020 2066  ').            f
+00020630: 6f72 2070 6b2c 2064 662c 2064 6631 362c  or pk, df, df16,
+00020640: 2064 6633 3420 696e 2063 7572 3a0a 2020   df34 in cur:.  
+00020650: 2020 2020 2020 2020 2020 2020 2020 6420                d 
+00020660: 3d20 6461 7461 5b70 6b5d 0a20 2020 2020  = data[pk].     
+00020670: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00020680: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
+00020690: 2864 662c 2064 6563 696d 616c 2e44 6563  (df, decimal.Dec
+000206a0: 696d 616c 290a 2020 2020 2020 2020 2020  imal).          
+000206b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000206c0: 7445 7175 616c 2864 662c 2064 5b30 5d29  tEqual(df, d[0])
 000206d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000206e0: 2037 3a20 2864 6563 696d 616c 2e44 6563   7: (decimal.Dec
-000206f0: 696d 616c 2827 3131 3131 3131 3131 3131  imal('1111111111
-00020700: 3232 3232 3232 3232 3232 3333 3333 3333  2222222222333333
-00020710: 3333 3333 2e34 3434 3435 3527 292c 6465  3333.444455'),de
-00020720: 6369 6d61 6c2e 4465 6369 6d61 6c28 2731  cimal.Decimal('1
-00020730: 3131 3131 3131 3131 3132 3232 3232 3232  1111111112222222
-00020740: 3232 3233 3333 3333 3333 3333 332e 3434  2223333333333.44
-00020750: 3434 3535 2729 292c 0a20 2020 2020 2020  4455')),.       
-00020760: 2020 2020 2020 2020 2038 3a20 2864 6563           8: (dec
-00020770: 696d 616c 2e44 6563 696d 616c 2827 3131  imal.Decimal('11
-00020780: 3131 3131 3131 3131 3232 3232 3232 3232  1111111122222222
-00020790: 3232 3333 3333 3333 3333 3333 2e34 3434  223333333333.444
-000207a0: 3435 3539 2729 2c64 6563 696d 616c 2e44  4559'),decimal.D
-000207b0: 6563 696d 616c 2827 3131 3131 3131 3131  ecimal('11111111
-000207c0: 3131 3232 3232 3232 3232 3232 3333 3333  1122222222223333
-000207d0: 3333 3333 3333 2e34 3434 3435 3627 2929  333333.444456'))
-000207e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000207f0: 2020 7d0a 2020 2020 2020 2020 7769 7468    }.        with
-00020800: 2073 656c 662e 636f 6e2e 6375 7273 6f72   self.con.cursor
-00020810: 2829 2061 7320 6375 723a 0a20 2020 2020  () as cur:.     
-00020820: 2020 2020 2020 2066 6f72 2070 6b2c 2064         for pk, d
-00020830: 2069 6e20 6461 7461 2e69 7465 6d73 2829   in data.items()
-00020840: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020850: 2020 6375 722e 6578 6563 7574 6528 2269    cur.execute("i
-00020860: 6e73 6572 7420 696e 746f 2046 4234 2028  nsert into FB4 (
-00020870: 504b 2c4e 3132 382c 4431 3238 2920 7661  PK,N128,D128) va
-00020880: 6c75 6573 2028 3f2c 203f 2c20 3f29 222c  lues (?, ?, ?)",
-00020890: 2028 706b 2c20 645b 305d 2c20 645b 305d   (pk, d[0], d[0]
-000208a0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-000208b0: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
-000208c0: 6974 2829 0a20 2020 2020 2020 2020 2020  it().           
-000208d0: 2063 7572 2e65 7865 6375 7465 2827 7365   cur.execute('se
-000208e0: 6c65 6374 2050 4b2c 4e31 3238 2c44 3132  lect PK,N128,D12
-000208f0: 3820 6672 6f6d 2046 4234 2077 6865 7265  8 from FB4 where
-00020900: 2050 4b20 6265 7477 6565 6e20 3520 616e   PK between 5 an
-00020910: 6420 3820 6f72 6465 7220 6279 2070 6b27  d 8 order by pk'
-00020920: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-00020930: 7220 706b 2c20 6e31 3238 2c20 6431 3238  r pk, n128, d128
-00020940: 2069 6e20 6375 723a 0a20 2020 2020 2020   in cur:.       
-00020950: 2020 2020 2020 2020 2064 203d 2064 6174           d = dat
-00020960: 615b 706b 5d0a 2020 2020 2020 2020 2020  a[pk].          
-00020970: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00020980: 7449 7349 6e73 7461 6e63 6528 6e31 3238  tIsInstance(n128
-00020990: 2c20 6465 6369 6d61 6c2e 4465 6369 6d61  , decimal.Decima
-000209a0: 6c29 0a20 2020 2020 2020 2020 2020 2020  l).             
-000209b0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000209c0: 7561 6c28 6e31 3238 2c20 645b 315d 290a  ual(n128, d[1]).
-000209d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000209e0: 7365 6c66 2e61 7373 6572 7449 7349 6e73  self.assertIsIns
-000209f0: 7461 6e63 6528 6431 3238 2c20 6465 6369  tance(d128, deci
-00020a00: 6d61 6c2e 4465 6369 6d61 6c29 0a20 2020  mal.Decimal).   
-00020a10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00020a20: 662e 6173 7365 7274 4571 7561 6c28 6431  f.assertEqual(d1
-00020a30: 3238 2c20 645b 315d 290a 0a63 6c61 7373  28, d[1])..class
-00020a40: 2054 6573 7449 7373 7565 7328 4472 6976   TestIssues(Driv
-00020a50: 6572 5465 7374 4261 7365 293a 0a20 2020  erTestBase):.   
-00020a60: 2064 6566 2073 6574 5570 2873 656c 6629   def setUp(self)
-00020a70: 3a0a 2020 2020 2020 2020 7375 7065 7228  :.        super(
-00020a80: 292e 7365 7455 7028 290a 2020 2020 2020  ).setUp().      
-00020a90: 2020 7365 6c66 2e64 6266 696c 6520 3d20    self.dbfile = 
-00020aa0: 6f73 2e70 6174 682e 6a6f 696e 2873 656c  os.path.join(sel
-00020ab0: 662e 6462 7061 7468 2c20 7365 6c66 2e46  f.dbpath, self.F
-00020ac0: 4254 4553 545f 4442 290a 2020 2020 2020  BTEST_DB).      
-00020ad0: 2020 7365 6c66 2e63 6f6e 203d 2063 6f6e    self.con = con
-00020ae0: 6e65 6374 2873 656c 662e 6462 6669 6c65  nect(self.dbfile
-00020af0: 2c20 7573 6572 3d46 4254 4553 545f 5553  , user=FBTEST_US
-00020b00: 4552 2c20 7061 7373 776f 7264 3d46 4254  ER, password=FBT
-00020b10: 4553 545f 5041 5353 574f 5244 290a 2020  EST_PASSWORD).  
-00020b20: 2020 2020 2020 7365 6c66 2e63 6f6e 2e5f        self.con._
-00020b30: 6c6f 6767 696e 675f 6964 5f20 3d20 7365  logging_id_ = se
-00020b40: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-00020b50: 616d 655f 5f0a 2020 2020 2020 2020 7365  ame__.        se
-00020b60: 6c66 2e63 6f6e 3220 3d20 636f 6e6e 6563  lf.con2 = connec
-00020b70: 7428 7365 6c66 2e64 6266 696c 652c 2075  t(self.dbfile, u
-00020b80: 7365 723d 4642 5445 5354 5f55 5345 522c  ser=FBTEST_USER,
-00020b90: 2070 6173 7377 6f72 643d 4642 5445 5354   password=FBTEST
-00020ba0: 5f50 4153 5357 4f52 442c 2063 6861 7273  _PASSWORD, chars
-00020bb0: 6574 3d27 7574 662d 3827 290a 2020 2020  et='utf-8').    
-00020bc0: 2020 2020 7365 6c66 2e63 6f6e 322e 5f6c      self.con2._l
-00020bd0: 6f67 6769 6e67 5f69 645f 203d 2073 656c  ogging_id_ = sel
-00020be0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
-00020bf0: 6d65 5f5f 0a20 2020 2020 2020 2023 7365  me__.        #se
-00020c00: 6c66 2e63 6f6e 2e65 7865 6375 7465 5f69  lf.con.execute_i
-00020c10: 6d6d 6564 6961 7465 2822 7265 6372 6561  mmediate("recrea
-00020c20: 7465 2074 6162 6c65 2074 2028 6331 2069  te table t (c1 i
-00020c30: 6e74 6567 6572 2922 290a 2020 2020 2020  nteger)").      
-00020c40: 2020 2373 656c 662e 636f 6e2e 636f 6d6d    #self.con.comm
-00020c50: 6974 2829 0a20 2020 2020 2020 2023 7365  it().        #se
-00020c60: 6c66 2e63 6f6e 2e65 7865 6375 7465 5f69  lf.con.execute_i
-00020c70: 6d6d 6564 6961 7465 2822 5245 4352 4541  mmediate("RECREA
-00020c80: 5445 2054 4142 4c45 2054 3220 2843 3120  TE TABLE T2 (C1 
-00020c90: 536d 616c 6c69 6e74 2c43 3220 496e 7465  Smallint,C2 Inte
-00020ca0: 6765 722c 4333 2042 6967 696e 742c 4334  ger,C3 Bigint,C4
-00020cb0: 2043 6861 7228 3529 2c43 3520 5661 7263   Char(5),C5 Varc
-00020cc0: 6861 7228 3130 292c 4336 2044 6174 652c  har(10),C6 Date,
-00020cd0: 4337 2054 696d 652c 4338 2054 696d 6573  C7 Time,C8 Times
-00020ce0: 7461 6d70 2c43 3920 426c 6f62 2073 7562  tamp,C9 Blob sub
-00020cf0: 5f74 7970 6520 312c 4331 3020 4e75 6d65  _type 1,C10 Nume
-00020d00: 7269 6328 3138 2c32 292c 4331 3120 4465  ric(18,2),C11 De
-00020d10: 6369 6d61 6c28 3138 2c32 292c 4331 3220  cimal(18,2),C12 
-00020d20: 466c 6f61 742c 4331 3320 446f 7562 6c65  Float,C13 Double
-00020d30: 2070 7265 6369 7369 6f6e 2c43 3134 204e   precision,C14 N
-00020d40: 756d 6572 6963 2838 2c34 292c 4331 3520  umeric(8,4),C15 
-00020d50: 4465 6369 6d61 6c28 382c 3429 2922 290a  Decimal(8,4))").
-00020d60: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
-00020d70: 2e65 7865 6375 7465 5f69 6d6d 6564 6961  .execute_immedia
-00020d80: 7465 2822 6465 6c65 7465 2066 726f 6d20  te("delete from 
-00020d90: 7422 290a 2020 2020 2020 2020 7365 6c66  t").        self
-00020da0: 2e63 6f6e 2e65 7865 6375 7465 5f69 6d6d  .con.execute_imm
-00020db0: 6564 6961 7465 2822 6465 6c65 7465 2066  ediate("delete f
-00020dc0: 726f 6d20 7432 2229 0a20 2020 2020 2020  rom t2").       
-00020dd0: 2073 656c 662e 636f 6e2e 636f 6d6d 6974   self.con.commit
-00020de0: 2829 0a20 2020 2064 6566 2074 6561 7244  ().    def tearD
-00020df0: 6f77 6e28 7365 6c66 293a 0a20 2020 2020  own(self):.     
-00020e00: 2020 2073 656c 662e 636f 6e32 2e63 6c6f     self.con2.clo
-00020e10: 7365 2829 0a20 2020 2020 2020 2073 656c  se().        sel
-00020e20: 662e 636f 6e2e 636c 6f73 6528 290a 2020  f.con.close().  
-00020e30: 2020 6465 6620 7465 7374 5f69 7373 7565    def test_issue
-00020e40: 5f30 3228 7365 6c66 293a 0a20 2020 2020  _02(self):.     
-00020e50: 2020 2077 6974 6820 7365 6c66 2e63 6f6e     with self.con
-00020e60: 2e63 7572 736f 7228 2920 6173 2063 7572  .cursor() as cur
-00020e70: 3a0a 2020 2020 2020 2020 2020 2020 6375  :.            cu
-00020e80: 722e 6578 6563 7574 6528 2769 6e73 6572  r.execute('inser
-00020e90: 7420 696e 746f 2054 3220 2843 312c 4332  t into T2 (C1,C2
-00020ea0: 2c43 3329 2076 616c 7565 7320 283f 2c3f  ,C3) values (?,?
-00020eb0: 2c3f 2927 2c20 5b31 2c20 4e6f 6e65 2c20  ,?)', [1, None, 
-00020ec0: 315d 290a 2020 2020 2020 2020 2020 2020  1]).            
-00020ed0: 7365 6c66 2e63 6f6e 2e63 6f6d 6d69 7428  self.con.commit(
-00020ee0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
-00020ef0: 722e 6578 6563 7574 6528 2773 656c 6563  r.execute('selec
-00020f00: 7420 4331 2c43 322c 4333 2066 726f 6d20  t C1,C2,C3 from 
-00020f10: 5432 2077 6865 7265 2043 3120 3d20 3127  T2 where C1 = 1'
-00020f20: 290a 2020 2020 2020 2020 2020 2020 726f  ).            ro
-00020f30: 7773 203d 2063 7572 2e66 6574 6368 616c  ws = cur.fetchal
-00020f40: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
-00020f50: 7365 6c66 2e61 7373 6572 744c 6973 7445  self.assertListE
-00020f60: 7175 616c 2872 6f77 732c 205b 2831 2c20  qual(rows, [(1, 
-00020f70: 4e6f 6e65 2c20 3129 5d29 0a0a 6966 205f  None, 1)])..if _
-00020f80: 5f6e 616d 655f 5f20 3d3d 2027 5f5f 6d61  _name__ == '__ma
-00020f90: 696e 5f5f 273a 0a20 2020 2075 6e69 7474  in__':.    unitt
-00020fa0: 6573 742e 6d61 696e 2829 0a0a            est.main()..
+000206e0: 2073 656c 662e 6173 7365 7274 4973 496e   self.assertIsIn
+000206f0: 7374 616e 6365 2864 6631 362c 2064 6563  stance(df16, dec
+00020700: 696d 616c 2e44 6563 696d 616c 290a 2020  imal.Decimal).  
+00020710: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00020720: 6c66 2e61 7373 6572 7445 7175 616c 2864  lf.assertEqual(d
+00020730: 6631 362c 2064 5b31 5d29 0a20 2020 2020  f16, d[1]).     
+00020740: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00020750: 6173 7365 7274 4973 496e 7374 616e 6365  assertIsInstance
+00020760: 2864 6633 342c 2064 6563 696d 616c 2e44  (df34, decimal.D
+00020770: 6563 696d 616c 290a 2020 2020 2020 2020  ecimal).        
+00020780: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00020790: 6572 7445 7175 616c 2864 6633 342c 2064  ertEqual(df34, d
+000207a0: 5b32 5d29 0a20 2020 2064 6566 2074 6573  [2]).    def tes
+000207b0: 745f 3037 5f73 656c 6563 745f 696e 7431  t_07_select_int1
+000207c0: 3238 2873 656c 6629 3a0a 2020 2020 2020  28(self):.      
+000207d0: 2020 6461 7461 203d 207b 353a 2064 6563    data = {5: dec
+000207e0: 696d 616c 2e44 6563 696d 616c 2827 3131  imal.Decimal('11
+000207f0: 3131 3131 3131 3131 3232 3232 3232 3232  1111111122222222
+00020800: 3232 3333 3333 3333 3333 2e33 3334 3434  2233333333.33444
+00020810: 3427 292c 0a20 2020 2020 2020 2020 2020  4'),.           
+00020820: 2020 2020 2036 3a20 6465 6369 6d61 6c2e       6: decimal.
+00020830: 4465 6369 6d61 6c28 2731 3131 3131 3131  Decimal('1111111
+00020840: 3131 3132 3232 3232 3232 3232 3233 3333  1112222222222333
+00020850: 3333 3333 3333 332e 3434 3434 2729 2c0a  3333333.4444'),.
+00020860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020870: 373a 2064 6563 696d 616c 2e44 6563 696d  7: decimal.Decim
+00020880: 616c 2827 3131 3131 3131 3131 3131 3232  al('111111111122
+00020890: 3232 3232 3232 3232 3333 3333 3333 3333  2222222233333333
+000208a0: 3333 2e34 3434 3435 3527 292c 0a20 2020  33.444455'),.   
+000208b0: 2020 2020 2020 2020 2020 2020 2038 3a20               8: 
+000208c0: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
+000208d0: 2731 3131 3131 3131 3131 3132 3232 3232  '111111111122222
+000208e0: 3232 3232 3233 3333 3333 3333 3333 332e  222223333333333.
+000208f0: 3434 3434 3536 2729 2c0a 2020 2020 2020  444456'),.      
+00020900: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
+00020910: 2020 2020 7769 7468 2073 656c 662e 636f      with self.co
+00020920: 6e2e 6375 7273 6f72 2829 2061 7320 6375  n.cursor() as cu
+00020930: 723a 0a20 2020 2020 2020 2020 2020 2063  r:.            c
+00020940: 7572 2e65 7865 6375 7465 2822 696e 7365  ur.execute("inse
+00020950: 7274 2069 6e74 6f20 4642 3420 2850 4b2c  rt into FB4 (PK,
+00020960: 4e31 3238 2c44 3132 3829 2076 616c 7565  N128,D128) value
+00020970: 7320 2835 2c20 3131 3131 3131 3131 3131  s (5, 1111111111
+00020980: 3232 3232 3232 3232 3232 3333 3333 3333  2222222222333333
+00020990: 3333 2e33 3334 3434 342c 2031 3131 3131  33.334444, 11111
+000209a0: 3131 3131 3132 3232 3232 3232 3232 3233  1111122222222223
+000209b0: 3333 3333 3333 332e 3333 3434 3434 2922  3333333.334444)"
+000209c0: 290a 2020 2020 2020 2020 2020 2020 6375  ).            cu
+000209d0: 722e 6578 6563 7574 6528 2269 6e73 6572  r.execute("inser
+000209e0: 7420 696e 746f 2046 4234 2028 504b 2c4e  t into FB4 (PK,N
+000209f0: 3132 382c 4431 3238 2920 7661 6c75 6573  128,D128) values
+00020a00: 2028 362c 2031 3131 3131 3131 3131 3132   (6, 11111111112
+00020a10: 3232 3232 3232 3232 3233 3333 3333 3333  2222222223333333
+00020a20: 3333 332e 3434 3434 2c20 3131 3131 3131  333.4444, 111111
+00020a30: 3131 3131 3232 3232 3232 3232 3232 3333  1111222222222233
+00020a40: 3333 3333 3333 3333 2e34 3434 3429 2229  33333333.4444)")
+00020a50: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
+00020a60: 2e65 7865 6375 7465 2822 696e 7365 7274  .execute("insert
+00020a70: 2069 6e74 6f20 4642 3420 2850 4b2c 4e31   into FB4 (PK,N1
+00020a80: 3238 2c44 3132 3829 2076 616c 7565 7320  28,D128) values 
+00020a90: 2837 2c20 3131 3131 3131 3131 3131 3232  (7, 111111111122
+00020aa0: 3232 3232 3232 3232 3333 3333 3333 3333  2222222233333333
+00020ab0: 3333 2e34 3434 3435 352c 2031 3131 3131  33.444455, 11111
+00020ac0: 3131 3131 3132 3232 3232 3232 3232 3233  1111122222222223
+00020ad0: 3333 3333 3333 3333 332e 3434 3434 3535  333333333.444455
+00020ae0: 2922 290a 2020 2020 2020 2020 2020 2020  )").            
+00020af0: 6375 722e 6578 6563 7574 6528 2269 6e73  cur.execute("ins
+00020b00: 6572 7420 696e 746f 2046 4234 2028 504b  ert into FB4 (PK
+00020b10: 2c4e 3132 382c 4431 3238 2920 7661 6c75  ,N128,D128) valu
+00020b20: 6573 2028 382c 2031 3131 3131 3131 3131  es (8, 111111111
+00020b30: 3132 3232 3232 3232 3232 3233 3333 3333  1222222222233333
+00020b40: 3333 3333 332e 3434 3434 3535 392c 2031  33333.4444559, 1
+00020b50: 3131 3131 3131 3131 3132 3232 3232 3232  1111111112222222
+00020b60: 3232 3233 3333 3333 3333 3333 332e 3434  2223333333333.44
+00020b70: 3434 3535 3929 2229 0a20 2020 2020 2020  44559)").       
+00020b80: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
+00020b90: 6d6d 6974 2829 0a20 2020 2020 2020 2020  mmit().         
+00020ba0: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
+00020bb0: 7365 6c65 6374 2050 4b2c 4e31 3238 2c44  select PK,N128,D
+00020bc0: 3132 3820 6672 6f6d 2046 4234 2077 6865  128 from FB4 whe
+00020bd0: 7265 2050 4b20 6265 7477 6565 6e20 3520  re PK between 5 
+00020be0: 616e 6420 3820 6f72 6465 7220 6279 2070  and 8 order by p
+00020bf0: 6b27 290a 2020 2020 2020 2020 2020 2020  k').            
+00020c00: 666f 7220 706b 2c20 6e31 3238 2c20 6431  for pk, n128, d1
+00020c10: 3238 2069 6e20 6375 723a 0a20 2020 2020  28 in cur:.     
+00020c20: 2020 2020 2020 2020 2020 2064 203d 2064             d = d
+00020c30: 6174 615b 706b 5d0a 2020 2020 2020 2020  ata[pk].        
+00020c40: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00020c50: 6572 7449 7349 6e73 7461 6e63 6528 6e31  ertIsInstance(n1
+00020c60: 3238 2c20 6465 6369 6d61 6c2e 4465 6369  28, decimal.Deci
+00020c70: 6d61 6c29 0a20 2020 2020 2020 2020 2020  mal).           
+00020c80: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00020c90: 4571 7561 6c28 6e31 3238 2c20 6429 0a20  Equal(n128, d). 
+00020ca0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00020cb0: 656c 662e 6173 7365 7274 4973 496e 7374  elf.assertIsInst
+00020cc0: 616e 6365 2864 3132 382c 2064 6563 696d  ance(d128, decim
+00020cd0: 616c 2e44 6563 696d 616c 290a 2020 2020  al.Decimal).    
+00020ce0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00020cf0: 2e61 7373 6572 7445 7175 616c 2864 3132  .assertEqual(d12
+00020d00: 382c 2064 290a 2020 2020 6465 6620 7465  8, d).    def te
+00020d10: 7374 5f30 385f 7365 6c65 6374 5f69 6e74  st_08_select_int
+00020d20: 3132 3828 7365 6c66 293a 0a20 2020 2020  128(self):.     
+00020d30: 2020 2064 6174 6120 3d20 7b35 3a20 2864     data = {5: (d
+00020d40: 6563 696d 616c 2e44 6563 696d 616c 2827  ecimal.Decimal('
+00020d50: 3131 3131 3131 3131 3131 3232 3232 3232  1111111111222222
+00020d60: 3232 3232 3333 3333 3333 3333 2e33 3334  222233333333.334
+00020d70: 3434 3427 292c 6465 6369 6d61 6c2e 4465  444'),decimal.De
+00020d80: 6369 6d61 6c28 2731 3131 3131 3131 3131  cimal('111111111
+00020d90: 3132 3232 3232 3232 3232 3233 3333 3333  1222222222233333
+00020da0: 3333 332e 3333 3434 3434 2729 292c 0a20  333.334444')),. 
+00020db0: 2020 2020 2020 2020 2020 2020 2020 2036                 6
+00020dc0: 3a20 2864 6563 696d 616c 2e44 6563 696d  : (decimal.Decim
+00020dd0: 616c 2827 3131 3131 3131 3131 3131 3232  al('111111111122
+00020de0: 3232 3232 3232 3232 3333 3333 3333 3333  2222222233333333
+00020df0: 3333 2e34 3434 3427 292c 6465 6369 6d61  33.4444'),decima
+00020e00: 6c2e 4465 6369 6d61 6c28 2731 3131 3131  l.Decimal('11111
+00020e10: 3131 3131 3132 3232 3232 3232 3232 3233  1111122222222223
+00020e20: 3333 3333 3333 3333 332e 3434 3434 2729  333333333.4444')
+00020e30: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00020e40: 2020 2037 3a20 2864 6563 696d 616c 2e44     7: (decimal.D
+00020e50: 6563 696d 616c 2827 3131 3131 3131 3131  ecimal('11111111
+00020e60: 3131 3232 3232 3232 3232 3232 3333 3333  1122222222223333
+00020e70: 3333 3333 3333 2e34 3434 3435 3527 292c  333333.444455'),
+00020e80: 6465 6369 6d61 6c2e 4465 6369 6d61 6c28  decimal.Decimal(
+00020e90: 2731 3131 3131 3131 3131 3132 3232 3232  '111111111122222
+00020ea0: 3232 3232 3233 3333 3333 3333 3333 332e  222223333333333.
+00020eb0: 3434 3434 3535 2729 292c 0a20 2020 2020  444455')),.     
+00020ec0: 2020 2020 2020 2020 2020 2038 3a20 2864             8: (d
+00020ed0: 6563 696d 616c 2e44 6563 696d 616c 2827  ecimal.Decimal('
+00020ee0: 3131 3131 3131 3131 3131 3232 3232 3232  1111111111222222
+00020ef0: 3232 3232 3333 3333 3333 3333 3333 2e34  22223333333333.4
+00020f00: 3434 3435 3539 2729 2c64 6563 696d 616c  444559'),decimal
+00020f10: 2e44 6563 696d 616c 2827 3131 3131 3131  .Decimal('111111
+00020f20: 3131 3131 3232 3232 3232 3232 3232 3333  1111222222222233
+00020f30: 3333 3333 3333 3333 2e34 3434 3435 3627  33333333.444456'
+00020f40: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
+00020f50: 2020 2020 7d0a 2020 2020 2020 2020 7769      }.        wi
+00020f60: 7468 2073 656c 662e 636f 6e2e 6375 7273  th self.con.curs
+00020f70: 6f72 2829 2061 7320 6375 723a 0a20 2020  or() as cur:.   
+00020f80: 2020 2020 2020 2020 2066 6f72 2070 6b2c           for pk,
+00020f90: 2064 2069 6e20 6461 7461 2e69 7465 6d73   d in data.items
+00020fa0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00020fb0: 2020 2020 6375 722e 6578 6563 7574 6528      cur.execute(
+00020fc0: 2269 6e73 6572 7420 696e 746f 2046 4234  "insert into FB4
+00020fd0: 2028 504b 2c4e 3132 382c 4431 3238 2920   (PK,N128,D128) 
+00020fe0: 7661 6c75 6573 2028 3f2c 203f 2c20 3f29  values (?, ?, ?)
+00020ff0: 222c 2028 706b 2c20 645b 305d 2c20 645b  ", (pk, d[0], d[
+00021000: 305d 2929 0a20 2020 2020 2020 2020 2020  0])).           
+00021010: 2020 2020 2073 656c 662e 636f 6e2e 636f       self.con.co
+00021020: 6d6d 6974 2829 0a20 2020 2020 2020 2020  mmit().         
+00021030: 2020 2063 7572 2e65 7865 6375 7465 2827     cur.execute('
+00021040: 7365 6c65 6374 2050 4b2c 4e31 3238 2c44  select PK,N128,D
+00021050: 3132 3820 6672 6f6d 2046 4234 2077 6865  128 from FB4 whe
+00021060: 7265 2050 4b20 6265 7477 6565 6e20 3520  re PK between 5 
+00021070: 616e 6420 3820 6f72 6465 7220 6279 2070  and 8 order by p
+00021080: 6b27 290a 2020 2020 2020 2020 2020 2020  k').            
+00021090: 666f 7220 706b 2c20 6e31 3238 2c20 6431  for pk, n128, d1
+000210a0: 3238 2069 6e20 6375 723a 0a20 2020 2020  28 in cur:.     
+000210b0: 2020 2020 2020 2020 2020 2064 203d 2064             d = d
+000210c0: 6174 615b 706b 5d0a 2020 2020 2020 2020  ata[pk].        
+000210d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+000210e0: 6572 7449 7349 6e73 7461 6e63 6528 6e31  ertIsInstance(n1
+000210f0: 3238 2c20 6465 6369 6d61 6c2e 4465 6369  28, decimal.Deci
+00021100: 6d61 6c29 0a20 2020 2020 2020 2020 2020  mal).           
+00021110: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00021120: 4571 7561 6c28 6e31 3238 2c20 645b 315d  Equal(n128, d[1]
+00021130: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00021140: 2020 7365 6c66 2e61 7373 6572 7449 7349    self.assertIsI
+00021150: 6e73 7461 6e63 6528 6431 3238 2c20 6465  nstance(d128, de
+00021160: 6369 6d61 6c2e 4465 6369 6d61 6c29 0a20  cimal.Decimal). 
+00021170: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00021180: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00021190: 6431 3238 2c20 645b 315d 290a 0a63 6c61  d128, d[1])..cla
+000211a0: 7373 2054 6573 7449 7373 7565 7328 4472  ss TestIssues(Dr
+000211b0: 6976 6572 5465 7374 4261 7365 293a 0a20  iverTestBase):. 
+000211c0: 2020 2064 6566 2073 6574 5570 2873 656c     def setUp(sel
+000211d0: 6629 3a0a 2020 2020 2020 2020 7375 7065  f):.        supe
+000211e0: 7228 292e 7365 7455 7028 290a 2020 2020  r().setUp().    
+000211f0: 2020 2020 7365 6c66 2e64 6266 696c 6520      self.dbfile 
+00021200: 3d20 6f73 2e70 6174 682e 6a6f 696e 2873  = os.path.join(s
+00021210: 656c 662e 6462 7061 7468 2c20 7365 6c66  elf.dbpath, self
+00021220: 2e46 4254 4553 545f 4442 290a 2020 2020  .FBTEST_DB).    
+00021230: 2020 2020 7365 6c66 2e63 6f6e 203d 2063      self.con = c
+00021240: 6f6e 6e65 6374 2873 656c 662e 6462 6669  onnect(self.dbfi
+00021250: 6c65 2c20 7573 6572 3d46 4254 4553 545f  le, user=FBTEST_
+00021260: 5553 4552 2c20 7061 7373 776f 7264 3d46  USER, password=F
+00021270: 4254 4553 545f 5041 5353 574f 5244 290a  BTEST_PASSWORD).
+00021280: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+00021290: 2e5f 6c6f 6767 696e 675f 6964 5f20 3d20  ._logging_id_ = 
+000212a0: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
+000212b0: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
+000212c0: 7365 6c66 2e63 6f6e 3220 3d20 636f 6e6e  self.con2 = conn
+000212d0: 6563 7428 7365 6c66 2e64 6266 696c 652c  ect(self.dbfile,
+000212e0: 2075 7365 723d 4642 5445 5354 5f55 5345   user=FBTEST_USE
+000212f0: 522c 2070 6173 7377 6f72 643d 4642 5445  R, password=FBTE
+00021300: 5354 5f50 4153 5357 4f52 442c 2063 6861  ST_PASSWORD, cha
+00021310: 7273 6574 3d27 7574 662d 3827 290a 2020  rset='utf-8').  
+00021320: 2020 2020 2020 7365 6c66 2e63 6f6e 322e        self.con2.
+00021330: 5f6c 6f67 6769 6e67 5f69 645f 203d 2073  _logging_id_ = s
+00021340: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+00021350: 6e61 6d65 5f5f 0a20 2020 2020 2020 2023  name__.        #
+00021360: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
+00021370: 5f69 6d6d 6564 6961 7465 2822 7265 6372  _immediate("recr
+00021380: 6561 7465 2074 6162 6c65 2074 2028 6331  eate table t (c1
+00021390: 2069 6e74 6567 6572 2922 290a 2020 2020   integer)").    
+000213a0: 2020 2020 2373 656c 662e 636f 6e2e 636f      #self.con.co
+000213b0: 6d6d 6974 2829 0a20 2020 2020 2020 2023  mmit().        #
+000213c0: 7365 6c66 2e63 6f6e 2e65 7865 6375 7465  self.con.execute
+000213d0: 5f69 6d6d 6564 6961 7465 2822 5245 4352  _immediate("RECR
+000213e0: 4541 5445 2054 4142 4c45 2054 3220 2843  EATE TABLE T2 (C
+000213f0: 3120 536d 616c 6c69 6e74 2c43 3220 496e  1 Smallint,C2 In
+00021400: 7465 6765 722c 4333 2042 6967 696e 742c  teger,C3 Bigint,
+00021410: 4334 2043 6861 7228 3529 2c43 3520 5661  C4 Char(5),C5 Va
+00021420: 7263 6861 7228 3130 292c 4336 2044 6174  rchar(10),C6 Dat
+00021430: 652c 4337 2054 696d 652c 4338 2054 696d  e,C7 Time,C8 Tim
+00021440: 6573 7461 6d70 2c43 3920 426c 6f62 2073  estamp,C9 Blob s
+00021450: 7562 5f74 7970 6520 312c 4331 3020 4e75  ub_type 1,C10 Nu
+00021460: 6d65 7269 6328 3138 2c32 292c 4331 3120  meric(18,2),C11 
+00021470: 4465 6369 6d61 6c28 3138 2c32 292c 4331  Decimal(18,2),C1
+00021480: 3220 466c 6f61 742c 4331 3320 446f 7562  2 Float,C13 Doub
+00021490: 6c65 2070 7265 6369 7369 6f6e 2c43 3134  le precision,C14
+000214a0: 204e 756d 6572 6963 2838 2c34 292c 4331   Numeric(8,4),C1
+000214b0: 3520 4465 6369 6d61 6c28 382c 3429 2922  5 Decimal(8,4))"
+000214c0: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
+000214d0: 6f6e 2e65 7865 6375 7465 5f69 6d6d 6564  on.execute_immed
+000214e0: 6961 7465 2822 6465 6c65 7465 2066 726f  iate("delete fro
+000214f0: 6d20 7422 290a 2020 2020 2020 2020 7365  m t").        se
+00021500: 6c66 2e63 6f6e 2e65 7865 6375 7465 5f69  lf.con.execute_i
+00021510: 6d6d 6564 6961 7465 2822 6465 6c65 7465  mmediate("delete
+00021520: 2066 726f 6d20 7432 2229 0a20 2020 2020   from t2").     
+00021530: 2020 2073 656c 662e 636f 6e2e 636f 6d6d     self.con.comm
+00021540: 6974 2829 0a20 2020 2064 6566 2074 6561  it().    def tea
+00021550: 7244 6f77 6e28 7365 6c66 293a 0a20 2020  rDown(self):.   
+00021560: 2020 2020 2073 656c 662e 636f 6e32 2e63       self.con2.c
+00021570: 6c6f 7365 2829 0a20 2020 2020 2020 2073  lose().        s
+00021580: 656c 662e 636f 6e2e 636c 6f73 6528 290a  elf.con.close().
+00021590: 2020 2020 6465 6620 7465 7374 5f69 7373      def test_iss
+000215a0: 7565 5f30 3228 7365 6c66 293a 0a20 2020  ue_02(self):.   
+000215b0: 2020 2020 2077 6974 6820 7365 6c66 2e63       with self.c
+000215c0: 6f6e 2e63 7572 736f 7228 2920 6173 2063  on.cursor() as c
+000215d0: 7572 3a0a 2020 2020 2020 2020 2020 2020  ur:.            
+000215e0: 6375 722e 6578 6563 7574 6528 2769 6e73  cur.execute('ins
+000215f0: 6572 7420 696e 746f 2054 3220 2843 312c  ert into T2 (C1,
+00021600: 4332 2c43 3329 2076 616c 7565 7320 283f  C2,C3) values (?
+00021610: 2c3f 2c3f 2927 2c20 5b31 2c20 4e6f 6e65  ,?,?)', [1, None
+00021620: 2c20 315d 290a 2020 2020 2020 2020 2020  , 1]).          
+00021630: 2020 7365 6c66 2e63 6f6e 2e63 6f6d 6d69    self.con.commi
+00021640: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+00021650: 6375 722e 6578 6563 7574 6528 2773 656c  cur.execute('sel
+00021660: 6563 7420 4331 2c43 322c 4333 2066 726f  ect C1,C2,C3 fro
+00021670: 6d20 5432 2077 6865 7265 2043 3120 3d20  m T2 where C1 = 
+00021680: 3127 290a 2020 2020 2020 2020 2020 2020  1').            
+00021690: 726f 7773 203d 2063 7572 2e66 6574 6368  rows = cur.fetch
+000216a0: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
+000216b0: 2020 7365 6c66 2e61 7373 6572 744c 6973    self.assertLis
+000216c0: 7445 7175 616c 2872 6f77 732c 205b 2831  tEqual(rows, [(1
+000216d0: 2c20 4e6f 6e65 2c20 3129 5d29 0a0a 6966  , None, 1)])..if
+000216e0: 205f 5f6e 616d 655f 5f20 3d3d 2027 5f5f   __name__ == '__
+000216f0: 6d61 696e 5f5f 273a 0a20 2020 2075 6e69  main__':.    uni
+00021700: 7474 6573 742e 6d61 696e 2829 0a0a       ttest.main()..
```

