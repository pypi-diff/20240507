# Comparing `tmp/lumigo_tracer-1.1.98-py3-none-any.whl.zip` & `tmp/lumigo_tracer-1.1.99-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,25 +1,25 @@
-Zip file size: 45861 bytes, number of entries: 23
--rw-r--r--  2.0 unx        7 b- defN 20-Jul-14 07:36 lumigo_tracer/VERSION
--rw-r--r--  2.0 unx      182 b- defN 20-Jul-14 07:36 lumigo_tracer/__init__.py
--rw-r--r--  2.0 unx    14000 b- defN 20-Jul-14 07:36 lumigo_tracer/spans_container.py
--rw-r--r--  2.0 unx     2240 b- defN 20-Jul-14 07:36 lumigo_tracer/user_utils.py
--rw-r--r--  2.0 unx    14483 b- defN 20-Jul-14 07:36 lumigo_tracer/utils.py
--rw-r--r--  2.0 unx        0 b- defN 20-Jul-14 07:36 lumigo_tracer/auto_tag/__init__.py
--rw-r--r--  2.0 unx     2011 b- defN 20-Jul-14 07:36 lumigo_tracer/auto_tag/auto_tag_event.py
--rw-r--r--  2.0 unx       84 b- defN 20-Jul-14 07:36 lumigo_tracer/libs/__init__.py
--rw-r--r--  2.0 unx    34961 b- defN 20-Jul-14 07:36 lumigo_tracer/libs/wrapt.py
--rw-r--r--  2.0 unx    18270 b- defN 20-Jul-14 07:36 lumigo_tracer/libs/xmltodict.py
--rw-r--r--  2.0 unx        0 b- defN 20-Jul-14 07:36 lumigo_tracer/parsers/__init__.py
--rw-r--r--  2.0 unx     4743 b- defN 20-Jul-14 07:36 lumigo_tracer/parsers/event_parser.py
--rw-r--r--  2.0 unx      558 b- defN 20-Jul-14 07:36 lumigo_tracer/parsers/http_data_classes.py
--rw-r--r--  2.0 unx    10449 b- defN 20-Jul-14 07:36 lumigo_tracer/parsers/parser.py
--rw-r--r--  2.0 unx    11609 b- defN 20-Jul-14 07:36 lumigo_tracer/parsers/utils.py
--rw-r--r--  2.0 unx        0 b- defN 20-Jul-14 07:36 lumigo_tracer/sync_http/__init__.py
--rw-r--r--  2.0 unx     1026 b- defN 20-Jul-14 07:36 lumigo_tracer/sync_http/handler.py
--rw-r--r--  2.0 unx    12070 b- defN 20-Jul-14 07:36 lumigo_tracer/sync_http/sync_hook.py
--rw-r--r--  2.0 unx    11356 b- defN 20-Jul-14 07:36 lumigo_tracer-1.1.98.dist-info/LICENSE
--rw-r--r--  2.0 unx     5194 b- defN 20-Jul-14 07:36 lumigo_tracer-1.1.98.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 20-Jul-14 07:36 lumigo_tracer-1.1.98.dist-info/WHEEL
--rw-r--r--  2.0 unx       14 b- defN 20-Jul-14 07:36 lumigo_tracer-1.1.98.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2006 b- defN 20-Jul-14 07:36 lumigo_tracer-1.1.98.dist-info/RECORD
-23 files, 145355 bytes uncompressed, 42569 bytes compressed:  70.7%
+Zip file size: 46051 bytes, number of entries: 23
+-rw-r--r--  2.0 unx        7 b- defN 20-Jul-27 07:04 lumigo_tracer/VERSION
+-rw-r--r--  2.0 unx      182 b- defN 20-Jul-27 07:04 lumigo_tracer/__init__.py
+-rw-r--r--  2.0 unx    14000 b- defN 20-Jul-27 07:04 lumigo_tracer/spans_container.py
+-rw-r--r--  2.0 unx     2240 b- defN 20-Jul-27 07:04 lumigo_tracer/user_utils.py
+-rw-r--r--  2.0 unx    15267 b- defN 20-Jul-27 07:04 lumigo_tracer/utils.py
+-rw-r--r--  2.0 unx        0 b- defN 20-Jul-27 07:04 lumigo_tracer/auto_tag/__init__.py
+-rw-r--r--  2.0 unx     2011 b- defN 20-Jul-27 07:04 lumigo_tracer/auto_tag/auto_tag_event.py
+-rw-r--r--  2.0 unx       84 b- defN 20-Jul-27 07:04 lumigo_tracer/libs/__init__.py
+-rw-r--r--  2.0 unx    34961 b- defN 20-Jul-27 07:04 lumigo_tracer/libs/wrapt.py
+-rw-r--r--  2.0 unx    18270 b- defN 20-Jul-27 07:04 lumigo_tracer/libs/xmltodict.py
+-rw-r--r--  2.0 unx        0 b- defN 20-Jul-27 07:04 lumigo_tracer/parsers/__init__.py
+-rw-r--r--  2.0 unx     4743 b- defN 20-Jul-27 07:04 lumigo_tracer/parsers/event_parser.py
+-rw-r--r--  2.0 unx      558 b- defN 20-Jul-27 07:04 lumigo_tracer/parsers/http_data_classes.py
+-rw-r--r--  2.0 unx    10449 b- defN 20-Jul-27 07:04 lumigo_tracer/parsers/parser.py
+-rw-r--r--  2.0 unx    11609 b- defN 20-Jul-27 07:04 lumigo_tracer/parsers/utils.py
+-rw-r--r--  2.0 unx        0 b- defN 20-Jul-27 07:04 lumigo_tracer/sync_http/__init__.py
+-rw-r--r--  2.0 unx     1026 b- defN 20-Jul-27 07:04 lumigo_tracer/sync_http/handler.py
+-rw-r--r--  2.0 unx    12070 b- defN 20-Jul-27 07:04 lumigo_tracer/sync_http/sync_hook.py
+-rw-r--r--  2.0 unx    11356 b- defN 20-Jul-27 07:04 lumigo_tracer-1.1.99.dist-info/LICENSE
+-rw-r--r--  2.0 unx     5194 b- defN 20-Jul-27 07:04 lumigo_tracer-1.1.99.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 20-Jul-27 07:04 lumigo_tracer-1.1.99.dist-info/WHEEL
+-rw-r--r--  2.0 unx       14 b- defN 20-Jul-27 07:04 lumigo_tracer-1.1.99.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2006 b- defN 20-Jul-27 07:04 lumigo_tracer-1.1.99.dist-info/RECORD
+23 files, 146139 bytes uncompressed, 42759 bytes compressed:  70.7%
```

## zipnote {}

```diff
@@ -48,23 +48,23 @@
 
 Filename: lumigo_tracer/sync_http/handler.py
 Comment: 
 
 Filename: lumigo_tracer/sync_http/sync_hook.py
 Comment: 
 
-Filename: lumigo_tracer-1.1.98.dist-info/LICENSE
+Filename: lumigo_tracer-1.1.99.dist-info/LICENSE
 Comment: 
 
-Filename: lumigo_tracer-1.1.98.dist-info/METADATA
+Filename: lumigo_tracer-1.1.99.dist-info/METADATA
 Comment: 
 
-Filename: lumigo_tracer-1.1.98.dist-info/WHEEL
+Filename: lumigo_tracer-1.1.99.dist-info/WHEEL
 Comment: 
 
-Filename: lumigo_tracer-1.1.98.dist-info/top_level.txt
+Filename: lumigo_tracer-1.1.99.dist-info/top_level.txt
 Comment: 
 
-Filename: lumigo_tracer-1.1.98.dist-info/RECORD
+Filename: lumigo_tracer-1.1.99.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## lumigo_tracer/VERSION

```diff
@@ -1 +1 @@
-1.1.98
+1.1.99
```

## lumigo_tracer/utils.py

```diff
@@ -1,31 +1,32 @@
 import decimal
 import hashlib
 import json
 import logging
 import os
 import re
 import time
-import urllib.request
-from urllib.error import URLError
+import http.client
 from collections import OrderedDict
 from typing import Union, List, Optional, Dict, Any
 from contextlib import contextmanager
 from base64 import b64encode
 import inspect
 
 EXECUTION_TAGS_KEY = "lumigo_execution_tags_no_scrub"
-EDGE_HOST = "https://{region}.lumigo-tracer-edge.golumigo.com/api/spans"
+EDGE_HOST = "{region}.lumigo-tracer-edge.golumigo.com"
+EDGE_PATH = "/api/spans"
 LOG_FORMAT = "#LUMIGO# - %(asctime)s - %(levelname)s - %(message)s"
 SECONDS_TO_TIMEOUT = 0.5
 LUMIGO_EVENT_KEY = "_lumigo"
 STEP_FUNCTION_UID_KEY = "step_function_uid"
 # number of spans that are too big to enter the reported message before break
 TOO_BIG_SPANS_THRESHOLD = 5
 MAX_SIZE_FOR_REQUEST: int = int(os.environ.get("LUMIGO_MAX_SIZE_FOR_REQUEST", 900_000))
+EDGE_TIMEOUT = float(os.environ.get("LUMIGO_EDGE_TIMEOUT", SECONDS_TO_TIMEOUT))
 MAX_VARS_SIZE = 100_000
 MAX_VAR_LEN = 200
 MAX_ENTRY_SIZE = 2048
 FrameVariables = Dict[str, str]
 OMITTING_KEYS_REGEXES = [
     ".*pass.*",
     ".*key.*",
@@ -46,14 +47,25 @@
 LUMIGO_SECRET_MASKING_REGEX_BACKWARD_COMP = "LUMIGO_BLACKLIST_REGEX"
 LUMIGO_SECRET_MASKING_REGEX = "LUMIGO_SECRET_MASKING_REGEX"
 WARN_CLIENT_PREFIX = "Lumigo Warning"
 NUMBER_OF_SPANS_IN_REPORT_OPTIMIZATION = 200
 
 _logger: Union[logging.Logger, None] = None
 
+edge_connection = None
+try:
+    # Try to establish the connection in initialization
+    if os.environ.get("LUMIGO_INITIALIZATION_CONNECTION", "").lower() != "false":
+        edge_connection = http.client.HTTPSConnection(  # type: ignore
+            EDGE_HOST.format(region=os.environ.get("AWS_REGION")), timeout=EDGE_TIMEOUT
+        )
+        edge_connection.connect()
+except Exception:
+    pass
+
 
 class Configuration:
     should_report: bool = True
     host: str = ""
     token: Optional[str] = ""
     verbose: bool = True
     enhanced_print: bool = False
@@ -76,15 +88,15 @@
     domains_scrubber: Optional[List[str]] = None,
 ) -> None:
     """
     This function configure the lumigo wrapper.
 
     :param verbose: Whether the tracer should send all the possible information (debug mode)
     :param edge_host: The host to send the events. Leave empty for default.
-    :param should_report: Weather we should send the events. Change to True in the production.
+    :param should_report: Whether we should send the events. Change to True in the production.
     :param token: The token to use when sending back the events.
     :param enhance_print: Should we add prefix to the print (so the logs will be in the platform).
     :param step_function: Is this function is a part of a step function?
     :param timeout_timer: Should we start a timer to send the traced data before timeout acceded.
     :param timeout_timer_buffer: The buffer (seconds) that we take before reaching timeout to send the traces to lumigo.
         The default is 10% of the duration of the lambda (with upper and lower bounds of 0.5 and 3 seconds).
     :param domains_scrubber: List of regexes. We will not collect data of requests with hosts that match it.
@@ -178,32 +190,40 @@
     This function sends the information back to the edge.
 
     :param region: The region to use as default if not configured otherwise.
     :param msgs: the message to send.
     :return: The duration of reporting (in milliseconds),
                 or 0 if we didn't send (due to configuration or fail).
     """
+    global edge_connection
     get_logger().info(f"reporting the messages: {msgs[:10]}")
     host = Configuration.host or EDGE_HOST.format(region=region)
     duration = 0
+    if not edge_connection or edge_connection.host != host:
+        try:
+            edge_connection = http.client.HTTPSConnection(  # type: ignore
+                host.lstrip("https://").rstrip(EDGE_PATH), timeout=EDGE_TIMEOUT
+            )
+        except Exception as e:
+            get_logger().exception(f"Could not establish connection to {host}", exc_info=e)
+            return duration
     if Configuration.should_report:
         try:
             prune_trace: bool = not os.environ.get("LUMIGO_PRUNE_TRACE_OFF", "").lower() == "true"
             to_send = _create_request_body(msgs, prune_trace).encode()
             start_time = time.time()
-            response = urllib.request.urlopen(
-                urllib.request.Request(host, to_send, headers={"Content-Type": "application/json"}),
-                timeout=float(os.environ.get("LUMIGO_EDGE_TIMEOUT", SECONDS_TO_TIMEOUT)),
+            edge_connection.request(
+                "POST", EDGE_PATH, to_send, headers={"Content-Type": "application/json"}
             )
+            response = edge_connection.getresponse()
+            response.read()  # We most read the response to keep the connection available
             duration = int((time.time() - start_time) * 1000)
             get_logger().info(f"successful reporting, code: {getattr(response, 'code', 'unknown')}")
-        except URLError as e:
-            get_logger().exception(f"Timeout when reporting to {host}", exc_info=e)
         except Exception as e:
-            get_logger().exception(f"could not report json to {host}", exc_info=e)
+            get_logger().exception(f"Could not report json to {host}", exc_info=e)
     return duration
 
 
 def get_logger():
     """
     This function returns lumigo's logger.
     The logger streams the logs to the stderr in format the explicitly say that those are lumigo's logs.
```

## Comparing `lumigo_tracer-1.1.98.dist-info/LICENSE` & `lumigo_tracer-1.1.99.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `lumigo_tracer-1.1.98.dist-info/METADATA` & `lumigo_tracer-1.1.99.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: lumigo-tracer
-Version: 1.1.98
+Version: 1.1.99
 Summary: Lumigo Tracer for Python v3.6 / v3.7 runtimes
 Home-page: https://github.com/lumigo-io/python_tracer.git
 Author: Lumigo LTD (https://lumigo.io)
 Author-email: support@lumigo.io
 License: Apache License 2.0
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

## Comparing `lumigo_tracer-1.1.98.dist-info/RECORD` & `lumigo_tracer-1.1.99.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,23 +1,23 @@
-lumigo_tracer/VERSION,sha256=-IpRi_EIFNwQjhucWm_YaFyrrMId0EiyxnVSGg9TcB8,7
+lumigo_tracer/VERSION,sha256=3X-ZDYJUr3wozfOIvs4HIiB1keCtUVGHgmGmBQxJgqU,7
 lumigo_tracer/__init__.py,sha256=yai4tnw8pa4dZkunaPQ2MUdTEaPB4dworoS_sRJhTjc,182
 lumigo_tracer/spans_container.py,sha256=u6BHJUpYzVIgL8limcpeeajqaysC96ZB9RiYIqtUXeg,14000
 lumigo_tracer/user_utils.py,sha256=Uc6Cto0efysuodPrSbqCyMSf5Jr-hV5HGrabm_1MLAk,2240
-lumigo_tracer/utils.py,sha256=uz3kc12vGAUSS1CqELBebYkt7mK0tzTnar8Jh8vM2N8,14483
+lumigo_tracer/utils.py,sha256=KwIRP8G_o9392uPktQDjrE9Tx4c3ABvodFn7ohxrDYA,15267
 lumigo_tracer/auto_tag/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 lumigo_tracer/auto_tag/auto_tag_event.py,sha256=l6ImOl88TOuwhQCpCrIM-y8S6956FzQF2napuh2W_I0,2011
 lumigo_tracer/libs/__init__.py,sha256=-TI4Sdo0Go_18kwMfX7nhV1erXo2DgRi2eygp2fOvRs,84
 lumigo_tracer/libs/wrapt.py,sha256=AMeuiNKBWq3WoLwl-fioxSoTS4Iy55FSnulta2q7VNA,34961
 lumigo_tracer/libs/xmltodict.py,sha256=7ivvabxD-3Jyh1DksEeADE0LA_NKCw8phN8nLNF9kAc,18270
 lumigo_tracer/parsers/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 lumigo_tracer/parsers/event_parser.py,sha256=s9l0kAHI7WHVOT27Xn1y9eI_Sns4tnrj7SWngXEcUcE,4743
 lumigo_tracer/parsers/http_data_classes.py,sha256=_TKxSzqJTwT7cx2ea92sD8nrdHqSqjxeB4WHULfh7jA,558
 lumigo_tracer/parsers/parser.py,sha256=xapuKWmUo1WF-dKSB4aAGed_-zoq1FxO4ztl-d2x5LQ,10449
 lumigo_tracer/parsers/utils.py,sha256=LPYE-64FSov-55tCKWe5tJxTyXZCW9q6EANIYQ8B6ZU,11609
 lumigo_tracer/sync_http/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 lumigo_tracer/sync_http/handler.py,sha256=Z6RVv1VWgwDyD-dmPQWBKYia2xbj7Y1dFV1Kx2KqX8k,1026
 lumigo_tracer/sync_http/sync_hook.py,sha256=nLzj6usY9BOFeEUS44KDN_yBxwKo__t6KXiirEgVETw,12070
-lumigo_tracer-1.1.98.dist-info/LICENSE,sha256=QwcOLU5TJoTeUhuIXzhdCEEDDvorGiC6-3YTOl4TecE,11356
-lumigo_tracer-1.1.98.dist-info/METADATA,sha256=nIDJUpnSZRr9tY-f7fVGVre2PmV-YiV5MBa7eTfPvBI,5194
-lumigo_tracer-1.1.98.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
-lumigo_tracer-1.1.98.dist-info/top_level.txt,sha256=cC9jIgVn6TvNrZSuSyqOQHus8Zy_hUv0f7hk-JznU_0,14
-lumigo_tracer-1.1.98.dist-info/RECORD,,
+lumigo_tracer-1.1.99.dist-info/LICENSE,sha256=QwcOLU5TJoTeUhuIXzhdCEEDDvorGiC6-3YTOl4TecE,11356
+lumigo_tracer-1.1.99.dist-info/METADATA,sha256=b9bT09m8VHNzAfacwefEAlz2bVJddlndKpyps8xR5Vg,5194
+lumigo_tracer-1.1.99.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
+lumigo_tracer-1.1.99.dist-info/top_level.txt,sha256=cC9jIgVn6TvNrZSuSyqOQHus8Zy_hUv0f7hk-JznU_0,14
+lumigo_tracer-1.1.99.dist-info/RECORD,,
```

