# Comparing `tmp/esdbclient-1.0b4.tar.gz` & `tmp/esdbclient-1.1b1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "esdbclient-1.0b4.tar", max compression
+gzip compressed data, was "esdbclient-1.1b1.tar", max compression
```

## Comparing `esdbclient-1.0b4.tar` & `esdbclient-1.1b1.tar`

### file list

```diff
@@ -1,38 +1,41 @@
--rw-r--r--   0        0        0     1520 2022-06-23 14:19:18.317032 esdbclient-1.0b4/LICENSE
--rw-r--r--   0        0        0   117096 2023-10-15 17:31:20.437454 esdbclient-1.0b4/README.md
--rw-r--r--   0        0        0      639 2023-05-26 19:08:34.577226 esdbclient-1.0b4/esdbclient/__init__.py
--rw-r--r--   0        0        0    16177 2023-10-15 16:45:33.353303 esdbclient-1.0b4/esdbclient/asyncio_client.py
--rw-r--r--   0        0        0    40806 2023-10-15 17:17:02.088669 esdbclient-1.0b4/esdbclient/client.py
--rw-r--r--   0        0        0     2600 2023-07-04 18:08:46.122503 esdbclient-1.0b4/esdbclient/connection.py
--rw-r--r--   0        0        0     9591 2023-06-02 22:33:39.164826 esdbclient-1.0b4/esdbclient/connection_spec.py
--rw-r--r--   0        0        0     3131 2023-07-04 18:08:46.123423 esdbclient-1.0b4/esdbclient/esdbapibase.py
--rw-r--r--   0        0        0     1258 2023-05-26 16:32:12.440216 esdbclient-1.0b4/esdbclient/events.py
--rw-r--r--   0        0        0     3548 2023-07-04 18:08:46.124316 esdbclient-1.0b4/esdbclient/exceptions.py
--rw-r--r--   0        0        0     5226 2023-06-02 22:33:14.763658 esdbclient-1.0b4/esdbclient/gossip.py
--rw-r--r--   0        0        0    33560 2023-10-12 19:16:46.656214 esdbclient-1.0b4/esdbclient/persistent.py
--rw-r--r--   0        0        0    14092 2023-10-12 19:01:06.500270 esdbclient-1.0b4/esdbclient/protos/Grpc/cluster_pb2.py
--rw-r--r--   0        0        0    37958 2023-10-12 19:01:05.284757 esdbclient-1.0b4/esdbclient/protos/Grpc/cluster_pb2.pyi
--rw-r--r--   0        0        0    19336 2023-10-12 19:01:06.473536 esdbclient-1.0b4/esdbclient/protos/Grpc/cluster_pb2_grpc.py
--rw-r--r--   0        0        0     1842 2023-10-12 19:01:06.511086 esdbclient-1.0b4/esdbclient/protos/Grpc/code_pb2.py
--rw-r--r--   0        0        0    13555 2023-10-12 19:01:04.648162 esdbclient-1.0b4/esdbclient/protos/Grpc/code_pb2.pyi
--rw-r--r--   0        0        0      158 2023-10-12 19:01:04.571237 esdbclient-1.0b4/esdbclient/protos/Grpc/code_pb2_grpc.py
--rw-r--r--   0        0        0     2956 2023-10-12 19:01:06.477602 esdbclient-1.0b4/esdbclient/protos/Grpc/gossip_pb2.py
--rw-r--r--   0        0        0     5524 2023-10-12 19:01:04.690964 esdbclient-1.0b4/esdbclient/protos/Grpc/gossip_pb2.pyi
--rw-r--r--   0        0        0     2752 2023-10-12 19:01:06.475386 esdbclient-1.0b4/esdbclient/protos/Grpc/gossip_pb2_grpc.py
--rw-r--r--   0        0        0    23590 2023-10-12 19:01:06.486846 esdbclient-1.0b4/esdbclient/protos/Grpc/persistent_pb2.py
--rw-r--r--   0        0        0    73220 2023-10-12 19:01:05.706609 esdbclient-1.0b4/esdbclient/protos/Grpc/persistent_pb2.pyi
--rw-r--r--   0        0        0    15771 2023-10-12 19:01:06.507863 esdbclient-1.0b4/esdbclient/protos/Grpc/persistent_pb2_grpc.py
--rw-r--r--   0        0        0     4113 2023-10-12 19:01:06.489702 esdbclient-1.0b4/esdbclient/protos/Grpc/shared_pb2.py
--rw-r--r--   0        0        0     9874 2023-10-12 19:01:04.780561 esdbclient-1.0b4/esdbclient/protos/Grpc/shared_pb2.pyi
--rw-r--r--   0        0        0      158 2023-10-12 19:01:04.571258 esdbclient-1.0b4/esdbclient/protos/Grpc/shared_pb2_grpc.py
--rw-r--r--   0        0        0     1739 2023-10-12 19:01:06.466820 esdbclient-1.0b4/esdbclient/protos/Grpc/status_pb2.py
--rw-r--r--   0        0        0     2838 2023-10-12 19:01:04.621188 esdbclient-1.0b4/esdbclient/protos/Grpc/status_pb2.pyi
--rw-r--r--   0        0        0      158 2023-10-12 19:01:04.574480 esdbclient-1.0b4/esdbclient/protos/Grpc/status_pb2_grpc.py
--rw-r--r--   0        0        0    20940 2023-10-12 19:01:06.521794 esdbclient-1.0b4/esdbclient/protos/Grpc/streams_pb2.py
--rw-r--r--   0        0        0    71744 2023-10-12 19:01:05.707853 esdbclient-1.0b4/esdbclient/protos/Grpc/streams_pb2.pyi
--rw-r--r--   0        0        0     9787 2023-10-12 19:01:04.764391 esdbclient-1.0b4/esdbclient/protos/Grpc/streams_pb2_grpc.py
--rw-r--r--   0        0        0        0 2022-06-23 14:19:18.321130 esdbclient-1.0b4/esdbclient/py.typed
--rw-r--r--   0        0        0    47100 2023-10-15 17:18:45.039369 esdbclient-1.0b4/esdbclient/streams.py
--rw-r--r--   0        0        0     2659 2023-10-15 19:25:29.009514 esdbclient-1.0b4/pyproject.toml
--rw-r--r--   0        0        0   121189 1970-01-01 00:00:00.000000 esdbclient-1.0b4/setup.py
--rw-r--r--   0        0        0   118466 1970-01-01 00:00:00.000000 esdbclient-1.0b4/PKG-INFO
+-rw-r--r--   0        0        0     1520 2022-06-23 14:19:18.317032 esdbclient-1.1b1/LICENSE
+-rw-r--r--   0        0        0   146551 2024-05-07 17:49:34.578510 esdbclient-1.1b1/README.md
+-rw-r--r--   0        0        0      665 2024-04-29 21:28:03.270446 esdbclient-1.1b1/esdbclient/__init__.py
+-rw-r--r--   0        0        0    61816 2024-05-07 17:49:33.437999 esdbclient-1.1b1/esdbclient/asyncio_client.py
+-rw-r--r--   0        0        0    68114 2024-05-07 17:49:33.438828 esdbclient-1.1b1/esdbclient/client.py
+-rw-r--r--   0        0        0    11967 2024-05-07 17:49:33.439565 esdbclient-1.1b1/esdbclient/common.py
+-rw-r--r--   0        0        0     3819 2024-05-07 17:49:33.440928 esdbclient-1.1b1/esdbclient/connection.py
+-rw-r--r--   0        0        0    10170 2024-03-20 01:14:49.708462 esdbclient-1.1b1/esdbclient/connection_spec.py
+-rw-r--r--   0        0        0     3284 2024-04-29 21:27:57.792242 esdbclient-1.1b1/esdbclient/events.py
+-rw-r--r--   0        0        0     5948 2024-04-26 00:35:12.280754 esdbclient-1.1b1/esdbclient/exceptions.py
+-rw-r--r--   0        0        0     5532 2024-04-04 00:22:38.215558 esdbclient-1.1b1/esdbclient/gossip.py
+-rw-r--r--   0        0        0    82861 2024-04-29 22:32:08.972569 esdbclient-1.1b1/esdbclient/persistent.py
+-rw-r--r--   0        0        0    27488 2024-05-07 17:49:33.442344 esdbclient-1.1b1/esdbclient/projections.py
+-rw-r--r--   0        0        0    14166 2024-05-02 13:49:41.020003 esdbclient-1.1b1/esdbclient/protos/Grpc/cluster_pb2.py
+-rw-r--r--   0        0        0    37958 2024-05-02 13:49:41.275519 esdbclient-1.1b1/esdbclient/protos/Grpc/cluster_pb2.pyi
+-rw-r--r--   0        0        0    19336 2024-05-02 13:49:40.865930 esdbclient-1.1b1/esdbclient/protos/Grpc/cluster_pb2_grpc.py
+-rw-r--r--   0        0        0     1916 2024-05-02 13:49:40.420076 esdbclient-1.1b1/esdbclient/protos/Grpc/code_pb2.py
+-rw-r--r--   0        0        0    13555 2024-05-02 13:49:40.538653 esdbclient-1.1b1/esdbclient/protos/Grpc/code_pb2.pyi
+-rw-r--r--   0        0        0      158 2024-05-02 13:49:40.389375 esdbclient-1.1b1/esdbclient/protos/Grpc/code_pb2_grpc.py
+-rw-r--r--   0        0        0     3030 2024-05-02 13:49:40.543509 esdbclient-1.1b1/esdbclient/protos/Grpc/gossip_pb2.py
+-rw-r--r--   0        0        0     5524 2024-05-02 13:49:40.640362 esdbclient-1.1b1/esdbclient/protos/Grpc/gossip_pb2.pyi
+-rw-r--r--   0        0        0     2752 2024-05-02 13:49:40.532290 esdbclient-1.1b1/esdbclient/protos/Grpc/gossip_pb2_grpc.py
+-rw-r--r--   0        0        0    23846 2024-05-02 13:49:41.404767 esdbclient-1.1b1/esdbclient/protos/Grpc/persistent_pb2.py
+-rw-r--r--   0        0        0    73220 2024-05-02 13:49:41.830902 esdbclient-1.1b1/esdbclient/protos/Grpc/persistent_pb2.pyi
+-rw-r--r--   0        0        0    15771 2024-05-02 13:49:40.799320 esdbclient-1.1b1/esdbclient/protos/Grpc/persistent_pb2_grpc.py
+-rw-r--r--   0        0        0    10621 2024-05-07 17:49:33.443252 esdbclient-1.1b1/esdbclient/protos/Grpc/projections_pb2.py
+-rw-r--r--   0        0        0    25437 2024-05-07 17:49:33.443914 esdbclient-1.1b1/esdbclient/protos/Grpc/projections_pb2.pyi
+-rw-r--r--   0        0        0    18841 2024-05-07 17:49:33.444347 esdbclient-1.1b1/esdbclient/protos/Grpc/projections_pb2_grpc.py
+-rw-r--r--   0        0        0     4187 2024-05-02 13:49:40.665078 esdbclient-1.1b1/esdbclient/protos/Grpc/shared_pb2.py
+-rw-r--r--   0        0        0     9874 2024-05-02 13:49:40.801616 esdbclient-1.1b1/esdbclient/protos/Grpc/shared_pb2.pyi
+-rw-r--r--   0        0        0      158 2024-05-02 13:49:40.534944 esdbclient-1.1b1/esdbclient/protos/Grpc/shared_pb2_grpc.py
+-rw-r--r--   0        0        0     1813 2024-05-02 13:49:40.593327 esdbclient-1.1b1/esdbclient/protos/Grpc/status_pb2.py
+-rw-r--r--   0        0        0     2838 2024-05-02 13:49:40.608113 esdbclient-1.1b1/esdbclient/protos/Grpc/status_pb2.pyi
+-rw-r--r--   0        0        0      158 2024-05-02 13:49:40.550725 esdbclient-1.1b1/esdbclient/protos/Grpc/status_pb2_grpc.py
+-rw-r--r--   0        0        0    21622 2024-05-02 13:49:41.325300 esdbclient-1.1b1/esdbclient/protos/Grpc/streams_pb2.py
+-rw-r--r--   0        0        0    72778 2024-05-02 13:49:41.844782 esdbclient-1.1b1/esdbclient/protos/Grpc/streams_pb2.pyi
+-rw-r--r--   0        0        0     9787 2024-05-02 13:49:40.788920 esdbclient-1.1b1/esdbclient/protos/Grpc/streams_pb2_grpc.py
+-rw-r--r--   0        0        0        0 2022-06-23 14:19:18.321130 esdbclient-1.1b1/esdbclient/py.typed
+-rw-r--r--   0        0        0    52257 2024-04-29 21:31:01.778647 esdbclient-1.1b1/esdbclient/streams.py
+-rw-r--r--   0        0        0     2778 2024-05-07 17:49:33.446041 esdbclient-1.1b1/pyproject.toml
+-rw-r--r--   0        0        0   147589 1970-01-01 00:00:00.000000 esdbclient-1.1b1/PKG-INFO
```

### Comparing `esdbclient-1.0b4/LICENSE` & `esdbclient-1.1b1/LICENSE`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/README.md` & `esdbclient-1.1b1/PKG-INFO`

 * *Files 21% similar despite different names*

```diff
@@ -1,7319 +1,9225 @@
-00000000: 2320 5079 7468 6f6e 2067 5250 4320 436c  # Python gRPC Cl
-00000010: 6965 6e74 2066 6f72 2045 7665 6e74 5374  ient for EventSt
-00000020: 6f72 6544 420a 0a54 6869 7320 5b50 7974  oreDB..This [Pyt
-00000030: 686f 6e20 7061 636b 6167 655d 2868 7474  hon package](htt
-00000040: 7073 3a2f 2f70 7970 692e 6f72 672f 7072  ps://pypi.org/pr
-00000050: 6f6a 6563 742f 6573 6462 636c 6965 6e74  oject/esdbclient
-00000060: 2f29 2070 726f 7669 6465 7320 6120 5079  /) provides a Py
-00000070: 7468 6f6e 0a67 5250 4320 636c 6965 6e74  thon.gRPC client
-00000080: 2066 6f72 2074 6865 205b 4576 656e 7453   for the [EventS
-00000090: 746f 7265 4442 5d28 6874 7470 733a 2f2f  toreDB](https://
-000000a0: 7777 772e 6576 656e 7473 746f 7265 2e63  www.eventstore.c
-000000b0: 6f6d 2f29 2064 6174 6162 6173 652e 0a0a  om/) database...
-000000c0: 5468 6973 2063 6c69 656e 7420 6861 7320  This client has 
-000000d0: 6265 656e 2064 6576 656c 6f70 6564 2069  been developed i
-000000e0: 6e20 636f 6c6c 6162 6f72 6174 696f 6e20  n collaboration 
-000000f0: 7769 7468 2074 6865 2045 7665 6e74 5374  with the EventSt
-00000100: 6f72 6544 420a 7465 616d 2e20 416c 7468  oreDB.team. Alth
-00000110: 6f75 6768 206e 6f74 2061 6c6c 2074 6865  ough not all the
-00000120: 2066 6561 7475 7265 7320 6f66 2045 7665   features of Eve
-00000130: 6e74 5374 6f72 6544 4220 6172 6520 7375  ntStoreDB are su
-00000140: 7070 6f72 7465 640a 6279 2074 6869 7320  pported.by this 
-00000150: 636c 6965 6e74 2c20 6d61 6e79 206f 6620  client, many of 
-00000160: 7468 6520 6d6f 7374 2075 7365 6675 6c20  the most useful 
-00000170: 6665 6174 7572 6573 2061 7265 2070 7265  features are pre
-00000180: 7365 6e74 6564 0a69 6e20 616e 2065 6173  sented.in an eas
-00000190: 792d 746f 2d75 7365 2069 6e74 6572 6661  y-to-use interfa
-000001a0: 6365 2e0a 0a54 6869 7320 636c 6965 6e74  ce...This client
-000001b0: 2068 6173 2062 6565 6e20 7465 7374 6564   has been tested
-000001c0: 2074 6f20 776f 726b 2077 6974 6820 4576   to work with Ev
-000001d0: 656e 7453 746f 7265 4442 204c 5453 2076  entStoreDB LTS v
-000001e0: 6572 7369 6f6e 7320 3231 2e31 300a 616e  ersions 21.10.an
-000001f0: 6420 3232 2e31 302c 2077 6974 686f 7574  d 22.10, without
-00000200: 2061 6e64 2077 6974 686f 7574 2053 534c   and without SSL
-00000210: 2f54 4c53 2c20 616e 6420 7769 7468 2050  /TLS, and with P
-00000220: 7974 686f 6e20 7665 7273 696f 6e73 2033  ython versions 3
-00000230: 2e37 2074 6f20 332e 3131 2e0a 5468 6572  .7 to 3.11..Ther
-00000240: 6520 6973 2031 3030 2520 7465 7374 2063  e is 100% test c
-00000250: 6f76 6572 6167 652e 2054 6865 2063 6f64  overage. The cod
-00000260: 6520 6861 7320 7479 7069 6e67 2061 6e6e  e has typing ann
-00000270: 6f74 6174 696f 6e73 2c20 6368 6563 6b65  otations, checke
-00000280: 6420 7769 7468 206d 7970 792e 0a54 6865  d with mypy..The
-00000290: 2063 6f64 6520 6973 2066 6f72 6d61 7474   code is formatt
-000002a0: 6564 2077 6974 6820 626c 6163 6b20 616e  ed with black an
-000002b0: 6420 6973 6f72 742c 2061 6e64 2063 6865  d isort, and che
-000002c0: 636b 6564 2077 6974 6820 666c 616b 6538  cked with flake8
-000002d0: 2e20 506f 6574 7279 0a69 7320 7573 6564  . Poetry.is used
-000002e0: 2066 6f72 2070 6163 6b61 6765 206d 616e   for package man
-000002f0: 6167 656d 656e 7420 6475 7269 6e67 2064  agement during d
-00000300: 6576 656c 6f70 6d65 6e74 2c20 616e 6420  evelopment, and 
-00000310: 666f 7220 6275 696c 6469 6e67 2061 6e64  for building and
-00000320: 0a70 7562 6c69 7368 696e 6720 6469 7374  .publishing dist
-00000330: 7269 6275 7469 6f6e 7320 746f 205b 5079  ributions to [Py
-00000340: 5049 5d28 6874 7470 733a 2f2f 7079 7069  PI](https://pypi
-00000350: 2e6f 7267 2f70 726f 6a65 6374 2f65 7364  .org/project/esd
-00000360: 6263 6c69 656e 742f 292e 0a0a 2323 2053  bclient/)...## S
-00000370: 796e 6f70 7369 730a 0a59 6f75 2063 616e  ynopsis..You can
-00000380: 2063 6f6e 6e65 6374 2074 6f20 616e 2045   connect to an E
-00000390: 7665 6e74 5374 6f72 6544 4220 6461 7461  ventStoreDB data
-000003a0: 6261 7365 2075 7369 6e67 2074 6865 2060  base using the `
-000003b0: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
-000003c0: 6e74 6020 636c 6173 732e 0a0a 5468 6520  nt` class...The 
-000003d0: 6045 7665 6e74 5374 6f72 6544 4243 6c69  `EventStoreDBCli
-000003e0: 656e 7460 2063 6c61 7373 2063 616e 2062  ent` class can b
-000003f0: 6520 696d 706f 7274 6564 2066 726f 6d20  e imported from 
-00000400: 7468 6520 6065 7364 6263 6c69 656e 7460  the `esdbclient`
-00000410: 2070 6163 6b61 6765 2e0a 0a50 726f 6261   package...Proba
-00000420: 626c 7920 7468 6520 7468 7265 6520 6d6f  bly the three mo
-00000430: 7374 2075 7365 6675 6c20 6d65 7468 6f64  st useful method
-00000440: 7320 6f66 2060 4576 656e 7453 746f 7265  s of `EventStore
-00000450: 4442 436c 6965 6e74 6020 6172 653a 0a0a  DBClient` are:..
-00000460: 2a20 6061 7070 656e 645f 746f 5f73 7472  * `append_to_str
-00000470: 6561 6d28 2960 2054 6869 7320 6d65 7468  eam()` This meth
-00000480: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
-00000490: 6f20 7265 636f 7264 206e 6577 2065 7665  o record new eve
-000004a0: 6e74 7320 696e 2061 2070 6172 7469 6375  nts in a particu
-000004b0: 6c61 720a 2273 7472 6561 6d22 2e20 5468  lar."stream". Th
-000004c0: 6973 2069 7320 7573 6566 756c 2c20 666f  is is useful, fo
-000004d0: 7220 6578 616d 706c 652c 2077 6865 6e20  r example, when 
-000004e0: 6578 6563 7574 696e 6720 6120 636f 6d6d  executing a comm
-000004f0: 616e 6420 696e 2061 6e20 6170 706c 6963  and in an applic
-00000500: 6174 696f 6e0a 7468 6174 206d 7574 6174  ation.that mutat
-00000510: 6573 2061 6e20 6167 6772 6567 6174 652e  es an aggregate.
-00000520: 2054 6869 7320 6d65 7468 6f64 2069 7320   This method is 
-00000530: 2261 746f 6d69 6322 2069 6e20 7468 6174  "atomic" in that
-00000540: 2065 6974 6865 7220 616c 6c20 6f72 206e   either all or n
-00000550: 6f6e 6520 6f66 0a74 6865 2065 7665 6e74  one of.the event
-00000560: 7320 7769 6c6c 2062 6520 7265 636f 7264  s will be record
-00000570: 6564 2e0a 0a2a 2060 7265 6164 5f73 7472  ed...* `read_str
-00000580: 6561 6d28 2960 2054 6869 7320 6d65 7468  eam()` This meth
-00000590: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
-000005a0: 6f20 7265 7472 6965 7665 2061 6c6c 2074  o retrieve all t
-000005b0: 6865 2072 6563 6f72 6465 640a 6576 656e  he recorded.even
-000005c0: 7473 2069 6e20 6120 2273 7472 6561 6d22  ts in a "stream"
-000005d0: 2e20 5468 6973 2069 7320 7573 6566 756c  . This is useful
-000005e0: 2c20 666f 7220 6578 616d 706c 652c 2077  , for example, w
-000005f0: 6865 6e20 7265 636f 6e73 7472 7563 7469  hen reconstructi
-00000600: 6e67 0a61 6e20 6167 6772 6567 6174 6520  ng.an aggregate 
-00000610: 6672 6f6d 2072 6563 6f72 6465 6420 6576  from recorded ev
-00000620: 656e 7473 2062 6566 6f72 6520 6578 6563  ents before exec
-00000630: 7574 696e 6720 6120 636f 6d6d 616e 6420  uting a command 
-00000640: 696e 2061 6e0a 6170 706c 6963 6174 696f  in an.applicatio
-00000650: 6e20 7468 6174 2063 7265 6174 6573 206e  n that creates n
-00000660: 6577 2065 7665 6e74 732e 0a0a 2a20 6073  ew events...* `s
-00000670: 7562 7363 7269 6265 5f74 6f5f 616c 6c28  ubscribe_to_all(
-00000680: 2960 2054 6869 7320 6d65 7468 6f64 2063  )` This method c
-00000690: 616e 2062 6520 7573 6564 2074 6f20 7265  an be used to re
-000006a0: 6365 6976 6520 616c 6c20 7265 636f 7264  ceive all record
-000006b0: 6564 2065 7665 6e74 7320 696e 0a74 6865  ed events in.the
-000006c0: 2064 6174 6162 6173 652e 2054 6869 7320   database. This 
-000006d0: 6973 2075 7365 6675 6c2c 2066 6f72 2065  is useful, for e
-000006e0: 7861 6d70 6c65 2c20 696e 2065 7665 6e74  xample, in event
-000006f0: 2d70 726f 6365 7373 696e 6720 636f 6d70  -processing comp
-00000700: 6f6e 656e 7473 2062 6563 6175 7365 0a69  onents because.i
-00000710: 7420 7375 7070 6f72 7473 2070 726f 6365  t supports proce
-00000720: 7373 696e 6720 6576 656e 7473 2077 6974  ssing events wit
-00000730: 6820 2265 7861 6374 6c79 2d6f 6e63 6522  h "exactly-once"
-00000740: 2073 656d 616e 7469 6373 2e0a 0a54 6865   semantics...The
-00000750: 2065 7861 6d70 6c65 2062 656c 6f77 2075   example below u
-00000760: 7365 7320 616e 2022 696e 7365 6375 7265  ses an "insecure
-00000770: 2220 4576 656e 7453 746f 7265 4442 2073  " EventStoreDB s
-00000780: 6572 7665 7220 7275 6e6e 696e 6720 6c6f  erver running lo
-00000790: 6361 6c6c 7920 6f6e 2070 6f72 7420 3231  cally on port 21
-000007a0: 3133 2e0a 0a60 6060 7079 7468 6f6e 0a69  13...```python.i
-000007b0: 6d70 6f72 7420 7575 6964 0a0a 6672 6f6d  mport uuid..from
-000007c0: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
-000007d0: 7274 2045 7665 6e74 5374 6f72 6544 4243  rt EventStoreDBC
-000007e0: 6c69 656e 742c 204e 6577 4576 656e 742c  lient, NewEvent,
-000007f0: 2053 7472 6561 6d53 7461 7465 0a0a 0a23   StreamState...#
-00000800: 2043 6f6e 7374 7275 6374 2045 7665 6e74   Construct Event
-00000810: 5374 6f72 6544 4243 6c69 656e 7420 7769  StoreDBClient wi
-00000820: 7468 2061 6e20 4576 656e 7453 746f 7265  th an EventStore
-00000830: 4442 2055 5249 2e20 5468 650a 2320 636f  DB URI. The.# co
-00000840: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
-00000850: 5552 4920 7370 6563 6966 6965 7320 7468  URI specifies th
-00000860: 6174 2074 6865 2063 6c69 656e 7420 7368  at the client sh
-00000870: 6f75 6c64 0a23 2063 6f6e 6e65 6374 2074  ould.# connect t
-00000880: 6f20 616e 2022 696e 7365 6375 7265 2220  o an "insecure" 
-00000890: 7365 7276 6572 2072 756e 6e69 6e67 206f  server running o
-000008a0: 6e20 706f 7274 2032 3131 332e 0a0a 636c  n port 2113...cl
-000008b0: 6965 6e74 203d 2045 7665 6e74 5374 6f72  ient = EventStor
-000008c0: 6544 4243 6c69 656e 7428 0a20 2020 2075  eDBClient(.    u
-000008d0: 7269 3d22 6573 6462 3a2f 2f6c 6f63 616c  ri="esdb://local
-000008e0: 686f 7374 3a32 3131 333f 546c 733d 6661  host:2113?Tls=fa
-000008f0: 6c73 6522 0a29 0a0a 0a23 2047 656e 6572  lse".)...# Gener
-00000900: 6174 6520 6e65 7720 6576 656e 7473 2e20  ate new events. 
-00000910: 5479 7069 6361 6c6c 792c 2064 6f6d 6169  Typically, domai
-00000920: 6e20 6576 656e 7473 206f 6620 6469 6666  n events of diff
-00000930: 6572 656e 740a 2320 7479 7065 7320 6172  erent.# types ar
-00000940: 6520 6765 6e65 7261 7465 6420 696e 2061  e generated in a
-00000950: 2064 6f6d 6169 6e20 6d6f 6465 6c2c 2061   domain model, a
-00000960: 6e64 2074 6865 6e20 7365 7269 616c 697a  nd then serializ
-00000970: 6564 0a23 2069 6e74 6f20 4e65 7745 7665  ed.# into NewEve
-00000980: 6e74 206f 626a 6563 7473 2e20 416e 2061  nt objects. An a
-00000990: 6767 7265 6761 7465 2049 4420 6d61 7920  ggregate ID may 
-000009a0: 6265 2075 7365 6420 6173 2074 6865 0a23  be used as the.#
-000009b0: 206e 616d 6520 6f66 2061 2073 7472 6561   name of a strea
-000009c0: 6d20 696e 2045 7665 6e74 5374 6f72 6544  m in EventStoreD
-000009d0: 422e 0a0a 7374 7265 616d 5f6e 616d 6531  B...stream_name1
-000009e0: 203d 2073 7472 2875 7569 642e 7575 6964   = str(uuid.uuid
-000009f0: 3428 2929 0a65 7665 6e74 3120 3d20 4e65  4()).event1 = Ne
-00000a00: 7745 7665 6e74 280a 2020 2020 7479 7065  wEvent(.    type
-00000a10: 3d27 4f72 6465 7243 7265 6174 6564 272c  ='OrderCreated',
-00000a20: 0a20 2020 2064 6174 613d 6227 7b22 6f72  .    data=b'{"or
-00000a30: 6465 725f 6e75 6d62 6572 223a 2022 3132  der_number": "12
-00000a40: 3334 3536 227d 270a 290a 6576 656e 7432  3456"}'.).event2
-00000a50: 203d 204e 6577 4576 656e 7428 0a20 2020   = NewEvent(.   
-00000a60: 2074 7970 653d 274f 7264 6572 5375 626d   type='OrderSubm
-00000a70: 6974 7465 6427 2c0a 2020 2020 6461 7461  itted',.    data
-00000a80: 3d62 277b 7d27 0a29 0a65 7665 6e74 3320  =b'{}'.).event3 
-00000a90: 3d20 4e65 7745 7665 6e74 280a 2020 2020  = NewEvent(.    
-00000aa0: 7479 7065 3d27 4f72 6465 7243 616e 6365  type='OrderCance
-00000ab0: 6c6c 6564 272c 0a20 2020 2064 6174 613d  lled',.    data=
-00000ac0: 6227 7b7d 270a 290a 0a0a 2320 4170 7065  b'{}'.)...# Appe
-00000ad0: 6e64 206e 6577 2065 7665 6e74 7320 746f  nd new events to
-00000ae0: 2061 206e 6577 2073 7472 6561 6d2e 2054   a new stream. T
-00000af0: 6865 2076 616c 7565 2072 6574 7572 6e65  he value returne
-00000b00: 640a 2320 6672 6f6d 2074 6865 2061 7070  d.# from the app
-00000b10: 656e 645f 746f 5f73 7472 6561 6d28 2920  end_to_stream() 
-00000b20: 6d65 7468 6f64 2069 7320 7468 6520 6f76  method is the ov
-00000b30: 6572 616c 6c0a 2320 2263 6f6d 6d69 7420  erall.# "commit 
-00000b40: 706f 7369 7469 6f6e 2220 696e 2074 6865  position" in the
-00000b50: 2064 6174 6162 6173 6520 6f66 2074 6865   database of the
-00000b60: 206c 6173 7420 6e65 7720 6576 656e 740a   last new event.
-00000b70: 2320 7265 636f 7264 6564 2062 7920 7468  # recorded by th
-00000b80: 6973 206f 7065 7261 7469 6f6e 2e20 5468  is operation. Th
-00000b90: 6520 7265 7475 726e 6564 2022 636f 6d6d  e returned "comm
-00000ba0: 6974 2070 6f73 6974 696f 6e22 0a23 206d  it position".# m
-00000bb0: 6179 2062 6520 7573 6564 2069 6e20 6120  ay be used in a 
-00000bc0: 7573 6572 2069 6e74 6572 6661 6365 2074  user interface t
-00000bd0: 6f20 706f 6c6c 2061 6e20 6576 656e 7475  o poll an eventu
-00000be0: 616c 6c79 0a23 2063 6f6e 7369 7374 656e  ally.# consisten
-00000bf0: 7420 6576 656e 742d 7072 6f63 6573 7369  t event-processi
-00000c00: 6e67 2063 6f6d 706f 6e65 6e74 2075 6e74  ng component unt
-00000c10: 696c 2069 7420 6361 6e0a 2320 7072 6573  il it can.# pres
-00000c20: 656e 7420 616e 2075 702d 746f 2d64 6174  ent an up-to-dat
-00000c30: 6520 6d61 7465 7269 616c 697a 6564 2076  e materialized v
-00000c40: 6965 772e 204e 6577 2065 7665 6e74 7320  iew. New events 
-00000c50: 6172 650a 2320 6561 6368 2061 6c6c 6f63  are.# each alloc
-00000c60: 6174 6564 2061 2022 7374 7265 616d 2070  ated a "stream p
-00000c70: 6f73 6974 696f 6e22 2c20 7768 6963 6820  osition", which 
-00000c80: 6973 2074 6865 206e 6578 740a 2320 6176  is the next.# av
-00000c90: 6169 6c61 626c 6520 706f 7369 7469 6f6e  ailable position
-00000ca0: 2069 6e20 7468 6520 7374 7265 616d 2c20   in the stream, 
-00000cb0: 7374 6172 7469 6e67 2066 726f 6d20 302e  starting from 0.
-00000cc0: 0a0a 636f 6d6d 6974 5f70 6f73 6974 696f  ..commit_positio
-00000cd0: 6e31 203d 2063 6c69 656e 742e 6170 7065  n1 = client.appe
-00000ce0: 6e64 5f74 6f5f 7374 7265 616d 280a 2020  nd_to_stream(.  
-00000cf0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-00000d00: 7265 616d 5f6e 616d 6531 2c0a 2020 2020  ream_name1,.    
-00000d10: 6375 7272 656e 745f 7665 7273 696f 6e3d  current_version=
-00000d20: 5374 7265 616d 5374 6174 652e 4e4f 5f53  StreamState.NO_S
-00000d30: 5452 4541 4d2c 0a20 2020 2065 7665 6e74  TREAM,.    event
-00000d40: 733d 5b65 7665 6e74 312c 2065 7665 6e74  s=[event1, event
-00000d50: 325d 2c0a 290a 0a23 2041 7070 656e 6420  2],.)..# Append 
-00000d60: 6576 656e 7473 2074 6f20 616e 2065 7869  events to an exi
-00000d70: 7374 696e 6720 7374 7265 616d 2e20 5468  sting stream. Th
-00000d80: 6520 2263 7572 7265 6e74 2076 6572 7369  e "current versi
-00000d90: 6f6e 220a 2320 6973 2074 6865 2022 7374  on".# is the "st
-00000da0: 7265 616d 2070 6f73 6974 696f 6e22 206f  ream position" o
-00000db0: 6620 7468 6520 6c61 7374 2072 6563 6f72  f the last recor
-00000dc0: 6465 6420 6576 656e 7420 696e 2061 0a23  ded event in a.#
-00000dd0: 2073 7472 6561 6d2e 2057 6520 6861 7665   stream. We have
-00000de0: 2072 6563 6f72 6465 6420 7477 6f20 6e65   recorded two ne
-00000df0: 7720 6576 656e 7473 2c20 736f 2074 6865  w events, so the
-00000e00: 2022 6375 7272 656e 740a 2320 7665 7273   "current.# vers
-00000e10: 696f 6e22 2069 7320 312e 2054 6865 2065  ion" is 1. The e
-00000e20: 7863 6570 7469 6f6e 2027 5772 6f6e 6743  xception 'WrongC
-00000e30: 7572 7265 6e74 5665 7273 696f 6e27 2077  urrentVersion' w
-00000e40: 696c 6c20 6265 0a23 2072 6169 7365 6420  ill be.# raised 
-00000e50: 6966 2061 6e20 696e 636f 7272 6563 7420  if an incorrect 
-00000e60: 7661 6c75 6520 6973 2067 6976 656e 2e0a  value is given..
-00000e70: 0a63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
-00000e80: 3220 3d20 636c 6965 6e74 2e61 7070 656e  2 = client.appen
-00000e90: 645f 746f 5f73 7472 6561 6d28 0a20 2020  d_to_stream(.   
-00000ea0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-00000eb0: 6561 6d5f 6e61 6d65 312c 0a20 2020 2063  eam_name1,.    c
-00000ec0: 7572 7265 6e74 5f76 6572 7369 6f6e 3d31  urrent_version=1
-00000ed0: 2c0a 2020 2020 6576 656e 7473 3d5b 6576  ,.    events=[ev
-00000ee0: 656e 7433 5d2c 0a29 0a0a 2320 2d20 616c  ent3],.)..# - al
-00000ef0: 6c6f 6361 7465 6420 636f 6d6d 6974 2070  located commit p
-00000f00: 6f73 6974 696f 6e73 2069 6e63 7265 6173  ositions increas
-00000f10: 6520 6d6f 6e6f 746f 6e69 6361 6c6c 790a  e monotonically.
-00000f20: 6173 7365 7274 2063 6f6d 6d69 745f 706f  assert commit_po
-00000f30: 7369 7469 6f6e 3220 3e20 636f 6d6d 6974  sition2 > commit
-00000f40: 5f70 6f73 6974 696f 6e31 0a0a 0a23 2052  _position1...# R
-00000f50: 6561 6420 6576 656e 7473 2066 726f 6d20  ead events from 
-00000f60: 6120 7374 7265 616d 2e20 5468 6973 206d  a stream. This m
-00000f70: 6574 686f 6420 7265 7475 726e 7320 610a  ethod returns a.
-00000f80: 2320 2272 6561 6420 7265 7370 6f6e 7365  # "read response
-00000f90: 2220 6974 6572 6174 6f72 2c20 7768 6963  " iterator, whic
-00000fa0: 6820 7265 7475 726e 7320 7265 636f 7264  h returns record
-00000fb0: 6564 0a23 2065 7665 6e74 732e 2054 6865  ed.# events. The
-00000fc0: 2069 7465 7261 746f 7220 7769 6c6c 2073   iterator will s
-00000fd0: 746f 7020 7768 656e 2074 6865 7265 2061  top when there a
-00000fe0: 7265 206e 6f0a 2320 6d6f 7265 2065 7665  re no.# more eve
-00000ff0: 6e74 7320 746f 2062 6520 7265 7475 726e  nts to be return
-00001000: 6564 2e0a 0a72 6561 645f 7265 7370 6f6e  ed...read_respon
-00001010: 7365 203d 2063 6c69 656e 742e 7265 6164  se = client.read
-00001020: 5f73 7472 6561 6d28 0a20 2020 2073 7472  _stream(.    str
-00001030: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00001040: 6e61 6d65 310a 290a 0a23 2049 7465 7261  name1.)..# Itera
-00001050: 7465 206f 7665 7220 2272 6561 6420 7265  te over "read re
-00001060: 7370 6f6e 7365 2220 746f 2067 6574 2072  sponse" to get r
-00001070: 6563 6f72 6465 6420 6576 656e 7473 2e0a  ecorded events..
-00001080: 2320 5468 6520 7265 636f 7264 6564 2065  # The recorded e
-00001090: 7665 6e74 7320 6d61 7920 6265 2064 6573  vents may be des
-000010a0: 6572 6961 6c69 7a65 6420 746f 2064 6f6d  erialized to dom
-000010b0: 6169 6e20 6576 656e 740a 2320 6f62 6a65  ain event.# obje
-000010c0: 6374 7320 6f66 2064 6966 6665 7265 6e74  cts of different
-000010d0: 2074 7970 6573 2061 6e64 2075 7365 6420   types and used 
-000010e0: 746f 2072 6563 6f6e 7374 7275 6374 2061  to reconstruct a
-000010f0: 6e0a 2320 6167 6772 6567 6174 6520 696e  n.# aggregate in
-00001100: 2061 2064 6f6d 6169 6e20 6d6f 6465 6c2e   a domain model.
-00001110: 0a72 6563 6f72 6465 645f 6576 656e 7473  .recorded_events
-00001120: 203d 2074 7570 6c65 2872 6561 645f 7265   = tuple(read_re
-00001130: 7370 6f6e 7365 290a 0a23 202d 2073 7472  sponse)..# - str
-00001140: 6561 6d20 2773 7472 6561 6d5f 6e61 6d65  eam 'stream_name
-00001150: 3127 206e 6f77 2068 6173 2074 6872 6565  1' now has three
-00001160: 2065 7665 6e74 730a 6173 7365 7274 206c   events.assert l
-00001170: 656e 2872 6563 6f72 6465 645f 6576 656e  en(recorded_even
-00001180: 7473 2920 3d3d 2033 0a0a 2320 2d20 616c  ts) == 3..# - al
-00001190: 6c6f 6361 7465 6420 7374 7265 616d 2070  located stream p
-000011a0: 6f73 6974 696f 6e73 2061 7265 207a 6572  ositions are zer
-000011b0: 6f2d 6261 7365 6420 616e 6420 6761 706c  o-based and gapl
-000011c0: 6573 730a 6173 7365 7274 2072 6563 6f72  ess.assert recor
-000011d0: 6465 645f 6576 656e 7473 5b30 5d2e 7374  ded_events[0].st
-000011e0: 7265 616d 5f70 6f73 6974 696f 6e20 3d3d  ream_position ==
-000011f0: 2030 0a61 7373 6572 7420 7265 636f 7264   0.assert record
-00001200: 6564 5f65 7665 6e74 735b 315d 2e73 7472  ed_events[1].str
-00001210: 6561 6d5f 706f 7369 7469 6f6e 203d 3d20  eam_position == 
-00001220: 310a 6173 7365 7274 2072 6563 6f72 6465  1.assert recorde
-00001230: 645f 6576 656e 7473 5b32 5d2e 7374 7265  d_events[2].stre
-00001240: 616d 5f70 6f73 6974 696f 6e20 3d3d 2032  am_position == 2
-00001250: 0a0a 2320 2d20 6576 656e 7420 6174 7472  ..# - event attr
-00001260: 6962 7574 6520 7661 6c75 6573 2061 7265  ibute values are
-00001270: 2072 6563 6f72 6465 6420 6661 6974 6866   recorded faithf
-00001280: 756c 6c79 0a61 7373 6572 7420 7265 636f  ully.assert reco
-00001290: 7264 6564 5f65 7665 6e74 735b 305d 2e74  rded_events[0].t
-000012a0: 7970 6520 3d3d 2022 4f72 6465 7243 7265  ype == "OrderCre
-000012b0: 6174 6564 220a 6173 7365 7274 2072 6563  ated".assert rec
-000012c0: 6f72 6465 645f 6576 656e 7473 5b30 5d2e  orded_events[0].
-000012d0: 6461 7461 203d 3d20 6227 7b22 6f72 6465  data == b'{"orde
-000012e0: 725f 6e75 6d62 6572 223a 2022 3132 3334  r_number": "1234
-000012f0: 3536 227d 270a 6173 7365 7274 2072 6563  56"}'.assert rec
-00001300: 6f72 6465 645f 6576 656e 7473 5b30 5d2e  orded_events[0].
-00001310: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
-00001320: 0a61 7373 6572 7420 7265 636f 7264 6564  .assert recorded
-00001330: 5f65 7665 6e74 735b 315d 2e74 7970 6520  _events[1].type 
-00001340: 3d3d 2022 4f72 6465 7253 7562 6d69 7474  == "OrderSubmitt
-00001350: 6564 220a 6173 7365 7274 2072 6563 6f72  ed".assert recor
-00001360: 6465 645f 6576 656e 7473 5b31 5d2e 6461  ded_events[1].da
-00001370: 7461 203d 3d20 6227 7b7d 270a 6173 7365  ta == b'{}'.asse
-00001380: 7274 2072 6563 6f72 6465 645f 6576 656e  rt recorded_even
-00001390: 7473 5b31 5d2e 6964 203d 3d20 6576 656e  ts[1].id == even
-000013a0: 7432 2e69 640a 0a61 7373 6572 7420 7265  t2.id..assert re
-000013b0: 636f 7264 6564 5f65 7665 6e74 735b 325d  corded_events[2]
-000013c0: 2e74 7970 6520 3d3d 2022 4f72 6465 7243  .type == "OrderC
-000013d0: 616e 6365 6c6c 6564 220a 6173 7365 7274  ancelled".assert
-000013e0: 2072 6563 6f72 6465 645f 6576 656e 7473   recorded_events
-000013f0: 5b32 5d2e 6461 7461 203d 3d20 6227 7b7d  [2].data == b'{}
-00001400: 270a 6173 7365 7274 2072 6563 6f72 6465  '.assert recorde
-00001410: 645f 6576 656e 7473 5b32 5d2e 6964 203d  d_events[2].id =
-00001420: 3d20 6576 656e 7433 2e69 640a 0a0a 2320  = event3.id...# 
-00001430: 5374 6172 7420 6120 6361 7463 682d 7570  Start a catch-up
-00001440: 2073 7562 7363 7269 7074 696f 6e20 6672   subscription fr
-00001450: 6f6d 206c 6173 7420 7265 636f 7264 6564  om last recorded
-00001460: 2070 6f73 6974 696f 6e2e 0a23 2054 6869   position..# Thi
-00001470: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
-00001480: 2061 2022 6361 7463 682d 7570 2073 7562   a "catch-up sub
-00001490: 7363 7269 7074 696f 6e22 2069 7465 7261  scription" itera
-000014a0: 746f 722c 0a23 2077 6869 6368 2072 6574  tor,.# which ret
-000014b0: 7572 6e73 2072 6563 6f72 6465 6420 6576  urns recorded ev
-000014c0: 656e 7473 2e20 5468 6520 6974 6572 6174  ents. The iterat
-000014d0: 6f72 2077 696c 6c20 6e6f 7420 7374 6f70  or will not stop
-000014e0: 0a23 2077 6865 6e20 7468 6572 6520 6172  .# when there ar
-000014f0: 6520 6e6f 206d 6f72 6520 7265 636f 7264  e no more record
-00001500: 6564 2065 7665 6e74 7320 746f 2062 6520  ed events to be 
-00001510: 7265 7475 726e 6564 2c20 6275 740a 2320  returned, but.# 
-00001520: 7769 6c6c 2062 6c6f 636b 2c20 616e 6420  will block, and 
-00001530: 636f 6e74 696e 7565 2077 6865 6e20 6675  continue when fu
-00001540: 7274 6865 7220 6576 656e 7473 2061 7265  rther events are
-00001550: 2072 6563 6f72 6465 642e 0a0a 6361 7463   recorded...catc
-00001560: 6875 705f 7375 6273 6372 6970 7469 6f6e  hup_subscription
-00001570: 203d 2063 6c69 656e 742e 7375 6273 6372   = client.subscr
-00001580: 6962 655f 746f 5f61 6c6c 2829 0a0a 0a23  ibe_to_all()...#
-00001590: 2049 7465 7261 7465 206f 7665 7220 7468   Iterate over th
-000015a0: 6520 6361 7463 682d 7570 2073 7562 7363  e catch-up subsc
-000015b0: 7269 7074 696f 6e2e 2050 726f 6365 7373  ription. Process
-000015c0: 2065 6163 6820 7265 636f 7264 6564 0a23   each recorded.#
-000015d0: 2065 7665 6e74 2069 6e20 7475 726e 2e20   event in turn. 
-000015e0: 5769 7468 696e 2061 6e20 6174 6f6d 6963  Within an atomic
-000015f0: 2064 6174 6162 6173 6520 7472 616e 7361   database transa
-00001600: 6374 696f 6e2c 2072 6563 6f72 640a 2320  ction, record.# 
-00001610: 7468 6520 6576 656e 7427 7320 2263 6f6d  the event's "com
-00001620: 6d69 7420 706f 7369 7469 6f6e 2220 616c  mit position" al
-00001630: 6f6e 6720 7769 7468 2061 6e79 206e 6577  ong with any new
-00001640: 2073 7461 7465 2067 656e 6572 6174 6564   state generated
-00001650: 0a23 2062 7920 7072 6f63 6573 7369 6e67  .# by processing
-00001660: 2074 6865 2065 7665 6e74 2e20 5573 6520   the event. Use 
-00001670: 7468 6520 636f 6d70 6f6e 656e 7427 7320  the component's 
-00001680: 6c61 7374 2072 6563 6f72 6465 6420 636f  last recorded co
-00001690: 6d6d 6974 0a23 2070 6f73 6974 696f 6e20  mmit.# position 
-000016a0: 7768 656e 2072 6573 7461 7274 696e 6720  when restarting 
-000016b0: 7468 6520 6361 7463 682d 7570 2073 7562  the catch-up sub
-000016c0: 7363 7269 7074 696f 6e2e 0a0a 7265 6365  scription...rece
-000016d0: 6976 6564 5f65 7665 6e74 7320 3d20 5b5d  ived_events = []
-000016e0: 0a66 6f72 2065 7665 6e74 2069 6e20 6361  .for event in ca
-000016f0: 7463 6875 705f 7375 6273 6372 6970 7469  tchup_subscripti
-00001700: 6f6e 3a0a 2020 2020 7265 6365 6976 6564  on:.    received
-00001710: 5f65 7665 6e74 732e 6170 7065 6e64 2865  _events.append(e
-00001720: 7665 6e74 290a 0a20 2020 2069 6620 6576  vent)..    if ev
-00001730: 656e 742e 636f 6d6d 6974 5f70 6f73 6974  ent.commit_posit
-00001740: 696f 6e20 3d3d 2063 6f6d 6d69 745f 706f  ion == commit_po
-00001750: 7369 7469 6f6e 323a 0a20 2020 2020 2020  sition2:.       
-00001760: 2023 2042 7265 616b 2073 6f20 7765 2063   # Break so we c
-00001770: 616e 2063 6f6e 7469 6e75 6520 7769 7468  an continue with
-00001780: 2074 6865 2065 7861 6d70 6c65 2e0a 2020   the example..  
-00001790: 2020 2020 2020 6272 6561 6b0a 0a0a 2320        break...# 
-000017a0: 2d20 6576 656e 7473 2061 7265 2072 6563  - events are rec
-000017b0: 6569 7665 6420 696e 2074 6865 206f 7264  eived in the ord
-000017c0: 6572 2074 6865 7920 7765 7265 2072 6563  er they were rec
-000017d0: 6f72 6465 640a 6173 7365 7274 2072 6563  orded.assert rec
-000017e0: 6569 7665 645f 6576 656e 7473 5b2d 335d  eived_events[-3]
-000017f0: 2e74 7970 6520 3d3d 2022 4f72 6465 7243  .type == "OrderC
-00001800: 7265 6174 6564 220a 6173 7365 7274 2072  reated".assert r
-00001810: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
-00001820: 335d 2e64 6174 6120 3d3d 2062 277b 226f  3].data == b'{"o
-00001830: 7264 6572 5f6e 756d 6265 7222 3a20 2231  rder_number": "1
-00001840: 3233 3435 3622 7d27 0a61 7373 6572 7420  23456"}'.assert 
-00001850: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-00001860: 2d33 5d2e 6964 203d 3d20 6576 656e 7431  -3].id == event1
-00001870: 2e69 640a 0a61 7373 6572 7420 7265 6365  .id..assert rece
-00001880: 6976 6564 5f65 7665 6e74 735b 2d32 5d2e  ived_events[-2].
-00001890: 7479 7065 203d 3d20 224f 7264 6572 5375  type == "OrderSu
-000018a0: 626d 6974 7465 6422 0a61 7373 6572 7420  bmitted".assert 
-000018b0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-000018c0: 2d32 5d2e 6461 7461 203d 3d20 6227 7b7d  -2].data == b'{}
-000018d0: 270a 6173 7365 7274 2072 6563 6569 7665  '.assert receive
-000018e0: 645f 6576 656e 7473 5b2d 325d 2e69 6420  d_events[-2].id 
-000018f0: 3d3d 2065 7665 6e74 322e 6964 0a0a 6173  == event2.id..as
-00001900: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
-00001910: 656e 7473 5b2d 315d 2e74 7970 6520 3d3d  ents[-1].type ==
-00001920: 2022 4f72 6465 7243 616e 6365 6c6c 6564   "OrderCancelled
-00001930: 220a 6173 7365 7274 2072 6563 6569 7665  ".assert receive
-00001940: 645f 6576 656e 7473 5b2d 315d 2e64 6174  d_events[-1].dat
-00001950: 6120 3d3d 2062 277b 7d27 0a61 7373 6572  a == b'{}'.asser
-00001960: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
-00001970: 735b 2d31 5d2e 6964 203d 3d20 6576 656e  s[-1].id == even
-00001980: 7433 2e69 640a 0a0a 2320 5374 6f70 2074  t3.id...# Stop t
-00001990: 6865 2063 6174 6368 2d75 7020 7375 6273  he catch-up subs
-000019a0: 6372 6970 7469 6f6e 2069 7465 7261 746f  cription iterato
-000019b0: 722e 0a0a 6361 7463 6875 705f 7375 6273  r...catchup_subs
-000019c0: 6372 6970 7469 6f6e 2e73 746f 7028 290a  cription.stop().
-000019d0: 0a0a 2320 436c 6f73 6520 7468 6520 636c  ..# Close the cl
-000019e0: 6965 6e74 2773 2067 5250 4320 636f 6e6e  ient's gRPC conn
-000019f0: 6563 7469 6f6e 2e0a 0a63 6c69 656e 742e  ection...client.
-00001a00: 636c 6f73 6528 290a 6060 600a 0a53 6565  close().```..See
-00001a10: 2062 656c 6f77 2066 6f72 206d 6f72 6520   below for more 
-00001a20: 6465 7461 696c 732e 0a0a 466f 7220 616e  details...For an
-00001a30: 2065 7861 6d70 6c65 206f 6620 7573 6167   example of usag
-00001a40: 652c 2073 6565 2074 6865 205b 6576 656e  e, see the [even
-00001a50: 7473 6f75 7263 696e 672d 6576 656e 7473  tsourcing-events
-00001a60: 746f 7265 6462 5d28 0a68 7474 7073 3a2f  toredb](.https:/
-00001a70: 2f67 6974 6875 622e 636f 6d2f 7079 6576  /github.com/pyev
-00001a80: 656e 7473 6f75 7263 696e 672f 6576 656e  entsourcing/even
-00001a90: 7473 6f75 7263 696e 672d 6576 656e 7473  tsourcing-events
-00001aa0: 746f 7265 6462 2920 7061 636b 6167 652e  toredb) package.
-00001ab0: 0a0a 2323 2054 6162 6c65 206f 6620 636f  ..## Table of co
-00001ac0: 6e74 656e 7473 0a0a 3c21 2d2d 2054 4f43  ntents..<!-- TOC
-00001ad0: 202d 2d3e 0a2a 205b 496e 7374 616c 6c20   -->.* [Install 
-00001ae0: 7061 636b 6167 655d 2823 696e 7374 616c  package](#instal
-00001af0: 6c2d 7061 636b 6167 6529 0a20 202a 205b  l-package).  * [
-00001b00: 4672 6f6d 2050 7950 495d 2823 6672 6f6d  From PyPI](#from
-00001b10: 2d70 7970 6929 0a20 202a 205b 5769 7468  -pypi).  * [With
-00001b20: 2050 6f65 7472 795d 2823 7769 7468 2d70   Poetry](#with-p
-00001b30: 6f65 7472 7929 0a2a 205b 4576 656e 7453  oetry).* [EventS
-00001b40: 746f 7265 4442 2073 6572 7665 725d 2823  toreDB server](#
-00001b50: 6576 656e 7473 746f 7265 6462 2d73 6572  eventstoredb-ser
-00001b60: 7665 7229 0a20 202a 205b 5275 6e20 636f  ver).  * [Run co
-00001b70: 6e74 6169 6e65 725d 2823 7275 6e2d 636f  ntainer](#run-co
-00001b80: 6e74 6169 6e65 7229 0a20 202a 205b 5374  ntainer).  * [St
-00001b90: 6f70 2063 6f6e 7461 696e 6572 5d28 2373  op container](#s
-00001ba0: 746f 702d 636f 6e74 6169 6e65 7229 0a2a  top-container).*
-00001bb0: 205b 4576 656e 7453 746f 7265 4442 2063   [EventStoreDB c
-00001bc0: 6c69 656e 745d 2823 6576 656e 7473 746f  lient](#eventsto
-00001bd0: 7265 6462 2d63 6c69 656e 7429 0a20 202a  redb-client).  *
-00001be0: 205b 496d 706f 7274 2063 6c61 7373 5d28   [Import class](
-00001bf0: 2369 6d70 6f72 742d 636c 6173 7329 0a20  #import-class). 
-00001c00: 202a 205b 436f 6e73 7472 7563 7420 636c   * [Construct cl
-00001c10: 6965 6e74 5d28 2363 6f6e 7374 7275 6374  ient](#construct
-00001c20: 2d63 6c69 656e 7429 0a2a 205b 436f 6e6e  -client).* [Conn
-00001c30: 6563 7469 6f6e 2073 7472 696e 6773 5d28  ection strings](
-00001c40: 2363 6f6e 6e65 6374 696f 6e2d 7374 7269  #connection-stri
-00001c50: 6e67 7329 0a20 202a 205b 5477 6f20 7363  ngs).  * [Two sc
-00001c60: 6865 6d65 735d 2823 7477 6f2d 7363 6865  hemes](#two-sche
-00001c70: 6d65 7329 0a20 202a 205b 5573 6572 2069  mes).  * [User i
-00001c80: 6e66 6f20 7374 7269 6e67 5d28 2375 7365  nfo string](#use
-00001c90: 722d 696e 666f 2d73 7472 696e 6729 0a20  r-info-string). 
-00001ca0: 202a 205b 5175 6572 7920 7374 7269 6e67   * [Query string
-00001cb0: 5d28 2371 7565 7279 2d73 7472 696e 6729  ](#query-string)
-00001cc0: 0a20 202a 205b 4578 616d 706c 6573 5d28  .  * [Examples](
-00001cd0: 2365 7861 6d70 6c65 7329 0a2a 205b 4576  #examples).* [Ev
-00001ce0: 656e 7420 6f62 6a65 6374 735d 2823 6576  ent objects](#ev
-00001cf0: 656e 742d 6f62 6a65 6374 7329 0a20 202a  ent-objects).  *
-00001d00: 205b 4e65 7720 6576 656e 7473 5d28 236e   [New events](#n
-00001d10: 6577 2d65 7665 6e74 7329 0a20 202a 205b  ew-events).  * [
-00001d20: 5265 636f 7264 6564 2065 7665 6e74 735d  Recorded events]
-00001d30: 2823 7265 636f 7264 6564 2d65 7665 6e74  (#recorded-event
-00001d40: 7329 0a2a 205b 5374 7265 616d 735d 2823  s).* [Streams](#
-00001d50: 7374 7265 616d 7329 0a20 202a 205b 4170  streams).  * [Ap
-00001d60: 7065 6e64 2065 7665 6e74 735d 2823 6170  pend events](#ap
-00001d70: 7065 6e64 2d65 7665 6e74 7329 0a20 202a  pend-events).  *
-00001d80: 205b 4964 656d 706f 7465 6e74 2061 7070   [Idempotent app
-00001d90: 656e 6420 6f70 6572 6174 696f 6e73 5d28  end operations](
-00001da0: 2369 6465 6d70 6f74 656e 742d 6170 7065  #idempotent-appe
-00001db0: 6e64 2d6f 7065 7261 7469 6f6e 7329 0a20  nd-operations). 
-00001dc0: 202a 205b 5265 6164 2073 7472 6561 6d20   * [Read stream 
-00001dd0: 6576 656e 7473 5d28 2372 6561 642d 7374  events](#read-st
-00001de0: 7265 616d 2d65 7665 6e74 7329 0a20 202a  ream-events).  *
-00001df0: 205b 4765 7420 6375 7272 656e 7420 7665   [Get current ve
-00001e00: 7273 696f 6e5d 2823 6765 742d 6375 7272  rsion](#get-curr
-00001e10: 656e 742d 7665 7273 696f 6e29 0a20 202a  ent-version).  *
-00001e20: 205b 486f 7720 746f 2069 6d70 6c65 6d65   [How to impleme
-00001e30: 6e74 2073 6e61 7073 686f 7474 696e 6720  nt snapshotting 
-00001e40: 7769 7468 2045 7665 6e74 5374 6f72 6544  with EventStoreD
-00001e50: 425d 2823 686f 772d 746f 2d69 6d70 6c65  B](#how-to-imple
-00001e60: 6d65 6e74 2d73 6e61 7073 686f 7474 696e  ment-snapshottin
-00001e70: 672d 7769 7468 2d65 7665 6e74 7374 6f72  g-with-eventstor
-00001e80: 6564 6229 0a20 202a 205b 5265 6164 2061  edb).  * [Read a
-00001e90: 6c6c 2065 7665 6e74 735d 2823 7265 6164  ll events](#read
-00001ea0: 2d61 6c6c 2d65 7665 6e74 7329 0a20 202a  -all-events).  *
-00001eb0: 205b 4765 7420 636f 6d6d 6974 2070 6f73   [Get commit pos
-00001ec0: 6974 696f 6e5d 2823 6765 742d 636f 6d6d  ition](#get-comm
-00001ed0: 6974 2d70 6f73 6974 696f 6e29 0a20 202a  it-position).  *
-00001ee0: 205b 4765 7420 7374 7265 616d 206d 6574   [Get stream met
-00001ef0: 6164 6174 615d 2823 6765 742d 7374 7265  adata](#get-stre
-00001f00: 616d 2d6d 6574 6164 6174 6129 0a20 202a  am-metadata).  *
-00001f10: 205b 5365 7420 7374 7265 616d 206d 6574   [Set stream met
-00001f20: 6164 6174 615d 2823 7365 742d 7374 7265  adata](#set-stre
-00001f30: 616d 2d6d 6574 6164 6174 6129 0a20 202a  am-metadata).  *
-00001f40: 205b 4465 6c65 7465 2073 7472 6561 6d5d   [Delete stream]
-00001f50: 2823 6465 6c65 7465 2d73 7472 6561 6d29  (#delete-stream)
-00001f60: 0a20 202a 205b 546f 6d62 7374 6f6e 6520  .  * [Tombstone 
-00001f70: 7374 7265 616d 5d28 2374 6f6d 6273 746f  stream](#tombsto
-00001f80: 6e65 2d73 7472 6561 6d29 0a2a 205b 4361  ne-stream).* [Ca
-00001f90: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-00001fa0: 696f 6e73 5d28 2363 6174 6368 2d75 702d  ions](#catch-up-
-00001fb0: 7375 6273 6372 6970 7469 6f6e 7329 0a20  subscriptions). 
-00001fc0: 202a 205b 5375 6273 6372 6962 6520 746f   * [Subscribe to
-00001fd0: 2061 6c6c 2065 7665 6e74 735d 2823 7375   all events](#su
-00001fe0: 6273 6372 6962 652d 746f 2d61 6c6c 2d65  bscribe-to-all-e
-00001ff0: 7665 6e74 7329 0a20 202a 205b 5375 6273  vents).  * [Subs
-00002000: 6372 6962 6520 746f 2073 7472 6561 6d20  cribe to stream 
-00002010: 6576 656e 7473 5d28 2373 7562 7363 7269  events](#subscri
-00002020: 6265 2d74 6f2d 7374 7265 616d 2d65 7665  be-to-stream-eve
-00002030: 6e74 7329 0a20 202a 205b 486f 7720 746f  nts).  * [How to
-00002040: 2069 6d70 6c65 6d65 6e74 2065 7861 6374   implement exact
-00002050: 6c79 2d6f 6e63 6520 6576 656e 7420 7072  ly-once event pr
-00002060: 6f63 6573 7369 6e67 5d28 2368 6f77 2d74  ocessing](#how-t
-00002070: 6f2d 696d 706c 656d 656e 742d 6578 6163  o-implement-exac
-00002080: 746c 792d 6f6e 6365 2d65 7665 6e74 2d70  tly-once-event-p
-00002090: 726f 6365 7373 696e 6729 0a2a 205b 5065  rocessing).* [Pe
-000020a0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-000020b0: 7074 696f 6e73 5d28 2370 6572 7369 7374  ptions](#persist
-000020c0: 656e 742d 7375 6273 6372 6970 7469 6f6e  ent-subscription
-000020d0: 7329 0a20 202a 205b 4372 6561 7465 2073  s).  * [Create s
-000020e0: 7562 7363 7269 7074 696f 6e20 746f 2061  ubscription to a
-000020f0: 6c6c 5d28 2363 7265 6174 652d 7375 6273  ll](#create-subs
-00002100: 6372 6970 7469 6f6e 2d74 6f2d 616c 6c29  cription-to-all)
-00002110: 0a20 202a 205b 5265 6164 2073 7562 7363  .  * [Read subsc
-00002120: 7269 7074 696f 6e20 746f 2061 6c6c 5d28  ription to all](
-00002130: 2372 6561 642d 7375 6273 6372 6970 7469  #read-subscripti
-00002140: 6f6e 2d74 6f2d 616c 6c29 0a20 202a 205b  on-to-all).  * [
-00002150: 486f 7720 746f 2077 7269 7465 2061 2070  How to write a p
-00002160: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00002170: 6970 7469 6f6e 2063 6f6e 7375 6d65 725d  iption consumer]
-00002180: 2823 686f 772d 746f 2d77 7269 7465 2d61  (#how-to-write-a
-00002190: 2d70 6572 7369 7374 656e 742d 7375 6273  -persistent-subs
-000021a0: 6372 6970 7469 6f6e 2d63 6f6e 7375 6d65  cription-consume
-000021b0: 7229 0a20 202a 205b 5570 6461 7465 2073  r).  * [Update s
-000021c0: 7562 7363 7269 7074 696f 6e20 746f 2061  ubscription to a
-000021d0: 6c6c 5d28 2375 7064 6174 652d 7375 6273  ll](#update-subs
-000021e0: 6372 6970 7469 6f6e 2d74 6f2d 616c 6c29  cription-to-all)
-000021f0: 0a20 202a 205b 4372 6561 7465 2073 7562  .  * [Create sub
-00002200: 7363 7269 7074 696f 6e20 746f 2073 7472  scription to str
-00002210: 6561 6d5d 2823 6372 6561 7465 2d73 7562  eam](#create-sub
-00002220: 7363 7269 7074 696f 6e2d 746f 2d73 7472  scription-to-str
-00002230: 6561 6d29 0a20 202a 205b 5265 6164 2073  eam).  * [Read s
-00002240: 7562 7363 7269 7074 696f 6e20 746f 2073  ubscription to s
-00002250: 7472 6561 6d5d 2823 7265 6164 2d73 7562  tream](#read-sub
-00002260: 7363 7269 7074 696f 6e2d 746f 2d73 7472  scription-to-str
-00002270: 6561 6d29 0a20 202a 205b 5570 6461 7465  eam).  * [Update
-00002280: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
-00002290: 2073 7472 6561 6d5d 2823 7570 6461 7465   stream](#update
-000022a0: 2d73 7562 7363 7269 7074 696f 6e2d 746f  -subscription-to
-000022b0: 2d73 7472 6561 6d29 0a20 202a 205b 5265  -stream).  * [Re
-000022c0: 706c 6179 2070 6172 6b65 6420 6576 656e  play parked even
-000022d0: 7473 5d28 2372 6570 6c61 792d 7061 726b  ts](#replay-park
-000022e0: 6564 2d65 7665 6e74 7329 0a20 202a 205b  ed-events).  * [
-000022f0: 4765 7420 7375 6273 6372 6970 7469 6f6e  Get subscription
-00002300: 2069 6e66 6f5d 2823 6765 742d 7375 6273   info](#get-subs
-00002310: 6372 6970 7469 6f6e 2d69 6e66 6f29 0a20  cription-info). 
-00002320: 202a 205b 4c69 7374 2073 7562 7363 7269   * [List subscri
-00002330: 7074 696f 6e73 5d28 236c 6973 742d 7375  ptions](#list-su
-00002340: 6273 6372 6970 7469 6f6e 7329 0a20 202a  bscriptions).  *
-00002350: 205b 4c69 7374 2073 7562 7363 7269 7074   [List subscript
-00002360: 696f 6e73 2074 6f20 7374 7265 616d 5d28  ions to stream](
-00002370: 236c 6973 742d 7375 6273 6372 6970 7469  #list-subscripti
-00002380: 6f6e 732d 746f 2d73 7472 6561 6d29 0a20  ons-to-stream). 
-00002390: 202a 205b 4465 6c65 7465 2073 7562 7363   * [Delete subsc
-000023a0: 7269 7074 696f 6e5d 2823 6465 6c65 7465  ription](#delete
-000023b0: 2d73 7562 7363 7269 7074 696f 6e29 0a2a  -subscription).*
-000023c0: 205b 4361 6c6c 2063 7265 6465 6e74 6961   [Call credentia
-000023d0: 6c73 5d28 2363 616c 6c2d 6372 6564 656e  ls](#call-creden
-000023e0: 7469 616c 7329 0a20 202a 205b 436f 6e73  tials).  * [Cons
-000023f0: 7472 7563 7420 6361 6c6c 2063 7265 6465  truct call crede
-00002400: 6e74 6961 6c73 5d28 2363 6f6e 7374 7275  ntials](#constru
-00002410: 6374 2d63 616c 6c2d 6372 6564 656e 7469  ct-call-credenti
-00002420: 616c 7329 0a2a 205b 436f 6e6e 6563 7469  als).* [Connecti
-00002430: 6f6e 5d28 2363 6f6e 6e65 6374 696f 6e29  on](#connection)
-00002440: 0a20 202a 205b 5265 636f 6e6e 6563 745d  .  * [Reconnect]
-00002450: 2823 7265 636f 6e6e 6563 7429 0a20 202a  (#reconnect).  *
-00002460: 205b 436c 6f73 655d 2823 636c 6f73 6529   [Close](#close)
-00002470: 0a2a 205b 4173 796e 6369 6f20 636c 6965  .* [Asyncio clie
-00002480: 6e74 5d28 2361 7379 6e63 696f 2d63 6c69  nt](#asyncio-cli
-00002490: 656e 7429 0a20 202a 205b 5379 6e6f 7073  ent).  * [Synops
-000024a0: 6973 5d28 2373 796e 6f70 7369 732d 3129  is](#synopsis-1)
-000024b0: 0a2a 205b 4e6f 7465 735d 2823 6e6f 7465  .* [Notes](#note
-000024c0: 7329 0a20 202a 205b 5265 6775 6c61 7220  s).  * [Regular 
-000024d0: 6578 7072 6573 7369 6f6e 2066 696c 7465  expression filte
-000024e0: 7273 5d28 2372 6567 756c 6172 2d65 7870  rs](#regular-exp
-000024f0: 7265 7373 696f 6e2d 6669 6c74 6572 7329  ression-filters)
-00002500: 0a20 202a 205b 5265 636f 6e6e 6563 7420  .  * [Reconnect 
-00002510: 616e 6420 7265 7472 7920 6d65 7468 6f64  and retry method
-00002520: 2064 6563 6f72 6174 6f72 735d 2823 7265   decorators](#re
-00002530: 636f 6e6e 6563 742d 616e 642d 7265 7472  connect-and-retr
-00002540: 792d 6d65 7468 6f64 2d64 6563 6f72 6174  y-method-decorat
-00002550: 6f72 7329 0a2a 205b 436f 6e74 7269 6275  ors).* [Contribu
-00002560: 746f 7273 5d28 2363 6f6e 7472 6962 7574  tors](#contribut
-00002570: 6f72 7329 0a20 202a 205b 496e 7374 616c  ors).  * [Instal
-00002580: 6c20 506f 6574 7279 5d28 2369 6e73 7461  l Poetry](#insta
-00002590: 6c6c 2d70 6f65 7472 7929 0a20 202a 205b  ll-poetry).  * [
-000025a0: 5365 7475 7020 666f 7220 5079 4368 6172  Setup for PyChar
-000025b0: 6d20 7573 6572 735d 2823 7365 7475 702d  m users](#setup-
-000025c0: 666f 722d 7079 6368 6172 6d2d 7573 6572  for-pycharm-user
-000025d0: 7329 0a20 202a 205b 5365 7475 7020 6672  s).  * [Setup fr
-000025e0: 6f6d 2063 6f6d 6d61 6e64 206c 696e 655d  om command line]
-000025f0: 2823 7365 7475 702d 6672 6f6d 2d63 6f6d  (#setup-from-com
-00002600: 6d61 6e64 2d6c 696e 6529 0a20 202a 205b  mand-line).  * [
-00002610: 5072 6f6a 6563 7420 4d61 6b65 6669 6c65  Project Makefile
-00002620: 2063 6f6d 6d61 6e64 735d 2823 7072 6f6a   commands](#proj
-00002630: 6563 742d 6d61 6b65 6669 6c65 2d63 6f6d  ect-makefile-com
-00002640: 6d61 6e64 7329 0a3c 212d 2d20 544f 4320  mands).<!-- TOC 
-00002650: 2d2d 3e0a 0a23 2320 496e 7374 616c 6c20  -->..## Install 
-00002660: 7061 636b 6167 650a 0a49 7420 6973 2072  package..It is r
-00002670: 6563 6f6d 6d65 6e64 6564 2074 6f20 696e  ecommended to in
-00002680: 7374 616c 6c20 5079 7468 6f6e 2070 6163  stall Python pac
-00002690: 6b61 6765 7320 696e 746f 2061 2050 7974  kages into a Pyt
-000026a0: 686f 6e20 7669 7274 7561 6c20 656e 7669  hon virtual envi
-000026b0: 726f 6e6d 656e 742e 0a0a 2323 2320 4672  ronment...### Fr
-000026c0: 6f6d 2050 7950 490a 0a59 6f75 2063 616e  om PyPI..You can
-000026d0: 2075 7365 2070 6970 2074 6f20 696e 7374   use pip to inst
-000026e0: 616c 6c20 7468 6973 2070 6163 6b61 6765  all this package
-000026f0: 2064 6972 6563 746c 7920 6672 6f6d 0a5b   directly from.[
-00002700: 7468 6520 5079 7468 6f6e 2050 6163 6b61  the Python Packa
-00002710: 6765 2049 6e64 6578 5d28 6874 7470 733a  ge Index](https:
-00002720: 2f2f 7079 7069 2e6f 7267 2f70 726f 6a65  //pypi.org/proje
-00002730: 6374 2f65 7364 6263 6c69 656e 742f 292e  ct/esdbclient/).
-00002740: 0a0a 2020 2020 2420 7069 7020 696e 7374  ..    $ pip inst
-00002750: 616c 6c20 6573 6462 636c 6965 6e74 0a0a  all esdbclient..
-00002760: 2323 2320 5769 7468 2050 6f65 7472 790a  ### With Poetry.
-00002770: 0a59 6f75 2063 616e 2075 7365 2050 6f65  .You can use Poe
-00002780: 7472 7920 746f 2061 6464 2074 6869 7320  try to add this 
-00002790: 7061 636b 6167 6520 746f 2079 6f75 7220  package to your 
-000027a0: 7079 7072 6f6a 6563 742e 746f 6d6c 2061  pyproject.toml a
-000027b0: 6e64 2069 6e73 7461 6c6c 2069 742e 0a0a  nd install it...
-000027c0: 2020 2020 2420 706f 6574 7279 2061 6464      $ poetry add
-000027d0: 2065 7364 6263 6c69 656e 740a 0a23 2320   esdbclient..## 
-000027e0: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
-000027f0: 7665 720a 0a54 6865 2045 7665 6e74 5374  ver..The EventSt
-00002800: 6f72 6544 4220 7365 7276 6572 2063 616e  oreDB server can
-00002810: 2062 6520 7275 6e20 6c6f 6361 6c6c 7920   be run locally 
-00002820: 7573 696e 6720 7468 6520 6f66 6669 6369  using the offici
-00002830: 616c 2044 6f63 6b65 7220 636f 6e74 6169  al Docker contai
-00002840: 6e65 7220 696d 6167 652e 0a0a 2323 2320  ner image...### 
-00002850: 5275 6e20 636f 6e74 6169 6e65 720a 0a46  Run container..F
-00002860: 6f72 2064 6576 656c 6f70 6d65 6e74 2c20  or development, 
-00002870: 796f 7520 6361 6e20 7275 6e20 6120 2273  you can run a "s
-00002880: 6563 7572 6522 2045 7665 6e74 5374 6f72  ecure" EventStor
-00002890: 6544 4220 7365 7276 6572 2075 7369 6e67  eDB server using
-000028a0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2063   the following c
-000028b0: 6f6d 6d61 6e64 2e0a 0a20 2020 2024 2064  ommand...    $ d
-000028c0: 6f63 6b65 7220 7275 6e20 2d64 202d 2d6e  ocker run -d --n
-000028d0: 616d 6520 6576 656e 7473 746f 7265 6462  ame eventstoredb
-000028e0: 2d73 6563 7572 6520 2d69 7420 2d70 2032  -secure -it -p 2
-000028f0: 3131 333a 3231 3133 202d 2d65 6e76 2022  113:2113 --env "
-00002900: 484f 4d45 3d2f 746d 7022 2065 7665 6e74  HOME=/tmp" event
-00002910: 7374 6f72 652f 6576 656e 7473 746f 7265  store/eventstore
-00002920: 3a32 312e 3130 2e39 2d62 7573 7465 722d  :21.10.9-buster-
-00002930: 736c 696d 202d 2d64 6576 0a0a 4173 2077  slim --dev..As w
-00002940: 6520 7769 6c6c 2073 6565 2c20 796f 7572  e will see, your
-00002950: 2063 6c69 656e 7420 7769 6c6c 206e 6565   client will nee
-00002960: 6420 616e 2045 7665 6e74 5374 6f72 6544  d an EventStoreD
-00002970: 4220 636f 6e6e 6563 7469 6f6e 2073 7472  B connection str
-00002980: 696e 6720 5552 4920 6173 2074 6865 2076  ing URI as the v
-00002990: 616c 7565 0a6f 6620 6974 7320 6075 7269  alue.of its `uri
-000029a0: 6020 636f 6e73 7472 7563 746f 7220 6172  ` constructor ar
-000029b0: 6775 6d65 6e74 2e20 5468 6520 636f 6e6e  gument. The conn
-000029c0: 6563 7469 6f6e 2073 7472 696e 6720 666f  ection string fo
-000029d0: 7220 7468 6973 2022 7365 6375 7265 2220  r this "secure" 
-000029e0: 4576 656e 7453 746f 7265 4442 0a73 6572  EventStoreDB.ser
-000029f0: 7665 7220 776f 756c 6420 6265 3a0a 0a20  ver would be:.. 
-00002a00: 2020 2065 7364 623a 2f2f 6164 6d69 6e3a     esdb://admin:
-00002a10: 6368 616e 6765 6974 406c 6f63 616c 686f  changeit@localho
-00002a20: 7374 3a32 3131 330a 0a54 6f20 636f 6e6e  st:2113..To conn
-00002a30: 6563 7420 746f 2061 2022 7365 6375 7265  ect to a "secure
-00002a40: 2220 7365 7276 6572 2c20 796f 7520 7769  " server, you wi
-00002a50: 6c6c 2075 7375 616c 6c79 206e 6565 6420  ll usually need 
-00002a60: 746f 2069 6e63 6c75 6465 2061 2022 7573  to include a "us
-00002a70: 6572 6e61 6d65 220a 616e 6420 6120 2270  ername".and a "p
-00002a80: 6173 7377 6f72 6422 2069 6e20 7468 6520  assword" in the 
-00002a90: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00002aa0: 672c 2073 6f20 7468 6174 2074 6865 2073  g, so that the s
-00002ab0: 6572 7665 7220 6361 6e20 6175 7468 656e  erver can authen
-00002ac0: 7469 6361 7465 2074 6865 0a63 6c69 656e  ticate the.clien
-00002ad0: 742e 2057 6974 6820 4576 656e 7453 746f  t. With EventSto
-00002ae0: 7265 4442 2c20 7468 6520 6465 6661 756c  reDB, the defaul
-00002af0: 7420 7573 6572 6e61 6d65 2069 7320 2261  t username is "a
-00002b00: 646d 696e 2220 616e 6420 7468 6520 6465  dmin" and the de
-00002b10: 6661 756c 7420 7061 7373 776f 7264 0a69  fault password.i
-00002b20: 7320 2263 6861 6e67 6569 7422 2e0a 0a57  s "changeit"...W
-00002b30: 6865 6e20 636f 6e6e 6563 7469 6e67 2074  hen connecting t
-00002b40: 6f20 6120 2273 6563 7572 6522 2073 6572  o a "secure" ser
-00002b50: 7665 722c 2079 6f75 7220 636c 6965 6e74  ver, your client
-00002b60: 2077 696c 6c20 616c 736f 206e 6565 6420   will also need 
-00002b70: 616e 2053 534c 2f54 4c53 2063 6572 7469  an SSL/TLS certi
-00002b80: 6669 6361 7465 0a61 7320 7468 6520 7661  ficate.as the va
-00002b90: 6c75 6520 6f66 2069 7473 2060 726f 6f74  lue of its `root
-00002ba0: 5f63 6572 7469 6669 6361 7465 7360 2063  _certificates` c
-00002bb0: 6f6e 7374 7275 6374 6f72 2061 7267 756d  onstructor argum
-00002bc0: 656e 742e 2054 6865 2063 6c69 656e 7420  ent. The client 
-00002bd0: 7573 6573 2074 6865 0a53 534c 2f54 4c53  uses the.SSL/TLS
-00002be0: 2063 6572 7469 6669 6361 7465 2074 6f20   certificate to 
-00002bf0: 6175 7468 656e 7469 6361 7465 2074 6865  authenticate the
-00002c00: 2073 6572 7665 722e 2046 6f72 2064 6576   server. For dev
-00002c10: 656c 6f70 6d65 6e74 2c20 796f 7520 6361  elopment, you ca
-00002c20: 6e20 6569 7468 6572 2075 7365 2074 6865  n either use the
-00002c30: 0a53 534c 2f54 4c53 2063 6572 7469 6669  .SSL/TLS certifi
-00002c40: 6361 7465 206f 6620 7468 6520 6365 7274  cate of the cert
-00002c50: 6966 6963 6174 6520 6175 7468 6f72 6974  ificate authorit
-00002c60: 7920 7573 6564 2074 6f20 6372 6561 7465  y used to create
-00002c70: 2074 6865 2073 6572 7665 7227 7320 6365   the server's ce
-00002c80: 7274 6966 6963 6174 652c 0a6f 7220 7768  rtificate,.or wh
-00002c90: 656e 2075 7369 6e67 2061 2073 696e 676c  en using a singl
-00002ca0: 652d 6e6f 6465 2063 6c75 7374 6572 2c20  e-node cluster, 
-00002cb0: 796f 7520 6361 6e20 7573 6520 7468 6520  you can use the 
-00002cc0: 7365 7276 6572 2063 6572 7469 6669 6361  server certifica
-00002cd0: 7465 2069 7473 656c 662e 2059 6f75 2063  te itself. You c
-00002ce0: 616e 0a67 6574 2074 6865 2073 6572 7665  an.get the serve
-00002cf0: 7220 6365 7274 6966 6963 6174 6520 7769  r certificate wi
-00002d00: 7468 2074 6865 2066 6f6c 6c6f 7769 6e67  th the following
-00002d10: 2050 7974 686f 6e20 636f 6465 2e0a 0a0a   Python code....
-00002d20: 6060 6070 7974 686f 6e0a 696d 706f 7274  ```python.import
-00002d30: 2073 736c 0a0a 7365 7276 6572 5f63 6572   ssl..server_cer
-00002d40: 7469 6669 6361 7465 203d 2073 736c 2e67  tificate = ssl.g
-00002d50: 6574 5f73 6572 7665 725f 6365 7274 6966  et_server_certif
-00002d60: 6963 6174 6528 6164 6472 3d28 276c 6f63  icate(addr=('loc
-00002d70: 616c 686f 7374 272c 2032 3131 3329 290a  alhost', 2113)).
-00002d80: 6060 600a 0a41 6c74 6572 6e61 7469 7665  ```..Alternative
-00002d90: 6c79 2c20 796f 7520 6361 6e20 7374 6172  ly, you can star
-00002da0: 7420 616e 2022 696e 7365 6375 7265 2220  t an "insecure" 
-00002db0: 7365 7276 6572 2075 7369 6e67 2074 6865  server using the
-00002dc0: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
-00002dd0: 6e64 2e0a 0a20 2020 2024 2064 6f63 6b65  nd...    $ docke
-00002de0: 7220 7275 6e20 2d64 202d 2d6e 616d 6520  r run -d --name 
-00002df0: 6576 656e 7473 746f 7265 6462 2d69 6e73  eventstoredb-ins
-00002e00: 6563 7572 6520 2d69 7420 2d70 2032 3131  ecure -it -p 211
-00002e10: 333a 3231 3133 2065 7665 6e74 7374 6f72  3:2113 eventstor
-00002e20: 652f 6576 656e 7473 746f 7265 3a32 312e  e/eventstore:21.
-00002e30: 3130 2e39 2d62 7573 7465 722d 736c 696d  10.9-buster-slim
-00002e40: 202d 2d69 6e73 6563 7572 650a 0a54 6865   --insecure..The
-00002e50: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-00002e60: 6e67 2055 5249 2066 6f72 2074 6869 7320  ng URI for this 
-00002e70: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
-00002e80: 7220 776f 756c 6420 6265 3a0a 0a20 2020  r would be:..   
-00002e90: 2065 7364 623a 2f2f 6c6f 6361 6c68 6f73   esdb://localhos
-00002ea0: 743a 3231 3133 3f54 6c73 3d66 616c 7365  t:2113?Tls=false
-00002eb0: 0a0a 4173 2077 6520 7769 6c6c 2073 6565  ..As we will see
-00002ec0: 2c20 7768 656e 2063 6f6e 6e65 6374 696e  , when connectin
-00002ed0: 6720 746f 2061 6e20 2269 6e73 6563 7572  g to an "insecur
-00002ee0: 6522 2073 6572 7665 722c 2074 6865 7265  e" server, there
-00002ef0: 2069 7320 6e6f 206e 6565 6420 746f 2069   is no need to i
-00002f00: 6e63 6c75 6465 0a61 2022 7573 6572 6e61  nclude.a "userna
-00002f10: 6d65 2220 616e 6420 6120 2270 6173 7377  me" and a "passw
-00002f20: 6f72 6422 2069 6e20 7468 6520 636f 6e6e  ord" in the conn
-00002f30: 6563 7469 6f6e 2073 7472 696e 672e 2049  ection string. I
-00002f40: 6620 796f 7520 646f 2c20 7468 6573 6520  f you do, these 
-00002f50: 7661 6c75 6573 2077 696c 6c0a 6265 2069  values will.be i
-00002f60: 676e 6f72 6564 2062 7920 7468 6520 636c  gnored by the cl
-00002f70: 6965 6e74 2c20 736f 2074 6861 7420 7468  ient, so that th
-00002f80: 6579 2061 7265 206e 6f74 2073 656e 7420  ey are not sent 
-00002f90: 6f76 6572 2061 6e20 696e 7365 6375 7265  over an insecure
-00002fa0: 2063 6861 6e6e 656c 2e0a 0a50 6c65 6173   channel...Pleas
-00002fb0: 6520 6e6f 7465 2c20 7468 6520 2269 6e73  e note, the "ins
-00002fc0: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
-00002fd0: 6e20 7374 7269 6e67 2075 7365 7320 6120  n string uses a 
-00002fe0: 7175 6572 7920 7374 7269 6e67 2077 6974  query string wit
-00002ff0: 6820 7468 6520 6669 656c 642d 7661 6c75  h the field-valu
-00003000: 650a 6054 6c73 3d66 616c 7365 602e 2054  e.`Tls=false`. T
-00003010: 6865 2076 616c 7565 206f 6620 7468 6973  he value of this
-00003020: 2066 6965 6c64 2069 7320 6279 2064 6566   field is by def
-00003030: 6175 6c74 2060 7472 7565 602e 0a0a 2323  ault `true`...##
-00003040: 2320 5374 6f70 2063 6f6e 7461 696e 6572  # Stop container
-00003050: 0a0a 546f 2073 746f 7020 616e 6420 7265  ..To stop and re
-00003060: 6d6f 7665 2074 6865 2022 7365 6375 7265  move the "secure
-00003070: 2220 636f 6e74 6169 6e65 722c 2075 7365  " container, use
-00003080: 2074 6865 2066 6f6c 6c6f 7769 6e67 2044   the following D
-00003090: 6f63 6b65 7220 636f 6d6d 616e 6473 2e0a  ocker commands..
-000030a0: 0a20 2020 2024 2064 6f63 6b65 7220 7374  .    $ docker st
-000030b0: 6f70 2065 7665 6e74 7374 6f72 6564 622d  op eventstoredb-
-000030c0: 7365 6375 7265 0a09 2420 646f 636b 6572  secure..$ docker
-000030d0: 2072 6d20 6576 656e 7473 746f 7265 6462   rm eventstoredb
-000030e0: 2d73 6563 7572 650a 0a54 6f20 7374 6f70  -secure..To stop
-000030f0: 2061 6e64 2072 656d 6f76 6520 7468 6520   and remove the 
-00003100: 2269 6e73 6563 7572 6522 2063 6f6e 7461  "insecure" conta
-00003110: 696e 6572 2c20 7573 6520 7468 6520 666f  iner, use the fo
-00003120: 6c6c 6f77 696e 6720 446f 636b 6572 2063  llowing Docker c
-00003130: 6f6d 6d61 6e64 732e 0a0a 2020 2020 2420  ommands...    $ 
-00003140: 646f 636b 6572 2073 746f 7020 6576 656e  docker stop even
-00003150: 7473 746f 7265 6462 2d69 6e73 6563 7572  tstoredb-insecur
-00003160: 650a 0924 2064 6f63 6b65 7220 726d 2065  e..$ docker rm e
-00003170: 7665 6e74 7374 6f72 6564 622d 696e 7365  ventstoredb-inse
-00003180: 6375 7265 0a0a 0a23 2320 4576 656e 7453  cure...## EventS
-00003190: 746f 7265 4442 2063 6c69 656e 740a 0a54  toreDB client..T
-000031a0: 6869 7320 4576 656e 7453 746f 7265 4442  his EventStoreDB
-000031b0: 2063 6c69 656e 7420 6973 2069 6d70 6c65   client is imple
-000031c0: 6d65 6e74 6564 2069 6e20 7468 6520 6065  mented in the `e
-000031d0: 7364 6263 6c69 656e 7460 2070 6163 6b61  sdbclient` packa
-000031e0: 6765 2077 6974 680a 7468 6520 6045 7665  ge with.the `Eve
-000031f0: 6e74 5374 6f72 6544 4243 6c69 656e 7460  ntStoreDBClient`
-00003200: 2063 6c61 7373 2e0a 0a23 2323 2049 6d70   class...### Imp
-00003210: 6f72 7420 636c 6173 730a 0a54 6865 2060  ort class..The `
-00003220: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
-00003230: 6e74 6020 636c 6173 7320 6361 6e20 6265  nt` class can be
-00003240: 2069 6d70 6f72 7465 6420 6672 6f6d 2074   imported from t
-00003250: 6865 2060 6573 6462 636c 6965 6e74 6020  he `esdbclient` 
-00003260: 7061 636b 6167 652e 0a0a 6060 6070 7974  package...```pyt
-00003270: 686f 6e0a 6672 6f6d 2065 7364 6263 6c69  hon.from esdbcli
-00003280: 656e 7420 696d 706f 7274 2045 7665 6e74  ent import Event
-00003290: 5374 6f72 6544 4243 6c69 656e 740a 6060  StoreDBClient.``
-000032a0: 600a 0a23 2323 2043 6f6e 7374 7275 6374  `..### Construct
-000032b0: 2063 6c69 656e 740a 0a54 6865 2060 4576   client..The `Ev
-000032c0: 656e 7453 746f 7265 4442 436c 6965 6e74  entStoreDBClient
-000032d0: 6020 636c 6173 7320 6861 7320 6f6e 6520  ` class has one 
-000032e0: 7265 7175 6972 6564 2063 6f6e 7374 7275  required constru
-000032f0: 6374 6f72 2061 7267 756d 656e 742c 2060  ctor argument, `
-00003300: 7572 6960 2c20 616e 6420 6f6e 650a 6f70  uri`, and one.op
-00003310: 7469 6f6e 616c 2063 6f6e 7374 7275 6374  tional construct
-00003320: 6f72 2061 7267 756d 656e 742c 2060 726f  or argument, `ro
-00003330: 6f74 5f63 6572 7469 6669 6361 7465 7360  ot_certificates`
-00003340: 2e0a 0a54 6865 2060 7572 6960 2061 7267  ...The `uri` arg
-00003350: 756d 656e 7420 6973 2065 7870 6563 7465  ument is expecte
-00003360: 6420 746f 2062 6520 616e 2045 7665 6e74  d to be an Event
-00003370: 5374 6f72 6544 4220 636f 6e6e 6563 7469  StoreDB connecti
-00003380: 6f6e 2073 7472 696e 6720 5552 4920 7468  on string URI th
-00003390: 6174 0a63 6f6e 666f 726d 7320 7769 7468  at.conforms with
-000033a0: 2074 6865 2073 7461 6e64 6172 6420 4576   the standard Ev
-000033b0: 656e 7453 746f 7265 4442 2022 6573 6462  entStoreDB "esdb
-000033c0: 2220 6f72 2022 6573 6462 2b64 6973 636f  " or "esdb+disco
-000033d0: 7665 7222 2055 5249 2073 6368 656d 6573  ver" URI schemes
-000033e0: 2e0a 0a46 6f72 2065 7861 6d70 6c65 2c20  ...For example, 
-000033f0: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
-00003400: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
-00003410: 7370 6563 6966 6965 7320 7468 6174 2074  specifies that t
-00003420: 6865 2063 6c69 656e 7420 7368 6f75 6c64  he client should
-00003430: 0a61 7474 656d 7074 2074 6f20 6372 6561  .attempt to crea
-00003440: 7465 2061 2022 7365 6375 7265 2220 636f  te a "secure" co
-00003450: 6e6e 6563 7469 6f6e 2074 6f20 706f 7274  nnection to port
-00003460: 2032 3131 3320 6f6e 2022 6c6f 6361 6c68   2113 on "localh
-00003470: 6f73 7422 2c20 616e 6420 7573 6520 7468  ost", and use th
-00003480: 650a 636c 6965 6e74 2063 7265 6465 6e74  e.client credent
-00003490: 6961 6c73 2022 7573 6572 6e61 6d65 2220  ials "username" 
-000034a0: 616e 6420 2270 6173 7377 6f72 6422 2077  and "password" w
-000034b0: 6865 6e20 6d61 6b69 6e67 2063 616c 6c73  hen making calls
-000034c0: 2074 6f20 7468 6520 7365 7276 6572 2e0a   to the server..
-000034d0: 0a20 2020 2065 7364 623a 2f2f 7573 6572  .    esdb://user
-000034e0: 6e61 6d65 3a70 6173 7377 6f72 6440 6c6f  name:password@lo
-000034f0: 6361 6c68 6f73 743a 3231 3133 3f54 6c73  calhost:2113?Tls
-00003500: 3d74 7275 650a 0a54 6865 2063 6c69 656e  =true..The clien
-00003510: 7420 6d75 7374 2062 6520 636f 6e66 6967  t must be config
-00003520: 7572 6564 2074 6f20 6372 6561 7465 2061  ured to create a
-00003530: 2022 7365 6375 7265 2220 636f 6e6e 6563   "secure" connec
-00003540: 7469 6f6e 2074 6f20 6120 2273 6563 7572  tion to a "secur
-00003550: 6522 2073 6572 7665 722c 0a6f 7220 616c  e" server,.or al
-00003560: 7465 726e 6174 6976 656c 7920 616e 2022  ternatively an "
-00003570: 696e 7365 6375 7265 2220 636f 6e6e 6563  insecure" connec
-00003580: 7469 6f6e 2074 6f20 616e 2022 696e 7365  tion to an "inse
-00003590: 6375 7265 2220 7365 7276 6572 2e20 4279  cure" server. By
-000035a0: 2064 6566 6175 6c74 2c20 7468 650a 636c   default, the.cl
-000035b0: 6965 6e74 2077 696c 6c20 6174 7465 6d70  ient will attemp
-000035c0: 7420 746f 2063 7265 6174 6520 6120 2273  t to create a "s
-000035d0: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
-000035e0: 6e2e 2041 6e64 2073 6f2c 2077 6865 6e20  n. And so, when 
-000035f0: 636f 6e6e 6563 7469 6e67 2074 6f20 616e  connecting to an
-00003600: 0a22 696e 7365 6375 7265 2220 7365 7276  ."insecure" serv
-00003610: 6572 2c20 7468 6520 636f 6e6e 6563 7469  er, the connecti
-00003620: 6f6e 2073 7472 696e 6720 6d75 7374 2073  on string must s
-00003630: 7065 6369 6679 2074 6861 7420 7468 6520  pecify that the 
-00003640: 636c 6965 6e74 2073 686f 756c 6420 6174  client should at
-00003650: 7465 6d70 740a 746f 206d 616b 6520 616e  tempt.to make an
-00003660: 2022 696e 7365 6375 7265 2220 636f 6e6e   "insecure" conn
-00003670: 6563 7469 6f6e 2e0a 0a54 6865 2066 6f6c  ection...The fol
-00003680: 6c6f 7769 6e67 2063 6f6e 6e65 6374 696f  lowing connectio
-00003690: 6e20 7374 7269 6e67 2073 7065 6369 6669  n string specifi
-000036a0: 6573 2074 6861 7420 7468 6520 636c 6965  es that the clie
-000036b0: 6e74 2073 686f 756c 640a 6174 7465 6d70  nt should.attemp
-000036c0: 7420 746f 2063 7265 6174 6520 616e 2022  t to create an "
-000036d0: 696e 7365 6375 7265 2220 636f 6e6e 6563  insecure" connec
-000036e0: 7469 6f6e 2074 6f20 706f 7274 2032 3131  tion to port 211
-000036f0: 3320 6f6e 2022 6c6f 6361 6c68 6f73 7422  3 on "localhost"
-00003700: 2e0a 5768 656e 2063 6f6e 6e65 6374 696e  ..When connectin
-00003710: 6720 746f 2061 6e20 2269 6e73 6563 7572  g to an "insecur
-00003720: 6522 2073 6572 7665 722c 2074 6865 2063  e" server, the c
-00003730: 6c69 656e 7420 7769 6c6c 2069 676e 6f72  lient will ignor
-00003740: 6520 616e 790a 7573 6572 6e61 6d65 2061  e any.username a
-00003750: 6e64 2070 6173 7377 6f72 6420 696e 666f  nd password info
-00003760: 726d 6174 696f 6e20 696e 636c 7564 6564  rmation included
-00003770: 2069 6e20 7468 6520 636f 6e6e 6563 7469   in the connecti
-00003780: 6f6e 2073 7472 696e 672c 0a73 6f20 7468  on string,.so th
-00003790: 6174 2075 7365 726e 616d 6573 2061 6e64  at usernames and
-000037a0: 2070 6173 7377 6f72 6473 2061 7265 206e   passwords are n
-000037b0: 6f74 2073 656e 7420 6f76 6572 2061 6e20  ot sent over an 
-000037c0: 2269 6e73 6563 7572 6522 2063 6f6e 6e65  "insecure" conne
-000037d0: 6374 696f 6e2e 0a0a 2020 2020 6573 6462  ction...    esdb
-000037e0: 3a2f 2f6c 6f63 616c 686f 7374 3a32 3131  ://localhost:211
-000037f0: 333f 546c 733d 6661 6c73 650a 0a50 6c65  3?Tls=false..Ple
-00003800: 6173 6520 6e6f 7465 2c20 7468 6520 2269  ase note, the "i
-00003810: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
-00003820: 696f 6e20 7374 7269 6e67 2075 7365 7320  ion string uses 
-00003830: 6120 7175 6572 7920 7374 7269 6e67 2077  a query string w
-00003840: 6974 6820 7468 6520 6669 656c 642d 7661  ith the field-va
-00003850: 6c75 650a 6054 6c73 3d66 616c 7365 602e  lue.`Tls=false`.
-00003860: 2054 6865 2076 616c 7565 206f 6620 7468   The value of th
-00003870: 6973 2066 6965 6c64 2069 7320 6279 2064  is field is by d
-00003880: 6566 6175 6c74 2060 7472 7565 602e 2055  efault `true`. U
-00003890: 6e6c 6573 7320 7468 6520 636f 6e6e 6563  nless the connec
-000038a0: 7469 6f6e 2073 7472 696e 670a 5552 4920  tion string.URI 
-000038b0: 696e 636c 7564 6573 2074 6865 2066 6965  includes the fie
-000038c0: 6c64 2d76 616c 7565 2060 546c 733d 6661  ld-value `Tls=fa
-000038d0: 6c73 6560 2069 6e20 7468 6520 7175 6572  lse` in the quer
-000038e0: 7920 7374 7269 6e67 2c20 7468 6520 6072  y string, the `r
-000038f0: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
-00003900: 600a 636f 6e73 7472 7563 746f 7220 6172  `.constructor ar
-00003910: 6775 6d65 6e74 2069 7320 616c 736f 2072  gument is also r
-00003920: 6571 7569 7265 642e 0a0a 5768 656e 2063  equired...When c
-00003930: 6f6e 6e65 6374 696e 6720 746f 2061 2022  onnecting to a "
-00003940: 7365 6375 7265 2220 7365 7276 6572 2c20  secure" server, 
-00003950: 7468 6520 6072 6f6f 745f 6365 7274 6966  the `root_certif
-00003960: 6963 6174 6573 6020 6172 6775 6d65 6e74  icates` argument
-00003970: 2069 7320 6578 7065 6374 6564 2074 6f0a   is expected to.
-00003980: 6265 2061 2050 7974 686f 6e20 6073 7472  be a Python `str
-00003990: 6020 636f 6e74 6169 6e69 6e67 2050 454d  ` containing PEM
-000039a0: 2065 6e63 6f64 6564 2053 534c 2f54 4c53   encoded SSL/TLS
-000039b0: 2072 6f6f 7420 6365 7274 6966 6963 6174   root certificat
-000039c0: 6573 2e20 5468 6973 2076 616c 7565 2069  es. This value i
-000039d0: 730a 7061 7373 6564 2064 6972 6563 746c  s.passed directl
-000039e0: 7920 746f 2060 6772 7063 2e73 736c 5f63  y to `grpc.ssl_c
-000039f0: 6861 6e6e 656c 5f63 7265 6465 6e74 6961  hannel_credentia
-00003a00: 6c73 2829 602e 2049 7420 6973 2075 7365  ls()`. It is use
-00003a10: 6420 666f 7220 6175 7468 656e 7469 6361  d for authentica
-00003a20: 7469 6e67 2074 6865 0a73 6572 7665 7220  ting the.server 
-00003a30: 746f 2074 6865 2063 6c69 656e 742e 2049  to the client. I
-00003a40: 7420 6973 2063 6f6d 6d6f 6e6c 7920 7468  t is commonly th
-00003a50: 6520 6365 7274 6966 6963 6174 6520 6f66  e certificate of
-00003a60: 2074 6865 2063 6572 7469 6669 6361 7465   the certificate
-00003a70: 2061 7574 686f 7269 7479 2074 6861 740a   authority that.
-00003a80: 7761 7320 7265 7370 6f6e 7369 626c 6520  was responsible 
-00003a90: 666f 7220 6765 6e65 7261 7469 6e67 2074  for generating t
-00003aa0: 6865 2053 534c 2f54 4c53 2063 6572 7469  he SSL/TLS certi
-00003ab0: 6669 6361 7465 2075 7365 6420 6279 2074  ficate used by t
-00003ac0: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
-00003ad0: 7365 7276 6572 2e0a 4275 742c 2061 6c74  server..But, alt
-00003ae0: 6572 6e61 7469 7665 6c79 2066 6f72 2064  ernatively for d
-00003af0: 6576 656c 6f70 6d65 6e74 2c20 796f 7520  evelopment, you 
-00003b00: 6361 6e20 7573 6520 7468 6520 7365 7276  can use the serv
-00003b10: 6572 2773 2063 6572 7469 6669 6361 7465  er's certificate
-00003b20: 2069 7473 656c 662e 0a0a 496e 2074 6865   itself...In the
-00003b30: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
-00003b40: 7468 6520 636f 6e73 7472 7563 746f 7220  the constructor 
-00003b50: 6172 6775 6d65 6e74 2076 616c 7565 7320  argument values 
-00003b60: 6172 6520 7461 6b65 6e20 6672 6f6d 2074  are taken from t
-00003b70: 6865 206f 7065 7261 7469 6e67 0a73 7973  he operating.sys
-00003b80: 7465 6d20 656e 7669 726f 6e6d 656e 742e  tem environment.
-00003b90: 2054 6869 7320 6973 2061 2074 7970 6963   This is a typic
-00003ba0: 616c 2061 7272 616e 6765 6d65 6e74 2069  al arrangement i
-00003bb0: 6e20 6120 7072 6f64 7563 7469 6f6e 2065  n a production e
-00003bc0: 6e76 6972 6f6e 6d65 6e74 2e20 4974 2069  nvironment. It i
-00003bd0: 730a 646f 6e65 2074 6869 7320 7761 7920  s.done this way 
-00003be0: 6865 7265 2073 6f20 7468 6174 2074 6865  here so that the
-00003bf0: 2063 6f64 6520 696e 2074 6869 7320 646f   code in this do
-00003c00: 6375 6d65 6e74 6174 696f 6e20 6361 6e20  cumentation can 
-00003c10: 6265 2074 6573 7465 6420 7769 7468 2062  be tested with b
-00003c20: 6f74 680a 6120 2273 6563 7572 6522 2061  oth.a "secure" a
-00003c30: 6e64 2061 6e20 2269 6e73 6563 7572 6522  nd an "insecure"
-00003c40: 2073 6572 7665 722e 0a0a 6060 6070 7974   server...```pyt
-00003c50: 686f 6e0a 696d 706f 7274 206f 730a 0a63  hon.import os..c
-00003c60: 6c69 656e 7420 3d20 4576 656e 7453 746f  lient = EventSto
-00003c70: 7265 4442 436c 6965 6e74 280a 2020 2020  reDBClient(.    
-00003c80: 7572 693d 6f73 2e67 6574 656e 7628 2245  uri=os.getenv("E
-00003c90: 5344 425f 5552 4922 292c 0a20 2020 2072  SDB_URI"),.    r
-00003ca0: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
-00003cb0: 3d6f 732e 6765 7465 6e76 2822 4553 4442  =os.getenv("ESDB
-00003cc0: 5f52 4f4f 545f 4345 5254 4946 4943 4154  _ROOT_CERTIFICAT
-00003cd0: 4553 2229 2c0a 290a 6060 600a 0a23 2320  ES"),.).```..## 
-00003ce0: 436f 6e6e 6563 7469 6f6e 2073 7472 696e  Connection strin
-00003cf0: 6773 0a0a 416e 2045 7665 6e74 5374 6f72  gs..An EventStor
-00003d00: 6544 4220 636f 6e6e 6563 7469 6f6e 2073  eDB connection s
-00003d10: 7472 696e 6720 6973 2061 2055 5249 2074  tring is a URI t
-00003d20: 6861 7420 636f 6e66 6f72 6d73 2077 6974  hat conforms wit
-00003d30: 6820 6f6e 6520 6f66 2074 776f 2070 6f73  h one of two pos
-00003d40: 7369 626c 650a 7363 6865 6d65 733a 2065  sible.schemes: e
-00003d50: 6974 6865 7220 7468 6520 2265 7364 6222  ither the "esdb"
-00003d60: 2073 6368 656d 652c 206f 7220 7468 6520   scheme, or the 
-00003d70: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
-00003d80: 7363 6865 6d65 2e0a 0a54 6865 2073 796e  scheme...The syn
-00003d90: 7461 7820 616e 6420 7365 6d61 6e74 6963  tax and semantic
-00003da0: 7320 6f66 2074 6865 2045 7665 6e74 5374  s of the EventSt
-00003db0: 6f72 6544 4220 5552 4920 7363 6865 6d65  oreDB URI scheme
-00003dc0: 7320 6172 6520 6465 7363 7269 6265 6420  s are described 
-00003dd0: 6265 6c6f 772e 2054 6865 0a73 796e 7461  below. The.synta
-00003de0: 7820 6973 2064 6566 696e 6564 2075 7369  x is defined usi
-00003df0: 6e67 205b 4542 4e46 5d28 6874 7470 733a  ng [EBNF](https:
-00003e00: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
-00003e10: 7267 2f77 696b 692f 4578 7465 6e64 6564  rg/wiki/Extended
-00003e20: 5f42 6163 6b75 73e2 8093 4e61 7572 5f66  _Backus...Naur_f
-00003e30: 6f72 6d29 2e0a 0a23 2323 2054 776f 2073  orm)...### Two s
-00003e40: 6368 656d 6573 0a0a 5468 6520 2265 7364  chemes..The "esd
-00003e50: 6222 2055 5249 2073 6368 656d 6520 6361  b" URI scheme ca
-00003e60: 6e20 6265 2064 6566 696e 6564 2069 6e20  n be defined in 
-00003e70: 7468 6520 666f 6c6c 6f77 696e 6720 7761  the following wa
-00003e80: 792e 0a0a 2020 2020 6573 6462 2d75 7269  y...    esdb-uri
-00003e90: 203d 2022 6573 6462 3a2f 2f22 202c 205b   = "esdb://" , [
-00003ea0: 2075 7365 722d 696e 666f 202c 2022 4022   user-info , "@"
-00003eb0: 205d 202c 2067 7270 632d 7461 7267 6574   ] , grpc-target
-00003ec0: 2c20 7b20 222c 2220 2c20 6772 7063 2d74  , { "," , grpc-t
-00003ed0: 6172 6765 7420 7d20 2c20 5b20 223f 2220  arget } , [ "?" 
-00003ee0: 2c20 7175 6572 792d 7374 7269 6e67 205d  , query-string ]
-00003ef0: 203b 0a0a 496e 2074 6865 2022 6573 6462   ;..In the "esdb
-00003f00: 2220 5552 4920 7363 6865 6d65 2c20 6166  " URI scheme, af
-00003f10: 7465 7220 7468 6520 6f70 7469 6f6e 616c  ter the optional
-00003f20: 2075 7365 7220 696e 666f 2073 7472 696e   user info strin
-00003f30: 672c 2074 6865 7265 206d 7573 7420 6265  g, there must be
-00003f40: 2061 7420 6c65 6173 740a 6f6e 6520 6752   at least.one gR
-00003f50: 5043 2074 6172 6765 742e 2049 6620 7468  PC target. If th
-00003f60: 6572 6520 6172 6520 7365 7665 7261 6c20  ere are several 
-00003f70: 6752 5043 2074 6172 6765 7473 2c20 7468  gRPC targets, th
-00003f80: 6579 206d 7573 7420 6265 2073 6570 6172  ey must be separ
-00003f90: 6174 6564 2066 726f 6d20 6561 6368 0a6f  ated from each.o
-00003fa0: 7468 6572 2077 6974 6820 7468 6520 222c  ther with the ",
-00003fb0: 2220 6368 6172 6163 7465 722e 2045 6163  " character. Eac
-00003fc0: 6820 6752 5043 2074 6172 6765 7420 7368  h gRPC target sh
-00003fd0: 6f75 6c64 2069 6e64 6963 6174 6520 616e  ould indicate an
-00003fe0: 2045 7665 6e74 5374 6f72 6544 4220 6752   EventStoreDB gR
-00003ff0: 5043 0a73 6572 7665 7220 736f 636b 6574  PC.server socket
-00004000: 2c20 6279 2073 7065 6369 6679 696e 6720  , by specifying 
-00004010: 6120 686f 7374 2061 6e64 2061 2070 6f72  a host and a por
-00004020: 7420 6e75 6d62 6572 2073 6570 6172 6174  t number separat
-00004030: 6564 2077 6974 6820 7468 6520 223a 2220  ed with the ":" 
-00004040: 6368 6172 6163 7465 722e 0a54 6865 2068  character..The h
-00004050: 6f73 7420 6d61 7920 6265 2061 2068 6f73  ost may be a hos
-00004060: 746e 616d 6520 7468 6174 2063 616e 2062  tname that can b
-00004070: 6520 7265 736f 6c76 6564 2074 6f20 616e  e resolved to an
-00004080: 2049 5020 6164 6472 6573 732c 206f 7220   IP address, or 
-00004090: 616e 2049 5020 6164 6472 6573 732e 0a0a  an IP address...
-000040a0: 2020 2020 6772 7063 2d74 6172 6765 7420      grpc-target 
-000040b0: 3d20 2820 686f 7374 6e61 6d65 207c 2069  = ( hostname | i
-000040c0: 702d 6164 6472 6573 7320 2920 2c20 223a  p-address ) , ":
-000040d0: 2220 2c20 706f 7274 2d6e 756d 6265 7220  " , port-number 
-000040e0: 3b0a 0a0a 5468 6520 2265 7364 622b 6469  ;...The "esdb+di
-000040f0: 7363 6f76 6572 2220 5552 4920 7363 6865  scover" URI sche
-00004100: 6d65 2063 616e 2062 6520 6465 6669 6e65  me can be define
-00004110: 6420 696e 2074 6865 2066 6f6c 6c6f 7769  d in the followi
-00004120: 6e67 2077 6179 2e0a 0a20 2020 2065 7364  ng way...    esd
-00004130: 622d 6469 7363 6f76 6572 2d75 7269 203d  b-discover-uri =
-00004140: 2022 6573 6462 2b64 6973 636f 7665 723a   "esdb+discover:
-00004150: 2f2f 2220 2c20 5b20 7573 6572 2d69 6e66  //" , [ user-inf
-00004160: 6f2c 2022 4022 205d 202c 2063 6c75 7374  o, "@" ] , clust
-00004170: 6572 2d64 6f6d 6169 6e6e 616d 6520 2c20  er-domainname , 
-00004180: 5b20 223f 2220 2c20 7175 6572 792d 7374  [ "?" , query-st
-00004190: 7269 6e67 205d 203b 0a0a 496e 2074 6865  ring ] ;..In the
-000041a0: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
-000041b0: 2055 5249 2073 6368 656d 652c 2061 6674   URI scheme, aft
-000041c0: 6572 2074 6865 206f 7074 696f 6e61 6c20  er the optional 
-000041d0: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
-000041e0: 2c20 7468 6572 6520 6d75 7374 2062 6520  , there must be 
-000041f0: 610a 646f 6d61 696e 206e 616d 6520 7768  a.domain name wh
-00004200: 6963 6820 7368 6f75 6c64 2069 6465 6e74  ich should ident
-00004210: 6966 7920 6120 636c 7573 7465 7220 6f66  ify a cluster of
-00004220: 2045 7665 6e74 5374 6f72 6544 4220 7365   EventStoreDB se
-00004230: 7276 6572 732e 2054 6865 2063 6c69 656e  rvers. The clien
-00004240: 7420 7769 6c6c 2075 7365 0a61 2044 4e53  t will use.a DNS
-00004250: 2073 6572 7665 7220 746f 2072 6573 6f6c   server to resol
-00004260: 7665 2074 6865 2064 6f6d 6169 6e20 6e61  ve the domain na
-00004270: 6d65 2074 6f20 6120 6c69 7374 206f 6620  me to a list of 
-00004280: 6164 6472 6573 7365 7320 6f66 2045 7665  addresses of Eve
-00004290: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
-000042a0: 732c 0a62 7920 7175 6572 7969 6e67 2066  s,.by querying f
-000042b0: 6f72 2027 4127 2072 6563 6f72 6473 2e20  or 'A' records. 
-000042c0: 496e 2074 6869 7320 6361 7365 2c20 7468  In this case, th
-000042d0: 6520 706f 7274 206e 756d 6265 7220 2232  e port number "2
-000042e0: 3131 3322 2077 696c 6c20 6265 2075 7365  113" will be use
-000042f0: 6420 746f 0a63 6f6e 7374 7275 6374 2067  d to.construct g
-00004300: 5250 4320 7461 7267 6574 7320 6672 6f6d  RPC targets from
-00004310: 2074 6865 2061 6464 7265 7373 6573 206f   the addresses o
-00004320: 6274 6169 6e65 6420 6672 6f6d 2027 4127  btained from 'A'
-00004330: 2072 6563 6f72 6473 2070 726f 7669 6465   records provide
-00004340: 6420 6279 2074 6865 0a44 4e53 2073 6572  d by the.DNS ser
-00004350: 7665 722e 2054 6865 7265 666f 7265 2c20  ver. Therefore, 
-00004360: 6966 2079 6f75 2077 616e 7420 746f 2075  if you want to u
-00004370: 7365 2074 6865 2022 6573 6462 2b64 6973  se the "esdb+dis
-00004380: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
-00004390: 652c 2079 6f75 2077 696c 6c0a 6e65 6564  e, you will.need
-000043a0: 2074 6f20 636f 6e66 6967 7572 6520 444e   to configure DN
-000043b0: 5320 7768 656e 2073 6574 7469 6e67 2075  S when setting u
-000043c0: 7020 796f 7572 2045 7665 6e74 5374 6f72  p your EventStor
-000043d0: 6544 4220 636c 7573 7465 722e 0a0a 5769  eDB cluster...Wi
-000043e0: 7468 2062 6f74 6820 7468 6520 2265 7364  th both the "esd
-000043f0: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
-00004400: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
-00004410: 6573 2c20 7468 6520 636c 6965 6e74 2066  es, the client f
-00004420: 6972 7374 6c79 206f 6274 6169 6e73 0a61  irstly obtains.a
-00004430: 206c 6973 7420 6f66 2067 5250 4320 7461   list of gRPC ta
-00004440: 7267 6574 733a 2065 6974 6865 7220 6469  rgets: either di
-00004450: 7265 6374 6c79 2066 726f 6d20 2265 7364  rectly from "esd
-00004460: 6222 2063 6f6e 6e65 6374 696f 6e20 7374  b" connection st
-00004470: 7269 6e67 733b 206f 7220 696e 6469 7265  rings; or indire
-00004480: 6374 6c79 0a66 726f 6d20 2265 7364 622b  ctly.from "esdb+
-00004490: 6469 7363 6f76 6572 2220 636f 6e6e 6563  discover" connec
-000044a0: 7469 6f6e 2073 7472 696e 6773 2076 6961  tion strings via
-000044b0: 2044 4e53 2e20 5468 6973 206c 6973 7420   DNS. This list 
-000044c0: 6f66 2074 6172 6765 7473 2069 7320 6b6e  of targets is kn
-000044d0: 6f77 6e20 6173 2074 6865 0a22 676f 7373  own as the."goss
-000044e0: 6970 2073 6565 6422 2e20 5468 6520 636c  ip seed". The cl
-000044f0: 6965 6e74 2077 696c 6c20 7468 656e 2061  ient will then a
-00004500: 7474 656d 7074 2074 6f20 636f 6e6e 6563  ttempt to connec
-00004510: 7420 746f 2065 6163 6820 6752 5043 2074  t to each gRPC t
-00004520: 6172 6765 7420 696e 2074 7572 6e2c 0a61  arget in turn,.a
-00004530: 7474 656d 7074 696e 6720 746f 2063 616c  ttempting to cal
-00004540: 6c20 7468 6520 4576 656e 7453 746f 7265  l the EventStore
-00004550: 4442 2047 6f73 7369 7020 4150 4920 746f  DB Gossip API to
-00004560: 206f 6274 6169 6e20 696e 666f 726d 6174   obtain informat
-00004570: 696f 6e20 6162 6f75 7420 7468 650a 4576  ion about the.Ev
-00004580: 656e 7453 746f 7265 4442 2063 6c75 7374  entStoreDB clust
-00004590: 6572 2e20 4120 6d65 6d62 6572 206f 6620  er. A member of 
-000045a0: 7468 6520 636c 7573 7465 7220 6973 2073  the cluster is s
-000045b0: 656c 6563 7465 6420 6279 2074 6865 2063  elected by the c
-000045c0: 6c69 656e 742c 2061 6363 6f72 6469 6e67  lient, according
-000045d0: 0a74 6f20 7468 6520 226e 6f64 6520 7072  .to the "node pr
-000045e0: 6566 6572 656e 6365 2220 6f70 7469 6f6e  eference" option
-000045f0: 2e20 5468 6520 636c 6965 6e74 206d 6179  . The client may
-00004600: 2074 6865 6e20 6e65 6564 2074 6f20 636c   then need to cl
-00004610: 6f73 6520 6974 730a 636f 6e6e 6563 7469  ose its.connecti
-00004620: 6f6e 2061 6e64 2072 6563 6f6e 6e65 6374  on and reconnect
-00004630: 2074 6f20 7468 6520 7365 6c65 6374 6564   to the selected
-00004640: 2073 6572 7665 722e 0a0a 2323 2320 5573   server...### Us
-00004650: 6572 2069 6e66 6f20 7374 7269 6e67 0a0a  er info string..
-00004660: 496e 2062 6f74 6820 7468 6520 2265 7364  In both the "esd
-00004670: 6222 2061 6e64 2022 6573 6462 2b64 6973  b" and "esdb+dis
-00004680: 636f 7665 7222 2073 6368 656d 6573 2c20  cover" schemes, 
-00004690: 7468 6520 5552 4920 6d61 7920 696e 636c  the URI may incl
-000046a0: 7564 6520 6120 7573 6572 2069 6e66 6f20  ude a user info 
-000046b0: 7374 7269 6e67 2e0a 4966 2069 7420 6578  string..If it ex
-000046c0: 6973 7473 2069 6e20 7468 6520 5552 492c  ists in the URI,
-000046d0: 2074 6865 2075 7365 7220 696e 666f 2073   the user info s
-000046e0: 7472 696e 6720 6d75 7374 2062 6520 7365  tring must be se
-000046f0: 7061 7261 7465 6420 6672 6f6d 2074 6865  parated from the
-00004700: 2072 6573 7420 6f66 2074 6865 2055 5249   rest of the URI
-00004710: 0a77 6974 6820 7468 6520 2240 2220 6368  .with the "@" ch
-00004720: 6172 6163 7465 722e 2054 6865 2075 7365  aracter. The use
-00004730: 7220 696e 666f 2073 7472 696e 6720 6d75  r info string mu
-00004740: 7374 2069 6e63 6c75 6465 2061 2075 7365  st include a use
-00004750: 726e 616d 6520 616e 6420 6120 7061 7373  rname and a pass
-00004760: 776f 7264 2c0a 7365 7061 7261 7465 6420  word,.separated 
-00004770: 7769 7468 2074 6865 2022 3a22 2063 6861  with the ":" cha
-00004780: 7261 6374 6572 2e0a 0a20 2020 2075 7365  racter...    use
-00004790: 722d 696e 666f 203d 2075 7365 726e 616d  r-info = usernam
-000047a0: 6520 2c20 223a 2220 2c20 7061 7373 776f  e , ":" , passwo
-000047b0: 7264 203b 0a0a 5468 6520 7573 6572 2069  rd ;..The user i
-000047c0: 6e66 6f20 6973 2073 656e 7420 6279 2074  nfo is sent by t
-000047d0: 6865 2063 6c69 656e 7420 6173 2022 6361  he client as "ca
-000047e0: 6c6c 2063 7265 6465 6e74 6961 6c73 2220  ll credentials" 
-000047f0: 696e 2065 6163 6820 6361 6c6c 2074 6f20  in each call to 
-00004800: 6120 2273 6563 7572 6522 0a73 6572 7665  a "secure".serve
-00004810: 722c 2069 6e20 6120 2262 6173 6963 2061  r, in a "basic a
-00004820: 7574 6822 2061 7574 686f 7269 7a61 7469  uth" authorizati
-00004830: 6f6e 2068 6561 6465 722e 2054 6869 7320  on header. This 
-00004840: 6175 7468 6f72 697a 6174 696f 6e20 6865  authorization he
-00004850: 6164 6572 2069 7320 7573 6564 2062 790a  ader is used by.
-00004860: 7468 6520 7365 7276 6572 2074 6f20 6175  the server to au
-00004870: 7468 656e 7469 6361 7465 2074 6865 2063  thenticate the c
-00004880: 6c69 656e 742e 2054 6865 2061 7574 686f  lient. The autho
-00004890: 7269 7a61 7469 6f6e 2068 6561 6465 7220  rization header 
-000048a0: 6973 206e 6f74 2073 656e 7420 746f 0a22  is not sent to."
-000048b0: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
-000048c0: 732e 0a0a 2323 2320 5175 6572 7920 7374  s...### Query st
-000048d0: 7269 6e67 0a0a 496e 2062 6f74 6820 7468  ring..In both th
-000048e0: 6520 2265 7364 6222 2061 6e64 2022 6573  e "esdb" and "es
-000048f0: 6462 2b64 6973 636f 7665 7222 2073 6368  db+discover" sch
-00004900: 656d 6573 2c20 7468 6520 6f70 7469 6f6e  emes, the option
-00004910: 616c 2071 7565 7279 2073 7472 696e 6720  al query string 
-00004920: 6d75 7374 2062 6520 6f6e 650a 6f72 206d  must be one.or m
-00004930: 616e 7920 6669 656c 642d 7661 6c75 6520  any field-value 
-00004940: 6172 6775 6d65 6e74 732c 2073 6570 6172  arguments, separ
-00004950: 6174 6564 2066 726f 6d20 6561 6368 206f  ated from each o
-00004960: 7468 6572 2077 6974 6820 7468 6520 2226  ther with the "&
-00004970: 2220 6368 6172 6163 7465 722e 0a0a 2020  " character...  
-00004980: 2020 7175 6572 792d 7374 7269 6e67 203d    query-string =
-00004990: 2066 6965 6c64 2d76 616c 7565 2c20 7b20   field-value, { 
-000049a0: 2226 222c 2066 6965 6c64 2d76 616c 7565  "&", field-value
-000049b0: 207d 203b 0a0a 4561 6368 2066 6965 6c64   } ;..Each field
-000049c0: 2d76 616c 7565 2061 7267 756d 656e 7420  -value argument 
-000049d0: 6d75 7374 2062 6520 6f6e 6520 6f66 2074  must be one of t
-000049e0: 6865 2073 7570 706f 7274 6564 2066 6965  he supported fie
-000049f0: 6c64 732c 2061 6e64 2061 6e0a 6170 7072  lds, and an.appr
-00004a00: 6f70 7269 6174 6520 7661 6c75 652c 2073  opriate value, s
-00004a10: 6570 6172 6174 6564 2077 6974 6820 7468  eparated with th
-00004a20: 6520 223d 2220 6368 6172 6163 7465 722e  e "=" character.
-00004a30: 0a0a 2020 2020 6669 656c 642d 7661 6c75  ..    field-valu
-00004a40: 6520 3d20 2820 2254 6c73 222c 2022 3d22  e = ( "Tls", "="
-00004a50: 202c 2022 7472 7565 2220 7c20 2266 616c   , "true" | "fal
-00004a60: 7365 2220 290a 2020 2020 2020 2020 2020  se" ).          
-00004a70: 2020 2020 2020 7c20 2820 2254 6c73 5665        | ( "TlsVe
-00004a80: 7269 6679 4365 7274 222c 2022 3d22 202c  rifyCert", "=" ,
-00004a90: 2022 7472 7565 2220 7c20 2266 616c 7365   "true" | "false
-00004aa0: 2220 290a 2020 2020 2020 2020 2020 2020  " ).            
-00004ab0: 2020 2020 7c20 2820 2243 6f6e 6e65 6374      | ( "Connect
-00004ac0: 696f 6e4e 616d 6522 2c20 223d 2220 2c20  ionName", "=" , 
-00004ad0: 7374 7269 6e67 2029 0a20 2020 2020 2020  string ).       
-00004ae0: 2020 2020 2020 2020 207c 2028 2022 4e6f           | ( "No
-00004af0: 6465 5072 6566 6572 656e 6365 222c 2022  dePreference", "
-00004b00: 3d22 202c 2022 6c65 6164 6572 2220 7c20  =" , "leader" | 
-00004b10: 2266 6f6c 6c6f 7765 7222 207c 2022 7265  "follower" | "re
-00004b20: 6164 6f6e 6c79 7265 706c 6963 6122 207c  adonlyreplica" |
-00004b30: 2022 7261 6e64 6f6d 2220 290a 2020 2020   "random" ).    
-00004b40: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-00004b50: 2244 6566 6175 6c74 4465 6164 6c69 6e65  "DefaultDeadline
-00004b60: 222c 2022 3d22 202c 2069 6e74 6567 6572  ", "=" , integer
-00004b70: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00004b80: 2020 207c 2028 2022 476f 7373 6970 5469     | ( "GossipTi
-00004b90: 6d65 6f75 7422 2c20 223d 2220 2c20 696e  meout", "=" , in
-00004ba0: 7465 6765 7220 290a 2020 2020 2020 2020  teger ).        
-00004bb0: 2020 2020 2020 2020 7c20 2820 224d 6178          | ( "Max
-00004bc0: 4469 7363 6f76 6572 4174 7465 6d70 7473  DiscoverAttempts
-00004bd0: 222c 2022 3d22 202c 2069 6e74 6567 6572  ", "=" , integer
-00004be0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00004bf0: 2020 207c 2028 2022 4469 7363 6f76 6572     | ( "Discover
-00004c00: 7949 6e74 6572 7661 6c22 2c20 223d 2220  yInterval", "=" 
-00004c10: 2c20 696e 7465 6765 7220 290a 2020 2020  , integer ).    
-00004c20: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
-00004c30: 224d 6178 4469 7363 6f76 6572 4174 7465  "MaxDiscoverAtte
-00004c40: 6d70 7473 222c 2022 3d22 202c 2069 6e74  mpts", "=" , int
-00004c50: 6567 6572 2029 0a20 2020 2020 2020 2020  eger ).         
-00004c60: 2020 2020 2020 207c 2028 2022 4b65 6570         | ( "Keep
-00004c70: 416c 6976 6549 6e74 6572 7661 6c22 2c20  AliveInterval", 
-00004c80: 223d 2220 2c20 696e 7465 6765 7220 290a  "=" , integer ).
-00004c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ca0: 7c20 2820 224b 6565 7041 6c69 7665 496e  | ( "KeepAliveIn
-00004cb0: 7465 7276 616c 222c 2022 3d22 202c 2069  terval", "=" , i
-00004cc0: 6e74 6567 6572 2029 203b 0a0a 5468 6520  nteger ) ;..The 
-00004cd0: 7461 626c 6520 6265 6c6f 7720 6465 7363  table below desc
-00004ce0: 7269 6265 7320 7468 6520 7175 6572 7920  ribes the query 
-00004cf0: 6669 656c 642d 7661 6c75 6573 2073 7570  field-values sup
-00004d00: 706f 7274 6564 2062 7920 7468 6973 2063  ported by this c
-00004d10: 6c69 656e 742e 0a0a 7c20 4669 656c 6420  lient...| Field 
-00004d20: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00004d30: 5661 6c75 6520 2020 2020 2020 2020 2020  Value           
-00004d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004d70: 2020 2020 2020 7c20 4465 7363 7269 7074        | Descript
-00004d80: 696f 6e20 2020 2020 2020 2020 2020 2020  ion             
-00004d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e10: 2020 2020 2020 2020 2020 7c0a 7c2d 2d2d            |.|---
-00004e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004e30: 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  --|-------------
-00004e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004e50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004e70: 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d  ----------|-----
-00004e80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004eb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ee0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ef0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004f10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 7c0a  --------------|.
-00004f20: 7c20 546c 7320 2020 2020 2020 2020 2020  | Tls           
-00004f30: 2020 2020 2020 7c20 2274 7275 6522 2c20        | "true", 
-00004f40: 2266 616c 7365 2220 2864 6566 6175 6c74  "false" (default
-00004f50: 3a20 2274 7275 6522 2920 2020 2020 2020  : "true")       
-00004f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004f70: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00004f80: 4966 2022 7472 7565 2220 7468 6520 636c  If "true" the cl
-00004f90: 6965 6e74 2077 696c 6c20 6372 6561 7465  ient will create
-00004fa0: 2061 2022 7365 6375 7265 2220 6752 5043   a "secure" gRPC
-00004fb0: 2063 6861 6e6e 656c 2e20 4966 2022 6661   channel. If "fa
-00004fc0: 6c73 6522 2074 6865 2063 6c69 656e 7420  lse" the client 
-00004fd0: 7769 6c6c 2063 7265 6174 6520 616e 2022  will create an "
-00004fe0: 696e 7365 6375 7265 2220 6752 5043 2063  insecure" gRPC c
-00004ff0: 6861 6e6e 656c 2e20 5468 6973 206d 7573  hannel. This mus
-00005000: 7420 6d61 7463 6820 7468 6520 7365 7276  t match the serv
-00005010: 6572 2063 6f6e 6669 6775 7261 7469 6f6e  er configuration
-00005020: 2e20 7c0a 7c20 546c 7356 6572 6966 7943  . |.| TlsVerifyC
-00005030: 6572 7420 2020 2020 2020 7c20 2274 7275  ert       | "tru
-00005040: 6522 2c20 2266 616c 7365 2220 2864 6566  e", "false" (def
-00005050: 6175 6c74 3a20 2274 7275 6522 2920 2020  ault: "true")   
-00005060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005080: 2020 7c20 5468 6973 2076 616c 7565 2069    | This value i
-00005090: 7320 6375 7272 656e 746c 7920 6967 6e6f  s currently igno
-000050a0: 7265 642e 2020 2020 2020 2020 2020 2020  red.            
-000050b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000050f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005120: 2020 2020 2020 7c0a 7c20 436f 6e6e 6563        |.| Connec
-00005130: 7469 6f6e 4e61 6d65 2020 2020 2020 7c20  tionName      | 
-00005140: 7374 7269 6e67 2028 6465 6661 756c 743a  string (default:
-00005150: 2061 7574 6f2d 6765 6e65 7261 7465 6420   auto-generated 
-00005160: 7665 7273 696f 6e2d 3420 5555 4944 2920  version-4 UUID) 
-00005170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005180: 2020 2020 2020 7c20 5365 6e74 2069 6e20        | Sent in 
-00005190: 6361 6c6c 206d 6574 6164 6174 6120 666f  call metadata fo
-000051a0: 7220 6576 6572 7920 6361 6c6c 2c20 746f  r every call, to
-000051b0: 2069 6465 6e74 6966 7920 7468 6520 636c   identify the cl
-000051c0: 6965 6e74 2074 6f20 7468 6520 636c 7573  ient to the clus
-000051d0: 7465 722e 2020 2020 2020 2020 2020 2020  ter.            
-000051e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005220: 2020 2020 2020 2020 2020 7c0a 7c20 4e6f            |.| No
-00005230: 6465 5072 6566 6572 656e 6365 2020 2020  dePreference    
-00005240: 2020 7c20 226c 6561 6465 7222 2c20 2266    | "leader", "f
-00005250: 6f6c 6c6f 7765 7222 2c20 2272 6561 646f  ollower", "reado
-00005260: 6e6c 7972 6570 6c69 6361 222c 2022 7261  nlyreplica", "ra
-00005270: 6e64 6f6d 2220 2864 6566 6175 6c74 3a20  ndom" (default: 
-00005280: 226c 6561 6465 7222 2920 7c20 5468 6520  "leader") | The 
-00005290: 6e6f 6465 2073 7461 7465 2070 7265 6665  node state prefe
-000052a0: 7272 6564 2062 7920 7468 6520 636c 6965  rred by the clie
-000052b0: 6e74 2e20 5468 6520 636c 6965 6e74 2077  nt. The client w
-000052c0: 696c 6c20 7365 6c65 6374 2061 206e 6f64  ill select a nod
-000052d0: 6520 6672 6f6d 2074 6865 2063 6c75 7374  e from the clust
-000052e0: 6572 2069 6e66 6f20 7265 6365 6976 6564  er info received
-000052f0: 2066 726f 6d20 7468 6520 476f 7373 6970   from the Gossip
-00005300: 2041 5049 2061 6363 6f72 6469 6e67 2074   API according t
-00005310: 6f20 7468 6973 2070 7265 6665 7265 6e63  o this preferenc
-00005320: 652e 2020 2020 2020 2020 2020 2020 7c0a  e.            |.
-00005330: 7c20 4465 6661 756c 7444 6561 646c 696e  | DefaultDeadlin
-00005340: 6520 2020 2020 7c20 696e 7465 6765 7220  e     | integer 
-00005350: 2864 6566 6175 6c74 3a20 604e 6f6e 6560  (default: `None`
-00005360: 2920 2020 2020 2020 2020 2020 2020 2020  )               
-00005370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005380: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00005390: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
-000053a0: 6520 2869 6e20 7365 636f 6e64 7329 206f  e (in seconds) o
-000053b0: 6620 7468 6520 6074 696d 656f 7574 6020  f the `timeout` 
-000053c0: 6172 6775 6d65 6e74 206f 6620 636c 6965  argument of clie
-000053d0: 6e74 2022 7772 6974 6522 206d 6574 686f  nt "write" metho
-000053e0: 6473 2073 7563 6820 6173 2060 6170 7065  ds such as `appe
-000053f0: 6e64 5f74 6f5f 7374 7265 616d 2829 602e  nd_to_stream()`.
-00005400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005430: 2020 7c0a 7c20 476f 7373 6970 5469 6d65    |.| GossipTime
-00005440: 6f75 7420 2020 2020 2020 7c20 696e 7465  out       | inte
-00005450: 6765 7220 2864 6566 6175 6c74 3a20 3529  ger (default: 5)
-00005460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005490: 2020 7c20 5468 6520 6465 6661 756c 7420    | The default 
-000054a0: 7661 6c75 6520 2869 6e20 7365 636f 6e64  value (in second
-000054b0: 7329 206f 6620 7468 6520 6074 696d 656f  s) of the `timeo
-000054c0: 7574 6020 6172 6775 6d65 6e74 206f 6620  ut` argument of 
-000054d0: 676f 7373 6970 2072 6561 6420 6d65 7468  gossip read meth
-000054e0: 6f64 732c 2073 7563 6820 6173 2060 7265  ods, such as `re
-000054f0: 6164 5f67 6f73 7369 7028 2960 2e20 2020  ad_gossip()`.   
-00005500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005530: 2020 2020 2020 7c0a 7c20 4d61 7844 6973        |.| MaxDis
-00005540: 636f 7665 7241 7474 656d 7074 7320 7c20  coverAttempts | 
-00005550: 696e 7465 6765 7220 2864 6566 6175 6c74  integer (default
-00005560: 3a20 3130 2920 2020 2020 2020 2020 2020  : 10)           
-00005570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005590: 2020 2020 2020 7c20 5468 6520 6e75 6d62        | The numb
-000055a0: 6572 206f 6620 6174 7465 6d70 7473 2074  er of attempts t
-000055b0: 6f20 7265 6164 2067 6f73 7369 7020 7768  o read gossip wh
-000055c0: 656e 2063 6f6e 6e65 6374 696e 6720 6f72  en connecting or
-000055d0: 2072 6563 6f6e 6e65 6374 696e 6720 746f   reconnecting to
-000055e0: 2061 2063 6c75 7374 6572 206d 656d 6265   a cluster membe
-000055f0: 722e 2020 2020 2020 2020 2020 2020 2020  r.              
+00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00000010: 3a20 322e 310a 4e61 6d65 3a20 6573 6462  : 2.1.Name: esdb
+00000020: 636c 6965 6e74 0a56 6572 7369 6f6e 3a20  client.Version: 
+00000030: 312e 3162 310a 5375 6d6d 6172 793a 2050  1.1b1.Summary: P
+00000040: 7974 686f 6e20 6752 5043 2043 6c69 656e  ython gRPC Clien
+00000050: 7420 666f 7220 4576 656e 7453 746f 7265  t for EventStore
+00000060: 4442 0a48 6f6d 652d 7061 6765 3a20 6874  DB.Home-page: ht
+00000070: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00000080: 2f70 7965 7665 6e74 736f 7572 6369 6e67  /pyeventsourcing
+00000090: 2f65 7364 6263 6c69 656e 740a 4c69 6365  /esdbclient.Lice
+000000a0: 6e73 653a 2042 5344 2033 2d43 6c61 7573  nse: BSD 3-Claus
+000000b0: 650a 4175 7468 6f72 3a20 4a6f 686e 2042  e.Author: John B
+000000c0: 7977 6174 6572 0a41 7574 686f 722d 656d  ywater.Author-em
+000000d0: 6169 6c3a 206a 6f68 6e2e 6279 7761 7465  ail: john.bywate
+000000e0: 7240 6170 7072 6f70 7269 6174 6573 6f66  r@appropriatesof
+000000f0: 7477 6172 652e 6e65 740a 5265 7175 6972  tware.net.Requir
+00000100: 6573 2d50 7974 686f 6e3a 203e 3d33 2e37  es-Python: >=3.7
+00000110: 2c3c 342e 300a 436c 6173 7369 6669 6572  ,<4.0.Classifier
+00000120: 3a20 4465 7665 6c6f 706d 656e 7420 5374  : Development St
+00000130: 6174 7573 203a 3a20 3420 2d20 4265 7461  atus :: 4 - Beta
+00000140: 0a43 6c61 7373 6966 6965 723a 204c 6963  .Classifier: Lic
+00000150: 656e 7365 203a 3a20 4f53 4920 4170 7072  ense :: OSI Appr
+00000160: 6f76 6564 203a 3a20 4253 4420 4c69 6365  oved :: BSD Lice
+00000170: 6e73 650a 436c 6173 7369 6669 6572 3a20  nse.Classifier: 
+00000180: 4c69 6365 6e73 6520 3a3a 204f 7468 6572  License :: Other
+00000190: 2f50 726f 7072 6965 7461 7279 204c 6963  /Proprietary Lic
+000001a0: 656e 7365 0a43 6c61 7373 6966 6965 723a  ense.Classifier:
+000001b0: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
+000001c0: 6775 6167 6520 3a3a 2050 7974 686f 6e0a  guage :: Python.
+000001d0: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
+000001e0: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
+000001f0: 203a 3a20 5079 7468 6f6e 203a 3a20 330a   :: Python :: 3.
+00000200: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
+00000210: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
+00000220: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
+00000230: 370a 436c 6173 7369 6669 6572 3a20 5072  7.Classifier: Pr
+00000240: 6f67 7261 6d6d 696e 6720 4c61 6e67 7561  ogramming Langua
+00000250: 6765 203a 3a20 5079 7468 6f6e 203a 3a20  ge :: Python :: 
+00000260: 332e 380a 436c 6173 7369 6669 6572 3a20  3.8.Classifier: 
+00000270: 5072 6f67 7261 6d6d 696e 6720 4c61 6e67  Programming Lang
+00000280: 7561 6765 203a 3a20 5079 7468 6f6e 203a  uage :: Python :
+00000290: 3a20 332e 390a 436c 6173 7369 6669 6572  : 3.9.Classifier
+000002a0: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
+000002b0: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
+000002c0: 203a 3a20 332e 3130 0a43 6c61 7373 6966   :: 3.10.Classif
+000002d0: 6965 723a 2050 726f 6772 616d 6d69 6e67  ier: Programming
+000002e0: 204c 616e 6775 6167 6520 3a3a 2050 7974   Language :: Pyt
+000002f0: 686f 6e20 3a3a 2033 2e31 310a 436c 6173  hon :: 3.11.Clas
+00000300: 7369 6669 6572 3a20 5072 6f67 7261 6d6d  sifier: Programm
+00000310: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
+00000320: 5079 7468 6f6e 203a 3a20 332e 3132 0a52  Python :: 3.12.R
+00000330: 6571 7569 7265 732d 4469 7374 3a20 6772  equires-Dist: gr
+00000340: 7063 696f 2028 3e3d 312e 3531 2e30 2c21  pcio (>=1.51.0,!
+00000350: 3d31 2e35 322e 2a29 0a52 6571 7569 7265  =1.52.*).Require
+00000360: 732d 4469 7374 3a20 7072 6f74 6f62 7566  s-Dist: protobuf
+00000370: 2028 3e3d 332e 3131 2e30 290a 5265 7175   (>=3.11.0).Requ
+00000380: 6972 6573 2d44 6973 743a 2074 7970 696e  ires-Dist: typin
+00000390: 675f 6578 7465 6e73 696f 6e73 0a50 726f  g_extensions.Pro
+000003a0: 6a65 6374 2d55 524c 3a20 5265 706f 7369  ject-URL: Reposi
+000003b0: 746f 7279 2c20 6874 7470 733a 2f2f 6769  tory, https://gi
+000003c0: 7468 7562 2e63 6f6d 2f70 7965 7665 6e74  thub.com/pyevent
+000003d0: 736f 7572 6369 6e67 2f65 7364 6263 6c69  sourcing/esdbcli
+000003e0: 656e 740a 4465 7363 7269 7074 696f 6e2d  ent.Description-
+000003f0: 436f 6e74 656e 742d 5479 7065 3a20 7465  Content-Type: te
+00000400: 7874 2f6d 6172 6b64 6f77 6e0a 0a23 2050  xt/markdown..# P
+00000410: 7974 686f 6e20 6752 5043 2043 6c69 656e  ython gRPC Clien
+00000420: 7420 666f 7220 4576 656e 7453 746f 7265  t for EventStore
+00000430: 4442 0a0a 5468 6973 205b 5079 7468 6f6e  DB..This [Python
+00000440: 2070 6163 6b61 6765 5d28 6874 7470 733a   package](https:
+00000450: 2f2f 7079 7069 2e6f 7267 2f70 726f 6a65  //pypi.org/proje
+00000460: 6374 2f65 7364 6263 6c69 656e 742f 2920  ct/esdbclient/) 
+00000470: 7072 6f76 6964 6573 206d 756c 7469 7468  provides multith
+00000480: 7265 6164 6564 2061 6e64 2061 7379 6e63  readed and async
+00000490: 696f 2050 7974 686f 6e0a 636c 6965 6e74  io Python.client
+000004a0: 7320 666f 7220 7468 6520 5b45 7665 6e74  s for the [Event
+000004b0: 5374 6f72 6544 425d 2868 7474 7073 3a2f  StoreDB](https:/
+000004c0: 2f77 7777 2e65 7665 6e74 7374 6f72 652e  /www.eventstore.
+000004d0: 636f 6d2f 2920 6461 7461 6261 7365 2e0a  com/) database..
+000004e0: 0a54 6865 206d 756c 7469 7468 7265 6164  .The multithread
+000004f0: 6564 2060 4576 656e 7453 746f 7265 4442  ed `EventStoreDB
+00000500: 436c 6965 6e74 6020 6973 2064 6573 6372  Client` is descr
+00000510: 6962 6564 2069 6e20 6465 7461 696c 2062  ibed in detail b
+00000520: 656c 6f77 2e20 506c 6561 7365 2073 6372  elow. Please scr
+00000530: 6f6c 6c0a 646f 776e 2066 6f72 203c 6120  oll.down for <a 
+00000540: 6872 6566 3d22 2361 7379 6e63 696f 2d63  href="#asyncio-c
+00000550: 6c69 656e 7422 3e69 6e66 6f72 6d61 7469  lient">informati
+00000560: 6f6e 3c2f 613e 2061 626f 7574 2060 4173  on</a> about `As
+00000570: 796e 6369 6f45 7665 6e74 5374 6f72 6544  yncioEventStoreD
+00000580: 4243 6c69 656e 7460 2e0a 0a54 6865 7365  BClient`...These
+00000590: 2063 6c69 656e 7473 2068 6176 6520 6265   clients have be
+000005a0: 656e 2064 6576 656c 6f70 6564 2061 6e64  en developed and
+000005b0: 2061 7265 2062 6569 6e67 206d 6169 6e74   are being maint
+000005c0: 6169 6e65 6420 696e 2061 2063 6f6c 6c61  ained in a colla
+000005d0: 626f 7261 7469 6f6e 0a77 6974 6820 7468  boration.with th
+000005e0: 6520 4576 656e 7453 746f 7265 4442 2074  e EventStoreDB t
+000005f0: 6561 6d2c 2061 6e64 2061 7265 206f 6666  eam, and are off
+00000600: 6963 6961 6c6c 7920 7375 7070 6f72 7420  icially support 
+00000610: 6279 2045 7665 6e74 2053 746f 7265 204c  by Event Store L
+00000620: 7464 2e0a 416c 7468 6f75 6768 206e 6f74  td..Although not
+00000630: 2061 6c6c 2074 6865 2066 6561 7475 7265   all the feature
+00000640: 7320 6f66 2045 7665 6e74 5374 6f72 6544  s of EventStoreD
+00000650: 4220 6172 6520 7375 7070 6f72 7465 642c  B are supported,
+00000660: 206d 616e 7920 6f66 2074 6865 206d 6f73   many of the mos
+00000670: 740a 7573 6566 756c 2066 6561 7475 7265  t.useful feature
+00000680: 7320 6172 6520 7072 6573 656e 7465 6420  s are presented 
+00000690: 696e 2061 6e20 6561 7379 2d74 6f2d 7573  in an easy-to-us
+000006a0: 6520 696e 7465 7266 6163 652e 0a0a 5468  e interface...Th
+000006b0: 6573 6520 636c 6965 6e74 7320 6861 7665  ese clients have
+000006c0: 2062 6565 6e20 7465 7374 6564 2074 6f20   been tested to 
+000006d0: 776f 726b 2077 6974 6820 4576 656e 7453  work with EventS
+000006e0: 746f 7265 4442 204c 5453 2076 6572 7369  toreDB LTS versi
+000006f0: 6f6e 7320 3231 2e31 302c 0a32 322e 3130  ons 21.10,.22.10
+00000700: 2c20 3233 2e31 302c 2061 6e64 2076 6572  , 23.10, and ver
+00000710: 7369 6f6e 2032 342e 322c 2077 6974 686f  sion 24.2, witho
+00000720: 7574 2061 6e64 2077 6974 686f 7574 2053  ut and without S
+00000730: 534c 2f54 4c53 2c20 7769 7468 2073 696e  SL/TLS, with sin
+00000740: 676c 652d 7365 7276 6572 0a61 6e64 2063  gle-server.and c
+00000750: 6c75 7374 6572 206d 6f64 6573 2c20 616e  luster modes, an
+00000760: 6420 7769 7468 2050 7974 686f 6e20 7665  d with Python ve
+00000770: 7273 696f 6e73 2033 2e37 2c20 332e 382c  rsions 3.7, 3.8,
+00000780: 2033 2e39 2c20 332e 3130 2c20 332e 3131   3.9, 3.10, 3.11
+00000790: 2061 6e64 2033 2e31 322e 0a0a 5468 6520   and 3.12...The 
+000007a0: 7465 7374 2073 7569 7465 2068 6173 2031  test suite has 1
+000007b0: 3030 2520 6c69 6e65 2061 6e64 2062 7261  00% line and bra
+000007c0: 6e63 6820 636f 7665 7261 6765 2e20 5468  nch coverage. Th
+000007d0: 6520 636f 6465 2068 6173 2074 7970 696e  e code has typin
+000007e0: 6720 616e 6e6f 7461 7469 6f6e 730a 6368  g annotations.ch
+000007f0: 6563 6b65 6420 7374 7269 6374 6c79 2077  ecked strictly w
+00000800: 6974 6820 6d79 7079 2e20 5468 6520 636f  ith mypy. The co
+00000810: 6465 2069 7320 666f 726d 6174 7465 6420  de is formatted 
+00000820: 7769 7468 2062 6c61 636b 2061 6e64 2069  with black and i
+00000830: 736f 7274 2c20 616e 6420 6368 6563 6b65  sort, and checke
+00000840: 640a 7769 7468 2066 6c61 6b65 382e 2050  d.with flake8. P
+00000850: 6f65 7472 7920 6973 2075 7365 6420 666f  oetry is used fo
+00000860: 7220 7061 636b 6167 6520 6d61 6e61 6765  r package manage
+00000870: 6d65 6e74 2064 7572 696e 6720 6465 7665  ment during deve
+00000880: 6c6f 706d 656e 742c 2061 6e64 2066 6f72  lopment, and for
+00000890: 0a62 7569 6c64 696e 6720 616e 6420 7075  .building and pu
+000008a0: 626c 6973 6869 6e67 2064 6973 7472 6962  blishing distrib
+000008b0: 7574 696f 6e73 2074 6f20 5b50 7950 495d  utions to [PyPI]
+000008c0: 2868 7474 7073 3a2f 2f70 7970 692e 6f72  (https://pypi.or
+000008d0: 672f 7072 6f6a 6563 742f 6573 6462 636c  g/project/esdbcl
+000008e0: 6965 6e74 2f29 2e0a 0a0a 2323 2053 796e  ient/)....## Syn
+000008f0: 6f70 7369 730a 0a54 6865 2060 4576 656e  opsis..The `Even
+00000900: 7453 746f 7265 4442 436c 6965 6e74 6020  tStoreDBClient` 
+00000910: 636c 6173 7320 6361 6e20 6265 2069 6d70  class can be imp
+00000920: 6f72 7465 6420 6672 6f6d 2074 6865 2060  orted from the `
+00000930: 6573 6462 636c 6965 6e74 6020 7061 636b  esdbclient` pack
+00000940: 6167 652e 0a0a 5072 6f62 6162 6c79 2074  age...Probably t
+00000950: 6865 2074 6872 6565 206d 6f73 7420 7573  he three most us
+00000960: 6566 756c 206d 6574 686f 6473 206f 6620  eful methods of 
+00000970: 6045 7665 6e74 5374 6f72 6544 4243 6c69  `EventStoreDBCli
+00000980: 656e 7460 2061 7265 3a0a 0a2a 2060 6170  ent` are:..* `ap
+00000990: 7065 6e64 5f74 6f5f 7374 7265 616d 2829  pend_to_stream()
+000009a0: 6020 5468 6973 206d 6574 686f 6420 6361  ` This method ca
+000009b0: 6e20 6265 2075 7365 6420 746f 2072 6563  n be used to rec
+000009c0: 6f72 6420 6e65 7720 6576 656e 7473 2069  ord new events i
+000009d0: 6e20 6120 7061 7274 6963 756c 6172 0a22  n a particular."
+000009e0: 7374 7265 616d 222e 2054 6869 7320 6973  stream". This is
+000009f0: 2075 7365 6675 6c2c 2066 6f72 2065 7861   useful, for exa
+00000a00: 6d70 6c65 2c20 7768 656e 2065 7865 6375  mple, when execu
+00000a10: 7469 6e67 2061 2063 6f6d 6d61 6e64 2069  ting a command i
+00000a20: 6e20 616e 2061 7070 6c69 6361 7469 6f6e  n an application
+00000a30: 0a74 6861 7420 6d75 7461 7465 7320 616e  .that mutates an
+00000a40: 2061 6767 7265 6761 7465 2e20 5468 6973   aggregate. This
+00000a50: 206d 6574 686f 6420 6973 2022 6174 6f6d   method is "atom
+00000a60: 6963 2220 696e 2074 6861 7420 6569 7468  ic" in that eith
+00000a70: 6572 2061 6c6c 206f 7220 6e6f 6e65 206f  er all or none o
+00000a80: 660a 7468 6520 6576 656e 7473 2077 696c  f.the events wil
+00000a90: 6c20 6265 2072 6563 6f72 6465 642e 0a0a  l be recorded...
+00000aa0: 2a20 6067 6574 5f73 7472 6561 6d28 2960  * `get_stream()`
+00000ab0: 2054 6869 7320 6d65 7468 6f64 2063 616e   This method can
+00000ac0: 2062 6520 7573 6564 2074 6f20 7265 7472   be used to retr
+00000ad0: 6965 7665 2061 6c6c 2074 6865 2072 6563  ieve all the rec
+00000ae0: 6f72 6465 640a 6576 656e 7473 2069 6e20  orded.events in 
+00000af0: 6120 2273 7472 6561 6d22 2e20 5468 6973  a "stream". This
+00000b00: 2069 7320 7573 6566 756c 2c20 666f 7220   is useful, for 
+00000b10: 6578 616d 706c 652c 2077 6865 6e20 7265  example, when re
+00000b20: 636f 6e73 7472 7563 7469 6e67 0a61 6e20  constructing.an 
+00000b30: 6167 6772 6567 6174 6520 6672 6f6d 2072  aggregate from r
+00000b40: 6563 6f72 6465 6420 6576 656e 7473 2062  ecorded events b
+00000b50: 6566 6f72 6520 6578 6563 7574 696e 6720  efore executing 
+00000b60: 6120 636f 6d6d 616e 6420 696e 2061 6e0a  a command in an.
+00000b70: 6170 706c 6963 6174 696f 6e20 7468 6174  application that
+00000b80: 2063 7265 6174 6573 206e 6577 2065 7665   creates new eve
+00000b90: 6e74 732e 0a0a 2a20 6073 7562 7363 7269  nts...* `subscri
+00000ba0: 6265 5f74 6f5f 616c 6c28 2960 2054 6869  be_to_all()` Thi
+00000bb0: 7320 6d65 7468 6f64 2063 616e 2062 6520  s method can be 
+00000bc0: 7573 6564 2074 6f20 7265 6365 6976 6520  used to receive 
+00000bd0: 616c 6c20 7265 636f 7264 6564 2065 7665  all recorded eve
+00000be0: 6e74 7320 696e 0a74 6865 2064 6174 6162  nts in.the datab
+00000bf0: 6173 652e 2054 6869 7320 6973 2075 7365  ase. This is use
+00000c00: 6675 6c2c 2066 6f72 2065 7861 6d70 6c65  ful, for example
+00000c10: 2c20 696e 2065 7665 6e74 2d70 726f 6365  , in event-proce
+00000c20: 7373 696e 6720 636f 6d70 6f6e 656e 7473  ssing components
+00000c30: 2062 6563 6175 7365 0a69 7420 7375 7070   because.it supp
+00000c40: 6f72 7473 2070 726f 6365 7373 696e 6720  orts processing 
+00000c50: 6576 656e 7473 2077 6974 6820 2265 7861  events with "exa
+00000c60: 6374 6c79 2d6f 6e63 6522 2073 656d 616e  ctly-once" seman
+00000c70: 7469 6373 2e0a 0a54 6865 2065 7861 6d70  tics...The examp
+00000c80: 6c65 2062 656c 6f77 2075 7365 7320 616e  le below uses an
+00000c90: 2022 696e 7365 6375 7265 2220 4576 656e   "insecure" Even
+00000ca0: 7453 746f 7265 4442 2073 6572 7665 7220  tStoreDB server 
+00000cb0: 7275 6e6e 696e 6720 6c6f 6361 6c6c 7920  running locally 
+00000cc0: 6f6e 2070 6f72 7420 3231 3133 2e0a 0a60  on port 2113...`
+00000cd0: 6060 7079 7468 6f6e 0a69 6d70 6f72 7420  ``python.import 
+00000ce0: 7575 6964 0a0a 6672 6f6d 2065 7364 6263  uuid..from esdbc
+00000cf0: 6c69 656e 7420 696d 706f 7274 2045 7665  lient import Eve
+00000d00: 6e74 5374 6f72 6544 4243 6c69 656e 742c  ntStoreDBClient,
+00000d10: 204e 6577 4576 656e 742c 2053 7472 6561   NewEvent, Strea
+00000d20: 6d53 7461 7465 0a0a 0a23 2043 6f6e 7374  mState...# Const
+00000d30: 7275 6374 2045 7665 6e74 5374 6f72 6544  ruct EventStoreD
+00000d40: 4243 6c69 656e 7420 7769 7468 2061 6e20  BClient with an 
+00000d50: 4576 656e 7453 746f 7265 4442 2055 5249  EventStoreDB URI
+00000d60: 2e20 5468 650a 2320 636f 6e6e 6563 7469  . The.# connecti
+00000d70: 6f6e 2073 7472 696e 6720 5552 4920 7370  on string URI sp
+00000d80: 6563 6966 6965 7320 7468 6174 2074 6865  ecifies that the
+00000d90: 2063 6c69 656e 7420 7368 6f75 6c64 0a23   client should.#
+00000da0: 2063 6f6e 6e65 6374 2074 6f20 616e 2022   connect to an "
+00000db0: 696e 7365 6375 7265 2220 7365 7276 6572  insecure" server
+00000dc0: 2072 756e 6e69 6e67 206f 6e20 706f 7274   running on port
+00000dd0: 2032 3131 332e 0a0a 636c 6965 6e74 203d   2113...client =
+00000de0: 2045 7665 6e74 5374 6f72 6544 4243 6c69   EventStoreDBCli
+00000df0: 656e 7428 0a20 2020 2075 7269 3d22 6573  ent(.    uri="es
+00000e00: 6462 3a2f 2f6c 6f63 616c 686f 7374 3a32  db://localhost:2
+00000e10: 3131 333f 546c 733d 6661 6c73 6522 0a29  113?Tls=false".)
+00000e20: 0a0a 0a23 2047 656e 6572 6174 6520 6e65  ...# Generate ne
+00000e30: 7720 6576 656e 7473 2e20 5479 7069 6361  w events. Typica
+00000e40: 6c6c 792c 2064 6f6d 6169 6e20 6576 656e  lly, domain even
+00000e50: 7473 206f 6620 6469 6666 6572 656e 740a  ts of different.
+00000e60: 2320 7479 7065 7320 6172 6520 6765 6e65  # types are gene
+00000e70: 7261 7465 6420 696e 2061 2064 6f6d 6169  rated in a domai
+00000e80: 6e20 6d6f 6465 6c2c 2061 6e64 2074 6865  n model, and the
+00000e90: 6e20 7365 7269 616c 697a 6564 0a23 2069  n serialized.# i
+00000ea0: 6e74 6f20 4e65 7745 7665 6e74 206f 626a  nto NewEvent obj
+00000eb0: 6563 7473 2e20 416e 2061 6767 7265 6761  ects. An aggrega
+00000ec0: 7465 2049 4420 6d61 7920 6265 2075 7365  te ID may be use
+00000ed0: 6420 6173 2074 6865 0a23 206e 616d 6520  d as the.# name 
+00000ee0: 6f66 2061 2073 7472 6561 6d20 696e 2045  of a stream in E
+00000ef0: 7665 6e74 5374 6f72 6544 422e 0a0a 7374  ventStoreDB...st
+00000f00: 7265 616d 5f6e 616d 6531 203d 2073 7472  ream_name1 = str
+00000f10: 2875 7569 642e 7575 6964 3428 2929 0a65  (uuid.uuid4()).e
+00000f20: 7665 6e74 3120 3d20 4e65 7745 7665 6e74  vent1 = NewEvent
+00000f30: 280a 2020 2020 7479 7065 3d27 4f72 6465  (.    type='Orde
+00000f40: 7243 7265 6174 6564 272c 0a20 2020 2064  rCreated',.    d
+00000f50: 6174 613d 6227 7b22 6f72 6465 725f 6e75  ata=b'{"order_nu
+00000f60: 6d62 6572 223a 2022 3132 3334 3536 227d  mber": "123456"}
+00000f70: 270a 290a 6576 656e 7432 203d 204e 6577  '.).event2 = New
+00000f80: 4576 656e 7428 0a20 2020 2074 7970 653d  Event(.    type=
+00000f90: 274f 7264 6572 5375 626d 6974 7465 6427  'OrderSubmitted'
+00000fa0: 2c0a 2020 2020 6461 7461 3d62 277b 7d27  ,.    data=b'{}'
+00000fb0: 0a29 0a65 7665 6e74 3320 3d20 4e65 7745  .).event3 = NewE
+00000fc0: 7665 6e74 280a 2020 2020 7479 7065 3d27  vent(.    type='
+00000fd0: 4f72 6465 7243 616e 6365 6c6c 6564 272c  OrderCancelled',
+00000fe0: 0a20 2020 2064 6174 613d 6227 7b7d 270a  .    data=b'{}'.
+00000ff0: 290a 0a0a 2320 4170 7065 6e64 206e 6577  )...# Append new
+00001000: 2065 7665 6e74 7320 746f 2061 206e 6577   events to a new
+00001010: 2073 7472 6561 6d2e 2054 6865 2076 616c   stream. The val
+00001020: 7565 2072 6574 7572 6e65 640a 2320 6672  ue returned.# fr
+00001030: 6f6d 2074 6865 2061 7070 656e 645f 746f  om the append_to
+00001040: 5f73 7472 6561 6d28 2920 6d65 7468 6f64  _stream() method
+00001050: 2069 7320 7468 6520 6f76 6572 616c 6c0a   is the overall.
+00001060: 2320 2263 6f6d 6d69 7420 706f 7369 7469  # "commit positi
+00001070: 6f6e 2220 696e 2074 6865 2064 6174 6162  on" in the datab
+00001080: 6173 6520 6f66 2074 6865 206c 6173 7420  ase of the last 
+00001090: 6e65 7720 6576 656e 740a 2320 7265 636f  new event.# reco
+000010a0: 7264 6564 2062 7920 7468 6973 206f 7065  rded by this ope
+000010b0: 7261 7469 6f6e 2e20 5468 6520 7265 7475  ration. The retu
+000010c0: 726e 6564 2022 636f 6d6d 6974 2070 6f73  rned "commit pos
+000010d0: 6974 696f 6e22 0a23 206d 6179 2062 6520  ition".# may be 
+000010e0: 7573 6564 2069 6e20 6120 7573 6572 2069  used in a user i
+000010f0: 6e74 6572 6661 6365 2074 6f20 706f 6c6c  nterface to poll
+00001100: 2061 6e20 6576 656e 7475 616c 6c79 0a23   an eventually.#
+00001110: 2063 6f6e 7369 7374 656e 7420 6576 656e   consistent even
+00001120: 742d 7072 6f63 6573 7369 6e67 2063 6f6d  t-processing com
+00001130: 706f 6e65 6e74 2075 6e74 696c 2069 7420  ponent until it 
+00001140: 6361 6e0a 2320 7072 6573 656e 7420 616e  can.# present an
+00001150: 2075 702d 746f 2d64 6174 6520 6d61 7465   up-to-date mate
+00001160: 7269 616c 697a 6564 2076 6965 772e 204e  rialized view. N
+00001170: 6577 2065 7665 6e74 7320 6172 650a 2320  ew events are.# 
+00001180: 6561 6368 2061 6c6c 6f63 6174 6564 2061  each allocated a
+00001190: 2022 7374 7265 616d 2070 6f73 6974 696f   "stream positio
+000011a0: 6e22 2c20 7768 6963 6820 6973 2074 6865  n", which is the
+000011b0: 206e 6578 740a 2320 6176 6169 6c61 626c   next.# availabl
+000011c0: 6520 706f 7369 7469 6f6e 2069 6e20 7468  e position in th
+000011d0: 6520 7374 7265 616d 2c20 7374 6172 7469  e stream, starti
+000011e0: 6e67 2066 726f 6d20 302e 0a0a 636f 6d6d  ng from 0...comm
+000011f0: 6974 5f70 6f73 6974 696f 6e31 203d 2063  it_position1 = c
+00001200: 6c69 656e 742e 6170 7065 6e64 5f74 6f5f  lient.append_to_
+00001210: 7374 7265 616d 280a 2020 2020 7374 7265  stream(.    stre
+00001220: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00001230: 616d 6531 2c0a 2020 2020 6375 7272 656e  ame1,.    curren
+00001240: 745f 7665 7273 696f 6e3d 5374 7265 616d  t_version=Stream
+00001250: 5374 6174 652e 4e4f 5f53 5452 4541 4d2c  State.NO_STREAM,
+00001260: 0a20 2020 2065 7665 6e74 733d 5b65 7665  .    events=[eve
+00001270: 6e74 312c 2065 7665 6e74 325d 2c0a 290a  nt1, event2],.).
+00001280: 0a23 2041 7070 656e 6420 6576 656e 7473  .# Append events
+00001290: 2074 6f20 616e 2065 7869 7374 696e 6720   to an existing 
+000012a0: 7374 7265 616d 2e20 5468 6520 2263 7572  stream. The "cur
+000012b0: 7265 6e74 2076 6572 7369 6f6e 220a 2320  rent version".# 
+000012c0: 6973 2074 6865 2022 7374 7265 616d 2070  is the "stream p
+000012d0: 6f73 6974 696f 6e22 206f 6620 7468 6520  osition" of the 
+000012e0: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
+000012f0: 656e 7420 696e 2061 0a23 2073 7472 6561  ent in a.# strea
+00001300: 6d2e 2057 6520 6861 7665 2072 6563 6f72  m. We have recor
+00001310: 6465 6420 7477 6f20 6e65 7720 6576 656e  ded two new even
+00001320: 7473 2c20 736f 2074 6865 2022 6375 7272  ts, so the "curr
+00001330: 656e 740a 2320 7665 7273 696f 6e22 2069  ent.# version" i
+00001340: 7320 312e 2054 6865 2065 7863 6570 7469  s 1. The excepti
+00001350: 6f6e 2027 5772 6f6e 6743 7572 7265 6e74  on 'WrongCurrent
+00001360: 5665 7273 696f 6e27 2077 696c 6c20 6265  Version' will be
+00001370: 0a23 2072 6169 7365 6420 6966 2061 6e20  .# raised if an 
+00001380: 696e 636f 7272 6563 7420 7661 6c75 6520  incorrect value 
+00001390: 6973 2067 6976 656e 2e0a 0a63 6f6d 6d69  is given...commi
+000013a0: 745f 706f 7369 7469 6f6e 3220 3d20 636c  t_position2 = cl
+000013b0: 6965 6e74 2e61 7070 656e 645f 746f 5f73  ient.append_to_s
+000013c0: 7472 6561 6d28 0a20 2020 2073 7472 6561  tream(.    strea
+000013d0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+000013e0: 6d65 312c 0a20 2020 2063 7572 7265 6e74  me1,.    current
+000013f0: 5f76 6572 7369 6f6e 3d31 2c0a 2020 2020  _version=1,.    
+00001400: 6576 656e 7473 3d5b 6576 656e 7433 5d2c  events=[event3],
+00001410: 0a29 0a0a 2320 2d20 616c 6c6f 6361 7465  .)..# - allocate
+00001420: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
+00001430: 6e73 2069 6e63 7265 6173 6520 6d6f 6e6f  ns increase mono
+00001440: 746f 6e69 6361 6c6c 790a 6173 7365 7274  tonically.assert
+00001450: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
+00001460: 3220 3e20 636f 6d6d 6974 5f70 6f73 6974  2 > commit_posit
+00001470: 696f 6e31 0a0a 0a23 2047 6574 2065 7665  ion1...# Get eve
+00001480: 6e74 7320 7265 636f 7264 6564 2069 6e20  nts recorded in 
+00001490: 6120 7374 7265 616d 2e20 5468 6973 206d  a stream. This m
+000014a0: 6574 686f 6420 7265 7475 726e 730a 2320  ethod returns.# 
+000014b0: 6120 7365 7175 656e 6365 206f 6620 7265  a sequence of re
+000014c0: 636f 7264 6564 2065 7665 6e74 206f 626a  corded event obj
+000014d0: 6563 7473 2e20 5468 6520 7265 636f 7264  ects. The record
+000014e0: 6564 0a23 2065 7665 6e74 206f 626a 6563  ed.# event objec
+000014f0: 7473 206d 6179 2062 6520 6465 7365 7269  ts may be deseri
+00001500: 616c 697a 6564 2074 6f20 646f 6d61 696e  alized to domain
+00001510: 2065 7665 6e74 0a23 206f 626a 6563 7473   event.# objects
+00001520: 206f 6620 6469 6666 6572 656e 7420 7479   of different ty
+00001530: 7065 7320 616e 6420 7573 6564 2074 6f20  pes and used to 
+00001540: 7265 636f 6e73 7472 7563 740a 2320 616e  reconstruct.# an
+00001550: 2061 6767 7265 6761 7465 2069 6e20 6120   aggregate in a 
+00001560: 646f 6d61 696e 206d 6f64 656c 2e0a 0a72  domain model...r
+00001570: 6563 6f72 6465 645f 6576 656e 7473 203d  ecorded_events =
+00001580: 2063 6c69 656e 742e 6765 745f 7374 7265   client.get_stre
+00001590: 616d 280a 2020 2020 7374 7265 616d 5f6e  am(.    stream_n
+000015a0: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
+000015b0: 0a29 0a0a 2320 2d20 7374 7265 616d 2027  .)..# - stream '
+000015c0: 7374 7265 616d 5f6e 616d 6531 2720 6e6f  stream_name1' no
+000015d0: 7720 6861 7320 7468 7265 6520 6576 656e  w has three even
+000015e0: 7473 0a61 7373 6572 7420 6c65 6e28 7265  ts.assert len(re
+000015f0: 636f 7264 6564 5f65 7665 6e74 7329 203d  corded_events) =
+00001600: 3d20 330a 0a23 202d 2061 6c6c 6f63 6174  = 3..# - allocat
+00001610: 6564 2073 7472 6561 6d20 706f 7369 7469  ed stream positi
+00001620: 6f6e 7320 6172 6520 7a65 726f 2d62 6173  ons are zero-bas
+00001630: 6564 2061 6e64 2067 6170 6c65 7373 0a61  ed and gapless.a
+00001640: 7373 6572 7420 7265 636f 7264 6564 5f65  ssert recorded_e
+00001650: 7665 6e74 735b 305d 2e73 7472 6561 6d5f  vents[0].stream_
+00001660: 706f 7369 7469 6f6e 203d 3d20 300a 6173  position == 0.as
+00001670: 7365 7274 2072 6563 6f72 6465 645f 6576  sert recorded_ev
+00001680: 656e 7473 5b31 5d2e 7374 7265 616d 5f70  ents[1].stream_p
+00001690: 6f73 6974 696f 6e20 3d3d 2031 0a61 7373  osition == 1.ass
+000016a0: 6572 7420 7265 636f 7264 6564 5f65 7665  ert recorded_eve
+000016b0: 6e74 735b 325d 2e73 7472 6561 6d5f 706f  nts[2].stream_po
+000016c0: 7369 7469 6f6e 203d 3d20 320a 0a23 202d  sition == 2..# -
+000016d0: 2065 7665 6e74 2061 7474 7269 6275 7465   event attribute
+000016e0: 2076 616c 7565 7320 6172 6520 7265 636f   values are reco
+000016f0: 7264 6564 2066 6169 7468 6675 6c6c 790a  rded faithfully.
+00001700: 6173 7365 7274 2072 6563 6f72 6465 645f  assert recorded_
+00001710: 6576 656e 7473 5b30 5d2e 7479 7065 203d  events[0].type =
+00001720: 3d20 224f 7264 6572 4372 6561 7465 6422  = "OrderCreated"
+00001730: 0a61 7373 6572 7420 7265 636f 7264 6564  .assert recorded
+00001740: 5f65 7665 6e74 735b 305d 2e64 6174 6120  _events[0].data 
+00001750: 3d3d 2062 277b 226f 7264 6572 5f6e 756d  == b'{"order_num
+00001760: 6265 7222 3a20 2231 3233 3435 3622 7d27  ber": "123456"}'
+00001770: 0a61 7373 6572 7420 7265 636f 7264 6564  .assert recorded
+00001780: 5f65 7665 6e74 735b 305d 2e69 6420 3d3d  _events[0].id ==
+00001790: 2065 7665 6e74 312e 6964 0a0a 6173 7365   event1.id..asse
+000017a0: 7274 2072 6563 6f72 6465 645f 6576 656e  rt recorded_even
+000017b0: 7473 5b31 5d2e 7479 7065 203d 3d20 224f  ts[1].type == "O
+000017c0: 7264 6572 5375 626d 6974 7465 6422 0a61  rderSubmitted".a
+000017d0: 7373 6572 7420 7265 636f 7264 6564 5f65  ssert recorded_e
+000017e0: 7665 6e74 735b 315d 2e64 6174 6120 3d3d  vents[1].data ==
+000017f0: 2062 277b 7d27 0a61 7373 6572 7420 7265   b'{}'.assert re
+00001800: 636f 7264 6564 5f65 7665 6e74 735b 315d  corded_events[1]
+00001810: 2e69 6420 3d3d 2065 7665 6e74 322e 6964  .id == event2.id
+00001820: 0a0a 6173 7365 7274 2072 6563 6f72 6465  ..assert recorde
+00001830: 645f 6576 656e 7473 5b32 5d2e 7479 7065  d_events[2].type
+00001840: 203d 3d20 224f 7264 6572 4361 6e63 656c   == "OrderCancel
+00001850: 6c65 6422 0a61 7373 6572 7420 7265 636f  led".assert reco
+00001860: 7264 6564 5f65 7665 6e74 735b 325d 2e64  rded_events[2].d
+00001870: 6174 6120 3d3d 2062 277b 7d27 0a61 7373  ata == b'{}'.ass
+00001880: 6572 7420 7265 636f 7264 6564 5f65 7665  ert recorded_eve
+00001890: 6e74 735b 325d 2e69 6420 3d3d 2065 7665  nts[2].id == eve
+000018a0: 6e74 332e 6964 0a0a 0a23 2053 7461 7274  nt3.id...# Start
+000018b0: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
+000018c0: 6372 6970 7469 6f6e 2066 726f 6d20 6c61  cription from la
+000018d0: 7374 2072 6563 6f72 6465 6420 706f 7369  st recorded posi
+000018e0: 7469 6f6e 2e0a 2320 5468 6973 206d 6574  tion..# This met
+000018f0: 686f 6420 7265 7475 726e 7320 6120 2263  hod returns a "c
+00001900: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00001910: 7469 6f6e 2220 6f62 6a65 6374 2c0a 2320  tion" object,.# 
+00001920: 7768 6963 6820 6361 6e20 6265 2069 7465  which can be ite
+00001930: 7261 7465 6420 6f76 6572 2074 6f20 6f62  rated over to ob
+00001940: 7461 696e 2072 6563 6f72 6465 6420 6576  tain recorded ev
+00001950: 656e 7473 2e0a 2320 5468 6520 6974 6572  ents..# The iter
+00001960: 6174 6f72 2077 696c 6c20 6e6f 7420 7374  ator will not st
+00001970: 6f70 2077 6865 6e20 7468 6572 6520 6172  op when there ar
+00001980: 6520 6e6f 206d 6f72 6520 7265 636f 7264  e no more record
+00001990: 6564 0a23 2065 7665 6e74 7320 746f 2062  ed.# events to b
+000019a0: 6520 7265 7475 726e 6564 2c20 6275 7420  e returned, but 
+000019b0: 696e 7374 6561 6420 7769 6c6c 2062 6c6f  instead will blo
+000019c0: 636b 2c20 616e 6420 7468 656e 2063 6f6e  ck, and then con
+000019d0: 7469 6e75 650a 2320 7768 656e 2066 7572  tinue.# when fur
+000019e0: 7468 6572 2065 7665 6e74 7320 6172 6520  ther events are 
+000019f0: 7265 636f 7264 6564 2e20 4974 2063 616e  recorded. It can
+00001a00: 2062 6520 7573 6564 2061 7320 6120 636f   be used as a co
+00001a10: 6e74 6578 740a 2320 6d61 6e61 6765 7220  ntext.# manager 
+00001a20: 736f 2074 6861 7420 7468 6520 756e 6465  so that the unde
+00001a30: 726c 7969 6e67 2073 7472 6561 6d69 6e67  rlying streaming
+00001a40: 2067 5250 4320 6361 6c6c 2074 6f20 7468   gRPC call to th
+00001a50: 6520 6461 7461 6261 7365 0a23 2063 616e  e database.# can
+00001a60: 2062 6520 6361 6e63 656c 6c65 6420 636c   be cancelled cl
+00001a70: 6561 6e6c 7920 696e 2063 6173 6520 6f66  eanly in case of
+00001a80: 2061 6e79 2065 7272 6f72 2e0a 0a72 6563   any error...rec
+00001a90: 6569 7665 645f 6576 656e 7473 203d 205b  eived_events = [
+00001aa0: 5d0a 7769 7468 2063 6c69 656e 742e 7375  ].with client.su
+00001ab0: 6273 6372 6962 655f 746f 5f61 6c6c 2863  bscribe_to_all(c
+00001ac0: 6f6d 6d69 745f 706f 7369 7469 6f6e 3d30  ommit_position=0
+00001ad0: 2920 6173 2073 7562 7363 7269 7074 696f  ) as subscriptio
+00001ae0: 6e3a 0a0a 2020 2020 2320 4974 6572 6174  n:..    # Iterat
+00001af0: 6520 6f76 6572 2074 6865 2063 6174 6368  e over the catch
+00001b00: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+00001b10: 2e20 5072 6f63 6573 7320 6561 6368 2072  . Process each r
+00001b20: 6563 6f72 6465 640a 2020 2020 2320 6576  ecorded.    # ev
+00001b30: 656e 7420 696e 2074 7572 6e2e 2057 6974  ent in turn. Wit
+00001b40: 6869 6e20 616e 2061 746f 6d69 6320 6461  hin an atomic da
+00001b50: 7461 6261 7365 2074 7261 6e73 6163 7469  tabase transacti
+00001b60: 6f6e 2c20 7265 636f 7264 0a20 2020 2023  on, record.    #
+00001b70: 2074 6865 2065 7665 6e74 2773 2022 636f   the event's "co
+00001b80: 6d6d 6974 2070 6f73 6974 696f 6e22 2061  mmit position" a
+00001b90: 6c6f 6e67 2077 6974 6820 616e 7920 6e65  long with any ne
+00001ba0: 7720 7374 6174 6520 6765 6e65 7261 7465  w state generate
+00001bb0: 640a 2020 2020 2320 6279 2070 726f 6365  d.    # by proce
+00001bc0: 7373 696e 6720 7468 6520 6576 656e 742e  ssing the event.
+00001bd0: 2055 7365 2074 6865 2063 6f6d 706f 6e65   Use the compone
+00001be0: 6e74 2773 206c 6173 7420 7265 636f 7264  nt's last record
+00001bf0: 6564 2063 6f6d 6d69 740a 2020 2020 2320  ed commit.    # 
+00001c00: 706f 7369 7469 6f6e 2077 6865 6e20 7265  position when re
+00001c10: 7374 6172 7469 6e67 2074 6865 2063 6174  starting the cat
+00001c20: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00001c30: 6f6e 2e0a 0a20 2020 2066 6f72 2065 7665  on...    for eve
+00001c40: 6e74 2069 6e20 7375 6273 6372 6970 7469  nt in subscripti
+00001c50: 6f6e 3a0a 2020 2020 2020 2020 7265 6365  on:.        rece
+00001c60: 6976 6564 5f65 7665 6e74 732e 6170 7065  ived_events.appe
+00001c70: 6e64 2865 7665 6e74 290a 0a20 2020 2020  nd(event)..     
+00001c80: 2020 2069 6620 6576 656e 742e 636f 6d6d     if event.comm
+00001c90: 6974 5f70 6f73 6974 696f 6e20 3d3d 2063  it_position == c
+00001ca0: 6f6d 6d69 745f 706f 7369 7469 6f6e 323a  ommit_position2:
+00001cb0: 0a20 2020 2020 2020 2020 2020 2023 2042  .            # B
+00001cc0: 7265 616b 2073 6f20 7765 2063 616e 2063  reak so we can c
+00001cd0: 6f6e 7469 6e75 6520 7769 7468 2074 6865  ontinue with the
+00001ce0: 2065 7861 6d70 6c65 2e0a 2020 2020 2020   example..      
+00001cf0: 2020 2020 2020 6272 6561 6b0a 0a0a 2320        break...# 
+00001d00: 2d20 6576 656e 7473 2061 7265 2072 6563  - events are rec
+00001d10: 6569 7665 6420 696e 2074 6865 206f 7264  eived in the ord
+00001d20: 6572 2074 6865 7920 7765 7265 2072 6563  er they were rec
+00001d30: 6f72 6465 640a 6173 7365 7274 2072 6563  orded.assert rec
+00001d40: 6569 7665 645f 6576 656e 7473 5b2d 335d  eived_events[-3]
+00001d50: 2e74 7970 6520 3d3d 2022 4f72 6465 7243  .type == "OrderC
+00001d60: 7265 6174 6564 220a 6173 7365 7274 2072  reated".assert r
+00001d70: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
+00001d80: 335d 2e64 6174 6120 3d3d 2062 277b 226f  3].data == b'{"o
+00001d90: 7264 6572 5f6e 756d 6265 7222 3a20 2231  rder_number": "1
+00001da0: 3233 3435 3622 7d27 0a61 7373 6572 7420  23456"}'.assert 
+00001db0: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+00001dc0: 2d33 5d2e 6964 203d 3d20 6576 656e 7431  -3].id == event1
+00001dd0: 2e69 640a 0a61 7373 6572 7420 7265 6365  .id..assert rece
+00001de0: 6976 6564 5f65 7665 6e74 735b 2d32 5d2e  ived_events[-2].
+00001df0: 7479 7065 203d 3d20 224f 7264 6572 5375  type == "OrderSu
+00001e00: 626d 6974 7465 6422 0a61 7373 6572 7420  bmitted".assert 
+00001e10: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+00001e20: 2d32 5d2e 6461 7461 203d 3d20 6227 7b7d  -2].data == b'{}
+00001e30: 270a 6173 7365 7274 2072 6563 6569 7665  '.assert receive
+00001e40: 645f 6576 656e 7473 5b2d 325d 2e69 6420  d_events[-2].id 
+00001e50: 3d3d 2065 7665 6e74 322e 6964 0a0a 6173  == event2.id..as
+00001e60: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+00001e70: 656e 7473 5b2d 315d 2e74 7970 6520 3d3d  ents[-1].type ==
+00001e80: 2022 4f72 6465 7243 616e 6365 6c6c 6564   "OrderCancelled
+00001e90: 220a 6173 7365 7274 2072 6563 6569 7665  ".assert receive
+00001ea0: 645f 6576 656e 7473 5b2d 315d 2e64 6174  d_events[-1].dat
+00001eb0: 6120 3d3d 2062 277b 7d27 0a61 7373 6572  a == b'{}'.asser
+00001ec0: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+00001ed0: 735b 2d31 5d2e 6964 203d 3d20 6576 656e  s[-1].id == even
+00001ee0: 7433 2e69 640a 0a0a 2320 436c 6f73 6520  t3.id...# Close 
+00001ef0: 7468 6520 636c 6965 6e74 2773 2067 5250  the client's gRP
+00001f00: 4320 636f 6e6e 6563 7469 6f6e 2e0a 0a63  C connection...c
+00001f10: 6c69 656e 742e 636c 6f73 6528 290a 6060  lient.close().``
+00001f20: 600a 0a53 6565 2062 656c 6f77 2066 6f72  `..See below for
+00001f30: 206d 6f72 6520 6465 7461 696c 732e 0a0a   more details...
+00001f40: 466f 7220 616e 2065 7861 6d70 6c65 206f  For an example o
+00001f50: 6620 7573 6167 652c 2073 6565 2074 6865  f usage, see the
+00001f60: 205b 6576 656e 7473 6f75 7263 696e 672d   [eventsourcing-
+00001f70: 6576 656e 7473 746f 7265 6462 5d28 0a68  eventstoredb](.h
+00001f80: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00001f90: 6d2f 7079 6576 656e 7473 6f75 7263 696e  m/pyeventsourcin
+00001fa0: 672f 6576 656e 7473 6f75 7263 696e 672d  g/eventsourcing-
+00001fb0: 6576 656e 7473 746f 7265 6462 2920 7061  eventstoredb) pa
+00001fc0: 636b 6167 652e 0a0a 2323 2054 6162 6c65  ckage...## Table
+00001fd0: 206f 6620 636f 6e74 656e 7473 0a0a 3c21   of contents..<!
+00001fe0: 2d2d 2054 4f43 202d 2d3e 0a2a 205b 496e  -- TOC -->.* [In
+00001ff0: 7374 616c 6c20 7061 636b 6167 655d 2823  stall package](#
+00002000: 696e 7374 616c 6c2d 7061 636b 6167 6529  install-package)
+00002010: 0a20 202a 205b 4672 6f6d 2050 7950 495d  .  * [From PyPI]
+00002020: 2823 6672 6f6d 2d70 7970 6929 0a20 202a  (#from-pypi).  *
+00002030: 205b 5769 7468 2050 6f65 7472 795d 2823   [With Poetry](#
+00002040: 7769 7468 2d70 6f65 7472 7929 0a2a 205b  with-poetry).* [
+00002050: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
+00002060: 7665 725d 2823 6576 656e 7473 746f 7265  ver](#eventstore
+00002070: 6462 2d73 6572 7665 7229 0a20 202a 205b  db-server).  * [
+00002080: 5275 6e20 636f 6e74 6169 6e65 725d 2823  Run container](#
+00002090: 7275 6e2d 636f 6e74 6169 6e65 7229 0a20  run-container). 
+000020a0: 202a 205b 5374 6f70 2063 6f6e 7461 696e   * [Stop contain
+000020b0: 6572 5d28 2373 746f 702d 636f 6e74 6169  er](#stop-contai
+000020c0: 6e65 7229 0a2a 205b 4576 656e 7453 746f  ner).* [EventSto
+000020d0: 7265 4442 2063 6c69 656e 745d 2823 6576  reDB client](#ev
+000020e0: 656e 7473 746f 7265 6462 2d63 6c69 656e  entstoredb-clien
+000020f0: 7429 0a20 202a 205b 496d 706f 7274 2063  t).  * [Import c
+00002100: 6c61 7373 5d28 2369 6d70 6f72 742d 636c  lass](#import-cl
+00002110: 6173 7329 0a20 202a 205b 436f 6e73 7472  ass).  * [Constr
+00002120: 7563 7420 636c 6965 6e74 5d28 2363 6f6e  uct client](#con
+00002130: 7374 7275 6374 2d63 6c69 656e 7429 0a2a  struct-client).*
+00002140: 205b 436f 6e6e 6563 7469 6f6e 2073 7472   [Connection str
+00002150: 696e 6773 5d28 2363 6f6e 6e65 6374 696f  ings](#connectio
+00002160: 6e2d 7374 7269 6e67 7329 0a20 202a 205b  n-strings).  * [
+00002170: 5477 6f20 7363 6865 6d65 735d 2823 7477  Two schemes](#tw
+00002180: 6f2d 7363 6865 6d65 7329 0a20 202a 205b  o-schemes).  * [
+00002190: 5573 6572 2069 6e66 6f20 7374 7269 6e67  User info string
+000021a0: 5d28 2375 7365 722d 696e 666f 2d73 7472  ](#user-info-str
+000021b0: 696e 6729 0a20 202a 205b 5175 6572 7920  ing).  * [Query 
+000021c0: 7374 7269 6e67 5d28 2371 7565 7279 2d73  string](#query-s
+000021d0: 7472 696e 6729 0a20 202a 205b 4578 616d  tring).  * [Exam
+000021e0: 706c 6573 5d28 2365 7861 6d70 6c65 7329  ples](#examples)
+000021f0: 0a2a 205b 4576 656e 7420 6f62 6a65 6374  .* [Event object
+00002200: 735d 2823 6576 656e 742d 6f62 6a65 6374  s](#event-object
+00002210: 7329 0a20 202a 205b 4e65 7720 6576 656e  s).  * [New even
+00002220: 7473 5d28 236e 6577 2d65 7665 6e74 7329  ts](#new-events)
+00002230: 0a20 202a 205b 5265 636f 7264 6564 2065  .  * [Recorded e
+00002240: 7665 6e74 735d 2823 7265 636f 7264 6564  vents](#recorded
+00002250: 2d65 7665 6e74 7329 0a2a 205b 5374 7265  -events).* [Stre
+00002260: 616d 735d 2823 7374 7265 616d 7329 0a20  ams](#streams). 
+00002270: 202a 205b 4170 7065 6e64 2065 7665 6e74   * [Append event
+00002280: 735d 2823 6170 7065 6e64 2d65 7665 6e74  s](#append-event
+00002290: 7329 0a20 202a 205b 4964 656d 706f 7465  s).  * [Idempote
+000022a0: 6e74 2061 7070 656e 6420 6f70 6572 6174  nt append operat
+000022b0: 696f 6e73 5d28 2369 6465 6d70 6f74 656e  ions](#idempoten
+000022c0: 742d 6170 7065 6e64 2d6f 7065 7261 7469  t-append-operati
+000022d0: 6f6e 7329 0a20 202a 205b 5265 6164 2073  ons).  * [Read s
+000022e0: 7472 6561 6d20 6576 656e 7473 5d28 2372  tream events](#r
+000022f0: 6561 642d 7374 7265 616d 2d65 7665 6e74  ead-stream-event
+00002300: 7329 0a20 202a 205b 4765 7420 6375 7272  s).  * [Get curr
+00002310: 656e 7420 7665 7273 696f 6e5d 2823 6765  ent version](#ge
+00002320: 742d 6375 7272 656e 742d 7665 7273 696f  t-current-versio
+00002330: 6e29 0a20 202a 205b 486f 7720 746f 2069  n).  * [How to i
+00002340: 6d70 6c65 6d65 6e74 2073 6e61 7073 686f  mplement snapsho
+00002350: 7474 696e 6720 7769 7468 2045 7665 6e74  tting with Event
+00002360: 5374 6f72 6544 425d 2823 686f 772d 746f  StoreDB](#how-to
+00002370: 2d69 6d70 6c65 6d65 6e74 2d73 6e61 7073  -implement-snaps
+00002380: 686f 7474 696e 672d 7769 7468 2d65 7665  hotting-with-eve
+00002390: 6e74 7374 6f72 6564 6229 0a20 202a 205b  ntstoredb).  * [
+000023a0: 5265 6164 2061 6c6c 2065 7665 6e74 735d  Read all events]
+000023b0: 2823 7265 6164 2d61 6c6c 2d65 7665 6e74  (#read-all-event
+000023c0: 7329 0a20 202a 205b 4765 7420 636f 6d6d  s).  * [Get comm
+000023d0: 6974 2070 6f73 6974 696f 6e5d 2823 6765  it position](#ge
+000023e0: 742d 636f 6d6d 6974 2d70 6f73 6974 696f  t-commit-positio
+000023f0: 6e29 0a20 202a 205b 4765 7420 7374 7265  n).  * [Get stre
+00002400: 616d 206d 6574 6164 6174 615d 2823 6765  am metadata](#ge
+00002410: 742d 7374 7265 616d 2d6d 6574 6164 6174  t-stream-metadat
+00002420: 6129 0a20 202a 205b 5365 7420 7374 7265  a).  * [Set stre
+00002430: 616d 206d 6574 6164 6174 615d 2823 7365  am metadata](#se
+00002440: 742d 7374 7265 616d 2d6d 6574 6164 6174  t-stream-metadat
+00002450: 6129 0a20 202a 205b 4465 6c65 7465 2073  a).  * [Delete s
+00002460: 7472 6561 6d5d 2823 6465 6c65 7465 2d73  tream](#delete-s
+00002470: 7472 6561 6d29 0a20 202a 205b 546f 6d62  tream).  * [Tomb
+00002480: 7374 6f6e 6520 7374 7265 616d 5d28 2374  stone stream](#t
+00002490: 6f6d 6273 746f 6e65 2d73 7472 6561 6d29  ombstone-stream)
+000024a0: 0a2a 205b 4361 7463 682d 7570 2073 7562  .* [Catch-up sub
+000024b0: 7363 7269 7074 696f 6e73 5d28 2363 6174  scriptions](#cat
+000024c0: 6368 2d75 702d 7375 6273 6372 6970 7469  ch-up-subscripti
+000024d0: 6f6e 7329 0a20 202a 205b 5375 6273 6372  ons).  * [Subscr
+000024e0: 6962 6520 746f 2061 6c6c 2065 7665 6e74  ibe to all event
+000024f0: 735d 2823 7375 6273 6372 6962 652d 746f  s](#subscribe-to
+00002500: 2d61 6c6c 2d65 7665 6e74 7329 0a20 202a  -all-events).  *
+00002510: 205b 5375 6273 6372 6962 6520 746f 2073   [Subscribe to s
+00002520: 7472 6561 6d20 6576 656e 7473 5d28 2373  tream events](#s
+00002530: 7562 7363 7269 6265 2d74 6f2d 7374 7265  ubscribe-to-stre
+00002540: 616d 2d65 7665 6e74 7329 0a20 202a 205b  am-events).  * [
+00002550: 486f 7720 746f 2069 6d70 6c65 6d65 6e74  How to implement
+00002560: 2065 7861 6374 6c79 2d6f 6e63 6520 6576   exactly-once ev
+00002570: 656e 7420 7072 6f63 6573 7369 6e67 5d28  ent processing](
+00002580: 2368 6f77 2d74 6f2d 696d 706c 656d 656e  #how-to-implemen
+00002590: 742d 6578 6163 746c 792d 6f6e 6365 2d65  t-exactly-once-e
+000025a0: 7665 6e74 2d70 726f 6365 7373 696e 6729  vent-processing)
+000025b0: 0a2a 205b 5065 7273 6973 7465 6e74 2073  .* [Persistent s
+000025c0: 7562 7363 7269 7074 696f 6e73 5d28 2370  ubscriptions](#p
+000025d0: 6572 7369 7374 656e 742d 7375 6273 6372  ersistent-subscr
+000025e0: 6970 7469 6f6e 7329 0a20 202a 205b 4372  iptions).  * [Cr
+000025f0: 6561 7465 2073 7562 7363 7269 7074 696f  eate subscriptio
+00002600: 6e20 746f 2061 6c6c 5d28 2363 7265 6174  n to all](#creat
+00002610: 652d 7375 6273 6372 6970 7469 6f6e 2d74  e-subscription-t
+00002620: 6f2d 616c 6c29 0a20 202a 205b 5265 6164  o-all).  * [Read
+00002630: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
+00002640: 2061 6c6c 5d28 2372 6561 642d 7375 6273   all](#read-subs
+00002650: 6372 6970 7469 6f6e 2d74 6f2d 616c 6c29  cription-to-all)
+00002660: 0a20 202a 205b 486f 7720 746f 2077 7269  .  * [How to wri
+00002670: 7465 2061 2070 6572 7369 7374 656e 7420  te a persistent 
+00002680: 7375 6273 6372 6970 7469 6f6e 2063 6f6e  subscription con
+00002690: 7375 6d65 725d 2823 686f 772d 746f 2d77  sumer](#how-to-w
+000026a0: 7269 7465 2d61 2d70 6572 7369 7374 656e  rite-a-persisten
+000026b0: 742d 7375 6273 6372 6970 7469 6f6e 2d63  t-subscription-c
+000026c0: 6f6e 7375 6d65 7229 0a20 202a 205b 5570  onsumer).  * [Up
+000026d0: 6461 7465 2073 7562 7363 7269 7074 696f  date subscriptio
+000026e0: 6e20 746f 2061 6c6c 5d28 2375 7064 6174  n to all](#updat
+000026f0: 652d 7375 6273 6372 6970 7469 6f6e 2d74  e-subscription-t
+00002700: 6f2d 616c 6c29 0a20 202a 205b 4372 6561  o-all).  * [Crea
+00002710: 7465 2073 7562 7363 7269 7074 696f 6e20  te subscription 
+00002720: 746f 2073 7472 6561 6d5d 2823 6372 6561  to stream](#crea
+00002730: 7465 2d73 7562 7363 7269 7074 696f 6e2d  te-subscription-
+00002740: 746f 2d73 7472 6561 6d29 0a20 202a 205b  to-stream).  * [
+00002750: 5265 6164 2073 7562 7363 7269 7074 696f  Read subscriptio
+00002760: 6e20 746f 2073 7472 6561 6d5d 2823 7265  n to stream](#re
+00002770: 6164 2d73 7562 7363 7269 7074 696f 6e2d  ad-subscription-
+00002780: 746f 2d73 7472 6561 6d29 0a20 202a 205b  to-stream).  * [
+00002790: 5570 6461 7465 2073 7562 7363 7269 7074  Update subscript
+000027a0: 696f 6e20 746f 2073 7472 6561 6d5d 2823  ion to stream](#
+000027b0: 7570 6461 7465 2d73 7562 7363 7269 7074  update-subscript
+000027c0: 696f 6e2d 746f 2d73 7472 6561 6d29 0a20  ion-to-stream). 
+000027d0: 202a 205b 5265 706c 6179 2070 6172 6b65   * [Replay parke
+000027e0: 6420 6576 656e 7473 5d28 2372 6570 6c61  d events](#repla
+000027f0: 792d 7061 726b 6564 2d65 7665 6e74 7329  y-parked-events)
+00002800: 0a20 202a 205b 4765 7420 7375 6273 6372  .  * [Get subscr
+00002810: 6970 7469 6f6e 2069 6e66 6f5d 2823 6765  iption info](#ge
+00002820: 742d 7375 6273 6372 6970 7469 6f6e 2d69  t-subscription-i
+00002830: 6e66 6f29 0a20 202a 205b 4c69 7374 2073  nfo).  * [List s
+00002840: 7562 7363 7269 7074 696f 6e73 5d28 236c  ubscriptions](#l
+00002850: 6973 742d 7375 6273 6372 6970 7469 6f6e  ist-subscription
+00002860: 7329 0a20 202a 205b 4c69 7374 2073 7562  s).  * [List sub
+00002870: 7363 7269 7074 696f 6e73 2074 6f20 7374  scriptions to st
+00002880: 7265 616d 5d28 236c 6973 742d 7375 6273  ream](#list-subs
+00002890: 6372 6970 7469 6f6e 732d 746f 2d73 7472  criptions-to-str
+000028a0: 6561 6d29 0a20 202a 205b 4465 6c65 7465  eam).  * [Delete
+000028b0: 2073 7562 7363 7269 7074 696f 6e5d 2823   subscription](#
+000028c0: 6465 6c65 7465 2d73 7562 7363 7269 7074  delete-subscript
+000028d0: 696f 6e29 0a2a 205b 5072 6f6a 6563 7469  ion).* [Projecti
+000028e0: 6f6e 735d 2823 7072 6f6a 6563 7469 6f6e  ons](#projection
+000028f0: 7329 0a20 202a 205b 4372 6561 7465 2070  s).  * [Create p
+00002900: 726f 6a65 6374 696f 6e5d 2823 6372 6561  rojection](#crea
+00002910: 7465 2d70 726f 6a65 6374 696f 6e29 0a20  te-projection). 
+00002920: 202a 205b 5570 6461 7465 2070 726f 6a65   * [Update proje
+00002930: 6374 696f 6e5d 2823 7570 6461 7465 2d70  ction](#update-p
+00002940: 726f 6a65 6374 696f 6e29 0a20 202a 205b  rojection).  * [
+00002950: 4765 7420 7072 6f6a 6563 7469 6f6e 2073  Get projection s
+00002960: 7461 7469 7374 6963 735d 2823 6765 742d  tatistics](#get-
+00002970: 7072 6f6a 6563 7469 6f6e 2d73 7461 7469  projection-stati
+00002980: 7374 6963 7329 0a20 202a 205b 4765 7420  stics).  * [Get 
+00002990: 7072 6f6a 6563 7469 6f6e 2073 7461 7465  projection state
+000029a0: 5d28 2367 6574 2d70 726f 6a65 6374 696f  ](#get-projectio
+000029b0: 6e2d 7374 6174 6529 0a20 202a 205b 4765  n-state).  * [Ge
+000029c0: 7420 7072 6f6a 6563 7469 6f6e 2072 6573  t projection res
+000029d0: 756c 745d 2823 6765 742d 7072 6f6a 6563  ult](#get-projec
+000029e0: 7469 6f6e 2d72 6573 756c 7429 0a20 202a  tion-result).  *
+000029f0: 205b 456e 6162 6c65 2070 726f 6a65 6374   [Enable project
+00002a00: 696f 6e5d 2823 656e 6162 6c65 2d70 726f  ion](#enable-pro
+00002a10: 6a65 6374 696f 6e29 0a20 202a 205b 4469  jection).  * [Di
+00002a20: 7361 626c 6520 7072 6f6a 6563 7469 6f6e  sable projection
+00002a30: 5d28 2364 6973 6162 6c65 2d70 726f 6a65  ](#disable-proje
+00002a40: 6374 696f 6e29 0a20 202a 205b 5265 7365  ction).  * [Rese
+00002a50: 7420 7072 6f6a 6563 7469 6f6e 5d28 2372  t projection](#r
+00002a60: 6573 6574 2d70 726f 6a65 6374 696f 6e29  eset-projection)
+00002a70: 0a20 202a 205b 4465 6c65 7465 2070 726f  .  * [Delete pro
+00002a80: 6a65 6374 696f 6e5d 2823 6465 6c65 7465  jection](#delete
+00002a90: 2d70 726f 6a65 6374 696f 6e29 0a20 202a  -projection).  *
+00002aa0: 205b 5265 7374 6172 7420 7072 6f6a 6563   [Restart projec
+00002ab0: 7469 6f6e 7320 7375 6273 7973 7465 6d5d  tions subsystem]
+00002ac0: 2823 7265 7374 6172 742d 7072 6f6a 6563  (#restart-projec
+00002ad0: 7469 6f6e 732d 7375 6273 7973 7465 6d29  tions-subsystem)
+00002ae0: 0a2a 205b 4361 6c6c 2063 7265 6465 6e74  .* [Call credent
+00002af0: 6961 6c73 5d28 2363 616c 6c2d 6372 6564  ials](#call-cred
+00002b00: 656e 7469 616c 7329 0a20 202a 205b 436f  entials).  * [Co
+00002b10: 6e73 7472 7563 7420 6361 6c6c 2063 7265  nstruct call cre
+00002b20: 6465 6e74 6961 6c73 5d28 2363 6f6e 7374  dentials](#const
+00002b30: 7275 6374 2d63 616c 6c2d 6372 6564 656e  ruct-call-creden
+00002b40: 7469 616c 7329 0a2a 205b 436f 6e6e 6563  tials).* [Connec
+00002b50: 7469 6f6e 5d28 2363 6f6e 6e65 6374 696f  tion](#connectio
+00002b60: 6e29 0a20 202a 205b 5265 636f 6e6e 6563  n).  * [Reconnec
+00002b70: 745d 2823 7265 636f 6e6e 6563 7429 0a20  t](#reconnect). 
+00002b80: 202a 205b 436c 6f73 655d 2823 636c 6f73   * [Close](#clos
+00002b90: 6529 0a2a 205b 4173 796e 6369 6f20 636c  e).* [Asyncio cl
+00002ba0: 6965 6e74 5d28 2361 7379 6e63 696f 2d63  ient](#asyncio-c
+00002bb0: 6c69 656e 7429 0a20 202a 205b 5379 6e6f  lient).  * [Syno
+00002bc0: 7073 6973 5d28 2373 796e 6f70 7369 732d  psis](#synopsis-
+00002bd0: 3129 0a2a 205b 4e6f 7465 735d 2823 6e6f  1).* [Notes](#no
+00002be0: 7465 7329 0a20 202a 205b 5265 6775 6c61  tes).  * [Regula
+00002bf0: 7220 6578 7072 6573 7369 6f6e 2066 696c  r expression fil
+00002c00: 7465 7273 5d28 2372 6567 756c 6172 2d65  ters](#regular-e
+00002c10: 7870 7265 7373 696f 6e2d 6669 6c74 6572  xpression-filter
+00002c20: 7329 0a20 202a 205b 5265 636f 6e6e 6563  s).  * [Reconnec
+00002c30: 7420 616e 6420 7265 7472 7920 6d65 7468  t and retry meth
+00002c40: 6f64 2064 6563 6f72 6174 6f72 735d 2823  od decorators](#
+00002c50: 7265 636f 6e6e 6563 742d 616e 642d 7265  reconnect-and-re
+00002c60: 7472 792d 6d65 7468 6f64 2d64 6563 6f72  try-method-decor
+00002c70: 6174 6f72 7329 0a2a 205b 436f 6e74 7269  ators).* [Contri
+00002c80: 6275 746f 7273 5d28 2363 6f6e 7472 6962  butors](#contrib
+00002c90: 7574 6f72 7329 0a20 202a 205b 496e 7374  utors).  * [Inst
+00002ca0: 616c 6c20 506f 6574 7279 5d28 2369 6e73  all Poetry](#ins
+00002cb0: 7461 6c6c 2d70 6f65 7472 7929 0a20 202a  tall-poetry).  *
+00002cc0: 205b 5365 7475 7020 666f 7220 5079 4368   [Setup for PyCh
+00002cd0: 6172 6d20 7573 6572 735d 2823 7365 7475  arm users](#setu
+00002ce0: 702d 666f 722d 7079 6368 6172 6d2d 7573  p-for-pycharm-us
+00002cf0: 6572 7329 0a20 202a 205b 5365 7475 7020  ers).  * [Setup 
+00002d00: 6672 6f6d 2063 6f6d 6d61 6e64 206c 696e  from command lin
+00002d10: 655d 2823 7365 7475 702d 6672 6f6d 2d63  e](#setup-from-c
+00002d20: 6f6d 6d61 6e64 2d6c 696e 6529 0a20 202a  ommand-line).  *
+00002d30: 205b 5072 6f6a 6563 7420 4d61 6b65 6669   [Project Makefi
+00002d40: 6c65 2063 6f6d 6d61 6e64 735d 2823 7072  le commands](#pr
+00002d50: 6f6a 6563 742d 6d61 6b65 6669 6c65 2d63  oject-makefile-c
+00002d60: 6f6d 6d61 6e64 7329 0a3c 212d 2d20 544f  ommands).<!-- TO
+00002d70: 4320 2d2d 3e0a 0a23 2320 496e 7374 616c  C -->..## Instal
+00002d80: 6c20 7061 636b 6167 653c 6120 6964 3d22  l package<a id="
+00002d90: 696e 7374 616c 6c2d 7061 636b 6167 6522  install-package"
+00002da0: 3e3c 2f61 3e0a 0a49 7420 6973 2072 6563  ></a>..It is rec
+00002db0: 6f6d 6d65 6e64 6564 2074 6f20 696e 7374  ommended to inst
+00002dc0: 616c 6c20 5079 7468 6f6e 2070 6163 6b61  all Python packa
+00002dd0: 6765 7320 696e 746f 2061 2050 7974 686f  ges into a Pytho
+00002de0: 6e20 7669 7274 7561 6c20 656e 7669 726f  n virtual enviro
+00002df0: 6e6d 656e 742e 0a0a 2323 2320 4672 6f6d  nment...### From
+00002e00: 2050 7950 493c 6120 6964 3d22 6672 6f6d   PyPI<a id="from
+00002e10: 2d70 7970 6922 3e3c 2f61 3e0a 0a59 6f75  -pypi"></a>..You
+00002e20: 2063 616e 2075 7365 2070 6970 2074 6f20   can use pip to 
+00002e30: 696e 7374 616c 6c20 7468 6973 2070 6163  install this pac
+00002e40: 6b61 6765 2064 6972 6563 746c 7920 6672  kage directly fr
+00002e50: 6f6d 0a5b 7468 6520 5079 7468 6f6e 2050  om.[the Python P
+00002e60: 6163 6b61 6765 2049 6e64 6578 5d28 6874  ackage Index](ht
+00002e70: 7470 733a 2f2f 7079 7069 2e6f 7267 2f70  tps://pypi.org/p
+00002e80: 726f 6a65 6374 2f65 7364 6263 6c69 656e  roject/esdbclien
+00002e90: 742f 292e 0a0a 2020 2020 2420 7069 7020  t/)...    $ pip 
+00002ea0: 696e 7374 616c 6c20 6573 6462 636c 6965  install esdbclie
+00002eb0: 6e74 0a0a 2323 2320 5769 7468 2050 6f65  nt..### With Poe
+00002ec0: 7472 793c 6120 6964 3d22 7769 7468 2d70  try<a id="with-p
+00002ed0: 6f65 7472 7922 3e3c 2f61 3e0a 0a59 6f75  oetry"></a>..You
+00002ee0: 2063 616e 2075 7365 2050 6f65 7472 7920   can use Poetry 
+00002ef0: 746f 2061 6464 2074 6869 7320 7061 636b  to add this pack
+00002f00: 6167 6520 746f 2079 6f75 7220 7079 7072  age to your pypr
+00002f10: 6f6a 6563 742e 746f 6d6c 2061 6e64 2069  oject.toml and i
+00002f20: 6e73 7461 6c6c 2069 742e 0a0a 2020 2020  nstall it...    
+00002f30: 2420 706f 6574 7279 2061 6464 2065 7364  $ poetry add esd
+00002f40: 6263 6c69 656e 740a 0a23 2320 4576 656e  bclient..## Even
+00002f50: 7453 746f 7265 4442 2073 6572 7665 723c  tStoreDB server<
+00002f60: 6120 6964 3d22 6576 656e 7473 746f 7265  a id="eventstore
+00002f70: 6462 2d73 6572 7665 7222 3e3c 2f61 3e0a  db-server"></a>.
+00002f80: 0a54 6865 2045 7665 6e74 5374 6f72 6544  .The EventStoreD
+00002f90: 4220 7365 7276 6572 2063 616e 2062 6520  B server can be 
+00002fa0: 7275 6e20 6c6f 6361 6c6c 7920 7573 696e  run locally usin
+00002fb0: 6720 7468 6520 6f66 6669 6369 616c 2044  g the official D
+00002fc0: 6f63 6b65 7220 636f 6e74 6169 6e65 7220  ocker container 
+00002fd0: 696d 6167 652e 0a0a 2323 2320 5275 6e20  image...### Run 
+00002fe0: 636f 6e74 6169 6e65 723c 6120 6964 3d22  container<a id="
+00002ff0: 7275 6e2d 636f 6e74 6169 6e65 7222 3e3c  run-container"><
+00003000: 2f61 3e0a 0a46 6f72 2064 6576 656c 6f70  /a>..For develop
+00003010: 6d65 6e74 2c20 796f 7520 6361 6e20 7275  ment, you can ru
+00003020: 6e20 6120 2273 6563 7572 6522 2045 7665  n a "secure" Eve
+00003030: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
+00003040: 2075 7369 6e67 2074 6865 2066 6f6c 6c6f   using the follo
+00003050: 7769 6e67 2063 6f6d 6d61 6e64 2e0a 0a20  wing command... 
+00003060: 2020 2024 2064 6f63 6b65 7220 7275 6e20     $ docker run 
+00003070: 2d64 202d 2d6e 616d 6520 6576 656e 7473  -d --name events
+00003080: 746f 7265 6462 2d73 6563 7572 6520 2d69  toredb-secure -i
+00003090: 7420 2d70 2032 3131 333a 3231 3133 202d  t -p 2113:2113 -
+000030a0: 2d65 6e76 2022 484f 4d45 3d2f 746d 7022  -env "HOME=/tmp"
+000030b0: 2065 7665 6e74 7374 6f72 652f 6576 656e   eventstore/even
+000030c0: 7473 746f 7265 3a32 312e 3130 2e39 2d62  tstore:21.10.9-b
+000030d0: 7573 7465 722d 736c 696d 202d 2d64 6576  uster-slim --dev
+000030e0: 0a0a 4173 2077 6520 7769 6c6c 2073 6565  ..As we will see
+000030f0: 2c20 796f 7572 2063 6c69 656e 7420 7769  , your client wi
+00003100: 6c6c 206e 6565 6420 616e 2045 7665 6e74  ll need an Event
+00003110: 5374 6f72 6544 4220 636f 6e6e 6563 7469  StoreDB connecti
+00003120: 6f6e 2073 7472 696e 6720 5552 4920 6173  on string URI as
+00003130: 2074 6865 2076 616c 7565 0a6f 6620 6974   the value.of it
+00003140: 7320 6075 7269 6020 636f 6e73 7472 7563  s `uri` construc
+00003150: 746f 7220 6172 6775 6d65 6e74 2e20 5468  tor argument. Th
+00003160: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+00003170: 696e 6720 666f 7220 7468 6973 2022 7365  ing for this "se
+00003180: 6375 7265 2220 4576 656e 7453 746f 7265  cure" EventStore
+00003190: 4442 0a73 6572 7665 7220 776f 756c 6420  DB.server would 
+000031a0: 6265 3a0a 0a20 2020 2065 7364 623a 2f2f  be:..    esdb://
+000031b0: 6164 6d69 6e3a 6368 616e 6765 6974 406c  admin:changeit@l
+000031c0: 6f63 616c 686f 7374 3a32 3131 330a 0a54  ocalhost:2113..T
+000031d0: 6f20 636f 6e6e 6563 7420 746f 2061 2022  o connect to a "
+000031e0: 7365 6375 7265 2220 7365 7276 6572 2c20  secure" server, 
+000031f0: 796f 7520 7769 6c6c 2075 7375 616c 6c79  you will usually
+00003200: 206e 6565 6420 746f 2069 6e63 6c75 6465   need to include
+00003210: 2061 2022 7573 6572 6e61 6d65 220a 616e   a "username".an
+00003220: 6420 6120 2270 6173 7377 6f72 6422 2069  d a "password" i
+00003230: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
+00003240: 2073 7472 696e 672c 2073 6f20 7468 6174   string, so that
+00003250: 2074 6865 2073 6572 7665 7220 6361 6e20   the server can 
+00003260: 6175 7468 656e 7469 6361 7465 2074 6865  authenticate the
+00003270: 0a63 6c69 656e 742e 2057 6974 6820 4576  .client. With Ev
+00003280: 656e 7453 746f 7265 4442 2c20 7468 6520  entStoreDB, the 
+00003290: 6465 6661 756c 7420 7573 6572 6e61 6d65  default username
+000032a0: 2069 7320 2261 646d 696e 2220 616e 6420   is "admin" and 
+000032b0: 7468 6520 6465 6661 756c 7420 7061 7373  the default pass
+000032c0: 776f 7264 0a69 7320 2263 6861 6e67 6569  word.is "changei
+000032d0: 7422 2e0a 0a57 6865 6e20 636f 6e6e 6563  t"...When connec
+000032e0: 7469 6e67 2074 6f20 6120 2273 6563 7572  ting to a "secur
+000032f0: 6522 2073 6572 7665 722c 2079 6f75 206d  e" server, you m
+00003300: 6179 2061 6c73 6f20 6e65 6564 2074 6f20  ay also need to 
+00003310: 7072 6f76 6964 6520 616e 2053 534c 2f54  provide an SSL/T
+00003320: 4c53 2063 6572 7469 6669 6361 7465 0a61  LS certificate.a
+00003330: 7320 7468 6520 7661 6c75 6520 6f66 2074  s the value of t
+00003340: 6865 2060 726f 6f74 5f63 6572 7469 6669  he `root_certifi
+00003350: 6361 7465 7360 2063 6f6e 7374 7275 6374  cates` construct
+00003360: 6f72 2061 7267 756d 656e 742e 2049 6620  or argument. If 
+00003370: 7468 6520 7365 7276 6572 2063 6572 7469  the server certi
+00003380: 6669 6361 7465 0a69 7320 7075 626c 6963  ficate.is public
+00003390: 6c79 2073 6967 6e65 642c 2074 6865 2072  ly signed, the r
+000033a0: 6f6f 7420 6365 7274 6966 6963 6174 6573  oot certificates
+000033b0: 206f 6620 7468 6520 6365 7274 6966 6963   of the certific
+000033c0: 6174 6520 6175 7468 6f72 6974 7920 6d61  ate authority ma
+000033d0: 7920 6265 2069 6e73 7461 6c6c 6564 0a6c  y be installed.l
+000033e0: 6f63 616c 6c79 2061 6e64 2070 6963 6b65  ocally and picke
+000033f0: 6420 7570 2062 7920 7468 6520 6772 7063  d up by the grpc
+00003400: 2070 6163 6b61 6765 2066 726f 6d20 6120   package from a 
+00003410: 6465 6661 756c 7420 6c6f 6361 7469 6f6e  default location
+00003420: 2e20 5468 6520 636c 6965 6e74 2075 7365  . The client use
+00003430: 7320 7468 650a 726f 6f74 2053 534c 2f54  s the.root SSL/T
+00003440: 4c53 2063 6572 7469 6669 6361 7465 2074  LS certificate t
+00003450: 6f20 6175 7468 656e 7469 6361 7465 2074  o authenticate t
+00003460: 6865 2073 6572 7665 722e 2046 6f72 2064  he server. For d
+00003470: 6576 656c 6f70 6d65 6e74 2c20 796f 7520  evelopment, you 
+00003480: 6361 6e20 6569 7468 6572 0a75 7365 2074  can either.use t
+00003490: 6865 2053 534c 2f54 4c53 2063 6572 7469  he SSL/TLS certi
+000034a0: 6669 6361 7465 206f 6620 6120 7365 6c66  ficate of a self
+000034b0: 2d73 6967 6e69 6e67 2063 6572 7469 6669  -signing certifi
+000034c0: 6361 7465 2061 7574 686f 7269 7479 2075  cate authority u
+000034d0: 7365 6420 746f 2063 7265 6174 6520 7468  sed to create th
+000034e0: 650a 7365 7276 6572 2773 2063 6572 7469  e.server's certi
+000034f0: 6669 6361 7465 2e20 4f72 2c20 7768 656e  ficate. Or, when
+00003500: 2075 7369 6e67 2061 2073 696e 676c 652d   using a single-
+00003510: 6e6f 6465 2063 6c75 7374 6572 2c20 796f  node cluster, yo
+00003520: 7520 6361 6e20 6a75 7374 2075 7365 2074  u can just use t
+00003530: 6865 2073 6572 7665 720a 6365 7274 6966  he server.certif
+00003540: 6963 6174 6520 6974 7365 6c66 2c20 6765  icate itself, ge
+00003550: 7474 696e 6720 7468 6520 7365 7276 6572  tting the server
+00003560: 2063 6572 7469 6669 6361 7465 2077 6974   certificate wit
+00003570: 6820 7468 6520 666f 6c6c 6f77 696e 6720  h the following 
+00003580: 5079 7468 6f6e 2063 6f64 652e 0a0a 6060  Python code...``
+00003590: 6070 7974 686f 6e0a 696d 706f 7274 2073  `python.import s
+000035a0: 736c 0a0a 7365 7276 6572 5f63 6572 7469  sl..server_certi
+000035b0: 6669 6361 7465 203d 2073 736c 2e67 6574  ficate = ssl.get
+000035c0: 5f73 6572 7665 725f 6365 7274 6966 6963  _server_certific
+000035d0: 6174 6528 6164 6472 3d28 276c 6f63 616c  ate(addr=('local
+000035e0: 686f 7374 272c 2032 3131 3329 290a 6060  host', 2113)).``
+000035f0: 600a 0a41 6c74 6572 6e61 7469 7665 6c79  `..Alternatively
+00003600: 2c20 796f 7520 6361 6e20 7374 6172 7420  , you can start 
+00003610: 616e 2022 696e 7365 6375 7265 2220 7365  an "insecure" se
+00003620: 7276 6572 2075 7369 6e67 2074 6865 2066  rver using the f
+00003630: 6f6c 6c6f 7769 6e67 2063 6f6d 6d61 6e64  ollowing command
+00003640: 2e0a 0a20 2020 2024 2064 6f63 6b65 7220  ...    $ docker 
+00003650: 7275 6e20 2d64 202d 2d6e 616d 6520 6576  run -d --name ev
+00003660: 656e 7473 746f 7265 6462 2d69 6e73 6563  entstoredb-insec
+00003670: 7572 6520 2d69 7420 2d70 2032 3131 333a  ure -it -p 2113:
+00003680: 3231 3133 2065 7665 6e74 7374 6f72 652f  2113 eventstore/
+00003690: 6576 656e 7473 746f 7265 3a32 312e 3130  eventstore:21.10
+000036a0: 2e39 2d62 7573 7465 722d 736c 696d 202d  .9-buster-slim -
+000036b0: 2d69 6e73 6563 7572 650a 0a54 6865 2063  -insecure..The c
+000036c0: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+000036d0: 2055 5249 2066 6f72 2074 6869 7320 2269   URI for this "i
+000036e0: 6e73 6563 7572 6522 2073 6572 7665 7220  nsecure" server 
+000036f0: 776f 756c 6420 6265 3a0a 0a20 2020 2065  would be:..    e
+00003700: 7364 623a 2f2f 6c6f 6361 6c68 6f73 743a  sdb://localhost:
+00003710: 3231 3133 3f54 6c73 3d66 616c 7365 0a0a  2113?Tls=false..
+00003720: 4173 2077 6520 7769 6c6c 2073 6565 2c20  As we will see, 
+00003730: 7768 656e 2063 6f6e 6e65 6374 696e 6720  when connecting 
+00003740: 746f 2061 6e20 2269 6e73 6563 7572 6522  to an "insecure"
+00003750: 2073 6572 7665 722c 2074 6865 7265 2069   server, there i
+00003760: 7320 6e6f 206e 6565 6420 746f 2069 6e63  s no need to inc
+00003770: 6c75 6465 0a61 2022 7573 6572 6e61 6d65  lude.a "username
+00003780: 2220 616e 6420 6120 2270 6173 7377 6f72  " and a "passwor
+00003790: 6422 2069 6e20 7468 6520 636f 6e6e 6563  d" in the connec
+000037a0: 7469 6f6e 2073 7472 696e 672e 2049 6620  tion string. If 
+000037b0: 796f 7520 646f 2c20 7468 6573 6520 7661  you do, these va
+000037c0: 6c75 6573 2077 696c 6c0a 6265 2069 676e  lues will.be ign
+000037d0: 6f72 6564 2062 7920 7468 6520 636c 6965  ored by the clie
+000037e0: 6e74 2c20 736f 2074 6861 7420 7468 6579  nt, so that they
+000037f0: 2061 7265 206e 6f74 2073 656e 7420 6f76   are not sent ov
+00003800: 6572 2061 6e20 696e 7365 6375 7265 2063  er an insecure c
+00003810: 6861 6e6e 656c 2e0a 0a50 6c65 6173 6520  hannel...Please 
+00003820: 6e6f 7465 2c20 7468 6520 2269 6e73 6563  note, the "insec
+00003830: 7572 6522 2063 6f6e 6e65 6374 696f 6e20  ure" connection 
+00003840: 7374 7269 6e67 2075 7365 7320 6120 7175  string uses a qu
+00003850: 6572 7920 7374 7269 6e67 2077 6974 6820  ery string with 
+00003860: 7468 6520 6669 656c 642d 7661 6c75 650a  the field-value.
+00003870: 6054 6c73 3d66 616c 7365 602e 2054 6865  `Tls=false`. The
+00003880: 2076 616c 7565 206f 6620 7468 6973 2066   value of this f
+00003890: 6965 6c64 2069 7320 6279 2064 6566 6175  ield is by defau
+000038a0: 6c74 2060 7472 7565 602e 0a0a 2323 2320  lt `true`...### 
+000038b0: 5374 6f70 2063 6f6e 7461 696e 6572 3c61  Stop container<a
+000038c0: 2069 643d 2273 746f 702d 636f 6e74 6169   id="stop-contai
+000038d0: 6e65 7222 3e3c 2f61 3e0a 0a54 6f20 7374  ner"></a>..To st
+000038e0: 6f70 2061 6e64 2072 656d 6f76 6520 7468  op and remove th
+000038f0: 6520 2273 6563 7572 6522 2063 6f6e 7461  e "secure" conta
+00003900: 696e 6572 2c20 7573 6520 7468 6520 666f  iner, use the fo
+00003910: 6c6c 6f77 696e 6720 446f 636b 6572 2063  llowing Docker c
+00003920: 6f6d 6d61 6e64 732e 0a0a 2020 2020 2420  ommands...    $ 
+00003930: 646f 636b 6572 2073 746f 7020 6576 656e  docker stop even
+00003940: 7473 746f 7265 6462 2d73 6563 7572 650a  tstoredb-secure.
+00003950: 0924 2064 6f63 6b65 7220 726d 2065 7665  .$ docker rm eve
+00003960: 6e74 7374 6f72 6564 622d 7365 6375 7265  ntstoredb-secure
+00003970: 0a0a 546f 2073 746f 7020 616e 6420 7265  ..To stop and re
+00003980: 6d6f 7665 2074 6865 2022 696e 7365 6375  move the "insecu
+00003990: 7265 2220 636f 6e74 6169 6e65 722c 2075  re" container, u
+000039a0: 7365 2074 6865 2066 6f6c 6c6f 7769 6e67  se the following
+000039b0: 2044 6f63 6b65 7220 636f 6d6d 616e 6473   Docker commands
+000039c0: 2e0a 0a20 2020 2024 2064 6f63 6b65 7220  ...    $ docker 
+000039d0: 7374 6f70 2065 7665 6e74 7374 6f72 6564  stop eventstored
+000039e0: 622d 696e 7365 6375 7265 0a09 2420 646f  b-insecure..$ do
+000039f0: 636b 6572 2072 6d20 6576 656e 7473 746f  cker rm eventsto
+00003a00: 7265 6462 2d69 6e73 6563 7572 650a 0a0a  redb-insecure...
+00003a10: 2323 2045 7665 6e74 5374 6f72 6544 4220  ## EventStoreDB 
+00003a20: 636c 6965 6e74 3c61 2069 643d 2265 7665  client<a id="eve
+00003a30: 6e74 7374 6f72 6564 622d 636c 6965 6e74  ntstoredb-client
+00003a40: 223e 3c2f 613e 0a0a 5468 6973 2045 7665  "></a>..This Eve
+00003a50: 6e74 5374 6f72 6544 4220 636c 6965 6e74  ntStoreDB client
+00003a60: 2069 7320 696d 706c 656d 656e 7465 6420   is implemented 
+00003a70: 696e 2074 6865 2060 6573 6462 636c 6965  in the `esdbclie
+00003a80: 6e74 6020 7061 636b 6167 6520 7769 7468  nt` package with
+00003a90: 0a74 6865 2060 4576 656e 7453 746f 7265  .the `EventStore
+00003aa0: 4442 436c 6965 6e74 6020 636c 6173 732e  DBClient` class.
+00003ab0: 0a0a 2323 2320 496d 706f 7274 2063 6c61  ..### Import cla
+00003ac0: 7373 3c61 2069 643d 2269 6d70 6f72 742d  ss<a id="import-
+00003ad0: 636c 6173 7322 3e3c 2f61 3e0a 0a54 6865  class"></a>..The
+00003ae0: 2060 4576 656e 7453 746f 7265 4442 436c   `EventStoreDBCl
+00003af0: 6965 6e74 6020 636c 6173 7320 6361 6e20  ient` class can 
+00003b00: 6265 2069 6d70 6f72 7465 6420 6672 6f6d  be imported from
+00003b10: 2074 6865 2060 6573 6462 636c 6965 6e74   the `esdbclient
+00003b20: 6020 7061 636b 6167 652e 0a0a 6060 6070  ` package...```p
+00003b30: 7974 686f 6e0a 6672 6f6d 2065 7364 6263  ython.from esdbc
+00003b40: 6c69 656e 7420 696d 706f 7274 2045 7665  lient import Eve
+00003b50: 6e74 5374 6f72 6544 4243 6c69 656e 740a  ntStoreDBClient.
+00003b60: 6060 600a 0a23 2323 2043 6f6e 7374 7275  ```..### Constru
+00003b70: 6374 2063 6c69 656e 743c 6120 6964 3d22  ct client<a id="
+00003b80: 636f 6e73 7472 7563 742d 636c 6965 6e74  construct-client
+00003b90: 223e 3c2f 613e 0a0a 5468 6520 6045 7665  "></a>..The `Eve
+00003ba0: 6e74 5374 6f72 6544 4243 6c69 656e 7460  ntStoreDBClient`
+00003bb0: 2063 6c61 7373 2068 6173 206f 6e65 2072   class has one r
+00003bc0: 6571 7569 7265 6420 636f 6e73 7472 7563  equired construc
+00003bd0: 746f 7220 6172 6775 6d65 6e74 2c20 6075  tor argument, `u
+00003be0: 7269 602c 2061 6e64 206f 6e65 0a6f 7074  ri`, and one.opt
+00003bf0: 696f 6e61 6c20 636f 6e73 7472 7563 746f  ional constructo
+00003c00: 7220 6172 6775 6d65 6e74 2c20 6072 6f6f  r argument, `roo
+00003c10: 745f 6365 7274 6966 6963 6174 6573 602e  t_certificates`.
+00003c20: 0a0a 5468 6520 6075 7269 6020 6172 6775  ..The `uri` argu
+00003c30: 6d65 6e74 2069 7320 6578 7065 6374 6564  ment is expected
+00003c40: 2074 6f20 6265 2061 6e20 4576 656e 7453   to be an EventS
+00003c50: 746f 7265 4442 2063 6f6e 6e65 6374 696f  toreDB connectio
+00003c60: 6e20 7374 7269 6e67 2055 5249 2074 6861  n string URI tha
+00003c70: 740a 636f 6e66 6f72 6d73 2077 6974 6820  t.conforms with 
+00003c80: 7468 6520 7374 616e 6461 7264 2045 7665  the standard Eve
+00003c90: 6e74 5374 6f72 6544 4220 2265 7364 6222  ntStoreDB "esdb"
+00003ca0: 206f 7220 2265 7364 622b 6469 7363 6f76   or "esdb+discov
+00003cb0: 6572 2220 5552 4920 7363 6865 6d65 732e  er" URI schemes.
+00003cc0: 0a0a 466f 7220 6578 616d 706c 652c 2074  ..For example, t
+00003cd0: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6e  he following con
+00003ce0: 6e65 6374 696f 6e20 7374 7269 6e67 2073  nection string s
+00003cf0: 7065 6369 6669 6573 2074 6861 7420 7468  pecifies that th
+00003d00: 6520 636c 6965 6e74 2073 686f 756c 640a  e client should.
+00003d10: 6174 7465 6d70 7420 746f 2063 7265 6174  attempt to creat
+00003d20: 6520 6120 2273 6563 7572 6522 2063 6f6e  e a "secure" con
+00003d30: 6e65 6374 696f 6e20 746f 2070 6f72 7420  nection to port 
+00003d40: 3231 3133 206f 6e20 226c 6f63 616c 686f  2113 on "localho
+00003d50: 7374 222c 2061 6e64 2075 7365 2074 6865  st", and use the
+00003d60: 0a63 6c69 656e 7420 6372 6564 656e 7469  .client credenti
+00003d70: 616c 7320 2275 7365 726e 616d 6522 2061  als "username" a
+00003d80: 6e64 2022 7061 7373 776f 7264 2220 7768  nd "password" wh
+00003d90: 656e 206d 616b 696e 6720 6361 6c6c 7320  en making calls 
+00003da0: 746f 2074 6865 2073 6572 7665 722e 0a0a  to the server...
+00003db0: 2020 2020 6573 6462 3a2f 2f75 7365 726e      esdb://usern
+00003dc0: 616d 653a 7061 7373 776f 7264 406c 6f63  ame:password@loc
+00003dd0: 616c 686f 7374 3a32 3131 333f 546c 733d  alhost:2113?Tls=
+00003de0: 7472 7565 0a0a 5468 6520 636c 6965 6e74  true..The client
+00003df0: 206d 7573 7420 6265 2063 6f6e 6669 6775   must be configu
+00003e00: 7265 6420 746f 2063 7265 6174 6520 6120  red to create a 
+00003e10: 2273 6563 7572 6522 2063 6f6e 6e65 6374  "secure" connect
+00003e20: 696f 6e20 746f 2061 2022 7365 6375 7265  ion to a "secure
+00003e30: 2220 7365 7276 6572 2c0a 6f72 2061 6c74  " server,.or alt
+00003e40: 6572 6e61 7469 7665 6c79 2061 6e20 2269  ernatively an "i
+00003e50: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
+00003e60: 696f 6e20 746f 2061 6e20 2269 6e73 6563  ion to an "insec
+00003e70: 7572 6522 2073 6572 7665 722e 2042 7920  ure" server. By 
+00003e80: 6465 6661 756c 742c 2074 6865 0a63 6c69  default, the.cli
+00003e90: 656e 7420 7769 6c6c 2061 7474 656d 7074  ent will attempt
+00003ea0: 2074 6f20 6372 6561 7465 2061 2022 7365   to create a "se
+00003eb0: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
+00003ec0: 2e20 416e 6420 736f 2c20 7768 656e 2063  . And so, when c
+00003ed0: 6f6e 6e65 6374 696e 6720 746f 2061 6e0a  onnecting to an.
+00003ee0: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
+00003ef0: 722c 2074 6865 2063 6f6e 6e65 6374 696f  r, the connectio
+00003f00: 6e20 7374 7269 6e67 206d 7573 7420 7370  n string must sp
+00003f10: 6563 6966 7920 7468 6174 2074 6865 2063  ecify that the c
+00003f20: 6c69 656e 7420 7368 6f75 6c64 2061 7474  lient should att
+00003f30: 656d 7074 0a74 6f20 6d61 6b65 2061 6e20  empt.to make an 
+00003f40: 2269 6e73 6563 7572 6522 2063 6f6e 6e65  "insecure" conne
+00003f50: 6374 696f 6e2e 0a0a 5468 6520 666f 6c6c  ction...The foll
+00003f60: 6f77 696e 6720 636f 6e6e 6563 7469 6f6e  owing connection
+00003f70: 2073 7472 696e 6720 7370 6563 6966 6965   string specifie
+00003f80: 7320 7468 6174 2074 6865 2063 6c69 656e  s that the clien
+00003f90: 7420 7368 6f75 6c64 0a61 7474 656d 7074  t should.attempt
+00003fa0: 2074 6f20 6372 6561 7465 2061 6e20 2269   to create an "i
+00003fb0: 6e73 6563 7572 6522 2063 6f6e 6e65 6374  nsecure" connect
+00003fc0: 696f 6e20 746f 2070 6f72 7420 3231 3133  ion to port 2113
+00003fd0: 206f 6e20 226c 6f63 616c 686f 7374 222e   on "localhost".
+00003fe0: 0a57 6865 6e20 636f 6e6e 6563 7469 6e67  .When connecting
+00003ff0: 2074 6f20 616e 2022 696e 7365 6375 7265   to an "insecure
+00004000: 2220 7365 7276 6572 2c20 7468 6520 636c  " server, the cl
+00004010: 6965 6e74 2077 696c 6c20 6967 6e6f 7265  ient will ignore
+00004020: 2061 6e79 0a75 7365 726e 616d 6520 616e   any.username an
+00004030: 6420 7061 7373 776f 7264 2069 6e66 6f72  d password infor
+00004040: 6d61 7469 6f6e 2069 6e63 6c75 6465 6420  mation included 
+00004050: 696e 2074 6865 2063 6f6e 6e65 6374 696f  in the connectio
+00004060: 6e20 7374 7269 6e67 2c0a 736f 2074 6861  n string,.so tha
+00004070: 7420 7573 6572 6e61 6d65 7320 616e 6420  t usernames and 
+00004080: 7061 7373 776f 7264 7320 6172 6520 6e6f  passwords are no
+00004090: 7420 7365 6e74 206f 7665 7220 616e 2022  t sent over an "
+000040a0: 696e 7365 6375 7265 2220 636f 6e6e 6563  insecure" connec
+000040b0: 7469 6f6e 2e0a 0a20 2020 2065 7364 623a  tion...    esdb:
+000040c0: 2f2f 6c6f 6361 6c68 6f73 743a 3231 3133  //localhost:2113
+000040d0: 3f54 6c73 3d66 616c 7365 0a0a 506c 6561  ?Tls=false..Plea
+000040e0: 7365 206e 6f74 652c 2074 6865 2022 696e  se note, the "in
+000040f0: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
+00004100: 6f6e 2073 7472 696e 6720 7573 6573 2061  on string uses a
+00004110: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
+00004120: 7468 2074 6865 2066 6965 6c64 2d76 616c  th the field-val
+00004130: 7565 0a60 546c 733d 6661 6c73 6560 2e20  ue.`Tls=false`. 
+00004140: 5468 6520 7661 6c75 6520 6f66 2074 6869  The value of thi
+00004150: 7320 6669 656c 6420 6973 2062 7920 6465  s field is by de
+00004160: 6661 756c 7420 6074 7275 6560 2e0a 0a57  fault `true`...W
+00004170: 6865 6e20 636f 6e6e 6563 7469 6e67 2074  hen connecting t
+00004180: 6f20 6120 2273 6563 7572 6522 2073 6572  o a "secure" ser
+00004190: 7665 722c 2074 6865 2060 726f 6f74 5f63  ver, the `root_c
+000041a0: 6572 7469 6669 6361 7465 7360 2061 7267  ertificates` arg
+000041b0: 756d 656e 7420 6361 6e20 6265 0a61 2050  ument can be.a P
+000041c0: 7974 686f 6e20 6073 7472 6020 636f 6e74  ython `str` cont
+000041d0: 6169 6e69 6e67 2050 454d 2065 6e63 6f64  aining PEM encod
+000041e0: 6564 2053 534c 2f54 4c53 2072 6f6f 7420  ed SSL/TLS root 
+000041f0: 6365 7274 6966 6963 6174 6573 2e20 5468  certificates. Th
+00004200: 6973 2076 616c 7565 2069 730a 7061 7373  is value is.pass
+00004210: 6564 2064 6972 6563 746c 7920 746f 2060  ed directly to `
+00004220: 6772 7063 2e73 736c 5f63 6861 6e6e 656c  grpc.ssl_channel
+00004230: 5f63 7265 6465 6e74 6961 6c73 2829 602e  _credentials()`.
+00004240: 2049 7420 6973 2075 7365 6420 666f 7220   It is used for 
+00004250: 6175 7468 656e 7469 6361 7469 6e67 2074  authenticating t
+00004260: 6865 0a73 6572 7665 7220 746f 2074 6865  he.server to the
+00004270: 2063 6c69 656e 742e 2049 7420 6973 2063   client. It is c
+00004280: 6f6d 6d6f 6e6c 7920 7468 6520 6365 7274  ommonly the cert
+00004290: 6966 6963 6174 6520 6f66 2074 6865 2063  ificate of the c
+000042a0: 6572 7469 6669 6361 7465 2061 7574 686f  ertificate autho
+000042b0: 7269 7479 2074 6861 740a 7761 7320 7265  rity that.was re
+000042c0: 7370 6f6e 7369 626c 6520 666f 7220 6765  sponsible for ge
+000042d0: 6e65 7261 7469 6e67 2074 6865 2053 534c  nerating the SSL
+000042e0: 2f54 4c53 2063 6572 7469 6669 6361 7465  /TLS certificate
+000042f0: 2075 7365 6420 6279 2074 6865 2045 7665   used by the Eve
+00004300: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
+00004310: 2e0a 4f66 7465 6e20 6974 2069 7320 756e  ..Often it is un
+00004320: 6e65 6365 7373 6172 7920 746f 2070 726f  necessary to pro
+00004330: 7669 6465 2074 6865 7365 2063 6572 7469  vide these certi
+00004340: 6669 6361 7465 7320 6578 706c 6963 6974  ficates explicit
+00004350: 6c79 2c20 6966 2074 6865 7920 6172 6520  ly, if they are 
+00004360: 696e 7374 616c 6c65 640a 6c6f 6361 6c6c  installed.locall
+00004370: 7920 696e 2061 2073 7563 6820 6120 7761  y in a such a wa
+00004380: 7920 7468 6174 2074 6865 2050 7974 686f  y that the Pytho
+00004390: 6e20 6772 7063 206c 6962 7261 7279 2063  n grpc library c
+000043a0: 616e 2070 6963 6b20 7468 656d 2075 7020  an pick them up 
+000043b0: 6672 6f6d 2061 2064 6566 6175 6c74 0a6c  from a default.l
+000043c0: 6f63 6174 696f 6e2e 2041 6c74 6572 6e61  ocation. Alterna
+000043d0: 7469 7665 6c79 2c20 666f 7220 6465 7665  tively, for deve
+000043e0: 6c6f 706d 656e 742c 2079 6f75 2063 616e  lopment, you can
+000043f0: 2075 7365 2074 6865 2073 6572 7665 7227   use the server'
+00004400: 7320 6365 7274 6966 6963 6174 6520 6974  s certificate it
+00004410: 7365 6c66 2e0a 0a49 6e20 7468 6520 6578  self...In the ex
+00004420: 616d 706c 6520 6265 6c6f 772c 2074 6865  ample below, the
+00004430: 2063 6f6e 7374 7275 6374 6f72 2061 7267   constructor arg
+00004440: 756d 656e 7420 7661 6c75 6573 2061 7265  ument values are
+00004450: 2074 616b 656e 2066 726f 6d20 7468 6520   taken from the 
+00004460: 6f70 6572 6174 696e 670a 7379 7374 656d  operating.system
+00004470: 2065 6e76 6972 6f6e 6d65 6e74 2e0a 0a60   environment...`
+00004480: 6060 7079 7468 6f6e 0a69 6d70 6f72 7420  ``python.import 
+00004490: 6f73 0a0a 636c 6965 6e74 203d 2045 7665  os..client = Eve
+000044a0: 6e74 5374 6f72 6544 4243 6c69 656e 7428  ntStoreDBClient(
+000044b0: 0a20 2020 2075 7269 3d6f 732e 6765 7465  .    uri=os.gete
+000044c0: 6e76 2822 4553 4442 5f55 5249 2229 2c0a  nv("ESDB_URI"),.
+000044d0: 2020 2020 726f 6f74 5f63 6572 7469 6669      root_certifi
+000044e0: 6361 7465 733d 6f73 2e67 6574 656e 7628  cates=os.getenv(
+000044f0: 2245 5344 425f 524f 4f54 5f43 4552 5449  "ESDB_ROOT_CERTI
+00004500: 4649 4341 5445 5322 292c 0a29 0a60 6060  FICATES"),.).```
+00004510: 0a0a 2323 2043 6f6e 6e65 6374 696f 6e20  ..## Connection 
+00004520: 7374 7269 6e67 733c 6120 6964 3d22 636f  strings<a id="co
+00004530: 6e6e 6563 7469 6f6e 2d73 7472 696e 6773  nnection-strings
+00004540: 223e 3c2f 613e 0a0a 416e 2045 7665 6e74  "></a>..An Event
+00004550: 5374 6f72 6544 4220 636f 6e6e 6563 7469  StoreDB connecti
+00004560: 6f6e 2073 7472 696e 6720 6973 2061 2055  on string is a U
+00004570: 5249 2074 6861 7420 636f 6e66 6f72 6d73  RI that conforms
+00004580: 2077 6974 6820 6f6e 6520 6f66 2074 776f   with one of two
+00004590: 2070 6f73 7369 626c 650a 7363 6865 6d65   possible.scheme
+000045a0: 733a 2065 6974 6865 7220 7468 6520 2265  s: either the "e
+000045b0: 7364 6222 2073 6368 656d 652c 206f 7220  sdb" scheme, or 
+000045c0: 7468 6520 2265 7364 622b 6469 7363 6f76  the "esdb+discov
+000045d0: 6572 2220 7363 6865 6d65 2e0a 0a54 6865  er" scheme...The
+000045e0: 2073 796e 7461 7820 616e 6420 7365 6d61   syntax and sema
+000045f0: 6e74 6963 7320 6f66 2074 6865 2045 7665  ntics of the Eve
+00004600: 6e74 5374 6f72 6544 4220 5552 4920 7363  ntStoreDB URI sc
+00004610: 6865 6d65 7320 6172 6520 6465 7363 7269  hemes are descri
+00004620: 6265 6420 6265 6c6f 772e 2054 6865 0a73  bed below. The.s
+00004630: 796e 7461 7820 6973 2064 6566 696e 6564  yntax is defined
+00004640: 2075 7369 6e67 205b 4542 4e46 5d28 6874   using [EBNF](ht
+00004650: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
+00004660: 6961 2e6f 7267 2f77 696b 692f 4578 7465  ia.org/wiki/Exte
+00004670: 6e64 6564 5f42 6163 6b75 73e2 8093 4e61  nded_Backus...Na
+00004680: 7572 5f66 6f72 6d29 2e0a 0a23 2323 2054  ur_form)...### T
+00004690: 776f 2073 6368 656d 6573 3c61 2069 643d  wo schemes<a id=
+000046a0: 2274 776f 2d73 6368 656d 6573 223e 3c2f  "two-schemes"></
+000046b0: 613e 0a0a 5468 6520 2265 7364 6222 2055  a>..The "esdb" U
+000046c0: 5249 2073 6368 656d 6520 6361 6e20 6265  RI scheme can be
+000046d0: 2064 6566 696e 6564 2069 6e20 7468 6520   defined in the 
+000046e0: 666f 6c6c 6f77 696e 6720 7761 792e 0a0a  following way...
+000046f0: 2020 2020 6573 6462 2d75 7269 203d 2022      esdb-uri = "
+00004700: 6573 6462 3a2f 2f22 202c 205b 2075 7365  esdb://" , [ use
+00004710: 722d 696e 666f 202c 2022 4022 205d 202c  r-info , "@" ] ,
+00004720: 2067 7270 632d 7461 7267 6574 2c20 7b20   grpc-target, { 
+00004730: 222c 2220 2c20 6772 7063 2d74 6172 6765  "," , grpc-targe
+00004740: 7420 7d20 2c20 5b20 223f 2220 2c20 7175  t } , [ "?" , qu
+00004750: 6572 792d 7374 7269 6e67 205d 203b 0a0a  ery-string ] ;..
+00004760: 496e 2074 6865 2022 6573 6462 2220 5552  In the "esdb" UR
+00004770: 4920 7363 6865 6d65 2c20 6166 7465 7220  I scheme, after 
+00004780: 7468 6520 6f70 7469 6f6e 616c 2075 7365  the optional use
+00004790: 7220 696e 666f 2073 7472 696e 672c 2074  r info string, t
+000047a0: 6865 7265 206d 7573 7420 6265 2061 7420  here must be at 
+000047b0: 6c65 6173 740a 6f6e 6520 6752 5043 2074  least.one gRPC t
+000047c0: 6172 6765 742e 2049 6620 7468 6572 6520  arget. If there 
+000047d0: 6172 6520 7365 7665 7261 6c20 6752 5043  are several gRPC
+000047e0: 2074 6172 6765 7473 2c20 7468 6579 206d   targets, they m
+000047f0: 7573 7420 6265 2073 6570 6172 6174 6564  ust be separated
+00004800: 2066 726f 6d20 6561 6368 0a6f 7468 6572   from each.other
+00004810: 2077 6974 6820 7468 6520 222c 2220 6368   with the "," ch
+00004820: 6172 6163 7465 722e 0a0a 4561 6368 2067  aracter...Each g
+00004830: 5250 4320 7461 7267 6574 2073 686f 756c  RPC target shoul
+00004840: 6420 696e 6469 6361 7465 2061 6e20 4576  d indicate an Ev
+00004850: 656e 7453 746f 7265 4442 2067 5250 4320  entStoreDB gRPC 
+00004860: 7365 7276 6572 2073 6f63 6b65 742c 2061  server socket, a
+00004870: 6c6c 2069 6e20 7468 6520 7361 6d65 0a45  ll in the same.E
+00004880: 7665 6e74 5374 6f72 6544 4220 636c 7573  ventStoreDB clus
+00004890: 7465 722c 2062 7920 7370 6563 6966 7969  ter, by specifyi
+000048a0: 6e67 2061 2068 6f73 7420 616e 6420 6120  ng a host and a 
+000048b0: 706f 7274 206e 756d 6265 7220 7365 7061  port number sepa
+000048c0: 7261 7465 6420 7769 7468 2074 6865 2022  rated with the "
+000048d0: 3a22 0a63 6861 7261 6374 6572 2e20 5468  :".character. Th
+000048e0: 6520 686f 7374 206d 6179 2062 6520 6120  e host may be a 
+000048f0: 686f 7374 6e61 6d65 2074 6861 7420 6361  hostname that ca
+00004900: 6e20 6265 2072 6573 6f6c 7665 6420 746f  n be resolved to
+00004910: 2061 6e20 4950 2061 6464 7265 7373 2c20   an IP address, 
+00004920: 6f72 2061 6e20 4950 0a61 6464 7265 7373  or an IP.address
+00004930: 2e0a 0a20 2020 2067 7270 632d 7461 7267  ...    grpc-targ
+00004940: 6574 203d 2028 2068 6f73 746e 616d 6520  et = ( hostname 
+00004950: 7c20 6970 2d61 6464 7265 7373 2029 202c  | ip-address ) ,
+00004960: 2022 3a22 202c 2070 6f72 742d 6e75 6d62   ":" , port-numb
+00004970: 6572 203b 0a0a 4966 2074 6865 7265 2069  er ;..If there i
+00004980: 7320 6f6e 6520 6752 5043 2074 6172 6765  s one gRPC targe
+00004990: 742c 2074 6865 2063 6c69 656e 7420 7769  t, the client wi
+000049a0: 6c6c 2073 696d 706c 7920 6174 7465 6d70  ll simply attemp
+000049b0: 7420 746f 2063 6f6e 6e65 6374 2074 6f20  t to connect to 
+000049c0: 7468 6973 0a73 6572 7665 722c 2061 6e64  this.server, and
+000049d0: 2069 7420 7769 6c6c 2075 7365 2074 6869   it will use thi
+000049e0: 7320 636f 6e6e 6563 7469 6f6e 2077 6865  s connection whe
+000049f0: 6e20 7265 636f 7264 696e 6720 616e 6420  n recording and 
+00004a00: 7265 7472 6965 7669 6e67 2065 7665 6e74  retrieving event
+00004a10: 732e 0a0a 4966 2074 6865 7265 2061 7265  s...If there are
+00004a20: 2074 776f 206f 7220 6d6f 7265 2067 5250   two or more gRP
+00004a30: 4320 7461 7267 6574 732c 2074 6865 2063  C targets, the c
+00004a40: 6c69 656e 7420 7769 6c6c 2061 7474 656d  lient will attem
+00004a50: 7074 2074 6f20 636f 6e6e 6563 7420 746f  pt to connect to
+00004a60: 2074 6865 0a47 6f73 7369 7020 4150 4920   the.Gossip API 
+00004a70: 6f66 2065 6163 6820 696e 2074 7572 6e2c  of each in turn,
+00004a80: 2074 6f20 6f62 7461 696e 2069 6e66 6f72   to obtain infor
+00004a90: 6d61 7469 6f6e 2061 626f 7574 2074 6865  mation about the
+00004aa0: 2077 686f 6c65 2063 6c75 7374 6572 2e20   whole cluster. 
+00004ab0: 4120 6d65 6d62 6572 0a6f 6620 7468 6520  A member.of the 
+00004ac0: 636c 7573 7465 7220 6973 2074 6865 6e20  cluster is then 
+00004ad0: 7365 6c65 6374 6564 2062 7920 7468 6520  selected by the 
+00004ae0: 636c 6965 6e74 2061 6363 6f72 6469 6e67  client according
+00004af0: 2074 6f20 7468 6520 226e 6f64 6520 7072   to the "node pr
+00004b00: 6566 6572 656e 6365 2220 6f70 7469 6f6e  eference" option
+00004b10: 0a6f 6620 7468 6520 636f 6e6e 6563 7469  .of the connecti
+00004b20: 6f6e 2073 7472 696e 672e 2054 6865 2063  on string. The c
+00004b30: 6c69 656e 7420 6d61 7920 7468 656e 206e  lient may then n
+00004b40: 6565 6420 746f 2063 6c6f 7365 2069 7473  eed to close its
+00004b50: 2063 6f6e 6e65 6374 696f 6e20 616e 6420   connection and 
+00004b60: 7265 636f 6e6e 6563 740a 746f 2074 6865  reconnect.to the
+00004b70: 2073 656c 6563 7465 6420 6e6f 6465 2e0a   selected node..
+00004b80: 0a54 6865 2022 6573 6462 2b64 6973 636f  .The "esdb+disco
+00004b90: 7665 7222 2055 5249 2073 6368 656d 6520  ver" URI scheme 
+00004ba0: 6361 6e20 6265 2064 6566 696e 6564 2069  can be defined i
+00004bb0: 6e20 7468 6520 666f 6c6c 6f77 696e 6720  n the following 
+00004bc0: 7761 792e 0a0a 2020 2020 6573 6462 2d64  way...    esdb-d
+00004bd0: 6973 636f 7665 722d 7572 6920 3d20 2265  iscover-uri = "e
+00004be0: 7364 622b 6469 7363 6f76 6572 3a2f 2f22  sdb+discover://"
+00004bf0: 202c 205b 2075 7365 722d 696e 666f 2c20   , [ user-info, 
+00004c00: 2240 2220 5d20 2c20 636c 7573 7465 722d  "@" ] , cluster-
+00004c10: 646f 6d61 696e 6e61 6d65 2c20 5b20 223a  domainname, [ ":
+00004c20: 2220 2c20 706f 7274 2d6e 756d 6265 7220  " , port-number 
+00004c30: 5d20 2c20 5b20 223f 2220 2c20 7175 6572  ] , [ "?" , quer
+00004c40: 792d 7374 7269 6e67 205d 203b 0a0a 496e  y-string ] ;..In
+00004c50: 2074 6865 2022 6573 6462 2b64 6973 636f   the "esdb+disco
+00004c60: 7665 7222 2055 5249 2073 6368 656d 652c  ver" URI scheme,
+00004c70: 2061 6674 6572 2074 6865 206f 7074 696f   after the optio
+00004c80: 6e61 6c20 7573 6572 2069 6e66 6f20 7374  nal user info st
+00004c90: 7269 6e67 2c20 7468 6572 6520 7368 6f75  ring, there shou
+00004ca0: 6c64 2062 650a 6120 646f 6d61 696e 206e  ld be.a domain n
+00004cb0: 616d 6520 7768 6963 6820 6964 656e 7469  ame which identi
+00004cc0: 6669 6573 2061 2063 6c75 7374 6572 206f  fies a cluster o
+00004cd0: 6620 4576 656e 7453 746f 7265 4442 2073  f EventStoreDB s
+00004ce0: 6572 7665 7273 2e20 496e 6469 7669 6475  ervers. Individu
+00004cf0: 616c 206e 6f64 6573 2069 6e0a 7468 6520  al nodes in.the 
+00004d00: 636c 7573 7465 7220 7368 6f75 6c64 2062  cluster should b
+00004d10: 6520 6465 636c 6172 6564 2077 6974 6820  e declared with 
+00004d20: 444e 5320 2741 2720 7265 636f 7264 732e  DNS 'A' records.
+00004d30: 0a0a 5468 6520 636c 6965 6e74 2077 696c  ..The client wil
+00004d40: 6c20 6372 6561 7465 2061 2067 5250 4320  l create a gRPC 
+00004d50: 636f 6e6e 6563 7469 6f6e 2075 7369 6e67  connection using
+00004d60: 2074 6865 2063 6c75 7374 6572 2773 2064   the cluster's d
+00004d70: 6f6d 6169 6e20 6e61 6d65 2c20 7573 696e  omain name, usin
+00004d80: 6720 7468 650a 6752 5043 206c 6962 7261  g the.gRPC libra
+00004d90: 7279 2773 2027 726f 756e 6420 726f 6269  ry's 'round robi
+00004da0: 6e27 206c 6f61 6420 6261 6c61 6e63 696e  n' load balancin
+00004db0: 6720 7374 7261 7465 6779 2074 6f20 6361  g strategy to ca
+00004dc0: 6c6c 2074 6865 2047 6f73 7369 7020 4150  ll the Gossip AP
+00004dd0: 4920 6f66 2061 6464 7265 7373 6573 0a74  I of addresses.t
+00004de0: 6f20 7768 6963 6820 7468 6973 2064 6f6d  o which this dom
+00004df0: 6169 6e20 6e61 6d65 2072 6573 6f6c 7665  ain name resolve
+00004e00: 732e 2049 6e66 6f72 6d61 7469 6f6e 2061  s. Information a
+00004e10: 626f 7574 2074 6865 2045 7665 6e74 5374  bout the EventSt
+00004e20: 6f72 6544 4220 636c 7573 7465 7220 6973  oreDB cluster is
+00004e30: 0a6f 6274 6169 6e65 6420 6672 6f6d 2074  .obtained from t
+00004e40: 6865 2047 6f73 7369 7020 4150 492e 2041  he Gossip API. A
+00004e50: 206d 656d 6265 7220 6f66 2074 6865 2063   member of the c
+00004e60: 6c75 7374 6572 2069 7320 7468 656e 2073  luster is then s
+00004e70: 656c 6563 7465 6420 6279 2074 6865 2063  elected by the c
+00004e80: 6c69 656e 740a 6163 636f 7264 696e 6720  lient.according 
+00004e90: 746f 2074 6865 2022 6e6f 6465 2070 7265  to the "node pre
+00004ea0: 6665 7265 6e63 6522 206f 7074 696f 6e2e  ference" option.
+00004eb0: 2054 6865 2063 6c69 656e 7420 6d61 7920   The client may 
+00004ec0: 7468 656e 206e 6565 6420 746f 2063 6c6f  then need to clo
+00004ed0: 7365 2069 7473 0a63 6f6e 6e65 6374 696f  se its.connectio
+00004ee0: 6e20 616e 6420 7265 636f 6e6e 6563 7420  n and reconnect 
+00004ef0: 746f 2074 6865 2073 656c 6563 7465 6420  to the selected 
+00004f00: 6e6f 6465 2e0a 0a23 2323 2055 7365 7220  node...### User 
+00004f10: 696e 666f 2073 7472 696e 673c 6120 6964  info string<a id
+00004f20: 3d22 7573 6572 2d69 6e66 6f2d 7374 7269  ="user-info-stri
+00004f30: 6e67 223e 3c2f 613e 0a0a 496e 2062 6f74  ng"></a>..In bot
+00004f40: 6820 7468 6520 2265 7364 6222 2061 6e64  h the "esdb" and
+00004f50: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
+00004f60: 2073 6368 656d 6573 2c20 7468 6520 5552   schemes, the UR
+00004f70: 4920 6d61 7920 696e 636c 7564 6520 6120  I may include a 
+00004f80: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
+00004f90: 2e0a 4966 2069 7420 6578 6973 7473 2069  ..If it exists i
+00004fa0: 6e20 7468 6520 5552 492c 2074 6865 2075  n the URI, the u
+00004fb0: 7365 7220 696e 666f 2073 7472 696e 6720  ser info string 
+00004fc0: 6d75 7374 2062 6520 7365 7061 7261 7465  must be separate
+00004fd0: 6420 6672 6f6d 2074 6865 2072 6573 7420  d from the rest 
+00004fe0: 6f66 2074 6865 2055 5249 0a77 6974 6820  of the URI.with 
+00004ff0: 7468 6520 2240 2220 6368 6172 6163 7465  the "@" characte
+00005000: 722e 2054 6865 2075 7365 7220 696e 666f  r. The user info
+00005010: 2073 7472 696e 6720 6d75 7374 2069 6e63   string must inc
+00005020: 6c75 6465 2061 2075 7365 726e 616d 6520  lude a username 
+00005030: 616e 6420 6120 7061 7373 776f 7264 2c0a  and a password,.
+00005040: 7365 7061 7261 7465 6420 7769 7468 2074  separated with t
+00005050: 6865 2022 3a22 2063 6861 7261 6374 6572  he ":" character
+00005060: 2e0a 0a20 2020 2075 7365 722d 696e 666f  ...    user-info
+00005070: 203d 2075 7365 726e 616d 6520 2c20 223a   = username , ":
+00005080: 2220 2c20 7061 7373 776f 7264 203b 0a0a  " , password ;..
+00005090: 5468 6520 7573 6572 2069 6e66 6f20 6973  The user info is
+000050a0: 2073 656e 7420 6279 2074 6865 2063 6c69   sent by the cli
+000050b0: 656e 7420 6173 2022 6361 6c6c 2063 7265  ent as "call cre
+000050c0: 6465 6e74 6961 6c73 2220 696e 2065 6163  dentials" in eac
+000050d0: 6820 6361 6c6c 2074 6f20 6120 2273 6563  h call to a "sec
+000050e0: 7572 6522 0a73 6572 7665 722c 2069 6e20  ure".server, in 
+000050f0: 6120 2262 6173 6963 2061 7574 6822 2061  a "basic auth" a
+00005100: 7574 686f 7269 7a61 7469 6f6e 2068 6561  uthorization hea
+00005110: 6465 722e 2054 6869 7320 6175 7468 6f72  der. This author
+00005120: 697a 6174 696f 6e20 6865 6164 6572 2069  ization header i
+00005130: 7320 7573 6564 2062 790a 7468 6520 7365  s used by.the se
+00005140: 7276 6572 2074 6f20 6175 7468 656e 7469  rver to authenti
+00005150: 6361 7465 2074 6865 2063 6c69 656e 742e  cate the client.
+00005160: 2054 6865 2061 7574 686f 7269 7a61 7469   The authorizati
+00005170: 6f6e 2068 6561 6465 7220 6973 206e 6f74  on header is not
+00005180: 2073 656e 7420 746f 0a22 696e 7365 6375   sent to."insecu
+00005190: 7265 2220 7365 7276 6572 732e 0a0a 2323  re" servers...##
+000051a0: 2320 5175 6572 7920 7374 7269 6e67 3c61  # Query string<a
+000051b0: 2069 643d 2271 7565 7279 2d73 7472 696e   id="query-strin
+000051c0: 6722 3e3c 2f61 3e0a 0a49 6e20 626f 7468  g"></a>..In both
+000051d0: 2074 6865 2022 6573 6462 2220 616e 6420   the "esdb" and 
+000051e0: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
+000051f0: 7363 6865 6d65 732c 2074 6865 206f 7074  schemes, the opt
+00005200: 696f 6e61 6c20 7175 6572 7920 7374 7269  ional query stri
+00005210: 6e67 206d 7573 7420 6265 206f 6e65 0a6f  ng must be one.o
+00005220: 7220 6d61 6e79 2066 6965 6c64 2d76 616c  r many field-val
+00005230: 7565 2061 7267 756d 656e 7473 2c20 7365  ue arguments, se
+00005240: 7061 7261 7465 6420 6672 6f6d 2065 6163  parated from eac
+00005250: 6820 6f74 6865 7220 7769 7468 2074 6865  h other with the
+00005260: 2022 2622 2063 6861 7261 6374 6572 2e0a   "&" character..
+00005270: 0a20 2020 2071 7565 7279 2d73 7472 696e  .    query-strin
+00005280: 6720 3d20 6669 656c 642d 7661 6c75 652c  g = field-value,
+00005290: 207b 2022 2622 2c20 6669 656c 642d 7661   { "&", field-va
+000052a0: 6c75 6520 7d20 3b0a 0a45 6163 6820 6669  lue } ;..Each fi
+000052b0: 656c 642d 7661 6c75 6520 6172 6775 6d65  eld-value argume
+000052c0: 6e74 206d 7573 7420 6265 206f 6e65 206f  nt must be one o
+000052d0: 6620 7468 6520 7375 7070 6f72 7465 6420  f the supported 
+000052e0: 6669 656c 6473 2c20 616e 6420 616e 0a61  fields, and an.a
+000052f0: 7070 726f 7072 6961 7465 2076 616c 7565  ppropriate value
+00005300: 2c20 7365 7061 7261 7465 6420 7769 7468  , separated with
+00005310: 2074 6865 2022 3d22 2063 6861 7261 6374   the "=" charact
+00005320: 6572 2e0a 0a20 2020 2066 6965 6c64 2d76  er...    field-v
+00005330: 616c 7565 203d 2028 2022 546c 7322 2c20  alue = ( "Tls", 
+00005340: 223d 2220 2c20 2274 7275 6522 207c 2022  "=" , "true" | "
+00005350: 6661 6c73 6522 2029 0a20 2020 2020 2020  false" ).       
+00005360: 2020 2020 2020 2020 207c 2028 2022 546c           | ( "Tl
+00005370: 7356 6572 6966 7943 6572 7422 2c20 223d  sVerifyCert", "=
+00005380: 2220 2c20 2274 7275 6522 207c 2022 6661  " , "true" | "fa
+00005390: 6c73 6522 2029 0a20 2020 2020 2020 2020  lse" ).         
+000053a0: 2020 2020 2020 207c 2028 2022 436f 6e6e         | ( "Conn
+000053b0: 6563 7469 6f6e 4e61 6d65 222c 2022 3d22  ectionName", "="
+000053c0: 202c 2073 7472 696e 6720 290a 2020 2020   , string ).    
+000053d0: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+000053e0: 224e 6f64 6550 7265 6665 7265 6e63 6522  "NodePreference"
+000053f0: 2c20 223d 2220 2c20 226c 6561 6465 7222  , "=" , "leader"
+00005400: 207c 2022 666f 6c6c 6f77 6572 2220 7c20   | "follower" | 
+00005410: 2272 6561 646f 6e6c 7972 6570 6c69 6361  "readonlyreplica
+00005420: 2220 7c20 2272 616e 646f 6d22 2029 0a20  " | "random" ). 
+00005430: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00005440: 2028 2022 4465 6661 756c 7444 6561 646c   ( "DefaultDeadl
+00005450: 696e 6522 2c20 223d 2220 2c20 696e 7465  ine", "=" , inte
+00005460: 6765 7220 290a 2020 2020 2020 2020 2020  ger ).          
+00005470: 2020 2020 2020 7c20 2820 2247 6f73 7369        | ( "Gossi
+00005480: 7054 696d 656f 7574 222c 2022 3d22 202c  pTimeout", "=" ,
+00005490: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
+000054a0: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
+000054b0: 4d61 7844 6973 636f 7665 7241 7474 656d  MaxDiscoverAttem
+000054c0: 7074 7322 2c20 223d 2220 2c20 696e 7465  pts", "=" , inte
+000054d0: 6765 7220 290a 2020 2020 2020 2020 2020  ger ).          
+000054e0: 2020 2020 2020 7c20 2820 2244 6973 636f        | ( "Disco
+000054f0: 7665 7279 496e 7465 7276 616c 222c 2022  veryInterval", "
+00005500: 3d22 202c 2069 6e74 6567 6572 2029 0a20  =" , integer ). 
+00005510: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00005520: 2028 2022 4b65 6570 416c 6976 6549 6e74   ( "KeepAliveInt
+00005530: 6572 7661 6c22 2c20 223d 2220 2c20 696e  erval", "=" , in
+00005540: 7465 6765 7220 290a 2020 2020 2020 2020  teger ).        
+00005550: 2020 2020 2020 2020 7c20 2820 224b 6565          | ( "Kee
+00005560: 7041 6c69 7665 5469 6d65 6f75 7422 2c20  pAliveTimeout", 
+00005570: 223d 2220 2c20 696e 7465 6765 7220 2920  "=" , integer ) 
+00005580: 3b0a 0a54 6865 2074 6162 6c65 2062 656c  ;..The table bel
+00005590: 6f77 2064 6573 6372 6962 6573 2074 6865  ow describes the
+000055a0: 2071 7565 7279 2066 6965 6c64 2d76 616c   query field-val
+000055b0: 7565 7320 7375 7070 6f72 7465 6420 6279  ues supported by
+000055c0: 2074 6869 7320 636c 6965 6e74 2e0a 0a7c   this client...|
+000055d0: 2046 6965 6c64 2020 2020 2020 2020 2020   Field          
+000055e0: 2020 2020 207c 2056 616c 7565 2020 2020       | Value    
+000055f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005600: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005630: 2020 2020 2020 2020 2020 7c0a 7c20 4469            |.| Di
-00005640: 7363 6f76 6572 7949 6e74 6572 7661 6c20  scoveryInterval 
-00005650: 2020 7c20 696e 7465 6765 7220 2864 6566    | integer (def
-00005660: 6175 6c74 3a20 3130 3029 2020 2020 2020  ault: 100)      
+00005620: 2020 2020 2020 2020 2020 2020 207c 2044               | D
+00005630: 6573 6372 6970 7469 6f6e 2020 2020 2020  escription      
+00005640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005660: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005670: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005690: 2020 2020 2020 2020 2020 7c20 486f 7720            | How 
-000056a0: 6c6f 6e67 2074 6f20 7761 6974 2028 696e  long to wait (in
-000056b0: 206d 696c 6c69 7365 636f 6e64 7329 2062   milliseconds) b
-000056c0: 6574 7765 656e 2067 6f73 7369 7020 7265  etween gossip re
-000056d0: 7472 6965 732e 2020 2020 2020 2020 2020  tries.          
-000056e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000056f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005730: 2020 2020 2020 2020 2020 2020 2020 7c0a                |.
-00005740: 7c20 4b65 6570 416c 6976 6549 6e74 6572  | KeepAliveInter
-00005750: 7661 6c20 2020 7c20 696e 7465 6765 7220  val   | integer 
-00005760: 2864 6566 6175 6c74 3a20 604e 6f6e 6560  (default: `None`
-00005770: 2920 2020 2020 2020 2020 2020 2020 2020  )               
-00005780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005790: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-000057a0: 5468 6520 7661 6c75 6520 6f66 2074 6865  The value of the
-000057b0: 2022 6772 7063 2e6b 6565 7061 6c69 7665   "grpc.keepalive
-000057c0: 5f6d 7322 2067 5250 4320 6368 616e 6e65  _ms" gRPC channe
-000057d0: 6c20 6f70 7469 6f6e 2e20 2020 2020 2020  l option.       
-000057e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000057f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056d0: 207c 0a7c 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   |.|------------
+000056e0: 2d2d 2d2d 2d2d 2d2d 2d7c 2d2d 2d2d 2d2d  ---------|------
+000056f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005700: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005710: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005720: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005730: 2d7c 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  -|--------------
+00005740: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005750: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005760: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005780: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005790: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000057a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000057b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000057c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000057d0: 2d2d 2d2d 2d7c 0a7c 2054 6c73 2020 2020  -----|.| Tls    
+000057e0: 2020 2020 2020 2020 2020 2020 207c 2022               | "
+000057f0: 7472 7565 222c 2022 6661 6c73 6522 2028  true", "false" (
+00005800: 6465 6661 756c 743a 2022 7472 7565 2229  default: "true")
 00005810: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005840: 2020 7c0a 7c20 4b65 6570 416c 6976 6554    |.| KeepAliveT
-00005850: 696d 656f 7574 2020 2020 7c20 696e 7465  imeout    | inte
-00005860: 6765 7220 2864 6566 6175 6c74 3a20 604e  ger (default: `N
-00005870: 6f6e 6560 2920 2020 2020 2020 2020 2020  one`)           
-00005880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000058a0: 2020 7c20 5468 6520 7661 6c75 6520 6f66    | The value of
-000058b0: 2074 6865 2022 6772 7063 2e6b 6565 7061   the "grpc.keepa
-000058c0: 6c69 7665 5f74 696d 656f 7574 5f6d 7322  live_timeout_ms"
-000058d0: 2067 5250 4320 6368 616e 6e65 6c20 6f70   gRPC channel op
-000058e0: 7469 6f6e 2e20 2020 2020 2020 2020 2020  tion.           
-000058f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005830: 2020 2020 207c 2049 6620 2274 7275 6522       | If "true"
+00005840: 2074 6865 2063 6c69 656e 7420 7769 6c6c   the client will
+00005850: 2063 7265 6174 6520 6120 2273 6563 7572   create a "secur
+00005860: 6522 2067 5250 4320 6368 616e 6e65 6c2e  e" gRPC channel.
+00005870: 2049 6620 2266 616c 7365 2220 7468 6520   If "false" the 
+00005880: 636c 6965 6e74 2077 696c 6c20 6372 6561  client will crea
+00005890: 7465 2061 6e20 2269 6e73 6563 7572 6522  te an "insecure"
+000058a0: 2067 5250 4320 6368 616e 6e65 6c2e 2054   gRPC channel. T
+000058b0: 6869 7320 6d75 7374 206d 6174 6368 2074  his must match t
+000058c0: 6865 2073 6572 7665 7220 636f 6e66 6967  he server config
+000058d0: 7572 6174 696f 6e2e 207c 0a7c 2054 6c73  uration. |.| Tls
+000058e0: 5665 7269 6679 4365 7274 2020 2020 2020  VerifyCert      
+000058f0: 207c 2022 7472 7565 222c 2022 6661 6c73   | "true", "fals
+00005900: 6522 2028 6465 6661 756c 743a 2022 7472  e" (default: "tr
+00005910: 7565 2229 2020 2020 2020 2020 2020 2020  ue")            
 00005920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005940: 2020 2020 2020 7c0a 0a0a 2323 2320 4578        |...### Ex
-00005950: 616d 706c 6573 0a0a 4865 7265 2061 7265  amples..Here are
-00005960: 2073 6f6d 6520 6578 616d 706c 6573 206f   some examples o
-00005970: 6620 4576 656e 7453 746f 7265 4442 2063  f EventStoreDB c
-00005980: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00005990: 2055 5249 732e 0a0a 5468 6520 666f 6c6c   URIs...The foll
-000059a0: 6f77 696e 6720 5552 4920 7769 6c6c 2063  owing URI will c
-000059b0: 6175 7365 2074 6865 2063 6c69 656e 7420  ause the client 
-000059c0: 746f 2063 6f6e 6e65 6374 2074 6f2c 2061  to connect to, a
-000059d0: 6e64 2067 6574 0a63 6c75 7374 6572 2069  nd get.cluster i
-000059e0: 6e66 6f2c 2066 726f 6d20 2273 6563 7572  nfo, from "secur
-000059f0: 6522 2073 6572 7665 7220 736f 636b 6574  e" server socket
-00005a00: 2060 6c6f 6361 6c68 6f73 743a 3231 3133   `localhost:2113
-00005a10: 602e 2041 6e64 0a74 6865 6e20 746f 2063  `. And.then to c
-00005a20: 6f6e 6e65 6374 2074 6f20 6120 226c 6561  onnect to a "lea
-00005a30: 6465 7222 206e 6f64 652e 2041 6e64 2061  der" node. And a
-00005a40: 6c73 6f20 746f 2075 7365 2022 6164 6d69  lso to use "admi
-00005a50: 6e22 2061 6e64 0a22 6368 616e 6765 6974  n" and."changeit
-00005a60: 2220 6173 2074 6865 2075 7365 726e 616d  " as the usernam
-00005a70: 6520 616e 6420 7061 7373 776f 7264 2077  e and password w
-00005a80: 6865 6e20 6d61 6b69 6e67 2063 616c 6c73  hen making calls
-00005a90: 2074 6f0a 4576 656e 7453 746f 7265 4442   to.EventStoreDB
-00005aa0: 2041 5049 206d 6574 686f 6473 2e0a 0a20   API methods... 
-00005ab0: 2020 2065 7364 623a 2f2f 6164 6d69 6e3a     esdb://admin:
-00005ac0: 6368 616e 6765 6974 406c 6f63 616c 686f  changeit@localho
-00005ad0: 7374 3a32 3131 330a 0a0a 5468 6520 666f  st:2113...The fo
-00005ae0: 6c6c 6f77 696e 6720 5552 4920 7769 6c6c  llowing URI will
-00005af0: 2063 6175 7365 2074 6865 2063 6c69 656e   cause the clien
-00005b00: 7420 746f 2067 6574 2063 6c75 7374 6572  t to get cluster
-00005b10: 2069 6e66 6f20 6672 6f6d 0a22 696e 7365   info from."inse
-00005b20: 6375 7265 2220 7365 7276 6572 2073 6f63  cure" server soc
-00005b30: 6b65 7420 3132 372e 302e 302e 313a 3231  ket 127.0.0.1:21
-00005b40: 3133 2e20 2041 6e64 2074 6865 6e20 746f  13.  And then to
-00005b50: 2063 6f6e 6e65 6374 2074 6f0a 6120 226c   connect to.a "l
-00005b60: 6561 6465 7222 206e 6f64 652e 0a0a 2020  eader" node...  
-00005b70: 2020 6573 6462 3a2f 2f31 3237 2e30 2e30    esdb://127.0.0
-00005b80: 2e31 3a32 3131 333f 546c 733d 6661 6c73  .1:2113?Tls=fals
-00005b90: 650a 0a0a 5468 6520 666f 6c6c 6f77 696e  e...The followin
-00005ba0: 6720 5552 4920 7769 6c6c 2063 6175 7365  g URI will cause
-00005bb0: 2074 6865 2063 6c69 656e 7420 746f 2067   the client to g
-00005bc0: 6574 2063 6c75 7374 6572 2069 6e66 6f20  et cluster info 
-00005bd0: 6672 6f6d 0a61 6464 7265 7373 6573 2069  from.addresses i
-00005be0: 6e20 444e 5320 2741 2720 7265 636f 7264  n DNS 'A' record
-00005bf0: 7320 666f 7220 636c 7573 7465 7231 2e65  s for cluster1.e
-00005c00: 7861 6d70 6c65 2e63 6f6d 2e20 416e 6420  xample.com. And 
-00005c10: 7468 656e 0a74 6f20 636f 6e6e 6563 7420  then.to connect 
-00005c20: 746f 2061 2022 6c65 6164 6572 2220 6e6f  to a "leader" no
-00005c30: 6465 2e20 416e 6420 7573 6520 6120 6465  de. And use a de
-00005c40: 6661 756c 7420 6465 6164 6c69 6e65 206f  fault deadline o
-00005c50: 6620 350a 7365 636f 6e64 7320 7768 656e  f 5.seconds when
-00005c60: 206d 616b 696e 6720 6361 6c6c 7320 746f   making calls to
-00005c70: 2045 7665 6e74 5374 6f72 6520 4150 4920   EventStore API 
-00005c80: 2277 7269 7465 2220 6d65 7468 6f64 732e  "write" methods.
-00005c90: 0a0a 2020 2020 6573 6462 2b64 6973 636f  ..    esdb+disco
-00005ca0: 7665 723a 2f2f 6164 6d69 6e3a 6368 616e  ver://admin:chan
-00005cb0: 6765 6974 4063 6c75 7374 6572 312e 6578  geit@cluster1.ex
-00005cc0: 616d 706c 652e 636f 6d3f 4465 6661 756c  ample.com?Defaul
-00005cd0: 7444 6561 646c 696e 653d 350a 0a0a 5468  tDeadline=5...Th
-00005ce0: 6520 666f 6c6c 6f77 696e 6720 5552 4920  e following URI 
-00005cf0: 7769 6c6c 2063 6175 7365 2074 6865 2063  will cause the c
-00005d00: 6c69 656e 7420 746f 2067 6574 2063 6c75  lient to get clu
-00005d10: 7374 6572 2069 6e66 6f20 6672 6f6d 2065  ster info from e
-00005d20: 6974 6865 720a 6c6f 6361 6c68 6f73 743a  ither.localhost:
-00005d30: 3231 3131 2c20 6f72 206c 6f63 616c 686f  2111, or localho
-00005d40: 7374 3a32 3131 322c 206f 7220 6c6f 6361  st:2112, or loca
-00005d50: 6c68 6f73 743a 3231 3133 2e20 416e 6420  lhost:2113. And 
-00005d60: 7468 656e 2074 6f20 636f 6e6e 6563 740a  then to connect.
-00005d70: 746f 2061 2022 666f 6c6c 6f77 6572 2220  to a "follower" 
-00005d80: 6e6f 6465 2e0a 0a20 2020 2065 7364 623a  node...    esdb:
-00005d90: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
-00005da0: 406c 6f63 616c 686f 7374 3a32 3131 312c  @localhost:2111,
-00005db0: 6c6f 6361 6c68 6f73 743a 3231 3132 2c6c  localhost:2112,l
-00005dc0: 6f63 616c 686f 7374 3a32 3131 333f 4e6f  ocalhost:2113?No
-00005dd0: 6465 5072 6566 6572 656e 6365 3d66 6f6c  dePreference=fol
-00005de0: 6c6f 7765 720a 0a0a 5468 6520 666f 6c6c  lower...The foll
-00005df0: 6f77 696e 6720 5552 4920 7769 6c6c 2063  owing URI will c
-00005e00: 6175 7365 2074 6865 2063 6c69 656e 7420  ause the client 
-00005e10: 746f 2067 6574 2063 6c75 7374 6572 2069  to get cluster i
-00005e20: 6e66 6f20 6672 6f6d 2061 6464 7265 7373  nfo from address
-00005e30: 6573 2069 6e0a 444e 5320 2741 2720 7265  es in.DNS 'A' re
-00005e40: 636f 7264 7320 666f 7220 636c 7573 7465  cords for cluste
-00005e50: 7231 2e65 7861 6d70 6c65 2e63 6f6d 2e20  r1.example.com. 
-00005e60: 416e 6420 746f 2063 6f6e 6669 6775 7265  And to configure
-00005e70: 2022 6b65 6570 2061 6c69 7665 2220 7469   "keep alive" ti
-00005e80: 6d65 6f75 740a 616e 6420 696e 7465 7276  meout.and interv
-00005e90: 616c 2069 6e20 7468 6520 6752 5043 2063  al in the gRPC c
-00005ea0: 6861 6e6e 656c 2e0a 0a20 2020 2065 7364  hannel...    esd
-00005eb0: 622b 6469 7363 6f76 6572 3a2f 2f61 646d  b+discover://adm
-00005ec0: 696e 3a63 6861 6e67 6569 7440 636c 7573  in:changeit@clus
-00005ed0: 7465 7231 2e65 7861 6d70 6c65 2e63 6f6d  ter1.example.com
-00005ee0: 3f4b 6565 7041 6c69 7665 496e 7465 7276  ?KeepAliveInterv
-00005ef0: 616c 3d31 3030 3030 264b 6565 7041 6c69  al=10000&KeepAli
-00005f00: 7665 5469 6d65 6f75 743d 3130 3030 300a  veTimeout=10000.
-00005f10: 0a0a 506c 6561 7365 206e 6f74 652c 2074  ..Please note, t
-00005f20: 6865 2063 6c69 656e 7420 6973 2069 6e73  he client is ins
-00005f30: 656e 7369 7469 7665 2074 6f20 7468 6520  ensitive to the 
-00005f40: 6361 7365 206f 6620 6669 656c 6473 2061  case of fields a
-00005f50: 6e64 2076 616c 7565 732e 2049 6620 6669  nd values. If fi
-00005f60: 656c 6473 2061 7265 0a72 6570 6561 7465  elds are.repeate
-00005f70: 6420 696e 2074 6865 2071 7565 7279 2073  d in the query s
-00005f80: 7472 696e 672c 2074 6865 2071 7565 7279  tring, the query
-00005f90: 2073 7472 696e 6720 7769 6c6c 2062 6520   string will be 
-00005fa0: 7061 7273 6564 2077 6974 686f 7574 2065  parsed without e
-00005fb0: 7272 6f72 2e20 486f 7765 7665 722c 0a74  rror. However,.t
-00005fc0: 6865 2063 6f6e 6e65 6374 696f 6e20 6f70  he connection op
-00005fd0: 7469 6f6e 7320 7573 6564 2062 7920 7468  tions used by th
-00005fe0: 6520 636c 6965 6e74 2077 696c 6c20 7573  e client will us
-00005ff0: 6520 7468 6520 7661 6c75 6520 6f66 2074  e the value of t
-00006000: 6865 2066 6972 7374 2066 6965 6c64 2e20  he first field. 
-00006010: 416c 6c0a 7468 6520 6f74 6865 7220 6669  All.the other fi
-00006020: 656c 642d 7661 6c75 6573 2069 6e20 7468  eld-values in th
-00006030: 6520 7175 6572 7920 7374 7269 6e67 2077  e query string w
-00006040: 6974 6820 7468 6520 7361 6d65 2066 6965  ith the same fie
-00006050: 6c64 206e 616d 6520 7769 6c6c 2062 6520  ld name will be 
-00006060: 6967 6e6f 7265 642e 0a46 6965 6c64 7320  ignored..Fields 
-00006070: 7769 7468 6f75 7420 7661 6c75 6573 2077  without values w
-00006080: 696c 6c20 616c 736f 2062 6520 6967 6e6f  ill also be igno
-00006090: 7265 642e 0a0a 4966 2074 6865 2063 6c69  red...If the cli
-000060a0: 656e 7427 7320 6e6f 6465 2070 7265 6665  ent's node prefe
-000060b0: 7265 6e63 6520 6973 2022 6c65 6164 6572  rence is "leader
-000060c0: 2220 616e 6420 7468 6520 6e6f 6465 2062  " and the node b
-000060d0: 6563 6f6d 6573 2061 0a22 666f 6c6c 6f77  ecomes a."follow
-000060e0: 6572 222c 2074 6865 2063 6c69 656e 7420  er", the client 
-000060f0: 7769 6c6c 2061 7474 656d 7074 2074 6f20  will attempt to 
-00006100: 7265 636f 6e6e 6563 7420 746f 2074 6865  reconnect to the
-00006110: 2063 7572 7265 6e74 206c 6561 6465 7220   current leader 
-00006120: 7768 656e 2061 206d 6574 686f 640a 6973  when a method.is
-00006130: 2063 616c 6c65 6420 7468 6174 2065 7870   called that exp
-00006140: 6563 7473 2074 6f20 6361 6c6c 2061 206c  ects to call a l
-00006150: 6561 6465 722e 204d 6574 686f 6473 2077  eader. Methods w
-00006160: 6869 6368 206d 7574 6174 6520 7468 6520  hich mutate the 
-00006170: 7374 6174 6520 6f66 2074 6865 2064 6174  state of the dat
-00006180: 6162 6173 650a 6578 7065 6374 2074 6f20  abase.expect to 
-00006190: 6361 6c6c 2061 206c 6561 6465 722e 2046  call a leader. F
-000061a0: 6f72 2073 7563 6820 6d65 7468 6f64 732c  or such methods,
-000061b0: 2074 6865 2048 5454 5020 6865 6164 6572   the HTTP header
-000061c0: 2022 7265 7175 6972 6573 2d6c 6561 6465   "requires-leade
-000061d0: 7222 2069 7320 7365 7420 746f 0a22 7472  r" is set to."tr
-000061e0: 7565 222c 2061 6e64 2074 6869 7320 6865  ue", and this he
-000061f0: 6164 6572 2069 7320 6f62 7365 7276 6564  ader is observed
-00006200: 2062 7920 7468 6520 7365 7276 6572 2c20   by the server, 
-00006210: 616e 6420 736f 2061 206e 6f64 6520 7768  and so a node wh
-00006220: 6963 6820 6973 206e 6f74 2061 206c 6561  ich is not a lea
-00006230: 6465 720a 7468 6174 2072 6563 6569 7665  der.that receive
-00006240: 7320 7375 6368 2061 2072 6571 7565 7374  s such a request
-00006250: 2077 696c 6c20 7265 7475 726e 2061 6e20   will return an 
-00006260: 6572 726f 722e 2054 6869 7320 6572 726f  error. This erro
-00006270: 7220 6973 2064 6574 6563 7465 6420 6279  r is detected by
-00006280: 2074 6865 2063 6c69 656e 742c 0a77 6869   the client,.whi
-00006290: 6368 2077 696c 6c20 7468 656e 2063 6c6f  ch will then clo
-000062a0: 7365 2074 6865 2063 7572 7265 6e74 2067  se the current g
-000062b0: 5250 4320 636f 6e6e 6563 7469 6f6e 2061  RPC connection a
-000062c0: 6e64 2063 7265 6174 6520 6120 6e65 7720  nd create a new 
-000062d0: 636f 6e6e 6563 7469 6f6e 2074 6f20 7468  connection to th
-000062e0: 650a 6c65 6164 6572 2e20 5468 6520 7265  e.leader. The re
-000062f0: 7175 6573 7420 7769 6c6c 2074 6865 6e20  quest will then 
-00006300: 6265 2072 6574 7269 6564 2077 6974 6820  be retried with 
-00006310: 7468 6520 6c65 6164 6572 2e0a 0a49 6620  the leader...If 
-00006320: 7468 6520 636c 6965 6e74 2773 206e 6f64  the client's nod
-00006330: 6520 7072 6566 6572 656e 6365 2069 7320  e preference is 
-00006340: 2266 6f6c 6c6f 7765 7222 2061 6e64 2074  "follower" and t
-00006350: 6865 7265 2061 7265 206e 6f20 666f 6c6c  here are no foll
-00006360: 6f77 6572 0a6e 6f64 6573 2069 6e20 7468  ower.nodes in th
-00006370: 6520 636c 7573 7465 722c 2074 6865 6e20  e cluster, then 
-00006380: 7468 6520 636c 6965 6e74 2077 696c 6c20  the client will 
-00006390: 7261 6973 6520 616e 2065 7863 6570 7469  raise an excepti
-000063a0: 6f6e 2e20 5369 6d69 6c61 726c 792c 2069  on. Similarly, i
-000063b0: 6620 7468 650a 636c 6965 6e74 2773 206e  f the.client's n
-000063c0: 6f64 6520 7072 6566 6572 656e 6365 2069  ode preference i
-000063d0: 7320 2272 6561 646f 6e6c 7972 6570 6c69  s "readonlyrepli
-000063e0: 6361 2220 616e 6420 7468 6572 6520 6172  ca" and there ar
-000063f0: 6520 6e6f 2072 6561 642d 6f6e 6c79 2072  e no read-only r
-00006400: 6570 6c69 6361 0a6e 6f64 6573 2069 6e20  eplica.nodes in 
-00006410: 7468 6520 636c 7573 7465 722c 2074 6865  the cluster, the
-00006420: 6e20 7468 6520 636c 6965 6e74 2077 696c  n the client wil
-00006430: 6c20 616c 736f 2072 6169 7365 2061 6e20  l also raise an 
-00006440: 6578 6365 7074 696f 6e2e 0a0a 5468 6520  exception...The 
-00006450: 6752 5043 2063 6861 6e6e 656c 206f 7074  gRPC channel opt
-00006460: 696f 6e20 2267 7270 632e 6d61 785f 7265  ion "grpc.max_re
-00006470: 6365 6976 655f 6d65 7373 6167 655f 6c65  ceive_message_le
-00006480: 6e67 7468 2220 6973 2061 7574 6f6d 6174  ngth" is automat
-00006490: 6963 616c 6c79 0a63 6f6e 6669 6775 7265  ically.configure
-000064a0: 6420 746f 2074 6865 2076 616c 7565 2060  d to the value `
-000064b0: 3137 202a 2031 3032 3420 2a20 3130 3234  17 * 1024 * 1024
-000064c0: 602e 2054 6869 7320 7661 6c75 6520 6361  `. This value ca
-000064d0: 6e6e 6f74 2062 6520 6368 616e 6765 642e  nnot be changed.
-000064e0: 0a0a 0a23 2320 4576 656e 7420 6f62 6a65  ...## Event obje
-000064f0: 6374 730a 0a54 6869 7320 7061 636b 6167  cts..This packag
-00006500: 6520 6465 6669 6e65 7320 6120 604e 6577  e defines a `New
-00006510: 4576 656e 7460 2063 6c61 7373 2061 6e64  Event` class and
-00006520: 2061 2060 5265 636f 7264 6564 4576 656e   a `RecordedEven
-00006530: 7460 2063 6c61 7373 2e20 5468 650a 604e  t` class. The.`N
-00006540: 6577 4576 656e 7460 2063 6c61 7373 2073  ewEvent` class s
-00006550: 686f 756c 6420 6265 2075 7365 6420 7768  hould be used wh
-00006560: 656e 2077 7269 7469 6e67 2065 7665 6e74  en writing event
-00006570: 7320 746f 2074 6865 2064 6174 6162 6173  s to the databas
-00006580: 652e 2054 6865 0a60 5265 636f 7264 6564  e. The.`Recorded
-00006590: 4576 656e 7460 2063 6c61 7373 2069 7320  Event` class is 
-000065a0: 7573 6564 2077 6865 6e20 7265 6164 696e  used when readin
-000065b0: 6720 6576 656e 7473 2066 726f 6d20 7468  g events from th
-000065c0: 6520 6461 7461 6261 7365 2e0a 0a23 2323  e database...###
-000065d0: 204e 6577 2065 7665 6e74 730a 0a54 6865   New events..The
-000065e0: 2060 4e65 7745 7665 6e74 6020 636c 6173   `NewEvent` clas
-000065f0: 7320 7368 6f75 6c64 2062 6520 7573 6564  s should be used
-00006600: 2077 6865 6e20 7772 6974 696e 6720 6576   when writing ev
-00006610: 656e 7473 2074 6f20 616e 2045 7665 6e74  ents to an Event
-00006620: 5374 6f72 6544 4220 6461 7461 6261 7365  StoreDB database
-00006630: 2e0a 596f 7520 7769 6c6c 206e 6565 6420  ..You will need 
-00006640: 746f 2063 6f6e 7374 7275 6374 206e 6577  to construct new
-00006650: 2065 7665 6e74 206f 626a 6563 7473 2062   event objects b
-00006660: 6566 6f72 6520 6361 6c6c 696e 6720 6061  efore calling `a
-00006670: 7070 656e 645f 746f 5f73 7472 6561 6d28  ppend_to_stream(
-00006680: 2960 2e0a 0a54 6865 2060 4e65 7745 7665  )`...The `NewEve
-00006690: 6e74 6020 636c 6173 7320 6973 2061 2066  nt` class is a f
-000066a0: 726f 7a65 6e20 5079 7468 6f6e 2064 6174  rozen Python dat
-000066b0: 6163 6c61 7373 2e20 4974 2068 6173 2074  aclass. It has t
-000066c0: 776f 2072 6571 7569 7265 6420 636f 6e73  wo required cons
-000066d0: 7472 7563 746f 720a 6172 6775 6d65 6e74  tructor.argument
-000066e0: 7320 2860 7479 7065 6020 616e 6420 6064  s (`type` and `d
-000066f0: 6174 6160 2920 616e 6420 7468 7265 6520  ata`) and three 
-00006700: 6f70 7469 6f6e 616c 2063 6f6e 7374 7275  optional constru
-00006710: 6374 6f72 2061 7267 756d 656e 7473 2028  ctor arguments (
-00006720: 606d 6574 6164 6174 6160 2c0a 6063 6f6e  `metadata`,.`con
-00006730: 7465 6e74 5f74 7970 6560 2061 6e64 2060  tent_type` and `
-00006740: 6964 6029 2e0a 0a54 6865 2072 6571 7569  id`)...The requi
-00006750: 7265 6420 6074 7970 6560 2061 7267 756d  red `type` argum
-00006760: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
-00006770: 6073 7472 602c 2075 7365 6420 746f 2064  `str`, used to d
-00006780: 6573 6372 6962 6520 7468 6520 7479 7065  escribe the type
-00006790: 206f 660a 646f 6d61 696e 2065 7665 6e74   of.domain event
-000067a0: 2074 6861 7420 6973 2062 6569 6e67 2072   that is being r
-000067b0: 6563 6f72 6465 642e 0a0a 5468 6520 7265  ecorded...The re
-000067c0: 7175 6972 6564 2060 6461 7461 6020 6172  quired `data` ar
-000067d0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
-000067e0: 6f6e 2060 6279 7465 7360 206f 626a 6563  on `bytes` objec
-000067f0: 742c 2075 7365 6420 746f 2073 7461 7465  t, used to state
-00006800: 2074 6865 0a73 6572 6961 6c69 7a65 6420   the.serialized 
-00006810: 6461 7461 206f 6620 7468 6520 646f 6d61  data of the doma
-00006820: 696e 2065 7665 6e74 2074 6861 7420 6973  in event that is
-00006830: 2062 6569 6e67 2072 6563 6f72 6465 642e   being recorded.
-00006840: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-00006850: 6d65 7461 6461 7461 6020 6172 6775 6d65  metadata` argume
-00006860: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
-00006870: 6279 7465 7360 206f 626a 6563 742c 2075  bytes` object, u
-00006880: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
-00006890: 616e 790a 6d65 7461 6461 7461 206f 6620  any.metadata of 
-000068a0: 7468 6520 6576 656e 7420 7468 6174 2077  the event that w
-000068b0: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
-000068c0: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
-000068d0: 7565 2069 7320 616e 2065 6d70 7479 2060  ue is an empty `
-000068e0: 6279 7465 7360 0a6f 626a 6563 742e 0a0a  bytes`.object...
-000068f0: 5468 6520 6f70 7469 6f6e 616c 2060 636f  The optional `co
-00006900: 6e74 656e 745f 7479 7065 6020 6172 6775  ntent_type` argu
-00006910: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
-00006920: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
-00006930: 696e 6469 6361 7465 2074 6865 0a6b 696e  indicate the.kin
-00006940: 6420 6f66 2064 6174 6120 7468 6174 2069  d of data that i
-00006950: 7320 6265 696e 6720 7265 636f 7264 6564  s being recorded
-00006960: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
-00006970: 6c75 6520 6973 2060 2761 7070 6c69 6361  lue is `'applica
-00006980: 7469 6f6e 2f6a 736f 6e27 602c 0a77 6869  tion/json'`,.whi
-00006990: 6368 2069 6e64 6963 6174 6573 2074 6861  ch indicates tha
-000069a0: 7420 7468 6520 6064 6174 6160 2077 6173  t the `data` was
-000069b0: 2073 6572 6961 6c69 7365 6420 7573 696e   serialised usin
-000069c0: 6720 4a53 4f4e 2e20 416e 2061 6c74 6572  g JSON. An alter
-000069d0: 6e61 7469 7665 2076 616c 7565 0a66 6f72  native value.for
-000069e0: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
-000069f0: 7320 7468 6520 6d6f 7265 2067 656e 6572  s the more gener
-00006a00: 616c 2069 6e64 6963 6174 696f 6e20 6027  al indication `'
-00006a10: 6170 706c 6963 6174 696f 6e2f 6f63 7465  application/octe
-00006a20: 742d 7374 7265 616d 2760 2e0a 0a54 6865  t-stream'`...The
-00006a30: 206f 7074 696f 6e61 6c20 6069 6460 2061   optional `id` a
-00006a40: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-00006a50: 686f 6e20 6055 5549 4460 206f 626a 6563  hon `UUID` objec
-00006a60: 742c 2075 7365 6420 746f 2073 7065 6369  t, used to speci
-00006a70: 6679 2074 6865 2075 6e69 7175 6520 4944  fy the unique ID
-00006a80: 0a6f 6620 7468 6520 6576 656e 7420 7468  .of the event th
-00006a90: 6174 2077 696c 6c20 6265 2072 6563 6f72  at will be recor
-00006aa0: 6465 642e 2049 6620 6e6f 2076 616c 7565  ded. If no value
-00006ab0: 2069 7320 7072 6f76 6964 6564 2c20 6120   is provided, a 
-00006ac0: 6e65 7720 7665 7273 696f 6e2d 3420 5555  new version-4 UU
-00006ad0: 4944 0a77 696c 6c20 6265 2067 656e 6572  ID.will be gener
-00006ae0: 6174 6564 2e0a 0a60 6060 7079 7468 6f6e  ated...```python
-00006af0: 0a6e 6577 5f65 7665 6e74 3120 3d20 4e65  .new_event1 = Ne
-00006b00: 7745 7665 6e74 280a 2020 2020 7479 7065  wEvent(.    type
-00006b10: 3d27 4f72 6465 7243 7265 6174 6564 272c  ='OrderCreated',
-00006b20: 0a20 2020 2064 6174 613d 6227 7b22 6e61  .    data=b'{"na
-00006b30: 6d65 223a 2022 4772 6567 227d 272c 0a29  me": "Greg"}',.)
-00006b40: 0a61 7373 6572 7420 6e65 775f 6576 656e  .assert new_even
-00006b50: 7431 2e74 7970 6520 3d3d 2027 4f72 6465  t1.type == 'Orde
-00006b60: 7243 7265 6174 6564 270a 6173 7365 7274  rCreated'.assert
-00006b70: 206e 6577 5f65 7665 6e74 312e 6461 7461   new_event1.data
-00006b80: 203d 3d20 6227 7b22 6e61 6d65 223a 2022   == b'{"name": "
-00006b90: 4772 6567 227d 270a 6173 7365 7274 206e  Greg"}'.assert n
-00006ba0: 6577 5f65 7665 6e74 312e 6d65 7461 6461  ew_event1.metada
-00006bb0: 7461 203d 3d20 6227 270a 6173 7365 7274  ta == b''.assert
-00006bc0: 206e 6577 5f65 7665 6e74 312e 636f 6e74   new_event1.cont
-00006bd0: 656e 745f 7479 7065 203d 3d20 2761 7070  ent_type == 'app
-00006be0: 6c69 6361 7469 6f6e 2f6a 736f 6e27 0a61  lication/json'.a
-00006bf0: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-00006c00: 286e 6577 5f65 7665 6e74 312e 6964 2c20  (new_event1.id, 
-00006c10: 7575 6964 2e55 5549 4429 0a0a 6576 656e  uuid.UUID)..even
-00006c20: 745f 6964 203d 2075 7569 642e 7575 6964  t_id = uuid.uuid
-00006c30: 3428 290a 6e65 775f 6576 656e 7432 203d  4().new_event2 =
-00006c40: 204e 6577 4576 656e 7428 0a20 2020 2074   NewEvent(.    t
-00006c50: 7970 653d 2749 6d61 6765 4372 6561 7465  ype='ImageCreate
-00006c60: 6427 2c0a 2020 2020 6461 7461 3d62 2730  d',.    data=b'0
-00006c70: 3130 3130 3130 3130 3130 3130 3127 2c0a  1010101010101',.
-00006c80: 2020 2020 6d65 7461 6461 7461 3d62 277b      metadata=b'{
-00006c90: 2261 223a 2031 7d27 2c0a 2020 2020 636f  "a": 1}',.    co
-00006ca0: 6e74 656e 745f 7479 7065 3d27 6170 706c  ntent_type='appl
-00006cb0: 6963 6174 696f 6e2f 6f63 7465 742d 7374  ication/octet-st
-00006cc0: 7265 616d 272c 0a20 2020 2069 643d 6576  ream',.    id=ev
-00006cd0: 656e 745f 6964 2c0a 290a 6173 7365 7274  ent_id,.).assert
-00006ce0: 206e 6577 5f65 7665 6e74 322e 7479 7065   new_event2.type
-00006cf0: 203d 3d20 2749 6d61 6765 4372 6561 7465   == 'ImageCreate
-00006d00: 6427 0a61 7373 6572 7420 6e65 775f 6576  d'.assert new_ev
-00006d10: 656e 7432 2e64 6174 6120 3d3d 2062 2730  ent2.data == b'0
-00006d20: 3130 3130 3130 3130 3130 3130 3127 0a61  1010101010101'.a
-00006d30: 7373 6572 7420 6e65 775f 6576 656e 7432  ssert new_event2
-00006d40: 2e6d 6574 6164 6174 6120 3d3d 2062 277b  .metadata == b'{
-00006d50: 2261 223a 2031 7d27 0a61 7373 6572 7420  "a": 1}'.assert 
-00006d60: 6e65 775f 6576 656e 7432 2e63 6f6e 7465  new_event2.conte
-00006d70: 6e74 5f74 7970 6520 3d3d 2027 6170 706c  nt_type == 'appl
-00006d80: 6963 6174 696f 6e2f 6f63 7465 742d 7374  ication/octet-st
-00006d90: 7265 616d 270a 6173 7365 7274 206e 6577  ream'.assert new
-00006da0: 5f65 7665 6e74 322e 6964 203d 3d20 6576  _event2.id == ev
-00006db0: 656e 745f 6964 0a60 6060 0a0a 2323 2320  ent_id.```..### 
-00006dc0: 5265 636f 7264 6564 2065 7665 6e74 730a  Recorded events.
-00006dd0: 0a54 6865 2060 5265 636f 7264 6564 4576  .The `RecordedEv
-00006de0: 656e 7460 2063 6c61 7373 2069 7320 7573  ent` class is us
-00006df0: 6564 2077 6865 6e20 7265 6164 696e 6720  ed when reading 
-00006e00: 6576 656e 7473 2066 726f 6d20 616e 2045  events from an E
-00006e10: 7665 6e74 5374 6f72 6544 420a 6461 7461  ventStoreDB.data
-00006e20: 6261 7365 2e20 5468 6520 636c 6965 6e74  base. The client
-00006e30: 2077 696c 6c20 7265 7475 726e 2065 7665   will return eve
-00006e40: 6e74 206f 626a 6563 7473 206f 6620 7468  nt objects of th
-00006e50: 6973 2074 7970 6520 6672 6f6d 2061 6c6c  is type from all
-00006e60: 206d 6574 686f 6473 0a74 6861 7420 7265   methods.that re
-00006e70: 7475 726e 2072 6563 6f72 6465 6420 6576  turn recorded ev
-00006e80: 656e 7473 2c20 7375 6368 2061 7320 6067  ents, such as `g
-00006e90: 6574 5f73 7472 6561 6d28 2960 2c20 6073  et_stream()`, `s
-00006ea0: 7562 7363 7269 6265 5f74 6f5f 616c 6c28  ubscribe_to_all(
-00006eb0: 2960 2c0a 616e 6420 6072 6561 645f 7375  )`,.and `read_su
-00006ec0: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
-00006ed0: 6c28 2960 2e20 596f 7520 646f 206e 6f74  l()`. You do not
-00006ee0: 206e 6565 6420 746f 2063 6f6e 7374 7275   need to constru
-00006ef0: 6374 2072 6563 6f72 6465 6420 6576 656e  ct recorded even
-00006f00: 7420 6f62 6a65 6374 732e 0a0a 4c69 6b65  t objects...Like
-00006f10: 2060 4e65 7745 7665 6e74 602c 2074 6865   `NewEvent`, the
-00006f20: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
-00006f30: 2063 6c61 7373 2069 7320 616c 736f 2061   class is also a
-00006f40: 2066 726f 7a65 6e20 5079 7468 6f6e 2064   frozen Python d
-00006f50: 6174 6163 6c61 7373 2e20 4974 2068 6173  ataclass. It has
-00006f60: 0a61 6c6c 2074 6865 2061 7474 7269 6275  .all the attribu
-00006f70: 7465 7320 7468 6174 2060 4e65 7745 7665  tes that `NewEve
-00006f80: 6e74 6020 6861 7320 2860 7479 7065 602c  nt` has (`type`,
-00006f90: 2060 6461 7461 602c 2060 6d65 7461 6461   `data`, `metada
-00006fa0: 7461 602c 2060 636f 6e74 656e 745f 7479  ta`, `content_ty
-00006fb0: 7065 602c 2060 6964 6029 0a61 6e64 2073  pe`, `id`).and s
-00006fc0: 6f6d 6520 6164 6469 7469 6f6e 616c 2061  ome additional a
-00006fd0: 7474 7269 6275 7465 7320 7468 6174 2066  ttributes that f
-00006fe0: 6f6c 6c6f 7720 6672 6f6d 2074 6865 2066  ollow from the f
-00006ff0: 6163 7420 7468 6174 2061 6e20 6576 656e  act that an even
-00007000: 7420 7761 7320 7265 636f 7264 6564 0a28  t was recorded.(
-00007010: 6073 7472 6561 6d5f 6e61 6d65 602c 2060  `stream_name`, `
-00007020: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
-00007030: 2c20 6063 6f6d 6d69 745f 706f 7369 7469  , `commit_positi
-00007040: 6f6e 6029 2e0a 0a54 6865 2060 7479 7065  on`)...The `type
-00007050: 6020 6174 7472 6962 7574 6520 6973 2061  ` attribute is a
-00007060: 2050 7974 686f 6e20 6073 7472 602c 2075   Python `str`, u
-00007070: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
-00007080: 7468 6520 7479 7065 206f 6620 616e 2065  the type of an e
-00007090: 7665 6e74 0a74 6861 7420 7761 7320 7265  vent.that was re
-000070a0: 636f 7264 6564 2e0a 0a54 6865 2060 6461  corded...The `da
-000070b0: 7461 6020 6174 7472 6962 7574 6520 6973  ta` attribute is
-000070c0: 2061 2050 7974 686f 6e20 6062 7974 6573   a Python `bytes
-000070d0: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
-000070e0: 6f20 696e 6469 6361 7465 2074 6865 2064  o indicate the d
-000070f0: 6174 6120 6f66 2061 6e0a 6576 656e 7420  ata of an.event 
-00007100: 7468 6174 2077 6173 2072 6563 6f72 6465  that was recorde
-00007110: 642e 0a0a 5468 6520 606d 6574 6164 6174  d...The `metadat
-00007120: 6160 2061 7474 7269 6275 7465 2069 7320  a` attribute is 
-00007130: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
-00007140: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
-00007150: 2069 6e64 6963 6174 6520 7468 6520 6d65   indicate the me
-00007160: 7461 6461 7461 206f 660a 616e 2065 7665  tadata of.an eve
-00007170: 6e74 2074 6861 7420 7761 7320 7265 636f  nt that was reco
-00007180: 7264 6564 2e0a 0a54 6865 2060 636f 6e74  rded...The `cont
-00007190: 656e 745f 7479 7065 6020 6174 7472 6962  ent_type` attrib
-000071a0: 7574 6520 6973 2061 2050 7974 686f 6e20  ute is a Python 
-000071b0: 6073 7472 602c 2075 7365 6420 746f 2069  `str`, used to i
-000071c0: 6e64 6963 6174 6520 7468 6520 7479 7065  ndicate the type
-000071d0: 206f 660a 6461 7461 2074 6861 7420 7761   of.data that wa
-000071e0: 7320 7265 636f 7264 6564 2066 6f72 2061  s recorded for a
-000071f0: 6e20 6576 656e 742e 2049 7420 6973 2075  n event. It is u
-00007200: 7375 616c 6c79 2060 2761 7070 6c69 6361  sually `'applica
-00007210: 7469 6f6e 2f6a 736f 6e27 602c 2069 6e64  tion/json'`, ind
-00007220: 6963 6174 696e 670a 7468 6174 2074 6865  icating.that the
-00007230: 2064 6174 6120 6361 6e20 6265 2070 6172   data can be par
-00007240: 7365 6420 6173 204a 534f 4e2e 2041 6c74  sed as JSON. Alt
-00007250: 6572 6e61 7469 7665 6c79 2c20 6974 2069  ernatively, it i
-00007260: 7320 6027 6170 706c 6963 6174 696f 6e2f  s `'application/
-00007270: 6f63 7465 742d 7374 7265 616d 2760 2e0a  octet-stream'`..
-00007280: 0a54 6865 2060 6964 6020 6174 7472 6962  .The `id` attrib
-00007290: 7574 6520 6973 2061 2050 7974 686f 6e20  ute is a Python 
-000072a0: 6055 5549 4460 206f 626a 6563 742c 2075  `UUID` object, u
-000072b0: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
-000072c0: 7468 6520 756e 6971 7565 2049 4420 6f66  the unique ID of
-000072d0: 2061 6e0a 6576 656e 7420 7468 6174 2077   an.event that w
-000072e0: 6173 2072 6563 6f72 6465 642e 0a0a 5468  as recorded...Th
-000072f0: 6520 6073 7472 6561 6d5f 6e61 6d65 6020  e `stream_name` 
-00007300: 6174 7472 6962 7574 6520 6973 2061 2050  attribute is a P
-00007310: 7974 686f 6e20 6073 7472 602c 2075 7365  ython `str`, use
-00007320: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
-00007330: 6520 6e61 6d65 206f 6620 610a 7374 7265  e name of a.stre
-00007340: 616d 2069 6e20 7768 6963 6820 616e 2065  am in which an e
-00007350: 7665 6e74 2077 6173 2072 6563 6f72 6465  vent was recorde
-00007360: 642e 0a0a 5468 6520 6073 7472 6561 6d5f  d...The `stream_
-00007370: 706f 7369 7469 6f6e 6020 6174 7472 6962  position` attrib
-00007380: 7574 6520 6973 2061 2050 7974 686f 6e20  ute is a Python 
-00007390: 6069 6e74 602c 2075 7365 6420 746f 2069  `int`, used to i
-000073a0: 6e64 6963 6174 6520 7468 6520 706f 7369  ndicate the posi
-000073b0: 7469 6f6e 2069 6e20 610a 7374 7265 616d  tion in a.stream
-000073c0: 2061 7420 7768 6963 6820 616e 2065 7665   at which an eve
-000073d0: 6e74 2077 6173 2072 6563 6f72 6465 642e  nt was recorded.
-000073e0: 0a0a 496e 2045 7665 6e74 5374 6f72 6544  ..In EventStoreD
-000073f0: 422c 2061 2022 7374 7265 616d 2070 6f73  B, a "stream pos
-00007400: 6974 696f 6e22 2069 7320 616e 2069 6e74  ition" is an int
-00007410: 6567 6572 2072 6570 7265 7365 6e74 696e  eger representin
-00007420: 6720 7468 6520 706f 7369 7469 6f6e 206f  g the position o
-00007430: 6620 610a 7265 636f 7264 6564 2065 7665  f a.recorded eve
-00007440: 6e74 2069 6e20 6120 7374 7265 616d 2e20  nt in a stream. 
-00007450: 4561 6368 2072 6563 6f72 6465 6420 6576  Each recorded ev
-00007460: 656e 7420 6973 2072 6563 6f72 6465 6420  ent is recorded 
-00007470: 6174 2061 2070 6f73 6974 696f 6e20 696e  at a position in
-00007480: 2061 2073 7472 6561 6d2e 0a45 6163 6820   a stream..Each 
-00007490: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
-000074a0: 6973 206f 6363 7570 6965 6420 6279 206f  is occupied by o
-000074b0: 6e6c 7920 6f6e 6520 7265 636f 7264 6564  nly one recorded
-000074c0: 2065 7665 6e74 2e20 4e65 7720 6576 656e   event. New even
-000074d0: 7473 2061 7265 2072 6563 6f72 6465 6420  ts are recorded 
-000074e0: 6174 2074 6865 0a6e 6578 7420 756e 6f63  at the.next unoc
-000074f0: 6375 7069 6564 2070 6f73 6974 696f 6e2e  cupied position.
-00007500: 2041 6c6c 2073 6571 7565 6e63 6573 206f   All sequences o
-00007510: 6620 7374 7265 616d 2070 6f73 6974 696f  f stream positio
-00007520: 6e73 2061 7265 207a 6572 6f2d 6261 7365  ns are zero-base
-00007530: 6420 616e 6420 6761 706c 6573 732e 0a0a  d and gapless...
-00007540: 5468 6520 6063 6f6d 6d69 745f 706f 7369  The `commit_posi
-00007550: 7469 6f6e 6020 6174 7472 6962 7574 6520  tion` attribute 
-00007560: 6973 2061 2050 7974 686f 6e20 6069 6e74  is a Python `int
-00007570: 602c 2075 7365 6420 746f 2069 6e64 6963  `, used to indic
-00007580: 6174 6520 7468 6520 706f 7369 7469 6f6e  ate the position
-00007590: 2069 6e20 7468 650a 6461 7461 6261 7365   in the.database
-000075a0: 2061 7420 7768 6963 6820 616e 2065 7665   at which an eve
-000075b0: 6e74 2077 6173 2072 6563 6f72 6465 642e  nt was recorded.
-000075c0: 0a0a 496e 2045 7665 6e74 5374 6f72 6544  ..In EventStoreD
-000075d0: 422c 2061 2022 636f 6d6d 6974 2070 6f73  B, a "commit pos
-000075e0: 6974 696f 6e22 2069 7320 616e 2069 6e74  ition" is an int
-000075f0: 6567 6572 2072 6570 7265 7365 6e74 696e  eger representin
-00007600: 6720 7468 6520 706f 7369 7469 6f6e 206f  g the position o
-00007610: 6620 610a 7265 636f 7264 6564 2065 7665  f a.recorded eve
-00007620: 6e74 2069 6e20 7468 6520 6461 7461 6261  nt in the databa
-00007630: 7365 2e20 4561 6368 2072 6563 6f72 6465  se. Each recorde
-00007640: 6420 6576 656e 7420 6973 2072 6563 6f72  d event is recor
-00007650: 6465 6420 6174 2061 2070 6f73 6974 696f  ded at a positio
-00007660: 6e20 696e 2074 6865 0a64 6174 6162 6173  n in the.databas
-00007670: 652e 2045 6163 6820 636f 6d6d 6974 2070  e. Each commit p
-00007680: 6f73 6974 696f 6e20 6973 206f 6363 7570  osition is occup
-00007690: 6965 6420 6279 206f 6e6c 7920 6f6e 6520  ied by only one 
-000076a0: 7265 636f 7264 6564 2065 7665 6e74 2e20  recorded event. 
-000076b0: 436f 6d6d 6974 2070 6f73 6974 696f 6e73  Commit positions
-000076c0: 0a61 7265 207a 6572 6f2d 6261 7365 6420  .are zero-based 
-000076d0: 616e 6420 696e 6372 6561 7365 206d 6f6e  and increase mon
-000076e0: 6f74 6f6e 6963 616c 6c79 2061 7320 6e65  otonically as ne
-000076f0: 7720 6576 656e 7473 2061 7265 2072 6563  w events are rec
-00007700: 6f72 6465 642e 2042 7574 2c20 756e 6c69  orded. But, unli
-00007710: 6b65 2073 7472 6561 6d0a 706f 7369 7469  ke stream.positi
-00007720: 6f6e 732c 2074 6865 2073 6571 7565 6e63  ons, the sequenc
-00007730: 6520 6f66 2073 7563 6365 7373 6976 6520  e of successive 
-00007740: 636f 6d6d 6974 2070 6f73 6974 696f 6e73  commit positions
-00007750: 2069 7320 6e6f 7420 6761 706c 6573 732e   is not gapless.
-00007760: 2049 6e64 6565 642c 2074 6865 7265 2061   Indeed, there a
-00007770: 7265 0a75 7375 616c 6c79 206c 6172 6765  re.usually large
-00007780: 2064 6966 6665 7265 6e63 6573 2062 6574   differences bet
-00007790: 7765 656e 2074 6865 2063 6f6d 6d69 7420  ween the commit 
-000077a0: 706f 7369 7469 6f6e 7320 6f66 2073 7563  positions of suc
-000077b0: 6365 7373 6976 656c 7920 7265 636f 7264  cessively record
-000077c0: 6564 2065 7665 6e74 732e 0a0a 506c 6561  ed events...Plea
-000077d0: 7365 206e 6f74 652c 2069 6e20 4576 656e  se note, in Even
-000077e0: 7453 746f 7265 4442 2032 312e 3130 2c20  tStoreDB 21.10, 
-000077f0: 7468 6520 6063 6f6d 6d69 745f 706f 7369  the `commit_posi
-00007800: 7469 6f6e 6020 6f66 2061 6c6c 2060 5265  tion` of all `Re
-00007810: 636f 7264 6564 4576 656e 7460 206f 626a  cordedEvent` obj
-00007820: 6563 7473 0a6f 6274 6169 6e65 6420 6672  ects.obtained fr
-00007830: 6f6d 2060 7265 6164 5f73 7472 6561 6d28  om `read_stream(
-00007840: 2960 2069 7320 604e 6f6e 6560 2c20 7768  )` is `None`, wh
-00007850: 6572 6561 7320 7468 6f73 6520 6f62 7461  ereas those obta
-00007860: 696e 6564 2066 726f 6d20 6072 6561 645f  ined from `read_
-00007870: 616c 6c28 2960 2068 6176 650a 7468 6520  all()` have.the 
-00007880: 6163 7475 616c 2063 6f6d 6d69 7420 706f  actual commit po
-00007890: 7369 7469 6f6e 206f 6620 7468 6520 7265  sition of the re
-000078a0: 636f 7264 6564 2065 7665 6e74 2e20 5468  corded event. Th
-000078b0: 6973 2077 6173 2063 6861 6e67 6564 2069  is was changed i
-000078c0: 6e20 7665 7273 696f 6e20 3232 2e31 302c  n version 22.10,
-000078d0: 2073 6f0a 7468 6174 2065 7665 6e74 206f   so.that event o
-000078e0: 626a 6563 7473 206f 6274 6169 6e65 6420  bjects obtained 
-000078f0: 6672 6f6d 2062 6f74 6820 6067 6574 5f73  from both `get_s
-00007900: 7472 6561 6d28 2960 2061 6e64 2060 7265  tream()` and `re
-00007910: 6164 5f61 6c6c 2829 6020 6861 7665 2074  ad_all()` have t
-00007920: 6865 2061 6374 7561 6c0a 636f 6d6d 6974  he actual.commit
-00007930: 2070 6f73 6974 696f 6e2e 2054 6865 2060   position. The `
-00007940: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
-00007950: 2061 7474 7269 6275 7465 206f 6620 7468   attribute of th
-00007960: 6520 6052 6563 6f72 6465 6445 7665 6e74  e `RecordedEvent
-00007970: 6020 636c 6173 7320 6973 0a61 6e6e 6f74  ` class is.annot
-00007980: 6174 6564 2077 6974 6820 7468 6520 7479  ated with the ty
-00007990: 7065 2060 4f70 7469 6f6e 616c 5b69 6e74  pe `Optional[int
-000079a0: 5d60 2066 6f72 2074 6869 7320 7265 6173  ]` for this reas
-000079b0: 6f6e 206f 6e6c 792e 0a0a 0a60 6060 7079  on only....```py
-000079c0: 7468 6f6e 0a66 726f 6d20 6573 6462 636c  thon.from esdbcl
-000079d0: 6965 6e74 2e65 7665 6e74 7320 696d 706f  ient.events impo
-000079e0: 7274 2052 6563 6f72 6465 6445 7665 6e74  rt RecordedEvent
-000079f0: 0a0a 7265 636f 7264 6564 5f65 7665 6e74  ..recorded_event
-00007a00: 203d 2052 6563 6f72 6465 6445 7665 6e74   = RecordedEvent
-00007a10: 280a 2020 2020 7479 7065 3d27 4f72 6465  (.    type='Orde
-00007a20: 7243 7265 6174 6564 272c 0a20 2020 2064  rCreated',.    d
-00007a30: 6174 613d 6227 7b7d 272c 0a20 2020 206d  ata=b'{}',.    m
-00007a40: 6574 6164 6174 613d 6227 272c 0a20 2020  etadata=b'',.   
-00007a50: 2063 6f6e 7465 6e74 5f74 7970 653d 2761   content_type='a
-00007a60: 7070 6c69 6361 7469 6f6e 2f6a 736f 6e27  pplication/json'
-00007a70: 2c0a 2020 2020 6964 3d75 7569 642e 7575  ,.    id=uuid.uu
-00007a80: 6964 3428 292c 0a20 2020 2073 7472 6561  id4(),.    strea
-00007a90: 6d5f 6e61 6d65 3d27 7374 7265 616d 3127  m_name='stream1'
-00007aa0: 2c0a 2020 2020 7374 7265 616d 5f70 6f73  ,.    stream_pos
-00007ab0: 6974 696f 6e3d 302c 0a20 2020 2063 6f6d  ition=0,.    com
-00007ac0: 6d69 745f 706f 7369 7469 6f6e 3d35 3132  mit_position=512
-00007ad0: 2c0a 290a 6060 600a 0a0a 2323 2053 7472  ,.).```...## Str
-00007ae0: 6561 6d73 0a0a 496e 2045 7665 6e74 5374  eams..In EventSt
-00007af0: 6f72 6544 422c 2061 2022 7374 7265 616d  oreDB, a "stream
-00007b00: 2220 6973 2061 2073 6571 7565 6e63 6520  " is a sequence 
-00007b10: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
-00007b20: 7473 2074 6861 7420 616c 6c20 6861 7665  ts that all have
-00007b30: 0a74 6865 2073 616d 6520 2273 7472 6561  .the same "strea
-00007b40: 6d20 6e61 6d65 222e 2054 6865 7265 2077  m name". There w
-00007b50: 696c 6c20 6e6f 726d 616c 6c79 2062 6520  ill normally be 
-00007b60: 6d61 6e79 2073 7472 6561 6d73 2069 6e20  many streams in 
-00007b70: 6120 6461 7461 6261 7365 2c0a 6561 6368  a database,.each
-00007b80: 2077 6974 6820 6d61 6e79 2072 6563 6f72   with many recor
-00007b90: 6465 6420 6576 656e 7473 2e20 4561 6368  ded events. Each
-00007ba0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00007bb0: 6861 7320 6120 706f 7369 7469 6f6e 2069  has a position i
-00007bc0: 6e20 6974 7320 7374 7265 616d 0a28 7468  n its stream.(th
-00007bd0: 6520 2273 7472 6561 6d20 706f 7369 7469  e "stream positi
-00007be0: 6f6e 2229 2c20 616e 6420 6120 706f 7369  on"), and a posi
-00007bf0: 7469 6f6e 2069 6e20 7468 6520 6461 7461  tion in the data
-00007c00: 6261 7365 2028 7468 6520 2263 6f6d 6d69  base (the "commi
-00007c10: 7420 706f 7369 7469 6f6e 2229 2e0a 5374  t position")..St
-00007c20: 7265 616d 2070 6f73 6974 696f 6e73 2061  ream positions a
-00007c30: 7265 207a 6572 6f2d 6261 7365 6420 616e  re zero-based an
-00007c40: 6420 6761 706c 6573 732e 2043 6f6d 6d69  d gapless. Commi
-00007c50: 7420 706f 7369 7469 6f6e 7320 6172 6520  t positions are 
-00007c60: 616c 736f 207a 6572 6f2d 6261 7365 642c  also zero-based,
-00007c70: 0a62 7574 2061 7265 206e 6f74 2067 6170  .but are not gap
-00007c80: 6c65 7373 2e0a 0a54 6865 206d 6574 686f  less...The metho
-00007c90: 6473 2060 6170 7065 6e64 5f74 6f5f 7374  ds `append_to_st
-00007ca0: 7265 616d 2829 602c 2060 6765 745f 7374  ream()`, `get_st
-00007cb0: 7265 616d 2829 6020 616e 6420 6072 6561  ream()` and `rea
-00007cc0: 645f 616c 6c28 2960 2063 616e 0a62 6520  d_all()` can.be 
-00007cd0: 7573 6564 2074 6f20 7265 6164 2061 6e64  used to read and
-00007ce0: 2072 6563 6f72 6420 696e 2074 6865 2064   record in the d
-00007cf0: 6174 6162 6173 652e 0a0a 2323 2320 4170  atabase...### Ap
-00007d00: 7065 6e64 2065 7665 6e74 730a 0a2a 7265  pend events..*re
-00007d10: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
-00007d20: 5468 6520 6061 7070 656e 645f 746f 5f73  The `append_to_s
-00007d30: 7472 6561 6d28 2960 206d 6574 686f 6420  tream()` method 
-00007d40: 6361 6e20 6265 2075 7365 6420 6174 6f6d  can be used atom
-00007d50: 6963 616c 6c79 2074 6f20 7265 636f 7264  ically to record
-00007d60: 2061 2073 6571 7565 6e63 6520 6f66 206e   a sequence of n
-00007d70: 6577 2065 7665 6e74 732e 0a49 6620 7468  ew events..If th
-00007d80: 6520 6f70 6572 6174 696f 6e20 6973 2073  e operation is s
-00007d90: 7563 6365 7373 6675 6c2c 2069 7420 7265  uccessful, it re
-00007da0: 7475 726e 7320 7468 6520 636f 6d6d 6974  turns the commit
-00007db0: 2070 6f73 6974 696f 6e20 6f66 2074 6865   position of the
-00007dc0: 206c 6173 7420 6576 656e 7420 696e 2074   last event in t
-00007dd0: 6865 0a73 6571 7565 6e63 6520 7468 6174  he.sequence that
-00007de0: 2068 6173 2062 6565 6e20 7265 636f 7264   has been record
-00007df0: 6564 2e0a 0a54 6869 7320 6d65 7468 6f64  ed...This method
-00007e00: 2068 6173 2074 6872 6565 2072 6571 7569   has three requi
-00007e10: 7265 6420 6172 6775 6d65 6e74 732c 2060  red arguments, `
-00007e20: 7374 7265 616d 5f6e 616d 6560 2c20 6063  stream_name`, `c
-00007e30: 7572 7265 6e74 5f76 6572 7369 6f6e 600a  urrent_version`.
-00007e40: 616e 6420 6065 7665 6e74 7360 2e0a 0a54  and `events`...T
-00007e50: 6865 2072 6571 7569 7265 6420 6073 7472  he required `str
-00007e60: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
-00007e70: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
-00007e80: 7374 7260 2074 6861 7420 756e 6971 7565  str` that unique
-00007e90: 6c79 2069 6465 6e74 6966 6965 7320 610a  ly identifies a.
-00007ea0: 7374 7265 616d 2074 6f20 7768 6963 6820  stream to which 
-00007eb0: 6120 7365 7175 656e 6365 206f 6620 6576  a sequence of ev
-00007ec0: 656e 7473 2077 696c 6c20 6265 2061 7070  ents will be app
-00007ed0: 656e 6465 642e 0a0a 5468 6520 7265 7175  ended...The requ
-00007ee0: 6972 6564 2060 6375 7272 656e 745f 7665  ired `current_ve
-00007ef0: 7273 696f 6e60 2061 7267 756d 656e 7420  rsion` argument 
-00007f00: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
-00007f10: 6520 6569 7468 6572 2061 2050 7974 686f  e either a Pytho
-00007f20: 6e20 6069 6e74 600a 7468 6174 2069 6e64  n `int`.that ind
-00007f30: 6963 6174 6573 2074 6865 2073 7472 6561  icates the strea
-00007f40: 6d20 706f 7369 7469 6f6e 206f 6620 7468  m position of th
-00007f50: 6520 6c61 7374 2072 6563 6f72 6465 6420  e last recorded 
-00007f60: 6576 656e 7420 696e 2074 6865 2073 7472  event in the str
-00007f70: 6561 6d2c 206f 720a 6053 7472 6561 6d53  eam, or.`StreamS
-00007f80: 7461 7465 2e4e 4f5f 5354 5245 414d 6020  tate.NO_STREAM` 
-00007f90: 6966 2074 6865 2073 7472 6561 6d20 646f  if the stream do
-00007fa0: 6573 206e 6f74 2079 6574 2065 7869 7374  es not yet exist
-00007fb0: 206f 7220 6861 7320 6265 656e 2064 656c   or has been del
-00007fc0: 6574 6564 2e20 5468 650a 7374 7265 616d  eted. The.stream
-00007fd0: 2070 6f73 6974 696f 6e73 2061 7265 207a   positions are z
-00007fe0: 6572 6f2d 6261 7365 6420 616e 6420 6761  ero-based and ga
-00007ff0: 706c 6573 732c 2073 6f20 7468 6174 2069  pless, so that i
-00008000: 6620 6120 7374 7265 616d 2068 6173 2074  f a stream has t
-00008010: 776f 2065 7665 6e74 732c 2074 6865 0a60  wo events, the.`
-00008020: 6375 7272 656e 745f 7665 7273 696f 6e60  current_version`
-00008030: 2073 686f 756c 6420 6265 2031 2e20 4966   should be 1. If
-00008040: 2061 6e20 696e 636f 7272 6563 7420 7661   an incorrect va
-00008050: 6c75 6520 6973 2067 6976 656e 2c20 7468  lue is given, th
-00008060: 6973 206d 6574 686f 6420 7769 6c6c 2072  is method will r
-00008070: 6169 7365 2061 0a60 5772 6f6e 6743 7572  aise a.`WrongCur
-00008080: 7265 6e74 5665 7273 696f 6e60 2065 7863  rentVersion` exc
-00008090: 6570 7469 6f6e 2e20 5468 6973 2062 6568  eption. This beh
-000080a0: 6176 696f 7220 6973 2064 6573 6967 6e65  avior is designe
-000080b0: 6420 746f 2070 726f 7669 6465 2063 6f6e  d to provide con
-000080c0: 6375 7272 656e 6379 0a63 6f6e 7472 6f6c  currency.control
-000080d0: 2077 6865 6e20 7265 636f 7264 696e 6720   when recording 
-000080e0: 6e65 7720 6576 656e 7473 2e20 5468 6520  new events. The 
-000080f0: 636f 7272 6563 7420 7661 6c75 6520 6f66  correct value of
-00008100: 2060 6375 7272 656e 745f 7665 7273 696f   `current_versio
-00008110: 6e60 2066 6f72 2061 6e79 2073 7472 6561  n` for any strea
-00008120: 6d0a 6361 6e20 6265 206f 6274 6169 6e65  m.can be obtaine
-00008130: 6420 6279 2063 616c 6c69 6e67 2060 6765  d by calling `ge
-00008140: 745f 6375 7272 656e 745f 7665 7273 696f  t_current_versio
-00008150: 6e28 2960 2e20 486f 7765 7665 722c 2074  n()`. However, t
-00008160: 6865 2074 7970 6963 616c 2061 7070 726f  he typical appro
-00008170: 6163 6820 6973 2074 6f0a 7265 636f 6e73  ach is to.recons
-00008180: 7472 7563 7420 616e 2061 6767 7265 6761  truct an aggrega
-00008190: 7465 2066 726f 6d20 7468 6520 7265 636f  te from the reco
-000081a0: 7264 6564 2065 7665 6e74 732c 2073 6f20  rded events, so 
-000081b0: 7468 6174 2074 6865 2076 6572 7369 6f6e  that the version
-000081c0: 206f 6620 7468 6520 6167 6772 6567 6174   of the aggregat
-000081d0: 650a 6973 2074 6865 2073 7472 6561 6d20  e.is the stream 
-000081e0: 706f 7369 7469 6f6e 206f 6620 7468 6520  position of the 
-000081f0: 6c61 7374 2072 6563 6f72 6465 6420 6576  last recorded ev
-00008200: 656e 742c 2074 6865 6e20 6861 7665 2074  ent, then have t
-00008210: 6865 2061 6767 7265 6761 7465 2067 656e  he aggregate gen
-00008220: 6572 6174 6520 6e65 770a 6576 656e 7473  erate new.events
-00008230: 2c20 616e 6420 7468 656e 2075 7365 2074  , and then use t
-00008240: 6865 2063 7572 7265 6e74 2076 6572 7369  he current versi
-00008250: 6f6e 206f 6620 7468 6520 6167 6772 6567  on of the aggreg
-00008260: 6174 6520 6173 2074 6865 2076 616c 7565  ate as the value
-00008270: 206f 6620 7468 650a 6063 7572 7265 6e74   of the.`current
-00008280: 5f76 6572 7369 6f6e 6020 6172 6775 6d65  _version` argume
-00008290: 6e74 2077 6865 6e20 6170 7065 6e64 696e  nt when appendin
-000082a0: 6720 7468 6520 6e65 7720 6167 6772 6567  g the new aggreg
-000082b0: 6174 6520 6576 656e 7473 2e20 5468 6973  ate events. This
-000082c0: 2065 6e73 7572 6573 0a74 6865 2063 6f6e   ensures.the con
-000082d0: 7369 7374 656e 6379 206f 6620 7468 6520  sistency of the 
-000082e0: 7265 636f 7264 6564 2061 6767 7265 6761  recorded aggrega
-000082f0: 7465 2065 7665 6e74 732c 2062 6563 6175  te events, becau
-00008300: 7365 206f 7065 7261 7469 6f6e 7320 7468  se operations th
-00008310: 6174 2067 656e 6572 6174 650a 6e65 7720  at generate.new 
-00008320: 6167 6772 6567 6174 6520 6576 656e 7473  aggregate events
-00008330: 2063 616e 2062 6520 7265 7472 6965 6420   can be retried 
-00008340: 7769 7468 2061 2066 7265 7368 6c79 2072  with a freshly r
-00008350: 6563 6f6e 7374 7275 6374 6564 2061 6767  econstructed agg
-00008360: 7265 6761 7465 2069 660a 6120 6057 726f  regate if.a `Wro
-00008370: 6e67 4375 7272 656e 7456 6572 7369 6f6e  ngCurrentVersion
-00008380: 6020 6578 6365 7074 696f 6e20 6973 2065  ` exception is e
-00008390: 6e63 6f75 6e74 6572 6564 2077 6865 6e20  ncountered when 
-000083a0: 7265 636f 7264 696e 6720 6e65 7720 6576  recording new ev
-000083b0: 656e 7473 2e20 5468 6973 0a63 6f6e 7472  ents. This.contr
-000083c0: 6f6c 6c69 6e67 2062 6568 6176 696f 7220  olling behavior 
-000083d0: 6361 6e20 6265 2064 6973 6162 6c65 6420  can be disabled 
-000083e0: 6279 2073 6574 7469 6e67 2074 6865 2076  by setting the v
-000083f0: 616c 7565 206f 6620 7468 6520 6063 7572  alue of the `cur
-00008400: 7265 6e74 5f76 6572 7369 6f6e 600a 6172  rent_version`.ar
-00008410: 6775 6d65 6e74 2074 6f20 7468 6520 636f  gument to the co
-00008420: 6e73 7461 6e74 2060 5374 7265 616d 5374  nstant `StreamSt
-00008430: 6174 652e 414e 5960 2e0a 0a54 6865 2072  ate.ANY`...The r
-00008440: 6571 7569 7265 6420 6065 7665 6e74 7360  equired `events`
-00008450: 2061 7267 756d 656e 7420 6973 2065 7870   argument is exp
-00008460: 6563 7465 6420 746f 2062 6520 6120 7365  ected to be a se
-00008470: 7175 656e 6365 206f 6620 6e65 7720 6576  quence of new ev
-00008480: 656e 7420 6f62 6a65 6374 732e 2054 6865  ent objects. The
-00008490: 0a60 4e65 7745 7665 6e74 6020 636c 6173  .`NewEvent` clas
-000084a0: 7320 7368 6f75 6c64 2062 6520 7573 6564  s should be used
-000084b0: 2074 6f20 636f 6e73 7472 7563 7420 6e65   to construct ne
-000084c0: 7720 6576 656e 7420 6f62 6a65 6374 732e  w event objects.
-000084d0: 2054 6865 2060 6170 7065 6e64 5f74 6f5f   The `append_to_
-000084e0: 7374 7265 616d 2829 600a 6f70 6572 6174  stream()`.operat
-000084f0: 696f 6e20 6973 2061 746f 6d69 632c 2073  ion is atomic, s
-00008500: 6f20 7468 6174 2065 6974 6865 7220 616c  o that either al
-00008510: 6c20 6f72 206e 6f6e 6520 6f66 2074 6865  l or none of the
-00008520: 206e 6577 2065 7665 6e74 7320 7769 6c6c   new events will
-00008530: 2062 6520 7265 636f 7264 6564 2e20 4974   be recorded. It
-00008540: 0a69 7320 6e6f 7420 706f 7373 6962 6c65  .is not possible
-00008550: 2077 6974 6820 4576 656e 7453 746f 7265   with EventStore
-00008560: 4442 2061 746f 6d69 6361 6c6c 7920 746f  DB atomically to
-00008570: 2072 6563 6f72 6420 6e65 7720 6576 656e   record new even
-00008580: 7473 2069 6e20 6d6f 7265 2074 6861 6e20  ts in more than 
-00008590: 6f6e 6520 7374 7265 616d 2e0a 0a54 6869  one stream...Thi
-000085a0: 7320 6d65 7468 6f64 2061 6c73 6f20 6861  s method also ha
-000085b0: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
-000085c0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-000085d0: 2c20 7768 6963 6820 6973 2061 2050 7974  , which is a Pyt
-000085e0: 686f 6e20 6066 6c6f 6174 600a 7468 6174  hon `float`.that
-000085f0: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
-00008600: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
-00008610: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00008620: 6f70 6572 6174 696f 6e2e 0a0a 5468 6973  operation...This
-00008630: 206d 6574 686f 6420 616c 736f 2068 6173   method also has
-00008640: 2061 6e20 6f70 7469 6f6e 616c 2060 6372   an optional `cr
-00008650: 6564 656e 7469 616c 7360 2061 7267 756d  edentials` argum
-00008660: 656e 742c 2077 6869 6368 2063 616e 2062  ent, which can b
-00008670: 6520 7573 6564 2074 6f0a 6f76 6572 7269  e used to.overri
-00008680: 6465 2063 616c 6c20 6372 6564 656e 7469  de call credenti
-00008690: 616c 7320 6465 7269 7665 6420 6672 6f6d  als derived from
-000086a0: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
-000086b0: 7374 7269 6e67 2055 5249 2e0a 0a49 6e20  string URI...In 
-000086c0: 7468 6520 6578 616d 706c 6520 6265 6c6f  the example belo
-000086d0: 772c 2061 206e 6577 2065 7665 6e74 2c20  w, a new event, 
-000086e0: 6065 7665 6e74 3160 2c20 6973 2061 7070  `event1`, is app
-000086f0: 656e 6465 6420 746f 2061 206e 6577 2073  ended to a new s
-00008700: 7472 6561 6d2e 2054 6865 2073 7472 6561  tream. The strea
-00008710: 6d0a 646f 6573 206e 6f74 2079 6574 2065  m.does not yet e
-00008720: 7869 7374 2c20 736f 2060 6375 7272 656e  xist, so `curren
-00008730: 745f 7665 7273 696f 6e60 2069 7320 6053  t_version` is `S
-00008740: 7472 6561 6d53 7461 7465 2e4e 4f5f 5354  treamState.NO_ST
-00008750: 5245 414d 602e 0a0a 6060 6070 7974 686f  REAM`...```pytho
-00008760: 6e0a 2320 436f 6e73 7472 7563 7420 6120  n.# Construct a 
-00008770: 6e65 7720 6576 656e 7420 6f62 6a65 6374  new event object
-00008780: 2e0a 6576 656e 7431 203d 204e 6577 4576  ..event1 = NewEv
-00008790: 656e 7428 7479 7065 3d27 4f72 6465 7243  ent(type='OrderC
-000087a0: 7265 6174 6564 272c 2064 6174 613d 6227  reated', data=b'
-000087b0: 6461 7461 3127 290a 0a23 2044 6566 696e  data1')..# Defin
-000087c0: 6520 6120 6e65 7720 7374 7265 616d 206e  e a new stream n
-000087d0: 616d 652e 0a73 7472 6561 6d5f 6e61 6d65  ame..stream_name
-000087e0: 3120 3d20 7374 7228 7575 6964 2e75 7569  1 = str(uuid.uui
-000087f0: 6434 2829 290a 0a23 2041 7070 656e 6420  d4())..# Append 
-00008800: 7468 6520 6e65 7720 6576 656e 7473 2074  the new events t
-00008810: 6f20 7468 6520 6e65 7720 7374 7265 616d  o the new stream
-00008820: 2e0a 636f 6d6d 6974 5f70 6f73 6974 696f  ..commit_positio
-00008830: 6e31 203d 2063 6c69 656e 742e 6170 7065  n1 = client.appe
-00008840: 6e64 5f74 6f5f 7374 7265 616d 280a 2020  nd_to_stream(.  
-00008850: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-00008860: 7265 616d 5f6e 616d 6531 2c0a 2020 2020  ream_name1,.    
-00008870: 6375 7272 656e 745f 7665 7273 696f 6e3d  current_version=
-00008880: 5374 7265 616d 5374 6174 652e 4e4f 5f53  StreamState.NO_S
-00008890: 5452 4541 4d2c 0a20 2020 2065 7665 6e74  TREAM,.    event
-000088a0: 733d 5b65 7665 6e74 315d 2c0a 290a 6060  s=[event1],.).``
-000088b0: 600a 0a49 6e20 7468 6520 6578 616d 706c  `..In the exampl
-000088c0: 6520 6265 6c6f 772c 2074 776f 2073 7562  e below, two sub
-000088d0: 7365 7175 656e 7420 6576 656e 7473 2061  sequent events a
-000088e0: 7265 2061 7070 656e 6465 6420 746f 2061  re appended to a
-000088f0: 6e20 6578 6973 7469 6e67 0a73 7472 6561  n existing.strea
-00008900: 6d2e 2054 6865 2073 7472 6561 6d20 6861  m. The stream ha
-00008910: 7320 6f6e 6520 7265 636f 7264 6564 2065  s one recorded e
-00008920: 7665 6e74 2c20 736f 2060 6375 7272 656e  vent, so `curren
-00008930: 745f 7665 7273 696f 6e60 2069 7320 6030  t_version` is `0
-00008940: 602e 0a0a 6060 6070 7974 686f 6e0a 6576  `...```python.ev
-00008950: 656e 7432 203d 204e 6577 4576 656e 7428  ent2 = NewEvent(
-00008960: 7479 7065 3d27 4f72 6465 7255 7064 6174  type='OrderUpdat
-00008970: 6564 272c 2064 6174 613d 6227 6461 7461  ed', data=b'data
-00008980: 3227 290a 6576 656e 7433 203d 204e 6577  2').event3 = New
-00008990: 4576 656e 7428 7479 7065 3d27 4f72 6465  Event(type='Orde
-000089a0: 7244 656c 6574 6564 272c 2064 6174 613d  rDeleted', data=
-000089b0: 6227 6461 7461 3327 290a 0a63 6f6d 6d69  b'data3')..commi
-000089c0: 745f 706f 7369 7469 6f6e 3220 3d20 636c  t_position2 = cl
-000089d0: 6965 6e74 2e61 7070 656e 645f 746f 5f73  ient.append_to_s
-000089e0: 7472 6561 6d28 0a20 2020 2073 7472 6561  tream(.    strea
-000089f0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-00008a00: 6d65 312c 0a20 2020 2063 7572 7265 6e74  me1,.    current
-00008a10: 5f76 6572 7369 6f6e 3d30 2c0a 2020 2020  _version=0,.    
-00008a20: 6576 656e 7473 3d5b 6576 656e 7432 2c20  events=[event2, 
-00008a30: 6576 656e 7433 5d2c 0a29 0a60 6060 0a0a  event3],.).```..
-00008a40: 5468 6520 7265 7475 726e 6564 2076 616c  The returned val
-00008a50: 7565 732c 2060 636f 6d6d 6974 5f70 6f73  ues, `commit_pos
-00008a60: 6974 696f 6e31 6020 616e 6420 6063 6f6d  ition1` and `com
-00008a70: 6d69 745f 706f 7369 7469 6f6e 3260 2c20  mit_position2`, 
-00008a80: 6172 6520 7468 650a 636f 6d6d 6974 2070  are the.commit p
-00008a90: 6f73 6974 696f 6e73 2069 6e20 7468 6520  ositions in the 
-00008aa0: 6461 7461 6261 7365 206f 6620 7468 6520  database of the 
-00008ab0: 6c61 7374 2065 7665 6e74 7320 696e 2074  last events in t
-00008ac0: 6865 2072 6563 6f72 6465 6420 7365 7175  he recorded sequ
-00008ad0: 656e 6365 732e 0a54 6861 7420 6973 2c20  ences..That is, 
-00008ae0: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-00008af0: 3160 2069 7320 7468 6520 636f 6d6d 6974  1` is the commit
-00008b00: 2070 6f73 6974 696f 6e20 6f66 2060 6576   position of `ev
-00008b10: 656e 7431 6020 616e 640a 6063 6f6d 6d69  ent1` and.`commi
-00008b20: 745f 706f 7369 7469 6f6e 3260 2069 7320  t_position2` is 
-00008b30: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
-00008b40: 696f 6e20 6f66 2060 6576 656e 7433 602e  ion of `event3`.
-00008b50: 0a0a 436f 6d6d 6974 2070 6f73 6974 696f  ..Commit positio
-00008b60: 6e73 2074 6861 7420 6172 6520 7265 7475  ns that are retu
-00008b70: 726e 6564 2069 6e20 7468 6973 2077 6179  rned in this way
-00008b80: 2063 616e 2062 6520 7573 6564 2062 7920   can be used by 
-00008b90: 6120 7573 6572 2069 6e74 6572 6661 6365  a user interface
-00008ba0: 2074 6f20 706f 6c6c 0a61 2064 6f77 6e73   to poll.a downs
-00008bb0: 7472 6561 6d20 636f 6d70 6f6e 656e 7420  tream component 
-00008bc0: 756e 7469 6c20 6974 2068 6173 2070 726f  until it has pro
-00008bd0: 6365 7373 6564 2061 6c6c 2074 6865 206e  cessed all the n
-00008be0: 6577 6c79 2072 6563 6f72 6465 6420 6576  ewly recorded ev
-00008bf0: 656e 7473 2e20 466f 7220 6578 616d 706c  ents. For exampl
-00008c00: 652c 0a63 6f6e 7369 6465 7220 6120 7573  e,.consider a us
-00008c10: 6572 2069 6e74 6572 6661 6365 2063 6f6d  er interface com
-00008c20: 6d61 6e64 2074 6861 7420 7265 7375 6c74  mand that result
-00008c30: 7320 696e 2074 6865 2072 6563 6f72 6469  s in the recordi
-00008c40: 6e67 206f 6620 6e65 7720 6576 656e 7473  ng of new events
-00008c50: 2c20 616e 6420 616e 0a65 7665 6e74 7561  , and an.eventua
-00008c60: 6c6c 7920 636f 6e73 6973 7465 6e74 206d  lly consistent m
-00008c70: 6174 6572 6961 6c69 7a65 6420 7669 6577  aterialized view
-00008c80: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
-00008c90: 2063 6f6d 706f 6e65 6e74 2074 6861 7420   component that 
-00008ca0: 6973 2075 7064 6174 6564 2066 726f 6d0a  is updated from.
-00008cb0: 7468 6573 6520 6576 656e 7473 2e20 4966  these events. If
-00008cc0: 2074 6865 206e 6577 2065 7665 6e74 7320   the new events 
-00008cd0: 6861 7665 206e 6f74 2079 6574 2062 6565  have not yet bee
-00008ce0: 6e20 7072 6f63 6573 7365 642c 2074 6865  n processed, the
-00008cf0: 2076 6965 7720 6d69 6768 7420 6265 2073   view might be s
-00008d00: 7461 6c65 2c0a 6f72 206f 7574 2d6f 662d  tale,.or out-of-
-00008d10: 6461 7465 2e20 496e 7374 6561 6420 6f66  date. Instead of
-00008d20: 2064 6973 706c 6179 696e 6720 6120 7374   displaying a st
-00008d30: 616c 6520 7669 6577 2c20 7468 6520 7573  ale view, the us
-00008d40: 6572 2069 6e74 6572 6661 6365 2063 616e  er interface can
-00008d50: 2070 6f6c 6c20 7468 650a 646f 776e 7374   poll the.downst
-00008d60: 7265 616d 2063 6f6d 706f 6e65 6e74 2075  ream component u
-00008d70: 6e74 696c 2069 7420 6861 7320 7072 6f63  ntil it has proc
-00008d80: 6573 7365 6420 7468 6520 6e65 776c 7920  essed the newly 
-00008d90: 7265 636f 7264 6564 2065 7665 6e74 732c  recorded events,
-00008da0: 2061 6e64 2074 6865 6e20 6469 7370 6c61   and then displa
-00008db0: 790a 616e 2075 702d 746f 2d64 6174 6520  y.an up-to-date 
-00008dc0: 7669 6577 2074 6f20 7468 6520 7573 6572  view to the user
-00008dd0: 2e0a 0a0a 2323 2320 4964 656d 706f 7465  ....### Idempote
-00008de0: 6e74 2061 7070 656e 6420 6f70 6572 6174  nt append operat
-00008df0: 696f 6e73 0a0a 5468 6520 6061 7070 656e  ions..The `appen
-00008e00: 645f 746f 5f73 7472 6561 6d28 2960 206d  d_to_stream()` m
-00008e10: 6574 686f 6420 6973 2022 6964 656d 706f  ethod is "idempo
-00008e20: 7465 6e74 222c 2069 6e20 7468 6174 2069  tent", in that i
-00008e30: 6620 6361 6c6c 6564 2077 6974 6820 6e65  f called with ne
-00008e40: 7720 6576 656e 7473 2077 686f 7365 0a60  w events whose.`
-00008e50: 6964 6020 6174 7472 6962 7574 6520 7661  id` attribute va
-00008e60: 6c75 6573 2065 7175 616c 2074 686f 7365  lues equal those
-00008e70: 206f 6620 7265 636f 7264 6564 2065 7665   of recorded eve
-00008e80: 6e74 7320 696e 2074 6865 206e 616d 6564  nts in the named
-00008e90: 2073 7472 6561 6d20 696d 6d65 6469 6174   stream immediat
-00008ea0: 656c 790a 6166 7465 7220 7468 6520 7374  ely.after the st
-00008eb0: 7265 616d 2070 6f73 6974 696f 6e20 7370  ream position sp
-00008ec0: 6563 6966 6965 6420 6279 2074 6865 2076  ecified by the v
-00008ed0: 616c 7565 206f 6620 7468 6520 6063 7572  alue of the `cur
-00008ee0: 7265 6e74 5f76 6572 7369 6f6e 6020 6172  rent_version` ar
-00008ef0: 6775 6d65 6e74 2c20 7468 656e 0a69 7420  gument, then.it 
-00008f00: 7769 6c6c 2072 6574 7572 6e20 7468 6520  will return the 
-00008f10: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-00008f20: 6f66 2074 6865 206c 6173 7420 6e65 7720  of the last new 
-00008f30: 6576 656e 742c 2077 6974 686f 7574 206d  event, without m
-00008f40: 616b 696e 6720 616e 7920 6368 616e 6765  aking any change
-00008f50: 7320 746f 0a74 6865 2064 6174 6162 6173  s to.the databas
-00008f60: 652e 0a0a 536f 6d65 7469 6d65 7320 6974  e...Sometimes it
-00008f70: 206d 6179 2068 6170 7065 6e2c 2077 6865   may happen, whe
-00008f80: 6e20 6361 6c6c 696e 6720 6061 7070 656e  n calling `appen
-00008f90: 645f 746f 5f73 7472 6561 6d28 2960 2c20  d_to_stream()`, 
-00008fa0: 7468 6174 2074 6865 206e 6577 2065 7665  that the new eve
-00008fb0: 6e74 7320 6172 650a 7375 6363 6573 7366  nts are.successf
-00008fc0: 756c 6c79 2072 6563 6f72 6465 6420 6275  ully recorded bu
-00008fd0: 7420 736f 6d65 686f 7720 6120 636f 6e6e  t somehow a conn
-00008fe0: 6563 7469 6f6e 2069 7373 7565 206f 6363  ection issue occ
-00008ff0: 7572 7320 6265 666f 7265 2074 6865 2073  urs before the s
-00009000: 7563 6365 7373 6675 6c20 6361 6c6c 0a63  uccessful call.c
-00009010: 616e 2072 6574 7572 6e20 7375 6363 6573  an return succes
-00009020: 7366 756c 6c79 2074 6f20 7468 6520 636c  sfully to the cl
-00009030: 6965 6e74 2e20 5765 2063 616e 6e6f 7420  ient. We cannot 
-00009040: 6265 2073 7572 6520 6966 2074 6865 2065  be sure if the e
-00009050: 7665 6e74 7320 7765 7265 2072 6563 6f72  vents were recor
-00009060: 6465 640a 6f72 206e 6f74 2c20 616e 6420  ded.or not, and 
-00009070: 736f 2077 6520 6d61 7920 7769 7368 2074  so we may wish t
-00009080: 6f20 7265 7472 792e 2049 6620 7468 6520  o retry. If the 
-00009090: 6576 656e 7473 2077 6572 6520 696e 2066  events were in f
-000090a0: 6163 7420 7375 6363 6573 7366 756c 6c79  act successfully
-000090b0: 2072 6563 6f72 6465 642c 0a69 7420 6973   recorded,.it is
-000090c0: 2063 6f6e 7665 6e69 656e 7420 666f 7220   convenient for 
-000090d0: 7468 6520 7265 7472 6965 6420 6f70 6572  the retried oper
-000090e0: 6174 696f 6e20 746f 2072 6574 7572 6e20  ation to return 
-000090f0: 7375 6363 6573 7366 756c 6c79 2077 6974  successfully wit
-00009100: 686f 7574 2072 6169 7369 6e67 2061 6e0a  hout raising an.
-00009110: 6578 6365 7074 696f 6e2e 2049 6620 7468  exception. If th
-00009120: 6f73 6520 6e65 7720 6576 656e 7473 2077  ose new events w
-00009130: 6572 6520 696e 2066 6163 7420 6e6f 7420  ere in fact not 
-00009140: 7265 636f 7264 6564 2c20 616e 6420 696e  recorded, and in
-00009150: 2074 6865 206d 6561 6e74 696d 6520 6e6f   the meantime no
-00009160: 206f 7468 6572 0a6e 6577 2065 7665 6e74   other.new event
-00009170: 7320 7765 7265 2072 6563 6f72 6465 6420  s were recorded 
-00009180: 696e 2074 6861 7420 7374 7265 616d 2c20  in that stream, 
-00009190: 7468 656e 2069 7420 6d61 6b65 7320 7365  then it makes se
-000091a0: 6e73 6520 7468 6174 2074 6865 206e 6577  nse that the new
-000091b0: 2065 7665 6e74 7320 7769 6c6c 0a62 6520   events will.be 
-000091c0: 7265 636f 7264 6564 2077 6865 6e20 7468  recorded when th
-000091d0: 6520 6170 7065 6e64 206f 7065 7261 7469  e append operati
-000091e0: 6f6e 2069 7320 7265 7472 6965 642e 204f  on is retried. O
-000091f0: 6620 636f 7572 7365 2c20 6966 2061 2060  f course, if a `
-00009200: 5772 6f6e 6743 7572 7265 6e74 5665 7273  WrongCurrentVers
-00009210: 696f 6e60 0a65 7863 6570 7469 6f6e 2069  ion`.exception i
-00009220: 7320 7261 6973 6564 2077 6865 6e20 7265  s raised when re
-00009230: 7472 7969 6e67 2074 6865 206f 7065 7261  trying the opera
-00009240: 7469 6f6e 2c20 7468 656e 2061 6e20 6170  tion, then an ap
-00009250: 706c 6963 6174 696f 6e20 636f 6d6d 616e  plication comman
-00009260: 6420 7768 6963 680a 6765 6e65 7261 7465  d which.generate
-00009270: 6420 7468 6520 6e65 7720 6576 656e 7473  d the new events
-00009280: 2069 6e20 7468 6520 636f 6e74 6578 7420   in the context 
-00009290: 6f66 2061 6c72 6561 6479 2072 6563 6f72  of already recor
-000092a0: 6465 6420 6576 656e 7473 206d 6179 206e  ded events may n
-000092b0: 6565 6420 746f 2062 650a 6578 6563 7574  eed to be.execut
-000092c0: 6564 2061 6761 696e 2e20 416c 7465 726e  ed again. Altern
-000092d0: 6174 6976 656c 792c 2061 2073 7569 7461  atively, a suita
-000092e0: 626c 6520 6572 726f 7220 6d69 6768 7420  ble error might 
-000092f0: 6265 2064 6973 706c 6179 6564 2062 7920  be displayed by 
-00009300: 7468 6520 6170 706c 6963 6174 696f 6e2c  the application,
-00009310: 0a77 6974 6820 616e 2075 702d 746f 2d64  .with an up-to-d
-00009320: 6174 6520 7669 6577 206f 6620 7468 6520  ate view of the 
-00009330: 7265 636f 7264 6564 2064 6174 612c 2067  recorded data, g
-00009340: 6976 696e 6720 6120 7573 6572 206f 6620  iving a user of 
-00009350: 7468 6520 6170 706c 6963 6174 696f 6e20  the application 
-00009360: 616e 0a6f 7070 6f72 7475 6e69 7479 2074  an.opportunity t
-00009370: 6f20 6465 6369 6465 2069 6620 7468 6579  o decide if they
-00009380: 2073 7469 6c6c 2077 6973 6820 746f 2070   still wish to p
-00009390: 726f 6365 6564 2077 6974 6820 7468 6569  roceed with thei
-000093a0: 7220 6f72 6967 696e 616c 2069 6e74 656e  r original inten
-000093b0: 7469 6f6e 2e0a 0a54 6865 2065 7861 6d70  tion...The examp
-000093c0: 6c65 2062 656c 6f77 2073 686f 7773 2074  le below shows t
-000093d0: 6865 2060 6170 7065 6e64 5f74 6f5f 7374  he `append_to_st
-000093e0: 7265 616d 2829 6020 6d65 7468 6f64 2062  ream()` method b
-000093f0: 6569 6e67 2063 616c 6c65 6420 6167 6169  eing called agai
-00009400: 6e20 7769 7468 0a60 6576 656e 7433 6020  n with.`event3` 
-00009410: 616e 6420 6063 7572 7265 6e74 5f76 6572  and `current_ver
-00009420: 7369 6f6e 3d30 602e 2057 6520 6361 6e20  sion=0`. We can 
-00009430: 7365 6520 7468 6174 2072 6570 6561 7469  see that repeati
-00009440: 6e67 2074 6865 2063 616c 6c20 746f 0a60  ng the call to.`
-00009450: 6170 7065 6e64 5f74 6f5f 7374 7265 616d  append_to_stream
-00009460: 2829 6020 7265 7475 726e 7320 7375 6363  ()` returns succ
-00009470: 6573 7366 756c 6c79 2e0a 0a60 6060 7079  essfully...```py
-00009480: 7468 6f6e 0a23 2052 6574 7279 2061 7070  thon.# Retry app
-00009490: 656e 6469 6e67 2065 7665 6e74 332e 0a63  ending event3..c
-000094a0: 6f6d 6d69 745f 706f 7369 7469 6f6e 5f72  ommit_position_r
-000094b0: 6574 7279 203d 2063 6c69 656e 742e 6170  etry = client.ap
-000094c0: 7065 6e64 5f74 6f5f 7374 7265 616d 280a  pend_to_stream(.
-000094d0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-000094e0: 7374 7265 616d 5f6e 616d 6531 2c0a 2020  stream_name1,.  
-000094f0: 2020 6375 7272 656e 745f 7665 7273 696f    current_versio
-00009500: 6e3d 302c 0a20 2020 2065 7665 6e74 733d  n=0,.    events=
-00009510: 5b65 7665 6e74 322c 2065 7665 6e74 335d  [event2, event3]
-00009520: 2c0a 290a 6060 600a 0a57 6520 6361 6e20  ,.).```..We can 
-00009530: 7365 6520 7468 6174 2074 6865 2073 616d  see that the sam
-00009540: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-00009550: 6e20 6973 2072 6574 7572 6e65 6420 6173  n is returned as
-00009560: 2061 626f 7665 2e0a 0a60 6060 7079 7468   above...```pyth
-00009570: 6f6e 0a61 7373 6572 7420 636f 6d6d 6974  on.assert commit
-00009580: 5f70 6f73 6974 696f 6e5f 7265 7472 7920  _position_retry 
-00009590: 3d3d 2063 6f6d 6d69 745f 706f 7369 7469  == commit_positi
-000095a0: 6f6e 320a 6060 600a 0a42 7920 6361 6c6c  on2.```..By call
-000095b0: 696e 6720 6067 6574 5f73 7472 6561 6d28  ing `get_stream(
-000095c0: 2960 2c20 7765 2063 616e 2061 6c73 6f20  )`, we can also 
-000095d0: 7365 6520 7468 6520 7374 7265 616d 2068  see the stream h
-000095e0: 6173 2062 6565 6e20 756e 6368 616e 6765  as been unchange
-000095f0: 640a 6465 7370 6974 6520 7468 6520 6061  d.despite the `a
-00009600: 7070 656e 645f 746f 5f73 7472 6561 6d28  ppend_to_stream(
-00009610: 2960 206d 6574 686f 6420 6861 7669 6e67  )` method having
-00009620: 2062 6565 6e20 6361 6c6c 6564 2074 7769   been called twi
-00009630: 6365 2077 6974 6820 7468 6520 7361 6d65  ce with the same
-00009640: 2061 7267 756d 656e 7473 2e0a 5468 6174   arguments..That
-00009650: 2069 732c 2074 6865 7265 2061 7265 2073   is, there are s
-00009660: 7469 6c6c 206f 6e6c 7920 7468 7265 6520  till only three 
-00009670: 6576 656e 7473 2069 6e20 7468 6520 7374  events in the st
-00009680: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
-00009690: 0a65 7665 6e74 7320 3d20 636c 6965 6e74  .events = client
-000096a0: 2e67 6574 5f73 7472 6561 6d28 0a20 2020  .get_stream(.   
-000096b0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
-000096c0: 6561 6d5f 6e61 6d65 310a 290a 0a61 7373  eam_name1.)..ass
-000096d0: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
-000096e0: 3d3d 2033 0a60 6060 0a0a 5468 6973 2069  == 3.```..This i
-000096f0: 6465 6d70 6f74 656e 7420 6265 6861 7669  dempotent behavi
-00009700: 6f75 7220 6465 7065 6e64 7320 6f6e 2074  our depends on t
-00009710: 6865 2060 6964 6020 6174 7472 6962 7574  he `id` attribut
-00009720: 6520 6f66 2074 6865 2060 4e65 7745 7665  e of the `NewEve
-00009730: 6e74 6020 636c 6173 732e 0a54 6869 7320  nt` class..This 
-00009740: 6174 7472 6962 7574 652c 2062 7920 6465  attribute, by de
-00009750: 6661 756c 742c 2069 7320 6173 7369 676e  fault, is assign
-00009760: 6564 2061 206e 6577 2061 6e64 2075 6e69  ed a new and uni
-00009770: 7175 6520 7665 7273 696f 6e2d 3420 5555  que version-4 UU
-00009780: 4944 2077 6865 6e20 616e 0a69 6e73 7461  ID when an.insta
-00009790: 6e63 6520 6f66 2060 4e65 7745 7665 6e74  nce of `NewEvent
-000097a0: 6020 6973 2063 6f6e 7374 7275 6374 6564  ` is constructed
-000097b0: 2e20 5468 6520 6069 6460 2061 7267 756d  . The `id` argum
-000097c0: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
-000097d0: 7768 656e 0a63 6f6e 7374 7275 6374 696e  when.constructin
-000097e0: 6720 604e 6577 4576 656e 7460 206f 626a  g `NewEvent` obj
-000097f0: 6563 7473 2074 6f20 7365 7420 7468 6520  ects to set the 
-00009800: 7661 6c75 6520 6f66 2074 6869 7320 6174  value of this at
-00009810: 7472 6962 7574 652e 0a0a 0a23 2323 2052  tribute....### R
-00009820: 6561 6420 7374 7265 616d 2065 7665 6e74  ead stream event
-00009830: 730a 0a54 6865 2060 7265 6164 5f73 7472  s..The `read_str
-00009840: 6561 6d28 2960 206d 6574 686f 6420 6361  eam()` method ca
-00009850: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
-00009860: 2065 7665 6e74 7320 7468 6174 2068 6176   events that hav
-00009870: 6520 6265 656e 2061 7070 656e 6465 640a  e been appended.
-00009880: 746f 2061 2073 7472 6561 6d2e 2054 6869  to a stream. Thi
-00009890: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
-000098a0: 2061 2022 7265 6164 2072 6573 706f 6e73   a "read respons
-000098b0: 6522 206f 626a 6563 742e 0a0a 4120 2272  e" object...A "r
-000098c0: 6561 6420 7265 7370 6f6e 7365 2220 6f62  ead response" ob
-000098d0: 6a65 6374 2069 7320 6120 5079 7468 6f6e  ject is a Python
-000098e0: 2069 7465 7261 746f 722e 2052 6563 6f72   iterator. Recor
-000098f0: 6465 6420 6576 656e 7473 2063 616e 2062  ded events can b
-00009900: 650a 6f62 7461 696e 6564 2062 7920 6974  e.obtained by it
-00009910: 6572 6174 696e 6720 6f76 6572 2074 6865  erating over the
-00009920: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
-00009930: 206f 626a 6563 742e 2052 6563 6f72 6465   object. Recorde
-00009940: 6420 6576 656e 7473 2061 7265 0a73 7472  d events are.str
-00009950: 6561 6d65 6420 6672 6f6d 2074 6865 2073  eamed from the s
-00009960: 6572 7665 7220 746f 2074 6865 2063 6c69  erver to the cli
-00009970: 656e 7420 6173 2074 6865 2069 7465 7261  ent as the itera
-00009980: 7469 6f6e 2070 726f 6365 6564 732e 2054  tion proceeds. T
-00009990: 6865 2069 7465 7261 7469 6f6e 0a77 696c  he iteration.wil
-000099a0: 6c20 6175 746f 6d61 7469 6361 6c6c 7920  l automatically 
-000099b0: 7374 6f70 2077 6865 6e20 7468 6572 6520  stop when there 
-000099c0: 6172 6520 6e6f 206d 6f72 6520 7265 636f  are no more reco
-000099d0: 7264 6564 2065 7665 6e74 7320 746f 2062  rded events to b
-000099e0: 6520 7265 7475 726e 6564 2e0a 5468 6520  e returned..The 
-000099f0: 7374 7265 616d 696e 6720 6f66 2065 7665  streaming of eve
-00009a00: 6e74 732c 2061 6e64 2068 656e 6365 2074  nts, and hence t
-00009a10: 6865 2069 7465 7261 746f 722c 2063 616e  he iterator, can
-00009a20: 2061 6c73 6f20 6265 2073 746f 7070 6564   also be stopped
-00009a30: 2062 7920 6361 6c6c 696e 670a 7468 6520   by calling.the 
-00009a40: 6073 746f 7028 2960 206d 6574 686f 6420  `stop()` method 
-00009a50: 6f6e 2074 6865 2022 7265 6164 2072 6573  on the "read res
-00009a60: 706f 6e73 6522 206f 626a 6563 742e 0a0a  ponse" object...
-00009a70: 5468 6520 6067 6574 5f73 7472 6561 6d28  The `get_stream(
-00009a80: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-00009a90: 2075 7365 6420 746f 2067 6574 2065 7665   used to get eve
-00009aa0: 6e74 7320 7468 6174 2068 6176 6520 6265  nts that have be
-00009ab0: 656e 2061 7070 656e 6465 640a 746f 2061  en appended.to a
-00009ac0: 2073 7472 6561 6d2e 2054 6869 7320 6d65   stream. This me
-00009ad0: 7468 6f64 2072 6574 7572 6e73 2061 2050  thod returns a P
-00009ae0: 7974 686f 6e20 6074 7570 6c65 6020 6f66  ython `tuple` of
-00009af0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00009b00: 6f62 6a65 6374 732e 0a54 6865 2072 6563  objects..The rec
-00009b10: 6f72 6465 6420 6576 656e 7420 6f62 6a65  orded event obje
-00009b20: 6374 7320 6172 6520 696e 7374 616e 6365  cts are instance
-00009b30: 7320 6f66 2074 6865 2060 5265 636f 7264  s of the `Record
-00009b40: 6564 4576 656e 7460 2063 6c61 7373 2e20  edEvent` class. 
-00009b50: 4974 0a63 616c 6c73 2060 7265 6164 5f73  It.calls `read_s
-00009b60: 7472 6561 6d28 2960 2061 6e64 2070 6173  tream()` and pas
-00009b70: 7365 7320 7468 6520 2272 6561 6420 7265  ses the "read re
-00009b80: 7370 6f6e 7365 2220 6974 6572 6174 6f72  sponse" iterator
-00009b90: 2069 6e74 6f20 6120 5079 7468 6f6e 0a60   into a Python.`
-00009ba0: 7475 706c 6560 2c20 736f 2074 6861 7420  tuple`, so that 
-00009bb0: 7468 6520 7374 7265 616d 696e 6720 7769  the streaming wi
-00009bc0: 6c6c 2063 6f6d 706c 6574 6520 6265 666f  ll complete befo
-00009bd0: 7265 2074 6865 206d 6574 686f 6420 7265  re the method re
-00009be0: 7475 726e 732e 0a0a 5468 6520 6072 6561  turns...The `rea
-00009bf0: 645f 7374 7265 616d 2829 6020 616e 6420  d_stream()` and 
-00009c00: 6067 6574 5f73 7472 6561 6d28 2960 206d  `get_stream()` m
-00009c10: 6574 686f 6473 2068 6176 6520 6f6e 6520  ethods have one 
-00009c20: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-00009c30: 742c 2060 7374 7265 616d 5f6e 616d 6560  t, `stream_name`
-00009c40: 2e0a 0a54 6865 2072 6571 7569 7265 6420  ...The required 
-00009c50: 6073 7472 6561 6d5f 6e61 6d65 6020 6172  `stream_name` ar
-00009c60: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
-00009c70: 6f6e 2060 7374 7260 2074 6861 7420 756e  on `str` that un
-00009c80: 6971 7565 6c79 2069 6465 6e74 6966 6965  iquely identifie
-00009c90: 7320 610a 7374 7265 616d 2066 726f 6d20  s a.stream from 
-00009ca0: 7768 6963 6820 7265 636f 7264 6564 2065  which recorded e
-00009cb0: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
-00009cc0: 7475 726e 6564 2e0a 0a54 6865 2060 7265  turned...The `re
-00009cd0: 6164 5f73 7472 6561 6d28 2960 2061 6e64  ad_stream()` and
-00009ce0: 2060 6765 745f 7374 7265 616d 2829 6020   `get_stream()` 
-00009cf0: 6d65 7468 6f64 7320 616c 736f 2068 6176  methods also hav
-00009d00: 6520 6669 7665 206f 7074 696f 6e61 6c20  e five optional 
-00009d10: 6172 6775 6d65 6e74 732c 0a60 7374 7265  arguments,.`stre
-00009d20: 616d 5f70 6f73 6974 696f 6e60 2c20 6062  am_position`, `b
-00009d30: 6163 6b77 6172 6473 602c 2060 7265 736f  ackwards`, `reso
-00009d40: 6c76 655f 6c69 6e6b 7360 2c20 606c 696d  lve_links`, `lim
-00009d50: 6974 602c 2061 6e64 2060 7469 6d65 6f75  it`, and `timeou
-00009d60: 7460 2e0a 0a54 6865 206f 7074 696f 6e61  t`...The optiona
-00009d70: 6c20 6073 7472 6561 6d5f 706f 7369 7469  l `stream_positi
-00009d80: 6f6e 6020 6172 6775 6d65 6e74 2069 7320  on` argument is 
-00009d90: 6120 5079 7468 6f6e 2060 696e 7460 2074  a Python `int` t
-00009da0: 6861 7420 6361 6e20 6265 2075 7365 6420  hat can be used 
-00009db0: 746f 0a69 6e64 6963 6174 6520 7468 6520  to.indicate the 
-00009dc0: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
-00009dd0: 7374 7265 616d 2066 726f 6d20 7768 6963  stream from whic
-00009de0: 6820 746f 2073 7461 7274 2072 6561 6469  h to start readi
-00009df0: 6e67 2e20 5468 6520 6465 6661 756c 7420  ng. The default 
-00009e00: 7661 6c75 650a 6f66 2060 7374 7265 616d  value.of `stream
-00009e10: 5f70 6f73 6974 696f 6e60 2069 7320 604e  _position` is `N
-00009e20: 6f6e 6560 2e20 5768 656e 2072 6561 6469  one`. When readi
-00009e30: 6e67 2061 2073 7472 6561 6d20 6672 6f6d  ng a stream from
-00009e40: 2061 2073 7065 6369 6669 6320 706f 7369   a specific posi
-00009e50: 7469 6f6e 2069 6e20 7468 650a 7374 7265  tion in the.stre
-00009e60: 616d 2c20 7468 6520 7265 636f 7264 6564  am, the recorded
-00009e70: 2065 7665 6e74 2061 7420 7468 6174 2070   event at that p
-00009e80: 6f73 6974 696f 6e20 7769 6c6c 2062 6520  osition will be 
-00009e90: 696e 636c 7564 6564 2c20 626f 7468 2077  included, both w
-00009ea0: 6865 6e20 7265 6164 696e 670a 666f 7277  hen reading.forw
-00009eb0: 6172 6473 2066 726f 6d20 7468 6174 2070  ards from that p
-00009ec0: 6f73 6974 696f 6e2c 2061 6e64 2077 6865  osition, and whe
-00009ed0: 6e20 7265 6164 696e 6720 6261 636b 7761  n reading backwa
-00009ee0: 7264 732e 0a0a 5468 6520 6f70 7469 6f6e  rds...The option
-00009ef0: 616c 2060 6261 636b 7761 7264 7360 2061  al `backwards` a
-00009f00: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-00009f10: 686f 6e20 6062 6f6f 6c60 2e20 5468 6520  hon `bool`. The 
-00009f20: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
-00009f30: 2060 6261 636b 7761 7264 7360 0a69 7320   `backwards`.is 
-00009f40: 6046 616c 7365 602c 2077 6869 6368 206d  `False`, which m
-00009f50: 6561 6e73 2074 6865 2073 7472 6561 6d20  eans the stream 
-00009f60: 7769 6c6c 2062 6520 7265 6164 2066 6f72  will be read for
-00009f70: 7761 7264 732c 2073 6f20 7468 6174 2065  wards, so that e
-00009f80: 7665 6e74 7320 6172 6520 7265 7475 726e  vents are return
-00009f90: 6564 0a69 6e20 7468 6520 6f72 6465 7220  ed.in the order 
-00009fa0: 7468 6579 2077 6572 6520 7265 636f 7264  they were record
-00009fb0: 6564 2e20 4966 2060 6261 636b 7761 7264  ed. If `backward
-00009fc0: 7360 2069 7320 6054 7275 6560 2c20 7468  s` is `True`, th
-00009fd0: 6520 6576 656e 7473 2061 7265 2072 6574  e events are ret
-00009fe0: 7572 6e65 6420 696e 0a72 6576 6572 7365  urned in.reverse
-00009ff0: 206f 7264 6572 2e0a 0a49 6620 6062 6163   order...If `bac
-0000a000: 6b77 6172 6473 6020 6973 2060 4661 6c73  kwards` is `Fals
-0000a010: 6560 2061 6e64 2060 7374 7265 616d 5f70  e` and `stream_p
-0000a020: 6f73 6974 696f 6e60 2069 7320 604e 6f6e  osition` is `Non
-0000a030: 6560 2c20 7468 6520 7374 7265 616d 2773  e`, the stream's
-0000a040: 2065 7665 6e74 7320 7769 6c6c 2062 650a   events will be.
-0000a050: 7265 7475 726e 6564 2069 6e20 7468 6520  returned in the 
-0000a060: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
-0000a070: 7265 636f 7264 6564 2c20 7374 6172 7469  recorded, starti
-0000a080: 6e67 2066 726f 6d20 7468 6520 6669 7273  ng from the firs
-0000a090: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-0000a0a0: 2e20 4966 0a60 6261 636b 7761 7264 7360  . If.`backwards`
-0000a0b0: 2069 7320 6054 7275 6560 2061 6e64 2060   is `True` and `
-0000a0c0: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
-0000a0d0: 2069 7320 604e 6f6e 6560 2c20 7468 6520   is `None`, the 
-0000a0e0: 7374 7265 616d 2773 2065 7665 6e74 7320  stream's events 
-0000a0f0: 7769 6c6c 2062 650a 7265 7475 726e 6564  will be.returned
-0000a100: 2069 6e20 7265 7665 7273 6520 6f72 6465   in reverse orde
-0000a110: 722c 2073 7461 7274 696e 6720 6672 6f6d  r, starting from
-0000a120: 2074 6865 206c 6173 7420 7265 636f 7264   the last record
-0000a130: 6564 2065 7665 6e74 2e0a 0a54 6865 206f  ed event...The o
-0000a140: 7074 696f 6e61 6c20 6072 6573 6f6c 7665  ptional `resolve
-0000a150: 5f6c 696e 6b73 6020 6172 6775 6d65 6e74  _links` argument
-0000a160: 2069 7320 6120 5079 7468 6f6e 2060 626f   is a Python `bo
-0000a170: 6f6c 602e 2054 6865 2064 6566 6175 6c74  ol`. The default
-0000a180: 2076 616c 7565 206f 6620 6072 6573 6f6c   value of `resol
-0000a190: 7665 5f6c 696e 6b73 600a 6973 2060 4661  ve_links`.is `Fa
-0000a1a0: 6c73 6560 2c20 7768 6963 6820 6d65 616e  lse`, which mean
-0000a1b0: 7320 616e 7920 6576 656e 7420 6c69 6e6b  s any event link
-0000a1c0: 7320 7769 6c6c 206e 6f74 2062 6520 7265  s will not be re
-0000a1d0: 736f 6c76 6564 2c20 736f 2074 6861 7420  solved, so that 
-0000a1e0: 7468 6520 6576 656e 7473 2074 6861 7420  the events that 
-0000a1f0: 6172 650a 7265 7475 726e 6564 206d 6179  are.returned may
-0000a200: 2072 6570 7265 7365 6e74 2065 7665 6e74   represent event
-0000a210: 206c 696e 6b73 2e20 4966 2060 7265 736f   links. If `reso
-0000a220: 6c76 655f 6c69 6e6b 7360 2069 7320 6054  lve_links` is `T
-0000a230: 7275 6560 2c20 616e 7920 6576 656e 7420  rue`, any event 
-0000a240: 6c69 6e6b 7320 7769 6c6c 0a62 6520 7265  links will.be re
-0000a250: 736f 6c76 6564 2c20 736f 2074 6861 7420  solved, so that 
-0000a260: 7468 6520 6c69 6e6b 6564 2065 7665 6e74  the linked event
-0000a270: 7320 7769 6c6c 2062 6520 7265 7475 726e  s will be return
-0000a280: 6564 2069 6e73 7465 6164 206f 6620 7468  ed instead of th
-0000a290: 6520 6576 656e 7420 6c69 6e6b 732e 0a0a  e event links...
-0000a2a0: 5468 6520 6f70 7469 6f6e 616c 2060 6c69  The optional `li
-0000a2b0: 6d69 7460 2061 7267 756d 656e 7420 6973  mit` argument is
-0000a2c0: 2061 2050 7974 686f 6e20 6069 6e74 6020   a Python `int` 
-0000a2d0: 7768 6963 6820 7265 7374 7269 6374 7320  which restricts 
-0000a2e0: 7468 6520 6e75 6d62 6572 206f 6620 6576  the number of ev
-0000a2f0: 656e 7473 0a74 6861 7420 7769 6c6c 2062  ents.that will b
-0000a300: 6520 7265 7475 726e 6564 2e20 5468 6520  e returned. The 
-0000a310: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
-0000a320: 2060 6c69 6d69 7460 2069 7320 6073 7973   `limit` is `sys
-0000a330: 2e6d 6178 696e 7460 2e0a 0a54 6865 206f  .maxint`...The o
-0000a340: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
-0000a350: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-0000a360: 5079 7468 6f6e 2060 666c 6f61 7460 2077  Python `float` w
-0000a370: 6869 6368 2073 6574 7320 6120 6465 6164  hich sets a dead
-0000a380: 6c69 6e65 2066 6f72 0a74 6865 2063 6f6d  line for.the com
-0000a390: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-0000a3a0: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
-0000a3b0: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
-0000a3c0: 2068 6173 2061 6e20 6f70 7469 6f6e 616c   has an optional
-0000a3d0: 2060 6372 6564 656e 7469 616c 7360 2061   `credentials` a
-0000a3e0: 7267 756d 656e 742c 2077 6869 6368 2063  rgument, which c
-0000a3f0: 616e 2062 6520 7573 6564 2074 6f0a 6f76  an be used to.ov
-0000a400: 6572 7269 6465 2063 616c 6c20 6372 6564  erride call cred
-0000a410: 656e 7469 616c 7320 6465 7269 7665 6420  entials derived 
-0000a420: 6672 6f6d 2074 6865 2063 6f6e 6e65 6374  from the connect
-0000a430: 696f 6e20 7374 7269 6e67 2055 5249 2e0a  ion string URI..
-0000a440: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-0000a450: 6f77 2073 686f 7773 2074 6865 2064 6566  ow shows the def
-0000a460: 6175 6c74 2062 6568 6176 696f 722c 2077  ault behavior, w
-0000a470: 6869 6368 2069 7320 746f 2072 6574 7572  hich is to retur
-0000a480: 6e20 616c 6c20 7468 6520 7265 636f 7264  n all the record
-0000a490: 6564 0a65 7665 6e74 7320 6f66 2061 2073  ed.events of a s
-0000a4a0: 7472 6561 6d20 666f 7277 6172 6473 2066  tream forwards f
-0000a4b0: 726f 6d20 7468 6520 6669 7273 7420 7265  rom the first re
-0000a4c0: 636f 7264 6564 2065 7665 6e74 7320 746f  corded events to
-0000a4d0: 2074 6865 206c 6173 742e 0a0a 6060 6070   the last...```p
-0000a4e0: 7974 686f 6e0a 6576 656e 7473 203d 2063  ython.events = c
-0000a4f0: 6c69 656e 742e 6765 745f 7374 7265 616d  lient.get_stream
-0000a500: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
-0000a510: 653d 7374 7265 616d 5f6e 616d 6531 0a29  e=stream_name1.)
-0000a520: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
-0000a530: 6e74 7329 203d 3d20 330a 6173 7365 7274  nts) == 3.assert
-0000a540: 2065 7665 6e74 735b 305d 2e69 6420 3d3d   events[0].id ==
-0000a550: 2065 7665 6e74 312e 6964 0a61 7373 6572   event1.id.asser
-0000a560: 7420 6576 656e 7473 5b31 5d2e 6964 203d  t events[1].id =
-0000a570: 3d20 6576 656e 7432 2e69 640a 6173 7365  = event2.id.asse
-0000a580: 7274 2065 7665 6e74 735b 325d 2e69 6420  rt events[2].id 
-0000a590: 3d3d 2065 7665 6e74 332e 6964 0a60 6060  == event3.id.```
-0000a5a0: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
-0000a5b0: 6c6f 7720 7368 6f77 7320 686f 7720 746f  low shows how to
-0000a5c0: 2075 7365 2074 6865 2060 7374 7265 616d   use the `stream
-0000a5d0: 5f70 6f73 6974 696f 6e60 2061 7267 756d  _position` argum
-0000a5e0: 656e 7420 746f 2072 6561 6420 6120 7374  ent to read a st
-0000a5f0: 7265 616d 0a66 726f 6d20 6120 7370 6563  ream.from a spec
-0000a600: 6966 6963 2073 7472 6561 6d20 706f 7369  ific stream posi
-0000a610: 7469 6f6e 2074 6f20 7468 6520 656e 6420  tion to the end 
-0000a620: 6f66 2074 6865 2073 7472 6561 6d2e 2053  of the stream. S
-0000a630: 7472 6561 6d20 706f 7369 7469 6f6e 7320  tream positions 
-0000a640: 6172 650a 7a65 726f 2d62 6173 6564 2c20  are.zero-based, 
-0000a650: 616e 6420 736f 2060 7374 7265 616d 5f70  and so `stream_p
-0000a660: 6f73 6974 696f 6e3d 3160 2063 6f72 7265  osition=1` corre
-0000a670: 7370 6f6e 6473 2074 6f20 7468 6520 7365  sponds to the se
-0000a680: 636f 6e64 2065 7665 6e74 2074 6861 7420  cond event that 
-0000a690: 7761 730a 7265 636f 7264 6564 2069 6e20  was.recorded in 
-0000a6a0: 7468 6520 7374 7265 616d 2c20 696e 2074  the stream, in t
-0000a6b0: 6869 7320 6361 7365 2060 6576 656e 7432  his case `event2
-0000a6c0: 602e 0a0a 6060 6070 7974 686f 6e0a 6576  `...```python.ev
-0000a6d0: 656e 7473 203d 2063 6c69 656e 742e 6765  ents = client.ge
-0000a6e0: 745f 7374 7265 616d 280a 2020 2020 7374  t_stream(.    st
-0000a6f0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-0000a700: 5f6e 616d 6531 2c0a 2020 2020 7374 7265  _name1,.    stre
-0000a710: 616d 5f70 6f73 6974 696f 6e3d 312c 0a29  am_position=1,.)
-0000a720: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
-0000a730: 6e74 7329 203d 3d20 320a 6173 7365 7274  nts) == 2.assert
-0000a740: 2065 7665 6e74 735b 305d 2e69 6420 3d3d   events[0].id ==
-0000a750: 2065 7665 6e74 322e 6964 0a61 7373 6572   event2.id.asser
-0000a760: 7420 6576 656e 7473 5b31 5d2e 6964 203d  t events[1].id =
-0000a770: 3d20 6576 656e 7433 2e69 640a 6060 600a  = event3.id.```.
-0000a780: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
-0000a790: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
-0000a7a0: 7573 6520 7468 6520 6062 6163 6b77 6172  use the `backwar
-0000a7b0: 6473 6020 6172 6775 6d65 6e74 2074 6f20  ds` argument to 
-0000a7c0: 7265 6164 2061 2073 7472 6561 6d20 6261  read a stream ba
-0000a7d0: 636b 7761 7264 732e 0a0a 6060 6070 7974  ckwards...```pyt
-0000a7e0: 686f 6e0a 6576 656e 7473 203d 2063 6c69  hon.events = cli
-0000a7f0: 656e 742e 6765 745f 7374 7265 616d 280a  ent.get_stream(.
-0000a800: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-0000a810: 7374 7265 616d 5f6e 616d 6531 2c0a 2020  stream_name1,.  
-0000a820: 2020 6261 636b 7761 7264 733d 5472 7565    backwards=True
-0000a830: 2c0a 290a 0a61 7373 6572 7420 6c65 6e28  ,.)..assert len(
-0000a840: 6576 656e 7473 2920 3d3d 2033 0a61 7373  events) == 3.ass
-0000a850: 6572 7420 6576 656e 7473 5b30 5d2e 6964  ert events[0].id
-0000a860: 203d 3d20 6576 656e 7433 2e69 640a 6173   == event3.id.as
-0000a870: 7365 7274 2065 7665 6e74 735b 315d 2e69  sert events[1].i
-0000a880: 6420 3d3d 2065 7665 6e74 322e 6964 0a61  d == event2.id.a
-0000a890: 7373 6572 7420 6576 656e 7473 5b32 5d2e  ssert events[2].
-0000a8a0: 6964 203d 3d20 6576 656e 7431 2e69 640a  id == event1.id.
-0000a8b0: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
-0000a8c0: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
-0000a8d0: 2074 6f20 7573 6520 7468 6520 606c 696d   to use the `lim
-0000a8e0: 6974 6020 6172 6775 6d65 6e74 2074 6f20  it` argument to 
-0000a8f0: 7265 6164 2061 206c 696d 6974 6564 206e  read a limited n
-0000a900: 756d 6265 7220 6f66 0a65 7665 6e74 732e  umber of.events.
-0000a910: 0a0a 6060 6070 7974 686f 6e0a 6576 656e  ..```python.even
-0000a920: 7473 203d 2063 6c69 656e 742e 6765 745f  ts = client.get_
-0000a930: 7374 7265 616d 280a 2020 2020 7374 7265  stream(.    stre
-0000a940: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-0000a950: 616d 6531 2c0a 2020 2020 6c69 6d69 743d  ame1,.    limit=
-0000a960: 322c 0a29 0a0a 6173 7365 7274 206c 656e  2,.)..assert len
-0000a970: 2865 7665 6e74 7329 203d 3d20 320a 6173  (events) == 2.as
-0000a980: 7365 7274 2065 7665 6e74 735b 305d 2e69  sert events[0].i
-0000a990: 6420 3d3d 2065 7665 6e74 312e 6964 0a61  d == event1.id.a
-0000a9a0: 7373 6572 7420 6576 656e 7473 5b31 5d2e  ssert events[1].
-0000a9b0: 6964 203d 3d20 6576 656e 7432 2e69 640a  id == event2.id.
-0000a9c0: 6060 600a 0a54 6865 2060 7265 6164 5f73  ```..The `read_s
-0000a9d0: 7472 6561 6d28 2960 2061 6e64 2060 6765  tream()` and `ge
-0000a9e0: 745f 7374 7265 616d 2829 6020 6d65 7468  t_stream()` meth
-0000a9f0: 6f64 7320 7769 6c6c 2072 6169 7365 2061  ods will raise a
-0000aa00: 2060 4e6f 7446 6f75 6e64 6020 6578 6365   `NotFound` exce
-0000aa10: 7074 696f 6e20 6966 2074 6865 0a6e 616d  ption if the.nam
-0000aa20: 6564 2073 7472 6561 6d20 6861 7320 6e65  ed stream has ne
-0000aa30: 7665 7220 6578 6973 7465 6420 6f72 2068  ver existed or h
-0000aa40: 6173 2062 6565 6e20 6465 6c65 7465 642e  as been deleted.
-0000aa50: 0a0a 6060 6070 7974 686f 6e0a 6672 6f6d  ..```python.from
-0000aa60: 2065 7364 6263 6c69 656e 742e 6578 6365   esdbclient.exce
-0000aa70: 7074 696f 6e73 2069 6d70 6f72 7420 4e6f  ptions import No
-0000aa80: 7446 6f75 6e64 0a0a 0a74 7279 3a0a 2020  tFound...try:.  
-0000aa90: 2020 636c 6965 6e74 2e67 6574 5f73 7472    client.get_str
-0000aaa0: 6561 6d28 2764 6f65 732d 6e6f 742d 6578  eam('does-not-ex
-0000aab0: 6973 7427 290a 6578 6365 7074 204e 6f74  ist').except Not
-0000aac0: 466f 756e 643a 0a20 2020 2070 6173 7320  Found:.    pass 
-0000aad0: 2023 2054 6865 2073 7472 6561 6d20 646f   # The stream do
-0000aae0: 6573 206e 6f74 2065 7869 7374 2e0a 656c  es not exist..el
-0000aaf0: 7365 3a0a 2020 2020 7261 6973 6520 4578  se:.    raise Ex
-0000ab00: 6365 7074 696f 6e28 2253 686f 756c 646e  ception("Shouldn
-0000ab10: 2774 2067 6574 2068 6572 6522 290a 6060  't get here").``
-0000ab20: 600a 0a50 6c65 6173 6520 6e6f 7465 2c20  `..Please note, 
-0000ab30: 7468 6520 6067 6574 5f73 7472 6561 6d28  the `get_stream(
-0000ab40: 2960 206d 6574 686f 6420 6973 2064 6563  )` method is dec
-0000ab50: 6f72 6174 6564 2077 6974 6820 7468 6520  orated with the 
-0000ab60: 6040 6175 746f 7265 636f 6e6e 6563 7460  `@autoreconnect`
-0000ab70: 2061 6e64 0a60 4072 6574 7279 6772 7063   and.`@retrygrpc
-0000ab80: 6020 6465 636f 7261 746f 7273 2c20 7768  ` decorators, wh
-0000ab90: 696c 7374 2074 6865 2060 7265 6164 5f73  ilst the `read_s
-0000aba0: 7472 6561 6d28 2960 206d 6574 686f 6420  tream()` method 
-0000abb0: 6973 206e 6f74 2e20 5468 6973 206d 6561  is not. This mea
-0000abc0: 6e73 2074 6861 740a 616c 6c20 6572 726f  ns that.all erro
-0000abd0: 7273 2064 7565 2074 6f20 636f 6e6e 6563  rs due to connec
-0000abe0: 7469 6f6e 2069 7373 7565 7320 7769 6c6c  tion issues will
-0000abf0: 2062 6520 6361 7567 6874 2062 7920 7468   be caught by th
-0000ac00: 6520 7265 7472 7920 616e 6420 7265 636f  e retry and reco
-0000ac10: 6e6e 6563 7420 6465 636f 7261 746f 7273  nnect decorators
-0000ac20: 0a77 6865 6e20 6361 6c6c 696e 6720 7468  .when calling th
-0000ac30: 6520 6067 6574 5f73 7472 6561 6d28 2960  e `get_stream()`
-0000ac40: 206d 6574 686f 642c 2062 7574 206e 6f74   method, but not
-0000ac50: 2077 6865 6e20 6361 6c6c 696e 6720 6072   when calling `r
-0000ac60: 6561 645f 7374 7265 616d 2829 602e 2054  ead_stream()`. T
-0000ac70: 6865 0a60 7265 6164 5f73 7472 6561 6d28  he.`read_stream(
-0000ac80: 2960 206d 6574 686f 6420 6861 7320 6e6f  )` method has no
-0000ac90: 2073 7563 6820 6465 636f 7261 746f 7273   such decorators
-0000aca0: 2062 6563 6175 7365 2074 6865 2073 7472   because the str
-0000acb0: 6561 6d69 6e67 206f 6e6c 7920 7374 6172  eaming only star
-0000acc0: 7473 0a77 6865 6e20 6974 6572 6174 696e  ts.when iteratin
-0000acd0: 6720 6f76 6572 2074 6865 2022 7265 6164  g over the "read
-0000ace0: 2072 6573 706f 6e73 6522 2073 7461 7274   response" start
-0000acf0: 732c 2077 6869 6368 206d 6561 6e73 2074  s, which means t
-0000ad00: 6861 7420 7468 6520 6d65 7468 6f64 2072  hat the method r
-0000ad10: 6574 7572 6e73 0a62 6566 6f72 6520 7468  eturns.before th
-0000ad20: 6520 7374 7265 616d 696e 6720 7374 6172  e streaming star
-0000ad30: 7473 2c20 616e 6420 736f 2074 6865 7265  ts, and so there
-0000ad40: 2069 7320 6e6f 2063 6861 6e63 6520 666f   is no chance fo
-0000ad50: 7220 616e 7920 6465 636f 7261 746f 7273  r any decorators
-0000ad60: 2074 6f20 6361 7463 680a 616e 7920 636f   to catch.any co
-0000ad70: 6e6e 6563 7469 6f6e 2069 7373 7565 732e  nnection issues.
-0000ad80: 0a0a 466f 7220 7468 6520 7361 6d65 2072  ..For the same r
-0000ad90: 6561 736f 6e2c 2060 7265 6164 5f73 7472  eason, `read_str
-0000ada0: 6561 6d28 2960 2077 696c 6c20 6e6f 7420  eam()` will not 
-0000adb0: 7261 6973 6520 6120 604e 6f74 466f 756e  raise a `NotFoun
-0000adc0: 6460 2065 7863 6570 7469 6f6e 2077 6865  d` exception whe
-0000add0: 6e0a 7468 6520 7374 7265 616d 2064 6f65  n.the stream doe
-0000ade0: 7320 6e6f 7420 6578 6973 742c 2075 6e74  s not exist, unt
-0000adf0: 696c 2069 7465 7261 7469 6e67 206f 7665  il iterating ove
-0000ae00: 7220 7468 6520 2272 6561 6420 7265 7370  r the "read resp
-0000ae10: 6f6e 7365 2220 6f62 6a65 6374 2062 6567  onse" object beg
-0000ae20: 696e 732e 0a0a 4966 2079 6f75 2061 7265  ins...If you are
-0000ae30: 2072 6561 6469 6e67 2061 2076 6572 7920   reading a very 
-0000ae40: 6c61 7267 6520 7374 7265 616d 2c20 7468  large stream, th
-0000ae50: 656e 2079 6f75 206d 6967 6874 2070 7265  en you might pre
-0000ae60: 6665 7220 746f 2063 616c 6c20 6072 6561  fer to call `rea
-0000ae70: 645f 7374 7265 616d 2829 602c 0a61 6e64  d_stream()`,.and
-0000ae80: 2062 6567 696e 2069 7465 7261 7469 6e67   begin iterating
-0000ae90: 2074 6872 6f75 6768 2074 6865 2072 6563   through the rec
-0000aea0: 6f72 6465 6420 6576 656e 7473 2077 6869  orded events whi
-0000aeb0: 6c73 7420 7468 6579 2061 7265 2062 6569  lst they are bei
-0000aec0: 6e67 2073 7472 6561 6d65 6420 6672 6f6d  ng streamed from
-0000aed0: 0a74 6865 2073 6572 7665 722c 2072 6174  .the server, rat
-0000aee0: 6865 7220 7468 616e 2062 6f74 6820 7761  her than both wa
-0000aef0: 6974 696e 6720 616e 6420 6861 7669 6e67  iting and having
-0000af00: 2074 6865 6d20 616c 6c20 6163 6375 6d75   them all accumu
-0000af10: 6c61 7465 2069 6e20 6d65 6d6f 7279 2e0a  late in memory..
-0000af20: 0a23 2323 2047 6574 2063 7572 7265 6e74  .### Get current
-0000af30: 2076 6572 7369 6f6e 0a0a 5468 6520 6067   version..The `g
-0000af40: 6574 5f63 7572 7265 6e74 5f76 6572 7369  et_current_versi
-0000af50: 6f6e 2829 6020 6d65 7468 6f64 2069 7320  on()` method is 
-0000af60: 6120 636f 6e76 656e 6965 6e63 6520 6d65  a convenience me
-0000af70: 7468 6f64 2074 6861 7420 6573 7365 6e74  thod that essent
-0000af80: 6961 6c6c 7920 6361 6c6c 730a 6067 6574  ially calls.`get
-0000af90: 5f73 7472 6561 6d28 2960 2077 6974 6820  _stream()` with 
-0000afa0: 6062 6163 6b77 6172 6473 3d54 7275 6560  `backwards=True`
-0000afb0: 2061 6e64 2060 6c69 6d69 743d 3160 2e20   and `limit=1`. 
-0000afc0: 5468 6973 206d 6574 686f 6420 7265 7475  This method retu
-0000afd0: 726e 730a 7468 6520 7661 6c75 6520 6f66  rns.the value of
-0000afe0: 2074 6865 2060 7374 7265 616d 5f70 6f73   the `stream_pos
-0000aff0: 6974 696f 6e60 2061 7474 7269 6275 7465  ition` attribute
-0000b000: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
-0000b010: 6f72 6465 6420 6576 656e 7420 696e 2061  orded event in a
-0000b020: 0a73 7472 6561 6d2e 2049 6620 6120 7374  .stream. If a st
-0000b030: 7265 616d 2064 6f65 7320 6e6f 7420 6578  ream does not ex
-0000b040: 6973 742c 2074 6865 2072 6574 7572 6e65  ist, the returne
-0000b050: 6420 7661 6c75 6520 6973 2060 5374 7265  d value is `Stre
-0000b060: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
-0000b070: 4d60 2e0a 5468 6520 7265 7475 726e 6564  M`..The returned
-0000b080: 2076 616c 7565 2069 7320 7468 6520 636f   value is the co
-0000b090: 7272 6563 7420 7661 6c75 6520 6f66 2060  rrect value of `
-0000b0a0: 6375 7272 656e 745f 7665 7273 696f 6e60  current_version`
-0000b0b0: 2077 6865 6e20 6170 7065 6e64 696e 6720   when appending 
-0000b0c0: 6576 656e 7473 0a74 6f20 6120 7374 7265  events.to a stre
-0000b0d0: 616d 2c20 616e 6420 7768 656e 2064 656c  am, and when del
-0000b0e0: 6574 696e 6720 6f72 2074 6f6d 6273 746f  eting or tombsto
-0000b0f0: 6e69 6e67 2061 2073 7472 6561 6d2e 0a0a  ning a stream...
-0000b100: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
-0000b110: 6f6e 6520 7265 7175 6972 6564 2061 7267  one required arg
-0000b120: 756d 656e 742c 2060 7374 7265 616d 5f6e  ument, `stream_n
-0000b130: 616d 6560 2e0a 0a54 6865 2072 6571 7569  ame`...The requi
-0000b140: 7265 6420 6073 7472 6561 6d5f 6e61 6d65  red `stream_name
-0000b150: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-0000b160: 5079 7468 6f6e 2060 7374 7260 2074 6861  Python `str` tha
-0000b170: 7420 756e 6971 7565 6c79 2069 6465 6e74  t uniquely ident
-0000b180: 6966 6965 7320 610a 7374 7265 616d 2066  ifies a.stream f
-0000b190: 726f 6d20 7768 6963 6820 6120 7374 7265  rom which a stre
-0000b1a0: 616d 2070 6f73 6974 696f 6e20 7769 6c6c  am position will
-0000b1b0: 2062 6520 7265 7475 726e 6564 2e0a 0a54   be returned...T
-0000b1c0: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
-0000b1d0: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
-0000b1e0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-0000b1f0: 6e74 2c20 7468 6174 0a69 7320 6578 7065  nt, that.is expe
-0000b200: 6374 6564 2074 6f20 6265 2061 2050 7974  cted to be a Pyt
-0000b210: 686f 6e20 6066 6c6f 6174 602c 2077 6869  hon `float`, whi
-0000b220: 6368 2073 6574 7320 6120 6465 6164 6c69  ch sets a deadli
-0000b230: 6e65 0a66 6f72 2074 6865 2063 6f6d 706c  ne.for the compl
-0000b240: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
-0000b250: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
-0000b260: 6973 206d 6574 686f 6420 616c 736f 2068  is method also h
-0000b270: 6173 2061 6e20 6f70 7469 6f6e 616c 2060  as an optional `
-0000b280: 6372 6564 656e 7469 616c 7360 2061 7267  credentials` arg
-0000b290: 756d 656e 742c 2077 6869 6368 2063 616e  ument, which can
-0000b2a0: 2062 6520 7573 6564 2074 6f0a 6f76 6572   be used to.over
-0000b2b0: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
-0000b2c0: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
-0000b2d0: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
-0000b2e0: 6e20 7374 7269 6e67 2055 5249 2e0a 0a49  n string URI...I
-0000b2f0: 6e20 7468 6520 6578 616d 706c 6520 6265  n the example be
-0000b300: 6c6f 772c 2074 6865 206c 6173 7420 7374  low, the last st
-0000b310: 7265 616d 2070 6f73 6974 696f 6e20 6f66  ream position of
-0000b320: 2060 7374 7265 616d 5f6e 616d 6531 6020   `stream_name1` 
-0000b330: 6973 206f 6274 6169 6e65 642e 0a53 696e  is obtained..Sin
-0000b340: 6365 2074 6872 6565 2065 7665 6e74 7320  ce three events 
-0000b350: 6861 7665 2062 6565 6e20 6170 7065 6e64  have been append
-0000b360: 6564 2074 6f20 6073 7472 6561 6d5f 6e61  ed to `stream_na
-0000b370: 6d65 3160 2c20 616e 6420 6265 6361 7573  me1`, and becaus
-0000b380: 6520 706f 7369 7469 6f6e 730a 696e 2061  e positions.in a
-0000b390: 2073 7472 6561 6d20 6172 6520 7a65 726f   stream are zero
-0000b3a0: 2d62 6173 6564 2061 6e64 2067 6170 6c65  -based and gaple
-0000b3b0: 7373 2c20 736f 2074 6865 2063 7572 7265  ss, so the curre
-0000b3c0: 6e74 2076 6572 7369 6f6e 2069 7320 6032  nt version is `2
-0000b3d0: 602e 0a0a 6060 6070 7974 686f 6e0a 6375  `...```python.cu
-0000b3e0: 7272 656e 745f 7665 7273 696f 6e20 3d20  rrent_version = 
-0000b3f0: 636c 6965 6e74 2e67 6574 5f63 7572 7265  client.get_curre
-0000b400: 6e74 5f76 6572 7369 6f6e 280a 2020 2020  nt_version(.    
-0000b410: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-0000b420: 616d 5f6e 616d 6531 0a29 0a0a 6173 7365  am_name1.)..asse
-0000b430: 7274 2063 7572 7265 6e74 5f76 6572 7369  rt current_versi
-0000b440: 6f6e 203d 3d20 320a 6060 600a 0a49 6620  on == 2.```..If 
-0000b450: 6120 7374 7265 616d 2068 6173 206e 6576  a stream has nev
-0000b460: 6572 2065 7869 7374 6564 206f 7220 6861  er existed or ha
-0000b470: 7320 6265 656e 2064 656c 6574 6564 2c20  s been deleted, 
-0000b480: 7468 6520 7265 7475 726e 6564 2076 616c  the returned val
-0000b490: 7565 2069 730a 6053 7472 6561 6d53 7461  ue is.`StreamSta
-0000b4a0: 7465 2e4e 4f5f 5354 5245 414d 602c 2077  te.NO_STREAM`, w
-0000b4b0: 6869 6368 2069 7320 7468 6520 636f 7272  hich is the corr
-0000b4c0: 6563 7420 7661 6c75 6520 6f66 2074 6865  ect value of the
-0000b4d0: 2060 6375 7272 656e 745f 7665 7273 696f   `current_versio
-0000b4e0: 6e60 0a61 7267 756d 656e 7420 626f 7468  n`.argument both
-0000b4f0: 2077 6865 6e20 6170 7065 6e64 696e 6720   when appending 
-0000b500: 7468 6520 6669 7273 7420 6576 656e 7420  the first event 
-0000b510: 6f66 2061 206e 6577 2073 7472 6561 6d2c  of a new stream,
-0000b520: 2061 6e64 2061 6c73 6f20 7768 656e 0a61   and also when.a
-0000b530: 7070 656e 6469 6e67 2065 7665 6e74 7320  ppending events 
-0000b540: 746f 2061 2073 7472 6561 6d20 7468 6174  to a stream that
-0000b550: 2068 6173 2062 6565 6e20 6465 6c65 7465   has been delete
-0000b560: 642e 0a0a 6060 6070 7974 686f 6e0a 6375  d...```python.cu
-0000b570: 7272 656e 745f 7665 7273 696f 6e20 3d20  rrent_version = 
-0000b580: 636c 6965 6e74 2e67 6574 5f63 7572 7265  client.get_curre
-0000b590: 6e74 5f76 6572 7369 6f6e 280a 2020 2020  nt_version(.    
-0000b5a0: 7374 7265 616d 5f6e 616d 653d 2764 6f65  stream_name='doe
-0000b5b0: 732d 6e6f 742d 6578 6973 7427 0a29 0a0a  s-not-exist'.)..
-0000b5c0: 6173 7365 7274 2063 7572 7265 6e74 5f76  assert current_v
-0000b5d0: 6572 7369 6f6e 2069 7320 5374 7265 616d  ersion is Stream
-0000b5e0: 5374 6174 652e 4e4f 5f53 5452 4541 4d0a  State.NO_STREAM.
-0000b5f0: 6060 600a 0a23 2323 2048 6f77 2074 6f20  ```..### How to 
-0000b600: 696d 706c 656d 656e 7420 736e 6170 7368  implement snapsh
-0000b610: 6f74 7469 6e67 2077 6974 6820 4576 656e  otting with Even
-0000b620: 7453 746f 7265 4442 0a0a 536e 6170 7368  tStoreDB..Snapsh
-0000b630: 6f74 7320 6361 6e20 696d 7072 6f76 6520  ots can improve 
-0000b640: 7468 6520 7065 7266 6f72 6d61 6e63 6520  the performance 
-0000b650: 6f66 2061 6767 7265 6761 7465 7320 7468  of aggregates th
-0000b660: 6174 2077 6f75 6c64 206f 7468 6572 7769  at would otherwi
-0000b670: 7365 2062 650a 7265 636f 6e73 7472 7563  se be.reconstruc
-0000b680: 7465 6420 6672 6f6d 2076 6572 7920 6c6f  ted from very lo
-0000b690: 6e67 2073 7472 6561 6d73 2e20 486f 7765  ng streams. Howe
-0000b6a0: 7665 722c 2069 7420 6973 2067 656e 6572  ver, it is gener
-0000b6b0: 616c 6c79 2072 6563 6f6d 6d65 6e64 6564  ally recommended
-0000b6c0: 2074 6f20 6465 7369 676e 0a61 6767 7265   to design.aggre
-0000b6d0: 6761 7465 7320 746f 2068 6176 6520 6120  gates to have a 
-0000b6e0: 6669 6e69 7465 206c 6966 6563 7963 6c65  finite lifecycle
-0000b6f0: 2c20 616e 6420 736f 2074 6f20 6861 7665  , and so to have
-0000b700: 2072 656c 6174 6976 656c 7920 7368 6f72   relatively shor
-0000b710: 7420 7374 7265 616d 732c 0a74 6865 7265  t streams,.there
-0000b720: 6279 2061 766f 6964 696e 6720 7468 6520  by avoiding the 
-0000b730: 6e65 6564 2066 6f72 2073 6e61 7073 686f  need for snapsho
-0000b740: 7474 696e 672e 2054 6869 7320 2268 6f77  tting. This "how
-0000b750: 2074 6f22 2073 6563 7469 6f6e 2069 7320   to" section is 
-0000b760: 696e 7465 6e64 6564 206d 6572 656c 790a  intended merely.
-0000b770: 746f 2073 686f 7720 686f 7720 736e 6170  to show how snap
-0000b780: 7368 6f74 7469 6e67 206f 6620 6167 6772  shotting of aggr
-0000b790: 6567 6174 6573 2063 616e 2062 6520 696d  egates can be im
-0000b7a0: 706c 656d 656e 7465 6420 7769 7468 2045  plemented with E
-0000b7b0: 7665 6e74 5374 6f72 6544 4220 7573 696e  ventStoreDB usin
-0000b7c0: 670a 7468 6973 2050 7974 686f 6e20 636c  g.this Python cl
-0000b7d0: 6965 6e74 2e0a 0a45 7665 6e74 2d73 6f75  ient...Event-sou
-0000b7e0: 7263 6564 2061 6767 7265 6761 7465 7320  rced aggregates 
-0000b7f0: 6172 6520 7479 7069 6361 6c6c 7920 7265  are typically re
-0000b800: 636f 6e73 7472 7563 7465 6420 6672 6f6d  constructed from
-0000b810: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-0000b820: 2062 7920 6361 6c6c 696e 670a 6120 6d75   by calling.a mu
-0000b830: 7461 746f 7220 6675 6e63 7469 6f6e 2066  tator function f
-0000b840: 6f72 2065 6163 6820 7265 636f 7264 6564  or each recorded
-0000b850: 2065 7665 6e74 2c20 6576 6f6c 7669 6e67   event, evolving
-0000b860: 2066 726f 6d20 616e 2069 6e69 7469 616c   from an initial
-0000b870: 2073 7461 7465 0a60 4e6f 6e65 6020 746f   state.`None` to
-0000b880: 2074 6865 2063 7572 7265 6e74 2073 7461   the current sta
-0000b890: 7465 206f 6620 7468 6520 6167 6772 6567  te of the aggreg
-0000b8a0: 6174 652e 2054 6865 2066 756e 6374 696f  ate. The functio
-0000b8b0: 6e20 6067 6574 5f61 6767 7265 6761 7465  n `get_aggregate
-0000b8c0: 2829 6020 7368 6f77 730a 686f 7720 7468  ()` shows.how th
-0000b8d0: 6973 2063 616e 2062 6520 646f 6e65 2e20  is can be done. 
-0000b8e0: 5468 6520 6167 6772 6567 6174 6520 4944  The aggregate ID
-0000b8f0: 2069 7320 7573 6564 2061 7320 6120 7374   is used as a st
-0000b900: 7265 616d 206e 616d 652e 2054 6865 2065  ream name. The e
-0000b910: 7863 6570 7469 6f6e 0a60 4167 6772 6567  xception.`Aggreg
-0000b920: 6174 654e 6f74 466f 756e 6460 2069 7320  ateNotFound` is 
-0000b930: 7261 6973 6564 2069 6620 7468 6520 6167  raised if the ag
-0000b940: 6772 6567 6174 6520 7374 7265 616d 2069  gregate stream i
-0000b950: 7320 6e6f 7420 666f 756e 642e 0a0a 6060  s not found...``
-0000b960: 6070 7974 686f 6e0a 636c 6173 7320 4167  `python.class Ag
-0000b970: 6772 6567 6174 654e 6f74 466f 756e 6428  gregateNotFound(
-0000b980: 4578 6365 7074 696f 6e29 3a0a 2020 2020  Exception):.    
-0000b990: 2222 2252 6169 7365 6420 7768 656e 2061  """Raised when a
-0000b9a0: 6e20 6167 6772 6567 6174 6520 6973 206e  n aggregate is n
-0000b9b0: 6f74 2066 6f75 6e64 2e22 2222 0a0a 0a64  ot found."""...d
-0000b9c0: 6566 2067 6574 5f61 6767 7265 6761 7465  ef get_aggregate
-0000b9d0: 2861 6767 7265 6761 7465 5f69 642c 206d  (aggregate_id, m
-0000b9e0: 7574 6174 6f72 5f66 756e 6329 3a0a 2020  utator_func):.  
-0000b9f0: 2020 7374 7265 616d 5f6e 616d 6520 3d20    stream_name = 
-0000ba00: 6167 6772 6567 6174 655f 6964 0a0a 2020  aggregate_id..  
-0000ba10: 2020 2320 4765 7420 7265 636f 7264 6564    # Get recorded
-0000ba20: 2065 7665 6e74 732e 0a20 2020 2074 7279   events..    try
-0000ba30: 3a0a 2020 2020 2020 2020 6576 656e 7473  :.        events
-0000ba40: 203d 2063 6c69 656e 742e 6765 745f 7374   = client.get_st
-0000ba50: 7265 616d 280a 2020 2020 2020 2020 2020  ream(.          
-0000ba60: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-0000ba70: 7265 616d 5f6e 616d 652c 0a20 2020 2020  ream_name,.     
-0000ba80: 2020 2020 2020 2073 7472 6561 6d5f 706f         stream_po
-0000ba90: 7369 7469 6f6e 3d4e 6f6e 650a 2020 2020  sition=None.    
-0000baa0: 2020 2020 290a 2020 2020 6578 6365 7074      ).    except
-0000bab0: 204e 6f74 466f 756e 6420 6173 2065 3a0a   NotFound as e:.
-0000bac0: 2020 2020 2020 2020 7261 6973 6520 4167          raise Ag
-0000bad0: 6772 6567 6174 654e 6f74 466f 756e 6428  gregateNotFound(
-0000bae0: 6167 6772 6567 6174 655f 6964 2920 6672  aggregate_id) fr
-0000baf0: 6f6d 2065 0a20 2020 2065 6c73 653a 0a20  om e.    else:. 
-0000bb00: 2020 2020 2020 2023 2052 6563 6f6e 7374         # Reconst
-0000bb10: 7275 6374 2061 6767 7265 6761 7465 2066  ruct aggregate f
-0000bb20: 726f 6d20 7265 636f 7264 6564 2065 7665  rom recorded eve
-0000bb30: 6e74 732e 0a20 2020 2020 2020 2061 6767  nts..        agg
-0000bb40: 7265 6761 7465 203d 204e 6f6e 650a 2020  regate = None.  
-0000bb50: 2020 2020 2020 666f 7220 6576 656e 7420        for event 
-0000bb60: 696e 2065 7665 6e74 733a 0a20 2020 2020  in events:.     
-0000bb70: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
-0000bb80: 203d 206d 7574 6174 6f72 5f66 756e 6328   = mutator_func(
-0000bb90: 6167 6772 6567 6174 652c 2065 7665 6e74  aggregate, event
-0000bba0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000bbb0: 2061 6767 7265 6761 7465 0a60 6060 0a0a   aggregate.```..
-0000bbc0: 536e 6170 7368 6f74 7469 6e67 206f 6620  Snapshotting of 
-0000bbd0: 6167 6772 6567 6174 6573 2063 616e 2062  aggregates can b
-0000bbe0: 6520 696d 706c 656d 656e 7465 6420 6279  e implemented by
-0000bbf0: 2072 6563 6f72 6469 6e67 2074 6865 2063   recording the c
-0000bc00: 7572 7265 6e74 2073 7461 7465 206f 660a  urrent state of.
-0000bc10: 616e 2061 6767 7265 6761 7465 2061 7320  an aggregate as 
-0000bc20: 6120 6e65 7720 6576 656e 742e 0a0a 4966  a new event...If
-0000bc30: 2061 6e20 6167 6772 6567 6174 6520 6f62   an aggregate ob
-0000bc40: 6a65 6374 2068 6173 2061 2076 6572 7369  ject has a versi
-0000bc50: 6f6e 206e 756d 6265 7220 7468 6174 2063  on number that c
-0000bc60: 6f72 7265 7370 6f6e 6473 2074 6f20 7468  orresponds to th
-0000bc70: 6520 7374 7265 616d 2070 6f73 6974 696f  e stream positio
-0000bc80: 6e20 6f66 0a74 6865 206c 6173 7420 6576  n of.the last ev
-0000bc90: 656e 7420 7468 6174 2077 6173 2075 7365  ent that was use
-0000bca0: 6420 746f 2072 6563 6f6e 7374 7275 6374  d to reconstruct
-0000bcb0: 2074 6865 2061 6767 7265 6761 7465 2c20   the aggregate, 
-0000bcc0: 616e 6420 7468 6973 2076 6572 7369 6f6e  and this version
-0000bcd0: 206e 756d 6265 720a 6973 2072 6563 6f72   number.is recor
-0000bce0: 6465 6420 696e 2074 6865 2073 6e61 7073  ded in the snaps
-0000bcf0: 686f 7420 6d65 7461 6461 7461 2c20 7468  hot metadata, th
-0000bd00: 656e 2061 6e79 2065 7665 6e74 7320 7468  en any events th
-0000bd10: 6174 2061 7265 2072 6563 6f72 6465 6420  at are recorded 
-0000bd20: 6166 7465 7220 7468 650a 736e 6170 7368  after the.snapsh
-0000bd30: 6f74 2063 616e 2062 6520 7365 6c65 6374  ot can be select
-0000bd40: 6564 2075 7369 6e67 2074 6869 7320 7665  ed using this ve
-0000bd50: 7273 696f 6e20 6e75 6d62 6572 2e20 5468  rsion number. Th
-0000bd60: 6520 6167 6772 6567 6174 6520 6361 6e20  e aggregate can 
-0000bd70: 7468 656e 2062 650a 7265 636f 6e73 7472  then be.reconstr
-0000bd80: 7563 7465 6420 6672 6f6d 2074 6865 206c  ucted from the l
-0000bd90: 6173 7420 736e 6170 7368 6f74 2061 6e64  ast snapshot and
-0000bda0: 2061 6e79 2073 7562 7365 7175 656e 7420   any subsequent 
-0000bdb0: 6576 656e 7473 2c20 7769 7468 6f75 7420  events, without 
-0000bdc0: 6861 7669 6e67 0a74 6f20 7265 706c 6179  having.to replay
-0000bdd0: 2074 6865 2065 6e74 6972 6520 6869 7374   the entire hist
-0000bde0: 6f72 792e 0a0a 5765 2077 696c 6c20 7573  ory...We will us
-0000bdf0: 6520 6120 7365 7061 7261 7465 2073 7472  e a separate str
-0000be00: 6561 6d20 666f 7220 616e 2061 6767 7265  eam for an aggre
-0000be10: 6761 7465 2773 2073 6e61 7073 686f 7473  gate's snapshots
-0000be20: 2074 6861 7420 6973 206e 616d 6564 2061   that is named a
-0000be30: 6674 6572 2074 6865 0a73 7472 6561 6d20  fter the.stream 
-0000be40: 7573 6564 2066 6f72 2072 6563 6f72 6469  used for recordi
-0000be50: 6e67 2069 7473 2065 7665 6e74 732e 2054  ng its events. T
-0000be60: 6865 206e 616d 6520 6f66 2074 6865 2073  he name of the s
-0000be70: 6e61 7073 686f 7420 7374 7265 616d 2077  napshot stream w
-0000be80: 696c 6c20 6265 0a63 6f6e 7374 7275 6374  ill be.construct
-0000be90: 6564 2062 7920 7072 6566 6978 696e 6720  ed by prefixing 
-0000bea0: 7468 6520 6167 6772 6567 6174 6527 7320  the aggregate's 
-0000beb0: 7374 7265 616d 206e 616d 6520 7769 7468  stream name with
-0000bec0: 2060 2773 6e61 7073 686f 742d 2427 602e   `'snapshot-$'`.
-0000bed0: 0a0a 6060 6070 7974 686f 6e0a 534e 4150  ..```python.SNAP
-0000bee0: 5348 4f54 5f53 5452 4541 4d5f 4e41 4d45  SHOT_STREAM_NAME
-0000bef0: 5f50 5245 4649 5820 3d20 2773 6e61 7073  _PREFIX = 'snaps
-0000bf00: 686f 742d 2427 0a0a 6465 6620 6d61 6b65  hot-$'..def make
-0000bf10: 5f73 6e61 7073 686f 745f 7374 7265 616d  _snapshot_stream
-0000bf20: 5f6e 616d 6528 7374 7265 616d 5f6e 616d  _name(stream_nam
-0000bf30: 6529 3a0a 2020 2020 7265 7475 726e 2066  e):.    return f
-0000bf40: 277b 534e 4150 5348 4f54 5f53 5452 4541  '{SNAPSHOT_STREA
-0000bf50: 4d5f 4e41 4d45 5f50 5245 4649 587d 7b73  M_NAME_PREFIX}{s
-0000bf60: 7472 6561 6d5f 6e61 6d65 7d27 0a0a 0a64  tream_name}'...d
-0000bf70: 6566 2072 656d 6f76 655f 736e 6170 7368  ef remove_snapsh
-0000bf80: 6f74 5f73 7472 6561 6d5f 7072 6566 6978  ot_stream_prefix
-0000bf90: 2873 6e61 7073 686f 745f 7374 7265 616d  (snapshot_stream
-0000bfa0: 5f6e 616d 6529 3a0a 2020 2020 6173 7365  _name):.    asse
-0000bfb0: 7274 2073 6e61 7073 686f 745f 7374 7265  rt snapshot_stre
-0000bfc0: 616d 5f6e 616d 652e 7374 6172 7473 7769  am_name.startswi
-0000bfd0: 7468 2853 4e41 5053 484f 545f 5354 5245  th(SNAPSHOT_STRE
-0000bfe0: 414d 5f4e 414d 455f 5052 4546 4958 290a  AM_NAME_PREFIX).
-0000bff0: 2020 2020 7265 7475 726e 2073 6e61 7073      return snaps
-0000c000: 686f 745f 7374 7265 616d 5f6e 616d 655b  hot_stream_name[
-0000c010: 6c65 6e28 534e 4150 5348 4f54 5f53 5452  len(SNAPSHOT_STR
-0000c020: 4541 4d5f 4e41 4d45 5f50 5245 4649 5829  EAM_NAME_PREFIX)
-0000c030: 3a5d 0a60 6060 0a0a 4e6f 772c 206c 6574  :].```..Now, let
-0000c040: 2773 2072 6564 6566 696e 6520 7468 6520  's redefine the 
-0000c050: 6067 6574 5f61 6767 7265 6761 7465 2829  `get_aggregate()
-0000c060: 6020 6675 6e63 7469 6f6e 2c20 736f 2074  ` function, so t
-0000c070: 6861 7420 6974 206c 6f6f 6b73 2066 6f72  hat it looks for
-0000c080: 2061 2073 6e61 7073 686f 7420 6576 656e   a snapshot even
-0000c090: 742c 0a74 6865 6e20 7365 6c65 6374 7320  t,.then selects 
-0000c0a0: 7375 6273 6571 7565 6e74 2061 6767 7265  subsequent aggre
-0000c0b0: 6761 7465 2065 7665 6e74 732c 2061 6e64  gate events, and
-0000c0c0: 2074 6865 6e20 6361 6c6c 7320 6120 6d75   then calls a mu
-0000c0d0: 7461 746f 7220 6675 6e63 7469 6f6e 2066  tator function f
-0000c0e0: 6f72 2065 6163 680a 7265 636f 7264 6564  or each.recorded
-0000c0f0: 2065 7665 6e74 2e0a 0a4e 6f74 6963 6520   event...Notice 
-0000c100: 7468 6174 2074 6865 2061 6767 7265 6761  that the aggrega
-0000c110: 7465 2065 7665 6e74 7320 6172 6520 7265  te events are re
-0000c120: 6164 2066 726f 6d20 6120 7374 7265 616d  ad from a stream
-0000c130: 2066 6f72 2073 6572 6961 6c69 7a65 6420   for serialized 
-0000c140: 6167 6772 6567 6174 650a 6576 656e 7473  aggregate.events
-0000c150: 2c20 7768 696c 7374 2074 6865 2073 6e61  , whilst the sna
-0000c160: 7073 686f 7420 6973 2072 6561 6420 6672  pshot is read fr
-0000c170: 6f6d 2061 2073 6570 6172 6174 6520 7374  om a separate st
-0000c180: 7265 616d 2066 6f72 2073 6572 6961 6c69  ream for seriali
-0000c190: 7a65 6420 6167 6772 6567 6174 650a 736e  zed aggregate.sn
-0000c1a0: 6170 7368 6f74 732e 2057 6520 7769 6c6c  apshots. We will
-0000c1b0: 2075 7365 204a 534f 4e20 746f 2073 6572   use JSON to ser
-0000c1c0: 6961 6c69 7a65 2061 6e64 2064 6573 6572  ialize and deser
-0000c1d0: 6961 6c69 7a65 2065 7665 6e74 2064 6174  ialize event dat
-0000c1e0: 612e 0a0a 0a60 6060 7079 7468 6f6e 0a69  a....```python.i
-0000c1f0: 6d70 6f72 7420 6a73 6f6e 0a0a 0a64 6566  mport json...def
-0000c200: 2067 6574 5f61 6767 7265 6761 7465 2861   get_aggregate(a
-0000c210: 6767 7265 6761 7465 5f69 642c 206d 7574  ggregate_id, mut
-0000c220: 6174 6f72 5f66 756e 6329 3a0a 2020 2020  ator_func):.    
-0000c230: 7374 7265 616d 5f6e 616d 6520 3d20 6167  stream_name = ag
-0000c240: 6772 6567 6174 655f 6964 0a20 2020 2072  gregate_id.    r
-0000c250: 6563 6f72 6465 645f 6576 656e 7473 203d  ecorded_events =
-0000c260: 205b 5d0a 0a20 2020 2023 204c 6f6f 6b20   []..    # Look 
-0000c270: 666f 7220 6120 736e 6170 7368 6f74 2e0a  for a snapshot..
-0000c280: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0000c290: 2073 6e61 7073 686f 7473 203d 2063 6c69   snapshots = cli
-0000c2a0: 656e 742e 6765 745f 7374 7265 616d 280a  ent.get_stream(.
-0000c2b0: 2020 2020 2020 2020 2020 2020 7374 7265              stre
-0000c2c0: 616d 5f6e 616d 653d 6d61 6b65 5f73 6e61  am_name=make_sna
-0000c2d0: 7073 686f 745f 7374 7265 616d 5f6e 616d  pshot_stream_nam
-0000c2e0: 6528 7374 7265 616d 5f6e 616d 6529 2c0a  e(stream_name),.
-0000c2f0: 2020 2020 2020 2020 2020 2020 6261 636b              back
-0000c300: 7761 7264 733d 5472 7565 2c0a 2020 2020  wards=True,.    
-0000c310: 2020 2020 2020 2020 6c69 6d69 743d 310a          limit=1.
-0000c320: 2020 2020 2020 2020 290a 2020 2020 6578          ).    ex
-0000c330: 6365 7074 204e 6f74 466f 756e 643a 0a20  cept NotFound:. 
-0000c340: 2020 2020 2020 2073 7472 6561 6d5f 706f         stream_po
-0000c350: 7369 7469 6f6e 203d 204e 6f6e 650a 2020  sition = None.  
-0000c360: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000c370: 6173 7365 7274 206c 656e 2873 6e61 7073  assert len(snaps
-0000c380: 686f 7473 2920 3d3d 2031 0a20 2020 2020  hots) == 1.     
-0000c390: 2020 2073 6e61 7073 686f 7420 3d20 736e     snapshot = sn
-0000c3a0: 6170 7368 6f74 735b 305d 0a20 2020 2020  apshots[0].     
-0000c3b0: 2020 2073 7472 6561 6d5f 706f 7369 7469     stream_positi
-0000c3c0: 6f6e 203d 2064 6573 6572 6961 6c69 7a65  on = deserialize
-0000c3d0: 2873 6e61 7073 686f 742e 6d65 7461 6461  (snapshot.metada
-0000c3e0: 7461 295b 2776 6572 7369 6f6e 275d 202b  ta)['version'] +
-0000c3f0: 2031 0a20 2020 2020 2020 2072 6563 6f72   1.        recor
-0000c400: 6465 645f 6576 656e 7473 2e61 7070 656e  ded_events.appen
-0000c410: 6428 736e 6170 7368 6f74 290a 0a20 2020  d(snapshot)..   
-0000c420: 2023 2047 6574 2073 7562 7365 7175 656e   # Get subsequen
-0000c430: 7420 6576 656e 7473 2e0a 2020 2020 7472  t events..    tr
-0000c440: 793a 0a20 2020 2020 2020 2065 7665 6e74  y:.        event
-0000c450: 7320 3d20 636c 6965 6e74 2e67 6574 5f73  s = client.get_s
-0000c460: 7472 6561 6d28 0a20 2020 2020 2020 2020  tream(.         
-0000c470: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-0000c480: 7472 6561 6d5f 6e61 6d65 2c0a 2020 2020  tream_name,.    
-0000c490: 2020 2020 2020 2020 7374 7265 616d 5f70          stream_p
-0000c4a0: 6f73 6974 696f 6e3d 7374 7265 616d 5f70  osition=stream_p
-0000c4b0: 6f73 6974 696f 6e0a 2020 2020 2020 2020  osition.        
-0000c4c0: 290a 2020 2020 6578 6365 7074 204e 6f74  ).    except Not
-0000c4d0: 466f 756e 6420 6173 2065 3a0a 2020 2020  Found as e:.    
-0000c4e0: 2020 2020 7261 6973 6520 4167 6772 6567      raise Aggreg
-0000c4f0: 6174 654e 6f74 466f 756e 6428 6167 6772  ateNotFound(aggr
-0000c500: 6567 6174 655f 6964 2920 6672 6f6d 2065  egate_id) from e
-0000c510: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-0000c520: 2020 2072 6563 6f72 6465 645f 6576 656e     recorded_even
-0000c530: 7473 202b 3d20 6576 656e 7473 0a0a 2020  ts += events..  
-0000c540: 2020 2320 5265 636f 6e73 7472 7563 7420    # Reconstruct 
-0000c550: 6167 6772 6567 6174 6520 6672 6f6d 2072  aggregate from r
-0000c560: 6563 6f72 6465 6420 6576 656e 7473 2e0a  ecorded events..
-0000c570: 2020 2020 6167 6772 6567 6174 6520 3d20      aggregate = 
-0000c580: 4e6f 6e65 0a20 2020 2066 6f72 2065 7665  None.    for eve
-0000c590: 6e74 2069 6e20 7265 636f 7264 6564 5f65  nt in recorded_e
-0000c5a0: 7665 6e74 733a 0a20 2020 2020 2020 2061  vents:.        a
-0000c5b0: 6767 7265 6761 7465 203d 206d 7574 6174  ggregate = mutat
-0000c5c0: 6f72 5f66 756e 6328 6167 6772 6567 6174  or_func(aggregat
-0000c5d0: 652c 2065 7665 6e74 290a 0a20 2020 2072  e, event)..    r
-0000c5e0: 6574 7572 6e20 6167 6772 6567 6174 650a  eturn aggregate.
-0000c5f0: 0a0a 6465 6620 7365 7269 616c 697a 6528  ..def serialize(
-0000c600: 6429 3a0a 2020 2020 7265 7475 726e 206a  d):.    return j
-0000c610: 736f 6e2e 6475 6d70 7328 6429 2e65 6e63  son.dumps(d).enc
-0000c620: 6f64 6528 2775 7466 3827 290a 0a0a 6465  ode('utf8')...de
-0000c630: 6620 6465 7365 7269 616c 697a 6528 7329  f deserialize(s)
-0000c640: 3a0a 2020 2020 7265 7475 726e 206a 736f  :.    return jso
-0000c650: 6e2e 6c6f 6164 7328 732e 6465 636f 6465  n.loads(s.decode
-0000c660: 2827 7574 6638 2729 290a 6060 600a 0a54  ('utf8')).```..T
-0000c670: 6f20 7368 6f77 2068 6f77 2060 6765 745f  o show how `get_
-0000c680: 6167 6772 6567 6174 6528 2960 2063 616e  aggregate()` can
-0000c690: 2062 6520 7573 6564 2c20 6c65 7427 7320   be used, let's 
-0000c6a0: 6465 6669 6e65 2061 2060 446f 6760 2061  define a `Dog` a
-0000c6b0: 6767 7265 6761 7465 2063 6c61 7373 2c20  ggregate class, 
-0000c6c0: 7769 7468 0a61 7474 7269 6275 7465 7320  with.attributes 
-0000c6d0: 606e 616d 6560 2061 6e64 2060 7472 6963  `name` and `tric
-0000c6e0: 6b73 602e 2054 6865 2061 7474 7269 6275  ks`. The attribu
-0000c6f0: 7465 7320 6069 6460 2061 6e64 2060 7665  tes `id` and `ve
-0000c700: 7273 696f 6e60 2077 696c 6c20 696e 6469  rsion` will indi
-0000c710: 6361 7465 2061 6e0a 6167 6772 6567 6174  cate an.aggregat
-0000c720: 6520 6f62 6a65 6374 2773 2049 4420 616e  e object's ID an
-0000c730: 6420 7665 7273 696f 6e20 6e75 6d62 6572  d version number
-0000c740: 2e20 5468 6520 6174 7472 6962 7574 6520  . The attribute 
-0000c750: 6069 735f 6672 6f6d 5f73 6e61 7073 686f  `is_from_snapsho
-0000c760: 7460 2069 7320 6164 6465 640a 6865 7265  t` is added.here
-0000c770: 206d 6572 656c 7920 746f 2064 656d 6f6e   merely to demon
-0000c780: 7374 7261 7465 2062 656c 6f77 2077 6865  strate below whe
-0000c790: 6e20 616e 2061 6767 7265 6761 7465 206f  n an aggregate o
-0000c7a0: 626a 6563 7420 6861 7320 6265 656e 2072  bject has been r
-0000c7b0: 6563 6f6e 7374 7275 6374 6564 2075 7369  econstructed usi
-0000c7c0: 6e67 0a61 2073 6e61 7073 686f 742e 0a0a  ng.a snapshot...
-0000c7d0: 6060 6070 7974 686f 6e0a 6672 6f6d 2064  ```python.from d
-0000c7e0: 6174 6163 6c61 7373 6573 2069 6d70 6f72  ataclasses impor
-0000c7f0: 7420 6461 7461 636c 6173 730a 0a0a 4064  t dataclass...@d
-0000c800: 6174 6163 6c61 7373 2866 726f 7a65 6e3d  ataclass(frozen=
-0000c810: 5472 7565 290a 636c 6173 7320 4167 6772  True).class Aggr
-0000c820: 6567 6174 653a 0a20 2020 2069 643a 2073  egate:.    id: s
-0000c830: 7472 0a20 2020 2076 6572 7369 6f6e 3a20  tr.    version: 
-0000c840: 696e 740a 2020 2020 6973 5f66 726f 6d5f  int.    is_from_
-0000c850: 736e 6170 7368 6f74 3a20 626f 6f6c 0a0a  snapshot: bool..
-0000c860: 0a40 6461 7461 636c 6173 7328 6672 6f7a  .@dataclass(froz
-0000c870: 656e 3d54 7275 6529 0a63 6c61 7373 2044  en=True).class D
-0000c880: 6f67 2841 6767 7265 6761 7465 293a 0a20  og(Aggregate):. 
-0000c890: 2020 206e 616d 653a 2073 7472 0a20 2020     name: str.   
-0000c8a0: 2074 7269 636b 733a 206c 6973 740a 6060   tricks: list.``
-0000c8b0: 600a 0a4c 6574 2773 2061 6c73 6f20 6465  `..Let's also de
-0000c8c0: 6669 6e65 2061 206d 7574 6174 6f72 2066  fine a mutator f
-0000c8d0: 756e 6374 696f 6e20 606d 7574 6174 655f  unction `mutate_
-0000c8e0: 646f 6728 2960 2074 6861 7420 6576 6f6c  dog()` that evol
-0000c8f0: 7665 7320 7468 6520 7374 6174 6520 6f66  ves the state of
-0000c900: 2061 0a60 446f 6760 2061 6767 7265 6761   a.`Dog` aggrega
-0000c910: 7465 2067 6976 656e 2076 6172 696f 7573  te given various
-0000c920: 2064 6966 6665 7265 6e74 2074 7970 6573   different types
-0000c930: 206f 6620 6576 656e 7473 2c20 6027 446f   of events, `'Do
-0000c940: 6752 6567 6973 7465 7265 6427 602c 0a60  gRegistered'`,.`
-0000c950: 2744 6f67 4c65 6172 6e65 6454 7269 636b  'DogLearnedTrick
-0000c960: 2760 2c20 616e 6420 6027 536e 6170 7368  '`, and `'Snapsh
-0000c970: 6f74 2760 2e0a 0a60 6060 7079 7468 6f6e  ot'`...```python
-0000c980: 0a64 6566 206d 7574 6174 655f 646f 6728  .def mutate_dog(
-0000c990: 646f 672c 2065 7665 6e74 293a 0a20 2020  dog, event):.   
-0000c9a0: 2064 6174 6120 3d20 6465 7365 7269 616c   data = deserial
-0000c9b0: 697a 6528 6576 656e 742e 6461 7461 290a  ize(event.data).
-0000c9c0: 2020 2020 6966 2065 7665 6e74 2e74 7970      if event.typ
-0000c9d0: 6520 3d3d 2027 446f 6752 6567 6973 7465  e == 'DogRegiste
-0000c9e0: 7265 6427 3a0a 2020 2020 2020 2020 7265  red':.        re
-0000c9f0: 7475 726e 2044 6f67 280a 2020 2020 2020  turn Dog(.      
-0000ca00: 2020 2020 2020 6964 3d65 7665 6e74 2e73        id=event.s
-0000ca10: 7472 6561 6d5f 6e61 6d65 2c0a 2020 2020  tream_name,.    
-0000ca20: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
-0000ca30: 6576 656e 742e 7374 7265 616d 5f70 6f73  event.stream_pos
-0000ca40: 6974 696f 6e2c 0a20 2020 2020 2020 2020  ition,.         
-0000ca50: 2020 2069 735f 6672 6f6d 5f73 6e61 7073     is_from_snaps
-0000ca60: 686f 743d 4661 6c73 652c 0a20 2020 2020  hot=False,.     
-0000ca70: 2020 2020 2020 206e 616d 653d 6461 7461         name=data
-0000ca80: 5b27 6e61 6d65 275d 2c0a 2020 2020 2020  ['name'],.      
-0000ca90: 2020 2020 2020 7472 6963 6b73 3d5b 5d2c        tricks=[],
-0000caa0: 0a20 2020 2020 2020 2029 0a20 2020 2065  .        ).    e
-0000cab0: 6c69 6620 6576 656e 742e 7479 7065 203d  lif event.type =
-0000cac0: 3d20 2744 6f67 4c65 6172 6e65 6454 7269  = 'DogLearnedTri
-0000cad0: 636b 273a 0a20 2020 2020 2020 2061 7373  ck':.        ass
-0000cae0: 6572 7420 6576 656e 742e 7374 7265 616d  ert event.stream
-0000caf0: 5f70 6f73 6974 696f 6e20 3d3d 2064 6f67  _position == dog
-0000cb00: 2e76 6572 7369 6f6e 202b 2031 0a20 2020  .version + 1.   
-0000cb10: 2020 2020 2061 7373 6572 7420 6576 656e       assert even
-0000cb20: 742e 7374 7265 616d 5f6e 616d 6520 3d3d  t.stream_name ==
-0000cb30: 2064 6f67 2e69 642c 2028 6576 656e 742e   dog.id, (event.
-0000cb40: 7374 7265 616d 5f6e 616d 652c 2064 6f67  stream_name, dog
-0000cb50: 2e69 6429 0a20 2020 2020 2020 2072 6574  .id).        ret
-0000cb60: 7572 6e20 446f 6728 0a20 2020 2020 2020  urn Dog(.       
-0000cb70: 2020 2020 2069 643d 646f 672e 6964 2c0a       id=dog.id,.
-0000cb80: 2020 2020 2020 2020 2020 2020 7665 7273              vers
-0000cb90: 696f 6e3d 6576 656e 742e 7374 7265 616d  ion=event.stream
-0000cba0: 5f70 6f73 6974 696f 6e2c 0a20 2020 2020  _position,.     
-0000cbb0: 2020 2020 2020 2069 735f 6672 6f6d 5f73         is_from_s
-0000cbc0: 6e61 7073 686f 743d 646f 672e 6973 5f66  napshot=dog.is_f
-0000cbd0: 726f 6d5f 736e 6170 7368 6f74 2c0a 2020  rom_snapshot,.  
-0000cbe0: 2020 2020 2020 2020 2020 6e61 6d65 3d64            name=d
-0000cbf0: 6f67 2e6e 616d 652c 0a20 2020 2020 2020  og.name,.       
-0000cc00: 2020 2020 2074 7269 636b 733d 646f 672e       tricks=dog.
-0000cc10: 7472 6963 6b73 202b 205b 6461 7461 5b27  tricks + [data['
-0000cc20: 7472 6963 6b27 5d5d 2c0a 2020 2020 2020  trick']],.      
-0000cc30: 2020 290a 2020 2020 656c 6966 2065 7665    ).    elif eve
-0000cc40: 6e74 2e74 7970 6520 3d3d 2027 536e 6170  nt.type == 'Snap
-0000cc50: 7368 6f74 273a 0a20 2020 2020 2020 2072  shot':.        r
-0000cc60: 6574 7572 6e20 446f 6728 0a20 2020 2020  eturn Dog(.     
-0000cc70: 2020 2020 2020 2069 643d 7265 6d6f 7665         id=remove
-0000cc80: 5f73 6e61 7073 686f 745f 7374 7265 616d  _snapshot_stream
-0000cc90: 5f70 7265 6669 7828 6576 656e 742e 7374  _prefix(event.st
-0000cca0: 7265 616d 5f6e 616d 6529 2c0a 2020 2020  ream_name),.    
-0000ccb0: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
-0000ccc0: 6465 7365 7269 616c 697a 6528 6576 656e  deserialize(even
-0000ccd0: 742e 6d65 7461 6461 7461 295b 2776 6572  t.metadata)['ver
-0000cce0: 7369 6f6e 275d 2c0a 2020 2020 2020 2020  sion'],.        
-0000ccf0: 2020 2020 6973 5f66 726f 6d5f 736e 6170      is_from_snap
-0000cd00: 7368 6f74 3d54 7275 652c 0a20 2020 2020  shot=True,.     
-0000cd10: 2020 2020 2020 206e 616d 653d 6461 7461         name=data
-0000cd20: 5b27 6e61 6d65 275d 2c0a 2020 2020 2020  ['name'],.      
-0000cd30: 2020 2020 2020 7472 6963 6b73 3d64 6174        tricks=dat
-0000cd40: 615b 2774 7269 636b 7327 5d2c 0a20 2020  a['tricks'],.   
-0000cd50: 2020 2020 2029 0a20 2020 2065 6c73 653a       ).    else:
-0000cd60: 0a20 2020 2020 2020 2072 6169 7365 2045  .        raise E
-0000cd70: 7863 6570 7469 6f6e 2866 2255 6e6b 6e6f  xception(f"Unkno
-0000cd80: 776e 2065 7665 6e74 2074 7970 653a 207b  wn event type: {
-0000cd90: 6576 656e 742e 7479 7065 7d22 290a 6060  event.type}").``
-0000cda0: 600a 0a46 6f72 2063 6f6e 7665 6e69 656e  `..For convenien
-0000cdb0: 6365 2c20 6c65 7427 7320 616c 736f 2064  ce, let's also d
-0000cdc0: 6566 696e 6520 6120 6067 6574 5f64 6f67  efine a `get_dog
-0000cdd0: 2829 6020 6675 6e63 7469 6f6e 2074 6861  ()` function tha
-0000cde0: 7420 6361 6c6c 7320 6067 6574 5f61 6767  t calls `get_agg
-0000cdf0: 7265 6761 7465 2829 600a 7769 7468 2074  regate()`.with t
-0000ce00: 6865 2060 6d75 7461 7465 5f64 6f67 2829  he `mutate_dog()
-0000ce10: 6020 6675 6e63 7469 6f6e 2061 7320 7468  ` function as th
-0000ce20: 6520 7661 6c75 6520 6f66 2069 7473 2060  e value of its `
-0000ce30: 6d75 7461 746f 725f 6675 6e63 6020 6172  mutator_func` ar
-0000ce40: 6775 6d65 6e74 2e0a 0a60 6060 7079 7468  gument...```pyth
-0000ce50: 6f6e 0a64 6566 2067 6574 5f64 6f67 2864  on.def get_dog(d
-0000ce60: 6f67 5f69 6429 3a0a 2020 2020 7265 7475  og_id):.    retu
-0000ce70: 726e 2067 6574 5f61 6767 7265 6761 7465  rn get_aggregate
-0000ce80: 280a 2020 2020 2020 2020 6167 6772 6567  (.        aggreg
-0000ce90: 6174 655f 6964 3d64 6f67 5f69 642c 0a20  ate_id=dog_id,. 
-0000cea0: 2020 2020 2020 206d 7574 6174 6f72 5f66         mutator_f
-0000ceb0: 756e 633d 6d75 7461 7465 5f64 6f67 2c0a  unc=mutate_dog,.
-0000cec0: 2020 2020 290a 6060 600a 0a57 6520 6361      ).```..We ca
-0000ced0: 6e20 616c 736f 2064 6566 696e 6520 736f  n also define so
-0000cee0: 6d65 2022 636f 6d6d 616e 6422 2066 756e  me "command" fun
-0000cef0: 6374 696f 6e73 2074 6861 7420 6170 7065  ctions that appe
-0000cf00: 6e64 206e 6577 2065 7665 6e74 7320 746f  nd new events to
-0000cf10: 2074 6865 0a64 6174 6162 6173 652e 2054   the.database. T
-0000cf20: 6865 2060 7265 6769 7374 6572 5f64 6f67  he `register_dog
-0000cf30: 2829 6020 6675 6e63 7469 6f6e 2061 7070  ()` function app
-0000cf40: 656e 6473 2061 2060 446f 6752 6567 6973  ends a `DogRegis
-0000cf50: 7465 7265 6460 2065 7665 6e74 2e20 5468  tered` event. Th
-0000cf60: 650a 6072 6563 6f72 645f 7472 6963 6b5f  e.`record_trick_
-0000cf70: 6c65 6172 6e65 6428 2960 2061 7070 656e  learned()` appen
-0000cf80: 6473 2061 2060 446f 674c 6561 726e 6564  ds a `DogLearned
-0000cf90: 5472 6963 6b60 2065 7665 6e74 2e20 5468  Trick` event. Th
-0000cfa0: 6520 6675 6e63 7469 6f6e 0a60 736e 6170  e function.`snap
-0000cfb0: 7368 6f74 5f64 6f67 2829 6020 6170 7065  shot_dog()` appe
-0000cfc0: 6e64 7320 6120 6053 6e61 7073 686f 7460  nds a `Snapshot`
-0000cfd0: 2065 7665 6e74 2e20 4e6f 7469 6365 2074   event. Notice t
-0000cfe0: 6861 7420 7468 650a 6072 6563 6f72 645f  hat the.`record_
-0000cff0: 7472 6963 6b5f 6c65 6172 6e65 6428 2960  trick_learned()`
-0000d000: 2061 6e64 2060 736e 6170 7368 6f74 5f64   and `snapshot_d
-0000d010: 6f67 2829 6020 6675 6e63 7469 6f6e 7320  og()` functions 
-0000d020: 7573 6520 6067 6574 5f64 6f67 2829 602e  use `get_dog()`.
-0000d030: 0a0a 4e6f 7469 6365 2061 6c73 6f20 7468  ..Notice also th
-0000d040: 6174 2074 6865 2060 446f 6752 6567 6973  at the `DogRegis
-0000d050: 7465 7265 6460 2061 6e64 2060 446f 674c  tered` and `DogL
-0000d060: 6561 726e 6564 5472 6963 6b60 2065 7665  earnedTrick` eve
-0000d070: 6e74 7320 6172 6520 6170 7065 6e64 6564  nts are appended
-0000d080: 2074 6f20 610a 7374 7265 616d 2066 6f72   to a.stream for
-0000d090: 2061 6767 7265 6761 7465 2065 7665 6e74   aggregate event
-0000d0a0: 732c 2077 6869 6c73 7420 7468 6520 6053  s, whilst the `S
-0000d0b0: 6e61 7073 686f 7460 2065 7665 6e74 2069  napshot` event i
-0000d0c0: 7320 6170 7065 6e64 6564 2074 6f20 6120  s appended to a 
-0000d0d0: 7365 7061 7261 7465 0a73 7472 6561 6d20  separate.stream 
-0000d0e0: 666f 7220 6167 6772 6567 6174 6520 736e  for aggregate sn
-0000d0f0: 6170 7368 6f74 732e 0a0a 6060 6070 7974  apshots...```pyt
-0000d100: 686f 6e0a 6465 6620 7265 6769 7374 6572  hon.def register
-0000d110: 5f64 6f67 286e 616d 6529 3a0a 2020 2020  _dog(name):.    
-0000d120: 646f 675f 6964 203d 2073 7472 2875 7569  dog_id = str(uui
-0000d130: 642e 7575 6964 3428 2929 0a20 2020 2065  d.uuid4()).    e
-0000d140: 7665 6e74 203d 204e 6577 4576 656e 7428  vent = NewEvent(
-0000d150: 0a20 2020 2020 2020 2074 7970 653d 2744  .        type='D
-0000d160: 6f67 5265 6769 7374 6572 6564 272c 0a20  ogRegistered',. 
-0000d170: 2020 2020 2020 2064 6174 613d 7365 7269         data=seri
-0000d180: 616c 697a 6528 7b27 6e61 6d65 273a 206e  alize({'name': n
-0000d190: 616d 657d 292c 0a20 2020 2029 0a20 2020  ame}),.    ).   
-0000d1a0: 2063 6c69 656e 742e 6170 7065 6e64 5f74   client.append_t
-0000d1b0: 6f5f 7374 7265 616d 280a 2020 2020 2020  o_stream(.      
-0000d1c0: 2020 7374 7265 616d 5f6e 616d 653d 646f    stream_name=do
-0000d1d0: 675f 6964 2c0a 2020 2020 2020 2020 6375  g_id,.        cu
-0000d1e0: 7272 656e 745f 7665 7273 696f 6e3d 5374  rrent_version=St
-0000d1f0: 7265 616d 5374 6174 652e 4e4f 5f53 5452  reamState.NO_STR
-0000d200: 4541 4d2c 0a20 2020 2020 2020 2065 7665  EAM,.        eve
-0000d210: 6e74 733d 6576 656e 742c 0a20 2020 2029  nts=event,.    )
-0000d220: 0a20 2020 2072 6574 7572 6e20 646f 675f  .    return dog_
-0000d230: 6964 0a0a 0a64 6566 2072 6563 6f72 645f  id...def record_
-0000d240: 7472 6963 6b5f 6c65 6172 6e65 6428 646f  trick_learned(do
-0000d250: 675f 6964 2c20 7472 6963 6b29 3a0a 2020  g_id, trick):.  
-0000d260: 2020 646f 6720 3d20 6765 745f 646f 6728    dog = get_dog(
-0000d270: 646f 675f 6964 290a 2020 2020 6576 656e  dog_id).    even
-0000d280: 7420 3d20 4e65 7745 7665 6e74 280a 2020  t = NewEvent(.  
-0000d290: 2020 2020 2020 7479 7065 3d27 446f 674c        type='DogL
-0000d2a0: 6561 726e 6564 5472 6963 6b27 2c0a 2020  earnedTrick',.  
-0000d2b0: 2020 2020 2020 6461 7461 3d73 6572 6961        data=seria
-0000d2c0: 6c69 7a65 287b 2774 7269 636b 273a 2074  lize({'trick': t
-0000d2d0: 7269 636b 7d29 2c0a 2020 2020 290a 2020  rick}),.    ).  
-0000d2e0: 2020 636c 6965 6e74 2e61 7070 656e 645f    client.append_
-0000d2f0: 746f 5f73 7472 6561 6d28 0a20 2020 2020  to_stream(.     
-0000d300: 2020 2073 7472 6561 6d5f 6e61 6d65 3d64     stream_name=d
-0000d310: 6f67 5f69 642c 0a20 2020 2020 2020 2063  og_id,.        c
-0000d320: 7572 7265 6e74 5f76 6572 7369 6f6e 3d64  urrent_version=d
-0000d330: 6f67 2e76 6572 7369 6f6e 2c0a 2020 2020  og.version,.    
-0000d340: 2020 2020 6576 656e 7473 3d65 7665 6e74      events=event
-0000d350: 2c0a 2020 2020 290a 0a0a 6465 6620 736e  ,.    )...def sn
-0000d360: 6170 7368 6f74 5f64 6f67 2864 6f67 5f69  apshot_dog(dog_i
-0000d370: 6429 3a0a 2020 2020 646f 6720 3d20 6765  d):.    dog = ge
-0000d380: 745f 646f 6728 646f 675f 6964 290a 2020  t_dog(dog_id).  
-0000d390: 2020 6576 656e 7420 3d20 4e65 7745 7665    event = NewEve
-0000d3a0: 6e74 280a 2020 2020 2020 2020 7479 7065  nt(.        type
-0000d3b0: 3d27 536e 6170 7368 6f74 272c 0a20 2020  ='Snapshot',.   
-0000d3c0: 2020 2020 2064 6174 613d 7365 7269 616c       data=serial
-0000d3d0: 697a 6528 7b27 6e61 6d65 273a 2064 6f67  ize({'name': dog
-0000d3e0: 2e6e 616d 652c 2027 7472 6963 6b73 273a  .name, 'tricks':
-0000d3f0: 2064 6f67 2e74 7269 636b 737d 292c 0a20   dog.tricks}),. 
-0000d400: 2020 2020 2020 206d 6574 6164 6174 613d         metadata=
-0000d410: 7365 7269 616c 697a 6528 7b27 7665 7273  serialize({'vers
-0000d420: 696f 6e27 3a20 646f 672e 7665 7273 696f  ion': dog.versio
-0000d430: 6e7d 292c 0a20 2020 2029 0a20 2020 2063  n}),.    ).    c
-0000d440: 6c69 656e 742e 6170 7065 6e64 5f74 6f5f  lient.append_to_
-0000d450: 7374 7265 616d 280a 2020 2020 2020 2020  stream(.        
-0000d460: 7374 7265 616d 5f6e 616d 653d 6d61 6b65  stream_name=make
-0000d470: 5f73 6e61 7073 686f 745f 7374 7265 616d  _snapshot_stream
-0000d480: 5f6e 616d 6528 646f 675f 6964 292c 0a20  _name(dog_id),. 
-0000d490: 2020 2020 2020 2063 7572 7265 6e74 5f76         current_v
-0000d4a0: 6572 7369 6f6e 3d53 7472 6561 6d53 7461  ersion=StreamSta
-0000d4b0: 7465 2e41 4e59 2c0a 2020 2020 2020 2020  te.ANY,.        
-0000d4c0: 6576 656e 7473 3d65 7665 6e74 2c0a 2020  events=event,.  
-0000d4d0: 2020 290a 6060 600a 0a57 6520 6361 6e20    ).```..We can 
-0000d4e0: 6361 6c6c 2060 7265 6769 7374 6572 5f64  call `register_d
-0000d4f0: 6f67 2829 6020 746f 2072 6567 6973 7465  og()` to registe
-0000d500: 7220 6120 6e65 7720 646f 672e 0a0a 6060  r a new dog...``
-0000d510: 6070 7974 686f 6e0a 2320 5265 6769 7374  `python.# Regist
-0000d520: 6572 2061 206e 6577 2064 6f67 2e0a 646f  er a new dog..do
-0000d530: 675f 6964 203d 2072 6567 6973 7465 725f  g_id = register_
-0000d540: 646f 6728 2746 6964 6f27 290a 0a64 6f67  dog('Fido')..dog
-0000d550: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
-0000d560: 6429 0a61 7373 6572 7420 646f 672e 6e61  d).assert dog.na
-0000d570: 6d65 203d 3d20 2746 6964 6f27 0a61 7373  me == 'Fido'.ass
-0000d580: 6572 7420 646f 672e 7472 6963 6b73 203d  ert dog.tricks =
-0000d590: 3d20 5b5d 0a61 7373 6572 7420 646f 672e  = [].assert dog.
-0000d5a0: 7665 7273 696f 6e20 3d3d 2030 0a61 7373  version == 0.ass
-0000d5b0: 6572 7420 646f 672e 6973 5f66 726f 6d5f  ert dog.is_from_
-0000d5c0: 736e 6170 7368 6f74 2069 7320 4661 6c73  snapshot is Fals
-0000d5d0: 650a 0a60 6060 0a0a 5765 2063 616e 2063  e..```..We can c
-0000d5e0: 616c 6c20 6072 6563 6f72 645f 7472 6963  all `record_tric
-0000d5f0: 6b5f 6c65 6172 6e65 6428 2960 2074 6f20  k_learned()` to 
-0000d600: 7265 636f 7264 2074 6861 7420 736f 6d65  record that some
-0000d610: 2074 7269 636b 7320 6861 7665 2062 6565   tricks have bee
-0000d620: 6e20 6c65 6172 6e65 642e 0a0a 6060 6070  n learned...```p
-0000d630: 7974 686f 6e0a 0a23 2052 6563 6f72 6420  ython..# Record 
-0000d640: 7468 6174 2027 4669 646f 2720 6c65 6172  that 'Fido' lear
-0000d650: 6e65 6420 6120 6e65 7720 7472 6963 6b2e  ned a new trick.
-0000d660: 0a72 6563 6f72 645f 7472 6963 6b5f 6c65  .record_trick_le
-0000d670: 6172 6e65 6428 646f 675f 6964 2c20 7472  arned(dog_id, tr
-0000d680: 6963 6b3d 2772 6f6c 6c20 6f76 6572 2729  ick='roll over')
-0000d690: 0a0a 646f 6720 3d20 6765 745f 646f 6728  ..dog = get_dog(
-0000d6a0: 646f 675f 6964 290a 6173 7365 7274 2064  dog_id).assert d
-0000d6b0: 6f67 2e6e 616d 6520 3d3d 2027 4669 646f  og.name == 'Fido
-0000d6c0: 270a 6173 7365 7274 2064 6f67 2e74 7269  '.assert dog.tri
-0000d6d0: 636b 7320 3d3d 205b 2772 6f6c 6c20 6f76  cks == ['roll ov
-0000d6e0: 6572 275d 0a61 7373 6572 7420 646f 672e  er'].assert dog.
-0000d6f0: 7665 7273 696f 6e20 3d3d 2031 0a61 7373  version == 1.ass
-0000d700: 6572 7420 646f 672e 6973 5f66 726f 6d5f  ert dog.is_from_
-0000d710: 736e 6170 7368 6f74 2069 7320 4661 6c73  snapshot is Fals
-0000d720: 650a 0a0a 2320 5265 636f 7264 2074 6861  e...# Record tha
-0000d730: 7420 2746 6964 6f27 206c 6561 726e 6564  t 'Fido' learned
-0000d740: 2061 6e6f 7468 6572 206e 6577 2074 7269   another new tri
-0000d750: 636b 2e0a 7265 636f 7264 5f74 7269 636b  ck..record_trick
-0000d760: 5f6c 6561 726e 6564 2864 6f67 5f69 642c  _learned(dog_id,
-0000d770: 2074 7269 636b 3d27 6665 7463 6820 6261   trick='fetch ba
-0000d780: 6c6c 2729 0a0a 646f 6720 3d20 6765 745f  ll')..dog = get_
-0000d790: 646f 6728 646f 675f 6964 290a 6173 7365  dog(dog_id).asse
-0000d7a0: 7274 2064 6f67 2e6e 616d 6520 3d3d 2027  rt dog.name == '
-0000d7b0: 4669 646f 270a 6173 7365 7274 2064 6f67  Fido'.assert dog
-0000d7c0: 2e74 7269 636b 7320 3d3d 205b 2772 6f6c  .tricks == ['rol
-0000d7d0: 6c20 6f76 6572 272c 2027 6665 7463 6820  l over', 'fetch 
-0000d7e0: 6261 6c6c 275d 0a61 7373 6572 7420 646f  ball'].assert do
-0000d7f0: 672e 7665 7273 696f 6e20 3d3d 2032 0a61  g.version == 2.a
-0000d800: 7373 6572 7420 646f 672e 6973 5f66 726f  ssert dog.is_fro
-0000d810: 6d5f 736e 6170 7368 6f74 2069 7320 4661  m_snapshot is Fa
-0000d820: 6c73 650a 6060 600a 0a57 6520 6361 6e20  lse.```..We can 
-0000d830: 6361 6c6c 2060 736e 6170 7368 6f74 5f64  call `snapshot_d
-0000d840: 6f67 2829 6020 746f 2072 6563 6f72 6420  og()` to record 
-0000d850: 6120 736e 6170 7368 6f74 206f 6620 7468  a snapshot of th
-0000d860: 6520 6375 7272 656e 7420 7374 6174 6520  e current state 
-0000d870: 6f66 2074 6865 2060 446f 6760 0a61 6767  of the `Dog`.agg
-0000d880: 7265 6761 7465 2e20 4166 7465 7220 7765  regate. After we
-0000d890: 2063 616c 6c20 6073 6e61 7073 686f 745f   call `snapshot_
-0000d8a0: 646f 6728 2960 2c20 7468 6520 6067 6574  dog()`, the `get
-0000d8b0: 5f64 6f67 2829 6020 6675 6e63 7469 6f6e  _dog()` function
-0000d8c0: 2077 696c 6c20 7265 7475 726e 2061 2060   will return a `
-0000d8d0: 446f 6760 0a6f 626a 6563 7420 7468 6174  Dog`.object that
-0000d8e0: 2068 6173 2062 6565 6e20 636f 6e73 7472   has been constr
-0000d8f0: 7563 7465 6420 7573 696e 6720 7468 6520  ucted using the 
-0000d900: 6053 6e61 7073 686f 7460 2065 7665 6e74  `Snapshot` event
-0000d910: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2053  ...```python.# S
-0000d920: 6e61 7073 686f 7420 2746 6964 6f27 2e0a  napshot 'Fido'..
-0000d930: 736e 6170 7368 6f74 5f64 6f67 2864 6f67  snapshot_dog(dog
-0000d940: 5f69 6429 0a0a 646f 6720 3d20 6765 745f  _id)..dog = get_
-0000d950: 646f 6728 646f 675f 6964 290a 6173 7365  dog(dog_id).asse
-0000d960: 7274 2064 6f67 2e6e 616d 6520 3d3d 2027  rt dog.name == '
-0000d970: 4669 646f 270a 6173 7365 7274 2064 6f67  Fido'.assert dog
-0000d980: 2e74 7269 636b 7320 3d3d 205b 2772 6f6c  .tricks == ['rol
-0000d990: 6c20 6f76 6572 272c 2027 6665 7463 6820  l over', 'fetch 
-0000d9a0: 6261 6c6c 275d 0a61 7373 6572 7420 646f  ball'].assert do
-0000d9b0: 672e 7665 7273 696f 6e20 3d3d 2032 0a61  g.version == 2.a
-0000d9c0: 7373 6572 7420 646f 672e 6973 5f66 726f  ssert dog.is_fro
-0000d9d0: 6d5f 736e 6170 7368 6f74 2069 7320 5472  m_snapshot is Tr
-0000d9e0: 7565 0a60 6060 0a0a 5765 2063 616e 2063  ue.```..We can c
-0000d9f0: 6f6e 7469 6e75 6520 746f 2065 766f 6c76  ontinue to evolv
-0000da00: 6520 7468 6520 7374 6174 6520 6f66 2074  e the state of t
-0000da10: 6865 2060 446f 6760 2061 6767 7265 6761  he `Dog` aggrega
-0000da20: 7465 2c20 7573 696e 670a 7468 6520 736e  te, using.the sn
-0000da30: 6170 7368 6f74 2062 6f74 6820 6475 7269  apshot both duri
-0000da40: 6e67 2074 6865 2063 616c 6c20 746f 2060  ng the call to `
-0000da50: 7265 636f 7264 5f74 7269 636b 5f6c 6561  record_trick_lea
-0000da60: 726e 6564 2829 6020 616e 640a 7768 656e  rned()` and.when
-0000da70: 2063 616c 6c69 6e67 2060 6765 745f 646f   calling `get_do
-0000da80: 6728 2960 2064 6972 6563 746c 792e 0a0a  g()` directly...
-0000da90: 6060 6070 7974 686f 6e0a 7265 636f 7264  ```python.record
-0000daa0: 5f74 7269 636b 5f6c 6561 726e 6564 2864  _trick_learned(d
-0000dab0: 6f67 5f69 642c 2074 7269 636b 3d27 7369  og_id, trick='si
-0000dac0: 7427 290a 0a64 6f67 203d 2067 6574 5f64  t')..dog = get_d
-0000dad0: 6f67 2864 6f67 5f69 6429 0a61 7373 6572  og(dog_id).asser
-0000dae0: 7420 646f 672e 6e61 6d65 203d 3d20 2746  t dog.name == 'F
-0000daf0: 6964 6f27 0a61 7373 6572 7420 646f 672e  ido'.assert dog.
-0000db00: 7472 6963 6b73 203d 3d20 5b27 726f 6c6c  tricks == ['roll
-0000db10: 206f 7665 7227 2c20 2766 6574 6368 2062   over', 'fetch b
-0000db20: 616c 6c27 2c20 2773 6974 275d 0a61 7373  all', 'sit'].ass
-0000db30: 6572 7420 646f 672e 7665 7273 696f 6e20  ert dog.version 
-0000db40: 3d3d 2033 0a61 7373 6572 7420 646f 672e  == 3.assert dog.
-0000db50: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
-0000db60: 2069 7320 5472 7565 0a60 6060 0a0a 5765   is True.```..We
-0000db70: 2063 616e 2073 6565 2066 726f 6d20 7468   can see from th
-0000db80: 6520 6069 735f 6672 6f6d 5f73 6e61 7073  e `is_from_snaps
-0000db90: 686f 7460 2061 7474 7269 6275 7465 2074  hot` attribute t
-0000dba0: 6861 7420 7468 6520 6044 6f67 6020 6f62  hat the `Dog` ob
-0000dbb0: 6a65 6374 2077 6173 2069 6e64 6565 640a  ject was indeed.
-0000dbc0: 7265 636f 6e73 7472 7563 7465 6420 6672  reconstructed fr
-0000dbd0: 6f6d 2074 6865 2073 6e61 7073 686f 742e  om the snapshot.
-0000dbe0: 0a0a 536e 6170 7368 6f74 7320 6361 6e20  ..Snapshots can 
-0000dbf0: 6265 2063 7265 6174 6564 2061 7420 6669  be created at fi
-0000dc00: 7865 6420 7665 7273 696f 6e20 6e75 6d62  xed version numb
-0000dc10: 6572 2069 6e74 6572 7661 6c73 2c20 6669  er intervals, fi
-0000dc20: 7865 6420 7469 6d65 0a70 6572 696f 6473  xed time.periods
-0000dc30: 2c20 6166 7465 7220 6120 7061 7274 6963  , after a partic
-0000dc40: 756c 6172 2074 7970 6520 6f66 2065 7665  ular type of eve
-0000dc50: 6e74 2c20 696d 6d65 6469 6174 656c 7920  nt, immediately 
-0000dc60: 6166 7465 7220 6576 656e 7473 2061 7265  after events are
-0000dc70: 0a61 7070 656e 6465 642c 206f 7220 6173  .appended, or as
-0000dc80: 2061 2062 6163 6b67 726f 756e 6420 7072   a background pr
-0000dc90: 6f63 6573 732e 0a0a 0a23 2323 2052 6561  ocess....### Rea
-0000dca0: 6420 616c 6c20 6576 656e 7473 0a0a 5468  d all events..Th
-0000dcb0: 6520 6072 6561 645f 616c 6c28 2960 206d  e `read_all()` m
-0000dcc0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-0000dcd0: 6420 746f 2067 6574 2061 6c6c 2072 6563  d to get all rec
-0000dce0: 6f72 6465 6420 6576 656e 7473 0a69 6e20  orded events.in 
-0000dcf0: 7468 6520 6461 7461 6261 7365 2069 6e20  the database in 
-0000dd00: 7468 6520 6f72 6465 7220 7468 6579 2077  the order they w
-0000dd10: 6572 6520 7265 636f 7264 6564 2e20 5468  ere recorded. Th
-0000dd20: 6973 206d 6574 686f 6420 7265 7475 726e  is method return
-0000dd30: 730a 6120 2272 6561 6420 7265 7370 6f6e  s.a "read respon
-0000dd40: 7365 2220 6f62 6a65 6374 2c20 6a75 7374  se" object, just
-0000dd50: 206c 696b 6520 6072 6561 645f 7374 7265   like `read_stre
-0000dd60: 616d 2829 602e 0a0a 4120 2272 6561 6420  am()`...A "read 
-0000dd70: 7265 7370 6f6e 7365 2220 6973 2061 6e20  response" is an 
-0000dd80: 6974 6572 6174 6f72 2c20 616e 6420 6e6f  iterator, and no
-0000dd90: 7420 6120 7365 7175 656e 6365 2e20 5265  t a sequence. Re
-0000dda0: 636f 7264 6564 2065 7665 6e74 7320 6361  corded events ca
-0000ddb0: 6e20 6265 0a6f 6274 6169 6e65 6420 6279  n be.obtained by
-0000ddc0: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
-0000ddd0: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
-0000dde0: 7365 2220 6f62 6a65 6374 2e20 5265 636f  se" object. Reco
-0000ddf0: 7264 6564 2065 7665 6e74 7320 6172 650a  rded events are.
-0000de00: 7374 7265 616d 6564 2066 726f 6d20 7468  streamed from th
-0000de10: 6520 7365 7276 6572 2074 6f20 7468 6520  e server to the 
-0000de20: 636c 6965 6e74 2061 7320 7468 6520 6974  client as the it
-0000de30: 6572 6174 696f 6e20 7072 6f63 6565 6473  eration proceeds
-0000de40: 2e20 5468 6520 6974 6572 6174 696f 6e0a  . The iteration.
-0000de50: 7769 6c6c 2061 7574 6f6d 6174 6963 616c  will automatical
-0000de60: 6c79 2073 746f 7020 7768 656e 2074 6865  ly stop when the
-0000de70: 7265 2061 7265 206e 6f20 6d6f 7265 2072  re are no more r
-0000de80: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
-0000de90: 6f20 6265 2072 6574 7572 6e65 642e 0a54  o be returned..T
-0000dea0: 6865 2073 7472 6561 6d69 6e67 206f 6620  he streaming of 
-0000deb0: 6576 656e 7473 2c20 616e 6420 6865 6e63  events, and henc
-0000dec0: 6520 7468 6520 6974 6572 6174 6f72 2c20  e the iterator, 
-0000ded0: 6361 6e20 616c 736f 2062 6520 7374 6f70  can also be stop
-0000dee0: 7065 6420 6279 2063 616c 6c69 6e67 0a74  ped by calling.t
-0000def0: 6865 2060 7374 6f70 2829 6020 6d65 7468  he `stop()` meth
-0000df00: 6f64 206f 6e20 7468 6520 2272 6561 6420  od on the "read 
-0000df10: 7265 7370 6f6e 7365 2220 6f62 6a65 6374  response" object
-0000df20: 2e20 5468 6520 7265 636f 7264 6564 2065  . The recorded e
-0000df30: 7665 6e74 206f 626a 6563 7473 0a61 7265  vent objects.are
-0000df40: 2069 6e73 7461 6e63 6573 206f 6620 7468   instances of th
-0000df50: 6520 6052 6563 6f72 6465 6445 7665 6e74  e `RecordedEvent
-0000df60: 6020 636c 6173 732e 0a0a 5468 6973 206d  ` class...This m
-0000df70: 6574 686f 6420 6861 7320 6569 6768 7420  ethod has eight 
-0000df80: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
-0000df90: 7473 2c20 6063 6f6d 6d69 745f 706f 7369  ts, `commit_posi
-0000dfa0: 7469 6f6e 602c 2060 6261 636b 7761 7264  tion`, `backward
-0000dfb0: 7360 2c0a 6066 696c 7465 725f 6578 636c  s`,.`filter_excl
-0000dfc0: 7564 6560 2c20 6066 696c 7465 725f 696e  ude`, `filter_in
-0000dfd0: 636c 7564 6560 2c20 6066 696c 7465 725f  clude`, `filter_
-0000dfe0: 6279 5f73 7472 6561 6d5f 6e61 6d65 602c  by_stream_name`,
-0000dff0: 2060 6c69 6d69 7460 2c20 6074 696d 656f   `limit`, `timeo
-0000e000: 7574 602c 0a61 6e64 2060 6372 6564 656e  ut`,.and `creden
-0000e010: 7469 616c 7360 2e0a 0a54 6865 206f 7074  tials`...The opt
-0000e020: 696f 6e61 6c20 6063 6f6d 6d69 745f 706f  ional `commit_po
-0000e030: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
-0000e040: 2069 7320 6120 5079 7468 6f6e 2060 696e   is a Python `in
-0000e050: 7460 2074 6861 7420 6361 6e20 6265 2075  t` that can be u
-0000e060: 7365 6420 746f 0a73 7065 6369 6679 2061  sed to.specify a
-0000e070: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000e080: 2066 726f 6d20 7768 6963 6820 746f 2073   from which to s
-0000e090: 7461 7274 2072 6561 6469 6e67 2e20 5468  tart reading. Th
-0000e0a0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-0000e0b0: 6f66 0a60 636f 6d6d 6974 5f70 6f73 6974  of.`commit_posit
-0000e0c0: 696f 6e60 2069 7320 604e 6f6e 6560 2e20  ion` is `None`. 
-0000e0d0: 506c 6561 7365 206e 6f74 652c 2069 6620  Please note, if 
-0000e0e0: 6120 636f 6d6d 6974 2070 6f73 6974 696f  a commit positio
-0000e0f0: 6e20 6973 2073 7065 6369 6669 6564 2c0a  n is specified,.
-0000e100: 6974 206d 7573 7420 6265 2061 6e20 6163  it must be an ac
-0000e110: 7475 616c 6c79 2065 7869 7374 696e 6720  tually existing 
-0000e120: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000e130: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
-0000e140: 2057 6865 6e20 7265 6164 696e 670a 666f   When reading.fo
-0000e150: 7277 6172 6473 2c20 7468 6520 6576 656e  rwards, the even
-0000e160: 7420 6174 2074 6865 2063 6f6d 6d69 7420  t at the commit 
-0000e170: 706f 7369 7469 6f6e 206d 6179 2062 6520  position may be 
-0000e180: 696e 636c 7564 6564 2c20 6465 7065 6e64  included, depend
-0000e190: 696e 6720 7570 6f6e 2074 6865 0a66 696c  ing upon the.fil
-0000e1a0: 7465 722e 2057 6865 6e20 7265 6164 696e  ter. When readin
-0000e1b0: 6720 6261 636b 7761 7264 732c 2074 6865  g backwards, the
-0000e1c0: 2065 7665 6e74 2061 7420 7468 6520 636f   event at the co
-0000e1d0: 6d6d 6974 2070 6f73 6974 696f 6e20 7769  mmit position wi
-0000e1e0: 6c6c 206e 6f74 2062 650a 696e 636c 7564  ll not be.includ
-0000e1f0: 6564 2e0a 0a54 6865 206f 7074 696f 6e61  ed...The optiona
-0000e200: 6c20 6062 6163 6b77 6172 6473 6020 6172  l `backwards` ar
-0000e210: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
-0000e220: 6f6e 2060 626f 6f6c 602e 2054 6865 2064  on `bool`. The d
-0000e230: 6566 6175 6c74 206f 6620 6062 6163 6b77  efault of `backw
-0000e240: 6172 6473 6020 6973 0a60 4661 6c73 6560  ards` is.`False`
-0000e250: 2c20 7768 6963 6820 6d65 616e 7320 6576  , which means ev
-0000e260: 656e 7473 2061 7265 2072 6574 7572 6e65  ents are returne
-0000e270: 6420 696e 2074 6865 206f 7264 6572 2074  d in the order t
-0000e280: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
-0000e290: 642c 2049 660a 6062 6163 6b77 6172 6473  d, If.`backwards
-0000e2a0: 6020 6973 2060 5472 7565 602c 2074 6865  ` is `True`, the
-0000e2b0: 6e20 6576 656e 7473 2061 7265 2072 6574  n events are ret
-0000e2c0: 7572 6e65 6420 696e 2072 6576 6572 7365  urned in reverse
-0000e2d0: 206f 7264 6572 2e0a 0a49 6620 6062 6163   order...If `bac
-0000e2e0: 6b77 6172 6473 6020 6973 2060 4661 6c73  kwards` is `Fals
-0000e2f0: 6560 2061 6e64 2060 636f 6d6d 6974 5f70  e` and `commit_p
-0000e300: 6f73 6974 696f 6e60 2069 7320 604e 6f6e  osition` is `Non
-0000e310: 6560 2c20 7468 6520 6461 7461 6261 7365  e`, the database
-0000e320: 2773 2065 7665 6e74 7320 7769 6c6c 0a62  's events will.b
-0000e330: 6520 7265 7475 726e 6564 2069 6e20 7468  e returned in th
-0000e340: 6520 6f72 6465 7220 7468 6579 2077 6572  e order they wer
-0000e350: 6520 7265 636f 7264 6564 2c20 7374 6172  e recorded, star
-0000e360: 7469 6e67 2066 726f 6d20 7468 6520 6669  ting from the fi
-0000e370: 7273 7420 7265 636f 7264 6564 2065 7665  rst recorded eve
-0000e380: 6e74 2e0a 5468 6973 2069 7320 7468 6520  nt..This is the 
-0000e390: 6465 6661 756c 7420 6265 6861 7669 6f72  default behavior
-0000e3a0: 206f 6620 6072 6561 645f 616c 6c28 2960   of `read_all()`
-0000e3b0: 2e20 4966 2060 6261 636b 7761 7264 7360  . If `backwards`
-0000e3c0: 2069 7320 6054 7275 6560 2061 6e64 0a60   is `True` and.`
-0000e3d0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
-0000e3e0: 2069 7320 604e 6f6e 6560 2c20 7468 6520   is `None`, the 
-0000e3f0: 6461 7461 6261 7365 2773 2065 7665 6e74  database's event
-0000e400: 7320 7769 6c6c 2062 6520 7265 7475 726e  s will be return
-0000e410: 6564 2069 6e20 7265 7665 7273 6520 6f72  ed in reverse or
-0000e420: 6465 722c 0a73 7461 7274 696e 6720 6672  der,.starting fr
-0000e430: 6f6d 2074 6865 206c 6173 7420 7265 636f  om the last reco
-0000e440: 7264 6564 2065 7665 6e74 2e0a 0a54 6865  rded event...The
-0000e450: 206f 7074 696f 6e61 6c20 6066 696c 7465   optional `filte
-0000e460: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
-0000e470: 656e 7420 6973 2061 2073 6571 7565 6e63  ent is a sequenc
-0000e480: 6520 6f66 2072 6567 756c 6172 2065 7870  e of regular exp
-0000e490: 7265 7373 696f 6e73 2074 6861 740a 7370  ressions that.sp
-0000e4a0: 6563 6966 6965 7320 7768 6963 6820 7265  ecifies which re
-0000e4b0: 636f 7264 6564 2065 7665 6e74 7320 7368  corded events sh
-0000e4c0: 6f75 6c64 2062 6520 7265 7475 726e 6564  ould be returned
-0000e4d0: 2e20 5468 6973 2061 7267 756d 656e 7420  . This argument 
-0000e4e0: 6973 2069 676e 6f72 6564 0a69 6620 6066  is ignored.if `f
-0000e4f0: 696c 7465 725f 696e 636c 7564 6560 2069  ilter_include` i
-0000e500: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
-0000e510: 6d70 7479 2073 6571 7565 6e63 652e 2054  mpty sequence. T
-0000e520: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-0000e530: 206f 6620 7468 6973 0a61 7267 756d 656e   of this.argumen
-0000e540: 7420 6d61 7463 6865 7320 7468 6520 6576  t matches the ev
-0000e550: 656e 7420 7479 7065 7320 6f66 2045 7665  ent types of Eve
-0000e560: 6e74 5374 6f72 6544 4220 2273 7973 7465  ntStoreDB "syste
-0000e570: 6d20 6576 656e 7473 222c 2073 6f20 7468  m events", so th
-0000e580: 6174 2073 7973 7465 6d0a 6576 656e 7473  at system.events
-0000e590: 2077 696c 6c20 6e6f 7420 6e6f 726d 616c   will not normal
-0000e5a0: 6c79 2062 6520 696e 636c 7564 6564 2e20  ly be included. 
-0000e5b0: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
-0000e5c0: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
-0000e5d0: 6d6f 7265 0a69 6e66 6f72 6d61 7469 6f6e  more.information
-0000e5e0: 2061 626f 7574 2066 696c 7465 7220 6578   about filter ex
-0000e5f0: 7072 6573 7369 6f6e 732e 0a0a 5468 6520  pressions...The 
-0000e600: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
-0000e610: 5f69 6e63 6c75 6465 6020 6172 6775 6d65  _include` argume
-0000e620: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
-0000e630: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
-0000e640: 6573 7369 6f6e 730a 7468 6174 2073 7065  essions.that spe
-0000e650: 6369 6669 6573 2077 6869 6368 2072 6563  cifies which rec
-0000e660: 6f72 6465 6420 6576 656e 7473 2073 686f  orded events sho
-0000e670: 756c 6420 6265 2072 6574 7572 6e65 642e  uld be returned.
-0000e680: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
-0000e690: 730a 6172 6775 6d65 6e74 2069 7320 616e  s.argument is an
-0000e6a0: 2065 6d70 7479 2074 7570 6c65 2e20 4966   empty tuple. If
-0000e6b0: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
-0000e6c0: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
-0000e6d0: 6d70 7479 2073 6571 7565 6e63 652c 0a74  mpty sequence,.t
-0000e6e0: 6865 2060 6669 6c74 6572 5f65 7863 6c75  he `filter_exclu
-0000e6f0: 6465 6020 6172 6775 6d65 6e74 2069 7320  de` argument is 
-0000e700: 6967 6e6f 7265 642e 0a0a 5468 6520 6f70  ignored...The op
-0000e710: 7469 6f6e 616c 2060 6669 6c74 6572 5f62  tional `filter_b
-0000e720: 795f 7374 7265 616d 5f6e 616d 6560 2061  y_stream_name` a
-0000e730: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-0000e740: 686f 6e20 6062 6f6f 6c60 2074 6861 7420  hon `bool` that 
-0000e750: 696e 6469 6361 7465 730a 7768 6574 6865  indicates.whethe
-0000e760: 7220 7468 6520 6669 6c74 6572 696e 6720  r the filtering 
-0000e770: 7769 6c6c 2061 7070 6c79 2074 6f20 6576  will apply to ev
-0000e780: 656e 7420 7479 7065 7320 6f72 2073 7472  ent types or str
-0000e790: 6561 6d20 6e61 6d65 732e 2042 7920 6465  eam names. By de
-0000e7a0: 6661 756c 742c 2074 6869 730a 7661 6c75  fault, this.valu
-0000e7b0: 6520 6973 2060 4661 6c73 6560 2061 6e64  e is `False` and
-0000e7c0: 2073 6f20 7468 6520 6669 6c74 6572 696e   so the filterin
-0000e7d0: 6720 7769 6c6c 2061 7070 6c79 2074 6f20  g will apply to 
-0000e7e0: 7468 6520 6576 656e 7420 7479 7065 2073  the event type s
-0000e7f0: 7472 696e 6773 206f 660a 7265 636f 7264  trings of.record
-0000e800: 6564 2065 7665 6e74 732e 0a0a 5468 6520  ed events...The 
-0000e810: 6f70 7469 6f6e 616c 2060 6c69 6d69 7460  optional `limit`
-0000e820: 2061 7267 756d 656e 7420 6973 2061 6e20   argument is an 
-0000e830: 696e 7465 6765 7220 7768 6963 6820 7265  integer which re
-0000e840: 7374 7269 6374 7320 7468 6520 6e75 6d62  stricts the numb
-0000e850: 6572 206f 6620 6576 656e 7473 2074 6861  er of events tha
-0000e860: 740a 7769 6c6c 2062 6520 7265 7475 726e  t.will be return
-0000e870: 6564 2e20 5468 6520 6465 6661 756c 7420  ed. The default 
-0000e880: 7661 6c75 6520 6973 2060 7379 732e 6d61  value is `sys.ma
-0000e890: 7869 6e74 602e 0a0a 5468 6520 6f70 7469  xint`...The opti
-0000e8a0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-0000e8b0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-0000e8c0: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
-0000e8d0: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
-0000e8e0: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
-0000e8f0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-0000e900: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
-0000e910: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-0000e920: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-0000e930: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
-0000e940: 6f76 6572 7269 6465 2063 616c 6c20 6372  override call cr
-0000e950: 6564 656e 7469 616c 7320 6465 7269 7665  edentials derive
-0000e960: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
-0000e970: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-0000e980: 2e0a 0a54 6865 2066 696c 7465 7269 6e67  ...The filtering
-0000e990: 206f 6620 6576 656e 7473 2069 7320 646f   of events is do
-0000e9a0: 6e65 206f 6e20 7468 6520 4576 656e 7453  ne on the EventS
-0000e9b0: 746f 7265 4442 2073 6572 7665 722e 2054  toreDB server. T
-0000e9c0: 6865 0a60 6c69 6d69 7460 2061 7267 756d  he.`limit` argum
-0000e9d0: 656e 7420 6973 2061 7070 6c69 6564 206f  ent is applied o
-0000e9e0: 6e20 7468 6520 7365 7276 6572 2061 6674  n the server aft
-0000e9f0: 6572 2066 696c 7465 7269 6e67 2e0a 0a54  er filtering...T
-0000ea00: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-0000ea10: 2073 686f 7773 2068 6f77 2074 6f20 6765   shows how to ge
-0000ea20: 7420 616c 6c20 7468 6520 6576 656e 7473  t all the events
-0000ea30: 2077 6520 6861 7665 2072 6563 6f72 6465   we have recorde
-0000ea40: 6420 696e 2074 6865 2064 6174 6162 6173  d in the databas
-0000ea50: 650a 736f 2066 6172 2c20 696e 2074 6865  e.so far, in the
-0000ea60: 206f 7264 6572 2074 6865 7920 7765 7265   order they were
-0000ea70: 2072 6563 6f72 6465 642e 2057 6520 6361   recorded. We ca
-0000ea80: 6e20 7365 6520 7468 6520 7468 7265 6520  n see the three 
-0000ea90: 6576 656e 7473 206f 6620 6073 7472 6561  events of `strea
-0000eaa0: 6d5f 6e61 6d65 3160 0a28 6065 7665 6e74  m_name1`.(`event
-0000eab0: 3160 2c20 6065 7665 6e74 3260 2061 6e64  1`, `event2` and
-0000eac0: 2060 6576 656e 7433 6029 2061 7265 2069   `event3`) are i
-0000ead0: 6e63 6c75 6465 642c 2061 6c6f 6e67 2077  ncluded, along w
-0000eae0: 6974 6820 6f74 6865 7273 2e0a 0a60 6060  ith others...```
-0000eaf0: 7079 7468 6f6e 0a23 2052 6561 6420 616c  python.# Read al
-0000eb00: 6c20 6576 656e 7473 2028 6372 6561 7465  l events (create
-0000eb10: 7320 6120 7374 7265 616d 696e 6720 6752  s a streaming gR
-0000eb20: 5043 2063 616c 6c29 2e0a 7265 6164 5f72  PC call)..read_r
-0000eb30: 6573 706f 6e73 6520 3d20 636c 6965 6e74  esponse = client
-0000eb40: 2e72 6561 645f 616c 6c28 290a 0a23 2043  .read_all()..# C
-0000eb50: 6f6e 7665 7274 2074 6865 2069 7465 7261  onvert the itera
-0000eb60: 746f 7220 696e 746f 2061 2073 6571 7565  tor into a seque
-0000eb70: 6e63 6520 6f66 2072 6563 6f72 6465 6420  nce of recorded 
-0000eb80: 6576 656e 7473 2e0a 6576 656e 7473 203d  events..events =
-0000eb90: 2074 7570 6c65 2872 6561 645f 7265 7370   tuple(read_resp
-0000eba0: 6f6e 7365 290a 6173 7365 7274 206c 656e  onse).assert len
-0000ebb0: 2865 7665 6e74 7329 203e 2033 2020 2320  (events) > 3  # 
-0000ebc0: 6d6f 7265 2074 6861 6e20 7468 7265 650a  more than three.
-0000ebd0: 0a23 2043 6f6e 7665 7274 2074 6865 2073  .# Convert the s
-0000ebe0: 6571 7565 6e63 6520 6f66 2072 6563 6f72  equence of recor
-0000ebf0: 6465 6420 6576 656e 7473 2069 6e74 6f20  ded events into 
-0000ec00: 6120 7365 7420 6f66 2065 7665 6e74 2049  a set of event I
-0000ec10: 4473 2e0a 6576 656e 745f 6964 7320 3d20  Ds..event_ids = 
-0000ec20: 7365 7428 652e 6964 2066 6f72 2065 2069  set(e.id for e i
-0000ec30: 6e20 6576 656e 7473 290a 6173 7365 7274  n events).assert
-0000ec40: 2065 7665 6e74 312e 6964 2069 6e20 6576   event1.id in ev
-0000ec50: 656e 745f 6964 730a 6173 7365 7274 2065  ent_ids.assert e
-0000ec60: 7665 6e74 322e 6964 2069 6e20 6576 656e  vent2.id in even
-0000ec70: 745f 6964 730a 6173 7365 7274 2065 7665  t_ids.assert eve
-0000ec80: 6e74 332e 6964 2069 6e20 6576 656e 745f  nt3.id in event_
-0000ec90: 6964 730a 6060 600a 0a54 6865 2065 7861  ids.```..The exa
-0000eca0: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-0000ecb0: 2068 6f77 2074 6f20 7265 6164 2061 6c6c   how to read all
-0000ecc0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-0000ecd0: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
-0000ece0: 2066 726f 6d0a 6120 7061 7274 6963 756c   from.a particul
-0000ecf0: 6172 2063 6f6d 6d69 7420 706f 7369 7469  ar commit positi
-0000ed00: 6f6e 2c20 696e 2074 6869 7320 6361 7365  on, in this case
-0000ed10: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
-0000ed20: 6e31 602e 2057 6865 6e20 7265 6164 696e  n1`. When readin
-0000ed30: 670a 666f 7277 6172 6473 2066 726f 6d20  g.forwards from 
-0000ed40: 6120 7370 6563 6966 6963 2063 6f6d 6d69  a specific commi
-0000ed50: 7420 706f 7369 7469 6f6e 2c20 7468 6520  t position, the 
-0000ed60: 6576 656e 7420 6174 2074 6865 2073 7065  event at the spe
-0000ed70: 6369 6669 6564 2070 6f73 6974 696f 6e0a  cified position.
-0000ed80: 7769 6c6c 2062 6520 696e 636c 7564 6564  will be included
-0000ed90: 2e20 5468 6520 7661 6c75 6520 6f66 2060  . The value of `
-0000eda0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e31  commit_position1
-0000edb0: 6020 6973 2074 6865 2070 6f73 6974 696f  ` is the positio
-0000edc0: 6e20 7765 206f 6274 6169 6e65 640a 7768  n we obtained.wh
-0000edd0: 656e 2061 7070 656e 6469 6e67 2060 6576  en appending `ev
-0000ede0: 656e 7431 602e 2041 6e64 2073 6f20 6065  ent1`. And so `e
-0000edf0: 7665 6e74 3160 2069 7320 7468 6520 6669  vent1` is the fi
-0000ee00: 7273 7420 7265 636f 7264 6564 2065 7665  rst recorded eve
-0000ee10: 6e74 2077 6520 7368 616c 6c0a 7265 6365  nt we shall.rece
-0000ee20: 6976 652c 2060 6576 656e 7432 6020 6973  ive, `event2` is
-0000ee30: 2074 6865 2073 6563 6f6e 642c 2061 6e64   the second, and
-0000ee40: 2060 6576 656e 7433 6020 6973 2074 6865   `event3` is the
-0000ee50: 2074 6869 7264 2e0a 0a60 6060 7079 7468   third...```pyth
-0000ee60: 6f6e 0a23 2052 6561 6420 616c 6c20 6576  on.# Read all ev
-0000ee70: 656e 7473 2066 6f72 7761 7264 7320 6672  ents forwards fr
-0000ee80: 6f6d 2061 2063 6f6d 6d69 7420 706f 7369  om a commit posi
-0000ee90: 7469 6f6e 2e0a 7265 6164 5f72 6573 706f  tion..read_respo
-0000eea0: 6e73 6520 3d20 636c 6965 6e74 2e72 6561  nse = client.rea
-0000eeb0: 645f 616c 6c28 0a20 2020 2063 6f6d 6d69  d_all(.    commi
-0000eec0: 745f 706f 7369 7469 6f6e 3d63 6f6d 6d69  t_position=commi
-0000eed0: 745f 706f 7369 7469 6f6e 310a 290a 0a23  t_position1.)..#
-0000eee0: 2053 7465 7020 7468 726f 7567 6820 7468   Step through th
-0000eef0: 6520 2272 6561 6420 7265 7370 6f6e 7365  e "read response
-0000ef00: 2220 6974 6572 6174 6f72 2e0a 6173 7365  " iterator..asse
-0000ef10: 7274 206e 6578 7428 7265 6164 5f72 6573  rt next(read_res
-0000ef20: 706f 6e73 6529 2e69 6420 3d3d 2065 7665  ponse).id == eve
-0000ef30: 6e74 312e 6964 0a61 7373 6572 7420 6e65  nt1.id.assert ne
-0000ef40: 7874 2872 6561 645f 7265 7370 6f6e 7365  xt(read_response
-0000ef50: 292e 6964 203d 3d20 6576 656e 7432 2e69  ).id == event2.i
-0000ef60: 640a 6173 7365 7274 206e 6578 7428 7265  d.assert next(re
-0000ef70: 6164 5f72 6573 706f 6e73 6529 2e69 6420  ad_response).id 
-0000ef80: 3d3d 2065 7665 6e74 332e 6964 0a0a 2320  == event3.id..# 
-0000ef90: 5374 6f70 2074 6865 2069 7465 7261 746f  Stop the iterato
-0000efa0: 722e 0a72 6561 645f 7265 7370 6f6e 7365  r..read_response
-0000efb0: 2e73 746f 7028 290a 6060 600a 0a54 6865  .stop().```..The
-0000efc0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-0000efd0: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
-0000efe0: 2061 6c6c 2065 7665 6e74 7320 7265 636f   all events reco
-0000eff0: 7264 6564 2069 6e20 7468 6520 6461 7461  rded in the data
-0000f000: 6261 7365 2069 6e20 7265 7665 7273 650a  base in reverse.
-0000f010: 6f72 6465 722e 2057 6520 6361 6e20 7365  order. We can se
-0000f020: 6520 7468 6174 2074 6865 2066 6972 7374  e that the first
-0000f030: 2065 7665 6e74 7320 7765 2072 6563 6569   events we recei
-0000f040: 7665 2061 7265 2074 6865 206c 6173 7420  ve are the last 
-0000f050: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
-0000f060: 0a72 6563 6f72 6465 643a 2074 6865 2065  .recorded: the e
-0000f070: 7665 6e74 7320 6f66 2074 6865 2060 446f  vents of the `Do
-0000f080: 6760 2061 6767 7265 6761 7465 2066 726f  g` aggregate fro
-0000f090: 6d20 7468 6520 7365 6374 696f 6e20 6162  m the section ab
-0000f0a0: 6f75 7420 736e 6170 7368 6f74 7469 6e67  out snapshotting
-0000f0b0: 0a61 6e64 2074 6865 2073 6e61 7073 686f  .and the snapsho
-0000f0c0: 742e 0a0a 6060 6070 7974 686f 6e0a 2320  t...```python.# 
-0000f0d0: 5265 6164 2061 6c6c 2065 7665 6e74 7320  Read all events 
-0000f0e0: 6261 636b 7761 7264 7320 6672 6f6d 2074  backwards from t
-0000f0f0: 6865 2065 6e64 2e0a 7265 6164 5f72 6573  he end..read_res
-0000f100: 706f 6e73 6520 3d20 636c 6965 6e74 2e72  ponse = client.r
-0000f110: 6561 645f 616c 6c28 0a20 2020 2062 6163  ead_all(.    bac
-0000f120: 6b77 6172 6473 3d54 7275 650a 290a 0a23  kwards=True.)..#
-0000f130: 2053 7465 7020 7468 726f 7567 6820 7468   Step through th
-0000f140: 6520 2272 6561 6420 7265 7370 6f6e 7365  e "read response
-0000f150: 2220 6974 6572 6174 6f72 2e0a 6173 7365  " iterator..asse
-0000f160: 7274 206e 6578 7428 7265 6164 5f72 6573  rt next(read_res
-0000f170: 706f 6e73 6529 2e74 7970 6520 3d3d 2022  ponse).type == "
-0000f180: 446f 674c 6561 726e 6564 5472 6963 6b22  DogLearnedTrick"
-0000f190: 0a61 7373 6572 7420 6e65 7874 2872 6561  .assert next(rea
-0000f1a0: 645f 7265 7370 6f6e 7365 292e 7479 7065  d_response).type
-0000f1b0: 203d 3d20 2253 6e61 7073 686f 7422 0a61   == "Snapshot".a
-0000f1c0: 7373 6572 7420 6e65 7874 2872 6561 645f  ssert next(read_
-0000f1d0: 7265 7370 6f6e 7365 292e 7479 7065 203d  response).type =
-0000f1e0: 3d20 2244 6f67 4c65 6172 6e65 6454 7269  = "DogLearnedTri
-0000f1f0: 636b 220a 6173 7365 7274 206e 6578 7428  ck".assert next(
-0000f200: 7265 6164 5f72 6573 706f 6e73 6529 2e74  read_response).t
-0000f210: 7970 6520 3d3d 2022 446f 674c 6561 726e  ype == "DogLearn
-0000f220: 6564 5472 6963 6b22 0a61 7373 6572 7420  edTrick".assert 
-0000f230: 6e65 7874 2872 6561 645f 7265 7370 6f6e  next(read_respon
-0000f240: 7365 292e 7479 7065 203d 3d20 2244 6f67  se).type == "Dog
-0000f250: 5265 6769 7374 6572 6564 220a 0a23 2053  Registered"..# S
-0000f260: 746f 7020 7468 6520 6974 6572 6174 6f72  top the iterator
-0000f270: 2e0a 7265 6164 5f72 6573 706f 6e73 652e  ..read_response.
-0000f280: 7374 6f70 2829 0a60 6060 0a0a 5468 6520  stop().```..The 
-0000f290: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-0000f2a0: 6f77 7320 686f 7720 746f 2072 6561 6420  ows how to read 
-0000f2b0: 6120 6c69 6d69 7465 6420 6e75 6d62 6572  a limited number
-0000f2c0: 206f 6620 6576 656e 7473 0a66 6f72 7761   of events.forwa
-0000f2d0: 7264 7320 6672 6f6d 2061 2073 7065 6369  rds from a speci
-0000f2e0: 6669 6320 636f 6d6d 6974 2070 6f73 6974  fic commit posit
-0000f2f0: 696f 6e2e 0a0a 6060 6070 7974 686f 6e0a  ion...```python.
-0000f300: 6576 656e 7473 203d 2074 7570 6c65 280a  events = tuple(.
-0000f310: 2020 2020 636c 6965 6e74 2e72 6561 645f      client.read_
-0000f320: 616c 6c28 0a20 2020 2020 2020 2063 6f6d  all(.        com
-0000f330: 6d69 745f 706f 7369 7469 6f6e 3d63 6f6d  mit_position=com
-0000f340: 6d69 745f 706f 7369 7469 6f6e 312c 0a20  mit_position1,. 
-0000f350: 2020 2020 2020 206c 696d 6974 3d31 2c0a         limit=1,.
-0000f360: 2020 2020 290a 290a 0a61 7373 6572 7420      ).)..assert 
-0000f370: 6c65 6e28 6576 656e 7473 2920 3d3d 2031  len(events) == 1
-0000f380: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
-0000f390: 5d2e 6964 203d 3d20 6576 656e 7431 2e69  ].id == event1.i
-0000f3a0: 640a 6060 600a 0a54 6865 2065 7861 6d70  d.```..The examp
-0000f3b0: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
-0000f3c0: 6f77 2074 6f20 7265 6164 2061 206c 696d  ow to read a lim
-0000f3d0: 6974 6564 206e 756d 6265 7220 6f66 2074  ited number of t
-0000f3e0: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-0000f3f0: 7473 0a69 6e20 7468 6520 6461 7461 6261  ts.in the databa
-0000f400: 7365 2062 6163 6b77 6172 6473 2066 726f  se backwards fro
-0000f410: 6d20 7468 6520 656e 642e 2049 6e20 7468  m the end. In th
-0000f420: 6973 2063 6173 652c 2074 6865 206c 696d  is case, the lim
-0000f430: 6974 2069 7320 312c 2061 6e64 0a73 6f20  it is 1, and.so 
-0000f440: 7765 2072 6563 6569 7665 2074 6865 206c  we receive the l
-0000f450: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
-0000f460: 6e74 2e0a 0a60 6060 7079 7468 6f6e 0a65  nt...```python.e
-0000f470: 7665 6e74 7320 3d20 7475 706c 6528 0a20  vents = tuple(. 
-0000f480: 2020 2063 6c69 656e 742e 7265 6164 5f61     client.read_a
-0000f490: 6c6c 280a 2020 2020 2020 2020 6261 636b  ll(.        back
-0000f4a0: 7761 7264 733d 5472 7565 2c0a 2020 2020  wards=True,.    
-0000f4b0: 2020 2020 6c69 6d69 743d 312c 0a20 2020      limit=1,.   
-0000f4c0: 2029 0a29 0a0a 6173 7365 7274 206c 656e   ).)..assert len
-0000f4d0: 2865 7665 6e74 7329 203d 3d20 310a 0a61  (events) == 1..a
-0000f4e0: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-0000f4f0: 7479 7065 203d 3d20 2744 6f67 4c65 6172  type == 'DogLear
-0000f500: 6e65 6454 7269 636b 270a 6173 7365 7274  nedTrick'.assert
-0000f510: 2064 6573 6572 6961 6c69 7a65 2865 7665   deserialize(eve
-0000f520: 6e74 735b 305d 2e64 6174 6129 5b27 7472  nts[0].data)['tr
-0000f530: 6963 6b27 5d20 3d3d 2027 7369 7427 0a60  ick'] == 'sit'.`
-0000f540: 6060 0a0a 506c 6561 7365 206e 6f74 652c  ``..Please note,
-0000f550: 206c 696b 6520 7468 6520 6072 6561 645f   like the `read_
-0000f560: 7374 7265 616d 2829 6020 6d65 7468 6f64  stream()` method
-0000f570: 2c20 7468 6520 6072 6561 645f 616c 6c28  , the `read_all(
-0000f580: 2960 206d 6574 686f 640a 6973 206e 6f74  )` method.is not
-0000f590: 2064 6563 6f72 6174 6564 2077 6974 6820   decorated with 
-0000f5a0: 7265 7472 7920 616e 6420 7265 636f 6e6e  retry and reconn
-0000f5b0: 6563 7420 6465 636f 7261 746f 7273 2c20  ect decorators, 
-0000f5c0: 6265 6361 7573 6520 7468 6520 7374 7265  because the stre
-0000f5d0: 616d 696e 6720 6f66 2072 6563 6f72 6465  aming of recorde
-0000f5e0: 640a 6576 656e 7473 2066 726f 6d20 7468  d.events from th
-0000f5f0: 6520 7365 7276 6572 206f 6e6c 7920 7374  e server only st
-0000f600: 6172 7473 2077 6865 6e20 6974 6572 6174  arts when iterat
-0000f610: 696e 6720 6f76 6572 2074 6865 2022 7265  ing over the "re
-0000f620: 6164 2072 6573 706f 6e73 6522 2073 7461  ad response" sta
-0000f630: 7274 732c 2077 6869 6368 0a6d 6561 6e73  rts, which.means
-0000f640: 2074 6861 7420 7468 6520 6d65 7468 6f64   that the method
-0000f650: 2072 6574 7572 6e73 2062 6566 6f72 6520   returns before 
-0000f660: 7468 6520 7374 7265 616d 696e 6720 7374  the streaming st
-0000f670: 6172 7473 2c20 616e 6420 736f 2074 6865  arts, and so the
-0000f680: 7265 2069 7320 6e6f 2063 6861 6e63 6520  re is no chance 
-0000f690: 666f 720a 616e 7920 6465 636f 7261 746f  for.any decorato
-0000f6a0: 7273 2074 6f20 6361 7463 6820 616e 7920  rs to catch any 
-0000f6b0: 636f 6e6e 6563 7469 6f6e 2069 7373 7565  connection issue
-0000f6c0: 732e 0a0a 2323 2320 4765 7420 636f 6d6d  s...### Get comm
-0000f6d0: 6974 2070 6f73 6974 696f 6e0a 0a54 6865  it position..The
-0000f6e0: 2060 6765 745f 636f 6d6d 6974 5f70 6f73   `get_commit_pos
-0000f6f0: 6974 696f 6e28 2960 206d 6574 686f 6420  ition()` method 
-0000f700: 6361 6e20 6265 2075 7365 6420 746f 2067  can be used to g
-0000f710: 6574 2074 6865 2063 6f6d 6d69 7420 706f  et the commit po
-0000f720: 7369 7469 6f6e 206f 6620 7468 650a 6c61  sition of the.la
-0000f730: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
-0000f740: 7420 696e 2074 6865 2064 6174 6162 6173  t in the databas
-0000f750: 652e 2049 7420 7369 6d70 6c79 2063 616c  e. It simply cal
-0000f760: 6c73 2060 7265 6164 5f61 6c6c 2829 6020  ls `read_all()` 
-0000f770: 7769 7468 0a60 6261 636b 7761 7264 733d  with.`backwards=
-0000f780: 5472 7565 6020 616e 6420 606c 696d 6974  True` and `limit
-0000f790: 3d31 602c 2061 6e64 2072 6574 7572 6e73  =1`, and returns
-0000f7a0: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
-0000f7b0: 6520 6063 6f6d 6d69 745f 706f 7369 7469  e `commit_positi
-0000f7c0: 6f6e 600a 6174 7472 6962 7574 6520 6f66  on`.attribute of
-0000f7d0: 2074 6865 206c 6173 7420 7265 636f 7264   the last record
-0000f7e0: 6564 2065 7665 6e74 2e0a 0a60 6060 7079  ed event...```py
-0000f7f0: 7468 6f6e 0a63 6f6d 6d69 745f 706f 7369  thon.commit_posi
-0000f800: 7469 6f6e 203d 2063 6c69 656e 742e 6765  tion = client.ge
-0000f810: 745f 636f 6d6d 6974 5f70 6f73 6974 696f  t_commit_positio
-0000f820: 6e28 290a 6060 600a 0a54 6869 7320 6d65  n().```..This me
-0000f830: 7468 6f64 2068 6173 2066 6976 6520 6f70  thod has five op
-0000f840: 7469 6f6e 616c 2061 7267 756d 656e 7473  tional arguments
-0000f850: 2c20 6066 696c 7465 725f 6578 636c 7564  , `filter_exclud
-0000f860: 6560 2c20 6066 696c 7465 725f 696e 636c  e`, `filter_incl
-0000f870: 7564 6560 2c0a 6066 696c 7465 725f 6279  ude`,.`filter_by
-0000f880: 5f73 7472 6561 6d5f 6e61 6d65 602c 2060  _stream_name`, `
-0000f890: 7469 6d65 6f75 7460 2061 6e64 2060 6372  timeout` and `cr
-0000f8a0: 6564 656e 7469 616c 7360 2e20 5468 6573  edentials`. Thes
-0000f8b0: 6520 7661 6c75 6573 2061 7265 2070 6173  e values are pas
-0000f8c0: 7365 6420 746f 0a60 7265 6164 5f61 6c6c  sed to.`read_all
-0000f8d0: 2829 602e 0a0a 5468 6520 6f70 7469 6f6e  ()`...The option
-0000f8e0: 616c 2060 6669 6c74 6572 5f65 7863 6c75  al `filter_exclu
-0000f8f0: 6465 602c 2060 6669 6c74 6572 5f69 6e63  de`, `filter_inc
-0000f900: 6c75 6465 6020 616e 6420 6066 696c 7465  lude` and `filte
-0000f910: 725f 6279 5f73 7472 6561 6d5f 6e61 6d65  r_by_stream_name
-0000f920: 6020 6172 6775 6d65 6e74 730a 776f 726b  ` arguments.work
-0000f930: 2069 6e20 7468 6520 7361 6d65 2077 6179   in the same way
-0000f940: 2061 7320 7468 6579 2064 6f20 696e 2074   as they do in t
-0000f950: 6865 2060 7265 6164 5f61 6c6c 2829 6020  he `read_all()` 
-0000f960: 6d65 7468 6f64 2e0a 0a54 6865 206f 7074  method...The opt
-0000f970: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-0000f980: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-0000f990: 7468 6f6e 2060 666c 6f61 7460 2074 6861  thon `float` tha
-0000f9a0: 7420 7365 7473 0a61 2064 6561 646c 696e  t sets.a deadlin
-0000f9b0: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
-0000f9c0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-0000f9d0: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
-0000f9e0: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-0000f9f0: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-0000fa00: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-0000fa10: 6f76 6572 7269 6465 2063 616c 6c20 6372  override call cr
-0000fa20: 6564 656e 7469 616c 730a 6465 7269 7665  edentials.derive
-0000fa30: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
-0000fa40: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-0000fa50: 2e0a 0a54 6869 7320 6d65 7468 6f64 206d  ...This method m
-0000fa60: 6967 6874 2062 6520 7573 6564 2074 6f20  ight be used to 
-0000fa70: 6d65 6173 7572 6520 7072 6f67 7265 7373  measure progress
-0000fa80: 206f 6620 6120 646f 776e 7374 7265 616d   of a downstream
-0000fa90: 2063 6f6d 706f 6e65 6e74 0a74 6861 7420   component.that 
-0000faa0: 6973 2070 726f 6365 7373 696e 6720 616c  is processing al
-0000fab0: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
-0000fac0: 732c 2062 7920 636f 6d70 6172 696e 6720  s, by comparing 
-0000fad0: 7468 6520 6375 7272 656e 7420 636f 6d6d  the current comm
-0000fae0: 6974 0a70 6f73 6974 696f 6e20 7769 7468  it.position with
-0000faf0: 2074 6865 2072 6563 6f72 6465 6420 636f   the recorded co
-0000fb00: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
-0000fb10: 2074 6865 206c 6173 7420 7375 6363 6573   the last succes
-0000fb20: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
-0000fb30: 0a65 7665 6e74 2069 6e20 6120 646f 776e  .event in a down
-0000fb40: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-0000fb50: 2e20 496e 2074 6869 7320 6361 7365 2c20  . In this case, 
-0000fb60: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
-0000fb70: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
-0000fb80: 602c 0a60 6669 6c74 6572 5f69 6e63 6c75  `,.`filter_inclu
-0000fb90: 6465 6020 616e 6420 6066 696c 7465 725f  de` and `filter_
-0000fba0: 6279 5f73 7472 6561 6d5f 6e61 6d65 6020  by_stream_name` 
-0000fbb0: 6172 6775 6d65 6e74 7320 7368 6f75 6c64  arguments should
-0000fbc0: 2065 7175 616c 2074 686f 7365 2075 7365   equal those use
-0000fbd0: 640a 6279 2074 6865 2064 6f77 6e73 7472  d.by the downstr
-0000fbe0: 6561 6d20 636f 6d70 6f6e 656e 7420 746f  eam component to
-0000fbf0: 206f 6274 6169 6e20 7265 636f 7264 6564   obtain recorded
-0000fc00: 2065 7665 6e74 732e 0a0a 0a23 2323 2047   events....### G
-0000fc10: 6574 2073 7472 6561 6d20 6d65 7461 6461  et stream metada
-0000fc20: 7461 0a0a 5468 6520 6067 6574 5f73 7472  ta..The `get_str
-0000fc30: 6561 6d5f 6d65 7461 6461 7461 2829 6020  eam_metadata()` 
-0000fc40: 6d65 7468 6f64 2072 6574 7572 6e73 2074  method returns t
-0000fc50: 6865 206d 6574 6164 6174 6120 666f 7220  he metadata for 
-0000fc60: 6120 7374 7265 616d 2c20 616c 6f6e 670a  a stream, along.
-0000fc70: 7769 7468 2074 6865 2076 6572 7369 6f6e  with the version
-0000fc80: 206f 6620 7468 6520 7374 7265 616d 206d   of the stream m
-0000fc90: 6574 6164 6174 612e 0a0a 5468 6973 206d  etadata...This m
-0000fca0: 6574 686f 6420 6861 7320 6f6e 6520 7265  ethod has one re
-0000fcb0: 7175 6972 6564 2061 7267 756d 656e 742c  quired argument,
-0000fcc0: 2060 7374 7265 616d 5f6e 616d 6560 2c20   `stream_name`, 
-0000fcd0: 7768 6963 6820 6973 2061 2050 7974 686f  which is a Pytho
-0000fce0: 6e20 6073 7472 6020 7468 6174 0a75 6e69  n `str` that.uni
-0000fcf0: 7175 656c 7920 6964 656e 7469 6669 6573  quely identifies
-0000fd00: 2061 2073 7472 6561 6d20 666f 7220 7768   a stream for wh
-0000fd10: 6963 6820 6120 7374 7265 616d 206d 6574  ich a stream met
-0000fd20: 6164 6174 6120 7769 6c6c 2062 6520 6f62  adata will be ob
-0000fd30: 7461 696e 6564 2e0a 0a54 6869 7320 6d65  tained...This me
-0000fd40: 7468 6f64 2068 6173 2061 6e20 6f70 7469  thod has an opti
-0000fd50: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-0000fd60: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
-0000fd70: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
-0000fd80: 7460 2074 6861 7420 7365 7473 0a61 2064  t` that sets.a d
-0000fd90: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-0000fda0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-0000fdb0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-0000fdc0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
-0000fdd0: 6173 2061 6e20 6f70 7469 6f6e 616c 2060  as an optional `
-0000fde0: 6372 6564 656e 7469 616c 7360 2061 7267  credentials` arg
-0000fdf0: 756d 656e 742c 2077 6869 6368 2063 616e  ument, which can
-0000fe00: 2062 6520 7573 6564 2074 6f0a 6f76 6572   be used to.over
-0000fe10: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
-0000fe20: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
-0000fe30: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
-0000fe40: 6e20 7374 7269 6e67 2055 5249 2e0a 0a49  n string URI...I
-0000fe50: 6e20 7468 6520 6578 616d 706c 6520 6265  n the example be
-0000fe60: 6c6f 772c 206d 6574 6164 6174 6120 666f  low, metadata fo
-0000fe70: 7220 6073 7472 6561 6d5f 6e61 6d65 3160  r `stream_name1`
-0000fe80: 2069 7320 6f62 7461 696e 6564 2e0a 0a60   is obtained...`
-0000fe90: 6060 7079 7468 6f6e 0a6d 6574 6164 6174  ``python.metadat
-0000fea0: 612c 206d 6574 6164 6174 615f 7665 7273  a, metadata_vers
-0000feb0: 696f 6e20 3d20 636c 6965 6e74 2e67 6574  ion = client.get
-0000fec0: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
-0000fed0: 2873 7472 6561 6d5f 6e61 6d65 3d73 7472  (stream_name=str
-0000fee0: 6561 6d5f 6e61 6d65 3129 0a60 6060 0a0a  eam_name1).```..
-0000fef0: 5468 6520 7265 7475 726e 6564 2060 6d65  The returned `me
-0000ff00: 7461 6461 7461 6020 7661 6c75 6520 6973  tadata` value is
-0000ff10: 2061 2050 7974 686f 6e20 6064 6963 7460   a Python `dict`
-0000ff20: 2e20 5468 6520 7265 7475 726e 6564 2060  . The returned `
-0000ff30: 6d65 7461 6461 7461 5f76 6572 7369 6f6e  metadata_version
-0000ff40: 600a 7661 6c75 6520 6973 2065 6974 6865  `.value is eithe
-0000ff50: 7220 616e 2060 696e 7460 2069 6620 7468  r an `int` if th
-0000ff60: 6520 7374 7265 616d 2065 7869 7374 732c  e stream exists,
-0000ff70: 206f 7220 6053 7472 6561 6d53 7461 7465   or `StreamState
-0000ff80: 2e4e 4f5f 5354 5245 414d 6020 6966 2074  .NO_STREAM` if t
-0000ff90: 6865 2073 7472 6561 6d0a 646f 6573 206e  he stream.does n
-0000ffa0: 6f74 2065 7869 7374 2061 6e64 206e 6f20  ot exist and no 
-0000ffb0: 6d65 7461 6461 7461 2068 6173 2062 6565  metadata has bee
-0000ffc0: 6e20 7365 742e 2054 6865 7365 2076 616c  n set. These val
-0000ffd0: 7565 7320 6361 6e20 6265 2075 7365 6420  ues can be used 
-0000ffe0: 6173 2074 6865 2061 7267 756d 656e 7473  as the arguments
-0000fff0: 0a6f 6620 6073 6574 5f73 7472 6561 6d5f  .of `set_stream_
-00010000: 6d65 7461 6461 7461 2829 602e 0a0a 2323  metadata()`...##
-00010010: 2320 5365 7420 7374 7265 616d 206d 6574  # Set stream met
-00010020: 6164 6174 610a 0a2a 7265 7175 6972 6573  adata..*requires
-00010030: 206c 6561 6465 722a 0a0a 5468 6520 6d65   leader*..The me
-00010040: 7468 6f64 2060 7365 745f 7374 7265 616d  thod `set_stream
-00010050: 5f6d 6574 6164 6174 6128 2960 2073 6574  _metadata()` set
-00010060: 7320 6d65 7461 6461 7461 2066 6f72 2061  s metadata for a
-00010070: 2073 7472 6561 6d2e 2053 7472 6561 6d20   stream. Stream 
-00010080: 6d65 7461 6461 7461 0a63 616e 2062 6520  metadata.can be 
-00010090: 7365 7420 6265 666f 7265 2061 7070 656e  set before appen
-000100a0: 6469 6e67 2065 7665 6e74 7320 746f 2061  ding events to a
-000100b0: 2073 7472 6561 6d2e 0a0a 5468 6973 206d   stream...This m
-000100c0: 6574 686f 6420 6861 7320 6f6e 6520 7265  ethod has one re
-000100d0: 7175 6972 6564 2061 7267 756d 656e 742c  quired argument,
-000100e0: 2060 7374 7265 616d 5f6e 616d 6560 2c20   `stream_name`, 
-000100f0: 7768 6963 6820 6973 2061 2050 7974 686f  which is a Pytho
-00010100: 6e20 6073 7472 6020 7468 6174 0a75 6e69  n `str` that.uni
-00010110: 7175 656c 7920 6964 656e 7469 6669 6573  quely identifies
-00010120: 2061 2073 7472 6561 6d20 666f 7220 7768   a stream for wh
-00010130: 6963 6820 6120 7374 7265 616d 206d 6574  ich a stream met
-00010140: 6164 6174 6120 7769 6c6c 2062 6520 7365  adata will be se
-00010150: 742e 0a0a 5468 6973 206d 6574 686f 6420  t...This method 
-00010160: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
-00010170: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-00010180: 6e74 2c20 7768 6963 6820 6973 2061 2050  nt, which is a P
-00010190: 7974 686f 6e20 6066 6c6f 6174 6020 7468  ython `float` th
-000101a0: 6174 2073 6574 730a 6120 6465 6164 6c69  at sets.a deadli
-000101b0: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
-000101c0: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
-000101d0: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
-000101e0: 6973 206d 6574 686f 6420 6861 7320 616e  is method has an
-000101f0: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-00010200: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-00010210: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
-00010220: 7365 6420 746f 0a6f 7665 7272 6964 6520  sed to.override 
-00010230: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
-00010240: 2064 6572 6976 6564 2066 726f 6d20 7468   derived from th
-00010250: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
-00010260: 696e 6720 5552 492e 0a0a 496e 2074 6865  ing URI...In the
-00010270: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
-00010280: 6d65 7461 6461 7461 2066 6f72 2060 7374  metadata for `st
-00010290: 7265 616d 5f6e 616d 6531 6020 6973 2073  ream_name1` is s
-000102a0: 6574 2e0a 0a0a 6060 6070 7974 686f 6e0a  et....```python.
-000102b0: 6d65 7461 6461 7461 5b22 666f 6f22 5d20  metadata["foo"] 
-000102c0: 3d20 2262 6172 220a 0a63 6c69 656e 742e  = "bar"..client.
-000102d0: 7365 745f 7374 7265 616d 5f6d 6574 6164  set_stream_metad
-000102e0: 6174 6128 0a20 2020 2073 7472 6561 6d5f  ata(.    stream_
-000102f0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00010300: 312c 0a20 2020 206d 6574 6164 6174 613d  1,.    metadata=
-00010310: 6d65 7461 6461 7461 2c0a 2020 2020 6375  metadata,.    cu
-00010320: 7272 656e 745f 7665 7273 696f 6e3d 6d65  rrent_version=me
-00010330: 7461 6461 7461 5f76 6572 7369 6f6e 2c0a  tadata_version,.
-00010340: 290a 6060 600a 0a54 6865 2060 6375 7272  ).```..The `curr
-00010350: 656e 745f 7665 7273 696f 6e60 2061 7267  ent_version` arg
-00010360: 756d 656e 7420 7368 6f75 6c64 2062 6520  ument should be 
-00010370: 7468 6520 6375 7272 656e 7420 7665 7273  the current vers
-00010380: 696f 6e20 6f66 2074 6865 2073 7472 6561  ion of the strea
-00010390: 6d20 6d65 7461 6461 7461 0a6f 6274 6169  m metadata.obtai
-000103a0: 6e65 6420 6672 6f6d 2060 6765 745f 7374  ned from `get_st
-000103b0: 7265 616d 5f6d 6574 6164 6174 6128 2960  ream_metadata()`
-000103c0: 2e0a 0a50 6c65 6173 6520 7265 6665 7220  ...Please refer 
-000103d0: 746f 2074 6865 2045 7665 6e74 5374 6f72  to the EventStor
-000103e0: 6544 4220 646f 6375 6d65 6e74 6174 696f  eDB documentatio
-000103f0: 6e20 666f 7220 6d6f 7265 2069 6e66 6f72  n for more infor
-00010400: 6d61 7469 6f6e 2061 626f 7574 2073 7472  mation about str
-00010410: 6561 6d0a 6d65 7461 6461 7461 2e0a 0a23  eam.metadata...#
-00010420: 2323 2044 656c 6574 6520 7374 7265 616d  ## Delete stream
-00010430: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
-00010440: 6572 2a0a 0a54 6865 206d 6574 686f 6420  er*..The method 
-00010450: 6064 656c 6574 655f 7374 7265 616d 2829  `delete_stream()
-00010460: 6020 6361 6e20 6265 2075 7365 6420 746f  ` can be used to
-00010470: 2022 6465 6c65 7465 2220 6120 7374 7265   "delete" a stre
-00010480: 616d 2e0a 0a54 6869 7320 6d65 7468 6f64  am...This method
-00010490: 2068 6173 2074 776f 2072 6571 7569 7265   has two require
-000104a0: 6420 6172 6775 6d65 6e74 732c 2060 7374  d arguments, `st
-000104b0: 7265 616d 5f6e 616d 6560 2061 6e64 2060  ream_name` and `
-000104c0: 6375 7272 656e 745f 7665 7273 696f 6e60  current_version`
-000104d0: 2e0a 0a54 6865 2072 6571 7569 7265 6420  ...The required 
-000104e0: 6073 7472 6561 6d5f 6e61 6d65 6020 6172  `stream_name` ar
-000104f0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
-00010500: 6f6e 2060 7374 7260 2074 6861 7420 756e  on `str` that un
-00010510: 6971 7565 6c79 2069 6465 6e74 6966 6965  iquely identifie
-00010520: 7320 610a 7374 7265 616d 2074 6f20 7768  s a.stream to wh
-00010530: 6963 6820 6120 7365 7175 656e 6365 206f  ich a sequence o
-00010540: 6620 6576 656e 7473 2077 696c 6c20 6265  f events will be
-00010550: 2061 7070 656e 6465 642e 0a0a 5468 6520   appended...The 
-00010560: 7265 7175 6972 6564 2060 6375 7272 656e  required `curren
-00010570: 745f 7665 7273 696f 6e60 2061 7267 756d  t_version` argum
-00010580: 656e 7420 6973 2065 7870 6563 7465 6420  ent is expected 
-00010590: 746f 2062 6520 6569 7468 6572 2061 2050  to be either a P
-000105a0: 7974 686f 6e20 6069 6e74 600a 7468 6174  ython `int`.that
-000105b0: 2069 6e64 6963 6174 6573 2074 6865 2073   indicates the s
-000105c0: 7472 6561 6d20 706f 7369 7469 6f6e 206f  tream position o
-000105d0: 6620 7468 6520 6c61 7374 2072 6563 6f72  f the last recor
-000105e0: 6465 6420 6576 656e 7420 696e 2074 6865  ded event in the
-000105f0: 2073 7472 6561 6d2e 0a0a 5468 6973 206d   stream...This m
-00010600: 6574 686f 6420 6861 7320 616e 206f 7074  ethod has an opt
-00010610: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-00010620: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
-00010630: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
-00010640: 6174 6020 7468 6174 2073 6574 730a 6120  at` that sets.a 
-00010650: 6465 6164 6c69 6e65 2066 6f72 2074 6865  deadline for the
-00010660: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
-00010670: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
-00010680: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
-00010690: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
-000106a0: 6063 7265 6465 6e74 6961 6c73 6020 6172  `credentials` ar
-000106b0: 6775 6d65 6e74 2c20 7768 6963 6820 6361  gument, which ca
-000106c0: 6e20 6265 2075 7365 6420 746f 0a6f 7665  n be used to.ove
-000106d0: 7272 6964 6520 6361 6c6c 2063 7265 6465  rride call crede
-000106e0: 6e74 6961 6c73 2064 6572 6976 6564 2066  ntials derived f
-000106f0: 726f 6d20 7468 6520 636f 6e6e 6563 7469  rom the connecti
-00010700: 6f6e 2073 7472 696e 6720 5552 492e 0a0a  on string URI...
-00010710: 496e 2074 6865 2065 7861 6d70 6c65 2062  In the example b
-00010720: 656c 6f77 2c20 6073 7472 6561 6d5f 6e61  elow, `stream_na
-00010730: 6d65 3160 2069 7320 6465 6c65 7465 642e  me1` is deleted.
-00010740: 0a0a 6060 6070 7974 686f 6e0a 636f 6d6d  ..```python.comm
-00010750: 6974 5f70 6f73 6974 696f 6e20 3d20 636c  it_position = cl
-00010760: 6965 6e74 2e64 656c 6574 655f 7374 7265  ient.delete_stre
-00010770: 616d 2873 7472 6561 6d5f 6e61 6d65 3d73  am(stream_name=s
-00010780: 7472 6561 6d5f 6e61 6d65 312c 2063 7572  tream_name1, cur
-00010790: 7265 6e74 5f76 6572 7369 6f6e 3d32 290a  rent_version=2).
-000107a0: 6060 600a 0a41 6674 6572 2064 656c 6574  ```..After delet
-000107b0: 696e 6720 6120 7374 7265 616d 2c20 6974  ing a stream, it
-000107c0: 2773 2073 7469 6c6c 2070 6f73 7369 626c  's still possibl
-000107d0: 6520 746f 2061 7070 656e 6420 6e65 7720  e to append new 
-000107e0: 6576 656e 7473 2e20 5265 6164 696e 6720  events. Reading 
-000107f0: 6672 6f6d 2061 0a64 656c 6574 6564 2073  from a.deleted s
-00010800: 7472 6561 6d20 7769 6c6c 2072 6574 7572  tream will retur
-00010810: 6e20 6f6e 6c79 2065 7665 6e74 7320 7468  n only events th
-00010820: 6174 2068 6176 6520 6265 656e 2061 7070  at have been app
-00010830: 656e 6465 6420 6166 7465 7220 6974 2077  ended after it w
-00010840: 6173 0a64 656c 6574 6564 2e0a 0a23 2323  as.deleted...###
-00010850: 2054 6f6d 6273 746f 6e65 2073 7472 6561   Tombstone strea
-00010860: 6d0a 0a2a 7265 7175 6972 6573 206c 6561  m..*requires lea
-00010870: 6465 722a 0a0a 5468 6520 6d65 7468 6f64  der*..The method
-00010880: 2060 746f 6d62 7374 6f6e 655f 7374 7265   `tombstone_stre
-00010890: 616d 2829 6020 6361 6e20 6265 2075 7365  am()` can be use
-000108a0: 6420 746f 2022 746f 6d62 7374 6f6e 6522  d to "tombstone"
-000108b0: 2061 2073 7472 6561 6d2e 0a0a 5468 6973   a stream...This
-000108c0: 206d 6574 686f 6420 6861 7320 7477 6f20   method has two 
-000108d0: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
-000108e0: 7473 2c20 6073 7472 6561 6d5f 6e61 6d65  ts, `stream_name
-000108f0: 6020 616e 6420 6063 7572 7265 6e74 5f76  ` and `current_v
-00010900: 6572 7369 6f6e 602e 0a0a 5468 6520 7265  ersion`...The re
-00010910: 7175 6972 6564 2060 7374 7265 616d 5f6e  quired `stream_n
-00010920: 616d 6560 2061 7267 756d 656e 7420 6973  ame` argument is
-00010930: 2061 2050 7974 686f 6e20 6073 7472 6020   a Python `str` 
-00010940: 7468 6174 2075 6e69 7175 656c 7920 6964  that uniquely id
-00010950: 656e 7469 6669 6573 2061 0a73 7472 6561  entifies a.strea
-00010960: 6d20 746f 2077 6869 6368 2061 2073 6571  m to which a seq
-00010970: 7565 6e63 6520 6f66 2065 7665 6e74 7320  uence of events 
-00010980: 7769 6c6c 2062 6520 6170 7065 6e64 6564  will be appended
-00010990: 2e0a 0a54 6865 2072 6571 7569 7265 6420  ...The required 
-000109a0: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
-000109b0: 6020 6172 6775 6d65 6e74 2069 7320 6578  ` argument is ex
-000109c0: 7065 6374 6564 2074 6f20 6265 2065 6974  pected to be eit
-000109d0: 6865 7220 6120 5079 7468 6f6e 2060 696e  her a Python `in
-000109e0: 7460 0a74 6861 7420 696e 6469 6361 7465  t`.that indicate
-000109f0: 7320 7468 6520 7374 7265 616d 2070 6f73  s the stream pos
-00010a00: 6974 696f 6e20 6f66 2074 6865 206c 6173  ition of the las
-00010a10: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-00010a20: 2069 6e20 7468 6520 7374 7265 616d 2e0a   in the stream..
-00010a30: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
-00010a40: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
-00010a50: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
-00010a60: 2077 6869 6368 2069 7320 6120 5079 7468   which is a Pyth
-00010a70: 6f6e 2060 666c 6f61 7460 2074 6861 7420  on `float` that 
-00010a80: 7365 7473 0a61 2064 6561 646c 696e 6520  sets.a deadline 
-00010a90: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00010aa0: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00010ab0: 7065 7261 7469 6f6e 2e0a 0a54 6869 7320  peration...This 
-00010ac0: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
-00010ad0: 7469 6f6e 616c 2060 6372 6564 656e 7469  tional `credenti
-00010ae0: 616c 7360 2061 7267 756d 656e 742c 2077  als` argument, w
-00010af0: 6869 6368 2063 616e 2062 6520 7573 6564  hich can be used
-00010b00: 2074 6f0a 6f76 6572 7269 6465 2063 616c   to.override cal
-00010b10: 6c20 6372 6564 656e 7469 616c 7320 6465  l credentials de
-00010b20: 7269 7665 6420 6672 6f6d 2074 6865 2063  rived from the c
-00010b30: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00010b40: 2055 5249 2e0a 0a49 6e20 7468 6520 6578   URI...In the ex
-00010b50: 616d 706c 6520 6265 6c6f 772c 2060 7374  ample below, `st
-00010b60: 7265 616d 5f6e 616d 6531 6020 6973 2074  ream_name1` is t
-00010b70: 6f6d 6273 746f 6e65 642e 0a0a 6060 6070  ombstoned...```p
-00010b80: 7974 686f 6e0a 636f 6d6d 6974 5f70 6f73  ython.commit_pos
-00010b90: 6974 696f 6e20 3d20 636c 6965 6e74 2e74  ition = client.t
-00010ba0: 6f6d 6273 746f 6e65 5f73 7472 6561 6d28  ombstone_stream(
-00010bb0: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00010bc0: 616d 5f6e 616d 6531 2c20 6375 7272 656e  am_name1, curren
-00010bd0: 745f 7665 7273 696f 6e3d 3229 0a60 6060  t_version=2).```
-00010be0: 0a0a 4166 7465 7220 746f 6d62 7374 6f6e  ..After tombston
-00010bf0: 696e 6720 6120 7374 7265 616d 2c20 6974  ing a stream, it
-00010c00: 2773 206e 6f74 2070 6f73 7369 626c 6520  's not possible 
-00010c10: 746f 2061 7070 656e 6420 6e65 7720 6576  to append new ev
-00010c20: 656e 7473 2e0a 0a0a 2323 2043 6174 6368  ents....## Catch
-00010c30: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
-00010c40: 730a 0a41 2022 6361 7463 682d 7570 2220  s..A "catch-up" 
-00010c50: 7375 6273 6372 6970 7469 6f6e 2063 616e  subscription can
-00010c60: 2062 6520 7573 6564 2074 6f20 7265 6365   be used to rece
-00010c70: 6976 6520 6576 656e 7473 2074 6861 7420  ive events that 
-00010c80: 6861 7665 2061 6c72 6561 6479 2062 6565  have already bee
-00010c90: 6e0a 7265 636f 7264 6564 2061 6e64 2065  n.recorded and e
-00010ca0: 7665 6e74 7320 7468 6174 2061 7265 2072  vents that are r
-00010cb0: 6563 6f72 6465 6420 7375 6273 6571 7565  ecorded subseque
-00010cc0: 6e74 6c79 2e20 4120 6361 7463 682d 7570  ntly. A catch-up
-00010cd0: 2073 7562 7363 7269 7074 696f 6e20 6361   subscription ca
-00010ce0: 6e0a 6265 2075 7365 6420 6279 2061 6e20  n.be used by an 
-00010cf0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
-00010d00: 2063 6f6d 706f 6e65 6e74 2074 6861 7420   component that 
-00010d10: 7072 6f63 6573 7365 7320 7265 636f 7264  processes record
-00010d20: 6564 2065 7665 6e74 7320 7769 7468 0a22  ed events with."
-00010d30: 6578 6163 746c 792d 6f6e 6365 2220 7365  exactly-once" se
-00010d40: 6d61 6e74 6963 732e 0a0a 5468 6520 6073  mantics...The `s
-00010d50: 7562 7363 7269 6265 5f74 6f5f 616c 6c28  ubscribe_to_all(
-00010d60: 2960 206d 6574 686f 6420 7374 6172 7473  )` method starts
-00010d70: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-00010d80: 6372 6970 7469 6f6e 2074 6861 7420 6361  cription that ca
-00010d90: 6e20 7265 6365 6976 650a 616c 6c20 6576  n receive.all ev
-00010da0: 656e 7473 2069 6e20 7468 6520 6461 7461  ents in the data
-00010db0: 6261 7365 2e20 5468 6520 6073 7562 7363  base. The `subsc
-00010dc0: 7269 6265 5f74 6f5f 7374 7265 616d 2829  ribe_to_stream()
-00010dd0: 6020 6d65 7468 6f64 2073 7461 7274 7320  ` method starts 
-00010de0: 6120 6361 7463 682d 7570 0a73 7562 7363  a catch-up.subsc
-00010df0: 7269 7074 696f 6e20 7468 6174 2063 616e  ription that can
-00010e00: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
-00010e10: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
-00010e20: 7374 7265 616d 2e20 426f 7468 206d 6574  stream. Both met
-00010e30: 686f 6473 2072 6574 7572 6e20 610a 2263  hods return a."c
-00010e40: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-00010e50: 7469 6f6e 2220 6f62 6a65 6374 2c20 7768  tion" object, wh
-00010e60: 6963 6820 6973 2061 2050 7974 686f 6e20  ich is a Python 
-00010e70: 6974 6572 6174 6f72 2e20 5265 636f 7264  iterator. Record
-00010e80: 6564 2065 7665 6e74 7320 6361 6e20 6265  ed events can be
-00010e90: 0a6f 6274 6169 6e65 6420 6279 2069 7465  .obtained by ite
-00010ea0: 7261 7469 6f6e 2e20 5265 636f 7264 6564  ration. Recorded
-00010eb0: 2065 7665 6e74 206f 626a 6563 7473 206f   event objects o
-00010ec0: 6274 6169 6e65 6420 696e 2074 6869 7320  btained in this 
-00010ed0: 7761 7920 6172 6520 696e 7374 616e 6365  way are instance
-00010ee0: 730a 6f66 2074 6865 2060 5265 636f 7264  s.of the `Record
-00010ef0: 6564 4576 656e 7460 2063 6c61 7373 2e0a  edEvent` class..
-00010f00: 0a42 6566 6f72 6520 7468 6520 2263 6174  .Before the "cat
-00010f10: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-00010f20: 6f6e 2220 6f62 6a65 6374 2069 7320 7265  on" object is re
-00010f30: 7475 726e 6564 2074 6f20 7468 6520 6361  turned to the ca
-00010f40: 6c6c 6572 2c20 7468 6520 636c 6965 6e74  ller, the client
-00010f50: 2077 696c 6c0a 6669 7273 746c 7920 6f62   will.firstly ob
-00010f60: 7461 696e 2061 2022 636f 6e66 6972 6d61  tain a "confirma
-00010f70: 7469 6f6e 2220 7265 7370 6f6e 7365 2066  tion" response f
-00010f80: 726f 6d20 7468 6520 7365 7276 6572 2c20  rom the server, 
-00010f90: 7768 6963 6820 616c 6c6f 7773 2074 6865  which allows the
-00010fa0: 2063 6c69 656e 7420 746f 0a64 6574 6563   client to.detec
-00010fb0: 7420 7468 6174 2062 6f74 6820 7468 6520  t that both the 
-00010fc0: 6752 5043 2063 6f6e 6e65 6374 696f 6e20  gRPC connection 
-00010fd0: 616e 6420 7468 6520 7374 7265 616d 696e  and the streamin
-00010fe0: 6720 6752 5043 2063 616c 6c20 6973 206f  g gRPC call is o
-00010ff0: 7065 7261 7469 6f6e 616c 2e20 466f 720a  perational. For.
-00011000: 7468 6973 2072 6561 736f 6e2c 2074 6865  this reason, the
-00011010: 2060 7375 6273 6372 6962 655f 746f 5f61   `subscribe_to_a
-00011020: 6c6c 2829 6020 616e 6420 6073 7562 7363  ll()` and `subsc
-00011030: 7269 6265 5f74 6f5f 7374 7265 616d 2829  ribe_to_stream()
-00011040: 6020 6d65 7468 6f64 7320 6172 6520 626f  ` methods are bo
-00011050: 7468 0a75 7365 6675 6c6c 7920 6465 636f  th.usefully deco
-00011060: 7261 7465 6420 7769 7468 2074 6865 2072  rated with the r
-00011070: 6563 6f6e 6e65 6374 2061 6e64 2072 6574  econnect and ret
-00011080: 7279 2064 6563 6f72 6174 6f72 732e 2048  ry decorators. H
-00011090: 6f77 6576 6572 2c20 6f6e 6365 2074 6865  owever, once the
-000110a0: 206d 6574 686f 640a 6861 7320 7265 7475   method.has retu
-000110b0: 726e 6564 2c20 7468 6520 6465 636f 7261  rned, the decora
-000110c0: 746f 7273 2077 696c 6c20 6861 7665 2065  tors will have e
-000110d0: 7869 7465 642c 2061 6e64 2061 6e79 2065  xited, and any e
-000110e0: 7863 6570 7469 6f6e 7320 7468 6174 2061  xceptions that a
-000110f0: 7265 2072 6169 7365 640a 6475 6520 746f  re raised.due to
-00011100: 2063 6f6e 6e65 6374 696f 6e20 6973 7375   connection issu
-00011110: 6573 2077 6869 6c73 7420 6974 6572 6174  es whilst iterat
-00011120: 696e 6720 6f76 6572 2074 6865 2073 7562  ing over the sub
-00011130: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
-00011140: 2077 696c 6c20 6861 7665 2074 6f0a 6265   will have to.be
-00011150: 2068 616e 646c 6564 2062 7920 796f 7572   handled by your
-00011160: 2063 6f64 652e 0a0a 4120 2263 6174 6368   code...A "catch
-00011170: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
-00011180: 2220 6974 6572 6174 6f72 2077 696c 6c20  " iterator will 
-00011190: 6e6f 7420 6175 746f 6d61 7469 6361 6c6c  not automaticall
-000111a0: 7920 7374 6f70 2077 6865 6e20 7468 6572  y stop when ther
-000111b0: 6520 6172 6520 6e6f 206d 6f72 650a 6576  e are no more.ev
-000111c0: 656e 7473 2074 6f20 6265 2072 6574 7572  ents to be retur
-000111d0: 6e65 642c 2062 7574 2069 6e73 7465 6164  ned, but instead
-000111e0: 2074 6865 2069 7465 7261 7469 6f6e 2077   the iteration w
-000111f0: 696c 6c20 626c 6f63 6b20 756e 7469 6c20  ill block until 
-00011200: 6e65 7720 6576 656e 7473 2061 7265 0a73  new events are.s
-00011210: 7562 7365 7175 656e 746c 7920 7265 636f  ubsequently reco
-00011220: 7264 6564 2069 6e20 7468 6520 6461 7461  rded in the data
-00011230: 6261 7365 2e20 416e 7920 7375 6273 6571  base. Any subseq
-00011240: 7565 6e74 6c79 2072 6563 6f72 6465 6420  uently recorded 
-00011250: 6576 656e 7473 2077 696c 6c20 7468 656e  events will then
-00011260: 2062 650a 696d 6d65 6469 6174 656c 7920   be.immediately 
-00011270: 7374 7265 616d 6564 2074 6f20 7468 6520  streamed to the 
-00011280: 636c 6965 6e74 2c20 616e 6420 7468 6520  client, and the 
-00011290: 6974 6572 6174 696f 6e20 7769 6c6c 2074  iteration will t
-000112a0: 6865 6e20 636f 6e74 696e 7565 2e20 5468  hen continue. Th
-000112b0: 6520 7374 7265 616d 696e 670a 6f66 2065  e streaming.of e
-000112c0: 7665 6e74 732c 2061 6e64 2068 656e 6365  vents, and hence
-000112d0: 2074 6865 2069 7465 7261 7469 6f6e 2c20   the iteration, 
-000112e0: 6361 6e20 6265 2073 746f 7070 6564 2062  can be stopped b
-000112f0: 7920 6361 6c6c 696e 6720 7468 6520 6073  y calling the `s
-00011300: 746f 7028 2960 206d 6574 686f 6420 6f6e  top()` method on
-00011310: 2074 6865 0a22 6361 7463 682d 7570 2073   the."catch-up s
-00011320: 7562 7363 7269 7074 696f 6e22 206f 626a  ubscription" obj
-00011330: 6563 742e 0a0a 2323 2320 5375 6273 6372  ect...### Subscr
-00011340: 6962 6520 746f 2061 6c6c 2065 7665 6e74  ibe to all event
-00011350: 730a 0a54 6865 6073 7562 7363 7269 6265  s..The`subscribe
-00011360: 5f74 6f5f 616c 6c28 2960 206d 6574 686f  _to_all()` metho
-00011370: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
-00011380: 2073 7461 7274 2061 2063 6174 6368 2d75   start a catch-u
-00011390: 7020 7375 6273 6372 6970 7469 6f6e 0a66  p subscription.f
-000113a0: 726f 6d20 7768 6963 6820 616c 6c20 6576  rom which all ev
-000113b0: 656e 7473 2072 6563 6f72 6465 6420 696e  ents recorded in
-000113c0: 2074 6865 2064 6174 6162 6173 6520 6361   the database ca
-000113d0: 6e20 6265 206f 6274 6169 6e65 6420 696e  n be obtained in
-000113e0: 2074 6865 206f 7264 6572 0a74 6865 7920   the order.they 
-000113f0: 7765 7265 2072 6563 6f72 6465 642e 2054  were recorded. T
-00011400: 6869 7320 6d65 7468 6f64 2072 6574 7572  his method retur
-00011410: 6e73 2061 2022 6361 7463 682d 7570 2073  ns a "catch-up s
-00011420: 7562 7363 7269 7074 696f 6e22 2069 7465  ubscription" ite
-00011430: 7261 746f 722e 0a0a 5468 6973 206d 6574  rator...This met
-00011440: 686f 6420 616c 736f 2068 6173 2073 6978  hod also has six
-00011450: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-00011460: 6e74 732c 2060 636f 6d6d 6974 5f70 6f73  nts, `commit_pos
-00011470: 6974 696f 6e60 2c20 6066 696c 7465 725f  ition`, `filter_
-00011480: 6578 636c 7564 6560 2c0a 6066 696c 7465  exclude`,.`filte
-00011490: 725f 696e 636c 7564 6560 2c20 6066 696c  r_include`, `fil
-000114a0: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
-000114b0: 6d65 602c 2060 7469 6d65 6f75 7460 2061  me`, `timeout` a
-000114c0: 6e64 2060 6372 6564 656e 7469 616c 7360  nd `credentials`
-000114d0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
-000114e0: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-000114f0: 6020 6172 6775 6d65 6e74 2073 7065 6369  ` argument speci
-00011500: 6669 6573 2061 2063 6f6d 6d69 7420 706f  fies a commit po
-00011510: 7369 7469 6f6e 2e20 5468 6520 6465 6661  sition. The defa
-00011520: 756c 740a 7661 6c75 6520 6f66 2060 636f  ult.value of `co
-00011530: 6d6d 6974 5f70 6f73 6974 696f 6e60 2069  mmit_position` i
-00011540: 7320 604e 6f6e 6560 2c20 7768 6963 6820  s `None`, which 
-00011550: 6d65 616e 7320 7468 6520 6361 7463 682d  means the catch-
-00011560: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
-00011570: 7769 6c6c 0a73 7461 7274 2066 726f 6d20  will.start from 
-00011580: 7468 6520 6669 7273 7420 7265 636f 7264  the first record
-00011590: 6564 2065 7665 6e74 2069 6e20 7468 6520  ed event in the 
-000115a0: 6461 7461 6261 7365 2e20 4966 2061 2063  database. If a c
-000115b0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2069  ommit position i
-000115c0: 7320 6769 7665 6e2c 0a69 7420 6d75 7374  s given,.it must
-000115d0: 206d 6174 6368 2061 6e20 6163 7475 616c   match an actual
-000115e0: 6c79 2065 7869 7374 696e 6720 636f 6d6d  ly existing comm
-000115f0: 6974 2070 6f73 6974 696f 6e20 696e 2074  it position in t
-00011600: 6865 2064 6174 6162 6173 652e 204f 6e6c  he database. Onl
-00011610: 7920 6576 656e 7473 0a72 6563 6f72 6465  y events.recorde
-00011620: 6420 6166 7465 7220 7468 6174 2070 6f73  d after that pos
-00011630: 6974 696f 6e20 7769 6c6c 2062 6520 6f62  ition will be ob
-00011640: 7461 696e 6564 2e0a 0a54 6865 206f 7074  tained...The opt
-00011650: 696f 6e61 6c20 6066 696c 7465 725f 6578  ional `filter_ex
-00011660: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
-00011670: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
-00011680: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
-00011690: 696f 6e73 2074 6861 740a 7370 6563 6966  ions that.specif
-000116a0: 6965 7320 7768 6963 6820 7265 636f 7264  ies which record
-000116b0: 6564 2065 7665 6e74 7320 7368 6f75 6c64  ed events should
-000116c0: 2062 6520 7265 7475 726e 6564 2e20 5468   be returned. Th
-000116d0: 6973 2061 7267 756d 656e 7420 6973 2069  is argument is i
-000116e0: 676e 6f72 6564 0a69 6620 6066 696c 7465  gnored.if `filte
-000116f0: 725f 696e 636c 7564 6560 2069 7320 7365  r_include` is se
-00011700: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
-00011710: 2073 6571 7565 6e63 652e 2054 6865 2064   sequence. The d
-00011720: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
-00011730: 7468 6973 0a61 7267 756d 656e 7420 6d61  this.argument ma
-00011740: 7463 6865 7320 7468 6520 6576 656e 7420  tches the event 
-00011750: 7479 7065 7320 6f66 2045 7665 6e74 5374  types of EventSt
-00011760: 6f72 6544 4220 2273 7973 7465 6d20 6576  oreDB "system ev
-00011770: 656e 7473 222c 2073 6f20 7468 6174 2073  ents", so that s
-00011780: 7973 7465 6d0a 6576 656e 7473 2077 696c  ystem.events wil
-00011790: 6c20 6e6f 7420 6e6f 726d 616c 6c79 2062  l not normally b
-000117a0: 6520 696e 636c 7564 6564 2e20 5365 6520  e included. See 
-000117b0: 7468 6520 4e6f 7465 7320 7365 6374 696f  the Notes sectio
-000117c0: 6e20 6265 6c6f 7720 666f 7220 6d6f 7265  n below for more
-000117d0: 0a69 6e66 6f72 6d61 7469 6f6e 2061 626f  .information abo
-000117e0: 7574 2066 696c 7465 7220 6578 7072 6573  ut filter expres
-000117f0: 7369 6f6e 732e 0a0a 5468 6520 6f70 7469  sions...The opti
-00011800: 6f6e 616c 2060 6669 6c74 6572 5f69 6e63  onal `filter_inc
-00011810: 6c75 6465 6020 6172 6775 6d65 6e74 2069  lude` argument i
-00011820: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
-00011830: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-00011840: 6f6e 730a 7468 6174 2073 7065 6369 6669  ons.that specifi
-00011850: 6573 2077 6869 6368 2072 6563 6f72 6465  es which recorde
-00011860: 6420 6576 656e 7473 2073 686f 756c 6420  d events should 
-00011870: 6265 2072 6574 7572 6e65 642e 2042 7920  be returned. By 
-00011880: 6465 6661 756c 742c 2074 6869 730a 6172  default, this.ar
-00011890: 6775 6d65 6e74 2069 7320 616e 2065 6d70  gument is an emp
-000118a0: 7479 2074 7570 6c65 2e20 4966 2074 6869  ty tuple. If thi
-000118b0: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
-000118c0: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
-000118d0: 2073 6571 7565 6e63 652c 0a74 6865 2060   sequence,.the `
-000118e0: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
-000118f0: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
-00011900: 7265 642e 0a0a 5468 6520 6f70 7469 6f6e  red...The option
-00011910: 616c 2060 6669 6c74 6572 5f62 795f 7374  al `filter_by_st
-00011920: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
-00011930: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
-00011940: 6062 6f6f 6c60 2074 6861 7420 696e 6469  `bool` that indi
-00011950: 6361 7465 730a 7768 6574 6865 7220 7468  cates.whether th
-00011960: 6520 6669 6c74 6572 696e 6720 7769 6c6c  e filtering will
-00011970: 2061 7070 6c79 2074 6f20 6576 656e 7420   apply to event 
-00011980: 7479 7065 7320 6f72 2073 7472 6561 6d20  types or stream 
-00011990: 6e61 6d65 732e 2042 7920 6465 6661 756c  names. By defaul
-000119a0: 742c 2074 6869 730a 7661 6c75 6520 6973  t, this.value is
-000119b0: 2060 4661 6c73 6560 2061 6e64 2073 6f20   `False` and so 
-000119c0: 7468 6520 6669 6c74 6572 696e 6720 7769  the filtering wi
-000119d0: 6c6c 2061 7070 6c79 2074 6f20 7468 6520  ll apply to the 
-000119e0: 6576 656e 7420 7479 7065 2073 7472 696e  event type strin
-000119f0: 6773 206f 660a 7265 636f 7264 6564 2065  gs of.recorded e
-00011a00: 7665 6e74 732e 0a0a 5468 6520 6f70 7469  vents...The opti
-00011a10: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00011a20: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-00011a30: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
-00011a40: 6820 7365 7473 2061 0a64 6561 646c 696e  h sets a.deadlin
-00011a50: 6520 666f 7220 7468 6520 636f 6d70 6c65  e for the comple
-00011a60: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-00011a70: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
-00011a80: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-00011a90: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-00011aa0: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
-00011ab0: 6f76 6572 7269 6465 2063 616c 6c20 6372  override call cr
-00011ac0: 6564 656e 7469 616c 7320 6465 7269 7665  edentials derive
-00011ad0: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
-00011ae0: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-00011af0: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
-00011b00: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
-00011b10: 6f20 7374 6172 7420 6120 6361 7463 682d  o start a catch-
-00011b20: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
-00011b30: 7468 6174 2073 7461 7274 730a 6672 6f6d  that starts.from
-00011b40: 2074 6865 2066 6972 7374 2072 6563 6f72   the first recor
-00011b50: 6465 6420 6576 656e 7420 696e 2074 6865  ded event in the
-00011b60: 2064 6174 6162 6173 652e 0a0a 6060 6070   database...```p
-00011b70: 7974 686f 6e0a 2320 5375 6273 6372 6962  ython.# Subscrib
-00011b80: 6520 6672 6f6d 2074 6865 2066 6972 7374  e from the first
-00011b90: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00011ba0: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
-00011bb0: 0a63 6174 6368 7570 5f73 7562 7363 7269  .catchup_subscri
-00011bc0: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
-00011bd0: 7562 7363 7269 6265 5f74 6f5f 616c 6c28  ubscribe_to_all(
-00011be0: 290a 6060 600a 0a54 6865 2065 7861 6d70  ).```..The examp
-00011bf0: 6c65 2062 656c 6f77 2073 686f 7773 2074  le below shows t
-00011c00: 6861 7420 6361 7463 682d 7570 2073 7562  hat catch-up sub
-00011c10: 7363 7269 7074 696f 6e73 2064 6f20 6e6f  scriptions do no
-00011c20: 7420 7374 6f70 0a61 7574 6f6d 6174 6963  t stop.automatic
-00011c30: 616c 6c79 2c20 6275 7420 626c 6f63 6b20  ally, but block 
-00011c40: 7768 656e 2074 6865 206c 6173 7420 7265  when the last re
-00011c50: 636f 7264 6564 2065 7665 6e74 2069 7320  corded event is 
-00011c60: 7265 6365 6976 6564 2c0a 616e 6420 7468  received,.and th
-00011c70: 656e 2063 6f6e 7469 6e75 6520 7768 656e  en continue when
-00011c80: 2073 7562 7365 7175 656e 7420 6576 656e   subsequent even
-00011c90: 7473 2061 7265 2072 6563 6f72 6465 642e  ts are recorded.
-00011ca0: 0a0a 6060 6070 7974 686f 6e0a 6672 6f6d  ..```python.from
-00011cb0: 2074 696d 6520 696d 706f 7274 2073 6c65   time import sle
-00011cc0: 6570 0a66 726f 6d20 7468 7265 6164 696e  ep.from threadin
-00011cd0: 6720 696d 706f 7274 2054 6872 6561 640a  g import Thread.
-00011ce0: 0a0a 2320 4170 7065 6e64 2061 206e 6577  ..# Append a new
-00011cf0: 2065 7665 6e74 2074 6f20 6120 6e65 7720   event to a new 
-00011d00: 7374 7265 616d 2e0a 7374 7265 616d 5f6e  stream..stream_n
-00011d10: 616d 6532 203d 2073 7472 2875 7569 642e  ame2 = str(uuid.
-00011d20: 7575 6964 3428 2929 0a65 7665 6e74 3420  uuid4()).event4 
-00011d30: 3d20 4e65 7745 7665 6e74 2874 7970 653d  = NewEvent(type=
-00011d40: 274f 7264 6572 4372 6561 7465 6427 2c20  'OrderCreated', 
-00011d50: 6461 7461 3d62 2764 6174 6134 2729 0a0a  data=b'data4')..
-00011d60: 636c 6965 6e74 2e61 7070 656e 645f 746f  client.append_to
-00011d70: 5f73 7472 6561 6d28 0a20 2020 2073 7472  _stream(.    str
-00011d80: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00011d90: 6e61 6d65 322c 0a20 2020 2063 7572 7265  name2,.    curre
-00011da0: 6e74 5f76 6572 7369 6f6e 3d53 7472 6561  nt_version=Strea
-00011db0: 6d53 7461 7465 2e4e 4f5f 5354 5245 414d  mState.NO_STREAM
-00011dc0: 2c0a 2020 2020 6576 656e 7473 3d5b 6576  ,.    events=[ev
-00011dd0: 656e 7434 5d2c 0a29 0a0a 0a23 2052 6563  ent4],.)...# Rec
-00011de0: 6569 7665 2065 7665 6e74 7320 6672 6f6d  eive events from
-00011df0: 2074 6865 2063 6174 6368 2d75 7020 7375   the catch-up su
-00011e00: 6273 6372 6970 7469 6f6e 2069 6e20 6120  bscription in a 
-00011e10: 6469 6666 6572 656e 7420 7468 7265 6164  different thread
-00011e20: 2e0a 7265 6365 6976 6564 5f65 7665 6e74  ..received_event
-00011e30: 7320 3d20 5b5d 0a0a 6465 6620 7265 6365  s = []..def rece
-00011e40: 6976 655f 6576 656e 7473 2829 3a0a 2020  ive_events():.  
-00011e50: 2020 666f 7220 6576 656e 7420 696e 2063    for event in c
-00011e60: 6174 6368 7570 5f73 7562 7363 7269 7074  atchup_subscript
-00011e70: 696f 6e3a 0a20 2020 2020 2020 2072 6563  ion:.        rec
-00011e80: 6569 7665 645f 6576 656e 7473 2e61 7070  eived_events.app
-00011e90: 656e 6428 6576 656e 7429 0a0a 0a64 6566  end(event)...def
-00011ea0: 2077 6169 745f 666f 725f 6576 656e 7428   wait_for_event(
-00011eb0: 6576 656e 745f 6964 293a 0a20 2020 2066  event_id):.    f
-00011ec0: 6f72 205f 2069 6e20 7261 6e67 6528 3130  or _ in range(10
-00011ed0: 3029 3a0a 2020 2020 2020 2020 666f 7220  0):.        for 
-00011ee0: 6576 656e 7420 696e 2072 6576 6572 7365  event in reverse
-00011ef0: 6428 7265 6365 6976 6564 5f65 7665 6e74  d(received_event
-00011f00: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00011f10: 6966 2065 7665 6e74 2e69 6420 3d3d 2065  if event.id == e
-00011f20: 7665 6e74 5f69 643a 0a20 2020 2020 2020  vent_id:.       
-00011f30: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-00011f40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00011f50: 2020 2020 2020 2020 2020 736c 6565 7028            sleep(
-00011f60: 302e 3129 0a20 2020 2065 6c73 653a 0a20  0.1).    else:. 
-00011f70: 2020 2020 2020 2072 6169 7365 2041 7373         raise Ass
-00011f80: 6572 7469 6f6e 4572 726f 7228 2245 7665  ertionError("Eve
-00011f90: 6e74 2077 6173 6e27 7420 7265 6365 6976  nt wasn't receiv
-00011fa0: 6564 2229 0a0a 0a74 6872 6561 6420 3d20  ed")...thread = 
-00011fb0: 5468 7265 6164 2874 6172 6765 743d 7265  Thread(target=re
-00011fc0: 6365 6976 655f 6576 656e 7473 2c20 6461  ceive_events, da
-00011fd0: 656d 6f6e 3d54 7275 6529 0a74 6872 6561  emon=True).threa
-00011fe0: 642e 7374 6172 7428 290a 0a23 2057 6169  d.start()..# Wai
-00011ff0: 7420 746f 2072 6563 6569 7665 2065 7665  t to receive eve
-00012000: 6e74 342e 0a77 6169 745f 666f 725f 6576  nt4..wait_for_ev
-00012010: 656e 7428 6576 656e 7434 2e69 6429 0a0a  ent(event4.id)..
-00012020: 2320 4170 7065 6e64 2061 6e6f 7468 6572  # Append another
-00012030: 2065 7665 6e74 2077 6869 6c73 7420 7468   event whilst th
-00012040: 6520 7375 6273 6372 6970 7469 6f6e 2069  e subscription i
-00012050: 7320 7275 6e6e 696e 672e 0a65 7665 6e74  s running..event
-00012060: 3520 3d20 4e65 7745 7665 6e74 2874 7970  5 = NewEvent(typ
-00012070: 653d 274f 7264 6572 5570 6461 7465 6427  e='OrderUpdated'
-00012080: 2c20 6461 7461 3d62 2764 6174 6135 2729  , data=b'data5')
-00012090: 0a63 6c69 656e 742e 6170 7065 6e64 5f74  .client.append_t
-000120a0: 6f5f 7374 7265 616d 280a 2020 2020 7374  o_stream(.    st
-000120b0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-000120c0: 5f6e 616d 6532 2c0a 2020 2020 6375 7272  _name2,.    curr
-000120d0: 656e 745f 7665 7273 696f 6e3d 302c 0a20  ent_version=0,. 
-000120e0: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
-000120f0: 355d 2c0a 290a 0a23 2057 6169 7420 666f  5],.)..# Wait fo
-00012100: 7220 7468 6520 7375 6273 6372 6970 7469  r the subscripti
-00012110: 6f6e 2074 6f20 626c 6f63 6b2e 0a77 6169  on to block..wai
-00012120: 745f 666f 725f 6576 656e 7428 6576 656e  t_for_event(even
-00012130: 7435 2e69 6429 0a0a 2320 5374 6f70 2074  t5.id)..# Stop t
-00012140: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
-00012150: 0a63 6174 6368 7570 5f73 7562 7363 7269  .catchup_subscri
-00012160: 7074 696f 6e2e 7374 6f70 2829 0a74 6872  ption.stop().thr
-00012170: 6561 642e 6a6f 696e 2829 0a60 6060 0a0a  ead.join().```..
-00012180: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-00012190: 7720 7368 6f77 7320 686f 7720 746f 2073  w shows how to s
-000121a0: 7562 7363 7269 6265 2074 6f20 6576 656e  ubscribe to even
-000121b0: 7473 2072 6563 6f72 6465 6420 6166 7465  ts recorded afte
-000121c0: 7220 610a 7061 7274 6963 756c 6172 2063  r a.particular c
-000121d0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
-000121e0: 696e 2074 6869 7320 6361 7365 2066 726f  in this case fro
-000121f0: 6d20 7468 6520 636f 6d6d 6974 2070 6f73  m the commit pos
-00012200: 6974 696f 6e20 6f66 0a74 6865 206c 6173  ition of.the las
-00012210: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-00012220: 2074 6861 7420 7761 7320 7265 6365 6976   that was receiv
-00012230: 6564 2061 626f 7665 2e20 416e 6f74 6865  ed above. Anothe
-00012240: 7220 6576 656e 7420 6973 0a72 6563 6f72  r event is.recor
-00012250: 6465 6420 6265 666f 7265 2074 6865 2073  ded before the s
-00012260: 7562 7363 7269 7074 696f 6e20 6973 2072  ubscription is r
-00012270: 6573 7461 7274 6564 2e20 4675 7274 6865  estarted. Furthe
-00012280: 7220 6576 656e 7473 2061 7265 0a72 6563  r events are.rec
-00012290: 6f72 6465 6420 7768 696c 7374 2074 6865  orded whilst the
-000122a0: 2073 7562 7363 7269 7074 696f 6e20 6973   subscription is
-000122b0: 2072 756e 6e69 6e67 2e20 5468 6520 6576   running. The ev
-000122c0: 656e 7473 2077 6520 6170 7065 6e64 6564  ents we appended
-000122d0: 0a61 7265 2072 6563 6569 7665 6420 696e  .are received in
-000122e0: 2074 6865 206f 7264 6572 2074 6865 7920   the order they 
-000122f0: 7765 7265 2072 6563 6f72 6465 642e 0a0a  were recorded...
-00012300: 0a60 6060 7079 7468 6f6e 0a0a 2320 4170  .```python..# Ap
-00012310: 7065 6e64 2061 6e6f 7468 6572 2065 7665  pend another eve
-00012320: 6e74 2e0a 6576 656e 7436 203d 204e 6577  nt..event6 = New
-00012330: 4576 656e 7428 7479 7065 3d27 4f72 6465  Event(type='Orde
-00012340: 7244 656c 6574 6564 272c 2064 6174 613d  rDeleted', data=
-00012350: 6227 6461 7461 3627 290a 636c 6965 6e74  b'data6').client
-00012360: 2e61 7070 656e 645f 746f 5f73 7472 6561  .append_to_strea
-00012370: 6d28 0a20 2020 2073 7472 6561 6d5f 6e61  m(.    stream_na
-00012380: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
-00012390: 0a20 2020 2063 7572 7265 6e74 5f76 6572  .    current_ver
-000123a0: 7369 6f6e 3d31 2c0a 2020 2020 6576 656e  sion=1,.    even
-000123b0: 7473 3d5b 6576 656e 7436 5d2c 0a29 0a0a  ts=[event6],.)..
-000123c0: 2320 5265 7374 6172 7420 7375 6273 6372  # Restart subscr
-000123d0: 6962 696e 6720 746f 2061 6c6c 2065 7665  ibing to all eve
-000123e0: 6e74 7320 6166 7465 7220 7468 650a 2320  nts after the.# 
-000123f0: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-00012400: 6f66 2074 6865 206c 6173 7420 7265 6365  of the last rece
-00012410: 6976 6564 2065 7665 6e74 2e0a 6361 7463  ived event..catc
-00012420: 6875 705f 7375 6273 6372 6970 7469 6f6e  hup_subscription
-00012430: 203d 2063 6c69 656e 742e 7375 6273 6372   = client.subscr
-00012440: 6962 655f 746f 5f61 6c6c 280a 2020 2020  ibe_to_all(.    
-00012450: 636f 6d6d 6974 5f70 6f73 6974 696f 6e3d  commit_position=
-00012460: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
-00012470: 2d31 5d2e 636f 6d6d 6974 5f70 6f73 6974  -1].commit_posit
-00012480: 696f 6e0a 290a 0a74 6872 6561 6420 3d20  ion.)..thread = 
-00012490: 5468 7265 6164 2874 6172 6765 743d 7265  Thread(target=re
-000124a0: 6365 6976 655f 6576 656e 7473 2c20 6461  ceive_events, da
-000124b0: 656d 6f6e 3d54 7275 6529 0a74 6872 6561  emon=True).threa
-000124c0: 642e 7374 6172 7428 290a 0a23 2057 6169  d.start()..# Wai
-000124d0: 7420 666f 7220 6576 656e 7436 2e0a 7761  t for event6..wa
-000124e0: 6974 5f66 6f72 5f65 7665 6e74 2865 7665  it_for_event(eve
-000124f0: 6e74 362e 6964 290a 0a23 2041 7070 656e  nt6.id)..# Appen
-00012500: 6420 7468 7265 6520 6d6f 7265 2065 7665  d three more eve
-00012510: 6e74 7320 746f 2061 206e 6577 2073 7472  nts to a new str
-00012520: 6561 6d2e 0a73 7472 6561 6d5f 6e61 6d65  eam..stream_name
-00012530: 3320 3d20 7374 7228 7575 6964 2e75 7569  3 = str(uuid.uui
-00012540: 6434 2829 290a 6576 656e 7437 203d 204e  d4()).event7 = N
-00012550: 6577 4576 656e 7428 7479 7065 3d27 4f72  ewEvent(type='Or
-00012560: 6465 7243 7265 6174 6564 272c 2064 6174  derCreated', dat
-00012570: 613d 6227 6461 7461 3727 290a 6576 656e  a=b'data7').even
-00012580: 7438 203d 204e 6577 4576 656e 7428 7479  t8 = NewEvent(ty
-00012590: 7065 3d27 4f72 6465 7255 7064 6174 6564  pe='OrderUpdated
-000125a0: 272c 2064 6174 613d 6227 6461 7461 3827  ', data=b'data8'
-000125b0: 290a 6576 656e 7439 203d 204e 6577 4576  ).event9 = NewEv
-000125c0: 656e 7428 7479 7065 3d27 4f72 6465 7244  ent(type='OrderD
-000125d0: 656c 6574 6564 272c 2064 6174 613d 6227  eleted', data=b'
-000125e0: 6461 7461 3927 290a 0a63 6c69 656e 742e  data9')..client.
-000125f0: 6170 7065 6e64 5f74 6f5f 7374 7265 616d  append_to_stream
-00012600: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
-00012610: 653d 7374 7265 616d 5f6e 616d 6533 2c0a  e=stream_name3,.
-00012620: 2020 2020 6375 7272 656e 745f 7665 7273      current_vers
-00012630: 696f 6e3d 5374 7265 616d 5374 6174 652e  ion=StreamState.
-00012640: 4e4f 5f53 5452 4541 4d2c 0a20 2020 2065  NO_STREAM,.    e
-00012650: 7665 6e74 733d 5b65 7665 6e74 372c 2065  vents=[event7, e
-00012660: 7665 6e74 382c 2065 7665 6e74 395d 2c0a  vent8, event9],.
-00012670: 290a 0a23 2057 6169 7420 666f 7220 6576  )..# Wait for ev
-00012680: 656e 7473 2e0a 7761 6974 5f66 6f72 5f65  ents..wait_for_e
-00012690: 7665 6e74 2865 7665 6e74 372e 6964 290a  vent(event7.id).
-000126a0: 7761 6974 5f66 6f72 5f65 7665 6e74 2865  wait_for_event(e
-000126b0: 7665 6e74 382e 6964 290a 7761 6974 5f66  vent8.id).wait_f
-000126c0: 6f72 5f65 7665 6e74 2865 7665 6e74 392e  or_event(event9.
-000126d0: 6964 290a 0a23 2053 746f 7020 7468 6520  id)..# Stop the 
-000126e0: 7375 6273 6372 6970 7469 6f6e 2e0a 6361  subscription..ca
-000126f0: 7463 6875 705f 7375 6273 6372 6970 7469  tchup_subscripti
-00012700: 6f6e 2e73 746f 7028 290a 7468 7265 6164  on.stop().thread
-00012710: 2e6a 6f69 6e28 290a 6060 600a 0a54 6865  .join().```..The
-00012720: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
-00012730: 6970 7469 6f6e 2063 616c 6c20 6973 2065  iption call is e
-00012740: 6e64 6564 2061 7320 736f 6f6e 2061 7320  nded as soon as 
-00012750: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-00012760: 206f 626a 6563 7427 730a 6073 746f 7028   object's.`stop(
-00012770: 2960 206d 6574 686f 6420 6973 2063 616c  )` method is cal
-00012780: 6c65 642e 2054 6869 7320 6861 7070 656e  led. This happen
-00012790: 7320 6175 746f 6d61 7469 6361 6c6c 7920  s automatically 
-000127a0: 7768 656e 2069 7420 676f 6573 206f 7574  when it goes out
-000127b0: 206f 6620 7363 6f70 652c 0a6f 7220 7768   of scope,.or wh
-000127c0: 656e 2069 7420 6973 2065 7870 6c69 6369  en it is explici
-000127d0: 746c 7920 6465 6c65 7465 6420 6672 6f6d  tly deleted from
-000127e0: 206d 656d 6f72 7920 7573 696e 6720 7468   memory using th
-000127f0: 6520 5079 7468 6f6e 2060 6465 6c60 206b  e Python `del` k
-00012800: 6579 776f 7264 2e0a 0a23 2323 2053 7562  eyword...### Sub
-00012810: 7363 7269 6265 2074 6f20 7374 7265 616d  scribe to stream
-00012820: 2065 7665 6e74 730a 0a54 6865 2060 7375   events..The `su
-00012830: 6273 6372 6962 655f 746f 5f73 7472 6561  bscribe_to_strea
-00012840: 6d28 2960 206d 6574 686f 6420 6361 6e20  m()` method can 
-00012850: 6265 2075 7365 6420 746f 2073 7461 7274  be used to start
-00012860: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-00012870: 6372 6970 7469 6f6e 0a66 726f 6d20 7768  cription.from wh
-00012880: 6963 6820 6576 656e 7473 2072 6563 6f72  ich events recor
-00012890: 6465 6420 696e 2061 2073 696e 676c 6520  ded in a single 
-000128a0: 7374 7265 616d 2063 616e 2062 6520 6f62  stream can be ob
-000128b0: 7461 696e 6564 2e20 5468 6973 206d 6574  tained. This met
-000128c0: 686f 640a 7265 7475 726e 7320 6120 2263  hod.returns a "c
-000128d0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-000128e0: 7469 6f6e 2220 6974 6572 6174 6f72 2e0a  tion" iterator..
-000128f0: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
-00012900: 2061 2072 6571 7569 7265 6420 6073 7472   a required `str
-00012910: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
-00012920: 6e74 2c20 7768 6963 6820 7370 6563 6966  nt, which specif
-00012930: 6965 7320 7468 6520 6e61 6d65 206f 6620  ies the name of 
-00012940: 7468 650a 7374 7265 616d 2066 726f 6d20  the.stream from 
-00012950: 7768 6963 6820 7265 636f 7264 6564 2065  which recorded e
-00012960: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
-00012970: 6365 6976 6564 2e0a 0a54 6869 7320 6d65  ceived...This me
-00012980: 7468 6f64 2061 6c73 6f20 6861 7320 666f  thod also has fo
-00012990: 7572 206f 7074 696f 6e61 6c20 6172 6775  ur optional argu
-000129a0: 6d65 6e74 732c 2060 7374 7265 616d 5f70  ments, `stream_p
-000129b0: 6f73 6974 696f 6e60 2c20 6072 6573 6f6c  osition`, `resol
-000129c0: 7665 5f6c 696e 6b73 602c 0a60 7469 6d65  ve_links`,.`time
-000129d0: 6f75 7460 2061 6e64 2060 6372 6564 656e  out` and `creden
-000129e0: 7469 616c 7360 2e0a 0a54 6865 206f 7074  tials`...The opt
-000129f0: 696f 6e61 6c20 6073 7472 6561 6d5f 706f  ional `stream_po
-00012a00: 7369 7469 6f6e 6020 6172 6775 6d65 6e74  sition` argument
-00012a10: 2073 7065 6369 6669 6573 2061 2070 6f73   specifies a pos
-00012a20: 6974 696f 6e20 696e 2074 6865 2073 7472  ition in the str
-00012a30: 6561 6d2e 2054 6865 0a64 6566 6175 6c74  eam. The.default
-00012a40: 2076 616c 7565 206f 6620 6073 7472 6561   value of `strea
-00012a50: 6d5f 706f 7369 7469 6f6e 6020 6973 2060  m_position` is `
-00012a60: 4e6f 6e65 602c 2077 6869 6368 206d 6561  None`, which mea
-00012a70: 6e73 2074 6861 7420 616c 6c20 6576 656e  ns that all even
-00012a80: 7473 0a72 6563 6f72 6465 6420 696e 2074  ts.recorded in t
-00012a90: 6865 2073 7472 6561 6d20 7769 6c6c 2062  he stream will b
-00012aa0: 6520 6f62 7461 696e 6564 2069 6e20 7468  e obtained in th
-00012ab0: 6520 6f72 6465 7220 7468 6579 2077 6572  e order they wer
-00012ac0: 6520 7265 636f 7264 6564 2e0a 4966 2061  e recorded..If a
-00012ad0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-00012ae0: 2069 7320 6769 7665 6e2c 2074 6865 6e20   is given, then 
-00012af0: 6f6e 6c79 2065 7665 6e74 7320 7265 636f  only events reco
-00012b00: 7264 6564 2061 6674 6572 2074 6861 7420  rded after that 
-00012b10: 706f 7369 7469 6f6e 0a77 696c 6c20 6265  position.will be
-00012b20: 206f 6274 6169 6e65 642e 0a0a 5468 6520   obtained...The 
-00012b30: 6f70 7469 6f6e 616c 2060 7265 736f 6c76  optional `resolv
-00012b40: 655f 6c69 6e6b 7360 2061 7267 756d 656e  e_links` argumen
-00012b50: 7420 6973 2061 2050 7974 686f 6e20 6062  t is a Python `b
-00012b60: 6f6f 6c60 2e20 5468 6520 6465 6661 756c  ool`. The defaul
-00012b70: 7420 7661 6c75 6520 6f66 2060 7265 736f  t value of `reso
-00012b80: 6c76 655f 6c69 6e6b 7360 0a69 7320 6046  lve_links`.is `F
-00012b90: 616c 7365 602c 2077 6869 6368 206d 6561  alse`, which mea
-00012ba0: 6e73 2061 6e79 2065 7665 6e74 206c 696e  ns any event lin
-00012bb0: 6b73 2077 696c 6c20 6e6f 7420 6265 2072  ks will not be r
-00012bc0: 6573 6f6c 7665 642c 2073 6f20 7468 6174  esolved, so that
-00012bd0: 2074 6865 2065 7665 6e74 7320 7468 6174   the events that
-00012be0: 2061 7265 0a72 6574 7572 6e65 6420 6d61   are.returned ma
-00012bf0: 7920 7265 7072 6573 656e 7420 6576 656e  y represent even
-00012c00: 7420 6c69 6e6b 732e 2049 6620 6072 6573  t links. If `res
-00012c10: 6f6c 7665 5f6c 696e 6b73 6020 6973 2060  olve_links` is `
-00012c20: 5472 7565 602c 2061 6e79 2065 7665 6e74  True`, any event
-00012c30: 206c 696e 6b73 2077 696c 6c0a 6265 2072   links will.be r
-00012c40: 6573 6f6c 7665 642c 2073 6f20 7468 6174  esolved, so that
-00012c50: 2074 6865 206c 696e 6b65 6420 6576 656e   the linked even
-00012c60: 7473 2077 696c 6c20 6265 2072 6574 7572  ts will be retur
-00012c70: 6e65 6420 696e 7374 6561 6420 6f66 2074  ned instead of t
-00012c80: 6865 2065 7665 6e74 206c 696e 6b73 2e0a  he event links..
-00012c90: 0a54 6865 206f 7074 696f 6e61 6c20 6074  .The optional `t
-00012ca0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-00012cb0: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
-00012cc0: 6f61 7460 2074 6861 7420 7365 7473 0a61  oat` that sets.a
-00012cd0: 2064 6561 646c 696e 6520 666f 7220 7468   deadline for th
-00012ce0: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
-00012cf0: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
-00012d00: 6f6e 2e0a 0a54 6865 206f 7074 696f 6e61  on...The optiona
-00012d10: 6c20 6063 7265 6465 6e74 6961 6c73 6020  l `credentials` 
-00012d20: 6172 6775 6d65 6e74 2063 616e 2062 6520  argument can be 
-00012d30: 7573 6564 2074 6f0a 6f76 6572 7269 6465  used to.override
-00012d40: 2063 616c 6c20 6372 6564 656e 7469 616c   call credential
-00012d50: 7320 6465 7269 7665 6420 6672 6f6d 2074  s derived from t
-00012d60: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-00012d70: 7269 6e67 2055 5249 2e0a 0a54 6865 2065  ring URI...The e
-00012d80: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
-00012d90: 7773 2068 6f77 2074 6f20 7374 6172 7420  ws how to start 
-00012da0: 6120 6361 7463 682d 7570 2073 7562 7363  a catch-up subsc
-00012db0: 7269 7074 696f 6e20 6672 6f6d 0a74 6865  ription from.the
-00012dc0: 2066 6972 7374 2072 6563 6f72 6465 6420   first recorded 
-00012dd0: 6576 656e 7420 696e 2061 2073 7472 6561  event in a strea
-00012de0: 6d2e 0a0a 6060 6070 7974 686f 6e0a 2320  m...```python.# 
-00012df0: 5375 6273 6372 6962 6520 6672 6f6d 2074  Subscribe from t
-00012e00: 6865 2073 7461 7274 206f 6620 2773 7472  he start of 'str
-00012e10: 6561 6d32 272e 0a73 7562 7363 7269 7074  eam2'..subscript
-00012e20: 696f 6e20 3d20 636c 6965 6e74 2e73 7562  ion = client.sub
-00012e30: 7363 7269 6265 5f74 6f5f 7374 7265 616d  scribe_to_stream
-00012e40: 2873 7472 6561 6d5f 6e61 6d65 3d73 7472  (stream_name=str
-00012e50: 6561 6d5f 6e61 6d65 3229 0a60 6060 0a0a  eam_name2).```..
-00012e60: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-00012e70: 7720 7368 6f77 7320 686f 7720 746f 2073  w shows how to s
-00012e80: 7461 7274 2061 2063 6174 6368 2d75 7020  tart a catch-up 
-00012e90: 7375 6273 6372 6970 7469 6f6e 2066 726f  subscription fro
-00012ea0: 6d0a 6120 7061 7274 6963 756c 6172 2073  m.a particular s
-00012eb0: 7472 6561 6d20 706f 7369 7469 6f6e 2e0a  tream position..
-00012ec0: 0a60 6060 7079 7468 6f6e 0a23 2053 7562  .```python.# Sub
-00012ed0: 7363 7269 6265 2074 6f20 7374 7265 616d  scribe to stream
-00012ee0: 322c 2066 726f 6d20 7468 6520 7365 636f  2, from the seco
-00012ef0: 6e64 2072 6563 6f72 6465 6420 6576 656e  nd recorded even
-00012f00: 742e 0a73 7562 7363 7269 7074 696f 6e20  t..subscription 
-00012f10: 3d20 636c 6965 6e74 2e73 7562 7363 7269  = client.subscri
-00012f20: 6265 5f74 6f5f 7374 7265 616d 280a 2020  be_to_stream(.  
-00012f30: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-00012f40: 7265 616d 5f6e 616d 6532 2c0a 2020 2020  ream_name2,.    
-00012f50: 7374 7265 616d 5f70 6f73 6974 696f 6e3d  stream_position=
-00012f60: 312c 0a29 0a60 6060 0a0a 2323 2320 486f  1,.).```..### Ho
-00012f70: 7720 746f 2069 6d70 6c65 6d65 6e74 2065  w to implement e
-00012f80: 7861 6374 6c79 2d6f 6e63 6520 6576 656e  xactly-once even
-00012f90: 7420 7072 6f63 6573 7369 6e67 0a0a 5468  t processing..Th
-00012fa0: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-00012fb0: 6e73 206f 6620 7265 636f 7264 6564 2065  ns of recorded e
-00012fc0: 7665 6e74 7320 7468 6174 2061 7265 2072  vents that are r
-00012fd0: 6563 6569 7665 6420 616e 6420 7072 6f63  eceived and proc
-00012fe0: 6573 7365 6420 6279 2061 0a64 6f77 6e73  essed by a.downs
-00012ff0: 7472 6561 6d20 636f 6d70 6f6e 656e 7420  tream component 
-00013000: 6172 6520 7573 6566 756c 6c79 2072 6563  are usefully rec
-00013010: 6f72 6465 6420 6279 2074 6865 2064 6f77  orded by the dow
-00013020: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-00013030: 742c 2073 6f20 7468 6174 0a74 6865 2063  t, so that.the c
-00013040: 6f6d 6d69 7420 706f 7369 7469 6f6e 206f  ommit position o
-00013050: 6620 6c61 7374 2070 726f 6365 7373 6564  f last processed
-00013060: 2065 7665 6e74 2063 616e 2062 6520 6465   event can be de
-00013070: 7465 726d 696e 6564 2077 6865 6e20 7072  termined when pr
-00013080: 6f63 6573 7369 6e67 2069 730a 7265 7375  ocessing is.resu
-00013090: 6d65 642e 0a0a 5468 6520 6c61 7374 2072  med...The last r
-000130a0: 6563 6f72 6465 6420 636f 6d6d 6974 2070  ecorded commit p
-000130b0: 6f73 6974 696f 6e20 6361 6e20 6265 2075  osition can be u
-000130c0: 7365 6420 746f 2073 7065 6369 6679 2074  sed to specify t
-000130d0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-000130e0: 6f6e 2066 726f 6d20 7768 6963 680a 746f  on from which.to
-000130f0: 2073 7562 7363 7269 6265 2077 6865 6e20   subscribe when 
-00013100: 7072 6f63 6573 7369 6e67 2069 7320 7265  processing is re
-00013110: 7375 6d65 642e 2053 696e 6365 2074 6869  sumed. Since thi
-00013120: 7320 636f 6d6d 6974 2070 6f73 6974 696f  s commit positio
-00013130: 6e20 7769 6c6c 2072 6570 7265 7365 6e74  n will represent
-00013140: 2074 6865 0a70 6f73 6974 696f 6e20 6f66   the.position of
-00013150: 2074 6865 206c 6173 7420 7375 6363 6573   the last succes
-00013160: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
-00013170: 2065 7665 6e74 2069 6e20 6120 646f 776e   event in a down
-00013180: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
-00013190: 2c20 736f 2069 740a 7769 6c6c 2062 6520  , so it.will be 
-000131a0: 7573 7561 6c20 746f 2077 616e 7420 7468  usual to want th
-000131b0: 6520 6e65 7874 2065 7665 6e74 2061 6674  e next event aft
-000131c0: 6572 2074 6869 7320 706f 7369 7469 6f6e  er this position
-000131d0: 2c20 6265 6361 7573 6520 7468 6174 2069  , because that i
-000131e0: 7320 7468 6520 6e65 7874 0a65 7665 6e74  s the next.event
-000131f0: 2074 6861 7420 6861 7320 6e6f 7420 7965   that has not ye
-00013200: 7420 6265 656e 2070 726f 6365 7373 6564  t been processed
-00013210: 2e20 466f 7220 7468 6973 2072 6561 736f  . For this reaso
-00013220: 6e2c 2077 6865 6e20 7375 6273 6372 6962  n, when subscrib
-00013230: 696e 6720 666f 7220 6576 656e 7473 0a66  ing for events.f
-00013240: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
-00013250: 6f6d 6d69 7420 706f 7369 7469 6f6e 2075  ommit position u
-00013260: 7369 6e67 2061 2063 6174 6368 2d75 7020  sing a catch-up 
-00013270: 7375 6273 6372 6970 7469 6f6e 2069 6e20  subscription in 
-00013280: 4576 656e 7453 746f 7265 4442 2c20 7468  EventStoreDB, th
-00013290: 650a 7265 636f 7264 6564 2065 7665 6e74  e.recorded event
-000132a0: 2061 7420 7468 6520 7370 6563 6966 6965   at the specifie
-000132b0: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
-000132c0: 6e20 7769 6c6c 204e 4f54 2062 6520 696e  n will NOT be in
-000132d0: 636c 7564 6564 2069 6e20 7468 6520 7365  cluded in the se
-000132e0: 7175 656e 6365 0a6f 6620 7265 636f 7264  quence.of record
-000132f0: 6564 2065 7665 6e74 7320 7468 6174 2061  ed events that a
-00013300: 7265 2072 6563 6569 7665 642e 0a0a 546f  re received...To
-00013310: 2061 6363 6f6d 706c 6973 6820 2265 7861   accomplish "exa
-00013320: 6374 6c79 2d6f 6e63 6522 2070 726f 6365  ctly-once" proce
-00013330: 7373 696e 6720 6f66 2072 6563 6f72 6465  ssing of recorde
-00013340: 6420 6576 656e 7473 2069 6e20 6120 646f  d events in a do
-00013350: 776e 7374 7265 616d 0a63 6f6d 706f 6e65  wnstream.compone
-00013360: 6e74 2077 6865 6e20 7573 696e 6720 6120  nt when using a 
-00013370: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
-00013380: 7074 696f 6e2c 2074 6865 2063 6f6d 6d69  ption, the commi
-00013390: 7420 706f 7369 7469 6f6e 206f 6620 6120  t position of a 
-000133a0: 7265 636f 7264 6564 0a65 7665 6e74 2073  recorded.event s
-000133b0: 686f 756c 6420 6265 2072 6563 6f72 6465  hould be recorde
-000133c0: 6420 6174 6f6d 6963 616c 6c79 2061 6e64  d atomically and
-000133d0: 2075 6e69 7175 656c 7920 616c 6f6e 6720   uniquely along 
-000133e0: 7769 7468 2074 6865 2072 6573 756c 7420  with the result 
-000133f0: 6f66 2070 726f 6365 7373 696e 670a 7265  of processing.re
-00013400: 636f 7264 6564 2065 7665 6e74 732c 2066  corded events, f
-00013410: 6f72 2065 7861 6d70 6c65 2069 6e20 7468  or example in th
-00013420: 6520 7361 6d65 2064 6174 6162 6173 6520  e same database 
-00013430: 6173 206d 6174 6572 6961 6c69 7365 6420  as materialised 
-00013440: 7669 6577 7320 7768 656e 0a69 6d70 6c65  views when.imple
-00013450: 6d65 6e74 696e 6720 6576 656e 7475 616c  menting eventual
-00013460: 6c79 2d63 6f6e 7369 7374 656e 7420 4351  ly-consistent CQ
-00013470: 5253 2c20 6f72 2069 6e20 7468 6520 7361  RS, or in the sa
-00013480: 6d65 2064 6174 6162 6173 6520 6173 2061  me database as a
-00013490: 2064 6f77 6e73 7472 6561 6d0a 616e 616c   downstream.anal
-000134a0: 7974 6963 7320 6f72 2072 6570 6f72 7469  ytics or reporti
-000134b0: 6e67 206f 7220 6172 6368 6976 696e 6720  ng or archiving 
-000134c0: 6170 706c 6963 6174 696f 6e2e 2042 7920  application. By 
-000134d0: 7265 636f 7264 696e 6720 7468 6520 636f  recording the co
-000134e0: 6d6d 6974 2070 6f73 6974 696f 6e0a 6f66  mmit position.of
-000134f0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00013500: 2061 746f 6d69 6361 6c6c 7920 7769 7468   atomically with
-00013510: 2074 6865 206e 6577 2073 7461 7465 2074   the new state t
-00013520: 6861 7420 7265 7375 6c74 7320 6672 6f6d  hat results from
-00013530: 2070 726f 6365 7373 696e 670a 7265 636f   processing.reco
-00013540: 7264 6564 2065 7665 6e74 732c 2022 6475  rded events, "du
-00013550: 616c 2077 7269 7469 6e67 2220 696e 2074  al writing" in t
-00013560: 6865 2063 6f6e 7375 6d70 7469 6f6e 206f  he consumption o
-00013570: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
-00013580: 7320 6361 6e20 6265 0a61 766f 6964 6564  s can be.avoided
-00013590: 2e20 4279 2061 6c73 6f20 7265 636f 7264  . By also record
-000135a0: 696e 6720 7468 6520 636f 6d6d 6974 2070  ing the commit p
-000135b0: 6f73 6974 696f 6e20 756e 6971 7565 6c79  osition uniquely
-000135c0: 2c20 7468 6520 6e65 7720 7374 6174 6520  , the new state 
-000135d0: 6361 6e6e 6f74 2062 650a 7265 636f 7264  cannot be.record
-000135e0: 6564 2074 7769 6365 2c20 616e 6420 6865  ed twice, and he
-000135f0: 6e63 6520 7468 6520 7265 636f 7264 6564  nce the recorded
-00013600: 2073 7461 7465 206f 6620 7468 6520 646f   state of the do
-00013610: 776e 7374 7265 616d 2063 6f6d 706f 6e65  wnstream compone
-00013620: 6e74 2077 696c 6c20 6265 0a75 7064 6174  nt will be.updat
-00013630: 6564 206f 6e6c 7920 6f6e 6365 2066 6f72  ed only once for
-00013640: 2061 6e79 2072 6563 6f72 6465 6420 6576   any recorded ev
-00013650: 656e 742e 2042 7920 7573 696e 6720 7468  ent. By using th
-00013660: 6520 6772 6561 7465 7374 2072 6563 6f72  e greatest recor
-00013670: 6465 6420 636f 6d6d 6974 0a70 6f73 6974  ded commit.posit
-00013680: 696f 6e20 746f 2072 6573 756d 6520 6120  ion to resume a 
-00013690: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
-000136a0: 7074 696f 6e2c 2061 6c6c 2072 6563 6f72  ption, all recor
-000136b0: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
-000136c0: 6576 656e 7475 616c 6c79 0a62 6520 7072  eventually.be pr
-000136d0: 6f63 6573 7365 642e 2054 6865 2063 6f6d  ocessed. The com
-000136e0: 6269 6e61 7469 6f6e 206f 6620 7468 6520  bination of the 
-000136f0: 2261 742d 6d6f 7374 2d6f 6e63 6522 2063  "at-most-once" c
-00013700: 6f6e 6469 7469 6f6e 2061 6e64 2074 6865  ondition and the
-00013710: 2022 6174 2d6c 6561 7374 2d6f 6e63 6522   "at-least-once"
-00013720: 0a63 6f6e 6469 7469 6f6e 2067 6976 6573  .condition gives
-00013730: 2074 6865 2022 6578 6163 746c 792d 6f6e   the "exactly-on
-00013740: 6365 2220 636f 6e64 6974 696f 6e2e 0a0a  ce" condition...
-00013750: 5468 6520 6461 6e67 6572 2077 6974 6820  The danger with 
-00013760: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
-00013770: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
-00013780: 6e20 6f66 2072 6563 6f72 6465 6420 6576  n of recorded ev
-00013790: 656e 7473 2069 7320 7468 6174 2069 6620  ents is that if 
-000137a0: 610a 7265 636f 7264 6564 2065 7665 6e74  a.recorded event
-000137b0: 2069 7320 7375 6363 6573 7366 756c 6c79   is successfully
-000137c0: 2070 726f 6365 7373 6564 2061 6e64 206e   processed and n
-000137d0: 6577 2073 7461 7465 2072 6563 6f72 6465  ew state recorde
-000137e0: 6420 6174 6f6d 6963 616c 6c79 2069 6e20  d atomically in 
-000137f0: 6f6e 650a 7472 616e 7361 6374 696f 6e20  one.transaction 
-00013800: 7769 7468 2074 6865 2063 6f6d 6d69 7420  with the commit 
-00013810: 706f 7369 7469 6f6e 2072 6563 6f72 6465  position recorde
-00013820: 6420 696e 2061 2073 6570 6172 6174 6520  d in a separate 
-00013830: 7472 616e 7361 6374 696f 6e2c 206f 6e65  transaction, one
-00013840: 206d 6179 0a68 6170 7065 6e20 616e 6420   may.happen and 
-00013850: 6e6f 7420 7468 6520 6f74 6865 722e 2049  not the other. I
-00013860: 6620 7468 6520 6e65 7720 7374 6174 6520  f the new state 
-00013870: 6973 2072 6563 6f72 6465 6420 6275 7420  is recorded but 
-00013880: 7468 6520 706f 7369 7469 6f6e 2069 7320  the position is 
-00013890: 6c6f 7374 2c0a 616e 6420 7468 656e 2074  lost,.and then t
-000138a0: 6865 2070 726f 6365 7373 696e 6720 6973  he processing is
-000138b0: 2073 746f 7070 6564 2061 6e64 2072 6573   stopped and res
-000138c0: 756d 6564 2c20 7468 6520 7265 636f 7264  umed, the record
-000138d0: 6564 2065 7665 6e74 206d 6179 2062 6520  ed event may be 
-000138e0: 7072 6f63 6573 7365 640a 7477 6963 652e  processed.twice.
-000138f0: 204f 6e20 7468 6520 6f74 6865 7220 6861   On the other ha
-00013900: 6e64 2c20 6966 2074 6865 2063 6f6d 6d69  nd, if the commi
-00013910: 7420 706f 7369 7469 6f6e 2069 7320 7265  t position is re
-00013920: 636f 7264 6564 2062 7574 2074 6865 206e  corded but the n
-00013930: 6577 2073 7461 7465 2069 730a 6c6f 7374  ew state is.lost
-00013940: 2c20 7468 6520 7265 636f 7264 6564 2065  , the recorded e
-00013950: 7665 6e74 206d 6179 2065 6666 6563 7469  vent may effecti
-00013960: 7665 6c79 206e 6f74 2062 6520 7072 6f63  vely not be proc
-00013970: 6573 7365 6420 6174 2061 6c6c 2e20 4279  essed at all. By
-00013980: 2065 6974 6865 720a 7072 6f63 6573 7369   either.processi
-00013990: 6e67 2061 6e20 6576 656e 7420 6d6f 7265  ng an event more
-000139a0: 2074 6861 6e20 6f6e 6365 2c20 6f72 2062   than once, or b
-000139b0: 7920 6661 696c 696e 6720 746f 2070 726f  y failing to pro
-000139c0: 6365 7373 2061 6e20 6576 656e 742c 2074  cess an event, t
-000139d0: 6865 2072 6563 6f72 6465 640a 7374 6174  he recorded.stat
-000139e0: 6520 6f66 2074 6865 2064 6f77 6e73 7472  e of the downstr
-000139f0: 6561 6d20 636f 6d70 6f6e 656e 7420 6d69  eam component mi
-00013a00: 6768 7420 6265 2069 6e61 6363 7572 6174  ght be inaccurat
-00013a10: 652c 206f 7220 706f 7373 6962 6c79 2069  e, or possibly i
-00013a20: 6e63 6f6e 7369 7374 656e 742c 2061 6e64  nconsistent, and
-00013a30: 0a70 6572 6861 7073 2063 6174 6173 7472  .perhaps catastr
-00013a40: 6f70 6869 6361 6c6c 7920 736f 2e20 5375  ophically so. Su
-00013a50: 6368 2063 6f6e 7365 7175 656e 6365 7320  ch consequences 
-00013a60: 6d61 7920 6f72 206d 6179 206e 6f74 206d  may or may not m
-00013a70: 6174 7465 7220 696e 2079 6f75 7220 7369  atter in your si
-00013a80: 7475 6174 696f 6e2e 0a42 7574 2073 6f6d  tuation..But som
-00013a90: 6574 696d 6573 2069 6e63 6f6e 7369 7374  etimes inconsist
-00013aa0: 656e 6369 6573 206d 6179 2068 616c 7420  encies may halt 
-00013ab0: 7072 6f63 6573 7369 6e67 2075 6e74 696c  processing until
-00013ac0: 2074 6865 2069 7373 7565 2069 7320 7265   the issue is re
-00013ad0: 736f 6c76 6564 2e20 596f 7520 6361 6e0a  solved. You can.
-00013ae0: 6176 6f69 6420 2264 7561 6c20 7772 6974  avoid "dual writ
-00013af0: 696e 6722 2069 6e20 7468 6520 636f 6e73  ing" in the cons
-00013b00: 756d 7074 696f 6e20 6f66 2065 7665 6e74  umption of event
-00013b10: 7320 6279 2061 746f 6d69 6361 6c6c 7920  s by atomically 
-00013b20: 7265 636f 7264 696e 6720 7468 6520 636f  recording the co
-00013b30: 6d6d 6974 0a70 6f73 6974 696f 6e20 6f66  mmit.position of
-00013b40: 2061 2072 6563 6f72 6465 6420 6576 656e   a recorded even
-00013b50: 7420 616c 6f6e 6720 7769 7468 2074 6865  t along with the
-00013b60: 206e 6577 2073 7461 7465 2074 6861 7420   new state that 
-00013b70: 7265 7375 6c74 7320 6672 6f6d 2070 726f  results from pro
-00013b80: 6365 7373 696e 6720 7468 6174 0a65 7665  cessing that.eve
-00013b90: 6e74 2069 6e20 7468 6520 7361 6d65 2061  nt in the same a
-00013ba0: 746f 6d69 6320 7472 616e 7361 6374 696f  tomic transactio
-00013bb0: 6e2e 2042 7920 6d61 6b69 6e67 2074 6865  n. By making the
-00013bc0: 2072 6563 6f72 6469 6e67 206f 6620 7468   recording of th
-00013bd0: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
-00013be0: 6e73 0a75 6e69 7175 652c 2073 6f20 7468  ns.unique, so th
-00013bf0: 6174 2074 7261 6e73 6163 7469 6f6e 7320  at transactions 
-00013c00: 7769 6c6c 2062 6520 726f 6c6c 6564 2062  will be rolled b
-00013c10: 6163 6b20 7768 656e 2074 6865 7265 2069  ack when there i
-00013c20: 7320 6120 636f 6e66 6c69 6374 2c20 796f  s a conflict, yo
-00013c30: 7520 7769 6c6c 0a70 7265 7665 6e74 2074  u will.prevent t
-00013c40: 6865 2072 6573 756c 7473 206f 6620 616e  he results of an
-00013c50: 7920 6475 706c 6963 6174 6520 7072 6f63  y duplicate proc
-00013c60: 6573 7369 6e67 206f 6620 6120 7265 636f  essing of a reco
-00013c70: 7264 6564 2065 7665 6e74 2062 6569 6e67  rded event being
-00013c80: 2063 6f6d 6d69 7474 6564 2e0a 0a52 6563   committed...Rec
-00013c90: 6f72 6465 6420 6576 656e 7473 2072 6563  orded events rec
-00013ca0: 6569 7665 6420 6672 6f6d 2061 2063 6174  eived from a cat
-00013cb0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-00013cc0: 6f6e 2063 616e 6e6f 7420 6265 2061 636b  on cannot be ack
-00013cd0: 6e6f 776c 6564 6765 6420 6261 636b 0a74  nowledged back.t
-00013ce0: 6f20 7468 6520 4576 656e 7453 746f 7265  o the EventStore
-00013cf0: 4442 2073 6572 7665 722e 2041 636b 6e6f  DB server. Ackno
-00013d00: 776c 6564 6769 6e67 2065 7665 6e74 732c  wledging events,
-00013d10: 2068 6f77 6576 6572 2c20 6973 2061 6e20   however, is an 
-00013d20: 6173 7065 6374 206f 6620 2270 6572 7369  aspect of "persi
-00013d30: 7374 656e 740a 7375 6273 6372 6970 7469  stent.subscripti
-00013d40: 6f6e 7322 2e20 486f 7069 6e67 2074 6f20  ons". Hoping to 
-00013d50: 7265 6c79 206f 6e20 6163 6b6e 6f77 6c65  rely on acknowle
-00013d60: 6467 696e 6720 6576 656e 7473 2074 6f20  dging events to 
-00013d70: 616e 2075 7073 7472 6561 6d0a 636f 6d70  an upstream.comp
-00013d80: 6f6e 656e 7420 6973 2061 6e20 6578 616d  onent is an exam
-00013d90: 706c 6520 6f66 2064 7561 6c20 7772 6974  ple of dual writ
-00013da0: 696e 672e 0a0a 0a23 2320 5065 7273 6973  ing....## Persis
-00013db0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-00013dc0: 6e73 0a0a 496e 2045 7665 6e74 5374 6f72  ns..In EventStor
-00013dd0: 6544 422c 2022 7065 7273 6973 7465 6e74  eDB, "persistent
-00013de0: 2220 7375 6273 6372 6970 7469 6f6e 7320  " subscriptions 
-00013df0: 6172 6520 7369 6d69 6c61 7220 746f 2063  are similar to c
-00013e00: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-00013e10: 7469 6f6e 732c 0a69 6e20 7468 6174 2072  tions,.in that r
-00013e20: 6561 6469 6e67 2061 2070 6572 7369 7374  eading a persist
-00013e30: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-00013e40: 2077 696c 6c20 626c 6f63 6b20 7768 656e   will block when
-00013e50: 2074 6865 7265 2061 7265 206e 6f20 6d6f   there are no mo
-00013e60: 7265 2072 6563 6f72 6465 640a 6576 656e  re recorded.even
-00013e70: 7473 2074 6f20 6265 2072 6563 6569 7665  ts to be receive
-00013e80: 642c 2061 6e64 2074 6865 6e20 636f 6e74  d, and then cont
-00013e90: 696e 7565 2077 6865 6e20 6e65 7720 6576  inue when new ev
-00013ea0: 656e 7473 2061 7265 2073 7562 7365 7175  ents are subsequ
-00013eb0: 656e 746c 7920 7265 636f 7264 6564 2e0a  ently recorded..
-00013ec0: 0a50 6572 7369 7374 656e 7420 7375 6273  .Persistent subs
-00013ed0: 6372 6970 7469 6f6e 7320 6361 6e0a 0a50  criptions can..P
-00013ee0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00013ef0: 6970 7469 6f6e 7320 6361 6e20 6265 2063  iptions can be c
-00013f00: 6f6e 7375 6d65 6420 6279 2061 2067 726f  onsumed by a gro
-00013f10: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
-00013f20: 6f70 6572 6174 696e 6720 7769 7468 206f  operating with o
-00013f30: 6e65 0a6f 6620 7468 6520 7375 7070 6f72  ne.of the suppor
-00013f40: 7465 6420 2263 6f6e 7375 6d65 7220 7374  ted "consumer st
-00013f50: 7261 7465 6769 6573 222e 0a0a 5468 6520  rategies"...The 
-00013f60: 7369 676e 6966 6963 616e 7420 6469 6666  significant diff
-00013f70: 6572 656e 7420 7769 7468 2070 6572 7369  erent with persi
-00013f80: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-00013f90: 6f6e 7320 6973 2074 6865 2073 6572 7665  ons is the serve
-00013fa0: 7220 7769 6c6c 206b 6565 7020 7472 6163  r will keep trac
-00013fb0: 6b0a 6f66 2074 6865 2070 726f 6772 6573  k.of the progres
-00013fc0: 7320 6f66 2074 6865 2063 6f6e 7375 6d65  s of the consume
-00013fd0: 7273 2e20 5468 6520 636f 6e73 756d 6572  rs. The consumer
-00013fe0: 206f 6620 6120 7065 7273 6973 7465 6e74   of a persistent
-00013ff0: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
-00014000: 6c6c 0a74 6865 7265 666f 7265 206e 6565  ll.therefore nee
-00014010: 6420 746f 2022 6163 6b6e 6f77 6c65 6467  d to "acknowledg
-00014020: 6522 2077 6865 6e20 6120 7265 636f 7264  e" when a record
-00014030: 6564 2065 7665 6e74 2068 6173 2062 6565  ed event has bee
-00014040: 6e20 7072 6f63 6573 7365 6420 7375 6363  n processed succ
-00014050: 6573 7366 756c 6c79 2c0a 616e 6420 6f74  essfully,.and ot
-00014060: 6865 7277 6973 6520 226e 6567 6174 6976  herwise "negativ
-00014070: 656c 7920 6163 6b6e 6f77 6c65 6467 6522  ely acknowledge"
-00014080: 2061 2072 6563 6f72 6465 6420 6576 656e   a recorded even
-00014090: 7420 7468 6174 2068 6173 2062 6565 6e20  t that has been 
-000140a0: 7265 6365 6976 6564 2062 7574 2077 6173  received but was
-000140b0: 0a6e 6f74 2073 7563 6365 7373 6675 6c6c  .not successfull
-000140c0: 7920 7072 6f63 6573 7365 642e 0a0a 416c  y processed...Al
-000140d0: 6c20 6f66 2074 6869 7320 6d65 616e 7320  l of this means 
-000140e0: 7468 6174 2066 6f72 2070 6572 7369 7374  that for persist
-000140f0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-00014100: 7320 7468 6572 6520 6172 6520 2263 7265  s there are "cre
-00014110: 6174 6522 2c20 2272 6561 6422 2c20 2275  ate", "read", "u
-00014120: 7064 6174 6522 0a22 6465 6c65 7465 222c  pdate"."delete",
-00014130: 2022 6163 6b22 2c20 616e 6420 226e 6163   "ack", and "nac
-00014140: 6b22 206f 7065 7261 7469 6f6e 7320 746f  k" operations to
-00014150: 2063 6f6e 7369 6465 722e 0a0a 5768 696c   consider...Whil
-00014160: 7374 2074 6865 7265 2061 7265 2073 6f6d  st there are som
-00014170: 6520 6164 7661 6e74 6167 6573 206f 6620  e advantages of 
-00014180: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00014190: 7269 7074 696f 6e73 2c20 696e 2070 6172  riptions, in par
-000141a0: 7469 6375 6c61 7220 7468 650a 636f 6e63  ticular the.conc
-000141b0: 7572 7265 6e74 2070 726f 6365 7373 696e  urrent processin
-000141c0: 6720 6f66 2072 6563 6f72 6465 6420 6576  g of recorded ev
-000141d0: 656e 7473 2062 7920 6120 6772 6f75 7020  ents by a group 
-000141e0: 6f66 2063 6f6e 7375 6d65 7273 2c20 6279  of consumers, by
-000141f0: 2074 7261 636b 696e 6720 696e 0a74 6865   tracking in.the
-00014200: 2073 6572 7665 7220 7468 6520 706f 7369   server the posi
-00014210: 7469 6f6e 2069 6e20 7468 6520 636f 6d6d  tion in the comm
-00014220: 6974 2073 6571 7565 6e63 6520 6f66 2065  it sequence of e
-00014230: 7665 6e74 7320 7468 6174 2068 6176 6520  vents that have 
-00014240: 6265 656e 2070 726f 6365 7373 6564 2c0a  been processed,.
-00014250: 7468 6520 6973 7375 6520 6f66 2022 6475  the issue of "du
-00014260: 616c 2077 7269 7469 6e67 2220 696e 2074  al writing" in t
-00014270: 6865 2063 6f6e 7375 6d70 7469 6f6e 206f  he consumption o
-00014280: 6620 6576 656e 7473 2061 7269 7365 732e  f events arises.
-00014290: 2052 656c 6961 6269 6c69 7479 2069 6e20   Reliability in 
-000142a0: 7468 650a 7072 6f63 6573 7369 6e67 206f  the.processing o
-000142b0: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
-000142c0: 7320 6279 2061 2067 726f 7570 206f 6620  s by a group of 
-000142d0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-000142e0: 7269 7074 696f 6e20 636f 6e73 756d 6572  ription consumer
-000142f0: 7320 7769 6c6c 0a72 656c 7920 6f6e 2074  s will.rely on t
-00014300: 6865 6972 2069 6465 6d70 6f74 656e 7420  heir idempotent 
-00014310: 6861 6e64 6c69 6e67 206f 6620 6475 706c  handling of dupl
-00014320: 6963 6174 6520 6d65 7373 6167 6573 2c20  icate messages, 
-00014330: 616e 6420 7468 6569 7220 7265 7369 6c69  and their resili
-00014340: 656e 6365 2074 6f0a 6f75 742d 6f66 2d6f  ence to.out-of-o
-00014350: 7264 6572 2064 656c 6976 6572 792e 0a0a  rder delivery...
-00014360: 0a23 2323 2043 7265 6174 6520 7375 6273  .### Create subs
-00014370: 6372 6970 7469 6f6e 2074 6f20 616c 6c0a  cription to all.
-00014380: 0a2a 7265 7175 6972 6573 206c 6561 6465  .*requires leade
-00014390: 722a 0a0a 5468 6520 6063 7265 6174 655f  r*..The `create_
-000143a0: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
-000143b0: 616c 6c28 2960 206d 6574 686f 6420 6361  all()` method ca
-000143c0: 6e20 6265 2075 7365 6420 746f 2063 7265  n be used to cre
-000143d0: 6174 6520 6120 2270 6572 7369 7374 656e  ate a "persisten
-000143e0: 7420 7375 6273 6372 6970 7469 6f6e 220a  t subscription".
-000143f0: 746f 2061 6c6c 2074 6865 2072 6563 6f72  to all the recor
-00014400: 6465 6420 6576 656e 7473 2069 6e20 7468  ded events in th
-00014410: 6520 6461 7461 6261 7365 2061 6372 6f73  e database acros
-00014420: 7320 616c 6c20 7374 7265 616d 732e 0a0a  s all streams...
-00014430: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
-00014440: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
-00014450: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
-00014460: 2c20 7768 6963 6820 6973 2074 6865 0a6e  , which is the.n
-00014470: 616d 6520 6f66 2061 2022 6772 6f75 7022  ame of a "group"
-00014480: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
-00014490: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-000144a0: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
-000144b0: 616c 736f 2068 6173 2065 6967 6874 206f  also has eight o
-000144c0: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
-000144d0: 732c 2060 6672 6f6d 5f65 6e64 602c 2060  s, `from_end`, `
-000144e0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
-000144f0: 2c0a 6066 696c 7465 725f 6578 636c 7564  ,.`filter_exclud
-00014500: 6560 2c20 6066 696c 7465 725f 696e 636c  e`, `filter_incl
-00014510: 7564 6560 2c20 6066 696c 7465 725f 6279  ude`, `filter_by
-00014520: 5f73 7472 6561 6d5f 6e61 6d65 602c 2060  _stream_name`, `
-00014530: 636f 6e73 756d 6572 5f73 7472 6174 6567  consumer_strateg
-00014540: 7960 2c0a 6074 696d 656f 7574 6020 616e  y`,.`timeout` an
-00014550: 6420 6063 7265 6465 6e74 6961 6c73 602e  d `credentials`.
-00014560: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-00014570: 6672 6f6d 5f65 6e64 6020 6172 6775 6d65  from_end` argume
-00014580: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
-00014590: 6f20 7370 6563 6966 7920 7468 6174 2074  o specify that t
-000145a0: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
-000145b0: 756d 6572 730a 6f66 2074 6865 2073 7562  umers.of the sub
-000145c0: 7363 7269 7074 696f 6e20 7368 6f75 6c64  scription should
-000145d0: 206f 6e6c 7920 7265 6365 6976 6520 6576   only receive ev
-000145e0: 656e 7473 2074 6861 7420 7765 7265 2072  ents that were r
-000145f0: 6563 6f72 6465 6420 6166 7465 7220 7468  ecorded after th
-00014600: 6520 7375 6273 6372 6970 7469 6f6e 0a77  e subscription.w
-00014610: 6173 2063 7265 6174 6564 2e0a 0a41 6c74  as created...Alt
-00014620: 6572 6e61 7469 7665 6c79 2c20 7468 6520  ernatively, the 
-00014630: 6f70 7469 6f6e 616c 2060 636f 6d6d 6974  optional `commit
-00014640: 5f70 6f73 6974 696f 6e60 2061 7267 756d  _position` argum
-00014650: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
-00014660: 746f 2073 7065 6369 6679 2061 2063 6f6d  to specify a com
-00014670: 6d69 740a 706f 7369 7469 6f6e 2066 726f  mit.position fro
-00014680: 6d20 7768 6963 6820 636f 6d6d 6974 2070  m which commit p
-00014690: 6f73 6974 696f 6e20 7468 6520 6772 6f75  osition the grou
-000146a0: 7020 6f66 2063 6f6e 7375 6d65 7273 206f  p of consumers o
-000146b0: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
-000146c0: 6f6e 2073 686f 756c 640a 7265 6365 6976  on should.receiv
-000146d0: 6520 6576 656e 7473 2e20 506c 6561 7365  e events. Please
-000146e0: 206e 6f74 652c 2074 6865 2072 6563 6f72   note, the recor
-000146f0: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
-00014700: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
-00014710: 7420 706f 7369 7469 6f6e 206d 6967 6874  t position might
-00014720: 0a62 6520 696e 636c 7564 6564 2069 6e20  .be included in 
-00014730: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
-00014740: 6e74 7320 7265 6365 6976 6564 2062 7920  nts received by 
-00014750: 7468 6520 6772 6f75 7020 6f66 2063 6f6e  the group of con
-00014760: 7375 6d65 7273 2e0a 0a49 6620 6e65 6974  sumers...If neit
-00014770: 6865 7220 6066 726f 6d5f 656e 6460 206f  her `from_end` o
-00014780: 7220 6063 6f6d 6d69 745f 706f 7369 7469  r `commit_positi
-00014790: 6f6e 6020 6172 6520 7370 6563 6966 6965  on` are specifie
-000147a0: 642c 2074 6865 2067 726f 7570 206f 6620  d, the group of 
-000147b0: 636f 6e73 756d 6572 730a 6f66 2074 6865  consumers.of the
-000147c0: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
-000147d0: 6c6c 2070 6f74 656e 7469 616c 6c79 2072  ll potentially r
-000147e0: 6563 6569 7665 2061 6c6c 2072 6563 6f72  eceive all recor
-000147f0: 6465 6420 6576 656e 7473 2069 6e20 7468  ded events in th
-00014800: 6520 6461 7461 6261 7365 2e0a 0a54 6865  e database...The
-00014810: 206f 7074 696f 6e61 6c20 6066 696c 7465   optional `filte
-00014820: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
-00014830: 656e 7420 6973 2061 2073 6571 7565 6e63  ent is a sequenc
-00014840: 6520 6f66 2072 6567 756c 6172 2065 7870  e of regular exp
-00014850: 7265 7373 696f 6e73 2074 6861 740a 7370  ressions that.sp
-00014860: 6563 6966 6965 7320 7768 6963 6820 7265  ecifies which re
-00014870: 636f 7264 6564 2065 7665 6e74 7320 7368  corded events sh
-00014880: 6f75 6c64 2062 6520 7265 7475 726e 6564  ould be returned
-00014890: 2e20 5468 6973 2061 7267 756d 656e 7420  . This argument 
-000148a0: 6973 2069 676e 6f72 6564 0a69 6620 6066  is ignored.if `f
-000148b0: 696c 7465 725f 696e 636c 7564 6560 2069  ilter_include` i
-000148c0: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
-000148d0: 6d70 7479 2073 6571 7565 6e63 652e 2054  mpty sequence. T
-000148e0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-000148f0: 206f 6620 7468 6973 0a61 7267 756d 656e   of this.argumen
-00014900: 7420 6d61 7463 6865 7320 7468 6520 6576  t matches the ev
-00014910: 656e 7420 7479 7065 7320 6f66 2045 7665  ent types of Eve
-00014920: 6e74 5374 6f72 6544 4220 2273 7973 7465  ntStoreDB "syste
-00014930: 6d20 6576 656e 7473 222c 2073 6f20 7468  m events", so th
-00014940: 6174 2073 7973 7465 6d0a 6576 656e 7473  at system.events
-00014950: 2077 696c 6c20 6e6f 7420 6e6f 726d 616c   will not normal
-00014960: 6c79 2062 6520 696e 636c 7564 6564 2e20  ly be included. 
-00014970: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
-00014980: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
-00014990: 6d6f 7265 0a69 6e66 6f72 6d61 7469 6f6e  more.information
-000149a0: 2061 626f 7574 2066 696c 7465 7220 6578   about filter ex
-000149b0: 7072 6573 7369 6f6e 732e 0a0a 5468 6520  pressions...The 
-000149c0: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
-000149d0: 5f69 6e63 6c75 6465 6020 6172 6775 6d65  _include` argume
-000149e0: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
-000149f0: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
-00014a00: 6573 7369 6f6e 730a 7468 6174 2073 7065  essions.that spe
-00014a10: 6369 6669 6573 2077 6869 6368 2072 6563  cifies which rec
-00014a20: 6f72 6465 6420 6576 656e 7473 2073 686f  orded events sho
-00014a30: 756c 6420 6265 2072 6574 7572 6e65 642e  uld be returned.
-00014a40: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
-00014a50: 730a 6172 6775 6d65 6e74 2069 7320 616e  s.argument is an
-00014a60: 2065 6d70 7479 2074 7570 6c65 2e20 4966   empty tuple. If
-00014a70: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
-00014a80: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
-00014a90: 6d70 7479 2073 6571 7565 6e63 652c 0a74  mpty sequence,.t
-00014aa0: 6865 2060 6669 6c74 6572 5f65 7863 6c75  he `filter_exclu
-00014ab0: 6465 6020 6172 6775 6d65 6e74 2069 7320  de` argument is 
-00014ac0: 6967 6e6f 7265 642e 0a0a 5468 6520 6f70  ignored...The op
-00014ad0: 7469 6f6e 616c 2060 6669 6c74 6572 5f62  tional `filter_b
-00014ae0: 795f 7374 7265 616d 5f6e 616d 6560 2061  y_stream_name` a
-00014af0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-00014b00: 686f 6e20 6062 6f6f 6c60 2074 6861 7420  hon `bool` that 
-00014b10: 696e 6469 6361 7465 730a 7768 6574 6865  indicates.whethe
-00014b20: 7220 7468 6520 6669 6c74 6572 696e 6720  r the filtering 
-00014b30: 7769 6c6c 2061 7070 6c79 2074 6f20 6576  will apply to ev
-00014b40: 656e 7420 7479 7065 7320 6f72 2073 7472  ent types or str
-00014b50: 6561 6d20 6e61 6d65 732e 2042 7920 6465  eam names. By de
-00014b60: 6661 756c 742c 2074 6869 730a 7661 6c75  fault, this.valu
-00014b70: 6520 6973 2060 4661 6c73 6560 2061 6e64  e is `False` and
-00014b80: 2073 6f20 7468 6520 6669 6c74 6572 696e   so the filterin
-00014b90: 6720 7769 6c6c 2061 7070 6c79 2074 6f20  g will apply to 
-00014ba0: 7468 6520 6576 656e 7420 7479 7065 2073  the event type s
-00014bb0: 7472 696e 6773 206f 660a 7265 636f 7264  trings of.record
-00014bc0: 6564 2065 7665 6e74 732e 0a0a 5468 6520  ed events...The 
-00014bd0: 6f70 7469 6f6e 616c 2060 636f 6e73 756d  optional `consum
-00014be0: 6572 5f73 7472 6174 6567 7960 2061 7267  er_strategy` arg
-00014bf0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-00014c00: 6e20 6073 7472 6020 7468 6174 2064 6566  n `str` that def
-00014c10: 696e 6573 0a74 6865 2063 6f6e 7375 6d65  ines.the consume
-00014c20: 7220 7374 7261 7465 6779 2066 6f72 2074  r strategy for t
-00014c30: 6869 7320 7065 7273 6973 7465 6e74 2073  his persistent s
-00014c40: 7562 7363 7269 7074 696f 6e2e 2054 6865  ubscription. The
-00014c50: 2076 616c 7565 206f 6620 7468 6973 2061   value of this a
-00014c60: 7267 756d 656e 740a 6361 6e20 6265 2060  rgument.can be `
-00014c70: 2744 6973 7061 7463 6854 6f53 696e 676c  'DispatchToSingl
-00014c80: 6527 602c 2060 2752 6f75 6e64 526f 6269  e'`, `'RoundRobi
-00014c90: 6e27 602c 2060 2750 696e 6e65 6427 602c  n'`, `'Pinned'`,
-00014ca0: 206f 7220 6027 5069 6e6e 6564 4279 436f   or `'PinnedByCo
-00014cb0: 7272 656c 6174 696f 6e27 602e 2054 6865  rrelation'`. The
-00014cc0: 0a64 6566 6175 6c74 2076 616c 7565 2069  .default value i
-00014cd0: 7320 6027 4469 7370 6174 6368 546f 5369  s `'DispatchToSi
-00014ce0: 6e67 6c65 2760 2e0a 0a54 6865 206f 7074  ngle'`...The opt
-00014cf0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-00014d00: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-00014d10: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
-00014d20: 6368 2073 6574 7320 610a 6465 6164 6c69  ch sets a.deadli
-00014d30: 6e65 2066 6f72 2074 6865 2063 6f6d 706c  ne for the compl
-00014d40: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
-00014d50: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
-00014d60: 6520 6f70 7469 6f6e 616c 2060 6372 6564  e optional `cred
-00014d70: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
-00014d80: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-00014d90: 0a6f 7665 7272 6964 6520 6361 6c6c 2063  .override call c
-00014da0: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
-00014db0: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
-00014dc0: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
-00014dd0: 492e 0a0a 5468 6520 6d65 7468 6f64 2060  I...The method `
-00014de0: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
-00014df0: 696f 6e5f 746f 5f61 6c6c 2829 6020 646f  ion_to_all()` do
-00014e00: 6573 206e 6f74 2072 6574 7572 6e20 6120  es not return a 
-00014e10: 7661 6c75 652e 2052 6563 6f72 6465 6420  value. Recorded 
-00014e20: 6576 656e 7473 2061 7265 0a6f 6274 6169  events are.obtai
-00014e30: 6e65 6420 6279 2063 616c 6c69 6e67 2074  ned by calling t
-00014e40: 6865 2060 7265 6164 5f73 7562 7363 7269  he `read_subscri
-00014e50: 7074 696f 6e5f 746f 5f61 6c6c 2829 6020  ption_to_all()` 
-00014e60: 6d65 7468 6f64 2e0a 0a49 6e20 7468 6520  method...In the 
-00014e70: 6578 616d 706c 6520 6265 6c6f 772c 2061  example below, a
-00014e80: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-00014e90: 6372 6970 7469 6f6e 2069 7320 6372 6561  cription is crea
-00014ea0: 7465 6420 746f 206f 7065 7261 7465 2066  ted to operate f
-00014eb0: 726f 6d20 7468 650a 6669 7273 7420 7265  rom the.first re
-00014ec0: 636f 7264 6564 206e 6f6e 2d73 7973 7465  corded non-syste
-00014ed0: 6d20 6576 656e 7420 696e 2074 6865 2064  m event in the d
-00014ee0: 6174 6162 6173 652e 0a0a 6060 6070 7974  atabase...```pyt
-00014ef0: 686f 6e0a 2320 4372 6561 7465 2061 2070  hon.# Create a p
-00014f00: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00014f10: 6970 7469 6f6e 2e0a 6772 6f75 705f 6e61  iption..group_na
-00014f20: 6d65 3120 3d20 6622 6772 6f75 702d 7b75  me1 = f"group-{u
-00014f30: 7569 642e 7575 6964 3428 297d 220a 636c  uid.uuid4()}".cl
-00014f40: 6965 6e74 2e63 7265 6174 655f 7375 6273  ient.create_subs
-00014f50: 6372 6970 7469 6f6e 5f74 6f5f 616c 6c28  cription_to_all(
-00014f60: 6772 6f75 705f 6e61 6d65 3d67 726f 7570  group_name=group
-00014f70: 5f6e 616d 6531 290a 6060 600a 0a23 2323  _name1).```..###
-00014f80: 2052 6561 6420 7375 6273 6372 6970 7469   Read subscripti
-00014f90: 6f6e 2074 6f20 616c 6c0a 0a2a 7265 7175  on to all..*requ
-00014fa0: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
-00014fb0: 6520 6072 6561 645f 7375 6273 6372 6970  e `read_subscrip
-00014fc0: 7469 6f6e 5f74 6f5f 616c 6c28 2960 206d  tion_to_all()` m
-00014fd0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00014fe0: 6420 6279 2061 2067 726f 7570 206f 6620  d by a group of 
-00014ff0: 636f 6e73 756d 6572 7320 746f 2072 6563  consumers to rec
-00015000: 6569 7665 0a72 6563 6f72 6465 6420 6576  eive.recorded ev
-00015010: 656e 7473 2066 726f 6d20 6120 7065 7273  ents from a pers
-00015020: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00015030: 696f 6e20 7468 6174 2068 6173 2062 6565  ion that has bee
-00015040: 6e20 6372 6561 7465 6420 7573 696e 670a  n created using.
-00015050: 7468 6520 6063 7265 6174 655f 7375 6273  the `create_subs
-00015060: 6372 6970 7469 6f6e 5f74 6f5f 616c 6c28  cription_to_all(
-00015070: 2960 206d 6574 686f 642e 0a0a 5468 6973  )` method...This
-00015080: 206d 6574 686f 6420 6861 7320 6120 7265   method has a re
-00015090: 7175 6972 6564 2060 6772 6f75 705f 6e61  quired `group_na
-000150a0: 6d65 6020 6172 6775 6d65 6e74 2c20 7768  me` argument, wh
-000150b0: 6963 6820 6973 0a74 6865 206e 616d 6520  ich is.the name 
-000150c0: 6f66 2061 2022 6772 6f75 7022 206f 6620  of a "group" of 
-000150d0: 636f 6e73 756d 6572 7320 6f66 2074 6865  consumers of the
-000150e0: 2073 7562 7363 7269 7074 696f 6e20 7370   subscription sp
-000150f0: 6563 6966 6965 640a 7768 656e 2060 6372  ecified.when `cr
-00015100: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
-00015110: 6e5f 746f 5f61 6c6c 2829 6020 7761 7320  n_to_all()` was 
-00015120: 6361 6c6c 6564 2e0a 0a54 6869 7320 6d65  called...This me
-00015130: 7468 6f64 2068 6173 2061 6e20 6f70 7469  thod has an opti
-00015140: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00015150: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
-00015160: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-00015170: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-00015180: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
-00015190: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
-000151a0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-000151b0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-000151c0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
-000151d0: 6c73 6f20 6861 7320 616e 206f 7074 696f  lso has an optio
-000151e0: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
-000151f0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-00015200: 6820 6361 6e20 6265 2075 7365 6420 746f  h can be used to
-00015210: 0a6f 7665 7272 6964 6520 6361 6c6c 2063  .override call c
-00015220: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
-00015230: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
-00015240: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
-00015250: 492e 0a0a 5468 6973 206d 6574 686f 6420  I...This method 
-00015260: 7265 7475 726e 7320 6120 6050 6572 7369  returns a `Persi
-00015270: 7374 656e 7453 7562 7363 7269 7074 696f  stentSubscriptio
-00015280: 6e60 206f 626a 6563 742c 2077 6869 6368  n` object, which
-00015290: 2069 7320 616e 2069 7465 7261 746f 720a   is an iterator.
-000152a0: 6769 7669 6e67 2060 5265 636f 7264 6564  giving `Recorded
-000152b0: 4576 656e 7460 206f 626a 6563 7473 2e20  Event` objects. 
-000152c0: 4974 2061 6c73 6f20 6861 7320 6061 636b  It also has `ack
-000152d0: 2829 602c 2060 6e61 636b 2829 6020 616e  ()`, `nack()` an
-000152e0: 6420 6073 746f 7028 2960 0a6d 6574 686f  d `stop()`.metho
-000152f0: 6473 2e0a 0a60 6060 7079 7468 6f6e 0a73  ds...```python.s
-00015300: 7562 7363 7269 7074 696f 6e20 3d20 636c  ubscription = cl
-00015310: 6965 6e74 2e72 6561 645f 7375 6273 6372  ient.read_subscr
-00015320: 6970 7469 6f6e 5f74 6f5f 616c 6c28 6772  iption_to_all(gr
-00015330: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
-00015340: 616d 6531 290a 6060 600a 0a54 6865 2060  ame1).```..The `
-00015350: 6163 6b28 2960 206d 6574 686f 6420 7368  ack()` method sh
-00015360: 6f75 6c64 2062 6520 7573 6564 2062 7920  ould be used by 
-00015370: 6120 636f 6e73 756d 6572 2074 6f20 696e  a consumer to in
-00015380: 6469 6361 7465 2074 6f20 7468 6520 7365  dicate to the se
-00015390: 7276 6572 2074 6861 7420 6974 0a68 6173  rver that it.has
-000153a0: 2072 6563 6569 7665 6420 616e 6420 7375   received and su
-000153b0: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
-000153c0: 7373 6564 2061 2072 6563 6f72 6465 6420  ssed a recorded 
-000153d0: 6576 656e 742e 2054 6869 7320 7769 6c6c  event. This will
-000153e0: 2070 7265 7665 6e74 2074 6861 740a 7265   prevent that.re
-000153f0: 636f 7264 6564 2065 7665 6e74 2062 6569  corded event bei
-00015400: 6e67 2072 6563 6569 7665 6420 6279 2061  ng received by a
-00015410: 6e6f 7468 6572 2063 6f6e 7375 6d65 7220  nother consumer 
-00015420: 696e 2074 6865 2073 616d 6520 6772 6f75  in the same grou
-00015430: 702e 2054 6865 2060 6163 6b28 2960 0a6d  p. The `ack()`.m
-00015440: 6574 686f 6420 7461 6b65 7320 616e 2060  ethod takes an `
-00015450: 6576 656e 745f 6964 6020 6172 6775 6d65  event_id` argume
-00015460: 6e74 2c20 7768 6963 6820 6973 2074 6865  nt, which is the
-00015470: 2049 4420 6f66 2074 6865 2072 6563 6f72   ID of the recor
-00015480: 6465 6420 6576 656e 7420 7468 6174 0a68  ded event that.h
-00015490: 6173 2062 6565 6e20 7265 6365 6976 6564  as been received
-000154a0: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
-000154b0: 656c 6f77 2069 7465 7261 7465 7320 6f76  elow iterates ov
-000154c0: 6572 2074 6865 2073 7562 7363 7269 7074  er the subscript
-000154d0: 696f 6e20 6f62 6a65 6374 2c20 616e 6420  ion object, and 
-000154e0: 6361 6c6c 7320 6061 636b 2829 602e 2054  calls `ack()`. T
-000154f0: 6865 0a60 7374 6f70 2829 6020 6d65 7468  he.`stop()` meth
-00015500: 6f64 2069 7320 6361 6c6c 6564 2077 6865  od is called whe
-00015510: 6e20 7765 2068 6176 6520 7265 6365 6976  n we have receiv
-00015520: 6564 2074 6865 206c 6173 7420 6576 656e  ed the last even
-00015530: 742c 2073 6f20 7468 6174 2077 6520 6361  t, so that we ca
-00015540: 6e0a 636f 6e74 696e 7565 2077 6974 6820  n.continue with 
-00015550: 7468 6520 6578 616d 706c 6573 2062 656c  the examples bel
-00015560: 6f77 2e0a 0a60 6060 7079 7468 6f6e 0a72  ow...```python.r
-00015570: 6563 6569 7665 645f 6576 656e 7473 203d  eceived_events =
-00015580: 205b 5d0a 0a66 6f72 2065 7665 6e74 2069   []..for event i
-00015590: 6e20 7375 6273 6372 6970 7469 6f6e 3a0a  n subscription:.
-000155a0: 2020 2020 7265 6365 6976 6564 5f65 7665      received_eve
-000155b0: 6e74 732e 6170 7065 6e64 2865 7665 6e74  nts.append(event
-000155c0: 290a 0a20 2020 2023 2041 636b 6e6f 776c  )..    # Acknowl
-000155d0: 6564 6765 2074 6865 2072 6563 6569 7665  edge the receive
-000155e0: 6420 6576 656e 742e 0a20 2020 2073 7562  d event..    sub
-000155f0: 7363 7269 7074 696f 6e2e 6163 6b28 6576  scription.ack(ev
-00015600: 656e 745f 6964 3d65 7665 6e74 2e69 6429  ent_id=event.id)
-00015610: 0a0a 2020 2020 2320 5374 6f70 2077 6865  ..    # Stop whe
-00015620: 6e20 2765 7665 6e74 3927 2068 6173 2062  n 'event9' has b
-00015630: 6565 6e20 7265 6365 6976 6564 2e0a 2020  een received..  
-00015640: 2020 6966 2065 7665 6e74 2e69 6420 3d3d    if event.id ==
-00015650: 2065 7665 6e74 392e 6964 3a0a 2020 2020   event9.id:.    
-00015660: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
-00015670: 2e73 746f 7028 290a 6060 600a 0a54 6865  .stop().```..The
-00015680: 2065 7665 6e74 7320 6172 6520 6e6f 7420   events are not 
-00015690: 6775 6172 616e 7465 6564 2074 6f20 6265  guaranteed to be
-000156a0: 2072 6563 6569 7665 6420 696e 2074 6865   received in the
-000156b0: 206f 7264 6572 2074 6865 7920 7765 7265   order they were
-000156c0: 2072 6563 6f72 6465 642e 2042 7574 0a77   recorded. But.w
-000156d0: 6520 7769 6c6c 2068 6176 6520 7265 6365  e will have rece
-000156e0: 6976 6564 2060 6576 656e 7439 602e 0a0a  ived `event9`...
-000156f0: 6060 6070 7974 686f 6e0a 6173 7365 7274  ```python.assert
-00015700: 2065 7665 6e74 392e 6964 2069 6e20 5b65   event9.id in [e
-00015710: 2e69 6420 666f 7220 6520 696e 2072 6563  .id for e in rec
-00015720: 6569 7665 645f 6576 656e 7473 5d0a 6060  eived_events].``
-00015730: 600a 0a54 6865 2060 5065 7273 6973 7465  `..The `Persiste
-00015740: 6e74 5375 6273 6372 6970 7469 6f6e 6020  ntSubscription` 
-00015750: 6f62 6a65 6374 2061 6c73 6f20 6861 7320  object also has 
-00015760: 616e 2060 6e61 636b 2829 6020 6d65 7468  an `nack()` meth
-00015770: 6f64 2074 6861 7420 7368 6f75 6c64 2062  od that should b
-00015780: 6520 7573 6564 0a62 7920 6120 636f 6e73  e used.by a cons
-00015790: 756d 6572 2074 6f20 6e65 6761 7469 7665  umer to negative
-000157a0: 6c79 2061 636b 6e6f 776c 6564 6765 2074  ly acknowledge t
-000157b0: 6f20 7468 6520 7365 7276 6572 2074 6861  o the server tha
-000157c0: 7420 6974 2068 6173 2072 6563 6569 7665  t it has receive
-000157d0: 6420 6275 7420 6e6f 740a 7375 6363 6573  d but not.succes
-000157e0: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
-000157f0: 2061 2072 6563 6f72 6465 6420 6576 656e   a recorded even
-00015800: 742e 2054 6865 2060 6e61 636b 2829 6020  t. The `nack()` 
-00015810: 6d65 7468 6f64 2068 6173 2061 6e20 6065  method has an `e
-00015820: 7665 6e74 5f69 6460 0a61 7267 756d 656e  vent_id`.argumen
-00015830: 742c 2077 6869 6368 2069 7320 7468 6520  t, which is the 
-00015840: 4944 206f 6620 7468 6520 7265 636f 7264  ID of the record
-00015850: 6564 2065 7665 6e74 2074 6861 7420 6861  ed event that ha
-00015860: 7320 6265 656e 2072 6563 6569 7665 642e  s been received.
-00015870: 2054 6865 2060 6e61 636b 2829 600a 6d65   The `nack()`.me
-00015880: 7468 6f64 2061 6c73 6f20 6861 7320 616e  thod also has an
-00015890: 2060 6163 7469 6f6e 6020 6172 6775 6d65   `action` argume
-000158a0: 6e74 2c20 7768 6963 6820 7368 6f75 6c64  nt, which should
-000158b0: 2062 6520 6120 5079 7468 6f6e 2060 7374   be a Python `st
-000158c0: 7260 3a20 6569 7468 6572 0a60 2775 6e6b  r`: either.`'unk
-000158d0: 6e6f 776e 2760 2c20 6027 7061 726b 2760  nown'`, `'park'`
-000158e0: 2c20 6027 7265 7472 7927 602c 2060 2773  , `'retry'`, `'s
-000158f0: 6b69 7027 6020 6f72 2060 2773 746f 7027  kip'` or `'stop'
-00015900: 602e 0a0a 0a23 2323 2048 6f77 2074 6f20  `....### How to 
-00015910: 7772 6974 6520 6120 7065 7273 6973 7465  write a persiste
-00015920: 6e74 2073 7562 7363 7269 7074 696f 6e20  nt subscription 
-00015930: 636f 6e73 756d 6572 0a0a 5468 6520 7265  consumer..The re
-00015940: 6164 696e 6720 6f66 2061 2070 6572 7369  ading of a persi
-00015950: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-00015960: 6f6e 2063 616e 2062 6520 656e 6361 7073  on can be encaps
-00015970: 756c 6174 6564 2069 6e20 6120 2263 6f6e  ulated in a "con
-00015980: 7375 6d65 7222 2074 6861 7420 6361 6c6c  sumer" that call
-00015990: 730a 6120 2270 6f6c 6963 7922 2066 756e  s.a "policy" fun
-000159a0: 6374 696f 6e20 7768 656e 2061 2072 6563  ction when a rec
-000159b0: 6f72 6465 6420 6576 656e 7420 6973 2072  orded event is r
-000159c0: 6563 6569 7665 6420 616e 6420 7468 656e  eceived and then
-000159d0: 2061 7574 6f6d 6174 6963 616c 6c79 2063   automatically c
-000159e0: 616c 6c73 0a60 6163 6b28 2960 2069 6620  alls.`ack()` if 
-000159f0: 7468 6520 706f 6c69 6379 2066 756e 6374  the policy funct
-00015a00: 696f 6e20 7265 7475 726e 7320 6e6f 726d  ion returns norm
-00015a10: 616c 6c79 2c20 616e 6420 606e 6163 6b28  ally, and `nack(
-00015a20: 2960 2069 6620 6974 2072 6169 7365 7320  )` if it raises 
-00015a30: 616e 2065 7863 6570 7469 6f6e 2c0a 7065  an exception,.pe
-00015a40: 7268 6170 7320 7265 7472 7969 6e67 2074  rhaps retrying t
-00015a50: 6865 2065 7665 6e74 2066 6f72 2061 2063  he event for a c
-00015a60: 6572 7461 696e 206e 756d 6265 7220 6f66  ertain number of
-00015a70: 2074 696d 6573 2062 6566 6f72 6520 7061   times before pa
-00015a80: 726b 696e 6720 7468 6520 6576 656e 742e  rking the event.
-00015a90: 0a0a 5468 6520 7369 6d70 6c65 2065 7861  ..The simple exa
-00015aa0: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-00015ab0: 2068 6f77 2074 6869 7320 6d69 6768 7420   how this might 
-00015ac0: 6265 2064 6f6e 652e 2057 6520 6361 6e20  be done. We can 
-00015ad0: 7365 6520 7468 6174 2027 6576 656e 7439  see that 'event9
-00015ae0: 2720 6973 0a61 636b 6e6f 776c 6564 6765  ' is.acknowledge
-00015af0: 6420 6265 666f 7265 2027 6576 656e 7435  d before 'event5
-00015b00: 2720 6973 2066 696e 616c 6c79 2070 6172  ' is finally par
-00015b10: 6b65 642e 0a0a 0a60 6060 7079 7468 6f6e  ked....```python
-00015b20: 0a61 636b 6564 5f65 7665 6e74 7320 3d20  .acked_events = 
-00015b30: 7b7d 0a6e 6163 6b65 645f 6576 656e 7473  {}.nacked_events
-00015b40: 203d 207b 7d0a 0a0a 636c 6173 7320 4578   = {}...class Ex
-00015b50: 616d 706c 6543 6f6e 7375 6d65 723a 0a20  ampleConsumer:. 
-00015b60: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00015b70: 7365 6c66 2c20 7375 6273 6372 6970 7469  self, subscripti
-00015b80: 6f6e 2c20 6d61 785f 7265 7472 6965 732c  on, max_retries,
-00015b90: 2066 696e 616c 5f61 6374 696f 6e29 3a0a   final_action):.
-00015ba0: 2020 2020 2020 2020 7365 6c66 2e73 7562          self.sub
-00015bb0: 7363 7269 7074 696f 6e20 3d20 7375 6273  scription = subs
-00015bc0: 6372 6970 7469 6f6e 0a20 2020 2020 2020  cription.       
-00015bd0: 2073 656c 662e 6d61 785f 7265 7472 6965   self.max_retrie
-00015be0: 7320 3d20 6d61 785f 7265 7472 6965 730a  s = max_retries.
-00015bf0: 2020 2020 2020 2020 7365 6c66 2e66 696e          self.fin
-00015c00: 616c 5f61 6374 696f 6e20 3d20 6669 6e61  al_action = fina
-00015c10: 6c5f 6163 7469 6f6e 0a20 2020 2020 2020  l_action.       
-00015c20: 2073 656c 662e 6572 726f 7220 3d20 4e6f   self.error = No
-00015c30: 6e65 0a0a 2020 2020 6465 6620 7275 6e28  ne..    def run(
-00015c40: 7365 6c66 293a 0a20 2020 2020 2020 2074  self):.        t
-00015c50: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00015c60: 666f 7220 6576 656e 7420 696e 2073 656c  for event in sel
-00015c70: 662e 7375 6273 6372 6970 7469 6f6e 3a0a  f.subscription:.
-00015c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c90: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00015ca0: 2020 2020 2020 2020 2073 656c 662e 706f           self.po
-00015cb0: 6c69 6379 2865 7665 6e74 290a 2020 2020  licy(event).    
-00015cc0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00015cd0: 7074 2045 7863 6570 7469 6f6e 3a0a 2020  pt Exception:.  
-00015ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015cf0: 2020 6966 2065 7665 6e74 2e72 6574 7279    if event.retry
-00015d00: 5f63 6f75 6e74 203c 2073 656c 662e 6d61  _count < self.ma
-00015d10: 785f 7265 7472 6965 733a 0a20 2020 2020  x_retries:.     
-00015d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d30: 2020 2061 6374 696f 6e20 3d20 2272 6574     action = "ret
-00015d40: 7279 220a 2020 2020 2020 2020 2020 2020  ry".            
-00015d50: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00015d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d70: 2020 2020 2020 6163 7469 6f6e 203d 2073        action = s
-00015d80: 656c 662e 6669 6e61 6c5f 6163 7469 6f6e  elf.final_action
-00015d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015da0: 2020 2020 2073 656c 662e 7375 6273 6372       self.subscr
-00015db0: 6970 7469 6f6e 2e6e 6163 6b28 6576 656e  iption.nack(even
-00015dc0: 742e 6964 2c20 6163 7469 6f6e 3d61 6374  t.id, action=act
-00015dd0: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
-00015de0: 2020 2020 2020 2020 2073 656c 662e 6166           self.af
-00015df0: 7465 725f 6e61 636b 2865 7665 6e74 2c20  ter_nack(event, 
-00015e00: 6163 7469 6f6e 290a 2020 2020 2020 2020  action).        
-00015e10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00015e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e30: 2020 7365 6c66 2e73 7562 7363 7269 7074    self.subscript
-00015e40: 696f 6e2e 6163 6b28 6576 656e 742e 6964  ion.ack(event.id
-00015e50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00015e60: 2020 2020 2020 7365 6c66 2e61 6674 6572        self.after
-00015e70: 5f61 636b 2865 7665 6e74 290a 2020 2020  _ack(event).    
-00015e80: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-00015e90: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-00015ea0: 2020 7365 6c66 2e73 746f 7028 290a 2020    self.stop().  
-00015eb0: 2020 2020 2020 2020 2020 7261 6973 650a            raise.
-00015ec0: 0a20 2020 2064 6566 2073 746f 7028 7365  .    def stop(se
-00015ed0: 6c66 293a 0a20 2020 2020 2020 2073 656c  lf):.        sel
-00015ee0: 662e 7375 6273 6372 6970 7469 6f6e 2e73  f.subscription.s
-00015ef0: 746f 7028 290a 0a20 2020 2064 6566 2070  top()..    def p
-00015f00: 6f6c 6963 7928 7365 6c66 2c20 6576 656e  olicy(self, even
-00015f10: 7429 3a0a 2020 2020 2020 2020 2320 5261  t):.        # Ra
-00015f20: 6973 6520 616e 2065 7863 6570 7469 6f6e  ise an exception
-00015f30: 2077 6865 6e20 7765 2073 6565 2022 6576   when we see "ev
-00015f40: 656e 7435 222e 0a20 2020 2020 2020 2069  ent5"..        i
-00015f50: 6620 6576 656e 742e 6964 203d 3d20 6576  f event.id == ev
-00015f60: 656e 7435 2e69 643a 0a20 2020 2020 2020  ent5.id:.       
-00015f70: 2020 2020 2072 6169 7365 2045 7863 6570       raise Excep
-00015f80: 7469 6f6e 2829 0a0a 2020 2020 6465 6620  tion()..    def 
-00015f90: 6166 7465 725f 6163 6b28 7365 6c66 2c20  after_ack(self, 
-00015fa0: 6576 656e 7429 3a0a 2020 2020 2020 2020  event):.        
-00015fb0: 2320 5472 6163 6b20 7265 7472 7920 636f  # Track retry co
-00015fc0: 756e 7420 6f66 2061 636b 6564 2065 7665  unt of acked eve
-00015fd0: 6e74 732e 0a20 2020 2020 2020 2061 636b  nts..        ack
-00015fe0: 6564 5f65 7665 6e74 735b 6576 656e 742e  ed_events[event.
-00015ff0: 6964 5d20 3d20 6576 656e 742e 7265 7472  id] = event.retr
-00016000: 795f 636f 756e 740a 0a20 2020 2064 6566  y_count..    def
-00016010: 2061 6674 6572 5f6e 6163 6b28 7365 6c66   after_nack(self
-00016020: 2c20 6576 656e 742c 2061 6374 696f 6e29  , event, action)
-00016030: 3a0a 2020 2020 2020 2020 2320 5472 6163  :.        # Trac
-00016040: 6b20 7265 7472 7920 636f 756e 7420 6f66  k retry count of
-00016050: 206e 6163 6b65 6420 6576 656e 7473 2e0a   nacked events..
-00016060: 2020 2020 2020 2020 6e61 636b 6564 5f65          nacked_e
-00016070: 7665 6e74 735b 6576 656e 742e 6964 5d20  vents[event.id] 
-00016080: 3d20 6576 656e 742e 7265 7472 795f 636f  = event.retry_co
-00016090: 756e 740a 0a20 2020 2020 2020 2069 6620  unt..        if 
-000160a0: 6163 7469 6f6e 203d 3d20 7365 6c66 2e66  action == self.f
-000160b0: 696e 616c 5f61 6374 696f 6e3a 0a20 2020  inal_action:.   
-000160c0: 2020 2020 2020 2020 2023 2053 746f 7020           # Stop 
-000160d0: 7468 6520 636f 6e73 756d 6572 2c20 736f  the consumer, so
-000160e0: 2077 6520 6361 6e20 636f 6e74 696e 7565   we can continue
-000160f0: 2077 6974 6820 7468 6520 6578 616d 706c   with the exampl
-00016100: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
-00016110: 7365 6c66 2e73 746f 7028 290a 0a0a 2320  self.stop()...# 
-00016120: 4372 6561 7465 2073 7562 7363 7269 7074  Create subscript
-00016130: 696f 6e2e 0a67 726f 7570 5f6e 616d 6520  ion..group_name 
-00016140: 3d20 6622 6772 6f75 702d 7b75 7569 642e  = f"group-{uuid.
-00016150: 7575 6964 3428 297d 220a 636c 6965 6e74  uuid4()}".client
-00016160: 2e63 7265 6174 655f 7375 6273 6372 6970  .create_subscrip
-00016170: 7469 6f6e 5f74 6f5f 616c 6c28 6772 6f75  tion_to_all(grou
-00016180: 705f 6e61 6d65 2c20 636f 6d6d 6974 5f70  p_name, commit_p
-00016190: 6f73 6974 696f 6e3d 636f 6d6d 6974 5f70  osition=commit_p
-000161a0: 6f73 6974 696f 6e31 290a 0a23 2052 6561  osition1)..# Rea
-000161b0: 6420 7375 6273 6372 6970 7469 6f6e 2e0a  d subscription..
-000161c0: 7375 6273 6372 6970 7469 6f6e 203d 2063  subscription = c
-000161d0: 6c69 656e 742e 7265 6164 5f73 7562 7363  lient.read_subsc
-000161e0: 7269 7074 696f 6e5f 746f 5f61 6c6c 2867  ription_to_all(g
-000161f0: 726f 7570 5f6e 616d 6529 0a0a 2320 436f  roup_name)..# Co
-00016200: 6e73 7472 7563 7420 636f 6e73 756d 6572  nstruct consumer
-00016210: 2e0a 636f 6e73 756d 6572 203d 2045 7861  ..consumer = Exa
-00016220: 6d70 6c65 436f 6e73 756d 6572 280a 2020  mpleConsumer(.  
-00016230: 2020 7375 6273 6372 6970 7469 6f6e 3d73    subscription=s
-00016240: 7562 7363 7269 7074 696f 6e2c 0a20 2020  ubscription,.   
-00016250: 206d 6178 5f72 6574 7269 6573 3d35 2c0a   max_retries=5,.
-00016260: 2020 2020 6669 6e61 6c5f 6163 7469 6f6e      final_action
-00016270: 3d22 7061 726b 222c 0a29 0a0a 2320 5275  ="park",.)..# Ru
-00016280: 6e20 636f 6e73 756d 6572 2e0a 636f 6e73  n consumer..cons
-00016290: 756d 6572 2e72 756e 2829 0a0a 2320 4368  umer.run()..# Ch
-000162a0: 6563 6b20 2765 7665 6e74 3527 2077 6173  eck 'event5' was
-000162b0: 206e 6163 6b65 6420 616e 6420 6e65 7665   nacked and neve
-000162c0: 7220 6163 6b65 642e 0a61 7373 6572 7420  r acked..assert 
-000162d0: 6576 656e 7435 2e69 6420 696e 206e 6163  event5.id in nac
-000162e0: 6b65 645f 6576 656e 7473 0a61 7373 6572  ked_events.asser
-000162f0: 7420 6576 656e 7435 2e69 6420 6e6f 7420  t event5.id not 
-00016300: 696e 2061 636b 6564 5f65 7665 6e74 730a  in acked_events.
-00016310: 6173 7365 7274 206e 6163 6b65 645f 6576  assert nacked_ev
-00016320: 656e 7473 5b65 7665 6e74 352e 6964 5d20  ents[event5.id] 
-00016330: 3d3d 2035 0a0a 2320 4368 6563 6b20 2765  == 5..# Check 'e
-00016340: 7665 6e74 3927 2077 6173 2061 636b 6564  vent9' was acked
-00016350: 2061 6e64 206e 6576 6572 206e 6163 6b65   and never nacke
-00016360: 642e 0a61 7373 6572 7420 6576 656e 7439  d..assert event9
-00016370: 2e69 6420 696e 2061 636b 6564 5f65 7665  .id in acked_eve
-00016380: 6e74 730a 6173 7365 7274 2065 7665 6e74  nts.assert event
-00016390: 392e 6964 206e 6f74 2069 6e20 6e61 636b  9.id not in nack
-000163a0: 6564 5f65 7665 6e74 730a 6060 600a 0a23  ed_events.```..#
-000163b0: 2323 2055 7064 6174 6520 7375 6273 6372  ## Update subscr
-000163c0: 6970 7469 6f6e 2074 6f20 616c 6c0a 0a2a  iption to all..*
-000163d0: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
-000163e0: 0a0a 5468 6520 6075 7064 6174 655f 7375  ..The `update_su
-000163f0: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
-00016400: 6c28 2960 206d 6574 686f 6420 6361 6e20  l()` method can 
-00016410: 6265 2075 7365 6420 746f 2075 7064 6174  be used to updat
-00016420: 6520 610a 2270 6572 7369 7374 656e 7420  e a."persistent 
-00016430: 7375 6273 6372 6970 7469 6f6e 222e 0a0a  subscription"...
-00016440: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
-00016450: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
-00016460: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
-00016470: 2c20 7768 6963 6820 6973 2074 6865 0a6e  , which is the.n
-00016480: 616d 6520 6f66 2061 2022 6772 6f75 7022  ame of a "group"
-00016490: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
-000164a0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-000164b0: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
-000164c0: 616c 736f 2068 6173 2074 6872 6565 206f  also has three o
-000164d0: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
-000164e0: 732c 2060 6672 6f6d 5f65 6e64 602c 2060  s, `from_end`, `
-000164f0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
-00016500: 2c20 6074 696d 656f 7574 600a 616e 6420  , `timeout`.and 
-00016510: 6063 7265 6465 6e74 6961 6c73 602e 0a0a  `credentials`...
-00016520: 5468 6520 6f70 7469 6f6e 616c 2060 6672  The optional `fr
-00016530: 6f6d 5f65 6e64 6020 6172 6775 6d65 6e74  om_end` argument
-00016540: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00016550: 7370 6563 6966 7920 7468 6174 2074 6865  specify that the
-00016560: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
-00016570: 6572 730a 6f66 2074 6865 2073 7562 7363  ers.of the subsc
-00016580: 7269 7074 696f 6e20 7368 6f75 6c64 206f  ription should o
-00016590: 6e6c 7920 7265 6365 6976 6520 6576 656e  nly receive even
-000165a0: 7473 2074 6861 7420 7765 7265 2072 6563  ts that were rec
-000165b0: 6f72 6465 6420 6166 7465 7220 7468 6520  orded after the 
-000165c0: 7375 6273 6372 6970 7469 6f6e 0a77 6173  subscription.was
-000165d0: 2075 7064 6174 6564 2e0a 0a41 6c74 6572   updated...Alter
-000165e0: 6e61 7469 7665 6c79 2c20 7468 6520 6f70  natively, the op
-000165f0: 7469 6f6e 616c 2060 636f 6d6d 6974 5f70  tional `commit_p
-00016600: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-00016610: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-00016620: 2073 7065 6369 6679 2061 2063 6f6d 6d69   specify a commi
-00016630: 740a 706f 7369 7469 6f6e 2066 726f 6d20  t.position from 
-00016640: 7768 6963 6820 636f 6d6d 6974 2070 6f73  which commit pos
-00016650: 6974 696f 6e20 7468 6520 6772 6f75 7020  ition the group 
-00016660: 6f66 2063 6f6e 7375 6d65 7273 206f 6620  of consumers of 
-00016670: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-00016680: 2073 686f 756c 640a 7265 6365 6976 6520   should.receive 
-00016690: 6576 656e 7473 2e20 506c 6561 7365 206e  events. Please n
-000166a0: 6f74 652c 2074 6865 2072 6563 6f72 6465  ote, the recorde
-000166b0: 6420 6576 656e 7420 6174 2074 6865 2073  d event at the s
-000166c0: 7065 6369 6669 6564 2063 6f6d 6d69 7420  pecified commit 
-000166d0: 706f 7369 7469 6f6e 206d 6967 6874 0a62  position might.b
-000166e0: 6520 696e 636c 7564 6564 2069 6e20 7468  e included in th
-000166f0: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-00016700: 7320 7265 6365 6976 6564 2062 7920 7468  s received by th
-00016710: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
-00016720: 6d65 7273 2e0a 0a49 6620 6e65 6974 6865  mers...If neithe
-00016730: 7220 6066 726f 6d5f 656e 6460 206f 7220  r `from_end` or 
-00016740: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-00016750: 6020 6172 6520 7370 6563 6966 6965 642c  ` are specified,
-00016760: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-00016770: 6e73 756d 6572 730a 6f66 2074 6865 2073  nsumers.of the s
-00016780: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
-00016790: 2070 6f74 656e 7469 616c 6c79 2072 6563   potentially rec
-000167a0: 6569 7665 2061 6c6c 2072 6563 6f72 6465  eive all recorde
-000167b0: 6420 6576 656e 7473 2069 6e20 7468 6520  d events in the 
-000167c0: 6461 7461 6261 7365 2e0a 0a50 6c65 6173  database...Pleas
-000167d0: 6520 6e6f 7465 2c20 7468 6520 6669 6c74  e note, the filt
-000167e0: 6572 206f 7074 696f 6e73 2061 6e64 2063  er options and c
-000167f0: 6f6e 7375 6d65 7220 7374 7261 7465 6779  onsumer strategy
-00016800: 2063 616e 6e6f 7420 6265 2061 646a 7573   cannot be adjus
-00016810: 7465 642e 0a0a 5468 6520 6f70 7469 6f6e  ted...The option
-00016820: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
-00016830: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-00016840: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
-00016850: 7365 7473 2061 0a64 6561 646c 696e 6520  sets a.deadline 
-00016860: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00016870: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00016880: 7065 7261 7469 6f6e 2e0a 0a54 6865 206f  peration...The o
-00016890: 7074 696f 6e61 6c20 6063 7265 6465 6e74  ptional `credent
-000168a0: 6961 6c73 6020 6172 6775 6d65 6e74 2063  ials` argument c
-000168b0: 616e 2062 6520 7573 6564 2074 6f0a 6f76  an be used to.ov
-000168c0: 6572 7269 6465 2063 616c 6c20 6372 6564  erride call cred
-000168d0: 656e 7469 616c 7320 6465 7269 7665 6420  entials derived 
-000168e0: 6672 6f6d 2074 6865 2063 6f6e 6e65 6374  from the connect
-000168f0: 696f 6e20 7374 7269 6e67 2055 5249 2e0a  ion string URI..
-00016900: 0a54 6865 206d 6574 686f 6420 6075 7064  .The method `upd
-00016910: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-00016920: 5f74 6f5f 616c 6c28 2960 2064 6f65 7320  _to_all()` does 
-00016930: 6e6f 7420 7265 7475 726e 2061 2076 616c  not return a val
-00016940: 7565 2e0a 0a49 6e20 7468 6520 6578 616d  ue...In the exam
-00016950: 706c 6520 6265 6c6f 772c 2061 2070 6572  ple below, a per
-00016960: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-00016970: 7469 6f6e 2069 7320 7570 6461 7465 6420  tion is updated 
-00016980: 746f 2072 756e 2066 726f 6d20 7468 6520  to run from the 
-00016990: 656e 6420 6f66 2074 6865 0a64 6174 6162  end of the.datab
-000169a0: 6173 652e 0a0a 6060 6070 7974 686f 6e0a  ase...```python.
-000169b0: 2320 4372 6561 7465 2061 2070 6572 7369  # Create a persi
-000169c0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
-000169d0: 6f6e 2e0a 636c 6965 6e74 2e75 7064 6174  on..client.updat
-000169e0: 655f 7375 6273 6372 6970 7469 6f6e 5f74  e_subscription_t
-000169f0: 6f5f 616c 6c28 6772 6f75 705f 6e61 6d65  o_all(group_name
-00016a00: 3d67 726f 7570 5f6e 616d 6531 2c20 6672  =group_name1, fr
-00016a10: 6f6d 5f65 6e64 3d54 7275 6529 0a60 6060  om_end=True).```
-00016a20: 0a0a 2323 2320 4372 6561 7465 2073 7562  ..### Create sub
-00016a30: 7363 7269 7074 696f 6e20 746f 2073 7472  scription to str
-00016a40: 6561 6d0a 0a2a 7265 7175 6972 6573 206c  eam..*requires l
-00016a50: 6561 6465 722a 0a0a 5468 6520 6063 7265  eader*..The `cre
-00016a60: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-00016a70: 5f74 6f5f 7374 7265 616d 2829 6020 6d65  _to_stream()` me
-00016a80: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00016a90: 2074 6f20 6372 6561 7465 2061 2070 6572   to create a per
-00016aa0: 7369 7374 656e 740a 7375 6273 6372 6970  sistent.subscrip
-00016ab0: 7469 6f6e 2074 6f20 6120 7374 7265 616d  tion to a stream
-00016ac0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
-00016ad0: 6173 2074 776f 2072 6571 7569 7265 6420  as two required 
-00016ae0: 6172 6775 6d65 6e74 732c 2060 6772 6f75  arguments, `grou
-00016af0: 705f 6e61 6d65 6020 616e 6420 6073 7472  p_name` and `str
-00016b00: 6561 6d5f 6e61 6d65 602e 2054 6865 0a60  eam_name`. The.`
-00016b10: 6772 6f75 705f 6e61 6d65 6020 6172 6775  group_name` argu
-00016b20: 6d65 6e74 206e 616d 6573 2074 6865 2067  ment names the g
-00016b30: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
-00016b40: 7320 7468 6174 2077 696c 6c20 7265 6365  s that will rece
-00016b50: 6976 6520 6576 656e 7473 0a66 726f 6d20  ive events.from 
-00016b60: 7468 6973 2073 7562 7363 7269 7074 696f  this subscriptio
-00016b70: 6e2e 2054 6865 2060 7374 7265 616d 5f6e  n. The `stream_n
-00016b80: 616d 6560 2061 7267 756d 656e 7420 7370  ame` argument sp
-00016b90: 6563 6966 6965 7320 7768 6963 6820 7374  ecifies which st
-00016ba0: 7265 616d 0a74 6865 2073 7562 7363 7269  ream.the subscri
-00016bb0: 7074 696f 6e20 7769 6c6c 2066 6f6c 6c6f  ption will follo
-00016bc0: 772e 2054 6865 2076 616c 7565 7320 6f66  w. The values of
-00016bd0: 2062 6f74 6820 7468 6573 6520 6172 6775   both these argu
-00016be0: 6d65 6e74 7320 6172 6520 6578 7065 6374  ments are expect
-00016bf0: 6564 0a74 6f20 6265 2050 7974 686f 6e20  ed.to be Python 
-00016c00: 6073 7472 6020 6f62 6a65 6374 732e 0a0a  `str` objects...
-00016c10: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
-00016c20: 2068 6173 2066 6976 6520 6f70 7469 6f6e   has five option
-00016c30: 616c 2061 7267 756d 656e 7473 2c20 6073  al arguments, `s
-00016c40: 7472 6561 6d5f 706f 7369 7469 6f6e 602c  tream_position`,
-00016c50: 2060 6672 6f6d 5f65 6e64 602c 0a60 636f   `from_end`,.`co
-00016c60: 6e73 756d 6572 5f73 7472 6174 6567 7960  nsumer_strategy`
-00016c70: 2c20 6074 696d 656f 7574 6020 616e 6420  , `timeout` and 
-00016c80: 6063 7265 6465 6e74 6961 6c73 602e 0a0a  `credentials`...
-00016c90: 5468 6520 6f70 7469 6f6e 616c 2060 7374  The optional `st
-00016ca0: 7265 616d 5f70 6f73 6974 696f 6e60 2061  ream_position` a
-00016cb0: 7267 756d 656e 7420 7370 6563 6966 6965  rgument specifie
-00016cc0: 7320 6120 7374 7265 616d 2070 6f73 6974  s a stream posit
-00016cd0: 696f 6e20 6672 6f6d 0a77 6869 6368 2074  ion from.which t
-00016ce0: 6f20 7375 6273 6372 6962 652e 2054 6865  o subscribe. The
-00016cf0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
-00016d00: 6174 2074 6869 7320 7374 7265 616d 0a70  at this stream.p
-00016d10: 6f73 6974 696f 6e20 7769 6c6c 2062 6520  osition will be 
-00016d20: 7265 6365 6976 6564 2077 6865 6e20 7265  received when re
-00016d30: 6164 696e 6720 7468 6520 7375 6273 6372  ading the subscr
-00016d40: 6970 7469 6f6e 2e0a 0a54 6865 206f 7074  iption...The opt
-00016d50: 696f 6e61 6c20 6066 726f 6d5f 656e 6460  ional `from_end`
-00016d60: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
-00016d70: 7974 686f 6e20 6062 6f6f 6c60 2e0a 4279  ython `bool`..By
-00016d80: 2064 6566 6175 6c74 2c20 7468 6520 7661   default, the va
-00016d90: 6c75 6520 6f66 2074 6869 7320 6172 6775  lue of this argu
-00016da0: 6d65 6e74 2069 7320 6046 616c 7365 602e  ment is `False`.
-00016db0: 2049 6620 7468 6973 2061 7267 756d 656e   If this argumen
-00016dc0: 7420 6973 2073 6574 0a74 6f20 6054 7275  t is set.to `Tru
-00016dd0: 6560 2c20 7265 6164 696e 6720 6672 6f6d  e`, reading from
-00016de0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-00016df0: 6e20 7769 6c6c 2072 6563 6569 7665 206f  n will receive o
-00016e00: 6e6c 7920 6576 656e 7473 0a72 6563 6f72  nly events.recor
-00016e10: 6465 6420 6166 7465 7220 7468 6520 7375  ded after the su
-00016e20: 6273 6372 6970 7469 6f6e 2077 6173 2063  bscription was c
-00016e30: 7265 6174 6564 2e20 5468 6174 2069 732c  reated. That is,
-00016e40: 2069 7420 6973 206e 6f74 2069 6e63 6c75   it is not inclu
-00016e50: 7369 7665 0a6f 6620 7468 6520 6375 7272  sive.of the curr
-00016e60: 656e 7420 7374 7265 616d 2070 6f73 6974  ent stream posit
-00016e70: 696f 6e2e 0a0a 5468 6520 6f70 7469 6f6e  ion...The option
-00016e80: 616c 2060 636f 6e73 756d 6572 5f73 7472  al `consumer_str
-00016e90: 6174 6567 7960 2061 7267 756d 656e 7420  ategy` argument 
-00016ea0: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
-00016eb0: 6020 7468 6174 2064 6566 696e 6573 0a74  ` that defines.t
-00016ec0: 6865 2063 6f6e 7375 6d65 7220 7374 7261  he consumer stra
-00016ed0: 7465 6779 2066 6f72 2074 6869 7320 7065  tegy for this pe
-00016ee0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-00016ef0: 7074 696f 6e2e 2054 6865 2076 616c 7565  ption. The value
-00016f00: 206f 6620 7468 6973 2061 7267 756d 656e   of this argumen
-00016f10: 740a 6361 6e20 6265 2060 2744 6973 7061  t.can be `'Dispa
-00016f20: 7463 6854 6f53 696e 676c 6527 602c 2060  tchToSingle'`, `
-00016f30: 2752 6f75 6e64 526f 6269 6e27 602c 2060  'RoundRobin'`, `
-00016f40: 2750 696e 6e65 6427 602c 206f 7220 6027  'Pinned'`, or `'
-00016f50: 5069 6e6e 6564 4279 436f 7272 656c 6174  PinnedByCorrelat
-00016f60: 696f 6e27 602e 2054 6865 0a64 6566 6175  ion'`. The.defau
-00016f70: 6c74 2076 616c 7565 2069 7320 6027 4469  lt value is `'Di
-00016f80: 7370 6174 6368 546f 5369 6e67 6c65 2760  spatchToSingle'`
-00016f90: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
-00016fa0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-00016fb0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
-00016fc0: 666c 6f61 7460 2077 6869 6368 2073 6574  float` which set
-00016fd0: 7320 6120 6465 6164 6c69 6e65 0a66 6f72  s a deadline.for
-00016fe0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
-00016ff0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
-00017000: 6174 696f 6e2e 0a0a 5468 6520 6f70 7469  ation...The opti
-00017010: 6f6e 616c 2060 6372 6564 656e 7469 616c  onal `credential
-00017020: 7360 2061 7267 756d 656e 7420 6361 6e20  s` argument can 
-00017030: 6265 2075 7365 6420 746f 0a6f 7665 7272  be used to.overr
-00017040: 6964 6520 6361 6c6c 2063 7265 6465 6e74  ide call credent
-00017050: 6961 6c73 2064 6572 6976 6564 2066 726f  ials derived fro
-00017060: 6d20 7468 6520 636f 6e6e 6563 7469 6f6e  m the connection
-00017070: 2073 7472 696e 6720 5552 492e 0a0a 5468   string URI...Th
-00017080: 6973 206d 6574 686f 6420 646f 6573 206e  is method does n
-00017090: 6f74 2072 6574 7572 6e20 6120 7661 6c75  ot return a valu
-000170a0: 652e 2045 7665 6e74 7320 6361 6e20 6265  e. Events can be
-000170b0: 2072 6563 6569 7665 6420 6279 2063 616c   received by cal
-000170c0: 6c69 6e67 0a60 7265 6164 5f73 7562 7363  ling.`read_subsc
-000170d0: 7269 7074 696f 6e5f 746f 5f73 7472 6561  ription_to_strea
-000170e0: 6d28 2960 2e0a 0a54 6865 2065 7861 6d70  m()`...The examp
-000170f0: 6c65 2062 656c 6f77 2063 7265 6174 6573  le below creates
-00017100: 2061 2070 6572 7369 7374 656e 7420 7374   a persistent st
-00017110: 7265 616d 2073 7562 7363 7269 7074 696f  ream subscriptio
-00017120: 6e20 6672 6f6d 2074 6865 2073 7461 7274  n from the start
-00017130: 206f 6620 7468 6520 7374 7265 616d 2e0a   of the stream..
-00017140: 0a60 6060 7079 7468 6f6e 0a23 2043 7265  .```python.# Cre
-00017150: 6174 6520 6120 7065 7273 6973 7465 6e74  ate a persistent
-00017160: 2073 7472 6561 6d20 7375 6273 6372 6970   stream subscrip
-00017170: 7469 6f6e 2066 726f 6d20 7374 6172 7420  tion from start 
-00017180: 6f66 2074 6865 2073 7472 6561 6d2e 0a67  of the stream..g
-00017190: 726f 7570 5f6e 616d 6532 203d 2066 2267  roup_name2 = f"g
-000171a0: 726f 7570 2d7b 7575 6964 2e75 7569 6434  roup-{uuid.uuid4
-000171b0: 2829 7d22 0a63 6c69 656e 742e 6372 6561  ()}".client.crea
-000171c0: 7465 5f73 7562 7363 7269 7074 696f 6e5f  te_subscription_
-000171d0: 746f 5f73 7472 6561 6d28 0a20 2020 2067  to_stream(.    g
-000171e0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-000171f0: 6e61 6d65 322c 0a20 2020 2073 7472 6561  name2,.    strea
-00017200: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-00017210: 6d65 322c 0a29 0a60 6060 0a0a 2323 2320  me2,.).```..### 
-00017220: 5265 6164 2073 7562 7363 7269 7074 696f  Read subscriptio
-00017230: 6e20 746f 2073 7472 6561 6d0a 0a2a 7265  n to stream..*re
-00017240: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
-00017250: 5468 6520 6072 6561 645f 7375 6273 6372  The `read_subscr
-00017260: 6970 7469 6f6e 5f74 6f5f 7374 7265 616d  iption_to_stream
-00017270: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00017280: 6520 7573 6564 2074 6f20 7265 6164 2061  e used to read a
-00017290: 2070 6572 7369 7374 656e 740a 7375 6273   persistent.subs
-000172a0: 6372 6970 7469 6f6e 2074 6f20 6120 7374  cription to a st
-000172b0: 7265 616d 2e0a 0a54 6869 7320 6d65 7468  ream...This meth
-000172c0: 6f64 2068 6173 2074 776f 2072 6571 7569  od has two requi
-000172d0: 7265 6420 6172 6775 6d65 6e74 732c 2060  red arguments, `
-000172e0: 6772 6f75 705f 6e61 6d65 6020 616e 6420  group_name` and 
-000172f0: 6073 7472 6561 6d5f 6e61 6d65 602c 2077  `stream_name`, w
-00017300: 6869 6368 0a73 686f 756c 6420 6d61 7463  hich.should matc
-00017310: 6820 7468 6520 7661 6c75 6573 206f 6620  h the values of 
-00017320: 6172 6775 6d65 6e74 7320 7573 6564 2077  arguments used w
-00017330: 6865 6e20 6361 6c6c 696e 6720 6063 7265  hen calling `cre
-00017340: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-00017350: 5f74 6f5f 7374 7265 616d 2829 602e 0a0a  _to_stream()`...
-00017360: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
-00017370: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
-00017380: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
-00017390: 7468 6174 0a69 7320 6578 7065 6374 6564  that.is expected
-000173a0: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
-000173b0: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
-000173c0: 6574 7320 6120 6465 6164 6c69 6e65 0a66  ets a deadline.f
-000173d0: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-000173e0: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-000173f0: 6572 6174 696f 6e2e 0a0a 5468 6973 206d  eration...This m
-00017400: 6574 686f 6420 616c 736f 2068 6173 2061  ethod also has a
-00017410: 6e20 6f70 7469 6f6e 616c 2060 6372 6564  n optional `cred
-00017420: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
-00017430: 742c 2077 6869 6368 2063 616e 2062 6520  t, which can be 
-00017440: 7573 6564 2074 6f0a 6f76 6572 7269 6465  used to.override
-00017450: 2063 616c 6c20 6372 6564 656e 7469 616c   call credential
-00017460: 7320 6465 7269 7665 6420 6672 6f6d 2074  s derived from t
-00017470: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-00017480: 7269 6e67 2055 5249 2e0a 0a54 6869 7320  ring URI...This 
-00017490: 6d65 7468 6f64 2072 6574 7572 6e73 2061  method returns a
-000174a0: 2060 5065 7273 6973 7465 6e74 5375 6273   `PersistentSubs
-000174b0: 6372 6970 7469 6f6e 6020 6f62 6a65 6374  cription` object
-000174c0: 2c20 7768 6963 6820 6973 2061 6e20 6974  , which is an it
-000174d0: 6572 6174 6f72 0a67 6976 696e 6720 6052  erator.giving `R
-000174e0: 6563 6f72 6465 6445 7665 6e74 6020 6f62  ecordedEvent` ob
-000174f0: 6a65 6374 732c 2074 6861 7420 616c 736f  jects, that also
-00017500: 2068 6173 2060 6163 6b28 2960 2c20 606e   has `ack()`, `n
-00017510: 6163 6b28 2960 2061 6e64 2060 7374 6f70  ack()` and `stop
-00017520: 2829 600a 6d65 7468 6f64 732e 0a0a 6060  ()`.methods...``
-00017530: 6070 7974 686f 6e0a 7375 6273 6372 6970  `python.subscrip
-00017540: 7469 6f6e 203d 2063 6c69 656e 742e 7265  tion = client.re
-00017550: 6164 5f73 7562 7363 7269 7074 696f 6e5f  ad_subscription_
-00017560: 746f 5f73 7472 6561 6d28 0a20 2020 2067  to_stream(.    g
-00017570: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-00017580: 6e61 6d65 322c 0a20 2020 2073 7472 6561  name2,.    strea
-00017590: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
-000175a0: 6d65 322c 0a29 0a60 6060 0a0a 5468 6520  me2,.).```..The 
-000175b0: 6578 616d 706c 6520 6265 6c6f 7720 6974  example below it
-000175c0: 6572 6174 6573 206f 7665 7220 7468 6520  erates over the 
-000175d0: 7375 6273 6372 6970 7469 6f6e 206f 626a  subscription obj
-000175e0: 6563 742c 2061 6e64 2063 616c 6c73 2060  ect, and calls `
-000175f0: 6163 6b28 2960 2e0a 5468 6520 666f 7220  ack()`..The for 
-00017600: 6c6f 6f70 2062 7265 616b 7320 7768 656e  loop breaks when
-00017610: 2077 6520 6861 7665 2072 6563 6569 7665   we have receive
-00017620: 6420 7468 6520 6c61 7374 2065 7665 6e74  d the last event
-00017630: 2069 6e20 7468 6520 7374 7265 616d 2c20   in the stream, 
-00017640: 736f 0a74 6861 7420 7765 2063 616e 2066  so.that we can f
-00017650: 696e 6973 6820 7468 6520 6578 616d 706c  inish the exampl
-00017660: 6573 2069 6e20 7468 6973 2064 6f63 756d  es in this docum
-00017670: 656e 7461 7469 6f6e 2e0a 0a60 6060 7079  entation...```py
-00017680: 7468 6f6e 0a65 7665 6e74 7320 3d20 5b5d  thon.events = []
-00017690: 0a66 6f72 2065 7665 6e74 2069 6e20 7375  .for event in su
-000176a0: 6273 6372 6970 7469 6f6e 3a0a 2020 2020  bscription:.    
-000176b0: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
-000176c0: 656e 7429 0a0a 2020 2020 2320 4163 6b6e  ent)..    # Ackn
-000176d0: 6f77 6c65 6467 6520 7468 6520 7265 6365  owledge the rece
-000176e0: 6976 6564 2065 7665 6e74 2e0a 2020 2020  ived event..    
-000176f0: 7375 6273 6372 6970 7469 6f6e 2e61 636b  subscription.ack
-00017700: 2865 7665 6e74 5f69 643d 6576 656e 742e  (event_id=event.
-00017710: 6964 290a 0a20 2020 2023 2053 746f 7020  id)..    # Stop 
-00017720: 7768 656e 2027 6576 656e 7436 2720 6861  when 'event6' ha
-00017730: 7320 6265 656e 2072 6563 6569 7665 642e  s been received.
-00017740: 0a20 2020 2069 6620 6576 656e 742e 6964  .    if event.id
-00017750: 203d 3d20 6576 656e 7436 2e69 643a 0a20   == event6.id:. 
-00017760: 2020 2020 2020 2073 7562 7363 7269 7074         subscript
-00017770: 696f 6e2e 7374 6f70 2829 0a60 6060 0a0a  ion.stop().```..
-00017780: 5765 2063 616e 2063 6865 636b 2077 6520  We can check we 
-00017790: 7265 6365 6976 6564 2061 6c6c 2074 6865  received all the
-000177a0: 2065 7665 6e74 7320 7468 6174 2077 6572   events that wer
-000177b0: 6520 6170 7065 6e64 6564 2074 6f20 6073  e appended to `s
-000177c0: 7472 6561 6d5f 6e61 6d65 3260 0a69 6e20  tream_name2`.in 
-000177d0: 7468 6520 6578 616d 706c 6573 2061 626f  the examples abo
-000177e0: 7665 2e0a 0a60 6060 7079 7468 6f6e 0a61  ve...```python.a
-000177f0: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
-00017800: 2920 3d3d 2033 0a61 7373 6572 7420 6576  ) == 3.assert ev
-00017810: 656e 7473 5b30 5d2e 7374 7265 616d 5f6e  ents[0].stream_n
-00017820: 616d 6520 3d3d 2073 7472 6561 6d5f 6e61  ame == stream_na
-00017830: 6d65 320a 6173 7365 7274 2065 7665 6e74  me2.assert event
-00017840: 735b 305d 2e69 6420 3d3d 2065 7665 6e74  s[0].id == event
-00017850: 342e 6964 0a61 7373 6572 7420 6576 656e  4.id.assert even
-00017860: 7473 5b31 5d2e 7374 7265 616d 5f6e 616d  ts[1].stream_nam
-00017870: 6520 3d3d 2073 7472 6561 6d5f 6e61 6d65  e == stream_name
-00017880: 320a 6173 7365 7274 2065 7665 6e74 735b  2.assert events[
-00017890: 315d 2e69 6420 3d3d 2065 7665 6e74 352e  1].id == event5.
-000178a0: 6964 0a61 7373 6572 7420 6576 656e 7473  id.assert events
-000178b0: 5b32 5d2e 7374 7265 616d 5f6e 616d 6520  [2].stream_name 
-000178c0: 3d3d 2073 7472 6561 6d5f 6e61 6d65 320a  == stream_name2.
-000178d0: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-000178e0: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
-000178f0: 0a60 6060 0a0a 2323 2320 5570 6461 7465  .```..### Update
-00017900: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
-00017910: 2073 7472 6561 6d0a 0a2a 7265 7175 6972   stream..*requir
-00017920: 6573 206c 6561 6465 722a 0a0a 5468 6520  es leader*..The 
-00017930: 6075 7064 6174 655f 7375 6273 6372 6970  `update_subscrip
-00017940: 7469 6f6e 5f74 6f5f 7374 7265 616d 2829  tion_to_stream()
-00017950: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
-00017960: 7573 6564 2074 6f20 7570 6461 7465 2061  used to update a
-00017970: 0a70 6572 7369 7374 656e 7420 7375 6273  .persistent subs
-00017980: 6372 6970 7469 6f6e 2074 6f20 6120 7374  cription to a st
-00017990: 7265 616d 2e0a 0a54 6869 7320 6d65 7468  ream...This meth
-000179a0: 6f64 2068 6173 2061 2072 6571 7569 7265  od has a require
-000179b0: 6420 6067 726f 7570 5f6e 616d 6560 2061  d `group_name` a
-000179c0: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
-000179d0: 7320 7468 650a 6e61 6d65 206f 6620 6120  s the.name of a 
-000179e0: 2267 726f 7570 2220 6f66 2063 6f6e 7375  "group" of consu
-000179f0: 6d65 7273 206f 6620 7468 6520 7375 6273  mers of the subs
-00017a00: 6372 6970 7469 6f6e 2c20 616e 6420 6120  cription, and a 
-00017a10: 7265 7175 6972 6564 0a60 7374 7265 616d  required.`stream
-00017a20: 5f6e 616d 6560 2061 7267 756d 656e 742c  _name` argument,
-00017a30: 2077 6869 6368 2069 7320 7468 6520 6e61   which is the na
-00017a40: 6d65 206f 6620 6120 7374 7265 616d 2e0a  me of a stream..
-00017a50: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
-00017a60: 6f20 6861 7320 666f 7572 206f 7074 696f  o has four optio
-00017a70: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
-00017a80: 6672 6f6d 5f65 6e64 602c 2060 7374 7265  from_end`, `stre
-00017a90: 616d 5f70 6f73 6974 696f 6e60 2c0a 6074  am_position`,.`t
-00017aa0: 696d 656f 7574 6020 616e 6420 6063 7265  imeout` and `cre
-00017ab0: 6465 6e74 6961 6c73 602e 0a0a 5468 6520  dentials`...The 
-00017ac0: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
-00017ad0: 6e64 6020 6172 6775 6d65 6e74 2063 616e  nd` argument can
-00017ae0: 2062 6520 7573 6564 2074 6f20 7370 6563   be used to spec
-00017af0: 6966 7920 7468 6174 2074 6865 2067 726f  ify that the gro
-00017b00: 7570 206f 6620 636f 6e73 756d 6572 730a  up of consumers.
-00017b10: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
-00017b20: 696f 6e20 7368 6f75 6c64 206f 6e6c 7920  ion should only 
-00017b30: 7265 6365 6976 6520 6576 656e 7473 2074  receive events t
-00017b40: 6861 7420 7765 7265 2072 6563 6f72 6465  hat were recorde
-00017b50: 6420 6166 7465 7220 7468 6520 7375 6273  d after the subs
-00017b60: 6372 6970 7469 6f6e 0a77 6173 2075 7064  cription.was upd
-00017b70: 6174 6564 2e0a 0a41 6c74 6572 6e61 7469  ated...Alternati
-00017b80: 7665 6c79 2c20 7468 6520 6f70 7469 6f6e  vely, the option
-00017b90: 616c 2060 7374 7265 616d 5f70 6f73 6974  al `stream_posit
-00017ba0: 696f 6e60 2061 7267 756d 656e 7420 6361  ion` argument ca
-00017bb0: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
-00017bc0: 6369 6679 2061 2073 7472 6561 6d0a 706f  cify a stream.po
-00017bd0: 7369 7469 6f6e 2066 726f 6d20 7768 6963  sition from whic
-00017be0: 6820 636f 6d6d 6974 2070 6f73 6974 696f  h commit positio
-00017bf0: 6e20 7468 6520 6772 6f75 7020 6f66 2063  n the group of c
-00017c00: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
-00017c10: 7375 6273 6372 6970 7469 6f6e 2073 686f  subscription sho
-00017c20: 756c 640a 7265 6365 6976 6520 6576 656e  uld.receive even
-00017c30: 7473 2e20 506c 6561 7365 206e 6f74 652c  ts. Please note,
-00017c40: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-00017c50: 656e 7420 6174 2074 6865 2073 7065 6369  ent at the speci
-00017c60: 6669 6564 2073 7472 6561 6d20 706f 7369  fied stream posi
-00017c70: 7469 6f6e 206d 6967 6874 0a62 6520 696e  tion might.be in
-00017c80: 636c 7564 6564 2069 6e20 7468 6520 7265  cluded in the re
-00017c90: 636f 7264 6564 2065 7665 6e74 7320 7265  corded events re
-00017ca0: 6365 6976 6564 2062 7920 7468 6520 6772  ceived by the gr
-00017cb0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-00017cc0: 2e0a 0a49 6620 6e65 6974 6865 7220 6066  ...If neither `f
-00017cd0: 726f 6d5f 656e 6460 206f 7220 6063 6f6d  rom_end` or `com
-00017ce0: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
-00017cf0: 6520 7370 6563 6966 6965 642c 2074 6865  e specified, the
-00017d00: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
-00017d10: 6572 730a 6f66 2074 6865 2073 7562 7363  ers.of the subsc
-00017d20: 7269 7074 696f 6e20 7769 6c6c 2070 6f74  ription will pot
-00017d30: 656e 7469 616c 6c79 2072 6563 6569 7665  entially receive
-00017d40: 2061 6c6c 2072 6563 6f72 6465 6420 6576   all recorded ev
-00017d50: 656e 7473 2069 6e20 7468 6520 7374 7265  ents in the stre
-00017d60: 616d 2e0a 0a50 6c65 6173 6520 6e6f 7465  am...Please note
-00017d70: 2c20 7468 6520 636f 6e73 756d 6572 2073  , the consumer s
-00017d80: 7472 6174 6567 7920 6361 6e6e 6f74 2062  trategy cannot b
-00017d90: 6520 6164 6a75 7374 6564 2e0a 0a54 6865  e adjusted...The
-00017da0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-00017db0: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
-00017dc0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-00017dd0: 2077 6869 6368 2073 6574 7320 610a 6465   which sets a.de
-00017de0: 6164 6c69 6e65 2066 6f72 2074 6865 2063  adline for the c
-00017df0: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-00017e00: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-00017e10: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
-00017e20: 6372 6564 656e 7469 616c 7360 2061 7267  credentials` arg
-00017e30: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
-00017e40: 6420 746f 0a6f 7665 7272 6964 6520 6361  d to.override ca
-00017e50: 6c6c 2063 7265 6465 6e74 6961 6c73 2064  ll credentials d
-00017e60: 6572 6976 6564 2066 726f 6d20 7468 6520  erived from the 
-00017e70: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00017e80: 6720 5552 492e 0a0a 5468 6520 6075 7064  g URI...The `upd
-00017e90: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-00017ea0: 5f74 6f5f 7374 7265 616d 2829 6020 6d65  _to_stream()` me
-00017eb0: 7468 6f64 2064 6f65 7320 6e6f 7420 7265  thod does not re
-00017ec0: 7475 726e 2061 2076 616c 7565 2e0a 0a49  turn a value...I
-00017ed0: 6e20 7468 6520 6578 616d 706c 6520 6265  n the example be
-00017ee0: 6c6f 772c 2061 2070 6572 7369 7374 656e  low, a persisten
-00017ef0: 7420 7375 6273 6372 6970 7469 6f6e 2074  t subscription t
-00017f00: 6f20 6120 7374 7265 616d 2069 7320 7570  o a stream is up
-00017f10: 6461 7465 6420 746f 2072 756e 2066 726f  dated to run fro
-00017f20: 6d20 7468 650a 656e 6420 6f66 2074 6865  m the.end of the
-00017f30: 2073 7472 6561 6d2e 0a0a 6060 6070 7974   stream...```pyt
-00017f40: 686f 6e0a 2320 4372 6561 7465 2061 2070  hon.# Create a p
-00017f50: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00017f60: 6970 7469 6f6e 2e0a 636c 6965 6e74 2e75  iption..client.u
-00017f70: 7064 6174 655f 7375 6273 6372 6970 7469  pdate_subscripti
-00017f80: 6f6e 5f74 6f5f 7374 7265 616d 280a 2020  on_to_stream(.  
-00017f90: 2020 6772 6f75 705f 6e61 6d65 3d67 726f    group_name=gro
-00017fa0: 7570 5f6e 616d 6532 2c0a 2020 2020 7374  up_name2,.    st
-00017fb0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00017fc0: 5f6e 616d 6532 2c0a 2020 2020 6672 6f6d  _name2,.    from
-00017fd0: 5f65 6e64 3d54 7275 652c 0a29 0a60 6060  _end=True,.).```
-00017fe0: 0a0a 2323 2320 5265 706c 6179 2070 6172  ..### Replay par
-00017ff0: 6b65 6420 6576 656e 7473 0a0a 2a72 6571  ked events..*req
-00018000: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
-00018010: 6865 2060 7265 706c 6179 5f70 6172 6b65  he `replay_parke
-00018020: 645f 6576 656e 7473 2829 6020 6d65 7468  d_events()` meth
-00018030: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
-00018040: 6f20 2272 6570 6c61 7922 2065 7665 6e74  o "replay" event
-00018050: 7320 7468 6174 2068 6176 650a 6265 656e  s that have.been
-00018060: 2022 7061 726b 6564 2220 286e 6567 6174   "parked" (negat
-00018070: 6976 656c 7920 6163 6b6e 6f77 6c65 6467  ively acknowledg
-00018080: 6564 2077 6974 6820 7468 6520 6163 7469  ed with the acti
-00018090: 6f6e 2060 2770 6172 6b27 6029 2077 6865  on `'park'`) whe
-000180a0: 6e20 7265 6164 696e 670a 6120 7065 7273  n reading.a pers
-000180b0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-000180c0: 696f 6e2e 2050 6172 6b65 6420 6576 656e  ion. Parked even
-000180d0: 7473 2077 696c 6c20 7468 656e 2062 6520  ts will then be 
-000180e0: 7265 6365 6976 6564 2061 6761 696e 2062  received again b
-000180f0: 7920 636f 6e73 756d 6572 730a 7265 6164  y consumers.read
-00018100: 696e 6720 6672 6f6d 2074 6865 2070 6572  ing from the per
-00018110: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-00018120: 7469 6f6e 2e0a 0a54 6869 7320 6d65 7468  tion...This meth
-00018130: 6f64 2068 6173 2061 2072 6571 7569 7265  od has a require
-00018140: 6420 6067 726f 7570 5f6e 616d 6560 2061  d `group_name` a
-00018150: 7267 756d 656e 7420 616e 6420 616e 206f  rgument and an o
-00018160: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
-00018170: 6e61 6d65 600a 6172 6775 6d65 6e74 2e20  name`.argument. 
-00018180: 5468 6520 7661 6c75 6573 206f 6620 7468  The values of th
-00018190: 6573 6520 6172 6775 6d65 6e74 7320 7368  ese arguments sh
-000181a0: 6f75 6c64 206d 6174 6368 2074 686f 7365  ould match those
-000181b0: 2075 7365 6420 7768 656e 2063 616c 6c69   used when calli
-000181c0: 6e67 0a60 6372 6561 7465 5f73 7562 7363  ng.`create_subsc
-000181d0: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
-000181e0: 6020 6f72 2060 6372 6561 7465 5f73 7562  ` or `create_sub
-000181f0: 7363 7269 7074 696f 6e5f 746f 5f73 7472  scription_to_str
-00018200: 6561 6d28 2960 2e0a 0a54 6869 7320 6d65  eam()`...This me
-00018210: 7468 6f64 2068 6173 2061 6e20 6f70 7469  thod has an opti
-00018220: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00018230: 7267 756d 656e 742c 2074 6861 740a 6973  rgument, that.is
-00018240: 2065 7870 6563 7465 6420 746f 2062 6520   expected to be 
-00018250: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-00018260: 2c20 7768 6963 6820 7365 7473 2061 2064  , which sets a d
-00018270: 6561 646c 696e 650a 666f 7220 7468 6520  eadline.for the 
-00018280: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-00018290: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-000182a0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
-000182b0: 6c73 6f20 6861 7320 616e 206f 7074 696f  lso has an optio
-000182c0: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
-000182d0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-000182e0: 6820 6361 6e20 6265 2075 7365 6420 746f  h can be used to
-000182f0: 0a6f 7665 7272 6964 6520 6361 6c6c 2063  .override call c
-00018300: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
-00018310: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
-00018320: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
-00018330: 492e 0a0a 5468 6520 6578 616d 706c 6520  I...The example 
-00018340: 6265 6c6f 7720 7265 706c 6179 7320 7061  below replays pa
-00018350: 726b 6564 2065 7665 6e74 7320 666f 7220  rked events for 
-00018360: 6772 6f75 7020 6067 726f 7570 5f6e 616d  group `group_nam
-00018370: 6531 602e 0a0a 6060 6070 7974 686f 6e0a  e1`...```python.
-00018380: 636c 6965 6e74 2e72 6570 6c61 795f 7061  client.replay_pa
-00018390: 726b 6564 5f65 7665 6e74 7328 0a20 2020  rked_events(.   
-000183a0: 2067 726f 7570 5f6e 616d 653d 6772 6f75   group_name=grou
-000183b0: 705f 6e61 6d65 312c 0a29 0a60 6060 0a0a  p_name1,.).```..
-000183c0: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
-000183d0: 7720 7265 706c 6179 7320 7061 726b 6564  w replays parked
-000183e0: 2065 7665 6e74 7320 666f 7220 6772 6f75   events for grou
-000183f0: 7020 6067 726f 7570 5f6e 616d 6532 602e  p `group_name2`.
-00018400: 0a0a 6060 6070 7974 686f 6e0a 636c 6965  ..```python.clie
-00018410: 6e74 2e72 6570 6c61 795f 7061 726b 6564  nt.replay_parked
-00018420: 5f65 7665 6e74 7328 0a20 2020 2067 726f  _events(.    gro
-00018430: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
-00018440: 6d65 322c 0a20 2020 2073 7472 6561 6d5f  me2,.    stream_
-00018450: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-00018460: 322c 0a29 0a60 6060 0a0a 2323 2320 4765  2,.).```..### Ge
-00018470: 7420 7375 6273 6372 6970 7469 6f6e 2069  t subscription i
-00018480: 6e66 6f0a 0a2a 7265 7175 6972 6573 206c  nfo..*requires l
-00018490: 6561 6465 722a 0a0a 5468 6520 6067 6574  eader*..The `get
-000184a0: 5f73 7562 7363 7269 7074 696f 6e5f 696e  _subscription_in
-000184b0: 666f 2829 6020 6d65 7468 6f64 2063 616e  fo()` method can
-000184c0: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
-000184d0: 696e 666f 726d 6174 696f 6e20 666f 7220  information for 
-000184e0: 610a 7065 7273 6973 7465 6e74 2073 7562  a.persistent sub
-000184f0: 7363 7269 7074 696f 6e2e 0a0a 5468 6973  scription...This
-00018500: 206d 6574 686f 6420 6861 7320 6120 7265   method has a re
-00018510: 7175 6972 6564 2060 6772 6f75 705f 6e61  quired `group_na
-00018520: 6d65 6020 6172 6775 6d65 6e74 2061 6e64  me` argument and
-00018530: 2061 6e20 6f70 7469 6f6e 616c 2060 7374   an optional `st
-00018540: 7265 616d 5f6e 616d 6560 0a61 7267 756d  ream_name`.argum
-00018550: 656e 742c 2077 6869 6368 2073 686f 756c  ent, which shoul
-00018560: 6420 6d61 7463 6820 7468 6520 7661 6c75  d match the valu
-00018570: 6573 206f 6620 6172 6775 6d65 6e74 7320  es of arguments 
-00018580: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
-00018590: 6720 6569 7468 6572 0a60 6372 6561 7465  g either.`create
-000185a0: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
-000185b0: 5f61 6c6c 2829 6020 6f72 2060 6372 6561  _all()` or `crea
-000185c0: 7465 5f73 7562 7363 7269 7074 696f 6e5f  te_subscription_
-000185d0: 746f 5f73 7472 6561 6d28 2960 2e0a 0a54  to_stream()`...T
-000185e0: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
-000185f0: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-00018600: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
-00018610: 6861 740a 6973 2065 7870 6563 7465 6420  hat.is expected 
-00018620: 746f 2062 6520 6120 5079 7468 6f6e 2060  to be a Python `
-00018630: 666c 6f61 7460 2c20 7768 6963 6820 7365  float`, which se
-00018640: 7473 2061 2064 6561 646c 696e 650a 666f  ts a deadline.fo
-00018650: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-00018660: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-00018670: 7261 7469 6f6e 2e0a 0a54 6869 7320 6d65  ration...This me
-00018680: 7468 6f64 2061 6c73 6f20 6861 7320 616e  thod also has an
-00018690: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-000186a0: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-000186b0: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
-000186c0: 7365 6420 746f 0a6f 7665 7272 6964 6520  sed to.override 
-000186d0: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
-000186e0: 2064 6572 6976 6564 2066 726f 6d20 7468   derived from th
-000186f0: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
-00018700: 696e 6720 5552 492e 0a0a 5468 6520 6578  ing URI...The ex
-00018710: 616d 706c 6520 6265 6c6f 7720 6765 7473  ample below gets
-00018720: 2069 6e66 6f72 6d61 7469 6f6e 2066 6f72   information for
-00018730: 2074 6865 2070 6572 7369 7374 656e 7420   the persistent 
-00018740: 7375 6273 6372 6970 7469 6f6e 2060 6772  subscription `gr
-00018750: 6f75 705f 6e61 6d65 3160 2077 6869 6368  oup_name1` which
-00018760: 0a77 6173 2063 7265 6174 6564 2062 7920  .was created by 
-00018770: 6361 6c6c 696e 6720 6063 7265 6174 655f  calling `create_
-00018780: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
-00018790: 616c 6c28 2960 2e0a 0a60 6060 7079 7468  all()`...```pyth
-000187a0: 6f6e 0a73 7562 7363 7269 7074 696f 6e5f  on.subscription_
-000187b0: 696e 666f 203d 2063 6c69 656e 742e 6765  info = client.ge
-000187c0: 745f 7375 6273 6372 6970 7469 6f6e 5f69  t_subscription_i
-000187d0: 6e66 6f28 0a20 2020 2067 726f 7570 5f6e  nfo(.    group_n
-000187e0: 616d 653d 6772 6f75 705f 6e61 6d65 312c  ame=group_name1,
-000187f0: 0a29 0a60 6060 0a0a 5468 6520 6578 616d  .).```..The exam
-00018800: 706c 6520 6265 6c6f 7720 6765 7473 2069  ple below gets i
-00018810: 6e66 6f72 6d61 7469 6f6e 2066 6f72 2074  nformation for t
-00018820: 6865 2070 6572 7369 7374 656e 7420 7375  he persistent su
-00018830: 6273 6372 6970 7469 6f6e 2060 6772 6f75  bscription `grou
-00018840: 705f 6e61 6d65 3260 206f 6e0a 6073 7472  p_name2` on.`str
-00018850: 6561 6d5f 6e61 6d65 3260 2077 6869 6368  eam_name2` which
-00018860: 2077 6173 2063 7265 6174 6564 2062 7920   was created by 
-00018870: 6361 6c6c 696e 6720 6063 7265 6174 655f  calling `create_
-00018880: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
-00018890: 7374 7265 616d 2829 602e 0a0a 6060 6070  stream()`...```p
-000188a0: 7974 686f 6e0a 7375 6273 6372 6970 7469  ython.subscripti
-000188b0: 6f6e 5f69 6e66 6f20 3d20 636c 6965 6e74  on_info = client
-000188c0: 2e67 6574 5f73 7562 7363 7269 7074 696f  .get_subscriptio
-000188d0: 6e5f 696e 666f 280a 2020 2020 6772 6f75  n_info(.    grou
-000188e0: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
-000188f0: 6532 2c0a 2020 2020 7374 7265 616d 5f6e  e2,.    stream_n
-00018900: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-00018910: 2c0a 290a 6060 600a 0a54 6865 2072 6574  ,.).```..The ret
-00018920: 7572 6e65 6420 7661 6c75 6520 6973 2061  urned value is a
-00018930: 2060 5375 6273 6372 6970 7469 6f6e 496e   `SubscriptionIn
-00018940: 666f 6020 6f62 6a65 6374 2e0a 0a23 2323  fo` object...###
-00018950: 204c 6973 7420 7375 6273 6372 6970 7469   List subscripti
-00018960: 6f6e 730a 0a2a 7265 7175 6972 6573 206c  ons..*requires l
-00018970: 6561 6465 722a 0a0a 5468 6520 606c 6973  eader*..The `lis
-00018980: 745f 7375 6273 6372 6970 7469 6f6e 7328  t_subscriptions(
-00018990: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-000189a0: 2075 7365 6420 746f 2067 6574 2069 6e66   used to get inf
-000189b0: 6f72 6d61 7469 6f6e 2066 6f72 2061 6c6c  ormation for all
-000189c0: 0a65 7869 7374 696e 6720 7065 7273 6973  .existing persis
-000189d0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-000189e0: 6e73 2c20 626f 7468 2022 7375 6273 6372  ns, both "subscr
-000189f0: 6970 7469 6f6e 7320 746f 2061 6c6c 2220  iptions to all" 
-00018a00: 616e 640a 2273 7562 7363 7269 7074 696f  and."subscriptio
-00018a10: 6e73 2074 6f20 7374 7265 616d 222e 0a0a  ns to stream"...
-00018a20: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
-00018a30: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
-00018a40: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
-00018a50: 7468 6174 0a69 7320 6578 7065 6374 6564  that.is expected
-00018a60: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
-00018a70: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
-00018a80: 6574 7320 6120 6465 6164 6c69 6e65 0a66  ets a deadline.f
-00018a90: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-00018aa0: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-00018ab0: 6572 6174 696f 6e2e 0a0a 5468 6973 206d  eration...This m
-00018ac0: 6574 686f 6420 616c 736f 2068 6173 2061  ethod also has a
-00018ad0: 6e20 6f70 7469 6f6e 616c 2060 6372 6564  n optional `cred
-00018ae0: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
-00018af0: 742c 2077 6869 6368 2063 616e 2062 6520  t, which can be 
-00018b00: 7573 6564 2074 6f0a 6f76 6572 7269 6465  used to.override
-00018b10: 2063 616c 6c20 6372 6564 656e 7469 616c   call credential
-00018b20: 7320 6465 7269 7665 6420 6672 6f6d 2074  s derived from t
-00018b30: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-00018b40: 7269 6e67 2055 5249 2e0a 0a54 6865 2065  ring URI...The e
-00018b50: 7861 6d70 6c65 2062 656c 6f77 206c 6973  xample below lis
-00018b60: 7473 2061 6c6c 2074 6865 2065 7869 7374  ts all the exist
-00018b70: 696e 6720 7065 7273 6973 7465 6e74 2073  ing persistent s
-00018b80: 7562 7363 7269 7074 696f 6e73 2e0a 0a60  ubscriptions...`
-00018b90: 6060 7079 7468 6f6e 0a73 7562 7363 7269  ``python.subscri
-00018ba0: 7074 696f 6e73 203d 2063 6c69 656e 742e  ptions = client.
-00018bb0: 6c69 7374 5f73 7562 7363 7269 7074 696f  list_subscriptio
-00018bc0: 6e73 2829 0a60 6060 0a0a 5468 6520 7265  ns().```..The re
-00018bd0: 7475 726e 6564 2076 616c 7565 2069 7320  turned value is 
-00018be0: 6120 6c69 7374 206f 6620 6053 7562 7363  a list of `Subsc
-00018bf0: 7269 7074 696f 6e49 6e66 6f60 206f 626a  riptionInfo` obj
-00018c00: 6563 7473 2e0a 0a0a 2323 2320 4c69 7374  ects....### List
-00018c10: 2073 7562 7363 7269 7074 696f 6e73 2074   subscriptions t
-00018c20: 6f20 7374 7265 616d 0a0a 2a72 6571 7569  o stream..*requi
-00018c30: 7265 7320 6c65 6164 6572 2a0a 0a54 6865  res leader*..The
-00018c40: 2060 6c69 7374 5f73 7562 7363 7269 7074   `list_subscript
-00018c50: 696f 6e73 5f74 6f5f 7374 7265 616d 2829  ions_to_stream()
-00018c60: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
-00018c70: 7573 6564 2074 6f20 6765 7420 696e 666f  used to get info
-00018c80: 726d 6174 696f 6e20 666f 7220 616c 6c0a  rmation for all.
-00018c90: 7468 6520 7065 7273 6973 7465 6e74 2073  the persistent s
-00018ca0: 7562 7363 7269 7074 696f 6e73 2074 6f20  ubscriptions to 
-00018cb0: 6120 7374 7265 616d 2e0a 0a54 6869 7320  a stream...This 
-00018cc0: 6d65 7468 6f64 2068 6173 206f 6e65 2072  method has one r
-00018cd0: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
-00018ce0: 2c20 6073 7472 6561 6d5f 6e61 6d65 602e  , `stream_name`.
-00018cf0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
-00018d00: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
-00018d10: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-00018d20: 2c20 7468 6174 2069 7320 6578 7065 6374  , that is expect
-00018d30: 6564 2074 6f20 6265 2061 0a50 7974 686f  ed to be a.Pytho
-00018d40: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
-00018d50: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
-00018d60: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
-00018d70: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00018d80: 6f70 6572 6174 696f 6e2e 0a0a 5468 6973  operation...This
-00018d90: 206d 6574 686f 6420 616c 736f 2068 6173   method also has
-00018da0: 2061 6e20 6f70 7469 6f6e 616c 2060 6372   an optional `cr
-00018db0: 6564 656e 7469 616c 7360 2061 7267 756d  edentials` argum
-00018dc0: 656e 742c 2077 6869 6368 2063 616e 2062  ent, which can b
-00018dd0: 6520 7573 6564 2074 6f0a 6f76 6572 7269  e used to.overri
-00018de0: 6465 2063 616c 6c20 6372 6564 656e 7469  de call credenti
-00018df0: 616c 7320 6465 7269 7665 6420 6672 6f6d  als derived from
-00018e00: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
-00018e10: 7374 7269 6e67 2055 5249 2e0a 0a60 6060  string URI...```
-00018e20: 7079 7468 6f6e 0a73 7562 7363 7269 7074  python.subscript
-00018e30: 696f 6e73 203d 2063 6c69 656e 742e 6c69  ions = client.li
-00018e40: 7374 5f73 7562 7363 7269 7074 696f 6e73  st_subscriptions
-00018e50: 5f74 6f5f 7374 7265 616d 280a 2020 2020  _to_stream(.    
-00018e60: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00018e70: 616d 5f6e 616d 6532 2c0a 290a 6060 600a  am_name2,.).```.
-00018e80: 0a54 6865 2072 6574 7572 6e65 6420 7661  .The returned va
-00018e90: 6c75 6520 6973 2061 206c 6973 7420 6f66  lue is a list of
-00018ea0: 2060 5375 6273 6372 6970 7469 6f6e 496e   `SubscriptionIn
-00018eb0: 666f 6020 6f62 6a65 6374 732e 0a0a 0a23  fo` objects....#
-00018ec0: 2323 2044 656c 6574 6520 7375 6273 6372  ## Delete subscr
-00018ed0: 6970 7469 6f6e 0a0a 2a72 6571 7569 7265  iption..*require
-00018ee0: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
-00018ef0: 6465 6c65 7465 5f73 7562 7363 7269 7074  delete_subscript
-00018f00: 696f 6e28 2960 206d 6574 686f 6420 6361  ion()` method ca
-00018f10: 6e20 6265 2075 7365 6420 746f 2064 656c  n be used to del
-00018f20: 6574 6520 6120 7065 7273 6973 7465 6e74  ete a persistent
-00018f30: 0a73 7562 7363 7269 7074 696f 6e2e 0a0a  .subscription...
-00018f40: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
-00018f50: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
-00018f60: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
-00018f70: 2061 6e64 2061 6e20 6f70 7469 6f6e 616c   and an optional
-00018f80: 2060 7374 7265 616d 5f6e 616d 6560 0a61   `stream_name`.a
-00018f90: 7267 756d 656e 742c 2077 6869 6368 2073  rgument, which s
-00018fa0: 686f 756c 6420 6d61 7463 6820 7468 6520  hould match the 
-00018fb0: 7661 6c75 6573 206f 6620 6172 6775 6d65  values of argume
-00018fc0: 6e74 7320 7573 6564 2077 6865 6e20 6361  nts used when ca
-00018fd0: 6c6c 696e 6720 6569 7468 6572 0a60 6372  lling either.`cr
-00018fe0: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
-00018ff0: 6e5f 746f 5f61 6c6c 2829 6020 6f72 2060  n_to_all()` or `
-00019000: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
-00019010: 696f 6e5f 746f 5f73 7472 6561 6d28 2960  ion_to_stream()`
-00019020: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
-00019030: 6173 2061 6e20 6f70 7469 6f6e 616c 2060  as an optional `
-00019040: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
-00019050: 742c 2074 6861 740a 6973 2065 7870 6563  t, that.is expec
-00019060: 7465 6420 746f 2062 6520 6120 5079 7468  ted to be a Pyth
-00019070: 6f6e 2060 666c 6f61 7460 2c20 7768 6963  on `float`, whic
-00019080: 6820 7365 7473 2061 2064 6561 646c 696e  h sets a deadlin
-00019090: 650a 666f 7220 7468 6520 636f 6d70 6c65  e.for the comple
-000190a0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-000190b0: 206f 7065 7261 7469 6f6e 2e0a 0a54 6869   operation...Thi
-000190c0: 7320 6d65 7468 6f64 2061 6c73 6f20 6861  s method also ha
-000190d0: 7320 616e 206f 7074 696f 6e61 6c20 6063  s an optional `c
-000190e0: 7265 6465 6e74 6961 6c73 6020 6172 6775  redentials` argu
-000190f0: 6d65 6e74 2c20 7768 6963 6820 6361 6e20  ment, which can 
-00019100: 6265 2075 7365 6420 746f 0a6f 7665 7272  be used to.overr
-00019110: 6964 6520 6361 6c6c 2063 7265 6465 6e74  ide call credent
-00019120: 6961 6c73 2064 6572 6976 6564 2066 726f  ials derived fro
-00019130: 6d20 7468 6520 636f 6e6e 6563 7469 6f6e  m the connection
-00019140: 2073 7472 696e 6720 5552 492e 0a0a 5468   string URI...Th
-00019150: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
-00019160: 6465 6c65 7465 7320 7468 6520 7065 7273  deletes the pers
-00019170: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00019180: 696f 6e20 6067 726f 7570 5f6e 616d 6531  ion `group_name1
-00019190: 6020 7768 6963 680a 7761 7320 6372 6561  ` which.was crea
-000191a0: 7465 6420 6279 2063 616c 6c69 6e67 2060  ted by calling `
-000191b0: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
-000191c0: 696f 6e5f 746f 5f61 6c6c 2829 602e 0a0a  ion_to_all()`...
-000191d0: 6060 6070 7974 686f 6e0a 636c 6965 6e74  ```python.client
-000191e0: 2e64 656c 6574 655f 7375 6273 6372 6970  .delete_subscrip
-000191f0: 7469 6f6e 280a 2020 2020 6772 6f75 705f  tion(.    group_
-00019200: 6e61 6d65 3d67 726f 7570 5f6e 616d 6531  name=group_name1
-00019210: 2c0a 290a 6060 600a 0a54 6865 2065 7861  ,.).```..The exa
-00019220: 6d70 6c65 2062 656c 6f77 2064 656c 6574  mple below delet
-00019230: 6564 2074 6865 2070 6572 7369 7374 656e  ed the persisten
-00019240: 7420 7375 6273 6372 6970 7469 6f6e 2060  t subscription `
-00019250: 6772 6f75 705f 6e61 6d65 3260 206f 6e0a  group_name2` on.
-00019260: 6073 7472 6561 6d5f 6e61 6d65 3260 2077  `stream_name2` w
-00019270: 6869 6368 2077 6173 2063 7265 6174 6564  hich was created
-00019280: 2062 7920 6361 6c6c 696e 6720 6063 7265   by calling `cre
-00019290: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-000192a0: 5f74 6f5f 7374 7265 616d 2829 602e 0a0a  _to_stream()`...
-000192b0: 6060 6070 7974 686f 6e0a 636c 6965 6e74  ```python.client
-000192c0: 2e64 656c 6574 655f 7375 6273 6372 6970  .delete_subscrip
-000192d0: 7469 6f6e 280a 2020 2020 6772 6f75 705f  tion(.    group_
-000192e0: 6e61 6d65 3d67 726f 7570 5f6e 616d 6532  name=group_name2
-000192f0: 2c0a 2020 2020 7374 7265 616d 5f6e 616d  ,.    stream_nam
-00019300: 653d 7374 7265 616d 5f6e 616d 6532 2c0a  e=stream_name2,.
-00019310: 290a 6060 600a 0a23 2323 2043 616c 6c20  ).```..### Call 
-00019320: 6372 6564 656e 7469 616c 730a 0a44 6566  credentials..Def
-00019330: 6175 6c74 2063 616c 6c20 6372 6564 656e  ault call creden
-00019340: 7469 616c 7320 6172 6520 6465 7269 7665  tials are derive
-00019350: 6420 6279 2074 6865 2063 6c69 656e 7420  d by the client 
-00019360: 6672 6f6d 2074 6865 2075 7365 7220 696e  from the user in
-00019370: 666f 2070 6172 7420 6f66 2074 6865 0a63  fo part of the.c
-00019380: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00019390: 2055 5249 2e0a 0a4d 616e 7920 6f66 2074   URI...Many of t
-000193a0: 6865 2063 6c69 656e 7420 6d65 7468 6f64  he client method
-000193b0: 7320 6465 7363 7269 6265 6420 6162 6f76  s described abov
-000193c0: 6520 6861 7665 2061 6e20 6f70 7469 6f6e  e have an option
-000193d0: 616c 2060 6372 6564 656e 7469 616c 7360  al `credentials`
-000193e0: 2061 7267 756d 656e 742c 0a77 6869 6368   argument,.which
-000193f0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00019400: 7365 7420 6361 6c6c 2063 7265 6465 6e74  set call credent
-00019410: 6961 6c73 2066 6f72 2061 6e20 696e 6469  ials for an indi
-00019420: 7669 6475 616c 206d 6574 686f 6420 6361  vidual method ca
-00019430: 6c6c 2074 6861 7420 6f76 6572 7269 6465  ll that override
-00019440: 0a74 686f 7365 2064 6572 6976 6564 2066  .those derived f
-00019450: 726f 6d20 7468 6520 636f 6e6e 6563 7469  rom the connecti
-00019460: 6f6e 2073 7472 696e 6720 5552 492e 0a0a  on string URI...
-00019470: 2323 2320 436f 6e73 7472 7563 7420 6361  ### Construct ca
-00019480: 6c6c 2063 7265 6465 6e74 6961 6c73 0a0a  ll credentials..
-00019490: 5468 6520 636c 6965 6e74 206d 6574 686f  The client metho
-000194a0: 6420 6063 6f6e 7374 7275 6374 5f63 616c  d `construct_cal
-000194b0: 6c5f 6372 6564 656e 7469 616c 7328 2960  l_credentials()`
-000194c0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-000194d0: 636f 6e73 7472 7563 7420 6120 6361 6c6c  construct a call
-000194e0: 0a63 7265 6465 6e74 6961 6c73 206f 626a  .credentials obj
-000194f0: 6563 7420 6672 6f6d 2061 2075 7365 726e  ect from a usern
-00019500: 616d 6520 616e 6420 7061 7373 776f 7264  ame and password
-00019510: 2e0a 0a60 6060 7079 7468 6f6e 0a63 616c  ...```python.cal
-00019520: 6c5f 6372 6564 656e 7469 616c 7320 3d20  l_credentials = 
-00019530: 636c 6965 6e74 2e63 6f6e 7374 7275 6374  client.construct
-00019540: 5f63 616c 6c5f 6372 6564 656e 7469 616c  _call_credential
-00019550: 7328 0a20 2020 2075 7365 726e 616d 653d  s(.    username=
-00019560: 2761 646d 696e 272c 2070 6173 7377 6f72  'admin', passwor
-00019570: 643d 2763 6861 6e67 6569 7427 0a29 0a60  d='changeit'.).`
-00019580: 6060 0a0a 5468 6520 6361 6c6c 2063 7265  ``..The call cre
-00019590: 6465 6e74 6961 6c73 206f 626a 6563 7420  dentials object 
-000195a0: 6361 6e20 6265 2075 7365 6420 6173 2074  can be used as t
-000195b0: 6865 2076 616c 7565 206f 6620 7468 6520  he value of the 
-000195c0: 6063 7265 6465 6e74 6961 6c73 600a 6172  `credentials`.ar
-000195d0: 6775 6d65 6e74 2069 6e20 6f74 6865 7220  gument in other 
-000195e0: 636c 6965 6e74 206d 6574 686f 6473 2e0a  client methods..
-000195f0: 0a23 2320 436f 6e6e 6563 7469 6f6e 0a0a  .## Connection..
-00019600: 2323 2320 5265 636f 6e6e 6563 740a 0a54  ### Reconnect..T
-00019610: 6865 2060 7265 636f 6e6e 6563 7428 2960  he `reconnect()`
-00019620: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-00019630: 7365 6420 746f 206d 616e 7561 6c6c 7920  sed to manually 
-00019640: 7265 636f 6e6e 6563 7420 7468 6520 636c  reconnect the cl
-00019650: 6965 6e74 2074 6f20 610a 7375 6974 6162  ient to a.suitab
-00019660: 6c65 2045 7665 6e74 5374 6f72 6544 4220  le EventStoreDB 
-00019670: 6e6f 6465 2e20 5468 6973 206d 6574 686f  node. This metho
-00019680: 6420 7573 6573 2074 6865 2073 616d 6520  d uses the same 
-00019690: 726f 7574 696e 6520 666f 7220 7265 6164  routine for read
-000196a0: 696e 6720 7468 650a 636c 7573 7465 7220  ing the.cluster 
-000196b0: 6e6f 6465 2073 7461 7465 7320 616e 6420  node states and 
-000196c0: 7468 656e 2063 6f6e 6e65 6374 696e 6720  then connecting 
-000196d0: 746f 2061 2073 7569 7461 626c 6520 6e6f  to a suitable no
-000196e0: 6465 2061 6363 6f72 6469 6e67 2074 6f20  de according to 
-000196f0: 7468 650a 636c 6965 6e74 2773 206e 6f64  the.client's nod
-00019700: 6520 7072 6566 6572 656e 6365 2074 6861  e preference tha
-00019710: 7420 6973 2073 7065 6369 6669 6564 2069  t is specified i
-00019720: 6e20 7468 6520 636f 6e6e 6563 7469 6f6e  n the connection
-00019730: 2073 7472 696e 6720 5552 4920 7768 656e   string URI when
-00019740: 0a74 6865 2063 6c69 656e 7420 6973 2063  .the client is c
-00019750: 6f6e 7374 7275 6374 6564 2e20 5468 6973  onstructed. This
-00019760: 206d 6574 686f 6420 6973 2074 6872 6561   method is threa
-00019770: 642d 7361 6665 2c20 696e 2074 6861 7420  d-safe, in that 
-00019780: 7768 656e 2069 7420 6973 2063 616c 6c65  when it is calle
-00019790: 640a 6279 2073 6576 6572 616c 2074 6872  d.by several thr
-000197a0: 6561 6473 2061 7420 7468 6520 7361 6d65  eads at the same
-000197b0: 2074 696d 652c 206f 6e6c 7920 6f6e 6520   time, only one 
-000197c0: 7265 636f 6e6e 6563 7469 6f6e 2077 696c  reconnection wil
-000197d0: 6c20 6f63 6375 722e 2043 6f6e 6375 7272  l occur. Concurr
-000197e0: 656e 740a 6174 7465 6d70 7473 2074 6f20  ent.attempts to 
-000197f0: 7265 636f 6e6e 6563 7420 7769 6c6c 2062  reconnect will b
-00019800: 6c6f 636b 2075 6e74 696c 2074 6865 2063  lock until the c
-00019810: 6c69 656e 7420 6861 7320 7265 636f 6e6e  lient has reconn
-00019820: 6563 7465 6420 7375 6363 6573 7366 756c  ected successful
-00019830: 6c79 2c0a 616e 6420 7468 656e 2074 6865  ly,.and then the
-00019840: 7920 7769 6c6c 2061 6c6c 2072 6574 7572  y will all retur
-00019850: 6e20 6e6f 726d 616c 6c79 2e0a 0a60 6060  n normally...```
-00019860: 7079 7468 6f6e 0a63 6c69 656e 742e 7265  python.client.re
-00019870: 636f 6e6e 6563 7428 290a 6060 600a 0a41  connect().```..A
-00019880: 6e20 6578 616d 706c 6520 6f66 2077 6865  n example of whe
-00019890: 6e20 6974 206d 6967 6874 2062 6520 6465  n it might be de
-000198a0: 7369 7261 626c 6520 746f 2072 6563 6f6e  sirable to recon
-000198b0: 6e65 6374 206d 616e 7561 6c6c 7920 6973  nect manually is
-000198c0: 2077 6865 6e20 2866 6f72 2070 6572 666f   when (for perfo
-000198d0: 726d 616e 6365 0a72 6561 736f 6e73 2920  rmance.reasons) 
-000198e0: 7468 6520 636c 6965 6e74 2773 206e 6f64  the client's nod
-000198f0: 6520 7072 6566 6572 656e 6365 2069 7320  e preference is 
-00019900: 746f 2062 6520 636f 6e6e 6563 7465 6420  to be connected 
-00019910: 746f 2061 2066 6f6c 6c6f 7765 7220 6e6f  to a follower no
-00019920: 6465 2069 6e20 7468 650a 636c 7573 7465  de in the.cluste
-00019930: 722c 2061 6e64 2c20 6166 7465 7220 6120  r, and, after a 
-00019940: 636c 7573 7465 7220 6c65 6164 6572 2065  cluster leader e
-00019950: 6c65 6374 696f 6e2c 2074 6865 2066 6f6c  lection, the fol
-00019960: 6c6f 7765 7220 6265 636f 6d65 7320 7468  lower becomes th
-00019970: 6520 6c65 6164 6572 2e0a 5265 636f 6e6e  e leader..Reconn
-00019980: 6563 7469 6e67 2074 6f20 6120 666f 6c6c  ecting to a foll
-00019990: 6f77 6572 206e 6f64 6520 696e 2074 6869  ower node in thi
-000199a0: 7320 6361 7365 2069 7320 6375 7272 656e  s case is curren
-000199b0: 746c 7920 6265 796f 6e64 2074 6865 2063  tly beyond the c
-000199c0: 6170 6162 696c 6974 6965 7320 6f66 0a74  apabilities of.t
-000199d0: 6869 7320 636c 6965 6e74 2c20 6275 7420  his client, but 
-000199e0: 7468 6973 2062 6568 6176 696f 7220 6d69  this behavior mi
-000199f0: 6768 7420 6265 2069 6d70 6c65 6d65 6e74  ght be implement
-00019a00: 6564 2069 6e20 6120 6675 7475 7265 2072  ed in a future r
-00019a10: 656c 6561 7365 2e0a 0a52 6563 6f6e 6e65  elease...Reconne
-00019a20: 6374 696f 6e20 7769 6c6c 2068 6170 7065  ction will happe
-00019a30: 6e20 6175 746f 6d61 7469 6361 6c6c 7920  n automatically 
-00019a40: 696e 206d 616e 7920 6361 7365 732c 2064  in many cases, d
-00019a50: 7565 2074 6f20 7468 6520 6040 6175 746f  ue to the `@auto
-00019a60: 7265 636f 6e6e 6563 7460 0a64 6563 6f72  reconnect`.decor
-00019a70: 6174 6f72 2e0a 0a23 2323 2043 6c6f 7365  ator...### Close
-00019a80: 0a0a 5468 6520 6063 6c6f 7365 2829 6020  ..The `close()` 
-00019a90: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-00019aa0: 6564 2074 6f20 636c 6561 6e6c 7920 636c  ed to cleanly cl
-00019ab0: 6f73 6520 7468 6520 636c 6965 6e74 2773  ose the client's
-00019ac0: 2067 5250 4320 636f 6e6e 6563 7469 6f6e   gRPC connection
-00019ad0: 2e0a 0a60 6060 7079 7468 6f6e 0a63 6c69  ...```python.cli
-00019ae0: 656e 742e 636c 6f73 6528 290a 6060 600a  ent.close().```.
-00019af0: 0a0a 2323 2041 7379 6e63 696f 2063 6c69  ..## Asyncio cli
-00019b00: 656e 740a 0a54 6865 2060 6573 6462 636c  ent..The `esdbcl
-00019b10: 6965 6e74 6020 7061 636b 6167 6520 616c  ient` package al
-00019b20: 736f 2069 6e63 6c75 6465 7320 616e 2065  so includes an e
-00019b30: 6172 6c79 2076 6572 7369 6f6e 206f 6620  arly version of 
-00019b40: 616e 2061 7379 6e63 6872 6f6e 6f75 7320  an asynchronous 
-00019b50: 492f 4f0a 6752 5043 2050 7974 686f 6e20  I/O.gRPC Python 
-00019b60: 636c 6965 6e74 2e20 4974 2066 6f6c 6c6f  client. It follo
-00019b70: 7773 2065 7861 6374 6c79 2074 6865 2073  ws exactly the s
-00019b80: 616d 6520 6265 6861 7669 6f72 7320 6173  ame behaviors as
-00019b90: 2074 6865 206d 756c 7469 7468 7265 6164   the multithread
-00019ba0: 6564 0a60 4576 656e 7453 746f 7265 4442  ed.`EventStoreDB
-00019bb0: 436c 6965 6e74 602c 2062 7574 2075 7365  Client`, but use
-00019bc0: 7320 7468 6520 6067 7270 632e 6169 6f60  s the `grpc.aio`
-00019bd0: 2070 6163 6b61 6765 2061 6e64 2074 6865   package and the
-00019be0: 2060 6173 796e 6369 6f60 206d 6f64 756c   `asyncio` modul
-00019bf0: 652c 2069 6e73 7465 6164 206f 660a 6067  e, instead of.`g
-00019c00: 7270 6360 2061 6e64 2060 7468 7265 6164  rpc` and `thread
-00019c10: 696e 6760 2e0a 0a54 6865 2061 7379 6e63  ing`...The async
-00019c20: 2066 756e 6374 696f 6e20 6041 7379 6e63   function `Async
-00019c30: 696f 4576 656e 7453 746f 7265 4442 436c  ioEventStoreDBCl
-00019c40: 6965 6e74 6020 636f 6e73 7472 7563 7473  ient` constructs
-00019c50: 2074 6865 2063 6c69 656e 742c 2061 6e64   the client, and
-00019c60: 2063 6f6e 6e65 6374 7320 746f 0a61 2073   connects to.a s
-00019c70: 6572 7665 722e 2049 7420 6361 6e20 6265  erver. It can be
-00019c80: 2069 6d70 6f72 7465 6420 6672 6f6d 2060   imported from `
-00019c90: 6573 6462 636c 6965 6e74 602c 2061 6e64  esdbclient`, and
-00019ca0: 2063 616e 2062 6520 6361 6c6c 6564 2077   can be called w
-00019cb0: 6974 6820 7468 6520 7361 6d65 0a61 7267  ith the same.arg
-00019cc0: 756d 656e 7473 2061 7320 6045 7665 6e74  uments as `Event
-00019cd0: 5374 6f72 6544 4243 6c69 656e 7460 2e20  StoreDBClient`. 
-00019ce0: 4974 2073 7570 706f 7274 7320 626f 7468  It supports both
-00019cf0: 2074 6865 2022 6573 6462 2220 616e 6420   the "esdb" and 
-00019d00: 7468 6520 2265 7364 622b 6469 7363 6f76  the "esdb+discov
-00019d10: 6572 220a 636f 6e6e 6563 7469 6f6e 2073  er".connection s
-00019d20: 7472 696e 6720 5552 4920 7363 6865 6d65  tring URI scheme
-00019d30: 732c 2061 6e64 2063 616e 2063 6f6e 6e65  s, and can conne
-00019d40: 6374 2074 6f20 626f 7468 2022 7365 6375  ct to both "secu
-00019d50: 7265 2220 616e 6420 2269 6e73 6563 7572  re" and "insecur
-00019d60: 6522 0a45 7665 6e74 5374 6f72 6544 4220  e".EventStoreDB 
-00019d70: 7365 7276 6572 732e 2049 7420 7265 636f  servers. It reco
-00019d80: 6e6e 6563 7473 206f 7220 7265 7472 6965  nnects or retrie
-00019d90: 7320 7768 656e 2063 6f6e 6e65 6374 696f  s when connectio
-00019da0: 6e20 6973 7375 6573 206f 7220 7365 7276  n issues or serv
-00019db0: 6572 0a65 7272 6f72 7320 6172 6520 656e  er.errors are en
-00019dc0: 636f 756e 7465 7265 642e 0a0a 6060 6070  countered...```p
-00019dd0: 7974 686f 6e0a 6672 6f6d 2065 7364 6263  ython.from esdbc
-00019de0: 6c69 656e 7420 696d 706f 7274 2041 7379  lient import Asy
-00019df0: 6e63 696f 4576 656e 7453 746f 7265 4442  ncioEventStoreDB
-00019e00: 436c 6965 6e74 0a60 6060 0a0a 5468 6520  Client.```..The 
-00019e10: 6173 796e 6368 726f 6e6f 7573 2049 2f4f  asynchronous I/O
-00019e20: 2063 6c69 656e 7420 6861 7320 7468 6520   client has the 
-00019e30: 666f 6c6c 6f77 696e 6720 6d65 7468 6f64  following method
-00019e40: 733a 2060 6170 7065 6e64 5f74 6f5f 7374  s: `append_to_st
-00019e50: 7265 616d 2829 602c 0a60 6765 745f 7374  ream()`,.`get_st
-00019e60: 7265 616d 2829 602c 2060 7265 6164 5f61  ream()`, `read_a
-00019e70: 6c6c 2829 602c 2060 7375 6273 6372 6962  ll()`, `subscrib
-00019e80: 655f 746f 5f61 6c6c 2829 602c 0a60 6465  e_to_all()`,.`de
-00019e90: 6c65 7465 5f73 7472 6561 6d28 2960 2c20  lete_stream()`, 
-00019ea0: 6074 6f6d 6273 746f 6e65 5f73 7472 6561  `tombstone_strea
-00019eb0: 6d28 2960 2c20 616e 6420 6072 6563 6f6e  m()`, and `recon
-00019ec0: 6e65 6374 2829 602e 0a0a 5468 6573 6520  nect()`...These 
-00019ed0: 6d65 7468 6f64 7320 6172 6520 6571 7569  methods are equi
-00019ee0: 7661 6c65 6e74 2074 6f20 7468 6520 6d65  valent to the me
-00019ef0: 7468 6f64 7320 6f6e 2060 4576 656e 7453  thods on `EventS
-00019f00: 746f 7265 4442 436c 6965 6e74 602e 2054  toreDBClient`. T
-00019f10: 6865 7920 6861 7665 2074 6865 2073 616d  hey have the sam
-00019f20: 650a 6d65 7468 6f64 2073 6967 6e61 7475  e.method signatu
-00019f30: 7265 732c 2061 6e64 2063 616e 2062 6520  res, and can be 
-00019f40: 6361 6c6c 6564 2077 6974 6820 7468 6520  called with the 
-00019f50: 7361 6d65 2061 7267 756d 656e 7473 2c20  same arguments, 
-00019f60: 746f 2074 6865 2073 616d 6520 6566 6665  to the same effe
-00019f70: 6374 2e0a 5468 6520 6d65 7468 6f64 7320  ct..The methods 
-00019f80: 7768 6963 6820 6170 7065 6172 206f 6e20  which appear on 
-00019f90: 6045 7665 6e74 5374 6f72 6544 4243 6c69  `EventStoreDBCli
-00019fa0: 656e 7460 2062 7574 206e 6f74 206f 6e20  ent` but not on 
-00019fb0: 6041 7379 6e63 696f 4576 656e 7453 746f  `AsyncioEventSto
-00019fc0: 7265 4442 436c 6965 6e74 6020 7769 6c6c  reDBClient` will
-00019fd0: 2062 650a 6164 6465 6420 736f 6f6e 2e0a   be.added soon..
-00019fe0: 0a23 2323 2053 796e 6f70 7369 730a 0a54  .### Synopsis..T
-00019ff0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-0001a000: 2064 656d 6f6e 7374 7261 7465 7320 7468   demonstrates th
-0001a010: 6520 6061 7070 656e 645f 746f 5f73 7472  e `append_to_str
-0001a020: 6561 6d28 2960 2c20 6067 6574 5f73 7472  eam()`, `get_str
-0001a030: 6561 6d28 2960 2061 6e64 0a60 7375 6273  eam()` and.`subs
-0001a040: 6372 6962 655f 746f 5f61 6c6c 2829 6020  cribe_to_all()` 
-0001a050: 6d65 7468 6f64 732e 2054 6865 7365 2061  methods. These a
-0001a060: 7265 2074 6865 206d 6f73 7420 7573 6566  re the most usef
-0001a070: 756c 206d 6574 686f 6473 2066 6f72 2077  ul methods for w
-0001a080: 7269 7469 6e67 0a61 6e20 6576 656e 742d  riting.an event-
-0001a090: 736f 7572 6365 6420 6170 706c 6963 6174  sourced applicat
-0001a0a0: 696f 6e2c 2061 6c6c 6f77 696e 6720 6e65  ion, allowing ne
-0001a0b0: 7720 6167 6772 6567 6174 6520 6576 656e  w aggregate even
-0001a0c0: 7473 2074 6f20 6265 2072 6563 6f72 6465  ts to be recorde
-0001a0d0: 642c 2074 6865 0a72 6563 6f72 6465 6420  d, the.recorded 
-0001a0e0: 6576 656e 7473 206f 6620 616e 2061 6767  events of an agg
-0001a0f0: 7265 6761 7465 2074 6f20 6265 206f 6274  regate to be obt
-0001a100: 6169 6e65 6420 736f 2061 6767 7265 6761  ained so aggrega
-0001a110: 7465 7320 6361 6e20 6265 2072 6563 6f6e  tes can be recon
-0001a120: 7374 7275 6374 6564 2c0a 616e 6420 7468  structed,.and th
-0001a130: 6520 7374 6174 6520 6f66 2061 6e20 6170  e state of an ap
-0001a140: 706c 6963 6174 696f 6e20 746f 2070 726f  plication to pro
-0001a150: 7061 6761 7465 6420 616e 6420 7072 6f63  pagated and proc
-0001a160: 6573 7365 6420 7769 7468 2022 6578 6163  essed with "exac
-0001a170: 746c 792d 6f6e 6365 220a 7365 6d61 6e74  tly-once".semant
-0001a180: 6963 732e 0a0a 6060 6070 7974 686f 6e0a  ics...```python.
-0001a190: 696d 706f 7274 2061 7379 6e63 696f 0a0a  import asyncio..
-0001a1a0: 6173 796e 6320 6465 6620 6465 6d6f 6e73  async def demons
-0001a1b0: 7472 6174 655f 6173 796e 6369 6f5f 636c  trate_asyncio_cl
-0001a1c0: 6965 6e74 2829 3a0a 0a20 2020 2023 2043  ient():..    # C
-0001a1d0: 6f6e 7374 7275 6374 2063 6c69 656e 742e  onstruct client.
-0001a1e0: 0a20 2020 2063 6c69 656e 7420 3d20 6177  .    client = aw
-0001a1f0: 6169 7420 4173 796e 6369 6f45 7665 6e74  ait AsyncioEvent
-0001a200: 5374 6f72 6544 4243 6c69 656e 7428 0a20  StoreDBClient(. 
-0001a210: 2020 2020 2020 2075 7269 3d6f 732e 6765         uri=os.ge
-0001a220: 7465 6e76 2822 4553 4442 5f55 5249 2229  tenv("ESDB_URI")
-0001a230: 2c0a 2020 2020 2020 2020 726f 6f74 5f63  ,.        root_c
-0001a240: 6572 7469 6669 6361 7465 733d 6f73 2e67  ertificates=os.g
-0001a250: 6574 656e 7628 2245 5344 425f 524f 4f54  etenv("ESDB_ROOT
-0001a260: 5f43 4552 5449 4649 4341 5445 5322 292c  _CERTIFICATES"),
-0001a270: 0a20 2020 2029 0a0a 2020 2020 2320 4170  .    )..    # Ap
-0001a280: 7065 6e64 2065 7665 6e74 732e 0a20 2020  pend events..   
-0001a290: 2073 7472 6561 6d5f 6e61 6d65 203d 2073   stream_name = s
-0001a2a0: 7472 2875 7569 642e 7575 6964 3428 2929  tr(uuid.uuid4())
-0001a2b0: 0a20 2020 2065 7665 6e74 3120 3d20 4e65  .    event1 = Ne
-0001a2c0: 7745 7665 6e74 2822 4f72 6465 7243 7265  wEvent("OrderCre
-0001a2d0: 6174 6564 222c 2064 6174 613d 6227 7b7d  ated", data=b'{}
-0001a2e0: 2729 0a20 2020 2065 7665 6e74 3220 3d20  ').    event2 = 
-0001a2f0: 4e65 7745 7665 6e74 2822 4f72 6465 7255  NewEvent("OrderU
-0001a300: 7064 6174 6564 222c 2064 6174 613d 6227  pdated", data=b'
-0001a310: 7b7d 2729 0a20 2020 2065 7665 6e74 3320  {}').    event3 
-0001a320: 3d20 4e65 7745 7665 6e74 2822 4f72 6465  = NewEvent("Orde
-0001a330: 7244 656c 6574 6564 222c 2064 6174 613d  rDeleted", data=
-0001a340: 6227 7b7d 2729 0a0a 2020 2020 636f 6d6d  b'{}')..    comm
-0001a350: 6974 5f70 6f73 6974 696f 6e20 3d20 6177  it_position = aw
-0001a360: 6169 7420 636c 6965 6e74 2e61 7070 656e  ait client.appen
-0001a370: 645f 746f 5f73 7472 6561 6d28 0a20 2020  d_to_stream(.   
-0001a380: 2020 2020 2073 7472 6561 6d5f 6e61 6d65       stream_name
-0001a390: 3d73 7472 6561 6d5f 6e61 6d65 2c0a 2020  =stream_name,.  
-0001a3a0: 2020 2020 2020 6375 7272 656e 745f 7665        current_ve
-0001a3b0: 7273 696f 6e3d 5374 7265 616d 5374 6174  rsion=StreamStat
-0001a3c0: 652e 4e4f 5f53 5452 4541 4d2c 0a20 2020  e.NO_STREAM,.   
-0001a3d0: 2020 2020 2065 7665 6e74 733d 5b65 7665       events=[eve
-0001a3e0: 6e74 312c 2065 7665 6e74 322c 2065 7665  nt1, event2, eve
-0001a3f0: 6e74 335d 0a20 2020 2029 0a0a 2020 2020  nt3].    )..    
-0001a400: 2320 5265 6164 2073 7472 6561 6d20 6576  # Read stream ev
-0001a410: 656e 7473 2e0a 2020 2020 7265 636f 7264  ents..    record
-0001a420: 6564 203d 2061 7761 6974 2063 6c69 656e  ed = await clien
-0001a430: 742e 6765 745f 7374 7265 616d 2873 7472  t.get_stream(str
-0001a440: 6561 6d5f 6e61 6d65 290a 2020 2020 6173  eam_name).    as
-0001a450: 7365 7274 206c 656e 2872 6563 6f72 6465  sert len(recorde
-0001a460: 6429 203d 3d20 330a 2020 2020 6173 7365  d) == 3.    asse
-0001a470: 7274 2072 6563 6f72 6465 645b 305d 2e69  rt recorded[0].i
-0001a480: 6420 3d3d 2065 7665 6e74 312e 6964 0a20  d == event1.id. 
-0001a490: 2020 2061 7373 6572 7420 7265 636f 7264     assert record
-0001a4a0: 6564 5b31 5d2e 6964 203d 3d20 6576 656e  ed[1].id == even
-0001a4b0: 7432 2e69 640a 2020 2020 6173 7365 7274  t2.id.    assert
-0001a4c0: 2072 6563 6f72 6465 645b 325d 2e69 6420   recorded[2].id 
-0001a4d0: 3d3d 2065 7665 6e74 332e 6964 0a0a 0a20  == event3.id... 
-0001a4e0: 2020 2023 2053 7562 7363 7269 6265 2061     # Subscribe a
-0001a4f0: 6c6c 2065 7665 6e74 732e 0a20 2020 2072  ll events..    r
-0001a500: 6563 6569 7665 6420 3d20 5b5d 0a20 2020  eceived = [].   
-0001a510: 2061 7379 6e63 2066 6f72 2065 7665 6e74   async for event
-0001a520: 2069 6e20 6177 6169 7420 636c 6965 6e74   in await client
-0001a530: 2e73 7562 7363 7269 6265 5f74 6f5f 616c  .subscribe_to_al
-0001a540: 6c28 293a 0a20 2020 2020 2020 2072 6563  l():.        rec
-0001a550: 6569 7665 642e 6170 7065 6e64 2865 7665  eived.append(eve
-0001a560: 6e74 290a 2020 2020 2020 2020 6966 2065  nt).        if e
-0001a570: 7665 6e74 2e63 6f6d 6d69 745f 706f 7369  vent.commit_posi
-0001a580: 7469 6f6e 203d 3d20 636f 6d6d 6974 5f70  tion == commit_p
-0001a590: 6f73 6974 696f 6e3a 0a20 2020 2020 2020  osition:.       
-0001a5a0: 2020 2020 2062 7265 616b 0a20 2020 2061       break.    a
-0001a5b0: 7373 6572 7420 7265 6365 6976 6564 5b2d  ssert received[-
-0001a5c0: 335d 2e69 6420 3d3d 2065 7665 6e74 312e  3].id == event1.
-0001a5d0: 6964 0a20 2020 2061 7373 6572 7420 7265  id.    assert re
-0001a5e0: 6365 6976 6564 5b2d 325d 2e69 6420 3d3d  ceived[-2].id ==
-0001a5f0: 2065 7665 6e74 322e 6964 0a20 2020 2061   event2.id.    a
-0001a600: 7373 6572 7420 7265 6365 6976 6564 5b2d  ssert received[-
-0001a610: 315d 2e69 6420 3d3d 2065 7665 6e74 332e  1].id == event3.
-0001a620: 6964 0a0a 0a20 2020 2023 2043 6c6f 7365  id...    # Close
-0001a630: 2074 6865 2063 6c69 656e 742e 0a20 2020   the client..   
-0001a640: 2061 7761 6974 2063 6c69 656e 742e 636c   await client.cl
-0001a650: 6f73 6528 290a 0a0a 2320 5275 6e20 7468  ose()...# Run th
-0001a660: 6520 6465 6d6f 2e0a 6173 796e 6369 6f2e  e demo..asyncio.
-0001a670: 6765 745f 6576 656e 745f 6c6f 6f70 2829  get_event_loop()
-0001a680: 2e72 756e 5f75 6e74 696c 5f63 6f6d 706c  .run_until_compl
-0001a690: 6574 6528 0a20 2020 2064 656d 6f6e 7374  ete(.    demonst
-0001a6a0: 7261 7465 5f61 7379 6e63 696f 5f63 6c69  rate_asyncio_cli
-0001a6b0: 656e 7428 290a 290a 6060 600a 0a23 2320  ent().).```..## 
-0001a6c0: 4e6f 7465 730a 0a23 2323 2052 6567 756c  Notes..### Regul
-0001a6d0: 6172 2065 7870 7265 7373 696f 6e20 6669  ar expression fi
-0001a6e0: 6c74 6572 730a 0a54 6865 2060 7265 6164  lters..The `read
-0001a6f0: 5f61 6c6c 2829 602c 2060 7375 6273 6372  _all()`, `subscr
-0001a700: 6962 655f 746f 5f61 6c6c 2829 602c 2060  ibe_to_all()`, `
-0001a710: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
-0001a720: 696f 6e5f 746f 5f61 6c6c 2829 600a 616e  ion_to_all()`.an
-0001a730: 6420 6067 6574 5f63 6f6d 6d69 745f 706f  d `get_commit_po
-0001a740: 7369 7469 6f6e 2829 6020 6d65 7468 6f64  sition()` method
-0001a750: 7320 6861 7665 2060 6669 6c74 6572 5f65  s have `filter_e
-0001a760: 7863 6c75 6465 6020 616e 6420 6066 696c  xclude` and `fil
-0001a770: 7465 725f 696e 636c 7564 6560 0a61 7267  ter_include`.arg
-0001a780: 756d 656e 7473 2e20 5468 6973 2073 6563  uments. This sec
-0001a790: 7469 6f6e 2070 726f 7669 6465 7320 736f  tion provides so
-0001a7a0: 6d65 206d 6f72 6520 6465 7461 696c 7320  me more details 
-0001a7b0: 6162 6f75 7420 7468 6520 7661 6c75 6573  about the values
-0001a7c0: 206f 6620 7468 6573 650a 6172 6775 6d65   of these.argume
-0001a7d0: 6e74 732e 0a0a 5468 6520 6669 7273 7420  nts...The first 
-0001a7e0: 7468 696e 6720 746f 206e 6f74 6520 6973  thing to note is
-0001a7f0: 2074 6861 7420 7468 6573 6520 6172 6775   that these argu
-0001a800: 6d65 6e74 7320 6172 6520 7365 7175 656e  ments are sequen
-0001a810: 6365 7320 6f66 2072 6567 756c 6172 2065  ces of regular e
-0001a820: 7870 7265 7373 696f 6e73 2e0a 5468 6579  xpressions..They
-0001a830: 2061 7265 2063 6f6e 6361 7465 6e61 7465   are concatenate
-0001a840: 6420 746f 6765 7468 6572 2062 7920 7468  d together by th
-0001a850: 6520 636c 6965 6e74 2061 7320 6272 6163  e client as brac
-0001a860: 6b65 7465 6420 616c 7465 726e 6174 6976  keted alternativ
-0001a870: 6573 2069 6e20 6120 6c61 7267 6572 0a72  es in a larger.r
-0001a880: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-0001a890: 6e20 7468 6174 2069 7320 616e 6368 6f72  n that is anchor
-0001a8a0: 6564 2074 6f20 7468 6520 7374 6172 7420  ed to the start 
-0001a8b0: 616e 6420 656e 6420 6f66 2074 6865 2073  and end of the s
-0001a8c0: 7472 696e 6773 2062 6569 6e67 0a6d 6174  trings being.mat
-0001a8d0: 6368 6564 2e20 536f 2079 6f75 2073 686f  ched. So you sho
-0001a8e0: 756c 646e 2774 2069 6e63 6c75 6465 2074  uldn't include t
-0001a8f0: 6865 2060 275e 2760 2061 6e64 2060 2724  he `'^'` and `'$
-0001a900: 2760 2061 6e63 686f 7220 6368 6172 6163  '` anchor charac
-0001a910: 7465 7273 2c20 756e 6c65 7373 0a74 6865  ters, unless.the
-0001a920: 7365 2063 6861 7261 6374 6572 7320 6172  se characters ar
-0001a930: 6520 6573 6361 7065 6420 6173 206c 6974  e escaped as lit
-0001a940: 6572 616c 2063 6861 7261 6374 6572 7320  eral characters 
-0001a950: 746f 2062 6520 6d61 7463 6865 642e 2042  to be matched. B
-0001a960: 7574 2079 6f75 2073 686f 756c 640a 7573  ut you should.us
-0001a970: 6520 7769 6c64 6361 7264 7320 6966 2079  e wildcards if y
-0001a980: 6f75 2077 616e 7420 746f 206d 6174 6368  ou want to match
-0001a990: 2073 7562 7374 7269 6e67 732c 2066 6f72   substrings, for
-0001a9a0: 2065 7861 6d70 6c65 2060 272e 2a53 6e61   example `'.*Sna
-0001a9b0: 7073 686f 7427 6020 746f 206d 6174 6368  pshot'` to match
-0001a9c0: 0a61 6c6c 2073 7472 696e 6773 2074 6861  .all strings tha
-0001a9d0: 7420 656e 6420 7769 7468 2060 2753 6e61  t end with `'Sna
-0001a9e0: 7073 686f 7460 272e 0a0a 496e 2061 6c6c  pshot`'...In all
-0001a9f0: 206d 6574 686f 6473 2c20 7468 6520 6465   methods, the de
-0001aa00: 6661 756c 7420 7661 6c75 6520 6f66 2074  fault value of t
-0001aa10: 6865 2060 6669 6c74 6572 5f65 7863 6c75  he `filter_exclu
-0001aa20: 6465 6020 6172 6775 6d65 6e74 2069 7320  de` argument is 
-0001aa30: 7468 6520 636f 6e73 7461 6e74 0a60 4445  the constant.`DE
-0001aa40: 4641 554c 545f 4558 434c 5544 455f 4649  FAULT_EXCLUDE_FI
-0001aa50: 4c54 4552 602c 2077 6869 6368 2069 7320  LTER`, which is 
-0001aa60: 6465 7369 676e 6564 2074 6f20 6578 636c  designed to excl
-0001aa70: 7564 6520 4576 656e 7453 746f 7265 4442  ude EventStoreDB
-0001aa80: 2022 7379 7374 656d 2220 616e 640a 2270   "system" and."p
-0001aa90: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
-0001aaa0: 7269 7074 696f 6e20 636f 6e66 6967 2220  ription config" 
-0001aab0: 6576 656e 7420 7479 7065 732c 2077 6869  event types, whi
-0001aac0: 6368 206f 7468 6572 7769 7365 2077 6f75  ch otherwise wou
-0001aad0: 6c64 2062 6520 696e 636c 7564 6564 2e0a  ld be included..
-0001aae0: 0a53 7973 7465 6d20 6576 656e 7473 2067  .System events g
-0001aaf0: 656e 6572 6174 6564 2062 7920 4576 656e  enerated by Even
-0001ab00: 7453 746f 7265 4442 2068 6176 6520 6074  tStoreDB have `t
-0001ab10: 7970 6560 2073 7472 696e 6773 2074 6861  ype` strings tha
-0001ab20: 7420 7374 6172 7420 7769 7468 0a74 6865  t start with.the
-0001ab30: 2060 2460 2073 6967 6e2e 2050 6572 7369   `$` sign. Persi
-0001ab40: 7374 656e 6365 2073 7562 7363 7269 7074  stence subscript
-0001ab50: 696f 6e20 6576 656e 7473 2067 656e 6572  ion events gener
-0001ab60: 6174 6564 2077 6865 6e20 6d61 6e69 7075  ated when manipu
-0001ab70: 6c61 7469 6e67 0a70 6572 7369 7374 656e  lating.persisten
-0001ab80: 6365 2073 7562 7363 7269 7074 696f 6e73  ce subscriptions
-0001ab90: 2068 6176 6520 6074 7970 6560 2073 7472   have `type` str
-0001aba0: 696e 6773 2074 6861 7420 7374 6172 7420  ings that start 
-0001abb0: 7769 7468 2060 5065 7273 6973 7465 6e74  with `Persistent
-0001abc0: 436f 6e66 6967 602e 0a0a 466f 7220 6578  Config`...For ex
-0001abd0: 616d 706c 652c 2074 6f20 6d61 7463 6820  ample, to match 
-0001abe0: 7468 6520 7479 7065 206f 6620 4576 656e  the type of Even
-0001abf0: 7453 746f 7265 4442 2073 7973 7465 6d20  tStoreDB system 
-0001ac00: 6576 656e 7473 2c20 7573 6520 7468 6520  events, use the 
-0001ac10: 7265 6775 6c61 720a 6578 7072 6573 7369  regular.expressi
-0001ac20: 6f6e 2073 7472 696e 6720 6072 275c 242e  on string `r'\$.
-0001ac30: 2b27 602e 2050 6c65 6173 6520 6e6f 7465  +'`. Please note
-0001ac40: 2c20 7468 6520 636f 6e73 7461 6e74 2060  , the constant `
-0001ac50: 4553 4442 5f53 5953 5445 4d5f 4556 454e  ESDB_SYSTEM_EVEN
-0001ac60: 5453 5f52 4547 4558 6020 6973 0a73 6574  TS_REGEX` is.set
-0001ac70: 2074 6f20 7468 6973 2076 616c 7565 2e20   to this value. 
-0001ac80: 596f 7520 6361 6e20 696d 706f 7274 2074  You can import t
-0001ac90: 6869 7320 636f 6e73 7461 6e74 2066 726f  his constant fro
-0001aca0: 6d20 6065 7364 6263 6c69 656e 7460 2061  m `esdbclient` a
-0001acb0: 6e64 2075 7365 2069 7420 7768 656e 0a62  nd use it when.b
-0001acc0: 7569 6c64 696e 6720 6c6f 6e67 6572 2073  uilding longer s
-0001acd0: 6571 7565 6e63 6573 206f 6620 7265 6775  equences of regu
-0001ace0: 6c61 7220 6578 7072 6573 7369 6f6e 732e  lar expressions.
-0001acf0: 0a0a 5369 6d69 6c61 726c 792c 2074 6f20  ..Similarly, to 
-0001ad00: 6d61 7463 6820 7468 6520 7479 7065 206f  match the type o
-0001ad10: 6620 4576 656e 7453 746f 7265 4442 2070  f EventStoreDB p
-0001ad20: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
-0001ad30: 7269 7074 696f 6e20 6576 656e 7473 2c20  ription events, 
-0001ad40: 7573 6520 7468 650a 7265 6775 6c61 7220  use the.regular 
-0001ad50: 6578 7072 6573 7369 6f6e 2060 7227 5065  expression `r'Pe
-0001ad60: 7273 6973 7465 6e74 436f 6e66 6967 5c64  rsistentConfig\d
-0001ad70: 2b27 602e 2054 6865 2063 6f6e 7374 616e  +'`. The constan
-0001ad80: 7420 6045 5344 425f 5045 5253 4953 5445  t `ESDB_PERSISTE
-0001ad90: 4e54 5f43 4f4e 4649 475f 4556 454e 5453  NT_CONFIG_EVENTS
-0001ada0: 5f52 4547 4558 600a 6973 2073 6574 2074  _REGEX`.is set t
-0001adb0: 6f20 7468 6973 2076 616c 7565 2e20 596f  o this value. Yo
-0001adc0: 7520 6361 6e20 696d 706f 7274 2074 6869  u can import thi
-0001add0: 7320 636f 6e73 7461 6e74 2066 726f 6d20  s constant from 
-0001ade0: 6065 7364 6263 6c69 656e 7460 2020 616e  `esdbclient`  an
-0001adf0: 6420 7573 6520 6974 2077 6865 6e0a 6275  d use it when.bu
-0001ae00: 696c 6469 6e67 206c 6f6e 6765 7220 7365  ilding longer se
-0001ae10: 7175 656e 6365 7320 6f66 2072 6567 756c  quences of regul
-0001ae20: 6172 2065 7870 7265 7373 696f 6e73 2e0a  ar expressions..
-0001ae30: 0a54 6865 2063 6f6e 7374 616e 7420 6044  .The constant `D
-0001ae40: 4546 4155 4c54 5f45 5843 4c55 4445 5f46  EFAULT_EXCLUDE_F
-0001ae50: 494c 5445 5260 2069 7320 6120 7365 7175  ILTER` is a sequ
-0001ae60: 656e 6365 206f 6620 7265 6775 6c61 7220  ence of regular 
-0001ae70: 6578 7072 6573 7369 6f6e 7320 7468 6174  expressions that
-0001ae80: 2069 6e63 6c75 6465 730a 626f 7468 2060   includes.both `
-0001ae90: 4553 4442 5f53 5953 5445 4d5f 4556 454e  ESDB_SYSTEM_EVEN
-0001aea0: 5453 5f52 4547 4558 6020 616e 6420 6045  TS_REGEX` and `E
-0001aeb0: 5344 425f 5045 5253 4953 5445 4e54 5f43  SDB_PERSISTENT_C
-0001aec0: 4f4e 4649 475f 4556 454e 5453 5f52 4547  ONFIG_EVENTS_REG
-0001aed0: 4558 602e 2049 7420 6973 2075 7365 640a  EX`. It is used.
-0001aee0: 6173 2074 6865 2064 6566 6175 6c74 2076  as the default v
-0001aef0: 616c 7565 206f 6620 6066 696c 7465 725f  alue of `filter_
-0001af00: 6578 636c 7564 6560 2073 6f20 7468 6174  exclude` so that
-0001af10: 2074 6865 2065 7665 6e74 7320 7468 6174   the events that
-0001af20: 2045 7665 6e74 5374 6f72 6544 4220 6765   EventStoreDB ge
-0001af30: 6e65 7261 7465 730a 696e 7465 726e 616c  nerates.internal
-0001af40: 6c79 2061 7265 2065 7863 6c75 6465 6420  ly are excluded 
-0001af50: 6279 2064 6566 6175 6c74 2e0a 0a46 6f72  by default...For
-0001af60: 2065 7861 6d70 6c65 2c20 6966 2079 6f75   example, if you
-0001af70: 2077 616e 7420 746f 2065 7863 6c75 6465   want to exclude
-0001af80: 2073 6e61 7073 686f 7473 2061 6e64 2073   snapshots and s
-0001af90: 7973 7465 6d20 6576 656e 7473 2061 6e64  ystem events and
-0001afa0: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-0001afb0: 6372 6970 7469 6f6e 0a65 7665 6e74 732c  cription.events,
-0001afc0: 2074 6865 6e20 796f 7520 6d61 7920 7769   then you may wi
-0001afd0: 7368 2074 6f20 7573 6520 6120 6170 7072  sh to use a appr
-0001afe0: 6f70 7269 6174 656c 7920 6578 7465 6e64  opriately extend
-0001aff0: 6564 2063 6f70 7920 6f66 2060 4445 4641  ed copy of `DEFA
-0001b000: 554c 545f 4558 434c 5544 455f 4649 4c54  ULT_EXCLUDE_FILT
-0001b010: 4552 600a 6173 2074 6865 2076 616c 7565  ER`.as the value
-0001b020: 206f 6620 7468 6520 6066 696c 7465 725f   of the `filter_
-0001b030: 6578 636c 7564 6560 2061 7267 756d 656e  exclude` argumen
-0001b040: 7473 2c20 7375 6368 2061 7320 6044 4546  ts, such as `DEF
-0001b050: 4155 4c54 5f45 5843 4c55 4445 5f46 494c  AULT_EXCLUDE_FIL
-0001b060: 5445 5220 2b20 5b27 2e2a 536e 6170 7368  TER + ['.*Snapsh
-0001b070: 6f74 275d 602e 0a0a 0a23 2323 2052 6563  ot']`....### Rec
-0001b080: 6f6e 6e65 6374 2061 6e64 2072 6574 7279  onnect and retry
-0001b090: 206d 6574 686f 6420 6465 636f 7261 746f   method decorato
-0001b0a0: 7273 0a0a 506c 6561 7365 206e 6f74 652c  rs..Please note,
-0001b0b0: 206e 6561 726c 7920 616c 6c20 7468 6520   nearly all the 
-0001b0c0: 636c 6965 6e74 206d 6574 686f 6473 2061  client methods a
-0001b0d0: 7265 2064 6563 6f72 6174 6564 2077 6974  re decorated wit
-0001b0e0: 6820 7468 6520 6040 6175 746f 7265 636f  h the `@autoreco
-0001b0f0: 6e6e 6563 7460 2061 6e64 0a74 6865 2060  nnect` and.the `
-0001b100: 4072 6574 7279 6772 7063 6020 6465 636f  @retrygrpc` deco
-0001b110: 7261 746f 7273 2e0a 0a54 6865 2060 4061  rators...The `@a
-0001b120: 7574 6f72 6563 6f6e 6e65 6374 6020 6465  utoreconnect` de
-0001b130: 636f 7261 746f 7220 7769 6c6c 2072 6563  corator will rec
-0001b140: 6f6e 6e65 6374 2074 6f20 6120 7375 6974  onnect to a suit
-0001b150: 6162 6c65 206e 6f64 6520 696e 2074 6865  able node in the
-0001b160: 2063 6c75 7374 6572 2077 6865 6e0a 7468   cluster when.th
-0001b170: 6520 7365 7276 6572 2074 6f20 7768 6963  e server to whic
-0001b180: 6820 7468 6520 636c 6965 6e74 2068 6173  h the client has
-0001b190: 2062 6565 6e20 636f 6e6e 6563 7465 6420   been connected 
-0001b1a0: 6861 7320 6265 636f 6d65 2075 6e61 7661  has become unava
-0001b1b0: 696c 6162 6c65 2c20 6f72 2077 6865 6e20  ilable, or when 
-0001b1c0: 7468 650a 636c 6965 6e74 2773 2067 5250  the.client's gRP
-0001b1d0: 4320 6368 616e 6e65 6c20 6861 7070 656e  C channel happen
-0001b1e0: 7320 746f 2068 6176 6520 6265 656e 2063  s to have been c
-0001b1f0: 6c6f 7365 642e 2054 6865 2063 6c69 656e  losed. The clien
-0001b200: 7420 7769 6c6c 2061 6c73 6f20 7265 636f  t will also reco
-0001b210: 6e6e 6563 7420 7768 656e 0a61 206d 6574  nnect when.a met
-0001b220: 686f 6420 6973 2063 616c 6c65 6420 7468  hod is called th
-0001b230: 6174 2072 6571 7569 7265 7320 6120 6c65  at requires a le
-0001b240: 6164 6572 2c20 616e 6420 7468 6520 636c  ader, and the cl
-0001b250: 6965 6e74 2773 206e 6f64 6520 7072 6566  ient's node pref
-0001b260: 6572 656e 6365 2069 7320 746f 2062 650a  erence is to be.
-0001b270: 636f 6e6e 6563 7465 6420 746f 2061 206c  connected to a l
-0001b280: 6561 6465 722c 2062 7574 2074 6865 206e  eader, but the n
-0001b290: 6f64 6520 7468 6174 2074 6865 2063 6c69  ode that the cli
-0001b2a0: 656e 7420 6861 7320 6265 656e 2063 6f6e  ent has been con
-0001b2b0: 6e65 6374 6564 2074 6f20 7374 6f70 7320  nected to stops 
-0001b2c0: 6265 696e 670a 7468 6520 6c65 6164 6572  being.the leader
-0001b2d0: 2e20 496e 2074 6869 7320 6361 7365 2c20  . In this case, 
-0001b2e0: 7468 6520 636c 6965 6e74 2077 696c 6c20  the client will 
-0001b2f0: 7265 636f 6e6e 6563 7420 746f 2074 6865  reconnect to the
-0001b300: 2063 7572 7265 6e74 206c 6561 6465 722e   current leader.
-0001b310: 2041 6674 6572 0a72 6563 6f6e 6e65 6374   After.reconnect
-0001b320: 696e 672c 2074 6865 2066 6169 6c65 6420  ing, the failed 
-0001b330: 6f70 6572 6174 696f 6e20 7769 6c6c 2062  operation will b
-0001b340: 6520 7265 7472 6965 642e 0a0a 5468 6520  e retried...The 
-0001b350: 6040 7265 7472 7967 7270 6360 2064 6563  `@retrygrpc` dec
-0001b360: 6f72 6174 6f72 2072 6574 7269 6573 206f  orator retries o
-0001b370: 7065 7261 7469 6f6e 7320 7468 6174 2068  perations that h
-0001b380: 6176 6520 6661 696c 6564 2064 7565 2074  ave failed due t
-0001b390: 6f20 6120 6465 6164 6c69 6e65 2062 6569  o a deadline bei
-0001b3a0: 6e67 0a72 6561 6368 6564 2028 736f 2074  ng.reached (so t
-0001b3b0: 6861 7420 7468 6520 6f70 6572 6174 696f  hat the operatio
-0001b3c0: 6e20 7469 6d65 7320 6f75 7429 2c20 616e  n times out), an
-0001b3d0: 6420 696e 2063 6173 6520 7468 6520 7365  d in case the se
-0001b3e0: 7276 6572 2074 6872 6f77 7320 616e 2065  rver throws an e
-0001b3f0: 7863 6570 7469 6f6e 0a77 6865 6e20 6861  xception.when ha
-0001b400: 6e64 6c69 6e67 2061 2063 6c69 656e 7420  ndling a client 
-0001b410: 7265 7175 6573 742e 0a0a 506c 6561 7365  request...Please
-0001b420: 2061 6c73 6f20 6e6f 7465 2c20 7468 6520   also note, the 
-0001b430: 6173 7065 6374 7320 6e6f 7420 636f 7665  aspects not cove
-0001b440: 7265 6420 6279 2074 6865 2072 6563 6f6e  red by the recon
-0001b450: 6e65 6374 2061 6e64 2072 6574 7279 2064  nect and retry d
-0001b460: 6563 6f72 6174 6f72 0a62 6568 6176 696f  ecorator.behavio
-0001b470: 7572 7320 6861 7665 2074 6f20 646f 2077  urs have to do w
-0001b480: 6974 6820 6d65 7468 6f64 7320 7468 6174  ith methods that
-0001b490: 2072 6574 7572 6e20 6974 6572 6174 6f72   return iterator
-0001b4a0: 732e 2046 6f72 2065 7861 6d70 6c65 2c20  s. For example, 
-0001b4b0: 636f 6e73 6964 6572 0a74 6865 2022 7265  consider.the "re
-0001b4c0: 6164 2072 6573 706f 6e73 6522 2069 7465  ad response" ite
-0001b4d0: 7261 746f 7220 7265 7475 726e 6564 2066  rator returned f
-0001b4e0: 726f 6d20 7468 6520 6072 6561 645f 616c  rom the `read_al
-0001b4f0: 6c28 2960 206d 6574 686f 642e 2054 6865  l()` method. The
-0001b500: 0a60 7265 6164 5f61 6c6c 2829 6020 6d65  .`read_all()` me
-0001b510: 7468 6f64 2077 696c 6c20 6861 7665 2072  thod will have r
-0001b520: 6574 7572 6e65 642c 2061 6e64 2074 6865  eturned, and the
-0001b530: 206d 6574 686f 6420 6465 636f 7261 746f   method decorato
-0001b540: 7273 2077 696c 6c20 7468 6572 6566 6f72  rs will therefor
-0001b550: 650a 6861 7665 2065 7869 7465 642c 2062  e.have exited, b
-0001b560: 6566 6f72 6520 6974 6572 6174 696e 6720  efore iterating 
-0001b570: 6f76 6572 2074 6865 2022 7265 6164 2072  over the "read r
-0001b580: 6573 706f 6e73 6522 2062 6567 696e 732e  esponse" begins.
-0001b590: 2054 6865 7265 666f 7265 2c20 6966 2061   Therefore, if a
-0001b5a0: 0a63 6f6e 6e65 6374 696f 6e20 6973 7375  .connection issu
-0001b5b0: 6573 206f 6363 7572 7320 7768 696c 7374  es occurs whilst
-0001b5c0: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
-0001b5d0: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
-0001b5e0: 7365 222c 2069 7420 6973 6e27 7420 706f  se", it isn't po
-0001b5f0: 7373 6962 6c65 0a66 6f72 2061 6e79 2064  ssible.for any d
-0001b600: 6563 6f72 6174 6f72 206f 6e20 7468 6520  ecorator on the 
-0001b610: 6072 6561 645f 616c 6c28 2960 206d 6574  `read_all()` met
-0001b620: 686f 6420 746f 2074 7269 6767 6572 2061  hod to trigger a
-0001b630: 2072 6563 6f6e 6e65 6374 696f 6e2e 0a0a   reconnection...
-0001b640: 5769 7468 2074 6865 2022 6361 7463 682d  With the "catch-
-0001b650: 7570 2073 7562 7363 7269 7074 696f 6e22  up subscription"
-0001b660: 206f 626a 6563 7473 2c20 7468 6572 6520   objects, there 
-0001b670: 6973 2061 6e20 696e 6974 6961 6c20 2263  is an initial "c
-0001b680: 6f6e 6669 726d 6174 696f 6e22 2072 6573  onfirmation" res
-0001b690: 706f 6e73 650a 6672 6f6d 2074 6865 2073  ponse.from the s
-0001b6a0: 6572 7665 7220 7768 6963 6820 6973 2072  erver which is r
-0001b6b0: 6563 6569 7665 6420 616e 6420 6368 6563  eceived and chec
-0001b6c0: 6b65 6420 6279 2074 6865 2063 6c69 656e  ked by the clien
-0001b6d0: 742e 2041 6e64 2073 6f2c 2077 6865 6e20  t. And so, when 
-0001b6e0: 6120 6361 6c6c 2069 730a 6d61 6465 2074  a call is.made t
-0001b6f0: 6f20 6073 7562 7363 7269 6265 5f74 6f5f  o `subscribe_to_
-0001b700: 616c 6c28 2960 206f 7220 6073 7562 7363  all()` or `subsc
-0001b710: 7269 6265 5f74 6f5f 7374 7265 616d 2829  ribe_to_stream()
-0001b720: 602c 2069 6620 7468 6520 7365 7276 6572  `, if the server
-0001b730: 2069 7320 756e 6176 6169 6c61 626c 652c   is unavailable,
-0001b740: 0a6f 7220 6966 2074 6865 2063 6861 6e6e  .or if the chann
-0001b750: 656c 2068 6173 2073 6f6d 6568 6f77 2062  el has somehow b
-0001b760: 6565 6e20 636c 6f73 6564 2c20 6f72 2069  een closed, or i
-0001b770: 6620 7468 6520 7265 7175 6573 7420 6661  f the request fa
-0001b780: 696c 7320 666f 7220 736f 6d65 206f 7468  ils for some oth
-0001b790: 6572 2072 6561 736f 6e2c 0a74 6865 6e20  er reason,.then 
-0001b7a0: 7468 6520 636c 6965 6e74 2077 696c 6c20  the client will 
-0001b7b0: 7265 636f 6e6e 6563 7420 616e 6420 7265  reconnect and re
-0001b7c0: 7472 792e 2048 6f77 6576 6572 2c20 6966  try. However, if
-0001b7d0: 2061 6e20 6578 6365 7074 696f 6e20 6973   an exception is
-0001b7e0: 2072 6169 7365 6420 7768 656e 2069 7465   raised when ite
-0001b7f0: 7261 7469 6e67 206f 7665 7220 610a 7375  rating over a.su
-0001b800: 6363 6573 7366 756c 6c79 2072 6574 7572  ccessfully retur
-0001b810: 6e65 6420 2263 6174 6368 2d75 7020 7375  ned "catch-up su
-0001b820: 6273 6372 6970 7469 6f6e 2220 6f62 6a65  bscription" obje
-0001b830: 6374 2c20 7468 6520 6361 7463 682d 7570  ct, the catch-up
-0001b840: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
-0001b850: 6c6c 0a6e 6565 6420 746f 2062 6520 7265  ll.need to be re
-0001b860: 7374 6172 7465 642e 2053 696d 696c 6172  started. Similar
-0001b870: 6c79 2c20 7768 656e 2072 6561 6469 6e67  ly, when reading
-0001b880: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-0001b890: 6372 6970 7469 6f6e 732c 2069 6620 7468  criptions, if th
-0001b8a0: 6572 6520 6172 650a 636f 6e6e 6563 7469  ere are.connecti
-0001b8b0: 6f6e 2069 7373 7565 7320 7768 696c 7374  on issues whilst
-0001b8c0: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
-0001b8d0: 6120 7375 6363 6573 7366 756c 6c79 2072  a successfully r
-0001b8e0: 6563 6569 7665 6420 7265 7370 6f6e 7365  eceived response
-0001b8f0: 2c20 7468 6520 636f 6e73 756d 6572 0a77  , the consumer.w
-0001b900: 696c 6c20 6e65 6564 2074 6f20 6265 2072  ill need to be r
-0001b910: 6573 7461 7274 6564 2e0a 0a0a 2323 2043  estarted....## C
-0001b920: 6f6e 7472 6962 7574 6f72 730a 0a23 2323  ontributors..###
-0001b930: 2049 6e73 7461 6c6c 2050 6f65 7472 790a   Install Poetry.
-0001b940: 0a54 6865 2066 6972 7374 2074 6869 6e67  .The first thing
-0001b950: 2069 7320 746f 2063 6865 636b 2079 6f75   is to check you
-0001b960: 2068 6176 6520 506f 6574 7279 2069 6e73   have Poetry ins
-0001b970: 7461 6c6c 6564 2e0a 0a20 2020 2024 2070  talled...    $ p
-0001b980: 6f65 7472 7920 2d2d 7665 7273 696f 6e0a  oetry --version.
-0001b990: 0a49 6620 796f 7520 646f 6e27 742c 2074  .If you don't, t
-0001b9a0: 6865 6e20 706c 6561 7365 205b 696e 7374  hen please [inst
-0001b9b0: 616c 6c20 506f 6574 7279 5d28 6874 7470  all Poetry](http
-0001b9c0: 733a 2f2f 7079 7468 6f6e 2d70 6f65 7472  s://python-poetr
-0001b9d0: 792e 6f72 672f 646f 6373 2f23 696e 7374  y.org/docs/#inst
-0001b9e0: 616c 6c69 6e67 2d77 6974 682d 7468 652d  alling-with-the-
-0001b9f0: 6f66 6669 6369 616c 2d69 6e73 7461 6c6c  official-install
-0001ba00: 6572 292e 0a0a 2020 2020 2420 6375 726c  er)...    $ curl
-0001ba10: 202d 7353 4c20 6874 7470 733a 2f2f 696e   -sSL https://in
-0001ba20: 7374 616c 6c2e 7079 7468 6f6e 2d70 6f65  stall.python-poe
-0001ba30: 7472 792e 6f72 6720 7c20 7079 7468 6f6e  try.org | python
-0001ba40: 3320 2d0a 0a49 7420 7769 6c6c 2068 656c  3 -..It will hel
-0001ba50: 7020 746f 206d 616b 6520 7375 7265 2050  p to make sure P
-0001ba60: 6f65 7472 7927 7320 6269 6e20 6469 7265  oetry's bin dire
-0001ba70: 6374 6f72 7920 6973 2069 6e20 796f 7572  ctory is in your
-0001ba80: 2060 5041 5448 6020 656e 7669 726f 6e6d   `PATH` environm
-0001ba90: 656e 7420 7661 7269 6162 6c65 2e0a 0a42  ent variable...B
-0001baa0: 7574 2069 6e20 616e 7920 6361 7365 2c20  ut in any case, 
-0001bab0: 6d61 6b65 2073 7572 6520 796f 7520 6b6e  make sure you kn
-0001bac0: 6f77 2074 6865 2070 6174 6820 746f 2074  ow the path to t
-0001bad0: 6865 2060 706f 6574 7279 6020 6578 6563  he `poetry` exec
-0001bae0: 7574 6162 6c65 2e20 5468 6520 506f 6574  utable. The Poet
-0001baf0: 7279 0a69 6e73 7461 6c6c 6572 2074 656c  ry.installer tel
-0001bb00: 6c73 2079 6f75 2077 6865 7265 2069 7420  ls you where it 
-0001bb10: 6861 7320 6265 656e 2069 6e73 7461 6c6c  has been install
-0001bb20: 6564 2c20 616e 6420 686f 7720 746f 2063  ed, and how to c
-0001bb30: 6f6e 6669 6775 7265 2079 6f75 7220 7368  onfigure your sh
-0001bb40: 656c 6c2e 0a0a 506c 6561 7365 2072 6566  ell...Please ref
-0001bb50: 6572 2074 6f20 7468 6520 5b50 6f65 7472  er to the [Poetr
-0001bb60: 7920 646f 6373 5d28 6874 7470 733a 2f2f  y docs](https://
-0001bb70: 7079 7468 6f6e 2d70 6f65 7472 792e 6f72  python-poetry.or
-0001bb80: 672f 646f 6373 2f29 2066 6f72 2067 7569  g/docs/) for gui
-0001bb90: 6461 6e63 6520 6f6e 0a75 7369 6e67 2050  dance on.using P
-0001bba0: 6f65 7472 792e 0a0a 2323 2320 5365 7475  oetry...### Setu
-0001bbb0: 7020 666f 7220 5079 4368 6172 6d20 7573  p for PyCharm us
-0001bbc0: 6572 730a 0a59 6f75 2063 616e 2065 6173  ers..You can eas
-0001bbd0: 696c 7920 6f62 7461 696e 2074 6865 2070  ily obtain the p
-0001bbe0: 726f 6a65 6374 2066 696c 6573 2075 7369  roject files usi
-0001bbf0: 6e67 2050 7943 6861 726d 2028 6d65 6e75  ng PyCharm (menu
-0001bc00: 2022 4769 7420 3e20 436c 6f6e 652e 2e2e   "Git > Clone...
-0001bc10: 2229 2e0a 5079 4368 6172 6d20 7769 6c6c  ")..PyCharm will
-0001bc20: 2074 6865 6e20 7573 7561 6c6c 7920 7072   then usually pr
-0001bc30: 6f6d 7074 2079 6f75 2074 6f20 6f70 656e  ompt you to open
-0001bc40: 2074 6865 2070 726f 6a65 6374 2e0a 0a4f   the project...O
-0001bc50: 7065 6e20 7468 6520 7072 6f6a 6563 7420  pen the project 
-0001bc60: 696e 2061 206e 6577 2077 696e 646f 772e  in a new window.
-0001bc70: 2050 7943 6861 726d 2077 696c 6c20 7468   PyCharm will th
-0001bc80: 656e 2075 7375 616c 6c79 2070 726f 6d70  en usually promp
-0001bc90: 7420 796f 7520 746f 2063 7265 6174 650a  t you to create.
-0001bca0: 6120 6e65 7720 7669 7274 7561 6c20 656e  a new virtual en
-0001bcb0: 7669 726f 6e6d 656e 742e 0a0a 4372 6561  vironment...Crea
-0001bcc0: 7465 2061 206e 6577 2050 6f65 7472 7920  te a new Poetry 
-0001bcd0: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
-0001bce0: 656e 7420 666f 7220 7468 6520 7072 6f6a  ent for the proj
-0001bcf0: 6563 742e 2049 6620 5079 4368 6172 6d20  ect. If PyCharm 
-0001bd00: 646f 6573 6e27 7420 616c 7265 6164 790a  doesn't already.
-0001bd10: 6b6e 6f77 2077 6865 7265 2079 6f75 7220  know where your 
-0001bd20: 6070 6f65 7472 7960 2065 7865 6375 7461  `poetry` executa
-0001bd30: 626c 6520 6973 2c20 7468 656e 2073 6574  ble is, then set
-0001bd40: 2074 6865 2070 6174 6820 746f 2079 6f75   the path to you
-0001bd50: 7220 6070 6f65 7472 7960 2065 7865 6375  r `poetry` execu
-0001bd60: 7461 626c 650a 696e 2074 6865 2022 4e65  table.in the "Ne
-0001bd70: 7720 506f 6574 7279 2045 6e76 6972 6f6e  w Poetry Environ
-0001bd80: 6d65 6e74 2220 666f 726d 2069 6e70 7574  ment" form input
-0001bd90: 2066 6965 6c64 206c 6162 656c 6c65 6420   field labelled 
-0001bda0: 2250 6f65 7472 7920 6578 6563 7574 6162  "Poetry executab
-0001bdb0: 6c65 222e 2049 6e20 7468 650a 224e 6577  le". In the."New
-0001bdc0: 2050 6f65 7472 7920 456e 7669 726f 6e6d   Poetry Environm
-0001bdd0: 656e 7422 2066 6f72 6d2c 2079 6f75 2077  ent" form, you w
-0001bde0: 696c 6c20 616c 736f 2068 6176 6520 7468  ill also have th
-0001bdf0: 6520 6f70 706f 7274 756e 6974 7920 746f  e opportunity to
-0001be00: 2073 656c 6563 7420 7768 6963 680a 5079   select which.Py
-0001be10: 7468 6f6e 2065 7865 6375 7461 626c 6520  thon executable 
-0001be20: 7769 6c6c 2062 6520 7573 6564 2062 7920  will be used by 
-0001be30: 7468 6520 7669 7274 7561 6c20 656e 7669  the virtual envi
-0001be40: 726f 6e6d 656e 742e 0a0a 5079 4368 6172  ronment...PyChar
-0001be50: 6d20 7769 6c6c 2074 6865 6e20 6372 6561  m will then crea
-0001be60: 7465 2061 206e 6577 2050 6f65 7472 7920  te a new Poetry 
-0001be70: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
-0001be80: 656e 7420 666f 7220 796f 7572 2070 726f  ent for your pro
-0001be90: 6a65 6374 2c20 7573 696e 670a 6120 7061  ject, using.a pa
-0001bea0: 7274 6963 756c 6172 2076 6572 7369 6f6e  rticular version
-0001beb0: 206f 6620 5079 7468 6f6e 2c20 616e 6420   of Python, and 
-0001bec0: 616c 736f 2069 6e73 7461 6c6c 2069 6e74  also install int
-0001bed0: 6f20 7468 6973 2076 6972 7475 616c 2065  o this virtual e
-0001bee0: 6e76 6972 6f6e 6d65 6e74 2074 6865 0a70  nvironment the.p
-0001bef0: 726f 6a65 6374 2773 2070 6163 6b61 6765  roject's package
-0001bf00: 2064 6570 656e 6465 6e63 6965 7320 6163   dependencies ac
-0001bf10: 636f 7264 696e 6720 746f 2074 6865 2070  cording to the p
-0001bf20: 726f 6a65 6374 2773 2060 706f 6574 7279  roject's `poetry
-0001bf30: 2e6c 6f63 6b60 2066 696c 652e 0a0a 596f  .lock` file...Yo
-0001bf40: 7520 6361 6e20 6164 6420 6469 6666 6572  u can add differ
-0001bf50: 656e 7420 506f 6574 7279 2065 6e76 6972  ent Poetry envir
-0001bf60: 6f6e 6d65 6e74 7320 666f 7220 6469 6666  onments for diff
-0001bf70: 6572 656e 7420 5079 7468 6f6e 2076 6572  erent Python ver
-0001bf80: 7369 6f6e 732c 2061 6e64 2073 7769 7463  sions, and switc
-0001bf90: 680a 6265 7477 6565 6e20 7468 656d 2075  h.between them u
-0001bfa0: 7369 6e67 2074 6865 2022 5079 7468 6f6e  sing the "Python
-0001bfb0: 2049 6e74 6572 7072 6574 6572 2220 7365   Interpreter" se
-0001bfc0: 7474 696e 6773 206f 6620 5079 4368 6172  ttings of PyChar
-0001bfd0: 6d2e 2049 6620 796f 7520 7761 6e74 2074  m. If you want t
-0001bfe0: 6f20 7573 650a 6120 7665 7273 696f 6e20  o use.a version 
-0001bff0: 6f66 2050 7974 686f 6e20 7468 6174 2069  of Python that i
-0001c000: 736e 2774 2069 6e73 7461 6c6c 6564 2c20  sn't installed, 
-0001c010: 6569 7468 6572 2075 7365 2079 6f75 7220  either use your 
-0001c020: 6661 766f 7572 6974 6520 7061 636b 6167  favourite packag
-0001c030: 6520 6d61 6e61 6765 722c 0a6f 7220 696e  e manager,.or in
-0001c040: 7374 616c 6c20 5079 7468 6f6e 2062 7920  stall Python by 
-0001c050: 646f 776e 6c6f 6164 696e 6720 616e 2069  downloading an i
-0001c060: 6e73 7461 6c6c 6572 2066 6f72 2072 6563  nstaller for rec
-0001c070: 656e 7420 7665 7273 696f 6e73 206f 6620  ent versions of 
-0001c080: 5079 7468 6f6e 2064 6972 6563 746c 790a  Python directly.
-0001c090: 6672 6f6d 2074 6865 205b 5079 7468 6f6e  from the [Python
-0001c0a0: 2077 6562 7369 7465 5d28 6874 7470 733a   website](https:
-0001c0b0: 2f2f 7777 772e 7079 7468 6f6e 2e6f 7267  //www.python.org
-0001c0c0: 2f64 6f77 6e6c 6f61 6473 2f29 2e0a 0a4f  /downloads/)...O
-0001c0d0: 6e63 6520 7072 6f6a 6563 7420 6465 7065  nce project depe
-0001c0e0: 6e64 656e 6369 6573 2068 6176 6520 6265  ndencies have be
-0001c0f0: 656e 2069 6e73 7461 6c6c 6564 2c20 796f  en installed, yo
-0001c100: 7520 7368 6f75 6c64 2062 6520 6162 6c65  u should be able
-0001c110: 2074 6f20 7275 6e20 7465 7374 730a 6672   to run tests.fr
-0001c120: 6f6d 2077 6974 6869 6e20 5079 4368 6172  om within PyChar
-0001c130: 6d20 2872 6967 6874 2d63 6c69 636b 206f  m (right-click o
-0001c140: 6e20 7468 6520 6074 6573 7473 6020 666f  n the `tests` fo
-0001c150: 6c64 6572 2061 6e64 2073 656c 6563 7420  lder and select 
-0001c160: 7468 6520 2752 756e 2720 6f70 7469 6f6e  the 'Run' option
-0001c170: 292e 0a0a 4265 6361 7573 6520 6f66 2061  )...Because of a
-0001c180: 2063 6f6e 666c 6963 7420 6265 7477 6565   conflict betwee
-0001c190: 6e20 7079 7465 7374 2061 6e64 2050 7943  n pytest and PyC
-0001c1a0: 6861 726d 2773 2064 6562 7567 6765 7220  harm's debugger 
-0001c1b0: 616e 6420 7468 6520 636f 7665 7261 6765  and the coverage
-0001c1c0: 2074 6f6f 6c2c 0a79 6f75 206d 6179 206e   tool,.you may n
-0001c1d0: 6565 6420 746f 2061 6464 2060 602d 2d6e  eed to add ``--n
-0001c1e0: 6f2d 636f 7660 6020 6173 2061 6e20 6f70  o-cov`` as an op
-0001c1f0: 7469 6f6e 2074 6f20 7468 6520 7465 7374  tion to the test
-0001c200: 2072 756e 6e65 7220 7465 6d70 6c61 7465   runner template
-0001c210: 2e20 416c 7465 726e 6174 6976 656c 792c  . Alternatively,
-0001c220: 0a6a 7573 7420 7573 6520 7468 6520 5079  .just use the Py
-0001c230: 7468 6f6e 2053 7461 6e64 6172 6420 4c69  thon Standard Li
-0001c240: 6272 6172 7927 7320 6060 756e 6974 7465  brary's ``unitte
-0001c250: 7374 6060 206d 6f64 756c 652e 0a0a 596f  st`` module...Yo
-0001c260: 7520 7368 6f75 6c64 2061 6c73 6f20 6265  u should also be
-0001c270: 2061 626c 6520 746f 206f 7065 6e20 6120   able to open a 
-0001c280: 7465 726d 696e 616c 2077 696e 646f 7720  terminal window 
-0001c290: 696e 2050 7943 6861 726d 2c20 616e 6420  in PyCharm, and 
-0001c2a0: 7275 6e20 7468 6520 7072 6f6a 6563 7427  run the project'
-0001c2b0: 730a 4d61 6b65 6669 6c65 2063 6f6d 6d61  s.Makefile comma
-0001c2c0: 6e64 7320 6672 6f6d 2074 6865 2063 6f6d  nds from the com
-0001c2d0: 6d61 6e64 206c 696e 6520 2873 6565 2062  mand line (see b
-0001c2e0: 656c 6f77 292e 0a0a 2323 2320 5365 7475  elow)...### Setu
-0001c2f0: 7020 6672 6f6d 2063 6f6d 6d61 6e64 206c  p from command l
-0001c300: 696e 650a 0a4f 6274 6169 6e20 7468 6520  ine..Obtain the 
-0001c310: 7072 6f6a 6563 7420 6669 6c65 732c 2075  project files, u
-0001c320: 7369 6e67 2047 6974 206f 7220 7375 6974  sing Git or suit
-0001c330: 6162 6c65 2061 6c74 6572 6e61 7469 7665  able alternative
-0001c340: 2e0a 0a49 6e20 6120 7465 726d 696e 616c  ...In a terminal
-0001c350: 2061 7070 6c69 6361 7469 6f6e 2c20 6368   application, ch
-0001c360: 616e 6765 2079 6f75 7220 6375 7272 656e  ange your curren
-0001c370: 7420 776f 726b 696e 6720 6469 7265 6374  t working direct
-0001c380: 6f72 790a 746f 2074 6865 2072 6f6f 7420  ory.to the root 
-0001c390: 666f 6c64 6572 206f 6620 7468 6520 7072  folder of the pr
-0001c3a0: 6f6a 6563 7420 6669 6c65 732e 2054 6865  oject files. The
-0001c3b0: 7265 2073 686f 756c 6420 6265 2061 204d  re should be a M
-0001c3c0: 616b 6566 696c 650a 696e 2074 6869 7320  akefile.in this 
-0001c3d0: 666f 6c64 6572 2e0a 0a55 7365 2074 6865  folder...Use the
-0001c3e0: 204d 616b 6566 696c 6520 746f 2063 7265   Makefile to cre
-0001c3f0: 6174 6520 6120 6e65 7720 506f 6574 7279  ate a new Poetry
-0001c400: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
-0001c410: 6d65 6e74 2066 6f72 2074 6865 0a70 726f  ment for the.pro
-0001c420: 6a65 6374 2061 6e64 2069 6e73 7461 6c6c  ject and install
-0001c430: 2074 6865 2070 726f 6a65 6374 2773 2070   the project's p
-0001c440: 6163 6b61 6765 2064 6570 656e 6465 6e63  ackage dependenc
-0001c450: 6965 7320 696e 746f 2069 742c 0a75 7369  ies into it,.usi
-0001c460: 6e67 2074 6865 2066 6f6c 6c6f 7769 6e67  ng the following
-0001c470: 2063 6f6d 6d61 6e64 2e0a 0a20 2020 2024   command...    $
-0001c480: 206d 616b 6520 696e 7374 616c 6c2d 7061   make install-pa
-0001c490: 636b 6167 6573 0a0a 4974 2773 2061 6c73  ckages..It's als
-0001c4a0: 6f20 706f 7373 6962 6c65 2074 6f20 616c  o possible to al
-0001c4b0: 736f 2069 6e73 7461 6c6c 2074 6865 2070  so install the p
-0001c4c0: 726f 6a65 6374 2069 6e20 2765 6469 7461  roject in 'edita
-0001c4d0: 626c 6520 6d6f 6465 272e 0a0a 2020 2020  ble mode'...    
-0001c4e0: 2420 6d61 6b65 2069 6e73 7461 6c6c 0a0a  $ make install..
-0001c4f0: 506c 6561 7365 206e 6f74 652c 2069 6620  Please note, if 
-0001c500: 796f 7520 6372 6561 7465 2074 6865 2076  you create the v
-0001c510: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
-0001c520: 6e74 2069 6e20 7468 6973 2077 6179 2c20  nt in this way, 
-0001c530: 616e 6420 7468 656e 2074 7279 2074 6f0a  and then try to.
-0001c540: 6f70 656e 2074 6865 2070 726f 6a65 6374  open the project
-0001c550: 2069 6e20 5079 4368 6172 6d20 616e 6420   in PyCharm and 
-0001c560: 636f 6e66 6967 7572 6520 7468 6520 7072  configure the pr
-0001c570: 6f6a 6563 7420 746f 2075 7365 2074 6869  oject to use thi
-0001c580: 7320 7669 7274 7561 6c0a 656e 7669 726f  s virtual.enviro
-0001c590: 6e6d 656e 7420 6173 2061 6e20 2245 7869  nment as an "Exi
-0001c5a0: 7374 696e 6720 506f 6574 7279 2045 6e76  sting Poetry Env
-0001c5b0: 6972 6f6e 6d65 6e74 222c 2050 7943 6861  ironment", PyCha
-0001c5c0: 726d 2073 6f6d 6574 696d 6573 2068 6173  rm sometimes has
-0001c5d0: 2073 6f6d 650a 6973 7375 6573 2028 646f   some.issues (do
-0001c5e0: 6e27 7420 6b6e 6f77 2077 6879 2920 7768  n't know why) wh
-0001c5f0: 6963 6820 6d69 6768 7420 6265 2070 726f  ich might be pro
-0001c600: 626c 656d 6174 6963 2e20 4966 2079 6f75  blematic. If you
-0001c610: 2065 6e63 6f75 6e74 6572 2073 7563 680a   encounter such.
-0001c620: 6973 7375 6573 2c20 796f 7520 6361 6e20  issues, you can 
-0001c630: 7265 736f 6c76 6520 7468 6573 6520 6973  resolve these is
-0001c640: 7375 6573 2062 7920 6465 6c65 7469 6e67  sues by deleting
-0001c650: 2074 6865 2076 6972 7475 616c 2065 6e76   the virtual env
-0001c660: 6972 6f6e 6d65 6e74 0a61 6e64 2063 7265  ironment.and cre
-0001c670: 6174 696e 6720 7468 6520 506f 6574 7279  ating the Poetry
-0001c680: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
-0001c690: 6d65 6e74 2075 7369 6e67 2050 7943 6861  ment using PyCha
-0001c6a0: 726d 2028 7365 6520 6162 6f76 6529 2e0a  rm (see above)..
-0001c6b0: 0a23 2323 2050 726f 6a65 6374 204d 616b  .### Project Mak
-0001c6c0: 6566 696c 6520 636f 6d6d 616e 6473 0a0a  efile commands..
-0001c6d0: 596f 7520 6361 6e20 7374 6172 7420 4576  You can start Ev
-0001c6e0: 656e 7453 746f 7265 4442 2075 7369 6e67  entStoreDB using
-0001c6f0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2063   the following c
-0001c700: 6f6d 6d61 6e64 2e0a 0a20 2020 2024 206d  ommand...    $ m
-0001c710: 616b 6520 7374 6172 742d 6576 656e 7473  ake start-events
-0001c720: 746f 7265 6462 0a0a 596f 7520 6361 6e20  toredb..You can 
-0001c730: 7275 6e20 7465 7374 7320 7573 696e 6720  run tests using 
-0001c740: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
-0001c750: 6d6d 616e 6420 286e 6565 6473 2045 7665  mmand (needs Eve
-0001c760: 6e74 5374 6f72 6544 4220 746f 2062 6520  ntStoreDB to be 
-0001c770: 7275 6e6e 696e 6729 2e0a 0a20 2020 2024  running)...    $
-0001c780: 206d 616b 6520 7465 7374 0a0a 596f 7520   make test..You 
-0001c790: 6361 6e20 7374 6f70 2045 7665 6e74 5374  can stop EventSt
-0001c7a0: 6f72 6544 4220 7573 696e 6720 7468 6520  oreDB using the 
-0001c7b0: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
-0001c7c0: 642e 0a0a 2020 2020 2420 6d61 6b65 2073  d...    $ make s
-0001c7d0: 746f 702d 6576 656e 7473 746f 7265 6462  top-eventstoredb
-0001c7e0: 0a0a 596f 7520 6361 6e20 6368 6563 6b20  ..You can check 
-0001c7f0: 7468 6520 666f 726d 6174 7469 6e67 206f  the formatting o
-0001c800: 6620 7468 6520 636f 6465 2075 7369 6e67  f the code using
-0001c810: 2074 6865 2066 6f6c 6c6f 7769 6e67 2063   the following c
-0001c820: 6f6d 6d61 6e64 2e0a 0a20 2020 2024 206d  ommand...    $ m
-0001c830: 616b 6520 6c69 6e74 0a0a 596f 7520 6361  ake lint..You ca
-0001c840: 6e20 7265 666f 726d 6174 2074 6865 2063  n reformat the c
-0001c850: 6f64 6520 7573 696e 6720 7468 6520 666f  ode using the fo
-0001c860: 6c6c 6f77 696e 6720 636f 6d6d 616e 642e  llowing command.
-0001c870: 0a0a 2020 2020 2420 6d61 6b65 2066 6d74  ..    $ make fmt
-0001c880: 0a0a 5465 7374 7320 6265 6c6f 6e67 2069  ..Tests belong i
-0001c890: 6e20 602e 2f74 6573 7473 602e 2043 6f64  n `./tests`. Cod
-0001c8a0: 652d 756e 6465 722d 7465 7374 2062 656c  e-under-test bel
-0001c8b0: 6f6e 6773 2069 6e20 602e 2f65 7364 6263  ongs in `./esdbc
-0001c8c0: 6c69 656e 7460 2e0a 0a45 6469 7420 7061  lient`...Edit pa
-0001c8d0: 636b 6167 6520 6465 7065 6e64 656e 6369  ckage dependenci
-0001c8e0: 6573 2069 6e20 6070 7970 726f 6a65 6374  es in `pyproject
-0001c8f0: 2e74 6f6d 6c60 2e20 5570 6461 7465 2069  .toml`. Update i
-0001c900: 6e73 7461 6c6c 6564 2070 6163 6b61 6765  nstalled package
-0001c910: 7320 2861 6e64 2074 6865 0a60 706f 6574  s (and the.`poet
-0001c920: 7279 2e6c 6f63 6b60 2066 696c 6529 2075  ry.lock` file) u
-0001c930: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
-0001c940: 6e67 2063 6f6d 6d61 6e64 2e0a 0a20 2020  ng command...   
-0001c950: 2024 206d 616b 6520 7570 6461 7465 2d70   $ make update-p
-0001c960: 6163 6b61 6765 730a                      ackages.
+00005930: 2020 2020 2020 2020 207c 2054 6869 7320           | This 
+00005940: 7661 6c75 6520 6973 2063 7572 7265 6e74  value is current
+00005950: 6c79 2069 676e 6f72 6564 2e20 2020 2020  ly ignored.     
+00005960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000059a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000059b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000059c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000059d0: 2020 2020 2020 2020 2020 2020 207c 0a7c               |.|
+000059e0: 2043 6f6e 6e65 6374 696f 6e4e 616d 6520   ConnectionName 
+000059f0: 2020 2020 207c 2073 7472 696e 6720 2864       | string (d
+00005a00: 6566 6175 6c74 3a20 6175 746f 2d67 656e  efault: auto-gen
+00005a10: 6572 6174 6564 2076 6572 7369 6f6e 2d34  erated version-4
+00005a20: 2055 5549 4429 2020 2020 2020 2020 2020   UUID)          
+00005a30: 2020 2020 2020 2020 2020 2020 207c 2053               | S
+00005a40: 656e 7420 696e 2063 616c 6c20 6d65 7461  ent in call meta
+00005a50: 6461 7461 2066 6f72 2065 7665 7279 2063  data for every c
+00005a60: 616c 6c2c 2074 6f20 6964 656e 7469 6679  all, to identify
+00005a70: 2074 6865 2063 6c69 656e 7420 746f 2074   the client to t
+00005a80: 6865 2063 6c75 7374 6572 2e20 2020 2020  he cluster.     
+00005a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ae0: 207c 0a7c 204e 6f64 6550 7265 6665 7265   |.| NodePrefere
+00005af0: 6e63 6520 2020 2020 207c 2022 6c65 6164  nce      | "lead
+00005b00: 6572 222c 2022 666f 6c6c 6f77 6572 222c  er", "follower",
+00005b10: 2022 7265 6164 6f6e 6c79 7265 706c 6963   "readonlyreplic
+00005b20: 6122 2c20 2272 616e 646f 6d22 2028 6465  a", "random" (de
+00005b30: 6661 756c 743a 2022 6c65 6164 6572 2229  fault: "leader")
+00005b40: 207c 2054 6865 206e 6f64 6520 7374 6174   | The node stat
+00005b50: 6520 7072 6566 6572 7265 6420 6279 2074  e preferred by t
+00005b60: 6865 2063 6c69 656e 742e 2054 6865 2063  he client. The c
+00005b70: 6c69 656e 7420 7769 6c6c 2073 656c 6563  lient will selec
+00005b80: 7420 6120 6e6f 6465 2066 726f 6d20 7468  t a node from th
+00005b90: 6520 636c 7573 7465 7220 696e 666f 2072  e cluster info r
+00005ba0: 6563 6569 7665 6420 6672 6f6d 2074 6865  eceived from the
+00005bb0: 2047 6f73 7369 7020 4150 4920 6163 636f   Gossip API acco
+00005bc0: 7264 696e 6720 746f 2074 6869 7320 7072  rding to this pr
+00005bd0: 6566 6572 656e 6365 2e20 2020 2020 2020  eference.       
+00005be0: 2020 2020 207c 0a7c 2044 6566 6175 6c74       |.| Default
+00005bf0: 4465 6164 6c69 6e65 2020 2020 207c 2069  Deadline     | i
+00005c00: 6e74 6567 6572 2028 6465 6661 756c 743a  nteger (default:
+00005c10: 2060 4e6f 6e65 6029 2020 2020 2020 2020   `None`)        
+00005c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c40: 2020 2020 207c 2054 6865 2064 6566 6175       | The defau
+00005c50: 6c74 2076 616c 7565 2028 696e 2073 6563  lt value (in sec
+00005c60: 6f6e 6473 2920 6f66 2074 6865 2060 7469  onds) of the `ti
+00005c70: 6d65 6f75 7460 2061 7267 756d 656e 7420  meout` argument 
+00005c80: 6f66 2063 6c69 656e 7420 2277 7269 7465  of client "write
+00005c90: 2220 6d65 7468 6f64 7320 7375 6368 2061  " methods such a
+00005ca0: 7320 6061 7070 656e 645f 746f 5f73 7472  s `append_to_str
+00005cb0: 6561 6d28 2960 2e20 2020 2020 2020 2020  eam()`.         
+00005cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ce0: 2020 2020 2020 2020 207c 0a7c 2047 6f73           |.| Gos
+00005cf0: 7369 7054 696d 656f 7574 2020 2020 2020  sipTimeout      
+00005d00: 207c 2069 6e74 6567 6572 2028 6465 6661   | integer (defa
+00005d10: 756c 743a 2035 2920 2020 2020 2020 2020  ult: 5)         
+00005d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d40: 2020 2020 2020 2020 207c 2054 6865 2064           | The d
+00005d50: 6566 6175 6c74 2076 616c 7565 2028 696e  efault value (in
+00005d60: 2073 6563 6f6e 6473 2920 6f66 2074 6865   seconds) of the
+00005d70: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
+00005d80: 656e 7420 6f66 2067 6f73 7369 7020 7265  ent of gossip re
+00005d90: 6164 206d 6574 686f 6473 2c20 7375 6368  ad methods, such
+00005da0: 2061 7320 6072 6561 645f 676f 7373 6970   as `read_gossip
+00005db0: 2829 602e 2020 2020 2020 2020 2020 2020  ()`.            
+00005dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005de0: 2020 2020 2020 2020 2020 2020 207c 0a7c               |.|
+00005df0: 204d 6178 4469 7363 6f76 6572 4174 7465   MaxDiscoverAtte
+00005e00: 6d70 7473 207c 2069 6e74 6567 6572 2028  mpts | integer (
+00005e10: 6465 6661 756c 743a 2031 3029 2020 2020  default: 10)    
+00005e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005e40: 2020 2020 2020 2020 2020 2020 207c 2054               | T
+00005e50: 6865 206e 756d 6265 7220 6f66 2061 7474  he number of att
+00005e60: 656d 7074 7320 746f 2072 6561 6420 676f  empts to read go
+00005e70: 7373 6970 2077 6865 6e20 636f 6e6e 6563  ssip when connec
+00005e80: 7469 6e67 206f 7220 7265 636f 6e6e 6563  ting or reconnec
+00005e90: 7469 6e67 2074 6f20 6120 636c 7573 7465  ting to a cluste
+00005ea0: 7220 6d65 6d62 6572 2e20 2020 2020 2020  r member.       
+00005eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ef0: 207c 0a7c 2044 6973 636f 7665 7279 496e   |.| DiscoveryIn
+00005f00: 7465 7276 616c 2020 207c 2069 6e74 6567  terval   | integ
+00005f10: 6572 2028 6465 6661 756c 743a 2031 3030  er (default: 100
+00005f20: 2920 2020 2020 2020 2020 2020 2020 2020  )               
+00005f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f50: 207c 2048 6f77 206c 6f6e 6720 746f 2077   | How long to w
+00005f60: 6169 7420 2869 6e20 6d69 6c6c 6973 6563  ait (in millisec
+00005f70: 6f6e 6473 2920 6265 7477 6565 6e20 676f  onds) between go
+00005f80: 7373 6970 2072 6574 7269 6573 2e20 2020  ssip retries.   
+00005f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ff0: 2020 2020 207c 0a7c 204b 6565 7041 6c69       |.| KeepAli
+00006000: 7665 496e 7465 7276 616c 2020 207c 2069  veInterval   | i
+00006010: 6e74 6567 6572 2028 6465 6661 756c 743a  nteger (default:
+00006020: 2060 4e6f 6e65 6029 2020 2020 2020 2020   `None`)        
+00006030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006050: 2020 2020 207c 2054 6865 2076 616c 7565       | The value
+00006060: 206f 6620 7468 6520 2267 7270 632e 6b65   of the "grpc.ke
+00006070: 6570 616c 6976 655f 6d73 2220 6752 5043  epalive_ms" gRPC
+00006080: 2063 6861 6e6e 656c 206f 7074 696f 6e2e   channel option.
+00006090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060f0: 2020 2020 2020 2020 207c 0a7c 204b 6565           |.| Kee
+00006100: 7041 6c69 7665 5469 6d65 6f75 7420 2020  pAliveTimeout   
+00006110: 207c 2069 6e74 6567 6572 2028 6465 6661   | integer (defa
+00006120: 756c 743a 2060 4e6f 6e65 6029 2020 2020  ult: `None`)    
+00006130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006150: 2020 2020 2020 2020 207c 2054 6865 2076           | The v
+00006160: 616c 7565 206f 6620 7468 6520 2267 7270  alue of the "grp
+00006170: 632e 6b65 6570 616c 6976 655f 7469 6d65  c.keepalive_time
+00006180: 6f75 745f 6d73 2220 6752 5043 2063 6861  out_ms" gRPC cha
+00006190: 6e6e 656c 206f 7074 696f 6e2e 2020 2020  nnel option.    
+000061a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061f0: 2020 2020 2020 2020 2020 2020 207c 0a0a               |..
+00006200: 0a23 2323 2045 7861 6d70 6c65 733c 6120  .### Examples<a 
+00006210: 6964 3d22 6578 616d 706c 6573 223e 3c2f  id="examples"></
+00006220: 613e 0a0a 4865 7265 2061 7265 2073 6f6d  a>..Here are som
+00006230: 6520 6578 616d 706c 6573 206f 6620 4576  e examples of Ev
+00006240: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
+00006250: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+00006260: 732e 0a0a 5468 6520 666f 6c6c 6f77 696e  s...The followin
+00006270: 6720 5552 4920 7769 6c6c 2063 6175 7365  g URI will cause
+00006280: 2074 6865 2063 6c69 656e 7420 746f 2063   the client to c
+00006290: 6f6e 6e65 6374 2074 6f2c 2061 6e64 2067  onnect to, and g
+000062a0: 6574 0a63 6c75 7374 6572 2069 6e66 6f2c  et.cluster info,
+000062b0: 2066 726f 6d20 2273 6563 7572 6522 2073   from "secure" s
+000062c0: 6572 7665 7220 736f 636b 6574 2060 6c6f  erver socket `lo
+000062d0: 6361 6c68 6f73 743a 3231 3133 602e 2041  calhost:2113`. A
+000062e0: 6e64 0a74 6865 6e20 746f 2063 6f6e 6e65  nd.then to conne
+000062f0: 6374 2074 6f20 6120 226c 6561 6465 7222  ct to a "leader"
+00006300: 206e 6f64 652e 2041 6e64 2061 6c73 6f20   node. And also 
+00006310: 746f 2075 7365 2022 6164 6d69 6e22 2061  to use "admin" a
+00006320: 6e64 0a22 6368 616e 6765 6974 2220 6173  nd."changeit" as
+00006330: 2074 6865 2075 7365 726e 616d 6520 616e   the username an
+00006340: 6420 7061 7373 776f 7264 2077 6865 6e20  d password when 
+00006350: 6d61 6b69 6e67 2063 616c 6c73 2074 6f0a  making calls to.
+00006360: 4576 656e 7453 746f 7265 4442 2041 5049  EventStoreDB API
+00006370: 206d 6574 686f 6473 2e0a 0a20 2020 2065   methods...    e
+00006380: 7364 623a 2f2f 6164 6d69 6e3a 6368 616e  sdb://admin:chan
+00006390: 6765 6974 406c 6f63 616c 686f 7374 3a32  geit@localhost:2
+000063a0: 3131 330a 0a0a 5468 6520 666f 6c6c 6f77  113...The follow
+000063b0: 696e 6720 5552 4920 7769 6c6c 2063 6175  ing URI will cau
+000063c0: 7365 2074 6865 2063 6c69 656e 7420 746f  se the client to
+000063d0: 2067 6574 2063 6c75 7374 6572 2069 6e66   get cluster inf
+000063e0: 6f20 6672 6f6d 0a22 696e 7365 6375 7265  o from."insecure
+000063f0: 2220 7365 7276 6572 2073 6f63 6b65 7420  " server socket 
+00006400: 3132 372e 302e 302e 313a 3231 3133 2e20  127.0.0.1:2113. 
+00006410: 2041 6e64 2074 6865 6e20 746f 2063 6f6e   And then to con
+00006420: 6e65 6374 2074 6f0a 6120 226c 6561 6465  nect to.a "leade
+00006430: 7222 206e 6f64 652e 0a0a 2020 2020 6573  r" node...    es
+00006440: 6462 3a2f 2f31 3237 2e30 2e30 2e31 3a32  db://127.0.0.1:2
+00006450: 3131 333f 546c 733d 6661 6c73 650a 0a0a  113?Tls=false...
+00006460: 5468 6520 666f 6c6c 6f77 696e 6720 5552  The following UR
+00006470: 4920 7769 6c6c 2063 6175 7365 2074 6865  I will cause the
+00006480: 2063 6c69 656e 7420 746f 2067 6574 2063   client to get c
+00006490: 6c75 7374 6572 2069 6e66 6f20 6672 6f6d  luster info from
+000064a0: 0a61 6464 7265 7373 6573 2069 6e20 444e  .addresses in DN
+000064b0: 5320 2741 2720 7265 636f 7264 7320 666f  S 'A' records fo
+000064c0: 7220 636c 7573 7465 7231 2e65 7861 6d70  r cluster1.examp
+000064d0: 6c65 2e63 6f6d 2e20 416e 6420 7468 656e  le.com. And then
+000064e0: 0a74 6f20 636f 6e6e 6563 7420 746f 2061  .to connect to a
+000064f0: 2022 6c65 6164 6572 2220 6e6f 6465 2e20   "leader" node. 
+00006500: 416e 6420 7573 6520 6120 6465 6661 756c  And use a defaul
+00006510: 7420 6465 6164 6c69 6e65 206f 6620 350a  t deadline of 5.
+00006520: 7365 636f 6e64 7320 7768 656e 206d 616b  seconds when mak
+00006530: 696e 6720 6361 6c6c 7320 746f 2045 7665  ing calls to Eve
+00006540: 6e74 5374 6f72 6520 4150 4920 2277 7269  ntStore API "wri
+00006550: 7465 2220 6d65 7468 6f64 732e 0a0a 2020  te" methods...  
+00006560: 2020 6573 6462 2b64 6973 636f 7665 723a    esdb+discover:
+00006570: 2f2f 6164 6d69 6e3a 6368 616e 6765 6974  //admin:changeit
+00006580: 4063 6c75 7374 6572 312e 6578 616d 706c  @cluster1.exampl
+00006590: 652e 636f 6d3f 4465 6661 756c 7444 6561  e.com?DefaultDea
+000065a0: 646c 696e 653d 350a 0a0a 5468 6520 666f  dline=5...The fo
+000065b0: 6c6c 6f77 696e 6720 5552 4920 7769 6c6c  llowing URI will
+000065c0: 2063 6175 7365 2074 6865 2063 6c69 656e   cause the clien
+000065d0: 7420 746f 2067 6574 2063 6c75 7374 6572  t to get cluster
+000065e0: 2069 6e66 6f20 6672 6f6d 2065 6974 6865   info from eithe
+000065f0: 720a 6c6f 6361 6c68 6f73 743a 3231 3131  r.localhost:2111
+00006600: 2c20 6f72 206c 6f63 616c 686f 7374 3a32  , or localhost:2
+00006610: 3131 322c 206f 7220 6c6f 6361 6c68 6f73  112, or localhos
+00006620: 743a 3231 3133 2e20 416e 6420 7468 656e  t:2113. And then
+00006630: 2074 6f20 636f 6e6e 6563 740a 746f 2061   to connect.to a
+00006640: 2022 666f 6c6c 6f77 6572 2220 6e6f 6465   "follower" node
+00006650: 2e0a 0a20 2020 2065 7364 623a 2f2f 6164  ...    esdb://ad
+00006660: 6d69 6e3a 6368 616e 6765 6974 406c 6f63  min:changeit@loc
+00006670: 616c 686f 7374 3a32 3131 312c 6c6f 6361  alhost:2111,loca
+00006680: 6c68 6f73 743a 3231 3132 2c6c 6f63 616c  lhost:2112,local
+00006690: 686f 7374 3a32 3131 333f 4e6f 6465 5072  host:2113?NodePr
+000066a0: 6566 6572 656e 6365 3d66 6f6c 6c6f 7765  eference=followe
+000066b0: 720a 0a0a 5468 6520 666f 6c6c 6f77 696e  r...The followin
+000066c0: 6720 5552 4920 7769 6c6c 2063 6175 7365  g URI will cause
+000066d0: 2074 6865 2063 6c69 656e 7420 746f 2067   the client to g
+000066e0: 6574 2063 6c75 7374 6572 2069 6e66 6f20  et cluster info 
+000066f0: 6672 6f6d 2061 6464 7265 7373 6573 2069  from addresses i
+00006700: 6e0a 444e 5320 2741 2720 7265 636f 7264  n.DNS 'A' record
+00006710: 7320 666f 7220 636c 7573 7465 7231 2e65  s for cluster1.e
+00006720: 7861 6d70 6c65 2e63 6f6d 2e20 416e 6420  xample.com. And 
+00006730: 746f 2063 6f6e 6669 6775 7265 2022 6b65  to configure "ke
+00006740: 6570 2061 6c69 7665 2220 7469 6d65 6f75  ep alive" timeou
+00006750: 740a 616e 6420 696e 7465 7276 616c 2069  t.and interval i
+00006760: 6e20 7468 6520 6752 5043 2063 6861 6e6e  n the gRPC chann
+00006770: 656c 2e0a 0a20 2020 2065 7364 622b 6469  el...    esdb+di
+00006780: 7363 6f76 6572 3a2f 2f61 646d 696e 3a63  scover://admin:c
+00006790: 6861 6e67 6569 7440 636c 7573 7465 7231  hangeit@cluster1
+000067a0: 2e65 7861 6d70 6c65 2e63 6f6d 3f4b 6565  .example.com?Kee
+000067b0: 7041 6c69 7665 496e 7465 7276 616c 3d31  pAliveInterval=1
+000067c0: 3030 3030 264b 6565 7041 6c69 7665 5469  0000&KeepAliveTi
+000067d0: 6d65 6f75 743d 3130 3030 300a 0a0a 506c  meout=10000...Pl
+000067e0: 6561 7365 206e 6f74 652c 2074 6865 2063  ease note, the c
+000067f0: 6c69 656e 7420 6973 2069 6e73 656e 7369  lient is insensi
+00006800: 7469 7665 2074 6f20 7468 6520 6361 7365  tive to the case
+00006810: 206f 6620 6669 656c 6473 2061 6e64 2076   of fields and v
+00006820: 616c 7565 732e 2049 6620 6669 656c 6473  alues. If fields
+00006830: 2061 7265 0a72 6570 6561 7465 6420 696e   are.repeated in
+00006840: 2074 6865 2071 7565 7279 2073 7472 696e   the query strin
+00006850: 672c 2074 6865 2071 7565 7279 2073 7472  g, the query str
+00006860: 696e 6720 7769 6c6c 2062 6520 7061 7273  ing will be pars
+00006870: 6564 2077 6974 686f 7574 2065 7272 6f72  ed without error
+00006880: 2e20 486f 7765 7665 722c 0a74 6865 2063  . However,.the c
+00006890: 6f6e 6e65 6374 696f 6e20 6f70 7469 6f6e  onnection option
+000068a0: 7320 7573 6564 2062 7920 7468 6520 636c  s used by the cl
+000068b0: 6965 6e74 2077 696c 6c20 7573 6520 7468  ient will use th
+000068c0: 6520 7661 6c75 6520 6f66 2074 6865 2066  e value of the f
+000068d0: 6972 7374 2066 6965 6c64 2e20 416c 6c0a  irst field. All.
+000068e0: 7468 6520 6f74 6865 7220 6669 656c 642d  the other field-
+000068f0: 7661 6c75 6573 2069 6e20 7468 6520 7175  values in the qu
+00006900: 6572 7920 7374 7269 6e67 2077 6974 6820  ery string with 
+00006910: 7468 6520 7361 6d65 2066 6965 6c64 206e  the same field n
+00006920: 616d 6520 7769 6c6c 2062 6520 6967 6e6f  ame will be igno
+00006930: 7265 642e 0a46 6965 6c64 7320 7769 7468  red..Fields with
+00006940: 6f75 7420 7661 6c75 6573 2077 696c 6c20  out values will 
+00006950: 616c 736f 2062 6520 6967 6e6f 7265 642e  also be ignored.
+00006960: 0a0a 4966 2074 6865 2063 6c69 656e 7427  ..If the client'
+00006970: 7320 6e6f 6465 2070 7265 6665 7265 6e63  s node preferenc
+00006980: 6520 6973 2022 6c65 6164 6572 2220 616e  e is "leader" an
+00006990: 6420 7468 6520 6e6f 6465 2062 6563 6f6d  d the node becom
+000069a0: 6573 2061 0a22 666f 6c6c 6f77 6572 222c  es a."follower",
+000069b0: 2074 6865 2063 6c69 656e 7420 7769 6c6c   the client will
+000069c0: 2061 7474 656d 7074 2074 6f20 7265 636f   attempt to reco
+000069d0: 6e6e 6563 7420 746f 2074 6865 2063 7572  nnect to the cur
+000069e0: 7265 6e74 206c 6561 6465 7220 7768 656e  rent leader when
+000069f0: 2061 206d 6574 686f 640a 6973 2063 616c   a method.is cal
+00006a00: 6c65 6420 7468 6174 2065 7870 6563 7473  led that expects
+00006a10: 2074 6f20 6361 6c6c 2061 206c 6561 6465   to call a leade
+00006a20: 722e 204d 6574 686f 6473 2077 6869 6368  r. Methods which
+00006a30: 206d 7574 6174 6520 7468 6520 7374 6174   mutate the stat
+00006a40: 6520 6f66 2074 6865 2064 6174 6162 6173  e of the databas
+00006a50: 650a 6578 7065 6374 2074 6f20 6361 6c6c  e.expect to call
+00006a60: 2061 206c 6561 6465 722e 2046 6f72 2073   a leader. For s
+00006a70: 7563 6820 6d65 7468 6f64 732c 2074 6865  uch methods, the
+00006a80: 2048 5454 5020 6865 6164 6572 2022 7265   HTTP header "re
+00006a90: 7175 6972 6573 2d6c 6561 6465 7222 2069  quires-leader" i
+00006aa0: 7320 7365 7420 746f 0a22 7472 7565 222c  s set to."true",
+00006ab0: 2061 6e64 2074 6869 7320 6865 6164 6572   and this header
+00006ac0: 2069 7320 6f62 7365 7276 6564 2062 7920   is observed by 
+00006ad0: 7468 6520 7365 7276 6572 2c20 616e 6420  the server, and 
+00006ae0: 736f 2061 206e 6f64 6520 7768 6963 6820  so a node which 
+00006af0: 6973 206e 6f74 2061 206c 6561 6465 720a  is not a leader.
+00006b00: 7468 6174 2072 6563 6569 7665 7320 7375  that receives su
+00006b10: 6368 2061 2072 6571 7565 7374 2077 696c  ch a request wil
+00006b20: 6c20 7265 7475 726e 2061 6e20 6572 726f  l return an erro
+00006b30: 722e 2054 6869 7320 6572 726f 7220 6973  r. This error is
+00006b40: 2064 6574 6563 7465 6420 6279 2074 6865   detected by the
+00006b50: 2063 6c69 656e 742c 0a77 6869 6368 2077   client,.which w
+00006b60: 696c 6c20 7468 656e 2063 6c6f 7365 2074  ill then close t
+00006b70: 6865 2063 7572 7265 6e74 2067 5250 4320  he current gRPC 
+00006b80: 636f 6e6e 6563 7469 6f6e 2061 6e64 2063  connection and c
+00006b90: 7265 6174 6520 6120 6e65 7720 636f 6e6e  reate a new conn
+00006ba0: 6563 7469 6f6e 2074 6f20 7468 650a 6c65  ection to the.le
+00006bb0: 6164 6572 2e20 5468 6520 7265 7175 6573  ader. The reques
+00006bc0: 7420 7769 6c6c 2074 6865 6e20 6265 2072  t will then be r
+00006bd0: 6574 7269 6564 2077 6974 6820 7468 6520  etried with the 
+00006be0: 6c65 6164 6572 2e0a 0a49 6620 7468 6520  leader...If the 
+00006bf0: 636c 6965 6e74 2773 206e 6f64 6520 7072  client's node pr
+00006c00: 6566 6572 656e 6365 2069 7320 2266 6f6c  eference is "fol
+00006c10: 6c6f 7765 7222 2061 6e64 2074 6865 7265  lower" and there
+00006c20: 2061 7265 206e 6f20 666f 6c6c 6f77 6572   are no follower
+00006c30: 0a6e 6f64 6573 2069 6e20 7468 6520 636c  .nodes in the cl
+00006c40: 7573 7465 722c 2074 6865 6e20 7468 6520  uster, then the 
+00006c50: 636c 6965 6e74 2077 696c 6c20 7261 6973  client will rais
+00006c60: 6520 616e 2065 7863 6570 7469 6f6e 2e20  e an exception. 
+00006c70: 5369 6d69 6c61 726c 792c 2069 6620 7468  Similarly, if th
+00006c80: 650a 636c 6965 6e74 2773 206e 6f64 6520  e.client's node 
+00006c90: 7072 6566 6572 656e 6365 2069 7320 2272  preference is "r
+00006ca0: 6561 646f 6e6c 7972 6570 6c69 6361 2220  eadonlyreplica" 
+00006cb0: 616e 6420 7468 6572 6520 6172 6520 6e6f  and there are no
+00006cc0: 2072 6561 642d 6f6e 6c79 2072 6570 6c69   read-only repli
+00006cd0: 6361 0a6e 6f64 6573 2069 6e20 7468 6520  ca.nodes in the 
+00006ce0: 636c 7573 7465 722c 2074 6865 6e20 7468  cluster, then th
+00006cf0: 6520 636c 6965 6e74 2077 696c 6c20 616c  e client will al
+00006d00: 736f 2072 6169 7365 2061 6e20 6578 6365  so raise an exce
+00006d10: 7074 696f 6e2e 0a0a 5468 6520 6752 5043  ption...The gRPC
+00006d20: 2063 6861 6e6e 656c 206f 7074 696f 6e20   channel option 
+00006d30: 2267 7270 632e 6d61 785f 7265 6365 6976  "grpc.max_receiv
+00006d40: 655f 6d65 7373 6167 655f 6c65 6e67 7468  e_message_length
+00006d50: 2220 6973 2061 7574 6f6d 6174 6963 616c  " is automatical
+00006d60: 6c79 0a63 6f6e 6669 6775 7265 6420 746f  ly.configured to
+00006d70: 2074 6865 2076 616c 7565 2060 3137 202a   the value `17 *
+00006d80: 2031 3032 3420 2a20 3130 3234 602e 2054   1024 * 1024`. T
+00006d90: 6869 7320 7661 6c75 6520 6361 6e6e 6f74  his value cannot
+00006da0: 2062 6520 6368 616e 6765 642e 0a0a 0a23   be changed....#
+00006db0: 2320 4576 656e 7420 6f62 6a65 6374 733c  # Event objects<
+00006dc0: 6120 6964 3d22 6576 656e 742d 6f62 6a65  a id="event-obje
+00006dd0: 6374 7322 3e3c 2f61 3e0a 0a54 6869 7320  cts"></a>..This 
+00006de0: 7061 636b 6167 6520 6465 6669 6e65 7320  package defines 
+00006df0: 6120 604e 6577 4576 656e 7460 2063 6c61  a `NewEvent` cla
+00006e00: 7373 2061 6e64 2061 2060 5265 636f 7264  ss and a `Record
+00006e10: 6564 4576 656e 7460 2063 6c61 7373 2e20  edEvent` class. 
+00006e20: 5468 650a 604e 6577 4576 656e 7460 2063  The.`NewEvent` c
+00006e30: 6c61 7373 2073 686f 756c 6420 6265 2075  lass should be u
+00006e40: 7365 6420 7768 656e 2077 7269 7469 6e67  sed when writing
+00006e50: 2065 7665 6e74 7320 746f 2074 6865 2064   events to the d
+00006e60: 6174 6162 6173 652e 2054 6865 0a60 5265  atabase. The.`Re
+00006e70: 636f 7264 6564 4576 656e 7460 2063 6c61  cordedEvent` cla
+00006e80: 7373 2069 7320 7573 6564 2077 6865 6e20  ss is used when 
+00006e90: 7265 6164 696e 6720 6576 656e 7473 2066  reading events f
+00006ea0: 726f 6d20 7468 6520 6461 7461 6261 7365  rom the database
+00006eb0: 2e0a 0a23 2323 204e 6577 2065 7665 6e74  ...### New event
+00006ec0: 733c 6120 6964 3d22 6e65 772d 6576 656e  s<a id="new-even
+00006ed0: 7473 223e 3c2f 613e 0a0a 5468 6520 604e  ts"></a>..The `N
+00006ee0: 6577 4576 656e 7460 2063 6c61 7373 2073  ewEvent` class s
+00006ef0: 686f 756c 6420 6265 2075 7365 6420 7768  hould be used wh
+00006f00: 656e 2077 7269 7469 6e67 2065 7665 6e74  en writing event
+00006f10: 7320 746f 2061 6e20 4576 656e 7453 746f  s to an EventSto
+00006f20: 7265 4442 2064 6174 6162 6173 652e 0a59  reDB database..Y
+00006f30: 6f75 2077 696c 6c20 6e65 6564 2074 6f20  ou will need to 
+00006f40: 636f 6e73 7472 7563 7420 6e65 7720 6576  construct new ev
+00006f50: 656e 7420 6f62 6a65 6374 7320 6265 666f  ent objects befo
+00006f60: 7265 2063 616c 6c69 6e67 2060 6170 7065  re calling `appe
+00006f70: 6e64 5f74 6f5f 7374 7265 616d 2829 602e  nd_to_stream()`.
+00006f80: 0a0a 5468 6520 604e 6577 4576 656e 7460  ..The `NewEvent`
+00006f90: 2063 6c61 7373 2069 7320 6120 6672 6f7a   class is a froz
+00006fa0: 656e 2050 7974 686f 6e20 6461 7461 636c  en Python datacl
+00006fb0: 6173 732e 2049 7420 6861 7320 7477 6f20  ass. It has two 
+00006fc0: 7265 7175 6972 6564 2063 6f6e 7374 7275  required constru
+00006fd0: 6374 6f72 0a61 7267 756d 656e 7473 2028  ctor.arguments (
+00006fe0: 6074 7970 6560 2061 6e64 2060 6461 7461  `type` and `data
+00006ff0: 6029 2061 6e64 2074 6872 6565 206f 7074  `) and three opt
+00007000: 696f 6e61 6c20 636f 6e73 7472 7563 746f  ional constructo
+00007010: 7220 6172 6775 6d65 6e74 7320 2860 6d65  r arguments (`me
+00007020: 7461 6461 7461 602c 0a60 636f 6e74 656e  tadata`,.`conten
+00007030: 745f 7479 7065 6020 616e 6420 6069 6460  t_type` and `id`
+00007040: 292e 0a0a 5468 6520 7265 7175 6972 6564  )...The required
+00007050: 2060 7479 7065 6020 6172 6775 6d65 6e74   `type` argument
+00007060: 2069 7320 6120 5079 7468 6f6e 2060 7374   is a Python `st
+00007070: 7260 2c20 7573 6564 2074 6f20 6465 7363  r`, used to desc
+00007080: 7269 6265 2074 6865 2074 7970 6520 6f66  ribe the type of
+00007090: 0a64 6f6d 6169 6e20 6576 656e 7420 7468  .domain event th
+000070a0: 6174 2069 7320 6265 696e 6720 7265 636f  at is being reco
+000070b0: 7264 6564 2e0a 0a54 6865 2072 6571 7569  rded...The requi
+000070c0: 7265 6420 6064 6174 6160 2061 7267 756d  red `data` argum
+000070d0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+000070e0: 6062 7974 6573 6020 6f62 6a65 6374 2c20  `bytes` object, 
+000070f0: 7573 6564 2074 6f20 7374 6174 6520 7468  used to state th
+00007100: 650a 7365 7269 616c 697a 6564 2064 6174  e.serialized dat
+00007110: 6120 6f66 2074 6865 2064 6f6d 6169 6e20  a of the domain 
+00007120: 6576 656e 7420 7468 6174 2069 7320 6265  event that is be
+00007130: 696e 6720 7265 636f 7264 6564 2e0a 0a54  ing recorded...T
+00007140: 6865 206f 7074 696f 6e61 6c20 606d 6574  he optional `met
+00007150: 6164 6174 6160 2061 7267 756d 656e 7420  adata` argument 
+00007160: 6973 2061 2050 7974 686f 6e20 6062 7974  is a Python `byt
+00007170: 6573 6020 6f62 6a65 6374 2c20 7573 6564  es` object, used
+00007180: 2074 6f20 696e 6469 6361 7465 2061 6e79   to indicate any
+00007190: 0a6d 6574 6164 6174 6120 6f66 2074 6865  .metadata of the
+000071a0: 2065 7665 6e74 2074 6861 7420 7769 6c6c   event that will
+000071b0: 2062 6520 7265 636f 7264 6564 2e20 5468   be recorded. Th
+000071c0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+000071d0: 6973 2061 6e20 656d 7074 7920 6062 7974  is an empty `byt
+000071e0: 6573 600a 6f62 6a65 6374 2e0a 0a54 6865  es`.object...The
+000071f0: 206f 7074 696f 6e61 6c20 6063 6f6e 7465   optional `conte
+00007200: 6e74 5f74 7970 6560 2061 7267 756d 656e  nt_type` argumen
+00007210: 7420 6973 2061 2050 7974 686f 6e20 6073  t is a Python `s
+00007220: 7472 602c 2075 7365 6420 746f 2069 6e64  tr`, used to ind
+00007230: 6963 6174 6520 7468 650a 6b69 6e64 206f  icate the.kind o
+00007240: 6620 6461 7461 2074 6861 7420 6973 2062  f data that is b
+00007250: 6569 6e67 2072 6563 6f72 6465 642e 2054  eing recorded. T
+00007260: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00007270: 2069 7320 6027 6170 706c 6963 6174 696f   is `'applicatio
+00007280: 6e2f 6a73 6f6e 2760 2c0a 7768 6963 6820  n/json'`,.which 
+00007290: 696e 6469 6361 7465 7320 7468 6174 2074  indicates that t
+000072a0: 6865 2060 6461 7461 6020 7761 7320 7365  he `data` was se
+000072b0: 7269 616c 6973 6564 2075 7369 6e67 204a  rialised using J
+000072c0: 534f 4e2e 2041 6e20 616c 7465 726e 6174  SON. An alternat
+000072d0: 6976 6520 7661 6c75 650a 666f 7220 7468  ive value.for th
+000072e0: 6973 2061 7267 756d 656e 7420 6973 2074  is argument is t
+000072f0: 6865 206d 6f72 6520 6765 6e65 7261 6c20  he more general 
+00007300: 696e 6469 6361 7469 6f6e 2060 2761 7070  indication `'app
+00007310: 6c69 6361 7469 6f6e 2f6f 6374 6574 2d73  lication/octet-s
+00007320: 7472 6561 6d27 602e 0a0a 5468 6520 6f70  tream'`...The op
+00007330: 7469 6f6e 616c 2060 6964 6020 6172 6775  tional `id` argu
+00007340: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00007350: 2060 5555 4944 6020 6f62 6a65 6374 2c20   `UUID` object, 
+00007360: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
+00007370: 7468 6520 756e 6971 7565 2049 440a 6f66  the unique ID.of
+00007380: 2074 6865 2065 7665 6e74 2074 6861 7420   the event that 
+00007390: 7769 6c6c 2062 6520 7265 636f 7264 6564  will be recorded
+000073a0: 2e20 4966 206e 6f20 7661 6c75 6520 6973  . If no value is
+000073b0: 2070 726f 7669 6465 642c 2061 206e 6577   provided, a new
+000073c0: 2076 6572 7369 6f6e 2d34 2055 5549 440a   version-4 UUID.
+000073d0: 7769 6c6c 2062 6520 6765 6e65 7261 7465  will be generate
+000073e0: 642e 0a0a 6060 6070 7974 686f 6e0a 6e65  d...```python.ne
+000073f0: 775f 6576 656e 7431 203d 204e 6577 4576  w_event1 = NewEv
+00007400: 656e 7428 0a20 2020 2074 7970 653d 274f  ent(.    type='O
+00007410: 7264 6572 4372 6561 7465 6427 2c0a 2020  rderCreated',.  
+00007420: 2020 6461 7461 3d62 277b 226e 616d 6522    data=b'{"name"
+00007430: 3a20 2247 7265 6722 7d27 2c0a 290a 6173  : "Greg"}',.).as
+00007440: 7365 7274 206e 6577 5f65 7665 6e74 312e  sert new_event1.
+00007450: 7479 7065 203d 3d20 274f 7264 6572 4372  type == 'OrderCr
+00007460: 6561 7465 6427 0a61 7373 6572 7420 6e65  eated'.assert ne
+00007470: 775f 6576 656e 7431 2e64 6174 6120 3d3d  w_event1.data ==
+00007480: 2062 277b 226e 616d 6522 3a20 2247 7265   b'{"name": "Gre
+00007490: 6722 7d27 0a61 7373 6572 7420 6e65 775f  g"}'.assert new_
+000074a0: 6576 656e 7431 2e6d 6574 6164 6174 6120  event1.metadata 
+000074b0: 3d3d 2062 2727 0a61 7373 6572 7420 6e65  == b''.assert ne
+000074c0: 775f 6576 656e 7431 2e63 6f6e 7465 6e74  w_event1.content
+000074d0: 5f74 7970 6520 3d3d 2027 6170 706c 6963  _type == 'applic
+000074e0: 6174 696f 6e2f 6a73 6f6e 270a 6173 7365  ation/json'.asse
+000074f0: 7274 2069 7369 6e73 7461 6e63 6528 6e65  rt isinstance(ne
+00007500: 775f 6576 656e 7431 2e69 642c 2075 7569  w_event1.id, uui
+00007510: 642e 5555 4944 290a 0a65 7665 6e74 5f69  d.UUID)..event_i
+00007520: 6420 3d20 7575 6964 2e75 7569 6434 2829  d = uuid.uuid4()
+00007530: 0a6e 6577 5f65 7665 6e74 3220 3d20 4e65  .new_event2 = Ne
+00007540: 7745 7665 6e74 280a 2020 2020 7479 7065  wEvent(.    type
+00007550: 3d27 496d 6167 6543 7265 6174 6564 272c  ='ImageCreated',
+00007560: 0a20 2020 2064 6174 613d 6227 3031 3031  .    data=b'0101
+00007570: 3031 3031 3031 3031 3031 272c 0a20 2020  0101010101',.   
+00007580: 206d 6574 6164 6174 613d 6227 7b22 6122   metadata=b'{"a"
+00007590: 3a20 317d 272c 0a20 2020 2063 6f6e 7465  : 1}',.    conte
+000075a0: 6e74 5f74 7970 653d 2761 7070 6c69 6361  nt_type='applica
+000075b0: 7469 6f6e 2f6f 6374 6574 2d73 7472 6561  tion/octet-strea
+000075c0: 6d27 2c0a 2020 2020 6964 3d65 7665 6e74  m',.    id=event
+000075d0: 5f69 642c 0a29 0a61 7373 6572 7420 6e65  _id,.).assert ne
+000075e0: 775f 6576 656e 7432 2e74 7970 6520 3d3d  w_event2.type ==
+000075f0: 2027 496d 6167 6543 7265 6174 6564 270a   'ImageCreated'.
+00007600: 6173 7365 7274 206e 6577 5f65 7665 6e74  assert new_event
+00007610: 322e 6461 7461 203d 3d20 6227 3031 3031  2.data == b'0101
+00007620: 3031 3031 3031 3031 3031 270a 6173 7365  0101010101'.asse
+00007630: 7274 206e 6577 5f65 7665 6e74 322e 6d65  rt new_event2.me
+00007640: 7461 6461 7461 203d 3d20 6227 7b22 6122  tadata == b'{"a"
+00007650: 3a20 317d 270a 6173 7365 7274 206e 6577  : 1}'.assert new
+00007660: 5f65 7665 6e74 322e 636f 6e74 656e 745f  _event2.content_
+00007670: 7479 7065 203d 3d20 2761 7070 6c69 6361  type == 'applica
+00007680: 7469 6f6e 2f6f 6374 6574 2d73 7472 6561  tion/octet-strea
+00007690: 6d27 0a61 7373 6572 7420 6e65 775f 6576  m'.assert new_ev
+000076a0: 656e 7432 2e69 6420 3d3d 2065 7665 6e74  ent2.id == event
+000076b0: 5f69 640a 6060 600a 0a23 2323 2052 6563  _id.```..### Rec
+000076c0: 6f72 6465 6420 6576 656e 7473 3c61 2069  orded events<a i
+000076d0: 643d 2272 6563 6f72 6465 642d 6576 656e  d="recorded-even
+000076e0: 7473 223e 3c2f 613e 0a0a 5468 6520 6052  ts"></a>..The `R
+000076f0: 6563 6f72 6465 6445 7665 6e74 6020 636c  ecordedEvent` cl
+00007700: 6173 7320 6973 2075 7365 6420 7768 656e  ass is used when
+00007710: 2072 6561 6469 6e67 2065 7665 6e74 7320   reading events 
+00007720: 6672 6f6d 2061 6e20 4576 656e 7453 746f  from an EventSto
+00007730: 7265 4442 0a64 6174 6162 6173 652e 2054  reDB.database. T
+00007740: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
+00007750: 6574 7572 6e20 6576 656e 7420 6f62 6a65  eturn event obje
+00007760: 6374 7320 6f66 2074 6869 7320 7479 7065  cts of this type
+00007770: 2066 726f 6d20 616c 6c20 6d65 7468 6f64   from all method
+00007780: 730a 7468 6174 2072 6574 7572 6e20 7265  s.that return re
+00007790: 636f 7264 6564 2065 7665 6e74 732c 2073  corded events, s
+000077a0: 7563 6820 6173 2060 6765 745f 7374 7265  uch as `get_stre
+000077b0: 616d 2829 602c 2060 7375 6273 6372 6962  am()`, `subscrib
+000077c0: 655f 746f 5f61 6c6c 2829 602c 0a61 6e64  e_to_all()`,.and
+000077d0: 2060 7265 6164 5f73 7562 7363 7269 7074   `read_subscript
+000077e0: 696f 6e5f 746f 5f61 6c6c 2829 602e 2059  ion_to_all()`. Y
+000077f0: 6f75 2064 6f20 6e6f 7420 6e65 6564 2074  ou do not need t
+00007800: 6f20 636f 6e73 7472 7563 7420 7265 636f  o construct reco
+00007810: 7264 6564 2065 7665 6e74 206f 626a 6563  rded event objec
+00007820: 7473 2e0a 0a4c 696b 6520 604e 6577 4576  ts...Like `NewEv
+00007830: 656e 7460 2c20 7468 6520 6052 6563 6f72  ent`, the `Recor
+00007840: 6465 6445 7665 6e74 6020 636c 6173 7320  dedEvent` class 
+00007850: 6973 2061 2066 726f 7a65 6e20 5079 7468  is a frozen Pyth
+00007860: 6f6e 2064 6174 6163 6c61 7373 2e20 4974  on dataclass. It
+00007870: 2068 6173 0a61 6c6c 2074 6865 2061 7474   has.all the att
+00007880: 7269 6275 7465 7320 7468 6174 2060 4e65  ributes that `Ne
+00007890: 7745 7665 6e74 6020 6861 7320 2860 7479  wEvent` has (`ty
+000078a0: 7065 602c 2060 6461 7461 602c 2060 6d65  pe`, `data`, `me
+000078b0: 7461 6461 7461 602c 2060 636f 6e74 656e  tadata`, `conten
+000078c0: 745f 7479 7065 602c 2060 6964 6029 0a74  t_type`, `id`).t
+000078d0: 6861 7420 666f 6c6c 6f77 2066 726f 6d20  hat follow from 
+000078e0: 616e 2065 7665 6e74 2074 6861 7420 7761  an event that wa
+000078f0: 7320 7265 636f 7264 6564 2c20 616e 6420  s recorded, and 
+00007900: 736f 6d65 2061 6464 6974 696f 6e61 6c20  some additional 
+00007910: 6174 7472 6962 7574 6573 2074 6861 7420  attributes that 
+00007920: 666f 6c6c 6f77 0a66 726f 6d20 7468 6520  follow.from the 
+00007930: 7265 636f 7264 696e 6720 6f66 2061 6e20  recording of an 
+00007940: 6576 656e 7420 2860 7374 7265 616d 5f6e  event (`stream_n
+00007950: 616d 6560 2c20 6073 7472 6561 6d5f 706f  ame`, `stream_po
+00007960: 7369 7469 6f6e 602c 2060 636f 6d6d 6974  sition`, `commit
+00007970: 5f70 6f73 6974 696f 6e60 2c0a 6072 6563  _position`,.`rec
+00007980: 6f72 6465 645f 6174 6029 2e20 4974 2061  orded_at`). It a
+00007990: 6c73 6f20 6861 7320 6120 606c 696e 6b60  lso has a `link`
+000079a0: 2061 7474 7269 6275 7465 2c20 7768 6963   attribute, whic
+000079b0: 6820 6973 2073 6574 206f 6e6c 7920 7768  h is set only wh
+000079c0: 656e 2022 6c69 6e6b 2065 7665 6e74 7322  en "link events"
+000079d0: 0a61 7265 2022 7265 736f 6c76 6564 222e  .are "resolved".
+000079e0: 2041 6e64 2069 7420 6861 7320 6120 6072   And it has a `r
+000079f0: 6574 7279 5f63 6f75 6e74 6020 7768 6963  etry_count` whic
+00007a00: 6820 6973 2073 6574 206f 6e6c 7920 7768  h is set only wh
+00007a10: 656e 2072 6561 6469 6e67 2070 6572 7369  en reading persi
+00007a20: 7374 656e 6365 0a73 7562 7363 7269 7074  stence.subscript
+00007a30: 696f 6e73 2e0a 0a54 6865 2060 7479 7065  ions...The `type
+00007a40: 6020 6174 7472 6962 7574 6520 6973 2061  ` attribute is a
+00007a50: 2050 7974 686f 6e20 6073 7472 602c 2075   Python `str`, u
+00007a60: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
+00007a70: 7468 6520 7479 7065 206f 6620 616e 2065  the type of an e
+00007a80: 7665 6e74 0a74 6861 7420 7761 7320 7265  vent.that was re
+00007a90: 636f 7264 6564 2e0a 0a54 6865 2060 6461  corded...The `da
+00007aa0: 7461 6020 6174 7472 6962 7574 6520 6973  ta` attribute is
+00007ab0: 2061 2050 7974 686f 6e20 6062 7974 6573   a Python `bytes
+00007ac0: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
+00007ad0: 6f20 696e 6469 6361 7465 2074 6865 2064  o indicate the d
+00007ae0: 6174 6120 6f66 2061 6e0a 6576 656e 7420  ata of an.event 
+00007af0: 7468 6174 2077 6173 2072 6563 6f72 6465  that was recorde
+00007b00: 642e 0a0a 5468 6520 606d 6574 6164 6174  d...The `metadat
+00007b10: 6160 2061 7474 7269 6275 7465 2069 7320  a` attribute is 
+00007b20: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
+00007b30: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
+00007b40: 2069 6e64 6963 6174 6520 7468 6520 6d65   indicate the me
+00007b50: 7461 6461 7461 206f 660a 616e 2065 7665  tadata of.an eve
+00007b60: 6e74 2074 6861 7420 7761 7320 7265 636f  nt that was reco
+00007b70: 7264 6564 2e0a 0a54 6865 2060 636f 6e74  rded...The `cont
+00007b80: 656e 745f 7479 7065 6020 6174 7472 6962  ent_type` attrib
+00007b90: 7574 6520 6973 2061 2050 7974 686f 6e20  ute is a Python 
+00007ba0: 6073 7472 602c 2075 7365 6420 746f 2069  `str`, used to i
+00007bb0: 6e64 6963 6174 6520 7468 6520 7479 7065  ndicate the type
+00007bc0: 206f 660a 6461 7461 2074 6861 7420 7761   of.data that wa
+00007bd0: 7320 7265 636f 7264 6564 2066 6f72 2061  s recorded for a
+00007be0: 6e20 6576 656e 742e 2049 7420 6973 2075  n event. It is u
+00007bf0: 7375 616c 6c79 2060 2761 7070 6c69 6361  sually `'applica
+00007c00: 7469 6f6e 2f6a 736f 6e27 602c 2069 6e64  tion/json'`, ind
+00007c10: 6963 6174 696e 670a 7468 6174 2074 6865  icating.that the
+00007c20: 2064 6174 6120 6361 6e20 6265 2070 6172   data can be par
+00007c30: 7365 6420 6173 204a 534f 4e2e 2041 6c74  sed as JSON. Alt
+00007c40: 6572 6e61 7469 7665 6c79 2c20 6974 2069  ernatively, it i
+00007c50: 7320 6027 6170 706c 6963 6174 696f 6e2f  s `'application/
+00007c60: 6f63 7465 742d 7374 7265 616d 2760 2e0a  octet-stream'`..
+00007c70: 0a54 6865 2060 6964 6020 6174 7472 6962  .The `id` attrib
+00007c80: 7574 6520 6973 2061 2050 7974 686f 6e20  ute is a Python 
+00007c90: 6055 5549 4460 206f 626a 6563 742c 2075  `UUID` object, u
+00007ca0: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
+00007cb0: 7468 6520 756e 6971 7565 2049 4420 6f66  the unique ID of
+00007cc0: 2061 6e0a 6576 656e 7420 7468 6174 2077   an.event that w
+00007cd0: 6173 2072 6563 6f72 6465 642e 0a0a 5468  as recorded...Th
+00007ce0: 6520 6073 7472 6561 6d5f 6e61 6d65 6020  e `stream_name` 
+00007cf0: 6174 7472 6962 7574 6520 6973 2061 2050  attribute is a P
+00007d00: 7974 686f 6e20 6073 7472 602c 2075 7365  ython `str`, use
+00007d10: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
+00007d20: 6520 6e61 6d65 206f 6620 610a 7374 7265  e name of a.stre
+00007d30: 616d 2069 6e20 7768 6963 6820 616e 2065  am in which an e
+00007d40: 7665 6e74 2077 6173 2072 6563 6f72 6465  vent was recorde
+00007d50: 642e 0a0a 5468 6520 6073 7472 6561 6d5f  d...The `stream_
+00007d60: 706f 7369 7469 6f6e 6020 6174 7472 6962  position` attrib
+00007d70: 7574 6520 6973 2061 2050 7974 686f 6e20  ute is a Python 
+00007d80: 6069 6e74 602c 2075 7365 6420 746f 2069  `int`, used to i
+00007d90: 6e64 6963 6174 6520 7468 6520 706f 7369  ndicate the posi
+00007da0: 7469 6f6e 2069 6e20 610a 7374 7265 616d  tion in a.stream
+00007db0: 2061 7420 7768 6963 6820 616e 2065 7665   at which an eve
+00007dc0: 6e74 2077 6173 2072 6563 6f72 6465 642e  nt was recorded.
+00007dd0: 0a0a 496e 2045 7665 6e74 5374 6f72 6544  ..In EventStoreD
+00007de0: 422c 2061 2022 7374 7265 616d 2070 6f73  B, a "stream pos
+00007df0: 6974 696f 6e22 2069 7320 616e 2069 6e74  ition" is an int
+00007e00: 6567 6572 2072 6570 7265 7365 6e74 696e  eger representin
+00007e10: 6720 7468 6520 706f 7369 7469 6f6e 206f  g the position o
+00007e20: 6620 610a 7265 636f 7264 6564 2065 7665  f a.recorded eve
+00007e30: 6e74 2069 6e20 6120 7374 7265 616d 2e20  nt in a stream. 
+00007e40: 4561 6368 2072 6563 6f72 6465 6420 6576  Each recorded ev
+00007e50: 656e 7420 6973 2072 6563 6f72 6465 6420  ent is recorded 
+00007e60: 6174 2061 2070 6f73 6974 696f 6e20 696e  at a position in
+00007e70: 2061 2073 7472 6561 6d2e 0a45 6163 6820   a stream..Each 
+00007e80: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+00007e90: 6973 206f 6363 7570 6965 6420 6279 206f  is occupied by o
+00007ea0: 6e6c 7920 6f6e 6520 7265 636f 7264 6564  nly one recorded
+00007eb0: 2065 7665 6e74 2e20 4e65 7720 6576 656e   event. New even
+00007ec0: 7473 2061 7265 2072 6563 6f72 6465 6420  ts are recorded 
+00007ed0: 6174 2074 6865 0a6e 6578 7420 756e 6f63  at the.next unoc
+00007ee0: 6375 7069 6564 2070 6f73 6974 696f 6e2e  cupied position.
+00007ef0: 2041 6c6c 2073 6571 7565 6e63 6573 206f   All sequences o
+00007f00: 6620 7374 7265 616d 2070 6f73 6974 696f  f stream positio
+00007f10: 6e73 2061 7265 207a 6572 6f2d 6261 7365  ns are zero-base
+00007f20: 6420 616e 6420 6761 706c 6573 732e 0a0a  d and gapless...
+00007f30: 5468 6520 6063 6f6d 6d69 745f 706f 7369  The `commit_posi
+00007f40: 7469 6f6e 6020 6174 7472 6962 7574 6520  tion` attribute 
+00007f50: 6973 2061 2050 7974 686f 6e20 6069 6e74  is a Python `int
+00007f60: 602c 2075 7365 6420 746f 2069 6e64 6963  `, used to indic
+00007f70: 6174 6520 7468 6520 706f 7369 7469 6f6e  ate the position
+00007f80: 2069 6e20 7468 650a 6461 7461 6261 7365   in the.database
+00007f90: 2061 7420 7768 6963 6820 616e 2065 7665   at which an eve
+00007fa0: 6e74 2077 6173 2072 6563 6f72 6465 642e  nt was recorded.
+00007fb0: 0a0a 496e 2045 7665 6e74 5374 6f72 6544  ..In EventStoreD
+00007fc0: 422c 2061 2022 636f 6d6d 6974 2070 6f73  B, a "commit pos
+00007fd0: 6974 696f 6e22 2069 7320 616e 2069 6e74  ition" is an int
+00007fe0: 6567 6572 2072 6570 7265 7365 6e74 696e  eger representin
+00007ff0: 6720 7468 6520 706f 7369 7469 6f6e 206f  g the position o
+00008000: 6620 610a 7265 636f 7264 6564 2065 7665  f a.recorded eve
+00008010: 6e74 2069 6e20 7468 6520 6461 7461 6261  nt in the databa
+00008020: 7365 2e20 4561 6368 2072 6563 6f72 6465  se. Each recorde
+00008030: 6420 6576 656e 7420 6973 2072 6563 6f72  d event is recor
+00008040: 6465 6420 6174 2061 2070 6f73 6974 696f  ded at a positio
+00008050: 6e20 696e 2074 6865 0a64 6174 6162 6173  n in the.databas
+00008060: 652e 2045 6163 6820 636f 6d6d 6974 2070  e. Each commit p
+00008070: 6f73 6974 696f 6e20 6973 206f 6363 7570  osition is occup
+00008080: 6965 6420 6279 206f 6e6c 7920 6f6e 6520  ied by only one 
+00008090: 7265 636f 7264 6564 2065 7665 6e74 2e20  recorded event. 
+000080a0: 436f 6d6d 6974 2070 6f73 6974 696f 6e73  Commit positions
+000080b0: 0a61 7265 207a 6572 6f2d 6261 7365 6420  .are zero-based 
+000080c0: 616e 6420 696e 6372 6561 7365 206d 6f6e  and increase mon
+000080d0: 6f74 6f6e 6963 616c 6c79 2061 7320 6e65  otonically as ne
+000080e0: 7720 6576 656e 7473 2061 7265 2072 6563  w events are rec
+000080f0: 6f72 6465 642e 2042 7574 2c20 756e 6c69  orded. But, unli
+00008100: 6b65 2073 7472 6561 6d0a 706f 7369 7469  ke stream.positi
+00008110: 6f6e 732c 2074 6865 2073 6571 7565 6e63  ons, the sequenc
+00008120: 6520 6f66 2073 7563 6365 7373 6976 6520  e of successive 
+00008130: 636f 6d6d 6974 2070 6f73 6974 696f 6e73  commit positions
+00008140: 2069 7320 6e6f 7420 6761 706c 6573 732e   is not gapless.
+00008150: 2049 6e64 6565 642c 2074 6865 7265 2061   Indeed, there a
+00008160: 7265 0a75 7375 616c 6c79 206c 6172 6765  re.usually large
+00008170: 2064 6966 6665 7265 6e63 6573 2062 6574   differences bet
+00008180: 7765 656e 2074 6865 2063 6f6d 6d69 7420  ween the commit 
+00008190: 706f 7369 7469 6f6e 7320 6f66 2073 7563  positions of suc
+000081a0: 6365 7373 6976 656c 7920 7265 636f 7264  cessively record
+000081b0: 6564 2065 7665 6e74 732e 0a0a 506c 6561  ed events...Plea
+000081c0: 7365 206e 6f74 652c 2069 6e20 4576 656e  se note, in Even
+000081d0: 7453 746f 7265 4442 2032 312e 3130 2c20  tStoreDB 21.10, 
+000081e0: 7468 6520 6063 6f6d 6d69 745f 706f 7369  the `commit_posi
+000081f0: 7469 6f6e 6020 6f66 2061 6c6c 2060 5265  tion` of all `Re
+00008200: 636f 7264 6564 4576 656e 7460 206f 626a  cordedEvent` obj
+00008210: 6563 7473 0a6f 6274 6169 6e65 6420 6672  ects.obtained fr
+00008220: 6f6d 2060 7265 6164 5f73 7472 6561 6d28  om `read_stream(
+00008230: 2960 2069 7320 604e 6f6e 6560 2c20 7768  )` is `None`, wh
+00008240: 6572 6561 7320 7468 6f73 6520 6f62 7461  ereas those obta
+00008250: 696e 6564 2066 726f 6d20 6072 6561 645f  ined from `read_
+00008260: 616c 6c28 2960 2068 6176 650a 7468 6520  all()` have.the 
+00008270: 6163 7475 616c 2063 6f6d 6d69 7420 706f  actual commit po
+00008280: 7369 7469 6f6e 206f 6620 7468 6520 7265  sition of the re
+00008290: 636f 7264 6564 2065 7665 6e74 2e20 5468  corded event. Th
+000082a0: 6973 2077 6173 2063 6861 6e67 6564 2069  is was changed i
+000082b0: 6e20 7665 7273 696f 6e20 3232 2e31 302c  n version 22.10,
+000082c0: 2073 6f0a 7468 6174 2065 7665 6e74 206f   so.that event o
+000082d0: 626a 6563 7473 206f 6274 6169 6e65 6420  bjects obtained 
+000082e0: 6672 6f6d 2062 6f74 6820 6067 6574 5f73  from both `get_s
+000082f0: 7472 6561 6d28 2960 2061 6e64 2060 7265  tream()` and `re
+00008300: 6164 5f61 6c6c 2829 6020 6861 7665 2074  ad_all()` have t
+00008310: 6865 2061 6374 7561 6c0a 636f 6d6d 6974  he actual.commit
+00008320: 2070 6f73 6974 696f 6e2e 2054 6865 2060   position. The `
+00008330: 636f 6d6d 6974 5f70 6f73 6974 696f 6e60  commit_position`
+00008340: 2061 7474 7269 6275 7465 206f 6620 7468   attribute of th
+00008350: 6520 6052 6563 6f72 6465 6445 7665 6e74  e `RecordedEvent
+00008360: 6020 636c 6173 7320 6973 0a61 6e6e 6f74  ` class is.annot
+00008370: 6174 6564 2077 6974 6820 7468 6520 7479  ated with the ty
+00008380: 7065 2060 4f70 7469 6f6e 616c 5b69 6e74  pe `Optional[int
+00008390: 5d60 2066 6f72 2074 6869 7320 7265 6173  ]` for this reas
+000083a0: 6f6e 206f 6e6c 792e 0a0a 5468 6520 6072  on only...The `r
+000083b0: 6563 6f72 6465 645f 6174 6020 6174 7472  ecorded_at` attr
+000083c0: 6962 7574 6520 6973 2061 2050 7974 686f  ibute is a Pytho
+000083d0: 6e20 6064 6174 6574 696d 6560 2c20 7573  n `datetime`, us
+000083e0: 6564 2074 6f20 696e 6469 6361 7465 2077  ed to indicate w
+000083f0: 6865 6e20 616e 2065 7665 6e74 2077 6173  hen an event was
+00008400: 0a72 6563 6f72 6465 6420 6279 2074 6865  .recorded by the
+00008410: 2064 6174 6162 6173 652e 0a0a 5468 6520   database...The 
+00008420: 606c 696e 6b60 2061 7474 7269 6275 7465  `link` attribute
+00008430: 2069 7320 616e 206f 7074 696f 6e61 6c20   is an optional 
+00008440: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
+00008450: 7468 6174 2063 6172 7269 6573 2069 6e66  that carries inf
+00008460: 6f72 6d61 7469 6f6e 2061 626f 7574 0a61  ormation about.a
+00008470: 2022 6c69 6e6b 2065 7665 6e74 2220 7468   "link event" th
+00008480: 6174 2068 6173 2062 6565 6e20 2272 6573  at has been "res
+00008490: 6f6c 7665 6422 2074 6f20 7468 6520 6c69  olved" to the li
+000084a0: 6e6b 6564 2065 7665 6e74 2e20 5468 6973  nked event. This
+000084b0: 2061 6c6c 6f77 7320 6163 6365 7373 2074   allows access t
+000084c0: 6f0a 7468 6520 6c69 6e6b 2065 7665 6e74  o.the link event
+000084d0: 2061 7474 7269 6275 7465 7320 7768 656e   attributes when
+000084e0: 206c 696e 6b20 6576 656e 7473 2068 6176   link events hav
+000084f0: 6520 6265 656e 2072 6573 6f6c 7665 642c  e been resolved,
+00008500: 2066 6f72 2065 7861 6d70 6c65 2061 6363   for example acc
+00008510: 6573 730a 746f 2074 6865 2063 6f72 7265  ess.to the corre
+00008520: 6374 2065 7665 6e74 2049 4420 746f 2062  ct event ID to b
+00008530: 6520 7573 6564 2077 6865 6e20 6163 6b6e  e used when ackn
+00008540: 6f77 6c65 6467 696e 6720 6f72 206e 6567  owledging or neg
+00008550: 6174 6976 656c 7920 6163 6b6e 6f77 6c65  atively acknowle
+00008560: 6467 696e 670a 6c69 6e6b 2065 7665 6e74  dging.link event
+00008570: 732e 204c 696e 6b20 6576 656e 7473 2061  s. Link events a
+00008580: 7265 2022 7265 736f 6c76 6564 2220 7768  re "resolved" wh
+00008590: 656e 2074 6865 2060 7265 736f 6c76 655f  en the `resolve_
+000085a0: 6c69 6e6b 7360 2061 7267 756d 656e 7420  links` argument 
+000085b0: 6973 2060 5472 7565 600a 616e 6420 7768  is `True`.and wh
+000085c0: 656e 2072 6570 6c61 7969 6e67 2070 6172  en replaying par
+000085d0: 6b65 6420 6576 656e 7473 2028 6e65 6761  ked events (nega
+000085e0: 7469 7665 6c79 2061 636b 6e6f 776c 6564  tively acknowled
+000085f0: 6769 6e67 2061 6e20 6576 656e 7420 7265  ging an event re
+00008600: 6365 6976 6564 2066 726f 6d0a 6120 7065  ceived from.a pe
+00008610: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+00008620: 7074 696f 6e20 7769 7468 2074 6865 2060  ption with the `
+00008630: 2770 6172 6b27 6020 6163 7469 6f6e 2077  'park'` action w
+00008640: 696c 6c20 6372 6561 7465 2061 206c 696e  ill create a lin
+00008650: 6b20 6576 656e 742c 2061 6e64 0a77 6865  k event, and.whe
+00008660: 6e20 7061 726b 6564 2065 7665 6e74 2061  n parked event a
+00008670: 7265 2072 6570 6c61 7965 6420 7468 6579  re replayed they
+00008680: 2061 7265 2072 6563 6569 7665 6420 6173   are received as
+00008690: 2072 6573 6f6c 7665 6420 6576 656e 7473   resolved events
+000086a0: 292e 2054 6865 0a60 6163 6b5f 6964 6020  ). The.`ack_id` 
+000086b0: 7072 6f70 6572 7479 2068 656c 7073 2077  property helps w
+000086c0: 6974 6820 6f62 7461 696e 696e 6720 7468  ith obtaining th
+000086d0: 6520 636f 7272 6563 7420 6576 656e 7420  e correct event 
+000086e0: 4944 2074 6f20 7573 6520 7768 656e 2061  ID to use when a
+000086f0: 636b 6e6f 776c 6564 6769 6e67 0a6f 7220  cknowledging.or 
+00008700: 6e65 6761 7469 7665 6c79 2061 636b 6e6f  negatively ackno
+00008710: 776c 6564 6769 6e67 2065 7665 6e74 7320  wledging events 
+00008720: 7265 6365 6976 6564 2066 726f 6d20 7065  received from pe
+00008730: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+00008740: 7074 696f 6e73 2e0a 0a54 6865 2060 7265  ptions...The `re
+00008750: 7472 795f 636f 756e 7460 2069 7320 6120  try_count` is a 
+00008760: 5079 7468 6f6e 2060 696e 7460 2c20 7573  Python `int`, us
+00008770: 6564 2074 6f20 696e 6469 6361 7465 2074  ed to indicate t
+00008780: 6865 206e 756d 6265 7220 6f66 2074 696d  he number of tim
+00008790: 6573 2061 2070 6572 7369 7374 656e 740a  es a persistent.
+000087a0: 7375 6273 6372 6970 7469 6f6e 2068 6173  subscription has
+000087b0: 2072 6574 7269 6564 2073 656e 6469 6e67   retried sending
+000087c0: 2074 6865 2065 7665 6e74 2074 6f20 6120   the event to a 
+000087d0: 636f 6e73 756d 6572 2e0a 0a0a 6060 6070  consumer....```p
+000087e0: 7974 686f 6e0a 6672 6f6d 2064 6174 6163  ython.from datac
+000087f0: 6c61 7373 6573 2069 6d70 6f72 7420 6461  lasses import da
+00008800: 7461 636c 6173 730a 6672 6f6d 2064 6174  taclass.from dat
+00008810: 6574 696d 6520 696d 706f 7274 2064 6174  etime import dat
+00008820: 6574 696d 650a 0a40 6461 7461 636c 6173  etime..@dataclas
+00008830: 7328 6672 6f7a 656e 3d54 7275 6529 0a63  s(frozen=True).c
+00008840: 6c61 7373 2052 6563 6f72 6465 6445 7665  lass RecordedEve
+00008850: 6e74 3a0a 2020 2020 2222 220a 2020 2020  nt:.    """.    
+00008860: 456e 6361 7073 756c 6174 6573 2065 7665  Encapsulates eve
+00008870: 6e74 2064 6174 6120 7468 6174 2068 6173  nt data that has
+00008880: 2062 6565 6e20 7265 636f 7264 6564 2069   been recorded i
+00008890: 6e20 4576 656e 7453 746f 7265 4442 2e0a  n EventStoreDB..
+000088a0: 2020 2020 2222 220a 0a20 2020 2074 7970      """..    typ
+000088b0: 653a 2073 7472 0a20 2020 2064 6174 613a  e: str.    data:
+000088c0: 2062 7974 6573 0a20 2020 206d 6574 6164   bytes.    metad
+000088d0: 6174 613a 2062 7974 6573 0a20 2020 2063  ata: bytes.    c
+000088e0: 6f6e 7465 6e74 5f74 7970 653a 2073 7472  ontent_type: str
+000088f0: 0a20 2020 2069 643a 2055 5549 440a 2020  .    id: UUID.  
+00008900: 2020 7374 7265 616d 5f6e 616d 653a 2073    stream_name: s
+00008910: 7472 0a20 2020 2073 7472 6561 6d5f 706f  tr.    stream_po
+00008920: 7369 7469 6f6e 3a20 696e 740a 2020 2020  sition: int.    
+00008930: 636f 6d6d 6974 5f70 6f73 6974 696f 6e3a  commit_position:
+00008940: 204f 7074 696f 6e61 6c5b 696e 745d 0a20   Optional[int]. 
+00008950: 2020 2072 6563 6f72 6465 645f 6174 3a20     recorded_at: 
+00008960: 4f70 7469 6f6e 616c 5b64 6174 6574 696d  Optional[datetim
+00008970: 655d 203d 204e 6f6e 650a 2020 2020 6c69  e] = None.    li
+00008980: 6e6b 3a20 4f70 7469 6f6e 616c 5b22 5265  nk: Optional["Re
+00008990: 636f 7264 6564 4576 656e 7422 5d20 3d20  cordedEvent"] = 
+000089a0: 4e6f 6e65 0a20 2020 2072 6574 7279 5f63  None.    retry_c
+000089b0: 6f75 6e74 3a20 4f70 7469 6f6e 616c 5b69  ount: Optional[i
+000089c0: 6e74 5d20 3d20 4e6f 6e65 0a0a 2020 2020  nt] = None..    
+000089d0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000089e0: 6620 6163 6b5f 6964 2873 656c 6629 202d  f ack_id(self) -
+000089f0: 3e20 5555 4944 3a0a 2020 2020 2020 2020  > UUID:.        
+00008a00: 6966 2073 656c 662e 6c69 6e6b 2069 7320  if self.link is 
+00008a10: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00008a20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00008a30: 662e 6c69 6e6b 2e69 640a 2020 2020 2020  f.link.id.      
+00008a40: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00008a50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00008a60: 6964 0a0a 2020 2020 4070 726f 7065 7274  id..    @propert
+00008a70: 790a 2020 2020 6465 6620 6973 5f73 7973  y.    def is_sys
+00008a80: 7465 6d5f 6576 656e 7428 7365 6c66 2920  tem_event(self) 
+00008a90: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+00008aa0: 2072 6574 7572 6e20 7365 6c66 2e74 7970   return self.typ
+00008ab0: 652e 7374 6172 7473 7769 7468 2822 2422  e.startswith("$"
+00008ac0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00008ad0: 0a20 2020 2064 6566 2069 735f 6c69 6e6b  .    def is_link
+00008ae0: 5f65 7665 6e74 2873 656c 6629 202d 3e20  _event(self) -> 
+00008af0: 626f 6f6c 3a0a 2020 2020 2020 2020 7265  bool:.        re
+00008b00: 7475 726e 2073 656c 662e 7479 7065 203d  turn self.type =
+00008b10: 3d20 2224 3e22 0a0a 2020 2020 4070 726f  = "$>"..    @pro
+00008b20: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
+00008b30: 5f72 6573 6f6c 7665 645f 6576 656e 7428  _resolved_event(
+00008b40: 7365 6c66 2920 2d3e 2062 6f6f 6c3a 0a20  self) -> bool:. 
+00008b50: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00008b60: 6c66 2e6c 696e 6b20 6973 206e 6f74 204e  lf.link is not N
+00008b70: 6f6e 650a 0a20 2020 2040 7072 6f70 6572  one..    @proper
+00008b80: 7479 0a20 2020 2064 6566 2069 735f 6368  ty.    def is_ch
+00008b90: 6563 6b70 6f69 6e74 2873 656c 6629 202d  eckpoint(self) -
+00008ba0: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
+00008bb0: 7265 7475 726e 2046 616c 7365 0a60 6060  return False.```
+00008bc0: 0a0a 5468 6520 7072 6f70 6572 7479 2060  ..The property `
+00008bd0: 6163 6b5f 6964 6020 6361 6e20 6265 2075  ack_id` can be u
+00008be0: 7365 6420 746f 206f 6274 6169 6e20 7468  sed to obtain th
+00008bf0: 6520 636f 7272 6563 7420 6576 656e 7420  e correct event 
+00008c00: 4944 2074 6f20 6061 636b 2829 6020 6f72  ID to `ack()` or
+00008c10: 2060 6e61 636b 2829 600a 6576 656e 7473   `nack()`.events
+00008c20: 2072 6563 6569 7665 6420 7768 656e 2072   received when r
+00008c30: 6561 6469 6e67 2070 6572 7369 7374 656e  eading persisten
+00008c40: 7420 7375 6273 6372 6970 7469 6f6e 732e  t subscriptions.
+00008c50: 2054 6865 2072 6574 7572 6e65 6420 7661   The returned va
+00008c60: 6c75 6520 6973 2065 6974 6865 7220 7468  lue is either th
+00008c70: 650a 7661 6c75 6520 6f66 2074 6865 2060  e.value of the `
+00008c80: 6964 6020 6174 7472 6962 7574 6520 6f66  id` attribute of
+00008c90: 2074 6865 2060 6c69 6e6b 6020 6174 7472   the `link` attr
+00008ca0: 6962 7574 652c 2069 6620 606c 696e 6b60  ibute, if `link`
+00008cb0: 2069 7320 6e6f 7420 604e 6f6e 6560 2c20   is not `None`, 
+00008cc0: 6f74 6865 7277 6973 650a 6974 2069 7320  otherwise.it is 
+00008cd0: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
+00008ce0: 2060 6964 6020 6174 7472 6962 7574 652e   `id` attribute.
+00008cf0: 0a0a 5468 6520 7072 6f70 6572 7479 2060  ..The property `
+00008d00: 6973 5f73 7973 7465 6d5f 6576 656e 7460  is_system_event`
+00008d10: 2069 6e64 6963 6174 6573 2077 6865 7468   indicates wheth
+00008d20: 6572 2074 6865 2065 7665 6e74 2069 7320  er the event is 
+00008d30: 6120 2273 7973 7465 6d20 6576 656e 7422  a "system event"
+00008d40: 2e20 5379 7374 656d 0a65 7665 6e74 7320  . System.events 
+00008d50: 6861 7665 2061 2060 7479 7065 6020 7661  have a `type` va
+00008d60: 6c75 6520 7468 6174 2073 7461 7274 7320  lue that starts 
+00008d70: 7769 7468 2060 2724 2760 2e0a 0a54 6865  with `'$'`...The
+00008d80: 2070 726f 7065 7274 7920 6069 735f 6c69   property `is_li
+00008d90: 6e6b 5f65 7665 6e74 6020 696e 6469 6361  nk_event` indica
+00008da0: 7465 7320 7768 6574 6865 7220 7468 6520  tes whether the 
+00008db0: 6576 656e 7420 6973 2061 2022 6c69 6e6b  event is a "link
+00008dc0: 2065 7665 6e74 222e 204c 696e 6b0a 6576   event". Link.ev
+00008dd0: 656e 7473 2068 6176 6520 6120 6074 7970  ents have a `typ
+00008de0: 6560 2076 616c 7565 206f 6620 6027 243e  e` value of `'$>
+00008df0: 2760 2e0a 0a54 6865 2070 726f 7065 7274  '`...The propert
+00008e00: 7920 6069 735f 7265 736f 6c76 655f 6576  y `is_resolve_ev
+00008e10: 656e 7460 2069 6e64 6963 6174 6573 2077  ent` indicates w
+00008e20: 6865 7468 6572 2074 6865 2065 7665 6e74  hether the event
+00008e30: 2068 6173 2062 6565 6e20 7265 736f 6c76   has been resolv
+00008e40: 6564 2066 726f 6d20 610a 226c 696e 6b20  ed from a."link 
+00008e50: 6576 656e 7422 2e20 5468 6520 7265 7475  event". The retu
+00008e60: 726e 6564 2076 616c 7565 2069 7320 6054  rned value is `T
+00008e70: 7275 6560 2069 6620 606c 696e 6b60 2069  rue` if `link` i
+00008e80: 7320 6e6f 7420 604e 6f6e 6560 2e0a 0a54  s not `None`...T
+00008e90: 6865 2070 726f 7065 7274 7920 6069 735f  he property `is_
+00008ea0: 6368 6563 6b70 6f69 6e74 6020 6973 2060  checkpoint` is `
+00008eb0: 4661 6c73 6560 2e20 5468 6973 2063 616e  False`. This can
+00008ec0: 2062 6520 7573 6564 2074 6f20 6964 656e   be used to iden
+00008ed0: 7469 6679 2060 4368 6563 6b70 6f69 6e74  tify `Checkpoint
+00008ee0: 600a 696e 7374 616e 6365 7320 7265 7475  `.instances retu
+00008ef0: 726e 6564 2077 6865 6e20 7265 6365 6976  rned when receiv
+00008f00: 696e 6720 6576 656e 7473 2066 726f 6d20  ing events from 
+00008f10: 6069 6e63 6c75 6465 5f63 6865 636b 706f  `include_checkpo
+00008f20: 696e 7473 3d54 7275 6560 2e0a 0a0a 0a23  ints=True`.....#
+00008f30: 2320 5374 7265 616d 733c 6120 6964 3d22  # Streams<a id="
+00008f40: 7374 7265 616d 7322 3e3c 2f61 3e0a 0a49  streams"></a>..I
+00008f50: 6e20 4576 656e 7453 746f 7265 4442 2c20  n EventStoreDB, 
+00008f60: 6120 2273 7472 6561 6d22 2069 7320 6120  a "stream" is a 
+00008f70: 7365 7175 656e 6365 206f 6620 7265 636f  sequence of reco
+00008f80: 7264 6564 2065 7665 6e74 7320 7468 6174  rded events that
+00008f90: 2061 6c6c 2068 6176 650a 7468 6520 7361   all have.the sa
+00008fa0: 6d65 2022 7374 7265 616d 206e 616d 6522  me "stream name"
+00008fb0: 2e20 5468 6572 6520 7769 6c6c 206e 6f72  . There will nor
+00008fc0: 6d61 6c6c 7920 6265 206d 616e 7920 7374  mally be many st
+00008fd0: 7265 616d 7320 696e 2061 2064 6174 6162  reams in a datab
+00008fe0: 6173 652c 0a65 6163 6820 7769 7468 206d  ase,.each with m
+00008ff0: 616e 7920 7265 636f 7264 6564 2065 7665  any recorded eve
+00009000: 6e74 732e 2045 6163 6820 7265 636f 7264  nts. Each record
+00009010: 6564 2065 7665 6e74 2068 6173 2061 2070  ed event has a p
+00009020: 6f73 6974 696f 6e20 696e 2069 7473 2073  osition in its s
+00009030: 7472 6561 6d0a 2874 6865 2022 7374 7265  tream.(the "stre
+00009040: 616d 2070 6f73 6974 696f 6e22 292c 2061  am position"), a
+00009050: 6e64 2061 2070 6f73 6974 696f 6e20 696e  nd a position in
+00009060: 2074 6865 2064 6174 6162 6173 6520 2874   the database (t
+00009070: 6865 2022 636f 6d6d 6974 2070 6f73 6974  he "commit posit
+00009080: 696f 6e22 292e 0a53 7472 6561 6d20 706f  ion")..Stream po
+00009090: 7369 7469 6f6e 7320 6172 6520 7a65 726f  sitions are zero
+000090a0: 2d62 6173 6564 2061 6e64 2067 6170 6c65  -based and gaple
+000090b0: 7373 2e20 436f 6d6d 6974 2070 6f73 6974  ss. Commit posit
+000090c0: 696f 6e73 2061 7265 2061 6c73 6f20 7a65  ions are also ze
+000090d0: 726f 2d62 6173 6564 2c0a 6275 7420 6172  ro-based,.but ar
+000090e0: 6520 6e6f 7420 6761 706c 6573 732e 0a0a  e not gapless...
+000090f0: 5468 6520 6d65 7468 6f64 7320 6061 7070  The methods `app
+00009100: 656e 645f 746f 5f73 7472 6561 6d28 2960  end_to_stream()`
+00009110: 2c20 6067 6574 5f73 7472 6561 6d28 2960  , `get_stream()`
+00009120: 2061 6e64 2060 7265 6164 5f61 6c6c 2829   and `read_all()
+00009130: 6020 6361 6e0a 6265 2075 7365 6420 746f  ` can.be used to
+00009140: 2072 6561 6420 616e 6420 7265 636f 7264   read and record
+00009150: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
+00009160: 2e0a 0a23 2323 2041 7070 656e 6420 6576  ...### Append ev
+00009170: 656e 7473 3c61 2069 643d 2261 7070 656e  ents<a id="appen
+00009180: 642d 6576 656e 7473 223e 3c2f 613e 0a0a  d-events"></a>..
+00009190: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
+000091a0: 2a0a 0a54 6865 2060 6170 7065 6e64 5f74  *..The `append_t
+000091b0: 6f5f 7374 7265 616d 2829 6020 6d65 7468  o_stream()` meth
+000091c0: 6f64 2063 616e 2062 6520 7573 6564 2061  od can be used a
+000091d0: 746f 6d69 6361 6c6c 7920 746f 2072 6563  tomically to rec
+000091e0: 6f72 6420 6120 7365 7175 656e 6365 206f  ord a sequence o
+000091f0: 6620 6e65 7720 6576 656e 7473 2e0a 4966  f new events..If
+00009200: 2074 6865 206f 7065 7261 7469 6f6e 2069   the operation i
+00009210: 7320 7375 6363 6573 7366 756c 2c20 6974  s successful, it
+00009220: 2072 6574 7572 6e73 2074 6865 2063 6f6d   returns the com
+00009230: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
+00009240: 7468 6520 6c61 7374 2065 7665 6e74 2069  the last event i
+00009250: 6e20 7468 650a 7365 7175 656e 6365 2074  n the.sequence t
+00009260: 6861 7420 6861 7320 6265 656e 2072 6563  hat has been rec
+00009270: 6f72 6465 642e 0a0a 5468 6973 206d 6574  orded...This met
+00009280: 686f 6420 6861 7320 7468 7265 6520 7265  hod has three re
+00009290: 7175 6972 6564 2061 7267 756d 656e 7473  quired arguments
+000092a0: 2c20 6073 7472 6561 6d5f 6e61 6d65 602c  , `stream_name`,
+000092b0: 2060 6375 7272 656e 745f 7665 7273 696f   `current_versio
+000092c0: 6e60 0a61 6e64 2060 6576 656e 7473 602e  n`.and `events`.
+000092d0: 0a0a 5468 6520 7265 7175 6972 6564 2060  ..The required `
+000092e0: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+000092f0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+00009300: 6e20 6073 7472 6020 7468 6174 2075 6e69  n `str` that uni
+00009310: 7175 656c 7920 6964 656e 7469 6669 6573  quely identifies
+00009320: 2061 0a73 7472 6561 6d20 746f 2077 6869   a.stream to whi
+00009330: 6368 2061 2073 6571 7565 6e63 6520 6f66  ch a sequence of
+00009340: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+00009350: 6170 7065 6e64 6564 2e0a 0a54 6865 2072  appended...The r
+00009360: 6571 7569 7265 6420 6063 7572 7265 6e74  equired `current
+00009370: 5f76 6572 7369 6f6e 6020 6172 6775 6d65  _version` argume
+00009380: 6e74 2069 7320 6578 7065 6374 6564 2074  nt is expected t
+00009390: 6f20 6265 2065 6974 6865 7220 6120 5079  o be either a Py
+000093a0: 7468 6f6e 2060 696e 7460 0a74 6861 7420  thon `int`.that 
+000093b0: 696e 6469 6361 7465 7320 7468 6520 7374  indicates the st
+000093c0: 7265 616d 2070 6f73 6974 696f 6e20 6f66  ream position of
+000093d0: 2074 6865 206c 6173 7420 7265 636f 7264   the last record
+000093e0: 6564 2065 7665 6e74 2069 6e20 7468 6520  ed event in the 
+000093f0: 7374 7265 616d 2c20 6f72 0a60 5374 7265  stream, or.`Stre
+00009400: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
+00009410: 4d60 2069 6620 7468 6520 7374 7265 616d  M` if the stream
+00009420: 2064 6f65 7320 6e6f 7420 7965 7420 6578   does not yet ex
+00009430: 6973 7420 6f72 2068 6173 2062 6565 6e20  ist or has been 
+00009440: 6465 6c65 7465 642e 2054 6865 0a73 7472  deleted. The.str
+00009450: 6561 6d20 706f 7369 7469 6f6e 7320 6172  eam positions ar
+00009460: 6520 7a65 726f 2d62 6173 6564 2061 6e64  e zero-based and
+00009470: 2067 6170 6c65 7373 2c20 736f 2074 6861   gapless, so tha
+00009480: 7420 6966 2061 2073 7472 6561 6d20 6861  t if a stream ha
+00009490: 7320 7477 6f20 6576 656e 7473 2c20 7468  s two events, th
+000094a0: 650a 6063 7572 7265 6e74 5f76 6572 7369  e.`current_versi
+000094b0: 6f6e 6020 7368 6f75 6c64 2062 6520 312e  on` should be 1.
+000094c0: 2049 6620 616e 2069 6e63 6f72 7265 6374   If an incorrect
+000094d0: 2076 616c 7565 2069 7320 6769 7665 6e2c   value is given,
+000094e0: 2074 6869 7320 6d65 7468 6f64 2077 696c   this method wil
+000094f0: 6c20 7261 6973 6520 610a 6057 726f 6e67  l raise a.`Wrong
+00009500: 4375 7272 656e 7456 6572 7369 6f6e 6020  CurrentVersion` 
+00009510: 6578 6365 7074 696f 6e2e 2054 6869 7320  exception. This 
+00009520: 6265 6861 7669 6f72 2069 7320 6465 7369  behavior is desi
+00009530: 676e 6564 2074 6f20 7072 6f76 6964 6520  gned to provide 
+00009540: 636f 6e63 7572 7265 6e63 790a 636f 6e74  concurrency.cont
+00009550: 726f 6c20 7768 656e 2072 6563 6f72 6469  rol when recordi
+00009560: 6e67 206e 6577 2065 7665 6e74 732e 2054  ng new events. T
+00009570: 6865 2063 6f72 7265 6374 2076 616c 7565  he correct value
+00009580: 206f 6620 6063 7572 7265 6e74 5f76 6572   of `current_ver
+00009590: 7369 6f6e 6020 666f 7220 616e 7920 7374  sion` for any st
+000095a0: 7265 616d 0a63 616e 2062 6520 6f62 7461  ream.can be obta
+000095b0: 696e 6564 2062 7920 6361 6c6c 696e 6720  ined by calling 
+000095c0: 6067 6574 5f63 7572 7265 6e74 5f76 6572  `get_current_ver
+000095d0: 7369 6f6e 2829 602e 2048 6f77 6576 6572  sion()`. However
+000095e0: 2c20 7468 6520 7479 7069 6361 6c20 6170  , the typical ap
+000095f0: 7072 6f61 6368 2069 7320 746f 0a72 6563  proach is to.rec
+00009600: 6f6e 7374 7275 6374 2061 6e20 6167 6772  onstruct an aggr
+00009610: 6567 6174 6520 6672 6f6d 2074 6865 2072  egate from the r
+00009620: 6563 6f72 6465 6420 6576 656e 7473 2c20  ecorded events, 
+00009630: 736f 2074 6861 7420 7468 6520 7665 7273  so that the vers
+00009640: 696f 6e20 6f66 2074 6865 2061 6767 7265  ion of the aggre
+00009650: 6761 7465 0a69 7320 7468 6520 7374 7265  gate.is the stre
+00009660: 616d 2070 6f73 6974 696f 6e20 6f66 2074  am position of t
+00009670: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
+00009680: 2065 7665 6e74 2c20 7468 656e 2068 6176   event, then hav
+00009690: 6520 7468 6520 6167 6772 6567 6174 6520  e the aggregate 
+000096a0: 6765 6e65 7261 7465 206e 6577 0a65 7665  generate new.eve
+000096b0: 6e74 732c 2061 6e64 2074 6865 6e20 7573  nts, and then us
+000096c0: 6520 7468 6520 6375 7272 656e 7420 7665  e the current ve
+000096d0: 7273 696f 6e20 6f66 2074 6865 2061 6767  rsion of the agg
+000096e0: 7265 6761 7465 2061 7320 7468 6520 7661  regate as the va
+000096f0: 6c75 6520 6f66 2074 6865 0a60 6375 7272  lue of the.`curr
+00009700: 656e 745f 7665 7273 696f 6e60 2061 7267  ent_version` arg
+00009710: 756d 656e 7420 7768 656e 2061 7070 656e  ument when appen
+00009720: 6469 6e67 2074 6865 206e 6577 2061 6767  ding the new agg
+00009730: 7265 6761 7465 2065 7665 6e74 732e 2054  regate events. T
+00009740: 6869 7320 656e 7375 7265 730a 7468 6520  his ensures.the 
+00009750: 636f 6e73 6973 7465 6e63 7920 6f66 2074  consistency of t
+00009760: 6865 2072 6563 6f72 6465 6420 6167 6772  he recorded aggr
+00009770: 6567 6174 6520 6576 656e 7473 2c20 6265  egate events, be
+00009780: 6361 7573 6520 6f70 6572 6174 696f 6e73  cause operations
+00009790: 2074 6861 7420 6765 6e65 7261 7465 0a6e   that generate.n
+000097a0: 6577 2061 6767 7265 6761 7465 2065 7665  ew aggregate eve
+000097b0: 6e74 7320 6361 6e20 6265 2072 6574 7269  nts can be retri
+000097c0: 6564 2077 6974 6820 6120 6672 6573 686c  ed with a freshl
+000097d0: 7920 7265 636f 6e73 7472 7563 7465 6420  y reconstructed 
+000097e0: 6167 6772 6567 6174 6520 6966 0a61 2060  aggregate if.a `
+000097f0: 5772 6f6e 6743 7572 7265 6e74 5665 7273  WrongCurrentVers
+00009800: 696f 6e60 2065 7863 6570 7469 6f6e 2069  ion` exception i
+00009810: 7320 656e 636f 756e 7465 7265 6420 7768  s encountered wh
+00009820: 656e 2072 6563 6f72 6469 6e67 206e 6577  en recording new
+00009830: 2065 7665 6e74 732e 2054 6869 730a 636f   events. This.co
+00009840: 6e74 726f 6c6c 696e 6720 6265 6861 7669  ntrolling behavi
+00009850: 6f72 2063 616e 2062 6520 656e 7469 7265  or can be entire
+00009860: 6c79 2064 6973 6162 6c65 6420 6279 2073  ly disabled by s
+00009870: 6574 7469 6e67 2074 6865 2076 616c 7565  etting the value
+00009880: 206f 6620 7468 6520 6063 7572 7265 6e74   of the `current
+00009890: 5f76 6572 7369 6f6e 600a 6172 6775 6d65  _version`.argume
+000098a0: 6e74 2074 6f20 7468 6520 636f 6e73 7461  nt to the consta
+000098b0: 6e74 2060 5374 7265 616d 5374 6174 652e  nt `StreamState.
+000098c0: 414e 5960 2e20 4d6f 7265 2073 656c 6563  ANY`. More selec
+000098d0: 7469 7665 6c79 2c20 7468 6973 2062 6568  tively, this beh
+000098e0: 6176 696f 7572 2063 616e 2062 650a 6469  aviour can be.di
+000098f0: 7361 626c 6564 2066 6f72 2065 7869 7374  sabled for exist
+00009900: 696e 6720 7374 7265 616d 7320 6279 2073  ing streams by s
+00009910: 6574 7469 6e67 2074 6865 2076 616c 7565  etting the value
+00009920: 206f 6620 7468 6520 6063 7572 7265 6e74   of the `current
+00009930: 5f76 6572 7369 6f6e 600a 6172 6775 6d65  _version`.argume
+00009940: 6e74 2074 6f20 7468 6520 636f 6e73 7461  nt to the consta
+00009950: 6e74 2060 5374 7265 616d 5374 6174 652e  nt `StreamState.
+00009960: 4558 4953 5453 602e 0a0a 5468 6520 7265  EXISTS`...The re
+00009970: 7175 6972 6564 2060 6576 656e 7473 6020  quired `events` 
+00009980: 6172 6775 6d65 6e74 2069 7320 6578 7065  argument is expe
+00009990: 6374 6564 2074 6f20 6265 2061 2073 6571  cted to be a seq
+000099a0: 7565 6e63 6520 6f66 206e 6577 2065 7665  uence of new eve
+000099b0: 6e74 206f 626a 6563 7473 2e20 5468 650a  nt objects. The.
+000099c0: 604e 6577 4576 656e 7460 2063 6c61 7373  `NewEvent` class
+000099d0: 2073 686f 756c 6420 6265 2075 7365 6420   should be used 
+000099e0: 746f 2063 6f6e 7374 7275 6374 206e 6577  to construct new
+000099f0: 2065 7665 6e74 206f 626a 6563 7473 2e20   event objects. 
+00009a00: 5468 6520 6061 7070 656e 645f 746f 5f73  The `append_to_s
+00009a10: 7472 6561 6d28 2960 0a6f 7065 7261 7469  tream()`.operati
+00009a20: 6f6e 2069 7320 6174 6f6d 6963 2c20 736f  on is atomic, so
+00009a30: 2074 6861 7420 6569 7468 6572 2061 6c6c   that either all
+00009a40: 206f 7220 6e6f 6e65 206f 6620 7468 6520   or none of the 
+00009a50: 6e65 7720 6576 656e 7473 2077 696c 6c20  new events will 
+00009a60: 6265 2072 6563 6f72 6465 642e 2049 740a  be recorded. It.
+00009a70: 6973 206e 6f74 2070 6f73 7369 626c 6520  is not possible 
+00009a80: 7769 7468 2045 7665 6e74 5374 6f72 6544  with EventStoreD
+00009a90: 4220 6174 6f6d 6963 616c 6c79 2074 6f20  B atomically to 
+00009aa0: 7265 636f 7264 206e 6577 2065 7665 6e74  record new event
+00009ab0: 7320 696e 206d 6f72 6520 7468 616e 206f  s in more than o
+00009ac0: 6e65 2073 7472 6561 6d2e 0a0a 5468 6973  ne stream...This
+00009ad0: 206d 6574 686f 6420 6861 7320 616e 206f   method has an o
+00009ae0: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+00009af0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+00009b00: 6820 6973 2061 2050 7974 686f 6e20 6066  h is a Python `f
+00009b10: 6c6f 6174 600a 7468 6174 2073 6574 7320  loat`.that sets 
+00009b20: 6120 6d61 7869 6d75 6d20 6475 7261 7469  a maximum durati
+00009b30: 6f6e 2c20 696e 2073 6563 6f6e 6473 2c20  on, in seconds, 
+00009b40: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+00009b50: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+00009b60: 7065 7261 7469 6f6e 2e0a 0a54 6869 7320  peration...This 
+00009b70: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
+00009b80: 7469 6f6e 616c 2060 6372 6564 656e 7469  tional `credenti
+00009b90: 616c 7360 2061 7267 756d 656e 742c 2077  als` argument, w
+00009ba0: 6869 6368 2063 616e 2062 6520 7573 6564  hich can be used
+00009bb0: 2074 6f0a 6f76 6572 7269 6465 2063 616c   to.override cal
+00009bc0: 6c20 6372 6564 656e 7469 616c 7320 6465  l credentials de
+00009bd0: 7269 7665 6420 6672 6f6d 2074 6865 2063  rived from the c
+00009be0: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00009bf0: 2055 5249 2e0a 0a49 6e20 7468 6520 6578   URI...In the ex
+00009c00: 616d 706c 6520 6265 6c6f 772c 2061 206e  ample below, a n
+00009c10: 6577 2065 7665 6e74 2c20 6065 7665 6e74  ew event, `event
+00009c20: 3160 2c20 6973 2061 7070 656e 6465 6420  1`, is appended 
+00009c30: 746f 2061 206e 6577 2073 7472 6561 6d2e  to a new stream.
+00009c40: 2054 6865 2073 7472 6561 6d0a 646f 6573   The stream.does
+00009c50: 206e 6f74 2079 6574 2065 7869 7374 2c20   not yet exist, 
+00009c60: 736f 2060 6375 7272 656e 745f 7665 7273  so `current_vers
+00009c70: 696f 6e60 2069 7320 6053 7472 6561 6d53  ion` is `StreamS
+00009c80: 7461 7465 2e4e 4f5f 5354 5245 414d 602e  tate.NO_STREAM`.
+00009c90: 0a0a 6060 6070 7974 686f 6e0a 2320 436f  ..```python.# Co
+00009ca0: 6e73 7472 7563 7420 6120 6e65 7720 6576  nstruct a new ev
+00009cb0: 656e 7420 6f62 6a65 6374 2e0a 6576 656e  ent object..even
+00009cc0: 7431 203d 204e 6577 4576 656e 7428 7479  t1 = NewEvent(ty
+00009cd0: 7065 3d27 4f72 6465 7243 7265 6174 6564  pe='OrderCreated
+00009ce0: 272c 2064 6174 613d 6227 7b7d 2729 0a0a  ', data=b'{}')..
+00009cf0: 2320 4465 6669 6e65 2061 206e 6577 2073  # Define a new s
+00009d00: 7472 6561 6d20 6e61 6d65 2e0a 7374 7265  tream name..stre
+00009d10: 616d 5f6e 616d 6531 203d 2073 7472 2875  am_name1 = str(u
+00009d20: 7569 642e 7575 6964 3428 2929 0a0a 2320  uid.uuid4())..# 
+00009d30: 4170 7065 6e64 2074 6865 206e 6577 2065  Append the new e
+00009d40: 7665 6e74 7320 746f 2074 6865 206e 6577  vents to the new
+00009d50: 2073 7472 6561 6d2e 0a63 6f6d 6d69 745f   stream..commit_
+00009d60: 706f 7369 7469 6f6e 3120 3d20 636c 6965  position1 = clie
+00009d70: 6e74 2e61 7070 656e 645f 746f 5f73 7472  nt.append_to_str
+00009d80: 6561 6d28 0a20 2020 2073 7472 6561 6d5f  eam(.    stream_
+00009d90: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00009da0: 312c 0a20 2020 2063 7572 7265 6e74 5f76  1,.    current_v
+00009db0: 6572 7369 6f6e 3d53 7472 6561 6d53 7461  ersion=StreamSta
+00009dc0: 7465 2e4e 4f5f 5354 5245 414d 2c0a 2020  te.NO_STREAM,.  
+00009dd0: 2020 6576 656e 7473 3d5b 6576 656e 7431    events=[event1
+00009de0: 5d2c 0a29 0a60 6060 0a0a 496e 2074 6865  ],.).```..In the
+00009df0: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
+00009e00: 7477 6f20 7375 6273 6571 7565 6e74 2065  two subsequent e
+00009e10: 7665 6e74 7320 6172 6520 6170 7065 6e64  vents are append
+00009e20: 6564 2074 6f20 616e 2065 7869 7374 696e  ed to an existin
+00009e30: 670a 7374 7265 616d 2e20 5468 6520 7374  g.stream. The st
+00009e40: 7265 616d 2068 6173 206f 6e65 2072 6563  ream has one rec
+00009e50: 6f72 6465 6420 6576 656e 742c 2073 6f20  orded event, so 
+00009e60: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
+00009e70: 6020 6973 2060 3060 2e0a 0a60 6060 7079  ` is `0`...```py
+00009e80: 7468 6f6e 0a65 7665 6e74 3220 3d20 4e65  thon.event2 = Ne
+00009e90: 7745 7665 6e74 2874 7970 653d 274f 7264  wEvent(type='Ord
+00009ea0: 6572 5570 6461 7465 6427 2c20 6461 7461  erUpdated', data
+00009eb0: 3d62 277b 7d27 290a 6576 656e 7433 203d  =b'{}').event3 =
+00009ec0: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
+00009ed0: 4f72 6465 7244 656c 6574 6564 272c 2064  OrderDeleted', d
+00009ee0: 6174 613d 6227 7b7d 2729 0a0a 636f 6d6d  ata=b'{}')..comm
+00009ef0: 6974 5f70 6f73 6974 696f 6e32 203d 2063  it_position2 = c
+00009f00: 6c69 656e 742e 6170 7065 6e64 5f74 6f5f  lient.append_to_
+00009f10: 7374 7265 616d 280a 2020 2020 7374 7265  stream(.    stre
+00009f20: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00009f30: 616d 6531 2c0a 2020 2020 6375 7272 656e  ame1,.    curren
+00009f40: 745f 7665 7273 696f 6e3d 302c 0a20 2020  t_version=0,.   
+00009f50: 2065 7665 6e74 733d 5b65 7665 6e74 322c   events=[event2,
+00009f60: 2065 7665 6e74 335d 2c0a 290a 6060 600a   event3],.).```.
+00009f70: 0a54 6865 2072 6574 7572 6e65 6420 7661  .The returned va
+00009f80: 6c75 6573 2c20 6063 6f6d 6d69 745f 706f  lues, `commit_po
+00009f90: 7369 7469 6f6e 3160 2061 6e64 2060 636f  sition1` and `co
+00009fa0: 6d6d 6974 5f70 6f73 6974 696f 6e32 602c  mmit_position2`,
+00009fb0: 2061 7265 2074 6865 0a63 6f6d 6d69 7420   are the.commit 
+00009fc0: 706f 7369 7469 6f6e 7320 696e 2074 6865  positions in the
+00009fd0: 2064 6174 6162 6173 6520 6f66 2074 6865   database of the
+00009fe0: 206c 6173 7420 6576 656e 7473 2069 6e20   last events in 
+00009ff0: 7468 6520 7265 636f 7264 6564 2073 6571  the recorded seq
+0000a000: 7565 6e63 6573 2e0a 5468 6174 2069 732c  uences..That is,
+0000a010: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+0000a020: 6e31 6020 6973 2074 6865 2063 6f6d 6d69  n1` is the commi
+0000a030: 7420 706f 7369 7469 6f6e 206f 6620 6065  t position of `e
+0000a040: 7665 6e74 3160 2061 6e64 0a60 636f 6d6d  vent1` and.`comm
+0000a050: 6974 5f70 6f73 6974 696f 6e32 6020 6973  it_position2` is
+0000a060: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+0000a070: 7469 6f6e 206f 6620 6065 7665 6e74 3360  tion of `event3`
+0000a080: 2e0a 0a43 6f6d 6d69 7420 706f 7369 7469  ...Commit positi
+0000a090: 6f6e 7320 7468 6174 2061 7265 2072 6574  ons that are ret
+0000a0a0: 7572 6e65 6420 696e 2074 6869 7320 7761  urned in this wa
+0000a0b0: 7920 6361 6e20 6265 2075 7365 6420 6279  y can be used by
+0000a0c0: 2061 2075 7365 7220 696e 7465 7266 6163   a user interfac
+0000a0d0: 6520 746f 2070 6f6c 6c0a 6120 646f 776e  e to poll.a down
+0000a0e0: 7374 7265 616d 2063 6f6d 706f 6e65 6e74  stream component
+0000a0f0: 2075 6e74 696c 2069 7420 6861 7320 7072   until it has pr
+0000a100: 6f63 6573 7365 6420 616c 6c20 7468 6520  ocessed all the 
+0000a110: 6e65 776c 7920 7265 636f 7264 6564 2065  newly recorded e
+0000a120: 7665 6e74 732e 2046 6f72 2065 7861 6d70  vents. For examp
+0000a130: 6c65 2c0a 636f 6e73 6964 6572 2061 2075  le,.consider a u
+0000a140: 7365 7220 696e 7465 7266 6163 6520 636f  ser interface co
+0000a150: 6d6d 616e 6420 7468 6174 2072 6573 756c  mmand that resul
+0000a160: 7473 2069 6e20 7468 6520 7265 636f 7264  ts in the record
+0000a170: 696e 6720 6f66 206e 6577 2065 7665 6e74  ing of new event
+0000a180: 732c 2061 6e64 2061 6e0a 6576 656e 7475  s, and an.eventu
+0000a190: 616c 6c79 2063 6f6e 7369 7374 656e 7420  ally consistent 
+0000a1a0: 6d61 7465 7269 616c 697a 6564 2076 6965  materialized vie
+0000a1b0: 7720 696e 2061 2064 6f77 6e73 7472 6561  w in a downstrea
+0000a1c0: 6d20 636f 6d70 6f6e 656e 7420 7468 6174  m component that
+0000a1d0: 2069 7320 7570 6461 7465 6420 6672 6f6d   is updated from
+0000a1e0: 0a74 6865 7365 2065 7665 6e74 732e 2049  .these events. I
+0000a1f0: 6620 7468 6520 6e65 7720 6576 656e 7473  f the new events
+0000a200: 2068 6176 6520 6e6f 7420 7965 7420 6265   have not yet be
+0000a210: 656e 2070 726f 6365 7373 6564 2c20 7468  en processed, th
+0000a220: 6520 7669 6577 206d 6967 6874 2062 6520  e view might be 
+0000a230: 7374 616c 652c 0a6f 7220 6f75 742d 6f66  stale,.or out-of
+0000a240: 2d64 6174 652e 2049 6e73 7465 6164 206f  -date. Instead o
+0000a250: 6620 6469 7370 6c61 7969 6e67 2061 2073  f displaying a s
+0000a260: 7461 6c65 2076 6965 772c 2074 6865 2075  tale view, the u
+0000a270: 7365 7220 696e 7465 7266 6163 6520 6361  ser interface ca
+0000a280: 6e20 706f 6c6c 2074 6865 0a64 6f77 6e73  n poll the.downs
+0000a290: 7472 6561 6d20 636f 6d70 6f6e 656e 7420  tream component 
+0000a2a0: 756e 7469 6c20 6974 2068 6173 2070 726f  until it has pro
+0000a2b0: 6365 7373 6564 2074 6865 206e 6577 6c79  cessed the newly
+0000a2c0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000a2d0: 2c20 616e 6420 7468 656e 2064 6973 706c  , and then displ
+0000a2e0: 6179 0a61 6e20 7570 2d74 6f2d 6461 7465  ay.an up-to-date
+0000a2f0: 2076 6965 7720 746f 2074 6865 2075 7365   view to the use
+0000a300: 722e 0a0a 0a23 2323 2049 6465 6d70 6f74  r....### Idempot
+0000a310: 656e 7420 6170 7065 6e64 206f 7065 7261  ent append opera
+0000a320: 7469 6f6e 733c 6120 6964 3d22 6964 656d  tions<a id="idem
+0000a330: 706f 7465 6e74 2d61 7070 656e 642d 6f70  potent-append-op
+0000a340: 6572 6174 696f 6e73 223e 3c2f 613e 0a0a  erations"></a>..
+0000a350: 5468 6520 6061 7070 656e 645f 746f 5f73  The `append_to_s
+0000a360: 7472 6561 6d28 2960 206d 6574 686f 6420  tream()` method 
+0000a370: 6973 2022 6964 656d 706f 7465 6e74 2220  is "idempotent" 
+0000a380: 7769 7468 2072 6573 7065 6374 2074 6f20  with respect to 
+0000a390: 7468 6520 6069 6460 2076 616c 7565 206f  the `id` value o
+0000a3a0: 6620 610a 604e 6577 4576 656e 7460 206f  f a.`NewEvent` o
+0000a3b0: 626a 6563 742e 2054 6861 7420 6973 2074  bject. That is t
+0000a3c0: 6f20 7361 792c 2069 6620 6061 7070 656e  o say, if `appen
+0000a3d0: 645f 746f 5f73 7472 6561 6d28 2960 2069  d_to_stream()` i
+0000a3e0: 7320 6361 6c6c 6564 2077 6974 6820 6576  s called with ev
+0000a3f0: 656e 7473 0a77 686f 7365 2060 6964 6020  ents.whose `id` 
+0000a400: 7661 6c75 6573 2061 7265 2065 7175 616c  values are equal
+0000a410: 2074 6f20 7468 6f73 6520 616c 7265 6164   to those alread
+0000a420: 7920 7265 636f 7264 6564 2069 6e20 7468  y recorded in th
+0000a430: 6520 7374 7265 616d 2c20 7468 656e 2074  e stream, then t
+0000a440: 6865 0a6d 6574 686f 6420 6361 6c6c 2077  he.method call w
+0000a450: 696c 6c20 7375 6363 6573 7366 756c 6c79  ill successfully
+0000a460: 2072 6574 7572 6e2c 2077 6974 6820 7468   return, with th
+0000a470: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+0000a480: 6e20 6f66 2074 6865 206c 6173 7420 6e65  n of the last ne
+0000a490: 7720 6576 656e 742c 0a77 6974 686f 7574  w event,.without
+0000a4a0: 206d 616b 696e 6720 616e 7920 6368 616e   making any chan
+0000a4b0: 6765 7320 746f 2074 6865 2064 6174 6162  ges to the datab
+0000a4c0: 6173 652e 0a0a 5468 6973 2069 7320 6265  ase...This is be
+0000a4d0: 6361 7573 6520 736f 6d65 7469 6d65 7320  cause sometimes 
+0000a4e0: 6974 206d 6179 2068 6170 7065 6e2c 2077  it may happen, w
+0000a4f0: 6865 6e20 6361 6c6c 696e 6720 6061 7070  hen calling `app
+0000a500: 656e 645f 746f 5f73 7472 6561 6d28 2960  end_to_stream()`
+0000a510: 2c20 7468 6174 2074 6865 206e 6577 0a65  , that the new.e
+0000a520: 7665 6e74 7320 6172 6520 7375 6363 6573  vents are succes
+0000a530: 7366 756c 6c79 2072 6563 6f72 6465 642c  sfully recorded,
+0000a540: 2062 7574 2073 6f6d 6568 6f77 2073 6f6d   but somehow som
+0000a550: 6574 6869 6e67 2062 6164 2068 6170 7065  ething bad happe
+0000a560: 6e73 2062 6566 6f72 6520 7468 6520 6d65  ns before the me
+0000a570: 7468 6f64 2063 616c 6c0a 6361 6e20 7265  thod call.can re
+0000a580: 7475 726e 2073 7563 6365 7373 6675 6c6c  turn successfull
+0000a590: 7920 746f 2074 6865 2063 616c 6c65 722e  y to the caller.
+0000a5a0: 2049 6e20 7468 6973 2063 6173 652c 2077   In this case, w
+0000a5b0: 6520 6361 6e6e 6f74 2062 6520 7375 7265  e cannot be sure
+0000a5c0: 2074 6861 7420 7468 6520 6576 656e 7473   that the events
+0000a5d0: 2068 6176 650a 696e 2066 6163 7420 6265   have.in fact be
+0000a5e0: 656e 2072 6563 6f72 6465 642c 2061 6e64  en recorded, and
+0000a5f0: 2073 6f20 7765 206d 6179 2077 6973 6820   so we may wish 
+0000a600: 746f 2072 6574 7279 2e0a 0a49 6620 7468  to retry...If th
+0000a610: 6520 6576 656e 7473 2077 6572 6520 696e  e events were in
+0000a620: 2066 6163 7420 7375 6363 6573 7366 756c   fact successful
+0000a630: 6c79 2072 6563 6f72 6465 642c 2069 7420  ly recorded, it 
+0000a640: 6973 2063 6f6e 7665 6e69 656e 7420 666f  is convenient fo
+0000a650: 7220 7468 6520 7265 7472 6965 6420 6d65  r the retried me
+0000a660: 7468 6f64 2063 616c 6c0a 746f 2072 6574  thod call.to ret
+0000a670: 7572 6e20 7375 6363 6573 7366 756c 6c79  urn successfully
+0000a680: 2c20 616e 6420 7769 7468 6f75 7420 6569  , and without ei
+0000a690: 7468 6572 2072 6169 7369 6e67 2061 6e20  ther raising an 
+0000a6a0: 6578 6365 7074 696f 6e20 2877 6865 6e20  exception (when 
+0000a6b0: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
+0000a6c0: 600a 6973 2065 6974 6865 7220 6053 7472  `.is either `Str
+0000a6d0: 6561 6d53 7461 7465 2e4e 4f5f 5354 5245  eamState.NO_STRE
+0000a6e0: 414d 6020 616e 2069 6e74 6567 6572 2076  AM` an integer v
+0000a6f0: 616c 7565 2920 6f72 2063 7265 6174 696e  alue) or creatin
+0000a700: 6720 6675 7274 6865 7220 6576 656e 7420  g further event 
+0000a710: 7265 636f 7264 730a 2877 6865 6e20 6063  records.(when `c
+0000a720: 7572 7265 6e74 5f76 6572 7369 6f6e 6020  urrent_version` 
+0000a730: 6973 2060 5374 7265 616d 5374 6174 652e  is `StreamState.
+0000a740: 414e 5960 206f 7220 6053 7472 6561 6d53  ANY` or `StreamS
+0000a750: 7461 7465 2e45 5849 5354 5360 292c 2061  tate.EXISTS`), a
+0000a760: 7320 6974 2077 6f75 6c64 0a69 6620 7468  s it would.if th
+0000a770: 6520 6061 7070 656e 645f 746f 5f73 7472  e `append_to_str
+0000a780: 6561 6d28 2960 206d 6574 686f 6420 7765  eam()` method we
+0000a790: 7265 206e 6f74 2069 6465 6d70 6f74 656e  re not idempoten
+0000a7a0: 742e 0a0a 4966 2074 6865 206d 6574 686f  t...If the metho
+0000a7b0: 6420 6361 6c6c 2069 6e69 7469 616c 6c79  d call initially
+0000a7c0: 2066 6169 6c65 6420 616e 6420 7468 6520   failed and the 
+0000a7d0: 6e65 7720 6576 656e 7473 2077 6572 6520  new events were 
+0000a7e0: 6e6f 7420 696e 2066 6163 7420 7265 636f  not in fact reco
+0000a7f0: 7264 6564 2c20 6974 0a6d 616b 6573 2067  rded, it.makes g
+0000a800: 6f6f 6420 7365 6e73 652c 2077 6865 6e20  ood sense, when 
+0000a810: 7468 6520 6d65 7468 6f64 2063 616c 6c20  the method call 
+0000a820: 6973 2072 6574 7269 6564 2c20 7468 6174  is retried, that
+0000a830: 2074 6865 206e 6577 2065 7665 6e74 7320   the new events 
+0000a840: 6172 6520 7265 636f 7264 6564 0a61 6e64  are recorded.and
+0000a850: 2074 6861 7420 7468 6520 6d65 7468 6f64   that the method
+0000a860: 2063 616c 6c20 7265 7475 726e 7320 7375   call returns su
+0000a870: 6363 6573 7366 756c 6c79 2e20 4966 2074  ccessfully. If t
+0000a880: 6865 2063 6f6e 6375 7272 656e 6379 2063  he concurrency c
+0000a890: 6f6e 7472 6f6c 7320 6861 7665 206e 6f74  ontrols have not
+0000a8a0: 2062 6565 6e20 6469 7361 626c 6564 2c0a   been disabled,.
+0000a8b0: 7468 6174 2069 7320 6966 2074 6865 2060  that is if the `
+0000a8c0: 6375 7272 656e 7420 7665 7273 696f 6e60  current version`
+0000a8d0: 2069 7320 6569 7468 6572 2060 5374 7265   is either `Stre
+0000a8e0: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
+0000a8f0: 4d60 206f 7220 616e 2069 6e74 6567 6572  M` or an integer
+0000a900: 2076 616c 7565 2c20 616e 640a 6966 2061   value, and.if a
+0000a910: 2060 5772 6f6e 6743 7572 7265 6e74 5665   `WrongCurrentVe
+0000a920: 7273 696f 6e60 2065 7863 6570 7469 6f6e  rsion` exception
+0000a930: 2069 7320 7261 6973 6564 2077 6865 6e20   is raised when 
+0000a940: 7265 7472 7969 6e67 2074 6865 206d 6574  retrying the met
+0000a950: 686f 6420 6361 6c6c 2c20 7468 656e 2077  hod call, then w
+0000a960: 6520 6361 6e20 6173 7375 6d65 0a62 6f74  e can assume.bot
+0000a970: 6820 7468 6174 2074 6865 2069 6e69 7469  h that the initi
+0000a980: 616c 206d 6574 686f 6420 6361 6c6c 2064  al method call d
+0000a990: 6964 206e 6f74 2069 6e20 6661 6374 2073  id not in fact s
+0000a9a0: 7563 6365 7373 6675 6c6c 7920 7265 636f  uccessfully reco
+0000a9b0: 7264 2074 6865 2065 7665 6e74 732c 2061  rd the events, a
+0000a9c0: 6e64 2061 6c73 6f0a 7468 6174 2073 7562  nd also.that sub
+0000a9d0: 7365 7175 656e 7420 6576 656e 7473 2068  sequent events h
+0000a9e0: 6176 6520 696e 2074 6865 206d 6561 6e74  ave in the meant
+0000a9f0: 696d 6520 6265 656e 2072 6563 6f72 6465  ime been recorde
+0000aa00: 6420 6279 2073 6f6d 6562 6f64 7920 656c  d by somebody el
+0000aa10: 7365 2e20 496e 2074 6869 7320 6361 7365  se. In this case
+0000aa20: 2c0a 616e 2061 7070 6c69 6361 7469 6f6e  ,.an application
+0000aa30: 2063 6f6d 6d61 6e64 2077 6869 6368 2067   command which g
+0000aa40: 656e 6572 6174 6564 2074 6865 206e 6577  enerated the new
+0000aa50: 2065 7665 6e74 7320 6d61 7920 6e65 6564   events may need
+0000aa60: 2074 6f20 6265 2065 7865 6375 7465 6420   to be executed 
+0000aa70: 6167 6169 6e2e 2041 6e64 0a74 6865 2075  again. And.the u
+0000aa80: 7365 7220 6f66 2074 6865 2061 7070 6c69  ser of the appli
+0000aa90: 6361 7469 6f6e 206d 6179 206e 6565 6420  cation may need 
+0000aaa0: 746f 2062 6520 6769 7665 6e20 616e 206f  to be given an o
+0000aab0: 7070 6f72 7475 6e69 7479 2074 6f20 6465  pportunity to de
+0000aac0: 6369 6465 2069 6620 7468 6579 2073 7469  cide if they sti
+0000aad0: 6c6c 2077 6973 6820 746f 0a70 726f 6365  ll wish to.proce
+0000aae0: 6564 2077 6974 6820 7468 6569 7220 6f72  ed with their or
+0000aaf0: 6967 696e 616c 2069 6e74 656e 7469 6f6e  iginal intention
+0000ab00: 2c20 6279 2064 6973 706c 6179 696e 6720  , by displaying 
+0000ab10: 6120 7375 6974 6162 6c65 2065 7272 6f72  a suitable error
+0000ab20: 2077 6974 6820 616e 2075 702d 746f 2d64   with an up-to-d
+0000ab30: 6174 6520 7669 6577 206f 660a 7468 6520  ate view of.the 
+0000ab40: 7265 636f 7264 6564 2073 7461 7465 2e20  recorded state. 
+0000ab50: 496e 2074 6865 2063 6173 6520 7768 6572  In the case wher
+0000ab60: 6520 636f 6e63 7572 7265 6e63 7920 636f  e concurrency co
+0000ab70: 6e74 726f 6c73 2068 6176 6520 6265 656e  ntrols have been
+0000ab80: 2064 6973 6162 6c65 642c 2062 7920 7573   disabled, by us
+0000ab90: 696e 6720 6053 7472 6561 6d53 7461 7465  ing `StreamState
+0000aba0: 2e41 4e59 6020 6f72 0a60 5374 7265 616d  .ANY` or.`Stream
+0000abb0: 5374 6174 652e 4558 4953 5453 6020 6173  State.EXISTS` as
+0000abc0: 2074 6865 2076 616c 7565 206f 6620 6063   the value of `c
+0000abd0: 7572 7265 6e74 5f70 6f73 6974 696f 6e60  urrent_position`
+0000abe0: 2c20 7265 7472 7969 6e67 2061 206d 6574  , retrying a met
+0000abf0: 686f 6420 6361 6c6c 2074 6861 7420 6661  hod call that fa
+0000ac00: 696c 6564 2074 6f0a 7265 7475 726e 2073  iled to.return s
+0000ac10: 7563 6365 7373 6675 6c6c 7920 7769 6c6c  uccessfully will
+0000ac20: 2c20 6d6f 7265 2073 696d 706c 792c 206a  , more simply, j
+0000ac30: 7573 7420 6174 7465 6d70 7420 746f 2065  ust attempt to e
+0000ac40: 6e73 7572 6520 7468 6520 6e65 7720 6576  nsure the new ev
+0000ac50: 656e 7473 2061 7265 2072 6563 6f72 6465  ents are recorde
+0000ac60: 642c 2072 6567 6172 646c 6573 730a 6f66  d, regardless.of
+0000ac70: 2074 6865 6972 2072 6573 756c 7469 6e67   their resulting
+0000ac80: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+0000ac90: 732e 2049 6e20 6569 7468 6572 2063 6173  s. In either cas
+0000aca0: 652c 2077 6865 6e20 7468 6520 6d65 7468  e, when the meth
+0000acb0: 6f64 2063 616c 6c20 646f 6573 2072 6574  od call does ret
+0000acc0: 7572 6e20 7375 6363 6573 7366 756c 6c79  urn successfully
+0000acd0: 2c20 7765 0a63 616e 2062 6520 7375 7265  , we.can be sure
+0000ace0: 2074 6865 2065 7665 6e74 7320 6861 7665   the events have
+0000acf0: 2062 6565 6e20 7265 636f 7264 6564 2e0a   been recorded..
+0000ad00: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+0000ad10: 6f77 2073 686f 7773 2074 6865 2060 6170  ow shows the `ap
+0000ad20: 7065 6e64 5f74 6f5f 7374 7265 616d 2829  pend_to_stream()
+0000ad30: 6020 6d65 7468 6f64 2062 6569 6e67 2063  ` method being c
+0000ad40: 616c 6c65 6420 6167 6169 6e20 7769 7468  alled again with
+0000ad50: 2065 7665 6e74 730a 6065 7665 6e74 3260   events.`event2`
+0000ad60: 2061 6e64 2060 6576 656e 7433 602c 2061   and `event3`, a
+0000ad70: 6e64 2077 6974 6820 6063 7572 7265 6e74  nd with `current
+0000ad80: 5f76 6572 7369 6f6e 3d30 602e 2057 6520  _version=0`. We 
+0000ad90: 6361 6e20 7365 6520 7468 6174 2072 6570  can see that rep
+0000ada0: 6561 7469 6e67 2074 6865 2063 616c 6c0a  eating the call.
+0000adb0: 746f 2060 6170 7065 6e64 5f74 6f5f 7374  to `append_to_st
+0000adc0: 7265 616d 2829 6020 7265 7475 726e 7320  ream()` returns 
+0000add0: 7375 6363 6573 7366 756c 6c79 2077 6974  successfully wit
+0000ade0: 686f 7574 2072 6169 7369 6e67 2061 2060  hout raising a `
+0000adf0: 5772 6f6e 6743 7572 7265 6e74 5665 7273  WrongCurrentVers
+0000ae00: 696f 6e60 0a65 7863 6570 7469 6f6e 2c20  ion`.exception, 
+0000ae10: 6173 2069 7420 776f 756c 6420 6966 2074  as it would if t
+0000ae20: 6865 2060 6170 7065 6e64 5f74 6f5f 7374  he `append_to_st
+0000ae30: 7265 616d 2829 6020 6f70 6572 6174 696f  ream()` operatio
+0000ae40: 6e20 7765 7265 206e 6f74 2069 6465 6d70  n were not idemp
+0000ae50: 6f74 656e 742e 0a0a 6060 6070 7974 686f  otent...```pytho
+0000ae60: 6e0a 2320 5265 7472 7920 6170 7065 6e64  n.# Retry append
+0000ae70: 696e 6720 6576 656e 7433 2e0a 636f 6d6d  ing event3..comm
+0000ae80: 6974 5f70 6f73 6974 696f 6e5f 7265 7472  it_position_retr
+0000ae90: 7920 3d20 636c 6965 6e74 2e61 7070 656e  y = client.appen
+0000aea0: 645f 746f 5f73 7472 6561 6d28 0a20 2020  d_to_stream(.   
+0000aeb0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+0000aec0: 6561 6d5f 6e61 6d65 312c 0a20 2020 2063  eam_name1,.    c
+0000aed0: 7572 7265 6e74 5f76 6572 7369 6f6e 3d30  urrent_version=0
+0000aee0: 2c0a 2020 2020 6576 656e 7473 3d5b 6576  ,.    events=[ev
+0000aef0: 656e 7432 2c20 6576 656e 7433 5d2c 0a29  ent2, event3],.)
+0000af00: 0a60 6060 0a0a 5765 2063 616e 2073 6565  .```..We can see
+0000af10: 2074 6861 7420 7468 6520 7361 6d65 2063   that the same c
+0000af20: 6f6d 6d69 7420 706f 7369 7469 6f6e 2069  ommit position i
+0000af30: 7320 7265 7475 726e 6564 2061 7320 6162  s returned as ab
+0000af40: 6f76 652e 0a0a 6060 6070 7974 686f 6e0a  ove...```python.
+0000af50: 6173 7365 7274 2063 6f6d 6d69 745f 706f  assert commit_po
+0000af60: 7369 7469 6f6e 5f72 6574 7279 203d 3d20  sition_retry == 
+0000af70: 636f 6d6d 6974 5f70 6f73 6974 696f 6e32  commit_position2
+0000af80: 0a60 6060 0a0a 5468 6520 6578 616d 706c  .```..The exampl
+0000af90: 6520 6265 6c6f 7720 7368 6f77 7320 7468  e below shows th
+0000afa0: 6520 6061 7070 656e 645f 746f 5f73 7472  e `append_to_str
+0000afb0: 6561 6d28 2960 206d 6574 686f 6420 6265  eam()` method be
+0000afc0: 696e 6720 6361 6c6c 6564 2061 6761 696e  ing called again
+0000afd0: 2077 6974 6820 6576 656e 7473 0a60 6576   with events.`ev
+0000afe0: 656e 7432 6020 616e 6420 6065 7665 6e74  ent2` and `event
+0000aff0: 3360 2c20 7769 7468 2061 6e64 2060 6375  3`, with and `cu
+0000b000: 7272 656e 745f 7665 7273 696f 6e3d 5374  rrent_version=St
+0000b010: 7265 616d 5374 6174 652e 414e 5960 2e0a  reamState.ANY`..
+0000b020: 0a60 6060 7079 7468 6f6e 0a23 2052 6574  .```python.# Ret
+0000b030: 7279 2061 7070 656e 6469 6e67 2065 7665  ry appending eve
+0000b040: 6e74 332e 0a63 6f6d 6d69 745f 706f 7369  nt3..commit_posi
+0000b050: 7469 6f6e 5f72 6574 7279 203d 2063 6c69  tion_retry = cli
+0000b060: 656e 742e 6170 7065 6e64 5f74 6f5f 7374  ent.append_to_st
+0000b070: 7265 616d 280a 2020 2020 7374 7265 616d  ream(.    stream
+0000b080: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+0000b090: 6531 2c0a 2020 2020 6375 7272 656e 745f  e1,.    current_
+0000b0a0: 7665 7273 696f 6e3d 302c 0a20 2020 2065  version=0,.    e
+0000b0b0: 7665 6e74 733d 5b65 7665 6e74 322c 2065  vents=[event2, e
+0000b0c0: 7665 6e74 335d 2c0a 290a 6060 600a 0a57  vent3],.).```..W
+0000b0d0: 6520 6361 6e20 7365 6520 7468 6174 2074  e can see that t
+0000b0e0: 6865 2073 616d 6520 636f 6d6d 6974 2070  he same commit p
+0000b0f0: 6f73 6974 696f 6e20 6973 2072 6574 7572  osition is retur
+0000b100: 6e65 6420 6173 2061 626f 7665 2e0a 0a60  ned as above...`
+0000b110: 6060 7079 7468 6f6e 0a61 7373 6572 7420  ``python.assert 
+0000b120: 636f 6d6d 6974 5f70 6f73 6974 696f 6e5f  commit_position_
+0000b130: 7265 7472 7920 3d3d 2063 6f6d 6d69 745f  retry == commit_
+0000b140: 706f 7369 7469 6f6e 320a 6060 600a 0a42  position2.```..B
+0000b150: 7920 6361 6c6c 696e 6720 6067 6574 5f73  y calling `get_s
+0000b160: 7472 6561 6d28 2960 2c20 7765 2063 616e  tream()`, we can
+0000b170: 2061 6c73 6f20 7365 6520 7468 6520 7374   also see the st
+0000b180: 7265 616d 2068 6173 2062 6565 6e20 756e  ream has been un
+0000b190: 6368 616e 6765 642e 0a54 6861 7420 6973  changed..That is
+0000b1a0: 2c20 7468 6572 6520 6172 6520 7374 696c  , there are stil
+0000b1b0: 6c20 6f6e 6c79 2074 6872 6565 2065 7665  l only three eve
+0000b1c0: 6e74 7320 696e 2074 6865 2073 7472 6561  nts in the strea
+0000b1d0: 6d2e 0a0a 6060 6070 7974 686f 6e0a 6576  m...```python.ev
+0000b1e0: 656e 7473 203d 2063 6c69 656e 742e 6765  ents = client.ge
+0000b1f0: 745f 7374 7265 616d 280a 2020 2020 7374  t_stream(.    st
+0000b200: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+0000b210: 5f6e 616d 6531 0a29 0a0a 6173 7365 7274  _name1.)..assert
+0000b220: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
+0000b230: 330a 6060 600a 0a54 6869 7320 6964 656d  3.```..This idem
+0000b240: 706f 7465 6e74 2062 6568 6176 696f 7572  potent behaviour
+0000b250: 2064 6570 656e 6473 206f 6e20 7468 6520   depends on the 
+0000b260: 6069 6460 2061 7474 7269 6275 7465 206f  `id` attribute o
+0000b270: 6620 7468 6520 604e 6577 4576 656e 7460  f the `NewEvent`
+0000b280: 2063 6c61 7373 2e0a 5468 6973 2061 7474   class..This att
+0000b290: 7269 6275 7465 2069 732c 2062 7920 6465  ribute is, by de
+0000b2a0: 6661 756c 742c 2061 7373 6967 6e65 6420  fault, assigned 
+0000b2b0: 6120 6e65 7720 616e 6420 756e 6971 7565  a new and unique
+0000b2c0: 2076 6572 7369 6f6e 2d34 2055 5549 4420   version-4 UUID 
+0000b2d0: 7768 656e 2061 6e0a 696e 7374 616e 6365  when an.instance
+0000b2e0: 206f 6620 604e 6577 4576 656e 7460 2069   of `NewEvent` i
+0000b2f0: 7320 636f 6e73 7472 7563 7465 642e 2054  s constructed. T
+0000b300: 6f20 7365 7420 7468 6520 6069 6460 2076  o set the `id` v
+0000b310: 616c 7565 206f 6620 6120 604e 6577 4576  alue of a `NewEv
+0000b320: 656e 7460 2c0a 7468 6520 6f70 7469 6f6e  ent`,.the option
+0000b330: 616c 2060 6964 6020 636f 6e73 7472 7563  al `id` construc
+0000b340: 746f 7220 6172 6775 6d65 6e74 2063 616e  tor argument can
+0000b350: 2062 6520 7573 6564 2077 6865 6e20 636f   be used when co
+0000b360: 6e73 7472 7563 7469 6e67 2060 4e65 7745  nstructing `NewE
+0000b370: 7665 6e74 6020 6f62 6a65 6374 732e 0a0a  vent` objects...
+0000b380: 0a23 2323 2052 6561 6420 7374 7265 616d  .### Read stream
+0000b390: 2065 7665 6e74 733c 6120 6964 3d22 7265   events<a id="re
+0000b3a0: 6164 2d73 7472 6561 6d2d 6576 656e 7473  ad-stream-events
+0000b3b0: 223e 3c2f 613e 0a0a 5468 6520 6072 6561  "></a>..The `rea
+0000b3c0: 645f 7374 7265 616d 2829 6020 6d65 7468  d_stream()` meth
+0000b3d0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+0000b3e0: 6f20 6765 7420 6576 656e 7473 2074 6861  o get events tha
+0000b3f0: 7420 6861 7665 2062 6565 6e20 6170 7065  t have been appe
+0000b400: 6e64 6564 0a74 6f20 6120 7374 7265 616d  nded.to a stream
+0000b410: 2e20 5468 6973 206d 6574 686f 6420 7265  . This method re
+0000b420: 7475 726e 7320 6120 2272 6561 6420 7265  turns a "read re
+0000b430: 7370 6f6e 7365 2220 6f62 6a65 6374 2e0a  sponse" object..
+0000b440: 0a41 2022 7265 6164 2072 6573 706f 6e73  .A "read respons
+0000b450: 6522 206f 626a 6563 7420 6973 2061 2050  e" object is a P
+0000b460: 7974 686f 6e20 6974 6572 6174 6f72 2e20  ython iterator. 
+0000b470: 5265 636f 7264 6564 2065 7665 6e74 7320  Recorded events 
+0000b480: 6361 6e20 6265 0a6f 6274 6169 6e65 6420  can be.obtained 
+0000b490: 6279 2069 7465 7261 7469 6e67 206f 7665  by iterating ove
+0000b4a0: 7220 7468 6520 2272 6561 6420 7265 7370  r the "read resp
+0000b4b0: 6f6e 7365 2220 6f62 6a65 6374 2e20 5265  onse" object. Re
+0000b4c0: 636f 7264 6564 2065 7665 6e74 7320 6172  corded events ar
+0000b4d0: 650a 7374 7265 616d 6564 2066 726f 6d20  e.streamed from 
+0000b4e0: 7468 6520 7365 7276 6572 2074 6f20 7468  the server to th
+0000b4f0: 6520 636c 6965 6e74 2061 7320 7468 6520  e client as the 
+0000b500: 6974 6572 6174 696f 6e20 7072 6f63 6565  iteration procee
+0000b510: 6473 2e20 5468 6520 6974 6572 6174 696f  ds. The iteratio
+0000b520: 6e0a 7769 6c6c 2061 7574 6f6d 6174 6963  n.will automatic
+0000b530: 616c 6c79 2073 746f 7020 7768 656e 2074  ally stop when t
+0000b540: 6865 7265 2061 7265 206e 6f20 6d6f 7265  here are no more
+0000b550: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000b560: 2074 6f20 6265 2072 6574 7572 6e65 642e   to be returned.
+0000b570: 0a54 6865 2073 7472 6561 6d69 6e67 206f  .The streaming o
+0000b580: 6620 6576 656e 7473 2c20 616e 6420 6865  f events, and he
+0000b590: 6e63 6520 7468 6520 6974 6572 6174 6f72  nce the iterator
+0000b5a0: 2c20 6361 6e20 616c 736f 2062 6520 7374  , can also be st
+0000b5b0: 6f70 7065 6420 6279 2063 616c 6c69 6e67  opped by calling
+0000b5c0: 0a74 6865 2060 7374 6f70 2829 6020 6d65  .the `stop()` me
+0000b5d0: 7468 6f64 206f 6e20 7468 6520 2272 6561  thod on the "rea
+0000b5e0: 6420 7265 7370 6f6e 7365 2220 6f62 6a65  d response" obje
+0000b5f0: 6374 2e0a 0a54 6865 2060 6765 745f 7374  ct...The `get_st
+0000b600: 7265 616d 2829 6020 6d65 7468 6f64 2063  ream()` method c
+0000b610: 616e 2062 6520 7573 6564 2074 6f20 6765  an be used to ge
+0000b620: 7420 6576 656e 7473 2074 6861 7420 6861  t events that ha
+0000b630: 7665 2062 6565 6e20 6170 7065 6e64 6564  ve been appended
+0000b640: 0a74 6f20 6120 7374 7265 616d 2e20 5468  .to a stream. Th
+0000b650: 6973 206d 6574 686f 6420 7265 7475 726e  is method return
+0000b660: 7320 6120 5079 7468 6f6e 2060 7475 706c  s a Python `tupl
+0000b670: 6560 206f 6620 7265 636f 7264 6564 2065  e` of recorded e
+0000b680: 7665 6e74 206f 626a 6563 7473 2e0a 5468  vent objects..Th
+0000b690: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+0000b6a0: 206f 626a 6563 7473 2061 7265 2069 6e73   objects are ins
+0000b6b0: 7461 6e63 6573 206f 6620 7468 6520 6052  tances of the `R
+0000b6c0: 6563 6f72 6465 6445 7665 6e74 6020 636c  ecordedEvent` cl
+0000b6d0: 6173 732e 2049 740a 6361 6c6c 7320 6072  ass. It.calls `r
+0000b6e0: 6561 645f 7374 7265 616d 2829 6020 616e  ead_stream()` an
+0000b6f0: 6420 7061 7373 6573 2074 6865 2022 7265  d passes the "re
+0000b700: 6164 2072 6573 706f 6e73 6522 2069 7465  ad response" ite
+0000b710: 7261 746f 7220 696e 746f 2061 2050 7974  rator into a Pyt
+0000b720: 686f 6e0a 6074 7570 6c65 602c 2073 6f20  hon.`tuple`, so 
+0000b730: 7468 6174 2074 6865 2073 7472 6561 6d69  that the streami
+0000b740: 6e67 2077 696c 6c20 636f 6d70 6c65 7465  ng will complete
+0000b750: 2062 6566 6f72 6520 7468 6520 6d65 7468   before the meth
+0000b760: 6f64 2072 6574 7572 6e73 2e0a 0a54 6865  od returns...The
+0000b770: 2060 7265 6164 5f73 7472 6561 6d28 2960   `read_stream()`
+0000b780: 2061 6e64 2060 6765 745f 7374 7265 616d   and `get_stream
+0000b790: 2829 6020 6d65 7468 6f64 7320 6861 7665  ()` methods have
+0000b7a0: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
+0000b7b0: 6775 6d65 6e74 2c20 6073 7472 6561 6d5f  gument, `stream_
+0000b7c0: 6e61 6d65 602e 0a0a 5468 6520 7265 7175  name`...The requ
+0000b7d0: 6972 6564 2060 7374 7265 616d 5f6e 616d  ired `stream_nam
+0000b7e0: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+0000b7f0: 2050 7974 686f 6e20 6073 7472 6020 7468   Python `str` th
+0000b800: 6174 2075 6e69 7175 656c 7920 6964 656e  at uniquely iden
+0000b810: 7469 6669 6573 2061 0a73 7472 6561 6d20  tifies a.stream 
+0000b820: 6672 6f6d 2077 6869 6368 2072 6563 6f72  from which recor
+0000b830: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
+0000b840: 6265 2072 6574 7572 6e65 642e 0a0a 5468  be returned...Th
+0000b850: 6520 6072 6561 645f 7374 7265 616d 2829  e `read_stream()
+0000b860: 6020 616e 6420 6067 6574 5f73 7472 6561  ` and `get_strea
+0000b870: 6d28 2960 206d 6574 686f 6473 2061 6c73  m()` methods als
+0000b880: 6f20 6861 7665 2073 6978 206f 7074 696f  o have six optio
+0000b890: 6e61 6c20 6172 6775 6d65 6e74 732c 0a60  nal arguments,.`
+0000b8a0: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+0000b8b0: 2c20 6062 6163 6b77 6172 6473 602c 2060  , `backwards`, `
+0000b8c0: 7265 736f 6c76 655f 6c69 6e6b 7360 2c20  resolve_links`, 
+0000b8d0: 606c 696d 6974 602c 2060 7469 6d65 6f75  `limit`, `timeou
+0000b8e0: 7460 2c20 616e 6420 6063 7265 6465 6e74  t`, and `credent
+0000b8f0: 6961 6c73 602e 0a0a 5468 6520 6f70 7469  ials`...The opti
+0000b900: 6f6e 616c 2060 7374 7265 616d 5f70 6f73  onal `stream_pos
+0000b910: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+0000b920: 6973 2061 2050 7974 686f 6e20 6069 6e74  is a Python `int
+0000b930: 6020 7468 6174 2063 616e 2062 6520 7573  ` that can be us
+0000b940: 6564 2074 6f0a 696e 6469 6361 7465 2074  ed to.indicate t
+0000b950: 6865 2070 6f73 6974 696f 6e20 696e 2074  he position in t
+0000b960: 6865 2073 7472 6561 6d20 6672 6f6d 2077  he stream from w
+0000b970: 6869 6368 2074 6f20 7374 6172 7420 7265  hich to start re
+0000b980: 6164 696e 672e 2054 6865 2064 6566 6175  ading. The defau
+0000b990: 6c74 2076 616c 7565 0a6f 6620 6073 7472  lt value.of `str
+0000b9a0: 6561 6d5f 706f 7369 7469 6f6e 6020 6973  eam_position` is
+0000b9b0: 2060 4e6f 6e65 602e 2057 6865 6e20 7265   `None`. When re
+0000b9c0: 6164 696e 6720 6120 7374 7265 616d 2066  ading a stream f
+0000b9d0: 726f 6d20 6120 7370 6563 6966 6963 2070  rom a specific p
+0000b9e0: 6f73 6974 696f 6e20 696e 2074 6865 0a73  osition in the.s
+0000b9f0: 7472 6561 6d2c 2074 6865 2072 6563 6f72  tream, the recor
+0000ba00: 6465 6420 6576 656e 7420 6174 2074 6861  ded event at tha
+0000ba10: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+0000ba20: 6265 2069 6e63 6c75 6465 642c 2062 6f74  be included, bot
+0000ba30: 6820 7768 656e 2072 6561 6469 6e67 0a66  h when reading.f
+0000ba40: 6f72 7761 7264 7320 6672 6f6d 2074 6861  orwards from tha
+0000ba50: 7420 706f 7369 7469 6f6e 2c20 616e 6420  t position, and 
+0000ba60: 7768 656e 2072 6561 6469 6e67 2062 6163  when reading bac
+0000ba70: 6b77 6172 6473 2e0a 0a54 6865 206f 7074  kwards...The opt
+0000ba80: 696f 6e61 6c20 6062 6163 6b77 6172 6473  ional `backwards
+0000ba90: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+0000baa0: 5079 7468 6f6e 2060 626f 6f6c 602e 2054  Python `bool`. T
+0000bab0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0000bac0: 206f 6620 6062 6163 6b77 6172 6473 600a   of `backwards`.
+0000bad0: 6973 2060 4661 6c73 6560 2c20 7768 6963  is `False`, whic
+0000bae0: 6820 6d65 616e 7320 7468 6520 7374 7265  h means the stre
+0000baf0: 616d 2077 696c 6c20 6265 2072 6561 6420  am will be read 
+0000bb00: 666f 7277 6172 6473 2c20 736f 2074 6861  forwards, so tha
+0000bb10: 7420 6576 656e 7473 2061 7265 2072 6574  t events are ret
+0000bb20: 7572 6e65 640a 696e 2074 6865 206f 7264  urned.in the ord
+0000bb30: 6572 2074 6865 7920 7765 7265 2072 6563  er they were rec
+0000bb40: 6f72 6465 642e 2049 6620 6062 6163 6b77  orded. If `backw
+0000bb50: 6172 6473 6020 6973 2060 5472 7565 602c  ards` is `True`,
+0000bb60: 2074 6865 2065 7665 6e74 7320 6172 6520   the events are 
+0000bb70: 7265 7475 726e 6564 2069 6e0a 7265 7665  returned in.reve
+0000bb80: 7273 6520 6f72 6465 722e 0a0a 4966 2060  rse order...If `
+0000bb90: 6261 636b 7761 7264 7360 2069 7320 6046  backwards` is `F
+0000bba0: 616c 7365 6020 616e 6420 6073 7472 6561  alse` and `strea
+0000bbb0: 6d5f 706f 7369 7469 6f6e 6020 6973 2060  m_position` is `
+0000bbc0: 4e6f 6e65 602c 2074 6865 2073 7472 6561  None`, the strea
+0000bbd0: 6d27 7320 6576 656e 7473 2077 696c 6c20  m's events will 
+0000bbe0: 6265 0a72 6574 7572 6e65 6420 696e 2074  be.returned in t
+0000bbf0: 6865 206f 7264 6572 2074 6865 7920 7765  he order they we
+0000bc00: 7265 2072 6563 6f72 6465 642c 2073 7461  re recorded, sta
+0000bc10: 7274 696e 6720 6672 6f6d 2074 6865 2066  rting from the f
+0000bc20: 6972 7374 2072 6563 6f72 6465 6420 6576  irst recorded ev
+0000bc30: 656e 742e 2049 660a 6062 6163 6b77 6172  ent. If.`backwar
+0000bc40: 6473 6020 6973 2060 5472 7565 6020 616e  ds` is `True` an
+0000bc50: 6420 6073 7472 6561 6d5f 706f 7369 7469  d `stream_positi
+0000bc60: 6f6e 6020 6973 2060 4e6f 6e65 602c 2074  on` is `None`, t
+0000bc70: 6865 2073 7472 6561 6d27 7320 6576 656e  he stream's even
+0000bc80: 7473 2077 696c 6c20 6265 0a72 6574 7572  ts will be.retur
+0000bc90: 6e65 6420 696e 2072 6576 6572 7365 206f  ned in reverse o
+0000bca0: 7264 6572 2c20 7374 6172 7469 6e67 2066  rder, starting f
+0000bcb0: 726f 6d20 7468 6520 6c61 7374 2072 6563  rom the last rec
+0000bcc0: 6f72 6465 6420 6576 656e 742e 0a0a 5468  orded event...Th
+0000bcd0: 6520 6f70 7469 6f6e 616c 2060 7265 736f  e optional `reso
+0000bce0: 6c76 655f 6c69 6e6b 7360 2061 7267 756d  lve_links` argum
+0000bcf0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+0000bd00: 6062 6f6f 6c60 2e20 5468 6520 6465 6661  `bool`. The defa
+0000bd10: 756c 7420 7661 6c75 6520 6f66 2060 7265  ult value of `re
+0000bd20: 736f 6c76 655f 6c69 6e6b 7360 0a69 7320  solve_links`.is 
+0000bd30: 6046 616c 7365 602c 2077 6869 6368 206d  `False`, which m
+0000bd40: 6561 6e73 2061 6e79 2065 7665 6e74 206c  eans any event l
+0000bd50: 696e 6b73 2077 696c 6c20 6e6f 7420 6265  inks will not be
+0000bd60: 2072 6573 6f6c 7665 642c 2073 6f20 7468   resolved, so th
+0000bd70: 6174 2074 6865 2065 7665 6e74 7320 7468  at the events th
+0000bd80: 6174 2061 7265 0a72 6574 7572 6e65 6420  at are.returned 
+0000bd90: 6d61 7920 7265 7072 6573 656e 7420 6576  may represent ev
+0000bda0: 656e 7420 6c69 6e6b 732e 2049 6620 6072  ent links. If `r
+0000bdb0: 6573 6f6c 7665 5f6c 696e 6b73 6020 6973  esolve_links` is
+0000bdc0: 2060 5472 7565 602c 2061 6e79 2065 7665   `True`, any eve
+0000bdd0: 6e74 206c 696e 6b73 2077 696c 6c0a 6265  nt links will.be
+0000bde0: 2072 6573 6f6c 7665 642c 2073 6f20 7468   resolved, so th
+0000bdf0: 6174 2074 6865 206c 696e 6b65 6420 6576  at the linked ev
+0000be00: 656e 7473 2077 696c 6c20 6265 2072 6574  ents will be ret
+0000be10: 7572 6e65 6420 696e 7374 6561 6420 6f66  urned instead of
+0000be20: 2074 6865 2065 7665 6e74 206c 696e 6b73   the event links
+0000be30: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0000be40: 606c 696d 6974 6020 6172 6775 6d65 6e74  `limit` argument
+0000be50: 2069 7320 6120 5079 7468 6f6e 2060 696e   is a Python `in
+0000be60: 7460 2077 6869 6368 2072 6573 7472 6963  t` which restric
+0000be70: 7473 2074 6865 206e 756d 6265 7220 6f66  ts the number of
+0000be80: 2065 7665 6e74 730a 7468 6174 2077 696c   events.that wil
+0000be90: 6c20 6265 2072 6574 7572 6e65 642e 2054  l be returned. T
+0000bea0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0000beb0: 206f 6620 606c 696d 6974 6020 6973 2060   of `limit` is `
+0000bec0: 7379 732e 6d61 7869 6e74 602e 0a0a 5468  sys.maxint`...Th
+0000bed0: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
+0000bee0: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
+0000bef0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+0000bf00: 6020 7768 6963 6820 7365 7473 2061 0a6d  ` which sets a.m
+0000bf10: 6178 696d 756d 2064 7572 6174 696f 6e2c  aximum duration,
+0000bf20: 2069 6e20 7365 636f 6e64 732c 2066 6f72   in seconds, for
+0000bf30: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+0000bf40: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+0000bf50: 6174 696f 6e2e 0a0a 5468 6520 6f70 7469  ation...The opti
+0000bf60: 6f6e 616c 2060 6372 6564 656e 7469 616c  onal `credential
+0000bf70: 7360 2061 7267 756d 656e 7420 6361 6e20  s` argument can 
+0000bf80: 6265 2075 7365 6420 746f 206f 7665 7272  be used to overr
+0000bf90: 6964 6520 6361 6c6c 2063 7265 6465 6e74  ide call credent
+0000bfa0: 6961 6c73 2064 6572 6976 6564 0a66 726f  ials derived.fro
+0000bfb0: 6d20 7468 6520 636f 6e6e 6563 7469 6f6e  m the connection
+0000bfc0: 2073 7472 696e 6720 5552 492e 2041 2073   string URI. A s
+0000bfd0: 7569 7461 626c 6520 7661 6c75 6520 666f  uitable value fo
+0000bfe0: 7220 7468 6973 2061 7267 756d 656e 7420  r this argument 
+0000bff0: 6361 6e20 6265 2063 6f6e 7374 7275 6374  can be construct
+0000c000: 6564 0a62 7920 6361 6c6c 696e 6720 7468  ed.by calling th
+0000c010: 6520 636c 6965 6e74 206d 6574 686f 6420  e client method 
+0000c020: 6063 6f6e 7374 7275 6374 5f63 616c 6c5f  `construct_call_
+0000c030: 6372 6564 656e 7469 616c 7328 2960 2e0a  credentials()`..
+0000c040: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+0000c050: 6f77 2073 686f 7773 2074 6865 2064 6566  ow shows the def
+0000c060: 6175 6c74 2062 6568 6176 696f 722c 2077  ault behavior, w
+0000c070: 6869 6368 2069 7320 746f 2072 6574 7572  hich is to retur
+0000c080: 6e20 616c 6c20 7468 6520 7265 636f 7264  n all the record
+0000c090: 6564 0a65 7665 6e74 7320 6f66 2061 2073  ed.events of a s
+0000c0a0: 7472 6561 6d20 666f 7277 6172 6473 2066  tream forwards f
+0000c0b0: 726f 6d20 7468 6520 6669 7273 7420 7265  rom the first re
+0000c0c0: 636f 7264 6564 2065 7665 6e74 7320 746f  corded events to
+0000c0d0: 2074 6865 206c 6173 742e 0a0a 6060 6070   the last...```p
+0000c0e0: 7974 686f 6e0a 6576 656e 7473 203d 2063  ython.events = c
+0000c0f0: 6c69 656e 742e 6765 745f 7374 7265 616d  lient.get_stream
+0000c100: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+0000c110: 653d 7374 7265 616d 5f6e 616d 6531 0a29  e=stream_name1.)
+0000c120: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
+0000c130: 6e74 7329 203d 3d20 330a 6173 7365 7274  nts) == 3.assert
+0000c140: 2065 7665 6e74 735b 305d 203d 3d20 6576   events[0] == ev
+0000c150: 656e 7431 0a61 7373 6572 7420 6576 656e  ent1.assert even
+0000c160: 7473 5b31 5d20 3d3d 2065 7665 6e74 320a  ts[1] == event2.
+0000c170: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
+0000c180: 203d 3d20 6576 656e 7433 0a60 6060 0a0a   == event3.```..
+0000c190: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+0000c1a0: 7720 7368 6f77 7320 686f 7720 746f 2075  w shows how to u
+0000c1b0: 7365 2074 6865 2060 7374 7265 616d 5f70  se the `stream_p
+0000c1c0: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
+0000c1d0: 7420 746f 2072 6561 6420 6120 7374 7265  t to read a stre
+0000c1e0: 616d 0a66 726f 6d20 6120 7370 6563 6966  am.from a specif
+0000c1f0: 6963 2073 7472 6561 6d20 706f 7369 7469  ic stream positi
+0000c200: 6f6e 2074 6f20 7468 6520 656e 6420 6f66  on to the end of
+0000c210: 2074 6865 2073 7472 6561 6d2e 2053 7472   the stream. Str
+0000c220: 6561 6d20 706f 7369 7469 6f6e 7320 6172  eam positions ar
+0000c230: 650a 7a65 726f 2d62 6173 6564 2c20 616e  e.zero-based, an
+0000c240: 6420 736f 2060 7374 7265 616d 5f70 6f73  d so `stream_pos
+0000c250: 6974 696f 6e3d 3160 2063 6f72 7265 7370  ition=1` corresp
+0000c260: 6f6e 6473 2074 6f20 7468 6520 7365 636f  onds to the seco
+0000c270: 6e64 2065 7665 6e74 2074 6861 7420 7761  nd event that wa
+0000c280: 730a 7265 636f 7264 6564 2069 6e20 7468  s.recorded in th
+0000c290: 6520 7374 7265 616d 2c20 696e 2074 6869  e stream, in thi
+0000c2a0: 7320 6361 7365 2060 6576 656e 7432 602e  s case `event2`.
+0000c2b0: 0a0a 6060 6070 7974 686f 6e0a 6576 656e  ..```python.even
+0000c2c0: 7473 203d 2063 6c69 656e 742e 6765 745f  ts = client.get_
+0000c2d0: 7374 7265 616d 280a 2020 2020 7374 7265  stream(.    stre
+0000c2e0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+0000c2f0: 616d 6531 2c0a 2020 2020 7374 7265 616d  ame1,.    stream
+0000c300: 5f70 6f73 6974 696f 6e3d 312c 0a29 0a0a  _position=1,.)..
+0000c310: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
+0000c320: 7329 203d 3d20 320a 6173 7365 7274 2065  s) == 2.assert e
+0000c330: 7665 6e74 735b 305d 203d 3d20 6576 656e  vents[0] == even
+0000c340: 7432 0a61 7373 6572 7420 6576 656e 7473  t2.assert events
+0000c350: 5b31 5d20 3d3d 2065 7665 6e74 330a 6060  [1] == event3.``
+0000c360: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
+0000c370: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
+0000c380: 6f20 7573 6520 7468 6520 6062 6163 6b77  o use the `backw
+0000c390: 6172 6473 6020 6172 6775 6d65 6e74 2074  ards` argument t
+0000c3a0: 6f20 7265 6164 2061 2073 7472 6561 6d20  o read a stream 
+0000c3b0: 6261 636b 7761 7264 732e 0a0a 6060 6070  backwards...```p
+0000c3c0: 7974 686f 6e0a 6576 656e 7473 203d 2063  ython.events = c
+0000c3d0: 6c69 656e 742e 6765 745f 7374 7265 616d  lient.get_stream
+0000c3e0: 280a 2020 2020 7374 7265 616d 5f6e 616d  (.    stream_nam
+0000c3f0: 653d 7374 7265 616d 5f6e 616d 6531 2c0a  e=stream_name1,.
+0000c400: 2020 2020 6261 636b 7761 7264 733d 5472      backwards=Tr
+0000c410: 7565 2c0a 290a 0a61 7373 6572 7420 6c65  ue,.)..assert le
+0000c420: 6e28 6576 656e 7473 2920 3d3d 2033 0a61  n(events) == 3.a
+0000c430: 7373 6572 7420 6576 656e 7473 5b30 5d20  ssert events[0] 
+0000c440: 3d3d 2065 7665 6e74 330a 6173 7365 7274  == event3.assert
+0000c450: 2065 7665 6e74 735b 315d 203d 3d20 6576   events[1] == ev
+0000c460: 656e 7432 0a61 7373 6572 7420 6576 656e  ent2.assert even
+0000c470: 7473 5b32 5d20 3d3d 2065 7665 6e74 310a  ts[2] == event1.
+0000c480: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
+0000c490: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
+0000c4a0: 2074 6f20 7573 6520 7468 6520 606c 696d   to use the `lim
+0000c4b0: 6974 6020 6172 6775 6d65 6e74 2074 6f20  it` argument to 
+0000c4c0: 7265 6164 2061 206c 696d 6974 6564 206e  read a limited n
+0000c4d0: 756d 6265 7220 6f66 0a65 7665 6e74 732e  umber of.events.
+0000c4e0: 0a0a 6060 6070 7974 686f 6e0a 6576 656e  ..```python.even
+0000c4f0: 7473 203d 2063 6c69 656e 742e 6765 745f  ts = client.get_
+0000c500: 7374 7265 616d 280a 2020 2020 7374 7265  stream(.    stre
+0000c510: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+0000c520: 616d 6531 2c0a 2020 2020 6c69 6d69 743d  ame1,.    limit=
+0000c530: 322c 0a29 0a0a 6173 7365 7274 206c 656e  2,.)..assert len
+0000c540: 2865 7665 6e74 7329 203d 3d20 320a 6173  (events) == 2.as
+0000c550: 7365 7274 2065 7665 6e74 735b 305d 203d  sert events[0] =
+0000c560: 3d20 6576 656e 7431 0a61 7373 6572 7420  = event1.assert 
+0000c570: 6576 656e 7473 5b31 5d20 3d3d 2065 7665  events[1] == eve
+0000c580: 6e74 320a 6060 600a 0a54 6865 2060 7265  nt2.```..The `re
+0000c590: 6164 5f73 7472 6561 6d28 2960 2061 6e64  ad_stream()` and
+0000c5a0: 2060 6765 745f 7374 7265 616d 2829 6020   `get_stream()` 
+0000c5b0: 6d65 7468 6f64 7320 7769 6c6c 2072 6169  methods will rai
+0000c5c0: 7365 2061 2060 4e6f 7446 6f75 6e64 6020  se a `NotFound` 
+0000c5d0: 6578 6365 7074 696f 6e20 6966 2074 6865  exception if the
+0000c5e0: 0a6e 616d 6564 2073 7472 6561 6d20 6861  .named stream ha
+0000c5f0: 7320 6e65 7665 7220 6578 6973 7465 6420  s never existed 
+0000c600: 6f72 2068 6173 2062 6565 6e20 6465 6c65  or has been dele
+0000c610: 7465 642e 0a0a 6060 6070 7974 686f 6e0a  ted...```python.
+0000c620: 6672 6f6d 2065 7364 6263 6c69 656e 742e  from esdbclient.
+0000c630: 6578 6365 7074 696f 6e73 2069 6d70 6f72  exceptions impor
+0000c640: 7420 4e6f 7446 6f75 6e64 0a0a 0a74 7279  t NotFound...try
+0000c650: 3a0a 2020 2020 636c 6965 6e74 2e67 6574  :.    client.get
+0000c660: 5f73 7472 6561 6d28 2764 6f65 732d 6e6f  _stream('does-no
+0000c670: 742d 6578 6973 7427 290a 6578 6365 7074  t-exist').except
+0000c680: 204e 6f74 466f 756e 643a 0a20 2020 2070   NotFound:.    p
+0000c690: 6173 7320 2023 2054 6865 2073 7472 6561  ass  # The strea
+0000c6a0: 6d20 646f 6573 206e 6f74 2065 7869 7374  m does not exist
+0000c6b0: 2e0a 656c 7365 3a0a 2020 2020 7261 6973  ..else:.    rais
+0000c6c0: 6520 4578 6365 7074 696f 6e28 2253 686f  e Exception("Sho
+0000c6d0: 756c 646e 2774 2067 6574 2068 6572 6522  uldn't get here"
+0000c6e0: 290a 6060 600a 0a50 6c65 6173 6520 6e6f  ).```..Please no
+0000c6f0: 7465 2c20 7468 6520 6067 6574 5f73 7472  te, the `get_str
+0000c700: 6561 6d28 2960 206d 6574 686f 6420 6973  eam()` method is
+0000c710: 2064 6563 6f72 6174 6564 2077 6974 6820   decorated with 
+0000c720: 7468 6520 6040 6175 746f 7265 636f 6e6e  the `@autoreconn
+0000c730: 6563 7460 2061 6e64 0a60 4072 6574 7279  ect` and.`@retry
+0000c740: 6772 7063 6020 6465 636f 7261 746f 7273  grpc` decorators
+0000c750: 2c20 7768 696c 7374 2074 6865 2060 7265  , whilst the `re
+0000c760: 6164 5f73 7472 6561 6d28 2960 206d 6574  ad_stream()` met
+0000c770: 686f 6420 6973 206e 6f74 2e20 5468 6973  hod is not. This
+0000c780: 206d 6561 6e73 2074 6861 740a 616c 6c20   means that.all 
+0000c790: 6572 726f 7273 2064 7565 2074 6f20 636f  errors due to co
+0000c7a0: 6e6e 6563 7469 6f6e 2069 7373 7565 7320  nnection issues 
+0000c7b0: 7769 6c6c 2062 6520 6361 7567 6874 2062  will be caught b
+0000c7c0: 7920 7468 6520 7265 7472 7920 616e 6420  y the retry and 
+0000c7d0: 7265 636f 6e6e 6563 7420 6465 636f 7261  reconnect decora
+0000c7e0: 746f 7273 0a77 6865 6e20 6361 6c6c 696e  tors.when callin
+0000c7f0: 6720 7468 6520 6067 6574 5f73 7472 6561  g the `get_strea
+0000c800: 6d28 2960 206d 6574 686f 642c 2062 7574  m()` method, but
+0000c810: 206e 6f74 2077 6865 6e20 6361 6c6c 696e   not when callin
+0000c820: 6720 6072 6561 645f 7374 7265 616d 2829  g `read_stream()
+0000c830: 602e 2054 6865 0a60 7265 6164 5f73 7472  `. The.`read_str
+0000c840: 6561 6d28 2960 206d 6574 686f 6420 6861  eam()` method ha
+0000c850: 7320 6e6f 2073 7563 6820 6465 636f 7261  s no such decora
+0000c860: 746f 7273 2062 6563 6175 7365 2074 6865  tors because the
+0000c870: 2073 7472 6561 6d69 6e67 206f 6e6c 7920   streaming only 
+0000c880: 7374 6172 7473 0a77 6865 6e20 6974 6572  starts.when iter
+0000c890: 6174 696e 6720 6f76 6572 2074 6865 2022  ating over the "
+0000c8a0: 7265 6164 2072 6573 706f 6e73 6522 2073  read response" s
+0000c8b0: 7461 7274 732c 2077 6869 6368 206d 6561  tarts, which mea
+0000c8c0: 6e73 2074 6861 7420 7468 6520 6d65 7468  ns that the meth
+0000c8d0: 6f64 2072 6574 7572 6e73 0a62 6566 6f72  od returns.befor
+0000c8e0: 6520 7468 6520 7374 7265 616d 696e 6720  e the streaming 
+0000c8f0: 7374 6172 7473 2c20 616e 6420 736f 2074  starts, and so t
+0000c900: 6865 7265 2069 7320 6e6f 2063 6861 6e63  here is no chanc
+0000c910: 6520 666f 7220 616e 7920 6465 636f 7261  e for any decora
+0000c920: 746f 7273 2074 6f20 6361 7463 680a 616e  tors to catch.an
+0000c930: 7920 636f 6e6e 6563 7469 6f6e 2069 7373  y connection iss
+0000c940: 7565 732e 0a0a 466f 7220 7468 6520 7361  ues...For the sa
+0000c950: 6d65 2072 6561 736f 6e2c 2060 7265 6164  me reason, `read
+0000c960: 5f73 7472 6561 6d28 2960 2077 696c 6c20  _stream()` will 
+0000c970: 6e6f 7420 7261 6973 6520 6120 604e 6f74  not raise a `Not
+0000c980: 466f 756e 6460 2065 7863 6570 7469 6f6e  Found` exception
+0000c990: 2077 6865 6e0a 7468 6520 7374 7265 616d   when.the stream
+0000c9a0: 2064 6f65 7320 6e6f 7420 6578 6973 742c   does not exist,
+0000c9b0: 2075 6e74 696c 2069 7465 7261 7469 6e67   until iterating
+0000c9c0: 206f 7665 7220 7468 6520 2272 6561 6420   over the "read 
+0000c9d0: 7265 7370 6f6e 7365 2220 6f62 6a65 6374  response" object
+0000c9e0: 2062 6567 696e 732e 0a0a 4966 2079 6f75   begins...If you
+0000c9f0: 2061 7265 2072 6561 6469 6e67 2061 2076   are reading a v
+0000ca00: 6572 7920 6c61 7267 6520 7374 7265 616d  ery large stream
+0000ca10: 2c20 7468 656e 2079 6f75 206d 6967 6874  , then you might
+0000ca20: 2070 7265 6665 7220 746f 2063 616c 6c20   prefer to call 
+0000ca30: 6072 6561 645f 7374 7265 616d 2829 602c  `read_stream()`,
+0000ca40: 0a61 6e64 2062 6567 696e 2069 7465 7261  .and begin itera
+0000ca50: 7469 6e67 2074 6872 6f75 6768 2074 6865  ting through the
+0000ca60: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000ca70: 2077 6869 6c73 7420 7468 6579 2061 7265   whilst they are
+0000ca80: 2062 6569 6e67 2073 7472 6561 6d65 6420   being streamed 
+0000ca90: 6672 6f6d 0a74 6865 2073 6572 7665 722c  from.the server,
+0000caa0: 2072 6174 6865 7220 7468 616e 2062 6f74   rather than bot
+0000cab0: 6820 7761 6974 696e 6720 616e 6420 6861  h waiting and ha
+0000cac0: 7669 6e67 2074 6865 6d20 616c 6c20 6163  ving them all ac
+0000cad0: 6375 6d75 6c61 7465 2069 6e20 6d65 6d6f  cumulate in memo
+0000cae0: 7279 2e0a 0a23 2323 2047 6574 2063 7572  ry...### Get cur
+0000caf0: 7265 6e74 2076 6572 7369 6f6e 3c61 2069  rent version<a i
+0000cb00: 643d 2267 6574 2d63 7572 7265 6e74 2d76  d="get-current-v
+0000cb10: 6572 7369 6f6e 223e 3c2f 613e 0a0a 5468  ersion"></a>..Th
+0000cb20: 6520 6067 6574 5f63 7572 7265 6e74 5f76  e `get_current_v
+0000cb30: 6572 7369 6f6e 2829 6020 6d65 7468 6f64  ersion()` method
+0000cb40: 2069 7320 6120 636f 6e76 656e 6965 6e63   is a convenienc
+0000cb50: 6520 6d65 7468 6f64 2074 6861 7420 6573  e method that es
+0000cb60: 7365 6e74 6961 6c6c 7920 6361 6c6c 730a  sentially calls.
+0000cb70: 6067 6574 5f73 7472 6561 6d28 2960 2077  `get_stream()` w
+0000cb80: 6974 6820 6062 6163 6b77 6172 6473 3d54  ith `backwards=T
+0000cb90: 7275 6560 2061 6e64 2060 6c69 6d69 743d  rue` and `limit=
+0000cba0: 3160 2e20 5468 6973 206d 6574 686f 6420  1`. This method 
+0000cbb0: 7265 7475 726e 730a 7468 6520 7661 6c75  returns.the valu
+0000cbc0: 6520 6f66 2074 6865 2060 7374 7265 616d  e of the `stream
+0000cbd0: 5f70 6f73 6974 696f 6e60 2061 7474 7269  _position` attri
+0000cbe0: 6275 7465 206f 6620 7468 6520 6c61 7374  bute of the last
+0000cbf0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+0000cc00: 696e 2061 0a73 7472 6561 6d2e 2049 6620  in a.stream. If 
+0000cc10: 6120 7374 7265 616d 2064 6f65 7320 6e6f  a stream does no
+0000cc20: 7420 6578 6973 742c 2074 6865 2072 6574  t exist, the ret
+0000cc30: 7572 6e65 6420 7661 6c75 6520 6973 2060  urned value is `
+0000cc40: 5374 7265 616d 5374 6174 652e 4e4f 5f53  StreamState.NO_S
+0000cc50: 5452 4541 4d60 2e0a 5468 6520 7265 7475  TREAM`..The retu
+0000cc60: 726e 6564 2076 616c 7565 2069 7320 7468  rned value is th
+0000cc70: 6520 636f 7272 6563 7420 7661 6c75 6520  e correct value 
+0000cc80: 6f66 2060 6375 7272 656e 745f 7665 7273  of `current_vers
+0000cc90: 696f 6e60 2077 6865 6e20 6170 7065 6e64  ion` when append
+0000cca0: 696e 6720 6576 656e 7473 0a74 6f20 6120  ing events.to a 
+0000ccb0: 7374 7265 616d 2c20 616e 6420 7768 656e  stream, and when
+0000ccc0: 2064 656c 6574 696e 6720 6f72 2074 6f6d   deleting or tom
+0000ccd0: 6273 746f 6e69 6e67 2061 2073 7472 6561  bstoning a strea
+0000cce0: 6d2e 0a0a 5468 6973 206d 6574 686f 6420  m...This method 
+0000ccf0: 6861 7320 6f6e 6520 7265 7175 6972 6564  has one required
+0000cd00: 2061 7267 756d 656e 742c 2060 7374 7265   argument, `stre
+0000cd10: 616d 5f6e 616d 6560 2e0a 0a54 6865 2072  am_name`...The r
+0000cd20: 6571 7569 7265 6420 6073 7472 6561 6d5f  equired `stream_
+0000cd30: 6e61 6d65 6020 6172 6775 6d65 6e74 2069  name` argument i
+0000cd40: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
+0000cd50: 2074 6861 7420 756e 6971 7565 6c79 2069   that uniquely i
+0000cd60: 6465 6e74 6966 6965 7320 610a 7374 7265  dentifies a.stre
+0000cd70: 616d 2066 726f 6d20 7768 6963 6820 6120  am from which a 
+0000cd80: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+0000cd90: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
+0000cda0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
+0000cdb0: 6173 2061 6e20 6f70 7469 6f6e 616c 2060  as an optional `
+0000cdc0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+0000cdd0: 742c 2077 6869 6368 2069 7320 6120 5079  t, which is a Py
+0000cde0: 7468 6f6e 2060 666c 6f61 7460 0a74 6861  thon `float`.tha
+0000cdf0: 7420 7365 7473 2061 206d 6178 696d 756d  t sets a maximum
+0000ce00: 2064 7572 6174 696f 6e2c 2069 6e20 7365   duration, in se
+0000ce10: 636f 6e64 732c 2066 6f72 2074 6865 2063  conds, for the c
+0000ce20: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
+0000ce30: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
+0000ce40: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+0000ce50: 7320 616e 206f 7074 696f 6e61 6c20 6063  s an optional `c
+0000ce60: 7265 6465 6e74 6961 6c73 6020 6172 6775  redentials` argu
+0000ce70: 6d65 6e74 2c20 7768 6963 6820 6361 6e20  ment, which can 
+0000ce80: 6265 2075 7365 6420 746f 0a6f 7665 7272  be used to.overr
+0000ce90: 6964 6520 6361 6c6c 2063 7265 6465 6e74  ide call credent
+0000cea0: 6961 6c73 2064 6572 6976 6564 2066 726f  ials derived fro
+0000ceb0: 6d20 7468 6520 636f 6e6e 6563 7469 6f6e  m the connection
+0000cec0: 2073 7472 696e 6720 5552 492e 0a0a 496e   string URI...In
+0000ced0: 2074 6865 2065 7861 6d70 6c65 2062 656c   the example bel
+0000cee0: 6f77 2c20 7468 6520 6c61 7374 2073 7472  ow, the last str
+0000cef0: 6561 6d20 706f 7369 7469 6f6e 206f 6620  eam position of 
+0000cf00: 6073 7472 6561 6d5f 6e61 6d65 3160 2069  `stream_name1` i
+0000cf10: 7320 6f62 7461 696e 6564 2e0a 5369 6e63  s obtained..Sinc
+0000cf20: 6520 7468 7265 6520 6576 656e 7473 2068  e three events h
+0000cf30: 6176 6520 6265 656e 2061 7070 656e 6465  ave been appende
+0000cf40: 6420 746f 2060 7374 7265 616d 5f6e 616d  d to `stream_nam
+0000cf50: 6531 602c 2061 6e64 2062 6563 6175 7365  e1`, and because
+0000cf60: 2070 6f73 6974 696f 6e73 0a69 6e20 6120   positions.in a 
+0000cf70: 7374 7265 616d 2061 7265 207a 6572 6f2d  stream are zero-
+0000cf80: 6261 7365 6420 616e 6420 6761 706c 6573  based and gaples
+0000cf90: 732c 2073 6f20 7468 6520 6375 7272 656e  s, so the curren
+0000cfa0: 7420 7665 7273 696f 6e20 6973 2060 3260  t version is `2`
+0000cfb0: 2e0a 0a60 6060 7079 7468 6f6e 0a63 7572  ...```python.cur
+0000cfc0: 7265 6e74 5f76 6572 7369 6f6e 203d 2063  rent_version = c
+0000cfd0: 6c69 656e 742e 6765 745f 6375 7272 656e  lient.get_curren
+0000cfe0: 745f 7665 7273 696f 6e28 0a20 2020 2073  t_version(.    s
+0000cff0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+0000d000: 6d5f 6e61 6d65 310a 290a 0a61 7373 6572  m_name1.)..asser
+0000d010: 7420 6375 7272 656e 745f 7665 7273 696f  t current_versio
+0000d020: 6e20 3d3d 2032 0a60 6060 0a0a 4966 2061  n == 2.```..If a
+0000d030: 2073 7472 6561 6d20 6861 7320 6e65 7665   stream has neve
+0000d040: 7220 6578 6973 7465 6420 6f72 2068 6173  r existed or has
+0000d050: 2062 6565 6e20 6465 6c65 7465 642c 2074   been deleted, t
+0000d060: 6865 2072 6574 7572 6e65 6420 7661 6c75  he returned valu
+0000d070: 6520 6973 0a60 5374 7265 616d 5374 6174  e is.`StreamStat
+0000d080: 652e 4e4f 5f53 5452 4541 4d60 2c20 7768  e.NO_STREAM`, wh
+0000d090: 6963 6820 6973 2074 6865 2063 6f72 7265  ich is the corre
+0000d0a0: 6374 2076 616c 7565 206f 6620 7468 6520  ct value of the 
+0000d0b0: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
+0000d0c0: 600a 6172 6775 6d65 6e74 2062 6f74 6820  `.argument both 
+0000d0d0: 7768 656e 2061 7070 656e 6469 6e67 2074  when appending t
+0000d0e0: 6865 2066 6972 7374 2065 7665 6e74 206f  he first event o
+0000d0f0: 6620 6120 6e65 7720 7374 7265 616d 2c20  f a new stream, 
+0000d100: 616e 6420 616c 736f 2077 6865 6e0a 6170  and also when.ap
+0000d110: 7065 6e64 696e 6720 6576 656e 7473 2074  pending events t
+0000d120: 6f20 6120 7374 7265 616d 2074 6861 7420  o a stream that 
+0000d130: 6861 7320 6265 656e 2064 656c 6574 6564  has been deleted
+0000d140: 2e0a 0a60 6060 7079 7468 6f6e 0a63 7572  ...```python.cur
+0000d150: 7265 6e74 5f76 6572 7369 6f6e 203d 2063  rent_version = c
+0000d160: 6c69 656e 742e 6765 745f 6375 7272 656e  lient.get_curren
+0000d170: 745f 7665 7273 696f 6e28 0a20 2020 2073  t_version(.    s
+0000d180: 7472 6561 6d5f 6e61 6d65 3d27 646f 6573  tream_name='does
+0000d190: 2d6e 6f74 2d65 7869 7374 270a 290a 0a61  -not-exist'.)..a
+0000d1a0: 7373 6572 7420 6375 7272 656e 745f 7665  ssert current_ve
+0000d1b0: 7273 696f 6e20 6973 2053 7472 6561 6d53  rsion is StreamS
+0000d1c0: 7461 7465 2e4e 4f5f 5354 5245 414d 0a60  tate.NO_STREAM.`
+0000d1d0: 6060 0a0a 2323 2320 486f 7720 746f 2069  ``..### How to i
+0000d1e0: 6d70 6c65 6d65 6e74 2073 6e61 7073 686f  mplement snapsho
+0000d1f0: 7474 696e 6720 7769 7468 2045 7665 6e74  tting with Event
+0000d200: 5374 6f72 6544 423c 6120 6964 3d22 686f  StoreDB<a id="ho
+0000d210: 772d 746f 2d69 6d70 6c65 6d65 6e74 2d73  w-to-implement-s
+0000d220: 6e61 7073 686f 7474 696e 672d 7769 7468  napshotting-with
+0000d230: 2d65 7665 6e74 7374 6f72 6564 6222 3e3c  -eventstoredb"><
+0000d240: 2f61 3e0a 0a53 6e61 7073 686f 7473 2063  /a>..Snapshots c
+0000d250: 616e 2069 6d70 726f 7665 2074 6865 2070  an improve the p
+0000d260: 6572 666f 726d 616e 6365 206f 6620 6167  erformance of ag
+0000d270: 6772 6567 6174 6573 2074 6861 7420 776f  gregates that wo
+0000d280: 756c 6420 6f74 6865 7277 6973 6520 6265  uld otherwise be
+0000d290: 0a72 6563 6f6e 7374 7275 6374 6564 2066  .reconstructed f
+0000d2a0: 726f 6d20 7665 7279 206c 6f6e 6720 7374  rom very long st
+0000d2b0: 7265 616d 732e 2048 6f77 6576 6572 2c20  reams. However, 
+0000d2c0: 6974 2069 7320 6765 6e65 7261 6c6c 7920  it is generally 
+0000d2d0: 7265 636f 6d6d 656e 6465 6420 746f 2064  recommended to d
+0000d2e0: 6573 6967 6e0a 6167 6772 6567 6174 6573  esign.aggregates
+0000d2f0: 2074 6f20 6861 7665 2061 2066 696e 6974   to have a finit
+0000d300: 6520 6c69 6665 6379 636c 652c 2061 6e64  e lifecycle, and
+0000d310: 2073 6f20 746f 2068 6176 6520 7265 6c61   so to have rela
+0000d320: 7469 7665 6c79 2073 686f 7274 2073 7472  tively short str
+0000d330: 6561 6d73 2c0a 7468 6572 6562 7920 6176  eams,.thereby av
+0000d340: 6f69 6469 6e67 2074 6865 206e 6565 6420  oiding the need 
+0000d350: 666f 7220 736e 6170 7368 6f74 7469 6e67  for snapshotting
+0000d360: 2e20 5468 6973 2022 686f 7720 746f 2220  . This "how to" 
+0000d370: 7365 6374 696f 6e20 6973 2069 6e74 656e  section is inten
+0000d380: 6465 6420 6d65 7265 6c79 0a74 6f20 7368  ded merely.to sh
+0000d390: 6f77 2068 6f77 2073 6e61 7073 686f 7474  ow how snapshott
+0000d3a0: 696e 6720 6f66 2061 6767 7265 6761 7465  ing of aggregate
+0000d3b0: 7320 6361 6e20 6265 2069 6d70 6c65 6d65  s can be impleme
+0000d3c0: 6e74 6564 2077 6974 6820 4576 656e 7453  nted with EventS
+0000d3d0: 746f 7265 4442 2075 7369 6e67 0a74 6869  toreDB using.thi
+0000d3e0: 7320 5079 7468 6f6e 2063 6c69 656e 742e  s Python client.
+0000d3f0: 0a0a 4576 656e 742d 736f 7572 6365 6420  ..Event-sourced 
+0000d400: 6167 6772 6567 6174 6573 2061 7265 2074  aggregates are t
+0000d410: 7970 6963 616c 6c79 2072 6563 6f6e 7374  ypically reconst
+0000d420: 7275 6374 6564 2066 726f 6d20 7265 636f  ructed from reco
+0000d430: 7264 6564 2065 7665 6e74 7320 6279 2063  rded events by c
+0000d440: 616c 6c69 6e67 0a61 206d 7574 6174 6f72  alling.a mutator
+0000d450: 2066 756e 6374 696f 6e20 666f 7220 6561   function for ea
+0000d460: 6368 2072 6563 6f72 6465 6420 6576 656e  ch recorded even
+0000d470: 742c 2065 766f 6c76 696e 6720 6672 6f6d  t, evolving from
+0000d480: 2061 6e20 696e 6974 6961 6c20 7374 6174   an initial stat
+0000d490: 650a 604e 6f6e 6560 2074 6f20 7468 6520  e.`None` to the 
+0000d4a0: 6375 7272 656e 7420 7374 6174 6520 6f66  current state of
+0000d4b0: 2074 6865 2061 6767 7265 6761 7465 2e20   the aggregate. 
+0000d4c0: 5468 6520 6675 6e63 7469 6f6e 2060 6765  The function `ge
+0000d4d0: 745f 6167 6772 6567 6174 6528 2960 2073  t_aggregate()` s
+0000d4e0: 686f 7773 0a68 6f77 2074 6869 7320 6361  hows.how this ca
+0000d4f0: 6e20 6265 2064 6f6e 652e 2054 6865 2061  n be done. The a
+0000d500: 6767 7265 6761 7465 2049 4420 6973 2075  ggregate ID is u
+0000d510: 7365 6420 6173 2061 2073 7472 6561 6d20  sed as a stream 
+0000d520: 6e61 6d65 2e20 5468 6520 6578 6365 7074  name. The except
+0000d530: 696f 6e0a 6041 6767 7265 6761 7465 4e6f  ion.`AggregateNo
+0000d540: 7446 6f75 6e64 6020 6973 2072 6169 7365  tFound` is raise
+0000d550: 6420 6966 2074 6865 2061 6767 7265 6761  d if the aggrega
+0000d560: 7465 2073 7472 6561 6d20 6973 206e 6f74  te stream is not
+0000d570: 2066 6f75 6e64 2e0a 0a60 6060 7079 7468   found...```pyth
+0000d580: 6f6e 0a63 6c61 7373 2041 6767 7265 6761  on.class Aggrega
+0000d590: 7465 4e6f 7446 6f75 6e64 2845 7863 6570  teNotFound(Excep
+0000d5a0: 7469 6f6e 293a 0a20 2020 2022 2222 5261  tion):.    """Ra
+0000d5b0: 6973 6564 2077 6865 6e20 616e 2061 6767  ised when an agg
+0000d5c0: 7265 6761 7465 2069 7320 6e6f 7420 666f  regate is not fo
+0000d5d0: 756e 642e 2222 220a 0a0a 6465 6620 6765  und."""...def ge
+0000d5e0: 745f 6167 6772 6567 6174 6528 6167 6772  t_aggregate(aggr
+0000d5f0: 6567 6174 655f 6964 2c20 6d75 7461 746f  egate_id, mutato
+0000d600: 725f 6675 6e63 293a 0a20 2020 2073 7472  r_func):.    str
+0000d610: 6561 6d5f 6e61 6d65 203d 2061 6767 7265  eam_name = aggre
+0000d620: 6761 7465 5f69 640a 0a20 2020 2023 2047  gate_id..    # G
+0000d630: 6574 2072 6563 6f72 6465 6420 6576 656e  et recorded even
+0000d640: 7473 2e0a 2020 2020 7472 793a 0a20 2020  ts..    try:.   
+0000d650: 2020 2020 2065 7665 6e74 7320 3d20 636c       events = cl
+0000d660: 6965 6e74 2e67 6574 5f73 7472 6561 6d28  ient.get_stream(
+0000d670: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+0000d680: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+0000d690: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0000d6a0: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
+0000d6b0: 6e3d 4e6f 6e65 0a20 2020 2020 2020 2029  n=None.        )
+0000d6c0: 0a20 2020 2065 7863 6570 7420 4e6f 7446  .    except NotF
+0000d6d0: 6f75 6e64 2061 7320 653a 0a20 2020 2020  ound as e:.     
+0000d6e0: 2020 2072 6169 7365 2041 6767 7265 6761     raise Aggrega
+0000d6f0: 7465 4e6f 7446 6f75 6e64 2861 6767 7265  teNotFound(aggre
+0000d700: 6761 7465 5f69 6429 2066 726f 6d20 650a  gate_id) from e.
+0000d710: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000d720: 2020 2320 5265 636f 6e73 7472 7563 7420    # Reconstruct 
+0000d730: 6167 6772 6567 6174 6520 6672 6f6d 2072  aggregate from r
+0000d740: 6563 6f72 6465 6420 6576 656e 7473 2e0a  ecorded events..
+0000d750: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0000d760: 6520 3d20 4e6f 6e65 0a20 2020 2020 2020  e = None.       
+0000d770: 2066 6f72 2065 7665 6e74 2069 6e20 6576   for event in ev
+0000d780: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
+0000d790: 2020 6167 6772 6567 6174 6520 3d20 6d75    aggregate = mu
+0000d7a0: 7461 746f 725f 6675 6e63 2861 6767 7265  tator_func(aggre
+0000d7b0: 6761 7465 2c20 6576 656e 7429 0a20 2020  gate, event).   
+0000d7c0: 2020 2020 2072 6574 7572 6e20 6167 6772       return aggr
+0000d7d0: 6567 6174 650a 6060 600a 0a53 6e61 7073  egate.```..Snaps
+0000d7e0: 686f 7474 696e 6720 6f66 2061 6767 7265  hotting of aggre
+0000d7f0: 6761 7465 7320 6361 6e20 6265 2069 6d70  gates can be imp
+0000d800: 6c65 6d65 6e74 6564 2062 7920 7265 636f  lemented by reco
+0000d810: 7264 696e 6720 7468 6520 6375 7272 656e  rding the curren
+0000d820: 7420 7374 6174 6520 6f66 0a61 6e20 6167  t state of.an ag
+0000d830: 6772 6567 6174 6520 6173 2061 206e 6577  gregate as a new
+0000d840: 2065 7665 6e74 2e0a 0a49 6620 616e 2061   event...If an a
+0000d850: 6767 7265 6761 7465 206f 626a 6563 7420  ggregate object 
+0000d860: 6861 7320 6120 7665 7273 696f 6e20 6e75  has a version nu
+0000d870: 6d62 6572 2074 6861 7420 636f 7272 6573  mber that corres
+0000d880: 706f 6e64 7320 746f 2074 6865 2073 7472  ponds to the str
+0000d890: 6561 6d20 706f 7369 7469 6f6e 206f 660a  eam position of.
+0000d8a0: 7468 6520 6c61 7374 2065 7665 6e74 2074  the last event t
+0000d8b0: 6861 7420 7761 7320 7573 6564 2074 6f20  hat was used to 
+0000d8c0: 7265 636f 6e73 7472 7563 7420 7468 6520  reconstruct the 
+0000d8d0: 6167 6772 6567 6174 652c 2061 6e64 2074  aggregate, and t
+0000d8e0: 6869 7320 7665 7273 696f 6e20 6e75 6d62  his version numb
+0000d8f0: 6572 0a69 7320 7265 636f 7264 6564 2069  er.is recorded i
+0000d900: 6e20 7468 6520 736e 6170 7368 6f74 206d  n the snapshot m
+0000d910: 6574 6164 6174 612c 2074 6865 6e20 616e  etadata, then an
+0000d920: 7920 6576 656e 7473 2074 6861 7420 6172  y events that ar
+0000d930: 6520 7265 636f 7264 6564 2061 6674 6572  e recorded after
+0000d940: 2074 6865 0a73 6e61 7073 686f 7420 6361   the.snapshot ca
+0000d950: 6e20 6265 2073 656c 6563 7465 6420 7573  n be selected us
+0000d960: 696e 6720 7468 6973 2076 6572 7369 6f6e  ing this version
+0000d970: 206e 756d 6265 722e 2054 6865 2061 6767   number. The agg
+0000d980: 7265 6761 7465 2063 616e 2074 6865 6e20  regate can then 
+0000d990: 6265 0a72 6563 6f6e 7374 7275 6374 6564  be.reconstructed
+0000d9a0: 2066 726f 6d20 7468 6520 6c61 7374 2073   from the last s
+0000d9b0: 6e61 7073 686f 7420 616e 6420 616e 7920  napshot and any 
+0000d9c0: 7375 6273 6571 7565 6e74 2065 7665 6e74  subsequent event
+0000d9d0: 732c 2077 6974 686f 7574 2068 6176 696e  s, without havin
+0000d9e0: 670a 746f 2072 6570 6c61 7920 7468 6520  g.to replay the 
+0000d9f0: 656e 7469 7265 2068 6973 746f 7279 2e0a  entire history..
+0000da00: 0a57 6520 7769 6c6c 2075 7365 2061 2073  .We will use a s
+0000da10: 6570 6172 6174 6520 7374 7265 616d 2066  eparate stream f
+0000da20: 6f72 2061 6e20 6167 6772 6567 6174 6527  or an aggregate'
+0000da30: 7320 736e 6170 7368 6f74 7320 7468 6174  s snapshots that
+0000da40: 2069 7320 6e61 6d65 6420 6166 7465 7220   is named after 
+0000da50: 7468 650a 7374 7265 616d 2075 7365 6420  the.stream used 
+0000da60: 666f 7220 7265 636f 7264 696e 6720 6974  for recording it
+0000da70: 7320 6576 656e 7473 2e20 5468 6520 6e61  s events. The na
+0000da80: 6d65 206f 6620 7468 6520 736e 6170 7368  me of the snapsh
+0000da90: 6f74 2073 7472 6561 6d20 7769 6c6c 2062  ot stream will b
+0000daa0: 650a 636f 6e73 7472 7563 7465 6420 6279  e.constructed by
+0000dab0: 2070 7265 6669 7869 6e67 2074 6865 2061   prefixing the a
+0000dac0: 6767 7265 6761 7465 2773 2073 7472 6561  ggregate's strea
+0000dad0: 6d20 6e61 6d65 2077 6974 6820 6027 736e  m name with `'sn
+0000dae0: 6170 7368 6f74 2d24 2760 2e0a 0a60 6060  apshot-$'`...```
+0000daf0: 7079 7468 6f6e 0a53 4e41 5053 484f 545f  python.SNAPSHOT_
+0000db00: 5354 5245 414d 5f4e 414d 455f 5052 4546  STREAM_NAME_PREF
+0000db10: 4958 203d 2027 736e 6170 7368 6f74 2d24  IX = 'snapshot-$
+0000db20: 270a 0a64 6566 206d 616b 655f 736e 6170  '..def make_snap
+0000db30: 7368 6f74 5f73 7472 6561 6d5f 6e61 6d65  shot_stream_name
+0000db40: 2873 7472 6561 6d5f 6e61 6d65 293a 0a20  (stream_name):. 
+0000db50: 2020 2072 6574 7572 6e20 6627 7b53 4e41     return f'{SNA
+0000db60: 5053 484f 545f 5354 5245 414d 5f4e 414d  PSHOT_STREAM_NAM
+0000db70: 455f 5052 4546 4958 7d7b 7374 7265 616d  E_PREFIX}{stream
+0000db80: 5f6e 616d 657d 270a 0a0a 6465 6620 7265  _name}'...def re
+0000db90: 6d6f 7665 5f73 6e61 7073 686f 745f 7374  move_snapshot_st
+0000dba0: 7265 616d 5f70 7265 6669 7828 736e 6170  ream_prefix(snap
+0000dbb0: 7368 6f74 5f73 7472 6561 6d5f 6e61 6d65  shot_stream_name
+0000dbc0: 293a 0a20 2020 2061 7373 6572 7420 736e  ):.    assert sn
+0000dbd0: 6170 7368 6f74 5f73 7472 6561 6d5f 6e61  apshot_stream_na
+0000dbe0: 6d65 2e73 7461 7274 7377 6974 6828 534e  me.startswith(SN
+0000dbf0: 4150 5348 4f54 5f53 5452 4541 4d5f 4e41  APSHOT_STREAM_NA
+0000dc00: 4d45 5f50 5245 4649 5829 0a20 2020 2072  ME_PREFIX).    r
+0000dc10: 6574 7572 6e20 736e 6170 7368 6f74 5f73  eturn snapshot_s
+0000dc20: 7472 6561 6d5f 6e61 6d65 5b6c 656e 2853  tream_name[len(S
+0000dc30: 4e41 5053 484f 545f 5354 5245 414d 5f4e  NAPSHOT_STREAM_N
+0000dc40: 414d 455f 5052 4546 4958 293a 5d0a 6060  AME_PREFIX):].``
+0000dc50: 600a 0a4e 6f77 2c20 6c65 7427 7320 7265  `..Now, let's re
+0000dc60: 6465 6669 6e65 2074 6865 2060 6765 745f  define the `get_
+0000dc70: 6167 6772 6567 6174 6528 2960 2066 756e  aggregate()` fun
+0000dc80: 6374 696f 6e2c 2073 6f20 7468 6174 2069  ction, so that i
+0000dc90: 7420 6c6f 6f6b 7320 666f 7220 6120 736e  t looks for a sn
+0000dca0: 6170 7368 6f74 2065 7665 6e74 2c0a 7468  apshot event,.th
+0000dcb0: 656e 2073 656c 6563 7473 2073 7562 7365  en selects subse
+0000dcc0: 7175 656e 7420 6167 6772 6567 6174 6520  quent aggregate 
+0000dcd0: 6576 656e 7473 2c20 616e 6420 7468 656e  events, and then
+0000dce0: 2063 616c 6c73 2061 206d 7574 6174 6f72   calls a mutator
+0000dcf0: 2066 756e 6374 696f 6e20 666f 7220 6561   function for ea
+0000dd00: 6368 0a72 6563 6f72 6465 6420 6576 656e  ch.recorded even
+0000dd10: 742e 0a0a 4e6f 7469 6365 2074 6861 7420  t...Notice that 
+0000dd20: 7468 6520 6167 6772 6567 6174 6520 6576  the aggregate ev
+0000dd30: 656e 7473 2061 7265 2072 6561 6420 6672  ents are read fr
+0000dd40: 6f6d 2061 2073 7472 6561 6d20 666f 7220  om a stream for 
+0000dd50: 7365 7269 616c 697a 6564 2061 6767 7265  serialized aggre
+0000dd60: 6761 7465 0a65 7665 6e74 732c 2077 6869  gate.events, whi
+0000dd70: 6c73 7420 7468 6520 736e 6170 7368 6f74  lst the snapshot
+0000dd80: 2069 7320 7265 6164 2066 726f 6d20 6120   is read from a 
+0000dd90: 7365 7061 7261 7465 2073 7472 6561 6d20  separate stream 
+0000dda0: 666f 7220 7365 7269 616c 697a 6564 2061  for serialized a
+0000ddb0: 6767 7265 6761 7465 0a73 6e61 7073 686f  ggregate.snapsho
+0000ddc0: 7473 2e20 5765 2077 696c 6c20 7573 6520  ts. We will use 
+0000ddd0: 4a53 4f4e 2074 6f20 7365 7269 616c 697a  JSON to serializ
+0000dde0: 6520 616e 6420 6465 7365 7269 616c 697a  e and deserializ
+0000ddf0: 6520 6576 656e 7420 6461 7461 2e0a 0a0a  e event data....
+0000de00: 6060 6070 7974 686f 6e0a 696d 706f 7274  ```python.import
+0000de10: 206a 736f 6e0a 0a0a 6465 6620 6765 745f   json...def get_
+0000de20: 6167 6772 6567 6174 6528 6167 6772 6567  aggregate(aggreg
+0000de30: 6174 655f 6964 2c20 6d75 7461 746f 725f  ate_id, mutator_
+0000de40: 6675 6e63 293a 0a20 2020 2073 7472 6561  func):.    strea
+0000de50: 6d5f 6e61 6d65 203d 2061 6767 7265 6761  m_name = aggrega
+0000de60: 7465 5f69 640a 2020 2020 7265 636f 7264  te_id.    record
+0000de70: 6564 5f65 7665 6e74 7320 3d20 5b5d 0a0a  ed_events = []..
+0000de80: 2020 2020 2320 4c6f 6f6b 2066 6f72 2061      # Look for a
+0000de90: 2073 6e61 7073 686f 742e 0a20 2020 2074   snapshot..    t
+0000dea0: 7279 3a0a 2020 2020 2020 2020 736e 6170  ry:.        snap
+0000deb0: 7368 6f74 7320 3d20 636c 6965 6e74 2e67  shots = client.g
+0000dec0: 6574 5f73 7472 6561 6d28 0a20 2020 2020  et_stream(.     
+0000ded0: 2020 2020 2020 2073 7472 6561 6d5f 6e61         stream_na
+0000dee0: 6d65 3d6d 616b 655f 736e 6170 7368 6f74  me=make_snapshot
+0000def0: 5f73 7472 6561 6d5f 6e61 6d65 2873 7472  _stream_name(str
+0000df00: 6561 6d5f 6e61 6d65 292c 0a20 2020 2020  eam_name),.     
+0000df10: 2020 2020 2020 2062 6163 6b77 6172 6473         backwards
+0000df20: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+0000df30: 2020 206c 696d 6974 3d31 0a20 2020 2020     limit=1.     
+0000df40: 2020 2029 0a20 2020 2065 7863 6570 7420     ).    except 
+0000df50: 4e6f 7446 6f75 6e64 3a0a 2020 2020 2020  NotFound:.      
+0000df60: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
+0000df70: 6e20 3d20 4e6f 6e65 0a20 2020 2065 6c73  n = None.    els
+0000df80: 653a 0a20 2020 2020 2020 2061 7373 6572  e:.        asser
+0000df90: 7420 6c65 6e28 736e 6170 7368 6f74 7329  t len(snapshots)
+0000dfa0: 203d 3d20 310a 2020 2020 2020 2020 736e   == 1.        sn
+0000dfb0: 6170 7368 6f74 203d 2073 6e61 7073 686f  apshot = snapsho
+0000dfc0: 7473 5b30 5d0a 2020 2020 2020 2020 7374  ts[0].        st
+0000dfd0: 7265 616d 5f70 6f73 6974 696f 6e20 3d20  ream_position = 
+0000dfe0: 6465 7365 7269 616c 697a 6528 736e 6170  deserialize(snap
+0000dff0: 7368 6f74 2e6d 6574 6164 6174 6129 5b27  shot.metadata)['
+0000e000: 7665 7273 696f 6e27 5d20 2b20 310a 2020  version'] + 1.  
+0000e010: 2020 2020 2020 7265 636f 7264 6564 5f65        recorded_e
+0000e020: 7665 6e74 732e 6170 7065 6e64 2873 6e61  vents.append(sna
+0000e030: 7073 686f 7429 0a0a 2020 2020 2320 4765  pshot)..    # Ge
+0000e040: 7420 7375 6273 6571 7565 6e74 2065 7665  t subsequent eve
+0000e050: 6e74 732e 0a20 2020 2074 7279 3a0a 2020  nts..    try:.  
+0000e060: 2020 2020 2020 6576 656e 7473 203d 2063        events = c
+0000e070: 6c69 656e 742e 6765 745f 7374 7265 616d  lient.get_stream
+0000e080: 280a 2020 2020 2020 2020 2020 2020 7374  (.            st
+0000e090: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+0000e0a0: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
+0000e0b0: 2020 2073 7472 6561 6d5f 706f 7369 7469     stream_positi
+0000e0c0: 6f6e 3d73 7472 6561 6d5f 706f 7369 7469  on=stream_positi
+0000e0d0: 6f6e 0a20 2020 2020 2020 2029 0a20 2020  on.        ).   
+0000e0e0: 2065 7863 6570 7420 4e6f 7446 6f75 6e64   except NotFound
+0000e0f0: 2061 7320 653a 0a20 2020 2020 2020 2072   as e:.        r
+0000e100: 6169 7365 2041 6767 7265 6761 7465 4e6f  aise AggregateNo
+0000e110: 7446 6f75 6e64 2861 6767 7265 6761 7465  tFound(aggregate
+0000e120: 5f69 6429 2066 726f 6d20 650a 2020 2020  _id) from e.    
+0000e130: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
+0000e140: 636f 7264 6564 5f65 7665 6e74 7320 2b3d  corded_events +=
+0000e150: 2065 7665 6e74 730a 0a20 2020 2023 2052   events..    # R
+0000e160: 6563 6f6e 7374 7275 6374 2061 6767 7265  econstruct aggre
+0000e170: 6761 7465 2066 726f 6d20 7265 636f 7264  gate from record
+0000e180: 6564 2065 7665 6e74 732e 0a20 2020 2061  ed events..    a
+0000e190: 6767 7265 6761 7465 203d 204e 6f6e 650a  ggregate = None.
+0000e1a0: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
+0000e1b0: 2072 6563 6f72 6465 645f 6576 656e 7473   recorded_events
+0000e1c0: 3a0a 2020 2020 2020 2020 6167 6772 6567  :.        aggreg
+0000e1d0: 6174 6520 3d20 6d75 7461 746f 725f 6675  ate = mutator_fu
+0000e1e0: 6e63 2861 6767 7265 6761 7465 2c20 6576  nc(aggregate, ev
+0000e1f0: 656e 7429 0a0a 2020 2020 7265 7475 726e  ent)..    return
+0000e200: 2061 6767 7265 6761 7465 0a0a 0a64 6566   aggregate...def
+0000e210: 2073 6572 6961 6c69 7a65 2864 293a 0a20   serialize(d):. 
+0000e220: 2020 2072 6574 7572 6e20 6a73 6f6e 2e64     return json.d
+0000e230: 756d 7073 2864 292e 656e 636f 6465 2827  umps(d).encode('
+0000e240: 7574 6638 2729 0a0a 0a64 6566 2064 6573  utf8')...def des
+0000e250: 6572 6961 6c69 7a65 2873 293a 0a20 2020  erialize(s):.   
+0000e260: 2072 6574 7572 6e20 6a73 6f6e 2e6c 6f61   return json.loa
+0000e270: 6473 2873 2e64 6563 6f64 6528 2775 7466  ds(s.decode('utf
+0000e280: 3827 2929 0a60 6060 0a0a 546f 2073 686f  8')).```..To sho
+0000e290: 7720 686f 7720 6067 6574 5f61 6767 7265  w how `get_aggre
+0000e2a0: 6761 7465 2829 6020 6361 6e20 6265 2075  gate()` can be u
+0000e2b0: 7365 642c 206c 6574 2773 2064 6566 696e  sed, let's defin
+0000e2c0: 6520 6120 6044 6f67 6020 6167 6772 6567  e a `Dog` aggreg
+0000e2d0: 6174 6520 636c 6173 732c 2077 6974 680a  ate class, with.
+0000e2e0: 6174 7472 6962 7574 6573 2060 6e61 6d65  attributes `name
+0000e2f0: 6020 616e 6420 6074 7269 636b 7360 2e20  ` and `tricks`. 
+0000e300: 5468 6520 6174 7472 6962 7574 6573 2060  The attributes `
+0000e310: 6964 6020 616e 6420 6076 6572 7369 6f6e  id` and `version
+0000e320: 6020 7769 6c6c 2069 6e64 6963 6174 6520  ` will indicate 
+0000e330: 616e 0a61 6767 7265 6761 7465 206f 626a  an.aggregate obj
+0000e340: 6563 7427 7320 4944 2061 6e64 2076 6572  ect's ID and ver
+0000e350: 7369 6f6e 206e 756d 6265 722e 2054 6865  sion number. The
+0000e360: 2061 7474 7269 6275 7465 2060 6973 5f66   attribute `is_f
+0000e370: 726f 6d5f 736e 6170 7368 6f74 6020 6973  rom_snapshot` is
+0000e380: 2061 6464 6564 0a68 6572 6520 6d65 7265   added.here mere
+0000e390: 6c79 2074 6f20 6465 6d6f 6e73 7472 6174  ly to demonstrat
+0000e3a0: 6520 6265 6c6f 7720 7768 656e 2061 6e20  e below when an 
+0000e3b0: 6167 6772 6567 6174 6520 6f62 6a65 6374  aggregate object
+0000e3c0: 2068 6173 2062 6565 6e20 7265 636f 6e73   has been recons
+0000e3d0: 7472 7563 7465 6420 7573 696e 670a 6120  tructed using.a 
+0000e3e0: 736e 6170 7368 6f74 2e0a 0a60 6060 7079  snapshot...```py
+0000e3f0: 7468 6f6e 0a66 726f 6d20 6461 7461 636c  thon.from datacl
+0000e400: 6173 7365 7320 696d 706f 7274 2064 6174  asses import dat
+0000e410: 6163 6c61 7373 0a0a 0a40 6461 7461 636c  aclass...@datacl
+0000e420: 6173 7328 6672 6f7a 656e 3d54 7275 6529  ass(frozen=True)
+0000e430: 0a63 6c61 7373 2041 6767 7265 6761 7465  .class Aggregate
+0000e440: 3a0a 2020 2020 6964 3a20 7374 720a 2020  :.    id: str.  
+0000e450: 2020 7665 7273 696f 6e3a 2069 6e74 0a20    version: int. 
+0000e460: 2020 2069 735f 6672 6f6d 5f73 6e61 7073     is_from_snaps
+0000e470: 686f 743a 2062 6f6f 6c0a 0a0a 4064 6174  hot: bool...@dat
+0000e480: 6163 6c61 7373 2866 726f 7a65 6e3d 5472  aclass(frozen=Tr
+0000e490: 7565 290a 636c 6173 7320 446f 6728 4167  ue).class Dog(Ag
+0000e4a0: 6772 6567 6174 6529 3a0a 2020 2020 6e61  gregate):.    na
+0000e4b0: 6d65 3a20 7374 720a 2020 2020 7472 6963  me: str.    tric
+0000e4c0: 6b73 3a20 6c69 7374 0a60 6060 0a0a 4c65  ks: list.```..Le
+0000e4d0: 7427 7320 616c 736f 2064 6566 696e 6520  t's also define 
+0000e4e0: 6120 6d75 7461 746f 7220 6675 6e63 7469  a mutator functi
+0000e4f0: 6f6e 2060 6d75 7461 7465 5f64 6f67 2829  on `mutate_dog()
+0000e500: 6020 7468 6174 2065 766f 6c76 6573 2074  ` that evolves t
+0000e510: 6865 2073 7461 7465 206f 6620 610a 6044  he state of a.`D
+0000e520: 6f67 6020 6167 6772 6567 6174 6520 6769  og` aggregate gi
+0000e530: 7665 6e20 7661 7269 6f75 7320 6469 6666  ven various diff
+0000e540: 6572 656e 7420 7479 7065 7320 6f66 2065  erent types of e
+0000e550: 7665 6e74 732c 2060 2744 6f67 5265 6769  vents, `'DogRegi
+0000e560: 7374 6572 6564 2760 2c0a 6027 446f 674c  stered'`,.`'DogL
+0000e570: 6561 726e 6564 5472 6963 6b27 602c 2061  earnedTrick'`, a
+0000e580: 6e64 2060 2753 6e61 7073 686f 7427 602e  nd `'Snapshot'`.
+0000e590: 0a0a 6060 6070 7974 686f 6e0a 6465 6620  ..```python.def 
+0000e5a0: 6d75 7461 7465 5f64 6f67 2864 6f67 2c20  mutate_dog(dog, 
+0000e5b0: 6576 656e 7429 3a0a 2020 2020 6461 7461  event):.    data
+0000e5c0: 203d 2064 6573 6572 6961 6c69 7a65 2865   = deserialize(e
+0000e5d0: 7665 6e74 2e64 6174 6129 0a20 2020 2069  vent.data).    i
+0000e5e0: 6620 6576 656e 742e 7479 7065 203d 3d20  f event.type == 
+0000e5f0: 2744 6f67 5265 6769 7374 6572 6564 273a  'DogRegistered':
+0000e600: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000e610: 446f 6728 0a20 2020 2020 2020 2020 2020  Dog(.           
+0000e620: 2069 643d 6576 656e 742e 7374 7265 616d   id=event.stream
+0000e630: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
+0000e640: 2020 2076 6572 7369 6f6e 3d65 7665 6e74     version=event
+0000e650: 2e73 7472 6561 6d5f 706f 7369 7469 6f6e  .stream_position
+0000e660: 2c0a 2020 2020 2020 2020 2020 2020 6973  ,.            is
+0000e670: 5f66 726f 6d5f 736e 6170 7368 6f74 3d46  _from_snapshot=F
+0000e680: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+0000e690: 2020 6e61 6d65 3d64 6174 615b 276e 616d    name=data['nam
+0000e6a0: 6527 5d2c 0a20 2020 2020 2020 2020 2020  e'],.           
+0000e6b0: 2074 7269 636b 733d 5b5d 2c0a 2020 2020   tricks=[],.    
+0000e6c0: 2020 2020 290a 2020 2020 656c 6966 2065      ).    elif e
+0000e6d0: 7665 6e74 2e74 7970 6520 3d3d 2027 446f  vent.type == 'Do
+0000e6e0: 674c 6561 726e 6564 5472 6963 6b27 3a0a  gLearnedTrick':.
+0000e6f0: 2020 2020 2020 2020 6173 7365 7274 2065          assert e
+0000e700: 7665 6e74 2e73 7472 6561 6d5f 706f 7369  vent.stream_posi
+0000e710: 7469 6f6e 203d 3d20 646f 672e 7665 7273  tion == dog.vers
+0000e720: 696f 6e20 2b20 310a 2020 2020 2020 2020  ion + 1.        
+0000e730: 6173 7365 7274 2065 7665 6e74 2e73 7472  assert event.str
+0000e740: 6561 6d5f 6e61 6d65 203d 3d20 646f 672e  eam_name == dog.
+0000e750: 6964 2c20 2865 7665 6e74 2e73 7472 6561  id, (event.strea
+0000e760: 6d5f 6e61 6d65 2c20 646f 672e 6964 290a  m_name, dog.id).
+0000e770: 2020 2020 2020 2020 7265 7475 726e 2044          return D
+0000e780: 6f67 280a 2020 2020 2020 2020 2020 2020  og(.            
+0000e790: 6964 3d64 6f67 2e69 642c 0a20 2020 2020  id=dog.id,.     
+0000e7a0: 2020 2020 2020 2076 6572 7369 6f6e 3d65         version=e
+0000e7b0: 7665 6e74 2e73 7472 6561 6d5f 706f 7369  vent.stream_posi
+0000e7c0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0000e7d0: 2020 6973 5f66 726f 6d5f 736e 6170 7368    is_from_snapsh
+0000e7e0: 6f74 3d64 6f67 2e69 735f 6672 6f6d 5f73  ot=dog.is_from_s
+0000e7f0: 6e61 7073 686f 742c 0a20 2020 2020 2020  napshot,.       
+0000e800: 2020 2020 206e 616d 653d 646f 672e 6e61       name=dog.na
+0000e810: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0000e820: 7472 6963 6b73 3d64 6f67 2e74 7269 636b  tricks=dog.trick
+0000e830: 7320 2b20 5b64 6174 615b 2774 7269 636b  s + [data['trick
+0000e840: 275d 5d2c 0a20 2020 2020 2020 2029 0a20  ']],.        ). 
+0000e850: 2020 2065 6c69 6620 6576 656e 742e 7479     elif event.ty
+0000e860: 7065 203d 3d20 2753 6e61 7073 686f 7427  pe == 'Snapshot'
+0000e870: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000e880: 2044 6f67 280a 2020 2020 2020 2020 2020   Dog(.          
+0000e890: 2020 6964 3d72 656d 6f76 655f 736e 6170    id=remove_snap
+0000e8a0: 7368 6f74 5f73 7472 6561 6d5f 7072 6566  shot_stream_pref
+0000e8b0: 6978 2865 7665 6e74 2e73 7472 6561 6d5f  ix(event.stream_
+0000e8c0: 6e61 6d65 292c 0a20 2020 2020 2020 2020  name),.         
+0000e8d0: 2020 2076 6572 7369 6f6e 3d64 6573 6572     version=deser
+0000e8e0: 6961 6c69 7a65 2865 7665 6e74 2e6d 6574  ialize(event.met
+0000e8f0: 6164 6174 6129 5b27 7665 7273 696f 6e27  adata)['version'
+0000e900: 5d2c 0a20 2020 2020 2020 2020 2020 2069  ],.            i
+0000e910: 735f 6672 6f6d 5f73 6e61 7073 686f 743d  s_from_snapshot=
+0000e920: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+0000e930: 2020 6e61 6d65 3d64 6174 615b 276e 616d    name=data['nam
+0000e940: 6527 5d2c 0a20 2020 2020 2020 2020 2020  e'],.           
+0000e950: 2074 7269 636b 733d 6461 7461 5b27 7472   tricks=data['tr
+0000e960: 6963 6b73 275d 2c0a 2020 2020 2020 2020  icks'],.        
+0000e970: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+0000e980: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+0000e990: 696f 6e28 6622 556e 6b6e 6f77 6e20 6576  ion(f"Unknown ev
+0000e9a0: 656e 7420 7479 7065 3a20 7b65 7665 6e74  ent type: {event
+0000e9b0: 2e74 7970 657d 2229 0a60 6060 0a0a 466f  .type}").```..Fo
+0000e9c0: 7220 636f 6e76 656e 6965 6e63 652c 206c  r convenience, l
+0000e9d0: 6574 2773 2061 6c73 6f20 6465 6669 6e65  et's also define
+0000e9e0: 2061 2060 6765 745f 646f 6728 2960 2066   a `get_dog()` f
+0000e9f0: 756e 6374 696f 6e20 7468 6174 2063 616c  unction that cal
+0000ea00: 6c73 2060 6765 745f 6167 6772 6567 6174  ls `get_aggregat
+0000ea10: 6528 2960 0a77 6974 6820 7468 6520 606d  e()`.with the `m
+0000ea20: 7574 6174 655f 646f 6728 2960 2066 756e  utate_dog()` fun
+0000ea30: 6374 696f 6e20 6173 2074 6865 2076 616c  ction as the val
+0000ea40: 7565 206f 6620 6974 7320 606d 7574 6174  ue of its `mutat
+0000ea50: 6f72 5f66 756e 6360 2061 7267 756d 656e  or_func` argumen
+0000ea60: 742e 0a0a 6060 6070 7974 686f 6e0a 6465  t...```python.de
+0000ea70: 6620 6765 745f 646f 6728 646f 675f 6964  f get_dog(dog_id
+0000ea80: 293a 0a20 2020 2072 6574 7572 6e20 6765  ):.    return ge
+0000ea90: 745f 6167 6772 6567 6174 6528 0a20 2020  t_aggregate(.   
+0000eaa0: 2020 2020 2061 6767 7265 6761 7465 5f69       aggregate_i
+0000eab0: 643d 646f 675f 6964 2c0a 2020 2020 2020  d=dog_id,.      
+0000eac0: 2020 6d75 7461 746f 725f 6675 6e63 3d6d    mutator_func=m
+0000ead0: 7574 6174 655f 646f 672c 0a20 2020 2029  utate_dog,.    )
+0000eae0: 0a60 6060 0a0a 5765 2063 616e 2061 6c73  .```..We can als
+0000eaf0: 6f20 6465 6669 6e65 2073 6f6d 6520 2263  o define some "c
+0000eb00: 6f6d 6d61 6e64 2220 6675 6e63 7469 6f6e  ommand" function
+0000eb10: 7320 7468 6174 2061 7070 656e 6420 6e65  s that append ne
+0000eb20: 7720 6576 656e 7473 2074 6f20 7468 650a  w events to the.
+0000eb30: 6461 7461 6261 7365 2e20 5468 6520 6072  database. The `r
+0000eb40: 6567 6973 7465 725f 646f 6728 2960 2066  egister_dog()` f
+0000eb50: 756e 6374 696f 6e20 6170 7065 6e64 7320  unction appends 
+0000eb60: 6120 6044 6f67 5265 6769 7374 6572 6564  a `DogRegistered
+0000eb70: 6020 6576 656e 742e 2054 6865 0a60 7265  ` event. The.`re
+0000eb80: 636f 7264 5f74 7269 636b 5f6c 6561 726e  cord_trick_learn
+0000eb90: 6564 2829 6020 6170 7065 6e64 7320 6120  ed()` appends a 
+0000eba0: 6044 6f67 4c65 6172 6e65 6454 7269 636b  `DogLearnedTrick
+0000ebb0: 6020 6576 656e 742e 2054 6865 2066 756e  ` event. The fun
+0000ebc0: 6374 696f 6e0a 6073 6e61 7073 686f 745f  ction.`snapshot_
+0000ebd0: 646f 6728 2960 2061 7070 656e 6473 2061  dog()` appends a
+0000ebe0: 2060 536e 6170 7368 6f74 6020 6576 656e   `Snapshot` even
+0000ebf0: 742e 204e 6f74 6963 6520 7468 6174 2074  t. Notice that t
+0000ec00: 6865 0a60 7265 636f 7264 5f74 7269 636b  he.`record_trick
+0000ec10: 5f6c 6561 726e 6564 2829 6020 616e 6420  _learned()` and 
+0000ec20: 6073 6e61 7073 686f 745f 646f 6728 2960  `snapshot_dog()`
+0000ec30: 2066 756e 6374 696f 6e73 2075 7365 2060   functions use `
+0000ec40: 6765 745f 646f 6728 2960 2e0a 0a4e 6f74  get_dog()`...Not
+0000ec50: 6963 6520 616c 736f 2074 6861 7420 7468  ice also that th
+0000ec60: 6520 6044 6f67 5265 6769 7374 6572 6564  e `DogRegistered
+0000ec70: 6020 616e 6420 6044 6f67 4c65 6172 6e65  ` and `DogLearne
+0000ec80: 6454 7269 636b 6020 6576 656e 7473 2061  dTrick` events a
+0000ec90: 7265 2061 7070 656e 6465 6420 746f 2061  re appended to a
+0000eca0: 0a73 7472 6561 6d20 666f 7220 6167 6772  .stream for aggr
+0000ecb0: 6567 6174 6520 6576 656e 7473 2c20 7768  egate events, wh
+0000ecc0: 696c 7374 2074 6865 2060 536e 6170 7368  ilst the `Snapsh
+0000ecd0: 6f74 6020 6576 656e 7420 6973 2061 7070  ot` event is app
+0000ece0: 656e 6465 6420 746f 2061 2073 6570 6172  ended to a separ
+0000ecf0: 6174 650a 7374 7265 616d 2066 6f72 2061  ate.stream for a
+0000ed00: 6767 7265 6761 7465 2073 6e61 7073 686f  ggregate snapsho
+0000ed10: 7473 2e0a 0a60 6060 7079 7468 6f6e 0a64  ts...```python.d
+0000ed20: 6566 2072 6567 6973 7465 725f 646f 6728  ef register_dog(
+0000ed30: 6e61 6d65 293a 0a20 2020 2064 6f67 5f69  name):.    dog_i
+0000ed40: 6420 3d20 7374 7228 7575 6964 2e75 7569  d = str(uuid.uui
+0000ed50: 6434 2829 290a 2020 2020 6576 656e 7420  d4()).    event 
+0000ed60: 3d20 4e65 7745 7665 6e74 280a 2020 2020  = NewEvent(.    
+0000ed70: 2020 2020 7479 7065 3d27 446f 6752 6567      type='DogReg
+0000ed80: 6973 7465 7265 6427 2c0a 2020 2020 2020  istered',.      
+0000ed90: 2020 6461 7461 3d73 6572 6961 6c69 7a65    data=serialize
+0000eda0: 287b 276e 616d 6527 3a20 6e61 6d65 7d29  ({'name': name})
+0000edb0: 2c0a 2020 2020 290a 2020 2020 636c 6965  ,.    ).    clie
+0000edc0: 6e74 2e61 7070 656e 645f 746f 5f73 7472  nt.append_to_str
+0000edd0: 6561 6d28 0a20 2020 2020 2020 2073 7472  eam(.        str
+0000ede0: 6561 6d5f 6e61 6d65 3d64 6f67 5f69 642c  eam_name=dog_id,
+0000edf0: 0a20 2020 2020 2020 2063 7572 7265 6e74  .        current
+0000ee00: 5f76 6572 7369 6f6e 3d53 7472 6561 6d53  _version=StreamS
+0000ee10: 7461 7465 2e4e 4f5f 5354 5245 414d 2c0a  tate.NO_STREAM,.
+0000ee20: 2020 2020 2020 2020 6576 656e 7473 3d65          events=e
+0000ee30: 7665 6e74 2c0a 2020 2020 290a 2020 2020  vent,.    ).    
+0000ee40: 7265 7475 726e 2064 6f67 5f69 640a 0a0a  return dog_id...
+0000ee50: 6465 6620 7265 636f 7264 5f74 7269 636b  def record_trick
+0000ee60: 5f6c 6561 726e 6564 2864 6f67 5f69 642c  _learned(dog_id,
+0000ee70: 2074 7269 636b 293a 0a20 2020 2064 6f67   trick):.    dog
+0000ee80: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
+0000ee90: 6429 0a20 2020 2065 7665 6e74 203d 204e  d).    event = N
+0000eea0: 6577 4576 656e 7428 0a20 2020 2020 2020  ewEvent(.       
+0000eeb0: 2074 7970 653d 2744 6f67 4c65 6172 6e65   type='DogLearne
+0000eec0: 6454 7269 636b 272c 0a20 2020 2020 2020  dTrick',.       
+0000eed0: 2064 6174 613d 7365 7269 616c 697a 6528   data=serialize(
+0000eee0: 7b27 7472 6963 6b27 3a20 7472 6963 6b7d  {'trick': trick}
+0000eef0: 292c 0a20 2020 2029 0a20 2020 2063 6c69  ),.    ).    cli
+0000ef00: 656e 742e 6170 7065 6e64 5f74 6f5f 7374  ent.append_to_st
+0000ef10: 7265 616d 280a 2020 2020 2020 2020 7374  ream(.        st
+0000ef20: 7265 616d 5f6e 616d 653d 646f 675f 6964  ream_name=dog_id
+0000ef30: 2c0a 2020 2020 2020 2020 6375 7272 656e  ,.        curren
+0000ef40: 745f 7665 7273 696f 6e3d 646f 672e 7665  t_version=dog.ve
+0000ef50: 7273 696f 6e2c 0a20 2020 2020 2020 2065  rsion,.        e
+0000ef60: 7665 6e74 733d 6576 656e 742c 0a20 2020  vents=event,.   
+0000ef70: 2029 0a0a 0a64 6566 2073 6e61 7073 686f   )...def snapsho
+0000ef80: 745f 646f 6728 646f 675f 6964 293a 0a20  t_dog(dog_id):. 
+0000ef90: 2020 2064 6f67 203d 2067 6574 5f64 6f67     dog = get_dog
+0000efa0: 2864 6f67 5f69 6429 0a20 2020 2065 7665  (dog_id).    eve
+0000efb0: 6e74 203d 204e 6577 4576 656e 7428 0a20  nt = NewEvent(. 
+0000efc0: 2020 2020 2020 2074 7970 653d 2753 6e61         type='Sna
+0000efd0: 7073 686f 7427 2c0a 2020 2020 2020 2020  pshot',.        
+0000efe0: 6461 7461 3d73 6572 6961 6c69 7a65 287b  data=serialize({
+0000eff0: 276e 616d 6527 3a20 646f 672e 6e61 6d65  'name': dog.name
+0000f000: 2c20 2774 7269 636b 7327 3a20 646f 672e  , 'tricks': dog.
+0000f010: 7472 6963 6b73 7d29 2c0a 2020 2020 2020  tricks}),.      
+0000f020: 2020 6d65 7461 6461 7461 3d73 6572 6961    metadata=seria
+0000f030: 6c69 7a65 287b 2776 6572 7369 6f6e 273a  lize({'version':
+0000f040: 2064 6f67 2e76 6572 7369 6f6e 7d29 2c0a   dog.version}),.
+0000f050: 2020 2020 290a 2020 2020 636c 6965 6e74      ).    client
+0000f060: 2e61 7070 656e 645f 746f 5f73 7472 6561  .append_to_strea
+0000f070: 6d28 0a20 2020 2020 2020 2073 7472 6561  m(.        strea
+0000f080: 6d5f 6e61 6d65 3d6d 616b 655f 736e 6170  m_name=make_snap
+0000f090: 7368 6f74 5f73 7472 6561 6d5f 6e61 6d65  shot_stream_name
+0000f0a0: 2864 6f67 5f69 6429 2c0a 2020 2020 2020  (dog_id),.      
+0000f0b0: 2020 6375 7272 656e 745f 7665 7273 696f    current_versio
+0000f0c0: 6e3d 5374 7265 616d 5374 6174 652e 414e  n=StreamState.AN
+0000f0d0: 592c 0a20 2020 2020 2020 2065 7665 6e74  Y,.        event
+0000f0e0: 733d 6576 656e 742c 0a20 2020 2029 0a60  s=event,.    ).`
+0000f0f0: 6060 0a0a 5765 2063 616e 2063 616c 6c20  ``..We can call 
+0000f100: 6072 6567 6973 7465 725f 646f 6728 2960  `register_dog()`
+0000f110: 2074 6f20 7265 6769 7374 6572 2061 206e   to register a n
+0000f120: 6577 2064 6f67 2e0a 0a60 6060 7079 7468  ew dog...```pyth
+0000f130: 6f6e 0a23 2052 6567 6973 7465 7220 6120  on.# Register a 
+0000f140: 6e65 7720 646f 672e 0a64 6f67 5f69 6420  new dog..dog_id 
+0000f150: 3d20 7265 6769 7374 6572 5f64 6f67 2827  = register_dog('
+0000f160: 4669 646f 2729 0a0a 646f 6720 3d20 6765  Fido')..dog = ge
+0000f170: 745f 646f 6728 646f 675f 6964 290a 6173  t_dog(dog_id).as
+0000f180: 7365 7274 2064 6f67 2e6e 616d 6520 3d3d  sert dog.name ==
+0000f190: 2027 4669 646f 270a 6173 7365 7274 2064   'Fido'.assert d
+0000f1a0: 6f67 2e74 7269 636b 7320 3d3d 205b 5d0a  og.tricks == [].
+0000f1b0: 6173 7365 7274 2064 6f67 2e76 6572 7369  assert dog.versi
+0000f1c0: 6f6e 203d 3d20 300a 6173 7365 7274 2064  on == 0.assert d
+0000f1d0: 6f67 2e69 735f 6672 6f6d 5f73 6e61 7073  og.is_from_snaps
+0000f1e0: 686f 7420 6973 2046 616c 7365 0a0a 6060  hot is False..``
+0000f1f0: 600a 0a57 6520 6361 6e20 6361 6c6c 2060  `..We can call `
+0000f200: 7265 636f 7264 5f74 7269 636b 5f6c 6561  record_trick_lea
+0000f210: 726e 6564 2829 6020 746f 2072 6563 6f72  rned()` to recor
+0000f220: 6420 7468 6174 2073 6f6d 6520 7472 6963  d that some tric
+0000f230: 6b73 2068 6176 6520 6265 656e 206c 6561  ks have been lea
+0000f240: 726e 6564 2e0a 0a60 6060 7079 7468 6f6e  rned...```python
+0000f250: 0a0a 2320 5265 636f 7264 2074 6861 7420  ..# Record that 
+0000f260: 2746 6964 6f27 206c 6561 726e 6564 2061  'Fido' learned a
+0000f270: 206e 6577 2074 7269 636b 2e0a 7265 636f   new trick..reco
+0000f280: 7264 5f74 7269 636b 5f6c 6561 726e 6564  rd_trick_learned
+0000f290: 2864 6f67 5f69 642c 2074 7269 636b 3d27  (dog_id, trick='
+0000f2a0: 726f 6c6c 206f 7665 7227 290a 0a64 6f67  roll over')..dog
+0000f2b0: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
+0000f2c0: 6429 0a61 7373 6572 7420 646f 672e 6e61  d).assert dog.na
+0000f2d0: 6d65 203d 3d20 2746 6964 6f27 0a61 7373  me == 'Fido'.ass
+0000f2e0: 6572 7420 646f 672e 7472 6963 6b73 203d  ert dog.tricks =
+0000f2f0: 3d20 5b27 726f 6c6c 206f 7665 7227 5d0a  = ['roll over'].
+0000f300: 6173 7365 7274 2064 6f67 2e76 6572 7369  assert dog.versi
+0000f310: 6f6e 203d 3d20 310a 6173 7365 7274 2064  on == 1.assert d
+0000f320: 6f67 2e69 735f 6672 6f6d 5f73 6e61 7073  og.is_from_snaps
+0000f330: 686f 7420 6973 2046 616c 7365 0a0a 0a23  hot is False...#
+0000f340: 2052 6563 6f72 6420 7468 6174 2027 4669   Record that 'Fi
+0000f350: 646f 2720 6c65 6172 6e65 6420 616e 6f74  do' learned anot
+0000f360: 6865 7220 6e65 7720 7472 6963 6b2e 0a72  her new trick..r
+0000f370: 6563 6f72 645f 7472 6963 6b5f 6c65 6172  ecord_trick_lear
+0000f380: 6e65 6428 646f 675f 6964 2c20 7472 6963  ned(dog_id, tric
+0000f390: 6b3d 2766 6574 6368 2062 616c 6c27 290a  k='fetch ball').
+0000f3a0: 0a64 6f67 203d 2067 6574 5f64 6f67 2864  .dog = get_dog(d
+0000f3b0: 6f67 5f69 6429 0a61 7373 6572 7420 646f  og_id).assert do
+0000f3c0: 672e 6e61 6d65 203d 3d20 2746 6964 6f27  g.name == 'Fido'
+0000f3d0: 0a61 7373 6572 7420 646f 672e 7472 6963  .assert dog.tric
+0000f3e0: 6b73 203d 3d20 5b27 726f 6c6c 206f 7665  ks == ['roll ove
+0000f3f0: 7227 2c20 2766 6574 6368 2062 616c 6c27  r', 'fetch ball'
+0000f400: 5d0a 6173 7365 7274 2064 6f67 2e76 6572  ].assert dog.ver
+0000f410: 7369 6f6e 203d 3d20 320a 6173 7365 7274  sion == 2.assert
+0000f420: 2064 6f67 2e69 735f 6672 6f6d 5f73 6e61   dog.is_from_sna
+0000f430: 7073 686f 7420 6973 2046 616c 7365 0a60  pshot is False.`
+0000f440: 6060 0a0a 5765 2063 616e 2063 616c 6c20  ``..We can call 
+0000f450: 6073 6e61 7073 686f 745f 646f 6728 2960  `snapshot_dog()`
+0000f460: 2074 6f20 7265 636f 7264 2061 2073 6e61   to record a sna
+0000f470: 7073 686f 7420 6f66 2074 6865 2063 7572  pshot of the cur
+0000f480: 7265 6e74 2073 7461 7465 206f 6620 7468  rent state of th
+0000f490: 6520 6044 6f67 600a 6167 6772 6567 6174  e `Dog`.aggregat
+0000f4a0: 652e 2041 6674 6572 2077 6520 6361 6c6c  e. After we call
+0000f4b0: 2060 736e 6170 7368 6f74 5f64 6f67 2829   `snapshot_dog()
+0000f4c0: 602c 2074 6865 2060 6765 745f 646f 6728  `, the `get_dog(
+0000f4d0: 2960 2066 756e 6374 696f 6e20 7769 6c6c  )` function will
+0000f4e0: 2072 6574 7572 6e20 6120 6044 6f67 600a   return a `Dog`.
+0000f4f0: 6f62 6a65 6374 2074 6861 7420 6861 7320  object that has 
+0000f500: 6265 656e 2063 6f6e 7374 7275 6374 6564  been constructed
+0000f510: 2075 7369 6e67 2074 6865 2060 536e 6170   using the `Snap
+0000f520: 7368 6f74 6020 6576 656e 742e 0a0a 6060  shot` event...``
+0000f530: 6070 7974 686f 6e0a 2320 536e 6170 7368  `python.# Snapsh
+0000f540: 6f74 2027 4669 646f 272e 0a73 6e61 7073  ot 'Fido'..snaps
+0000f550: 686f 745f 646f 6728 646f 675f 6964 290a  hot_dog(dog_id).
+0000f560: 0a64 6f67 203d 2067 6574 5f64 6f67 2864  .dog = get_dog(d
+0000f570: 6f67 5f69 6429 0a61 7373 6572 7420 646f  og_id).assert do
+0000f580: 672e 6e61 6d65 203d 3d20 2746 6964 6f27  g.name == 'Fido'
+0000f590: 0a61 7373 6572 7420 646f 672e 7472 6963  .assert dog.tric
+0000f5a0: 6b73 203d 3d20 5b27 726f 6c6c 206f 7665  ks == ['roll ove
+0000f5b0: 7227 2c20 2766 6574 6368 2062 616c 6c27  r', 'fetch ball'
+0000f5c0: 5d0a 6173 7365 7274 2064 6f67 2e76 6572  ].assert dog.ver
+0000f5d0: 7369 6f6e 203d 3d20 320a 6173 7365 7274  sion == 2.assert
+0000f5e0: 2064 6f67 2e69 735f 6672 6f6d 5f73 6e61   dog.is_from_sna
+0000f5f0: 7073 686f 7420 6973 2054 7275 650a 6060  pshot is True.``
+0000f600: 600a 0a57 6520 6361 6e20 636f 6e74 696e  `..We can contin
+0000f610: 7565 2074 6f20 6576 6f6c 7665 2074 6865  ue to evolve the
+0000f620: 2073 7461 7465 206f 6620 7468 6520 6044   state of the `D
+0000f630: 6f67 6020 6167 6772 6567 6174 652c 2075  og` aggregate, u
+0000f640: 7369 6e67 0a74 6865 2073 6e61 7073 686f  sing.the snapsho
+0000f650: 7420 626f 7468 2064 7572 696e 6720 7468  t both during th
+0000f660: 6520 6361 6c6c 2074 6f20 6072 6563 6f72  e call to `recor
+0000f670: 645f 7472 6963 6b5f 6c65 6172 6e65 6428  d_trick_learned(
+0000f680: 2960 2061 6e64 0a77 6865 6e20 6361 6c6c  )` and.when call
+0000f690: 696e 6720 6067 6574 5f64 6f67 2829 6020  ing `get_dog()` 
+0000f6a0: 6469 7265 6374 6c79 2e0a 0a60 6060 7079  directly...```py
+0000f6b0: 7468 6f6e 0a72 6563 6f72 645f 7472 6963  thon.record_tric
+0000f6c0: 6b5f 6c65 6172 6e65 6428 646f 675f 6964  k_learned(dog_id
+0000f6d0: 2c20 7472 6963 6b3d 2773 6974 2729 0a0a  , trick='sit')..
+0000f6e0: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+0000f6f0: 675f 6964 290a 6173 7365 7274 2064 6f67  g_id).assert dog
+0000f700: 2e6e 616d 6520 3d3d 2027 4669 646f 270a  .name == 'Fido'.
+0000f710: 6173 7365 7274 2064 6f67 2e74 7269 636b  assert dog.trick
+0000f720: 7320 3d3d 205b 2772 6f6c 6c20 6f76 6572  s == ['roll over
+0000f730: 272c 2027 6665 7463 6820 6261 6c6c 272c  ', 'fetch ball',
+0000f740: 2027 7369 7427 5d0a 6173 7365 7274 2064   'sit'].assert d
+0000f750: 6f67 2e76 6572 7369 6f6e 203d 3d20 330a  og.version == 3.
+0000f760: 6173 7365 7274 2064 6f67 2e69 735f 6672  assert dog.is_fr
+0000f770: 6f6d 5f73 6e61 7073 686f 7420 6973 2054  om_snapshot is T
+0000f780: 7275 650a 6060 600a 0a57 6520 6361 6e20  rue.```..We can 
+0000f790: 7365 6520 6672 6f6d 2074 6865 2060 6973  see from the `is
+0000f7a0: 5f66 726f 6d5f 736e 6170 7368 6f74 6020  _from_snapshot` 
+0000f7b0: 6174 7472 6962 7574 6520 7468 6174 2074  attribute that t
+0000f7c0: 6865 2060 446f 6760 206f 626a 6563 7420  he `Dog` object 
+0000f7d0: 7761 7320 696e 6465 6564 0a72 6563 6f6e  was indeed.recon
+0000f7e0: 7374 7275 6374 6564 2066 726f 6d20 7468  structed from th
+0000f7f0: 6520 736e 6170 7368 6f74 2e0a 0a53 6e61  e snapshot...Sna
+0000f800: 7073 686f 7473 2063 616e 2062 6520 6372  pshots can be cr
+0000f810: 6561 7465 6420 6174 2066 6978 6564 2076  eated at fixed v
+0000f820: 6572 7369 6f6e 206e 756d 6265 7220 696e  ersion number in
+0000f830: 7465 7276 616c 732c 2066 6978 6564 2074  tervals, fixed t
+0000f840: 696d 650a 7065 7269 6f64 732c 2061 6674  ime.periods, aft
+0000f850: 6572 2061 2070 6172 7469 6375 6c61 7220  er a particular 
+0000f860: 7479 7065 206f 6620 6576 656e 742c 2069  type of event, i
+0000f870: 6d6d 6564 6961 7465 6c79 2061 6674 6572  mmediately after
+0000f880: 2065 7665 6e74 7320 6172 650a 6170 7065   events are.appe
+0000f890: 6e64 6564 2c20 6f72 2061 7320 6120 6261  nded, or as a ba
+0000f8a0: 636b 6772 6f75 6e64 2070 726f 6365 7373  ckground process
+0000f8b0: 2e0a 0a0a 2323 2320 5265 6164 2061 6c6c  ....### Read all
+0000f8c0: 2065 7665 6e74 733c 6120 6964 3d22 7265   events<a id="re
+0000f8d0: 6164 2d61 6c6c 2d65 7665 6e74 7322 3e3c  ad-all-events"><
+0000f8e0: 2f61 3e0a 0a54 6865 2060 7265 6164 5f61  /a>..The `read_a
+0000f8f0: 6c6c 2829 6020 6d65 7468 6f64 2063 616e  ll()` method can
+0000f900: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
+0000f910: 616c 6c20 7265 636f 7264 6564 2065 7665  all recorded eve
+0000f920: 6e74 730a 696e 2074 6865 2064 6174 6162  nts.in the datab
+0000f930: 6173 6520 696e 2074 6865 206f 7264 6572  ase in the order
+0000f940: 2074 6865 7920 7765 7265 2072 6563 6f72   they were recor
+0000f950: 6465 642e 2054 6869 7320 6d65 7468 6f64  ded. This method
+0000f960: 2072 6574 7572 6e73 0a61 2022 7265 6164   returns.a "read
+0000f970: 2072 6573 706f 6e73 6522 206f 626a 6563   response" objec
+0000f980: 742c 206a 7573 7420 6c69 6b65 2060 7265  t, just like `re
+0000f990: 6164 5f73 7472 6561 6d28 2960 2e0a 0a41  ad_stream()`...A
+0000f9a0: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+0000f9b0: 2069 7320 616e 2069 7465 7261 746f 722c   is an iterator,
+0000f9c0: 2061 6e64 206e 6f74 2061 2073 6571 7565   and not a seque
+0000f9d0: 6e63 652e 2052 6563 6f72 6465 6420 6576  nce. Recorded ev
+0000f9e0: 656e 7473 2063 616e 2062 650a 6f62 7461  ents can be.obta
+0000f9f0: 696e 6564 2062 7920 6974 6572 6174 696e  ined by iteratin
+0000fa00: 6720 6f76 6572 2074 6865 2022 7265 6164  g over the "read
+0000fa10: 2072 6573 706f 6e73 6522 206f 626a 6563   response" objec
+0000fa20: 742e 2052 6563 6f72 6465 6420 6576 656e  t. Recorded even
+0000fa30: 7473 2061 7265 0a73 7472 6561 6d65 6420  ts are.streamed 
+0000fa40: 6672 6f6d 2074 6865 2073 6572 7665 7220  from the server 
+0000fa50: 746f 2074 6865 2063 6c69 656e 7420 6173  to the client as
+0000fa60: 2074 6865 2069 7465 7261 7469 6f6e 2070   the iteration p
+0000fa70: 726f 6365 6564 732e 2054 6865 2069 7465  roceeds. The ite
+0000fa80: 7261 7469 6f6e 0a77 696c 6c20 6175 746f  ration.will auto
+0000fa90: 6d61 7469 6361 6c6c 7920 7374 6f70 2077  matically stop w
+0000faa0: 6865 6e20 7468 6572 6520 6172 6520 6e6f  hen there are no
+0000fab0: 206d 6f72 6520 7265 636f 7264 6564 2065   more recorded e
+0000fac0: 7665 6e74 7320 746f 2062 6520 7265 7475  vents to be retu
+0000fad0: 726e 6564 2e0a 5468 6520 7374 7265 616d  rned..The stream
+0000fae0: 696e 6720 6f66 2065 7665 6e74 732c 2061  ing of events, a
+0000faf0: 6e64 2068 656e 6365 2074 6865 2069 7465  nd hence the ite
+0000fb00: 7261 746f 722c 2063 616e 2061 6c73 6f20  rator, can also 
+0000fb10: 6265 2073 746f 7070 6564 2062 7920 6361  be stopped by ca
+0000fb20: 6c6c 696e 670a 7468 6520 6073 746f 7028  lling.the `stop(
+0000fb30: 2960 206d 6574 686f 6420 6f6e 2074 6865  )` method on the
+0000fb40: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+0000fb50: 206f 626a 6563 742e 2054 6865 2072 6563   object. The rec
+0000fb60: 6f72 6465 6420 6576 656e 7420 6f62 6a65  orded event obje
+0000fb70: 6374 730a 6172 6520 696e 7374 616e 6365  cts.are instance
+0000fb80: 7320 6f66 2074 6865 2060 5265 636f 7264  s of the `Record
+0000fb90: 6564 4576 656e 7460 2063 6c61 7373 2e0a  edEvent` class..
+0000fba0: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+0000fbb0: 206e 696e 6520 6f70 7469 6f6e 616c 2061   nine optional a
+0000fbc0: 7267 756d 656e 7473 2c20 6063 6f6d 6d69  rguments, `commi
+0000fbd0: 745f 706f 7369 7469 6f6e 602c 2060 6261  t_position`, `ba
+0000fbe0: 636b 7761 7264 7360 2c20 6072 6573 6f6c  ckwards`, `resol
+0000fbf0: 7665 5f6c 696e 6b73 602c 0a60 6669 6c74  ve_links`,.`filt
+0000fc00: 6572 5f65 7863 6c75 6465 602c 2060 6669  er_exclude`, `fi
+0000fc10: 6c74 6572 5f69 6e63 6c75 6465 602c 2060  lter_include`, `
+0000fc20: 6669 6c74 6572 5f62 795f 7374 7265 616d  filter_by_stream
+0000fc30: 5f6e 616d 6560 2c20 606c 696d 6974 602c  _name`, `limit`,
+0000fc40: 2060 7469 6d65 6f75 7460 2c0a 616e 6420   `timeout`,.and 
+0000fc50: 6063 7265 6465 6e74 6961 6c73 602e 0a0a  `credentials`...
+0000fc60: 5468 6520 6f70 7469 6f6e 616c 2060 636f  The optional `co
+0000fc70: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
+0000fc80: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0000fc90: 686f 6e20 6069 6e74 6020 7468 6174 2063  hon `int` that c
+0000fca0: 616e 2062 6520 7573 6564 2074 6f0a 7370  an be used to.sp
+0000fcb0: 6563 6966 7920 6120 636f 6d6d 6974 2070  ecify a commit p
+0000fcc0: 6f73 6974 696f 6e20 6672 6f6d 2077 6869  osition from whi
+0000fcd0: 6368 2074 6f20 7374 6172 7420 7265 6164  ch to start read
+0000fce0: 696e 672e 2054 6865 2064 6566 6175 6c74  ing. The default
+0000fcf0: 2076 616c 7565 206f 660a 6063 6f6d 6d69   value of.`commi
+0000fd00: 745f 706f 7369 7469 6f6e 6020 6973 2060  t_position` is `
+0000fd10: 4e6f 6e65 602e 2050 6c65 6173 6520 6e6f  None`. Please no
+0000fd20: 7465 2c20 6966 2061 2063 6f6d 6d69 7420  te, if a commit 
+0000fd30: 706f 7369 7469 6f6e 2069 7320 7370 6563  position is spec
+0000fd40: 6966 6965 642c 0a69 7420 6d75 7374 2062  ified,.it must b
+0000fd50: 6520 616e 2061 6374 7561 6c6c 7920 6578  e an actually ex
+0000fd60: 6973 7469 6e67 2063 6f6d 6d69 7420 706f  isting commit po
+0000fd70: 7369 7469 6f6e 2069 6e20 7468 6520 6461  sition in the da
+0000fd80: 7461 6261 7365 2e20 5768 656e 2072 6561  tabase. When rea
+0000fd90: 6469 6e67 0a66 6f72 7761 7264 732c 2074  ding.forwards, t
+0000fda0: 6865 2065 7665 6e74 2061 7420 7468 6520  he event at the 
+0000fdb0: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+0000fdc0: 6d61 7920 6265 2069 6e63 6c75 6465 642c  may be included,
+0000fdd0: 2064 6570 656e 6469 6e67 2075 706f 6e20   depending upon 
+0000fde0: 7468 650a 6669 6c74 6572 2e20 5768 656e  the.filter. When
+0000fdf0: 2072 6561 6469 6e67 2062 6163 6b77 6172   reading backwar
+0000fe00: 6473 2c20 7468 6520 6576 656e 7420 6174  ds, the event at
+0000fe10: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+0000fe20: 7469 6f6e 2077 696c 6c20 6e6f 7420 6265  tion will not be
+0000fe30: 0a69 6e63 6c75 6465 642e 0a0a 5468 6520  .included...The 
+0000fe40: 6f70 7469 6f6e 616c 2060 6261 636b 7761  optional `backwa
+0000fe50: 7264 7360 2061 7267 756d 656e 7420 6973  rds` argument is
+0000fe60: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+0000fe70: 2e20 5468 6520 6465 6661 756c 7420 6f66  . The default of
+0000fe80: 2060 6261 636b 7761 7264 7360 2069 730a   `backwards` is.
+0000fe90: 6046 616c 7365 602c 2077 6869 6368 206d  `False`, which m
+0000fea0: 6561 6e73 2065 7665 6e74 7320 6172 6520  eans events are 
+0000feb0: 7265 7475 726e 6564 2069 6e20 7468 6520  returned in the 
+0000fec0: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
+0000fed0: 7265 636f 7264 6564 2c20 4966 0a60 6261  recorded, If.`ba
+0000fee0: 636b 7761 7264 7360 2069 7320 6054 7275  ckwards` is `Tru
+0000fef0: 6560 2c20 7468 656e 2065 7665 6e74 7320  e`, then events 
+0000ff00: 6172 6520 7265 7475 726e 6564 2069 6e20  are returned in 
+0000ff10: 7265 7665 7273 6520 6f72 6465 722e 0a0a  reverse order...
+0000ff20: 4966 2060 6261 636b 7761 7264 7360 2069  If `backwards` i
+0000ff30: 7320 6046 616c 7365 6020 616e 6420 6063  s `False` and `c
+0000ff40: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
+0000ff50: 6973 2060 4e6f 6e65 602c 2074 6865 2064  is `None`, the d
+0000ff60: 6174 6162 6173 6527 7320 6576 656e 7473  atabase's events
+0000ff70: 2077 696c 6c0a 6265 2072 6574 7572 6e65   will.be returne
+0000ff80: 6420 696e 2074 6865 206f 7264 6572 2074  d in the order t
+0000ff90: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
+0000ffa0: 642c 2073 7461 7274 696e 6720 6672 6f6d  d, starting from
+0000ffb0: 2074 6865 2066 6972 7374 2072 6563 6f72   the first recor
+0000ffc0: 6465 6420 6576 656e 742e 0a54 6869 7320  ded event..This 
+0000ffd0: 6973 2074 6865 2064 6566 6175 6c74 2062  is the default b
+0000ffe0: 6568 6176 696f 7220 6f66 2060 7265 6164  ehavior of `read
+0000fff0: 5f61 6c6c 2829 602e 2049 6620 6062 6163  _all()`. If `bac
+00010000: 6b77 6172 6473 6020 6973 2060 5472 7565  kwards` is `True
+00010010: 6020 616e 640a 6063 6f6d 6d69 745f 706f  ` and.`commit_po
+00010020: 7369 7469 6f6e 6020 6973 2060 4e6f 6e65  sition` is `None
+00010030: 602c 2074 6865 2064 6174 6162 6173 6527  `, the database'
+00010040: 7320 6576 656e 7473 2077 696c 6c20 6265  s events will be
+00010050: 2072 6574 7572 6e65 6420 696e 2072 6576   returned in rev
+00010060: 6572 7365 206f 7264 6572 2c0a 7374 6172  erse order,.star
+00010070: 7469 6e67 2066 726f 6d20 7468 6520 6c61  ting from the la
+00010080: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
+00010090: 742e 0a0a 5468 6520 6f70 7469 6f6e 616c  t...The optional
+000100a0: 2060 7265 736f 6c76 655f 6c69 6e6b 7360   `resolve_links`
+000100b0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+000100c0: 7974 686f 6e20 6062 6f6f 6c60 2e20 5468  ython `bool`. Th
+000100d0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+000100e0: 6f66 2060 7265 736f 6c76 655f 6c69 6e6b  of `resolve_link
+000100f0: 7360 0a69 7320 6046 616c 7365 602c 2077  s`.is `False`, w
+00010100: 6869 6368 206d 6561 6e73 2061 6e79 2065  hich means any e
+00010110: 7665 6e74 206c 696e 6b73 2077 696c 6c20  vent links will 
+00010120: 6e6f 7420 6265 2072 6573 6f6c 7665 642c  not be resolved,
+00010130: 2073 6f20 7468 6174 2074 6865 2065 7665   so that the eve
+00010140: 6e74 7320 7468 6174 2061 7265 0a72 6574  nts that are.ret
+00010150: 7572 6e65 6420 6d61 7920 7265 7072 6573  urned may repres
+00010160: 656e 7420 6576 656e 7420 6c69 6e6b 732e  ent event links.
+00010170: 2049 6620 6072 6573 6f6c 7665 5f6c 696e   If `resolve_lin
+00010180: 6b73 6020 6973 2060 5472 7565 602c 2061  ks` is `True`, a
+00010190: 6e79 2065 7665 6e74 206c 696e 6b73 2077  ny event links w
+000101a0: 696c 6c0a 6265 2072 6573 6f6c 7665 642c  ill.be resolved,
+000101b0: 2073 6f20 7468 6174 2074 6865 206c 696e   so that the lin
+000101c0: 6b65 6420 6576 656e 7473 2077 696c 6c20  ked events will 
+000101d0: 6265 2072 6574 7572 6e65 6420 696e 7374  be returned inst
+000101e0: 6561 6420 6f66 2074 6865 2065 7665 6e74  ead of the event
+000101f0: 206c 696e 6b73 2e0a 0a54 6865 206f 7074   links...The opt
+00010200: 696f 6e61 6c20 6066 696c 7465 725f 6578  ional `filter_ex
+00010210: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
+00010220: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
+00010230: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
+00010240: 696f 6e73 2074 6861 740a 7370 6563 6966  ions that.specif
+00010250: 6965 7320 7768 6963 6820 7265 636f 7264  ies which record
+00010260: 6564 2065 7665 6e74 7320 7368 6f75 6c64  ed events should
+00010270: 2062 6520 7265 7475 726e 6564 2e20 5468   be returned. Th
+00010280: 6973 2061 7267 756d 656e 7420 6973 2069  is argument is i
+00010290: 676e 6f72 6564 0a69 6620 6066 696c 7465  gnored.if `filte
+000102a0: 725f 696e 636c 7564 6560 2069 7320 7365  r_include` is se
+000102b0: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
+000102c0: 2073 6571 7565 6e63 652e 2054 6865 2064   sequence. The d
+000102d0: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+000102e0: 7468 6973 0a61 7267 756d 656e 7420 6d61  this.argument ma
+000102f0: 7463 6865 7320 7468 6520 6576 656e 7420  tches the event 
+00010300: 7479 7065 7320 6f66 2045 7665 6e74 5374  types of EventSt
+00010310: 6f72 6544 4220 2273 7973 7465 6d20 6576  oreDB "system ev
+00010320: 656e 7473 222c 2073 6f20 7468 6174 2073  ents", so that s
+00010330: 7973 7465 6d0a 6576 656e 7473 2077 696c  ystem.events wil
+00010340: 6c20 6e6f 7420 6e6f 726d 616c 6c79 2062  l not normally b
+00010350: 6520 696e 636c 7564 6564 2e20 5365 6520  e included. See 
+00010360: 7468 6520 4e6f 7465 7320 7365 6374 696f  the Notes sectio
+00010370: 6e20 6265 6c6f 7720 666f 7220 6d6f 7265  n below for more
+00010380: 0a69 6e66 6f72 6d61 7469 6f6e 2061 626f  .information abo
+00010390: 7574 2066 696c 7465 7220 6578 7072 6573  ut filter expres
+000103a0: 7369 6f6e 732e 0a0a 5468 6520 6f70 7469  sions...The opti
+000103b0: 6f6e 616c 2060 6669 6c74 6572 5f69 6e63  onal `filter_inc
+000103c0: 6c75 6465 6020 6172 6775 6d65 6e74 2069  lude` argument i
+000103d0: 7320 6120 7365 7175 656e 6365 206f 6620  s a sequence of 
+000103e0: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
+000103f0: 6f6e 730a 7468 6174 2073 7065 6369 6669  ons.that specifi
+00010400: 6573 2077 6869 6368 2072 6563 6f72 6465  es which recorde
+00010410: 6420 6576 656e 7473 2073 686f 756c 6420  d events should 
+00010420: 6265 2072 6574 7572 6e65 642e 2042 7920  be returned. By 
+00010430: 6465 6661 756c 742c 2074 6869 730a 6172  default, this.ar
+00010440: 6775 6d65 6e74 2069 7320 616e 2065 6d70  gument is an emp
+00010450: 7479 2074 7570 6c65 2e20 4966 2074 6869  ty tuple. If thi
+00010460: 7320 6172 6775 6d65 6e74 2069 7320 7365  s argument is se
+00010470: 7420 746f 2061 206e 6f6e 2d65 6d70 7479  t to a non-empty
+00010480: 2073 6571 7565 6e63 652c 0a74 6865 2060   sequence,.the `
+00010490: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
+000104a0: 6172 6775 6d65 6e74 2069 7320 6967 6e6f  argument is igno
+000104b0: 7265 642e 0a0a 5468 6520 6f70 7469 6f6e  red...The option
+000104c0: 616c 2060 6669 6c74 6572 5f62 795f 7374  al `filter_by_st
+000104d0: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+000104e0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+000104f0: 6062 6f6f 6c60 2074 6861 7420 696e 6469  `bool` that indi
+00010500: 6361 7465 730a 7768 6574 6865 7220 7468  cates.whether th
+00010510: 6520 6669 6c74 6572 696e 6720 7769 6c6c  e filtering will
+00010520: 2061 7070 6c79 2074 6f20 6576 656e 7420   apply to event 
+00010530: 7479 7065 7320 6f72 2073 7472 6561 6d20  types or stream 
+00010540: 6e61 6d65 732e 2042 7920 6465 6661 756c  names. By defaul
+00010550: 742c 2074 6869 730a 7661 6c75 6520 6973  t, this.value is
+00010560: 2060 4661 6c73 6560 2061 6e64 2073 6f20   `False` and so 
+00010570: 7468 6520 6669 6c74 6572 696e 6720 7769  the filtering wi
+00010580: 6c6c 2061 7070 6c79 2074 6f20 7468 6520  ll apply to the 
+00010590: 6576 656e 7420 7479 7065 2073 7472 696e  event type strin
+000105a0: 6773 206f 660a 7265 636f 7264 6564 2065  gs of.recorded e
+000105b0: 7665 6e74 732e 0a0a 5468 6520 6f70 7469  vents...The opti
+000105c0: 6f6e 616c 2060 6c69 6d69 7460 2061 7267  onal `limit` arg
+000105d0: 756d 656e 7420 6973 2061 6e20 696e 7465  ument is an inte
+000105e0: 6765 7220 7768 6963 6820 7265 7374 7269  ger which restri
+000105f0: 6374 7320 7468 6520 6e75 6d62 6572 206f  cts the number o
+00010600: 6620 6576 656e 7473 2074 6861 740a 7769  f events that.wi
+00010610: 6c6c 2062 6520 7265 7475 726e 6564 2e20  ll be returned. 
+00010620: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+00010630: 6520 6973 2060 7379 732e 6d61 7869 6e74  e is `sys.maxint
+00010640: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
+00010650: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
+00010660: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+00010670: 6066 6c6f 6174 6020 7768 6963 6820 7365  `float` which se
+00010680: 7473 2061 0a6d 6178 696d 756d 2064 7572  ts a.maximum dur
+00010690: 6174 696f 6e2c 2069 6e20 7365 636f 6e64  ation, in second
+000106a0: 732c 2066 6f72 2074 6865 2063 6f6d 706c  s, for the compl
+000106b0: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+000106c0: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+000106d0: 6520 6f70 7469 6f6e 616c 2060 6372 6564  e optional `cred
+000106e0: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
+000106f0: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+00010700: 0a6f 7665 7272 6964 6520 6361 6c6c 2063  .override call c
+00010710: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
+00010720: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
+00010730: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
+00010740: 492e 0a0a 5468 6520 6669 6c74 6572 696e  I...The filterin
+00010750: 6720 6f66 2065 7665 6e74 7320 6973 2064  g of events is d
+00010760: 6f6e 6520 6f6e 2074 6865 2045 7665 6e74  one on the Event
+00010770: 5374 6f72 6544 4220 7365 7276 6572 2e20  StoreDB server. 
+00010780: 5468 650a 606c 696d 6974 6020 6172 6775  The.`limit` argu
+00010790: 6d65 6e74 2069 7320 6170 706c 6965 6420  ment is applied 
+000107a0: 6f6e 2074 6865 2073 6572 7665 7220 6166  on the server af
+000107b0: 7465 7220 6669 6c74 6572 696e 672e 0a0a  ter filtering...
+000107c0: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+000107d0: 7720 7368 6f77 7320 686f 7720 746f 2067  w shows how to g
+000107e0: 6574 2061 6c6c 2074 6865 2065 7665 6e74  et all the event
+000107f0: 7320 7765 2068 6176 6520 7265 636f 7264  s we have record
+00010800: 6564 2069 6e20 7468 6520 6461 7461 6261  ed in the databa
+00010810: 7365 0a73 6f20 6661 722c 2069 6e20 7468  se.so far, in th
+00010820: 6520 6f72 6465 7220 7468 6579 2077 6572  e order they wer
+00010830: 6520 7265 636f 7264 6564 2e20 5765 2063  e recorded. We c
+00010840: 616e 2073 6565 2074 6865 2074 6872 6565  an see the three
+00010850: 2065 7665 6e74 7320 6f66 2060 7374 7265   events of `stre
+00010860: 616d 5f6e 616d 6531 600a 2860 6576 656e  am_name1`.(`even
+00010870: 7431 602c 2060 6576 656e 7432 6020 616e  t1`, `event2` an
+00010880: 6420 6065 7665 6e74 3360 2920 6172 6520  d `event3`) are 
+00010890: 696e 636c 7564 6564 2c20 616c 6f6e 6720  included, along 
+000108a0: 7769 7468 206f 7468 6572 732e 0a0a 6060  with others...``
+000108b0: 6070 7974 686f 6e0a 2320 5265 6164 2061  `python.# Read a
+000108c0: 6c6c 2065 7665 6e74 7320 2863 7265 6174  ll events (creat
+000108d0: 6573 2061 2073 7472 6561 6d69 6e67 2067  es a streaming g
+000108e0: 5250 4320 6361 6c6c 292e 0a72 6561 645f  RPC call)..read_
+000108f0: 7265 7370 6f6e 7365 203d 2063 6c69 656e  response = clien
+00010900: 742e 7265 6164 5f61 6c6c 2829 0a0a 2320  t.read_all()..# 
+00010910: 436f 6e76 6572 7420 7468 6520 6974 6572  Convert the iter
+00010920: 6174 6f72 2069 6e74 6f20 6120 7365 7175  ator into a sequ
+00010930: 656e 6365 206f 6620 7265 636f 7264 6564  ence of recorded
+00010940: 2065 7665 6e74 732e 0a65 7665 6e74 7320   events..events 
+00010950: 3d20 7475 706c 6528 7265 6164 5f72 6573  = tuple(read_res
+00010960: 706f 6e73 6529 0a61 7373 6572 7420 6c65  ponse).assert le
+00010970: 6e28 6576 656e 7473 2920 3e20 3320 2023  n(events) > 3  #
+00010980: 206d 6f72 6520 7468 616e 2074 6872 6565   more than three
+00010990: 0a0a 2320 436f 6e76 6572 7420 7468 6520  ..# Convert the 
+000109a0: 7365 7175 656e 6365 206f 6620 7265 636f  sequence of reco
+000109b0: 7264 6564 2065 7665 6e74 7320 696e 746f  rded events into
+000109c0: 2061 2073 6574 206f 6620 6576 656e 7420   a set of event 
+000109d0: 4944 732e 0a65 7665 6e74 5f69 6473 203d  IDs..event_ids =
+000109e0: 2073 6574 2865 2e69 6420 666f 7220 6520   set(e.id for e 
+000109f0: 696e 2065 7665 6e74 7329 0a61 7373 6572  in events).asser
+00010a00: 7420 6576 656e 7431 2e69 6420 696e 2065  t event1.id in e
+00010a10: 7665 6e74 5f69 6473 0a61 7373 6572 7420  vent_ids.assert 
+00010a20: 6576 656e 7432 2e69 6420 696e 2065 7665  event2.id in eve
+00010a30: 6e74 5f69 6473 0a61 7373 6572 7420 6576  nt_ids.assert ev
+00010a40: 656e 7433 2e69 6420 696e 2065 7665 6e74  ent3.id in event
+00010a50: 5f69 6473 0a60 6060 0a0a 5468 6520 6578  _ids.```..The ex
+00010a60: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
+00010a70: 7320 686f 7720 746f 2072 6561 6420 616c  s how to read al
+00010a80: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
+00010a90: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
+00010aa0: 6520 6672 6f6d 0a61 2070 6172 7469 6375  e from.a particu
+00010ab0: 6c61 7220 636f 6d6d 6974 2070 6f73 6974  lar commit posit
+00010ac0: 696f 6e2c 2069 6e20 7468 6973 2063 6173  ion, in this cas
+00010ad0: 6520 6063 6f6d 6d69 745f 706f 7369 7469  e `commit_positi
+00010ae0: 6f6e 3160 2e20 5768 656e 2072 6561 6469  on1`. When readi
+00010af0: 6e67 0a66 6f72 7761 7264 7320 6672 6f6d  ng.forwards from
+00010b00: 2061 2073 7065 6369 6669 6320 636f 6d6d   a specific comm
+00010b10: 6974 2070 6f73 6974 696f 6e2c 2074 6865  it position, the
+00010b20: 2065 7665 6e74 2061 7420 7468 6520 7370   event at the sp
+00010b30: 6563 6966 6965 6420 706f 7369 7469 6f6e  ecified position
+00010b40: 0a77 696c 6c20 6265 2069 6e63 6c75 6465  .will be include
+00010b50: 642e 2054 6865 2076 616c 7565 206f 6620  d. The value of 
+00010b60: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00010b70: 3160 2069 7320 7468 6520 706f 7369 7469  1` is the positi
+00010b80: 6f6e 2077 6520 6f62 7461 696e 6564 0a77  on we obtained.w
+00010b90: 6865 6e20 6170 7065 6e64 696e 6720 6065  hen appending `e
+00010ba0: 7665 6e74 3160 2e20 416e 6420 736f 2060  vent1`. And so `
+00010bb0: 6576 656e 7431 6020 6973 2074 6865 2066  event1` is the f
+00010bc0: 6972 7374 2072 6563 6f72 6465 6420 6576  irst recorded ev
+00010bd0: 656e 7420 7765 2073 6861 6c6c 0a72 6563  ent we shall.rec
+00010be0: 6569 7665 2c20 6065 7665 6e74 3260 2069  eive, `event2` i
+00010bf0: 7320 7468 6520 7365 636f 6e64 2c20 616e  s the second, an
+00010c00: 6420 6065 7665 6e74 3360 2069 7320 7468  d `event3` is th
+00010c10: 6520 7468 6972 642e 0a0a 6060 6070 7974  e third...```pyt
+00010c20: 686f 6e0a 2320 5265 6164 2061 6c6c 2065  hon.# Read all e
+00010c30: 7665 6e74 7320 666f 7277 6172 6473 2066  vents forwards f
+00010c40: 726f 6d20 6120 636f 6d6d 6974 2070 6f73  rom a commit pos
+00010c50: 6974 696f 6e2e 0a72 6561 645f 7265 7370  ition..read_resp
+00010c60: 6f6e 7365 203d 2063 6c69 656e 742e 7265  onse = client.re
+00010c70: 6164 5f61 6c6c 280a 2020 2020 636f 6d6d  ad_all(.    comm
+00010c80: 6974 5f70 6f73 6974 696f 6e3d 636f 6d6d  it_position=comm
+00010c90: 6974 5f70 6f73 6974 696f 6e31 0a29 0a0a  it_position1.)..
+00010ca0: 2320 5374 6570 2074 6872 6f75 6768 2074  # Step through t
+00010cb0: 6865 2022 7265 6164 2072 6573 706f 6e73  he "read respons
+00010cc0: 6522 2069 7465 7261 746f 722e 0a61 7373  e" iterator..ass
+00010cd0: 6572 7420 6e65 7874 2872 6561 645f 7265  ert next(read_re
+00010ce0: 7370 6f6e 7365 2920 3d3d 2065 7665 6e74  sponse) == event
+00010cf0: 310a 6173 7365 7274 206e 6578 7428 7265  1.assert next(re
+00010d00: 6164 5f72 6573 706f 6e73 6529 203d 3d20  ad_response) == 
+00010d10: 6576 656e 7432 0a61 7373 6572 7420 6e65  event2.assert ne
+00010d20: 7874 2872 6561 645f 7265 7370 6f6e 7365  xt(read_response
+00010d30: 2920 3d3d 2065 7665 6e74 330a 0a23 2053  ) == event3..# S
+00010d40: 746f 7020 7468 6520 6974 6572 6174 6f72  top the iterator
+00010d50: 2e0a 7265 6164 5f72 6573 706f 6e73 652e  ..read_response.
+00010d60: 7374 6f70 2829 0a60 6060 0a0a 5468 6520  stop().```..The 
+00010d70: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
+00010d80: 6f77 7320 686f 7720 746f 2072 6561 6420  ows how to read 
+00010d90: 616c 6c20 6576 656e 7473 2072 6563 6f72  all events recor
+00010da0: 6465 6420 696e 2074 6865 2064 6174 6162  ded in the datab
+00010db0: 6173 6520 696e 2072 6576 6572 7365 0a6f  ase in reverse.o
+00010dc0: 7264 6572 2e20 5765 2063 616e 2073 6565  rder. We can see
+00010dd0: 2074 6861 7420 7468 6520 6669 7273 7420   that the first 
+00010de0: 6576 656e 7473 2077 6520 7265 6365 6976  events we receiv
+00010df0: 6520 6172 6520 7468 6520 6c61 7374 2065  e are the last e
+00010e00: 7665 6e74 7320 7468 6174 2077 6572 650a  vents that were.
+00010e10: 7265 636f 7264 6564 3a20 7468 6520 6576  recorded: the ev
+00010e20: 656e 7473 206f 6620 7468 6520 6044 6f67  ents of the `Dog
+00010e30: 6020 6167 6772 6567 6174 6520 6672 6f6d  ` aggregate from
+00010e40: 2074 6865 2073 6563 7469 6f6e 2061 626f   the section abo
+00010e50: 7574 2073 6e61 7073 686f 7474 696e 670a  ut snapshotting.
+00010e60: 616e 6420 7468 6520 736e 6170 7368 6f74  and the snapshot
+00010e70: 2e0a 0a60 6060 7079 7468 6f6e 0a23 2052  ...```python.# R
+00010e80: 6561 6420 616c 6c20 6576 656e 7473 2062  ead all events b
+00010e90: 6163 6b77 6172 6473 2066 726f 6d20 7468  ackwards from th
+00010ea0: 6520 656e 642e 0a72 6561 645f 7265 7370  e end..read_resp
+00010eb0: 6f6e 7365 203d 2063 6c69 656e 742e 7265  onse = client.re
+00010ec0: 6164 5f61 6c6c 280a 2020 2020 6261 636b  ad_all(.    back
+00010ed0: 7761 7264 733d 5472 7565 0a29 0a0a 2320  wards=True.)..# 
+00010ee0: 5374 6570 2074 6872 6f75 6768 2074 6865  Step through the
+00010ef0: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+00010f00: 2069 7465 7261 746f 722e 0a61 7373 6572   iterator..asser
+00010f10: 7420 6e65 7874 2872 6561 645f 7265 7370  t next(read_resp
+00010f20: 6f6e 7365 292e 7479 7065 203d 3d20 2244  onse).type == "D
+00010f30: 6f67 4c65 6172 6e65 6454 7269 636b 220a  ogLearnedTrick".
+00010f40: 6173 7365 7274 206e 6578 7428 7265 6164  assert next(read
+00010f50: 5f72 6573 706f 6e73 6529 2e74 7970 6520  _response).type 
+00010f60: 3d3d 2022 536e 6170 7368 6f74 220a 6173  == "Snapshot".as
+00010f70: 7365 7274 206e 6578 7428 7265 6164 5f72  sert next(read_r
+00010f80: 6573 706f 6e73 6529 2e74 7970 6520 3d3d  esponse).type ==
+00010f90: 2022 446f 674c 6561 726e 6564 5472 6963   "DogLearnedTric
+00010fa0: 6b22 0a61 7373 6572 7420 6e65 7874 2872  k".assert next(r
+00010fb0: 6561 645f 7265 7370 6f6e 7365 292e 7479  ead_response).ty
+00010fc0: 7065 203d 3d20 2244 6f67 4c65 6172 6e65  pe == "DogLearne
+00010fd0: 6454 7269 636b 220a 6173 7365 7274 206e  dTrick".assert n
+00010fe0: 6578 7428 7265 6164 5f72 6573 706f 6e73  ext(read_respons
+00010ff0: 6529 2e74 7970 6520 3d3d 2022 446f 6752  e).type == "DogR
+00011000: 6567 6973 7465 7265 6422 0a0a 2320 5374  egistered"..# St
+00011010: 6f70 2074 6865 2069 7465 7261 746f 722e  op the iterator.
+00011020: 0a72 6561 645f 7265 7370 6f6e 7365 2e73  .read_response.s
+00011030: 746f 7028 290a 6060 600a 0a54 6865 2065  top().```..The e
+00011040: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
+00011050: 7773 2068 6f77 2074 6f20 7265 6164 2061  ws how to read a
+00011060: 206c 696d 6974 6564 206e 756d 6265 7220   limited number 
+00011070: 6f66 2065 7665 6e74 730a 666f 7277 6172  of events.forwar
+00011080: 6473 2066 726f 6d20 6120 7370 6563 6966  ds from a specif
+00011090: 6963 2063 6f6d 6d69 7420 706f 7369 7469  ic commit positi
+000110a0: 6f6e 2e0a 0a60 6060 7079 7468 6f6e 0a65  on...```python.e
+000110b0: 7665 6e74 7320 3d20 7475 706c 6528 0a20  vents = tuple(. 
+000110c0: 2020 2063 6c69 656e 742e 7265 6164 5f61     client.read_a
+000110d0: 6c6c 280a 2020 2020 2020 2020 636f 6d6d  ll(.        comm
+000110e0: 6974 5f70 6f73 6974 696f 6e3d 636f 6d6d  it_position=comm
+000110f0: 6974 5f70 6f73 6974 696f 6e31 2c0a 2020  it_position1,.  
+00011100: 2020 2020 2020 6c69 6d69 743d 312c 0a20        limit=1,. 
+00011110: 2020 2029 0a29 0a0a 6173 7365 7274 206c     ).)..assert l
+00011120: 656e 2865 7665 6e74 7329 203d 3d20 310a  en(events) == 1.
+00011130: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
+00011140: 203d 3d20 6576 656e 7431 0a60 6060 0a0a   == event1.```..
+00011150: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+00011160: 7720 7368 6f77 7320 686f 7720 746f 2072  w shows how to r
+00011170: 6561 6420 6120 6c69 6d69 7465 6420 6e75  ead a limited nu
+00011180: 6d62 6572 206f 6620 7468 6520 7265 636f  mber of the reco
+00011190: 7264 6564 2065 7665 6e74 730a 696e 2074  rded events.in t
+000111a0: 6865 2064 6174 6162 6173 6520 6261 636b  he database back
+000111b0: 7761 7264 7320 6672 6f6d 2074 6865 2065  wards from the e
+000111c0: 6e64 2e20 496e 2074 6869 7320 6361 7365  nd. In this case
+000111d0: 2c20 7468 6520 6c69 6d69 7420 6973 2031  , the limit is 1
+000111e0: 2c20 616e 640a 736f 2077 6520 7265 6365  , and.so we rece
+000111f0: 6976 6520 7468 6520 6c61 7374 2072 6563  ive the last rec
+00011200: 6f72 6465 6420 6576 656e 742e 0a0a 6060  orded event...``
+00011210: 6070 7974 686f 6e0a 6576 656e 7473 203d  `python.events =
+00011220: 2074 7570 6c65 280a 2020 2020 636c 6965   tuple(.    clie
+00011230: 6e74 2e72 6561 645f 616c 6c28 0a20 2020  nt.read_all(.   
+00011240: 2020 2020 2062 6163 6b77 6172 6473 3d54       backwards=T
+00011250: 7275 652c 0a20 2020 2020 2020 206c 696d  rue,.        lim
+00011260: 6974 3d31 2c0a 2020 2020 290a 290a 0a61  it=1,.    ).)..a
+00011270: 7373 6572 7420 6c65 6e28 6576 656e 7473  ssert len(events
+00011280: 2920 3d3d 2031 0a0a 6173 7365 7274 2065  ) == 1..assert e
+00011290: 7665 6e74 735b 305d 2e74 7970 6520 3d3d  vents[0].type ==
+000112a0: 2027 446f 674c 6561 726e 6564 5472 6963   'DogLearnedTric
+000112b0: 6b27 0a61 7373 6572 7420 6465 7365 7269  k'.assert deseri
+000112c0: 616c 697a 6528 6576 656e 7473 5b30 5d2e  alize(events[0].
+000112d0: 6461 7461 295b 2774 7269 636b 275d 203d  data)['trick'] =
+000112e0: 3d20 2773 6974 270a 6060 600a 0a50 6c65  = 'sit'.```..Ple
+000112f0: 6173 6520 6e6f 7465 2c20 6c69 6b65 2074  ase note, like t
+00011300: 6865 2060 7265 6164 5f73 7472 6561 6d28  he `read_stream(
+00011310: 2960 206d 6574 686f 642c 2074 6865 2060  )` method, the `
+00011320: 7265 6164 5f61 6c6c 2829 6020 6d65 7468  read_all()` meth
+00011330: 6f64 0a69 7320 6e6f 7420 6465 636f 7261  od.is not decora
+00011340: 7465 6420 7769 7468 2072 6574 7279 2061  ted with retry a
+00011350: 6e64 2072 6563 6f6e 6e65 6374 2064 6563  nd reconnect dec
+00011360: 6f72 6174 6f72 732c 2062 6563 6175 7365  orators, because
+00011370: 2074 6865 2073 7472 6561 6d69 6e67 206f   the streaming o
+00011380: 6620 7265 636f 7264 6564 0a65 7665 6e74  f recorded.event
+00011390: 7320 6672 6f6d 2074 6865 2073 6572 7665  s from the serve
+000113a0: 7220 6f6e 6c79 2073 7461 7274 7320 7768  r only starts wh
+000113b0: 656e 2069 7465 7261 7469 6e67 206f 7665  en iterating ove
+000113c0: 7220 7468 6520 2272 6561 6420 7265 7370  r the "read resp
+000113d0: 6f6e 7365 2220 7374 6172 7473 2c20 7768  onse" starts, wh
+000113e0: 6963 680a 6d65 616e 7320 7468 6174 2074  ich.means that t
+000113f0: 6865 206d 6574 686f 6420 7265 7475 726e  he method return
+00011400: 7320 6265 666f 7265 2074 6865 2073 7472  s before the str
+00011410: 6561 6d69 6e67 2073 7461 7274 732c 2061  eaming starts, a
+00011420: 6e64 2073 6f20 7468 6572 6520 6973 206e  nd so there is n
+00011430: 6f20 6368 616e 6365 2066 6f72 0a61 6e79  o chance for.any
+00011440: 2064 6563 6f72 6174 6f72 7320 746f 2063   decorators to c
+00011450: 6174 6368 2061 6e79 2063 6f6e 6e65 6374  atch any connect
+00011460: 696f 6e20 6973 7375 6573 2e0a 0a23 2323  ion issues...###
+00011470: 2047 6574 2063 6f6d 6d69 7420 706f 7369   Get commit posi
+00011480: 7469 6f6e 3c61 2069 643d 2267 6574 2d63  tion<a id="get-c
+00011490: 6f6d 6d69 742d 706f 7369 7469 6f6e 223e  ommit-position">
+000114a0: 3c2f 613e 0a0a 5468 6520 6067 6574 5f63  </a>..The `get_c
+000114b0: 6f6d 6d69 745f 706f 7369 7469 6f6e 2829  ommit_position()
+000114c0: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
+000114d0: 7573 6564 2074 6f20 6765 7420 7468 6520  used to get the 
+000114e0: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+000114f0: 6f66 2074 6865 0a6c 6173 7420 7265 636f  of the.last reco
+00011500: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
+00011510: 6520 6461 7461 6261 7365 2e20 4974 2073  e database. It s
+00011520: 696d 706c 7920 6361 6c6c 7320 6072 6561  imply calls `rea
+00011530: 645f 616c 6c28 2960 2077 6974 680a 6062  d_all()` with.`b
+00011540: 6163 6b77 6172 6473 3d54 7275 6560 2061  ackwards=True` a
+00011550: 6e64 2060 6c69 6d69 743d 3160 2c20 616e  nd `limit=1`, an
+00011560: 6420 7265 7475 726e 7320 7468 6520 7661  d returns the va
+00011570: 6c75 6520 6f66 2074 6865 2060 636f 6d6d  lue of the `comm
+00011580: 6974 5f70 6f73 6974 696f 6e60 0a61 7474  it_position`.att
+00011590: 7269 6275 7465 206f 6620 7468 6520 6c61  ribute of the la
+000115a0: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
+000115b0: 742e 0a0a 6060 6070 7974 686f 6e0a 636f  t...```python.co
+000115c0: 6d6d 6974 5f70 6f73 6974 696f 6e20 3d20  mmit_position = 
+000115d0: 636c 6965 6e74 2e67 6574 5f63 6f6d 6d69  client.get_commi
+000115e0: 745f 706f 7369 7469 6f6e 2829 0a60 6060  t_position().```
+000115f0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+00011600: 7320 6669 7665 206f 7074 696f 6e61 6c20  s five optional 
+00011610: 6172 6775 6d65 6e74 732c 2060 6669 6c74  arguments, `filt
+00011620: 6572 5f65 7863 6c75 6465 602c 2060 6669  er_exclude`, `fi
+00011630: 6c74 6572 5f69 6e63 6c75 6465 602c 0a60  lter_include`,.`
+00011640: 6669 6c74 6572 5f62 795f 7374 7265 616d  filter_by_stream
+00011650: 5f6e 616d 6560 2c20 6074 696d 656f 7574  _name`, `timeout
+00011660: 6020 616e 6420 6063 7265 6465 6e74 6961  ` and `credentia
+00011670: 6c73 602e 2054 6865 7365 2076 616c 7565  ls`. These value
+00011680: 7320 6172 6520 7061 7373 6564 2074 6f0a  s are passed to.
+00011690: 6072 6561 645f 616c 6c28 2960 2e0a 0a54  `read_all()`...T
+000116a0: 6865 206f 7074 696f 6e61 6c20 6066 696c  he optional `fil
+000116b0: 7465 725f 6578 636c 7564 6560 2c20 6066  ter_exclude`, `f
+000116c0: 696c 7465 725f 696e 636c 7564 6560 2061  ilter_include` a
+000116d0: 6e64 2060 6669 6c74 6572 5f62 795f 7374  nd `filter_by_st
+000116e0: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+000116f0: 656e 7473 0a77 6f72 6b20 696e 2074 6865  ents.work in the
+00011700: 2073 616d 6520 7761 7920 6173 2074 6865   same way as the
+00011710: 7920 646f 2069 6e20 7468 6520 6072 6561  y do in the `rea
+00011720: 645f 616c 6c28 2960 206d 6574 686f 642e  d_all()` method.
+00011730: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+00011740: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+00011750: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
+00011760: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
+00011770: 2061 0a6d 6178 696d 756d 2064 7572 6174   a.maximum durat
+00011780: 696f 6e2c 2069 6e20 7365 636f 6e64 732c  ion, in seconds,
+00011790: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+000117a0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+000117b0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+000117c0: 6f70 7469 6f6e 616c 2060 6372 6564 656e  optional `creden
+000117d0: 7469 616c 7360 2061 7267 756d 656e 7420  tials` argument 
+000117e0: 6361 6e20 6265 2075 7365 6420 746f 206f  can be used to o
+000117f0: 7665 7272 6964 6520 6361 6c6c 2063 7265  verride call cre
+00011800: 6465 6e74 6961 6c73 0a64 6572 6976 6564  dentials.derived
+00011810: 2066 726f 6d20 7468 6520 636f 6e6e 6563   from the connec
+00011820: 7469 6f6e 2073 7472 696e 6720 5552 492e  tion string URI.
+00011830: 0a0a 5468 6973 206d 6574 686f 6420 6d69  ..This method mi
+00011840: 6768 7420 6265 2075 7365 6420 746f 206d  ght be used to m
+00011850: 6561 7375 7265 2070 726f 6772 6573 7320  easure progress 
+00011860: 6f66 2061 2064 6f77 6e73 7472 6561 6d20  of a downstream 
+00011870: 636f 6d70 6f6e 656e 740a 7468 6174 2069  component.that i
+00011880: 7320 7072 6f63 6573 7369 6e67 2061 6c6c  s processing all
+00011890: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+000118a0: 2c20 6279 2063 6f6d 7061 7269 6e67 2074  , by comparing t
+000118b0: 6865 2063 7572 7265 6e74 2063 6f6d 6d69  he current commi
+000118c0: 740a 706f 7369 7469 6f6e 2077 6974 6820  t.position with 
+000118d0: 7468 6520 7265 636f 7264 6564 2063 6f6d  the recorded com
+000118e0: 6d69 7420 706f 7369 7469 6f6e 206f 6620  mit position of 
+000118f0: 7468 6520 6c61 7374 2073 7563 6365 7373  the last success
+00011900: 6675 6c6c 7920 7072 6f63 6573 7365 640a  fully processed.
+00011910: 6576 656e 7420 696e 2061 2064 6f77 6e73  event in a downs
+00011920: 7472 6561 6d20 636f 6d70 6f6e 656e 742e  tream component.
+00011930: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
+00011940: 6865 2076 616c 7565 206f 6620 7468 6520  he value of the 
+00011950: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
+00011960: 2c0a 6066 696c 7465 725f 696e 636c 7564  ,.`filter_includ
+00011970: 6560 2061 6e64 2060 6669 6c74 6572 5f62  e` and `filter_b
+00011980: 795f 7374 7265 616d 5f6e 616d 6560 2061  y_stream_name` a
+00011990: 7267 756d 656e 7473 2073 686f 756c 6420  rguments should 
+000119a0: 6571 7561 6c20 7468 6f73 6520 7573 6564  equal those used
+000119b0: 0a62 7920 7468 6520 646f 776e 7374 7265  .by the downstre
+000119c0: 616d 2063 6f6d 706f 6e65 6e74 2074 6f20  am component to 
+000119d0: 6f62 7461 696e 2072 6563 6f72 6465 6420  obtain recorded 
+000119e0: 6576 656e 7473 2e0a 0a0a 2323 2320 4765  events....### Ge
+000119f0: 7420 7374 7265 616d 206d 6574 6164 6174  t stream metadat
+00011a00: 613c 6120 6964 3d22 6765 742d 7374 7265  a<a id="get-stre
+00011a10: 616d 2d6d 6574 6164 6174 6122 3e3c 2f61  am-metadata"></a
+00011a20: 3e0a 0a54 6865 2060 6765 745f 7374 7265  >..The `get_stre
+00011a30: 616d 5f6d 6574 6164 6174 6128 2960 206d  am_metadata()` m
+00011a40: 6574 686f 6420 7265 7475 726e 7320 7468  ethod returns th
+00011a50: 6520 6d65 7461 6461 7461 2066 6f72 2061  e metadata for a
+00011a60: 2073 7472 6561 6d2c 2061 6c6f 6e67 0a77   stream, along.w
+00011a70: 6974 6820 7468 6520 7665 7273 696f 6e20  ith the version 
+00011a80: 6f66 2074 6865 2073 7472 6561 6d20 6d65  of the stream me
+00011a90: 7461 6461 7461 2e0a 0a54 6869 7320 6d65  tadata...This me
+00011aa0: 7468 6f64 2068 6173 206f 6e65 2072 6571  thod has one req
+00011ab0: 7569 7265 6420 6172 6775 6d65 6e74 2c20  uired argument, 
+00011ac0: 6073 7472 6561 6d5f 6e61 6d65 602c 2077  `stream_name`, w
+00011ad0: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
+00011ae0: 2060 7374 7260 2074 6861 740a 756e 6971   `str` that.uniq
+00011af0: 7565 6c79 2069 6465 6e74 6966 6965 7320  uely identifies 
+00011b00: 6120 7374 7265 616d 2066 6f72 2077 6869  a stream for whi
+00011b10: 6368 2061 2073 7472 6561 6d20 6d65 7461  ch a stream meta
+00011b20: 6461 7461 2077 696c 6c20 6265 206f 6274  data will be obt
+00011b30: 6169 6e65 642e 0a0a 5468 6973 206d 6574  ained...This met
+00011b40: 686f 6420 6861 7320 616e 206f 7074 696f  hod has an optio
+00011b50: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+00011b60: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
+00011b70: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00011b80: 600a 7468 6174 2073 6574 7320 6120 6d61  `.that sets a ma
+00011b90: 7869 6d75 6d20 6475 7261 7469 6f6e 2c20  ximum duration, 
+00011ba0: 696e 2073 6563 6f6e 6473 2c20 666f 7220  in seconds, for 
+00011bb0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+00011bc0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+00011bd0: 7469 6f6e 2e0a 0a54 6869 7320 6d65 7468  tion...This meth
+00011be0: 6f64 2068 6173 2061 6e20 6f70 7469 6f6e  od has an option
+00011bf0: 616c 2060 6372 6564 656e 7469 616c 7360  al `credentials`
+00011c00: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+00011c10: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
+00011c20: 6f76 6572 7269 6465 2063 616c 6c20 6372  override call cr
+00011c30: 6564 656e 7469 616c 7320 6465 7269 7665  edentials derive
+00011c40: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
+00011c50: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+00011c60: 2e0a 0a49 6e20 7468 6520 6578 616d 706c  ...In the exampl
+00011c70: 6520 6265 6c6f 772c 206d 6574 6164 6174  e below, metadat
+00011c80: 6120 666f 7220 6073 7472 6561 6d5f 6e61  a for `stream_na
+00011c90: 6d65 3160 2069 7320 6f62 7461 696e 6564  me1` is obtained
+00011ca0: 2e0a 0a60 6060 7079 7468 6f6e 0a6d 6574  ...```python.met
+00011cb0: 6164 6174 612c 206d 6574 6164 6174 615f  adata, metadata_
+00011cc0: 7665 7273 696f 6e20 3d20 636c 6965 6e74  version = client
+00011cd0: 2e67 6574 5f73 7472 6561 6d5f 6d65 7461  .get_stream_meta
+00011ce0: 6461 7461 2873 7472 6561 6d5f 6e61 6d65  data(stream_name
+00011cf0: 3d73 7472 6561 6d5f 6e61 6d65 3129 0a60  =stream_name1).`
+00011d00: 6060 0a0a 5468 6520 7265 7475 726e 6564  ``..The returned
+00011d10: 2060 6d65 7461 6461 7461 6020 7661 6c75   `metadata` valu
+00011d20: 6520 6973 2061 2050 7974 686f 6e20 6064  e is a Python `d
+00011d30: 6963 7460 2e20 5468 6520 7265 7475 726e  ict`. The return
+00011d40: 6564 2060 6d65 7461 6461 7461 5f76 6572  ed `metadata_ver
+00011d50: 7369 6f6e 600a 7661 6c75 6520 6973 2065  sion`.value is e
+00011d60: 6974 6865 7220 616e 2060 696e 7460 2069  ither an `int` i
+00011d70: 6620 7468 6520 7374 7265 616d 2065 7869  f the stream exi
+00011d80: 7374 732c 206f 7220 6053 7472 6561 6d53  sts, or `StreamS
+00011d90: 7461 7465 2e4e 4f5f 5354 5245 414d 6020  tate.NO_STREAM` 
+00011da0: 6966 2074 6865 2073 7472 6561 6d0a 646f  if the stream.do
+00011db0: 6573 206e 6f74 2065 7869 7374 2061 6e64  es not exist and
+00011dc0: 206e 6f20 6d65 7461 6461 7461 2068 6173   no metadata has
+00011dd0: 2062 6565 6e20 7365 742e 2054 6865 7365   been set. These
+00011de0: 2076 616c 7565 7320 6361 6e20 6265 2075   values can be u
+00011df0: 7365 6420 6173 2074 6865 2061 7267 756d  sed as the argum
+00011e00: 656e 7473 0a6f 6620 6073 6574 5f73 7472  ents.of `set_str
+00011e10: 6561 6d5f 6d65 7461 6461 7461 2829 602e  eam_metadata()`.
+00011e20: 0a0a 2323 2320 5365 7420 7374 7265 616d  ..### Set stream
+00011e30: 206d 6574 6164 6174 613c 6120 6964 3d22   metadata<a id="
+00011e40: 7365 742d 7374 7265 616d 2d6d 6574 6164  set-stream-metad
+00011e50: 6174 6122 3e3c 2f61 3e0a 0a2a 7265 7175  ata"></a>..*requ
+00011e60: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
+00011e70: 6520 6d65 7468 6f64 2060 7365 745f 7374  e method `set_st
+00011e80: 7265 616d 5f6d 6574 6164 6174 6128 2960  ream_metadata()`
+00011e90: 2073 6574 7320 6d65 7461 6461 7461 2066   sets metadata f
+00011ea0: 6f72 2061 2073 7472 6561 6d2e 2053 7472  or a stream. Str
+00011eb0: 6561 6d20 6d65 7461 6461 7461 0a63 616e  eam metadata.can
+00011ec0: 2062 6520 7365 7420 6265 666f 7265 2061   be set before a
+00011ed0: 7070 656e 6469 6e67 2065 7665 6e74 7320  ppending events 
+00011ee0: 746f 2061 2073 7472 6561 6d2e 0a0a 5468  to a stream...Th
+00011ef0: 6973 206d 6574 686f 6420 6861 7320 6f6e  is method has on
+00011f00: 6520 7265 7175 6972 6564 2061 7267 756d  e required argum
+00011f10: 656e 742c 2060 7374 7265 616d 5f6e 616d  ent, `stream_nam
+00011f20: 6560 2c20 7768 6963 6820 6973 2061 2050  e`, which is a P
+00011f30: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
+00011f40: 0a75 6e69 7175 656c 7920 6964 656e 7469  .uniquely identi
+00011f50: 6669 6573 2061 2073 7472 6561 6d20 666f  fies a stream fo
+00011f60: 7220 7768 6963 6820 6120 7374 7265 616d  r which a stream
+00011f70: 206d 6574 6164 6174 6120 7769 6c6c 2062   metadata will b
+00011f80: 6520 7365 742e 0a0a 5468 6973 206d 6574  e set...This met
+00011f90: 686f 6420 6861 7320 616e 206f 7074 696f  hod has an optio
+00011fa0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+00011fb0: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
+00011fc0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00011fd0: 600a 7468 6174 2073 6574 7320 6120 6d61  `.that sets a ma
+00011fe0: 7869 6d75 6d20 6475 7261 7469 6f6e 2c20  ximum duration, 
+00011ff0: 696e 2073 6563 6f6e 6473 2c20 666f 7220  in seconds, for 
+00012000: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+00012010: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+00012020: 7469 6f6e 2e0a 0a54 6869 7320 6d65 7468  tion...This meth
+00012030: 6f64 2068 6173 2061 6e20 6f70 7469 6f6e  od has an option
+00012040: 616c 2060 6372 6564 656e 7469 616c 7360  al `credentials`
+00012050: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+00012060: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
+00012070: 6f76 6572 7269 6465 2063 616c 6c20 6372  override call cr
+00012080: 6564 656e 7469 616c 7320 6465 7269 7665  edentials derive
+00012090: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
+000120a0: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+000120b0: 2e0a 0a49 6e20 7468 6520 6578 616d 706c  ...In the exampl
+000120c0: 6520 6265 6c6f 772c 206d 6574 6164 6174  e below, metadat
+000120d0: 6120 666f 7220 6073 7472 6561 6d5f 6e61  a for `stream_na
+000120e0: 6d65 3160 2069 7320 7365 742e 0a0a 0a60  me1` is set....`
+000120f0: 6060 7079 7468 6f6e 0a6d 6574 6164 6174  ``python.metadat
+00012100: 615b 2266 6f6f 225d 203d 2022 6261 7222  a["foo"] = "bar"
+00012110: 0a0a 636c 6965 6e74 2e73 6574 5f73 7472  ..client.set_str
+00012120: 6561 6d5f 6d65 7461 6461 7461 280a 2020  eam_metadata(.  
+00012130: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+00012140: 7265 616d 5f6e 616d 6531 2c0a 2020 2020  ream_name1,.    
+00012150: 6d65 7461 6461 7461 3d6d 6574 6164 6174  metadata=metadat
+00012160: 612c 0a20 2020 2063 7572 7265 6e74 5f76  a,.    current_v
+00012170: 6572 7369 6f6e 3d6d 6574 6164 6174 615f  ersion=metadata_
+00012180: 7665 7273 696f 6e2c 0a29 0a60 6060 0a0a  version,.).```..
+00012190: 5468 6520 6063 7572 7265 6e74 5f76 6572  The `current_ver
+000121a0: 7369 6f6e 6020 6172 6775 6d65 6e74 2073  sion` argument s
+000121b0: 686f 756c 6420 6265 2074 6865 2063 7572  hould be the cur
+000121c0: 7265 6e74 2076 6572 7369 6f6e 206f 6620  rent version of 
+000121d0: 7468 6520 7374 7265 616d 206d 6574 6164  the stream metad
+000121e0: 6174 610a 6f62 7461 696e 6564 2066 726f  ata.obtained fro
+000121f0: 6d20 6067 6574 5f73 7472 6561 6d5f 6d65  m `get_stream_me
+00012200: 7461 6461 7461 2829 602e 0a0a 506c 6561  tadata()`...Plea
+00012210: 7365 2072 6566 6572 2074 6f20 7468 6520  se refer to the 
+00012220: 4576 656e 7453 746f 7265 4442 2064 6f63  EventStoreDB doc
+00012230: 756d 656e 7461 7469 6f6e 2066 6f72 206d  umentation for m
+00012240: 6f72 6520 696e 666f 726d 6174 696f 6e20  ore information 
+00012250: 6162 6f75 7420 7374 7265 616d 0a6d 6574  about stream.met
+00012260: 6164 6174 612e 0a0a 2323 2320 4465 6c65  adata...### Dele
+00012270: 7465 2073 7472 6561 6d3c 6120 6964 3d22  te stream<a id="
+00012280: 6465 6c65 7465 2d73 7472 6561 6d22 3e3c  delete-stream"><
+00012290: 2f61 3e0a 0a2a 7265 7175 6972 6573 206c  /a>..*requires l
+000122a0: 6561 6465 722a 0a0a 5468 6520 6d65 7468  eader*..The meth
+000122b0: 6f64 2060 6465 6c65 7465 5f73 7472 6561  od `delete_strea
+000122c0: 6d28 2960 2063 616e 2062 6520 7573 6564  m()` can be used
+000122d0: 2074 6f20 2264 656c 6574 6522 2061 2073   to "delete" a s
+000122e0: 7472 6561 6d2e 0a0a 5468 6973 206d 6574  tream...This met
+000122f0: 686f 6420 6861 7320 7477 6f20 7265 7175  hod has two requ
+00012300: 6972 6564 2061 7267 756d 656e 7473 2c20  ired arguments, 
+00012310: 6073 7472 6561 6d5f 6e61 6d65 6020 616e  `stream_name` an
+00012320: 6420 6063 7572 7265 6e74 5f76 6572 7369  d `current_versi
+00012330: 6f6e 602e 0a0a 5468 6520 7265 7175 6972  on`...The requir
+00012340: 6564 2060 7374 7265 616d 5f6e 616d 6560  ed `stream_name`
+00012350: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00012360: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
+00012370: 2075 6e69 7175 656c 7920 6964 656e 7469   uniquely identi
+00012380: 6669 6573 2061 0a73 7472 6561 6d20 746f  fies a.stream to
+00012390: 2077 6869 6368 2061 2073 6571 7565 6e63   which a sequenc
+000123a0: 6520 6f66 2065 7665 6e74 7320 7769 6c6c  e of events will
+000123b0: 2062 6520 6170 7065 6e64 6564 2e0a 0a54   be appended...T
+000123c0: 6865 2072 6571 7569 7265 6420 6063 7572  he required `cur
+000123d0: 7265 6e74 5f76 6572 7369 6f6e 6020 6172  rent_version` ar
+000123e0: 6775 6d65 6e74 2069 7320 6578 7065 6374  gument is expect
+000123f0: 6564 2074 6f20 6265 2065 6974 6865 7220  ed to be either 
+00012400: 6120 5079 7468 6f6e 2060 696e 7460 0a74  a Python `int`.t
+00012410: 6861 7420 696e 6469 6361 7465 7320 7468  hat indicates th
+00012420: 6520 7374 7265 616d 2070 6f73 6974 696f  e stream positio
+00012430: 6e20 6f66 2074 6865 206c 6173 7420 7265  n of the last re
+00012440: 636f 7264 6564 2065 7665 6e74 2069 6e20  corded event in 
+00012450: 7468 6520 7374 7265 616d 2e0a 0a54 6869  the stream...Thi
+00012460: 7320 6d65 7468 6f64 2068 6173 2061 6e20  s method has an 
+00012470: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+00012480: 7460 2061 7267 756d 656e 742c 2077 6869  t` argument, whi
+00012490: 6368 2069 7320 6120 5079 7468 6f6e 2060  ch is a Python `
+000124a0: 666c 6f61 7460 0a74 6861 7420 7365 7473  float`.that sets
+000124b0: 2061 206d 6178 696d 756d 2064 7572 6174   a maximum durat
+000124c0: 696f 6e2c 2069 6e20 7365 636f 6e64 732c  ion, in seconds,
+000124d0: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+000124e0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+000124f0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6973  operation...This
+00012500: 206d 6574 686f 6420 6861 7320 616e 206f   method has an o
+00012510: 7074 696f 6e61 6c20 6063 7265 6465 6e74  ptional `credent
+00012520: 6961 6c73 6020 6172 6775 6d65 6e74 2c20  ials` argument, 
+00012530: 7768 6963 6820 6361 6e20 6265 2075 7365  which can be use
+00012540: 6420 746f 0a6f 7665 7272 6964 6520 6361  d to.override ca
+00012550: 6c6c 2063 7265 6465 6e74 6961 6c73 2064  ll credentials d
+00012560: 6572 6976 6564 2066 726f 6d20 7468 6520  erived from the 
+00012570: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00012580: 6720 5552 492e 0a0a 496e 2074 6865 2065  g URI...In the e
+00012590: 7861 6d70 6c65 2062 656c 6f77 2c20 6073  xample below, `s
+000125a0: 7472 6561 6d5f 6e61 6d65 3160 2069 7320  tream_name1` is 
+000125b0: 6465 6c65 7465 642e 0a0a 6060 6070 7974  deleted...```pyt
+000125c0: 686f 6e0a 636f 6d6d 6974 5f70 6f73 6974  hon.commit_posit
+000125d0: 696f 6e20 3d20 636c 6965 6e74 2e64 656c  ion = client.del
+000125e0: 6574 655f 7374 7265 616d 2873 7472 6561  ete_stream(strea
+000125f0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00012600: 6d65 312c 2063 7572 7265 6e74 5f76 6572  me1, current_ver
+00012610: 7369 6f6e 3d32 290a 6060 600a 0a41 6674  sion=2).```..Aft
+00012620: 6572 2064 656c 6574 696e 6720 6120 7374  er deleting a st
+00012630: 7265 616d 2c20 6974 2773 2073 7469 6c6c  ream, it's still
+00012640: 2070 6f73 7369 626c 6520 746f 2061 7070   possible to app
+00012650: 656e 6420 6e65 7720 6576 656e 7473 2e20  end new events. 
+00012660: 5265 6164 696e 6720 6672 6f6d 2061 0a64  Reading from a.d
+00012670: 656c 6574 6564 2073 7472 6561 6d20 7769  eleted stream wi
+00012680: 6c6c 2072 6574 7572 6e20 6f6e 6c79 2065  ll return only e
+00012690: 7665 6e74 7320 7468 6174 2068 6176 6520  vents that have 
+000126a0: 6265 656e 2061 7070 656e 6465 6420 6166  been appended af
+000126b0: 7465 7220 6974 2077 6173 0a64 656c 6574  ter it was.delet
+000126c0: 6564 2e0a 0a23 2323 2054 6f6d 6273 746f  ed...### Tombsto
+000126d0: 6e65 2073 7472 6561 6d3c 6120 6964 3d22  ne stream<a id="
+000126e0: 746f 6d62 7374 6f6e 652d 7374 7265 616d  tombstone-stream
+000126f0: 223e 3c2f 613e 0a0a 2a72 6571 7569 7265  "></a>..*require
+00012700: 7320 6c65 6164 6572 2a0a 0a54 6865 206d  s leader*..The m
+00012710: 6574 686f 6420 6074 6f6d 6273 746f 6e65  ethod `tombstone
+00012720: 5f73 7472 6561 6d28 2960 2063 616e 2062  _stream()` can b
+00012730: 6520 7573 6564 2074 6f20 2274 6f6d 6273  e used to "tombs
+00012740: 746f 6e65 2220 6120 7374 7265 616d 2e0a  tone" a stream..
+00012750: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+00012760: 2074 776f 2072 6571 7569 7265 6420 6172   two required ar
+00012770: 6775 6d65 6e74 732c 2060 7374 7265 616d  guments, `stream
+00012780: 5f6e 616d 6560 2061 6e64 2060 6375 7272  _name` and `curr
+00012790: 656e 745f 7665 7273 696f 6e60 2e0a 0a54  ent_version`...T
+000127a0: 6865 2072 6571 7569 7265 6420 6073 7472  he required `str
+000127b0: 6561 6d5f 6e61 6d65 6020 6172 6775 6d65  eam_name` argume
+000127c0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+000127d0: 7374 7260 2074 6861 7420 756e 6971 7565  str` that unique
+000127e0: 6c79 2069 6465 6e74 6966 6965 7320 610a  ly identifies a.
+000127f0: 7374 7265 616d 2074 6f20 7768 6963 6820  stream to which 
+00012800: 6120 7365 7175 656e 6365 206f 6620 6576  a sequence of ev
+00012810: 656e 7473 2077 696c 6c20 6265 2061 7070  ents will be app
+00012820: 656e 6465 642e 0a0a 5468 6520 7265 7175  ended...The requ
+00012830: 6972 6564 2060 6375 7272 656e 745f 7665  ired `current_ve
+00012840: 7273 696f 6e60 2061 7267 756d 656e 7420  rsion` argument 
+00012850: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
+00012860: 6520 6569 7468 6572 2061 2050 7974 686f  e either a Pytho
+00012870: 6e20 6069 6e74 600a 7468 6174 2069 6e64  n `int`.that ind
+00012880: 6963 6174 6573 2074 6865 2073 7472 6561  icates the strea
+00012890: 6d20 706f 7369 7469 6f6e 206f 6620 7468  m position of th
+000128a0: 6520 6c61 7374 2072 6563 6f72 6465 6420  e last recorded 
+000128b0: 6576 656e 7420 696e 2074 6865 2073 7472  event in the str
+000128c0: 6561 6d2e 0a0a 5468 6973 206d 6574 686f  eam...This metho
+000128d0: 6420 6861 7320 616e 206f 7074 696f 6e61  d has an optiona
+000128e0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+000128f0: 6d65 6e74 2c20 7768 6963 6820 6973 2061  ment, which is a
+00012900: 2050 7974 686f 6e20 6066 6c6f 6174 600a   Python `float`.
+00012910: 7468 6174 2073 6574 7320 6120 6d61 7869  that sets a maxi
+00012920: 6d75 6d20 6475 7261 7469 6f6e 2c20 696e  mum duration, in
+00012930: 2073 6563 6f6e 6473 2c20 666f 7220 7468   seconds, for th
+00012940: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
+00012950: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
+00012960: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
+00012970: 2068 6173 2061 6e20 6f70 7469 6f6e 616c   has an optional
+00012980: 2060 6372 6564 656e 7469 616c 7360 2061   `credentials` a
+00012990: 7267 756d 656e 742c 2077 6869 6368 2063  rgument, which c
+000129a0: 616e 2062 6520 7573 6564 2074 6f0a 6f76  an be used to.ov
+000129b0: 6572 7269 6465 2063 616c 6c20 6372 6564  erride call cred
+000129c0: 656e 7469 616c 7320 6465 7269 7665 6420  entials derived 
+000129d0: 6672 6f6d 2074 6865 2063 6f6e 6e65 6374  from the connect
+000129e0: 696f 6e20 7374 7269 6e67 2055 5249 2e0a  ion string URI..
+000129f0: 0a49 6e20 7468 6520 6578 616d 706c 6520  .In the example 
+00012a00: 6265 6c6f 772c 2060 7374 7265 616d 5f6e  below, `stream_n
+00012a10: 616d 6531 6020 6973 2074 6f6d 6273 746f  ame1` is tombsto
+00012a20: 6e65 642e 0a0a 6060 6070 7974 686f 6e0a  ned...```python.
+00012a30: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
+00012a40: 3d20 636c 6965 6e74 2e74 6f6d 6273 746f  = client.tombsto
+00012a50: 6e65 5f73 7472 6561 6d28 7374 7265 616d  ne_stream(stream
+00012a60: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+00012a70: 6531 2c20 6375 7272 656e 745f 7665 7273  e1, current_vers
+00012a80: 696f 6e3d 3229 0a60 6060 0a0a 4166 7465  ion=2).```..Afte
+00012a90: 7220 746f 6d62 7374 6f6e 696e 6720 6120  r tombstoning a 
+00012aa0: 7374 7265 616d 2c20 6974 2773 206e 6f74  stream, it's not
+00012ab0: 2070 6f73 7369 626c 6520 746f 2061 7070   possible to app
+00012ac0: 656e 6420 6e65 7720 6576 656e 7473 2e0a  end new events..
+00012ad0: 0a0a 2323 2043 6174 6368 2d75 7020 7375  ..## Catch-up su
+00012ae0: 6273 6372 6970 7469 6f6e 733c 6120 6964  bscriptions<a id
+00012af0: 3d22 6361 7463 682d 7570 2d73 7562 7363  ="catch-up-subsc
+00012b00: 7269 7074 696f 6e73 223e 3c2f 613e 0a0a  riptions"></a>..
+00012b10: 4120 2263 6174 6368 2d75 7022 2073 7562  A "catch-up" sub
+00012b20: 7363 7269 7074 696f 6e20 6361 6e20 6265  scription can be
+00012b30: 2075 7365 6420 746f 2072 6563 6569 7665   used to receive
+00012b40: 2065 7665 6e74 7320 7468 6174 2068 6176   events that hav
+00012b50: 6520 616c 7265 6164 7920 6265 656e 0a72  e already been.r
+00012b60: 6563 6f72 6465 6420 616e 6420 6576 656e  ecorded and even
+00012b70: 7473 2074 6861 7420 6172 6520 7265 636f  ts that are reco
+00012b80: 7264 6564 2073 7562 7365 7175 656e 746c  rded subsequentl
+00012b90: 792e 2041 2063 6174 6368 2d75 7020 7375  y. A catch-up su
+00012ba0: 6273 6372 6970 7469 6f6e 2063 616e 0a62  bscription can.b
+00012bb0: 6520 7573 6564 2062 7920 616e 2065 7665  e used by an eve
+00012bc0: 6e74 2d70 726f 6365 7373 696e 6720 636f  nt-processing co
+00012bd0: 6d70 6f6e 656e 7420 7468 6174 2070 726f  mponent that pro
+00012be0: 6365 7373 6573 2072 6563 6f72 6465 6420  cesses recorded 
+00012bf0: 6576 656e 7473 2077 6974 680a 2265 7861  events with."exa
+00012c00: 6374 6c79 2d6f 6e63 6522 2073 656d 616e  ctly-once" seman
+00012c10: 7469 6373 2e0a 0a54 6865 2060 7375 6273  tics...The `subs
+00012c20: 6372 6962 655f 746f 5f61 6c6c 2829 6020  cribe_to_all()` 
+00012c30: 6d65 7468 6f64 2073 7461 7274 7320 6120  method starts a 
+00012c40: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+00012c50: 7074 696f 6e20 7468 6174 2063 616e 2072  ption that can r
+00012c60: 6563 6569 7665 0a61 6c6c 2065 7665 6e74  eceive.all event
+00012c70: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
+00012c80: 652e 2054 6865 2060 7375 6273 6372 6962  e. The `subscrib
+00012c90: 655f 746f 5f73 7472 6561 6d28 2960 206d  e_to_stream()` m
+00012ca0: 6574 686f 6420 7374 6172 7473 2061 2063  ethod starts a c
+00012cb0: 6174 6368 2d75 700a 7375 6273 6372 6970  atch-up.subscrip
+00012cc0: 7469 6f6e 2074 6861 7420 6361 6e20 7265  tion that can re
+00012cd0: 6365 6976 6520 6576 656e 7473 2066 726f  ceive events fro
+00012ce0: 6d20 6120 7370 6563 6966 6963 2073 7472  m a specific str
+00012cf0: 6561 6d2e 2042 6f74 6820 6d65 7468 6f64  eam. Both method
+00012d00: 7320 7265 7475 726e 2061 0a22 6361 7463  s return a."catc
+00012d10: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
+00012d20: 6e22 206f 626a 6563 742c 2077 6869 6368  n" object, which
+00012d30: 2069 7320 6120 5079 7468 6f6e 2069 7465   is a Python ite
+00012d40: 7261 746f 722e 2052 6563 6f72 6465 6420  rator. Recorded 
+00012d50: 6576 656e 7473 2063 616e 2062 650a 6f62  events can be.ob
+00012d60: 7461 696e 6564 2062 7920 6974 6572 6174  tained by iterat
+00012d70: 696f 6e2e 2052 6563 6f72 6465 6420 6576  ion. Recorded ev
+00012d80: 656e 7420 6f62 6a65 6374 7320 6f62 7461  ent objects obta
+00012d90: 696e 6564 2069 6e20 7468 6973 2077 6179  ined in this way
+00012da0: 2061 7265 2069 6e73 7461 6e63 6573 0a6f   are instances.o
+00012db0: 6620 7468 6520 6052 6563 6f72 6465 6445  f the `RecordedE
+00012dc0: 7665 6e74 6020 636c 6173 732e 0a0a 4265  vent` class...Be
+00012dd0: 666f 7265 2074 6865 2022 6361 7463 682d  fore the "catch-
+00012de0: 7570 2073 7562 7363 7269 7074 696f 6e22  up subscription"
+00012df0: 206f 626a 6563 7420 6973 2072 6574 7572   object is retur
+00012e00: 6e65 6420 746f 2074 6865 2063 616c 6c65  ned to the calle
+00012e10: 722c 2074 6865 2063 6c69 656e 7420 7769  r, the client wi
+00012e20: 6c6c 0a66 6972 7374 6c79 206f 6274 6169  ll.firstly obtai
+00012e30: 6e20 6120 2263 6f6e 6669 726d 6174 696f  n a "confirmatio
+00012e40: 6e22 2072 6573 706f 6e73 6520 6672 6f6d  n" response from
+00012e50: 2074 6865 2073 6572 7665 722c 2077 6869   the server, whi
+00012e60: 6368 2061 6c6c 6f77 7320 7468 6520 636c  ch allows the cl
+00012e70: 6965 6e74 2074 6f0a 6465 7465 6374 2074  ient to.detect t
+00012e80: 6861 7420 626f 7468 2074 6865 2067 5250  hat both the gRP
+00012e90: 4320 636f 6e6e 6563 7469 6f6e 2061 6e64  C connection and
+00012ea0: 2074 6865 2073 7472 6561 6d69 6e67 2067   the streaming g
+00012eb0: 5250 4320 6361 6c6c 2069 7320 6f70 6572  RPC call is oper
+00012ec0: 6174 696f 6e61 6c2e 2046 6f72 0a74 6869  ational. For.thi
+00012ed0: 7320 7265 6173 6f6e 2c20 7468 6520 6073  s reason, the `s
+00012ee0: 7562 7363 7269 6265 5f74 6f5f 616c 6c28  ubscribe_to_all(
+00012ef0: 2960 2061 6e64 2060 7375 6273 6372 6962  )` and `subscrib
+00012f00: 655f 746f 5f73 7472 6561 6d28 2960 206d  e_to_stream()` m
+00012f10: 6574 686f 6473 2061 7265 2062 6f74 680a  ethods are both.
+00012f20: 7573 6566 756c 6c79 2064 6563 6f72 6174  usefully decorat
+00012f30: 6564 2077 6974 6820 7468 6520 7265 636f  ed with the reco
+00012f40: 6e6e 6563 7420 616e 6420 7265 7472 7920  nnect and retry 
+00012f50: 6465 636f 7261 746f 7273 2e20 486f 7765  decorators. Howe
+00012f60: 7665 722c 206f 6e63 6520 7468 6520 6d65  ver, once the me
+00012f70: 7468 6f64 0a68 6173 2072 6574 7572 6e65  thod.has returne
+00012f80: 642c 2074 6865 2064 6563 6f72 6174 6f72  d, the decorator
+00012f90: 7320 7769 6c6c 2068 6176 6520 6578 6974  s will have exit
+00012fa0: 6564 2c20 616e 6420 616e 7920 6578 6365  ed, and any exce
+00012fb0: 7074 696f 6e73 2074 6861 7420 6172 6520  ptions that are 
+00012fc0: 7261 6973 6564 0a64 7565 2074 6f20 636f  raised.due to co
+00012fd0: 6e6e 6563 7469 6f6e 2069 7373 7565 7320  nnection issues 
+00012fe0: 7768 696c 7374 2069 7465 7261 7469 6e67  whilst iterating
+00012ff0: 206f 7665 7220 7468 6520 7375 6273 6372   over the subscr
+00013000: 6970 7469 6f6e 206f 626a 6563 7420 7769  iption object wi
+00013010: 6c6c 2068 6176 6520 746f 0a62 6520 6861  ll have to.be ha
+00013020: 6e64 6c65 6420 6279 2079 6f75 7220 636f  ndled by your co
+00013030: 6465 2e0a 0a41 2022 6361 7463 682d 7570  de...A "catch-up
+00013040: 2073 7562 7363 7269 7074 696f 6e22 2069   subscription" i
+00013050: 7465 7261 746f 7220 7769 6c6c 206e 6f74  terator will not
+00013060: 2061 7574 6f6d 6174 6963 616c 6c79 2073   automatically s
+00013070: 746f 7020 7768 656e 2074 6865 7265 2061  top when there a
+00013080: 7265 206e 6f20 6d6f 7265 0a65 7665 6e74  re no more.event
+00013090: 7320 746f 2062 6520 7265 7475 726e 6564  s to be returned
+000130a0: 2c20 6275 7420 696e 7374 6561 6420 7468  , but instead th
+000130b0: 6520 6974 6572 6174 696f 6e20 7769 6c6c  e iteration will
+000130c0: 2062 6c6f 636b 2075 6e74 696c 206e 6577   block until new
+000130d0: 2065 7665 6e74 7320 6172 650a 7375 6273   events are.subs
+000130e0: 6571 7565 6e74 6c79 2072 6563 6f72 6465  equently recorde
+000130f0: 6420 696e 2074 6865 2064 6174 6162 6173  d in the databas
+00013100: 652e 2041 6e79 2073 7562 7365 7175 656e  e. Any subsequen
+00013110: 746c 7920 7265 636f 7264 6564 2065 7665  tly recorded eve
+00013120: 6e74 7320 7769 6c6c 2074 6865 6e20 6265  nts will then be
+00013130: 0a69 6d6d 6564 6961 7465 6c79 2073 7472  .immediately str
+00013140: 6561 6d65 6420 746f 2074 6865 2063 6c69  eamed to the cli
+00013150: 656e 742c 2061 6e64 2074 6865 2069 7465  ent, and the ite
+00013160: 7261 7469 6f6e 2077 696c 6c20 7468 656e  ration will then
+00013170: 2063 6f6e 7469 6e75 652e 2054 6865 2073   continue. The s
+00013180: 7472 6561 6d69 6e67 0a6f 6620 6576 656e  treaming.of even
+00013190: 7473 2c20 616e 6420 6865 6e63 6520 7468  ts, and hence th
+000131a0: 6520 6974 6572 6174 696f 6e2c 2063 616e  e iteration, can
+000131b0: 2062 6520 7374 6f70 7065 6420 6279 2063   be stopped by c
+000131c0: 616c 6c69 6e67 2074 6865 2060 7374 6f70  alling the `stop
+000131d0: 2829 6020 6d65 7468 6f64 206f 6e20 7468  ()` method on th
+000131e0: 650a 2263 6174 6368 2d75 7020 7375 6273  e."catch-up subs
+000131f0: 6372 6970 7469 6f6e 2220 6f62 6a65 6374  cription" object
+00013200: 2e0a 0a23 2323 2053 7562 7363 7269 6265  ...### Subscribe
+00013210: 2074 6f20 616c 6c20 6576 656e 7473 3c61   to all events<a
+00013220: 2069 643d 2273 7562 7363 7269 6265 2d74   id="subscribe-t
+00013230: 6f2d 616c 6c2d 6576 656e 7473 223e 3c2f  o-all-events"></
+00013240: 613e 0a0a 5468 6560 7375 6273 6372 6962  a>..The`subscrib
+00013250: 655f 746f 5f61 6c6c 2829 6020 6d65 7468  e_to_all()` meth
+00013260: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+00013270: 6f20 7374 6172 7420 6120 6361 7463 682d  o start a catch-
+00013280: 7570 2073 7562 7363 7269 7074 696f 6e0a  up subscription.
+00013290: 6672 6f6d 2077 6869 6368 2061 6c6c 2065  from which all e
+000132a0: 7665 6e74 7320 7265 636f 7264 6564 2069  vents recorded i
+000132b0: 6e20 7468 6520 6461 7461 6261 7365 2063  n the database c
+000132c0: 616e 2062 6520 6f62 7461 696e 6564 2069  an be obtained i
+000132d0: 6e20 7468 6520 6f72 6465 720a 7468 6579  n the order.they
+000132e0: 2077 6572 6520 7265 636f 7264 6564 2e20   were recorded. 
+000132f0: 5468 6973 206d 6574 686f 6420 7265 7475  This method retu
+00013300: 726e 7320 6120 2263 6174 6368 2d75 7020  rns a "catch-up 
+00013310: 7375 6273 6372 6970 7469 6f6e 2220 6974  subscription" it
+00013320: 6572 6174 6f72 2e0a 0a54 6869 7320 6d65  erator...This me
+00013330: 7468 6f64 2061 6c73 6f20 6861 7320 7465  thod also has te
+00013340: 6e20 6f70 7469 6f6e 616c 2061 7267 756d  n optional argum
+00013350: 656e 7473 2c20 6063 6f6d 6d69 745f 706f  ents, `commit_po
+00013360: 7369 7469 6f6e 602c 2060 6672 6f6d 5f65  sition`, `from_e
+00013370: 6e64 602c 2060 7265 736f 6c76 655f 6c69  nd`, `resolve_li
+00013380: 6e6b 7360 2c0a 6066 696c 7465 725f 6578  nks`,.`filter_ex
+00013390: 636c 7564 6560 2c20 6066 696c 7465 725f  clude`, `filter_
+000133a0: 696e 636c 7564 6560 2c20 6066 696c 7465  include`, `filte
+000133b0: 725f 6279 5f73 7472 6561 6d5f 6e61 6d65  r_by_stream_name
+000133c0: 602c 2060 696e 636c 7564 655f 6368 6563  `, `include_chec
+000133d0: 6b70 6f69 6e74 7360 2c0a 6069 6e63 6c75  kpoints`,.`inclu
+000133e0: 6465 5f63 6175 6768 745f 7570 602c 2060  de_caught_up`, `
+000133f0: 7469 6d65 6f75 7460 2061 6e64 2060 6372  timeout` and `cr
+00013400: 6564 656e 7469 616c 7360 2e0a 0a54 6865  edentials`...The
+00013410: 206f 7074 696f 6e61 6c20 6063 6f6d 6d69   optional `commi
+00013420: 745f 706f 7369 7469 6f6e 6020 6172 6775  t_position` argu
+00013430: 6d65 6e74 2073 7065 6369 6669 6573 2061  ment specifies a
+00013440: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+00013450: 2e20 5468 6520 6465 6661 756c 740a 7661  . The default.va
+00013460: 6c75 6520 6f66 2060 636f 6d6d 6974 5f70  lue of `commit_p
+00013470: 6f73 6974 696f 6e60 2069 7320 604e 6f6e  osition` is `Non
+00013480: 6560 2c20 7768 6963 6820 6d65 616e 7320  e`, which means 
+00013490: 7468 6520 6361 7463 682d 7570 2073 7562  the catch-up sub
+000134a0: 7363 7269 7074 696f 6e20 7769 6c6c 0a73  scription will.s
+000134b0: 7461 7274 2066 726f 6d20 7468 6520 6669  tart from the fi
+000134c0: 7273 7420 7265 636f 7264 6564 2065 7665  rst recorded eve
+000134d0: 6e74 2069 6e20 7468 6520 6461 7461 6261  nt in the databa
+000134e0: 7365 2e20 4966 2061 2063 6f6d 6d69 7420  se. If a commit 
+000134f0: 706f 7369 7469 6f6e 2069 7320 6769 7665  position is give
+00013500: 6e2c 0a69 7420 6d75 7374 206d 6174 6368  n,.it must match
+00013510: 2061 6e20 6163 7475 616c 6c79 2065 7869   an actually exi
+00013520: 7374 696e 6720 636f 6d6d 6974 2070 6f73  sting commit pos
+00013530: 6974 696f 6e20 696e 2074 6865 2064 6174  ition in the dat
+00013540: 6162 6173 652e 204f 6e6c 7920 6576 656e  abase. Only even
+00013550: 7473 0a72 6563 6f72 6465 6420 6166 7465  ts.recorded afte
+00013560: 7220 7468 6174 2070 6f73 6974 696f 6e20  r that position 
+00013570: 7769 6c6c 2062 6520 6f62 7461 696e 6564  will be obtained
+00013580: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00013590: 6066 726f 6d5f 656e 6460 2061 7267 756d  `from_end` argum
+000135a0: 656e 7420 7370 6563 6966 6965 7320 7768  ent specifies wh
+000135b0: 6574 6865 7220 6f72 206e 6f74 2074 6865  ether or not the
+000135c0: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
+000135d0: 6970 7469 6f6e 0a77 696c 6c20 7374 6172  iption.will star
+000135e0: 7420 6672 6f6d 2074 6865 206c 6173 7420  t from the last 
+000135f0: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
+00013600: 6e20 7468 6520 6461 7461 6261 7365 2e20  n the database. 
+00013610: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
+00013620: 2061 7267 756d 656e 740a 6973 2060 4661   argument.is `Fa
+00013630: 6c73 6560 2e20 4966 2060 6672 6f6d 5f65  lse`. If `from_e
+00013640: 6e64 6020 6973 2060 5472 7565 602c 206f  nd` is `True`, o
+00013650: 6e6c 7920 6576 656e 7473 2072 6563 6f72  nly events recor
+00013660: 6465 6420 6166 7465 7220 7468 6520 7375  ded after the su
+00013670: 6273 6372 6970 7469 6f6e 0a69 7320 7374  bscription.is st
+00013680: 6172 7465 6420 7769 6c6c 2062 6520 6f62  arted will be ob
+00013690: 7461 696e 6564 2e20 5468 6973 2061 7267  tained. This arg
+000136a0: 756d 656e 7420 7769 6c6c 2062 6520 6469  ument will be di
+000136b0: 7372 6567 6172 6465 6420 6966 2060 636f  sregarded if `co
+000136c0: 6d6d 6974 5f70 6f73 6974 696f 6e60 0a69  mmit_position`.i
+000136d0: 7320 6e6f 7420 604e 6f6e 6560 2e0a 0a54  s not `None`...T
+000136e0: 6865 206f 7074 696f 6e61 6c20 6072 6573  he optional `res
+000136f0: 6f6c 7665 5f6c 696e 6b73 6020 6172 6775  olve_links` argu
+00013700: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00013710: 2060 626f 6f6c 602e 2054 6865 2064 6566   `bool`. The def
+00013720: 6175 6c74 2076 616c 7565 206f 6620 6072  ault value of `r
+00013730: 6573 6f6c 7665 5f6c 696e 6b73 600a 6973  esolve_links`.is
+00013740: 2060 4661 6c73 6560 2c20 7768 6963 6820   `False`, which 
+00013750: 6d65 616e 7320 616e 7920 6576 656e 7420  means any event 
+00013760: 6c69 6e6b 7320 7769 6c6c 206e 6f74 2062  links will not b
+00013770: 6520 7265 736f 6c76 6564 2c20 736f 2074  e resolved, so t
+00013780: 6861 7420 7468 6520 6576 656e 7473 2074  hat the events t
+00013790: 6861 7420 6172 650a 7265 7475 726e 6564  hat are.returned
+000137a0: 206d 6179 2072 6570 7265 7365 6e74 2065   may represent e
+000137b0: 7665 6e74 206c 696e 6b73 2e20 4966 2060  vent links. If `
+000137c0: 7265 736f 6c76 655f 6c69 6e6b 7360 2069  resolve_links` i
+000137d0: 7320 6054 7275 6560 2c20 616e 7920 6576  s `True`, any ev
+000137e0: 656e 7420 6c69 6e6b 7320 7769 6c6c 0a62  ent links will.b
+000137f0: 6520 7265 736f 6c76 6564 2c20 736f 2074  e resolved, so t
+00013800: 6861 7420 7468 6520 6c69 6e6b 6564 2065  hat the linked e
+00013810: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
+00013820: 7475 726e 6564 2069 6e73 7465 6164 206f  turned instead o
+00013830: 6620 7468 6520 6576 656e 7420 6c69 6e6b  f the event link
+00013840: 732e 0a0a 5468 6520 6f70 7469 6f6e 616c  s...The optional
+00013850: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
+00013860: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+00013870: 7365 7175 656e 6365 206f 6620 7265 6775  sequence of regu
+00013880: 6c61 7220 6578 7072 6573 7369 6f6e 7320  lar expressions 
+00013890: 7468 6174 0a73 7065 6369 6669 6573 2077  that.specifies w
+000138a0: 6869 6368 2072 6563 6f72 6465 6420 6576  hich recorded ev
+000138b0: 656e 7473 2073 686f 756c 6420 6265 2072  ents should be r
+000138c0: 6574 7572 6e65 642e 2054 6869 7320 6172  eturned. This ar
+000138d0: 6775 6d65 6e74 2069 7320 6967 6e6f 7265  gument is ignore
+000138e0: 640a 6966 2060 6669 6c74 6572 5f69 6e63  d.if `filter_inc
+000138f0: 6c75 6465 6020 6973 2073 6574 2074 6f20  lude` is set to 
+00013900: 6120 6e6f 6e2d 656d 7074 7920 7365 7175  a non-empty sequ
+00013910: 656e 6365 2e20 5468 6520 6465 6661 756c  ence. The defaul
+00013920: 7420 7661 6c75 6520 6f66 2074 6869 730a  t value of this.
+00013930: 6172 6775 6d65 6e74 206d 6174 6368 6573  argument matches
+00013940: 2074 6865 2065 7665 6e74 2074 7970 6573   the event types
+00013950: 206f 6620 4576 656e 7453 746f 7265 4442   of EventStoreDB
+00013960: 2022 7379 7374 656d 2065 7665 6e74 7322   "system events"
+00013970: 2c20 736f 2074 6861 7420 7379 7374 656d  , so that system
+00013980: 0a65 7665 6e74 7320 7769 6c6c 206e 6f74  .events will not
+00013990: 206e 6f72 6d61 6c6c 7920 6265 2069 6e63   normally be inc
+000139a0: 6c75 6465 642e 2053 6565 2074 6865 204e  luded. See the N
+000139b0: 6f74 6573 2073 6563 7469 6f6e 2062 656c  otes section bel
+000139c0: 6f77 2066 6f72 206d 6f72 650a 696e 666f  ow for more.info
+000139d0: 726d 6174 696f 6e20 6162 6f75 7420 6669  rmation about fi
+000139e0: 6c74 6572 2065 7870 7265 7373 696f 6e73  lter expressions
+000139f0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00013a00: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+00013a10: 2061 7267 756d 656e 7420 6973 2061 2073   argument is a s
+00013a20: 6571 7565 6e63 6520 6f66 2072 6567 756c  equence of regul
+00013a30: 6172 2065 7870 7265 7373 696f 6e73 0a74  ar expressions.t
+00013a40: 6861 7420 7370 6563 6966 6965 7320 7768  hat specifies wh
+00013a50: 6963 6820 7265 636f 7264 6564 2065 7665  ich recorded eve
+00013a60: 6e74 7320 7368 6f75 6c64 2062 6520 7265  nts should be re
+00013a70: 7475 726e 6564 2e20 4279 2064 6566 6175  turned. By defau
+00013a80: 6c74 2c20 7468 6973 0a61 7267 756d 656e  lt, this.argumen
+00013a90: 7420 6973 2061 6e20 656d 7074 7920 7475  t is an empty tu
+00013aa0: 706c 652e 2049 6620 7468 6973 2061 7267  ple. If this arg
+00013ab0: 756d 656e 7420 6973 2073 6574 2074 6f20  ument is set to 
+00013ac0: 6120 6e6f 6e2d 656d 7074 7920 7365 7175  a non-empty sequ
+00013ad0: 656e 6365 2c0a 7468 6520 6066 696c 7465  ence,.the `filte
+00013ae0: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
+00013af0: 656e 7420 6973 2069 676e 6f72 6564 2e0a  ent is ignored..
+00013b00: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
+00013b10: 696c 7465 725f 6279 5f73 7472 6561 6d5f  ilter_by_stream_
+00013b20: 6e61 6d65 6020 6172 6775 6d65 6e74 2069  name` argument i
+00013b30: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
+00013b40: 6020 7468 6174 2069 6e64 6963 6174 6573  ` that indicates
+00013b50: 0a77 6865 7468 6572 2074 6865 2066 696c  .whether the fil
+00013b60: 7465 7269 6e67 2077 696c 6c20 6170 706c  tering will appl
+00013b70: 7920 746f 2065 7665 6e74 2074 7970 6573  y to event types
+00013b80: 206f 7220 7374 7265 616d 206e 616d 6573   or stream names
+00013b90: 2e20 4279 2064 6566 6175 6c74 2c20 7468  . By default, th
+00013ba0: 6973 0a76 616c 7565 2069 7320 6046 616c  is.value is `Fal
+00013bb0: 7365 6020 616e 6420 736f 2074 6865 2066  se` and so the f
+00013bc0: 696c 7465 7269 6e67 2077 696c 6c20 6170  iltering will ap
+00013bd0: 706c 7920 746f 2074 6865 2065 7665 6e74  ply to the event
+00013be0: 2074 7970 6520 7374 7269 6e67 7320 6f66   type strings of
+00013bf0: 0a72 6563 6f72 6465 6420 6576 656e 7473  .recorded events
+00013c00: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00013c10: 6069 6e63 6c75 6465 5f63 6865 636b 706f  `include_checkpo
+00013c20: 696e 7473 6020 6172 6775 6d65 6e74 2069  ints` argument i
+00013c30: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
+00013c40: 6020 7768 6963 6820 696e 6469 6361 7465  ` which indicate
+00013c50: 730a 7768 6574 6865 7220 2263 6865 636b  s.whether "check
+00013c60: 706f 696e 7422 206d 6573 7361 6765 7320  point" messages 
+00013c70: 7368 6f75 6c64 2062 6520 696e 636c 7564  should be includ
+00013c80: 6564 2077 6865 6e20 7265 636f 7264 6564  ed when recorded
+00013c90: 2065 7665 6e74 7320 6172 6520 7265 6365   events are rece
+00013ca0: 6976 6564 2e0a 4368 6563 6b70 6f69 6e74  ived..Checkpoint
+00013cb0: 7320 6861 7665 2061 2060 636f 6d6d 6974  s have a `commit
+00013cc0: 5f70 6f73 6974 696f 6e60 2076 616c 7565  _position` value
+00013cd0: 2074 6861 7420 6361 6e20 6265 2075 7365   that can be use
+00013ce0: 6420 6279 2061 6e20 6576 656e 7420 7072  d by an event pr
+00013cf0: 6f63 6573 7369 6e67 2063 6f6d 706f 6e65  ocessing compone
+00013d00: 6e74 2074 6f0a 7570 6461 7465 2069 7473  nt to.update its
+00013d10: 2072 6563 6f72 6465 6420 636f 6d6d 6974   recorded commit
+00013d20: 2070 6f73 6974 696f 6e20 7661 6c75 652c   position value,
+00013d30: 2073 6f20 7468 6174 2c20 7768 656e 206c   so that, when l
+00013d40: 6f74 7320 6f66 2065 7665 6e74 7320 6172  ots of events ar
+00013d50: 6520 6265 696e 670a 6669 6c74 6572 206f  e being.filter o
+00013d60: 7574 2c20 7468 6520 7375 6273 6372 6962  ut, the subscrib
+00013d70: 6572 2064 6f65 7320 6e6f 7420 6861 7665  er does not have
+00013d80: 2074 6f20 7374 6172 7420 6672 6f6d 2074   to start from t
+00013d90: 6865 2073 616d 6520 6f6c 6420 706f 7369  he same old posi
+00013da0: 7469 6f6e 2077 6865 6e0a 7468 6520 6576  tion when.the ev
+00013db0: 656e 7420 7072 6f63 6573 7369 6e67 2063  ent processing c
+00013dc0: 6f6d 706f 6e65 6e74 2069 7320 7265 7374  omponent is rest
+00013dd0: 6172 7465 642e 0a0a 5468 6520 6f70 7469  arted...The opti
+00013de0: 6f6e 616c 2060 696e 636c 7564 655f 6361  onal `include_ca
+00013df0: 7567 6874 5f75 7060 2061 7267 756d 656e  ught_up` argumen
+00013e00: 7420 6973 2061 2050 7974 686f 6e20 6062  t is a Python `b
+00013e10: 6f6f 6c60 2077 6869 6368 2069 6e64 6963  ool` which indic
+00013e20: 6174 6573 0a77 6865 7468 6572 2022 6361  ates.whether "ca
+00013e30: 7567 6874 2075 7022 206d 6573 7361 6765  ught up" message
+00013e40: 7320 7368 6f75 6c64 2062 6520 696e 636c  s should be incl
+00013e50: 7564 6564 2077 6865 6e20 7265 636f 7264  uded when record
+00013e60: 6564 2065 7665 6e74 7320 6172 650a 7265  ed events are.re
+00013e70: 6365 6976 6564 2e20 5468 6520 6465 6661  ceived. The defa
+00013e80: 756c 7420 7661 6c75 6520 6f66 2060 696e  ult value of `in
+00013e90: 636c 7564 655f 6361 7567 6874 5f75 7060  clude_caught_up`
+00013ea0: 2069 7320 6046 616c 7365 602e 0a0a 5468   is `False`...Th
+00013eb0: 6520 6f70 7469 6f6e 616c 2060 7469 6d65  e optional `time
+00013ec0: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
+00013ed0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00013ee0: 6020 7768 6963 6820 7365 7473 2061 0a6d  ` which sets a.m
+00013ef0: 6178 696d 756d 2064 7572 6174 696f 6e2c  aximum duration,
+00013f00: 2069 6e20 7365 636f 6e64 732c 2066 6f72   in seconds, for
+00013f10: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+00013f20: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+00013f30: 6174 696f 6e2e 0a0a 5468 6520 6f70 7469  ation...The opti
+00013f40: 6f6e 616c 2060 6372 6564 656e 7469 616c  onal `credential
+00013f50: 7360 2061 7267 756d 656e 7420 6361 6e20  s` argument can 
+00013f60: 6265 2075 7365 6420 746f 0a6f 7665 7272  be used to.overr
+00013f70: 6964 6520 6361 6c6c 2063 7265 6465 6e74  ide call credent
+00013f80: 6961 6c73 2064 6572 6976 6564 2066 726f  ials derived fro
+00013f90: 6d20 7468 6520 636f 6e6e 6563 7469 6f6e  m the connection
+00013fa0: 2073 7472 696e 6720 5552 492e 0a0a 5468   string URI...Th
+00013fb0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00013fc0: 7368 6f77 7320 686f 7720 746f 2073 7461  shows how to sta
+00013fd0: 7274 2061 2063 6174 6368 2d75 7020 7375  rt a catch-up su
+00013fe0: 6273 6372 6970 7469 6f6e 2074 6861 7420  bscription that 
+00013ff0: 7374 6172 7473 0a66 726f 6d20 7468 6520  starts.from the 
+00014000: 6669 7273 7420 7265 636f 7264 6564 2065  first recorded e
+00014010: 7665 6e74 2069 6e20 7468 6520 6461 7461  vent in the data
+00014020: 6261 7365 2e0a 0a60 6060 7079 7468 6f6e  base...```python
+00014030: 0a23 2053 7562 7363 7269 6265 2066 726f  .# Subscribe fro
+00014040: 6d20 7468 6520 6669 7273 7420 7265 636f  m the first reco
+00014050: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
+00014060: 6520 6461 7461 6261 7365 2e0a 6361 7463  e database..catc
+00014070: 6875 705f 7375 6273 6372 6970 7469 6f6e  hup_subscription
+00014080: 203d 2063 6c69 656e 742e 7375 6273 6372   = client.subscr
+00014090: 6962 655f 746f 5f61 6c6c 2829 0a60 6060  ibe_to_all().```
+000140a0: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
+000140b0: 6c6f 7720 7368 6f77 7320 7468 6174 2063  low shows that c
+000140c0: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+000140d0: 7469 6f6e 7320 646f 206e 6f74 2073 746f  tions do not sto
+000140e0: 700a 6175 746f 6d61 7469 6361 6c6c 792c  p.automatically,
+000140f0: 2062 7574 2062 6c6f 636b 2077 6865 6e20   but block when 
+00014100: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
+00014110: 6420 6576 656e 7420 6973 2072 6563 6569  d event is recei
+00014120: 7665 642c 0a61 6e64 2074 6865 6e20 636f  ved,.and then co
+00014130: 6e74 696e 7565 2077 6865 6e20 7375 6273  ntinue when subs
+00014140: 6571 7565 6e74 2065 7665 6e74 7320 6172  equent events ar
+00014150: 6520 7265 636f 7264 6564 2e0a 0a60 6060  e recorded...```
+00014160: 7079 7468 6f6e 0a66 726f 6d20 7469 6d65  python.from time
+00014170: 2069 6d70 6f72 7420 736c 6565 700a 6672   import sleep.fr
+00014180: 6f6d 2074 6872 6561 6469 6e67 2069 6d70  om threading imp
+00014190: 6f72 7420 5468 7265 6164 0a0a 0a23 2041  ort Thread...# A
+000141a0: 7070 656e 6420 6120 6e65 7720 6576 656e  ppend a new even
+000141b0: 7420 746f 2061 206e 6577 2073 7472 6561  t to a new strea
+000141c0: 6d2e 0a73 7472 6561 6d5f 6e61 6d65 3220  m..stream_name2 
+000141d0: 3d20 7374 7228 7575 6964 2e75 7569 6434  = str(uuid.uuid4
+000141e0: 2829 290a 6576 656e 7434 203d 204e 6577  ()).event4 = New
+000141f0: 4576 656e 7428 7479 7065 3d27 4f72 6465  Event(type='Orde
+00014200: 7243 7265 6174 6564 272c 2064 6174 613d  rCreated', data=
+00014210: 6227 7b7d 2729 0a0a 636c 6965 6e74 2e61  b'{}')..client.a
+00014220: 7070 656e 645f 746f 5f73 7472 6561 6d28  ppend_to_stream(
+00014230: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+00014240: 3d73 7472 6561 6d5f 6e61 6d65 322c 0a20  =stream_name2,. 
+00014250: 2020 2063 7572 7265 6e74 5f76 6572 7369     current_versi
+00014260: 6f6e 3d53 7472 6561 6d53 7461 7465 2e4e  on=StreamState.N
+00014270: 4f5f 5354 5245 414d 2c0a 2020 2020 6576  O_STREAM,.    ev
+00014280: 656e 7473 3d5b 6576 656e 7434 5d2c 0a29  ents=[event4],.)
+00014290: 0a0a 0a23 2052 6563 6569 7665 2065 7665  ...# Receive eve
+000142a0: 6e74 7320 6672 6f6d 2074 6865 2063 6174  nts from the cat
+000142b0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+000142c0: 6f6e 2069 6e20 6120 6469 6666 6572 656e  on in a differen
+000142d0: 7420 7468 7265 6164 2e0a 7265 6365 6976  t thread..receiv
+000142e0: 6564 5f65 7665 6e74 7320 3d20 5b5d 0a0a  ed_events = []..
+000142f0: 6465 6620 7265 6365 6976 655f 6576 656e  def receive_even
+00014300: 7473 2829 3a0a 2020 2020 666f 7220 6576  ts():.    for ev
+00014310: 656e 7420 696e 2063 6174 6368 7570 5f73  ent in catchup_s
+00014320: 7562 7363 7269 7074 696f 6e3a 0a20 2020  ubscription:.   
+00014330: 2020 2020 2072 6563 6569 7665 645f 6576       received_ev
+00014340: 656e 7473 2e61 7070 656e 6428 6576 656e  ents.append(even
+00014350: 7429 0a0a 0a64 6566 2077 6169 745f 666f  t)...def wait_fo
+00014360: 725f 6576 656e 7428 6576 656e 7429 3a0a  r_event(event):.
+00014370: 2020 2020 666f 7220 5f20 696e 2072 616e      for _ in ran
+00014380: 6765 2831 3030 293a 0a20 2020 2020 2020  ge(100):.       
+00014390: 2066 6f72 2072 6563 6569 7665 6420 696e   for received in
+000143a0: 2072 6576 6572 7365 6428 7265 6365 6976   reversed(receiv
+000143b0: 6564 5f65 7665 6e74 7329 3a0a 2020 2020  ed_events):.    
+000143c0: 2020 2020 2020 2020 6966 2065 7665 6e74          if event
+000143d0: 203d 3d20 7265 6365 6976 6564 3a0a 2020   == received:.  
+000143e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000143f0: 7475 726e 0a20 2020 2020 2020 2065 6c73  turn.        els
+00014400: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00014410: 6c65 6570 2830 2e31 290a 2020 2020 656c  leep(0.1).    el
+00014420: 7365 3a0a 2020 2020 2020 2020 7261 6973  se:.        rais
+00014430: 6520 4173 7365 7274 696f 6e45 7272 6f72  e AssertionError
+00014440: 2822 4576 656e 7420 7761 736e 2774 2072  ("Event wasn't r
+00014450: 6563 6569 7665 6422 290a 0a0a 7468 7265  eceived")...thre
+00014460: 6164 203d 2054 6872 6561 6428 7461 7267  ad = Thread(targ
+00014470: 6574 3d72 6563 6569 7665 5f65 7665 6e74  et=receive_event
+00014480: 732c 2064 6165 6d6f 6e3d 5472 7565 290a  s, daemon=True).
+00014490: 7468 7265 6164 2e73 7461 7274 2829 0a0a  thread.start()..
+000144a0: 2320 5761 6974 2074 6f20 7265 6365 6976  # Wait to receiv
+000144b0: 6520 6576 656e 7434 2e0a 7761 6974 5f66  e event4..wait_f
+000144c0: 6f72 5f65 7665 6e74 2865 7665 6e74 3429  or_event(event4)
+000144d0: 0a0a 2320 4170 7065 6e64 2061 6e6f 7468  ..# Append anoth
+000144e0: 6572 2065 7665 6e74 2077 6869 6c73 7420  er event whilst 
+000144f0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00014500: 2069 7320 7275 6e6e 696e 672e 0a65 7665   is running..eve
+00014510: 6e74 3520 3d20 4e65 7745 7665 6e74 2874  nt5 = NewEvent(t
+00014520: 7970 653d 274f 7264 6572 5570 6461 7465  ype='OrderUpdate
+00014530: 6427 2c20 6461 7461 3d62 277b 7d27 290a  d', data=b'{}').
+00014540: 636c 6965 6e74 2e61 7070 656e 645f 746f  client.append_to
+00014550: 5f73 7472 6561 6d28 0a20 2020 2073 7472  _stream(.    str
+00014560: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+00014570: 6e61 6d65 322c 0a20 2020 2063 7572 7265  name2,.    curre
+00014580: 6e74 5f76 6572 7369 6f6e 3d30 2c0a 2020  nt_version=0,.  
+00014590: 2020 6576 656e 7473 3d5b 6576 656e 7435    events=[event5
+000145a0: 5d2c 0a29 0a0a 2320 5761 6974 2066 6f72  ],.)..# Wait for
+000145b0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+000145c0: 6e20 746f 2062 6c6f 636b 2e0a 7761 6974  n to block..wait
+000145d0: 5f66 6f72 5f65 7665 6e74 2865 7665 6e74  _for_event(event
+000145e0: 3529 0a0a 2320 5374 6f70 2074 6865 2073  5)..# Stop the s
+000145f0: 7562 7363 7269 7074 696f 6e2e 0a63 6174  ubscription..cat
+00014600: 6368 7570 5f73 7562 7363 7269 7074 696f  chup_subscriptio
+00014610: 6e2e 7374 6f70 2829 0a74 6872 6561 642e  n.stop().thread.
+00014620: 6a6f 696e 2829 0a60 6060 0a0a 5468 6520  join().```..The 
+00014630: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
+00014640: 6f77 7320 686f 7720 746f 2073 7562 7363  ows how to subsc
+00014650: 7269 6265 2074 6f20 6576 656e 7473 2072  ribe to events r
+00014660: 6563 6f72 6465 6420 6166 7465 7220 610a  ecorded after a.
+00014670: 7061 7274 6963 756c 6172 2063 6f6d 6d69  particular commi
+00014680: 7420 706f 7369 7469 6f6e 2c20 696e 2074  t position, in t
+00014690: 6869 7320 6361 7365 2066 726f 6d20 7468  his case from th
+000146a0: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+000146b0: 6e20 6f66 0a74 6865 206c 6173 7420 7265  n of.the last re
+000146c0: 636f 7264 6564 2065 7665 6e74 2074 6861  corded event tha
+000146d0: 7420 7761 7320 7265 6365 6976 6564 2061  t was received a
+000146e0: 626f 7665 2e20 5468 656e 2c20 616e 6f74  bove. Then, anot
+000146f0: 6865 7220 6576 656e 7420 6973 0a72 6563  her event is.rec
+00014700: 6f72 6465 6420 6265 666f 7265 2074 6865  orded before the
+00014710: 2073 7562 7363 7269 7074 696f 6e20 6973   subscription is
+00014720: 2072 6573 7461 7274 6564 2e20 416e 6420   restarted. And 
+00014730: 7468 7265 6520 6d6f 7265 2065 7665 6e74  three more event
+00014740: 7320 6172 650a 7265 636f 7264 6564 2077  s are.recorded w
+00014750: 6869 6c73 7420 7468 6520 7375 6273 6372  hilst the subscr
+00014760: 6970 7469 6f6e 2069 7320 7275 6e6e 696e  iption is runnin
+00014770: 672e 2054 6865 7365 2066 6f75 7220 6576  g. These four ev
+00014780: 656e 7473 2061 7265 0a72 6563 6569 7665  ents are.receive
+00014790: 6420 696e 2074 6865 206f 7264 6572 2074  d in the order t
+000147a0: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
+000147b0: 642e 0a0a 0a60 6060 7079 7468 6f6e 0a0a  d....```python..
+000147c0: 2320 4170 7065 6e64 2061 6e6f 7468 6572  # Append another
+000147d0: 2065 7665 6e74 2e0a 6576 656e 7436 203d   event..event6 =
+000147e0: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
+000147f0: 4f72 6465 7244 656c 6574 6564 272c 2064  OrderDeleted', d
+00014800: 6174 613d 6227 7b7d 2729 0a63 6c69 656e  ata=b'{}').clien
+00014810: 742e 6170 7065 6e64 5f74 6f5f 7374 7265  t.append_to_stre
+00014820: 616d 280a 2020 2020 7374 7265 616d 5f6e  am(.    stream_n
+00014830: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+00014840: 2c0a 2020 2020 6375 7272 656e 745f 7665  ,.    current_ve
+00014850: 7273 696f 6e3d 312c 0a20 2020 2065 7665  rsion=1,.    eve
+00014860: 6e74 733d 5b65 7665 6e74 365d 2c0a 290a  nts=[event6],.).
+00014870: 0a23 2052 6573 7461 7274 2073 7562 7363  .# Restart subsc
+00014880: 7269 6269 6e67 2074 6f20 616c 6c20 6576  ribing to all ev
+00014890: 656e 7473 2061 6674 6572 2074 6865 0a23  ents after the.#
+000148a0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+000148b0: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
+000148c0: 6569 7665 6420 6576 656e 742e 0a63 6174  eived event..cat
+000148d0: 6368 7570 5f73 7562 7363 7269 7074 696f  chup_subscriptio
+000148e0: 6e20 3d20 636c 6965 6e74 2e73 7562 7363  n = client.subsc
+000148f0: 7269 6265 5f74 6f5f 616c 6c28 0a20 2020  ribe_to_all(.   
+00014900: 2063 6f6d 6d69 745f 706f 7369 7469 6f6e   commit_position
+00014910: 3d72 6563 6569 7665 645f 6576 656e 7473  =received_events
+00014920: 5b2d 315d 2e63 6f6d 6d69 745f 706f 7369  [-1].commit_posi
+00014930: 7469 6f6e 0a29 0a0a 7468 7265 6164 203d  tion.)..thread =
+00014940: 2054 6872 6561 6428 7461 7267 6574 3d72   Thread(target=r
+00014950: 6563 6569 7665 5f65 7665 6e74 732c 2064  eceive_events, d
+00014960: 6165 6d6f 6e3d 5472 7565 290a 7468 7265  aemon=True).thre
+00014970: 6164 2e73 7461 7274 2829 0a0a 2320 5761  ad.start()..# Wa
+00014980: 6974 2066 6f72 2065 7665 6e74 362e 0a77  it for event6..w
+00014990: 6169 745f 666f 725f 6576 656e 7428 6576  ait_for_event(ev
+000149a0: 656e 7436 290a 0a23 2041 7070 656e 6420  ent6)..# Append 
+000149b0: 7468 7265 6520 6d6f 7265 2065 7665 6e74  three more event
+000149c0: 7320 746f 2061 206e 6577 2073 7472 6561  s to a new strea
+000149d0: 6d2e 0a73 7472 6561 6d5f 6e61 6d65 3320  m..stream_name3 
+000149e0: 3d20 7374 7228 7575 6964 2e75 7569 6434  = str(uuid.uuid4
+000149f0: 2829 290a 6576 656e 7437 203d 204e 6577  ()).event7 = New
+00014a00: 4576 656e 7428 7479 7065 3d27 4f72 6465  Event(type='Orde
+00014a10: 7243 7265 6174 6564 272c 2064 6174 613d  rCreated', data=
+00014a20: 6227 7b7d 2729 0a65 7665 6e74 3820 3d20  b'{}').event8 = 
+00014a30: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+00014a40: 7264 6572 5570 6461 7465 6427 2c20 6461  rderUpdated', da
+00014a50: 7461 3d62 277b 7d27 290a 6576 656e 7439  ta=b'{}').event9
+00014a60: 203d 204e 6577 4576 656e 7428 7479 7065   = NewEvent(type
+00014a70: 3d27 4f72 6465 7244 656c 6574 6564 272c  ='OrderDeleted',
+00014a80: 2064 6174 613d 6227 7b7d 2729 0a0a 636c   data=b'{}')..cl
+00014a90: 6965 6e74 2e61 7070 656e 645f 746f 5f73  ient.append_to_s
+00014aa0: 7472 6561 6d28 0a20 2020 2073 7472 6561  tream(.    strea
+00014ab0: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00014ac0: 6d65 332c 0a20 2020 2063 7572 7265 6e74  me3,.    current
+00014ad0: 5f76 6572 7369 6f6e 3d53 7472 6561 6d53  _version=StreamS
+00014ae0: 7461 7465 2e4e 4f5f 5354 5245 414d 2c0a  tate.NO_STREAM,.
+00014af0: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
+00014b00: 7437 2c20 6576 656e 7438 2c20 6576 656e  t7, event8, even
+00014b10: 7439 5d2c 0a29 0a0a 2320 5761 6974 2066  t9],.)..# Wait f
+00014b20: 6f72 2065 7665 6e74 7320 372c 2038 2061  or events 7, 8 a
+00014b30: 6e64 2039 2e0a 7761 6974 5f66 6f72 5f65  nd 9..wait_for_e
+00014b40: 7665 6e74 2865 7665 6e74 3729 0a77 6169  vent(event7).wai
+00014b50: 745f 666f 725f 6576 656e 7428 6576 656e  t_for_event(even
+00014b60: 7438 290a 7761 6974 5f66 6f72 5f65 7665  t8).wait_for_eve
+00014b70: 6e74 2865 7665 6e74 3929 0a0a 2320 5374  nt(event9)..# St
+00014b80: 6f70 2074 6865 2073 7562 7363 7269 7074  op the subscript
+00014b90: 696f 6e2e 0a63 6174 6368 7570 5f73 7562  ion..catchup_sub
+00014ba0: 7363 7269 7074 696f 6e2e 7374 6f70 2829  scription.stop()
+00014bb0: 0a74 6872 6561 642e 6a6f 696e 2829 0a60  .thread.join().`
+00014bc0: 6060 0a0a 5468 6520 6361 7463 682d 7570  ``..The catch-up
+00014bd0: 2073 7562 7363 7269 7074 696f 6e20 6361   subscription ca
+00014be0: 6c6c 2069 7320 656e 6465 6420 6173 2073  ll is ended as s
+00014bf0: 6f6f 6e20 6173 2074 6865 2073 7562 7363  oon as the subsc
+00014c00: 7269 7074 696f 6e20 6f62 6a65 6374 2773  ription object's
+00014c10: 0a60 7374 6f70 2829 6020 6d65 7468 6f64  .`stop()` method
+00014c20: 2069 7320 6361 6c6c 6564 2e20 5468 6973   is called. This
+00014c30: 2068 6170 7065 6e73 2061 7574 6f6d 6174   happens automat
+00014c40: 6963 616c 6c79 2077 6865 6e20 6974 2067  ically when it g
+00014c50: 6f65 7320 6f75 7420 6f66 2073 636f 7065  oes out of scope
+00014c60: 2c0a 6f72 2077 6865 6e20 6974 2069 7320  ,.or when it is 
+00014c70: 6578 706c 6963 6974 6c79 2064 656c 6574  explicitly delet
+00014c80: 6564 2066 726f 6d20 6d65 6d6f 7279 2075  ed from memory u
+00014c90: 7369 6e67 2074 6865 2050 7974 686f 6e20  sing the Python 
+00014ca0: 6064 656c 6020 6b65 7977 6f72 642e 0a0a  `del` keyword...
+00014cb0: 2323 2320 5375 6273 6372 6962 6520 746f  ### Subscribe to
+00014cc0: 2073 7472 6561 6d20 6576 656e 7473 3c61   stream events<a
+00014cd0: 2069 643d 2273 7562 7363 7269 6265 2d74   id="subscribe-t
+00014ce0: 6f2d 7374 7265 616d 2d65 7665 6e74 7322  o-stream-events"
+00014cf0: 3e3c 2f61 3e0a 0a54 6865 2060 7375 6273  ></a>..The `subs
+00014d00: 6372 6962 655f 746f 5f73 7472 6561 6d28  cribe_to_stream(
+00014d10: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+00014d20: 2075 7365 6420 746f 2073 7461 7274 2061   used to start a
+00014d30: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
+00014d40: 6970 7469 6f6e 0a66 726f 6d20 7768 6963  iption.from whic
+00014d50: 6820 6576 656e 7473 2072 6563 6f72 6465  h events recorde
+00014d60: 6420 696e 2061 2073 696e 676c 6520 7374  d in a single st
+00014d70: 7265 616d 2063 616e 2062 6520 6f62 7461  ream can be obta
+00014d80: 696e 6564 2e20 5468 6973 206d 6574 686f  ined. This metho
+00014d90: 640a 7265 7475 726e 7320 6120 2263 6174  d.returns a "cat
+00014da0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00014db0: 6f6e 2220 6974 6572 6174 6f72 2e0a 0a54  on" iterator...T
+00014dc0: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
+00014dd0: 2072 6571 7569 7265 6420 6073 7472 6561   required `strea
+00014de0: 6d5f 6e61 6d65 6020 6172 6775 6d65 6e74  m_name` argument
+00014df0: 2c20 7768 6963 6820 7370 6563 6966 6965  , which specifie
+00014e00: 7320 7468 6520 6e61 6d65 206f 6620 7468  s the name of th
+00014e10: 650a 7374 7265 616d 2066 726f 6d20 7768  e.stream from wh
+00014e20: 6963 6820 7265 636f 7264 6564 2065 7665  ich recorded eve
+00014e30: 6e74 7320 7769 6c6c 2062 6520 7265 6365  nts will be rece
+00014e40: 6976 6564 2e0a 0a54 6869 7320 6d65 7468  ived...This meth
+00014e50: 6f64 2061 6c73 6f20 6861 7320 7369 7820  od also has six 
+00014e60: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+00014e70: 7473 2c20 6073 7472 6561 6d5f 706f 7369  ts, `stream_posi
+00014e80: 7469 6f6e 602c 2060 6672 6f6d 5f65 6e64  tion`, `from_end
+00014e90: 602c 0a60 7265 736f 6c76 655f 6c69 6e6b  `,.`resolve_link
+00014ea0: 7360 2c20 6069 6e63 6c75 6465 5f63 6175  s`, `include_cau
+00014eb0: 6768 745f 7570 602c 2060 7469 6d65 6f75  ght_up`, `timeou
+00014ec0: 7460 2061 6e64 2060 6372 6564 656e 7469  t` and `credenti
+00014ed0: 616c 7360 2e0a 0a54 6865 206f 7074 696f  als`...The optio
+00014ee0: 6e61 6c20 6073 7472 6561 6d5f 706f 7369  nal `stream_posi
+00014ef0: 7469 6f6e 6020 6172 6775 6d65 6e74 2073  tion` argument s
+00014f00: 7065 6369 6669 6573 2061 2070 6f73 6974  pecifies a posit
+00014f10: 696f 6e20 696e 2074 6865 2073 7472 6561  ion in the strea
+00014f20: 6d20 6672 6f6d 0a77 6869 6368 2074 6f20  m from.which to 
+00014f30: 7374 6172 7420 7375 6273 6372 6962 696e  start subscribin
+00014f40: 672e 2054 6865 2064 6566 6175 6c74 2076  g. The default v
+00014f50: 616c 7565 206f 6620 6073 7472 6561 6d5f  alue of `stream_
+00014f60: 706f 7369 7469 6f6e 6020 6973 2060 4e6f  position` is `No
+00014f70: 6e65 602c 0a77 6869 6368 206d 6561 6e73  ne`,.which means
+00014f80: 2074 6861 7420 616c 6c20 6576 656e 7473   that all events
+00014f90: 2072 6563 6f72 6465 6420 696e 2074 6865   recorded in the
+00014fa0: 2073 7472 6561 6d20 7769 6c6c 2062 6520   stream will be 
+00014fb0: 6f62 7461 696e 6564 2069 6e20 7468 650a  obtained in the.
+00014fc0: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
+00014fd0: 7265 636f 7264 6564 2c20 756e 6c65 7373  recorded, unless
+00014fe0: 2060 6672 6f6d 5f65 6e64 6020 6973 2073   `from_end` is s
+00014ff0: 6574 2074 6f20 6054 7275 6560 2e20 4966  et to `True`. If
+00015000: 2061 2073 7472 6561 6d0a 706f 7369 7469   a stream.positi
+00015010: 6f6e 2069 7320 6769 7665 6e2c 2074 6865  on is given, the
+00015020: 6e20 6f6e 6c79 2065 7665 6e74 7320 7265  n only events re
+00015030: 636f 7264 6564 2061 6674 6572 2074 6861  corded after tha
+00015040: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+00015050: 6265 206f 6274 6169 6e65 642e 0a0a 5468  be obtained...Th
+00015060: 6520 6f70 7469 6f6e 616c 2060 6672 6f6d  e optional `from
+00015070: 5f65 6e64 6020 6172 6775 6d65 6e74 2073  _end` argument s
+00015080: 7065 6369 6669 6573 2074 6861 7420 7468  pecifies that th
+00015090: 6520 7375 6273 6372 6970 7469 6f6e 2077  e subscription w
+000150a0: 696c 6c20 7374 6172 740a 6672 6f6d 2074  ill start.from t
+000150b0: 6865 206c 6173 7420 706f 7369 7469 6f6e  he last position
+000150c0: 2069 6e20 7468 6520 7374 7265 616d 2e20   in the stream. 
+000150d0: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+000150e0: 6520 6f66 2060 6672 6f6d 5f65 6e64 6020  e of `from_end` 
+000150f0: 6973 2060 4661 6c73 6560 2e0a 4966 2060  is `False`..If `
+00015100: 6672 6f6d 5f65 6e64 6020 6973 2060 5472  from_end` is `Tr
+00015110: 7565 602c 2074 6865 6e20 6f6e 6c79 2065  ue`, then only e
+00015120: 7665 6e74 7320 7265 636f 7264 6564 2061  vents recorded a
+00015130: 6674 6572 2074 6865 2073 7562 7363 7269  fter the subscri
+00015140: 7074 696f 6e20 7761 730a 6372 6561 7465  ption was.create
+00015150: 6420 7769 6c6c 2062 6520 6f62 7461 696e  d will be obtain
+00015160: 6564 2e20 5468 6973 2061 7267 756d 656e  ed. This argumen
+00015170: 7420 6966 2069 676e 6f72 6564 2069 7320  t if ignored is 
+00015180: 6073 7472 6561 6d5f 706f 7369 7469 6f6e  `stream_position
+00015190: 6020 6973 2073 6574 2e0a 0a54 6865 206f  ` is set...The o
+000151a0: 7074 696f 6e61 6c20 6072 6573 6f6c 7665  ptional `resolve
+000151b0: 5f6c 696e 6b73 6020 6172 6775 6d65 6e74  _links` argument
+000151c0: 2069 7320 6120 5079 7468 6f6e 2060 626f   is a Python `bo
+000151d0: 6f6c 602e 2054 6865 2064 6566 6175 6c74  ol`. The default
+000151e0: 2076 616c 7565 206f 6620 6072 6573 6f6c   value of `resol
+000151f0: 7665 5f6c 696e 6b73 600a 6973 2060 4661  ve_links`.is `Fa
+00015200: 6c73 6560 2c20 7768 6963 6820 6d65 616e  lse`, which mean
+00015210: 7320 616e 7920 6576 656e 7420 6c69 6e6b  s any event link
+00015220: 7320 7769 6c6c 206e 6f74 2062 6520 7265  s will not be re
+00015230: 736f 6c76 6564 2c20 736f 2074 6861 7420  solved, so that 
+00015240: 7468 6520 6576 656e 7473 2074 6861 7420  the events that 
+00015250: 6172 650a 7265 7475 726e 6564 206d 6179  are.returned may
+00015260: 2072 6570 7265 7365 6e74 2065 7665 6e74   represent event
+00015270: 206c 696e 6b73 2e20 4966 2060 7265 736f   links. If `reso
+00015280: 6c76 655f 6c69 6e6b 7360 2069 7320 6054  lve_links` is `T
+00015290: 7275 6560 2c20 616e 7920 6576 656e 7420  rue`, any event 
+000152a0: 6c69 6e6b 7320 7769 6c6c 0a62 6520 7265  links will.be re
+000152b0: 736f 6c76 6564 2c20 736f 2074 6861 7420  solved, so that 
+000152c0: 7468 6520 6c69 6e6b 6564 2065 7665 6e74  the linked event
+000152d0: 7320 7769 6c6c 2062 6520 7265 7475 726e  s will be return
+000152e0: 6564 2069 6e73 7465 6164 206f 6620 7468  ed instead of th
+000152f0: 6520 6576 656e 7420 6c69 6e6b 732e 0a0a  e event links...
+00015300: 5468 6520 6f70 7469 6f6e 616c 2060 696e  The optional `in
+00015310: 636c 7564 655f 6361 7567 6874 5f75 7060  clude_caught_up`
+00015320: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00015330: 7974 686f 6e20 6062 6f6f 6c60 2077 6869  ython `bool` whi
+00015340: 6368 2069 6e64 6963 6174 6573 0a77 6865  ch indicates.whe
+00015350: 7468 6572 2022 6361 7567 6874 2075 7022  ther "caught up"
+00015360: 206d 6573 7361 6765 7320 7368 6f75 6c64   messages should
+00015370: 2062 6520 696e 636c 7564 6564 2077 6865   be included whe
+00015380: 6e20 7265 636f 7264 6564 2065 7665 6e74  n recorded event
+00015390: 7320 6172 650a 7265 6365 6976 6564 2e20  s are.received. 
+000153a0: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+000153b0: 6520 6f66 2060 696e 636c 7564 655f 6361  e of `include_ca
+000153c0: 7567 6874 5f75 7060 2069 7320 6046 616c  ught_up` is `Fal
+000153d0: 7365 602e 0a0a 5468 6520 6f70 7469 6f6e  se`...The option
+000153e0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+000153f0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+00015400: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
+00015410: 7365 7473 2061 0a6d 6178 696d 756d 2064  sets a.maximum d
+00015420: 7572 6174 696f 6e2c 2069 6e20 7365 636f  uration, in seco
+00015430: 6e64 732c 2066 6f72 2074 6865 2063 6f6d  nds, for the com
+00015440: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+00015450: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+00015460: 5468 6520 6f70 7469 6f6e 616c 2060 6372  The optional `cr
+00015470: 6564 656e 7469 616c 7360 2061 7267 756d  edentials` argum
+00015480: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
+00015490: 746f 0a6f 7665 7272 6964 6520 6361 6c6c  to.override call
+000154a0: 2063 7265 6465 6e74 6961 6c73 2064 6572   credentials der
+000154b0: 6976 6564 2066 726f 6d20 7468 6520 636f  ived from the co
+000154c0: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+000154d0: 5552 492e 0a0a 5468 6520 6578 616d 706c  URI...The exampl
+000154e0: 6520 6265 6c6f 7720 7368 6f77 7320 686f  e below shows ho
+000154f0: 7720 746f 2073 7461 7274 2061 2063 6174  w to start a cat
+00015500: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00015510: 6f6e 2066 726f 6d0a 7468 6520 6669 7273  on from.the firs
+00015520: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
+00015530: 2069 6e20 6120 7374 7265 616d 2e0a 0a60   in a stream...`
+00015540: 6060 7079 7468 6f6e 0a23 2053 7562 7363  ``python.# Subsc
+00015550: 7269 6265 2066 726f 6d20 7468 6520 7374  ribe from the st
+00015560: 6172 7420 6f66 2027 7374 7265 616d 3227  art of 'stream2'
+00015570: 2e0a 7375 6273 6372 6970 7469 6f6e 203d  ..subscription =
+00015580: 2063 6c69 656e 742e 7375 6273 6372 6962   client.subscrib
+00015590: 655f 746f 5f73 7472 6561 6d28 7374 7265  e_to_stream(stre
+000155a0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+000155b0: 616d 6532 290a 6060 600a 0a54 6865 2065  ame2).```..The e
+000155c0: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
+000155d0: 7773 2068 6f77 2074 6f20 7374 6172 7420  ws how to start 
+000155e0: 6120 6361 7463 682d 7570 2073 7562 7363  a catch-up subsc
+000155f0: 7269 7074 696f 6e20 6672 6f6d 0a61 2070  ription from.a p
+00015600: 6172 7469 6375 6c61 7220 7374 7265 616d  articular stream
+00015610: 2070 6f73 6974 696f 6e2e 0a0a 6060 6070   position...```p
+00015620: 7974 686f 6e0a 2320 5375 6273 6372 6962  ython.# Subscrib
+00015630: 6520 746f 2073 7472 6561 6d32 2c20 6672  e to stream2, fr
+00015640: 6f6d 2074 6865 2073 6563 6f6e 6420 7265  om the second re
+00015650: 636f 7264 6564 2065 7665 6e74 2e0a 7375  corded event..su
+00015660: 6273 6372 6970 7469 6f6e 203d 2063 6c69  bscription = cli
+00015670: 656e 742e 7375 6273 6372 6962 655f 746f  ent.subscribe_to
+00015680: 5f73 7472 6561 6d28 0a20 2020 2073 7472  _stream(.    str
+00015690: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+000156a0: 6e61 6d65 322c 0a20 2020 2073 7472 6561  name2,.    strea
+000156b0: 6d5f 706f 7369 7469 6f6e 3d31 2c0a 290a  m_position=1,.).
+000156c0: 6060 600a 0a23 2323 2048 6f77 2074 6f20  ```..### How to 
+000156d0: 696d 706c 656d 656e 7420 6578 6163 746c  implement exactl
+000156e0: 792d 6f6e 6365 2065 7665 6e74 2070 726f  y-once event pro
+000156f0: 6365 7373 696e 673c 6120 6964 3d22 686f  cessing<a id="ho
+00015700: 772d 746f 2d69 6d70 6c65 6d65 6e74 2d65  w-to-implement-e
+00015710: 7861 6374 6c79 2d6f 6e63 652d 6576 656e  xactly-once-even
+00015720: 742d 7072 6f63 6573 7369 6e67 223e 3c2f  t-processing"></
+00015730: 613e 0a0a 5468 6520 636f 6d6d 6974 2070  a>..The commit p
+00015740: 6f73 6974 696f 6e73 206f 6620 7265 636f  ositions of reco
+00015750: 7264 6564 2065 7665 6e74 7320 7468 6174  rded events that
+00015760: 2061 7265 2072 6563 6569 7665 6420 616e   are received an
+00015770: 6420 7072 6f63 6573 7365 6420 6279 2061  d processed by a
+00015780: 0a64 6f77 6e73 7472 6561 6d20 636f 6d70  .downstream comp
+00015790: 6f6e 656e 7420 6172 6520 7573 6566 756c  onent are useful
+000157a0: 6c79 2072 6563 6f72 6465 6420 6279 2074  ly recorded by t
+000157b0: 6865 2064 6f77 6e73 7472 6561 6d20 636f  he downstream co
+000157c0: 6d70 6f6e 656e 742c 2073 6f20 7468 6174  mponent, so that
+000157d0: 0a74 6865 2063 6f6d 6d69 7420 706f 7369  .the commit posi
+000157e0: 7469 6f6e 206f 6620 6c61 7374 2070 726f  tion of last pro
+000157f0: 6365 7373 6564 2065 7665 6e74 2063 616e  cessed event can
+00015800: 2062 6520 6465 7465 726d 696e 6564 2077   be determined w
+00015810: 6865 6e20 7072 6f63 6573 7369 6e67 2069  hen processing i
+00015820: 730a 7265 7375 6d65 642e 0a0a 5468 6520  s.resumed...The 
+00015830: 6c61 7374 2072 6563 6f72 6465 6420 636f  last recorded co
+00015840: 6d6d 6974 2070 6f73 6974 696f 6e20 6361  mmit position ca
+00015850: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
+00015860: 6369 6679 2074 6865 2063 6f6d 6d69 7420  cify the commit 
+00015870: 706f 7369 7469 6f6e 2066 726f 6d20 7768  position from wh
+00015880: 6963 680a 746f 2073 7562 7363 7269 6265  ich.to subscribe
+00015890: 2077 6865 6e20 7072 6f63 6573 7369 6e67   when processing
+000158a0: 2069 7320 7265 7375 6d65 642e 2053 696e   is resumed. Sin
+000158b0: 6365 2074 6869 7320 636f 6d6d 6974 2070  ce this commit p
+000158c0: 6f73 6974 696f 6e20 7769 6c6c 2072 6570  osition will rep
+000158d0: 7265 7365 6e74 2074 6865 0a70 6f73 6974  resent the.posit
+000158e0: 696f 6e20 6f66 2074 6865 206c 6173 7420  ion of the last 
+000158f0: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
+00015900: 6365 7373 6564 2065 7665 6e74 2069 6e20  cessed event in 
+00015910: 6120 646f 776e 7374 7265 616d 2063 6f6d  a downstream com
+00015920: 706f 6e65 6e74 2c20 736f 2069 740a 7769  ponent, so it.wi
+00015930: 6c6c 2062 6520 7573 7561 6c20 746f 2077  ll be usual to w
+00015940: 616e 7420 7468 6520 6e65 7874 2065 7665  ant the next eve
+00015950: 6e74 2061 6674 6572 2074 6869 7320 706f  nt after this po
+00015960: 7369 7469 6f6e 2c20 6265 6361 7573 6520  sition, because 
+00015970: 7468 6174 2069 7320 7468 6520 6e65 7874  that is the next
+00015980: 0a65 7665 6e74 2074 6861 7420 6861 7320  .event that has 
+00015990: 6e6f 7420 7965 7420 6265 656e 2070 726f  not yet been pro
+000159a0: 6365 7373 6564 2e20 466f 7220 7468 6973  cessed. For this
+000159b0: 2072 6561 736f 6e2c 2077 6865 6e20 7375   reason, when su
+000159c0: 6273 6372 6962 696e 6720 666f 7220 6576  bscribing for ev
+000159d0: 656e 7473 0a66 726f 6d20 6120 7370 6563  ents.from a spec
+000159e0: 6966 6963 2063 6f6d 6d69 7420 706f 7369  ific commit posi
+000159f0: 7469 6f6e 2075 7369 6e67 2061 2063 6174  tion using a cat
+00015a00: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00015a10: 6f6e 2069 6e20 4576 656e 7453 746f 7265  on in EventStore
+00015a20: 4442 2c20 7468 650a 7265 636f 7264 6564  DB, the.recorded
+00015a30: 2065 7665 6e74 2061 7420 7468 6520 7370   event at the sp
+00015a40: 6563 6966 6965 6420 636f 6d6d 6974 2070  ecified commit p
+00015a50: 6f73 6974 696f 6e20 7769 6c6c 204e 4f54  osition will NOT
+00015a60: 2062 6520 696e 636c 7564 6564 2069 6e20   be included in 
+00015a70: 7468 6520 7365 7175 656e 6365 0a6f 6620  the sequence.of 
+00015a80: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
+00015a90: 7468 6174 2061 7265 2072 6563 6569 7665  that are receive
+00015aa0: 642e 0a0a 546f 2061 6363 6f6d 706c 6973  d...To accomplis
+00015ab0: 6820 2265 7861 6374 6c79 2d6f 6e63 6522  h "exactly-once"
+00015ac0: 2070 726f 6365 7373 696e 6720 6f66 2072   processing of r
+00015ad0: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
+00015ae0: 6e20 6120 646f 776e 7374 7265 616d 0a63  n a downstream.c
+00015af0: 6f6d 706f 6e65 6e74 2077 6865 6e20 7573  omponent when us
+00015b00: 696e 6720 6120 6361 7463 682d 7570 2073  ing a catch-up s
+00015b10: 7562 7363 7269 7074 696f 6e2c 2074 6865  ubscription, the
+00015b20: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+00015b30: 206f 6620 6120 7265 636f 7264 6564 0a65   of a recorded.e
+00015b40: 7665 6e74 2073 686f 756c 6420 6265 2072  vent should be r
+00015b50: 6563 6f72 6465 6420 6174 6f6d 6963 616c  ecorded atomical
+00015b60: 6c79 2061 6e64 2075 6e69 7175 656c 7920  ly and uniquely 
+00015b70: 616c 6f6e 6720 7769 7468 2074 6865 2072  along with the r
+00015b80: 6573 756c 7420 6f66 2070 726f 6365 7373  esult of process
+00015b90: 696e 670a 7265 636f 7264 6564 2065 7665  ing.recorded eve
+00015ba0: 6e74 732c 2066 6f72 2065 7861 6d70 6c65  nts, for example
+00015bb0: 2069 6e20 7468 6520 7361 6d65 2064 6174   in the same dat
+00015bc0: 6162 6173 6520 6173 206d 6174 6572 6961  abase as materia
+00015bd0: 6c69 7365 6420 7669 6577 7320 7768 656e  lised views when
+00015be0: 0a69 6d70 6c65 6d65 6e74 696e 6720 6576  .implementing ev
+00015bf0: 656e 7475 616c 6c79 2d63 6f6e 7369 7374  entually-consist
+00015c00: 656e 7420 4351 5253 2c20 6f72 2069 6e20  ent CQRS, or in 
+00015c10: 7468 6520 7361 6d65 2064 6174 6162 6173  the same databas
+00015c20: 6520 6173 2061 2064 6f77 6e73 7472 6561  e as a downstrea
+00015c30: 6d0a 616e 616c 7974 6963 7320 6f72 2072  m.analytics or r
+00015c40: 6570 6f72 7469 6e67 206f 7220 6172 6368  eporting or arch
+00015c50: 6976 696e 6720 6170 706c 6963 6174 696f  iving applicatio
+00015c60: 6e2e 2042 7920 7265 636f 7264 696e 6720  n. By recording 
+00015c70: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
+00015c80: 696f 6e0a 6f66 2072 6563 6f72 6465 6420  ion.of recorded 
+00015c90: 6576 656e 7473 2061 746f 6d69 6361 6c6c  events atomicall
+00015ca0: 7920 7769 7468 2074 6865 206e 6577 2073  y with the new s
+00015cb0: 7461 7465 2074 6861 7420 7265 7375 6c74  tate that result
+00015cc0: 7320 6672 6f6d 2070 726f 6365 7373 696e  s from processin
+00015cd0: 670a 7265 636f 7264 6564 2065 7665 6e74  g.recorded event
+00015ce0: 732c 2022 6475 616c 2077 7269 7469 6e67  s, "dual writing
+00015cf0: 2220 696e 2074 6865 2063 6f6e 7375 6d70  " in the consump
+00015d00: 7469 6f6e 206f 6620 7265 636f 7264 6564  tion of recorded
+00015d10: 2065 7665 6e74 7320 6361 6e20 6265 0a61   events can be.a
+00015d20: 766f 6964 6564 2e20 4279 2061 6c73 6f20  voided. By also 
+00015d30: 7265 636f 7264 696e 6720 7468 6520 636f  recording the co
+00015d40: 6d6d 6974 2070 6f73 6974 696f 6e20 756e  mmit position un
+00015d50: 6971 7565 6c79 2c20 7468 6520 6e65 7720  iquely, the new 
+00015d60: 7374 6174 6520 6361 6e6e 6f74 2062 650a  state cannot be.
+00015d70: 7265 636f 7264 6564 2074 7769 6365 2c20  recorded twice, 
+00015d80: 616e 6420 6865 6e63 6520 7468 6520 7265  and hence the re
+00015d90: 636f 7264 6564 2073 7461 7465 206f 6620  corded state of 
+00015da0: 7468 6520 646f 776e 7374 7265 616d 2063  the downstream c
+00015db0: 6f6d 706f 6e65 6e74 2077 696c 6c20 6265  omponent will be
+00015dc0: 0a75 7064 6174 6564 206f 6e6c 7920 6f6e  .updated only on
+00015dd0: 6365 2066 6f72 2061 6e79 2072 6563 6f72  ce for any recor
+00015de0: 6465 6420 6576 656e 742e 2042 7920 7573  ded event. By us
+00015df0: 696e 6720 7468 6520 6772 6561 7465 7374  ing the greatest
+00015e00: 2072 6563 6f72 6465 6420 636f 6d6d 6974   recorded commit
+00015e10: 0a70 6f73 6974 696f 6e20 746f 2072 6573  .position to res
+00015e20: 756d 6520 6120 6361 7463 682d 7570 2073  ume a catch-up s
+00015e30: 7562 7363 7269 7074 696f 6e2c 2061 6c6c  ubscription, all
+00015e40: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00015e50: 2077 696c 6c20 6576 656e 7475 616c 6c79   will eventually
+00015e60: 0a62 6520 7072 6f63 6573 7365 642e 2054  .be processed. T
+00015e70: 6865 2063 6f6d 6269 6e61 7469 6f6e 206f  he combination o
+00015e80: 6620 7468 6520 2261 742d 6d6f 7374 2d6f  f the "at-most-o
+00015e90: 6e63 6522 2063 6f6e 6469 7469 6f6e 2061  nce" condition a
+00015ea0: 6e64 2074 6865 2022 6174 2d6c 6561 7374  nd the "at-least
+00015eb0: 2d6f 6e63 6522 0a63 6f6e 6469 7469 6f6e  -once".condition
+00015ec0: 2067 6976 6573 2074 6865 2022 6578 6163   gives the "exac
+00015ed0: 746c 792d 6f6e 6365 2220 636f 6e64 6974  tly-once" condit
+00015ee0: 696f 6e2e 0a0a 5468 6520 6461 6e67 6572  ion...The danger
+00015ef0: 2077 6974 6820 2264 7561 6c20 7772 6974   with "dual writ
+00015f00: 696e 6722 2069 6e20 7468 6520 636f 6e73  ing" in the cons
+00015f10: 756d 7074 696f 6e20 6f66 2072 6563 6f72  umption of recor
+00015f20: 6465 6420 6576 656e 7473 2069 7320 7468  ded events is th
+00015f30: 6174 2069 6620 610a 7265 636f 7264 6564  at if a.recorded
+00015f40: 2065 7665 6e74 2069 7320 7375 6363 6573   event is succes
+00015f50: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
+00015f60: 2061 6e64 206e 6577 2073 7461 7465 2072   and new state r
+00015f70: 6563 6f72 6465 6420 6174 6f6d 6963 616c  ecorded atomical
+00015f80: 6c79 2069 6e20 6f6e 650a 7472 616e 7361  ly in one.transa
+00015f90: 6374 696f 6e20 7769 7468 2074 6865 2063  ction with the c
+00015fa0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2072  ommit position r
+00015fb0: 6563 6f72 6465 6420 696e 2061 2073 6570  ecorded in a sep
+00015fc0: 6172 6174 6520 7472 616e 7361 6374 696f  arate transactio
+00015fd0: 6e2c 206f 6e65 206d 6179 0a68 6170 7065  n, one may.happe
+00015fe0: 6e20 616e 6420 6e6f 7420 7468 6520 6f74  n and not the ot
+00015ff0: 6865 722e 2049 6620 7468 6520 6e65 7720  her. If the new 
+00016000: 7374 6174 6520 6973 2072 6563 6f72 6465  state is recorde
+00016010: 6420 6275 7420 7468 6520 706f 7369 7469  d but the positi
+00016020: 6f6e 2069 7320 6c6f 7374 2c0a 616e 6420  on is lost,.and 
+00016030: 7468 656e 2074 6865 2070 726f 6365 7373  then the process
+00016040: 696e 6720 6973 2073 746f 7070 6564 2061  ing is stopped a
+00016050: 6e64 2072 6573 756d 6564 2c20 7468 6520  nd resumed, the 
+00016060: 7265 636f 7264 6564 2065 7665 6e74 206d  recorded event m
+00016070: 6179 2062 6520 7072 6f63 6573 7365 640a  ay be processed.
+00016080: 7477 6963 652e 204f 6e20 7468 6520 6f74  twice. On the ot
+00016090: 6865 7220 6861 6e64 2c20 6966 2074 6865  her hand, if the
+000160a0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+000160b0: 2069 7320 7265 636f 7264 6564 2062 7574   is recorded but
+000160c0: 2074 6865 206e 6577 2073 7461 7465 2069   the new state i
+000160d0: 730a 6c6f 7374 2c20 7468 6520 7265 636f  s.lost, the reco
+000160e0: 7264 6564 2065 7665 6e74 206d 6179 2065  rded event may e
+000160f0: 6666 6563 7469 7665 6c79 206e 6f74 2062  ffectively not b
+00016100: 6520 7072 6f63 6573 7365 6420 6174 2061  e processed at a
+00016110: 6c6c 2e20 4279 2065 6974 6865 720a 7072  ll. By either.pr
+00016120: 6f63 6573 7369 6e67 2061 6e20 6576 656e  ocessing an even
+00016130: 7420 6d6f 7265 2074 6861 6e20 6f6e 6365  t more than once
+00016140: 2c20 6f72 2062 7920 6661 696c 696e 6720  , or by failing 
+00016150: 746f 2070 726f 6365 7373 2061 6e20 6576  to process an ev
+00016160: 656e 742c 2074 6865 2072 6563 6f72 6465  ent, the recorde
+00016170: 640a 7374 6174 6520 6f66 2074 6865 2064  d.state of the d
+00016180: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
+00016190: 656e 7420 6d69 6768 7420 6265 2069 6e61  ent might be ina
+000161a0: 6363 7572 6174 652c 206f 7220 706f 7373  ccurate, or poss
+000161b0: 6962 6c79 2069 6e63 6f6e 7369 7374 656e  ibly inconsisten
+000161c0: 742c 2061 6e64 0a70 6572 6861 7073 2063  t, and.perhaps c
+000161d0: 6174 6173 7472 6f70 6869 6361 6c6c 7920  atastrophically 
+000161e0: 736f 2e20 5375 6368 2063 6f6e 7365 7175  so. Such consequ
+000161f0: 656e 6365 7320 6d61 7920 6f72 206d 6179  ences may or may
+00016200: 206e 6f74 206d 6174 7465 7220 696e 2079   not matter in y
+00016210: 6f75 7220 7369 7475 6174 696f 6e2e 0a42  our situation..B
+00016220: 7574 2073 6f6d 6574 696d 6573 2069 6e63  ut sometimes inc
+00016230: 6f6e 7369 7374 656e 6369 6573 206d 6179  onsistencies may
+00016240: 2068 616c 7420 7072 6f63 6573 7369 6e67   halt processing
+00016250: 2075 6e74 696c 2074 6865 2069 7373 7565   until the issue
+00016260: 2069 7320 7265 736f 6c76 6564 2e20 596f   is resolved. Yo
+00016270: 7520 6361 6e0a 6176 6f69 6420 2264 7561  u can.avoid "dua
+00016280: 6c20 7772 6974 696e 6722 2069 6e20 7468  l writing" in th
+00016290: 6520 636f 6e73 756d 7074 696f 6e20 6f66  e consumption of
+000162a0: 2065 7665 6e74 7320 6279 2061 746f 6d69   events by atomi
+000162b0: 6361 6c6c 7920 7265 636f 7264 696e 6720  cally recording 
+000162c0: 7468 6520 636f 6d6d 6974 0a70 6f73 6974  the commit.posit
+000162d0: 696f 6e20 6f66 2061 2072 6563 6f72 6465  ion of a recorde
+000162e0: 6420 6576 656e 7420 616c 6f6e 6720 7769  d event along wi
+000162f0: 7468 2074 6865 206e 6577 2073 7461 7465  th the new state
+00016300: 2074 6861 7420 7265 7375 6c74 7320 6672   that results fr
+00016310: 6f6d 2070 726f 6365 7373 696e 6720 7468  om processing th
+00016320: 6174 0a65 7665 6e74 2069 6e20 7468 6520  at.event in the 
+00016330: 7361 6d65 2061 746f 6d69 6320 7472 616e  same atomic tran
+00016340: 7361 6374 696f 6e2e 2042 7920 6d61 6b69  saction. By maki
+00016350: 6e67 2074 6865 2072 6563 6f72 6469 6e67  ng the recording
+00016360: 206f 6620 7468 6520 636f 6d6d 6974 2070   of the commit p
+00016370: 6f73 6974 696f 6e73 0a75 6e69 7175 652c  ositions.unique,
+00016380: 2073 6f20 7468 6174 2074 7261 6e73 6163   so that transac
+00016390: 7469 6f6e 7320 7769 6c6c 2062 6520 726f  tions will be ro
+000163a0: 6c6c 6564 2062 6163 6b20 7768 656e 2074  lled back when t
+000163b0: 6865 7265 2069 7320 6120 636f 6e66 6c69  here is a confli
+000163c0: 6374 2c20 796f 7520 7769 6c6c 0a70 7265  ct, you will.pre
+000163d0: 7665 6e74 2074 6865 2072 6573 756c 7473  vent the results
+000163e0: 206f 6620 616e 7920 6475 706c 6963 6174   of any duplicat
+000163f0: 6520 7072 6f63 6573 7369 6e67 206f 6620  e processing of 
+00016400: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
+00016410: 2062 6569 6e67 2063 6f6d 6d69 7474 6564   being committed
+00016420: 2e0a 0a52 6563 6f72 6465 6420 6576 656e  ...Recorded even
+00016430: 7473 2072 6563 6569 7665 6420 6672 6f6d  ts received from
+00016440: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
+00016450: 6372 6970 7469 6f6e 2063 616e 6e6f 7420  cription cannot 
+00016460: 6265 2061 636b 6e6f 776c 6564 6765 6420  be acknowledged 
+00016470: 6261 636b 0a74 6f20 7468 6520 4576 656e  back.to the Even
+00016480: 7453 746f 7265 4442 2073 6572 7665 722e  tStoreDB server.
+00016490: 2041 636b 6e6f 776c 6564 6769 6e67 2065   Acknowledging e
+000164a0: 7665 6e74 732c 2068 6f77 6576 6572 2c20  vents, however, 
+000164b0: 6973 2061 6e20 6173 7065 6374 206f 6620  is an aspect of 
+000164c0: 2270 6572 7369 7374 656e 740a 7375 6273  "persistent.subs
+000164d0: 6372 6970 7469 6f6e 7322 2e20 486f 7069  criptions". Hopi
+000164e0: 6e67 2074 6f20 7265 6c79 206f 6e20 6163  ng to rely on ac
+000164f0: 6b6e 6f77 6c65 6467 696e 6720 6576 656e  knowledging even
+00016500: 7473 2074 6f20 616e 2075 7073 7472 6561  ts to an upstrea
+00016510: 6d0a 636f 6d70 6f6e 656e 7420 6973 2061  m.component is a
+00016520: 6e20 6578 616d 706c 6520 6f66 2064 7561  n example of dua
+00016530: 6c20 7772 6974 696e 672e 0a0a 0a23 2320  l writing....## 
+00016540: 5065 7273 6973 7465 6e74 2073 7562 7363  Persistent subsc
+00016550: 7269 7074 696f 6e73 3c61 2069 643d 2270  riptions<a id="p
+00016560: 6572 7369 7374 656e 742d 7375 6273 6372  ersistent-subscr
+00016570: 6970 7469 6f6e 7322 3e3c 2f61 3e0a 0a49  iptions"></a>..I
+00016580: 6e20 4576 656e 7453 746f 7265 4442 2c20  n EventStoreDB, 
+00016590: 2270 6572 7369 7374 656e 7422 2073 7562  "persistent" sub
+000165a0: 7363 7269 7074 696f 6e73 2061 7265 2073  scriptions are s
+000165b0: 696d 696c 6172 2074 6f20 6361 7463 682d  imilar to catch-
+000165c0: 7570 2073 7562 7363 7269 7074 696f 6e73  up subscriptions
+000165d0: 2c0a 696e 2074 6861 7420 7265 6164 696e  ,.in that readin
+000165e0: 6720 6120 7065 7273 6973 7465 6e74 2073  g a persistent s
+000165f0: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
+00016600: 2062 6c6f 636b 2077 6865 6e20 7468 6572   block when ther
+00016610: 6520 6172 6520 6e6f 206d 6f72 6520 7265  e are no more re
+00016620: 636f 7264 6564 0a65 7665 6e74 7320 746f  corded.events to
+00016630: 2062 6520 7265 6365 6976 6564 2c20 616e   be received, an
+00016640: 6420 7468 656e 2063 6f6e 7469 6e75 6520  d then continue 
+00016650: 7768 656e 206e 6577 2065 7665 6e74 7320  when new events 
+00016660: 6172 6520 7375 6273 6571 7565 6e74 6c79  are subsequently
+00016670: 2072 6563 6f72 6465 642e 0a0a 5065 7273   recorded...Pers
+00016680: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00016690: 696f 6e73 2063 616e 2062 6520 636f 6e73  ions can be cons
+000166a0: 756d 6564 2062 7920 6120 6772 6f75 7020  umed by a group 
+000166b0: 6f66 2063 6f6e 7375 6d65 7273 206f 7065  of consumers ope
+000166c0: 7261 7469 6e67 2077 6974 6820 6f6e 650a  rating with one.
+000166d0: 6f66 2074 6865 2073 7570 706f 7274 6564  of the supported
+000166e0: 2022 636f 6e73 756d 6572 2073 7472 6174   "consumer strat
+000166f0: 6567 6965 7322 2e0a 0a54 6865 2073 6967  egies"...The sig
+00016700: 6e69 6669 6361 6e74 2064 6966 6665 7265  nificant differe
+00016710: 6e74 2077 6974 6820 7065 7273 6973 7465  nt with persiste
+00016720: 6e74 2073 7562 7363 7269 7074 696f 6e73  nt subscriptions
+00016730: 2069 7320 7468 6520 7365 7276 6572 2077   is the server w
+00016740: 696c 6c20 6b65 6570 2074 7261 636b 0a6f  ill keep track.o
+00016750: 6620 7468 6520 7072 6f67 7265 7373 206f  f the progress o
+00016760: 6620 7468 6520 636f 6e73 756d 6572 732e  f the consumers.
+00016770: 2054 6865 2063 6f6e 7375 6d65 7220 6f66   The consumer of
+00016780: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
+00016790: 6273 6372 6970 7469 6f6e 2077 696c 6c0a  bscription will.
+000167a0: 7468 6572 6566 6f72 6520 6e65 6564 2074  therefore need t
+000167b0: 6f20 2261 636b 6e6f 776c 6564 6765 2220  o "acknowledge" 
+000167c0: 7768 656e 2061 2072 6563 6f72 6465 6420  when a recorded 
+000167d0: 6576 656e 7420 6861 7320 6265 656e 2070  event has been p
+000167e0: 726f 6365 7373 6564 2073 7563 6365 7373  rocessed success
+000167f0: 6675 6c6c 792c 0a61 6e64 206f 7468 6572  fully,.and other
+00016800: 7769 7365 2022 6e65 6761 7469 7665 6c79  wise "negatively
+00016810: 2061 636b 6e6f 776c 6564 6765 2220 6120   acknowledge" a 
+00016820: 7265 636f 7264 6564 2065 7665 6e74 2074  recorded event t
+00016830: 6861 7420 6861 7320 6265 656e 2072 6563  hat has been rec
+00016840: 6569 7665 6420 6275 7420 7761 730a 6e6f  eived but was.no
+00016850: 7420 7375 6363 6573 7366 756c 6c79 2070  t successfully p
+00016860: 726f 6365 7373 6564 2e0a 0a41 6c6c 206f  rocessed...All o
+00016870: 6620 7468 6973 206d 6561 6e73 2074 6861  f this means tha
+00016880: 7420 666f 7220 7065 7273 6973 7465 6e74  t for persistent
+00016890: 2073 7562 7363 7269 7074 696f 6e73 2074   subscriptions t
+000168a0: 6865 7265 2061 7265 2022 6372 6561 7465  here are "create
+000168b0: 222c 2022 7265 6164 222c 2022 7570 6461  ", "read", "upda
+000168c0: 7465 220a 2264 656c 6574 6522 2c20 2261  te"."delete", "a
+000168d0: 636b 222c 2061 6e64 2022 6e61 636b 2220  ck", and "nack" 
+000168e0: 6f70 6572 6174 696f 6e73 2074 6f20 636f  operations to co
+000168f0: 6e73 6964 6572 2e0a 0a57 6869 6c73 7420  nsider...Whilst 
+00016900: 7468 6572 6520 6172 6520 736f 6d65 2061  there are some a
+00016910: 6476 616e 7461 6765 7320 6f66 2070 6572  dvantages of per
+00016920: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+00016930: 7469 6f6e 732c 2069 6e20 7061 7274 6963  tions, in partic
+00016940: 756c 6172 2074 6865 0a63 6f6e 6375 7272  ular the.concurr
+00016950: 656e 7420 7072 6f63 6573 7369 6e67 206f  ent processing o
+00016960: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
+00016970: 7320 6279 2061 2067 726f 7570 206f 6620  s by a group of 
+00016980: 636f 6e73 756d 6572 732c 2062 7920 7472  consumers, by tr
+00016990: 6163 6b69 6e67 2069 6e0a 7468 6520 7365  acking in.the se
+000169a0: 7276 6572 2074 6865 2070 6f73 6974 696f  rver the positio
+000169b0: 6e20 696e 2074 6865 2063 6f6d 6d69 7420  n in the commit 
+000169c0: 7365 7175 656e 6365 206f 6620 6576 656e  sequence of even
+000169d0: 7473 2074 6861 7420 6861 7665 2062 6565  ts that have bee
+000169e0: 6e20 7072 6f63 6573 7365 642c 0a74 6865  n processed,.the
+000169f0: 2069 7373 7565 206f 6620 2264 7561 6c20   issue of "dual 
+00016a00: 7772 6974 696e 6722 2069 6e20 7468 6520  writing" in the 
+00016a10: 636f 6e73 756d 7074 696f 6e20 6f66 2065  consumption of e
+00016a20: 7665 6e74 7320 6172 6973 6573 2e20 5265  vents arises. Re
+00016a30: 6c69 6162 696c 6974 7920 696e 2074 6865  liability in the
+00016a40: 0a70 726f 6365 7373 696e 6720 6f66 2072  .processing of r
+00016a50: 6563 6f72 6465 6420 6576 656e 7473 2062  ecorded events b
+00016a60: 7920 6120 6772 6f75 7020 6f66 2070 6572  y a group of per
+00016a70: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+00016a80: 7469 6f6e 2063 6f6e 7375 6d65 7273 2077  tion consumers w
+00016a90: 696c 6c0a 7265 6c79 206f 6e20 7468 6569  ill.rely on thei
+00016aa0: 7220 6964 656d 706f 7465 6e74 2068 616e  r idempotent han
+00016ab0: 646c 696e 6720 6f66 2064 7570 6c69 6361  dling of duplica
+00016ac0: 7465 206d 6573 7361 6765 732c 2061 6e64  te messages, and
+00016ad0: 2074 6865 6972 2072 6573 696c 6965 6e63   their resilienc
+00016ae0: 6520 746f 0a6f 7574 2d6f 662d 6f72 6465  e to.out-of-orde
+00016af0: 7220 6465 6c69 7665 7279 2e0a 0a0a 2323  r delivery....##
+00016b00: 2320 4372 6561 7465 2073 7562 7363 7269  # Create subscri
+00016b10: 7074 696f 6e20 746f 2061 6c6c 3c61 2069  ption to all<a i
+00016b20: 643d 2263 7265 6174 652d 7375 6273 6372  d="create-subscr
+00016b30: 6970 7469 6f6e 2d74 6f2d 616c 6c22 3e3c  iption-to-all"><
+00016b40: 2f61 3e0a 0a2a 7265 7175 6972 6573 206c  /a>..*requires l
+00016b50: 6561 6465 722a 0a0a 5468 6520 6063 7265  eader*..The `cre
+00016b60: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+00016b70: 5f74 6f5f 616c 6c28 2960 206d 6574 686f  _to_all()` metho
+00016b80: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
+00016b90: 2063 7265 6174 6520 6120 2270 6572 7369   create a "persi
+00016ba0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00016bb0: 6f6e 220a 746f 2061 6c6c 2074 6865 2072  on".to all the r
+00016bc0: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
+00016bd0: 6e20 7468 6520 6461 7461 6261 7365 2061  n the database a
+00016be0: 6372 6f73 7320 616c 6c20 7374 7265 616d  cross all stream
+00016bf0: 732e 0a0a 5468 6973 206d 6574 686f 6420  s...This method 
+00016c00: 6861 7320 6120 7265 7175 6972 6564 2060  has a required `
+00016c10: 6772 6f75 705f 6e61 6d65 6020 6172 6775  group_name` argu
+00016c20: 6d65 6e74 2c20 7768 6963 6820 6973 2074  ment, which is t
+00016c30: 6865 0a6e 616d 6520 6f66 2061 2022 6772  he.name of a "gr
+00016c40: 6f75 7022 206f 6620 636f 6e73 756d 6572  oup" of consumer
+00016c50: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
+00016c60: 7074 696f 6e2e 0a0a 5468 6973 206d 6574  ption...This met
+00016c70: 686f 6420 6861 7320 6e69 6e65 7465 656e  hod has nineteen
+00016c80: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+00016c90: 6e74 732c 2060 6672 6f6d 5f65 6e64 602c  nts, `from_end`,
+00016ca0: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+00016cb0: 6e60 2c20 6072 6573 6f6c 7665 5f6c 696e  n`, `resolve_lin
+00016cc0: 6b73 602c 0a60 6669 6c74 6572 5f65 7863  ks`,.`filter_exc
+00016cd0: 6c75 6465 602c 2060 6669 6c74 6572 5f69  lude`, `filter_i
+00016ce0: 6e63 6c75 6465 602c 2060 6669 6c74 6572  nclude`, `filter
+00016cf0: 5f62 795f 7374 7265 616d 5f6e 616d 6560  _by_stream_name`
+00016d00: 2c20 6063 6f6e 7375 6d65 725f 7374 7261  , `consumer_stra
+00016d10: 7465 6779 602c 0a60 6d65 7373 6167 655f  tegy`,.`message_
+00016d20: 7469 6d65 6f75 7460 2c20 606d 6178 5f72  timeout`, `max_r
+00016d30: 6574 7279 5f63 6f75 6e74 602c 2060 6d69  etry_count`, `mi
+00016d40: 6e5f 6368 6563 6b70 6f69 6e74 5f63 6f75  n_checkpoint_cou
+00016d50: 6e74 602c 2060 6d61 785f 6368 6563 6b70  nt`, `max_checkp
+00016d60: 6f69 6e74 5f63 6f75 6e74 602c 0a60 6368  oint_count`,.`ch
+00016d70: 6563 6b70 6f69 6e74 5f61 6674 6572 602c  eckpoint_after`,
+00016d80: 2060 6d61 785f 7375 6273 6372 6962 6572   `max_subscriber
+00016d90: 5f63 6f75 6e74 602c 2060 6c69 7665 5f62  _count`, `live_b
+00016da0: 7566 6665 725f 7369 7a65 602c 2060 7265  uffer_size`, `re
+00016db0: 6164 5f62 6174 6368 5f73 697a 6560 2c0a  ad_batch_size`,.
+00016dc0: 6068 6973 746f 7279 5f62 7566 6665 725f  `history_buffer_
+00016dd0: 7369 7a65 602c 2060 6578 7472 615f 7374  size`, `extra_st
+00016de0: 6174 6973 7469 6373 602c 2060 7469 6d65  atistics`, `time
+00016df0: 6f75 7460 2061 6e64 2060 6372 6564 656e  out` and `creden
+00016e00: 7469 616c 7360 2e0a 0a54 6865 206f 7074  tials`...The opt
+00016e10: 696f 6e61 6c20 6066 726f 6d5f 656e 6460  ional `from_end`
+00016e20: 2061 7267 756d 656e 7420 6361 6e20 6265   argument can be
+00016e30: 2075 7365 6420 746f 2073 7065 6369 6679   used to specify
+00016e40: 2074 6861 7420 7468 6520 6772 6f75 7020   that the group 
+00016e50: 6f66 2063 6f6e 7375 6d65 7273 0a6f 6620  of consumers.of 
+00016e60: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00016e70: 2073 686f 756c 6420 6f6e 6c79 2072 6563   should only rec
+00016e80: 6569 7665 2065 7665 6e74 7320 7468 6174  eive events that
+00016e90: 2077 6572 6520 7265 636f 7264 6564 2061   were recorded a
+00016ea0: 6674 6572 2074 6865 2073 7562 7363 7269  fter the subscri
+00016eb0: 7074 696f 6e0a 7761 7320 6372 6561 7465  ption.was create
+00016ec0: 642e 0a0a 416c 7465 726e 6174 6976 656c  d...Alternativel
+00016ed0: 792c 2074 6865 206f 7074 696f 6e61 6c20  y, the optional 
+00016ee0: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00016ef0: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
+00016f00: 6520 7573 6564 2074 6f20 7370 6563 6966  e used to specif
+00016f10: 7920 6120 636f 6d6d 6974 0a70 6f73 6974  y a commit.posit
+00016f20: 696f 6e20 6672 6f6d 2077 6869 6368 2074  ion from which t
+00016f30: 6865 2067 726f 7570 206f 6620 636f 6e73  he group of cons
+00016f40: 756d 6572 7320 6f66 2074 6865 2073 7562  umers of the sub
+00016f50: 7363 7269 7074 696f 6e20 7368 6f75 6c64  scription should
+00016f60: 0a72 6563 6569 7665 2065 7665 6e74 732e  .receive events.
+00016f70: 2050 6c65 6173 6520 6e6f 7465 2c20 7468   Please note, th
+00016f80: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00016f90: 2061 7420 7468 6520 7370 6563 6966 6965   at the specifie
+00016fa0: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
+00016fb0: 6e20 6d69 6768 740a 6265 2069 6e63 6c75  n might.be inclu
+00016fc0: 6465 6420 696e 2074 6865 2072 6563 6f72  ded in the recor
+00016fd0: 6465 6420 6576 656e 7473 2072 6563 6569  ded events recei
+00016fe0: 7665 6420 6279 2074 6865 2067 726f 7570  ved by the group
+00016ff0: 206f 6620 636f 6e73 756d 6572 732e 0a0a   of consumers...
+00017000: 4966 206e 6569 7468 6572 2060 6672 6f6d  If neither `from
+00017010: 5f65 6e64 6020 6e6f 7220 6063 6f6d 6d69  _end` nor `commi
+00017020: 745f 706f 7369 7469 6f6e 6020 6172 6520  t_position` are 
+00017030: 7370 6563 6966 6965 642c 2074 6865 2067  specified, the g
+00017040: 726f 7570 206f 6620 636f 6e73 756d 6572  roup of consumer
+00017050: 730a 6f66 2074 6865 2073 7562 7363 7269  s.of the subscri
+00017060: 7074 696f 6e20 7769 6c6c 2070 6f74 656e  ption will poten
+00017070: 7469 616c 6c79 2072 6563 6569 7665 2061  tially receive a
+00017080: 6c6c 2072 6563 6f72 6465 6420 6576 656e  ll recorded even
+00017090: 7473 2069 6e20 7468 6520 6461 7461 6261  ts in the databa
+000170a0: 7365 2e0a 0a54 6865 206f 7074 696f 6e61  se...The optiona
+000170b0: 6c20 6072 6573 6f6c 7665 5f6c 696e 6b73  l `resolve_links
+000170c0: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+000170d0: 5079 7468 6f6e 2060 626f 6f6c 602e 2054  Python `bool`. T
+000170e0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+000170f0: 206f 6620 6072 6573 6f6c 7665 5f6c 696e   of `resolve_lin
+00017100: 6b73 600a 6973 2060 4661 6c73 6560 2c20  ks`.is `False`, 
+00017110: 7768 6963 6820 6d65 616e 7320 616e 7920  which means any 
+00017120: 6576 656e 7420 6c69 6e6b 7320 7769 6c6c  event links will
+00017130: 206e 6f74 2062 6520 7265 736f 6c76 6564   not be resolved
+00017140: 2c20 736f 2074 6861 7420 7468 6520 6576  , so that the ev
+00017150: 656e 7473 2074 6861 7420 6172 650a 7265  ents that are.re
+00017160: 7475 726e 6564 206d 6179 2072 6570 7265  turned may repre
+00017170: 7365 6e74 2065 7665 6e74 206c 696e 6b73  sent event links
+00017180: 2e20 4966 2060 7265 736f 6c76 655f 6c69  . If `resolve_li
+00017190: 6e6b 7360 2069 7320 6054 7275 6560 2c20  nks` is `True`, 
+000171a0: 616e 7920 6576 656e 7420 6c69 6e6b 7320  any event links 
+000171b0: 7769 6c6c 0a62 6520 7265 736f 6c76 6564  will.be resolved
+000171c0: 2c20 736f 2074 6861 7420 7468 6520 6c69  , so that the li
+000171d0: 6e6b 6564 2065 7665 6e74 7320 7769 6c6c  nked events will
+000171e0: 2062 6520 7265 7475 726e 6564 2069 6e73   be returned ins
+000171f0: 7465 6164 206f 6620 7468 6520 6576 656e  tead of the even
+00017200: 7420 6c69 6e6b 732e 0a0a 5468 6520 6f70  t links...The op
+00017210: 7469 6f6e 616c 2060 6669 6c74 6572 5f65  tional `filter_e
+00017220: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
+00017230: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
+00017240: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
+00017250: 7369 6f6e 7320 7468 6174 0a73 7065 6369  sions that.speci
+00017260: 6669 6573 2077 6869 6368 2072 6563 6f72  fies which recor
+00017270: 6465 6420 6576 656e 7473 2073 686f 756c  ded events shoul
+00017280: 6420 6265 2072 6574 7572 6e65 642e 2054  d be returned. T
+00017290: 6869 7320 6172 6775 6d65 6e74 2069 7320  his argument is 
+000172a0: 6967 6e6f 7265 640a 6966 2060 6669 6c74  ignored.if `filt
+000172b0: 6572 5f69 6e63 6c75 6465 6020 6973 2073  er_include` is s
+000172c0: 6574 2074 6f20 6120 6e6f 6e2d 656d 7074  et to a non-empt
+000172d0: 7920 7365 7175 656e 6365 2e20 5468 6520  y sequence. The 
+000172e0: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
+000172f0: 2074 6869 730a 6172 6775 6d65 6e74 206d   this.argument m
+00017300: 6174 6368 6573 2074 6865 2065 7665 6e74  atches the event
+00017310: 2074 7970 6573 206f 6620 4576 656e 7453   types of EventS
+00017320: 746f 7265 4442 2022 7379 7374 656d 2065  toreDB "system e
+00017330: 7665 6e74 7322 2c20 736f 2074 6861 7420  vents", so that 
+00017340: 7379 7374 656d 0a65 7665 6e74 7320 7769  system.events wi
+00017350: 6c6c 206e 6f74 206e 6f72 6d61 6c6c 7920  ll not normally 
+00017360: 6265 2069 6e63 6c75 6465 642e 2053 6565  be included. See
+00017370: 2074 6865 204e 6f74 6573 2073 6563 7469   the Notes secti
+00017380: 6f6e 2062 656c 6f77 2066 6f72 206d 6f72  on below for mor
+00017390: 650a 696e 666f 726d 6174 696f 6e20 6162  e.information ab
+000173a0: 6f75 7420 6669 6c74 6572 2065 7870 7265  out filter expre
+000173b0: 7373 696f 6e73 2e0a 0a54 6865 206f 7074  ssions...The opt
+000173c0: 696f 6e61 6c20 6066 696c 7465 725f 696e  ional `filter_in
+000173d0: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
+000173e0: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
+000173f0: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
+00017400: 696f 6e73 0a74 6861 7420 7370 6563 6966  ions.that specif
+00017410: 6965 7320 7768 6963 6820 7265 636f 7264  ies which record
+00017420: 6564 2065 7665 6e74 7320 7368 6f75 6c64  ed events should
+00017430: 2062 6520 7265 7475 726e 6564 2e20 4279   be returned. By
+00017440: 2064 6566 6175 6c74 2c20 7468 6973 0a61   default, this.a
+00017450: 7267 756d 656e 7420 6973 2061 6e20 656d  rgument is an em
+00017460: 7074 7920 7475 706c 652e 2049 6620 7468  pty tuple. If th
+00017470: 6973 2061 7267 756d 656e 7420 6973 2073  is argument is s
+00017480: 6574 2074 6f20 6120 6e6f 6e2d 656d 7074  et to a non-empt
+00017490: 7920 7365 7175 656e 6365 2c0a 7468 6520  y sequence,.the 
+000174a0: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
+000174b0: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
+000174c0: 6f72 6564 2e0a 0a54 6865 206f 7074 696f  ored...The optio
+000174d0: 6e61 6c20 6066 696c 7465 725f 6279 5f73  nal `filter_by_s
+000174e0: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
+000174f0: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00017500: 2060 626f 6f6c 6020 7468 6174 2069 6e64   `bool` that ind
+00017510: 6963 6174 6573 0a77 6865 7468 6572 2074  icates.whether t
+00017520: 6865 2066 696c 7465 7269 6e67 2077 696c  he filtering wil
+00017530: 6c20 6170 706c 7920 746f 2065 7665 6e74  l apply to event
+00017540: 2074 7970 6573 206f 7220 7374 7265 616d   types or stream
+00017550: 206e 616d 6573 2e20 4279 2064 6566 6175   names. By defau
+00017560: 6c74 2c20 7468 6973 0a76 616c 7565 2069  lt, this.value i
+00017570: 7320 6046 616c 7365 6020 616e 6420 736f  s `False` and so
+00017580: 2074 6865 2066 696c 7465 7269 6e67 2077   the filtering w
+00017590: 696c 6c20 6170 706c 7920 746f 2074 6865  ill apply to the
+000175a0: 2065 7665 6e74 2074 7970 6520 7374 7269   event type stri
+000175b0: 6e67 7320 6f66 0a72 6563 6f72 6465 6420  ngs of.recorded 
+000175c0: 6576 656e 7473 2e0a 0a54 6865 206f 7074  events...The opt
+000175d0: 696f 6e61 6c20 6063 6f6e 7375 6d65 725f  ional `consumer_
+000175e0: 7374 7261 7465 6779 6020 6172 6775 6d65  strategy` argume
+000175f0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+00017600: 7374 7260 2074 6861 7420 6465 6669 6e65  str` that define
+00017610: 730a 7468 6520 636f 6e73 756d 6572 2073  s.the consumer s
+00017620: 7472 6174 6567 7920 666f 7220 7468 6973  trategy for this
+00017630: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00017640: 6372 6970 7469 6f6e 2e20 5468 6520 7661  cription. The va
+00017650: 6c75 6520 6f66 2074 6869 7320 6172 6775  lue of this argu
+00017660: 6d65 6e74 0a63 616e 2062 6520 6027 4469  ment.can be `'Di
+00017670: 7370 6174 6368 546f 5369 6e67 6c65 2760  spatchToSingle'`
+00017680: 2c20 6027 526f 756e 6452 6f62 696e 2760  , `'RoundRobin'`
+00017690: 2c20 6027 5069 6e6e 6564 2760 2c20 6f72  , `'Pinned'`, or
+000176a0: 2060 2750 696e 6e65 6442 7943 6f72 7265   `'PinnedByCorre
+000176b0: 6c61 7469 6f6e 2760 2e20 5468 650a 6465  lation'`. The.de
+000176c0: 6661 756c 7420 7661 6c75 6520 6973 2060  fault value is `
+000176d0: 2744 6973 7061 7463 6854 6f53 696e 676c  'DispatchToSingl
+000176e0: 6527 602e 0a0a 5468 6520 6f70 7469 6f6e  e'`...The option
+000176f0: 616c 2060 6d65 7373 6167 655f 7469 6d65  al `message_time
+00017700: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
+00017710: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+00017720: 6020 7768 6963 6820 7365 7473 2061 206d  ` which sets a m
+00017730: 6178 696d 756d 2064 7572 6174 696f 6e2c  aximum duration,
+00017740: 0a69 6e20 7365 636f 6e64 732c 2066 726f  .in seconds, fro
+00017750: 6d20 7468 6520 7365 7276 6572 2073 656e  m the server sen
+00017760: 6469 6e67 2061 2072 6563 6f72 6465 6420  ding a recorded 
+00017770: 6576 656e 7420 746f 2061 2063 6f6e 7375  event to a consu
+00017780: 6d65 7220 6f66 2074 6865 2070 6572 7369  mer of the persi
+00017790: 7374 656e 740a 7375 6273 6372 6970 7469  stent.subscripti
+000177a0: 6f6e 2075 6e74 696c 2065 6974 6865 7220  on until either 
+000177b0: 616e 2022 6163 6b6e 6f77 6c65 6467 656d  an "acknowledgem
+000177c0: 656e 7422 2028 6163 6b29 206f 7220 6120  ent" (ack) or a 
+000177d0: 226e 6567 6174 6976 6520 6163 6b6e 6f77  "negative acknow
+000177e0: 6c65 6467 656d 656e 7422 0a28 6e61 636b  ledgement".(nack
+000177f0: 2920 6973 2072 6563 6569 7665 6420 6279  ) is received by
+00017800: 2074 6865 2073 6572 7665 722c 2061 6674   the server, aft
+00017810: 6572 2077 6869 6368 2074 6865 2073 6572  er which the ser
+00017820: 7665 7220 7769 6c6c 2072 6574 7279 2074  ver will retry t
+00017830: 6f20 7365 6e64 2074 6865 2065 7665 6e74  o send the event
+00017840: 2e0a 5468 6520 6465 6661 756c 7420 7661  ..The default va
+00017850: 6c75 6520 6f66 2060 6d65 7373 6167 655f  lue of `message_
+00017860: 7469 6d65 6f75 7460 2069 7320 6033 302e  timeout` is `30.
+00017870: 3060 2e0a 0a54 6865 206f 7074 696f 6e61  0`...The optiona
+00017880: 6c20 606d 6178 5f72 6574 7279 5f63 6f75  l `max_retry_cou
+00017890: 6e74 6020 6172 6775 6d65 6e74 2069 7320  nt` argument is 
+000178a0: 6120 5079 7468 6f6e 2060 696e 7460 2077  a Python `int` w
+000178b0: 6869 6368 2073 6574 7320 7468 6520 6e75  hich sets the nu
+000178c0: 6d62 6572 206f 6620 7469 6d65 730a 7468  mber of times.th
+000178d0: 6520 7365 7276 6572 2077 696c 6c20 7265  e server will re
+000178e0: 7472 7920 746f 2073 656e 6420 616e 2065  try to send an e
+000178f0: 7665 6e74 2e20 5468 6520 6465 6661 756c  vent. The defaul
+00017900: 7420 7661 6c75 6520 6f66 2060 6d61 785f  t value of `max_
+00017910: 7265 7472 795f 636f 756e 7460 2069 7320  retry_count` is 
+00017920: 6031 3060 2e0a 0a54 6865 206f 7074 696f  `10`...The optio
+00017930: 6e61 6c20 606d 696e 5f63 6865 636b 706f  nal `min_checkpo
+00017940: 696e 745f 636f 756e 7460 2061 7267 756d  int_count` argum
+00017950: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+00017960: 6069 6e74 6020 7768 6963 6820 7365 7473  `int` which sets
+00017970: 2074 6865 206d 696e 696d 756d 0a6e 756d   the minimum.num
+00017980: 6265 7220 6f66 2022 6163 6b6e 6f77 6c65  ber of "acknowle
+00017990: 6467 656d 656e 7473 2220 2861 636b 7329  dgements" (acks)
+000179a0: 2072 6563 6569 7665 6420 6279 2074 6865   received by the
+000179b0: 2073 6572 7665 7220 6265 666f 7265 2074   server before t
+000179c0: 6865 2073 6572 7665 7220 6d61 7920 7265  he server may re
+000179d0: 636f 7264 0a74 6865 2061 636b 6e6f 776c  cord.the acknowl
+000179e0: 6564 6765 6d65 6e74 732e 2054 6865 2064  edgements. The d
+000179f0: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+00017a00: 606d 696e 5f63 6865 636b 706f 696e 745f  `min_checkpoint_
+00017a10: 636f 756e 7460 2069 7320 6031 3060 2e0a  count` is `10`..
+00017a20: 0a54 6865 206f 7074 696f 6e61 6c20 606d  .The optional `m
+00017a30: 6178 5f63 6865 636b 706f 696e 745f 636f  ax_checkpoint_co
+00017a40: 756e 7460 2061 7267 756d 656e 7420 6973  unt` argument is
+00017a50: 2061 2050 7974 686f 6e20 6069 6e74 6020   a Python `int` 
+00017a60: 7768 6963 6820 7365 7473 2074 6865 206d  which sets the m
+00017a70: 6178 696d 756d 0a6e 756d 6265 7220 6f66  aximum.number of
+00017a80: 2022 6163 6b6e 6f77 6c65 6467 656d 656e   "acknowledgemen
+00017a90: 7473 2220 2861 636b 7329 2072 6563 6569  ts" (acks) recei
+00017aa0: 7665 6420 6279 2074 6865 2073 6572 7665  ved by the serve
+00017ab0: 7220 6265 666f 7265 2074 6865 2073 6572  r before the ser
+00017ac0: 7665 7220 6d75 7374 0a72 6563 6f72 6420  ver must.record 
+00017ad0: 7468 6520 6163 6b6e 6f77 6c65 6467 656d  the acknowledgem
+00017ae0: 656e 7473 2e20 5468 6520 6465 6661 756c  ents. The defaul
+00017af0: 7420 7661 6c75 6520 6f66 2060 6d61 785f  t value of `max_
+00017b00: 6368 6563 6b70 6f69 6e74 5f63 6f75 6e74  checkpoint_count
+00017b10: 6020 6973 2060 3130 3030 602e 0a0a 5468  ` is `1000`...Th
+00017b20: 6520 6f70 7469 6f6e 616c 2060 6368 6563  e optional `chec
+00017b30: 6b70 6f69 6e74 5f61 6674 6572 6020 6172  kpoint_after` ar
+00017b40: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00017b50: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
+00017b60: 2073 6574 7320 7468 6520 6d61 7869 6d75   sets the maximu
+00017b70: 6d0a 6475 7261 7469 6f6e 2069 6e20 7365  m.duration in se
+00017b80: 636f 6e64 7320 6265 7477 6565 6e20 7265  conds between re
+00017b90: 636f 7264 696e 6720 2261 636b 6e6f 776c  cording "acknowl
+00017ba0: 6564 6765 6d65 6e74 7322 2028 6163 6b73  edgements" (acks
+00017bb0: 292e 2054 6865 2064 6566 6175 6c74 2076  ). The default v
+00017bc0: 616c 7565 206f 660a 6063 6865 636b 706f  alue of.`checkpo
+00017bd0: 696e 745f 6166 7465 7260 2069 7320 6032  int_after` is `2
+00017be0: 2e30 602e 0a0a 5468 6520 6f70 7469 6f6e  .0`...The option
+00017bf0: 616c 2060 6d61 785f 7375 6273 6372 6962  al `max_subscrib
+00017c00: 6572 5f63 6f75 6e74 6020 6172 6775 6d65  er_count` argume
+00017c10: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+00017c20: 696e 7460 2077 6869 6368 2073 6574 7320  int` which sets 
+00017c30: 7468 6520 6d61 7869 6d75 6d0a 6e75 6d62  the maximum.numb
+00017c40: 6572 206f 6620 636f 6e63 7572 7265 6e74  er of concurrent
+00017c50: 2072 6561 6465 7273 206f 6620 7468 6520   readers of the 
+00017c60: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00017c70: 7269 7074 696f 6e2c 2062 6579 6f6e 6420  ription, beyond 
+00017c80: 7768 6963 6820 6174 7465 6d70 7473 2074  which attempts t
+00017c90: 6f0a 7265 6164 2074 6865 2070 6572 7369  o.read the persi
+00017ca0: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00017cb0: 6f6e 2077 696c 6c20 7261 6973 6520 6120  on will raise a 
+00017cc0: 604d 6178 696d 756d 5375 6273 6372 6970  `MaximumSubscrip
+00017cd0: 7469 6f6e 7352 6561 6368 6564 6020 6572  tionsReached` er
+00017ce0: 726f 722e 0a0a 5468 6520 6f70 7469 6f6e  ror...The option
+00017cf0: 616c 2060 6c69 7665 5f62 7566 6665 725f  al `live_buffer_
+00017d00: 7369 7a65 6020 6172 6775 6d65 6e74 2069  size` argument i
+00017d10: 7320 6120 5079 7468 6f6e 2060 696e 7460  s a Python `int`
+00017d20: 2077 6869 6368 2073 6574 7320 7468 6520   which sets the 
+00017d30: 7369 7a65 206f 6620 7468 650a 6275 6666  size of the.buff
+00017d40: 6572 2028 696e 2d6d 656d 6f72 7929 2068  er (in-memory) h
+00017d50: 6f6c 6469 6e67 206e 6577 6c79 2072 6563  olding newly rec
+00017d60: 6f72 6465 6420 6576 656e 7473 2e20 5468  orded events. Th
+00017d70: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+00017d80: 6f66 2060 6c69 7665 5f62 7566 6665 725f  of `live_buffer_
+00017d90: 7369 7a65 600a 6973 2035 3030 2e0a 0a54  size`.is 500...T
+00017da0: 6865 206f 7074 696f 6e61 6c20 6072 6561  he optional `rea
+00017db0: 645f 6261 7463 685f 7369 7a65 6020 6172  d_batch_size` ar
+00017dc0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00017dd0: 6f6e 2060 696e 7460 2077 6869 6368 2073  on `int` which s
+00017de0: 6574 7320 7468 6520 6e75 6d62 6572 206f  ets the number o
+00017df0: 660a 7265 636f 7264 6564 2065 7665 6e74  f.recorded event
+00017e00: 7320 7265 6164 2066 726f 6d20 6469 736b  s read from disk
+00017e10: 2077 6865 6e20 6361 7463 6869 6e67 2075   when catching u
+00017e20: 702e 2054 6865 2064 6566 6175 6c74 2076  p. The default v
+00017e30: 616c 7565 206f 6620 6072 6561 645f 6261  alue of `read_ba
+00017e40: 7463 685f 7369 7a65 600a 6973 2032 3030  tch_size`.is 200
+00017e50: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00017e60: 6068 6973 746f 7279 5f62 7566 6665 725f  `history_buffer_
+00017e70: 7369 7a65 6020 6172 6775 6d65 6e74 2069  size` argument i
+00017e80: 7320 6120 5079 7468 6f6e 2060 696e 7460  s a Python `int`
+00017e90: 2077 6869 6368 2073 6574 7320 7468 6520   which sets the 
+00017ea0: 6e75 6d62 6572 206f 660a 7265 636f 7264  number of.record
+00017eb0: 6564 2065 7665 6e74 7320 746f 2063 6163  ed events to cac
+00017ec0: 6865 2069 6e20 6d65 6d6f 7279 2077 6865  he in memory whe
+00017ed0: 6e20 6361 7463 6869 6e67 2075 702e 2054  n catching up. T
+00017ee0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00017ef0: 206f 6620 6068 6973 746f 7279 5f62 7566   of `history_buf
+00017f00: 6665 725f 7369 7a65 600a 6973 2035 3030  fer_size`.is 500
+00017f10: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00017f20: 6065 7874 7261 5f73 7461 7469 7374 6963  `extra_statistic
+00017f30: 7360 2061 7267 756d 656e 7420 6973 2061  s` argument is a
+00017f40: 2050 7974 686f 6e20 6062 6f6f 6c60 2077   Python `bool` w
+00017f50: 6869 6368 2065 6e61 626c 6573 2074 7261  hich enables tra
+00017f60: 636b 696e 6720 6f66 0a65 7874 7261 2073  cking of.extra s
+00017f70: 7461 7469 7374 6963 7320 6f6e 2074 6869  tatistics on thi
+00017f80: 7320 7375 6273 6372 6970 7469 6f6e 2e20  s subscription. 
+00017f90: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+00017fa0: 6520 6f66 2060 6578 7472 615f 7374 6174  e of `extra_stat
+00017fb0: 6973 7469 6373 6020 6973 2060 4661 6c73  istics` is `Fals
+00017fc0: 6560 2e0a 0a54 6865 206f 7074 696f 6e61  e`...The optiona
+00017fd0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+00017fe0: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00017ff0: 2060 666c 6f61 7460 2077 6869 6368 2073   `float` which s
+00018000: 6574 7320 610a 6d61 7869 6d75 6d20 6475  ets a.maximum du
+00018010: 7261 7469 6f6e 2c20 696e 2073 6563 6f6e  ration, in secon
+00018020: 6473 2c20 666f 7220 7468 6520 636f 6d70  ds, for the comp
+00018030: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+00018040: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+00018050: 6865 206f 7074 696f 6e61 6c20 6063 7265  he optional `cre
+00018060: 6465 6e74 6961 6c73 6020 6172 6775 6d65  dentials` argume
+00018070: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+00018080: 6f0a 6f76 6572 7269 6465 2063 616c 6c20  o.override call 
+00018090: 6372 6564 656e 7469 616c 7320 6465 7269  credentials deri
+000180a0: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
+000180b0: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
+000180c0: 5249 2e0a 0a54 6865 206d 6574 686f 6420  RI...The method 
+000180d0: 6063 7265 6174 655f 7375 6273 6372 6970  `create_subscrip
+000180e0: 7469 6f6e 5f74 6f5f 616c 6c28 2960 2064  tion_to_all()` d
+000180f0: 6f65 7320 6e6f 7420 7265 7475 726e 2061  oes not return a
+00018100: 2076 616c 7565 2e20 5265 636f 7264 6564   value. Recorded
+00018110: 2065 7665 6e74 7320 6172 650a 6f62 7461   events are.obta
+00018120: 696e 6564 2062 7920 6361 6c6c 696e 6720  ined by calling 
+00018130: 7468 6520 6072 6561 645f 7375 6273 6372  the `read_subscr
+00018140: 6970 7469 6f6e 5f74 6f5f 616c 6c28 2960  iption_to_all()`
+00018150: 206d 6574 686f 642e 0a0a 496e 2074 6865   method...In the
+00018160: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
+00018170: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
+00018180: 7363 7269 7074 696f 6e20 6973 2063 7265  scription is cre
+00018190: 6174 6564 2074 6f20 6f70 6572 6174 6520  ated to operate 
+000181a0: 6672 6f6d 2074 6865 0a66 6972 7374 2072  from the.first r
+000181b0: 6563 6f72 6465 6420 6e6f 6e2d 7379 7374  ecorded non-syst
+000181c0: 656d 2065 7665 6e74 2069 6e20 7468 6520  em event in the 
+000181d0: 6461 7461 6261 7365 2e0a 0a60 6060 7079  database...```py
+000181e0: 7468 6f6e 0a23 2043 7265 6174 6520 6120  thon.# Create a 
+000181f0: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00018200: 7269 7074 696f 6e2e 0a67 726f 7570 5f6e  ription..group_n
+00018210: 616d 6531 203d 2066 2267 726f 7570 2d7b  ame1 = f"group-{
+00018220: 7575 6964 2e75 7569 6434 2829 7d22 0a63  uuid.uuid4()}".c
+00018230: 6c69 656e 742e 6372 6561 7465 5f73 7562  lient.create_sub
+00018240: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
+00018250: 2867 726f 7570 5f6e 616d 653d 6772 6f75  (group_name=grou
+00018260: 705f 6e61 6d65 3129 0a60 6060 0a0a 2323  p_name1).```..##
+00018270: 2320 5265 6164 2073 7562 7363 7269 7074  # Read subscript
+00018280: 696f 6e20 746f 2061 6c6c 3c61 2069 643d  ion to all<a id=
+00018290: 2272 6561 642d 7375 6273 6372 6970 7469  "read-subscripti
+000182a0: 6f6e 2d74 6f2d 616c 6c22 3e3c 2f61 3e0a  on-to-all"></a>.
+000182b0: 0a2a 7265 7175 6972 6573 206c 6561 6465  .*requires leade
+000182c0: 722a 0a0a 5468 6520 6072 6561 645f 7375  r*..The `read_su
+000182d0: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
+000182e0: 6c28 2960 206d 6574 686f 6420 6361 6e20  l()` method can 
+000182f0: 6265 2075 7365 6420 6279 2061 2067 726f  be used by a gro
+00018300: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
+00018310: 746f 2072 6563 6569 7665 0a72 6563 6f72  to receive.recor
+00018320: 6465 6420 6576 656e 7473 2066 726f 6d20  ded events from 
+00018330: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
+00018340: 7363 7269 7074 696f 6e20 7468 6174 2068  scription that h
+00018350: 6173 2062 6565 6e20 6372 6561 7465 6420  as been created 
+00018360: 7573 696e 670a 7468 6520 6063 7265 6174  using.the `creat
+00018370: 655f 7375 6273 6372 6970 7469 6f6e 5f74  e_subscription_t
+00018380: 6f5f 616c 6c28 2960 206d 6574 686f 642e  o_all()` method.
+00018390: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+000183a0: 7320 6120 7265 7175 6972 6564 2060 6772  s a required `gr
+000183b0: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
+000183c0: 6e74 2c20 7768 6963 6820 6973 0a74 6865  nt, which is.the
+000183d0: 206e 616d 6520 6f66 2061 2022 6772 6f75   name of a "grou
+000183e0: 7022 206f 6620 636f 6e73 756d 6572 7320  p" of consumers 
+000183f0: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
+00018400: 696f 6e20 7370 6563 6966 6965 640a 7768  ion specified.wh
+00018410: 656e 2060 6372 6561 7465 5f73 7562 7363  en `create_subsc
+00018420: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
+00018430: 6020 7761 7320 6361 6c6c 6564 2e0a 0a54  ` was called...T
+00018440: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
+00018450: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
+00018460: 6f75 7460 2061 7267 756d 656e 742c 2077  out` argument, w
+00018470: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
+00018480: 2060 666c 6f61 7460 0a74 6861 7420 7365   `float`.that se
+00018490: 7473 2061 206d 6178 696d 756d 2064 7572  ts a maximum dur
+000184a0: 6174 696f 6e2c 2069 6e20 7365 636f 6e64  ation, in second
+000184b0: 732c 2066 6f72 2074 6865 2063 6f6d 706c  s, for the compl
+000184c0: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+000184d0: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+000184e0: 6973 206d 6574 686f 6420 6861 7320 616e  is method has an
+000184f0: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
+00018500: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
+00018510: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
+00018520: 7365 6420 746f 0a6f 7665 7272 6964 6520  sed to.override 
+00018530: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
+00018540: 2064 6572 6976 6564 2066 726f 6d20 7468   derived from th
+00018550: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+00018560: 696e 6720 5552 492e 0a0a 5468 6973 206d  ing URI...This m
+00018570: 6574 686f 6420 7265 7475 726e 7320 6120  ethod returns a 
+00018580: 6050 6572 7369 7374 656e 7453 7562 7363  `PersistentSubsc
+00018590: 7269 7074 696f 6e60 206f 626a 6563 742c  ription` object,
+000185a0: 2077 6869 6368 2069 7320 616e 2069 7465   which is an ite
+000185b0: 7261 746f 720a 6769 7669 6e67 2060 5265  rator.giving `Re
+000185c0: 636f 7264 6564 4576 656e 7460 206f 626a  cordedEvent` obj
+000185d0: 6563 7473 2e20 4974 2061 6c73 6f20 6861  ects. It also ha
+000185e0: 7320 6061 636b 2829 602c 2060 6e61 636b  s `ack()`, `nack
+000185f0: 2829 6020 616e 6420 6073 746f 7028 2960  ()` and `stop()`
+00018600: 0a6d 6574 686f 6473 2e0a 0a60 6060 7079  .methods...```py
+00018610: 7468 6f6e 0a73 7562 7363 7269 7074 696f  thon.subscriptio
+00018620: 6e20 3d20 636c 6965 6e74 2e72 6561 645f  n = client.read_
+00018630: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+00018640: 616c 6c28 6772 6f75 705f 6e61 6d65 3d67  all(group_name=g
+00018650: 726f 7570 5f6e 616d 6531 290a 6060 600a  roup_name1).```.
+00018660: 0a54 6865 2060 6163 6b28 2960 206d 6574  .The `ack()` met
+00018670: 686f 6420 7368 6f75 6c64 2062 6520 7573  hod should be us
+00018680: 6564 2062 7920 6120 636f 6e73 756d 6572  ed by a consumer
+00018690: 2074 6f20 2261 636b 6e6f 776c 6564 6765   to "acknowledge
+000186a0: 2220 746f 2074 6865 2073 6572 7665 7220  " to the server 
+000186b0: 7468 6174 0a69 7420 6861 7320 7265 6365  that.it has rece
+000186c0: 6976 6564 2061 6e64 2073 7563 6365 7373  ived and success
+000186d0: 6675 6c6c 7920 7072 6f63 6573 7365 6420  fully processed 
+000186e0: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
+000186f0: 2e20 5468 6973 2077 696c 6c20 7072 6576  . This will prev
+00018700: 656e 7420 7468 6174 0a72 6563 6f72 6465  ent that.recorde
+00018710: 6420 6576 656e 7420 6265 696e 6720 7265  d event being re
+00018720: 6365 6976 6564 2062 7920 616e 6f74 6865  ceived by anothe
+00018730: 7220 636f 6e73 756d 6572 2069 6e20 7468  r consumer in th
+00018740: 6520 7361 6d65 2067 726f 7570 2e20 5468  e same group. Th
+00018750: 6520 6061 636b 2829 600a 6861 7320 616e  e `ack()`.has an
+00018760: 2060 6974 656d 6020 6172 6775 6d65 6e74   `item` argument
+00018770: 2077 6869 6368 2063 616e 2062 6520 6569   which can be ei
+00018780: 7468 6572 2061 2060 5265 636f 7264 6564  ther a `Recorded
+00018790: 4576 656e 7460 206f 7220 6120 6055 5549  Event` or a `UUI
+000187a0: 4460 2e20 4966 2079 6f75 2070 6173 730a  D`. If you pass.
+000187b0: 696e 2061 2060 5265 636f 7264 6564 4576  in a `RecordedEv
+000187c0: 656e 7460 2c20 7468 6520 7661 6c75 6520  ent`, the value 
+000187d0: 6f66 2069 7473 2060 6163 6b5f 6964 6020  of its `ack_id` 
+000187e0: 6174 7472 6962 7574 6520 7769 6c6c 2062  attribute will b
+000187f0: 6520 7573 6564 2074 6f20 6163 6b6e 6f77  e used to acknow
+00018800: 6c65 6467 650a 7468 6520 6576 656e 7420  ledge.the event 
+00018810: 746f 2074 6865 2073 6572 7665 722e 2049  to the server. I
+00018820: 6620 796f 7520 7061 7373 2069 6e20 6120  f you pass in a 
+00018830: 5555 4944 2c20 7468 656e 2075 7365 6420  UUID, then used 
+00018840: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
+00018850: 2060 6163 6b5f 6964 600a 6f66 2074 6865   `ack_id`.of the
+00018860: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+00018870: 2074 6861 7420 6973 2062 6569 6e67 2061   that is being a
+00018880: 636b 6e6f 776c 6564 6765 642c 2069 6e20  cknowledged, in 
+00018890: 6361 7365 2074 6865 2065 7665 6e74 2068  case the event h
+000188a0: 6173 2062 6565 6e20 7265 736f 6c76 6564  as been resolved
+000188b0: 0a66 726f 6d20 6120 6c69 6e6b 2065 7665  .from a link eve
+000188c0: 6e74 2028 7768 6963 6820 6361 6e20 6861  nt (which can ha
+000188d0: 7070 656e 2062 6f74 6820 7768 656e 2070  ppen both when p
+000188e0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+000188f0: 6970 7469 6f6e 2073 6574 7469 6e67 0a60  iption setting.`
+00018900: 7265 736f 6c76 655f 6c69 6e6b 7360 2069  resolve_links` i
+00018910: 7320 6054 7275 6560 2061 6e64 2061 6c73  s `True` and als
+00018920: 6f20 7768 656e 2072 6570 6c61 7969 6e67  o when replaying
+00018930: 2070 6172 6b65 6420 6576 656e 7473 2072   parked events r
+00018940: 6567 6172 646c 6573 7320 6f66 2074 6865  egardless of the
+00018950: 0a60 7265 736f 6c76 655f 6c69 6e6b 7360  .`resolve_links`
+00018960: 2073 6574 7469 6e67 292e 0a0a 5468 6520   setting)...The 
+00018970: 6578 616d 706c 6520 6265 6c6f 7720 6974  example below it
+00018980: 6572 6174 6573 206f 7665 7220 7468 6520  erates over the 
+00018990: 7375 6273 6372 6970 7469 6f6e 206f 626a  subscription obj
+000189a0: 6563 742c 2061 6e64 2063 616c 6c73 2060  ect, and calls `
+000189b0: 6163 6b28 2960 2077 6974 6820 7468 650a  ack()` with the.
+000189c0: 7265 6365 6976 6564 2060 5265 636f 7264  received `Record
+000189d0: 6564 4576 656e 7460 206f 626a 6563 7473  edEvent` objects
+000189e0: 2e20 5468 6520 7375 6273 6372 6970 7469  . The subscripti
+000189f0: 6f6e 2773 2060 7374 6f70 2829 6020 6d65  on's `stop()` me
+00018a00: 7468 6f64 2069 7320 6361 6c6c 6564 2077  thod is called w
+00018a10: 6865 6e0a 7765 2068 6176 6520 7265 6365  hen.we have rece
+00018a20: 6976 6564 2060 6576 656e 7439 602c 2073  ived `event9`, s
+00018a30: 746f 7070 696e 6720 7468 6520 6974 6572  topping the iter
+00018a40: 6174 696f 6e2c 2073 6f20 7468 6174 2077  ation, so that w
+00018a50: 6520 6361 6e20 636f 6e74 696e 7565 2077  e can continue w
+00018a60: 6974 6820 7468 650a 6578 616d 706c 6573  ith the.examples
+00018a70: 2062 656c 6f77 2e0a 0a60 6060 7079 7468   below...```pyth
+00018a80: 6f6e 0a72 6563 6569 7665 645f 6576 656e  on.received_even
+00018a90: 7473 203d 205b 5d0a 0a66 6f72 2065 7665  ts = []..for eve
+00018aa0: 6e74 2069 6e20 7375 6273 6372 6970 7469  nt in subscripti
+00018ab0: 6f6e 3a0a 2020 2020 7265 6365 6976 6564  on:.    received
+00018ac0: 5f65 7665 6e74 732e 6170 7065 6e64 2865  _events.append(e
+00018ad0: 7665 6e74 290a 0a20 2020 2023 2041 636b  vent)..    # Ack
+00018ae0: 6e6f 776c 6564 6765 2074 6865 2072 6563  nowledge the rec
+00018af0: 6569 7665 6420 6576 656e 742e 0a20 2020  eived event..   
+00018b00: 2073 7562 7363 7269 7074 696f 6e2e 6163   subscription.ac
+00018b10: 6b28 6576 656e 7429 0a0a 2020 2020 2320  k(event)..    # 
+00018b20: 5374 6f70 2077 6865 6e20 2765 7665 6e74  Stop when 'event
+00018b30: 3927 2068 6173 2062 6565 6e20 7265 6365  9' has been rece
+00018b40: 6976 6564 2e0a 2020 2020 6966 2065 7665  ived..    if eve
+00018b50: 6e74 203d 3d20 6576 656e 7439 3a0a 2020  nt == event9:.  
+00018b60: 2020 2020 2020 7375 6273 6372 6970 7469        subscripti
+00018b70: 6f6e 2e73 746f 7028 290a 6060 600a 0a54  on.stop().```..T
+00018b80: 6865 2060 6e61 636b 2829 6020 7368 6f75  he `nack()` shou
+00018b90: 6c64 2062 6520 7573 6564 2062 7920 6120  ld be used by a 
+00018ba0: 636f 6e73 756d 6572 2074 6f20 226e 6567  consumer to "neg
+00018bb0: 6174 6976 656c 7920 6163 6b6e 6f77 6c65  atively acknowle
+00018bc0: 6467 6522 2074 6f20 7468 6520 7365 7276  dge" to the serv
+00018bd0: 6572 2074 6861 740a 6974 2068 6173 2072  er that.it has r
+00018be0: 6563 6569 7665 6420 6275 7420 6e6f 7420  eceived but not 
+00018bf0: 7375 6363 6573 7366 756c 6c79 2070 726f  successfully pro
+00018c00: 6365 7373 6564 2061 2072 6563 6f72 6465  cessed a recorde
+00018c10: 6420 6576 656e 742e 2054 6865 2060 6e61  d event. The `na
+00018c20: 636b 2829 6020 6d65 7468 6f64 2068 6173  ck()` method has
+00018c30: 0a61 6e20 6069 7465 6d60 2061 7267 756d  .an `item` argum
+00018c40: 656e 7420 7468 6174 2077 6f72 6b73 2069  ent that works i
+00018c50: 6e20 7468 6520 7361 6d65 2077 6179 2061  n the same way a
+00018c60: 7320 6061 636b 2829 602e 2055 7365 2074  s `ack()`. Use t
+00018c70: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00018c80: 7420 6f72 2069 7473 0a60 6163 6b5f 6964  t or its.`ack_id
+00018c90: 6020 6174 7472 6962 7574 652e 2054 6865  ` attribute. The
+00018ca0: 2060 6e61 636b 2829 6020 6d65 7468 6f64   `nack()` method
+00018cb0: 2061 6c73 6f20 6861 7320 616e 2060 6163   also has an `ac
+00018cc0: 7469 6f6e 6020 6172 6775 6d65 6e74 2c20  tion` argument, 
+00018cd0: 7768 6963 6820 7368 6f75 6c64 2062 650a  which should be.
+00018ce0: 6120 5079 7468 6f6e 2060 7374 7260 3a20  a Python `str`: 
+00018cf0: 6569 7468 6572 2060 2775 6e6b 6e6f 776e  either `'unknown
+00018d00: 2760 2c20 6027 7061 726b 2760 2c20 6027  '`, `'park'`, `'
+00018d10: 7265 7472 7927 602c 2060 2773 6b69 7027  retry'`, `'skip'
+00018d20: 6020 6f72 2060 2773 746f 7027 602e 0a0a  ` or `'stop'`...
+00018d30: 5468 6520 6073 746f 7028 2960 206d 6574  The `stop()` met
+00018d40: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
+00018d50: 746f 2073 746f 7020 7468 6520 6752 5043  to stop the gRPC
+00018d60: 2073 7472 6561 6d69 6e67 206f 7065 7261   streaming opera
+00018d70: 7469 6f6e 2e0a 0a23 2323 2048 6f77 2074  tion...### How t
+00018d80: 6f20 7772 6974 6520 6120 7065 7273 6973  o write a persis
+00018d90: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00018da0: 6e20 636f 6e73 756d 6572 3c61 2069 643d  n consumer<a id=
+00018db0: 2268 6f77 2d74 6f2d 7772 6974 652d 612d  "how-to-write-a-
+00018dc0: 7065 7273 6973 7465 6e74 2d73 7562 7363  persistent-subsc
+00018dd0: 7269 7074 696f 6e2d 636f 6e73 756d 6572  ription-consumer
+00018de0: 223e 3c2f 613e 0a0a 5468 6520 7265 6164  "></a>..The read
+00018df0: 696e 6720 6f66 2061 2070 6572 7369 7374  ing of a persist
+00018e00: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00018e10: 2063 616e 2062 6520 656e 6361 7073 756c   can be encapsul
+00018e20: 6174 6564 2069 6e20 6120 2263 6f6e 7375  ated in a "consu
+00018e30: 6d65 7222 2074 6861 7420 6361 6c6c 730a  mer" that calls.
+00018e40: 6120 2270 6f6c 6963 7922 2066 756e 6374  a "policy" funct
+00018e50: 696f 6e20 7768 656e 2061 2072 6563 6f72  ion when a recor
+00018e60: 6465 6420 6576 656e 7420 6973 2072 6563  ded event is rec
+00018e70: 6569 7665 6420 616e 6420 7468 656e 2061  eived and then a
+00018e80: 7574 6f6d 6174 6963 616c 6c79 2063 616c  utomatically cal
+00018e90: 6c73 0a60 6163 6b28 2960 2069 6620 7468  ls.`ack()` if th
+00018ea0: 6520 706f 6c69 6379 2066 756e 6374 696f  e policy functio
+00018eb0: 6e20 7265 7475 726e 7320 6e6f 726d 616c  n returns normal
+00018ec0: 6c79 2c20 616e 6420 606e 6163 6b28 2960  ly, and `nack()`
+00018ed0: 2069 6620 6974 2072 6169 7365 7320 616e   if it raises an
+00018ee0: 2065 7863 6570 7469 6f6e 2c0a 7065 7268   exception,.perh
+00018ef0: 6170 7320 7265 7472 7969 6e67 2074 6865  aps retrying the
+00018f00: 2065 7665 6e74 2066 6f72 2061 2063 6572   event for a cer
+00018f10: 7461 696e 206e 756d 6265 7220 6f66 2074  tain number of t
+00018f20: 696d 6573 2062 6566 6f72 6520 7061 726b  imes before park
+00018f30: 696e 6720 7468 6520 6576 656e 742e 0a0a  ing the event...
+00018f40: 5468 6520 7369 6d70 6c65 2065 7861 6d70  The simple examp
+00018f50: 6c65 2062 656c 6f77 2073 686f 7773 2068  le below shows h
+00018f60: 6f77 2074 6869 7320 6d69 6768 7420 6265  ow this might be
+00018f70: 2064 6f6e 652e 2057 6520 6361 6e20 7365   done. We can se
+00018f80: 6520 7468 6174 2027 6576 656e 7439 2720  e that 'event9' 
+00018f90: 6973 0a61 636b 6e6f 776c 6564 6765 6420  is.acknowledged 
+00018fa0: 6265 666f 7265 2027 6576 656e 7435 2720  before 'event5' 
+00018fb0: 6973 2066 696e 616c 6c79 2070 6172 6b65  is finally parke
+00018fc0: 642e 0a0a 5468 6520 206e 756d 6265 7220  d...The  number 
+00018fd0: 6f66 2074 696d 6520 6120 6052 6563 6f72  of time a `Recor
+00018fe0: 6465 6445 7665 6e74 6020 6861 7320 6265  dedEvent` has be
+00018ff0: 656e 2072 6574 7269 6564 2069 7320 7072  en retried is pr
+00019000: 6573 656e 7465 6420 6279 2074 6865 2069  esented by the i
+00019010: 7473 0a60 7265 7472 795f 636f 756e 7460  ts.`retry_count`
+00019020: 2061 7474 7269 6275 7465 2e0a 0a60 6060   attribute...```
+00019030: 7079 7468 6f6e 0a61 636b 6564 5f65 7665  python.acked_eve
+00019040: 6e74 7320 3d20 7b7d 0a6e 6163 6b65 645f  nts = {}.nacked_
+00019050: 6576 656e 7473 203d 207b 7d0a 0a0a 636c  events = {}...cl
+00019060: 6173 7320 4578 616d 706c 6543 6f6e 7375  ass ExampleConsu
+00019070: 6d65 723a 0a20 2020 2064 6566 205f 5f69  mer:.    def __i
+00019080: 6e69 745f 5f28 7365 6c66 2c20 7375 6273  nit__(self, subs
+00019090: 6372 6970 7469 6f6e 2c20 6d61 785f 7265  cription, max_re
+000190a0: 7472 795f 636f 756e 742c 2066 696e 616c  try_count, final
+000190b0: 5f61 6374 696f 6e29 3a0a 2020 2020 2020  _action):.      
+000190c0: 2020 7365 6c66 2e73 7562 7363 7269 7074    self.subscript
+000190d0: 696f 6e20 3d20 7375 6273 6372 6970 7469  ion = subscripti
+000190e0: 6f6e 0a20 2020 2020 2020 2073 656c 662e  on.        self.
+000190f0: 6d61 785f 7265 7472 795f 636f 756e 7420  max_retry_count 
+00019100: 3d20 6d61 785f 7265 7472 795f 636f 756e  = max_retry_coun
+00019110: 740a 2020 2020 2020 2020 7365 6c66 2e66  t.        self.f
+00019120: 696e 616c 5f61 6374 696f 6e20 3d20 6669  inal_action = fi
+00019130: 6e61 6c5f 6163 7469 6f6e 0a20 2020 2020  nal_action.     
+00019140: 2020 2073 656c 662e 6572 726f 7220 3d20     self.error = 
+00019150: 4e6f 6e65 0a0a 2020 2020 6465 6620 7275  None..    def ru
+00019160: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
+00019170: 2077 6974 6820 7365 6c66 2e73 7562 7363   with self.subsc
+00019180: 7269 7074 696f 6e3a 0a20 2020 2020 2020  ription:.       
+00019190: 2020 2020 2066 6f72 2065 7665 6e74 2069       for event i
+000191a0: 6e20 7365 6c66 2e73 7562 7363 7269 7074  n self.subscript
+000191b0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+000191c0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+000191d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000191e0: 6c66 2e70 6f6c 6963 7928 6576 656e 7429  lf.policy(event)
+000191f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019200: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+00019210: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+00019220: 2020 2020 2020 2069 6620 6576 656e 742e         if event.
+00019230: 7265 7472 795f 636f 756e 7420 3c20 7365  retry_count < se
+00019240: 6c66 2e6d 6178 5f72 6574 7279 5f63 6f75  lf.max_retry_cou
+00019250: 6e74 3a0a 2020 2020 2020 2020 2020 2020  nt:.            
+00019260: 2020 2020 2020 2020 2020 2020 6163 7469              acti
+00019270: 6f6e 203d 2022 7265 7472 7922 0a20 2020  on = "retry".   
+00019280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019290: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000192a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000192b0: 6374 696f 6e20 3d20 7365 6c66 2e66 696e  ction = self.fin
+000192c0: 616c 5f61 6374 696f 6e0a 2020 2020 2020  al_action.      
+000192d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000192e0: 6c66 2e73 7562 7363 7269 7074 696f 6e2e  lf.subscription.
+000192f0: 6e61 636b 2865 7665 6e74 2c20 6163 7469  nack(event, acti
+00019300: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
+00019310: 2020 2020 2020 2020 7365 6c66 2e61 6674          self.aft
+00019320: 6572 5f6e 6163 6b28 6576 656e 742c 2061  er_nack(event, a
+00019330: 6374 696f 6e29 0a20 2020 2020 2020 2020  ction).         
+00019340: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00019350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019360: 2073 656c 662e 7375 6273 6372 6970 7469   self.subscripti
+00019370: 6f6e 2e61 636b 2865 7665 6e74 290a 2020  on.ack(event).  
+00019380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019390: 2020 7365 6c66 2e61 6674 6572 5f61 636b    self.after_ack
+000193a0: 2865 7665 6e74 290a 0a20 2020 2064 6566  (event)..    def
+000193b0: 2073 746f 7028 7365 6c66 293a 0a20 2020   stop(self):.   
+000193c0: 2020 2020 2073 656c 662e 7375 6273 6372       self.subscr
+000193d0: 6970 7469 6f6e 2e73 746f 7028 290a 0a20  iption.stop().. 
+000193e0: 2020 2064 6566 2070 6f6c 6963 7928 7365     def policy(se
+000193f0: 6c66 2c20 6576 656e 7429 3a0a 2020 2020  lf, event):.    
+00019400: 2020 2020 2320 5261 6973 6520 616e 2065      # Raise an e
+00019410: 7863 6570 7469 6f6e 2077 6865 6e20 7765  xception when we
+00019420: 2073 6565 2022 6576 656e 7435 222e 0a20   see "event5".. 
+00019430: 2020 2020 2020 2069 6620 6576 656e 7420         if event 
+00019440: 3d3d 2065 7665 6e74 353a 0a20 2020 2020  == event5:.     
+00019450: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+00019460: 6570 7469 6f6e 2829 0a0a 2020 2020 6465  eption()..    de
+00019470: 6620 6166 7465 725f 6163 6b28 7365 6c66  f after_ack(self
+00019480: 2c20 6576 656e 7429 3a0a 2020 2020 2020  , event):.      
+00019490: 2020 2320 5472 6163 6b20 7265 7472 7920    # Track retry 
+000194a0: 636f 756e 7420 6f66 2061 636b 6564 2065  count of acked e
+000194b0: 7665 6e74 732e 0a20 2020 2020 2020 2061  vents..        a
+000194c0: 636b 6564 5f65 7665 6e74 735b 6576 656e  cked_events[even
+000194d0: 742e 6964 5d20 3d20 6576 656e 742e 7265  t.id] = event.re
+000194e0: 7472 795f 636f 756e 740a 0a20 2020 2064  try_count..    d
+000194f0: 6566 2061 6674 6572 5f6e 6163 6b28 7365  ef after_nack(se
+00019500: 6c66 2c20 6576 656e 742c 2061 6374 696f  lf, event, actio
+00019510: 6e29 3a0a 2020 2020 2020 2020 2320 5472  n):.        # Tr
+00019520: 6163 6b20 7265 7472 7920 636f 756e 7420  ack retry count 
+00019530: 6f66 206e 6163 6b65 6420 6576 656e 7473  of nacked events
+00019540: 2e0a 2020 2020 2020 2020 6e61 636b 6564  ..        nacked
+00019550: 5f65 7665 6e74 735b 6576 656e 742e 6964  _events[event.id
+00019560: 5d20 3d20 6576 656e 742e 7265 7472 795f  ] = event.retry_
+00019570: 636f 756e 740a 0a20 2020 2020 2020 2069  count..        i
+00019580: 6620 6163 7469 6f6e 203d 3d20 7365 6c66  f action == self
+00019590: 2e66 696e 616c 5f61 6374 696f 6e3a 0a20  .final_action:. 
+000195a0: 2020 2020 2020 2020 2020 2023 2053 746f             # Sto
+000195b0: 7020 7468 6520 636f 6e73 756d 6572 2c20  p the consumer, 
+000195c0: 736f 2077 6520 6361 6e20 636f 6e74 696e  so we can contin
+000195d0: 7565 2077 6974 6820 7468 6520 6578 616d  ue with the exam
+000195e0: 706c 6573 2e0a 2020 2020 2020 2020 2020  ples..          
+000195f0: 2020 7365 6c66 2e73 746f 7028 290a 0a0a    self.stop()...
+00019600: 2320 4372 6561 7465 2073 7562 7363 7269  # Create subscri
+00019610: 7074 696f 6e2e 0a67 726f 7570 5f6e 616d  ption..group_nam
+00019620: 6520 3d20 6622 6772 6f75 702d 7b75 7569  e = f"group-{uui
+00019630: 642e 7575 6964 3428 297d 220a 636c 6965  d.uuid4()}".clie
+00019640: 6e74 2e63 7265 6174 655f 7375 6273 6372  nt.create_subscr
+00019650: 6970 7469 6f6e 5f74 6f5f 616c 6c28 6772  iption_to_all(gr
+00019660: 6f75 705f 6e61 6d65 2c20 636f 6d6d 6974  oup_name, commit
+00019670: 5f70 6f73 6974 696f 6e3d 636f 6d6d 6974  _position=commit
+00019680: 5f70 6f73 6974 696f 6e31 290a 0a23 2052  _position1)..# R
+00019690: 6561 6420 7375 6273 6372 6970 7469 6f6e  ead subscription
+000196a0: 2e0a 7375 6273 6372 6970 7469 6f6e 203d  ..subscription =
+000196b0: 2063 6c69 656e 742e 7265 6164 5f73 7562   client.read_sub
+000196c0: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
+000196d0: 2867 726f 7570 5f6e 616d 6529 0a0a 2320  (group_name)..# 
+000196e0: 436f 6e73 7472 7563 7420 636f 6e73 756d  Construct consum
+000196f0: 6572 2e0a 636f 6e73 756d 6572 203d 2045  er..consumer = E
+00019700: 7861 6d70 6c65 436f 6e73 756d 6572 280a  xampleConsumer(.
+00019710: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
+00019720: 3d73 7562 7363 7269 7074 696f 6e2c 0a20  =subscription,. 
+00019730: 2020 206d 6178 5f72 6574 7279 5f63 6f75     max_retry_cou
+00019740: 6e74 3d35 2c0a 2020 2020 6669 6e61 6c5f  nt=5,.    final_
+00019750: 6163 7469 6f6e 3d22 7061 726b 222c 0a29  action="park",.)
+00019760: 0a0a 2320 5275 6e20 636f 6e73 756d 6572  ..# Run consumer
+00019770: 2e0a 636f 6e73 756d 6572 2e72 756e 2829  ..consumer.run()
+00019780: 0a0a 2320 4368 6563 6b20 2765 7665 6e74  ..# Check 'event
+00019790: 3527 2077 6173 206e 6163 6b65 6420 616e  5' was nacked an
+000197a0: 6420 6e65 7665 7220 6163 6b65 642e 0a61  d never acked..a
+000197b0: 7373 6572 7420 6576 656e 7435 2e69 6420  ssert event5.id 
+000197c0: 696e 206e 6163 6b65 645f 6576 656e 7473  in nacked_events
+000197d0: 0a61 7373 6572 7420 6576 656e 7435 2e69  .assert event5.i
+000197e0: 6420 6e6f 7420 696e 2061 636b 6564 5f65  d not in acked_e
+000197f0: 7665 6e74 730a 6173 7365 7274 206e 6163  vents.assert nac
+00019800: 6b65 645f 6576 656e 7473 5b65 7665 6e74  ked_events[event
+00019810: 352e 6964 5d20 3d3d 2035 0a0a 2320 4368  5.id] == 5..# Ch
+00019820: 6563 6b20 2765 7665 6e74 3927 2077 6173  eck 'event9' was
+00019830: 2061 636b 6564 2061 6e64 206e 6576 6572   acked and never
+00019840: 206e 6163 6b65 642e 0a61 7373 6572 7420   nacked..assert 
+00019850: 6576 656e 7439 2e69 6420 696e 2061 636b  event9.id in ack
+00019860: 6564 5f65 7665 6e74 730a 6173 7365 7274  ed_events.assert
+00019870: 2065 7665 6e74 392e 6964 206e 6f74 2069   event9.id not i
+00019880: 6e20 6e61 636b 6564 5f65 7665 6e74 730a  n nacked_events.
+00019890: 6060 600a 0a23 2323 2055 7064 6174 6520  ```..### Update 
+000198a0: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
+000198b0: 616c 6c3c 6120 6964 3d22 7570 6461 7465  all<a id="update
+000198c0: 2d73 7562 7363 7269 7074 696f 6e2d 746f  -subscription-to
+000198d0: 2d61 6c6c 223e 3c2f 613e 0a0a 2a72 6571  -all"></a>..*req
+000198e0: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
+000198f0: 6865 2060 7570 6461 7465 5f73 7562 7363  he `update_subsc
+00019900: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
+00019910: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
+00019920: 7573 6564 2074 6f20 7570 6461 7465 2061  used to update a
+00019930: 0a22 7065 7273 6973 7465 6e74 2073 7562  ."persistent sub
+00019940: 7363 7269 7074 696f 6e22 2e20 506c 6561  scription". Plea
+00019950: 7365 206e 6f74 652c 2074 6865 2066 696c  se note, the fil
+00019960: 7465 7220 6f70 7469 6f6e 7320 616e 6420  ter options and 
+00019970: 636f 6e73 756d 6572 0a73 7472 6174 6567  consumer.strateg
+00019980: 7920 6361 6e6e 6f74 2062 6520 6164 6a75  y cannot be adju
+00019990: 7374 6564 2e0a 0a54 6869 7320 6d65 7468  sted...This meth
+000199a0: 6f64 2068 6173 2061 2072 6571 7569 7265  od has a require
+000199b0: 6420 6067 726f 7570 5f6e 616d 6560 2061  d `group_name` a
+000199c0: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
+000199d0: 7320 7468 650a 6e61 6d65 206f 6620 6120  s the.name of a 
+000199e0: 2267 726f 7570 2220 6f66 2063 6f6e 7375  "group" of consu
+000199f0: 6d65 7273 206f 6620 7468 6520 7375 6273  mers of the subs
+00019a00: 6372 6970 7469 6f6e 2e0a 0a54 6869 7320  cription...This 
+00019a10: 6d65 7468 6f64 2061 6c73 6f20 6861 7320  method also has 
+00019a20: 7369 7874 6565 6e20 6f70 7469 6f6e 616c  sixteen optional
+00019a30: 2061 7267 756d 656e 7473 2c20 6066 726f   arguments, `fro
+00019a40: 6d5f 656e 6460 2c20 6063 6f6d 6d69 745f  m_end`, `commit_
+00019a50: 706f 7369 7469 6f6e 602c 0a60 7265 736f  position`,.`reso
+00019a60: 6c76 655f 6c69 6e6b 7360 2c20 6063 6f6e  lve_links`, `con
+00019a70: 7375 6d65 725f 7374 7261 7465 6779 602c  sumer_strategy`,
+00019a80: 2060 6d65 7373 6167 655f 7469 6d65 6f75   `message_timeou
+00019a90: 7460 2c20 606d 6178 5f72 6574 7279 5f63  t`, `max_retry_c
+00019aa0: 6f75 6e74 602c 0a60 6d69 6e5f 6368 6563  ount`,.`min_chec
+00019ab0: 6b70 6f69 6e74 5f63 6f75 6e74 602c 2060  kpoint_count`, `
+00019ac0: 6d61 785f 6368 6563 6b70 6f69 6e74 5f63  max_checkpoint_c
+00019ad0: 6f75 6e74 602c 2060 6368 6563 6b70 6f69  ount`, `checkpoi
+00019ae0: 6e74 5f61 6674 6572 602c 0a60 6d61 785f  nt_after`,.`max_
+00019af0: 7375 6273 6372 6962 6572 5f63 6f75 6e74  subscriber_count
+00019b00: 602c 2060 6c69 7665 5f62 7566 6665 725f  `, `live_buffer_
+00019b10: 7369 7a65 602c 2060 7265 6164 5f62 6174  size`, `read_bat
+00019b20: 6368 5f73 697a 6560 2c20 6068 6973 746f  ch_size`, `histo
+00019b30: 7279 5f62 7566 6665 725f 7369 7a65 602c  ry_buffer_size`,
+00019b40: 0a60 6578 7472 615f 7374 6174 6973 7469  .`extra_statisti
+00019b50: 6373 602c 2060 7469 6d65 6f75 7460 2061  cs`, `timeout` a
+00019b60: 6e64 2060 6372 6564 656e 7469 616c 7360  nd `credentials`
+00019b70: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00019b80: 6172 6775 6d65 6e74 7320 6066 726f 6d5f  arguments `from_
+00019b90: 656e 6460 2c20 6063 6f6d 6d69 745f 706f  end`, `commit_po
+00019ba0: 7369 7469 6f6e 602c 0a60 7265 736f 6c76  sition`,.`resolv
+00019bb0: 655f 6c69 6e6b 7360 2c20 6063 6f6e 7375  e_links`, `consu
+00019bc0: 6d65 725f 7374 7261 7465 6779 602c 2060  mer_strategy`, `
+00019bd0: 6d65 7373 6167 655f 7469 6d65 6f75 7460  message_timeout`
+00019be0: 2c20 606d 6178 5f72 6574 7279 5f63 6f75  , `max_retry_cou
+00019bf0: 6e74 602c 0a60 6d69 6e5f 6368 6563 6b70  nt`,.`min_checkp
+00019c00: 6f69 6e74 5f63 6f75 6e74 602c 2060 6d61  oint_count`, `ma
+00019c10: 785f 6368 6563 6b70 6f69 6e74 5f63 6f75  x_checkpoint_cou
+00019c20: 6e74 602c 2060 6368 6563 6b70 6f69 6e74  nt`, `checkpoint
+00019c30: 5f61 6674 6572 602c 0a60 6d61 785f 7375  _after`,.`max_su
+00019c40: 6273 6372 6962 6572 5f63 6f75 6e74 602c  bscriber_count`,
+00019c50: 2060 6c69 7665 5f62 7566 6665 725f 7369   `live_buffer_si
+00019c60: 7a65 602c 2060 7265 6164 5f62 6174 6368  ze`, `read_batch
+00019c70: 5f73 697a 6560 2c20 6068 6973 746f 7279  _size`, `history
+00019c80: 5f62 7566 6665 725f 7369 7a65 602c 0a61  _buffer_size`,.a
+00019c90: 6d64 2060 6578 7472 615f 7374 6174 6973  md `extra_statis
+00019ca0: 7469 6373 6020 6361 6e20 6265 2075 7365  tics` can be use
+00019cb0: 6420 746f 2061 646a 7573 7420 7468 6520  d to adjust the 
+00019cc0: 7661 6c75 6573 2073 6574 206f 6e20 7072  values set on pr
+00019cd0: 6576 696f 7573 2063 616c 6c73 2074 6f0a  evious calls to.
+00019ce0: 6063 7265 6174 655f 7375 6273 6372 6970  `create_subscrip
+00019cf0: 7469 6f6e 5f74 6f5f 616c 6c28 2960 2061  tion_to_all()` a
+00019d00: 6e64 2060 7570 6461 7465 5f73 7562 7363  nd `update_subsc
+00019d10: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
+00019d20: 602e 2049 6620 616e 7920 6f66 0a74 6865  `. If any of.the
+00019d30: 7365 2061 7267 756d 656e 7473 2061 7265  se arguments are
+00019d40: 206e 6f74 206d 656e 7469 6f6e 6564 2069   not mentioned i
+00019d50: 6e20 6120 6361 6c6c 2074 6f20 6075 7064  n a call to `upd
+00019d60: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+00019d70: 5f74 6f5f 616c 6c28 2960 2c0a 7468 6520  _to_all()`,.the 
+00019d80: 636f 7272 6573 706f 6e64 696e 6720 7365  corresponding se
+00019d90: 7474 696e 6773 206f 6620 7468 6520 7065  ttings of the pe
+00019da0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+00019db0: 7074 696f 6e20 7769 6c6c 2062 6520 756e  ption will be un
+00019dc0: 6368 616e 6765 642e 0a0a 5468 6520 6f70  changed...The op
+00019dd0: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00019de0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00019df0: 7974 686f 6e20 6066 6c6f 6174 6020 7768  ython `float` wh
+00019e00: 6963 6820 7365 7473 2061 0a6d 6178 696d  ich sets a.maxim
+00019e10: 756d 2064 7572 6174 696f 6e2c 2069 6e20  um duration, in 
+00019e20: 7365 636f 6e64 732c 2066 6f72 2074 6865  seconds, for the
+00019e30: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+00019e40: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+00019e50: 6e2e 0a0a 5468 6520 6f70 7469 6f6e 616c  n...The optional
+00019e60: 2060 6372 6564 656e 7469 616c 7360 2061   `credentials` a
+00019e70: 7267 756d 656e 7420 6361 6e20 6265 2075  rgument can be u
+00019e80: 7365 6420 746f 0a6f 7665 7272 6964 6520  sed to.override 
+00019e90: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
+00019ea0: 2064 6572 6976 6564 2066 726f 6d20 7468   derived from th
+00019eb0: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+00019ec0: 696e 6720 5552 492e 0a0a 5468 6520 6d65  ing URI...The me
+00019ed0: 7468 6f64 2060 7570 6461 7465 5f73 7562  thod `update_sub
+00019ee0: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
+00019ef0: 2829 6020 646f 6573 206e 6f74 2072 6574  ()` does not ret
+00019f00: 7572 6e20 6120 7661 6c75 652e 0a0a 496e  urn a value...In
+00019f10: 2074 6865 2065 7861 6d70 6c65 2062 656c   the example bel
+00019f20: 6f77 2c20 6120 7065 7273 6973 7465 6e74  ow, a persistent
+00019f30: 2073 7562 7363 7269 7074 696f 6e20 6973   subscription is
+00019f40: 2075 7064 6174 6564 2074 6f20 7275 6e20   updated to run 
+00019f50: 6672 6f6d 2074 6865 2065 6e64 206f 6620  from the end of 
+00019f60: 7468 650a 6461 7461 6261 7365 2e0a 0a60  the.database...`
+00019f70: 6060 7079 7468 6f6e 0a23 2043 7265 6174  ``python.# Creat
+00019f80: 6520 6120 7065 7273 6973 7465 6e74 2073  e a persistent s
+00019f90: 7562 7363 7269 7074 696f 6e2e 0a63 6c69  ubscription..cli
+00019fa0: 656e 742e 7570 6461 7465 5f73 7562 7363  ent.update_subsc
+00019fb0: 7269 7074 696f 6e5f 746f 5f61 6c6c 2867  ription_to_all(g
+00019fc0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
+00019fd0: 6e61 6d65 312c 2066 726f 6d5f 656e 643d  name1, from_end=
+00019fe0: 5472 7565 290a 6060 600a 0a23 2323 2043  True).```..### C
+00019ff0: 7265 6174 6520 7375 6273 6372 6970 7469  reate subscripti
+0001a000: 6f6e 2074 6f20 7374 7265 616d 3c61 2069  on to stream<a i
+0001a010: 643d 2263 7265 6174 652d 7375 6273 6372  d="create-subscr
+0001a020: 6970 7469 6f6e 2d74 6f2d 7374 7265 616d  iption-to-stream
+0001a030: 223e 3c2f 613e 0a0a 2a72 6571 7569 7265  "></a>..*require
+0001a040: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
+0001a050: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
+0001a060: 696f 6e5f 746f 5f73 7472 6561 6d28 2960  ion_to_stream()`
+0001a070: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+0001a080: 7365 6420 746f 2063 7265 6174 6520 6120  sed to create a 
+0001a090: 7065 7273 6973 7465 6e74 0a73 7562 7363  persistent.subsc
+0001a0a0: 7269 7074 696f 6e20 746f 2061 2073 7472  ription to a str
+0001a0b0: 6561 6d2e 0a0a 5468 6973 206d 6574 686f  eam...This metho
+0001a0c0: 6420 6861 7320 7477 6f20 7265 7175 6972  d has two requir
+0001a0d0: 6564 2061 7267 756d 656e 7473 2c20 6067  ed arguments, `g
+0001a0e0: 726f 7570 5f6e 616d 6560 2061 6e64 2060  roup_name` and `
+0001a0f0: 7374 7265 616d 5f6e 616d 6560 2e20 5468  stream_name`. Th
+0001a100: 650a 6067 726f 7570 5f6e 616d 6560 2061  e.`group_name` a
+0001a110: 7267 756d 656e 7420 6e61 6d65 7320 7468  rgument names th
+0001a120: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+0001a130: 6d65 7273 2074 6861 7420 7769 6c6c 2072  mers that will r
+0001a140: 6563 6569 7665 2065 7665 6e74 730a 6672  eceive events.fr
+0001a150: 6f6d 2074 6869 7320 7375 6273 6372 6970  om this subscrip
+0001a160: 7469 6f6e 2e20 5468 6520 6073 7472 6561  tion. The `strea
+0001a170: 6d5f 6e61 6d65 6020 6172 6775 6d65 6e74  m_name` argument
+0001a180: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
+0001a190: 2073 7472 6561 6d0a 7468 6520 7375 6273   stream.the subs
+0001a1a0: 6372 6970 7469 6f6e 2077 696c 6c20 666f  cription will fo
+0001a1b0: 6c6c 6f77 2e20 5468 6520 7661 6c75 6573  llow. The values
+0001a1c0: 206f 6620 626f 7468 2074 6865 7365 2061   of both these a
+0001a1d0: 7267 756d 656e 7473 2061 7265 2065 7870  rguments are exp
+0001a1e0: 6563 7465 640a 746f 2062 6520 5079 7468  ected.to be Pyth
+0001a1f0: 6f6e 2060 7374 7260 206f 626a 6563 7473  on `str` objects
+0001a200: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
+0001a210: 6c73 6f20 6861 7320 7369 7874 6565 6e20  lso has sixteen 
+0001a220: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+0001a230: 7473 2c20 6073 7472 6561 6d5f 706f 7369  ts, `stream_posi
+0001a240: 7469 6f6e 602c 2060 6672 6f6d 5f65 6e64  tion`, `from_end
+0001a250: 602c 0a60 7265 736f 6c76 655f 6c69 6e6b  `,.`resolve_link
+0001a260: 7360 2c20 6063 6f6e 7375 6d65 725f 7374  s`, `consumer_st
+0001a270: 7261 7465 6779 602c 2060 6d65 7373 6167  rategy`, `messag
+0001a280: 655f 7469 6d65 6f75 7460 2c20 606d 6178  e_timeout`, `max
+0001a290: 5f72 6574 7279 5f63 6f75 6e74 602c 0a60  _retry_count`,.`
+0001a2a0: 6d69 6e5f 6368 6563 6b70 6f69 6e74 5f63  min_checkpoint_c
+0001a2b0: 6f75 6e74 602c 2060 6d61 785f 6368 6563  ount`, `max_chec
+0001a2c0: 6b70 6f69 6e74 5f63 6f75 6e74 602c 2060  kpoint_count`, `
+0001a2d0: 6368 6563 6b70 6f69 6e74 5f61 6674 6572  checkpoint_after
+0001a2e0: 602c 0a60 6d61 785f 7375 6273 6372 6962  `,.`max_subscrib
+0001a2f0: 6572 5f63 6f75 6e74 602c 2060 6c69 7665  er_count`, `live
+0001a300: 5f62 7566 6665 725f 7369 7a65 602c 2060  _buffer_size`, `
+0001a310: 7265 6164 5f62 6174 6368 5f73 697a 6560  read_batch_size`
+0001a320: 2c20 6068 6973 746f 7279 5f62 7566 6665  , `history_buffe
+0001a330: 725f 7369 7a65 602c 0a60 6578 7472 615f  r_size`,.`extra_
+0001a340: 7374 6174 6973 7469 6373 602c 2060 7469  statistics`, `ti
+0001a350: 6d65 6f75 7460 2061 6e64 2060 6372 6564  meout` and `cred
+0001a360: 656e 7469 616c 7360 2e0a 0a54 6865 206f  entials`...The o
+0001a370: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
+0001a380: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+0001a390: 6e74 2073 7065 6369 6669 6573 2061 2073  nt specifies a s
+0001a3a0: 7472 6561 6d20 706f 7369 7469 6f6e 2066  tream position f
+0001a3b0: 726f 6d0a 7768 6963 6820 746f 2073 7562  rom.which to sub
+0001a3c0: 7363 7269 6265 2e20 5468 6520 7265 636f  scribe. The reco
+0001a3d0: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
+0001a3e0: 6973 2073 7472 6561 6d0a 706f 7369 7469  is stream.positi
+0001a3f0: 6f6e 2077 696c 6c20 6265 2072 6563 6569  on will be recei
+0001a400: 7665 6420 7768 656e 2072 6561 6469 6e67  ved when reading
+0001a410: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+0001a420: 6e2e 0a0a 5468 6520 6f70 7469 6f6e 616c  n...The optional
+0001a430: 2060 6672 6f6d 5f65 6e64 6020 6172 6775   `from_end` argu
+0001a440: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+0001a450: 2060 626f 6f6c 602e 0a42 7920 6465 6661   `bool`..By defa
+0001a460: 756c 742c 2074 6865 2076 616c 7565 206f  ult, the value o
+0001a470: 6620 7468 6973 2061 7267 756d 656e 7420  f this argument 
+0001a480: 6973 2060 4661 6c73 6560 2e20 4966 2074  is `False`. If t
+0001a490: 6869 7320 6172 6775 6d65 6e74 2069 7320  his argument is 
+0001a4a0: 7365 740a 746f 2060 5472 7565 602c 2072  set.to `True`, r
+0001a4b0: 6561 6469 6e67 2066 726f 6d20 7468 6520  eading from the 
+0001a4c0: 7375 6273 6372 6970 7469 6f6e 2077 696c  subscription wil
+0001a4d0: 6c20 7265 6365 6976 6520 6f6e 6c79 2065  l receive only e
+0001a4e0: 7665 6e74 730a 7265 636f 7264 6564 2061  vents.recorded a
+0001a4f0: 6674 6572 2074 6865 2073 7562 7363 7269  fter the subscri
+0001a500: 7074 696f 6e20 7761 7320 6372 6561 7465  ption was create
+0001a510: 642e 2054 6861 7420 6973 2c20 6974 2069  d. That is, it i
+0001a520: 7320 6e6f 7420 696e 636c 7573 6976 650a  s not inclusive.
+0001a530: 6f66 2074 6865 2063 7572 7265 6e74 2073  of the current s
+0001a540: 7472 6561 6d20 706f 7369 7469 6f6e 2e0a  tream position..
+0001a550: 0a54 6865 206f 7074 696f 6e61 6c20 6072  .The optional `r
+0001a560: 6573 6f6c 7665 5f6c 696e 6b73 6020 6172  esolve_links` ar
+0001a570: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0001a580: 6f6e 2060 626f 6f6c 602e 2054 6865 2064  on `bool`. The d
+0001a590: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+0001a5a0: 6072 6573 6f6c 7665 5f6c 696e 6b73 600a  `resolve_links`.
+0001a5b0: 6973 2060 4661 6c73 6560 2c20 7768 6963  is `False`, whic
+0001a5c0: 6820 6d65 616e 7320 616e 7920 6576 656e  h means any even
+0001a5d0: 7420 6c69 6e6b 7320 7769 6c6c 206e 6f74  t links will not
+0001a5e0: 2062 6520 7265 736f 6c76 6564 2c20 736f   be resolved, so
+0001a5f0: 2074 6861 7420 7468 6520 6576 656e 7473   that the events
+0001a600: 2074 6861 7420 6172 650a 7265 7475 726e   that are.return
+0001a610: 6564 206d 6179 2072 6570 7265 7365 6e74  ed may represent
+0001a620: 2065 7665 6e74 206c 696e 6b73 2e20 4966   event links. If
+0001a630: 2060 7265 736f 6c76 655f 6c69 6e6b 7360   `resolve_links`
+0001a640: 2069 7320 6054 7275 6560 2c20 616e 7920   is `True`, any 
+0001a650: 6576 656e 7420 6c69 6e6b 7320 7769 6c6c  event links will
+0001a660: 0a62 6520 7265 736f 6c76 6564 2c20 736f  .be resolved, so
+0001a670: 2074 6861 7420 7468 6520 6c69 6e6b 6564   that the linked
+0001a680: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+0001a690: 7265 7475 726e 6564 2069 6e73 7465 6164  returned instead
+0001a6a0: 206f 6620 7468 6520 6576 656e 7420 6c69   of the event li
+0001a6b0: 6e6b 732e 0a0a 5468 6520 6f70 7469 6f6e  nks...The option
+0001a6c0: 616c 2060 636f 6e73 756d 6572 5f73 7472  al `consumer_str
+0001a6d0: 6174 6567 7960 2061 7267 756d 656e 7420  ategy` argument 
+0001a6e0: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
+0001a6f0: 6020 7468 6174 2064 6566 696e 6573 0a74  ` that defines.t
+0001a700: 6865 2063 6f6e 7375 6d65 7220 7374 7261  he consumer stra
+0001a710: 7465 6779 2066 6f72 2074 6869 7320 7065  tegy for this pe
+0001a720: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+0001a730: 7074 696f 6e2e 2054 6865 2076 616c 7565  ption. The value
+0001a740: 206f 6620 7468 6973 2061 7267 756d 656e   of this argumen
+0001a750: 740a 6361 6e20 6265 2060 2744 6973 7061  t.can be `'Dispa
+0001a760: 7463 6854 6f53 696e 676c 6527 602c 2060  tchToSingle'`, `
+0001a770: 2752 6f75 6e64 526f 6269 6e27 602c 2060  'RoundRobin'`, `
+0001a780: 2750 696e 6e65 6427 602c 206f 7220 6027  'Pinned'`, or `'
+0001a790: 5069 6e6e 6564 4279 436f 7272 656c 6174  PinnedByCorrelat
+0001a7a0: 696f 6e27 602e 2054 6865 0a64 6566 6175  ion'`. The.defau
+0001a7b0: 6c74 2076 616c 7565 2069 7320 6027 4469  lt value is `'Di
+0001a7c0: 7370 6174 6368 546f 5369 6e67 6c65 2760  spatchToSingle'`
+0001a7d0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001a7e0: 606d 6573 7361 6765 5f74 696d 656f 7574  `message_timeout
+0001a7f0: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+0001a800: 5079 7468 6f6e 2060 666c 6f61 7460 2077  Python `float` w
+0001a810: 6869 6368 2073 6574 7320 6120 6d61 7869  hich sets a maxi
+0001a820: 6d75 6d20 6475 7261 7469 6f6e 2c0a 696e  mum duration,.in
+0001a830: 2073 6563 6f6e 6473 2c20 6672 6f6d 2074   seconds, from t
+0001a840: 6865 2073 6572 7665 7220 7365 6e64 696e  he server sendin
+0001a850: 6720 6120 7265 636f 7264 6564 2065 7665  g a recorded eve
+0001a860: 6e74 2074 6f20 6120 636f 6e73 756d 6572  nt to a consumer
+0001a870: 206f 6620 7468 6520 7065 7273 6973 7465   of the persiste
+0001a880: 6e74 0a73 7562 7363 7269 7074 696f 6e20  nt.subscription 
+0001a890: 756e 7469 6c20 6569 7468 6572 2061 6e20  until either an 
+0001a8a0: 2261 636b 6e6f 776c 6564 6765 6d65 6e74  "acknowledgement
+0001a8b0: 2220 2861 636b 2920 6f72 2061 2022 6e65  " (ack) or a "ne
+0001a8c0: 6761 7469 7665 2061 636b 6e6f 776c 6564  gative acknowled
+0001a8d0: 6765 6d65 6e74 220a 286e 6163 6b29 2069  gement".(nack) i
+0001a8e0: 7320 7265 6365 6976 6564 2062 7920 7468  s received by th
+0001a8f0: 6520 7365 7276 6572 2c20 6166 7465 7220  e server, after 
+0001a900: 7768 6963 6820 7468 6520 7365 7276 6572  which the server
+0001a910: 2077 696c 6c20 7265 7472 7920 746f 2073   will retry to s
+0001a920: 656e 6420 7468 6520 6576 656e 742e 0a54  end the event..T
+0001a930: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0001a940: 206f 6620 606d 6573 7361 6765 5f74 696d   of `message_tim
+0001a950: 656f 7574 6020 6973 2060 3330 2e30 602e  eout` is `30.0`.
+0001a960: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0001a970: 6d61 785f 7265 7472 795f 636f 756e 7460  max_retry_count`
+0001a980: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+0001a990: 7974 686f 6e20 6069 6e74 6020 7768 6963  ython `int` whic
+0001a9a0: 6820 7365 7473 2074 6865 206e 756d 6265  h sets the numbe
+0001a9b0: 7220 6f66 2074 696d 6573 0a74 6865 2073  r of times.the s
+0001a9c0: 6572 7665 7220 7769 6c6c 2072 6574 7279  erver will retry
+0001a9d0: 2074 6f20 7365 6e64 2061 6e20 6576 656e   to send an even
+0001a9e0: 742e 2054 6865 2064 6566 6175 6c74 2076  t. The default v
+0001a9f0: 616c 7565 206f 6620 606d 6178 5f72 6574  alue of `max_ret
+0001aa00: 7279 5f63 6f75 6e74 6020 6973 2060 3130  ry_count` is `10
+0001aa10: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
+0001aa20: 2060 6d69 6e5f 6368 6563 6b70 6f69 6e74   `min_checkpoint
+0001aa30: 5f63 6f75 6e74 6020 6172 6775 6d65 6e74  _count` argument
+0001aa40: 2069 7320 6120 5079 7468 6f6e 2060 696e   is a Python `in
+0001aa50: 7460 2077 6869 6368 2073 6574 7320 7468  t` which sets th
+0001aa60: 6520 6d69 6e69 6d75 6d0a 6e75 6d62 6572  e minimum.number
+0001aa70: 206f 6620 2261 636b 6e6f 776c 6564 6765   of "acknowledge
+0001aa80: 6d65 6e74 7322 2028 6163 6b73 2920 7265  ments" (acks) re
+0001aa90: 6365 6976 6564 2062 7920 7468 6520 7365  ceived by the se
+0001aaa0: 7276 6572 2062 6566 6f72 6520 7468 6520  rver before the 
+0001aab0: 7365 7276 6572 206d 6179 2072 6563 6f72  server may recor
+0001aac0: 640a 7468 6520 6163 6b6e 6f77 6c65 6467  d.the acknowledg
+0001aad0: 656d 656e 7473 2e20 5468 6520 6465 6661  ements. The defa
+0001aae0: 756c 7420 7661 6c75 6520 6f66 2060 6d69  ult value of `mi
+0001aaf0: 6e5f 6368 6563 6b70 6f69 6e74 5f63 6f75  n_checkpoint_cou
+0001ab00: 6e74 6020 6973 2060 3130 602e 0a0a 5468  nt` is `10`...Th
+0001ab10: 6520 6f70 7469 6f6e 616c 2060 6d61 785f  e optional `max_
+0001ab20: 6368 6563 6b70 6f69 6e74 5f63 6f75 6e74  checkpoint_count
+0001ab30: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+0001ab40: 5079 7468 6f6e 2060 696e 7460 2077 6869  Python `int` whi
+0001ab50: 6368 2073 6574 7320 7468 6520 6d61 7869  ch sets the maxi
+0001ab60: 6d75 6d0a 6e75 6d62 6572 206f 6620 2261  mum.number of "a
+0001ab70: 636b 6e6f 776c 6564 6765 6d65 6e74 7322  cknowledgements"
+0001ab80: 2028 6163 6b73 2920 7265 6365 6976 6564   (acks) received
+0001ab90: 2062 7920 7468 6520 7365 7276 6572 2062   by the server b
+0001aba0: 6566 6f72 6520 7468 6520 7365 7276 6572  efore the server
+0001abb0: 206d 7573 740a 7265 636f 7264 2074 6865   must.record the
+0001abc0: 2061 636b 6e6f 776c 6564 6765 6d65 6e74   acknowledgement
+0001abd0: 732e 2054 6865 2064 6566 6175 6c74 2076  s. The default v
+0001abe0: 616c 7565 206f 6620 606d 6178 5f63 6865  alue of `max_che
+0001abf0: 636b 706f 696e 745f 636f 756e 7460 2069  ckpoint_count` i
+0001ac00: 7320 6031 3030 3060 2e0a 0a54 6865 206f  s `1000`...The o
+0001ac10: 7074 696f 6e61 6c20 6063 6865 636b 706f  ptional `checkpo
+0001ac20: 696e 745f 6166 7465 7260 2061 7267 756d  int_after` argum
+0001ac30: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+0001ac40: 6066 6c6f 6174 6020 7768 6963 6820 7365  `float` which se
+0001ac50: 7473 2074 6865 206d 6178 696d 756d 0a64  ts the maximum.d
+0001ac60: 7572 6174 696f 6e20 696e 2073 6563 6f6e  uration in secon
+0001ac70: 6473 2062 6574 7765 656e 2072 6563 6f72  ds between recor
+0001ac80: 6469 6e67 2022 6163 6b6e 6f77 6c65 6467  ding "acknowledg
+0001ac90: 656d 656e 7473 2220 2861 636b 7329 2e20  ements" (acks). 
+0001aca0: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+0001acb0: 6520 6f66 0a60 6368 6563 6b70 6f69 6e74  e of.`checkpoint
+0001acc0: 5f61 6674 6572 6020 6973 2060 322e 3060  _after` is `2.0`
+0001acd0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001ace0: 606d 6178 5f73 7562 7363 7269 6265 725f  `max_subscriber_
+0001acf0: 636f 756e 7460 2061 7267 756d 656e 7420  count` argument 
+0001ad00: 6973 2061 2050 7974 686f 6e20 6069 6e74  is a Python `int
+0001ad10: 6020 7768 6963 6820 7365 7473 2074 6865  ` which sets the
+0001ad20: 206d 6178 696d 756d 0a6e 756d 6265 7220   maximum.number 
+0001ad30: 6f66 2063 6f6e 6375 7272 656e 7420 7265  of concurrent re
+0001ad40: 6164 6572 7320 6f66 2074 6865 2070 6572  aders of the per
+0001ad50: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+0001ad60: 7469 6f6e 2c20 6265 796f 6e64 2077 6869  tion, beyond whi
+0001ad70: 6368 2061 7474 656d 7074 7320 746f 0a72  ch attempts to.r
+0001ad80: 6561 6420 7468 6520 7065 7273 6973 7465  ead the persiste
+0001ad90: 6e74 2073 7562 7363 7269 7074 696f 6e20  nt subscription 
+0001ada0: 7769 6c6c 2072 6169 7365 2061 2060 4d61  will raise a `Ma
+0001adb0: 7869 6d75 6d53 7562 7363 7269 7074 696f  ximumSubscriptio
+0001adc0: 6e73 5265 6163 6865 6460 2065 7272 6f72  nsReached` error
+0001add0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001ade0: 606c 6976 655f 6275 6666 6572 5f73 697a  `live_buffer_siz
+0001adf0: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+0001ae00: 2050 7974 686f 6e20 6069 6e74 6020 7768   Python `int` wh
+0001ae10: 6963 6820 7365 7473 2074 6865 2073 697a  ich sets the siz
+0001ae20: 6520 6f66 2074 6865 0a62 7566 6665 7220  e of the.buffer 
+0001ae30: 2869 6e2d 6d65 6d6f 7279 2920 686f 6c64  (in-memory) hold
+0001ae40: 696e 6720 6e65 776c 7920 7265 636f 7264  ing newly record
+0001ae50: 6564 2065 7665 6e74 732e 2054 6865 2064  ed events. The d
+0001ae60: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+0001ae70: 606c 6976 655f 6275 6666 6572 5f73 697a  `live_buffer_siz
+0001ae80: 6560 0a69 7320 3530 302e 0a0a 5468 6520  e`.is 500...The 
+0001ae90: 6f70 7469 6f6e 616c 2060 7265 6164 5f62  optional `read_b
+0001aea0: 6174 6368 5f73 697a 6560 2061 7267 756d  atch_size` argum
+0001aeb0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+0001aec0: 6069 6e74 6020 7768 6963 6820 7365 7473  `int` which sets
+0001aed0: 2074 6865 206e 756d 6265 7220 6f66 0a72   the number of.r
+0001aee0: 6563 6f72 6465 6420 6576 656e 7473 2072  ecorded events r
+0001aef0: 6561 6420 6672 6f6d 2064 6973 6b20 7768  ead from disk wh
+0001af00: 656e 2063 6174 6368 696e 6720 7570 2e20  en catching up. 
+0001af10: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+0001af20: 6520 6f66 2060 7265 6164 5f62 6174 6368  e of `read_batch
+0001af30: 5f73 697a 6560 0a69 7320 3230 302e 0a0a  _size`.is 200...
+0001af40: 5468 6520 6f70 7469 6f6e 616c 2060 6869  The optional `hi
+0001af50: 7374 6f72 795f 6275 6666 6572 5f73 697a  story_buffer_siz
+0001af60: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+0001af70: 2050 7974 686f 6e20 6069 6e74 6020 7768   Python `int` wh
+0001af80: 6963 6820 7365 7473 2074 6865 206e 756d  ich sets the num
+0001af90: 6265 7220 6f66 0a72 6563 6f72 6465 6420  ber of.recorded 
+0001afa0: 6576 656e 7473 2074 6f20 6361 6368 6520  events to cache 
+0001afb0: 696e 206d 656d 6f72 7920 7768 656e 2063  in memory when c
+0001afc0: 6174 6368 696e 6720 7570 2e20 5468 6520  atching up. The 
+0001afd0: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
+0001afe0: 2060 6869 7374 6f72 795f 6275 6666 6572   `history_buffer
+0001aff0: 5f73 697a 6560 0a69 7320 3530 302e 0a0a  _size`.is 500...
+0001b000: 5468 6520 6f70 7469 6f6e 616c 2060 6578  The optional `ex
+0001b010: 7472 615f 7374 6174 6973 7469 6373 6020  tra_statistics` 
+0001b020: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+0001b030: 7468 6f6e 2060 626f 6f6c 6020 7768 6963  thon `bool` whic
+0001b040: 6820 656e 6162 6c65 7320 7472 6163 6b69  h enables tracki
+0001b050: 6e67 206f 660a 6578 7472 6120 7374 6174  ng of.extra stat
+0001b060: 6973 7469 6373 206f 6e20 7468 6973 2073  istics on this s
+0001b070: 7562 7363 7269 7074 696f 6e2e 2054 6865  ubscription. The
+0001b080: 2064 6566 6175 6c74 2076 616c 7565 206f   default value o
+0001b090: 6620 6065 7874 7261 5f73 7461 7469 7374  f `extra_statist
+0001b0a0: 6963 7360 2069 7320 6046 616c 7365 602e  ics` is `False`.
+0001b0b0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0001b0c0: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+0001b0d0: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
+0001b0e0: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
+0001b0f0: 2061 0a6d 6178 696d 756d 2064 7572 6174   a.maximum durat
+0001b100: 696f 6e2c 2069 6e20 7365 636f 6e64 732c  ion, in seconds,
+0001b110: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+0001b120: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+0001b130: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+0001b140: 6f70 7469 6f6e 616c 2060 6372 6564 656e  optional `creden
+0001b150: 7469 616c 7360 2061 7267 756d 656e 7420  tials` argument 
+0001b160: 6361 6e20 6265 2075 7365 6420 746f 0a6f  can be used to.o
+0001b170: 7665 7272 6964 6520 6361 6c6c 2063 7265  verride call cre
+0001b180: 6465 6e74 6961 6c73 2064 6572 6976 6564  dentials derived
+0001b190: 2066 726f 6d20 7468 6520 636f 6e6e 6563   from the connec
+0001b1a0: 7469 6f6e 2073 7472 696e 6720 5552 492e  tion string URI.
+0001b1b0: 0a0a 5468 6973 206d 6574 686f 6420 646f  ..This method do
+0001b1c0: 6573 206e 6f74 2072 6574 7572 6e20 6120  es not return a 
+0001b1d0: 7661 6c75 652e 2045 7665 6e74 7320 6361  value. Events ca
+0001b1e0: 6e20 6265 2072 6563 6569 7665 6420 6279  n be received by
+0001b1f0: 2063 616c 6c69 6e67 0a60 7265 6164 5f73   calling.`read_s
+0001b200: 7562 7363 7269 7074 696f 6e5f 746f 5f73  ubscription_to_s
+0001b210: 7472 6561 6d28 2960 2e0a 0a54 6865 2065  tream()`...The e
+0001b220: 7861 6d70 6c65 2062 656c 6f77 2063 7265  xample below cre
+0001b230: 6174 6573 2061 2070 6572 7369 7374 656e  ates a persisten
+0001b240: 7420 7374 7265 616d 2073 7562 7363 7269  t stream subscri
+0001b250: 7074 696f 6e20 6672 6f6d 2074 6865 2073  ption from the s
+0001b260: 7461 7274 206f 6620 7468 6520 7374 7265  tart of the stre
+0001b270: 616d 2e0a 0a60 6060 7079 7468 6f6e 0a23  am...```python.#
+0001b280: 2043 7265 6174 6520 6120 7065 7273 6973   Create a persis
+0001b290: 7465 6e74 2073 7472 6561 6d20 7375 6273  tent stream subs
+0001b2a0: 6372 6970 7469 6f6e 2066 726f 6d20 7374  cription from st
+0001b2b0: 6172 7420 6f66 2074 6865 2073 7472 6561  art of the strea
+0001b2c0: 6d2e 0a67 726f 7570 5f6e 616d 6532 203d  m..group_name2 =
+0001b2d0: 2066 2267 726f 7570 2d7b 7575 6964 2e75   f"group-{uuid.u
+0001b2e0: 7569 6434 2829 7d22 0a63 6c69 656e 742e  uid4()}".client.
+0001b2f0: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
+0001b300: 696f 6e5f 746f 5f73 7472 6561 6d28 0a20  ion_to_stream(. 
+0001b310: 2020 2067 726f 7570 5f6e 616d 653d 6772     group_name=gr
+0001b320: 6f75 705f 6e61 6d65 322c 0a20 2020 2073  oup_name2,.    s
+0001b330: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+0001b340: 6d5f 6e61 6d65 322c 0a29 0a60 6060 0a0a  m_name2,.).```..
+0001b350: 2323 2320 5265 6164 2073 7562 7363 7269  ### Read subscri
+0001b360: 7074 696f 6e20 746f 2073 7472 6561 6d3c  ption to stream<
+0001b370: 6120 6964 3d22 7265 6164 2d73 7562 7363  a id="read-subsc
+0001b380: 7269 7074 696f 6e2d 746f 2d73 7472 6561  ription-to-strea
+0001b390: 6d22 3e3c 2f61 3e0a 0a2a 7265 7175 6972  m"></a>..*requir
+0001b3a0: 6573 206c 6561 6465 722a 0a0a 5468 6520  es leader*..The 
+0001b3b0: 6072 6561 645f 7375 6273 6372 6970 7469  `read_subscripti
+0001b3c0: 6f6e 5f74 6f5f 7374 7265 616d 2829 6020  on_to_stream()` 
+0001b3d0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+0001b3e0: 6564 2074 6f20 7265 6164 2061 2070 6572  ed to read a per
+0001b3f0: 7369 7374 656e 740a 7375 6273 6372 6970  sistent.subscrip
+0001b400: 7469 6f6e 2074 6f20 6120 7374 7265 616d  tion to a stream
+0001b410: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
+0001b420: 6173 2074 776f 2072 6571 7569 7265 6420  as two required 
+0001b430: 6172 6775 6d65 6e74 732c 2060 6772 6f75  arguments, `grou
+0001b440: 705f 6e61 6d65 6020 616e 6420 6073 7472  p_name` and `str
+0001b450: 6561 6d5f 6e61 6d65 602c 2077 6869 6368  eam_name`, which
+0001b460: 0a73 686f 756c 6420 6d61 7463 6820 7468  .should match th
+0001b470: 6520 7661 6c75 6573 206f 6620 6172 6775  e values of argu
+0001b480: 6d65 6e74 7320 7573 6564 2077 6865 6e20  ments used when 
+0001b490: 6361 6c6c 696e 6720 6063 7265 6174 655f  calling `create_
+0001b4a0: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+0001b4b0: 7374 7265 616d 2829 602e 0a0a 5468 6973  stream()`...This
+0001b4c0: 206d 6574 686f 6420 6861 7320 616e 206f   method has an o
+0001b4d0: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+0001b4e0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+0001b4f0: 6820 6973 2061 2050 7974 686f 6e20 6066  h is a Python `f
+0001b500: 6c6f 6174 600a 7468 6174 2073 6574 7320  loat`.that sets 
+0001b510: 6120 6d61 7869 6d75 6d20 6475 7261 7469  a maximum durati
+0001b520: 6f6e 2c20 696e 2073 6563 6f6e 6473 2c20  on, in seconds, 
+0001b530: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+0001b540: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+0001b550: 7065 7261 7469 6f6e 2e0a 0a54 6869 7320  peration...This 
+0001b560: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
+0001b570: 7469 6f6e 616c 2060 6372 6564 656e 7469  tional `credenti
+0001b580: 616c 7360 2061 7267 756d 656e 742c 2077  als` argument, w
+0001b590: 6869 6368 2063 616e 2062 6520 7573 6564  hich can be used
+0001b5a0: 2074 6f0a 6f76 6572 7269 6465 2063 616c   to.override cal
+0001b5b0: 6c20 6372 6564 656e 7469 616c 7320 6465  l credentials de
+0001b5c0: 7269 7665 6420 6672 6f6d 2074 6865 2063  rived from the c
+0001b5d0: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+0001b5e0: 2055 5249 2e0a 0a54 6869 7320 6d65 7468   URI...This meth
+0001b5f0: 6f64 2072 6574 7572 6e73 2061 2060 5065  od returns a `Pe
+0001b600: 7273 6973 7465 6e74 5375 6273 6372 6970  rsistentSubscrip
+0001b610: 7469 6f6e 6020 6f62 6a65 6374 2c20 7768  tion` object, wh
+0001b620: 6963 6820 6973 2061 6e20 6974 6572 6174  ich is an iterat
+0001b630: 6f72 0a67 6976 696e 6720 6052 6563 6f72  or.giving `Recor
+0001b640: 6465 6445 7665 6e74 6020 6f62 6a65 6374  dedEvent` object
+0001b650: 732c 2074 6861 7420 616c 736f 2068 6173  s, that also has
+0001b660: 2060 6163 6b28 2960 2c20 606e 6163 6b28   `ack()`, `nack(
+0001b670: 2960 2061 6e64 2060 7374 6f70 2829 600a  )` and `stop()`.
+0001b680: 6d65 7468 6f64 732e 0a0a 6060 6070 7974  methods...```pyt
+0001b690: 686f 6e0a 7375 6273 6372 6970 7469 6f6e  hon.subscription
+0001b6a0: 203d 2063 6c69 656e 742e 7265 6164 5f73   = client.read_s
+0001b6b0: 7562 7363 7269 7074 696f 6e5f 746f 5f73  ubscription_to_s
+0001b6c0: 7472 6561 6d28 0a20 2020 2067 726f 7570  tream(.    group
+0001b6d0: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
+0001b6e0: 322c 0a20 2020 2073 7472 6561 6d5f 6e61  2,.    stream_na
+0001b6f0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 322c  me=stream_name2,
+0001b700: 0a29 0a60 6060 0a0a 5468 6520 6578 616d  .).```..The exam
+0001b710: 706c 6520 6265 6c6f 7720 6974 6572 6174  ple below iterat
+0001b720: 6573 206f 7665 7220 7468 6520 7375 6273  es over the subs
+0001b730: 6372 6970 7469 6f6e 206f 626a 6563 742c  cription object,
+0001b740: 2061 6e64 2063 616c 6c73 2060 6163 6b28   and calls `ack(
+0001b750: 2960 2e0a 5468 6520 7375 6273 6372 6970  )`..The subscrip
+0001b760: 7469 6f6e 2773 2060 7374 6f70 2829 6020  tion's `stop()` 
+0001b770: 6d65 7468 6f64 2069 7320 6361 6c6c 6564  method is called
+0001b780: 2077 6865 6e20 7765 2068 6176 6520 7265   when we have re
+0001b790: 6365 6976 6564 2060 6576 656e 7436 602c  ceived `event6`,
+0001b7a0: 0a73 746f 7070 696e 6720 7468 6520 6974  .stopping the it
+0001b7b0: 6572 6174 696f 6e2c 2073 6f20 7468 6174  eration, so that
+0001b7c0: 2077 6520 6361 6e20 636f 6e74 696e 7565   we can continue
+0001b7d0: 2077 6974 6820 7468 6520 6578 616d 706c   with the exampl
+0001b7e0: 6573 2062 656c 6f77 2e0a 0a60 6060 7079  es below...```py
+0001b7f0: 7468 6f6e 0a65 7665 6e74 7320 3d20 5b5d  thon.events = []
+0001b800: 0a66 6f72 2065 7665 6e74 2069 6e20 7375  .for event in su
+0001b810: 6273 6372 6970 7469 6f6e 3a0a 2020 2020  bscription:.    
+0001b820: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
+0001b830: 656e 7429 0a0a 2020 2020 2320 4163 6b6e  ent)..    # Ackn
+0001b840: 6f77 6c65 6467 6520 7468 6520 7265 6365  owledge the rece
+0001b850: 6976 6564 2065 7665 6e74 2e0a 2020 2020  ived event..    
+0001b860: 7375 6273 6372 6970 7469 6f6e 2e61 636b  subscription.ack
+0001b870: 2865 7665 6e74 290a 0a20 2020 2023 2053  (event)..    # S
+0001b880: 746f 7020 7768 656e 2027 6576 656e 7436  top when 'event6
+0001b890: 2720 6861 7320 6265 656e 2072 6563 6569  ' has been recei
+0001b8a0: 7665 642e 0a20 2020 2069 6620 6576 656e  ved..    if even
+0001b8b0: 7420 3d3d 2065 7665 6e74 363a 0a20 2020  t == event6:.   
+0001b8c0: 2020 2020 2073 7562 7363 7269 7074 696f       subscriptio
+0001b8d0: 6e2e 7374 6f70 2829 0a60 6060 0a0a 5765  n.stop().```..We
+0001b8e0: 2063 616e 2063 6865 636b 2077 6520 7265   can check we re
+0001b8f0: 6365 6976 6564 2061 6c6c 2074 6865 2065  ceived all the e
+0001b900: 7665 6e74 7320 7468 6174 2077 6572 6520  vents that were 
+0001b910: 6170 7065 6e64 6564 2074 6f20 6073 7472  appended to `str
+0001b920: 6561 6d5f 6e61 6d65 3260 0a69 6e20 7468  eam_name2`.in th
+0001b930: 6520 6578 616d 706c 6573 2061 626f 7665  e examples above
+0001b940: 2e0a 0a60 6060 7079 7468 6f6e 0a61 7373  ...```python.ass
+0001b950: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
+0001b960: 3d3d 2033 0a61 7373 6572 7420 6576 656e  == 3.assert even
+0001b970: 7473 5b30 5d20 3d3d 2065 7665 6e74 340a  ts[0] == event4.
+0001b980: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
+0001b990: 203d 3d20 6576 656e 7435 0a61 7373 6572   == event5.asser
+0001b9a0: 7420 6576 656e 7473 5b32 5d20 3d3d 2065  t events[2] == e
+0001b9b0: 7665 6e74 360a 6060 600a 0a23 2323 2055  vent6.```..### U
+0001b9c0: 7064 6174 6520 7375 6273 6372 6970 7469  pdate subscripti
+0001b9d0: 6f6e 2074 6f20 7374 7265 616d 3c61 2069  on to stream<a i
+0001b9e0: 643d 2275 7064 6174 652d 7375 6273 6372  d="update-subscr
+0001b9f0: 6970 7469 6f6e 2d74 6f2d 7374 7265 616d  iption-to-stream
+0001ba00: 223e 3c2f 613e 0a0a 2a72 6571 7569 7265  "></a>..*require
+0001ba10: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
+0001ba20: 7570 6461 7465 5f73 7562 7363 7269 7074  update_subscript
+0001ba30: 696f 6e5f 746f 5f73 7472 6561 6d28 2960  ion_to_stream()`
+0001ba40: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+0001ba50: 7365 6420 746f 2075 7064 6174 6520 6120  sed to update a 
+0001ba60: 7065 7273 6973 7465 6e74 0a73 7562 7363  persistent.subsc
+0001ba70: 7269 7074 696f 6e20 746f 2061 2073 7472  ription to a str
+0001ba80: 6561 6d2e 2050 6c65 6173 6520 6e6f 7465  eam. Please note
+0001ba90: 2c20 7468 6520 636f 6e73 756d 6572 2073  , the consumer s
+0001baa0: 7472 6174 6567 7920 6361 6e6e 6f74 2062  trategy cannot b
+0001bab0: 6520 6164 6a75 7374 6564 2e0a 0a54 6869  e adjusted...Thi
+0001bac0: 7320 6d65 7468 6f64 2068 6173 2061 2072  s method has a r
+0001bad0: 6571 7569 7265 6420 6067 726f 7570 5f6e  equired `group_n
+0001bae0: 616d 6560 2061 7267 756d 656e 742c 2077  ame` argument, w
+0001baf0: 6869 6368 2069 7320 7468 650a 6e61 6d65  hich is the.name
+0001bb00: 206f 6620 6120 2267 726f 7570 2220 6f66   of a "group" of
+0001bb10: 2063 6f6e 7375 6d65 7273 206f 6620 7468   consumers of th
+0001bb20: 6520 7375 6273 6372 6970 7469 6f6e 2c20  e subscription, 
+0001bb30: 616e 6420 6120 7265 7175 6972 6564 0a60  and a required.`
+0001bb40: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+0001bb50: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
+0001bb60: 7468 6520 6e61 6d65 206f 6620 6120 7374  the name of a st
+0001bb70: 7265 616d 2e0a 0a54 6869 7320 6d65 7468  ream...This meth
+0001bb80: 6f64 2061 6c73 6f20 6861 7320 7369 7874  od also has sixt
+0001bb90: 6565 6e20 6f70 7469 6f6e 616c 2061 7267  een optional arg
+0001bba0: 756d 656e 7473 2c20 6066 726f 6d5f 656e  uments, `from_en
+0001bbb0: 6460 2c20 6073 7472 6561 6d5f 706f 7369  d`, `stream_posi
+0001bbc0: 7469 6f6e 602c 0a60 7265 736f 6c76 655f  tion`,.`resolve_
+0001bbd0: 6c69 6e6b 7360 2c20 6063 6f6e 7375 6d65  links`, `consume
+0001bbe0: 725f 7374 7261 7465 6779 602c 2060 6d65  r_strategy`, `me
+0001bbf0: 7373 6167 655f 7469 6d65 6f75 7460 2c20  ssage_timeout`, 
+0001bc00: 606d 6178 5f72 6574 7279 5f63 6f75 6e74  `max_retry_count
+0001bc10: 602c 0a60 6d61 785f 7375 6273 6372 6962  `,.`max_subscrib
+0001bc20: 6572 5f63 6f75 6e74 602c 2060 6c69 7665  er_count`, `live
+0001bc30: 5f62 7566 6665 725f 7369 7a65 602c 2060  _buffer_size`, `
+0001bc40: 7265 6164 5f62 6174 6368 5f73 697a 6560  read_batch_size`
+0001bc50: 2c20 6068 6973 746f 7279 5f62 7566 6665  , `history_buffe
+0001bc60: 725f 7369 7a65 602c 0a60 6578 7472 615f  r_size`,.`extra_
+0001bc70: 7374 6174 6973 7469 6373 602c 2060 6d69  statistics`, `mi
+0001bc80: 6e5f 6368 6563 6b70 6f69 6e74 5f63 6f75  n_checkpoint_cou
+0001bc90: 6e74 602c 2060 6d61 785f 6368 6563 6b70  nt`, `max_checkp
+0001bca0: 6f69 6e74 5f63 6f75 6e74 602c 2060 6368  oint_count`, `ch
+0001bcb0: 6563 6b70 6f69 6e74 5f61 6674 6572 602c  eckpoint_after`,
+0001bcc0: 0a60 7469 6d65 6f75 7460 2061 6e64 2060  .`timeout` and `
+0001bcd0: 6372 6564 656e 7469 616c 7360 2e0a 0a54  credentials`...T
+0001bce0: 6865 206f 7074 696f 6e61 6c20 6172 6775  he optional argu
+0001bcf0: 6d65 6e74 7320 6066 726f 6d5f 656e 6460  ments `from_end`
+0001bd00: 2c20 6073 7472 6561 6d5f 706f 7369 7469  , `stream_positi
+0001bd10: 6f6e 602c 0a60 7265 736f 6c76 655f 6c69  on`,.`resolve_li
+0001bd20: 6e6b 7360 2c20 6063 6f6e 7375 6d65 725f  nks`, `consumer_
+0001bd30: 7374 7261 7465 6779 602c 2060 6d65 7373  strategy`, `mess
+0001bd40: 6167 655f 7469 6d65 6f75 7460 2c20 606d  age_timeout`, `m
+0001bd50: 6178 5f72 6574 7279 5f63 6f75 6e74 602c  ax_retry_count`,
+0001bd60: 0a60 6d69 6e5f 6368 6563 6b70 6f69 6e74  .`min_checkpoint
+0001bd70: 5f63 6f75 6e74 602c 2060 6d61 785f 6368  _count`, `max_ch
+0001bd80: 6563 6b70 6f69 6e74 5f63 6f75 6e74 602c  eckpoint_count`,
+0001bd90: 2060 6368 6563 6b70 6f69 6e74 5f61 6674   `checkpoint_aft
+0001bda0: 6572 602c 0a60 6d61 785f 7375 6273 6372  er`,.`max_subscr
+0001bdb0: 6962 6572 5f63 6f75 6e74 602c 2060 6c69  iber_count`, `li
+0001bdc0: 7665 5f62 7566 6665 725f 7369 7a65 602c  ve_buffer_size`,
+0001bdd0: 2060 7265 6164 5f62 6174 6368 5f73 697a   `read_batch_siz
+0001bde0: 6560 2c20 6068 6973 746f 7279 5f62 7566  e`, `history_buf
+0001bdf0: 6665 725f 7369 7a65 602c 0a61 6e64 2060  fer_size`,.and `
+0001be00: 6578 7472 615f 7374 6174 6973 7469 6373  extra_statistics
+0001be10: 6020 6361 6e20 6265 2075 7365 6420 746f  ` can be used to
+0001be20: 2061 646a 7573 7420 7468 6520 7661 6c75   adjust the valu
+0001be30: 6573 2073 6574 206f 6e20 7072 6576 696f  es set on previo
+0001be40: 7573 2063 616c 6c73 2074 6f0a 6063 7265  us calls to.`cre
+0001be50: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
+0001be60: 5f74 6f5f 7374 7265 616d 2829 6020 616e  _to_stream()` an
+0001be70: 6420 6075 7064 6174 655f 7375 6273 6372  d `update_subscr
+0001be80: 6970 7469 6f6e 5f74 6f5f 7374 7265 616d  iption_to_stream
+0001be90: 2829 602e 2049 6620 616e 7920 6f66 0a74  ()`. If any of.t
+0001bea0: 6865 7365 2061 7267 756d 656e 7473 2061  hese arguments a
+0001beb0: 7265 206e 6f74 206d 656e 7469 6f6e 6564  re not mentioned
+0001bec0: 2069 6e20 6120 6361 6c6c 2074 6f20 6075   in a call to `u
+0001bed0: 7064 6174 655f 7375 6273 6372 6970 7469  pdate_subscripti
+0001bee0: 6f6e 5f74 6f5f 7374 7265 616d 2829 602c  on_to_stream()`,
+0001bef0: 0a74 6865 2063 6f72 7265 7370 6f6e 6469  .the correspondi
+0001bf00: 6e67 2073 6574 7469 6e67 7320 6f66 2074  ng settings of t
+0001bf10: 6865 2070 6572 7369 7374 656e 7420 7375  he persistent su
+0001bf20: 6273 6372 6970 7469 6f6e 2077 696c 6c20  bscription will 
+0001bf30: 6265 2075 6e63 6861 6e67 6564 2e0a 0a54  be unchanged...T
+0001bf40: 6865 206f 7074 696f 6e61 6c20 6074 696d  he optional `tim
+0001bf50: 656f 7574 6020 6172 6775 6d65 6e74 2069  eout` argument i
+0001bf60: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+0001bf70: 7460 2077 6869 6368 2073 6574 7320 610a  t` which sets a.
+0001bf80: 6d61 7869 6d75 6d20 6475 7261 7469 6f6e  maximum duration
+0001bf90: 2c20 696e 2073 6563 6f6e 6473 2c20 666f  , in seconds, fo
+0001bfa0: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
+0001bfb0: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
+0001bfc0: 7261 7469 6f6e 2e0a 0a54 6865 206f 7074  ration...The opt
+0001bfd0: 696f 6e61 6c20 6063 7265 6465 6e74 6961  ional `credentia
+0001bfe0: 6c73 6020 6172 6775 6d65 6e74 2063 616e  ls` argument can
+0001bff0: 2062 6520 7573 6564 2074 6f0a 6f76 6572   be used to.over
+0001c000: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
+0001c010: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
+0001c020: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
+0001c030: 6e20 7374 7269 6e67 2055 5249 2e0a 0a54  n string URI...T
+0001c040: 6865 2060 7570 6461 7465 5f73 7562 7363  he `update_subsc
+0001c050: 7269 7074 696f 6e5f 746f 5f73 7472 6561  ription_to_strea
+0001c060: 6d28 2960 206d 6574 686f 6420 646f 6573  m()` method does
+0001c070: 206e 6f74 2072 6574 7572 6e20 6120 7661   not return a va
+0001c080: 6c75 652e 0a0a 496e 2074 6865 2065 7861  lue...In the exa
+0001c090: 6d70 6c65 2062 656c 6f77 2c20 6120 7065  mple below, a pe
+0001c0a0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+0001c0b0: 7074 696f 6e20 746f 2061 2073 7472 6561  ption to a strea
+0001c0c0: 6d20 6973 2075 7064 6174 6564 2074 6f20  m is updated to 
+0001c0d0: 7275 6e20 6672 6f6d 2074 6865 0a65 6e64  run from the.end
+0001c0e0: 206f 6620 7468 6520 7374 7265 616d 2e0a   of the stream..
+0001c0f0: 0a60 6060 7079 7468 6f6e 0a23 2043 7265  .```python.# Cre
+0001c100: 6174 6520 6120 7065 7273 6973 7465 6e74  ate a persistent
+0001c110: 2073 7562 7363 7269 7074 696f 6e2e 0a63   subscription..c
+0001c120: 6c69 656e 742e 7570 6461 7465 5f73 7562  lient.update_sub
+0001c130: 7363 7269 7074 696f 6e5f 746f 5f73 7472  scription_to_str
+0001c140: 6561 6d28 0a20 2020 2067 726f 7570 5f6e  eam(.    group_n
+0001c150: 616d 653d 6772 6f75 705f 6e61 6d65 322c  ame=group_name2,
+0001c160: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+0001c170: 3d73 7472 6561 6d5f 6e61 6d65 322c 0a20  =stream_name2,. 
+0001c180: 2020 2066 726f 6d5f 656e 643d 5472 7565     from_end=True
+0001c190: 2c0a 290a 6060 600a 0a23 2323 2052 6570  ,.).```..### Rep
+0001c1a0: 6c61 7920 7061 726b 6564 2065 7665 6e74  lay parked event
+0001c1b0: 733c 6120 6964 3d22 7265 706c 6179 2d70  s<a id="replay-p
+0001c1c0: 6172 6b65 642d 6576 656e 7473 223e 3c2f  arked-events"></
+0001c1d0: 613e 0a0a 2a72 6571 7569 7265 7320 6c65  a>..*requires le
+0001c1e0: 6164 6572 2a0a 0a54 6865 2060 7265 706c  ader*..The `repl
+0001c1f0: 6179 5f70 6172 6b65 645f 6576 656e 7473  ay_parked_events
+0001c200: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+0001c210: 6520 7573 6564 2074 6f20 2272 6570 6c61  e used to "repla
+0001c220: 7922 2065 7665 6e74 7320 7468 6174 2068  y" events that h
+0001c230: 6176 650a 6265 656e 2022 7061 726b 6564  ave.been "parked
+0001c240: 2220 286e 6567 6174 6976 656c 7920 6163  " (negatively ac
+0001c250: 6b6e 6f77 6c65 6467 6564 2077 6974 6820  knowledged with 
+0001c260: 7468 6520 6163 7469 6f6e 2060 2770 6172  the action `'par
+0001c270: 6b27 6029 2077 6865 6e20 7265 6164 696e  k'`) when readin
+0001c280: 670a 6120 7065 7273 6973 7465 6e74 2073  g.a persistent s
+0001c290: 7562 7363 7269 7074 696f 6e2e 2050 6172  ubscription. Par
+0001c2a0: 6b65 6420 6576 656e 7473 2077 696c 6c20  ked events will 
+0001c2b0: 7468 656e 2062 6520 7265 6365 6976 6564  then be received
+0001c2c0: 2061 6761 696e 2062 7920 636f 6e73 756d   again by consum
+0001c2d0: 6572 730a 7265 6164 696e 6720 6672 6f6d  ers.reading from
+0001c2e0: 2074 6865 2070 6572 7369 7374 656e 7420   the persistent 
+0001c2f0: 7375 6273 6372 6970 7469 6f6e 2e0a 0a54  subscription...T
+0001c300: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
+0001c310: 2072 6571 7569 7265 6420 6067 726f 7570   required `group
+0001c320: 5f6e 616d 6560 2061 7267 756d 656e 7420  _name` argument 
+0001c330: 616e 6420 616e 206f 7074 696f 6e61 6c20  and an optional 
+0001c340: 6073 7472 6561 6d5f 6e61 6d65 600a 6172  `stream_name`.ar
+0001c350: 6775 6d65 6e74 2e20 5468 6520 7661 6c75  gument. The valu
+0001c360: 6573 206f 6620 7468 6573 6520 6172 6775  es of these argu
+0001c370: 6d65 6e74 7320 7368 6f75 6c64 206d 6174  ments should mat
+0001c380: 6368 2074 686f 7365 2075 7365 6420 7768  ch those used wh
+0001c390: 656e 2063 616c 6c69 6e67 0a60 6372 6561  en calling.`crea
+0001c3a0: 7465 5f73 7562 7363 7269 7074 696f 6e5f  te_subscription_
+0001c3b0: 746f 5f61 6c6c 2829 6020 6f72 2060 6372  to_all()` or `cr
+0001c3c0: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
+0001c3d0: 6e5f 746f 5f73 7472 6561 6d28 2960 2e0a  n_to_stream()`..
+0001c3e0: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+0001c3f0: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
+0001c400: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
+0001c410: 2077 6869 6368 2069 7320 6120 5079 7468   which is a Pyth
+0001c420: 6f6e 2060 666c 6f61 7460 0a74 6861 7420  on `float`.that 
+0001c430: 7365 7473 2061 206d 6178 696d 756d 2064  sets a maximum d
+0001c440: 7572 6174 696f 6e2c 2069 6e20 7365 636f  uration, in seco
+0001c450: 6e64 732c 2066 6f72 2074 6865 2063 6f6d  nds, for the com
+0001c460: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+0001c470: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+0001c480: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+0001c490: 616e 206f 7074 696f 6e61 6c20 6063 7265  an optional `cre
+0001c4a0: 6465 6e74 6961 6c73 6020 6172 6775 6d65  dentials` argume
+0001c4b0: 6e74 2c20 7768 6963 6820 6361 6e20 6265  nt, which can be
+0001c4c0: 2075 7365 6420 746f 0a6f 7665 7272 6964   used to.overrid
+0001c4d0: 6520 6361 6c6c 2063 7265 6465 6e74 6961  e call credentia
+0001c4e0: 6c73 2064 6572 6976 6564 2066 726f 6d20  ls derived from 
+0001c4f0: 7468 6520 636f 6e6e 6563 7469 6f6e 2073  the connection s
+0001c500: 7472 696e 6720 5552 492e 0a0a 5468 6520  tring URI...The 
+0001c510: 6578 616d 706c 6520 6265 6c6f 7720 7265  example below re
+0001c520: 706c 6179 7320 7061 726b 6564 2065 7665  plays parked eve
+0001c530: 6e74 7320 666f 7220 6772 6f75 7020 6067  nts for group `g
+0001c540: 726f 7570 5f6e 616d 6531 602e 0a0a 6060  roup_name1`...``
+0001c550: 6070 7974 686f 6e0a 636c 6965 6e74 2e72  `python.client.r
+0001c560: 6570 6c61 795f 7061 726b 6564 5f65 7665  eplay_parked_eve
+0001c570: 6e74 7328 0a20 2020 2067 726f 7570 5f6e  nts(.    group_n
+0001c580: 616d 653d 6772 6f75 705f 6e61 6d65 312c  ame=group_name1,
+0001c590: 0a29 0a60 6060 0a0a 5468 6520 6578 616d  .).```..The exam
+0001c5a0: 706c 6520 6265 6c6f 7720 7265 706c 6179  ple below replay
+0001c5b0: 7320 7061 726b 6564 2065 7665 6e74 7320  s parked events 
+0001c5c0: 666f 7220 6772 6f75 7020 6067 726f 7570  for group `group
+0001c5d0: 5f6e 616d 6532 602e 0a0a 6060 6070 7974  _name2`...```pyt
+0001c5e0: 686f 6e0a 636c 6965 6e74 2e72 6570 6c61  hon.client.repla
+0001c5f0: 795f 7061 726b 6564 5f65 7665 6e74 7328  y_parked_events(
+0001c600: 0a20 2020 2067 726f 7570 5f6e 616d 653d  .    group_name=
+0001c610: 6772 6f75 705f 6e61 6d65 322c 0a20 2020  group_name2,.   
+0001c620: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+0001c630: 6561 6d5f 6e61 6d65 322c 0a29 0a60 6060  eam_name2,.).```
+0001c640: 0a0a 2323 2320 4765 7420 7375 6273 6372  ..### Get subscr
+0001c650: 6970 7469 6f6e 2069 6e66 6f3c 6120 6964  iption info<a id
+0001c660: 3d22 6765 742d 7375 6273 6372 6970 7469  ="get-subscripti
+0001c670: 6f6e 2d69 6e66 6f22 3e3c 2f61 3e0a 0a2a  on-info"></a>..*
+0001c680: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+0001c690: 0a0a 5468 6520 6067 6574 5f73 7562 7363  ..The `get_subsc
+0001c6a0: 7269 7074 696f 6e5f 696e 666f 2829 6020  ription_info()` 
+0001c6b0: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+0001c6c0: 6564 2074 6f20 6765 7420 696e 666f 726d  ed to get inform
+0001c6d0: 6174 696f 6e20 666f 7220 610a 7065 7273  ation for a.pers
+0001c6e0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+0001c6f0: 696f 6e2e 0a0a 5468 6973 206d 6574 686f  ion...This metho
+0001c700: 6420 6861 7320 6120 7265 7175 6972 6564  d has a required
+0001c710: 2060 6772 6f75 705f 6e61 6d65 6020 6172   `group_name` ar
+0001c720: 6775 6d65 6e74 2061 6e64 2061 6e20 6f70  gument and an op
+0001c730: 7469 6f6e 616c 2060 7374 7265 616d 5f6e  tional `stream_n
+0001c740: 616d 6560 0a61 7267 756d 656e 742c 2077  ame`.argument, w
+0001c750: 6869 6368 2073 686f 756c 6420 6d61 7463  hich should matc
+0001c760: 6820 7468 6520 7661 6c75 6573 206f 6620  h the values of 
+0001c770: 6172 6775 6d65 6e74 7320 7573 6564 2077  arguments used w
+0001c780: 6865 6e20 6361 6c6c 696e 6720 6569 7468  hen calling eith
+0001c790: 6572 0a60 6372 6561 7465 5f73 7562 7363  er.`create_subsc
+0001c7a0: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
+0001c7b0: 6020 6f72 2060 6372 6561 7465 5f73 7562  ` or `create_sub
+0001c7c0: 7363 7269 7074 696f 6e5f 746f 5f73 7472  scription_to_str
+0001c7d0: 6561 6d28 2960 2e0a 0a54 6869 7320 6d65  eam()`...This me
+0001c7e0: 7468 6f64 2068 6173 2061 6e20 6f70 7469  thod has an opti
+0001c7f0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+0001c800: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
+0001c810: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+0001c820: 7460 0a74 6861 7420 7365 7473 2061 206d  t`.that sets a m
+0001c830: 6178 696d 756d 2064 7572 6174 696f 6e2c  aximum duration,
+0001c840: 2069 6e20 7365 636f 6e64 732c 2066 6f72   in seconds, for
+0001c850: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+0001c860: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+0001c870: 6174 696f 6e2e 0a0a 5468 6973 206d 6574  ation...This met
+0001c880: 686f 6420 6861 7320 616e 206f 7074 696f  hod has an optio
+0001c890: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
+0001c8a0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+0001c8b0: 6820 6361 6e20 6265 2075 7365 6420 746f  h can be used to
+0001c8c0: 0a6f 7665 7272 6964 6520 6361 6c6c 2063  .override call c
+0001c8d0: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
+0001c8e0: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
+0001c8f0: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
+0001c900: 492e 0a0a 5468 6520 6578 616d 706c 6520  I...The example 
+0001c910: 6265 6c6f 7720 6765 7473 2069 6e66 6f72  below gets infor
+0001c920: 6d61 7469 6f6e 2066 6f72 2074 6865 2070  mation for the p
+0001c930: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+0001c940: 6970 7469 6f6e 2060 6772 6f75 705f 6e61  iption `group_na
+0001c950: 6d65 3160 2077 6869 6368 0a77 6173 2063  me1` which.was c
+0001c960: 7265 6174 6564 2062 7920 6361 6c6c 696e  reated by callin
+0001c970: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
+0001c980: 6970 7469 6f6e 5f74 6f5f 616c 6c28 2960  iption_to_all()`
+0001c990: 2e0a 0a60 6060 7079 7468 6f6e 0a73 7562  ...```python.sub
+0001c9a0: 7363 7269 7074 696f 6e5f 696e 666f 203d  scription_info =
+0001c9b0: 2063 6c69 656e 742e 6765 745f 7375 6273   client.get_subs
+0001c9c0: 6372 6970 7469 6f6e 5f69 6e66 6f28 0a20  cription_info(. 
+0001c9d0: 2020 2067 726f 7570 5f6e 616d 653d 6772     group_name=gr
+0001c9e0: 6f75 705f 6e61 6d65 312c 0a29 0a60 6060  oup_name1,.).```
+0001c9f0: 0a0a 5468 6520 6578 616d 706c 6520 6265  ..The example be
+0001ca00: 6c6f 7720 6765 7473 2069 6e66 6f72 6d61  low gets informa
+0001ca10: 7469 6f6e 2066 6f72 2074 6865 2070 6572  tion for the per
+0001ca20: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+0001ca30: 7469 6f6e 2060 6772 6f75 705f 6e61 6d65  tion `group_name
+0001ca40: 3260 206f 6e0a 6073 7472 6561 6d5f 6e61  2` on.`stream_na
+0001ca50: 6d65 3260 2077 6869 6368 2077 6173 2063  me2` which was c
+0001ca60: 7265 6174 6564 2062 7920 6361 6c6c 696e  reated by callin
+0001ca70: 6720 6063 7265 6174 655f 7375 6273 6372  g `create_subscr
+0001ca80: 6970 7469 6f6e 5f74 6f5f 7374 7265 616d  iption_to_stream
+0001ca90: 2829 602e 0a0a 6060 6070 7974 686f 6e0a  ()`...```python.
+0001caa0: 7375 6273 6372 6970 7469 6f6e 5f69 6e66  subscription_inf
+0001cab0: 6f20 3d20 636c 6965 6e74 2e67 6574 5f73  o = client.get_s
+0001cac0: 7562 7363 7269 7074 696f 6e5f 696e 666f  ubscription_info
+0001cad0: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
+0001cae0: 3d67 726f 7570 5f6e 616d 6532 2c0a 2020  =group_name2,.  
+0001caf0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+0001cb00: 7265 616d 5f6e 616d 6532 2c0a 290a 6060  ream_name2,.).``
+0001cb10: 600a 0a54 6865 2072 6574 7572 6e65 6420  `..The returned 
+0001cb20: 7661 6c75 6520 6973 2061 2060 5375 6273  value is a `Subs
+0001cb30: 6372 6970 7469 6f6e 496e 666f 6020 6f62  criptionInfo` ob
+0001cb40: 6a65 6374 2e0a 0a23 2323 204c 6973 7420  ject...### List 
+0001cb50: 7375 6273 6372 6970 7469 6f6e 733c 6120  subscriptions<a 
+0001cb60: 6964 3d22 6c69 7374 2d73 7562 7363 7269  id="list-subscri
+0001cb70: 7074 696f 6e73 223e 3c2f 613e 0a0a 2a72  ptions"></a>..*r
+0001cb80: 6571 7569 7265 7320 6c65 6164 6572 2a0a  equires leader*.
+0001cb90: 0a54 6865 2060 6c69 7374 5f73 7562 7363  .The `list_subsc
+0001cba0: 7269 7074 696f 6e73 2829 6020 6d65 7468  riptions()` meth
+0001cbb0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+0001cbc0: 6f20 6765 7420 696e 666f 726d 6174 696f  o get informatio
+0001cbd0: 6e20 666f 7220 616c 6c0a 6578 6973 7469  n for all.existi
+0001cbe0: 6e67 2070 6572 7369 7374 656e 7420 7375  ng persistent su
+0001cbf0: 6273 6372 6970 7469 6f6e 732c 2062 6f74  bscriptions, bot
+0001cc00: 6820 2273 7562 7363 7269 7074 696f 6e73  h "subscriptions
+0001cc10: 2074 6f20 616c 6c22 2061 6e64 0a22 7375   to all" and."su
+0001cc20: 6273 6372 6970 7469 6f6e 7320 746f 2073  bscriptions to s
+0001cc30: 7472 6561 6d22 2e0a 0a54 6869 7320 6d65  tream"...This me
+0001cc40: 7468 6f64 2068 6173 2061 6e20 6f70 7469  thod has an opti
+0001cc50: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+0001cc60: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
+0001cc70: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+0001cc80: 7460 0a74 6861 7420 7365 7473 2061 206d  t`.that sets a m
+0001cc90: 6178 696d 756d 2064 7572 6174 696f 6e2c  aximum duration,
+0001cca0: 2069 6e20 7365 636f 6e64 732c 2066 6f72   in seconds, for
+0001ccb0: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+0001ccc0: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+0001ccd0: 6174 696f 6e2e 0a0a 5468 6973 206d 6574  ation...This met
+0001cce0: 686f 6420 6861 7320 616e 206f 7074 696f  hod has an optio
+0001ccf0: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
+0001cd00: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+0001cd10: 6820 6361 6e20 6265 2075 7365 6420 746f  h can be used to
+0001cd20: 0a6f 7665 7272 6964 6520 6361 6c6c 2063  .override call c
+0001cd30: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
+0001cd40: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
+0001cd50: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
+0001cd60: 492e 0a0a 5468 6520 6578 616d 706c 6520  I...The example 
+0001cd70: 6265 6c6f 7720 6c69 7374 7320 616c 6c20  below lists all 
+0001cd80: 7468 6520 6578 6973 7469 6e67 2070 6572  the existing per
+0001cd90: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+0001cda0: 7469 6f6e 732e 0a0a 6060 6070 7974 686f  tions...```pytho
+0001cdb0: 6e0a 7375 6273 6372 6970 7469 6f6e 7320  n.subscriptions 
+0001cdc0: 3d20 636c 6965 6e74 2e6c 6973 745f 7375  = client.list_su
+0001cdd0: 6273 6372 6970 7469 6f6e 7328 290a 6060  bscriptions().``
+0001cde0: 600a 0a54 6865 2072 6574 7572 6e65 6420  `..The returned 
+0001cdf0: 7661 6c75 6520 6973 2061 206c 6973 7420  value is a list 
+0001ce00: 6f66 2060 5375 6273 6372 6970 7469 6f6e  of `Subscription
+0001ce10: 496e 666f 6020 6f62 6a65 6374 732e 0a0a  Info` objects...
+0001ce20: 0a23 2323 204c 6973 7420 7375 6273 6372  .### List subscr
+0001ce30: 6970 7469 6f6e 7320 746f 2073 7472 6561  iptions to strea
+0001ce40: 6d3c 6120 6964 3d22 6c69 7374 2d73 7562  m<a id="list-sub
+0001ce50: 7363 7269 7074 696f 6e73 2d74 6f2d 7374  scriptions-to-st
+0001ce60: 7265 616d 223e 3c2f 613e 0a0a 2a72 6571  ream"></a>..*req
+0001ce70: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
+0001ce80: 6865 2060 6c69 7374 5f73 7562 7363 7269  he `list_subscri
+0001ce90: 7074 696f 6e73 5f74 6f5f 7374 7265 616d  ptions_to_stream
+0001cea0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+0001ceb0: 6520 7573 6564 2074 6f20 6765 7420 696e  e used to get in
+0001cec0: 666f 726d 6174 696f 6e20 666f 7220 616c  formation for al
+0001ced0: 6c0a 7468 6520 7065 7273 6973 7465 6e74  l.the persistent
+0001cee0: 2073 7562 7363 7269 7074 696f 6e73 2074   subscriptions t
+0001cef0: 6f20 6120 7374 7265 616d 2e0a 0a54 6869  o a stream...Thi
+0001cf00: 7320 6d65 7468 6f64 2068 6173 206f 6e65  s method has one
+0001cf10: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
+0001cf20: 6e74 2c20 6073 7472 6561 6d5f 6e61 6d65  nt, `stream_name
+0001cf30: 602e 0a0a 5468 6973 206d 6574 686f 6420  `...This method 
+0001cf40: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
+0001cf50: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
+0001cf60: 6e74 2c20 7768 6963 6820 6973 2061 2050  nt, which is a P
+0001cf70: 7974 686f 6e20 6066 6c6f 6174 600a 7468  ython `float`.th
+0001cf80: 6174 2073 6574 7320 6120 6d61 7869 6d75  at sets a maximu
+0001cf90: 6d20 6475 7261 7469 6f6e 2c20 696e 2073  m duration, in s
+0001cfa0: 6563 6f6e 6473 2c20 666f 7220 7468 6520  econds, for the 
+0001cfb0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+0001cfc0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+0001cfd0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
+0001cfe0: 6173 2061 6e20 6f70 7469 6f6e 616c 2060  as an optional `
+0001cff0: 6372 6564 656e 7469 616c 7360 2061 7267  credentials` arg
+0001d000: 756d 656e 742c 2077 6869 6368 2063 616e  ument, which can
+0001d010: 2062 6520 7573 6564 2074 6f0a 6f76 6572   be used to.over
+0001d020: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
+0001d030: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
+0001d040: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
+0001d050: 6e20 7374 7269 6e67 2055 5249 2e0a 0a60  n string URI...`
+0001d060: 6060 7079 7468 6f6e 0a73 7562 7363 7269  ``python.subscri
+0001d070: 7074 696f 6e73 203d 2063 6c69 656e 742e  ptions = client.
+0001d080: 6c69 7374 5f73 7562 7363 7269 7074 696f  list_subscriptio
+0001d090: 6e73 5f74 6f5f 7374 7265 616d 280a 2020  ns_to_stream(.  
+0001d0a0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+0001d0b0: 7265 616d 5f6e 616d 6532 2c0a 290a 6060  ream_name2,.).``
+0001d0c0: 600a 0a54 6865 2072 6574 7572 6e65 6420  `..The returned 
+0001d0d0: 7661 6c75 6520 6973 2061 206c 6973 7420  value is a list 
+0001d0e0: 6f66 2060 5375 6273 6372 6970 7469 6f6e  of `Subscription
+0001d0f0: 496e 666f 6020 6f62 6a65 6374 732e 0a0a  Info` objects...
+0001d100: 0a23 2323 2044 656c 6574 6520 7375 6273  .### Delete subs
+0001d110: 6372 6970 7469 6f6e 3c61 2069 643d 2264  cription<a id="d
+0001d120: 656c 6574 652d 7375 6273 6372 6970 7469  elete-subscripti
+0001d130: 6f6e 223e 3c2f 613e 0a0a 2a72 6571 7569  on"></a>..*requi
+0001d140: 7265 7320 6c65 6164 6572 2a0a 0a54 6865  res leader*..The
+0001d150: 2060 6465 6c65 7465 5f73 7562 7363 7269   `delete_subscri
+0001d160: 7074 696f 6e28 2960 206d 6574 686f 6420  ption()` method 
+0001d170: 6361 6e20 6265 2075 7365 6420 746f 2064  can be used to d
+0001d180: 656c 6574 6520 6120 7065 7273 6973 7465  elete a persiste
+0001d190: 6e74 0a73 7562 7363 7269 7074 696f 6e2e  nt.subscription.
+0001d1a0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+0001d1b0: 7320 6120 7265 7175 6972 6564 2060 6772  s a required `gr
+0001d1c0: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
+0001d1d0: 6e74 2061 6e64 2061 6e20 6f70 7469 6f6e  nt and an option
+0001d1e0: 616c 2060 7374 7265 616d 5f6e 616d 6560  al `stream_name`
+0001d1f0: 0a61 7267 756d 656e 742c 2077 6869 6368  .argument, which
+0001d200: 2073 686f 756c 6420 6d61 7463 6820 7468   should match th
+0001d210: 6520 7661 6c75 6573 206f 6620 6172 6775  e values of argu
+0001d220: 6d65 6e74 7320 7573 6564 2077 6865 6e20  ments used when 
+0001d230: 6361 6c6c 696e 6720 6569 7468 6572 0a60  calling either.`
+0001d240: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
+0001d250: 696f 6e5f 746f 5f61 6c6c 2829 6020 6f72  ion_to_all()` or
+0001d260: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
+0001d270: 7074 696f 6e5f 746f 5f73 7472 6561 6d28  ption_to_stream(
+0001d280: 2960 2e0a 0a54 6869 7320 6d65 7468 6f64  )`...This method
+0001d290: 2068 6173 2061 6e20 6f70 7469 6f6e 616c   has an optional
+0001d2a0: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
+0001d2b0: 656e 742c 2077 6869 6368 2069 7320 6120  ent, which is a 
+0001d2c0: 5079 7468 6f6e 2060 666c 6f61 7460 0a74  Python `float`.t
+0001d2d0: 6861 7420 7365 7473 2061 206d 6178 696d  hat sets a maxim
+0001d2e0: 756d 2064 7572 6174 696f 6e2c 2069 6e20  um duration, in 
+0001d2f0: 7365 636f 6e64 732c 2066 6f72 2074 6865  seconds, for the
+0001d300: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+0001d310: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+0001d320: 6e2e 0a0a 5468 6973 206d 6574 686f 6420  n...This method 
+0001d330: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
+0001d340: 6063 7265 6465 6e74 6961 6c73 6020 6172  `credentials` ar
+0001d350: 6775 6d65 6e74 2c20 7768 6963 6820 6361  gument, which ca
+0001d360: 6e20 6265 2075 7365 6420 746f 0a6f 7665  n be used to.ove
+0001d370: 7272 6964 6520 6361 6c6c 2063 7265 6465  rride call crede
+0001d380: 6e74 6961 6c73 2064 6572 6976 6564 2066  ntials derived f
+0001d390: 726f 6d20 7468 6520 636f 6e6e 6563 7469  rom the connecti
+0001d3a0: 6f6e 2073 7472 696e 6720 5552 492e 0a0a  on string URI...
+0001d3b0: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+0001d3c0: 7720 6465 6c65 7465 7320 7468 6520 7065  w deletes the pe
+0001d3d0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+0001d3e0: 7074 696f 6e20 6067 726f 7570 5f6e 616d  ption `group_nam
+0001d3f0: 6531 6020 7768 6963 680a 7761 7320 6372  e1` which.was cr
+0001d400: 6561 7465 6420 6279 2063 616c 6c69 6e67  eated by calling
+0001d410: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
+0001d420: 7074 696f 6e5f 746f 5f61 6c6c 2829 602e  ption_to_all()`.
+0001d430: 0a0a 6060 6070 7974 686f 6e0a 636c 6965  ..```python.clie
+0001d440: 6e74 2e64 656c 6574 655f 7375 6273 6372  nt.delete_subscr
+0001d450: 6970 7469 6f6e 280a 2020 2020 6772 6f75  iption(.    grou
+0001d460: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+0001d470: 6531 2c0a 290a 6060 600a 0a54 6865 2065  e1,.).```..The e
+0001d480: 7861 6d70 6c65 2062 656c 6f77 2064 656c  xample below del
+0001d490: 6574 6564 2074 6865 2070 6572 7369 7374  eted the persist
+0001d4a0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+0001d4b0: 2060 6772 6f75 705f 6e61 6d65 3260 206f   `group_name2` o
+0001d4c0: 6e0a 6073 7472 6561 6d5f 6e61 6d65 3260  n.`stream_name2`
+0001d4d0: 2077 6869 6368 2077 6173 2063 7265 6174   which was creat
+0001d4e0: 6564 2062 7920 6361 6c6c 696e 6720 6063  ed by calling `c
+0001d4f0: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
+0001d500: 6f6e 5f74 6f5f 7374 7265 616d 2829 602e  on_to_stream()`.
+0001d510: 0a0a 6060 6070 7974 686f 6e0a 636c 6965  ..```python.clie
+0001d520: 6e74 2e64 656c 6574 655f 7375 6273 6372  nt.delete_subscr
+0001d530: 6970 7469 6f6e 280a 2020 2020 6772 6f75  iption(.    grou
+0001d540: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+0001d550: 6532 2c0a 2020 2020 7374 7265 616d 5f6e  e2,.    stream_n
+0001d560: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+0001d570: 2c0a 290a 6060 600a 0a0a 2323 2050 726f  ,.).```...## Pro
+0001d580: 6a65 6374 696f 6e73 3c61 2069 643d 2270  jections<a id="p
+0001d590: 726f 6a65 6374 696f 6e73 223e 3c2f 613e  rojections"></a>
+0001d5a0: 0a0a 2323 2320 4372 6561 7465 2070 726f  ..### Create pro
+0001d5b0: 6a65 6374 696f 6e3c 6120 6964 3d22 6372  jection<a id="cr
+0001d5c0: 6561 7465 2d70 726f 6a65 6374 696f 6e22  eate-projection"
+0001d5d0: 3e3c 2f61 3e0a 0a54 6865 2060 6372 6561  ></a>..The `crea
+0001d5e0: 7465 5f70 726f 6a65 6374 696f 6e28 2960  te_projection()`
+0001d5f0: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+0001d600: 7365 6420 746f 2063 7265 6174 6520 6120  sed to create a 
+0001d610: 7072 6f6a 6563 7469 6f6e 2e0a 0a54 6869  projection...Thi
+0001d620: 7320 6d65 7468 6f64 2068 6173 2061 2072  s method has a r
+0001d630: 6571 7569 7265 6420 6071 7565 7279 6020  equired `query` 
+0001d640: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
+0001d650: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
+0001d660: 6020 7468 6174 0a64 6566 696e 6573 2077  ` that.defines w
+0001d670: 6861 7420 7468 6520 7072 6f6a 6563 7469  hat the projecti
+0001d680: 6f6e 2077 696c 6c20 646f 2e0a 0a54 6869  on will do...Thi
+0001d690: 7320 6d65 7468 6f64 2061 6c73 6f20 6861  s method also ha
+0001d6a0: 7320 7369 7820 6f70 7469 6f6e 616c 2061  s six optional a
+0001d6b0: 7267 756d 656e 7473 2c20 606e 616d 6560  rguments, `name`
+0001d6c0: 2c20 6063 6f6e 7469 6e75 6f75 7360 2c20  , `continuous`, 
+0001d6d0: 6065 6d69 745f 656e 6162 6c65 6460 2c0a  `emit_enabled`,.
+0001d6e0: 6074 7261 636b 5f65 6d69 7474 6564 5f73  `track_emitted_s
+0001d6f0: 7472 6561 6d73 602c 2060 7469 6d65 6f75  treams`, `timeou
+0001d700: 7460 2c20 616e 6420 6063 7265 6465 6e74  t`, and `credent
+0001d710: 6961 6c73 602e 0a0a 5468 6520 6f70 7469  ials`...The opti
+0001d720: 6f6e 616c 2060 6e61 6d65 6020 6172 6775  onal `name` argu
+0001d730: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+0001d740: 2060 7374 7260 2077 6869 6368 2073 7065   `str` which spe
+0001d750: 6369 6669 6573 2074 6865 206e 616d 6520  cifies the name 
+0001d760: 6f66 2074 6865 2070 726f 6a65 6374 696f  of the projectio
+0001d770: 6e2e 0a49 6620 6120 6e61 6d65 2069 7320  n..If a name is 
+0001d780: 7072 6f76 6964 6564 2c20 7468 6520 7072  provided, the pr
+0001d790: 6f6a 6563 7469 6f6e 2077 696c 6c20 6569  ojection will ei
+0001d7a0: 7468 6572 2062 6520 6120 2274 7261 6e73  ther be a "trans
+0001d7b0: 6965 6e74 2220 6f72 2061 2022 636f 6e74  ient" or a "cont
+0001d7c0: 696e 756f 7573 220a 7072 6f6a 6563 7469  inuous".projecti
+0001d7d0: 6f6e 2e20 4f74 6865 7277 6973 652c 2074  on. Otherwise, t
+0001d7e0: 6865 2070 726f 6a65 6374 696f 6e20 7769  he projection wi
+0001d7f0: 6c6c 2062 6520 6120 226f 6e65 2074 696d  ll be a "one tim
+0001d800: 6522 2070 726f 6a65 6374 696f 6e2e 0a0a  e" projection...
+0001d810: 5468 6520 6f70 7469 6f6e 616c 2060 636f  The optional `co
+0001d820: 6e74 696e 756f 7573 6020 6172 6775 6d65  ntinuous` argume
+0001d830: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+0001d840: 626f 6f6c 6020 7768 6963 6820 7370 6563  bool` which spec
+0001d850: 6966 6965 7320 7768 6574 6865 7220 610a  ifies whether a.
+0001d860: 7072 6f6a 6563 7469 6f6e 2077 696c 6c20  projection will 
+0001d870: 6265 2061 2022 636f 6e74 696e 756f 7573  be a "continuous
+0001d880: 2220 7072 6f6a 6563 7469 6f6e 2e20 4966  " projection. If
+0001d890: 2061 2060 5472 7565 6020 7661 6c75 6520   a `True` value 
+0001d8a0: 6973 2073 7065 6369 6669 6564 2c20 7468  is specified, th
+0001d8b0: 650a 7072 6f6a 6563 7469 6f6e 2077 696c  e.projection wil
+0001d8c0: 6c20 6265 2061 2022 636f 6e74 696e 756f  l be a "continuo
+0001d8d0: 7573 2220 7072 6f6a 6563 7469 6f6e 2c20  us" projection, 
+0001d8e0: 6f74 6865 7277 6973 6520 7468 6520 7072  otherwise the pr
+0001d8f0: 6f6a 6563 7469 6f6e 2077 696c 6c20 6265  ojection will be
+0001d900: 2061 0a22 7472 616e 7369 656e 7422 2070   a."transient" p
+0001d910: 726f 6a65 6374 696f 6e2e 2054 6865 2064  rojection. The d
+0001d920: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+0001d930: 6063 6f6e 7469 6e75 6f75 7360 2069 7320  `continuous` is 
+0001d940: 6046 616c 7365 602e 0a0a 5468 6520 6f70  `False`...The op
+0001d950: 7469 6f6e 616c 2060 656d 6974 5f65 6e61  tional `emit_ena
+0001d960: 626c 6564 6020 6172 6775 6d65 6e74 2069  bled` argument i
+0001d970: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
+0001d980: 6020 7768 6963 6820 7370 6563 6966 6965  ` which specifie
+0001d990: 7320 7768 6574 6865 7220 610a 7072 6f6a  s whether a.proj
+0001d9a0: 6563 7469 6f6e 2077 696c 6c20 6265 2061  ection will be a
+0001d9b0: 626c 6520 746f 2065 6d69 7420 6576 656e  ble to emit even
+0001d9c0: 7473 2e20 4966 2061 2060 5472 7565 6020  ts. If a `True` 
+0001d9d0: 7661 6c75 6520 6973 2073 7065 6369 6669  value is specifi
+0001d9e0: 6564 2c20 7468 6520 7072 6f6a 6563 7469  ed, the projecti
+0001d9f0: 6f6e 0a77 696c 6c20 6265 2061 626c 6520  on.will be able 
+0001da00: 746f 2065 6d69 7420 6576 656e 7473 2c20  to emit events, 
+0001da10: 6f74 6865 7277 6973 6520 7468 6520 7072  otherwise the pr
+0001da20: 6f6a 6563 7469 6f6e 2077 696c 6c20 6e6f  ojection will no
+0001da30: 7420 6265 2061 626c 6520 746f 2065 6d69  t be able to emi
+0001da40: 7420 6576 656e 7473 2e0a 5468 6520 6465  t events..The de
+0001da50: 6661 756c 7420 7661 6c75 6520 6f66 2060  fault value of `
+0001da60: 656d 6974 5f65 6e61 626c 6564 6020 6973  emit_enabled` is
+0001da70: 2060 4661 6c73 6560 2e0a 0a54 6865 206f   `False`...The o
+0001da80: 7074 696f 6e61 6c20 6074 7261 636b 5f65  ptional `track_e
+0001da90: 6d69 7474 6564 5f73 7472 6561 6d73 6020  mitted_streams` 
+0001daa0: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+0001dab0: 7468 6f6e 2060 626f 6f6c 6020 7768 6963  thon `bool` whic
+0001dac0: 6820 7370 6563 6966 6965 7320 7768 6574  h specifies whet
+0001dad0: 6865 720a 6120 7072 6f6a 6563 7469 6f6e  her.a projection
+0001dae0: 2077 696c 6c20 6861 7665 2069 7473 2065   will have its e
+0001daf0: 6d69 7474 6564 2073 7472 6561 6d73 2074  mitted streams t
+0001db00: 7261 636b 6564 2e20 4966 2061 2060 5472  racked. If a `Tr
+0001db10: 7565 6020 7661 6c75 6520 6973 2073 7065  ue` value is spe
+0001db20: 6369 6669 6564 2c20 7468 650a 7072 6f6a  cified, the.proj
+0001db30: 6563 7469 6f6e 2077 696c 6c20 6861 7665  ection will have
+0001db40: 2069 7473 2065 6d69 7474 6564 2073 7472   its emitted str
+0001db50: 6561 6d73 2074 7261 636b 6564 2c20 6f74  eams tracked, ot
+0001db60: 6865 7277 6973 6520 7468 6520 7072 6f6a  herwise the proj
+0001db70: 6563 7469 6f6e 2077 696c 6c20 6e6f 740a  ection will not.
+0001db80: 6861 7665 2069 7473 2065 6d69 7474 6564  have its emitted
+0001db90: 2073 7472 6561 6d73 2074 7261 636b 6564   streams tracked
+0001dba0: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+0001dbb0: 6c75 6520 6f66 2060 7472 6163 6b5f 656d  lue of `track_em
+0001dbc0: 6974 7465 645f 7374 7265 616d 7360 2069  itted_streams` i
+0001dbd0: 7320 6046 616c 7365 602e 0a0a 5468 6520  s `False`...The 
+0001dbe0: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+0001dbf0: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
+0001dc00: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
+0001dc10: 7768 6963 6820 7365 7473 2061 0a6d 6178  which sets a.max
+0001dc20: 696d 756d 2064 7572 6174 696f 6e2c 2069  imum duration, i
+0001dc30: 6e20 7365 636f 6e64 732c 2066 6f72 2074  n seconds, for t
+0001dc40: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+0001dc50: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+0001dc60: 696f 6e2e 0a0a 5468 6520 6f70 7469 6f6e  ion...The option
+0001dc70: 616c 2060 6372 6564 656e 7469 616c 7360  al `credentials`
+0001dc80: 2061 7267 756d 656e 7420 6361 6e20 6265   argument can be
+0001dc90: 2075 7365 6420 746f 0a6f 7665 7272 6964   used to.overrid
+0001dca0: 6520 6361 6c6c 2063 7265 6465 6e74 6961  e call credentia
+0001dcb0: 6c73 2064 6572 6976 6564 2066 726f 6d20  ls derived from 
+0001dcc0: 7468 6520 636f 6e6e 6563 7469 6f6e 2073  the connection s
+0001dcd0: 7472 696e 6720 5552 492e 0a0a 496e 2074  tring URI...In t
+0001dce0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+0001dcf0: 2c20 6120 636f 6e74 696e 756f 7573 2070  , a continuous p
+0001dd00: 726f 6a65 6374 696f 6e20 6973 2063 7265  rojection is cre
+0001dd10: 6174 6564 2074 6861 7420 7072 6f63 6573  ated that proces
+0001dd20: 7365 730a 6576 656e 7473 2061 7070 656e  ses.events appen
+0001dd30: 6465 6420 746f 2060 7374 7265 616d 5f6e  ded to `stream_n
+0001dd40: 616d 6532 602e 2054 6865 2022 7374 6174  ame2`. The "stat
+0001dd50: 6522 206f 6620 7468 6520 7072 6f6a 6563  e" of the projec
+0001dd60: 7469 6f6e 2069 730a 696e 6974 6961 6c69  tion is.initiali
+0001dd70: 7365 6420 746f 2068 6176 6520 6120 2263  sed to have a "c
+0001dd80: 6f75 6e74 2220 7468 6174 2069 7320 696e  ount" that is in
+0001dd90: 6372 656d 656e 7465 6420 6f6e 6365 2066  cremented once f
+0001dda0: 6f72 2065 6163 6820 6576 656e 742e 0a0a  or each event...
+0001ddb0: 6060 6070 7974 686f 6e0a 7072 6f6a 6563  ```python.projec
+0001ddc0: 7469 6f6e 5f6e 616d 6520 3d20 7374 7228  tion_name = str(
+0001ddd0: 7575 6964 2e75 7569 6434 2829 290a 0a70  uuid.uuid4())..p
+0001dde0: 726f 6a65 6374 696f 6e5f 7175 6572 7920  rojection_query 
+0001ddf0: 3d20 2222 2266 726f 6d53 7472 6561 6d28  = """fromStream(
+0001de00: 2725 7327 290a 2e77 6865 6e28 7b0a 2020  '%s')..when({.  
+0001de10: 2469 6e69 743a 2066 756e 6374 696f 6e28  $init: function(
+0001de20: 297b 0a20 2020 2072 6574 7572 6e20 7b0a  ){.    return {.
+0001de30: 2020 2020 2020 636f 756e 743a 2030 0a20        count: 0. 
+0001de40: 2020 207d 3b0a 2020 7d2c 0a20 204f 7264     };.  },.  Ord
+0001de50: 6572 4372 6561 7465 643a 2066 756e 6374  erCreated: funct
+0001de60: 696f 6e28 732c 6529 7b0a 2020 2020 732e  ion(s,e){.    s.
+0001de70: 636f 756e 7420 2b3d 2031 3b0a 2020 7d2c  count += 1;.  },
+0001de80: 0a20 204f 7264 6572 5570 6461 7465 643a  .  OrderUpdated:
+0001de90: 2066 756e 6374 696f 6e28 732c 6529 7b0a   function(s,e){.
+0001dea0: 2020 2020 732e 636f 756e 7420 2b3d 2031      s.count += 1
+0001deb0: 3b0a 2020 7d2c 0a20 204f 7264 6572 4465  ;.  },.  OrderDe
+0001dec0: 6c65 7465 643a 2066 756e 6374 696f 6e28  leted: function(
+0001ded0: 732c 6529 7b0a 2020 2020 732e 636f 756e  s,e){.    s.coun
+0001dee0: 7420 2b3d 2031 3b0a 2020 7d0a 7d29 0a2e  t += 1;.  }.})..
+0001def0: 6f75 7470 7574 5374 6174 6528 290a 2222  outputState().""
+0001df00: 2220 2025 2073 7472 6561 6d5f 6e61 6d65  "  % stream_name
+0001df10: 320a 0a63 6c69 656e 742e 6372 6561 7465  2..client.create
+0001df20: 5f70 726f 6a65 6374 696f 6e28 0a20 2020  _projection(.   
+0001df30: 206e 616d 653d 7072 6f6a 6563 7469 6f6e   name=projection
+0001df40: 5f6e 616d 652c 0a20 2020 2071 7565 7279  _name,.    query
+0001df50: 3d70 726f 6a65 6374 696f 6e5f 7175 6572  =projection_quer
+0001df60: 792c 0a20 2020 2063 6f6e 7469 6e75 6f75  y,.    continuou
+0001df70: 733d 5472 7565 2c0a 290a 6060 600a 0a23  s=True,.).```..#
+0001df80: 2323 2047 6574 2070 726f 6a65 6374 696f  ## Get projectio
+0001df90: 6e20 7374 6174 653c 6120 6964 3d22 6765  n state<a id="ge
+0001dfa0: 742d 7072 6f6a 6563 7469 6f6e 2d73 7461  t-projection-sta
+0001dfb0: 7465 223e 3c2f 613e 0a0a 5468 6520 6067  te"></a>..The `g
+0001dfc0: 6574 5f70 726f 6a65 6374 696f 6e5f 7374  et_projection_st
+0001dfd0: 6174 6528 2960 206d 6574 686f 6420 6361  ate()` method ca
+0001dfe0: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
+0001dff0: 2061 2070 726f 6a65 6374 696f 6e27 7320   a projection's 
+0001e000: 7374 6174 652e 0a0a 5468 6973 206d 6574  state...This met
+0001e010: 686f 6420 6861 7320 6120 7265 7175 6972  hod has a requir
+0001e020: 6564 2060 6e61 6d65 6020 6172 6775 6d65  ed `name` argume
+0001e030: 6e74 2c20 7768 6963 6820 6973 2061 2050  nt, which is a P
+0001e040: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
+0001e050: 0a73 7065 6369 6669 6573 2074 6865 206e  .specifies the n
+0001e060: 616d 6520 6f66 2061 2070 726f 6a65 6374  ame of a project
+0001e070: 696f 6e2e 0a0a 5468 6973 206d 6574 686f  ion...This metho
+0001e080: 6420 616c 736f 2068 6173 2074 6872 6565  d also has three
+0001e090: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0001e0a0: 6e74 732c 2060 7061 7274 6974 696f 6e60  nts, `partition`
+0001e0b0: 2c20 6074 696d 656f 7574 602c 2061 6e64  , `timeout`, and
+0001e0c0: 2060 6372 6564 656e 7469 616c 7360 2e0a   `credentials`..
+0001e0d0: 0a54 6865 206f 7074 696f 6e61 6c20 6070  .The optional `p
+0001e0e0: 6172 7469 7469 6f6e 6020 6172 6775 6d65  artition` argume
+0001e0f0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+0001e100: 7374 7260 2077 6869 6368 2073 7065 6369  str` which speci
+0001e110: 6669 6573 2061 2070 6172 7469 7469 6f6e  fies a partition
+0001e120: 2e2e 2e0a 0a54 6865 206f 7074 696f 6e61  .....The optiona
+0001e130: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+0001e140: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+0001e150: 2060 666c 6f61 7460 2077 6869 6368 2073   `float` which s
+0001e160: 6574 7320 610a 6d61 7869 6d75 6d20 6475  ets a.maximum du
+0001e170: 7261 7469 6f6e 2c20 696e 2073 6563 6f6e  ration, in secon
+0001e180: 6473 2c20 666f 7220 7468 6520 636f 6d70  ds, for the comp
+0001e190: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+0001e1a0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+0001e1b0: 6865 206f 7074 696f 6e61 6c20 6063 7265  he optional `cre
+0001e1c0: 6465 6e74 6961 6c73 6020 6172 6775 6d65  dentials` argume
+0001e1d0: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+0001e1e0: 6f0a 6f76 6572 7269 6465 2063 616c 6c20  o.override call 
+0001e1f0: 6372 6564 656e 7469 616c 7320 6465 7269  credentials deri
+0001e200: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
+0001e210: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
+0001e220: 5249 2e0a 0a49 6e20 7468 6520 6578 616d  RI...In the exam
+0001e230: 706c 6520 6265 6c6f 772c 2061 6674 6572  ple below, after
+0001e240: 2073 6c65 6570 696e 6720 666f 7220 3120   sleeping for 1 
+0001e250: 7365 636f 6e64 2074 6f20 616c 6c6f 7720  second to allow 
+0001e260: 7468 6520 7072 6f6a 6563 7469 6f6e 0a74  the projection.t
+0001e270: 6f20 7072 6f63 6573 7320 616c 6c20 7468  o process all th
+0001e280: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+0001e290: 732c 2074 6865 2070 726f 6a65 6374 696f  s, the projectio
+0001e2a0: 6e20 2273 7461 7465 2220 6973 206f 6274  n "state" is obt
+0001e2b0: 6169 6e65 642e 0a57 6520 6361 6e20 7365  ained..We can se
+0001e2c0: 6520 7468 6174 2074 6865 2070 726f 6a65  e that the proje
+0001e2d0: 6374 696f 6e20 6861 7320 7072 6f63 6573  ction has proces
+0001e2e0: 7365 6420 7468 7265 6520 6576 656e 7473  sed three events
+0001e2f0: 2e0a 0a60 6060 7079 7468 6f6e 0a73 6c65  ...```python.sle
+0001e300: 6570 2831 2920 2023 2061 6c6c 6f77 2074  ep(1)  # allow t
+0001e310: 696d 6520 666f 7220 7072 6f6a 6563 7469  ime for projecti
+0001e320: 6f6e 2074 6f20 7072 6f63 6573 7320 7265  on to process re
+0001e330: 636f 7264 6564 2065 7665 6e74 730a 0a70  corded events..p
+0001e340: 726f 6a65 6374 696f 6e5f 7374 6174 6520  rojection_state 
+0001e350: 3d20 636c 6965 6e74 2e67 6574 5f70 726f  = client.get_pro
+0001e360: 6a65 6374 696f 6e5f 7374 6174 6528 6e61  jection_state(na
+0001e370: 6d65 3d70 726f 6a65 6374 696f 6e5f 6e61  me=projection_na
+0001e380: 6d65 290a 0a61 7373 6572 7420 7072 6f6a  me)..assert proj
+0001e390: 6563 7469 6f6e 5f73 7461 7465 2e76 616c  ection_state.val
+0001e3a0: 7565 203d 3d20 7b27 636f 756e 7427 3a20  ue == {'count': 
+0001e3b0: 337d 0a60 6060 0a0a 2323 2320 4765 7420  3}.```..### Get 
+0001e3c0: 7072 6f6a 6563 7469 6f6e 2072 6573 756c  projection resul
+0001e3d0: 743c 6120 6964 3d22 6765 742d 7072 6f6a  t<a id="get-proj
+0001e3e0: 6563 7469 6f6e 2d72 6573 756c 7422 3e3c  ection-result"><
+0001e3f0: 2f61 3e0a 0a54 6865 2060 6765 745f 7072  /a>..The `get_pr
+0001e400: 6f6a 6563 7469 6f6e 5f72 6573 756c 7428  ojection_result(
+0001e410: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+0001e420: 2075 7365 6420 746f 2067 6574 2061 2070   used to get a p
+0001e430: 726f 6a65 6374 696f 6e27 7320 7265 7375  rojection's resu
+0001e440: 6c74 2e0a 0a54 6869 7320 6d65 7468 6f64  lt...This method
+0001e450: 2068 6173 2061 2072 6571 7569 7265 6420   has a required 
+0001e460: 606e 616d 6560 2061 7267 756d 656e 742c  `name` argument,
+0001e470: 2077 6869 6368 2069 7320 6120 5079 7468   which is a Pyth
+0001e480: 6f6e 2060 7374 7260 2074 6861 740a 7370  on `str` that.sp
+0001e490: 6563 6966 6965 7320 7468 6520 6e61 6d65  ecifies the name
+0001e4a0: 206f 6620 6120 7072 6f6a 6563 7469 6f6e   of a projection
+0001e4b0: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
+0001e4c0: 6c73 6f20 6861 7320 7468 7265 6520 6f70  lso has three op
+0001e4d0: 7469 6f6e 616c 2061 7267 756d 656e 7473  tional arguments
+0001e4e0: 2c20 6070 6172 7469 7469 6f6e 602c 2060  , `partition`, `
+0001e4f0: 7469 6d65 6f75 7460 2c20 616e 6420 6063  timeout`, and `c
+0001e500: 7265 6465 6e74 6961 6c73 602e 0a0a 5468  redentials`...Th
+0001e510: 6520 6f70 7469 6f6e 616c 2060 7061 7274  e optional `part
+0001e520: 6974 696f 6e60 2061 7267 756d 656e 7420  ition` argument 
+0001e530: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
+0001e540: 6020 7768 6963 6820 7370 6563 6966 6965  ` which specifie
+0001e550: 7320 6120 7061 7274 6974 696f 6e2e 2e2e  s a partition...
+0001e560: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0001e570: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+0001e580: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
+0001e590: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
+0001e5a0: 2061 0a6d 6178 696d 756d 2064 7572 6174   a.maximum durat
+0001e5b0: 696f 6e2c 2069 6e20 7365 636f 6e64 732c  ion, in seconds,
+0001e5c0: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+0001e5d0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+0001e5e0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+0001e5f0: 6f70 7469 6f6e 616c 2060 6372 6564 656e  optional `creden
+0001e600: 7469 616c 7360 2061 7267 756d 656e 7420  tials` argument 
+0001e610: 6361 6e20 6265 2075 7365 6420 746f 0a6f  can be used to.o
+0001e620: 7665 7272 6964 6520 6361 6c6c 2063 7265  verride call cre
+0001e630: 6465 6e74 6961 6c73 2064 6572 6976 6564  dentials derived
+0001e640: 2066 726f 6d20 7468 6520 636f 6e6e 6563   from the connec
+0001e650: 7469 6f6e 2073 7472 696e 6720 5552 492e  tion string URI.
+0001e660: 0a0a 496e 2074 6865 2065 7861 6d70 6c65  ..In the example
+0001e670: 2062 656c 6f77 2c20 7468 6520 7072 6f6a   below, the proj
+0001e680: 6563 7469 6f6e 2022 7265 7375 6c74 2220  ection "result" 
+0001e690: 6973 206f 6274 6169 6e65 642e 0a57 6520  is obtained..We 
+0001e6a0: 6361 6e20 7365 6520 7468 6174 2074 6865  can see that the
+0001e6b0: 2070 726f 6a65 6374 696f 6e20 6861 7320   projection has 
+0001e6c0: 7072 6f63 6573 7365 6420 7468 7265 6520  processed three 
+0001e6d0: 6576 656e 7473 2e0a 0a60 6060 7079 7468  events...```pyth
+0001e6e0: 6f6e 0a70 726f 6a65 6374 696f 6e5f 7265  on.projection_re
+0001e6f0: 7375 6c74 203d 2063 6c69 656e 742e 6765  sult = client.ge
+0001e700: 745f 7072 6f6a 6563 7469 6f6e 5f72 6573  t_projection_res
+0001e710: 756c 7428 6e61 6d65 3d70 726f 6a65 6374  ult(name=project
+0001e720: 696f 6e5f 6e61 6d65 290a 0a61 7373 6572  ion_name)..asser
+0001e730: 7420 7072 6f6a 6563 7469 6f6e 5f72 6573  t projection_res
+0001e740: 756c 742e 7661 6c75 6520 3d3d 207b 2763  ult.value == {'c
+0001e750: 6f75 6e74 273a 2033 7d0a 6060 600a 0a23  ount': 3}.```..#
+0001e760: 2323 2047 6574 2070 726f 6a65 6374 696f  ## Get projectio
+0001e770: 6e20 7374 6174 6973 7469 6373 3c61 2069  n statistics<a i
+0001e780: 643d 2267 6574 2d70 726f 6a65 6374 696f  d="get-projectio
+0001e790: 6e2d 7374 6174 6973 7469 6373 223e 3c2f  n-statistics"></
+0001e7a0: 613e 0a0a 5468 6520 6067 6574 5f70 726f  a>..The `get_pro
+0001e7b0: 6a65 6374 696f 6e5f 7374 6174 6973 7475  jection_statistu
+0001e7c0: 6373 2829 6020 6d65 7468 6f64 2063 616e  cs()` method can
+0001e7d0: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
+0001e7e0: 7072 6f6a 6563 7469 6f6e 2073 7461 7469  projection stati
+0001e7f0: 7374 6963 732e 0a0a 5468 6973 206d 6574  stics...This met
+0001e800: 686f 6420 616c 736f 2068 6173 2073 6576  hod also has sev
+0001e810: 656e 206f 7074 696f 6e61 6c20 6172 6775  en optional argu
+0001e820: 6d65 6e74 732c 2060 6e61 6d65 602c 2060  ments, `name`, `
+0001e830: 616c 6c60 2c20 6074 7261 6e73 6965 6e74  all`, `transient
+0001e840: 602c 0a60 636f 6e74 696e 756f 7573 602c  `,.`continuous`,
+0001e850: 2060 6f6e 655f 7469 6d65 602c 2060 7469   `one_time`, `ti
+0001e860: 6d65 6f75 7460 2c20 616e 6420 6063 7265  meout`, and `cre
+0001e870: 6465 6e74 6961 6c73 602e 0a0a 5468 6520  dentials`...The 
+0001e880: 6f70 7469 6f6e 616c 2060 6e61 6d65 6020  optional `name` 
+0001e890: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+0001e8a0: 7468 6f6e 2060 7374 7260 2074 6861 7420  thon `str` that 
+0001e8b0: 7370 6563 6966 6965 7320 7468 6520 6e61  specifies the na
+0001e8c0: 6d65 206f 6620 610a 7072 6f6a 6563 7469  me of a.projecti
+0001e8d0: 6f6e 2e20 4966 2074 6865 206e 616d 6520  on. If the name 
+0001e8e0: 6f66 2061 2070 726f 6a65 6374 696f 6e20  of a projection 
+0001e8f0: 6973 2073 7065 6369 6669 6564 2c20 7468  is specified, th
+0001e900: 6973 206d 6574 686f 6420 7769 6c6c 2072  is method will r
+0001e910: 6574 7572 6e0a 6120 7369 6e67 6c65 2060  eturn.a single `
+0001e920: 5072 6f6a 6563 7469 6f6e 5374 6174 6973  ProjectionStatis
+0001e930: 7469 6373 6020 6f62 6a65 6374 2074 6861  tics` object tha
+0001e940: 7420 7265 7072 6573 656e 7473 2074 6861  t represents tha
+0001e950: 7420 7072 6f6a 6563 7469 6f6e 2e20 4f74  t projection. Ot
+0001e960: 6865 7277 6973 650a 7468 6973 206d 6574  herwise.this met
+0001e970: 686f 6420 7769 6c6c 2072 6574 7572 6e20  hod will return 
+0001e980: 6120 7365 7175 656e 6365 206f 6620 6050  a sequence of `P
+0001e990: 726f 6a65 6374 696f 6e53 7461 7469 7374  rojectionStatist
+0001e9a0: 6963 7360 206f 626a 6563 7473 2e0a 0a54  ics` objects...T
+0001e9b0: 6865 206f 7074 696f 6e61 6c20 6061 6c6c  he optional `all
+0001e9c0: 6020 6172 6775 6d65 6e74 2069 7320 5079  ` argument is Py
+0001e9d0: 7468 6f6e 2060 626f 6f6c 6020 7468 6174  thon `bool` that
+0001e9e0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0001e9f0: 7265 7175 6573 7420 7374 6174 6973 7469  request statisti
+0001ea00: 6373 0a66 6f72 2061 6c6c 2070 726f 6a65  cs.for all proje
+0001ea10: 6374 696f 6e73 2e0a 0a54 6865 206f 7074  ctions...The opt
+0001ea20: 696f 6e61 6c20 6074 7261 6e73 6965 6e74  ional `transient
+0001ea30: 6020 6172 6775 6d65 6e74 2069 7320 5079  ` argument is Py
+0001ea40: 7468 6f6e 2060 626f 6f6c 6020 7468 6174  thon `bool` that
+0001ea50: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0001ea60: 7265 7175 6573 740a 7374 6174 6973 7469  request.statisti
+0001ea70: 6373 2066 6f72 2061 6c6c 2022 7472 616e  cs for all "tran
+0001ea80: 7369 656e 7422 2070 726f 6a65 6374 696f  sient" projectio
+0001ea90: 6e73 2e0a 0a54 6865 206f 7074 696f 6e61  ns...The optiona
+0001eaa0: 6c20 6063 6f6e 7469 6e75 6f75 7360 2061  l `continuous` a
+0001eab0: 7267 756d 656e 7420 6973 2050 7974 686f  rgument is Pytho
+0001eac0: 6e20 6062 6f6f 6c60 2074 6861 7420 6361  n `bool` that ca
+0001ead0: 6e20 6265 2075 7365 6420 746f 2072 6571  n be used to req
+0001eae0: 7565 7374 0a73 7461 7469 7374 6963 7320  uest.statistics 
+0001eaf0: 666f 7220 616c 6c20 2263 6f6e 7469 6e75  for all "continu
+0001eb00: 6f75 7322 2070 726f 6a65 6374 696f 6e73  ous" projections
+0001eb10: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001eb20: 606f 6e65 5f74 696d 6560 2061 7267 756d  `one_time` argum
+0001eb30: 656e 7420 6973 2050 7974 686f 6e20 6062  ent is Python `b
+0001eb40: 6f6f 6c60 2074 6861 7420 6361 6e20 6265  ool` that can be
+0001eb50: 2075 7365 6420 746f 2072 6571 7565 7374   used to request
+0001eb60: 0a73 7461 7469 7374 6963 7320 666f 7220  .statistics for 
+0001eb70: 616c 6c20 226f 6e65 2074 696d 6522 2070  all "one time" p
+0001eb80: 726f 6a65 6374 696f 6e73 2e0a 0a54 6865  rojections...The
+0001eb90: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+0001eba0: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
+0001ebb0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+0001ebc0: 2077 6869 6368 2073 6574 7320 610a 6d61   which sets a.ma
+0001ebd0: 7869 6d75 6d20 6475 7261 7469 6f6e 2c20  ximum duration, 
+0001ebe0: 696e 2073 6563 6f6e 6473 2c20 666f 7220  in seconds, for 
+0001ebf0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+0001ec00: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+0001ec10: 7469 6f6e 2e0a 0a54 6865 206f 7074 696f  tion...The optio
+0001ec20: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
+0001ec30: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
+0001ec40: 6520 7573 6564 2074 6f0a 6f76 6572 7269  e used to.overri
+0001ec50: 6465 2063 616c 6c20 6372 6564 656e 7469  de call credenti
+0001ec60: 616c 7320 6465 7269 7665 6420 6672 6f6d  als derived from
+0001ec70: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+0001ec80: 7374 7269 6e67 2055 5249 2e0a 0a60 6060  string URI...```
+0001ec90: 7079 7468 6f6e 0a73 7461 7469 7374 6963  python.statistic
+0001eca0: 7320 3d20 636c 6965 6e74 2e67 6574 5f70  s = client.get_p
+0001ecb0: 726f 6a65 6374 696f 6e5f 7374 6174 6973  rojection_statis
+0001ecc0: 7469 6373 286e 616d 653d 7072 6f6a 6563  tics(name=projec
+0001ecd0: 7469 6f6e 5f6e 616d 6529 0a60 6060 0a0a  tion_name).```..
+0001ece0: 4120 6050 726f 6a65 6374 696f 6e53 7461  A `ProjectionSta
+0001ecf0: 7469 7374 6963 7360 206f 626a 6563 7420  tistics` object 
+0001ed00: 6973 2072 6574 7572 6e65 642e 2054 6865  is returned. The
+0001ed10: 2061 7474 7269 6275 7465 7320 6f66 2074   attributes of t
+0001ed20: 6869 7320 6f62 6a65 6374 0a68 6176 6520  his object.have 
+0001ed30: 7661 6c75 6573 2074 6861 7420 7265 7072  values that repr
+0001ed40: 6573 656e 7420 7468 6520 7072 6f67 7265  esent the progre
+0001ed50: 7373 206f 6620 7468 6520 7072 6f6a 6563  ss of the projec
+0001ed60: 7469 6f6e 2e0a 0a23 2323 2055 7064 6174  tion...### Updat
+0001ed70: 6520 7072 6f6a 6563 7469 6f6e 3c61 2069  e projection<a i
+0001ed80: 643d 2275 7064 6174 652d 7072 6f6a 6563  d="update-projec
+0001ed90: 7469 6f6e 223e 3c2f 613e 0a0a 5468 6520  tion"></a>..The 
+0001eda0: 6075 7064 6174 655f 7072 6f6a 6563 7469  `update_projecti
+0001edb0: 6f6e 2829 6020 6d65 7468 6f64 2063 616e  on()` method can
+0001edc0: 2062 6520 7573 6564 2074 6f20 7570 6461   be used to upda
+0001edd0: 7465 2061 2070 726f 6a65 6374 696f 6e2e  te a projection.
+0001ede0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+0001edf0: 7320 7477 6f20 7265 7175 6972 6564 2061  s two required a
+0001ee00: 7267 756d 656e 7473 2c20 606e 616d 6560  rguments, `name`
+0001ee10: 2061 6e64 2060 7175 6572 7960 2e0a 0a54   and `query`...T
+0001ee20: 6865 2072 6571 7569 7265 6420 606e 616d  he required `nam
+0001ee30: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+0001ee40: 2050 7974 686f 6e20 6073 7472 6020 7768   Python `str` wh
+0001ee50: 6963 6820 7370 6563 6966 6965 7320 7468  ich specifies th
+0001ee60: 6520 6e61 6d65 206f 6620 7468 6520 7072  e name of the pr
+0001ee70: 6f6a 6563 7469 6f6e 0a74 6f20 6265 2075  ojection.to be u
+0001ee80: 7064 6174 6564 2e0a 0a54 6865 2072 6571  pdated...The req
+0001ee90: 7569 7265 6420 6071 7565 7279 6020 6172  uired `query` ar
+0001eea0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0001eeb0: 6f6e 2060 7374 7260 2077 6869 6368 2064  on `str` which d
+0001eec0: 6566 696e 6573 2077 6861 7420 7468 6520  efines what the 
+0001eed0: 7072 6f6a 6563 7469 6f6e 2077 696c 6c20  projection will 
+0001eee0: 646f 2e0a 0a54 6869 7320 6d65 7468 6f64  do...This method
+0001eef0: 2061 6c73 6f20 6861 7320 7468 7265 6520   also has three 
+0001ef00: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+0001ef10: 7473 2c20 6065 6d69 745f 656e 6162 6c65  ts, `emit_enable
+0001ef20: 6460 2c20 6074 696d 656f 7574 602c 2061  d`, `timeout`, a
+0001ef30: 6e64 2060 6372 6564 656e 7469 616c 7360  nd `credentials`
+0001ef40: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001ef50: 6065 6d69 745f 656e 6162 6c65 6460 2061  `emit_enabled` a
+0001ef60: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0001ef70: 686f 6e20 6062 6f6f 6c60 2077 6869 6368  hon `bool` which
+0001ef80: 2073 7065 6369 6669 6573 2077 6865 7468   specifies wheth
+0001ef90: 6572 2061 0a70 726f 6a65 6374 696f 6e20  er a.projection 
+0001efa0: 7769 6c6c 2062 6520 6162 6c65 2074 6f20  will be able to 
+0001efb0: 656d 6974 2065 7665 6e74 732e 2049 6620  emit events. If 
+0001efc0: 6120 6054 7275 6560 2076 616c 7565 2069  a `True` value i
+0001efd0: 7320 7370 6563 6966 6965 642c 2074 6865  s specified, the
+0001efe0: 2070 726f 6a65 6374 696f 6e0a 7769 6c6c   projection.will
+0001eff0: 2062 6520 6162 6c65 2074 6f20 656d 6974   be able to emit
+0001f000: 2065 7665 6e74 732e 2049 6620 6120 6046   events. If a `F
+0001f010: 616c 7365 6020 7661 6c75 6520 6973 2073  alse` value is s
+0001f020: 7065 6369 6669 6564 2c20 7468 6520 7072  pecified, the pr
+0001f030: 6f6a 6563 7469 6f6e 2077 696c 6c20 6e6f  ojection will no
+0001f040: 740a 6265 2061 626c 6520 746f 2065 6d69  t.be able to emi
+0001f050: 7420 6576 656e 7473 2e20 5468 6520 6465  t events. The de
+0001f060: 6661 756c 7420 7661 6c75 6520 6f66 2060  fault value of `
+0001f070: 656d 6974 5f65 6e61 626c 6564 6020 6973  emit_enabled` is
+0001f080: 2060 4e6f 6e65 602e 0a0a 5468 6520 6f70   `None`...The op
+0001f090: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+0001f0a0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+0001f0b0: 7974 686f 6e20 6066 6c6f 6174 6020 7768  ython `float` wh
+0001f0c0: 6963 6820 7365 7473 2061 0a6d 6178 696d  ich sets a.maxim
+0001f0d0: 756d 2064 7572 6174 696f 6e2c 2069 6e20  um duration, in 
+0001f0e0: 7365 636f 6e64 732c 2066 6f72 2074 6865  seconds, for the
+0001f0f0: 2063 6f6d 706c 6574 696f 6e20 6f66 2074   completion of t
+0001f100: 6865 2067 5250 4320 6f70 6572 6174 696f  he gRPC operatio
+0001f110: 6e2e 0a0a 5468 6520 6f70 7469 6f6e 616c  n...The optional
+0001f120: 2060 6372 6564 656e 7469 616c 7360 2061   `credentials` a
+0001f130: 7267 756d 656e 7420 6361 6e20 6265 2075  rgument can be u
+0001f140: 7365 6420 746f 0a6f 7665 7272 6964 6520  sed to.override 
+0001f150: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
+0001f160: 2064 6572 6976 6564 2066 726f 6d20 7468   derived from th
+0001f170: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+0001f180: 696e 6720 5552 492e 0a0a 6060 6070 7974  ing URI...```pyt
+0001f190: 686f 6e0a 636c 6965 6e74 2e75 7064 6174  hon.client.updat
+0001f1a0: 655f 7072 6f6a 6563 7469 6f6e 286e 616d  e_projection(nam
+0001f1b0: 653d 7072 6f6a 6563 7469 6f6e 5f6e 616d  e=projection_nam
+0001f1c0: 652c 2071 7565 7279 3d70 726f 6a65 6374  e, query=project
+0001f1d0: 696f 6e5f 7175 6572 7929 0a60 6060 0a0a  ion_query).```..
+0001f1e0: 2323 2320 456e 6162 6c65 2070 726f 6a65  ### Enable proje
+0001f1f0: 6374 696f 6e3c 6120 6964 3d22 656e 6162  ction<a id="enab
+0001f200: 6c65 2d70 726f 6a65 6374 696f 6e22 3e3c  le-projection"><
+0001f210: 2f61 3e0a 0a54 6865 2060 656e 6162 6c65  /a>..The `enable
+0001f220: 5f70 726f 6a65 6374 696f 6e28 2960 206d  _projection()` m
+0001f230: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+0001f240: 6420 746f 2065 6e61 626c 6520 6120 7072  d to enable a pr
+0001f250: 6f6a 6563 7469 6f6e 2074 6861 7420 7761  ojection that wa
+0001f260: 7320 7072 6576 696f 7573 6c79 0a64 6973  s previously.dis
+0001f270: 6162 6c65 642e 0a0a 5468 6973 206d 6574  abled...This met
+0001f280: 686f 6420 6861 7320 6120 7265 7175 6972  hod has a requir
+0001f290: 6564 2060 6e61 6d65 6020 6172 6775 6d65  ed `name` argume
+0001f2a0: 6e74 2c20 7768 6963 6820 6973 2061 2050  nt, which is a P
+0001f2b0: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
+0001f2c0: 0a73 7065 6369 6669 6573 2074 6865 206e  .specifies the n
+0001f2d0: 616d 6520 6f66 2074 6865 2070 726f 6a65  ame of the proje
+0001f2e0: 6374 696f 6e20 746f 2062 6520 6469 7361  ction to be disa
+0001f2f0: 626c 6564 2e0a 0a54 6869 7320 6d65 7468  bled...This meth
+0001f300: 6f64 2061 6c73 6f20 6861 7320 7477 6f20  od also has two 
+0001f310: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
+0001f320: 7473 2c20 6074 696d 656f 7574 6020 616e  ts, `timeout` an
+0001f330: 6420 6063 7265 6465 6e74 6961 6c73 602e  d `credentials`.
+0001f340: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0001f350: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+0001f360: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
+0001f370: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
+0001f380: 2061 0a6d 6178 696d 756d 2064 7572 6174   a.maximum durat
+0001f390: 696f 6e2c 2069 6e20 7365 636f 6e64 732c  ion, in seconds,
+0001f3a0: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+0001f3b0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+0001f3c0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+0001f3d0: 6f70 7469 6f6e 616c 2060 6372 6564 656e  optional `creden
+0001f3e0: 7469 616c 7360 2061 7267 756d 656e 7420  tials` argument 
+0001f3f0: 6361 6e20 6265 2075 7365 6420 746f 0a6f  can be used to.o
+0001f400: 7665 7272 6964 6520 6361 6c6c 2063 7265  verride call cre
+0001f410: 6465 6e74 6961 6c73 2064 6572 6976 6564  dentials derived
+0001f420: 2066 726f 6d20 7468 6520 636f 6e6e 6563   from the connec
+0001f430: 7469 6f6e 2073 7472 696e 6720 5552 492e  tion string URI.
+0001f440: 0a0a 6060 6070 7974 686f 6e0a 636c 6965  ..```python.clie
+0001f450: 6e74 2e65 6e61 626c 655f 7072 6f6a 6563  nt.enable_projec
+0001f460: 7469 6f6e 286e 616d 653d 7072 6f6a 6563  tion(name=projec
+0001f470: 7469 6f6e 5f6e 616d 6529 0a60 6060 0a0a  tion_name).```..
+0001f480: 2323 2320 4469 7361 626c 6520 7072 6f6a  ### Disable proj
+0001f490: 6563 7469 6f6e 3c61 2069 643d 2264 6973  ection<a id="dis
+0001f4a0: 6162 6c65 2d70 726f 6a65 6374 696f 6e22  able-projection"
+0001f4b0: 3e3c 2f61 3e0a 0a54 6865 2060 6469 7361  ></a>..The `disa
+0001f4c0: 626c 655f 7072 6f6a 6563 7469 6f6e 2829  ble_projection()
+0001f4d0: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
+0001f4e0: 7573 6564 2074 6f20 6469 7361 626c 6520  used to disable 
+0001f4f0: 6120 7072 6f6a 6563 7469 6f6e 2e0a 0a54  a projection...T
+0001f500: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
+0001f510: 2072 6571 7569 7265 6420 606e 616d 6560   required `name`
+0001f520: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+0001f530: 2069 7320 6120 5079 7468 6f6e 2060 7374   is a Python `st
+0001f540: 7260 2074 6861 740a 7370 6563 6966 6965  r` that.specifie
+0001f550: 7320 7468 6520 6e61 6d65 206f 6620 7468  s the name of th
+0001f560: 6520 7072 6f6a 6563 7469 6f6e 2074 6f20  e projection to 
+0001f570: 6265 2064 6973 6162 6c65 642e 0a0a 5468  be disabled...Th
+0001f580: 6973 206d 6574 686f 6420 616c 736f 2068  is method also h
+0001f590: 6173 2074 6872 6565 206f 7074 696f 6e61  as three optiona
+0001f5a0: 6c20 6172 6775 6d65 6e74 732c 2060 7772  l arguments, `wr
+0001f5b0: 6974 655f 6368 6563 6b70 6f69 6e74 602c  ite_checkpoint`,
+0001f5c0: 2060 7469 6d65 6f75 7460 2c20 616e 6420   `timeout`, and 
+0001f5d0: 6063 7265 6465 6e74 6961 6c73 602e 0a0a  `credentials`...
+0001f5e0: 5468 6520 6f70 7469 6f6e 616c 2060 7772  The optional `wr
+0001f5f0: 6974 655f 6368 6563 6b70 6f69 6e74 6020  ite_checkpoint` 
+0001f600: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+0001f610: 7468 6f6e 2060 626f 6f6c 6020 7768 6963  thon `bool` whic
+0001f620: 6820 7370 6563 6966 6965 7320 7768 6574  h specifies whet
+0001f630: 6865 720a 6120 6368 6563 6b70 6f69 6e74  her.a checkpoint
+0001f640: 2077 696c 6c20 6265 2077 7269 7474 656e   will be written
+0001f650: 2077 6865 6e20 7468 6520 7072 6f6a 6563   when the projec
+0001f660: 7469 6f6e 2069 7320 6469 7361 626c 6564  tion is disabled
+0001f670: 2e20 4966 2060 7772 6974 655f 6368 6563  . If `write_chec
+0001f680: 6b70 6f69 6e74 600a 6973 2060 5472 7565  kpoint`.is `True
+0001f690: 6020 6120 6368 6563 6b70 6f69 6e74 2077  ` a checkpoint w
+0001f6a0: 696c 6c20 6265 2077 7269 7474 656e 2c20  ill be written, 
+0001f6b0: 6f74 6865 7277 6973 6520 6120 6368 6563  otherwise a chec
+0001f6c0: 6b70 6f69 6e74 2077 696c 6c20 6e6f 7420  kpoint will not 
+0001f6d0: 6265 2077 7269 7474 656e 2e0a 5468 6520  be written..The 
+0001f6e0: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
+0001f6f0: 2060 7772 6974 655f 6368 6563 6b70 6f69   `write_checkpoi
+0001f700: 6e74 6020 6973 2060 4661 6c73 6560 2e0a  nt` is `False`..
+0001f710: 0a54 6865 206f 7074 696f 6e61 6c20 6074  .The optional `t
+0001f720: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+0001f730: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+0001f740: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
+0001f750: 610a 6d61 7869 6d75 6d20 6475 7261 7469  a.maximum durati
+0001f760: 6f6e 2c20 696e 2073 6563 6f6e 6473 2c20  on, in seconds, 
+0001f770: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+0001f780: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+0001f790: 7065 7261 7469 6f6e 2e0a 0a54 6865 206f  peration...The o
+0001f7a0: 7074 696f 6e61 6c20 6063 7265 6465 6e74  ptional `credent
+0001f7b0: 6961 6c73 6020 6172 6775 6d65 6e74 2063  ials` argument c
+0001f7c0: 616e 2062 6520 7573 6564 2074 6f0a 6f76  an be used to.ov
+0001f7d0: 6572 7269 6465 2063 616c 6c20 6372 6564  erride call cred
+0001f7e0: 656e 7469 616c 7320 6465 7269 7665 6420  entials derived 
+0001f7f0: 6672 6f6d 2074 6865 2063 6f6e 6e65 6374  from the connect
+0001f800: 696f 6e20 7374 7269 6e67 2055 5249 2e0a  ion string URI..
+0001f810: 0a60 6060 7079 7468 6f6e 0a63 6c69 656e  .```python.clien
+0001f820: 742e 6469 7361 626c 655f 7072 6f6a 6563  t.disable_projec
+0001f830: 7469 6f6e 286e 616d 653d 7072 6f6a 6563  tion(name=projec
+0001f840: 7469 6f6e 5f6e 616d 6529 0a60 6060 0a0a  tion_name).```..
+0001f850: 2323 2320 5265 7365 7420 7072 6f6a 6563  ### Reset projec
+0001f860: 7469 6f6e 3c61 2069 643d 2272 6573 6574  tion<a id="reset
+0001f870: 2d70 726f 6a65 6374 696f 6e22 3e3c 2f61  -projection"></a
+0001f880: 3e0a 0a54 6865 2060 7265 7365 745f 7072  >..The `reset_pr
+0001f890: 6f6a 6563 7469 6f6e 2829 6020 6d65 7468  ojection()` meth
+0001f8a0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+0001f8b0: 6f20 7265 7365 7420 6120 7072 6f6a 6563  o reset a projec
+0001f8c0: 7469 6f6e 2e0a 0a54 6869 7320 6d65 7468  tion...This meth
+0001f8d0: 6f64 2068 6173 2061 2072 6571 7569 7265  od has a require
+0001f8e0: 6420 606e 616d 6560 2061 7267 756d 656e  d `name` argumen
+0001f8f0: 742c 2077 6869 6368 2069 7320 6120 5079  t, which is a Py
+0001f900: 7468 6f6e 2060 7374 7260 2074 6861 740a  thon `str` that.
+0001f910: 7370 6563 6966 6965 7320 7468 6520 6e61  specifies the na
+0001f920: 6d65 206f 6620 7468 6520 7072 6f6a 6563  me of the projec
+0001f930: 7469 6f6e 2074 6f20 6265 2072 6573 6574  tion to be reset
+0001f940: 2e0a 0a54 6869 7320 6d65 7468 6f64 2061  ...This method a
+0001f950: 6c73 6f20 6861 7320 7468 7265 6520 6f70  lso has three op
+0001f960: 7469 6f6e 616c 2061 7267 756d 656e 7473  tional arguments
+0001f970: 2c20 6077 7269 7465 5f63 6865 636b 706f  , `write_checkpo
+0001f980: 696e 7460 2c20 6074 696d 656f 7574 602c  int`, `timeout`,
+0001f990: 2061 6e64 2060 6372 6564 656e 7469 616c   and `credential
+0001f9a0: 7360 2e0a 0a54 6865 206f 7074 696f 6e61  s`...The optiona
+0001f9b0: 6c20 6077 7269 7465 5f63 6865 636b 706f  l `write_checkpo
+0001f9c0: 696e 7460 2061 7267 756d 656e 7420 6973  int` argument is
+0001f9d0: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+0001f9e0: 2077 6869 6368 2073 7065 6369 6669 6573   which specifies
+0001f9f0: 2077 6865 7468 6572 0a61 2063 6865 636b   whether.a check
+0001fa00: 706f 696e 7420 7769 6c6c 2062 6520 7772  point will be wr
+0001fa10: 6974 7465 6e20 7768 656e 2074 6865 2070  itten when the p
+0001fa20: 726f 6a65 6374 696f 6e20 6973 2072 6573  rojection is res
+0001fa30: 6574 2e20 4966 2060 7772 6974 655f 6368  et. If `write_ch
+0001fa40: 6563 6b70 6f69 6e74 600a 6973 2060 5472  eckpoint`.is `Tr
+0001fa50: 7565 6020 6120 6368 6563 6b70 6f69 6e74  ue` a checkpoint
+0001fa60: 2077 696c 6c20 6265 2077 7269 7474 656e   will be written
+0001fa70: 2c20 6f74 6865 7277 6973 6520 6120 6368  , otherwise a ch
+0001fa80: 6563 6b70 6f69 6e74 2077 696c 6c20 6e6f  eckpoint will no
+0001fa90: 7420 6265 2077 7269 7474 656e 2e0a 5468  t be written..Th
+0001faa0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+0001fab0: 6f66 2060 7772 6974 655f 6368 6563 6b70  of `write_checkp
+0001fac0: 6f69 6e74 6020 6973 2060 4661 6c73 6560  oint` is `False`
+0001fad0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001fae0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
+0001faf0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+0001fb00: 666c 6f61 7460 2077 6869 6368 2073 6574  float` which set
+0001fb10: 7320 610a 6d61 7869 6d75 6d20 6475 7261  s a.maximum dura
+0001fb20: 7469 6f6e 2c20 696e 2073 6563 6f6e 6473  tion, in seconds
+0001fb30: 2c20 666f 7220 7468 6520 636f 6d70 6c65  , for the comple
+0001fb40: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
+0001fb50: 206f 7065 7261 7469 6f6e 2e0a 0a54 6865   operation...The
+0001fb60: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
+0001fb70: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
+0001fb80: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
+0001fb90: 6f76 6572 7269 6465 2063 616c 6c20 6372  override call cr
+0001fba0: 6564 656e 7469 616c 7320 6465 7269 7665  edentials derive
+0001fbb0: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
+0001fbc0: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+0001fbd0: 2e0a 0a60 6060 7079 7468 6f6e 0a63 6c69  ...```python.cli
+0001fbe0: 656e 742e 7265 7365 745f 7072 6f6a 6563  ent.reset_projec
+0001fbf0: 7469 6f6e 286e 616d 653d 7072 6f6a 6563  tion(name=projec
+0001fc00: 7469 6f6e 5f6e 616d 6529 0a60 6060 0a0a  tion_name).```..
+0001fc10: 2323 2320 4465 6c65 7465 2070 726f 6a65  ### Delete proje
+0001fc20: 6374 696f 6e3c 6120 6964 3d22 6465 6c65  ction<a id="dele
+0001fc30: 7465 2d70 726f 6a65 6374 696f 6e22 3e3c  te-projection"><
+0001fc40: 2f61 3e0a 0a54 6865 2060 6465 6c65 7465  /a>..The `delete
+0001fc50: 5f70 726f 6a65 6374 696f 6e28 2960 206d  _projection()` m
+0001fc60: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+0001fc70: 6420 746f 2064 656c 6574 6520 6120 7072  d to delete a pr
+0001fc80: 6f6a 6563 7469 6f6e 2e0a 0a54 6869 7320  ojection...This 
+0001fc90: 6d65 7468 6f64 2068 6173 2061 2072 6571  method has a req
+0001fca0: 7569 7265 6420 606e 616d 6560 2061 7267  uired `name` arg
+0001fcb0: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
+0001fcc0: 6120 5079 7468 6f6e 2060 7374 7260 2074  a Python `str` t
+0001fcd0: 6861 740a 7370 6563 6966 6965 7320 7468  hat.specifies th
+0001fce0: 6520 6e61 6d65 206f 6620 7468 6520 7072  e name of the pr
+0001fcf0: 6f6a 6563 7469 6f6e 2074 6f20 6265 2064  ojection to be d
+0001fd00: 656c 6574 6564 2e0a 0a54 6869 7320 6d65  eleted...This me
+0001fd10: 7468 6f64 2061 6c73 6f20 6861 7320 6669  thod also has fi
+0001fd20: 7665 206f 7074 696f 6e61 6c20 6172 6775  ve optional argu
+0001fd30: 6d65 6e74 732c 2060 6465 6c65 7465 5f65  ments, `delete_e
+0001fd40: 6d69 7474 6564 5f73 7472 6561 6d73 602c  mitted_streams`,
+0001fd50: 0a60 6465 6c65 7465 5f73 7461 7465 5f73  .`delete_state_s
+0001fd60: 7472 6561 6d60 2c20 6064 656c 6574 655f  tream`, `delete_
+0001fd70: 6368 6563 6b70 6f69 6e74 5f73 7472 6561  checkpoint_strea
+0001fd80: 6d60 2c20 6074 696d 656f 7574 602c 2061  m`, `timeout`, a
+0001fd90: 6e64 2060 6372 6564 656e 7469 616c 7360  nd `credentials`
+0001fda0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001fdb0: 6064 656c 6574 655f 656d 6974 7465 645f  `delete_emitted_
+0001fdc0: 7374 7265 616d 7360 2061 7267 756d 656e  streams` argumen
+0001fdd0: 7420 6973 2061 2050 7974 686f 6e20 6062  t is a Python `b
+0001fde0: 6f6f 6c60 2077 6869 6368 2e2e 2e0a 0a54  ool` which.....T
+0001fdf0: 6865 206f 7074 696f 6e61 6c20 6064 656c  he optional `del
+0001fe00: 6574 655f 7374 6174 655f 7374 7265 616d  ete_state_stream
+0001fe10: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+0001fe20: 5079 7468 6f6e 2060 626f 6f6c 6020 7768  Python `bool` wh
+0001fe30: 6963 682e 2e2e 0a0a 5468 6520 6f70 7469  ich.....The opti
+0001fe40: 6f6e 616c 2060 6465 6c65 7465 5f63 6865  onal `delete_che
+0001fe50: 636b 706f 696e 745f 7374 7265 616d 6020  ckpoint_stream` 
+0001fe60: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+0001fe70: 7468 6f6e 2060 626f 6f6c 6020 7768 6963  thon `bool` whic
+0001fe80: 682e 2e2e 0a0a 5468 6520 6f70 7469 6f6e  h.....The option
+0001fe90: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+0001fea0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0001feb0: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
+0001fec0: 7365 7473 2061 0a6d 6178 696d 756d 2064  sets a.maximum d
+0001fed0: 7572 6174 696f 6e2c 2069 6e20 7365 636f  uration, in seco
+0001fee0: 6e64 732c 2066 6f72 2074 6865 2063 6f6d  nds, for the com
+0001fef0: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+0001ff00: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+0001ff10: 5468 6520 6f70 7469 6f6e 616c 2060 6372  The optional `cr
+0001ff20: 6564 656e 7469 616c 7360 2061 7267 756d  edentials` argum
+0001ff30: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
+0001ff40: 746f 0a6f 7665 7272 6964 6520 6361 6c6c  to.override call
+0001ff50: 2063 7265 6465 6e74 6961 6c73 2064 6572   credentials der
+0001ff60: 6976 6564 2066 726f 6d20 7468 6520 636f  ived from the co
+0001ff70: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+0001ff80: 5552 492e 0a0a 6060 6070 7974 686f 6e0a  URI...```python.
+0001ff90: 636c 6965 6e74 2e64 656c 6574 655f 7072  client.delete_pr
+0001ffa0: 6f6a 6563 7469 6f6e 286e 616d 653d 7072  ojection(name=pr
+0001ffb0: 6f6a 6563 7469 6f6e 5f6e 616d 6529 0a60  ojection_name).`
+0001ffc0: 6060 0a0a 2323 2320 5265 7374 6172 7420  ``..### Restart 
+0001ffd0: 7072 6f6a 6563 7469 6f6e 7320 7375 6273  projections subs
+0001ffe0: 7973 7465 6d3c 6120 6964 3d22 7265 7374  ystem<a id="rest
+0001fff0: 6172 742d 7072 6f6a 6563 7469 6f6e 732d  art-projections-
+00020000: 7375 6273 7973 7465 6d22 3e3c 2f61 3e0a  subsystem"></a>.
+00020010: 0a54 6865 2060 7265 7374 6172 745f 7072  .The `restart_pr
+00020020: 6f6a 6563 7469 6f6e 735f 7375 6273 7973  ojections_subsys
+00020030: 7465 6d28 2960 206d 6574 686f 6420 6361  tem()` method ca
+00020040: 6e20 6265 2075 7365 6420 746f 2072 6573  n be used to res
+00020050: 7461 7274 2074 6865 2070 726f 6a65 6374  tart the project
+00020060: 696f 6e73 2073 7562 7379 7374 656d 2e0a  ions subsystem..
+00020070: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
+00020080: 6f20 6861 7320 7477 6f20 6f70 7469 6f6e  o has two option
+00020090: 616c 2061 7267 756d 656e 7473 2c20 6074  al arguments, `t
+000200a0: 696d 656f 7574 6020 616e 6420 6063 7265  imeout` and `cre
+000200b0: 6465 6e74 6961 6c73 602e 0a0a 5468 6520  dentials`...The 
+000200c0: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
+000200d0: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
+000200e0: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
+000200f0: 7768 6963 6820 7365 7473 2061 0a6d 6178  which sets a.max
+00020100: 696d 756d 2064 7572 6174 696f 6e2c 2069  imum duration, i
+00020110: 6e20 7365 636f 6e64 732c 2066 6f72 2074  n seconds, for t
+00020120: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+00020130: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+00020140: 696f 6e2e 0a0a 5468 6520 6f70 7469 6f6e  ion...The option
+00020150: 616c 2060 6372 6564 656e 7469 616c 7360  al `credentials`
+00020160: 2061 7267 756d 656e 7420 6361 6e20 6265   argument can be
+00020170: 2075 7365 6420 746f 0a6f 7665 7272 6964   used to.overrid
+00020180: 6520 6361 6c6c 2063 7265 6465 6e74 6961  e call credentia
+00020190: 6c73 2064 6572 6976 6564 2066 726f 6d20  ls derived from 
+000201a0: 7468 6520 636f 6e6e 6563 7469 6f6e 2073  the connection s
+000201b0: 7472 696e 6720 5552 492e 0a0a 6060 6070  tring URI...```p
+000201c0: 7974 686f 6e0a 636c 6965 6e74 2e72 6573  ython.client.res
+000201d0: 7461 7274 5f70 726f 6a65 6374 696f 6e73  tart_projections
+000201e0: 5f73 7562 7379 7374 656d 2829 0a60 6060  _subsystem().```
+000201f0: 0a0a 0a23 2320 4361 6c6c 2063 7265 6465  ...## Call crede
+00020200: 6e74 6961 6c73 3c61 2069 643d 2263 616c  ntials<a id="cal
+00020210: 6c2d 6372 6564 656e 7469 616c 7322 3e3c  l-credentials"><
+00020220: 2f61 3e0a 0a44 6566 6175 6c74 2063 616c  /a>..Default cal
+00020230: 6c20 6372 6564 656e 7469 616c 7320 6172  l credentials ar
+00020240: 6520 6465 7269 7665 6420 6279 2074 6865  e derived by the
+00020250: 2063 6c69 656e 7420 6672 6f6d 2074 6865   client from the
+00020260: 2075 7365 7220 696e 666f 2070 6172 7420   user info part 
+00020270: 6f66 2074 6865 0a63 6f6e 6e65 6374 696f  of the.connectio
+00020280: 6e20 7374 7269 6e67 2055 5249 2e0a 0a4d  n string URI...M
+00020290: 616e 7920 6f66 2074 6865 2063 6c69 656e  any of the clien
+000202a0: 7420 6d65 7468 6f64 7320 6465 7363 7269  t methods descri
+000202b0: 6265 6420 6162 6f76 6520 6861 7665 2061  bed above have a
+000202c0: 6e20 6f70 7469 6f6e 616c 2060 6372 6564  n optional `cred
+000202d0: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
+000202e0: 742c 0a77 6869 6368 2063 616e 2062 6520  t,.which can be 
+000202f0: 7573 6564 2074 6f20 7365 7420 6361 6c6c  used to set call
+00020300: 2063 7265 6465 6e74 6961 6c73 2066 6f72   credentials for
+00020310: 2061 6e20 696e 6469 7669 6475 616c 206d   an individual m
+00020320: 6574 686f 6420 6361 6c6c 2074 6861 7420  ethod call that 
+00020330: 6f76 6572 7269 6465 0a74 686f 7365 2064  override.those d
+00020340: 6572 6976 6564 2066 726f 6d20 7468 6520  erived from the 
+00020350: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00020360: 6720 5552 492e 0a0a 2323 2320 436f 6e73  g URI...### Cons
+00020370: 7472 7563 7420 6361 6c6c 2063 7265 6465  truct call crede
+00020380: 6e74 6961 6c73 3c61 2069 643d 2263 6f6e  ntials<a id="con
+00020390: 7374 7275 6374 2d63 616c 6c2d 6372 6564  struct-call-cred
+000203a0: 656e 7469 616c 7322 3e3c 2f61 3e0a 0a54  entials"></a>..T
+000203b0: 6865 2063 6c69 656e 7420 6d65 7468 6f64  he client method
+000203c0: 2060 636f 6e73 7472 7563 745f 6361 6c6c   `construct_call
+000203d0: 5f63 7265 6465 6e74 6961 6c73 2829 6020  _credentials()` 
+000203e0: 6361 6e20 6265 2075 7365 6420 746f 2063  can be used to c
+000203f0: 6f6e 7374 7275 6374 2061 2063 616c 6c0a  onstruct a call.
+00020400: 6372 6564 656e 7469 616c 7320 6f62 6a65  credentials obje
+00020410: 6374 2066 726f 6d20 6120 7573 6572 6e61  ct from a userna
+00020420: 6d65 2061 6e64 2070 6173 7377 6f72 642e  me and password.
+00020430: 0a0a 6060 6070 7974 686f 6e0a 6361 6c6c  ..```python.call
+00020440: 5f63 7265 6465 6e74 6961 6c73 203d 2063  _credentials = c
+00020450: 6c69 656e 742e 636f 6e73 7472 7563 745f  lient.construct_
+00020460: 6361 6c6c 5f63 7265 6465 6e74 6961 6c73  call_credentials
+00020470: 280a 2020 2020 7573 6572 6e61 6d65 3d27  (.    username='
+00020480: 6164 6d69 6e27 2c20 7061 7373 776f 7264  admin', password
+00020490: 3d27 6368 616e 6765 6974 270a 290a 6060  ='changeit'.).``
+000204a0: 600a 0a54 6865 2063 616c 6c20 6372 6564  `..The call cred
+000204b0: 656e 7469 616c 7320 6f62 6a65 6374 2063  entials object c
+000204c0: 616e 2062 6520 7573 6564 2061 7320 7468  an be used as th
+000204d0: 6520 7661 6c75 6520 6f66 2074 6865 2060  e value of the `
+000204e0: 6372 6564 656e 7469 616c 7360 0a61 7267  credentials`.arg
+000204f0: 756d 656e 7420 696e 206f 7468 6572 2063  ument in other c
+00020500: 6c69 656e 7420 6d65 7468 6f64 732e 0a0a  lient methods...
+00020510: 2323 2043 6f6e 6e65 6374 696f 6e3c 6120  ## Connection<a 
+00020520: 6964 3d22 636f 6e6e 6563 7469 6f6e 223e  id="connection">
+00020530: 3c2f 613e 0a0a 2323 2320 5265 636f 6e6e  </a>..### Reconn
+00020540: 6563 743c 6120 6964 3d22 7265 636f 6e6e  ect<a id="reconn
+00020550: 6563 7422 3e3c 2f61 3e0a 0a54 6865 2060  ect"></a>..The `
+00020560: 7265 636f 6e6e 6563 7428 2960 206d 6574  reconnect()` met
+00020570: 686f 6420 6361 6e20 6265 2075 7365 6420  hod can be used 
+00020580: 746f 206d 616e 7561 6c6c 7920 7265 636f  to manually reco
+00020590: 6e6e 6563 7420 7468 6520 636c 6965 6e74  nnect the client
+000205a0: 2074 6f20 610a 7375 6974 6162 6c65 2045   to a.suitable E
+000205b0: 7665 6e74 5374 6f72 6544 4220 6e6f 6465  ventStoreDB node
+000205c0: 2e20 5468 6973 206d 6574 686f 6420 7573  . This method us
+000205d0: 6573 2074 6865 2073 616d 6520 726f 7574  es the same rout
+000205e0: 696e 6520 666f 7220 7265 6164 696e 6720  ine for reading 
+000205f0: 7468 650a 636c 7573 7465 7220 6e6f 6465  the.cluster node
+00020600: 2073 7461 7465 7320 616e 6420 7468 656e   states and then
+00020610: 2063 6f6e 6e65 6374 696e 6720 746f 2061   connecting to a
+00020620: 2073 7569 7461 626c 6520 6e6f 6465 2061   suitable node a
+00020630: 6363 6f72 6469 6e67 2074 6f20 7468 650a  ccording to the.
+00020640: 636c 6965 6e74 2773 206e 6f64 6520 7072  client's node pr
+00020650: 6566 6572 656e 6365 2074 6861 7420 6973  eference that is
+00020660: 2073 7065 6369 6669 6564 2069 6e20 7468   specified in th
+00020670: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+00020680: 696e 6720 5552 4920 7768 656e 0a74 6865  ing URI when.the
+00020690: 2063 6c69 656e 7420 6973 2063 6f6e 7374   client is const
+000206a0: 7275 6374 6564 2e20 5468 6973 206d 6574  ructed. This met
+000206b0: 686f 6420 6973 2074 6872 6561 642d 7361  hod is thread-sa
+000206c0: 6665 2c20 696e 2074 6861 7420 7768 656e  fe, in that when
+000206d0: 2069 7420 6973 2063 616c 6c65 640a 6279   it is called.by
+000206e0: 2073 6576 6572 616c 2074 6872 6561 6473   several threads
+000206f0: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
+00020700: 652c 206f 6e6c 7920 6f6e 6520 7265 636f  e, only one reco
+00020710: 6e6e 6563 7469 6f6e 2077 696c 6c20 6f63  nnection will oc
+00020720: 6375 722e 2043 6f6e 6375 7272 656e 740a  cur. Concurrent.
+00020730: 6174 7465 6d70 7473 2074 6f20 7265 636f  attempts to reco
+00020740: 6e6e 6563 7420 7769 6c6c 2062 6c6f 636b  nnect will block
+00020750: 2075 6e74 696c 2074 6865 2063 6c69 656e   until the clien
+00020760: 7420 6861 7320 7265 636f 6e6e 6563 7465  t has reconnecte
+00020770: 6420 7375 6363 6573 7366 756c 6c79 2c0a  d successfully,.
+00020780: 616e 6420 7468 656e 2074 6865 7920 7769  and then they wi
+00020790: 6c6c 2061 6c6c 2072 6574 7572 6e20 6e6f  ll all return no
+000207a0: 726d 616c 6c79 2e0a 0a60 6060 7079 7468  rmally...```pyth
+000207b0: 6f6e 0a63 6c69 656e 742e 7265 636f 6e6e  on.client.reconn
+000207c0: 6563 7428 290a 6060 600a 0a41 6e20 6578  ect().```..An ex
+000207d0: 616d 706c 6520 6f66 2077 6865 6e20 6974  ample of when it
+000207e0: 206d 6967 6874 2062 6520 6465 7369 7261   might be desira
+000207f0: 626c 6520 746f 2072 6563 6f6e 6e65 6374  ble to reconnect
+00020800: 206d 616e 7561 6c6c 7920 6973 2077 6865   manually is whe
+00020810: 6e20 2866 6f72 2070 6572 666f 726d 616e  n (for performan
+00020820: 6365 0a72 6561 736f 6e73 2920 7468 6520  ce.reasons) the 
+00020830: 636c 6965 6e74 2773 206e 6f64 6520 7072  client's node pr
+00020840: 6566 6572 656e 6365 2069 7320 746f 2062  eference is to b
+00020850: 6520 636f 6e6e 6563 7465 6420 746f 2061  e connected to a
+00020860: 2066 6f6c 6c6f 7765 7220 6e6f 6465 2069   follower node i
+00020870: 6e20 7468 650a 636c 7573 7465 722c 2061  n the.cluster, a
+00020880: 6e64 2c20 6166 7465 7220 6120 636c 7573  nd, after a clus
+00020890: 7465 7220 6c65 6164 6572 2065 6c65 6374  ter leader elect
+000208a0: 696f 6e2c 2074 6865 2066 6f6c 6c6f 7765  ion, the followe
+000208b0: 7220 6265 636f 6d65 7320 7468 6520 6c65  r becomes the le
+000208c0: 6164 6572 2e0a 5265 636f 6e6e 6563 7469  ader..Reconnecti
+000208d0: 6e67 2074 6f20 6120 666f 6c6c 6f77 6572  ng to a follower
+000208e0: 206e 6f64 6520 696e 2074 6869 7320 6361   node in this ca
+000208f0: 7365 2069 7320 6375 7272 656e 746c 7920  se is currently 
+00020900: 6265 796f 6e64 2074 6865 2063 6170 6162  beyond the capab
+00020910: 696c 6974 6965 7320 6f66 0a74 6869 7320  ilities of.this 
+00020920: 636c 6965 6e74 2c20 6275 7420 7468 6973  client, but this
+00020930: 2062 6568 6176 696f 7220 6d69 6768 7420   behavior might 
+00020940: 6265 2069 6d70 6c65 6d65 6e74 6564 2069  be implemented i
+00020950: 6e20 6120 6675 7475 7265 2072 656c 6561  n a future relea
+00020960: 7365 2e0a 0a52 6563 6f6e 6e65 6374 696f  se...Reconnectio
+00020970: 6e20 7769 6c6c 2068 6170 7065 6e20 6175  n will happen au
+00020980: 746f 6d61 7469 6361 6c6c 7920 696e 206d  tomatically in m
+00020990: 616e 7920 6361 7365 732c 2064 7565 2074  any cases, due t
+000209a0: 6f20 7468 6520 6040 6175 746f 7265 636f  o the `@autoreco
+000209b0: 6e6e 6563 7460 0a64 6563 6f72 6174 6f72  nnect`.decorator
+000209c0: 2e0a 0a23 2323 2043 6c6f 7365 3c61 2069  ...### Close<a i
+000209d0: 643d 2263 6c6f 7365 223e 3c2f 613e 0a0a  d="close"></a>..
+000209e0: 5468 6520 6063 6c6f 7365 2829 6020 6d65  The `close()` me
+000209f0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+00020a00: 2074 6f20 636c 6561 6e6c 7920 636c 6f73   to cleanly clos
+00020a10: 6520 7468 6520 636c 6965 6e74 2773 2067  e the client's g
+00020a20: 5250 4320 636f 6e6e 6563 7469 6f6e 2e0a  RPC connection..
+00020a30: 0a60 6060 7079 7468 6f6e 0a63 6c69 656e  .```python.clien
+00020a40: 742e 636c 6f73 6528 290a 6060 600a 0a0a  t.close().```...
+00020a50: 2323 2041 7379 6e63 696f 2063 6c69 656e  ## Asyncio clien
+00020a60: 743c 6120 6964 3d22 6173 796e 6369 6f2d  t<a id="asyncio-
+00020a70: 636c 6965 6e74 223e 3c2f 613e 0a0a 5468  client"></a>..Th
+00020a80: 6520 6065 7364 6263 6c69 656e 7460 2070  e `esdbclient` p
+00020a90: 6163 6b61 6765 2061 6c73 6f20 7072 6f76  ackage also prov
+00020aa0: 6964 6573 2061 6e20 6173 796e 6368 726f  ides an asynchro
+00020ab0: 6e6f 7573 2049 2f4f 2067 5250 4320 5079  nous I/O gRPC Py
+00020ac0: 7468 6f6e 2063 6c69 656e 7420 666f 720a  thon client for.
+00020ad0: 4576 656e 7453 746f 7265 4442 2e20 4974  EventStoreDB. It
+00020ae0: 2069 7320 6675 6e63 7469 6f6e 616c 6c79   is functionally
+00020af0: 2065 7175 6976 616c 656e 7420 746f 2074   equivalent to t
+00020b00: 6865 206d 756c 7469 7468 7265 6164 6564  he multithreaded
+00020b10: 2063 6c69 656e 742e 2049 7420 7573 6573   client. It uses
+00020b20: 0a74 6865 2060 6772 7063 2e61 696f 6020  .the `grpc.aio` 
+00020b30: 7061 636b 6167 6520 616e 6420 7468 6520  package and the 
+00020b40: 6061 7379 6e63 696f 6020 6d6f 6475 6c65  `asyncio` module
+00020b50: 2c20 696e 7374 6561 6420 6f66 2060 6772  , instead of `gr
+00020b60: 7063 6020 616e 6420 6074 6872 6561 6469  pc` and `threadi
+00020b70: 6e67 602e 0a0a 4974 2073 7570 706f 7274  ng`...It support
+00020b80: 7320 626f 7468 2074 6865 2022 6573 6462  s both the "esdb
+00020b90: 2220 616e 6420 7468 6520 2265 7364 622b  " and the "esdb+
+00020ba0: 6469 7363 6f76 6572 2220 636f 6e6e 6563  discover" connec
+00020bb0: 7469 6f6e 2073 7472 696e 6720 5552 4920  tion string URI 
+00020bc0: 7363 6865 6d65 732c 0a61 6e64 2063 616e  schemes,.and can
+00020bd0: 2063 6f6e 6e65 6374 2074 6f20 626f 7468   connect to both
+00020be0: 2022 7365 6375 7265 2220 616e 6420 2269   "secure" and "i
+00020bf0: 6e73 6563 7572 6522 2045 7665 6e74 5374  nsecure" EventSt
+00020c00: 6f72 6544 4220 7365 7276 6572 732e 0a0a  oreDB servers...
+00020c10: 5468 6520 6173 796e 6320 6675 6e63 7469  The async functi
+00020c20: 6f6e 2060 4173 796e 6369 6f45 7665 6e74  on `AsyncioEvent
+00020c30: 5374 6f72 6544 4243 6c69 656e 7460 2063  StoreDBClient` c
+00020c40: 6f6e 7374 7275 6374 7320 7468 6520 636c  onstructs the cl
+00020c50: 6965 6e74 2061 6e64 2063 6f6e 6e65 6374  ient and connect
+00020c60: 7320 746f 0a45 7665 6e74 5374 6f72 6544  s to.EventStoreD
+00020c70: 422e 2049 7420 6361 6e20 6265 2069 6d70  B. It can be imp
+00020c80: 6f72 7465 6420 6672 6f6d 2060 6573 6462  orted from `esdb
+00020c90: 636c 6965 6e74 602e 0a0a 5468 6520 6173  client`...The as
+00020ca0: 796e 6369 6f20 636c 6965 6e74 2068 6173  yncio client has
+00020cb0: 2065 7861 6374 6c79 2074 6865 2073 616d   exactly the sam
+00020cc0: 6520 6d65 7468 6f64 7320 6173 2074 6865  e methods as the
+00020cd0: 206d 756c 7469 7468 7265 6164 6564 2060   multithreaded `
+00020ce0: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
+00020cf0: 6e74 602e 0a54 6865 7365 206d 6574 686f  nt`..These metho
+00020d00: 6473 2061 7265 2064 6566 696e 6564 2061  ds are defined a
+00020d10: 7320 6061 7379 6e63 2064 6566 6020 6d65  s `async def` me
+00020d20: 7468 6f64 732c 2061 6e64 2073 6f20 6361  thods, and so ca
+00020d30: 6c6c 7320 746f 2074 6865 7365 206d 6574  lls to these met
+00020d40: 686f 6473 2077 696c 6c0a 7265 7475 726e  hods will.return
+00020d50: 2050 7974 686f 6e20 2261 7761 6974 6162   Python "awaitab
+00020d60: 6c65 7322 2074 6861 7420 6d75 7374 2062  les" that must b
+00020d70: 6520 6177 6169 7465 6420 746f 206f 6274  e awaited to obt
+00020d80: 6169 6e20 7468 6520 6d65 7468 6f64 2072  ain the method r
+00020d90: 6574 7572 6e20 7661 6c75 6573 2e0a 5468  eturn values..Th
+00020da0: 6520 6d65 7468 6f64 7320 6861 7665 2074  e methods have t
+00020db0: 6865 2073 616d 6520 6265 6861 7669 6f72  he same behavior
+00020dc0: 732c 2074 6865 2073 616d 6520 6172 6775  s, the same argu
+00020dd0: 6d65 6e74 7320 616e 6420 7468 6520 7361  ments and the sa
+00020de0: 6d65 206f 7220 6571 7569 7661 6c65 6e74  me or equivalent
+00020df0: 0a72 6574 7572 6e20 7661 6c75 6573 2e20  .return values. 
+00020e00: 5468 6520 6d65 7468 6f64 7320 6172 6520  The methods are 
+00020e10: 7369 6d69 6c61 726c 7920 6465 636f 7261  similarly decora
+00020e20: 7465 6420 7769 7468 2072 6563 6f6e 6e65  ted with reconne
+00020e30: 6374 2061 6e64 2072 6574 7279 2064 6563  ct and retry dec
+00020e40: 6f72 6174 6f72 732c 0a74 6861 7420 7365  orators,.that se
+00020e50: 6c65 6374 6976 656c 7920 7265 636f 6e6e  lectively reconn
+00020e60: 6563 7420 616e 6420 7265 7472 7920 7768  ect and retry wh
+00020e70: 656e 2063 6f6e 6e65 6374 696f 6e20 6973  en connection is
+00020e80: 7375 6573 206f 7220 7365 7276 6572 2065  sues or server e
+00020e90: 7272 6f72 7320 6172 650a 656e 636f 756e  rrors are.encoun
+00020ea0: 7465 7265 642e 0a0a 5768 656e 2061 7761  tered...When awa
+00020eb0: 6974 6564 2c20 7468 6520 6d65 7468 6f64  ited, the method
+00020ec0: 7320 6072 6561 645f 616c 6c28 2960 2061  s `read_all()` a
+00020ed0: 6e64 2060 7265 6164 5f73 7472 6561 6d28  nd `read_stream(
+00020ee0: 2960 2072 6574 7572 6e20 616e 2060 4173  )` return an `As
+00020ef0: 796e 6369 6f52 6561 6452 6573 706f 6e73  yncioReadRespons
+00020f00: 6560 0a6f 626a 6563 742e 2054 6865 206d  e`.object. The m
+00020f10: 6574 686f 6473 2060 7375 6273 6372 6962  ethods `subscrib
+00020f20: 655f 746f 5f61 6c6c 2829 6020 616e 6420  e_to_all()` and 
+00020f30: 6073 7562 7363 7269 6265 5f74 6f5f 7374  `subscribe_to_st
+00020f40: 7265 616d 2829 6020 7265 7475 726e 2061  ream()` return a
+00020f50: 6e0a 6041 7379 6e63 696f 4361 7463 6875  n.`AsyncioCatchu
+00020f60: 7053 7562 7363 7269 7074 696f 6e60 206f  pSubscription` o
+00020f70: 626a 6563 742e 2054 6865 206d 6574 686f  bject. The metho
+00020f80: 6473 2060 7265 6164 5f73 7562 7363 7269  ds `read_subscri
+00020f90: 7074 696f 6e5f 746f 5f61 6c6c 2829 6020  ption_to_all()` 
+00020fa0: 616e 640a 6072 6561 645f 7375 6273 6372  and.`read_subscr
+00020fb0: 6970 7469 6f6e 5f74 6f5f 7374 7265 616d  iption_to_stream
+00020fc0: 2829 6020 7265 7475 726e 2061 6e20 6041  ()` return an `A
+00020fd0: 7379 6e63 696f 5065 7273 6973 7465 6e74  syncioPersistent
+00020fe0: 5375 6273 6372 6970 7469 6f6e 6020 6f62  Subscription` ob
+00020ff0: 6a65 6374 2e0a 5468 6573 6520 6f62 6a65  ject..These obje
+00021000: 6374 7320 6172 6520 6173 796e 6369 6f20  cts are asyncio 
+00021010: 6974 6572 6162 6c65 732c 2077 6869 6368  iterables, which
+00021020: 2079 6f75 2063 616e 2069 7465 7261 7465   you can iterate
+00021030: 206f 7665 7220 7769 7468 2050 7974 686f   over with Pytho
+00021040: 6e27 7320 6061 7379 6e63 2066 6f72 600a  n's `async for`.
+00021050: 7379 6e74 6178 2074 6f20 6f62 7461 696e  syntax to obtain
+00021060: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+00021070: 206f 626a 6563 7473 2e20 5468 6579 2061   objects. They a
+00021080: 7265 2061 6c73 6f20 6173 796e 6369 6f20  re also asyncio 
+00021090: 636f 6e74 6578 7420 6d61 6e61 6765 7273  context managers
+000210a0: 2c0a 7375 7070 6f72 7469 6e67 2074 6865  ,.supporting the
+000210b0: 2060 6173 796e 6320 7769 7468 6020 7379   `async with` sy
+000210c0: 6e74 6178 2e20 5468 6579 2061 6c73 6f20  ntax. They also 
+000210d0: 6861 7665 2061 2060 7374 6f70 2829 6020  have a `stop()` 
+000210e0: 6d65 7468 6f64 2077 6869 6368 2063 616e  method which can
+000210f0: 2062 650a 7573 6564 2074 6f20 7465 726d   be.used to term
+00021100: 696e 6174 6520 7468 6520 6974 6572 6174  inate the iterat
+00021110: 6f72 2069 6e20 6120 7761 7920 7468 6174  or in a way that
+00021120: 2061 6374 6976 656c 7920 6361 6e63 656c   actively cancel
+00021130: 7320 7468 6520 7374 7265 616d 696e 6720  s the streaming 
+00021140: 6752 5043 2063 616c 6c0a 746f 2074 6865  gRPC call.to the
+00021150: 2073 6572 7665 722e 2057 6865 6e20 7573   server. When us
+00021160: 6564 2061 7320 6120 636f 6e74 6578 7420  ed as a context 
+00021170: 6d61 6e61 6765 722c 2074 6865 2060 7374  manager, the `st
+00021180: 6f70 2829 6020 6d65 7468 6f64 2077 696c  op()` method wil
+00021190: 6c20 6265 2063 616c 6c65 6420 7768 656e  l be called when
+000211a0: 0a74 6865 2063 6f6e 7465 7874 206d 616e  .the context man
+000211b0: 6167 6572 2065 7869 7473 2e0a 0a54 6865  ager exits...The
+000211c0: 206d 6574 686f 6473 2060 7265 6164 5f73   methods `read_s
+000211d0: 7562 7363 7269 7074 696f 6e5f 746f 5f61  ubscription_to_a
+000211e0: 6c6c 2829 6020 616e 6420 6072 6561 645f  ll()` and `read_
+000211f0: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+00021200: 7374 7265 616d 2829 6020 7265 7475 726e  stream()` return
+00021210: 0a69 6e73 7461 6e63 6573 206f 6620 7468  .instances of th
+00021220: 6520 636c 6173 7320 6041 7379 6e63 696f  e class `Asyncio
+00021230: 5065 7273 6973 7465 6e74 5375 6273 6372  PersistentSubscr
+00021240: 6970 7469 6f6e 602c 2077 6869 6368 2068  iption`, which h
+00021250: 6173 2061 7379 6e63 206d 6574 686f 6473  as async methods
+00021260: 2060 6163 6b28 2960 2c0a 606e 6163 6b28   `ack()`,.`nack(
+00021270: 2960 2074 6861 7420 776f 726b 2069 6e20  )` that work in 
+00021280: 7468 6520 7361 6d65 2077 6179 2061 7320  the same way as 
+00021290: 7468 6520 6d65 7468 6f64 7320 6f6e 2060  the methods on `
+000212a0: 5065 7273 6973 7465 6e74 5375 6273 6372  PersistentSubscr
+000212b0: 6970 7469 6f6e 602c 0a73 7570 706f 7274  iption`,.support
+000212c0: 696e 6720 7468 6520 6163 6b6e 6f77 6c65  ing the acknowle
+000212d0: 6467 656d 656e 7420 616e 6420 6e65 6761  dgement and nega
+000212e0: 7469 7665 2061 636b 6e6f 776c 6564 6765  tive acknowledge
+000212f0: 6d65 6e74 206f 6620 7265 636f 7264 6564  ment of recorded
+00021300: 2065 7665 6e74 7320 7468 6174 0a68 6176   events that.hav
+00021310: 6520 6265 656e 2072 6563 6569 7665 6420  e been received 
+00021320: 6672 6f6d 2061 2070 6572 7369 7374 656e  from a persisten
+00021330: 7420 7375 6273 6372 6970 7469 6f6e 2e20  t subscription. 
+00021340: 5365 6520 6162 6f76 6520 666f 7220 6465  See above for de
+00021350: 7461 696c 732e 0a0a 2323 2320 5379 6e6f  tails...### Syno
+00021360: 7073 6973 3c61 2069 643d 2273 796e 6f70  psis<a id="synop
+00021370: 7369 732d 3122 3e3c 2f61 3e0a 0a54 6865  sis-1"></a>..The
+00021380: 2065 7861 6d70 6c65 2062 656c 6f77 2064   example below d
+00021390: 656d 6f6e 7374 7261 7465 7320 7468 6520  emonstrates the 
+000213a0: 6061 7070 656e 645f 746f 5f73 7472 6561  `append_to_strea
+000213b0: 6d28 2960 2c20 6067 6574 5f73 7472 6561  m()`, `get_strea
+000213c0: 6d28 2960 2061 6e64 0a60 7375 6273 6372  m()` and.`subscr
+000213d0: 6962 655f 746f 5f61 6c6c 2829 6020 6d65  ibe_to_all()` me
+000213e0: 7468 6f64 732e 2054 6865 7365 2061 7265  thods. These are
+000213f0: 2074 6865 206d 6f73 7420 7573 6566 756c   the most useful
+00021400: 206d 6574 686f 6473 2066 6f72 2077 7269   methods for wri
+00021410: 7469 6e67 0a61 6e20 6576 656e 742d 736f  ting.an event-so
+00021420: 7572 6365 6420 6170 706c 6963 6174 696f  urced applicatio
+00021430: 6e2c 2061 6c6c 6f77 696e 6720 6e65 7720  n, allowing new 
+00021440: 6167 6772 6567 6174 6520 6576 656e 7473  aggregate events
+00021450: 2074 6f20 6265 2072 6563 6f72 6465 642c   to be recorded,
+00021460: 2074 6865 0a72 6563 6f72 6465 6420 6576   the.recorded ev
+00021470: 656e 7473 206f 6620 616e 2061 6767 7265  ents of an aggre
+00021480: 6761 7465 2074 6f20 6265 206f 6274 6169  gate to be obtai
+00021490: 6e65 6420 736f 2061 6767 7265 6761 7465  ned so aggregate
+000214a0: 7320 6361 6e20 6265 2072 6563 6f6e 7374  s can be reconst
+000214b0: 7275 6374 6564 2c0a 616e 6420 7468 6520  ructed,.and the 
+000214c0: 7374 6174 6520 6f66 2061 6e20 6170 706c  state of an appl
+000214d0: 6963 6174 696f 6e20 746f 2070 726f 7061  ication to propa
+000214e0: 6761 7465 6420 616e 6420 7072 6f63 6573  gated and proces
+000214f0: 7365 6420 7769 7468 2022 6578 6163 746c  sed with "exactl
+00021500: 792d 6f6e 6365 220a 7365 6d61 6e74 6963  y-once".semantic
+00021510: 732e 0a0a 6060 6070 7974 686f 6e0a 696d  s...```python.im
+00021520: 706f 7274 2061 7379 6e63 696f 0a0a 6672  port asyncio..fr
+00021530: 6f6d 2065 7364 6263 6c69 656e 7420 696d  om esdbclient im
+00021540: 706f 7274 2041 7379 6e63 696f 4576 656e  port AsyncioEven
+00021550: 7453 746f 7265 4442 436c 6965 6e74 0a0a  tStoreDBClient..
+00021560: 0a61 7379 6e63 2064 6566 2064 656d 6f6e  .async def demon
+00021570: 7374 7261 7465 5f61 7379 6e63 696f 5f63  strate_asyncio_c
+00021580: 6c69 656e 7428 293a 0a0a 2020 2020 2320  lient():..    # 
+00021590: 436f 6e73 7472 7563 7420 636c 6965 6e74  Construct client
+000215a0: 2e0a 2020 2020 636c 6965 6e74 203d 2061  ..    client = a
+000215b0: 7761 6974 2041 7379 6e63 696f 4576 656e  wait AsyncioEven
+000215c0: 7453 746f 7265 4442 436c 6965 6e74 280a  tStoreDBClient(.
+000215d0: 2020 2020 2020 2020 7572 693d 6f73 2e67          uri=os.g
+000215e0: 6574 656e 7628 2245 5344 425f 5552 4922  etenv("ESDB_URI"
+000215f0: 292c 0a20 2020 2020 2020 2072 6f6f 745f  ),.        root_
+00021600: 6365 7274 6966 6963 6174 6573 3d6f 732e  certificates=os.
+00021610: 6765 7465 6e76 2822 4553 4442 5f52 4f4f  getenv("ESDB_ROO
+00021620: 545f 4345 5254 4946 4943 4154 4553 2229  T_CERTIFICATES")
+00021630: 2c0a 2020 2020 290a 0a20 2020 2023 2041  ,.    )..    # A
+00021640: 7070 656e 6420 6576 656e 7473 2e0a 2020  ppend events..  
+00021650: 2020 7374 7265 616d 5f6e 616d 6520 3d20    stream_name = 
+00021660: 7374 7228 7575 6964 2e75 7569 6434 2829  str(uuid.uuid4()
+00021670: 290a 2020 2020 6576 656e 7431 203d 204e  ).    event1 = N
+00021680: 6577 4576 656e 7428 224f 7264 6572 4372  ewEvent("OrderCr
+00021690: 6561 7465 6422 2c20 6461 7461 3d62 277b  eated", data=b'{
+000216a0: 7d27 290a 2020 2020 6576 656e 7432 203d  }').    event2 =
+000216b0: 204e 6577 4576 656e 7428 224f 7264 6572   NewEvent("Order
+000216c0: 5570 6461 7465 6422 2c20 6461 7461 3d62  Updated", data=b
+000216d0: 277b 7d27 290a 2020 2020 6576 656e 7433  '{}').    event3
+000216e0: 203d 204e 6577 4576 656e 7428 224f 7264   = NewEvent("Ord
+000216f0: 6572 4465 6c65 7465 6422 2c20 6461 7461  erDeleted", data
+00021700: 3d62 277b 7d27 290a 0a20 2020 2063 6f6d  =b'{}')..    com
+00021710: 6d69 745f 706f 7369 7469 6f6e 203d 2061  mit_position = a
+00021720: 7761 6974 2063 6c69 656e 742e 6170 7065  wait client.appe
+00021730: 6e64 5f74 6f5f 7374 7265 616d 280a 2020  nd_to_stream(.  
+00021740: 2020 2020 2020 7374 7265 616d 5f6e 616d        stream_nam
+00021750: 653d 7374 7265 616d 5f6e 616d 652c 0a20  e=stream_name,. 
+00021760: 2020 2020 2020 2063 7572 7265 6e74 5f76         current_v
+00021770: 6572 7369 6f6e 3d53 7472 6561 6d53 7461  ersion=StreamSta
+00021780: 7465 2e4e 4f5f 5354 5245 414d 2c0a 2020  te.NO_STREAM,.  
+00021790: 2020 2020 2020 6576 656e 7473 3d5b 6576        events=[ev
+000217a0: 656e 7431 2c20 6576 656e 7432 2c20 6576  ent1, event2, ev
+000217b0: 656e 7433 5d0a 2020 2020 290a 0a20 2020  ent3].    )..   
+000217c0: 2023 2047 6574 2073 7472 6561 6d20 6576   # Get stream ev
+000217d0: 656e 7473 2e0a 2020 2020 7265 636f 7264  ents..    record
+000217e0: 6564 203d 2061 7761 6974 2063 6c69 656e  ed = await clien
+000217f0: 742e 6765 745f 7374 7265 616d 2873 7472  t.get_stream(str
+00021800: 6561 6d5f 6e61 6d65 290a 2020 2020 6173  eam_name).    as
+00021810: 7365 7274 206c 656e 2872 6563 6f72 6465  sert len(recorde
+00021820: 6429 203d 3d20 330a 2020 2020 6173 7365  d) == 3.    asse
+00021830: 7274 2072 6563 6f72 6465 645b 305d 203d  rt recorded[0] =
+00021840: 3d20 6576 656e 7431 0a20 2020 2061 7373  = event1.    ass
+00021850: 6572 7420 7265 636f 7264 6564 5b31 5d20  ert recorded[1] 
+00021860: 3d3d 2065 7665 6e74 320a 2020 2020 6173  == event2.    as
+00021870: 7365 7274 2072 6563 6f72 6465 645b 325d  sert recorded[2]
+00021880: 203d 3d20 6576 656e 7433 0a0a 0a20 2020   == event3...   
+00021890: 2023 2053 7562 7363 7269 6265 2074 6f20   # Subscribe to 
+000218a0: 616c 6c20 6576 656e 7473 2e0a 2020 2020  all events..    
+000218b0: 7265 6365 6976 6564 203d 205b 5d0a 2020  received = [].  
+000218c0: 2020 6173 796e 6320 7769 7468 2061 7761    async with awa
+000218d0: 6974 2063 6c69 656e 742e 7375 6273 6372  it client.subscr
+000218e0: 6962 655f 746f 5f61 6c6c 2863 6f6d 6d69  ibe_to_all(commi
+000218f0: 745f 706f 7369 7469 6f6e 3d30 2920 6173  t_position=0) as
+00021900: 2073 7562 7363 7269 7074 696f 6e3a 0a20   subscription:. 
+00021910: 2020 2020 2020 2061 7379 6e63 2066 6f72         async for
+00021920: 2065 7665 6e74 2069 6e20 7375 6273 6372   event in subscr
+00021930: 6970 7469 6f6e 3a0a 2020 2020 2020 2020  iption:.        
+00021940: 2020 2020 7265 6365 6976 6564 2e61 7070      received.app
+00021950: 656e 6428 6576 656e 7429 0a20 2020 2020  end(event).     
+00021960: 2020 2020 2020 2069 6620 6576 656e 742e         if event.
+00021970: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
+00021980: 3d3d 2063 6f6d 6d69 745f 706f 7369 7469  == commit_positi
+00021990: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+000219a0: 2020 2020 6272 6561 6b0a 2020 2020 6173      break.    as
+000219b0: 7365 7274 2072 6563 6569 7665 645b 2d33  sert received[-3
+000219c0: 5d20 3d3d 2065 7665 6e74 310a 2020 2020  ] == event1.    
+000219d0: 6173 7365 7274 2072 6563 6569 7665 645b  assert received[
+000219e0: 2d32 5d20 3d3d 2065 7665 6e74 320a 2020  -2] == event2.  
+000219f0: 2020 6173 7365 7274 2072 6563 6569 7665    assert receive
+00021a00: 645b 2d31 5d20 3d3d 2065 7665 6e74 330a  d[-1] == event3.
+00021a10: 0a0a 2020 2020 2320 436c 6f73 6520 7468  ..    # Close th
+00021a20: 6520 636c 6965 6e74 2e0a 2020 2020 6177  e client..    aw
+00021a30: 6169 7420 636c 6965 6e74 2e63 6c6f 7365  ait client.close
+00021a40: 2829 0a0a 0a23 2052 756e 2074 6865 2064  ()...# Run the d
+00021a50: 656d 6f2e 0a61 7379 6e63 696f 2e67 6574  emo..asyncio.get
+00021a60: 5f65 7665 6e74 5f6c 6f6f 7028 292e 7275  _event_loop().ru
+00021a70: 6e5f 756e 7469 6c5f 636f 6d70 6c65 7465  n_until_complete
+00021a80: 280a 2020 2020 6465 6d6f 6e73 7472 6174  (.    demonstrat
+00021a90: 655f 6173 796e 6369 6f5f 636c 6965 6e74  e_asyncio_client
+00021aa0: 2829 0a29 0a60 6060 0a0a 2323 204e 6f74  ().).```..## Not
+00021ab0: 6573 3c61 2069 643d 226e 6f74 6573 223e  es<a id="notes">
+00021ac0: 3c2f 613e 0a0a 2323 2320 5265 6775 6c61  </a>..### Regula
+00021ad0: 7220 6578 7072 6573 7369 6f6e 2066 696c  r expression fil
+00021ae0: 7465 7273 3c61 2069 643d 2272 6567 756c  ters<a id="regul
+00021af0: 6172 2d65 7870 7265 7373 696f 6e2d 6669  ar-expression-fi
+00021b00: 6c74 6572 7322 3e3c 2f61 3e0a 0a54 6865  lters"></a>..The
+00021b10: 2060 7265 6164 5f61 6c6c 2829 602c 2060   `read_all()`, `
+00021b20: 7375 6273 6372 6962 655f 746f 5f61 6c6c  subscribe_to_all
+00021b30: 2829 602c 2060 6372 6561 7465 5f73 7562  ()`, `create_sub
+00021b40: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
+00021b50: 2829 600a 616e 6420 6067 6574 5f63 6f6d  ()`.and `get_com
+00021b60: 6d69 745f 706f 7369 7469 6f6e 2829 6020  mit_position()` 
+00021b70: 6d65 7468 6f64 7320 6861 7665 2060 6669  methods have `fi
+00021b80: 6c74 6572 5f65 7863 6c75 6465 6020 616e  lter_exclude` an
+00021b90: 6420 6066 696c 7465 725f 696e 636c 7564  d `filter_includ
+00021ba0: 6560 0a61 7267 756d 656e 7473 2e20 5468  e`.arguments. Th
+00021bb0: 6973 2073 6563 7469 6f6e 2070 726f 7669  is section provi
+00021bc0: 6465 7320 736f 6d65 206d 6f72 6520 6465  des some more de
+00021bd0: 7461 696c 7320 6162 6f75 7420 7468 6520  tails about the 
+00021be0: 7661 6c75 6573 206f 6620 7468 6573 650a  values of these.
+00021bf0: 6172 6775 6d65 6e74 732e 0a0a 5468 6520  arguments...The 
+00021c00: 6669 7273 7420 7468 696e 6720 746f 206e  first thing to n
+00021c10: 6f74 6520 6973 2074 6861 7420 7468 6520  ote is that the 
+00021c20: 7661 6c75 6573 206f 6620 7468 6573 6520  values of these 
+00021c30: 6172 6775 6d65 6e74 7320 7368 6f75 6c64  arguments should
+00021c40: 2062 6520 7365 7175 656e 6365 730a 6f66   be sequences.of
+00021c50: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
+00021c60: 696f 6e73 2e0a 0a50 6c65 6173 6520 6e6f  ions...Please no
+00021c70: 7465 2c20 7468 6579 2061 7265 2063 6f6e  te, they are con
+00021c80: 6361 7465 6e61 7465 6420 746f 6765 7468  catenated togeth
+00021c90: 6572 2062 7920 7468 6520 636c 6965 6e74  er by the client
+00021ca0: 2061 7320 6272 6163 6b65 7465 6420 616c   as bracketed al
+00021cb0: 7465 726e 6174 6976 6573 2069 6e20 6120  ternatives in a 
+00021cc0: 6c61 7267 6572 0a72 6567 756c 6172 2065  larger.regular e
+00021cd0: 7870 7265 7373 696f 6e20 7468 6174 2069  xpression that i
+00021ce0: 7320 616e 6368 6f72 6564 2074 6f20 7468  s anchored to th
+00021cf0: 6520 7374 6172 7420 616e 6420 656e 6420  e start and end 
+00021d00: 6f66 2074 6865 2073 7472 696e 6773 2062  of the strings b
+00021d10: 6569 6e67 0a6d 6174 6368 6564 2e20 536f  eing.matched. So
+00021d20: 2074 6865 7265 2069 7320 6e6f 206e 6565   there is no nee
+00021d30: 6420 746f 2069 6e63 6c75 6465 2074 6865  d to include the
+00021d40: 2060 275e 2760 2061 6e64 2060 2724 2760   `'^'` and `'$'`
+00021d50: 2061 6e63 686f 7220 6173 7365 7274 696f   anchor assertio
+00021d60: 6e73 2e0a 0a59 6f75 2073 686f 756c 6420  ns...You should 
+00021d70: 7573 6520 7769 6c64 6361 7264 7320 6966  use wildcards if
+00021d80: 2079 6f75 2077 616e 7420 746f 206d 6174   you want to mat
+00021d90: 6368 2073 7562 7374 7269 6e67 732c 2066  ch substrings, f
+00021da0: 6f72 2065 7861 6d70 6c65 2060 272e 2a53  or example `'.*S
+00021db0: 6e61 7073 686f 7427 600a 746f 206d 6174  napshot'`.to mat
+00021dc0: 6368 2061 6c6c 2073 7472 696e 6773 2074  ch all strings t
+00021dd0: 6861 7420 656e 6420 7769 7468 2060 2753  hat end with `'S
+00021de0: 6e61 7073 686f 7460 272c 206f 7220 6027  napshot`', or `'
+00021df0: 4f72 6465 722e 2a27 6020 746f 206d 6174  Order.*'` to mat
+00021e00: 6368 2061 6c6c 2073 7472 696e 6773 0a74  ch all strings.t
+00021e10: 6861 7420 7374 6172 7420 7769 7468 2060  hat start with `
+00021e20: 274f 7264 6572 2760 2e0a 0a53 7973 7465  'Order'`...Syste
+00021e30: 6d20 6576 656e 7473 2067 656e 6572 6174  m events generat
+00021e40: 6564 2062 7920 4576 656e 7453 746f 7265  ed by EventStore
+00021e50: 4442 2068 6176 6520 6074 7970 6560 2073  DB have `type` s
+00021e60: 7472 696e 6773 2074 6861 7420 7374 6172  trings that star
+00021e70: 7420 7769 7468 0a74 6865 2060 2460 2073  t with.the `$` s
+00021e80: 6967 6e2e 2050 6572 7369 7374 656e 6365  ign. Persistence
+00021e90: 2073 7562 7363 7269 7074 696f 6e20 6576   subscription ev
+00021ea0: 656e 7473 2067 656e 6572 6174 6564 2077  ents generated w
+00021eb0: 6865 6e20 6d61 6e69 7075 6c61 7469 6e67  hen manipulating
+00021ec0: 0a70 6572 7369 7374 656e 6365 2073 7562  .persistence sub
+00021ed0: 7363 7269 7074 696f 6e73 2068 6176 6520  scriptions have 
+00021ee0: 6074 7970 6560 2073 7472 696e 6773 2074  `type` strings t
+00021ef0: 6861 7420 7374 6172 7420 7769 7468 2060  hat start with `
+00021f00: 5065 7273 6973 7465 6e74 436f 6e66 6967  PersistentConfig
+00021f10: 602e 0a0a 466f 7220 6578 616d 706c 652c  `...For example,
+00021f20: 2074 6f20 6d61 7463 6820 7468 6520 7479   to match the ty
+00021f30: 7065 206f 6620 4576 656e 7453 746f 7265  pe of EventStore
+00021f40: 4442 2073 7973 7465 6d20 6576 656e 7473  DB system events
+00021f50: 2c20 7573 6520 7468 6520 7265 6775 6c61  , use the regula
+00021f60: 720a 6578 7072 6573 7369 6f6e 2073 7472  r.expression str
+00021f70: 696e 6720 6072 275c 242e 2b27 602e 2050  ing `r'\$.+'`. P
+00021f80: 6c65 6173 6520 6e6f 7465 2c20 7468 6520  lease note, the 
+00021f90: 636f 6e73 7461 6e74 2060 4553 4442 5f53  constant `ESDB_S
+00021fa0: 5953 5445 4d5f 4556 454e 5453 5f52 4547  YSTEM_EVENTS_REG
+00021fb0: 4558 6020 6973 0a73 6574 2074 6f20 7468  EX` is.set to th
+00021fc0: 6973 2076 616c 7565 2e20 596f 7520 6361  is value. You ca
+00021fd0: 6e20 696d 706f 7274 2074 6869 7320 636f  n import this co
+00021fe0: 6e73 7461 6e74 2066 726f 6d20 6065 7364  nstant from `esd
+00021ff0: 6263 6c69 656e 7460 2061 6e64 2075 7365  bclient` and use
+00022000: 2069 7420 7768 656e 0a62 7569 6c64 696e   it when.buildin
+00022010: 6720 6c6f 6e67 6572 2073 6571 7565 6e63  g longer sequenc
+00022020: 6573 206f 6620 7265 6775 6c61 7220 6578  es of regular ex
+00022030: 7072 6573 7369 6f6e 732e 0a0a 5369 6d69  pressions...Simi
+00022040: 6c61 726c 792c 2074 6f20 6d61 7463 6820  larly, to match 
+00022050: 7468 6520 7479 7065 206f 6620 4576 656e  the type of Even
+00022060: 7453 746f 7265 4442 2070 6572 7369 7374  tStoreDB persist
+00022070: 656e 6365 2073 7562 7363 7269 7074 696f  ence subscriptio
+00022080: 6e20 6576 656e 7473 2c20 7573 6520 7468  n events, use th
+00022090: 650a 7265 6775 6c61 7220 6578 7072 6573  e.regular expres
+000220a0: 7369 6f6e 2060 7227 5065 7273 6973 7465  sion `r'Persiste
+000220b0: 6e74 436f 6e66 6967 5c64 2b27 602e 2054  ntConfig\d+'`. T
+000220c0: 6865 2063 6f6e 7374 616e 7420 6045 5344  he constant `ESD
+000220d0: 425f 5045 5253 4953 5445 4e54 5f43 4f4e  B_PERSISTENT_CON
+000220e0: 4649 475f 4556 454e 5453 5f52 4547 4558  FIG_EVENTS_REGEX
+000220f0: 600a 6973 2073 6574 2074 6f20 7468 6973  `.is set to this
+00022100: 2076 616c 7565 2e20 596f 7520 6361 6e20   value. You can 
+00022110: 696d 706f 7274 2074 6869 7320 636f 6e73  import this cons
+00022120: 7461 6e74 2066 726f 6d20 6065 7364 6263  tant from `esdbc
+00022130: 6c69 656e 7460 2061 6e64 2075 7365 2069  lient` and use i
+00022140: 7420 7768 656e 0a62 7569 6c64 696e 6720  t when.building 
+00022150: 6c6f 6e67 6572 2073 6571 7565 6e63 6573  longer sequences
+00022160: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
+00022170: 6573 7369 6f6e 732e 0a0a 5468 6520 636f  essions...The co
+00022180: 6e73 7461 6e74 2060 4445 4641 554c 545f  nstant `DEFAULT_
+00022190: 4558 434c 5544 455f 4649 4c54 4552 6020  EXCLUDE_FILTER` 
+000221a0: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
+000221b0: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
+000221c0: 696f 6e73 2074 6861 7420 696e 636c 7564  ions that includ
+000221d0: 6573 0a62 6f74 6820 6045 5344 425f 5359  es.both `ESDB_SY
+000221e0: 5354 454d 5f45 5645 4e54 535f 5245 4745  STEM_EVENTS_REGE
+000221f0: 5860 2061 6e64 2060 4553 4442 5f50 4552  X` and `ESDB_PER
+00022200: 5349 5354 454e 545f 434f 4e46 4947 5f45  SISTENT_CONFIG_E
+00022210: 5645 4e54 535f 5245 4745 5860 2e20 4974  VENTS_REGEX`. It
+00022220: 2069 7320 7573 6564 0a61 7320 7468 6520   is used.as the 
+00022230: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
+00022240: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
+00022250: 6020 736f 2074 6861 7420 7468 6520 6576  ` so that the ev
+00022260: 656e 7473 2067 656e 6572 6174 6564 2069  ents generated i
+00022270: 6e74 6572 6e61 6c6c 7920 6279 0a45 7665  nternally by.Eve
+00022280: 6e74 5374 6f72 6544 4220 6172 6520 6578  ntStoreDB are ex
+00022290: 636c 7564 6564 2062 7920 6465 6661 756c  cluded by defaul
+000222a0: 742e 0a0a 496e 2061 6c6c 206d 6574 686f  t...In all metho
+000222b0: 6473 2074 6861 7420 6861 7665 2061 2060  ds that have a `
+000222c0: 6669 6c74 6572 5f65 7863 6c75 6465 6020  filter_exclude` 
+000222d0: 6172 6775 6d65 6e74 2c20 7468 6520 6465  argument, the de
+000222e0: 6661 756c 7420 7661 6c75 6520 6f66 2074  fault value of t
+000222f0: 6865 2061 7267 756d 656e 740a 6973 2074  he argument.is t
+00022300: 6865 2063 6f6e 7374 616e 7420 6044 4546  he constant `DEF
+00022310: 4155 4c54 5f45 5843 4c55 4445 5f46 494c  AULT_EXCLUDE_FIL
+00022320: 5445 5260 2c20 7768 6963 6820 6973 2064  TER`, which is d
+00022330: 6573 6967 6e65 6420 746f 206d 6174 6368  esigned to match
+00022340: 2028 616e 6420 7468 6572 6566 6f72 650a   (and therefore.
+00022350: 746f 2065 7863 6c75 6465 2920 626f 7468  to exclude) both
+00022360: 2022 7379 7374 656d 2220 616e 6420 2270   "system" and "p
+00022370: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
+00022380: 7269 7074 696f 6e20 636f 6e66 6967 2220  ription config" 
+00022390: 6576 656e 7420 7479 7065 732c 2077 6869  event types, whi
+000223a0: 6368 0a77 6f75 6c64 206f 7468 6572 7769  ch.would otherwi
+000223b0: 7365 2062 6520 696e 636c 7564 6564 2e0a  se be included..
+000223c0: 0a54 6869 7320 7661 6c75 6520 6361 6e20  .This value can 
+000223d0: 6265 2065 7874 656e 6465 642e 2046 6f72  be extended. For
+000223e0: 2065 7861 6d70 6c65 2c20 6966 2079 6f75   example, if you
+000223f0: 2077 616e 7420 746f 2065 7863 6c75 6465   want to exclude
+00022400: 2073 7973 7465 6d20 6576 656e 7473 2061   system events a
+00022410: 6e64 0a70 6572 7369 7374 656e 7420 7375  nd.persistent su
+00022420: 6273 6372 6970 7469 6f6e 2065 7665 6e74  bscription event
+00022430: 7320 616e 6420 616c 736f 2065 7665 6e74  s and also event
+00022440: 7320 7468 6174 2068 6176 6520 6120 7479  s that have a ty
+00022450: 7065 2074 6861 7420 656e 6473 2077 6974  pe that ends wit
+00022460: 680a 6027 536e 6170 7368 6f74 2760 2c20  h.`'Snapshot'`, 
+00022470: 7468 656e 2079 6f75 2063 616e 2075 7365  then you can use
+00022480: 2060 4445 4641 554c 545f 4558 434c 5544   `DEFAULT_EXCLUD
+00022490: 455f 4649 4c54 4552 202b 205b 272e 2a53  E_FILTER + ['.*S
+000224a0: 6e61 7073 686f 7427 5d60 2061 7320 7468  napshot']` as th
+000224b0: 650a 6066 696c 7465 725f 6578 636c 7564  e.`filter_exclud
+000224c0: 6560 2061 7267 756d 656e 742e 0a0a 5468  e` argument...Th
+000224d0: 6520 6066 696c 7465 725f 696e 636c 7564  e `filter_includ
+000224e0: 6560 2061 6e64 2060 6669 6c74 6572 5f65  e` and `filter_e
+000224f0: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
+00022500: 7320 6172 6520 6465 7369 676e 6564 2074  s are designed t
+00022510: 6f20 6861 7665 2065 7861 6374 6c79 0a74  o have exactly.t
+00022520: 6865 206f 7070 6f73 6974 6520 6566 6665  he opposite effe
+00022530: 6374 2066 726f 6d20 6561 6368 206f 7468  ct from each oth
+00022540: 6572 2c20 736f 2074 6861 7420 6120 7365  er, so that a se
+00022550: 7175 656e 6365 206f 6620 7374 7269 6e67  quence of string
+00022560: 7320 6769 7665 6e20 746f 0a60 6669 6c74  s given to.`filt
+00022570: 6572 5f69 6e63 6c75 6465 6020 7769 6c6c  er_include` will
+00022580: 2072 6574 7572 6e20 6578 6163 746c 7920   return exactly 
+00022590: 7468 6f73 6520 6576 656e 7473 2077 6869  those events whi
+000225a0: 6368 2077 6f75 6c64 2062 6520 6578 636c  ch would be excl
+000225b0: 7564 6564 2069 660a 7468 6520 7361 6d65  uded if.the same
+000225c0: 2061 7267 756d 656e 7420 7661 6c75 6520   argument value 
+000225d0: 7765 7265 2075 7365 6420 7769 7468 2060  were used with `
+000225e0: 6669 6c74 6572 5f65 7863 6c75 6465 602e  filter_exclude`.
+000225f0: 2041 6e64 2076 6963 6520 7665 7273 612c   And vice versa,
+00022600: 2073 6f20 7468 6174 0a61 2073 6571 7565   so that.a seque
+00022610: 6e63 6520 6f66 2073 7472 696e 6773 2067  nce of strings g
+00022620: 6976 656e 2074 6f20 6066 696c 7465 725f  iven to `filter_
+00022630: 6578 636c 7564 6560 2077 696c 6c20 7265  exclude` will re
+00022640: 7475 726e 2065 7861 6374 6c79 2074 686f  turn exactly tho
+00022650: 7365 2065 7665 6e74 730a 7468 6174 2077  se events.that w
+00022660: 6f75 6c64 206e 6f74 2062 6520 696e 636c  ould not be incl
+00022670: 7564 6564 2069 6620 7468 6520 7361 6d65  uded if the same
+00022680: 2061 7267 756d 656e 7420 7661 6c75 6520   argument value 
+00022690: 7765 7265 2075 7365 6420 7769 7468 2060  were used with `
+000226a0: 6669 6c74 6572 5f69 6e63 6c75 6465 602e  filter_include`.
+000226b0: 0a0a 0a23 2323 2052 6563 6f6e 6e65 6374  ...### Reconnect
+000226c0: 2061 6e64 2072 6574 7279 206d 6574 686f   and retry metho
+000226d0: 6420 6465 636f 7261 746f 7273 3c61 2069  d decorators<a i
+000226e0: 643d 2272 6563 6f6e 6e65 6374 2d61 6e64  d="reconnect-and
+000226f0: 2d72 6574 7279 2d6d 6574 686f 642d 6465  -retry-method-de
+00022700: 636f 7261 746f 7273 223e 3c2f 613e 0a0a  corators"></a>..
+00022710: 506c 6561 7365 206e 6f74 652c 206e 6561  Please note, nea
+00022720: 726c 7920 616c 6c20 7468 6520 636c 6965  rly all the clie
+00022730: 6e74 206d 6574 686f 6473 2061 7265 2064  nt methods are d
+00022740: 6563 6f72 6174 6564 2077 6974 6820 7468  ecorated with th
+00022750: 6520 6040 6175 746f 7265 636f 6e6e 6563  e `@autoreconnec
+00022760: 7460 2061 6e64 0a74 6865 2060 4072 6574  t` and.the `@ret
+00022770: 7279 6772 7063 6020 6465 636f 7261 746f  rygrpc` decorato
+00022780: 7273 2e0a 0a54 6865 2060 4061 7574 6f72  rs...The `@autor
+00022790: 6563 6f6e 6e65 6374 6020 6465 636f 7261  econnect` decora
+000227a0: 746f 7220 7769 6c6c 2072 6563 6f6e 6e65  tor will reconne
+000227b0: 6374 2074 6f20 6120 7375 6974 6162 6c65  ct to a suitable
+000227c0: 206e 6f64 6520 696e 2074 6865 2063 6c75   node in the clu
+000227d0: 7374 6572 2077 6865 6e0a 7468 6520 7365  ster when.the se
+000227e0: 7276 6572 2074 6f20 7768 6963 6820 7468  rver to which th
+000227f0: 6520 636c 6965 6e74 2068 6173 2062 6565  e client has bee
+00022800: 6e20 636f 6e6e 6563 7465 6420 6861 7320  n connected has 
+00022810: 6265 636f 6d65 2075 6e61 7661 696c 6162  become unavailab
+00022820: 6c65 2c20 6f72 2077 6865 6e20 7468 650a  le, or when the.
+00022830: 636c 6965 6e74 2773 2067 5250 4320 6368  client's gRPC ch
+00022840: 616e 6e65 6c20 6861 7070 656e 7320 746f  annel happens to
+00022850: 2068 6176 6520 6265 656e 2063 6c6f 7365   have been close
+00022860: 642e 2054 6865 2063 6c69 656e 7420 7769  d. The client wi
+00022870: 6c6c 2061 6c73 6f20 7265 636f 6e6e 6563  ll also reconnec
+00022880: 7420 7768 656e 0a61 206d 6574 686f 6420  t when.a method 
+00022890: 6973 2063 616c 6c65 6420 7468 6174 2072  is called that r
+000228a0: 6571 7569 7265 7320 6120 6c65 6164 6572  equires a leader
+000228b0: 2c20 616e 6420 7468 6520 636c 6965 6e74  , and the client
+000228c0: 2773 206e 6f64 6520 7072 6566 6572 656e  's node preferen
+000228d0: 6365 2069 7320 746f 2062 650a 636f 6e6e  ce is to be.conn
+000228e0: 6563 7465 6420 746f 2061 206c 6561 6465  ected to a leade
+000228f0: 722c 2062 7574 2074 6865 206e 6f64 6520  r, but the node 
+00022900: 7468 6174 2074 6865 2063 6c69 656e 7420  that the client 
+00022910: 6861 7320 6265 656e 2063 6f6e 6e65 6374  has been connect
+00022920: 6564 2074 6f20 7374 6f70 7320 6265 696e  ed to stops bein
+00022930: 670a 7468 6520 6c65 6164 6572 2e20 496e  g.the leader. In
+00022940: 2074 6869 7320 6361 7365 2c20 7468 6520   this case, the 
+00022950: 636c 6965 6e74 2077 696c 6c20 7265 636f  client will reco
+00022960: 6e6e 6563 7420 746f 2074 6865 2063 7572  nnect to the cur
+00022970: 7265 6e74 206c 6561 6465 722e 2041 6674  rent leader. Aft
+00022980: 6572 0a72 6563 6f6e 6e65 6374 696e 672c  er.reconnecting,
+00022990: 2074 6865 2066 6169 6c65 6420 6f70 6572   the failed oper
+000229a0: 6174 696f 6e20 7769 6c6c 2062 6520 7265  ation will be re
+000229b0: 7472 6965 642e 0a0a 5468 6520 6040 7265  tried...The `@re
+000229c0: 7472 7967 7270 6360 2064 6563 6f72 6174  trygrpc` decorat
+000229d0: 6f72 2073 656c 6563 7469 7665 6c79 2072  or selectively r
+000229e0: 6574 7269 6573 2067 5250 4320 6f70 6572  etries gRPC oper
+000229f0: 6174 696f 6e73 2074 6861 7420 6861 7665  ations that have
+00022a00: 2066 6169 6c65 6420 6475 6520 746f 0a61   failed due to.a
+00022a10: 2074 696d 656f 7574 2c20 6e65 7477 6f72   timeout, networ
+00022a20: 6b20 6572 726f 722c 206f 7220 7365 7276  k error, or serv
+00022a30: 6572 2065 7272 6f72 2e20 4974 2064 6f65  er error. It doe
+00022a40: 736e 2774 2072 6574 7279 206f 7065 7261  sn't retry opera
+00022a50: 7469 6f6e 7320 7468 6174 2066 6169 6c20  tions that fail 
+00022a60: 6475 6520 746f 0a62 6164 2072 6571 7565  due to.bad reque
+00022a70: 7374 7320 7468 6174 2077 696c 6c20 6365  sts that will ce
+00022a80: 7274 6169 6e6c 7920 6661 696c 2061 6761  rtainly fail aga
+00022a90: 696e 2e0a 0a50 6c65 6173 6520 616c 736f  in...Please also
+00022aa0: 206e 6f74 652c 2074 6865 2061 7370 6563   note, the aspec
+00022ab0: 7473 206e 6f74 2063 6f76 6572 6564 2062  ts not covered b
+00022ac0: 7920 7468 6520 7265 636f 6e6e 6563 7420  y the reconnect 
+00022ad0: 616e 6420 7265 7472 7920 6465 636f 7261  and retry decora
+00022ae0: 746f 720a 6265 6861 7669 6f75 7273 2068  tor.behaviours h
+00022af0: 6176 6520 746f 2064 6f20 7769 7468 206d  ave to do with m
+00022b00: 6574 686f 6473 2074 6861 7420 7265 7475  ethods that retu
+00022b10: 726e 2069 7465 7261 746f 7273 2e20 466f  rn iterators. Fo
+00022b20: 7220 6578 616d 706c 652c 2063 6f6e 7369  r example, consi
+00022b30: 6465 720a 7468 6520 2272 6561 6420 7265  der.the "read re
+00022b40: 7370 6f6e 7365 2220 6974 6572 6174 6f72  sponse" iterator
+00022b50: 2072 6574 7572 6e65 6420 6672 6f6d 2074   returned from t
+00022b60: 6865 2060 7265 6164 5f61 6c6c 2829 6020  he `read_all()` 
+00022b70: 6d65 7468 6f64 2e20 5468 650a 6072 6561  method. The.`rea
+00022b80: 645f 616c 6c28 2960 206d 6574 686f 6420  d_all()` method 
+00022b90: 7769 6c6c 2068 6176 6520 7265 7475 726e  will have return
+00022ba0: 6564 2c20 616e 6420 7468 6520 6d65 7468  ed, and the meth
+00022bb0: 6f64 2064 6563 6f72 6174 6f72 7320 7769  od decorators wi
+00022bc0: 6c6c 2074 6865 7265 666f 7265 0a68 6176  ll therefore.hav
+00022bd0: 6520 6578 6974 6564 2c20 6265 666f 7265  e exited, before
+00022be0: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
+00022bf0: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
+00022c00: 7365 2220 6265 6769 6e73 2e20 5468 6572  se" begins. Ther
+00022c10: 6566 6f72 652c 2069 6620 610a 636f 6e6e  efore, if a.conn
+00022c20: 6563 7469 6f6e 2069 7373 7565 206f 6363  ection issue occ
+00022c30: 7572 7320 7768 696c 7374 2069 7465 7261  urs whilst itera
+00022c40: 7469 6e67 206f 7665 7220 7468 6520 2272  ting over the "r
+00022c50: 6561 6420 7265 7370 6f6e 7365 222c 2069  ead response", i
+00022c60: 7420 6973 6e27 7420 706f 7373 6962 6c65  t isn't possible
+00022c70: 0a66 6f72 2061 6e79 2064 6563 6f72 6174  .for any decorat
+00022c80: 6f72 206f 6e20 7468 6520 6072 6561 645f  or on the `read_
+00022c90: 616c 6c28 2960 206d 6574 686f 6420 746f  all()` method to
+00022ca0: 2074 7269 6767 6572 2061 2072 6563 6f6e   trigger a recon
+00022cb0: 6e65 6374 696f 6e2e 0a0a 5769 7468 2074  nection...With t
+00022cc0: 6865 2022 6361 7463 682d 7570 2073 7562  he "catch-up sub
+00022cd0: 7363 7269 7074 696f 6e22 206f 626a 6563  scription" objec
+00022ce0: 7473 2c20 7468 6572 6520 6973 2061 6e20  ts, there is an 
+00022cf0: 696e 6974 6961 6c20 2263 6f6e 6669 726d  initial "confirm
+00022d00: 6174 696f 6e22 2072 6573 706f 6e73 650a  ation" response.
+00022d10: 6672 6f6d 2074 6865 2073 6572 7665 7220  from the server 
+00022d20: 7768 6963 6820 6973 2072 6563 6569 7665  which is receive
+00022d30: 6420 616e 6420 6368 6563 6b65 6420 6279  d and checked by
+00022d40: 2074 6865 2063 6c69 656e 742e 2041 6e64   the client. And
+00022d50: 2073 6f2c 2077 6865 6e20 6120 6361 6c6c   so, when a call
+00022d60: 2069 730a 6d61 6465 2074 6f20 6073 7562   is.made to `sub
+00022d70: 7363 7269 6265 5f74 6f5f 616c 6c28 2960  scribe_to_all()`
+00022d80: 206f 7220 6073 7562 7363 7269 6265 5f74   or `subscribe_t
+00022d90: 6f5f 7374 7265 616d 2829 602c 2069 6620  o_stream()`, if 
+00022da0: 7468 6520 7365 7276 6572 2069 7320 756e  the server is un
+00022db0: 6176 6169 6c61 626c 652c 0a6f 7220 6966  available,.or if
+00022dc0: 2074 6865 2063 6861 6e6e 656c 2068 6173   the channel has
+00022dd0: 2073 6f6d 6568 6f77 2062 6565 6e20 636c   somehow been cl
+00022de0: 6f73 6564 2c20 6f72 2069 6620 7468 6520  osed, or if the 
+00022df0: 7265 7175 6573 7420 6661 696c 7320 666f  request fails fo
+00022e00: 7220 736f 6d65 206f 7468 6572 2072 6561  r some other rea
+00022e10: 736f 6e2c 0a74 6865 6e20 7468 6520 636c  son,.then the cl
+00022e20: 6965 6e74 2077 696c 6c20 7265 636f 6e6e  ient will reconn
+00022e30: 6563 7420 616e 6420 7265 7472 792e 2048  ect and retry. H
+00022e40: 6f77 6576 6572 2c20 6966 2061 6e20 6578  owever, if an ex
+00022e50: 6365 7074 696f 6e20 6973 2072 6169 7365  ception is raise
+00022e60: 6420 7768 656e 2069 7465 7261 7469 6e67  d when iterating
+00022e70: 206f 7665 7220 610a 7375 6363 6573 7366   over a.successf
+00022e80: 756c 6c79 2072 6574 7572 6e65 6420 2263  ully returned "c
+00022e90: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00022ea0: 7469 6f6e 2220 6f62 6a65 6374 2c20 7468  tion" object, th
+00022eb0: 6520 6361 7463 682d 7570 2073 7562 7363  e catch-up subsc
+00022ec0: 7269 7074 696f 6e20 7769 6c6c 0a6e 6565  ription will.nee
+00022ed0: 6420 746f 2062 6520 7265 7374 6172 7465  d to be restarte
+00022ee0: 642e 2053 696d 696c 6172 6c79 2c20 7768  d. Similarly, wh
+00022ef0: 656e 2072 6561 6469 6e67 2070 6572 7369  en reading persi
+00022f00: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00022f10: 6f6e 732c 2069 6620 7468 6572 6520 6172  ons, if there ar
+00022f20: 650a 636f 6e6e 6563 7469 6f6e 2069 7373  e.connection iss
+00022f30: 7565 7320 7768 696c 7374 2069 7465 7261  ues whilst itera
+00022f40: 7469 6e67 206f 7665 7220 6120 7375 6363  ting over a succ
+00022f50: 6573 7366 756c 6c79 2072 6563 6569 7665  essfully receive
+00022f60: 6420 7265 7370 6f6e 7365 2c20 7468 6520  d response, the 
+00022f70: 636f 6e73 756d 6572 0a77 696c 6c20 6e65  consumer.will ne
+00022f80: 6564 2074 6f20 6265 2072 6573 7461 7274  ed to be restart
+00022f90: 6564 2e0a 0a0a 2323 2043 6f6e 7472 6962  ed....## Contrib
+00022fa0: 7574 6f72 733c 6120 6964 3d22 636f 6e74  utors<a id="cont
+00022fb0: 7269 6275 746f 7273 223e 3c2f 613e 0a0a  ributors"></a>..
+00022fc0: 2323 2320 496e 7374 616c 6c20 506f 6574  ### Install Poet
+00022fd0: 7279 3c61 2069 643d 2269 6e73 7461 6c6c  ry<a id="install
+00022fe0: 2d70 6f65 7472 7922 3e3c 2f61 3e0a 0a54  -poetry"></a>..T
+00022ff0: 6865 2066 6972 7374 2074 6869 6e67 2069  he first thing i
+00023000: 7320 746f 2063 6865 636b 2079 6f75 2068  s to check you h
+00023010: 6176 6520 506f 6574 7279 2069 6e73 7461  ave Poetry insta
+00023020: 6c6c 6564 2e0a 0a20 2020 2024 2070 6f65  lled...    $ poe
+00023030: 7472 7920 2d2d 7665 7273 696f 6e0a 0a49  try --version..I
+00023040: 6620 796f 7520 646f 6e27 742c 2074 6865  f you don't, the
+00023050: 6e20 706c 6561 7365 205b 696e 7374 616c  n please [instal
+00023060: 6c20 506f 6574 7279 5d28 6874 7470 733a  l Poetry](https:
+00023070: 2f2f 7079 7468 6f6e 2d70 6f65 7472 792e  //python-poetry.
+00023080: 6f72 672f 646f 6373 2f23 696e 7374 616c  org/docs/#instal
+00023090: 6c69 6e67 2d77 6974 682d 7468 652d 6f66  ling-with-the-of
+000230a0: 6669 6369 616c 2d69 6e73 7461 6c6c 6572  ficial-installer
+000230b0: 292e 0a0a 2020 2020 2420 6375 726c 202d  )...    $ curl -
+000230c0: 7353 4c20 6874 7470 733a 2f2f 696e 7374  sSL https://inst
+000230d0: 616c 6c2e 7079 7468 6f6e 2d70 6f65 7472  all.python-poetr
+000230e0: 792e 6f72 6720 7c20 7079 7468 6f6e 3320  y.org | python3 
+000230f0: 2d0a 0a49 7420 7769 6c6c 2068 656c 7020  -..It will help 
+00023100: 746f 206d 616b 6520 7375 7265 2050 6f65  to make sure Poe
+00023110: 7472 7927 7320 6269 6e20 6469 7265 6374  try's bin direct
+00023120: 6f72 7920 6973 2069 6e20 796f 7572 2060  ory is in your `
+00023130: 5041 5448 6020 656e 7669 726f 6e6d 656e  PATH` environmen
+00023140: 7420 7661 7269 6162 6c65 2e0a 0a42 7574  t variable...But
+00023150: 2069 6e20 616e 7920 6361 7365 2c20 6d61   in any case, ma
+00023160: 6b65 2073 7572 6520 796f 7520 6b6e 6f77  ke sure you know
+00023170: 2074 6865 2070 6174 6820 746f 2074 6865   the path to the
+00023180: 2060 706f 6574 7279 6020 6578 6563 7574   `poetry` execut
+00023190: 6162 6c65 2e20 5468 6520 506f 6574 7279  able. The Poetry
+000231a0: 0a69 6e73 7461 6c6c 6572 2074 656c 6c73  .installer tells
+000231b0: 2079 6f75 2077 6865 7265 2069 7420 6861   you where it ha
+000231c0: 7320 6265 656e 2069 6e73 7461 6c6c 6564  s been installed
+000231d0: 2c20 616e 6420 686f 7720 746f 2063 6f6e  , and how to con
+000231e0: 6669 6775 7265 2079 6f75 7220 7368 656c  figure your shel
+000231f0: 6c2e 0a0a 506c 6561 7365 2072 6566 6572  l...Please refer
+00023200: 2074 6f20 7468 6520 5b50 6f65 7472 7920   to the [Poetry 
+00023210: 646f 6373 5d28 6874 7470 733a 2f2f 7079  docs](https://py
+00023220: 7468 6f6e 2d70 6f65 7472 792e 6f72 672f  thon-poetry.org/
+00023230: 646f 6373 2f29 2066 6f72 2067 7569 6461  docs/) for guida
+00023240: 6e63 6520 6f6e 0a75 7369 6e67 2050 6f65  nce on.using Poe
+00023250: 7472 792e 0a0a 2323 2320 5365 7475 7020  try...### Setup 
+00023260: 666f 7220 5079 4368 6172 6d20 7573 6572  for PyCharm user
+00023270: 733c 6120 6964 3d22 7365 7475 702d 666f  s<a id="setup-fo
+00023280: 722d 7079 6368 6172 6d2d 7573 6572 7322  r-pycharm-users"
+00023290: 3e3c 2f61 3e0a 0a59 6f75 2063 616e 2065  ></a>..You can e
+000232a0: 6173 696c 7920 6f62 7461 696e 2074 6865  asily obtain the
+000232b0: 2070 726f 6a65 6374 2066 696c 6573 2075   project files u
+000232c0: 7369 6e67 2050 7943 6861 726d 2028 6d65  sing PyCharm (me
+000232d0: 6e75 2022 4769 7420 3e20 436c 6f6e 652e  nu "Git > Clone.
+000232e0: 2e2e 2229 2e0a 5079 4368 6172 6d20 7769  ..")..PyCharm wi
+000232f0: 6c6c 2074 6865 6e20 7573 7561 6c6c 7920  ll then usually 
+00023300: 7072 6f6d 7074 2079 6f75 2074 6f20 6f70  prompt you to op
+00023310: 656e 2074 6865 2070 726f 6a65 6374 2e0a  en the project..
+00023320: 0a4f 7065 6e20 7468 6520 7072 6f6a 6563  .Open the projec
+00023330: 7420 696e 2061 206e 6577 2077 696e 646f  t in a new windo
+00023340: 772e 2050 7943 6861 726d 2077 696c 6c20  w. PyCharm will 
+00023350: 7468 656e 2075 7375 616c 6c79 2070 726f  then usually pro
+00023360: 6d70 7420 796f 7520 746f 2063 7265 6174  mpt you to creat
+00023370: 650a 6120 6e65 7720 7669 7274 7561 6c20  e.a new virtual 
+00023380: 656e 7669 726f 6e6d 656e 742e 0a0a 4372  environment...Cr
+00023390: 6561 7465 2061 206e 6577 2050 6f65 7472  eate a new Poetr
+000233a0: 7920 7669 7274 7561 6c20 656e 7669 726f  y virtual enviro
+000233b0: 6e6d 656e 7420 666f 7220 7468 6520 7072  nment for the pr
+000233c0: 6f6a 6563 742e 2049 6620 5079 4368 6172  oject. If PyChar
+000233d0: 6d20 646f 6573 6e27 7420 616c 7265 6164  m doesn't alread
+000233e0: 790a 6b6e 6f77 2077 6865 7265 2079 6f75  y.know where you
+000233f0: 7220 6070 6f65 7472 7960 2065 7865 6375  r `poetry` execu
+00023400: 7461 626c 6520 6973 2c20 7468 656e 2073  table is, then s
+00023410: 6574 2074 6865 2070 6174 6820 746f 2079  et the path to y
+00023420: 6f75 7220 6070 6f65 7472 7960 2065 7865  our `poetry` exe
+00023430: 6375 7461 626c 650a 696e 2074 6865 2022  cutable.in the "
+00023440: 4e65 7720 506f 6574 7279 2045 6e76 6972  New Poetry Envir
+00023450: 6f6e 6d65 6e74 2220 666f 726d 2069 6e70  onment" form inp
+00023460: 7574 2066 6965 6c64 206c 6162 656c 6c65  ut field labelle
+00023470: 6420 2250 6f65 7472 7920 6578 6563 7574  d "Poetry execut
+00023480: 6162 6c65 222e 2049 6e20 7468 650a 224e  able". In the."N
+00023490: 6577 2050 6f65 7472 7920 456e 7669 726f  ew Poetry Enviro
+000234a0: 6e6d 656e 7422 2066 6f72 6d2c 2079 6f75  nment" form, you
+000234b0: 2077 696c 6c20 616c 736f 2068 6176 6520   will also have 
+000234c0: 7468 6520 6f70 706f 7274 756e 6974 7920  the opportunity 
+000234d0: 746f 2073 656c 6563 7420 7768 6963 680a  to select which.
+000234e0: 5079 7468 6f6e 2065 7865 6375 7461 626c  Python executabl
+000234f0: 6520 7769 6c6c 2062 6520 7573 6564 2062  e will be used b
+00023500: 7920 7468 6520 7669 7274 7561 6c20 656e  y the virtual en
+00023510: 7669 726f 6e6d 656e 742e 0a0a 5079 4368  vironment...PyCh
+00023520: 6172 6d20 7769 6c6c 2074 6865 6e20 6372  arm will then cr
+00023530: 6561 7465 2061 206e 6577 2050 6f65 7472  eate a new Poetr
+00023540: 7920 7669 7274 7561 6c20 656e 7669 726f  y virtual enviro
+00023550: 6e6d 656e 7420 666f 7220 796f 7572 2070  nment for your p
+00023560: 726f 6a65 6374 2c20 7573 696e 670a 6120  roject, using.a 
+00023570: 7061 7274 6963 756c 6172 2076 6572 7369  particular versi
+00023580: 6f6e 206f 6620 5079 7468 6f6e 2c20 616e  on of Python, an
+00023590: 6420 616c 736f 2069 6e73 7461 6c6c 2069  d also install i
+000235a0: 6e74 6f20 7468 6973 2076 6972 7475 616c  nto this virtual
+000235b0: 2065 6e76 6972 6f6e 6d65 6e74 2074 6865   environment the
+000235c0: 0a70 726f 6a65 6374 2773 2070 6163 6b61  .project's packa
+000235d0: 6765 2064 6570 656e 6465 6e63 6965 7320  ge dependencies 
+000235e0: 6163 636f 7264 696e 6720 746f 2074 6865  according to the
+000235f0: 2070 726f 6a65 6374 2773 2060 706f 6574   project's `poet
+00023600: 7279 2e6c 6f63 6b60 2066 696c 652e 0a0a  ry.lock` file...
+00023610: 596f 7520 6361 6e20 6164 6420 6469 6666  You can add diff
+00023620: 6572 656e 7420 506f 6574 7279 2065 6e76  erent Poetry env
+00023630: 6972 6f6e 6d65 6e74 7320 666f 7220 6469  ironments for di
+00023640: 6666 6572 656e 7420 5079 7468 6f6e 2076  fferent Python v
+00023650: 6572 7369 6f6e 732c 2061 6e64 2073 7769  ersions, and swi
+00023660: 7463 680a 6265 7477 6565 6e20 7468 656d  tch.between them
+00023670: 2075 7369 6e67 2074 6865 2022 5079 7468   using the "Pyth
+00023680: 6f6e 2049 6e74 6572 7072 6574 6572 2220  on Interpreter" 
+00023690: 7365 7474 696e 6773 206f 6620 5079 4368  settings of PyCh
+000236a0: 6172 6d2e 2049 6620 796f 7520 7761 6e74  arm. If you want
+000236b0: 2074 6f20 7573 650a 6120 7665 7273 696f   to use.a versio
+000236c0: 6e20 6f66 2050 7974 686f 6e20 7468 6174  n of Python that
+000236d0: 2069 736e 2774 2069 6e73 7461 6c6c 6564   isn't installed
+000236e0: 2c20 6569 7468 6572 2075 7365 2079 6f75  , either use you
+000236f0: 7220 6661 766f 7572 6974 6520 7061 636b  r favourite pack
+00023700: 6167 6520 6d61 6e61 6765 722c 0a6f 7220  age manager,.or 
+00023710: 696e 7374 616c 6c20 5079 7468 6f6e 2062  install Python b
+00023720: 7920 646f 776e 6c6f 6164 696e 6720 616e  y downloading an
+00023730: 2069 6e73 7461 6c6c 6572 2066 6f72 2072   installer for r
+00023740: 6563 656e 7420 7665 7273 696f 6e73 206f  ecent versions o
+00023750: 6620 5079 7468 6f6e 2064 6972 6563 746c  f Python directl
+00023760: 790a 6672 6f6d 2074 6865 205b 5079 7468  y.from the [Pyth
+00023770: 6f6e 2077 6562 7369 7465 5d28 6874 7470  on website](http
+00023780: 733a 2f2f 7777 772e 7079 7468 6f6e 2e6f  s://www.python.o
+00023790: 7267 2f64 6f77 6e6c 6f61 6473 2f29 2e0a  rg/downloads/)..
+000237a0: 0a4f 6e63 6520 7072 6f6a 6563 7420 6465  .Once project de
+000237b0: 7065 6e64 656e 6369 6573 2068 6176 6520  pendencies have 
+000237c0: 6265 656e 2069 6e73 7461 6c6c 6564 2c20  been installed, 
+000237d0: 796f 7520 7368 6f75 6c64 2062 6520 6162  you should be ab
+000237e0: 6c65 2074 6f20 7275 6e20 7465 7374 730a  le to run tests.
+000237f0: 6672 6f6d 2077 6974 6869 6e20 5079 4368  from within PyCh
+00023800: 6172 6d20 2872 6967 6874 2d63 6c69 636b  arm (right-click
+00023810: 206f 6e20 7468 6520 6074 6573 7473 6020   on the `tests` 
+00023820: 666f 6c64 6572 2061 6e64 2073 656c 6563  folder and selec
+00023830: 7420 7468 6520 2752 756e 2720 6f70 7469  t the 'Run' opti
+00023840: 6f6e 292e 0a0a 4265 6361 7573 6520 6f66  on)...Because of
+00023850: 2061 2063 6f6e 666c 6963 7420 6265 7477   a conflict betw
+00023860: 6565 6e20 7079 7465 7374 2061 6e64 2050  een pytest and P
+00023870: 7943 6861 726d 2773 2064 6562 7567 6765  yCharm's debugge
+00023880: 7220 616e 6420 7468 6520 636f 7665 7261  r and the covera
+00023890: 6765 2074 6f6f 6c2c 0a79 6f75 206d 6179  ge tool,.you may
+000238a0: 206e 6565 6420 746f 2061 6464 2060 602d   need to add ``-
+000238b0: 2d6e 6f2d 636f 7660 6020 6173 2061 6e20  -no-cov`` as an 
+000238c0: 6f70 7469 6f6e 2074 6f20 7468 6520 7465  option to the te
+000238d0: 7374 2072 756e 6e65 7220 7465 6d70 6c61  st runner templa
+000238e0: 7465 2e20 416c 7465 726e 6174 6976 656c  te. Alternativel
+000238f0: 792c 0a6a 7573 7420 7573 6520 7468 6520  y,.just use the 
+00023900: 5079 7468 6f6e 2053 7461 6e64 6172 6420  Python Standard 
+00023910: 4c69 6272 6172 7927 7320 6060 756e 6974  Library's ``unit
+00023920: 7465 7374 6060 206d 6f64 756c 652e 0a0a  test`` module...
+00023930: 596f 7520 7368 6f75 6c64 2061 6c73 6f20  You should also 
+00023940: 6265 2061 626c 6520 746f 206f 7065 6e20  be able to open 
+00023950: 6120 7465 726d 696e 616c 2077 696e 646f  a terminal windo
+00023960: 7720 696e 2050 7943 6861 726d 2c20 616e  w in PyCharm, an
+00023970: 6420 7275 6e20 7468 6520 7072 6f6a 6563  d run the projec
+00023980: 7427 730a 4d61 6b65 6669 6c65 2063 6f6d  t's.Makefile com
+00023990: 6d61 6e64 7320 6672 6f6d 2074 6865 2063  mands from the c
+000239a0: 6f6d 6d61 6e64 206c 696e 6520 2873 6565  ommand line (see
+000239b0: 2062 656c 6f77 292e 0a0a 2323 2320 5365   below)...### Se
+000239c0: 7475 7020 6672 6f6d 2063 6f6d 6d61 6e64  tup from command
+000239d0: 206c 696e 653c 6120 6964 3d22 7365 7475   line<a id="setu
+000239e0: 702d 6672 6f6d 2d63 6f6d 6d61 6e64 2d6c  p-from-command-l
+000239f0: 696e 6522 3e3c 2f61 3e0a 0a4f 6274 6169  ine"></a>..Obtai
+00023a00: 6e20 7468 6520 7072 6f6a 6563 7420 6669  n the project fi
+00023a10: 6c65 732c 2075 7369 6e67 2047 6974 206f  les, using Git o
+00023a20: 7220 7375 6974 6162 6c65 2061 6c74 6572  r suitable alter
+00023a30: 6e61 7469 7665 2e0a 0a49 6e20 6120 7465  native...In a te
+00023a40: 726d 696e 616c 2061 7070 6c69 6361 7469  rminal applicati
+00023a50: 6f6e 2c20 6368 616e 6765 2079 6f75 7220  on, change your 
+00023a60: 6375 7272 656e 7420 776f 726b 696e 6720  current working 
+00023a70: 6469 7265 6374 6f72 790a 746f 2074 6865  directory.to the
+00023a80: 2072 6f6f 7420 666f 6c64 6572 206f 6620   root folder of 
+00023a90: 7468 6520 7072 6f6a 6563 7420 6669 6c65  the project file
+00023aa0: 732e 2054 6865 7265 2073 686f 756c 6420  s. There should 
+00023ab0: 6265 2061 204d 616b 6566 696c 650a 696e  be a Makefile.in
+00023ac0: 2074 6869 7320 666f 6c64 6572 2e0a 0a55   this folder...U
+00023ad0: 7365 2074 6865 204d 616b 6566 696c 6520  se the Makefile 
+00023ae0: 746f 2063 7265 6174 6520 6120 6e65 7720  to create a new 
+00023af0: 506f 6574 7279 2076 6972 7475 616c 2065  Poetry virtual e
+00023b00: 6e76 6972 6f6e 6d65 6e74 2066 6f72 2074  nvironment for t
+00023b10: 6865 0a70 726f 6a65 6374 2061 6e64 2069  he.project and i
+00023b20: 6e73 7461 6c6c 2074 6865 2070 726f 6a65  nstall the proje
+00023b30: 6374 2773 2070 6163 6b61 6765 2064 6570  ct's package dep
+00023b40: 656e 6465 6e63 6965 7320 696e 746f 2069  endencies into i
+00023b50: 742c 0a75 7369 6e67 2074 6865 2066 6f6c  t,.using the fol
+00023b60: 6c6f 7769 6e67 2063 6f6d 6d61 6e64 2e0a  lowing command..
+00023b70: 0a20 2020 2024 206d 616b 6520 696e 7374  .    $ make inst
+00023b80: 616c 6c2d 7061 636b 6167 6573 0a0a 4974  all-packages..It
+00023b90: 2773 2061 6c73 6f20 706f 7373 6962 6c65  's also possible
+00023ba0: 2074 6f20 616c 736f 2069 6e73 7461 6c6c   to also install
+00023bb0: 2074 6865 2070 726f 6a65 6374 2069 6e20   the project in 
+00023bc0: 2765 6469 7461 626c 6520 6d6f 6465 272e  'editable mode'.
+00023bd0: 0a0a 2020 2020 2420 6d61 6b65 2069 6e73  ..    $ make ins
+00023be0: 7461 6c6c 0a0a 506c 6561 7365 206e 6f74  tall..Please not
+00023bf0: 652c 2069 6620 796f 7520 6372 6561 7465  e, if you create
+00023c00: 2074 6865 2076 6972 7475 616c 2065 6e76   the virtual env
+00023c10: 6972 6f6e 6d65 6e74 2069 6e20 7468 6973  ironment in this
+00023c20: 2077 6179 2c20 616e 6420 7468 656e 2074   way, and then t
+00023c30: 7279 2074 6f0a 6f70 656e 2074 6865 2070  ry to.open the p
+00023c40: 726f 6a65 6374 2069 6e20 5079 4368 6172  roject in PyChar
+00023c50: 6d20 616e 6420 636f 6e66 6967 7572 6520  m and configure 
+00023c60: 7468 6520 7072 6f6a 6563 7420 746f 2075  the project to u
+00023c70: 7365 2074 6869 7320 7669 7274 7561 6c0a  se this virtual.
+00023c80: 656e 7669 726f 6e6d 656e 7420 6173 2061  environment as a
+00023c90: 6e20 2245 7869 7374 696e 6720 506f 6574  n "Existing Poet
+00023ca0: 7279 2045 6e76 6972 6f6e 6d65 6e74 222c  ry Environment",
+00023cb0: 2050 7943 6861 726d 2073 6f6d 6574 696d   PyCharm sometim
+00023cc0: 6573 2068 6173 2073 6f6d 650a 6973 7375  es has some.issu
+00023cd0: 6573 2028 646f 6e27 7420 6b6e 6f77 2077  es (don't know w
+00023ce0: 6879 2920 7768 6963 6820 6d69 6768 7420  hy) which might 
+00023cf0: 6265 2070 726f 626c 656d 6174 6963 2e20  be problematic. 
+00023d00: 4966 2079 6f75 2065 6e63 6f75 6e74 6572  If you encounter
+00023d10: 2073 7563 680a 6973 7375 6573 2c20 796f   such.issues, yo
+00023d20: 7520 6361 6e20 7265 736f 6c76 6520 7468  u can resolve th
+00023d30: 6573 6520 6973 7375 6573 2062 7920 6465  ese issues by de
+00023d40: 6c65 7469 6e67 2074 6865 2076 6972 7475  leting the virtu
+00023d50: 616c 2065 6e76 6972 6f6e 6d65 6e74 0a61  al environment.a
+00023d60: 6e64 2063 7265 6174 696e 6720 7468 6520  nd creating the 
+00023d70: 506f 6574 7279 2076 6972 7475 616c 2065  Poetry virtual e
+00023d80: 6e76 6972 6f6e 6d65 6e74 2075 7369 6e67  nvironment using
+00023d90: 2050 7943 6861 726d 2028 7365 6520 6162   PyCharm (see ab
+00023da0: 6f76 6529 2e0a 0a23 2323 2050 726f 6a65  ove)...### Proje
+00023db0: 6374 204d 616b 6566 696c 6520 636f 6d6d  ct Makefile comm
+00023dc0: 616e 6473 3c61 2069 643d 2270 726f 6a65  ands<a id="proje
+00023dd0: 6374 2d6d 616b 6566 696c 652d 636f 6d6d  ct-makefile-comm
+00023de0: 616e 6473 223e 3c2f 613e 0a0a 596f 7520  ands"></a>..You 
+00023df0: 6361 6e20 7374 6172 7420 4576 656e 7453  can start EventS
+00023e00: 746f 7265 4442 2075 7369 6e67 2074 6865  toreDB using the
+00023e10: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
+00023e20: 6e64 2e0a 0a20 2020 2024 206d 616b 6520  nd...    $ make 
+00023e30: 7374 6172 742d 6576 656e 7473 746f 7265  start-eventstore
+00023e40: 6462 0a0a 596f 7520 6361 6e20 7275 6e20  db..You can run 
+00023e50: 7465 7374 7320 7573 696e 6720 7468 6520  tests using the 
+00023e60: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
+00023e70: 6420 286e 6565 6473 2045 7665 6e74 5374  d (needs EventSt
+00023e80: 6f72 6544 4220 746f 2062 6520 7275 6e6e  oreDB to be runn
+00023e90: 696e 6729 2e0a 0a20 2020 2024 206d 616b  ing)...    $ mak
+00023ea0: 6520 7465 7374 0a0a 596f 7520 6361 6e20  e test..You can 
+00023eb0: 7374 6f70 2045 7665 6e74 5374 6f72 6544  stop EventStoreD
+00023ec0: 4220 7573 696e 6720 7468 6520 666f 6c6c  B using the foll
+00023ed0: 6f77 696e 6720 636f 6d6d 616e 642e 0a0a  owing command...
+00023ee0: 2020 2020 2420 6d61 6b65 2073 746f 702d      $ make stop-
+00023ef0: 6576 656e 7473 746f 7265 6462 0a0a 596f  eventstoredb..Yo
+00023f00: 7520 6361 6e20 6368 6563 6b20 7468 6520  u can check the 
+00023f10: 666f 726d 6174 7469 6e67 206f 6620 7468  formatting of th
+00023f20: 6520 636f 6465 2075 7369 6e67 2074 6865  e code using the
+00023f30: 2066 6f6c 6c6f 7769 6e67 2063 6f6d 6d61   following comma
+00023f40: 6e64 2e0a 0a20 2020 2024 206d 616b 6520  nd...    $ make 
+00023f50: 6c69 6e74 0a0a 596f 7520 6361 6e20 7265  lint..You can re
+00023f60: 666f 726d 6174 2074 6865 2063 6f64 6520  format the code 
+00023f70: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
+00023f80: 696e 6720 636f 6d6d 616e 642e 0a0a 2020  ing command...  
+00023f90: 2020 2420 6d61 6b65 2066 6d74 0a0a 5465    $ make fmt..Te
+00023fa0: 7374 7320 6265 6c6f 6e67 2069 6e20 602e  sts belong in `.
+00023fb0: 2f74 6573 7473 602e 2043 6f64 652d 756e  /tests`. Code-un
+00023fc0: 6465 722d 7465 7374 2062 656c 6f6e 6773  der-test belongs
+00023fd0: 2069 6e20 602e 2f65 7364 6263 6c69 656e   in `./esdbclien
+00023fe0: 7460 2e0a 0a45 6469 7420 7061 636b 6167  t`...Edit packag
+00023ff0: 6520 6465 7065 6e64 656e 6369 6573 2069  e dependencies i
+00024000: 6e20 6070 7970 726f 6a65 6374 2e74 6f6d  n `pyproject.tom
+00024010: 6c60 2e20 5570 6461 7465 2069 6e73 7461  l`. Update insta
+00024020: 6c6c 6564 2070 6163 6b61 6765 7320 2861  lled packages (a
+00024030: 6e64 2074 6865 0a60 706f 6574 7279 2e6c  nd the.`poetry.l
+00024040: 6f63 6b60 2066 696c 6529 2075 7369 6e67  ock` file) using
+00024050: 2074 6865 2066 6f6c 6c6f 7769 6e67 2063   the following c
+00024060: 6f6d 6d61 6e64 2e0a 0a20 2020 2024 206d  ommand...    $ m
+00024070: 616b 6520 7570 6461 7465 2d70 6163 6b61  ake update-packa
+00024080: 6765 730a 0a                             ges..
```

### Comparing `esdbclient-1.0b4/esdbclient/__init__.py` & `esdbclient-1.1b1/esdbclient/__init__.py`

 * *Files 19% similar despite different names*

```diff
@@ -2,22 +2,23 @@
 from esdbclient.asyncio_client import AsyncioEventStoreDBClient
 from esdbclient.client import (
     DEFAULT_EXCLUDE_FILTER,
     ESDB_PERSISTENT_CONFIG_EVENTS_REGEX,
     ESDB_SYSTEM_EVENTS_REGEX,
     EventStoreDBClient,
 )
-from esdbclient.events import Checkpoint, ContentType, NewEvent, RecordedEvent
+from esdbclient.events import CaughtUp, Checkpoint, ContentType, NewEvent, RecordedEvent
 from esdbclient.streams import StreamState
 
 __all__ = [
     "DEFAULT_EXCLUDE_FILTER",
     "ESDB_PERSISTENT_CONFIG_EVENTS_REGEX",
     "ESDB_SYSTEM_EVENTS_REGEX",
     "AsyncioEventStoreDBClient",
     "Checkpoint",
+    "CaughtUp",
     "ContentType",
     "EventStoreDBClient",
     "NewEvent",
     "RecordedEvent",
     "StreamState",
 ]
```

### Comparing `esdbclient-1.0b4/esdbclient/connection.py` & `esdbclient-1.1b1/esdbclient/connection.py`

 * *Files 24% similar despite different names*

```diff
@@ -1,75 +1,110 @@
 # -*- coding: utf-8 -*-
 
 import grpc.aio
 
+from esdbclient.common import AsyncGrpcStreamers, SyncGrpcStreamers
 from esdbclient.connection_spec import ConnectionSpec
-from esdbclient.gossip import (
-    AsyncioClusterGossipService,
-    AsyncioGossipService,
-    ClusterGossipService,
-    GossipService,
-)
+from esdbclient.gossip import AsyncioGossipService, GossipService
 from esdbclient.persistent import (
     AsyncioPersistentSubscriptionsService,
     PersistentSubscriptionsService,
 )
+from esdbclient.projections import AsyncioProjectionsService, ProjectionsService
 from esdbclient.streams import AsyncioStreamsService, StreamsService
 
 
 class ESDBConnection:
     def __init__(
         self,
         grpc_channel: grpc.Channel,
         grpc_target: str,
         connection_spec: ConnectionSpec,
     ) -> None:
-        self.grpc_channel = grpc_channel
-        self.grpc_target = grpc_target
-        self.streams = StreamsService(grpc_channel, connection_spec=connection_spec)
-        self.persistent_subscriptions = PersistentSubscriptionsService(
-            grpc_channel, connection_spec=connection_spec
-        )
-        self.gossip = GossipService(grpc_channel, connection_spec=connection_spec)
-        self.cluster_gossip = ClusterGossipService(
-            grpc_channel, connection_spec=connection_spec
+        self._grpc_channel = grpc_channel
+        self._grpc_target = grpc_target
+        self._grpc_streamers = SyncGrpcStreamers()
+        self.streams = StreamsService(
+            grpc_channel=grpc_channel,
+            connection_spec=connection_spec,
+            grpc_streamers=self._grpc_streamers,
         )
+        self.persistent_subscriptions = PersistentSubscriptionsService(
+            channel=grpc_channel,
+            connection_spec=connection_spec,
+            grpc_streamers=self._grpc_streamers,
+        )
+        self.gossip = GossipService(
+            channel=grpc_channel,
+            connection_spec=connection_spec,
+            grpc_streamers=self._grpc_streamers,
+        )
+        # self.cluster_gossip = ClusterGossipService(
+        #     channel=grpc_channel,
+        #     connection_spec=connection_spec,
+        #     grpc_streamers=self._grpc_streamers,
+        # )
         # self._channel_connectivity_state: Optional[ChannelConnectivity] = None
         # self.grpc_channel.subscribe(self._receive_channel_connectivity_state)
+        self.projections = ProjectionsService(
+            channel=grpc_channel,
+            connection_spec=connection_spec,
+            grpc_streamers=self._grpc_streamers,
+        )
+
+    @property
+    def grpc_target(self) -> str:
+        return self._grpc_target
 
     # def _receive_channel_connectivity_state(
     #     self, connectivity: ChannelConnectivity
     # ) -> None:
     #     self._channel_connectivity_state = connectivity
     #     # print("Channel connectivity state:", connectivity)
 
     def close(self) -> None:
+        self._grpc_streamers.close()
         # self.grpc_channel.unsubscribe(self._receive_channel_connectivity_state)
         # sleep(0.1)  # Allow connectivity polling to stop.
-        self.grpc_channel.close()
+        # print("closing channel")
+        self._grpc_channel.close()
+        # print("closed channel")
 
 
 class AsyncioESDBConnection:
     def __init__(
         self,
         grpc_channel: grpc.aio.Channel,
         grpc_target: str,
         connection_spec: ConnectionSpec,
     ) -> None:
-        self.grpc_channel = grpc_channel
-        self.grpc_target = grpc_target
-        self.connection_spec = connection_spec
+        self._grpc_channel = grpc_channel
+        self._grpc_target = grpc_target
+        self._grpc_streamers = AsyncGrpcStreamers()
         self.streams = AsyncioStreamsService(
-            grpc_channel, connection_spec=connection_spec
+            grpc_channel,
+            connection_spec=connection_spec,
+            grpc_streamers=self._grpc_streamers,
         )
         self.persistent_subscriptions = AsyncioPersistentSubscriptionsService(
-            grpc_channel, connection_spec=connection_spec
+            grpc_channel,
+            connection_spec=connection_spec,
+            grpc_streamers=self._grpc_streamers,
         )
         self.gossip = AsyncioGossipService(
-            grpc_channel, connection_spec=connection_spec
-        )
-        self.cluster_gossip = AsyncioClusterGossipService(
-            grpc_channel, connection_spec=connection_spec
+            grpc_channel,
+            connection_spec=connection_spec,
+            grpc_streamers=self._grpc_streamers,
+        )
+        self.projections = AsyncioProjectionsService(
+            grpc_channel,
+            connection_spec=connection_spec,
+            grpc_streamers=self._grpc_streamers,
         )
 
+    @property
+    def grpc_target(self) -> str:
+        return self._grpc_target
+
     async def close(self) -> None:
-        await self.grpc_channel.close(grace=5)
+        await self._grpc_streamers.close()
+        await self._grpc_channel.close(grace=5)
```

### Comparing `esdbclient-1.0b4/esdbclient/connection_spec.py` & `esdbclient-1.1b1/esdbclient/connection_spec.py`

 * *Files 13% similar despite different names*

```diff
@@ -261,29 +261,41 @@
         self._username = parse_result.username
         self._password = parse_result.password
         if "@" in self._netloc:
             _, _, targets = self._netloc.partition("@")
         else:
             targets = self._netloc
         self._targets = [t.strip() for t in targets.split(",") if t.strip()]
+
+        if len(self._targets) == 0:
+            raise ValueError(f"No targets specified: {uri}")
+        if self._scheme == URI_SCHEME_ESDB_DISCOVER:
+            if len(self._targets) > 1:
+                raise ValueError(f"More than one target specified: {uri}")
+
+        for i, target in enumerate(self._targets):
+            host, _, port = target.partition(":")
+            if port == "":
+                port = "2113"
+                self._targets[i] = f"{host}:{port}"
+
         self._options = ConnectionOptions(parse_result.query)
+        if self._options.Tls is True:
+            if not self._username or not self._password:
+                raise ValueError(f"Username and password are required: {uri}")
 
     @property
     def uri(self) -> str:
         return self._uri
 
     @property
     def scheme(self) -> str:
         return self._scheme
 
     @property
-    def netloc(self) -> str:
-        return self._netloc
-
-    @property
     def username(self) -> Optional[str]:
         return self._username
 
     @property
     def password(self) -> Optional[str]:
         return self._password
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/cluster_pb2.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/cluster_pb2.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 # -*- coding: utf-8 -*-
 # Generated by the protocol buffer compiler.  DO NOT EDIT!
 # source: esdbclient/protos/Grpc/cluster.proto
+# Protobuf Python Version: 4.25.1
 """Generated protocol buffer code."""
 from google.protobuf import (
     descriptor as _descriptor,
     descriptor_pool as _descriptor_pool,
     symbol_database as _symbol_database,
 )
 from google.protobuf.internal import builder as _builder
@@ -142,16 +143,18 @@
 
 _globals = globals()
 _builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, _globals)
 _builder.BuildTopDescriptorsAndMessages(
     DESCRIPTOR, "esdbclient.protos.Grpc.cluster_pb2", _globals
 )
 if _descriptor._USE_C_DESCRIPTORS == False:
-    DESCRIPTOR._options = None
-    DESCRIPTOR._serialized_options = b"\n%com.eventstore.dbclient.proto.cluster"
+    _globals["DESCRIPTOR"]._options = None
+    _globals["DESCRIPTOR"]._serialized_options = (
+        b"\n%com.eventstore.dbclient.proto.cluster"
+    )
     _globals["_GOSSIPREQUEST"]._serialized_start = 98
     _globals["_GOSSIPREQUEST"]._serialized_end = 208
     _globals["_VIEWCHANGEREQUEST"]._serialized_start = 211
     _globals["_VIEWCHANGEREQUEST"]._serialized_end = 351
     _globals["_VIEWCHANGEPROOFREQUEST"]._serialized_start = 354
     _globals["_VIEWCHANGEPROOFREQUEST"]._serialized_end = 499
     _globals["_PREPAREREQUEST"]._serialized_start = 501
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/cluster_pb2.pyi` & `esdbclient-1.1b1/esdbclient/protos/Grpc/cluster_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/cluster_pb2_grpc.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/cluster_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/code_pb2.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/code_pb2.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 # -*- coding: utf-8 -*-
 # Generated by the protocol buffer compiler.  DO NOT EDIT!
 # source: esdbclient/protos/Grpc/code.proto
+# Protobuf Python Version: 4.25.1
 """Generated protocol buffer code."""
 from google.protobuf import (
     descriptor as _descriptor,
     descriptor_pool as _descriptor_pool,
     symbol_database as _symbol_database,
 )
 from google.protobuf.internal import builder as _builder
@@ -20,12 +21,14 @@
 
 _globals = globals()
 _builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, _globals)
 _builder.BuildTopDescriptorsAndMessages(
     DESCRIPTOR, "esdbclient.protos.Grpc.code_pb2", _globals
 )
 if _descriptor._USE_C_DESCRIPTORS == False:
-    DESCRIPTOR._options = None
-    DESCRIPTOR._serialized_options = b"\n\016com.google.rpcB\tCodeProtoP\001Z3google.golang.org/genproto/googleapis/rpc/code;code\242\002\003RPC"
+    _globals["DESCRIPTOR"]._options = None
+    _globals["DESCRIPTOR"]._serialized_options = (
+        b"\n\016com.google.rpcB\tCodeProtoP\001Z3google.golang.org/genproto/googleapis/rpc/code;code\242\002\003RPC"
+    )
     _globals["_CODE"]._serialized_start = 54
     _globals["_CODE"]._serialized_end = 365
 # @@protoc_insertion_point(module_scope)
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/code_pb2.pyi` & `esdbclient-1.1b1/esdbclient/protos/Grpc/code_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/gossip_pb2.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/gossip_pb2.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 # -*- coding: utf-8 -*-
 # Generated by the protocol buffer compiler.  DO NOT EDIT!
 # source: esdbclient/protos/Grpc/gossip.proto
+# Protobuf Python Version: 4.25.1
 """Generated protocol buffer code."""
 from google.protobuf import (
     descriptor as _descriptor,
     descriptor_pool as _descriptor_pool,
     symbol_database as _symbol_database,
 )
 from google.protobuf.internal import builder as _builder
@@ -32,16 +33,18 @@
 
 _globals = globals()
 _builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, _globals)
 _builder.BuildTopDescriptorsAndMessages(
     DESCRIPTOR, "esdbclient.protos.Grpc.gossip_pb2", _globals
 )
 if _descriptor._USE_C_DESCRIPTORS == False:
-    DESCRIPTOR._options = None
-    DESCRIPTOR._serialized_options = b"\n$com.eventstore.dbclient.proto.gossip"
+    _globals["DESCRIPTOR"]._options = None
+    _globals["DESCRIPTOR"]._serialized_options = (
+        b"\n$com.eventstore.dbclient.proto.gossip"
+    )
     _globals["_CLUSTERINFO"]._serialized_start = 103
     _globals["_CLUSTERINFO"]._serialized_end = 172
     _globals["_ENDPOINT"]._serialized_start = 174
     _globals["_ENDPOINT"]._serialized_end = 215
     _globals["_MEMBERINFO"]._serialized_start = 218
     _globals["_MEMBERINFO"]._serialized_end = 726
     _globals["_MEMBERINFO_VNODESTATE"]._serialized_start = 444
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/gossip_pb2.pyi` & `esdbclient-1.1b1/esdbclient/protos/Grpc/gossip_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/gossip_pb2_grpc.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/gossip_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/persistent_pb2.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/persistent_pb2.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 # -*- coding: utf-8 -*-
 # Generated by the protocol buffer compiler.  DO NOT EDIT!
 # source: esdbclient/protos/Grpc/persistent.proto
+# Protobuf Python Version: 4.25.1
 """Generated protocol buffer code."""
 from google.protobuf import (
     descriptor as _descriptor,
     descriptor_pool as _descriptor_pool,
     symbol_database as _symbol_database,
 )
 from google.protobuf.internal import builder as _builder
@@ -188,36 +189,44 @@
 
 _globals = globals()
 _builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, _globals)
 _builder.BuildTopDescriptorsAndMessages(
     DESCRIPTOR, "esdbclient.protos.Grpc.persistent_pb2", _globals
 )
 if _descriptor._USE_C_DESCRIPTORS == False:
-    DESCRIPTOR._options = None
-    DESCRIPTOR._serialized_options = (
+    _globals["DESCRIPTOR"]._options = None
+    _globals["DESCRIPTOR"]._serialized_options = (
         b"\n5com.eventstore.dbclient.proto.persistentsubscriptions"
     )
-    _READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY._options = None
-    _READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY._serialized_options = b"8\001"
-    _CREATEREQ_OPTIONS.fields_by_name["stream_identifier"]._options = None
-    _CREATEREQ_OPTIONS.fields_by_name["stream_identifier"]._serialized_options = (
-        b"\030\001"
+    _globals["_READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY"]._options = None
+    _globals["_READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY"]._serialized_options = (
+        b"8\001"
     )
-    _CREATEREQ_SETTINGS.fields_by_name["revision"]._options = None
-    _CREATEREQ_SETTINGS.fields_by_name["revision"]._serialized_options = b"\030\001"
-    _CREATEREQ_SETTINGS.fields_by_name["named_consumer_strategy"]._options = None
-    _CREATEREQ_SETTINGS.fields_by_name[
+    _globals["_CREATEREQ_OPTIONS"].fields_by_name["stream_identifier"]._options = None
+    _globals["_CREATEREQ_OPTIONS"].fields_by_name[
+        "stream_identifier"
+    ]._serialized_options = b"\030\001"
+    _globals["_CREATEREQ_SETTINGS"].fields_by_name["revision"]._options = None
+    _globals["_CREATEREQ_SETTINGS"].fields_by_name[
+        "revision"
+    ]._serialized_options = b"\030\001"
+    _globals["_CREATEREQ_SETTINGS"].fields_by_name[
+        "named_consumer_strategy"
+    ]._options = None
+    _globals["_CREATEREQ_SETTINGS"].fields_by_name[
         "named_consumer_strategy"
     ]._serialized_options = b"\030\001"
-    _UPDATEREQ_OPTIONS.fields_by_name["stream_identifier"]._options = None
-    _UPDATEREQ_OPTIONS.fields_by_name["stream_identifier"]._serialized_options = (
-        b"\030\001"
-    )
-    _UPDATEREQ_SETTINGS.fields_by_name["revision"]._options = None
-    _UPDATEREQ_SETTINGS.fields_by_name["revision"]._serialized_options = b"\030\001"
+    _globals["_UPDATEREQ_OPTIONS"].fields_by_name["stream_identifier"]._options = None
+    _globals["_UPDATEREQ_OPTIONS"].fields_by_name[
+        "stream_identifier"
+    ]._serialized_options = b"\030\001"
+    _globals["_UPDATEREQ_SETTINGS"].fields_by_name["revision"]._options = None
+    _globals["_UPDATEREQ_SETTINGS"].fields_by_name[
+        "revision"
+    ]._serialized_options = b"\030\001"
     _globals["_READREQ"]._serialized_start = 126
     _globals["_READREQ"]._serialized_end = 1047
     _globals["_READREQ_OPTIONS"]._serialized_start = 367
     _globals["_READREQ_OPTIONS"]._serialized_end = 756
     _globals["_READREQ_OPTIONS_UUIDOPTION"]._serialized_start = 622
     _globals["_READREQ_OPTIONS_UUIDOPTION"]._serialized_end = 739
     _globals["_READREQ_ACK"]._serialized_start = 758
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/persistent_pb2.pyi` & `esdbclient-1.1b1/esdbclient/protos/Grpc/persistent_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/persistent_pb2_grpc.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/persistent_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/shared_pb2.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/shared_pb2.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 # -*- coding: utf-8 -*-
 # Generated by the protocol buffer compiler.  DO NOT EDIT!
 # source: esdbclient/protos/Grpc/shared.proto
+# Protobuf Python Version: 4.25.1
 """Generated protocol buffer code."""
 from google.protobuf import (
     descriptor as _descriptor,
     descriptor_pool as _descriptor_pool,
     symbol_database as _symbol_database,
 )
 from google.protobuf.internal import builder as _builder
@@ -39,16 +40,18 @@
 
 _globals = globals()
 _builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, _globals)
 _builder.BuildTopDescriptorsAndMessages(
     DESCRIPTOR, "esdbclient.protos.Grpc.shared_pb2", _globals
 )
 if _descriptor._USE_C_DESCRIPTORS == False:
-    DESCRIPTOR._options = None
-    DESCRIPTOR._serialized_options = b"\n$com.eventstore.dbclient.proto.shared"
+    _globals["DESCRIPTOR"]._options = None
+    _globals["DESCRIPTOR"]._serialized_options = (
+        b"\n$com.eventstore.dbclient.proto.shared"
+    )
     _globals["_UUID"]._serialized_start = 89
     _globals["_UUID"]._serialized_end = 258
     _globals["_UUID_STRUCTURED"]._serialized_start = 174
     _globals["_UUID_STRUCTURED"]._serialized_end = 249
     _globals["_EMPTY"]._serialized_start = 260
     _globals["_EMPTY"]._serialized_end = 267
     _globals["_STREAMIDENTIFIER"]._serialized_start = 269
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/shared_pb2.pyi` & `esdbclient-1.1b1/esdbclient/protos/Grpc/shared_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/status_pb2.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/status_pb2.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 # -*- coding: utf-8 -*-
 # Generated by the protocol buffer compiler.  DO NOT EDIT!
 # source: esdbclient/protos/Grpc/status.proto
+# Protobuf Python Version: 4.25.1
 """Generated protocol buffer code."""
 from google.protobuf import (
     descriptor as _descriptor,
     descriptor_pool as _descriptor_pool,
     symbol_database as _symbol_database,
 )
 from google.protobuf.internal import builder as _builder
@@ -29,12 +30,14 @@
 
 _globals = globals()
 _builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, _globals)
 _builder.BuildTopDescriptorsAndMessages(
     DESCRIPTOR, "esdbclient.protos.Grpc.status_pb2", _globals
 )
 if _descriptor._USE_C_DESCRIPTORS == False:
-    DESCRIPTOR._options = None
-    DESCRIPTOR._serialized_options = b"\n\016com.google.rpcB\013StatusProtoP\001Z7google.golang.org/genproto/googleapis/rpc/status;status\370\001\001\242\002\003RPC"
+    _globals["DESCRIPTOR"]._options = None
+    _globals["DESCRIPTOR"]._serialized_options = (
+        b"\n\016com.google.rpcB\013StatusProtoP\001Z7google.golang.org/genproto/googleapis/rpc/status;status\370\001\001\242\002\003RPC"
+    )
     _globals["_STATUS"]._serialized_start = 117
     _globals["_STATUS"]._serialized_end = 217
 # @@protoc_insertion_point(module_scope)
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/status_pb2.pyi` & `esdbclient-1.1b1/esdbclient/protos/Grpc/status_pb2.pyi`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/streams_pb2.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/streams_pb2.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 # -*- coding: utf-8 -*-
 # Generated by the protocol buffer compiler.  DO NOT EDIT!
 # source: esdbclient/protos/Grpc/streams.proto
+# Protobuf Python Version: 4.25.1
 """Generated protocol buffer code."""
 from google.protobuf import (
     descriptor as _descriptor,
     descriptor_pool as _descriptor_pool,
     symbol_database as _symbol_database,
 )
 from google.protobuf.internal import builder as _builder
@@ -52,22 +53,24 @@
     b" \x01(\rH\x01\x12*\n\x05\x63ount\x18\x04"
     b" \x01(\x0b\x32\x19.event_store.client.EmptyH\x01\x12$\n\x1c\x63heckpointIntervalMultiplier\x18\x05"
     b" \x01(\r\x1a+\n\nExpression\x12\r\n\x05regex\x18\x01"
     b" \x01(\t\x12\x0e\n\x06prefix\x18\x02"
     b" \x03(\tB\x08\n\x06\x66ilterB\x08\n\x06window\x1au\n\nUUIDOption\x12/\n\nstructured\x18\x01"
     b" \x01(\x0b\x32\x19.event_store.client.EmptyH\x00\x12+\n\x06string\x18\x02"
     b" \x01(\x0b\x32\x19.event_store.client.EmptyH\x00\x42\t\n\x07\x63ontent\x1a&\n\rControlOption\x12\x15\n\rcompatibility\x18\x01"
-    b' \x01(\r",\n\rReadDirection\x12\x0c\n\x08\x46orwards\x10\x00\x12\r\n\tBackwards\x10\x01\x42\x0f\n\rstream_optionB\x0e\n\x0c\x63ount_optionB\x0f\n\rfilter_option"\x95\n\n\x08ReadResp\x12?\n\x05\x65vent\x18\x01'
+    b' \x01(\r",\n\rReadDirection\x12\x0c\n\x08\x46orwards\x10\x00\x12\r\n\tBackwards\x10\x01\x42\x0f\n\rstream_optionB\x0e\n\x0c\x63ount_optionB\x0f\n\rfilter_option"\xbb\x0b\n\x08ReadResp\x12?\n\x05\x65vent\x18\x01'
     b" \x01(\x0b\x32..event_store.client.streams.ReadResp.ReadEventH\x00\x12U\n\x0c\x63onfirmation\x18\x02"
     b" \x01(\x0b\x32=.event_store.client.streams.ReadResp.SubscriptionConfirmationH\x00\x12\x45\n\ncheckpoint\x18\x03"
     b" \x01(\x0b\x32/.event_store.client.streams.ReadResp.CheckpointH\x00\x12O\n\x10stream_not_found\x18\x04"
     b" \x01(\x0b\x32\x33.event_store.client.streams.ReadResp.StreamNotFoundH\x00\x12\x1f\n\x15\x66irst_stream_position\x18\x05"
     b" \x01(\x04H\x00\x12\x1e\n\x14last_stream_position\x18\x06"
     b" \x01(\x04H\x00\x12I\n\x18last_all_stream_position\x18\x07"
-    b" \x01(\x0b\x32%.event_store.client.AllStreamPositionH\x00\x1a\xf8\x04\n\tReadEvent\x12K\n\x05\x65vent\x18\x01"
+    b" \x01(\x0b\x32%.event_store.client.AllStreamPositionH\x00\x12\x42\n\tcaught_up\x18\x08"
+    b" \x01(\x0b\x32-.event_store.client.streams.ReadResp.CaughtUpH\x00\x12\x46\n\x0b\x66\x65ll_behind\x18\t"
+    b" \x01(\x0b\x32/.event_store.client.streams.ReadResp.FellBehindH\x00\x1a\xf8\x04\n\tReadEvent\x12K\n\x05\x65vent\x18\x01"
     b" \x01(\x0b\x32<.event_store.client.streams.ReadResp.ReadEvent.RecordedEvent\x12J\n\x04link\x18\x02"
     b" \x01(\x0b\x32<.event_store.client.streams.ReadResp.ReadEvent.RecordedEvent\x12\x19\n\x0f\x63ommit_position\x18\x03"
     b" \x01(\x04H\x00\x12\x30\n\x0bno_position\x18\x04"
     b" \x01(\x0b\x32\x19.event_store.client.EmptyH\x00\x1a\xf8\x02\n\rRecordedEvent\x12$\n\x02id\x18\x01"
     b" \x01(\x0b\x32\x18.event_store.client.UUID\x12?\n\x11stream_identifier\x18\x02"
     b" \x01(\x0b\x32$.event_store.client.StreamIdentifier\x12\x17\n\x0fstream_revision\x18\x03"
     b" \x01(\x04\x12\x18\n\x10prepare_position\x18\x04"
@@ -76,15 +79,15 @@
     b" \x03(\x0b\x32J.event_store.client.streams.ReadResp.ReadEvent.RecordedEvent.MetadataEntry\x12\x17\n\x0f\x63ustom_metadata\x18\x07"
     b" \x01(\x0c\x12\x0c\n\x04\x64\x61ta\x18\x08"
     b" \x01(\x0c\x1a/\n\rMetadataEntry\x12\x0b\n\x03key\x18\x01"
     b" \x01(\t\x12\r\n\x05value\x18\x02"
     b" \x01(\t:\x02\x38\x01\x42\n\n\x08position\x1a\x33\n\x18SubscriptionConfirmation\x12\x17\n\x0fsubscription_id\x18\x01"
     b" \x01(\t\x1a?\n\nCheckpoint\x12\x17\n\x0f\x63ommit_position\x18\x01"
     b" \x01(\x04\x12\x18\n\x10prepare_position\x18\x02"
-    b" \x01(\x04\x1aQ\n\x0eStreamNotFound\x12?\n\x11stream_identifier\x18\x01"
+    b" \x01(\x04\x1a\n\n\x08\x43\x61ughtUp\x1a\x0c\n\nFellBehind\x1aQ\n\x0eStreamNotFound\x12?\n\x11stream_identifier\x18\x01"
     b' \x01(\x0b\x32$.event_store.client.StreamIdentifierB\t\n\x07\x63ontent"\x9f\x05\n\tAppendReq\x12@\n\x07options\x18\x01'
     b" \x01(\x0b\x32-.event_store.client.streams.AppendReq.OptionsH\x00\x12Q\n\x10proposed_message\x18\x02"
     b" \x01(\x0b\x32\x35.event_store.client.streams.AppendReq.ProposedMessageH\x00\x1a\x88\x02\n\x07Options\x12?\n\x11stream_identifier\x18\x01"
     b" \x01(\x0b\x32$.event_store.client.StreamIdentifier\x12\x12\n\x08revision\x18\x02"
     b" \x01(\x04H\x00\x12.\n\tno_stream\x18\x03"
     b" \x01(\x0b\x32\x19.event_store.client.EmptyH\x00\x12(\n\x03\x61ny\x18\x04"
     b" \x01(\x0b\x32\x19.event_store.client.EmptyH\x00\x12\x32\n\rstream_exists\x18\x05"
@@ -168,22 +171,28 @@
 
 _globals = globals()
 _builder.BuildMessageAndEnumDescriptors(DESCRIPTOR, _globals)
 _builder.BuildTopDescriptorsAndMessages(
     DESCRIPTOR, "esdbclient.protos.Grpc.streams_pb2", _globals
 )
 if _descriptor._USE_C_DESCRIPTORS == False:
-    DESCRIPTOR._options = None
-    DESCRIPTOR._serialized_options = b"\n%com.eventstore.dbclient.proto.streams"
-    _READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY._options = None
-    _READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY._serialized_options = b"8\001"
-    _APPENDREQ_PROPOSEDMESSAGE_METADATAENTRY._options = None
-    _APPENDREQ_PROPOSEDMESSAGE_METADATAENTRY._serialized_options = b"8\001"
-    _BATCHAPPENDREQ_PROPOSEDMESSAGE_METADATAENTRY._options = None
-    _BATCHAPPENDREQ_PROPOSEDMESSAGE_METADATAENTRY._serialized_options = b"8\001"
+    _globals["DESCRIPTOR"]._options = None
+    _globals["DESCRIPTOR"]._serialized_options = (
+        b"\n%com.eventstore.dbclient.proto.streams"
+    )
+    _globals["_READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY"]._options = None
+    _globals["_READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY"]._serialized_options = (
+        b"8\001"
+    )
+    _globals["_APPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._options = None
+    _globals["_APPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_options = b"8\001"
+    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._options = None
+    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_options = (
+        b"8\001"
+    )
     _globals["_READREQ"]._serialized_start = 237
     _globals["_READREQ"]._serialized_end = 2074
     _globals["_READREQ_OPTIONS"]._serialized_start = 311
     _globals["_READREQ_OPTIONS"]._serialized_end = 2074
     _globals["_READREQ_OPTIONS_STREAMOPTIONS"]._serialized_start = 968
     _globals["_READREQ_OPTIONS_STREAMOPTIONS"]._serialized_end = 1173
     _globals["_READREQ_OPTIONS_ALLOPTIONS"]._serialized_start = 1176
@@ -199,67 +208,71 @@
     _globals["_READREQ_OPTIONS_UUIDOPTION"]._serialized_start = 1821
     _globals["_READREQ_OPTIONS_UUIDOPTION"]._serialized_end = 1938
     _globals["_READREQ_OPTIONS_CONTROLOPTION"]._serialized_start = 1940
     _globals["_READREQ_OPTIONS_CONTROLOPTION"]._serialized_end = 1978
     _globals["_READREQ_OPTIONS_READDIRECTION"]._serialized_start = 1980
     _globals["_READREQ_OPTIONS_READDIRECTION"]._serialized_end = 2024
     _globals["_READRESP"]._serialized_start = 2077
-    _globals["_READRESP"]._serialized_end = 3378
-    _globals["_READRESP_READEVENT"]._serialized_start = 2534
-    _globals["_READRESP_READEVENT"]._serialized_end = 3166
-    _globals["_READRESP_READEVENT_RECORDEDEVENT"]._serialized_start = 2778
-    _globals["_READRESP_READEVENT_RECORDEDEVENT"]._serialized_end = 3154
-    _globals["_READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY"]._serialized_start = 3107
-    _globals["_READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY"]._serialized_end = 3154
-    _globals["_READRESP_SUBSCRIPTIONCONFIRMATION"]._serialized_start = 3168
-    _globals["_READRESP_SUBSCRIPTIONCONFIRMATION"]._serialized_end = 3219
-    _globals["_READRESP_CHECKPOINT"]._serialized_start = 3221
-    _globals["_READRESP_CHECKPOINT"]._serialized_end = 3284
-    _globals["_READRESP_STREAMNOTFOUND"]._serialized_start = 3286
-    _globals["_READRESP_STREAMNOTFOUND"]._serialized_end = 3367
-    _globals["_APPENDREQ"]._serialized_start = 3381
-    _globals["_APPENDREQ"]._serialized_end = 4052
-    _globals["_APPENDREQ_OPTIONS"]._serialized_start = 3544
-    _globals["_APPENDREQ_OPTIONS"]._serialized_end = 3808
-    _globals["_APPENDREQ_PROPOSEDMESSAGE"]._serialized_start = 3811
-    _globals["_APPENDREQ_PROPOSEDMESSAGE"]._serialized_end = 4041
-    _globals["_APPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_start = 3107
-    _globals["_APPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_end = 3154
-    _globals["_APPENDRESP"]._serialized_start = 4055
-    _globals["_APPENDRESP"]._serialized_end = 5220
+    _globals["_READRESP"]._serialized_end = 3544
+    _globals["_READRESP_READEVENT"]._serialized_start = 2674
+    _globals["_READRESP_READEVENT"]._serialized_end = 3306
+    _globals["_READRESP_READEVENT_RECORDEDEVENT"]._serialized_start = 2918
+    _globals["_READRESP_READEVENT_RECORDEDEVENT"]._serialized_end = 3294
+    _globals["_READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY"]._serialized_start = 3247
+    _globals["_READRESP_READEVENT_RECORDEDEVENT_METADATAENTRY"]._serialized_end = 3294
+    _globals["_READRESP_SUBSCRIPTIONCONFIRMATION"]._serialized_start = 3308
+    _globals["_READRESP_SUBSCRIPTIONCONFIRMATION"]._serialized_end = 3359
+    _globals["_READRESP_CHECKPOINT"]._serialized_start = 3361
+    _globals["_READRESP_CHECKPOINT"]._serialized_end = 3424
+    _globals["_READRESP_CAUGHTUP"]._serialized_start = 3426
+    _globals["_READRESP_CAUGHTUP"]._serialized_end = 3436
+    _globals["_READRESP_FELLBEHIND"]._serialized_start = 3438
+    _globals["_READRESP_FELLBEHIND"]._serialized_end = 3450
+    _globals["_READRESP_STREAMNOTFOUND"]._serialized_start = 3452
+    _globals["_READRESP_STREAMNOTFOUND"]._serialized_end = 3533
+    _globals["_APPENDREQ"]._serialized_start = 3547
+    _globals["_APPENDREQ"]._serialized_end = 4218
+    _globals["_APPENDREQ_OPTIONS"]._serialized_start = 3710
+    _globals["_APPENDREQ_OPTIONS"]._serialized_end = 3974
+    _globals["_APPENDREQ_PROPOSEDMESSAGE"]._serialized_start = 3977
+    _globals["_APPENDREQ_PROPOSEDMESSAGE"]._serialized_end = 4207
+    _globals["_APPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_start = 3247
+    _globals["_APPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_end = 3294
+    _globals["_APPENDRESP"]._serialized_start = 4221
+    _globals["_APPENDRESP"]._serialized_end = 5386
     _globals["_APPENDRESP_POSITION"]._serialized_start = 1387
     _globals["_APPENDRESP_POSITION"]._serialized_end = 1448
-    _globals["_APPENDRESP_SUCCESS"]._serialized_start = 4295
-    _globals["_APPENDRESP_SUCCESS"]._serialized_end = 4545
-    _globals["_APPENDRESP_WRONGEXPECTEDVERSION"]._serialized_start = 4548
-    _globals["_APPENDRESP_WRONGEXPECTEDVERSION"]._serialized_end = 5210
-    _globals["_BATCHAPPENDREQ"]._serialized_start = 5223
-    _globals["_BATCHAPPENDREQ"]._serialized_end = 6088
-    _globals["_BATCHAPPENDREQ_OPTIONS"]._serialized_start = 5466
-    _globals["_BATCHAPPENDREQ_OPTIONS"]._serialized_end = 5850
-    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE"]._serialized_start = 5853
-    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE"]._serialized_end = 6088
-    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_start = 3107
-    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_end = 3154
-    _globals["_BATCHAPPENDRESP"]._serialized_start = 6091
-    _globals["_BATCHAPPENDRESP"]._serialized_end = 6771
-    _globals["_BATCHAPPENDRESP_SUCCESS"]._serialized_start = 6499
-    _globals["_BATCHAPPENDRESP_SUCCESS"]._serialized_end = 6733
-    _globals["_DELETEREQ"]._serialized_start = 6774
-    _globals["_DELETEREQ"]._serialized_end = 7116
-    _globals["_DELETEREQ_OPTIONS"]._serialized_start = 3544
-    _globals["_DELETEREQ_OPTIONS"]._serialized_end = 3808
-    _globals["_DELETERESP"]._serialized_start = 7119
-    _globals["_DELETERESP"]._serialized_end = 7332
+    _globals["_APPENDRESP_SUCCESS"]._serialized_start = 4461
+    _globals["_APPENDRESP_SUCCESS"]._serialized_end = 4711
+    _globals["_APPENDRESP_WRONGEXPECTEDVERSION"]._serialized_start = 4714
+    _globals["_APPENDRESP_WRONGEXPECTEDVERSION"]._serialized_end = 5376
+    _globals["_BATCHAPPENDREQ"]._serialized_start = 5389
+    _globals["_BATCHAPPENDREQ"]._serialized_end = 6254
+    _globals["_BATCHAPPENDREQ_OPTIONS"]._serialized_start = 5632
+    _globals["_BATCHAPPENDREQ_OPTIONS"]._serialized_end = 6016
+    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE"]._serialized_start = 6019
+    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE"]._serialized_end = 6254
+    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_start = 3247
+    _globals["_BATCHAPPENDREQ_PROPOSEDMESSAGE_METADATAENTRY"]._serialized_end = 3294
+    _globals["_BATCHAPPENDRESP"]._serialized_start = 6257
+    _globals["_BATCHAPPENDRESP"]._serialized_end = 6937
+    _globals["_BATCHAPPENDRESP_SUCCESS"]._serialized_start = 6665
+    _globals["_BATCHAPPENDRESP_SUCCESS"]._serialized_end = 6899
+    _globals["_DELETEREQ"]._serialized_start = 6940
+    _globals["_DELETEREQ"]._serialized_end = 7282
+    _globals["_DELETEREQ_OPTIONS"]._serialized_start = 3710
+    _globals["_DELETEREQ_OPTIONS"]._serialized_end = 3974
+    _globals["_DELETERESP"]._serialized_start = 7285
+    _globals["_DELETERESP"]._serialized_end = 7498
     _globals["_DELETERESP_POSITION"]._serialized_start = 1387
     _globals["_DELETERESP_POSITION"]._serialized_end = 1448
-    _globals["_TOMBSTONEREQ"]._serialized_start = 7335
-    _globals["_TOMBSTONEREQ"]._serialized_end = 7683
-    _globals["_TOMBSTONEREQ_OPTIONS"]._serialized_start = 3544
-    _globals["_TOMBSTONEREQ_OPTIONS"]._serialized_end = 3808
-    _globals["_TOMBSTONERESP"]._serialized_start = 7686
-    _globals["_TOMBSTONERESP"]._serialized_end = 7905
+    _globals["_TOMBSTONEREQ"]._serialized_start = 7501
+    _globals["_TOMBSTONEREQ"]._serialized_end = 7849
+    _globals["_TOMBSTONEREQ_OPTIONS"]._serialized_start = 3710
+    _globals["_TOMBSTONEREQ_OPTIONS"]._serialized_end = 3974
+    _globals["_TOMBSTONERESP"]._serialized_start = 7852
+    _globals["_TOMBSTONERESP"]._serialized_end = 8071
     _globals["_TOMBSTONERESP_POSITION"]._serialized_start = 1387
     _globals["_TOMBSTONERESP_POSITION"]._serialized_end = 1448
-    _globals["_STREAMS"]._serialized_start = 7908
-    _globals["_STREAMS"]._serialized_end = 8388
+    _globals["_STREAMS"]._serialized_start = 8074
+    _globals["_STREAMS"]._serialized_end = 8554
 # @@protoc_insertion_point(module_scope)
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/streams_pb2.pyi` & `esdbclient-1.1b1/esdbclient/protos/Grpc/streams_pb2.pyi`

 * *Files 1% similar despite different names*

```diff
@@ -686,14 +686,30 @@
                 b"commit_position",
                 "prepare_position",
                 b"prepare_position",
             ],
         ) -> None: ...
 
     @typing_extensions.final
+    class CaughtUp(google.protobuf.message.Message):
+        DESCRIPTOR: google.protobuf.descriptor.Descriptor
+
+        def __init__(
+            self,
+        ) -> None: ...
+
+    @typing_extensions.final
+    class FellBehind(google.protobuf.message.Message):
+        DESCRIPTOR: google.protobuf.descriptor.Descriptor
+
+        def __init__(
+            self,
+        ) -> None: ...
+
+    @typing_extensions.final
     class StreamNotFound(google.protobuf.message.Message):
         DESCRIPTOR: google.protobuf.descriptor.Descriptor
 
         STREAM_IDENTIFIER_FIELD_NUMBER: builtins.int
         @property
         def stream_identifier(
             self,
@@ -720,72 +736,88 @@
     EVENT_FIELD_NUMBER: builtins.int
     CONFIRMATION_FIELD_NUMBER: builtins.int
     CHECKPOINT_FIELD_NUMBER: builtins.int
     STREAM_NOT_FOUND_FIELD_NUMBER: builtins.int
     FIRST_STREAM_POSITION_FIELD_NUMBER: builtins.int
     LAST_STREAM_POSITION_FIELD_NUMBER: builtins.int
     LAST_ALL_STREAM_POSITION_FIELD_NUMBER: builtins.int
+    CAUGHT_UP_FIELD_NUMBER: builtins.int
+    FELL_BEHIND_FIELD_NUMBER: builtins.int
     @property
     def event(self) -> global___ReadResp.ReadEvent: ...
     @property
     def confirmation(self) -> global___ReadResp.SubscriptionConfirmation: ...
     @property
     def checkpoint(self) -> global___ReadResp.Checkpoint: ...
     @property
     def stream_not_found(self) -> global___ReadResp.StreamNotFound: ...
     first_stream_position: builtins.int
     last_stream_position: builtins.int
     @property
     def last_all_stream_position(
         self,
     ) -> esdbclient.protos.Grpc.shared_pb2.AllStreamPosition: ...
+    @property
+    def caught_up(self) -> global___ReadResp.CaughtUp: ...
+    @property
+    def fell_behind(self) -> global___ReadResp.FellBehind: ...
     def __init__(
         self,
         *,
         event: global___ReadResp.ReadEvent | None = ...,
         confirmation: global___ReadResp.SubscriptionConfirmation | None = ...,
         checkpoint: global___ReadResp.Checkpoint | None = ...,
         stream_not_found: global___ReadResp.StreamNotFound | None = ...,
         first_stream_position: builtins.int = ...,
         last_stream_position: builtins.int = ...,
         last_all_stream_position: esdbclient.protos.Grpc.shared_pb2.AllStreamPosition
         | None = ...,
+        caught_up: global___ReadResp.CaughtUp | None = ...,
+        fell_behind: global___ReadResp.FellBehind | None = ...,
     ) -> None: ...
     def HasField(
         self,
         field_name: typing_extensions.Literal[
+            "caught_up",
+            b"caught_up",
             "checkpoint",
             b"checkpoint",
             "confirmation",
             b"confirmation",
             "content",
             b"content",
             "event",
             b"event",
+            "fell_behind",
+            b"fell_behind",
             "first_stream_position",
             b"first_stream_position",
             "last_all_stream_position",
             b"last_all_stream_position",
             "last_stream_position",
             b"last_stream_position",
             "stream_not_found",
             b"stream_not_found",
         ],
     ) -> builtins.bool: ...
     def ClearField(
         self,
         field_name: typing_extensions.Literal[
+            "caught_up",
+            b"caught_up",
             "checkpoint",
             b"checkpoint",
             "confirmation",
             b"confirmation",
             "content",
             b"content",
             "event",
             b"event",
+            "fell_behind",
+            b"fell_behind",
             "first_stream_position",
             b"first_stream_position",
             "last_all_stream_position",
             b"last_all_stream_position",
             "last_stream_position",
             b"last_stream_position",
             "stream_not_found",
@@ -799,14 +831,16 @@
             "event",
             "confirmation",
             "checkpoint",
             "stream_not_found",
             "first_stream_position",
             "last_stream_position",
             "last_all_stream_position",
+            "caught_up",
+            "fell_behind",
         ]
         | None
     ): ...
 
 global___ReadResp = ReadResp
 
 @typing_extensions.final
```

### Comparing `esdbclient-1.0b4/esdbclient/protos/Grpc/streams_pb2_grpc.py` & `esdbclient-1.1b1/esdbclient/protos/Grpc/streams_pb2_grpc.py`

 * *Files identical despite different names*

### Comparing `esdbclient-1.0b4/esdbclient/streams.py` & `esdbclient-1.1b1/esdbclient/streams.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,14 +1,18 @@
 # -*- coding: utf-8 -*-
+from __future__ import annotations
+
+import math
 import sys
 from abc import abstractmethod
 from asyncio import CancelledError
 from dataclasses import dataclass
 from enum import Enum
 from typing import (
+    Any,
     AsyncIterator,
     Iterable,
     Iterator,
     Optional,
     Sequence,
     Union,
     overload,
@@ -16,319 +20,418 @@
 from uuid import UUID, uuid4
 
 import grpc
 import grpc.aio
 from google.protobuf import duration_pb2, empty_pb2
 from typing_extensions import Literal, Protocol, runtime_checkable
 
-from esdbclient.connection_spec import ConnectionSpec
-from esdbclient.esdbapibase import (
-    DEFAULT_BATCH_APPEND_REQUEST_DEADLINE,
+from esdbclient.common import (
     DEFAULT_CHECKPOINT_INTERVAL_MULTIPLIER,
     DEFAULT_WINDOW_SIZE,
+    PROTOBUF_MAX_DEADLINE_SECONDS,
+    AsyncGrpcStreamer,
+    AsyncGrpcStreamers,
     ESDBService,
     Metadata,
+    SyncGrpcStreamer,
+    SyncGrpcStreamers,
+    TGrpcStreamers,
+    construct_filter_exclude_regex,
+    construct_filter_include_regex,
+    construct_recorded_event,
     handle_rpc_error,
 )
-from esdbclient.events import Checkpoint, NewEvent, RecordedEvent
+from esdbclient.connection_spec import ConnectionSpec
+from esdbclient.events import CaughtUp, Checkpoint, NewEvent, RecordedEvent
 from esdbclient.exceptions import (
     AccessDeniedError,
+    AppendDeadlineExceeded,
     BadRequestError,
     CancelledByClient,
     EventStoreDBClientException,
     InvalidTransactionError,
     MaximumAppendSizeExceededError,
     NotFound,
     StreamIsDeleted,
     SubscriptionConfirmationError,
-    TimeoutError,
     UnknownError,
     WrongCurrentVersion,
 )
 from esdbclient.protos.Grpc import shared_pb2, status_pb2, streams_pb2, streams_pb2_grpc
 
 
 @runtime_checkable
 class _ReadResps(Iterator[streams_pb2.ReadResp], Protocol):
     @abstractmethod
     def cancel(self) -> None:
         ...  # pragma: no cover
 
 
+# @runtime_checkable
+# class _BatchAppendResps(Iterator[streams_pb2.BatchAppendResp], Protocol):
+#     @abstractmethod
+#     def cancel(self) -> None:
+#         ...  # pragma: no cover
+#
+#
 class StreamState(Enum):
     ANY = "ANY"
     NO_STREAM = "NO_STREAM"
     EXISTS = "EXISTS"
 
 
 class BaseReadResponse:
     def __init__(
         self,
         stream_name: Optional[str],
     ):
-        self.stream_name = stream_name
+        self._stream_name = stream_name
+        self._include_checkpoints = False
+        self._include_caught_up = False
 
-    def handle_stream_read_rpc_error(
+    def _handle_stream_read_rpc_error(
         self, e: grpc.RpcError
     ) -> EventStoreDBClientException:
         if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
             details = e.details() or ""
-            if self.stream_name and details and "is deleted" in details:
+            if self._stream_name and details and "is deleted" in details:
                 return StreamIsDeleted()
             else:  # pragma: no cover
                 return handle_rpc_error(e)
         else:
             return handle_rpc_error(e)
 
     def _convert_read_resp(
         self, read_resp: streams_pb2.ReadResp
     ) -> Optional[RecordedEvent]:
         content_oneof = read_resp.WhichOneof("content")
         if content_oneof == "stream_not_found":
-            raise NotFound(f"Stream {self.stream_name!r} not found")
+            raise NotFound(f"Stream {self._stream_name!r} not found")
         elif content_oneof == "event":
-            read_event = read_resp.event
-            assert isinstance(read_event, streams_pb2.ReadResp.ReadEvent)
-            recorded_event = read_event.event
-            assert isinstance(
-                recorded_event, streams_pb2.ReadResp.ReadEvent.RecordedEvent
-            )
-            # There's also read_event.link...
-            # print("Link:", read_event.link)
-            position_oneof = read_event.WhichOneof("position")
-            if position_oneof == "commit_position":
-                commit_position = read_event.commit_position
-            else:  # pragma: no cover
-                # We only get here with EventStoreDB < 22.10.
-                assert position_oneof == "no_position", position_oneof
-                commit_position = None
-
-            # print("Recorded event commit position:", commit_position)
-            return RecordedEvent(
-                id=UUID(read_event.event.id.string),
-                type=recorded_event.metadata["type"],
-                data=recorded_event.data,
-                content_type=recorded_event.metadata["content-type"],
-                metadata=recorded_event.custom_metadata,
-                stream_name=recorded_event.stream_identifier.stream_name.decode("utf8"),
-                stream_position=recorded_event.stream_revision,
-                commit_position=commit_position,
-            )
+            return construct_recorded_event(read_resp.event)
         elif content_oneof == "checkpoint":
             checkpoint = read_resp.checkpoint
-            # print("Checkpoint commit position:", checkpoint.commit_position)
             return Checkpoint(
                 commit_position=checkpoint.commit_position,
             )
+        elif content_oneof == "caught_up":  # pragma: no cover
+            return CaughtUp()
+        # elif content_oneof == "fell_behind":  # pragma: no cover
+        #     return FellBehind()
         else:  # pragma: no cover
             return None
             # Todo: Maybe support other content_oneof values:
             # 		uint64 first_stream_position = 5;
             # 		uint64 last_stream_position = 6;
             # 		AllStreamPosition last_all_stream_position = 7;
             #
             # Todo: Not sure how to request to get first_stream_position,
             #   last_stream_position, first_all_stream_position.
 
+    def _filter_recorded_event(
+        self, recorded_event: Optional[RecordedEvent]
+    ) -> Optional[RecordedEvent]:
+        recorded_event_type = type(recorded_event)
+        if (
+            (recorded_event_type is RecordedEvent)
+            or (self._include_checkpoints and recorded_event_type is Checkpoint)
+            or (self._include_caught_up and (recorded_event_type is CaughtUp))
+        ):
+            return recorded_event
+        return None
+
 
-class AsyncioReadResponse(AsyncIterator[RecordedEvent], BaseReadResponse):
+class AsyncioReadResponse(
+    BaseReadResponse, AsyncGrpcStreamer, AsyncIterator[RecordedEvent]
+):
     def __init__(
         self,
         aio_call: grpc.aio.UnaryStreamCall[streams_pb2.ReadReq, streams_pb2.ReadResp],
         stream_name: Optional[str],
+        grpc_streamers: AsyncGrpcStreamers,
     ):
         super().__init__(stream_name=stream_name)
+        self._is_stopped = False
         self.aio_call = aio_call
         self.read_resp_iter = aio_call.__aiter__()
+        self._grpc_streamers = grpc_streamers
+        self._grpc_streamers[id(self)] = self
 
     def __aiter__(self) -> AsyncIterator[RecordedEvent]:
         return self
 
     async def __anext__(self) -> RecordedEvent:
         while True:
             try:
-                read_resp = await self._get_next_read_resp()
-            except CancelledByClient as e:
-                raise StopAsyncIteration() from e
-            else:
-                recorded_event = self._convert_read_resp(read_resp)
-                if recorded_event is not None:
-                    return recorded_event
-                else:  # pragma: no cover
-                    pass
+                try:
+                    read_resp = await self._get_next_read_resp()
+                except CancelledByClient:
+                    raise StopAsyncIteration() from None
+                else:
+                    recorded_event = self._filter_recorded_event(
+                        self._convert_read_resp(read_resp)
+                    )
+                    if recorded_event is not None:
+                        return recorded_event
+            except Exception:
+                await self.stop()
+                raise
 
     async def _get_next_read_resp(self) -> streams_pb2.ReadResp:
         try:
             read_resp = await self.read_resp_iter.__anext__()
         except grpc.RpcError as e:
-            raise self.handle_stream_read_rpc_error(e) from e
-        except CancelledError as e:
-            raise CancelledByClient() from e
+            raise self._handle_stream_read_rpc_error(e) from None
+        except CancelledError:
+            raise CancelledByClient() from None
         else:
             assert isinstance(read_resp, streams_pb2.ReadResp)
             return read_resp
 
-    def stop(self) -> None:
-        self.aio_call.cancel()
+    async def stop(self) -> None:
+        if not self._is_stopped:
+            self.aio_call.cancel()
+            try:
+                self._grpc_streamers.pop(id(self))
+            except KeyError:  # pragma: no cover
+                pass
+            self._is_stopped = True
+
+    async def __aenter__(self) -> "AsyncioReadResponse":
+        return self
+
+    async def __aexit__(self, *args: Any, **kwargs: Any) -> None:
+        await self.stop()
 
 
 class AsyncioCatchupSubscription(AsyncioReadResponse):
     def __init__(
         self,
         aio_call: grpc.aio.UnaryStreamCall[streams_pb2.ReadReq, streams_pb2.ReadResp],
         stream_name: Optional[str],
+        grpc_streamers: AsyncGrpcStreamers,
         include_checkpoints: bool = False,
+        include_caught_up: bool = False,
     ):
-        super().__init__(aio_call=aio_call, stream_name=stream_name)
-        self.include_checkpoints = include_checkpoints
+        super().__init__(
+            aio_call=aio_call, stream_name=stream_name, grpc_streamers=grpc_streamers
+        )
+        self._include_checkpoints = include_checkpoints
+        self._include_caught_up = include_caught_up
 
     async def check_confirmation(self) -> None:
         read_resp = await self._get_next_read_resp()
         content_oneof = read_resp.WhichOneof("content")
         if content_oneof != "confirmation":  # pragma: no cover
             raise SubscriptionConfirmationError(
                 f"Expected subscription confirmation, got: {read_resp}"
             )
 
-    async def __anext__(self) -> RecordedEvent:
-        while True:
-            recorded_event = await super().__anext__()
-            if self.include_checkpoints or not isinstance(recorded_event, Checkpoint):
-                return recorded_event
+    async def __aenter__(self) -> "AsyncioCatchupSubscription":
+        return self
 
 
-class ReadResponse(Iterator[RecordedEvent], BaseReadResponse):
+class ReadResponse(Iterator[RecordedEvent], BaseReadResponse, SyncGrpcStreamer):
     def __init__(
         self,
         read_resps: _ReadResps,
         stream_name: Optional[str],
+        grpc_streamers: SyncGrpcStreamers,
     ):
         super().__init__(stream_name=stream_name)
-        self.read_resps = read_resps
+        self._is_stopped = False
+        self._read_resps = read_resps
+        self._grpc_streamers = grpc_streamers
+        self._grpc_streamers[id(self)] = self
 
     def __iter__(self) -> "ReadResponse":
         return self
 
     def __next__(self) -> RecordedEvent:
         while True:
             try:
-                read_resp = self._get_next_read_resp()
-            except CancelledByClient as e:
-                raise StopIteration() from e
-            else:
-                recorded_event = self._convert_read_resp(read_resp)
-                if recorded_event is not None:
-                    return recorded_event
-                else:  # pragma: no cover
-                    pass
+                try:
+                    read_resp = self._get_next_read_resp()
+                except CancelledByClient:
+                    raise StopIteration() from None
+                else:
+                    recorded_event = self._filter_recorded_event(
+                        self._convert_read_resp(read_resp)
+                    )
+                    if recorded_event is not None:
+                        return recorded_event
+            except Exception:
+                self.stop()
+                raise
 
     def _get_next_read_resp(self) -> streams_pb2.ReadResp:
         try:
-            read_resp = next(self.read_resps)
+            read_resp = next(self._read_resps)
         except grpc.RpcError as e:
-            raise self.handle_stream_read_rpc_error(e) from e
+            raise self._handle_stream_read_rpc_error(e) from None
         else:
             assert isinstance(read_resp, streams_pb2.ReadResp)
             return read_resp
 
     def stop(self) -> None:
-        self.read_resps.cancel()
+        if not self._is_stopped:
+            self._read_resps.cancel()
+            try:
+                self._grpc_streamers.pop(id(self))
+            except KeyError:  # pragma: no cover
+                pass
+            self._is_stopped = True
+
+    def __enter__(self) -> "ReadResponse":
+        return self
+
+    def __exit__(self, *args: Any, **kwargs: Any) -> None:
+        self.stop()
 
     def __del__(self) -> None:
         self.stop()
         del self
 
 
 class CatchupSubscription(ReadResponse):
     def __init__(
         self,
         read_resps: _ReadResps,
         stream_name: Optional[str],
+        grpc_streamers: SyncGrpcStreamers,
         include_checkpoints: bool = False,
+        include_caught_up: bool = False,
     ):
-        super().__init__(read_resps=read_resps, stream_name=stream_name)
-        self.subscription_id: Optional[UUID] = None
-        self.include_checkpoints = include_checkpoints
-        first_read_resp = self._get_next_read_resp()
-        content_oneof = first_read_resp.WhichOneof("content")
-        if content_oneof == "confirmation":
-            pass
-            # Todo: What is '.confirmation.subscription_id' for?
-        else:  # pragma: no cover
-            raise SubscriptionConfirmationError(
-                f"Expected subscription confirmation, got: {first_read_resp}"
-            )
+        super().__init__(
+            read_resps=read_resps,
+            stream_name=stream_name,
+            grpc_streamers=grpc_streamers,
+        )
+        self._subscription_id: Optional[UUID] = None
+        self._include_checkpoints = include_checkpoints
+        self._include_caught_up = include_caught_up
+        try:
+            first_read_resp = self._get_next_read_resp()
+            content_oneof = first_read_resp.WhichOneof("content")
+            if content_oneof == "confirmation":
+                pass
+                # Todo: What is '.confirmation.subscription_id' for?
+            else:  # pragma: no cover
+                raise SubscriptionConfirmationError(
+                    f"Expected subscription confirmation, got: {first_read_resp}"
+                )
+        except Exception:
+            self.stop()
+            raise
+
+    def __enter__(self) -> "CatchupSubscription":
+        return self
 
-    def __next__(self) -> RecordedEvent:
-        while True:
-            recorded_event = super().__next__()
-            if self.include_checkpoints or not isinstance(recorded_event, Checkpoint):
-                return recorded_event
+
+@dataclass
+class BatchAppendResponse:
+    commit_position: int
 
 
 # @dataclass
 # class BatchAppendRequest:
 #     stream_name: str
 #     current_version: Union[int, StreamState]
 #     events: Iterable[NewEvent]
 #     correlation_id: UUID = field(default_factory=uuid4)
-#     deadline: int = DEFAULT_BATCH_APPEND_REQUEST_DEADLINE
-
-
+#     deadline: int = PROTOBUF_MAX_DEADLINE_SECONDS
+#
+#
 # if TYPE_CHECKING:  # pragma: no cover
 #
 #     class _BatchAppendFuture(Future[BatchAppendResponse]):
 #         pass
 #
 # else:
 #
 #     class _BatchAppendFuture(Future):
 #         pass
 #
 #
 # class BatchAppendFuture(_BatchAppendFuture):
-#     def __init__(self, batch_append_request: BatchAppendRequest):
-#         super().__init__()
-#         self.batch_append_request = batch_append_request
+#    def __init__(self, batch_append_request: BatchAppendRequest):
+#        super().__init__()
+#        self.batch_append_request = batch_append_request
 #
 #
 # if TYPE_CHECKING:  # pragma: no cover
-#     BatchAppendFutureQueue = Queue[BatchAppendFuture]
+#    BatchAppendFutureQueue = Queue[BatchAppendFuture]
 # else:
-#     BatchAppendFutureQueue = Queue
-
-
-@dataclass
-class BatchAppendResponse:
-    commit_position: int
-
-
+#    BatchAppendFutureQueue = Queue
+#
+#
 # class BatchAppendFutureIterator(Iterator[streams_pb2.BatchAppendReq]):
 #     def __init__(self, queue: BatchAppendFutureQueue):
 #         self.queue = queue
 #         self.futures_by_correlation_id: Dict[UUID, BatchAppendFuture] = {}
 #
 #     def __next__(self) -> streams_pb2.BatchAppendReq:
 #         future = self.queue.get()
 #         batch = future.batch_append_request
 #         self.futures_by_correlation_id[batch.correlation_id] = future
-#         return _construct_batch_append_req(batch)
+#         return BaseStreamsService._construct_batch_append_req(
+#             stream_name=batch.stream_name,
+#             current_version=batch.current_version,
+#             events=batch.events,
+#             # timeout=batch.timeout,
+#             correlation_id=batch.correlation_id,
+#         )
 #
 #     def pop_future(self, correlation_id: UUID) -> BatchAppendFuture:
 #         return self.futures_by_correlation_id.pop(correlation_id)
+#
+#     def __del__(self) -> None:
+#         print("DEL BatchAppendFutureIterator")
+#
+#
+# class BatchAppendResps(GrpcStreamer):
+#     def __init__(self, batch_append_resps: _BatchAppendResps, grpc_streamers: GrpcStreamers):
+#         grpc_streamers[id(self)] = self
+#         self._batch_append_resps = batch_append_resps
+#         self._grpc_streamers = grpc_streamers
+#         self._is_stopped = False
+#
+#     def __iter__(self) -> BatchAppendResps:
+#         return self
+#
+#     def __next__(self) -> streams_pb2.BatchAppendResp:
+#         try:
+#             return next(self._batch_append_resps)
+#         except Exception:
+#             self.stop()
+#             raise
+#
+#     def stop(self) -> None:
+#         if not self._is_stopped:
+#             self._batch_append_resps.cancel()
+#             try:
+#                 self._grpc_streamers.pop(id(self))
+#             except KeyError:  # pragma: no cover
+#                 pass
+#             self._is_stopped = True
+#
+#     def __del__(self) -> None:
+#         self.stop()
+#         del self
 
 
-class BaseStreamsService(ESDBService):
+class BaseStreamsService(ESDBService[TGrpcStreamers]):
     def __init__(
         self,
-        channel: Union[grpc.Channel, grpc.aio.Channel],
+        grpc_channel: Union[grpc.Channel, grpc.aio.Channel],
         connection_spec: ConnectionSpec,
+        grpc_streamers: TGrpcStreamers,
     ):
-        super().__init__(connection_spec=connection_spec)
-        self._stub = streams_pb2_grpc.StreamsStub(channel)
+        super().__init__(connection_spec=connection_spec, grpc_streamers=grpc_streamers)
+        self._stub = streams_pb2_grpc.StreamsStub(grpc_channel)
 
     @staticmethod
     def _generate_append_reqs(
         stream_name: str,
         current_version: Union[int, StreamState],
         events: Iterable[NewEvent],
     ) -> Iterator[streams_pb2.AppendReq]:
@@ -365,26 +468,35 @@
             yield streams_pb2.AppendReq(proposed_message=proposed_message)
 
     @staticmethod
     def _construct_batch_append_req(
         stream_name: str,
         current_version: Union[int, StreamState],
         events: Iterable[NewEvent],
-        deadline: int,
         correlation_id: UUID,
+        timeout: Optional[float] = None,
     ) -> streams_pb2.BatchAppendReq:
         # Construct batch request 'options'.
+        stream_identifier = shared_pb2.StreamIdentifier(
+            stream_name=stream_name.encode("utf8")
+        )
+        if timeout is not None:
+            timeout_split = math.modf(timeout)
+            duration_seconds = min(int(timeout_split[1]), PROTOBUF_MAX_DEADLINE_SECONDS)
+            duration_nanos = int(timeout_split[0] * 1000000000)
+        else:
+            duration_seconds = PROTOBUF_MAX_DEADLINE_SECONDS
+            duration_nanos = 0
+        duration = duration_pb2.Duration(
+            seconds=duration_seconds,
+            nanos=duration_nanos,
+        )
         options = streams_pb2.BatchAppendReq.Options(
-            stream_identifier=shared_pb2.StreamIdentifier(
-                stream_name=stream_name.encode("utf8")
-            ),
-            deadline=duration_pb2.Duration(
-                seconds=deadline,
-                nanos=0,
-            ),
+            stream_identifier=stream_identifier,
+            deadline=duration,
         )
         # Decide options 'expected_stream_revision'.
         if isinstance(current_version, int):
             assert current_version >= 0
             options.stream_position = current_version
         else:
             assert isinstance(current_version, StreamState)
@@ -452,15 +564,15 @@
             elif error_details.Is(shared_pb2.StreamDeleted.DESCRIPTOR):
                 stream_deleted = shared_pb2.StreamDeleted()
                 error_details.Unpack(stream_deleted)
                 # Todo: Ask ESDB team if this is ever different from request value.
                 # stream_name = stream_deleted.stream_identifier.stream_name
                 result = StreamIsDeleted(f"Stream {stream_name !r} is deleted")
             elif error_details.Is(shared_pb2.Timeout.DESCRIPTOR):  # pragma: no cover
-                result = TimeoutError()
+                result = AppendDeadlineExceeded()
             elif error_details.Is(shared_pb2.Unknown.DESCRIPTOR):  # pragma: no cover
                 result = UnknownError()
             elif error_details.Is(
                 shared_pb2.InvalidTransaction.DESCRIPTOR
             ):  # pragma: no cover
                 result = InvalidTransactionError()
             elif error_details.Is(
@@ -480,14 +592,15 @@
         return result
 
     @staticmethod
     def _construct_read_request(
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         commit_position: Optional[int] = None,
+        from_end: bool = False,
         backwards: bool = False,
         resolve_links: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         subscribe: bool = False,
@@ -507,29 +620,32 @@
                 ),
                 revision=stream_position or 0,
             )
 
             # Decide 'revision_option'.
             if stream_position is not None:
                 stream_options.revision = stream_position
+            elif from_end is True:
+                stream_options.end.CopyFrom(shared_pb2.Empty())
             elif backwards is False:
                 stream_options.start.CopyFrom(shared_pb2.Empty())
             else:
                 stream_options.end.CopyFrom(shared_pb2.Empty())
             options.stream.CopyFrom(stream_options)
         else:
             assert stream_position is None
             if commit_position is not None:
                 all_options = streams_pb2.ReadReq.Options.AllOptions(
                     position=streams_pb2.ReadReq.Options.Position(
                         commit_position=commit_position,
+                        # prepare_position=prepare_position or commit_position,
                         prepare_position=commit_position,
                     )
                 )
-            elif backwards:
+            elif backwards or from_end:
                 all_options = streams_pb2.ReadReq.Options.AllOptions(
                     end=shared_pb2.Empty()
                 )
             else:
                 all_options = streams_pb2.ReadReq.Options.AllOptions(
                     start=shared_pb2.Empty()
                 )
@@ -555,38 +671,28 @@
         # Decide 'filter_option'.
         if filter_exclude or filter_include:
             filter_options = streams_pb2.ReadReq.Options.FilterOptions(
                 max=window_size,
                 checkpointIntervalMultiplier=checkpoint_interval_multiplier,
             )
 
-            # Decide 'filter'
+            # Decide 'expression'
             if filter_include:
-                filter_include = (
-                    [filter_include]
-                    if isinstance(filter_include, str)
-                    else filter_include
-                )
-                filter_regex = "^" + "|".join(filter_include) + "$"
+                regex = construct_filter_include_regex(filter_include)
             else:
-                filter_exclude = (
-                    [filter_exclude]
-                    if isinstance(filter_exclude, str)
-                    else filter_exclude
-                )
-                filter_regex = "^(?!(" + "|".join(filter_exclude) + ")).*$"
+                regex = construct_filter_exclude_regex(filter_exclude)
 
-            filter_expression = streams_pb2.ReadReq.Options.FilterOptions.Expression(
-                regex=filter_regex
+            expression = streams_pb2.ReadReq.Options.FilterOptions.Expression(
+                regex=regex
             )
 
             if filter_by_stream_name:
-                filter_options.stream_identifier.CopyFrom(filter_expression)
+                filter_options.stream_identifier.CopyFrom(expression)
             else:
-                filter_options.event_type.CopyFrom(filter_expression)
+                filter_options.event_type.CopyFrom(expression)
 
             options.filter.CopyFrom(filter_options)
         else:
             options.no_filter.CopyFrom(shared_pb2.Empty())
 
         # Decide 'uuid_option'.
         options.uuid_option.CopyFrom(
@@ -645,51 +751,51 @@
                 options.any.CopyFrom(shared_pb2.Empty())
             else:
                 assert current_version is StreamState.NO_STREAM
                 options.no_stream.CopyFrom(shared_pb2.Empty())
         return streams_pb2.TombstoneReq(options=options)
 
 
-class AsyncioStreamsService(BaseStreamsService):
+class AsyncioStreamsService(BaseStreamsService[AsyncGrpcStreamers]):
     async def batch_append(
         self,
         stream_name: str,
         current_version: Union[int, StreamState],
         events: Iterable[NewEvent],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
-    ) -> BatchAppendResponse:
+    ) -> int:
         # Call the gRPC method.
         try:
             req = self._construct_batch_append_req(
                 stream_name=stream_name,
                 current_version=current_version,
                 events=events,
-                deadline=DEFAULT_BATCH_APPEND_REQUEST_DEADLINE,
+                timeout=timeout,
                 correlation_id=uuid4(),
             )
             async for response in self._stub.BatchAppend(
                 iter([req]),
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             ):
                 assert isinstance(response, streams_pb2.BatchAppendResp)
                 result = self._convert_batch_append_resp(response, stream_name)
                 if isinstance(result, BatchAppendResponse):
-                    return result
+                    return result.commit_position
                 else:
                     assert isinstance(result, EventStoreDBClientException)
                     raise result
             else:  # pragma: no cover
                 raise EventStoreDBClientException("Batch append response not received")
 
         except grpc.RpcError as e:
-            raise handle_rpc_error(e) from e
+            raise handle_rpc_error(e) from None
 
     @overload
     async def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
@@ -706,29 +812,33 @@
 
     @overload
     async def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
+        from_end: bool = False,
+        resolve_links: bool = False,
         subscribe: Literal[True],
+        include_caught_up: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
     ) -> AsyncioCatchupSubscription:
         """
         Signature for reading events from a stream with a catch-up subscription.
         """
 
     @overload
     async def read(
         self,
         *,
         commit_position: Optional[int] = None,
         backwards: bool = False,
+        resolve_links: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
@@ -738,45 +848,50 @@
         """
 
     @overload
     async def read(
         self,
         *,
         commit_position: Optional[int] = None,
+        from_end: bool = False,
+        resolve_links: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         subscribe: Literal[True],
         include_checkpoints: bool = False,
         window_size: int = DEFAULT_WINDOW_SIZE,
         checkpoint_interval_multiplier: int = DEFAULT_CHECKPOINT_INTERVAL_MULTIPLIER,
+        include_caught_up: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
     ) -> AsyncioCatchupSubscription:
         """
         Signature for reading all events with a catch-up subscription.
         """
 
     async def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         commit_position: Optional[int] = None,
+        from_end: bool = False,
         backwards: bool = False,
         resolve_links: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         subscribe: bool = False,
         include_checkpoints: bool = False,
         window_size: int = DEFAULT_WINDOW_SIZE,
         checkpoint_interval_multiplier: int = DEFAULT_CHECKPOINT_INTERVAL_MULTIPLIER,
+        include_caught_up: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
     ) -> Union[AsyncioReadResponse, AsyncioCatchupSubscription]:
         """
         Constructs and sends a gRPC 'ReadReq' to the 'Read' rpc.
 
@@ -784,14 +899,15 @@
         """
 
         # Construct read request.
         read_req = self._construct_read_request(
             stream_name=stream_name,
             stream_position=stream_position,
             commit_position=commit_position,
+            from_end=from_end,
             backwards=backwards,
             resolve_links=resolve_links,
             filter_exclude=filter_exclude,
             filter_include=filter_include,
             filter_by_stream_name=filter_by_stream_name,
             limit=limit,
             subscribe=subscribe,
@@ -809,20 +925,23 @@
             credentials=credentials,
         )
 
         if not subscribe:
             response = AsyncioReadResponse(
                 aio_call=unary_stream_call,
                 stream_name=stream_name,
+                grpc_streamers=self._grpc_streamers,
             )
         else:
             response = AsyncioCatchupSubscription(
                 aio_call=unary_stream_call,
                 stream_name=stream_name,
                 include_checkpoints=include_checkpoints,
+                include_caught_up=include_caught_up,
+                grpc_streamers=self._grpc_streamers,
             )
             await response.check_confirmation()
         return response
 
     async def delete(
         self,
         stream_name: str,
@@ -841,23 +960,23 @@
                 credentials=credentials,
             )
         except grpc.RpcError as e:
             if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if "WrongExpectedVersion" in details:
                     if "Actual version: -1" in details:
-                        raise NotFound() from e
+                        raise NotFound() from None
                     else:
-                        raise WrongCurrentVersion() from e
+                        raise WrongCurrentVersion(details) from None
                 elif "is deleted" in details:
-                    raise StreamIsDeleted() from e
+                    raise StreamIsDeleted(details) from None
                 else:  # pragma: no cover
-                    raise handle_rpc_error(e) from e
+                    raise handle_rpc_error(e) from None
             else:
-                raise handle_rpc_error(e) from e
+                raise handle_rpc_error(e) from None
         else:
             assert isinstance(delete_resp, streams_pb2.DeleteResp), delete_resp
 
     async def tombstone(
         self,
         stream_name: str,
         current_version: Union[int, StreamState],
@@ -875,28 +994,28 @@
                 credentials=credentials,
             )
         except grpc.RpcError as e:
             if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if "WrongExpectedVersion" in details:
                     if "Actual version: -1" in details:
-                        raise NotFound() from e
+                        raise NotFound(details) from None
                     else:
-                        raise WrongCurrentVersion() from e
+                        raise WrongCurrentVersion(details) from None
                 elif "is deleted" in details:
-                    raise StreamIsDeleted() from e
+                    raise StreamIsDeleted(details) from None
                 else:  # pragma: no cover
-                    raise handle_rpc_error(e) from e
+                    raise handle_rpc_error(e) from None
             else:
-                raise handle_rpc_error(e) from e
+                raise handle_rpc_error(e) from None
         else:
             assert isinstance(tombstone_resp, streams_pb2.TombstoneResp)
 
 
-class StreamsService(BaseStreamsService):
+class StreamsService(BaseStreamsService[SyncGrpcStreamers]):
     """
     Encapsulates the 'streams.Streams' gRPC service.
     """
 
     @overload
     def read(
         self,
@@ -916,30 +1035,33 @@
 
     @overload
     def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
+        from_end: bool = False,
         resolve_links: bool = False,
         subscribe: Literal[True],
+        include_caught_up: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
     ) -> CatchupSubscription:
         """
         Signature for reading events from a stream with a catch-up subscription.
         """
 
     @overload
     def read(
         self,
         *,
         commit_position: Optional[int] = None,
         backwards: bool = False,
+        resolve_links: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
@@ -949,45 +1071,50 @@
         """
 
     @overload
     def read(
         self,
         *,
         commit_position: Optional[int] = None,
+        from_end: bool = False,
+        resolve_links: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         subscribe: Literal[True],
         include_checkpoints: bool = False,
         window_size: int = DEFAULT_WINDOW_SIZE,
         checkpoint_interval_multiplier: int = DEFAULT_CHECKPOINT_INTERVAL_MULTIPLIER,
+        include_caught_up: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
     ) -> CatchupSubscription:
         """
         Signature for reading all events with a catch-up subscription.
         """
 
     def read(
         self,
         *,
         stream_name: Optional[str] = None,
         stream_position: Optional[int] = None,
         commit_position: Optional[int] = None,
+        from_end: bool = False,
         backwards: bool = False,
         resolve_links: bool = False,
         filter_exclude: Sequence[str] = (),
         filter_include: Sequence[str] = (),
         filter_by_stream_name: bool = False,
         limit: int = sys.maxsize,
         subscribe: bool = False,
         include_checkpoints: bool = False,
         window_size: int = DEFAULT_WINDOW_SIZE,
         checkpoint_interval_multiplier: int = DEFAULT_CHECKPOINT_INTERVAL_MULTIPLIER,
+        include_caught_up: bool = False,
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
     ) -> Union[ReadResponse, CatchupSubscription]:
         """
         Constructs and sends a gRPC 'ReadReq' to the 'Read' rpc.
 
@@ -995,14 +1122,15 @@
         """
 
         # Construct read request.
         read_req = self._construct_read_request(
             stream_name=stream_name,
             stream_position=stream_position,
             commit_position=commit_position,
+            from_end=from_end,
             backwards=backwards,
             resolve_links=resolve_links,
             filter_exclude=filter_exclude,
             filter_include=filter_include,
             filter_by_stream_name=filter_by_stream_name,
             limit=limit,
             subscribe=subscribe,
@@ -1016,20 +1144,26 @@
             timeout=timeout,
             metadata=self._metadata(metadata),
             credentials=credentials,
         )
         assert isinstance(read_resps, _ReadResps)  # a _MultiThreadedRendezvous
 
         if subscribe is False:
-            return ReadResponse(read_resps, stream_name=stream_name)
+            return ReadResponse(
+                read_resps=read_resps,
+                stream_name=stream_name,
+                grpc_streamers=self._grpc_streamers,
+            )
         else:
             return CatchupSubscription(
-                read_resps,
+                read_resps=read_resps,
                 stream_name=stream_name,
                 include_checkpoints=include_checkpoints,
+                include_caught_up=include_caught_up,
+                grpc_streamers=self._grpc_streamers,
             )
 
     def append(
         self,
         stream_name: str,
         current_version: Union[int, StreamState],
         events: Iterable[NewEvent],
@@ -1037,29 +1171,31 @@
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
     ) -> int:
         """
         Constructs and sends a stream of gRPC 'AppendReq' to the 'Append' rpc.
 
         Returns the commit position of the last appended event.
+
+        This seems to be an atomic operation (either all or none
         """
         try:
             append_reqs = self._generate_append_reqs(
                 stream_name=stream_name,
                 current_version=current_version,
                 events=events,
             )
             append_resp = self._stub.Append(
                 append_reqs,
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             )
         except grpc.RpcError as e:
-            raise handle_rpc_error(e) from e
+            raise handle_rpc_error(e) from None
         else:
             assert isinstance(append_resp, streams_pb2.AppendResp)
             # Response 'result' is either 'success' or 'wrong_expected_version'.
             result_oneof = append_resp.WhichOneof("result")
             if result_oneof == "success":
                 return append_resp.success.position.commit_position
             else:
@@ -1082,94 +1218,111 @@
     #     credentials: Optional[grpc.CallCredentials] = None,
     # ) -> None:
     #     # Construct batch append requests iterator.
     #     requests = BatchAppendFutureIterator(futures_queue)
     #
     #     # Call the gRPC method.
     #     try:
-    #         for response in self._stub.BatchAppend(
+    #         batch_append_resps = self._stub.BatchAppend(
     #             requests,
     #             timeout=timeout,
     #             metadata=self._metadata(metadata, requires_leader=True),
     #             credentials=credentials,
-    #         ):
+    #         )
+    #
+    #         batch_append_resps = BatchAppendResps(
+    #             batch_append_resps, self._grpc_streamers
+    #         )
+    #
+    #         for response in batch_append_resps:
     #             # Use the correlation ID to get the future.
     #             assert isinstance(response, streams_pb2.BatchAppendResp)
     #             correlation_id = UUID(response.correlation_id.string)
     #             future = requests.pop_future(correlation_id)
     #
     #             # Convert the result.
     #             stream_name = future.batch_append_request.stream_name
-    #             result = self._convert_batch_append_result(response, stream_name)
+    #             result = self._convert_batch_append_resp(response, stream_name)
     #
     #             # Finish the future.
     #             if isinstance(result, BatchAppendResponse):
     #                 future.set_result(result)
     #             else:
     #                 assert isinstance(result, EventStoreDBClientException)
     #                 future.set_exception(result)
     #
     #         else:
     #             # The response stream ended without an RPC error.
-    #             for (
-    #                 correlation_id
-    #             ) in requests.futures_by_correlation_id:  # pragma: no cover
+    #             for correlation_id in list(
+    #                 requests.futures_by_correlation_id
+    #             ):  # pragma: no cover
     #                 future = requests.pop_future(correlation_id)
     #                 future.set_exception(
-    #                     EventStoreDBClientException("Batch append response not received")
+    #                     EventStoreDBClientException(
+    #                         "Batch append response not received"
+    #                     )
     #                 )
     #
     #     except grpc.RpcError as rpc_error:
     #         # The response stream ended with an RPC error.
     #         try:
     #             raise handle_rpc_error(rpc_error) from rpc_error
+    #         except CancelledByClient:
+    #             while len(requests.futures_by_correlation_id):
+    #                 for correlation_id in list(
+    #                     requests.futures_by_correlation_id
+    #                 ):  # pragma: no cover
+    #                     future = requests.pop_future(correlation_id)
+    #                     future.set_exception(
+    #                         EventStoreDBClientException("Cancelled by client")
+    #                     )
     #         except GrpcError as grpc_error:
-    #             for (
-    #                 correlation_id
-    #             ) in requests.futures_by_correlation_id:  # pragma: no cover
-    #                 future = requests.pop_future(correlation_id)
-    #                 future.set_exception(grpc_error)
-    #             raise
+    #             while len(requests.futures_by_correlation_id):
+    #                 for correlation_id in list(
+    #                     requests.futures_by_correlation_id
+    #                 ):  # pragma: no cover
+    #                     future = requests.pop_future(correlation_id)
+    #                     future.set_exception(grpc_error)
 
     def batch_append(
         self,
         stream_name: str,
         current_version: Union[int, StreamState],
         events: Iterable[NewEvent],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
         credentials: Optional[grpc.CallCredentials] = None,
-    ) -> BatchAppendResponse:
+    ) -> int:
         # Call the gRPC method.
         try:
             req = self._construct_batch_append_req(
                 stream_name=stream_name,
                 current_version=current_version,
                 events=events,
-                deadline=DEFAULT_BATCH_APPEND_REQUEST_DEADLINE,
+                timeout=timeout,
                 correlation_id=uuid4(),
             )
             for response in self._stub.BatchAppend(
                 iter([req]),
                 timeout=timeout,
                 metadata=self._metadata(metadata, requires_leader=True),
                 credentials=credentials,
             ):
                 assert isinstance(response, streams_pb2.BatchAppendResp)
                 result = self._convert_batch_append_resp(response, stream_name)
                 if isinstance(result, BatchAppendResponse):
-                    return result
+                    return result.commit_position
                 else:
                     assert isinstance(result, EventStoreDBClientException)
                     raise result
             else:  # pragma: no cover
                 raise EventStoreDBClientException("Batch append response not received")
 
         except grpc.RpcError as e:
-            raise handle_rpc_error(e) from e
+            raise handle_rpc_error(e) from None
 
     def delete(
         self,
         stream_name: str,
         current_version: Union[int, StreamState],
         timeout: Optional[float] = None,
         metadata: Optional[Metadata] = None,
@@ -1185,23 +1338,23 @@
                 credentials=credentials,
             )
         except grpc.RpcError as e:
             if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if "WrongExpectedVersion" in details:
                     if "Actual version: -1" in details:
-                        raise NotFound() from e
+                        raise NotFound(details) from None
                     else:
-                        raise WrongCurrentVersion() from e
+                        raise WrongCurrentVersion(details) from None
                 elif "is deleted" in details:
-                    raise StreamIsDeleted() from e
+                    raise StreamIsDeleted(details) from None
                 else:  # pragma: no cover
-                    raise handle_rpc_error(e) from e
+                    raise handle_rpc_error(e) from None
             else:
-                raise handle_rpc_error(e) from e
+                raise handle_rpc_error(e) from None
         else:
             assert isinstance(delete_resp, streams_pb2.DeleteResp)
             # position_option_oneof = delete_resp.WhichOneof("position_option")
             # if position_option_oneof == "position":
             #     return delete_resp.position
             # else:
             #     return delete_resp.no_position
@@ -1224,23 +1377,23 @@
                 credentials=credentials,
             )
         except grpc.RpcError as e:
             if e.code() == grpc.StatusCode.FAILED_PRECONDITION:
                 details = e.details() or ""
                 if "WrongExpectedVersion" in details:
                     if "Actual version: -1" in details:
-                        raise NotFound() from e
+                        raise NotFound(details) from None
                     else:
-                        raise WrongCurrentVersion() from e
+                        raise WrongCurrentVersion(details) from None
                 elif "is deleted" in details:
-                    raise StreamIsDeleted() from e
+                    raise StreamIsDeleted(details) from None
                 else:  # pragma: no cover
-                    raise handle_rpc_error(e) from e
+                    raise handle_rpc_error(e) from None
             else:
-                raise handle_rpc_error(e) from e
+                raise handle_rpc_error(e) from None
         else:
             assert isinstance(tombstone_resp, streams_pb2.TombstoneResp)
             # position_option_oneof = tombstone_resp.WhichOneof("position_option")
             # if position_option_oneof == "position":
             #     return tombstone_resp.position
             # else:
             #     return tombstone_resp.no_position
```

### Comparing `esdbclient-1.0b4/pyproject.toml` & `esdbclient-1.1b1/pyproject.toml`

 * *Files 8% similar despite different names*

```diff
@@ -1,21 +1,25 @@
 [tool.poetry]
 name = "esdbclient"
-version = "1.0b4"
+version = "1.1b1"
+
 description = "Python gRPC Client for EventStoreDB"
 authors = [
     "John Bywater <john.bywater@appropriatesoftware.net>",
 ]
 license = "BSD 3-Clause"
 classifiers = [
+#    "Development Status :: 3 - Alpha",
     "Development Status :: 4 - Beta",
+#    "Development Status :: 5 - Production/Stable",
     "License :: OSI Approved :: BSD License",
     "Programming Language :: Python :: 3",
     "Programming Language :: Python :: 3.10",
     "Programming Language :: Python :: 3.11",
+    "Programming Language :: Python :: 3.12",
     "Programming Language :: Python :: 3.7",
     "Programming Language :: Python :: 3.8",
     "Programming Language :: Python :: 3.9",
     "Programming Language :: Python",
 ]
 readme = "README.md"
 homepage = "https://github.com/pyeventsourcing/esdbclient"
@@ -25,16 +29,15 @@
 [tool.poetry.dependencies]
 python = ">=3.7,<4.0"
 grpcio = ">=1.51.0,!=1.52.*"  # 1.52.0 hangs on fork
 protobuf = ">=3.11.0"
 #protobuf = "^4.21.0"
 #protobuf = ">=3.11.0,<3.21.0"
 typing_extensions = "*"
-dnspython = "^2.3.0"
-coverage = "^7.2.7"
+
 
 [tool.poetry.dev-dependencies]
 black = { version = "*", allow-prereleases = true }
 flake8 = "*"
 flake8-broken-line = "*"
 flake8-bugbear = "*"
 flake8-coding = "*"
@@ -45,14 +48,15 @@
 #pre-commit = "*"
 #pre-commit-hooks = "*"
 grpcio-tools = "*"
 grpc-stubs = "*"
 types-protobuf = "*"
 mypy-protobuf = "*"
 async-case = {version = "^10.1.0", python = "<=3.8"}
+coverage = "^7.2.7"
 
 
 [build-system]
 requires = ["poetry-core>=1.0.0"]
 build-backend = "poetry.core.masonry.api"
 
 [tool.black]
```

### Comparing `esdbclient-1.0b4/setup.py` & `esdbclient-1.1b1/README.md`

 * *Files 20% similar despite different names*

```diff
@@ -1,7575 +1,9160 @@
-00000000: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
-00000010: 662d 3820 2d2a 2d0a 6672 6f6d 2073 6574  f-8 -*-.from set
-00000020: 7570 746f 6f6c 7320 696d 706f 7274 2073  uptools import s
-00000030: 6574 7570 0a0a 7061 636b 6167 6573 203d  etup..packages =
-00000040: 205c 0a5b 2765 7364 6263 6c69 656e 7427   \.['esdbclient'
-00000050: 2c20 2765 7364 6263 6c69 656e 742e 7072  , 'esdbclient.pr
-00000060: 6f74 6f73 2e47 7270 6327 5d0a 0a70 6163  otos.Grpc']..pac
-00000070: 6b61 6765 5f64 6174 6120 3d20 5c0a 7b27  kage_data = \.{'
-00000080: 273a 205b 272a 275d 7d0a 0a69 6e73 7461  ': ['*']}..insta
-00000090: 6c6c 5f72 6571 7569 7265 7320 3d20 5c0a  ll_requires = \.
-000000a0: 5b27 636f 7665 7261 6765 3e3d 372e 322e  ['coverage>=7.2.
-000000b0: 372c 3c38 2e30 2e30 272c 0a20 2764 6e73  7,<8.0.0',. 'dns
-000000c0: 7079 7468 6f6e 3e3d 322e 332e 302c 3c33  python>=2.3.0,<3
-000000d0: 2e30 2e30 272c 0a20 2767 7270 6369 6f3e  .0.0',. 'grpcio>
-000000e0: 3d31 2e35 312e 302c 213d 312e 3532 2e2a  =1.51.0,!=1.52.*
-000000f0: 272c 0a20 2770 726f 746f 6275 663e 3d33  ',. 'protobuf>=3
-00000100: 2e31 312e 3027 2c0a 2027 7479 7069 6e67  .11.0',. 'typing
-00000110: 5f65 7874 656e 7369 6f6e 7327 5d0a 0a73  _extensions']..s
-00000120: 6574 7570 5f6b 7761 7267 7320 3d20 7b0a  etup_kwargs = {.
-00000130: 2020 2020 276e 616d 6527 3a20 2765 7364      'name': 'esd
-00000140: 6263 6c69 656e 7427 2c0a 2020 2020 2776  bclient',.    'v
-00000150: 6572 7369 6f6e 273a 2027 312e 3062 3427  ersion': '1.0b4'
-00000160: 2c0a 2020 2020 2764 6573 6372 6970 7469  ,.    'descripti
-00000170: 6f6e 273a 2027 5079 7468 6f6e 2067 5250  on': 'Python gRP
-00000180: 4320 436c 6965 6e74 2066 6f72 2045 7665  C Client for Eve
-00000190: 6e74 5374 6f72 6544 4227 2c0a 2020 2020  ntStoreDB',.    
-000001a0: 276c 6f6e 675f 6465 7363 7269 7074 696f  'long_descriptio
-000001b0: 6e27 3a20 2723 2050 7974 686f 6e20 6752  n': '# Python gR
-000001c0: 5043 2043 6c69 656e 7420 666f 7220 4576  PC Client for Ev
-000001d0: 656e 7453 746f 7265 4442 5c6e 5c6e 5468  entStoreDB\n\nTh
-000001e0: 6973 205b 5079 7468 6f6e 2070 6163 6b61  is [Python packa
-000001f0: 6765 5d28 6874 7470 733a 2f2f 7079 7069  ge](https://pypi
-00000200: 2e6f 7267 2f70 726f 6a65 6374 2f65 7364  .org/project/esd
-00000210: 6263 6c69 656e 742f 2920 7072 6f76 6964  bclient/) provid
-00000220: 6573 2061 2050 7974 686f 6e5c 6e67 5250  es a Python\ngRP
-00000230: 4320 636c 6965 6e74 2066 6f72 2074 6865  C client for the
-00000240: 205b 4576 656e 7453 746f 7265 4442 5d28   [EventStoreDB](
-00000250: 6874 7470 733a 2f2f 7777 772e 6576 656e  https://www.even
-00000260: 7473 746f 7265 2e63 6f6d 2f29 2064 6174  tstore.com/) dat
-00000270: 6162 6173 652e 5c6e 5c6e 5468 6973 2063  abase.\n\nThis c
-00000280: 6c69 656e 7420 6861 7320 6265 656e 2064  lient has been d
-00000290: 6576 656c 6f70 6564 2069 6e20 636f 6c6c  eveloped in coll
-000002a0: 6162 6f72 6174 696f 6e20 7769 7468 2074  aboration with t
-000002b0: 6865 2045 7665 6e74 5374 6f72 6544 425c  he EventStoreDB\
-000002c0: 6e74 6561 6d2e 2041 6c74 686f 7567 6820  nteam. Although 
-000002d0: 6e6f 7420 616c 6c20 7468 6520 6665 6174  not all the feat
-000002e0: 7572 6573 206f 6620 4576 656e 7453 746f  ures of EventSto
-000002f0: 7265 4442 2061 7265 2073 7570 706f 7274  reDB are support
-00000300: 6564 5c6e 6279 2074 6869 7320 636c 6965  ed\nby this clie
-00000310: 6e74 2c20 6d61 6e79 206f 6620 7468 6520  nt, many of the 
-00000320: 6d6f 7374 2075 7365 6675 6c20 6665 6174  most useful feat
-00000330: 7572 6573 2061 7265 2070 7265 7365 6e74  ures are present
-00000340: 6564 5c6e 696e 2061 6e20 6561 7379 2d74  ed\nin an easy-t
-00000350: 6f2d 7573 6520 696e 7465 7266 6163 652e  o-use interface.
-00000360: 5c6e 5c6e 5468 6973 2063 6c69 656e 7420  \n\nThis client 
-00000370: 6861 7320 6265 656e 2074 6573 7465 6420  has been tested 
-00000380: 746f 2077 6f72 6b20 7769 7468 2045 7665  to work with Eve
-00000390: 6e74 5374 6f72 6544 4220 4c54 5320 7665  ntStoreDB LTS ve
-000003a0: 7273 696f 6e73 2032 312e 3130 5c6e 616e  rsions 21.10\nan
-000003b0: 6420 3232 2e31 302c 2077 6974 686f 7574  d 22.10, without
-000003c0: 2061 6e64 2077 6974 686f 7574 2053 534c   and without SSL
-000003d0: 2f54 4c53 2c20 616e 6420 7769 7468 2050  /TLS, and with P
-000003e0: 7974 686f 6e20 7665 7273 696f 6e73 2033  ython versions 3
-000003f0: 2e37 2074 6f20 332e 3131 2e5c 6e54 6865  .7 to 3.11.\nThe
-00000400: 7265 2069 7320 3130 3025 2074 6573 7420  re is 100% test 
-00000410: 636f 7665 7261 6765 2e20 5468 6520 636f  coverage. The co
-00000420: 6465 2068 6173 2074 7970 696e 6720 616e  de has typing an
-00000430: 6e6f 7461 7469 6f6e 732c 2063 6865 636b  notations, check
-00000440: 6564 2077 6974 6820 6d79 7079 2e5c 6e54  ed with mypy.\nT
-00000450: 6865 2063 6f64 6520 6973 2066 6f72 6d61  he code is forma
-00000460: 7474 6564 2077 6974 6820 626c 6163 6b20  tted with black 
-00000470: 616e 6420 6973 6f72 742c 2061 6e64 2063  and isort, and c
-00000480: 6865 636b 6564 2077 6974 6820 666c 616b  hecked with flak
-00000490: 6538 2e20 506f 6574 7279 5c6e 6973 2075  e8. Poetry\nis u
-000004a0: 7365 6420 666f 7220 7061 636b 6167 6520  sed for package 
-000004b0: 6d61 6e61 6765 6d65 6e74 2064 7572 696e  management durin
-000004c0: 6720 6465 7665 6c6f 706d 656e 742c 2061  g development, a
-000004d0: 6e64 2066 6f72 2062 7569 6c64 696e 6720  nd for building 
-000004e0: 616e 645c 6e70 7562 6c69 7368 696e 6720  and\npublishing 
-000004f0: 6469 7374 7269 6275 7469 6f6e 7320 746f  distributions to
-00000500: 205b 5079 5049 5d28 6874 7470 733a 2f2f   [PyPI](https://
-00000510: 7079 7069 2e6f 7267 2f70 726f 6a65 6374  pypi.org/project
-00000520: 2f65 7364 6263 6c69 656e 742f 292e 5c6e  /esdbclient/).\n
-00000530: 5c6e 2323 2053 796e 6f70 7369 735c 6e5c  \n## Synopsis\n\
-00000540: 6e59 6f75 2063 616e 2063 6f6e 6e65 6374  nYou can connect
-00000550: 2074 6f20 616e 2045 7665 6e74 5374 6f72   to an EventStor
-00000560: 6544 4220 6461 7461 6261 7365 2075 7369  eDB database usi
-00000570: 6e67 2074 6865 2060 4576 656e 7453 746f  ng the `EventSto
-00000580: 7265 4442 436c 6965 6e74 6020 636c 6173  reDBClient` clas
-00000590: 732e 5c6e 5c6e 5468 6520 6045 7665 6e74  s.\n\nThe `Event
-000005a0: 5374 6f72 6544 4243 6c69 656e 7460 2063  StoreDBClient` c
-000005b0: 6c61 7373 2063 616e 2062 6520 696d 706f  lass can be impo
-000005c0: 7274 6564 2066 726f 6d20 7468 6520 6065  rted from the `e
-000005d0: 7364 6263 6c69 656e 7460 2070 6163 6b61  sdbclient` packa
-000005e0: 6765 2e5c 6e5c 6e50 726f 6261 626c 7920  ge.\n\nProbably 
-000005f0: 7468 6520 7468 7265 6520 6d6f 7374 2075  the three most u
-00000600: 7365 6675 6c20 6d65 7468 6f64 7320 6f66  seful methods of
-00000610: 2060 4576 656e 7453 746f 7265 4442 436c   `EventStoreDBCl
-00000620: 6965 6e74 6020 6172 653a 5c6e 5c6e 2a20  ient` are:\n\n* 
-00000630: 6061 7070 656e 645f 746f 5f73 7472 6561  `append_to_strea
-00000640: 6d28 2960 2054 6869 7320 6d65 7468 6f64  m()` This method
-00000650: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00000660: 7265 636f 7264 206e 6577 2065 7665 6e74  record new event
-00000670: 7320 696e 2061 2070 6172 7469 6375 6c61  s in a particula
-00000680: 725c 6e22 7374 7265 616d 222e 2054 6869  r\n"stream". Thi
-00000690: 7320 6973 2075 7365 6675 6c2c 2066 6f72  s is useful, for
-000006a0: 2065 7861 6d70 6c65 2c20 7768 656e 2065   example, when e
-000006b0: 7865 6375 7469 6e67 2061 2063 6f6d 6d61  xecuting a comma
-000006c0: 6e64 2069 6e20 616e 2061 7070 6c69 6361  nd in an applica
-000006d0: 7469 6f6e 5c6e 7468 6174 206d 7574 6174  tion\nthat mutat
-000006e0: 6573 2061 6e20 6167 6772 6567 6174 652e  es an aggregate.
-000006f0: 2054 6869 7320 6d65 7468 6f64 2069 7320   This method is 
-00000700: 2261 746f 6d69 6322 2069 6e20 7468 6174  "atomic" in that
-00000710: 2065 6974 6865 7220 616c 6c20 6f72 206e   either all or n
-00000720: 6f6e 6520 6f66 5c6e 7468 6520 6576 656e  one of\nthe even
-00000730: 7473 2077 696c 6c20 6265 2072 6563 6f72  ts will be recor
-00000740: 6465 642e 5c6e 5c6e 2a20 6072 6561 645f  ded.\n\n* `read_
-00000750: 7374 7265 616d 2829 6020 5468 6973 206d  stream()` This m
-00000760: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00000770: 6420 746f 2072 6574 7269 6576 6520 616c  d to retrieve al
-00000780: 6c20 7468 6520 7265 636f 7264 6564 5c6e  l the recorded\n
-00000790: 6576 656e 7473 2069 6e20 6120 2273 7472  events in a "str
-000007a0: 6561 6d22 2e20 5468 6973 2069 7320 7573  eam". This is us
-000007b0: 6566 756c 2c20 666f 7220 6578 616d 706c  eful, for exampl
-000007c0: 652c 2077 6865 6e20 7265 636f 6e73 7472  e, when reconstr
-000007d0: 7563 7469 6e67 5c6e 616e 2061 6767 7265  ucting\nan aggre
-000007e0: 6761 7465 2066 726f 6d20 7265 636f 7264  gate from record
-000007f0: 6564 2065 7665 6e74 7320 6265 666f 7265  ed events before
-00000800: 2065 7865 6375 7469 6e67 2061 2063 6f6d   executing a com
-00000810: 6d61 6e64 2069 6e20 616e 5c6e 6170 706c  mand in an\nappl
-00000820: 6963 6174 696f 6e20 7468 6174 2063 7265  ication that cre
-00000830: 6174 6573 206e 6577 2065 7665 6e74 732e  ates new events.
-00000840: 5c6e 5c6e 2a20 6073 7562 7363 7269 6265  \n\n* `subscribe
-00000850: 5f74 6f5f 616c 6c28 2960 2054 6869 7320  _to_all()` This 
-00000860: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
-00000870: 6564 2074 6f20 7265 6365 6976 6520 616c  ed to receive al
-00000880: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
-00000890: 7320 696e 5c6e 7468 6520 6461 7461 6261  s in\nthe databa
-000008a0: 7365 2e20 5468 6973 2069 7320 7573 6566  se. This is usef
-000008b0: 756c 2c20 666f 7220 6578 616d 706c 652c  ul, for example,
-000008c0: 2069 6e20 6576 656e 742d 7072 6f63 6573   in event-proces
-000008d0: 7369 6e67 2063 6f6d 706f 6e65 6e74 7320  sing components 
-000008e0: 6265 6361 7573 655c 6e69 7420 7375 7070  because\nit supp
-000008f0: 6f72 7473 2070 726f 6365 7373 696e 6720  orts processing 
-00000900: 6576 656e 7473 2077 6974 6820 2265 7861  events with "exa
-00000910: 6374 6c79 2d6f 6e63 6522 2073 656d 616e  ctly-once" seman
-00000920: 7469 6373 2e5c 6e5c 6e54 6865 2065 7861  tics.\n\nThe exa
-00000930: 6d70 6c65 2062 656c 6f77 2075 7365 7320  mple below uses 
-00000940: 616e 2022 696e 7365 6375 7265 2220 4576  an "insecure" Ev
-00000950: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
-00000960: 7220 7275 6e6e 696e 6720 6c6f 6361 6c6c  r running locall
-00000970: 7920 6f6e 2070 6f72 7420 3231 3133 2e5c  y on port 2113.\
-00000980: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 696d  n\n```python\nim
-00000990: 706f 7274 2075 7569 645c 6e5c 6e66 726f  port uuid\n\nfro
-000009a0: 6d20 6573 6462 636c 6965 6e74 2069 6d70  m esdbclient imp
-000009b0: 6f72 7420 4576 656e 7453 746f 7265 4442  ort EventStoreDB
-000009c0: 436c 6965 6e74 2c20 4e65 7745 7665 6e74  Client, NewEvent
-000009d0: 2c20 5374 7265 616d 5374 6174 655c 6e5c  , StreamState\n\
-000009e0: 6e5c 6e23 2043 6f6e 7374 7275 6374 2045  n\n# Construct E
-000009f0: 7665 6e74 5374 6f72 6544 4243 6c69 656e  ventStoreDBClien
-00000a00: 7420 7769 7468 2061 6e20 4576 656e 7453  t with an EventS
-00000a10: 746f 7265 4442 2055 5249 2e20 5468 655c  toreDB URI. The\
-00000a20: 6e23 2063 6f6e 6e65 6374 696f 6e20 7374  n# connection st
-00000a30: 7269 6e67 2055 5249 2073 7065 6369 6669  ring URI specifi
-00000a40: 6573 2074 6861 7420 7468 6520 636c 6965  es that the clie
-00000a50: 6e74 2073 686f 756c 645c 6e23 2063 6f6e  nt should\n# con
-00000a60: 6e65 6374 2074 6f20 616e 2022 696e 7365  nect to an "inse
-00000a70: 6375 7265 2220 7365 7276 6572 2072 756e  cure" server run
-00000a80: 6e69 6e67 206f 6e20 706f 7274 2032 3131  ning on port 211
-00000a90: 332e 5c6e 5c6e 636c 6965 6e74 203d 2045  3.\n\nclient = E
-00000aa0: 7665 6e74 5374 6f72 6544 4243 6c69 656e  ventStoreDBClien
-00000ab0: 7428 5c6e 2020 2020 7572 693d 2265 7364  t(\n    uri="esd
-00000ac0: 623a 2f2f 6c6f 6361 6c68 6f73 743a 3231  b://localhost:21
-00000ad0: 3133 3f54 6c73 3d66 616c 7365 225c 6e29  13?Tls=false"\n)
-00000ae0: 5c6e 5c6e 5c6e 2320 4765 6e65 7261 7465  \n\n\n# Generate
-00000af0: 206e 6577 2065 7665 6e74 732e 2054 7970   new events. Typ
-00000b00: 6963 616c 6c79 2c20 646f 6d61 696e 2065  ically, domain e
-00000b10: 7665 6e74 7320 6f66 2064 6966 6665 7265  vents of differe
-00000b20: 6e74 5c6e 2320 7479 7065 7320 6172 6520  nt\n# types are 
-00000b30: 6765 6e65 7261 7465 6420 696e 2061 2064  generated in a d
-00000b40: 6f6d 6169 6e20 6d6f 6465 6c2c 2061 6e64  omain model, and
-00000b50: 2074 6865 6e20 7365 7269 616c 697a 6564   then serialized
-00000b60: 5c6e 2320 696e 746f 204e 6577 4576 656e  \n# into NewEven
-00000b70: 7420 6f62 6a65 6374 732e 2041 6e20 6167  t objects. An ag
-00000b80: 6772 6567 6174 6520 4944 206d 6179 2062  gregate ID may b
-00000b90: 6520 7573 6564 2061 7320 7468 655c 6e23  e used as the\n#
-00000ba0: 206e 616d 6520 6f66 2061 2073 7472 6561   name of a strea
-00000bb0: 6d20 696e 2045 7665 6e74 5374 6f72 6544  m in EventStoreD
-00000bc0: 422e 5c6e 5c6e 7374 7265 616d 5f6e 616d  B.\n\nstream_nam
-00000bd0: 6531 203d 2073 7472 2875 7569 642e 7575  e1 = str(uuid.uu
-00000be0: 6964 3428 2929 5c6e 6576 656e 7431 203d  id4())\nevent1 =
-00000bf0: 204e 6577 4576 656e 7428 5c6e 2020 2020   NewEvent(\n    
-00000c00: 7479 7065 3d5c 274f 7264 6572 4372 6561  type=\'OrderCrea
-00000c10: 7465 645c 272c 5c6e 2020 2020 6461 7461  ted\',\n    data
-00000c20: 3d62 5c27 7b22 6f72 6465 725f 6e75 6d62  =b\'{"order_numb
-00000c30: 6572 223a 2022 3132 3334 3536 227d 5c27  er": "123456"}\'
-00000c40: 5c6e 295c 6e65 7665 6e74 3220 3d20 4e65  \n)\nevent2 = Ne
-00000c50: 7745 7665 6e74 285c 6e20 2020 2074 7970  wEvent(\n    typ
-00000c60: 653d 5c27 4f72 6465 7253 7562 6d69 7474  e=\'OrderSubmitt
-00000c70: 6564 5c27 2c5c 6e20 2020 2064 6174 613d  ed\',\n    data=
-00000c80: 625c 277b 7d5c 275c 6e29 5c6e 6576 656e  b\'{}\'\n)\neven
-00000c90: 7433 203d 204e 6577 4576 656e 7428 5c6e  t3 = NewEvent(\n
-00000ca0: 2020 2020 7479 7065 3d5c 274f 7264 6572      type=\'Order
-00000cb0: 4361 6e63 656c 6c65 645c 272c 5c6e 2020  Cancelled\',\n  
-00000cc0: 2020 6461 7461 3d62 5c27 7b7d 5c27 5c6e    data=b\'{}\'\n
-00000cd0: 295c 6e5c 6e5c 6e23 2041 7070 656e 6420  )\n\n\n# Append 
-00000ce0: 6e65 7720 6576 656e 7473 2074 6f20 6120  new events to a 
-00000cf0: 6e65 7720 7374 7265 616d 2e20 5468 6520  new stream. The 
-00000d00: 7661 6c75 6520 7265 7475 726e 6564 5c6e  value returned\n
-00000d10: 2320 6672 6f6d 2074 6865 2061 7070 656e  # from the appen
-00000d20: 645f 746f 5f73 7472 6561 6d28 2920 6d65  d_to_stream() me
-00000d30: 7468 6f64 2069 7320 7468 6520 6f76 6572  thod is the over
-00000d40: 616c 6c5c 6e23 2022 636f 6d6d 6974 2070  all\n# "commit p
-00000d50: 6f73 6974 696f 6e22 2069 6e20 7468 6520  osition" in the 
-00000d60: 6461 7461 6261 7365 206f 6620 7468 6520  database of the 
-00000d70: 6c61 7374 206e 6577 2065 7665 6e74 5c6e  last new event\n
-00000d80: 2320 7265 636f 7264 6564 2062 7920 7468  # recorded by th
-00000d90: 6973 206f 7065 7261 7469 6f6e 2e20 5468  is operation. Th
-00000da0: 6520 7265 7475 726e 6564 2022 636f 6d6d  e returned "comm
-00000db0: 6974 2070 6f73 6974 696f 6e22 5c6e 2320  it position"\n# 
-00000dc0: 6d61 7920 6265 2075 7365 6420 696e 2061  may be used in a
-00000dd0: 2075 7365 7220 696e 7465 7266 6163 6520   user interface 
-00000de0: 746f 2070 6f6c 6c20 616e 2065 7665 6e74  to poll an event
-00000df0: 7561 6c6c 795c 6e23 2063 6f6e 7369 7374  ually\n# consist
-00000e00: 656e 7420 6576 656e 742d 7072 6f63 6573  ent event-proces
-00000e10: 7369 6e67 2063 6f6d 706f 6e65 6e74 2075  sing component u
-00000e20: 6e74 696c 2069 7420 6361 6e5c 6e23 2070  ntil it can\n# p
-00000e30: 7265 7365 6e74 2061 6e20 7570 2d74 6f2d  resent an up-to-
-00000e40: 6461 7465 206d 6174 6572 6961 6c69 7a65  date materialize
-00000e50: 6420 7669 6577 2e20 4e65 7720 6576 656e  d view. New even
-00000e60: 7473 2061 7265 5c6e 2320 6561 6368 2061  ts are\n# each a
-00000e70: 6c6c 6f63 6174 6564 2061 2022 7374 7265  llocated a "stre
-00000e80: 616d 2070 6f73 6974 696f 6e22 2c20 7768  am position", wh
-00000e90: 6963 6820 6973 2074 6865 206e 6578 745c  ich is the next\
-00000ea0: 6e23 2061 7661 696c 6162 6c65 2070 6f73  n# available pos
-00000eb0: 6974 696f 6e20 696e 2074 6865 2073 7472  ition in the str
-00000ec0: 6561 6d2c 2073 7461 7274 696e 6720 6672  eam, starting fr
-00000ed0: 6f6d 2030 2e5c 6e5c 6e63 6f6d 6d69 745f  om 0.\n\ncommit_
-00000ee0: 706f 7369 7469 6f6e 3120 3d20 636c 6965  position1 = clie
-00000ef0: 6e74 2e61 7070 656e 645f 746f 5f73 7472  nt.append_to_str
-00000f00: 6561 6d28 5c6e 2020 2020 7374 7265 616d  eam(\n    stream
-00000f10: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-00000f20: 6531 2c5c 6e20 2020 2063 7572 7265 6e74  e1,\n    current
-00000f30: 5f76 6572 7369 6f6e 3d53 7472 6561 6d53  _version=StreamS
-00000f40: 7461 7465 2e4e 4f5f 5354 5245 414d 2c5c  tate.NO_STREAM,\
-00000f50: 6e20 2020 2065 7665 6e74 733d 5b65 7665  n    events=[eve
-00000f60: 6e74 312c 2065 7665 6e74 325d 2c5c 6e29  nt1, event2],\n)
-00000f70: 5c6e 5c6e 2320 4170 7065 6e64 2065 7665  \n\n# Append eve
-00000f80: 6e74 7320 746f 2061 6e20 6578 6973 7469  nts to an existi
-00000f90: 6e67 2073 7472 6561 6d2e 2054 6865 2022  ng stream. The "
-00000fa0: 6375 7272 656e 7420 7665 7273 696f 6e22  current version"
-00000fb0: 5c6e 2320 6973 2074 6865 2022 7374 7265  \n# is the "stre
-00000fc0: 616d 2070 6f73 6974 696f 6e22 206f 6620  am position" of 
-00000fd0: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-00000fe0: 6420 6576 656e 7420 696e 2061 5c6e 2320  d event in a\n# 
-00000ff0: 7374 7265 616d 2e20 5765 2068 6176 6520  stream. We have 
-00001000: 7265 636f 7264 6564 2074 776f 206e 6577  recorded two new
-00001010: 2065 7665 6e74 732c 2073 6f20 7468 6520   events, so the 
-00001020: 2263 7572 7265 6e74 5c6e 2320 7665 7273  "current\n# vers
-00001030: 696f 6e22 2069 7320 312e 2054 6865 2065  ion" is 1. The e
-00001040: 7863 6570 7469 6f6e 205c 2757 726f 6e67  xception \'Wrong
-00001050: 4375 7272 656e 7456 6572 7369 6f6e 5c27  CurrentVersion\'
-00001060: 2077 696c 6c20 6265 5c6e 2320 7261 6973   will be\n# rais
-00001070: 6564 2069 6620 616e 2069 6e63 6f72 7265  ed if an incorre
-00001080: 6374 2076 616c 7565 2069 7320 6769 7665  ct value is give
-00001090: 6e2e 5c6e 5c6e 636f 6d6d 6974 5f70 6f73  n.\n\ncommit_pos
-000010a0: 6974 696f 6e32 203d 2063 6c69 656e 742e  ition2 = client.
-000010b0: 6170 7065 6e64 5f74 6f5f 7374 7265 616d  append_to_stream
-000010c0: 285c 6e20 2020 2073 7472 6561 6d5f 6e61  (\n    stream_na
-000010d0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 312c  me=stream_name1,
-000010e0: 5c6e 2020 2020 6375 7272 656e 745f 7665  \n    current_ve
-000010f0: 7273 696f 6e3d 312c 5c6e 2020 2020 6576  rsion=1,\n    ev
-00001100: 656e 7473 3d5b 6576 656e 7433 5d2c 5c6e  ents=[event3],\n
-00001110: 295c 6e5c 6e23 202d 2061 6c6c 6f63 6174  )\n\n# - allocat
-00001120: 6564 2063 6f6d 6d69 7420 706f 7369 7469  ed commit positi
-00001130: 6f6e 7320 696e 6372 6561 7365 206d 6f6e  ons increase mon
-00001140: 6f74 6f6e 6963 616c 6c79 5c6e 6173 7365  otonically\nasse
-00001150: 7274 2063 6f6d 6d69 745f 706f 7369 7469  rt commit_positi
-00001160: 6f6e 3220 3e20 636f 6d6d 6974 5f70 6f73  on2 > commit_pos
-00001170: 6974 696f 6e31 5c6e 5c6e 5c6e 2320 5265  ition1\n\n\n# Re
-00001180: 6164 2065 7665 6e74 7320 6672 6f6d 2061  ad events from a
-00001190: 2073 7472 6561 6d2e 2054 6869 7320 6d65   stream. This me
-000011a0: 7468 6f64 2072 6574 7572 6e73 2061 5c6e  thod returns a\n
-000011b0: 2320 2272 6561 6420 7265 7370 6f6e 7365  # "read response
-000011c0: 2220 6974 6572 6174 6f72 2c20 7768 6963  " iterator, whic
-000011d0: 6820 7265 7475 726e 7320 7265 636f 7264  h returns record
-000011e0: 6564 5c6e 2320 6576 656e 7473 2e20 5468  ed\n# events. Th
-000011f0: 6520 6974 6572 6174 6f72 2077 696c 6c20  e iterator will 
-00001200: 7374 6f70 2077 6865 6e20 7468 6572 6520  stop when there 
-00001210: 6172 6520 6e6f 5c6e 2320 6d6f 7265 2065  are no\n# more e
-00001220: 7665 6e74 7320 746f 2062 6520 7265 7475  vents to be retu
-00001230: 726e 6564 2e5c 6e5c 6e72 6561 645f 7265  rned.\n\nread_re
-00001240: 7370 6f6e 7365 203d 2063 6c69 656e 742e  sponse = client.
-00001250: 7265 6164 5f73 7472 6561 6d28 5c6e 2020  read_stream(\n  
-00001260: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-00001270: 7265 616d 5f6e 616d 6531 5c6e 295c 6e5c  ream_name1\n)\n\
-00001280: 6e23 2049 7465 7261 7465 206f 7665 7220  n# Iterate over 
-00001290: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
-000012a0: 746f 2067 6574 2072 6563 6f72 6465 6420  to get recorded 
-000012b0: 6576 656e 7473 2e5c 6e23 2054 6865 2072  events.\n# The r
-000012c0: 6563 6f72 6465 6420 6576 656e 7473 206d  ecorded events m
-000012d0: 6179 2062 6520 6465 7365 7269 616c 697a  ay be deserializ
-000012e0: 6564 2074 6f20 646f 6d61 696e 2065 7665  ed to domain eve
-000012f0: 6e74 5c6e 2320 6f62 6a65 6374 7320 6f66  nt\n# objects of
-00001300: 2064 6966 6665 7265 6e74 2074 7970 6573   different types
-00001310: 2061 6e64 2075 7365 6420 746f 2072 6563   and used to rec
-00001320: 6f6e 7374 7275 6374 2061 6e5c 6e23 2061  onstruct an\n# a
-00001330: 6767 7265 6761 7465 2069 6e20 6120 646f  ggregate in a do
-00001340: 6d61 696e 206d 6f64 656c 2e5c 6e72 6563  main model.\nrec
-00001350: 6f72 6465 645f 6576 656e 7473 203d 2074  orded_events = t
-00001360: 7570 6c65 2872 6561 645f 7265 7370 6f6e  uple(read_respon
-00001370: 7365 295c 6e5c 6e23 202d 2073 7472 6561  se)\n\n# - strea
-00001380: 6d20 5c27 7374 7265 616d 5f6e 616d 6531  m \'stream_name1
-00001390: 5c27 206e 6f77 2068 6173 2074 6872 6565  \' now has three
-000013a0: 2065 7665 6e74 735c 6e61 7373 6572 7420   events\nassert 
-000013b0: 6c65 6e28 7265 636f 7264 6564 5f65 7665  len(recorded_eve
-000013c0: 6e74 7329 203d 3d20 335c 6e5c 6e23 202d  nts) == 3\n\n# -
-000013d0: 2061 6c6c 6f63 6174 6564 2073 7472 6561   allocated strea
-000013e0: 6d20 706f 7369 7469 6f6e 7320 6172 6520  m positions are 
-000013f0: 7a65 726f 2d62 6173 6564 2061 6e64 2067  zero-based and g
-00001400: 6170 6c65 7373 5c6e 6173 7365 7274 2072  apless\nassert r
-00001410: 6563 6f72 6465 645f 6576 656e 7473 5b30  ecorded_events[0
-00001420: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-00001430: 6e20 3d3d 2030 5c6e 6173 7365 7274 2072  n == 0\nassert r
-00001440: 6563 6f72 6465 645f 6576 656e 7473 5b31  ecorded_events[1
-00001450: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-00001460: 6e20 3d3d 2031 5c6e 6173 7365 7274 2072  n == 1\nassert r
-00001470: 6563 6f72 6465 645f 6576 656e 7473 5b32  ecorded_events[2
-00001480: 5d2e 7374 7265 616d 5f70 6f73 6974 696f  ].stream_positio
-00001490: 6e20 3d3d 2032 5c6e 5c6e 2320 2d20 6576  n == 2\n\n# - ev
-000014a0: 656e 7420 6174 7472 6962 7574 6520 7661  ent attribute va
-000014b0: 6c75 6573 2061 7265 2072 6563 6f72 6465  lues are recorde
-000014c0: 6420 6661 6974 6866 756c 6c79 5c6e 6173  d faithfully\nas
-000014d0: 7365 7274 2072 6563 6f72 6465 645f 6576  sert recorded_ev
-000014e0: 656e 7473 5b30 5d2e 7479 7065 203d 3d20  ents[0].type == 
-000014f0: 224f 7264 6572 4372 6561 7465 6422 5c6e  "OrderCreated"\n
-00001500: 6173 7365 7274 2072 6563 6f72 6465 645f  assert recorded_
-00001510: 6576 656e 7473 5b30 5d2e 6461 7461 203d  events[0].data =
-00001520: 3d20 625c 277b 226f 7264 6572 5f6e 756d  = b\'{"order_num
-00001530: 6265 7222 3a20 2231 3233 3435 3622 7d5c  ber": "123456"}\
-00001540: 275c 6e61 7373 6572 7420 7265 636f 7264  '\nassert record
-00001550: 6564 5f65 7665 6e74 735b 305d 2e69 6420  ed_events[0].id 
-00001560: 3d3d 2065 7665 6e74 312e 6964 5c6e 5c6e  == event1.id\n\n
-00001570: 6173 7365 7274 2072 6563 6f72 6465 645f  assert recorded_
-00001580: 6576 656e 7473 5b31 5d2e 7479 7065 203d  events[1].type =
-00001590: 3d20 224f 7264 6572 5375 626d 6974 7465  = "OrderSubmitte
-000015a0: 6422 5c6e 6173 7365 7274 2072 6563 6f72  d"\nassert recor
-000015b0: 6465 645f 6576 656e 7473 5b31 5d2e 6461  ded_events[1].da
-000015c0: 7461 203d 3d20 625c 277b 7d5c 275c 6e61  ta == b\'{}\'\na
-000015d0: 7373 6572 7420 7265 636f 7264 6564 5f65  ssert recorded_e
-000015e0: 7665 6e74 735b 315d 2e69 6420 3d3d 2065  vents[1].id == e
-000015f0: 7665 6e74 322e 6964 5c6e 5c6e 6173 7365  vent2.id\n\nasse
-00001600: 7274 2072 6563 6f72 6465 645f 6576 656e  rt recorded_even
-00001610: 7473 5b32 5d2e 7479 7065 203d 3d20 224f  ts[2].type == "O
-00001620: 7264 6572 4361 6e63 656c 6c65 6422 5c6e  rderCancelled"\n
-00001630: 6173 7365 7274 2072 6563 6f72 6465 645f  assert recorded_
-00001640: 6576 656e 7473 5b32 5d2e 6461 7461 203d  events[2].data =
-00001650: 3d20 625c 277b 7d5c 275c 6e61 7373 6572  = b\'{}\'\nasser
-00001660: 7420 7265 636f 7264 6564 5f65 7665 6e74  t recorded_event
-00001670: 735b 325d 2e69 6420 3d3d 2065 7665 6e74  s[2].id == event
-00001680: 332e 6964 5c6e 5c6e 5c6e 2320 5374 6172  3.id\n\n\n# Star
-00001690: 7420 6120 6361 7463 682d 7570 2073 7562  t a catch-up sub
-000016a0: 7363 7269 7074 696f 6e20 6672 6f6d 206c  scription from l
-000016b0: 6173 7420 7265 636f 7264 6564 2070 6f73  ast recorded pos
-000016c0: 6974 696f 6e2e 5c6e 2320 5468 6973 206d  ition.\n# This m
-000016d0: 6574 686f 6420 7265 7475 726e 7320 6120  ethod returns a 
-000016e0: 2263 6174 6368 2d75 7020 7375 6273 6372  "catch-up subscr
-000016f0: 6970 7469 6f6e 2220 6974 6572 6174 6f72  iption" iterator
-00001700: 2c5c 6e23 2077 6869 6368 2072 6574 7572  ,\n# which retur
-00001710: 6e73 2072 6563 6f72 6465 6420 6576 656e  ns recorded even
-00001720: 7473 2e20 5468 6520 6974 6572 6174 6f72  ts. The iterator
-00001730: 2077 696c 6c20 6e6f 7420 7374 6f70 5c6e   will not stop\n
-00001740: 2320 7768 656e 2074 6865 7265 2061 7265  # when there are
-00001750: 206e 6f20 6d6f 7265 2072 6563 6f72 6465   no more recorde
-00001760: 6420 6576 656e 7473 2074 6f20 6265 2072  d events to be r
-00001770: 6574 7572 6e65 642c 2062 7574 5c6e 2320  eturned, but\n# 
-00001780: 7769 6c6c 2062 6c6f 636b 2c20 616e 6420  will block, and 
-00001790: 636f 6e74 696e 7565 2077 6865 6e20 6675  continue when fu
-000017a0: 7274 6865 7220 6576 656e 7473 2061 7265  rther events are
-000017b0: 2072 6563 6f72 6465 642e 5c6e 5c6e 6361   recorded.\n\nca
-000017c0: 7463 6875 705f 7375 6273 6372 6970 7469  tchup_subscripti
-000017d0: 6f6e 203d 2063 6c69 656e 742e 7375 6273  on = client.subs
-000017e0: 6372 6962 655f 746f 5f61 6c6c 2829 5c6e  cribe_to_all()\n
-000017f0: 5c6e 5c6e 2320 4974 6572 6174 6520 6f76  \n\n# Iterate ov
-00001800: 6572 2074 6865 2063 6174 6368 2d75 7020  er the catch-up 
-00001810: 7375 6273 6372 6970 7469 6f6e 2e20 5072  subscription. Pr
-00001820: 6f63 6573 7320 6561 6368 2072 6563 6f72  ocess each recor
-00001830: 6465 645c 6e23 2065 7665 6e74 2069 6e20  ded\n# event in 
-00001840: 7475 726e 2e20 5769 7468 696e 2061 6e20  turn. Within an 
-00001850: 6174 6f6d 6963 2064 6174 6162 6173 6520  atomic database 
-00001860: 7472 616e 7361 6374 696f 6e2c 2072 6563  transaction, rec
-00001870: 6f72 645c 6e23 2074 6865 2065 7665 6e74  ord\n# the event
-00001880: 5c27 7320 2263 6f6d 6d69 7420 706f 7369  \'s "commit posi
-00001890: 7469 6f6e 2220 616c 6f6e 6720 7769 7468  tion" along with
-000018a0: 2061 6e79 206e 6577 2073 7461 7465 2067   any new state g
-000018b0: 656e 6572 6174 6564 5c6e 2320 6279 2070  enerated\n# by p
-000018c0: 726f 6365 7373 696e 6720 7468 6520 6576  rocessing the ev
-000018d0: 656e 742e 2055 7365 2074 6865 2063 6f6d  ent. Use the com
-000018e0: 706f 6e65 6e74 5c27 7320 6c61 7374 2072  ponent\'s last r
-000018f0: 6563 6f72 6465 6420 636f 6d6d 6974 5c6e  ecorded commit\n
-00001900: 2320 706f 7369 7469 6f6e 2077 6865 6e20  # position when 
-00001910: 7265 7374 6172 7469 6e67 2074 6865 2063  restarting the c
-00001920: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
-00001930: 7469 6f6e 2e5c 6e5c 6e72 6563 6569 7665  tion.\n\nreceive
-00001940: 645f 6576 656e 7473 203d 205b 5d5c 6e66  d_events = []\nf
-00001950: 6f72 2065 7665 6e74 2069 6e20 6361 7463  or event in catc
-00001960: 6875 705f 7375 6273 6372 6970 7469 6f6e  hup_subscription
-00001970: 3a5c 6e20 2020 2072 6563 6569 7665 645f  :\n    received_
-00001980: 6576 656e 7473 2e61 7070 656e 6428 6576  events.append(ev
-00001990: 656e 7429 5c6e 5c6e 2020 2020 6966 2065  ent)\n\n    if e
-000019a0: 7665 6e74 2e63 6f6d 6d69 745f 706f 7369  vent.commit_posi
-000019b0: 7469 6f6e 203d 3d20 636f 6d6d 6974 5f70  tion == commit_p
-000019c0: 6f73 6974 696f 6e32 3a5c 6e20 2020 2020  osition2:\n     
-000019d0: 2020 2023 2042 7265 616b 2073 6f20 7765     # Break so we
-000019e0: 2063 616e 2063 6f6e 7469 6e75 6520 7769   can continue wi
-000019f0: 7468 2074 6865 2065 7861 6d70 6c65 2e5c  th the example.\
-00001a00: 6e20 2020 2020 2020 2062 7265 616b 5c6e  n        break\n
-00001a10: 5c6e 5c6e 2320 2d20 6576 656e 7473 2061  \n\n# - events a
-00001a20: 7265 2072 6563 6569 7665 6420 696e 2074  re received in t
-00001a30: 6865 206f 7264 6572 2074 6865 7920 7765  he order they we
-00001a40: 7265 2072 6563 6f72 6465 645c 6e61 7373  re recorded\nass
-00001a50: 6572 7420 7265 6365 6976 6564 5f65 7665  ert received_eve
-00001a60: 6e74 735b 2d33 5d2e 7479 7065 203d 3d20  nts[-3].type == 
-00001a70: 224f 7264 6572 4372 6561 7465 6422 5c6e  "OrderCreated"\n
-00001a80: 6173 7365 7274 2072 6563 6569 7665 645f  assert received_
-00001a90: 6576 656e 7473 5b2d 335d 2e64 6174 6120  events[-3].data 
-00001aa0: 3d3d 2062 5c27 7b22 6f72 6465 725f 6e75  == b\'{"order_nu
-00001ab0: 6d62 6572 223a 2022 3132 3334 3536 227d  mber": "123456"}
-00001ac0: 5c27 5c6e 6173 7365 7274 2072 6563 6569  \'\nassert recei
-00001ad0: 7665 645f 6576 656e 7473 5b2d 335d 2e69  ved_events[-3].i
-00001ae0: 6420 3d3d 2065 7665 6e74 312e 6964 5c6e  d == event1.id\n
-00001af0: 5c6e 6173 7365 7274 2072 6563 6569 7665  \nassert receive
-00001b00: 645f 6576 656e 7473 5b2d 325d 2e74 7970  d_events[-2].typ
-00001b10: 6520 3d3d 2022 4f72 6465 7253 7562 6d69  e == "OrderSubmi
-00001b20: 7474 6564 225c 6e61 7373 6572 7420 7265  tted"\nassert re
-00001b30: 6365 6976 6564 5f65 7665 6e74 735b 2d32  ceived_events[-2
-00001b40: 5d2e 6461 7461 203d 3d20 625c 277b 7d5c  ].data == b\'{}\
-00001b50: 275c 6e61 7373 6572 7420 7265 6365 6976  '\nassert receiv
-00001b60: 6564 5f65 7665 6e74 735b 2d32 5d2e 6964  ed_events[-2].id
-00001b70: 203d 3d20 6576 656e 7432 2e69 645c 6e5c   == event2.id\n\
-00001b80: 6e61 7373 6572 7420 7265 6365 6976 6564  nassert received
-00001b90: 5f65 7665 6e74 735b 2d31 5d2e 7479 7065  _events[-1].type
-00001ba0: 203d 3d20 224f 7264 6572 4361 6e63 656c   == "OrderCancel
-00001bb0: 6c65 6422 5c6e 6173 7365 7274 2072 6563  led"\nassert rec
-00001bc0: 6569 7665 645f 6576 656e 7473 5b2d 315d  eived_events[-1]
-00001bd0: 2e64 6174 6120 3d3d 2062 5c27 7b7d 5c27  .data == b\'{}\'
-00001be0: 5c6e 6173 7365 7274 2072 6563 6569 7665  \nassert receive
-00001bf0: 645f 6576 656e 7473 5b2d 315d 2e69 6420  d_events[-1].id 
-00001c00: 3d3d 2065 7665 6e74 332e 6964 5c6e 5c6e  == event3.id\n\n
-00001c10: 5c6e 2320 5374 6f70 2074 6865 2063 6174  \n# Stop the cat
-00001c20: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-00001c30: 6f6e 2069 7465 7261 746f 722e 5c6e 5c6e  on iterator.\n\n
-00001c40: 6361 7463 6875 705f 7375 6273 6372 6970  catchup_subscrip
-00001c50: 7469 6f6e 2e73 746f 7028 295c 6e5c 6e5c  tion.stop()\n\n\
-00001c60: 6e23 2043 6c6f 7365 2074 6865 2063 6c69  n# Close the cli
-00001c70: 656e 745c 2773 2067 5250 4320 636f 6e6e  ent\'s gRPC conn
-00001c80: 6563 7469 6f6e 2e5c 6e5c 6e63 6c69 656e  ection.\n\nclien
-00001c90: 742e 636c 6f73 6528 295c 6e60 6060 5c6e  t.close()\n```\n
-00001ca0: 5c6e 5365 6520 6265 6c6f 7720 666f 7220  \nSee below for 
-00001cb0: 6d6f 7265 2064 6574 6169 6c73 2e5c 6e5c  more details.\n\
-00001cc0: 6e46 6f72 2061 6e20 6578 616d 706c 6520  nFor an example 
-00001cd0: 6f66 2075 7361 6765 2c20 7365 6520 7468  of usage, see th
-00001ce0: 6520 5b65 7665 6e74 736f 7572 6369 6e67  e [eventsourcing
-00001cf0: 2d65 7665 6e74 7374 6f72 6564 625d 285c  -eventstoredb](\
-00001d00: 6e68 7474 7073 3a2f 2f67 6974 6875 622e  nhttps://github.
-00001d10: 636f 6d2f 7079 6576 656e 7473 6f75 7263  com/pyeventsourc
-00001d20: 696e 672f 6576 656e 7473 6f75 7263 696e  ing/eventsourcin
-00001d30: 672d 6576 656e 7473 746f 7265 6462 2920  g-eventstoredb) 
-00001d40: 7061 636b 6167 652e 5c6e 5c6e 2323 2054  package.\n\n## T
-00001d50: 6162 6c65 206f 6620 636f 6e74 656e 7473  able of contents
-00001d60: 5c6e 5c6e 3c21 2d2d 2054 4f43 202d 2d3e  \n\n<!-- TOC -->
-00001d70: 5c6e 2a20 5b49 6e73 7461 6c6c 2070 6163  \n* [Install pac
-00001d80: 6b61 6765 5d28 2369 6e73 7461 6c6c 2d70  kage](#install-p
-00001d90: 6163 6b61 6765 295c 6e20 202a 205b 4672  ackage)\n  * [Fr
-00001da0: 6f6d 2050 7950 495d 2823 6672 6f6d 2d70  om PyPI](#from-p
-00001db0: 7970 6929 5c6e 2020 2a20 5b57 6974 6820  ypi)\n  * [With 
-00001dc0: 506f 6574 7279 5d28 2377 6974 682d 706f  Poetry](#with-po
-00001dd0: 6574 7279 295c 6e2a 205b 4576 656e 7453  etry)\n* [EventS
-00001de0: 746f 7265 4442 2073 6572 7665 725d 2823  toreDB server](#
-00001df0: 6576 656e 7473 746f 7265 6462 2d73 6572  eventstoredb-ser
-00001e00: 7665 7229 5c6e 2020 2a20 5b52 756e 2063  ver)\n  * [Run c
-00001e10: 6f6e 7461 696e 6572 5d28 2372 756e 2d63  ontainer](#run-c
-00001e20: 6f6e 7461 696e 6572 295c 6e20 202a 205b  ontainer)\n  * [
-00001e30: 5374 6f70 2063 6f6e 7461 696e 6572 5d28  Stop container](
-00001e40: 2373 746f 702d 636f 6e74 6169 6e65 7229  #stop-container)
-00001e50: 5c6e 2a20 5b45 7665 6e74 5374 6f72 6544  \n* [EventStoreD
-00001e60: 4220 636c 6965 6e74 5d28 2365 7665 6e74  B client](#event
-00001e70: 7374 6f72 6564 622d 636c 6965 6e74 295c  storedb-client)\
-00001e80: 6e20 202a 205b 496d 706f 7274 2063 6c61  n  * [Import cla
-00001e90: 7373 5d28 2369 6d70 6f72 742d 636c 6173  ss](#import-clas
-00001ea0: 7329 5c6e 2020 2a20 5b43 6f6e 7374 7275  s)\n  * [Constru
-00001eb0: 6374 2063 6c69 656e 745d 2823 636f 6e73  ct client](#cons
-00001ec0: 7472 7563 742d 636c 6965 6e74 295c 6e2a  truct-client)\n*
-00001ed0: 205b 436f 6e6e 6563 7469 6f6e 2073 7472   [Connection str
-00001ee0: 696e 6773 5d28 2363 6f6e 6e65 6374 696f  ings](#connectio
-00001ef0: 6e2d 7374 7269 6e67 7329 5c6e 2020 2a20  n-strings)\n  * 
-00001f00: 5b54 776f 2073 6368 656d 6573 5d28 2374  [Two schemes](#t
-00001f10: 776f 2d73 6368 656d 6573 295c 6e20 202a  wo-schemes)\n  *
-00001f20: 205b 5573 6572 2069 6e66 6f20 7374 7269   [User info stri
-00001f30: 6e67 5d28 2375 7365 722d 696e 666f 2d73  ng](#user-info-s
-00001f40: 7472 696e 6729 5c6e 2020 2a20 5b51 7565  tring)\n  * [Que
-00001f50: 7279 2073 7472 696e 675d 2823 7175 6572  ry string](#quer
-00001f60: 792d 7374 7269 6e67 295c 6e20 202a 205b  y-string)\n  * [
-00001f70: 4578 616d 706c 6573 5d28 2365 7861 6d70  Examples](#examp
-00001f80: 6c65 7329 5c6e 2a20 5b45 7665 6e74 206f  les)\n* [Event o
-00001f90: 626a 6563 7473 5d28 2365 7665 6e74 2d6f  bjects](#event-o
-00001fa0: 626a 6563 7473 295c 6e20 202a 205b 4e65  bjects)\n  * [Ne
-00001fb0: 7720 6576 656e 7473 5d28 236e 6577 2d65  w events](#new-e
-00001fc0: 7665 6e74 7329 5c6e 2020 2a20 5b52 6563  vents)\n  * [Rec
-00001fd0: 6f72 6465 6420 6576 656e 7473 5d28 2372  orded events](#r
-00001fe0: 6563 6f72 6465 642d 6576 656e 7473 295c  ecorded-events)\
-00001ff0: 6e2a 205b 5374 7265 616d 735d 2823 7374  n* [Streams](#st
-00002000: 7265 616d 7329 5c6e 2020 2a20 5b41 7070  reams)\n  * [App
-00002010: 656e 6420 6576 656e 7473 5d28 2361 7070  end events](#app
-00002020: 656e 642d 6576 656e 7473 295c 6e20 202a  end-events)\n  *
-00002030: 205b 4964 656d 706f 7465 6e74 2061 7070   [Idempotent app
-00002040: 656e 6420 6f70 6572 6174 696f 6e73 5d28  end operations](
-00002050: 2369 6465 6d70 6f74 656e 742d 6170 7065  #idempotent-appe
-00002060: 6e64 2d6f 7065 7261 7469 6f6e 7329 5c6e  nd-operations)\n
-00002070: 2020 2a20 5b52 6561 6420 7374 7265 616d    * [Read stream
-00002080: 2065 7665 6e74 735d 2823 7265 6164 2d73   events](#read-s
-00002090: 7472 6561 6d2d 6576 656e 7473 295c 6e20  tream-events)\n 
-000020a0: 202a 205b 4765 7420 6375 7272 656e 7420   * [Get current 
-000020b0: 7665 7273 696f 6e5d 2823 6765 742d 6375  version](#get-cu
-000020c0: 7272 656e 742d 7665 7273 696f 6e29 5c6e  rrent-version)\n
-000020d0: 2020 2a20 5b48 6f77 2074 6f20 696d 706c    * [How to impl
-000020e0: 656d 656e 7420 736e 6170 7368 6f74 7469  ement snapshotti
-000020f0: 6e67 2077 6974 6820 4576 656e 7453 746f  ng with EventSto
-00002100: 7265 4442 5d28 2368 6f77 2d74 6f2d 696d  reDB](#how-to-im
-00002110: 706c 656d 656e 742d 736e 6170 7368 6f74  plement-snapshot
-00002120: 7469 6e67 2d77 6974 682d 6576 656e 7473  ting-with-events
-00002130: 746f 7265 6462 295c 6e20 202a 205b 5265  toredb)\n  * [Re
-00002140: 6164 2061 6c6c 2065 7665 6e74 735d 2823  ad all events](#
-00002150: 7265 6164 2d61 6c6c 2d65 7665 6e74 7329  read-all-events)
-00002160: 5c6e 2020 2a20 5b47 6574 2063 6f6d 6d69  \n  * [Get commi
-00002170: 7420 706f 7369 7469 6f6e 5d28 2367 6574  t position](#get
-00002180: 2d63 6f6d 6d69 742d 706f 7369 7469 6f6e  -commit-position
-00002190: 295c 6e20 202a 205b 4765 7420 7374 7265  )\n  * [Get stre
-000021a0: 616d 206d 6574 6164 6174 615d 2823 6765  am metadata](#ge
-000021b0: 742d 7374 7265 616d 2d6d 6574 6164 6174  t-stream-metadat
-000021c0: 6129 5c6e 2020 2a20 5b53 6574 2073 7472  a)\n  * [Set str
-000021d0: 6561 6d20 6d65 7461 6461 7461 5d28 2373  eam metadata](#s
-000021e0: 6574 2d73 7472 6561 6d2d 6d65 7461 6461  et-stream-metada
-000021f0: 7461 295c 6e20 202a 205b 4465 6c65 7465  ta)\n  * [Delete
-00002200: 2073 7472 6561 6d5d 2823 6465 6c65 7465   stream](#delete
-00002210: 2d73 7472 6561 6d29 5c6e 2020 2a20 5b54  -stream)\n  * [T
-00002220: 6f6d 6273 746f 6e65 2073 7472 6561 6d5d  ombstone stream]
-00002230: 2823 746f 6d62 7374 6f6e 652d 7374 7265  (#tombstone-stre
-00002240: 616d 295c 6e2a 205b 4361 7463 682d 7570  am)\n* [Catch-up
-00002250: 2073 7562 7363 7269 7074 696f 6e73 5d28   subscriptions](
-00002260: 2363 6174 6368 2d75 702d 7375 6273 6372  #catch-up-subscr
-00002270: 6970 7469 6f6e 7329 5c6e 2020 2a20 5b53  iptions)\n  * [S
-00002280: 7562 7363 7269 6265 2074 6f20 616c 6c20  ubscribe to all 
-00002290: 6576 656e 7473 5d28 2373 7562 7363 7269  events](#subscri
-000022a0: 6265 2d74 6f2d 616c 6c2d 6576 656e 7473  be-to-all-events
-000022b0: 295c 6e20 202a 205b 5375 6273 6372 6962  )\n  * [Subscrib
-000022c0: 6520 746f 2073 7472 6561 6d20 6576 656e  e to stream even
-000022d0: 7473 5d28 2373 7562 7363 7269 6265 2d74  ts](#subscribe-t
-000022e0: 6f2d 7374 7265 616d 2d65 7665 6e74 7329  o-stream-events)
-000022f0: 5c6e 2020 2a20 5b48 6f77 2074 6f20 696d  \n  * [How to im
-00002300: 706c 656d 656e 7420 6578 6163 746c 792d  plement exactly-
-00002310: 6f6e 6365 2065 7665 6e74 2070 726f 6365  once event proce
-00002320: 7373 696e 675d 2823 686f 772d 746f 2d69  ssing](#how-to-i
-00002330: 6d70 6c65 6d65 6e74 2d65 7861 6374 6c79  mplement-exactly
-00002340: 2d6f 6e63 652d 6576 656e 742d 7072 6f63  -once-event-proc
-00002350: 6573 7369 6e67 295c 6e2a 205b 5065 7273  essing)\n* [Pers
-00002360: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00002370: 696f 6e73 5d28 2370 6572 7369 7374 656e  ions](#persisten
-00002380: 742d 7375 6273 6372 6970 7469 6f6e 7329  t-subscriptions)
-00002390: 5c6e 2020 2a20 5b43 7265 6174 6520 7375  \n  * [Create su
-000023a0: 6273 6372 6970 7469 6f6e 2074 6f20 616c  bscription to al
-000023b0: 6c5d 2823 6372 6561 7465 2d73 7562 7363  l](#create-subsc
-000023c0: 7269 7074 696f 6e2d 746f 2d61 6c6c 295c  ription-to-all)\
-000023d0: 6e20 202a 205b 5265 6164 2073 7562 7363  n  * [Read subsc
-000023e0: 7269 7074 696f 6e20 746f 2061 6c6c 5d28  ription to all](
-000023f0: 2372 6561 642d 7375 6273 6372 6970 7469  #read-subscripti
-00002400: 6f6e 2d74 6f2d 616c 6c29 5c6e 2020 2a20  on-to-all)\n  * 
-00002410: 5b48 6f77 2074 6f20 7772 6974 6520 6120  [How to write a 
-00002420: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00002430: 7269 7074 696f 6e20 636f 6e73 756d 6572  ription consumer
-00002440: 5d28 2368 6f77 2d74 6f2d 7772 6974 652d  ](#how-to-write-
-00002450: 612d 7065 7273 6973 7465 6e74 2d73 7562  a-persistent-sub
-00002460: 7363 7269 7074 696f 6e2d 636f 6e73 756d  scription-consum
-00002470: 6572 295c 6e20 202a 205b 5570 6461 7465  er)\n  * [Update
-00002480: 2073 7562 7363 7269 7074 696f 6e20 746f   subscription to
-00002490: 2061 6c6c 5d28 2375 7064 6174 652d 7375   all](#update-su
-000024a0: 6273 6372 6970 7469 6f6e 2d74 6f2d 616c  bscription-to-al
-000024b0: 6c29 5c6e 2020 2a20 5b43 7265 6174 6520  l)\n  * [Create 
-000024c0: 7375 6273 6372 6970 7469 6f6e 2074 6f20  subscription to 
-000024d0: 7374 7265 616d 5d28 2363 7265 6174 652d  stream](#create-
-000024e0: 7375 6273 6372 6970 7469 6f6e 2d74 6f2d  subscription-to-
-000024f0: 7374 7265 616d 295c 6e20 202a 205b 5265  stream)\n  * [Re
-00002500: 6164 2073 7562 7363 7269 7074 696f 6e20  ad subscription 
-00002510: 746f 2073 7472 6561 6d5d 2823 7265 6164  to stream](#read
-00002520: 2d73 7562 7363 7269 7074 696f 6e2d 746f  -subscription-to
-00002530: 2d73 7472 6561 6d29 5c6e 2020 2a20 5b55  -stream)\n  * [U
-00002540: 7064 6174 6520 7375 6273 6372 6970 7469  pdate subscripti
-00002550: 6f6e 2074 6f20 7374 7265 616d 5d28 2375  on to stream](#u
-00002560: 7064 6174 652d 7375 6273 6372 6970 7469  pdate-subscripti
-00002570: 6f6e 2d74 6f2d 7374 7265 616d 295c 6e20  on-to-stream)\n 
-00002580: 202a 205b 5265 706c 6179 2070 6172 6b65   * [Replay parke
-00002590: 6420 6576 656e 7473 5d28 2372 6570 6c61  d events](#repla
-000025a0: 792d 7061 726b 6564 2d65 7665 6e74 7329  y-parked-events)
-000025b0: 5c6e 2020 2a20 5b47 6574 2073 7562 7363  \n  * [Get subsc
-000025c0: 7269 7074 696f 6e20 696e 666f 5d28 2367  ription info](#g
-000025d0: 6574 2d73 7562 7363 7269 7074 696f 6e2d  et-subscription-
-000025e0: 696e 666f 295c 6e20 202a 205b 4c69 7374  info)\n  * [List
-000025f0: 2073 7562 7363 7269 7074 696f 6e73 5d28   subscriptions](
-00002600: 236c 6973 742d 7375 6273 6372 6970 7469  #list-subscripti
-00002610: 6f6e 7329 5c6e 2020 2a20 5b4c 6973 7420  ons)\n  * [List 
-00002620: 7375 6273 6372 6970 7469 6f6e 7320 746f  subscriptions to
-00002630: 2073 7472 6561 6d5d 2823 6c69 7374 2d73   stream](#list-s
-00002640: 7562 7363 7269 7074 696f 6e73 2d74 6f2d  ubscriptions-to-
-00002650: 7374 7265 616d 295c 6e20 202a 205b 4465  stream)\n  * [De
-00002660: 6c65 7465 2073 7562 7363 7269 7074 696f  lete subscriptio
-00002670: 6e5d 2823 6465 6c65 7465 2d73 7562 7363  n](#delete-subsc
-00002680: 7269 7074 696f 6e29 5c6e 2a20 5b43 616c  ription)\n* [Cal
-00002690: 6c20 6372 6564 656e 7469 616c 735d 2823  l credentials](#
-000026a0: 6361 6c6c 2d63 7265 6465 6e74 6961 6c73  call-credentials
-000026b0: 295c 6e20 202a 205b 436f 6e73 7472 7563  )\n  * [Construc
-000026c0: 7420 6361 6c6c 2063 7265 6465 6e74 6961  t call credentia
-000026d0: 6c73 5d28 2363 6f6e 7374 7275 6374 2d63  ls](#construct-c
-000026e0: 616c 6c2d 6372 6564 656e 7469 616c 7329  all-credentials)
-000026f0: 5c6e 2a20 5b43 6f6e 6e65 6374 696f 6e5d  \n* [Connection]
-00002700: 2823 636f 6e6e 6563 7469 6f6e 295c 6e20  (#connection)\n 
-00002710: 202a 205b 5265 636f 6e6e 6563 745d 2823   * [Reconnect](#
-00002720: 7265 636f 6e6e 6563 7429 5c6e 2020 2a20  reconnect)\n  * 
-00002730: 5b43 6c6f 7365 5d28 2363 6c6f 7365 295c  [Close](#close)\
-00002740: 6e2a 205b 4173 796e 6369 6f20 636c 6965  n* [Asyncio clie
-00002750: 6e74 5d28 2361 7379 6e63 696f 2d63 6c69  nt](#asyncio-cli
-00002760: 656e 7429 5c6e 2020 2a20 5b53 796e 6f70  ent)\n  * [Synop
-00002770: 7369 735d 2823 7379 6e6f 7073 6973 2d31  sis](#synopsis-1
-00002780: 295c 6e2a 205b 4e6f 7465 735d 2823 6e6f  )\n* [Notes](#no
-00002790: 7465 7329 5c6e 2020 2a20 5b52 6567 756c  tes)\n  * [Regul
-000027a0: 6172 2065 7870 7265 7373 696f 6e20 6669  ar expression fi
-000027b0: 6c74 6572 735d 2823 7265 6775 6c61 722d  lters](#regular-
-000027c0: 6578 7072 6573 7369 6f6e 2d66 696c 7465  expression-filte
-000027d0: 7273 295c 6e20 202a 205b 5265 636f 6e6e  rs)\n  * [Reconn
-000027e0: 6563 7420 616e 6420 7265 7472 7920 6d65  ect and retry me
-000027f0: 7468 6f64 2064 6563 6f72 6174 6f72 735d  thod decorators]
-00002800: 2823 7265 636f 6e6e 6563 742d 616e 642d  (#reconnect-and-
-00002810: 7265 7472 792d 6d65 7468 6f64 2d64 6563  retry-method-dec
-00002820: 6f72 6174 6f72 7329 5c6e 2a20 5b43 6f6e  orators)\n* [Con
-00002830: 7472 6962 7574 6f72 735d 2823 636f 6e74  tributors](#cont
-00002840: 7269 6275 746f 7273 295c 6e20 202a 205b  ributors)\n  * [
-00002850: 496e 7374 616c 6c20 506f 6574 7279 5d28  Install Poetry](
-00002860: 2369 6e73 7461 6c6c 2d70 6f65 7472 7929  #install-poetry)
-00002870: 5c6e 2020 2a20 5b53 6574 7570 2066 6f72  \n  * [Setup for
-00002880: 2050 7943 6861 726d 2075 7365 7273 5d28   PyCharm users](
-00002890: 2373 6574 7570 2d66 6f72 2d70 7963 6861  #setup-for-pycha
-000028a0: 726d 2d75 7365 7273 295c 6e20 202a 205b  rm-users)\n  * [
-000028b0: 5365 7475 7020 6672 6f6d 2063 6f6d 6d61  Setup from comma
-000028c0: 6e64 206c 696e 655d 2823 7365 7475 702d  nd line](#setup-
-000028d0: 6672 6f6d 2d63 6f6d 6d61 6e64 2d6c 696e  from-command-lin
-000028e0: 6529 5c6e 2020 2a20 5b50 726f 6a65 6374  e)\n  * [Project
-000028f0: 204d 616b 6566 696c 6520 636f 6d6d 616e   Makefile comman
-00002900: 6473 5d28 2370 726f 6a65 6374 2d6d 616b  ds](#project-mak
-00002910: 6566 696c 652d 636f 6d6d 616e 6473 295c  efile-commands)\
-00002920: 6e3c 212d 2d20 544f 4320 2d2d 3e5c 6e5c  n<!-- TOC -->\n\
-00002930: 6e23 2320 496e 7374 616c 6c20 7061 636b  n## Install pack
-00002940: 6167 655c 6e5c 6e49 7420 6973 2072 6563  age\n\nIt is rec
-00002950: 6f6d 6d65 6e64 6564 2074 6f20 696e 7374  ommended to inst
-00002960: 616c 6c20 5079 7468 6f6e 2070 6163 6b61  all Python packa
-00002970: 6765 7320 696e 746f 2061 2050 7974 686f  ges into a Pytho
-00002980: 6e20 7669 7274 7561 6c20 656e 7669 726f  n virtual enviro
-00002990: 6e6d 656e 742e 5c6e 5c6e 2323 2320 4672  nment.\n\n### Fr
-000029a0: 6f6d 2050 7950 495c 6e5c 6e59 6f75 2063  om PyPI\n\nYou c
-000029b0: 616e 2075 7365 2070 6970 2074 6f20 696e  an use pip to in
-000029c0: 7374 616c 6c20 7468 6973 2070 6163 6b61  stall this packa
-000029d0: 6765 2064 6972 6563 746c 7920 6672 6f6d  ge directly from
-000029e0: 5c6e 5b74 6865 2050 7974 686f 6e20 5061  \n[the Python Pa
-000029f0: 636b 6167 6520 496e 6465 785d 2868 7474  ckage Index](htt
-00002a00: 7073 3a2f 2f70 7970 692e 6f72 672f 7072  ps://pypi.org/pr
-00002a10: 6f6a 6563 742f 6573 6462 636c 6965 6e74  oject/esdbclient
-00002a20: 2f29 2e5c 6e5c 6e20 2020 2024 2070 6970  /).\n\n    $ pip
-00002a30: 2069 6e73 7461 6c6c 2065 7364 6263 6c69   install esdbcli
-00002a40: 656e 745c 6e5c 6e23 2323 2057 6974 6820  ent\n\n### With 
-00002a50: 506f 6574 7279 5c6e 5c6e 596f 7520 6361  Poetry\n\nYou ca
-00002a60: 6e20 7573 6520 506f 6574 7279 2074 6f20  n use Poetry to 
-00002a70: 6164 6420 7468 6973 2070 6163 6b61 6765  add this package
-00002a80: 2074 6f20 796f 7572 2070 7970 726f 6a65   to your pyproje
-00002a90: 6374 2e74 6f6d 6c20 616e 6420 696e 7374  ct.toml and inst
-00002aa0: 616c 6c20 6974 2e5c 6e5c 6e20 2020 2024  all it.\n\n    $
-00002ab0: 2070 6f65 7472 7920 6164 6420 6573 6462   poetry add esdb
-00002ac0: 636c 6965 6e74 5c6e 5c6e 2323 2045 7665  client\n\n## Eve
-00002ad0: 6e74 5374 6f72 6544 4220 7365 7276 6572  ntStoreDB server
-00002ae0: 5c6e 5c6e 5468 6520 4576 656e 7453 746f  \n\nThe EventSto
-00002af0: 7265 4442 2073 6572 7665 7220 6361 6e20  reDB server can 
-00002b00: 6265 2072 756e 206c 6f63 616c 6c79 2075  be run locally u
-00002b10: 7369 6e67 2074 6865 206f 6666 6963 6961  sing the officia
-00002b20: 6c20 446f 636b 6572 2063 6f6e 7461 696e  l Docker contain
-00002b30: 6572 2069 6d61 6765 2e5c 6e5c 6e23 2323  er image.\n\n###
-00002b40: 2052 756e 2063 6f6e 7461 696e 6572 5c6e   Run container\n
-00002b50: 5c6e 466f 7220 6465 7665 6c6f 706d 656e  \nFor developmen
-00002b60: 742c 2079 6f75 2063 616e 2072 756e 2061  t, you can run a
-00002b70: 2022 7365 6375 7265 2220 4576 656e 7453   "secure" EventS
-00002b80: 746f 7265 4442 2073 6572 7665 7220 7573  toreDB server us
-00002b90: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
-00002ba0: 6720 636f 6d6d 616e 642e 5c6e 5c6e 2020  g command.\n\n  
-00002bb0: 2020 2420 646f 636b 6572 2072 756e 202d    $ docker run -
-00002bc0: 6420 2d2d 6e61 6d65 2065 7665 6e74 7374  d --name eventst
-00002bd0: 6f72 6564 622d 7365 6375 7265 202d 6974  oredb-secure -it
-00002be0: 202d 7020 3231 3133 3a32 3131 3320 2d2d   -p 2113:2113 --
-00002bf0: 656e 7620 2248 4f4d 453d 2f74 6d70 2220  env "HOME=/tmp" 
-00002c00: 6576 656e 7473 746f 7265 2f65 7665 6e74  eventstore/event
-00002c10: 7374 6f72 653a 3231 2e31 302e 392d 6275  store:21.10.9-bu
-00002c20: 7374 6572 2d73 6c69 6d20 2d2d 6465 765c  ster-slim --dev\
-00002c30: 6e5c 6e41 7320 7765 2077 696c 6c20 7365  n\nAs we will se
-00002c40: 652c 2079 6f75 7220 636c 6965 6e74 2077  e, your client w
-00002c50: 696c 6c20 6e65 6564 2061 6e20 4576 656e  ill need an Even
-00002c60: 7453 746f 7265 4442 2063 6f6e 6e65 6374  tStoreDB connect
-00002c70: 696f 6e20 7374 7269 6e67 2055 5249 2061  ion string URI a
-00002c80: 7320 7468 6520 7661 6c75 655c 6e6f 6620  s the value\nof 
-00002c90: 6974 7320 6075 7269 6020 636f 6e73 7472  its `uri` constr
-00002ca0: 7563 746f 7220 6172 6775 6d65 6e74 2e20  uctor argument. 
-00002cb0: 5468 6520 636f 6e6e 6563 7469 6f6e 2073  The connection s
-00002cc0: 7472 696e 6720 666f 7220 7468 6973 2022  tring for this "
-00002cd0: 7365 6375 7265 2220 4576 656e 7453 746f  secure" EventSto
-00002ce0: 7265 4442 5c6e 7365 7276 6572 2077 6f75  reDB\nserver wou
-00002cf0: 6c64 2062 653a 5c6e 5c6e 2020 2020 6573  ld be:\n\n    es
-00002d00: 6462 3a2f 2f61 646d 696e 3a63 6861 6e67  db://admin:chang
-00002d10: 6569 7440 6c6f 6361 6c68 6f73 743a 3231  eit@localhost:21
-00002d20: 3133 5c6e 5c6e 546f 2063 6f6e 6e65 6374  13\n\nTo connect
-00002d30: 2074 6f20 6120 2273 6563 7572 6522 2073   to a "secure" s
-00002d40: 6572 7665 722c 2079 6f75 2077 696c 6c20  erver, you will 
-00002d50: 7573 7561 6c6c 7920 6e65 6564 2074 6f20  usually need to 
-00002d60: 696e 636c 7564 6520 6120 2275 7365 726e  include a "usern
-00002d70: 616d 6522 5c6e 616e 6420 6120 2270 6173  ame"\nand a "pas
-00002d80: 7377 6f72 6422 2069 6e20 7468 6520 636f  sword" in the co
-00002d90: 6e6e 6563 7469 6f6e 2073 7472 696e 672c  nnection string,
-00002da0: 2073 6f20 7468 6174 2074 6865 2073 6572   so that the ser
-00002db0: 7665 7220 6361 6e20 6175 7468 656e 7469  ver can authenti
-00002dc0: 6361 7465 2074 6865 5c6e 636c 6965 6e74  cate the\nclient
-00002dd0: 2e20 5769 7468 2045 7665 6e74 5374 6f72  . With EventStor
-00002de0: 6544 422c 2074 6865 2064 6566 6175 6c74  eDB, the default
-00002df0: 2075 7365 726e 616d 6520 6973 2022 6164   username is "ad
-00002e00: 6d69 6e22 2061 6e64 2074 6865 2064 6566  min" and the def
-00002e10: 6175 6c74 2070 6173 7377 6f72 645c 6e69  ault password\ni
-00002e20: 7320 2263 6861 6e67 6569 7422 2e5c 6e5c  s "changeit".\n\
-00002e30: 6e57 6865 6e20 636f 6e6e 6563 7469 6e67  nWhen connecting
-00002e40: 2074 6f20 6120 2273 6563 7572 6522 2073   to a "secure" s
-00002e50: 6572 7665 722c 2079 6f75 7220 636c 6965  erver, your clie
-00002e60: 6e74 2077 696c 6c20 616c 736f 206e 6565  nt will also nee
-00002e70: 6420 616e 2053 534c 2f54 4c53 2063 6572  d an SSL/TLS cer
-00002e80: 7469 6669 6361 7465 5c6e 6173 2074 6865  tificate\nas the
-00002e90: 2076 616c 7565 206f 6620 6974 7320 6072   value of its `r
-00002ea0: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
-00002eb0: 6020 636f 6e73 7472 7563 746f 7220 6172  ` constructor ar
-00002ec0: 6775 6d65 6e74 2e20 5468 6520 636c 6965  gument. The clie
-00002ed0: 6e74 2075 7365 7320 7468 655c 6e53 534c  nt uses the\nSSL
-00002ee0: 2f54 4c53 2063 6572 7469 6669 6361 7465  /TLS certificate
-00002ef0: 2074 6f20 6175 7468 656e 7469 6361 7465   to authenticate
-00002f00: 2074 6865 2073 6572 7665 722e 2046 6f72   the server. For
-00002f10: 2064 6576 656c 6f70 6d65 6e74 2c20 796f   development, yo
-00002f20: 7520 6361 6e20 6569 7468 6572 2075 7365  u can either use
-00002f30: 2074 6865 5c6e 5353 4c2f 544c 5320 6365   the\nSSL/TLS ce
-00002f40: 7274 6966 6963 6174 6520 6f66 2074 6865  rtificate of the
-00002f50: 2063 6572 7469 6669 6361 7465 2061 7574   certificate aut
-00002f60: 686f 7269 7479 2075 7365 6420 746f 2063  hority used to c
-00002f70: 7265 6174 6520 7468 6520 7365 7276 6572  reate the server
-00002f80: 5c27 7320 6365 7274 6966 6963 6174 652c  \'s certificate,
-00002f90: 5c6e 6f72 2077 6865 6e20 7573 696e 6720  \nor when using 
-00002fa0: 6120 7369 6e67 6c65 2d6e 6f64 6520 636c  a single-node cl
-00002fb0: 7573 7465 722c 2079 6f75 2063 616e 2075  uster, you can u
-00002fc0: 7365 2074 6865 2073 6572 7665 7220 6365  se the server ce
-00002fd0: 7274 6966 6963 6174 6520 6974 7365 6c66  rtificate itself
-00002fe0: 2e20 596f 7520 6361 6e5c 6e67 6574 2074  . You can\nget t
-00002ff0: 6865 2073 6572 7665 7220 6365 7274 6966  he server certif
-00003000: 6963 6174 6520 7769 7468 2074 6865 2066  icate with the f
-00003010: 6f6c 6c6f 7769 6e67 2050 7974 686f 6e20  ollowing Python 
-00003020: 636f 6465 2e5c 6e5c 6e5c 6e60 6060 7079  code.\n\n\n```py
-00003030: 7468 6f6e 5c6e 696d 706f 7274 2073 736c  thon\nimport ssl
-00003040: 5c6e 5c6e 7365 7276 6572 5f63 6572 7469  \n\nserver_certi
-00003050: 6669 6361 7465 203d 2073 736c 2e67 6574  ficate = ssl.get
-00003060: 5f73 6572 7665 725f 6365 7274 6966 6963  _server_certific
-00003070: 6174 6528 6164 6472 3d28 5c27 6c6f 6361  ate(addr=(\'loca
-00003080: 6c68 6f73 745c 272c 2032 3131 3329 295c  lhost\', 2113))\
-00003090: 6e60 6060 5c6e 5c6e 416c 7465 726e 6174  n```\n\nAlternat
-000030a0: 6976 656c 792c 2079 6f75 2063 616e 2073  ively, you can s
-000030b0: 7461 7274 2061 6e20 2269 6e73 6563 7572  tart an "insecur
-000030c0: 6522 2073 6572 7665 7220 7573 696e 6720  e" server using 
-000030d0: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
-000030e0: 6d6d 616e 642e 5c6e 5c6e 2020 2020 2420  mmand.\n\n    $ 
-000030f0: 646f 636b 6572 2072 756e 202d 6420 2d2d  docker run -d --
-00003100: 6e61 6d65 2065 7665 6e74 7374 6f72 6564  name eventstored
-00003110: 622d 696e 7365 6375 7265 202d 6974 202d  b-insecure -it -
-00003120: 7020 3231 3133 3a32 3131 3320 6576 656e  p 2113:2113 even
-00003130: 7473 746f 7265 2f65 7665 6e74 7374 6f72  tstore/eventstor
-00003140: 653a 3231 2e31 302e 392d 6275 7374 6572  e:21.10.9-buster
-00003150: 2d73 6c69 6d20 2d2d 696e 7365 6375 7265  -slim --insecure
-00003160: 5c6e 5c6e 5468 6520 636f 6e6e 6563 7469  \n\nThe connecti
-00003170: 6f6e 2073 7472 696e 6720 5552 4920 666f  on string URI fo
-00003180: 7220 7468 6973 2022 696e 7365 6375 7265  r this "insecure
-00003190: 2220 7365 7276 6572 2077 6f75 6c64 2062  " server would b
-000031a0: 653a 5c6e 5c6e 2020 2020 6573 6462 3a2f  e:\n\n    esdb:/
-000031b0: 2f6c 6f63 616c 686f 7374 3a32 3131 333f  /localhost:2113?
-000031c0: 546c 733d 6661 6c73 655c 6e5c 6e41 7320  Tls=false\n\nAs 
-000031d0: 7765 2077 696c 6c20 7365 652c 2077 6865  we will see, whe
-000031e0: 6e20 636f 6e6e 6563 7469 6e67 2074 6f20  n connecting to 
-000031f0: 616e 2022 696e 7365 6375 7265 2220 7365  an "insecure" se
-00003200: 7276 6572 2c20 7468 6572 6520 6973 206e  rver, there is n
-00003210: 6f20 6e65 6564 2074 6f20 696e 636c 7564  o need to includ
-00003220: 655c 6e61 2022 7573 6572 6e61 6d65 2220  e\na "username" 
-00003230: 616e 6420 6120 2270 6173 7377 6f72 6422  and a "password"
-00003240: 2069 6e20 7468 6520 636f 6e6e 6563 7469   in the connecti
-00003250: 6f6e 2073 7472 696e 672e 2049 6620 796f  on string. If yo
-00003260: 7520 646f 2c20 7468 6573 6520 7661 6c75  u do, these valu
-00003270: 6573 2077 696c 6c5c 6e62 6520 6967 6e6f  es will\nbe igno
-00003280: 7265 6420 6279 2074 6865 2063 6c69 656e  red by the clien
-00003290: 742c 2073 6f20 7468 6174 2074 6865 7920  t, so that they 
-000032a0: 6172 6520 6e6f 7420 7365 6e74 206f 7665  are not sent ove
-000032b0: 7220 616e 2069 6e73 6563 7572 6520 6368  r an insecure ch
-000032c0: 616e 6e65 6c2e 5c6e 5c6e 506c 6561 7365  annel.\n\nPlease
-000032d0: 206e 6f74 652c 2074 6865 2022 696e 7365   note, the "inse
-000032e0: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
-000032f0: 2073 7472 696e 6720 7573 6573 2061 2071   string uses a q
-00003300: 7565 7279 2073 7472 696e 6720 7769 7468  uery string with
-00003310: 2074 6865 2066 6965 6c64 2d76 616c 7565   the field-value
-00003320: 5c6e 6054 6c73 3d66 616c 7365 602e 2054  \n`Tls=false`. T
-00003330: 6865 2076 616c 7565 206f 6620 7468 6973  he value of this
-00003340: 2066 6965 6c64 2069 7320 6279 2064 6566   field is by def
-00003350: 6175 6c74 2060 7472 7565 602e 5c6e 5c6e  ault `true`.\n\n
-00003360: 2323 2320 5374 6f70 2063 6f6e 7461 696e  ### Stop contain
-00003370: 6572 5c6e 5c6e 546f 2073 746f 7020 616e  er\n\nTo stop an
-00003380: 6420 7265 6d6f 7665 2074 6865 2022 7365  d remove the "se
-00003390: 6375 7265 2220 636f 6e74 6169 6e65 722c  cure" container,
-000033a0: 2075 7365 2074 6865 2066 6f6c 6c6f 7769   use the followi
-000033b0: 6e67 2044 6f63 6b65 7220 636f 6d6d 616e  ng Docker comman
-000033c0: 6473 2e5c 6e5c 6e20 2020 2024 2064 6f63  ds.\n\n    $ doc
-000033d0: 6b65 7220 7374 6f70 2065 7665 6e74 7374  ker stop eventst
-000033e0: 6f72 6564 622d 7365 6375 7265 5c6e 5c74  oredb-secure\n\t
-000033f0: 2420 646f 636b 6572 2072 6d20 6576 656e  $ docker rm even
-00003400: 7473 746f 7265 6462 2d73 6563 7572 655c  tstoredb-secure\
-00003410: 6e5c 6e54 6f20 7374 6f70 2061 6e64 2072  n\nTo stop and r
-00003420: 656d 6f76 6520 7468 6520 2269 6e73 6563  emove the "insec
-00003430: 7572 6522 2063 6f6e 7461 696e 6572 2c20  ure" container, 
-00003440: 7573 6520 7468 6520 666f 6c6c 6f77 696e  use the followin
-00003450: 6720 446f 636b 6572 2063 6f6d 6d61 6e64  g Docker command
-00003460: 732e 5c6e 5c6e 2020 2020 2420 646f 636b  s.\n\n    $ dock
-00003470: 6572 2073 746f 7020 6576 656e 7473 746f  er stop eventsto
-00003480: 7265 6462 2d69 6e73 6563 7572 655c 6e5c  redb-insecure\n\
-00003490: 7424 2064 6f63 6b65 7220 726d 2065 7665  t$ docker rm eve
-000034a0: 6e74 7374 6f72 6564 622d 696e 7365 6375  ntstoredb-insecu
-000034b0: 7265 5c6e 5c6e 5c6e 2323 2045 7665 6e74  re\n\n\n## Event
-000034c0: 5374 6f72 6544 4220 636c 6965 6e74 5c6e  StoreDB client\n
-000034d0: 5c6e 5468 6973 2045 7665 6e74 5374 6f72  \nThis EventStor
-000034e0: 6544 4220 636c 6965 6e74 2069 7320 696d  eDB client is im
-000034f0: 706c 656d 656e 7465 6420 696e 2074 6865  plemented in the
-00003500: 2060 6573 6462 636c 6965 6e74 6020 7061   `esdbclient` pa
-00003510: 636b 6167 6520 7769 7468 5c6e 7468 6520  ckage with\nthe 
-00003520: 6045 7665 6e74 5374 6f72 6544 4243 6c69  `EventStoreDBCli
-00003530: 656e 7460 2063 6c61 7373 2e5c 6e5c 6e23  ent` class.\n\n#
-00003540: 2323 2049 6d70 6f72 7420 636c 6173 735c  ## Import class\
-00003550: 6e5c 6e54 6865 2060 4576 656e 7453 746f  n\nThe `EventSto
-00003560: 7265 4442 436c 6965 6e74 6020 636c 6173  reDBClient` clas
-00003570: 7320 6361 6e20 6265 2069 6d70 6f72 7465  s can be importe
-00003580: 6420 6672 6f6d 2074 6865 2060 6573 6462  d from the `esdb
-00003590: 636c 6965 6e74 6020 7061 636b 6167 652e  client` package.
-000035a0: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e66  \n\n```python\nf
-000035b0: 726f 6d20 6573 6462 636c 6965 6e74 2069  rom esdbclient i
-000035c0: 6d70 6f72 7420 4576 656e 7453 746f 7265  mport EventStore
-000035d0: 4442 436c 6965 6e74 5c6e 6060 605c 6e5c  DBClient\n```\n\
-000035e0: 6e23 2323 2043 6f6e 7374 7275 6374 2063  n### Construct c
-000035f0: 6c69 656e 745c 6e5c 6e54 6865 2060 4576  lient\n\nThe `Ev
-00003600: 656e 7453 746f 7265 4442 436c 6965 6e74  entStoreDBClient
-00003610: 6020 636c 6173 7320 6861 7320 6f6e 6520  ` class has one 
-00003620: 7265 7175 6972 6564 2063 6f6e 7374 7275  required constru
-00003630: 6374 6f72 2061 7267 756d 656e 742c 2060  ctor argument, `
-00003640: 7572 6960 2c20 616e 6420 6f6e 655c 6e6f  uri`, and one\no
-00003650: 7074 696f 6e61 6c20 636f 6e73 7472 7563  ptional construc
-00003660: 746f 7220 6172 6775 6d65 6e74 2c20 6072  tor argument, `r
-00003670: 6f6f 745f 6365 7274 6966 6963 6174 6573  oot_certificates
-00003680: 602e 5c6e 5c6e 5468 6520 6075 7269 6020  `.\n\nThe `uri` 
-00003690: 6172 6775 6d65 6e74 2069 7320 6578 7065  argument is expe
-000036a0: 6374 6564 2074 6f20 6265 2061 6e20 4576  cted to be an Ev
-000036b0: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
-000036c0: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-000036d0: 2074 6861 745c 6e63 6f6e 666f 726d 7320   that\nconforms 
-000036e0: 7769 7468 2074 6865 2073 7461 6e64 6172  with the standar
-000036f0: 6420 4576 656e 7453 746f 7265 4442 2022  d EventStoreDB "
-00003700: 6573 6462 2220 6f72 2022 6573 6462 2b64  esdb" or "esdb+d
-00003710: 6973 636f 7665 7222 2055 5249 2073 6368  iscover" URI sch
-00003720: 656d 6573 2e5c 6e5c 6e46 6f72 2065 7861  emes.\n\nFor exa
-00003730: 6d70 6c65 2c20 7468 6520 666f 6c6c 6f77  mple, the follow
-00003740: 696e 6720 636f 6e6e 6563 7469 6f6e 2073  ing connection s
-00003750: 7472 696e 6720 7370 6563 6966 6965 7320  tring specifies 
-00003760: 7468 6174 2074 6865 2063 6c69 656e 7420  that the client 
-00003770: 7368 6f75 6c64 5c6e 6174 7465 6d70 7420  should\nattempt 
-00003780: 746f 2063 7265 6174 6520 6120 2273 6563  to create a "sec
-00003790: 7572 6522 2063 6f6e 6e65 6374 696f 6e20  ure" connection 
-000037a0: 746f 2070 6f72 7420 3231 3133 206f 6e20  to port 2113 on 
-000037b0: 226c 6f63 616c 686f 7374 222c 2061 6e64  "localhost", and
-000037c0: 2075 7365 2074 6865 5c6e 636c 6965 6e74   use the\nclient
-000037d0: 2063 7265 6465 6e74 6961 6c73 2022 7573   credentials "us
-000037e0: 6572 6e61 6d65 2220 616e 6420 2270 6173  ername" and "pas
-000037f0: 7377 6f72 6422 2077 6865 6e20 6d61 6b69  sword" when maki
-00003800: 6e67 2063 616c 6c73 2074 6f20 7468 6520  ng calls to the 
-00003810: 7365 7276 6572 2e5c 6e5c 6e20 2020 2065  server.\n\n    e
-00003820: 7364 623a 2f2f 7573 6572 6e61 6d65 3a70  sdb://username:p
-00003830: 6173 7377 6f72 6440 6c6f 6361 6c68 6f73  assword@localhos
-00003840: 743a 3231 3133 3f54 6c73 3d74 7275 655c  t:2113?Tls=true\
-00003850: 6e5c 6e54 6865 2063 6c69 656e 7420 6d75  n\nThe client mu
-00003860: 7374 2062 6520 636f 6e66 6967 7572 6564  st be configured
-00003870: 2074 6f20 6372 6561 7465 2061 2022 7365   to create a "se
-00003880: 6375 7265 2220 636f 6e6e 6563 7469 6f6e  cure" connection
-00003890: 2074 6f20 6120 2273 6563 7572 6522 2073   to a "secure" s
-000038a0: 6572 7665 722c 5c6e 6f72 2061 6c74 6572  erver,\nor alter
-000038b0: 6e61 7469 7665 6c79 2061 6e20 2269 6e73  natively an "ins
-000038c0: 6563 7572 6522 2063 6f6e 6e65 6374 696f  ecure" connectio
-000038d0: 6e20 746f 2061 6e20 2269 6e73 6563 7572  n to an "insecur
-000038e0: 6522 2073 6572 7665 722e 2042 7920 6465  e" server. By de
-000038f0: 6661 756c 742c 2074 6865 5c6e 636c 6965  fault, the\nclie
-00003900: 6e74 2077 696c 6c20 6174 7465 6d70 7420  nt will attempt 
-00003910: 746f 2063 7265 6174 6520 6120 2273 6563  to create a "sec
-00003920: 7572 6522 2063 6f6e 6e65 6374 696f 6e2e  ure" connection.
-00003930: 2041 6e64 2073 6f2c 2077 6865 6e20 636f   And so, when co
-00003940: 6e6e 6563 7469 6e67 2074 6f20 616e 5c6e  nnecting to an\n
-00003950: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
-00003960: 722c 2074 6865 2063 6f6e 6e65 6374 696f  r, the connectio
-00003970: 6e20 7374 7269 6e67 206d 7573 7420 7370  n string must sp
-00003980: 6563 6966 7920 7468 6174 2074 6865 2063  ecify that the c
-00003990: 6c69 656e 7420 7368 6f75 6c64 2061 7474  lient should att
-000039a0: 656d 7074 5c6e 746f 206d 616b 6520 616e  empt\nto make an
-000039b0: 2022 696e 7365 6375 7265 2220 636f 6e6e   "insecure" conn
-000039c0: 6563 7469 6f6e 2e5c 6e5c 6e54 6865 2066  ection.\n\nThe f
-000039d0: 6f6c 6c6f 7769 6e67 2063 6f6e 6e65 6374  ollowing connect
-000039e0: 696f 6e20 7374 7269 6e67 2073 7065 6369  ion string speci
-000039f0: 6669 6573 2074 6861 7420 7468 6520 636c  fies that the cl
-00003a00: 6965 6e74 2073 686f 756c 645c 6e61 7474  ient should\natt
-00003a10: 656d 7074 2074 6f20 6372 6561 7465 2061  empt to create a
-00003a20: 6e20 2269 6e73 6563 7572 6522 2063 6f6e  n "insecure" con
-00003a30: 6e65 6374 696f 6e20 746f 2070 6f72 7420  nection to port 
-00003a40: 3231 3133 206f 6e20 226c 6f63 616c 686f  2113 on "localho
-00003a50: 7374 222e 5c6e 5768 656e 2063 6f6e 6e65  st".\nWhen conne
-00003a60: 6374 696e 6720 746f 2061 6e20 2269 6e73  cting to an "ins
-00003a70: 6563 7572 6522 2073 6572 7665 722c 2074  ecure" server, t
-00003a80: 6865 2063 6c69 656e 7420 7769 6c6c 2069  he client will i
-00003a90: 676e 6f72 6520 616e 795c 6e75 7365 726e  gnore any\nusern
-00003aa0: 616d 6520 616e 6420 7061 7373 776f 7264  ame and password
-00003ab0: 2069 6e66 6f72 6d61 7469 6f6e 2069 6e63   information inc
-00003ac0: 6c75 6465 6420 696e 2074 6865 2063 6f6e  luded in the con
-00003ad0: 6e65 6374 696f 6e20 7374 7269 6e67 2c5c  nection string,\
-00003ae0: 6e73 6f20 7468 6174 2075 7365 726e 616d  nso that usernam
-00003af0: 6573 2061 6e64 2070 6173 7377 6f72 6473  es and passwords
-00003b00: 2061 7265 206e 6f74 2073 656e 7420 6f76   are not sent ov
-00003b10: 6572 2061 6e20 2269 6e73 6563 7572 6522  er an "insecure"
-00003b20: 2063 6f6e 6e65 6374 696f 6e2e 5c6e 5c6e   connection.\n\n
-00003b30: 2020 2020 6573 6462 3a2f 2f6c 6f63 616c      esdb://local
-00003b40: 686f 7374 3a32 3131 333f 546c 733d 6661  host:2113?Tls=fa
-00003b50: 6c73 655c 6e5c 6e50 6c65 6173 6520 6e6f  lse\n\nPlease no
-00003b60: 7465 2c20 7468 6520 2269 6e73 6563 7572  te, the "insecur
-00003b70: 6522 2063 6f6e 6e65 6374 696f 6e20 7374  e" connection st
-00003b80: 7269 6e67 2075 7365 7320 6120 7175 6572  ring uses a quer
-00003b90: 7920 7374 7269 6e67 2077 6974 6820 7468  y string with th
-00003ba0: 6520 6669 656c 642d 7661 6c75 655c 6e60  e field-value\n`
-00003bb0: 546c 733d 6661 6c73 6560 2e20 5468 6520  Tls=false`. The 
-00003bc0: 7661 6c75 6520 6f66 2074 6869 7320 6669  value of this fi
-00003bd0: 656c 6420 6973 2062 7920 6465 6661 756c  eld is by defaul
-00003be0: 7420 6074 7275 6560 2e20 556e 6c65 7373  t `true`. Unless
-00003bf0: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
-00003c00: 7374 7269 6e67 5c6e 5552 4920 696e 636c  string\nURI incl
-00003c10: 7564 6573 2074 6865 2066 6965 6c64 2d76  udes the field-v
-00003c20: 616c 7565 2060 546c 733d 6661 6c73 6560  alue `Tls=false`
-00003c30: 2069 6e20 7468 6520 7175 6572 7920 7374   in the query st
-00003c40: 7269 6e67 2c20 7468 6520 6072 6f6f 745f  ring, the `root_
-00003c50: 6365 7274 6966 6963 6174 6573 605c 6e63  certificates`\nc
-00003c60: 6f6e 7374 7275 6374 6f72 2061 7267 756d  onstructor argum
-00003c70: 656e 7420 6973 2061 6c73 6f20 7265 7175  ent is also requ
-00003c80: 6972 6564 2e5c 6e5c 6e57 6865 6e20 636f  ired.\n\nWhen co
-00003c90: 6e6e 6563 7469 6e67 2074 6f20 6120 2273  nnecting to a "s
-00003ca0: 6563 7572 6522 2073 6572 7665 722c 2074  ecure" server, t
-00003cb0: 6865 2060 726f 6f74 5f63 6572 7469 6669  he `root_certifi
-00003cc0: 6361 7465 7360 2061 7267 756d 656e 7420  cates` argument 
-00003cd0: 6973 2065 7870 6563 7465 6420 746f 5c6e  is expected to\n
-00003ce0: 6265 2061 2050 7974 686f 6e20 6073 7472  be a Python `str
-00003cf0: 6020 636f 6e74 6169 6e69 6e67 2050 454d  ` containing PEM
-00003d00: 2065 6e63 6f64 6564 2053 534c 2f54 4c53   encoded SSL/TLS
-00003d10: 2072 6f6f 7420 6365 7274 6966 6963 6174   root certificat
-00003d20: 6573 2e20 5468 6973 2076 616c 7565 2069  es. This value i
-00003d30: 735c 6e70 6173 7365 6420 6469 7265 6374  s\npassed direct
-00003d40: 6c79 2074 6f20 6067 7270 632e 7373 6c5f  ly to `grpc.ssl_
-00003d50: 6368 616e 6e65 6c5f 6372 6564 656e 7469  channel_credenti
-00003d60: 616c 7328 2960 2e20 4974 2069 7320 7573  als()`. It is us
-00003d70: 6564 2066 6f72 2061 7574 6865 6e74 6963  ed for authentic
-00003d80: 6174 696e 6720 7468 655c 6e73 6572 7665  ating the\nserve
-00003d90: 7220 746f 2074 6865 2063 6c69 656e 742e  r to the client.
-00003da0: 2049 7420 6973 2063 6f6d 6d6f 6e6c 7920   It is commonly 
-00003db0: 7468 6520 6365 7274 6966 6963 6174 6520  the certificate 
-00003dc0: 6f66 2074 6865 2063 6572 7469 6669 6361  of the certifica
-00003dd0: 7465 2061 7574 686f 7269 7479 2074 6861  te authority tha
-00003de0: 745c 6e77 6173 2072 6573 706f 6e73 6962  t\nwas responsib
-00003df0: 6c65 2066 6f72 2067 656e 6572 6174 696e  le for generatin
-00003e00: 6720 7468 6520 5353 4c2f 544c 5320 6365  g the SSL/TLS ce
-00003e10: 7274 6966 6963 6174 6520 7573 6564 2062  rtificate used b
-00003e20: 7920 7468 6520 4576 656e 7453 746f 7265  y the EventStore
-00003e30: 4442 2073 6572 7665 722e 5c6e 4275 742c  DB server.\nBut,
-00003e40: 2061 6c74 6572 6e61 7469 7665 6c79 2066   alternatively f
-00003e50: 6f72 2064 6576 656c 6f70 6d65 6e74 2c20  or development, 
-00003e60: 796f 7520 6361 6e20 7573 6520 7468 6520  you can use the 
-00003e70: 7365 7276 6572 5c27 7320 6365 7274 6966  server\'s certif
-00003e80: 6963 6174 6520 6974 7365 6c66 2e5c 6e5c  icate itself.\n\
-00003e90: 6e49 6e20 7468 6520 6578 616d 706c 6520  nIn the example 
-00003ea0: 6265 6c6f 772c 2074 6865 2063 6f6e 7374  below, the const
-00003eb0: 7275 6374 6f72 2061 7267 756d 656e 7420  ructor argument 
-00003ec0: 7661 6c75 6573 2061 7265 2074 616b 656e  values are taken
-00003ed0: 2066 726f 6d20 7468 6520 6f70 6572 6174   from the operat
-00003ee0: 696e 675c 6e73 7973 7465 6d20 656e 7669  ing\nsystem envi
-00003ef0: 726f 6e6d 656e 742e 2054 6869 7320 6973  ronment. This is
-00003f00: 2061 2074 7970 6963 616c 2061 7272 616e   a typical arran
-00003f10: 6765 6d65 6e74 2069 6e20 6120 7072 6f64  gement in a prod
-00003f20: 7563 7469 6f6e 2065 6e76 6972 6f6e 6d65  uction environme
-00003f30: 6e74 2e20 4974 2069 735c 6e64 6f6e 6520  nt. It is\ndone 
-00003f40: 7468 6973 2077 6179 2068 6572 6520 736f  this way here so
-00003f50: 2074 6861 7420 7468 6520 636f 6465 2069   that the code i
-00003f60: 6e20 7468 6973 2064 6f63 756d 656e 7461  n this documenta
-00003f70: 7469 6f6e 2063 616e 2062 6520 7465 7374  tion can be test
-00003f80: 6564 2077 6974 6820 626f 7468 5c6e 6120  ed with both\na 
-00003f90: 2273 6563 7572 6522 2061 6e64 2061 6e20  "secure" and an 
-00003fa0: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
-00003fb0: 722e 5c6e 5c6e 6060 6070 7974 686f 6e5c  r.\n\n```python\
-00003fc0: 6e69 6d70 6f72 7420 6f73 5c6e 5c6e 636c  nimport os\n\ncl
-00003fd0: 6965 6e74 203d 2045 7665 6e74 5374 6f72  ient = EventStor
-00003fe0: 6544 4243 6c69 656e 7428 5c6e 2020 2020  eDBClient(\n    
-00003ff0: 7572 693d 6f73 2e67 6574 656e 7628 2245  uri=os.getenv("E
-00004000: 5344 425f 5552 4922 292c 5c6e 2020 2020  SDB_URI"),\n    
-00004010: 726f 6f74 5f63 6572 7469 6669 6361 7465  root_certificate
-00004020: 733d 6f73 2e67 6574 656e 7628 2245 5344  s=os.getenv("ESD
-00004030: 425f 524f 4f54 5f43 4552 5449 4649 4341  B_ROOT_CERTIFICA
-00004040: 5445 5322 292c 5c6e 295c 6e60 6060 5c6e  TES"),\n)\n```\n
-00004050: 5c6e 2323 2043 6f6e 6e65 6374 696f 6e20  \n## Connection 
-00004060: 7374 7269 6e67 735c 6e5c 6e41 6e20 4576  strings\n\nAn Ev
-00004070: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
-00004080: 6374 696f 6e20 7374 7269 6e67 2069 7320  ction string is 
-00004090: 6120 5552 4920 7468 6174 2063 6f6e 666f  a URI that confo
-000040a0: 726d 7320 7769 7468 206f 6e65 206f 6620  rms with one of 
-000040b0: 7477 6f20 706f 7373 6962 6c65 5c6e 7363  two possible\nsc
-000040c0: 6865 6d65 733a 2065 6974 6865 7220 7468  hemes: either th
-000040d0: 6520 2265 7364 6222 2073 6368 656d 652c  e "esdb" scheme,
-000040e0: 206f 7220 7468 6520 2265 7364 622b 6469   or the "esdb+di
-000040f0: 7363 6f76 6572 2220 7363 6865 6d65 2e5c  scover" scheme.\
-00004100: 6e5c 6e54 6865 2073 796e 7461 7820 616e  n\nThe syntax an
-00004110: 6420 7365 6d61 6e74 6963 7320 6f66 2074  d semantics of t
-00004120: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
-00004130: 5552 4920 7363 6865 6d65 7320 6172 6520  URI schemes are 
-00004140: 6465 7363 7269 6265 6420 6265 6c6f 772e  described below.
-00004150: 2054 6865 5c6e 7379 6e74 6178 2069 7320   The\nsyntax is 
-00004160: 6465 6669 6e65 6420 7573 696e 6720 5b45  defined using [E
-00004170: 424e 465d 2868 7474 7073 3a2f 2f65 6e2e  BNF](https://en.
-00004180: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
-00004190: 6b69 2f45 7874 656e 6465 645f 4261 636b  ki/Extended_Back
-000041a0: 7573 e280 934e 6175 725f 666f 726d 292e  us...Naur_form).
-000041b0: 5c6e 5c6e 2323 2320 5477 6f20 7363 6865  \n\n### Two sche
-000041c0: 6d65 735c 6e5c 6e54 6865 2022 6573 6462  mes\n\nThe "esdb
-000041d0: 2220 5552 4920 7363 6865 6d65 2063 616e  " URI scheme can
-000041e0: 2062 6520 6465 6669 6e65 6420 696e 2074   be defined in t
-000041f0: 6865 2066 6f6c 6c6f 7769 6e67 2077 6179  he following way
-00004200: 2e5c 6e5c 6e20 2020 2065 7364 622d 7572  .\n\n    esdb-ur
-00004210: 6920 3d20 2265 7364 623a 2f2f 2220 2c20  i = "esdb://" , 
-00004220: 5b20 7573 6572 2d69 6e66 6f20 2c20 2240  [ user-info , "@
-00004230: 2220 5d20 2c20 6772 7063 2d74 6172 6765  " ] , grpc-targe
-00004240: 742c 207b 2022 2c22 202c 2067 7270 632d  t, { "," , grpc-
-00004250: 7461 7267 6574 207d 202c 205b 2022 3f22  target } , [ "?"
-00004260: 202c 2071 7565 7279 2d73 7472 696e 6720   , query-string 
-00004270: 5d20 3b5c 6e5c 6e49 6e20 7468 6520 2265  ] ;\n\nIn the "e
-00004280: 7364 6222 2055 5249 2073 6368 656d 652c  sdb" URI scheme,
-00004290: 2061 6674 6572 2074 6865 206f 7074 696f   after the optio
-000042a0: 6e61 6c20 7573 6572 2069 6e66 6f20 7374  nal user info st
-000042b0: 7269 6e67 2c20 7468 6572 6520 6d75 7374  ring, there must
-000042c0: 2062 6520 6174 206c 6561 7374 5c6e 6f6e   be at least\non
-000042d0: 6520 6752 5043 2074 6172 6765 742e 2049  e gRPC target. I
-000042e0: 6620 7468 6572 6520 6172 6520 7365 7665  f there are seve
-000042f0: 7261 6c20 6752 5043 2074 6172 6765 7473  ral gRPC targets
-00004300: 2c20 7468 6579 206d 7573 7420 6265 2073  , they must be s
-00004310: 6570 6172 6174 6564 2066 726f 6d20 6561  eparated from ea
-00004320: 6368 5c6e 6f74 6865 7220 7769 7468 2074  ch\nother with t
-00004330: 6865 2022 2c22 2063 6861 7261 6374 6572  he "," character
-00004340: 2e20 4561 6368 2067 5250 4320 7461 7267  . Each gRPC targ
-00004350: 6574 2073 686f 756c 6420 696e 6469 6361  et should indica
-00004360: 7465 2061 6e20 4576 656e 7453 746f 7265  te an EventStore
-00004370: 4442 2067 5250 435c 6e73 6572 7665 7220  DB gRPC\nserver 
-00004380: 736f 636b 6574 2c20 6279 2073 7065 6369  socket, by speci
-00004390: 6679 696e 6720 6120 686f 7374 2061 6e64  fying a host and
-000043a0: 2061 2070 6f72 7420 6e75 6d62 6572 2073   a port number s
-000043b0: 6570 6172 6174 6564 2077 6974 6820 7468  eparated with th
-000043c0: 6520 223a 2220 6368 6172 6163 7465 722e  e ":" character.
-000043d0: 5c6e 5468 6520 686f 7374 206d 6179 2062  \nThe host may b
-000043e0: 6520 6120 686f 7374 6e61 6d65 2074 6861  e a hostname tha
-000043f0: 7420 6361 6e20 6265 2072 6573 6f6c 7665  t can be resolve
-00004400: 6420 746f 2061 6e20 4950 2061 6464 7265  d to an IP addre
-00004410: 7373 2c20 6f72 2061 6e20 4950 2061 6464  ss, or an IP add
-00004420: 7265 7373 2e5c 6e5c 6e20 2020 2067 7270  ress.\n\n    grp
-00004430: 632d 7461 7267 6574 203d 2028 2068 6f73  c-target = ( hos
-00004440: 746e 616d 6520 7c20 6970 2d61 6464 7265  tname | ip-addre
-00004450: 7373 2029 202c 2022 3a22 202c 2070 6f72  ss ) , ":" , por
-00004460: 742d 6e75 6d62 6572 203b 5c6e 5c6e 5c6e  t-number ;\n\n\n
-00004470: 5468 6520 2265 7364 622b 6469 7363 6f76  The "esdb+discov
-00004480: 6572 2220 5552 4920 7363 6865 6d65 2063  er" URI scheme c
-00004490: 616e 2062 6520 6465 6669 6e65 6420 696e  an be defined in
-000044a0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2077   the following w
-000044b0: 6179 2e5c 6e5c 6e20 2020 2065 7364 622d  ay.\n\n    esdb-
-000044c0: 6469 7363 6f76 6572 2d75 7269 203d 2022  discover-uri = "
-000044d0: 6573 6462 2b64 6973 636f 7665 723a 2f2f  esdb+discover://
-000044e0: 2220 2c20 5b20 7573 6572 2d69 6e66 6f2c  " , [ user-info,
-000044f0: 2022 4022 205d 202c 2063 6c75 7374 6572   "@" ] , cluster
-00004500: 2d64 6f6d 6169 6e6e 616d 6520 2c20 5b20  -domainname , [ 
-00004510: 223f 2220 2c20 7175 6572 792d 7374 7269  "?" , query-stri
-00004520: 6e67 205d 203b 5c6e 5c6e 496e 2074 6865  ng ] ;\n\nIn the
-00004530: 2022 6573 6462 2b64 6973 636f 7665 7222   "esdb+discover"
-00004540: 2055 5249 2073 6368 656d 652c 2061 6674   URI scheme, aft
-00004550: 6572 2074 6865 206f 7074 696f 6e61 6c20  er the optional 
-00004560: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
-00004570: 2c20 7468 6572 6520 6d75 7374 2062 6520  , there must be 
-00004580: 615c 6e64 6f6d 6169 6e20 6e61 6d65 2077  a\ndomain name w
-00004590: 6869 6368 2073 686f 756c 6420 6964 656e  hich should iden
-000045a0: 7469 6679 2061 2063 6c75 7374 6572 206f  tify a cluster o
-000045b0: 6620 4576 656e 7453 746f 7265 4442 2073  f EventStoreDB s
-000045c0: 6572 7665 7273 2e20 5468 6520 636c 6965  ervers. The clie
-000045d0: 6e74 2077 696c 6c20 7573 655c 6e61 2044  nt will use\na D
-000045e0: 4e53 2073 6572 7665 7220 746f 2072 6573  NS server to res
-000045f0: 6f6c 7665 2074 6865 2064 6f6d 6169 6e20  olve the domain 
-00004600: 6e61 6d65 2074 6f20 6120 6c69 7374 206f  name to a list o
-00004610: 6620 6164 6472 6573 7365 7320 6f66 2045  f addresses of E
-00004620: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
-00004630: 6572 732c 5c6e 6279 2071 7565 7279 696e  ers,\nby queryin
-00004640: 6720 666f 7220 5c27 415c 2720 7265 636f  g for \'A\' reco
-00004650: 7264 732e 2049 6e20 7468 6973 2063 6173  rds. In this cas
-00004660: 652c 2074 6865 2070 6f72 7420 6e75 6d62  e, the port numb
-00004670: 6572 2022 3231 3133 2220 7769 6c6c 2062  er "2113" will b
-00004680: 6520 7573 6564 2074 6f5c 6e63 6f6e 7374  e used to\nconst
-00004690: 7275 6374 2067 5250 4320 7461 7267 6574  ruct gRPC target
-000046a0: 7320 6672 6f6d 2074 6865 2061 6464 7265  s from the addre
-000046b0: 7373 6573 206f 6274 6169 6e65 6420 6672  sses obtained fr
-000046c0: 6f6d 205c 2741 5c27 2072 6563 6f72 6473  om \'A\' records
-000046d0: 2070 726f 7669 6465 6420 6279 2074 6865   provided by the
-000046e0: 5c6e 444e 5320 7365 7276 6572 2e20 5468  \nDNS server. Th
-000046f0: 6572 6566 6f72 652c 2069 6620 796f 7520  erefore, if you 
-00004700: 7761 6e74 2074 6f20 7573 6520 7468 6520  want to use the 
-00004710: 2265 7364 622b 6469 7363 6f76 6572 2220  "esdb+discover" 
-00004720: 5552 4920 7363 6865 6d65 2c20 796f 7520  URI scheme, you 
-00004730: 7769 6c6c 5c6e 6e65 6564 2074 6f20 636f  will\nneed to co
-00004740: 6e66 6967 7572 6520 444e 5320 7768 656e  nfigure DNS when
-00004750: 2073 6574 7469 6e67 2075 7020 796f 7572   setting up your
-00004760: 2045 7665 6e74 5374 6f72 6544 4220 636c   EventStoreDB cl
-00004770: 7573 7465 722e 5c6e 5c6e 5769 7468 2062  uster.\n\nWith b
-00004780: 6f74 6820 7468 6520 2265 7364 6222 2061  oth the "esdb" a
-00004790: 6e64 2022 6573 6462 2b64 6973 636f 7665  nd "esdb+discove
-000047a0: 7222 2055 5249 2073 6368 656d 6573 2c20  r" URI schemes, 
-000047b0: 7468 6520 636c 6965 6e74 2066 6972 7374  the client first
-000047c0: 6c79 206f 6274 6169 6e73 5c6e 6120 6c69  ly obtains\na li
-000047d0: 7374 206f 6620 6752 5043 2074 6172 6765  st of gRPC targe
-000047e0: 7473 3a20 6569 7468 6572 2064 6972 6563  ts: either direc
-000047f0: 746c 7920 6672 6f6d 2022 6573 6462 2220  tly from "esdb" 
-00004800: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00004810: 6773 3b20 6f72 2069 6e64 6972 6563 746c  gs; or indirectl
-00004820: 795c 6e66 726f 6d20 2265 7364 622b 6469  y\nfrom "esdb+di
-00004830: 7363 6f76 6572 2220 636f 6e6e 6563 7469  scover" connecti
-00004840: 6f6e 2073 7472 696e 6773 2076 6961 2044  on strings via D
-00004850: 4e53 2e20 5468 6973 206c 6973 7420 6f66  NS. This list of
-00004860: 2074 6172 6765 7473 2069 7320 6b6e 6f77   targets is know
-00004870: 6e20 6173 2074 6865 5c6e 2267 6f73 7369  n as the\n"gossi
-00004880: 7020 7365 6564 222e 2054 6865 2063 6c69  p seed". The cli
-00004890: 656e 7420 7769 6c6c 2074 6865 6e20 6174  ent will then at
-000048a0: 7465 6d70 7420 746f 2063 6f6e 6e65 6374  tempt to connect
-000048b0: 2074 6f20 6561 6368 2067 5250 4320 7461   to each gRPC ta
-000048c0: 7267 6574 2069 6e20 7475 726e 2c5c 6e61  rget in turn,\na
-000048d0: 7474 656d 7074 696e 6720 746f 2063 616c  ttempting to cal
-000048e0: 6c20 7468 6520 4576 656e 7453 746f 7265  l the EventStore
-000048f0: 4442 2047 6f73 7369 7020 4150 4920 746f  DB Gossip API to
-00004900: 206f 6274 6169 6e20 696e 666f 726d 6174   obtain informat
-00004910: 696f 6e20 6162 6f75 7420 7468 655c 6e45  ion about the\nE
-00004920: 7665 6e74 5374 6f72 6544 4220 636c 7573  ventStoreDB clus
-00004930: 7465 722e 2041 206d 656d 6265 7220 6f66  ter. A member of
-00004940: 2074 6865 2063 6c75 7374 6572 2069 7320   the cluster is 
-00004950: 7365 6c65 6374 6564 2062 7920 7468 6520  selected by the 
-00004960: 636c 6965 6e74 2c20 6163 636f 7264 696e  client, accordin
-00004970: 675c 6e74 6f20 7468 6520 226e 6f64 6520  g\nto the "node 
-00004980: 7072 6566 6572 656e 6365 2220 6f70 7469  preference" opti
-00004990: 6f6e 2e20 5468 6520 636c 6965 6e74 206d  on. The client m
-000049a0: 6179 2074 6865 6e20 6e65 6564 2074 6f20  ay then need to 
-000049b0: 636c 6f73 6520 6974 735c 6e63 6f6e 6e65  close its\nconne
-000049c0: 6374 696f 6e20 616e 6420 7265 636f 6e6e  ction and reconn
-000049d0: 6563 7420 746f 2074 6865 2073 656c 6563  ect to the selec
-000049e0: 7465 6420 7365 7276 6572 2e5c 6e5c 6e23  ted server.\n\n#
-000049f0: 2323 2055 7365 7220 696e 666f 2073 7472  ## User info str
-00004a00: 696e 675c 6e5c 6e49 6e20 626f 7468 2074  ing\n\nIn both t
-00004a10: 6865 2022 6573 6462 2220 616e 6420 2265  he "esdb" and "e
-00004a20: 7364 622b 6469 7363 6f76 6572 2220 7363  sdb+discover" sc
-00004a30: 6865 6d65 732c 2074 6865 2055 5249 206d  hemes, the URI m
-00004a40: 6179 2069 6e63 6c75 6465 2061 2075 7365  ay include a use
-00004a50: 7220 696e 666f 2073 7472 696e 672e 5c6e  r info string.\n
-00004a60: 4966 2069 7420 6578 6973 7473 2069 6e20  If it exists in 
-00004a70: 7468 6520 5552 492c 2074 6865 2075 7365  the URI, the use
-00004a80: 7220 696e 666f 2073 7472 696e 6720 6d75  r info string mu
-00004a90: 7374 2062 6520 7365 7061 7261 7465 6420  st be separated 
-00004aa0: 6672 6f6d 2074 6865 2072 6573 7420 6f66  from the rest of
-00004ab0: 2074 6865 2055 5249 5c6e 7769 7468 2074   the URI\nwith t
-00004ac0: 6865 2022 4022 2063 6861 7261 6374 6572  he "@" character
-00004ad0: 2e20 5468 6520 7573 6572 2069 6e66 6f20  . The user info 
-00004ae0: 7374 7269 6e67 206d 7573 7420 696e 636c  string must incl
-00004af0: 7564 6520 6120 7573 6572 6e61 6d65 2061  ude a username a
-00004b00: 6e64 2061 2070 6173 7377 6f72 642c 5c6e  nd a password,\n
-00004b10: 7365 7061 7261 7465 6420 7769 7468 2074  separated with t
-00004b20: 6865 2022 3a22 2063 6861 7261 6374 6572  he ":" character
-00004b30: 2e5c 6e5c 6e20 2020 2075 7365 722d 696e  .\n\n    user-in
-00004b40: 666f 203d 2075 7365 726e 616d 6520 2c20  fo = username , 
-00004b50: 223a 2220 2c20 7061 7373 776f 7264 203b  ":" , password ;
-00004b60: 5c6e 5c6e 5468 6520 7573 6572 2069 6e66  \n\nThe user inf
-00004b70: 6f20 6973 2073 656e 7420 6279 2074 6865  o is sent by the
-00004b80: 2063 6c69 656e 7420 6173 2022 6361 6c6c   client as "call
-00004b90: 2063 7265 6465 6e74 6961 6c73 2220 696e   credentials" in
-00004ba0: 2065 6163 6820 6361 6c6c 2074 6f20 6120   each call to a 
-00004bb0: 2273 6563 7572 6522 5c6e 7365 7276 6572  "secure"\nserver
-00004bc0: 2c20 696e 2061 2022 6261 7369 6320 6175  , in a "basic au
-00004bd0: 7468 2220 6175 7468 6f72 697a 6174 696f  th" authorizatio
-00004be0: 6e20 6865 6164 6572 2e20 5468 6973 2061  n header. This a
-00004bf0: 7574 686f 7269 7a61 7469 6f6e 2068 6561  uthorization hea
-00004c00: 6465 7220 6973 2075 7365 6420 6279 5c6e  der is used by\n
-00004c10: 7468 6520 7365 7276 6572 2074 6f20 6175  the server to au
-00004c20: 7468 656e 7469 6361 7465 2074 6865 2063  thenticate the c
-00004c30: 6c69 656e 742e 2054 6865 2061 7574 686f  lient. The autho
-00004c40: 7269 7a61 7469 6f6e 2068 6561 6465 7220  rization header 
-00004c50: 6973 206e 6f74 2073 656e 7420 746f 5c6e  is not sent to\n
-00004c60: 2269 6e73 6563 7572 6522 2073 6572 7665  "insecure" serve
-00004c70: 7273 2e5c 6e5c 6e23 2323 2051 7565 7279  rs.\n\n### Query
-00004c80: 2073 7472 696e 675c 6e5c 6e49 6e20 626f   string\n\nIn bo
-00004c90: 7468 2074 6865 2022 6573 6462 2220 616e  th the "esdb" an
-00004ca0: 6420 2265 7364 622b 6469 7363 6f76 6572  d "esdb+discover
-00004cb0: 2220 7363 6865 6d65 732c 2074 6865 206f  " schemes, the o
-00004cc0: 7074 696f 6e61 6c20 7175 6572 7920 7374  ptional query st
-00004cd0: 7269 6e67 206d 7573 7420 6265 206f 6e65  ring must be one
-00004ce0: 5c6e 6f72 206d 616e 7920 6669 656c 642d  \nor many field-
-00004cf0: 7661 6c75 6520 6172 6775 6d65 6e74 732c  value arguments,
-00004d00: 2073 6570 6172 6174 6564 2066 726f 6d20   separated from 
-00004d10: 6561 6368 206f 7468 6572 2077 6974 6820  each other with 
-00004d20: 7468 6520 2226 2220 6368 6172 6163 7465  the "&" characte
-00004d30: 722e 5c6e 5c6e 2020 2020 7175 6572 792d  r.\n\n    query-
-00004d40: 7374 7269 6e67 203d 2066 6965 6c64 2d76  string = field-v
-00004d50: 616c 7565 2c20 7b20 2226 222c 2066 6965  alue, { "&", fie
-00004d60: 6c64 2d76 616c 7565 207d 203b 5c6e 5c6e  ld-value } ;\n\n
-00004d70: 4561 6368 2066 6965 6c64 2d76 616c 7565  Each field-value
-00004d80: 2061 7267 756d 656e 7420 6d75 7374 2062   argument must b
-00004d90: 6520 6f6e 6520 6f66 2074 6865 2073 7570  e one of the sup
-00004da0: 706f 7274 6564 2066 6965 6c64 732c 2061  ported fields, a
-00004db0: 6e64 2061 6e5c 6e61 7070 726f 7072 6961  nd an\nappropria
-00004dc0: 7465 2076 616c 7565 2c20 7365 7061 7261  te value, separa
-00004dd0: 7465 6420 7769 7468 2074 6865 2022 3d22  ted with the "="
-00004de0: 2063 6861 7261 6374 6572 2e5c 6e5c 6e20   character.\n\n 
-00004df0: 2020 2066 6965 6c64 2d76 616c 7565 203d     field-value =
-00004e00: 2028 2022 546c 7322 2c20 223d 2220 2c20   ( "Tls", "=" , 
-00004e10: 2274 7275 6522 207c 2022 6661 6c73 6522  "true" | "false"
-00004e20: 2029 5c6e 2020 2020 2020 2020 2020 2020   )\n            
-00004e30: 2020 2020 7c20 2820 2254 6c73 5665 7269      | ( "TlsVeri
-00004e40: 6679 4365 7274 222c 2022 3d22 202c 2022  fyCert", "=" , "
-00004e50: 7472 7565 2220 7c20 2266 616c 7365 2220  true" | "false" 
-00004e60: 295c 6e20 2020 2020 2020 2020 2020 2020  )\n             
-00004e70: 2020 207c 2028 2022 436f 6e6e 6563 7469     | ( "Connecti
-00004e80: 6f6e 4e61 6d65 222c 2022 3d22 202c 2073  onName", "=" , s
-00004e90: 7472 696e 6720 295c 6e20 2020 2020 2020  tring )\n       
-00004ea0: 2020 2020 2020 2020 207c 2028 2022 4e6f           | ( "No
-00004eb0: 6465 5072 6566 6572 656e 6365 222c 2022  dePreference", "
-00004ec0: 3d22 202c 2022 6c65 6164 6572 2220 7c20  =" , "leader" | 
-00004ed0: 2266 6f6c 6c6f 7765 7222 207c 2022 7265  "follower" | "re
-00004ee0: 6164 6f6e 6c79 7265 706c 6963 6122 207c  adonlyreplica" |
-00004ef0: 2022 7261 6e64 6f6d 2220 295c 6e20 2020   "random" )\n   
-00004f00: 2020 2020 2020 2020 2020 2020 207c 2028               | (
-00004f10: 2022 4465 6661 756c 7444 6561 646c 696e   "DefaultDeadlin
-00004f20: 6522 2c20 223d 2220 2c20 696e 7465 6765  e", "=" , intege
-00004f30: 7220 295c 6e20 2020 2020 2020 2020 2020  r )\n           
-00004f40: 2020 2020 207c 2028 2022 476f 7373 6970       | ( "Gossip
-00004f50: 5469 6d65 6f75 7422 2c20 223d 2220 2c20  Timeout", "=" , 
-00004f60: 696e 7465 6765 7220 295c 6e20 2020 2020  integer )\n     
-00004f70: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
-00004f80: 4d61 7844 6973 636f 7665 7241 7474 656d  MaxDiscoverAttem
-00004f90: 7074 7322 2c20 223d 2220 2c20 696e 7465  pts", "=" , inte
-00004fa0: 6765 7220 295c 6e20 2020 2020 2020 2020  ger )\n         
-00004fb0: 2020 2020 2020 207c 2028 2022 4469 7363         | ( "Disc
-00004fc0: 6f76 6572 7949 6e74 6572 7661 6c22 2c20  overyInterval", 
-00004fd0: 223d 2220 2c20 696e 7465 6765 7220 295c  "=" , integer )\
-00004fe0: 6e20 2020 2020 2020 2020 2020 2020 2020  n               
-00004ff0: 207c 2028 2022 4d61 7844 6973 636f 7665   | ( "MaxDiscove
-00005000: 7241 7474 656d 7074 7322 2c20 223d 2220  rAttempts", "=" 
-00005010: 2c20 696e 7465 6765 7220 295c 6e20 2020  , integer )\n   
-00005020: 2020 2020 2020 2020 2020 2020 207c 2028               | (
-00005030: 2022 4b65 6570 416c 6976 6549 6e74 6572   "KeepAliveInter
-00005040: 7661 6c22 2c20 223d 2220 2c20 696e 7465  val", "=" , inte
-00005050: 6765 7220 295c 6e20 2020 2020 2020 2020  ger )\n         
-00005060: 2020 2020 2020 207c 2028 2022 4b65 6570         | ( "Keep
-00005070: 416c 6976 6549 6e74 6572 7661 6c22 2c20  AliveInterval", 
-00005080: 223d 2220 2c20 696e 7465 6765 7220 2920  "=" , integer ) 
-00005090: 3b5c 6e5c 6e54 6865 2074 6162 6c65 2062  ;\n\nThe table b
-000050a0: 656c 6f77 2064 6573 6372 6962 6573 2074  elow describes t
-000050b0: 6865 2071 7565 7279 2066 6965 6c64 2d76  he query field-v
-000050c0: 616c 7565 7320 7375 7070 6f72 7465 6420  alues supported 
-000050d0: 6279 2074 6869 7320 636c 6965 6e74 2e5c  by this client.\
-000050e0: 6e5c 6e7c 2046 6965 6c64 2020 2020 2020  n\n| Field      
-000050f0: 2020 2020 2020 2020 207c 2056 616c 7565           | Value
-00005100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005140: 207c 2044 6573 6372 6970 7469 6f6e 2020   | Description  
-00005150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051e0: 2020 2020 207c 5c6e 7c2d 2d2d 2d2d 2d2d       |\n|-------
-000051f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d  --------------|-
-00005200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005220: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005240: 2d2d 2d2d 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d  ------|---------
-00005250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000052a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000052b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000052c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000052d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000052e0: 2d2d 2d2d 2d2d 2d2d 2d2d 7c5c 6e7c 2054  ----------|\n| T
-000052f0: 6c73 2020 2020 2020 2020 2020 2020 2020  ls              
-00005300: 2020 207c 2022 7472 7565 222c 2022 6661     | "true", "fa
-00005310: 6c73 6522 2028 6465 6661 756c 743a 2022  lse" (default: "
-00005320: 7472 7565 2229 2020 2020 2020 2020 2020  true")          
-00005330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005340: 2020 2020 2020 2020 2020 207c 2049 6620             | If 
-00005350: 2274 7275 6522 2074 6865 2063 6c69 656e  "true" the clien
-00005360: 7420 7769 6c6c 2063 7265 6174 6520 6120  t will create a 
-00005370: 2273 6563 7572 6522 2067 5250 4320 6368  "secure" gRPC ch
-00005380: 616e 6e65 6c2e 2049 6620 2266 616c 7365  annel. If "false
-00005390: 2220 7468 6520 636c 6965 6e74 2077 696c  " the client wil
-000053a0: 6c20 6372 6561 7465 2061 6e20 2269 6e73  l create an "ins
-000053b0: 6563 7572 6522 2067 5250 4320 6368 616e  ecure" gRPC chan
-000053c0: 6e65 6c2e 2054 6869 7320 6d75 7374 206d  nel. This must m
-000053d0: 6174 6368 2074 6865 2073 6572 7665 7220  atch the server 
-000053e0: 636f 6e66 6967 7572 6174 696f 6e2e 207c  configuration. |
-000053f0: 5c6e 7c20 546c 7356 6572 6966 7943 6572  \n| TlsVerifyCer
-00005400: 7420 2020 2020 2020 7c20 2274 7275 6522  t       | "true"
-00005410: 2c20 2266 616c 7365 2220 2864 6566 6175  , "false" (defau
-00005420: 6c74 3a20 2274 7275 6522 2920 2020 2020  lt: "true")     
-00005430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005450: 7c20 5468 6973 2076 616c 7565 2069 7320  | This value is 
-00005460: 6375 7272 656e 746c 7920 6967 6e6f 7265  currently ignore
-00005470: 642e 2020 2020 2020 2020 2020 2020 2020  d.              
-00005480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054f0: 2020 2020 7c5c 6e7c 2043 6f6e 6e65 6374      |\n| Connect
-00005500: 696f 6e4e 616d 6520 2020 2020 207c 2073  ionName      | s
-00005510: 7472 696e 6720 2864 6566 6175 6c74 3a20  tring (default: 
-00005520: 6175 746f 2d67 656e 6572 6174 6564 2076  auto-generated v
-00005530: 6572 7369 6f6e 2d34 2055 5549 4429 2020  ersion-4 UUID)  
-00005540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005550: 2020 2020 207c 2053 656e 7420 696e 2063       | Sent in c
-00005560: 616c 6c20 6d65 7461 6461 7461 2066 6f72  all metadata for
-00005570: 2065 7665 7279 2063 616c 6c2c 2074 6f20   every call, to 
-00005580: 6964 656e 7469 6679 2074 6865 2063 6c69  identify the cli
-00005590: 656e 7420 746f 2074 6865 2063 6c75 7374  ent to the clust
-000055a0: 6572 2e20 2020 2020 2020 2020 2020 2020  er.             
+00000000: 2320 5079 7468 6f6e 2067 5250 4320 436c  # Python gRPC Cl
+00000010: 6965 6e74 2066 6f72 2045 7665 6e74 5374  ient for EventSt
+00000020: 6f72 6544 420a 0a54 6869 7320 5b50 7974  oreDB..This [Pyt
+00000030: 686f 6e20 7061 636b 6167 655d 2868 7474  hon package](htt
+00000040: 7073 3a2f 2f70 7970 692e 6f72 672f 7072  ps://pypi.org/pr
+00000050: 6f6a 6563 742f 6573 6462 636c 6965 6e74  oject/esdbclient
+00000060: 2f29 2070 726f 7669 6465 7320 6d75 6c74  /) provides mult
+00000070: 6974 6872 6561 6465 6420 616e 6420 6173  ithreaded and as
+00000080: 796e 6369 6f20 5079 7468 6f6e 0a63 6c69  yncio Python.cli
+00000090: 656e 7473 2066 6f72 2074 6865 205b 4576  ents for the [Ev
+000000a0: 656e 7453 746f 7265 4442 5d28 6874 7470  entStoreDB](http
+000000b0: 733a 2f2f 7777 772e 6576 656e 7473 746f  s://www.eventsto
+000000c0: 7265 2e63 6f6d 2f29 2064 6174 6162 6173  re.com/) databas
+000000d0: 652e 0a0a 5468 6520 6d75 6c74 6974 6872  e...The multithr
+000000e0: 6561 6465 6420 6045 7665 6e74 5374 6f72  eaded `EventStor
+000000f0: 6544 4243 6c69 656e 7460 2069 7320 6465  eDBClient` is de
+00000100: 7363 7269 6265 6420 696e 2064 6574 6169  scribed in detai
+00000110: 6c20 6265 6c6f 772e 2050 6c65 6173 6520  l below. Please 
+00000120: 7363 726f 6c6c 0a64 6f77 6e20 666f 7220  scroll.down for 
+00000130: 3c61 2068 7265 663d 2223 6173 796e 6369  <a href="#asynci
+00000140: 6f2d 636c 6965 6e74 223e 696e 666f 726d  o-client">inform
+00000150: 6174 696f 6e3c 2f61 3e20 6162 6f75 7420  ation</a> about 
+00000160: 6041 7379 6e63 696f 4576 656e 7453 746f  `AsyncioEventSto
+00000170: 7265 4442 436c 6965 6e74 602e 0a0a 5468  reDBClient`...Th
+00000180: 6573 6520 636c 6965 6e74 7320 6861 7665  ese clients have
+00000190: 2062 6565 6e20 6465 7665 6c6f 7065 6420   been developed 
+000001a0: 616e 6420 6172 6520 6265 696e 6720 6d61  and are being ma
+000001b0: 696e 7461 696e 6564 2069 6e20 6120 636f  intained in a co
+000001c0: 6c6c 6162 6f72 6174 696f 6e0a 7769 7468  llaboration.with
+000001d0: 2074 6865 2045 7665 6e74 5374 6f72 6544   the EventStoreD
+000001e0: 4220 7465 616d 2c20 616e 6420 6172 6520  B team, and are 
+000001f0: 6f66 6669 6369 616c 6c79 2073 7570 706f  officially suppo
+00000200: 7274 2062 7920 4576 656e 7420 5374 6f72  rt by Event Stor
+00000210: 6520 4c74 642e 0a41 6c74 686f 7567 6820  e Ltd..Although 
+00000220: 6e6f 7420 616c 6c20 7468 6520 6665 6174  not all the feat
+00000230: 7572 6573 206f 6620 4576 656e 7453 746f  ures of EventSto
+00000240: 7265 4442 2061 7265 2073 7570 706f 7274  reDB are support
+00000250: 6564 2c20 6d61 6e79 206f 6620 7468 6520  ed, many of the 
+00000260: 6d6f 7374 0a75 7365 6675 6c20 6665 6174  most.useful feat
+00000270: 7572 6573 2061 7265 2070 7265 7365 6e74  ures are present
+00000280: 6564 2069 6e20 616e 2065 6173 792d 746f  ed in an easy-to
+00000290: 2d75 7365 2069 6e74 6572 6661 6365 2e0a  -use interface..
+000002a0: 0a54 6865 7365 2063 6c69 656e 7473 2068  .These clients h
+000002b0: 6176 6520 6265 656e 2074 6573 7465 6420  ave been tested 
+000002c0: 746f 2077 6f72 6b20 7769 7468 2045 7665  to work with Eve
+000002d0: 6e74 5374 6f72 6544 4220 4c54 5320 7665  ntStoreDB LTS ve
+000002e0: 7273 696f 6e73 2032 312e 3130 2c0a 3232  rsions 21.10,.22
+000002f0: 2e31 302c 2032 332e 3130 2c20 616e 6420  .10, 23.10, and 
+00000300: 7665 7273 696f 6e20 3234 2e32 2c20 7769  version 24.2, wi
+00000310: 7468 6f75 7420 616e 6420 7769 7468 6f75  thout and withou
+00000320: 7420 5353 4c2f 544c 532c 2077 6974 6820  t SSL/TLS, with 
+00000330: 7369 6e67 6c65 2d73 6572 7665 720a 616e  single-server.an
+00000340: 6420 636c 7573 7465 7220 6d6f 6465 732c  d cluster modes,
+00000350: 2061 6e64 2077 6974 6820 5079 7468 6f6e   and with Python
+00000360: 2076 6572 7369 6f6e 7320 332e 372c 2033   versions 3.7, 3
+00000370: 2e38 2c20 332e 392c 2033 2e31 302c 2033  .8, 3.9, 3.10, 3
+00000380: 2e31 3120 616e 6420 332e 3132 2e0a 0a54  .11 and 3.12...T
+00000390: 6865 2074 6573 7420 7375 6974 6520 6861  he test suite ha
+000003a0: 7320 3130 3025 206c 696e 6520 616e 6420  s 100% line and 
+000003b0: 6272 616e 6368 2063 6f76 6572 6167 652e  branch coverage.
+000003c0: 2054 6865 2063 6f64 6520 6861 7320 7479   The code has ty
+000003d0: 7069 6e67 2061 6e6e 6f74 6174 696f 6e73  ping annotations
+000003e0: 0a63 6865 636b 6564 2073 7472 6963 746c  .checked strictl
+000003f0: 7920 7769 7468 206d 7970 792e 2054 6865  y with mypy. The
+00000400: 2063 6f64 6520 6973 2066 6f72 6d61 7474   code is formatt
+00000410: 6564 2077 6974 6820 626c 6163 6b20 616e  ed with black an
+00000420: 6420 6973 6f72 742c 2061 6e64 2063 6865  d isort, and che
+00000430: 636b 6564 0a77 6974 6820 666c 616b 6538  cked.with flake8
+00000440: 2e20 506f 6574 7279 2069 7320 7573 6564  . Poetry is used
+00000450: 2066 6f72 2070 6163 6b61 6765 206d 616e   for package man
+00000460: 6167 656d 656e 7420 6475 7269 6e67 2064  agement during d
+00000470: 6576 656c 6f70 6d65 6e74 2c20 616e 6420  evelopment, and 
+00000480: 666f 720a 6275 696c 6469 6e67 2061 6e64  for.building and
+00000490: 2070 7562 6c69 7368 696e 6720 6469 7374   publishing dist
+000004a0: 7269 6275 7469 6f6e 7320 746f 205b 5079  ributions to [Py
+000004b0: 5049 5d28 6874 7470 733a 2f2f 7079 7069  PI](https://pypi
+000004c0: 2e6f 7267 2f70 726f 6a65 6374 2f65 7364  .org/project/esd
+000004d0: 6263 6c69 656e 742f 292e 0a0a 0a23 2320  bclient/)....## 
+000004e0: 5379 6e6f 7073 6973 0a0a 5468 6520 6045  Synopsis..The `E
+000004f0: 7665 6e74 5374 6f72 6544 4243 6c69 656e  ventStoreDBClien
+00000500: 7460 2063 6c61 7373 2063 616e 2062 6520  t` class can be 
+00000510: 696d 706f 7274 6564 2066 726f 6d20 7468  imported from th
+00000520: 6520 6065 7364 6263 6c69 656e 7460 2070  e `esdbclient` p
+00000530: 6163 6b61 6765 2e0a 0a50 726f 6261 626c  ackage...Probabl
+00000540: 7920 7468 6520 7468 7265 6520 6d6f 7374  y the three most
+00000550: 2075 7365 6675 6c20 6d65 7468 6f64 7320   useful methods 
+00000560: 6f66 2060 4576 656e 7453 746f 7265 4442  of `EventStoreDB
+00000570: 436c 6965 6e74 6020 6172 653a 0a0a 2a20  Client` are:..* 
+00000580: 6061 7070 656e 645f 746f 5f73 7472 6561  `append_to_strea
+00000590: 6d28 2960 2054 6869 7320 6d65 7468 6f64  m()` This method
+000005a0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+000005b0: 7265 636f 7264 206e 6577 2065 7665 6e74  record new event
+000005c0: 7320 696e 2061 2070 6172 7469 6375 6c61  s in a particula
+000005d0: 720a 2273 7472 6561 6d22 2e20 5468 6973  r."stream". This
+000005e0: 2069 7320 7573 6566 756c 2c20 666f 7220   is useful, for 
+000005f0: 6578 616d 706c 652c 2077 6865 6e20 6578  example, when ex
+00000600: 6563 7574 696e 6720 6120 636f 6d6d 616e  ecuting a comman
+00000610: 6420 696e 2061 6e20 6170 706c 6963 6174  d in an applicat
+00000620: 696f 6e0a 7468 6174 206d 7574 6174 6573  ion.that mutates
+00000630: 2061 6e20 6167 6772 6567 6174 652e 2054   an aggregate. T
+00000640: 6869 7320 6d65 7468 6f64 2069 7320 2261  his method is "a
+00000650: 746f 6d69 6322 2069 6e20 7468 6174 2065  tomic" in that e
+00000660: 6974 6865 7220 616c 6c20 6f72 206e 6f6e  ither all or non
+00000670: 6520 6f66 0a74 6865 2065 7665 6e74 7320  e of.the events 
+00000680: 7769 6c6c 2062 6520 7265 636f 7264 6564  will be recorded
+00000690: 2e0a 0a2a 2060 6765 745f 7374 7265 616d  ...* `get_stream
+000006a0: 2829 6020 5468 6973 206d 6574 686f 6420  ()` This method 
+000006b0: 6361 6e20 6265 2075 7365 6420 746f 2072  can be used to r
+000006c0: 6574 7269 6576 6520 616c 6c20 7468 6520  etrieve all the 
+000006d0: 7265 636f 7264 6564 0a65 7665 6e74 7320  recorded.events 
+000006e0: 696e 2061 2022 7374 7265 616d 222e 2054  in a "stream". T
+000006f0: 6869 7320 6973 2075 7365 6675 6c2c 2066  his is useful, f
+00000700: 6f72 2065 7861 6d70 6c65 2c20 7768 656e  or example, when
+00000710: 2072 6563 6f6e 7374 7275 6374 696e 670a   reconstructing.
+00000720: 616e 2061 6767 7265 6761 7465 2066 726f  an aggregate fro
+00000730: 6d20 7265 636f 7264 6564 2065 7665 6e74  m recorded event
+00000740: 7320 6265 666f 7265 2065 7865 6375 7469  s before executi
+00000750: 6e67 2061 2063 6f6d 6d61 6e64 2069 6e20  ng a command in 
+00000760: 616e 0a61 7070 6c69 6361 7469 6f6e 2074  an.application t
+00000770: 6861 7420 6372 6561 7465 7320 6e65 7720  hat creates new 
+00000780: 6576 656e 7473 2e0a 0a2a 2060 7375 6273  events...* `subs
+00000790: 6372 6962 655f 746f 5f61 6c6c 2829 6020  cribe_to_all()` 
+000007a0: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
+000007b0: 6265 2075 7365 6420 746f 2072 6563 6569  be used to recei
+000007c0: 7665 2061 6c6c 2072 6563 6f72 6465 6420  ve all recorded 
+000007d0: 6576 656e 7473 2069 6e0a 7468 6520 6461  events in.the da
+000007e0: 7461 6261 7365 2e20 5468 6973 2069 7320  tabase. This is 
+000007f0: 7573 6566 756c 2c20 666f 7220 6578 616d  useful, for exam
+00000800: 706c 652c 2069 6e20 6576 656e 742d 7072  ple, in event-pr
+00000810: 6f63 6573 7369 6e67 2063 6f6d 706f 6e65  ocessing compone
+00000820: 6e74 7320 6265 6361 7573 650a 6974 2073  nts because.it s
+00000830: 7570 706f 7274 7320 7072 6f63 6573 7369  upports processi
+00000840: 6e67 2065 7665 6e74 7320 7769 7468 2022  ng events with "
+00000850: 6578 6163 746c 792d 6f6e 6365 2220 7365  exactly-once" se
+00000860: 6d61 6e74 6963 732e 0a0a 5468 6520 6578  mantics...The ex
+00000870: 616d 706c 6520 6265 6c6f 7720 7573 6573  ample below uses
+00000880: 2061 6e20 2269 6e73 6563 7572 6522 2045   an "insecure" E
+00000890: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
+000008a0: 6572 2072 756e 6e69 6e67 206c 6f63 616c  er running local
+000008b0: 6c79 206f 6e20 706f 7274 2032 3131 332e  ly on port 2113.
+000008c0: 0a0a 6060 6070 7974 686f 6e0a 696d 706f  ..```python.impo
+000008d0: 7274 2075 7569 640a 0a66 726f 6d20 6573  rt uuid..from es
+000008e0: 6462 636c 6965 6e74 2069 6d70 6f72 7420  dbclient import 
+000008f0: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
+00000900: 6e74 2c20 4e65 7745 7665 6e74 2c20 5374  nt, NewEvent, St
+00000910: 7265 616d 5374 6174 650a 0a0a 2320 436f  reamState...# Co
+00000920: 6e73 7472 7563 7420 4576 656e 7453 746f  nstruct EventSto
+00000930: 7265 4442 436c 6965 6e74 2077 6974 6820  reDBClient with 
+00000940: 616e 2045 7665 6e74 5374 6f72 6544 4220  an EventStoreDB 
+00000950: 5552 492e 2054 6865 0a23 2063 6f6e 6e65  URI. The.# conne
+00000960: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+00000970: 2073 7065 6369 6669 6573 2074 6861 7420   specifies that 
+00000980: 7468 6520 636c 6965 6e74 2073 686f 756c  the client shoul
+00000990: 640a 2320 636f 6e6e 6563 7420 746f 2061  d.# connect to a
+000009a0: 6e20 2269 6e73 6563 7572 6522 2073 6572  n "insecure" ser
+000009b0: 7665 7220 7275 6e6e 696e 6720 6f6e 2070  ver running on p
+000009c0: 6f72 7420 3231 3133 2e0a 0a63 6c69 656e  ort 2113...clien
+000009d0: 7420 3d20 4576 656e 7453 746f 7265 4442  t = EventStoreDB
+000009e0: 436c 6965 6e74 280a 2020 2020 7572 693d  Client(.    uri=
+000009f0: 2265 7364 623a 2f2f 6c6f 6361 6c68 6f73  "esdb://localhos
+00000a00: 743a 3231 3133 3f54 6c73 3d66 616c 7365  t:2113?Tls=false
+00000a10: 220a 290a 0a0a 2320 4765 6e65 7261 7465  ".)...# Generate
+00000a20: 206e 6577 2065 7665 6e74 732e 2054 7970   new events. Typ
+00000a30: 6963 616c 6c79 2c20 646f 6d61 696e 2065  ically, domain e
+00000a40: 7665 6e74 7320 6f66 2064 6966 6665 7265  vents of differe
+00000a50: 6e74 0a23 2074 7970 6573 2061 7265 2067  nt.# types are g
+00000a60: 656e 6572 6174 6564 2069 6e20 6120 646f  enerated in a do
+00000a70: 6d61 696e 206d 6f64 656c 2c20 616e 6420  main model, and 
+00000a80: 7468 656e 2073 6572 6961 6c69 7a65 640a  then serialized.
+00000a90: 2320 696e 746f 204e 6577 4576 656e 7420  # into NewEvent 
+00000aa0: 6f62 6a65 6374 732e 2041 6e20 6167 6772  objects. An aggr
+00000ab0: 6567 6174 6520 4944 206d 6179 2062 6520  egate ID may be 
+00000ac0: 7573 6564 2061 7320 7468 650a 2320 6e61  used as the.# na
+00000ad0: 6d65 206f 6620 6120 7374 7265 616d 2069  me of a stream i
+00000ae0: 6e20 4576 656e 7453 746f 7265 4442 2e0a  n EventStoreDB..
+00000af0: 0a73 7472 6561 6d5f 6e61 6d65 3120 3d20  .stream_name1 = 
+00000b00: 7374 7228 7575 6964 2e75 7569 6434 2829  str(uuid.uuid4()
+00000b10: 290a 6576 656e 7431 203d 204e 6577 4576  ).event1 = NewEv
+00000b20: 656e 7428 0a20 2020 2074 7970 653d 274f  ent(.    type='O
+00000b30: 7264 6572 4372 6561 7465 6427 2c0a 2020  rderCreated',.  
+00000b40: 2020 6461 7461 3d62 277b 226f 7264 6572    data=b'{"order
+00000b50: 5f6e 756d 6265 7222 3a20 2231 3233 3435  _number": "12345
+00000b60: 3622 7d27 0a29 0a65 7665 6e74 3220 3d20  6"}'.).event2 = 
+00000b70: 4e65 7745 7665 6e74 280a 2020 2020 7479  NewEvent(.    ty
+00000b80: 7065 3d27 4f72 6465 7253 7562 6d69 7474  pe='OrderSubmitt
+00000b90: 6564 272c 0a20 2020 2064 6174 613d 6227  ed',.    data=b'
+00000ba0: 7b7d 270a 290a 6576 656e 7433 203d 204e  {}'.).event3 = N
+00000bb0: 6577 4576 656e 7428 0a20 2020 2074 7970  ewEvent(.    typ
+00000bc0: 653d 274f 7264 6572 4361 6e63 656c 6c65  e='OrderCancelle
+00000bd0: 6427 2c0a 2020 2020 6461 7461 3d62 277b  d',.    data=b'{
+00000be0: 7d27 0a29 0a0a 0a23 2041 7070 656e 6420  }'.)...# Append 
+00000bf0: 6e65 7720 6576 656e 7473 2074 6f20 6120  new events to a 
+00000c00: 6e65 7720 7374 7265 616d 2e20 5468 6520  new stream. The 
+00000c10: 7661 6c75 6520 7265 7475 726e 6564 0a23  value returned.#
+00000c20: 2066 726f 6d20 7468 6520 6170 7065 6e64   from the append
+00000c30: 5f74 6f5f 7374 7265 616d 2829 206d 6574  _to_stream() met
+00000c40: 686f 6420 6973 2074 6865 206f 7665 7261  hod is the overa
+00000c50: 6c6c 0a23 2022 636f 6d6d 6974 2070 6f73  ll.# "commit pos
+00000c60: 6974 696f 6e22 2069 6e20 7468 6520 6461  ition" in the da
+00000c70: 7461 6261 7365 206f 6620 7468 6520 6c61  tabase of the la
+00000c80: 7374 206e 6577 2065 7665 6e74 0a23 2072  st new event.# r
+00000c90: 6563 6f72 6465 6420 6279 2074 6869 7320  ecorded by this 
+00000ca0: 6f70 6572 6174 696f 6e2e 2054 6865 2072  operation. The r
+00000cb0: 6574 7572 6e65 6420 2263 6f6d 6d69 7420  eturned "commit 
+00000cc0: 706f 7369 7469 6f6e 220a 2320 6d61 7920  position".# may 
+00000cd0: 6265 2075 7365 6420 696e 2061 2075 7365  be used in a use
+00000ce0: 7220 696e 7465 7266 6163 6520 746f 2070  r interface to p
+00000cf0: 6f6c 6c20 616e 2065 7665 6e74 7561 6c6c  oll an eventuall
+00000d00: 790a 2320 636f 6e73 6973 7465 6e74 2065  y.# consistent e
+00000d10: 7665 6e74 2d70 726f 6365 7373 696e 6720  vent-processing 
+00000d20: 636f 6d70 6f6e 656e 7420 756e 7469 6c20  component until 
+00000d30: 6974 2063 616e 0a23 2070 7265 7365 6e74  it can.# present
+00000d40: 2061 6e20 7570 2d74 6f2d 6461 7465 206d   an up-to-date m
+00000d50: 6174 6572 6961 6c69 7a65 6420 7669 6577  aterialized view
+00000d60: 2e20 4e65 7720 6576 656e 7473 2061 7265  . New events are
+00000d70: 0a23 2065 6163 6820 616c 6c6f 6361 7465  .# each allocate
+00000d80: 6420 6120 2273 7472 6561 6d20 706f 7369  d a "stream posi
+00000d90: 7469 6f6e 222c 2077 6869 6368 2069 7320  tion", which is 
+00000da0: 7468 6520 6e65 7874 0a23 2061 7661 696c  the next.# avail
+00000db0: 6162 6c65 2070 6f73 6974 696f 6e20 696e  able position in
+00000dc0: 2074 6865 2073 7472 6561 6d2c 2073 7461   the stream, sta
+00000dd0: 7274 696e 6720 6672 6f6d 2030 2e0a 0a63  rting from 0...c
+00000de0: 6f6d 6d69 745f 706f 7369 7469 6f6e 3120  ommit_position1 
+00000df0: 3d20 636c 6965 6e74 2e61 7070 656e 645f  = client.append_
+00000e00: 746f 5f73 7472 6561 6d28 0a20 2020 2073  to_stream(.    s
+00000e10: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+00000e20: 6d5f 6e61 6d65 312c 0a20 2020 2063 7572  m_name1,.    cur
+00000e30: 7265 6e74 5f76 6572 7369 6f6e 3d53 7472  rent_version=Str
+00000e40: 6561 6d53 7461 7465 2e4e 4f5f 5354 5245  eamState.NO_STRE
+00000e50: 414d 2c0a 2020 2020 6576 656e 7473 3d5b  AM,.    events=[
+00000e60: 6576 656e 7431 2c20 6576 656e 7432 5d2c  event1, event2],
+00000e70: 0a29 0a0a 2320 4170 7065 6e64 2065 7665  .)..# Append eve
+00000e80: 6e74 7320 746f 2061 6e20 6578 6973 7469  nts to an existi
+00000e90: 6e67 2073 7472 6561 6d2e 2054 6865 2022  ng stream. The "
+00000ea0: 6375 7272 656e 7420 7665 7273 696f 6e22  current version"
+00000eb0: 0a23 2069 7320 7468 6520 2273 7472 6561  .# is the "strea
+00000ec0: 6d20 706f 7369 7469 6f6e 2220 6f66 2074  m position" of t
+00000ed0: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
+00000ee0: 2065 7665 6e74 2069 6e20 610a 2320 7374   event in a.# st
+00000ef0: 7265 616d 2e20 5765 2068 6176 6520 7265  ream. We have re
+00000f00: 636f 7264 6564 2074 776f 206e 6577 2065  corded two new e
+00000f10: 7665 6e74 732c 2073 6f20 7468 6520 2263  vents, so the "c
+00000f20: 7572 7265 6e74 0a23 2076 6572 7369 6f6e  urrent.# version
+00000f30: 2220 6973 2031 2e20 5468 6520 6578 6365  " is 1. The exce
+00000f40: 7074 696f 6e20 2757 726f 6e67 4375 7272  ption 'WrongCurr
+00000f50: 656e 7456 6572 7369 6f6e 2720 7769 6c6c  entVersion' will
+00000f60: 2062 650a 2320 7261 6973 6564 2069 6620   be.# raised if 
+00000f70: 616e 2069 6e63 6f72 7265 6374 2076 616c  an incorrect val
+00000f80: 7565 2069 7320 6769 7665 6e2e 0a0a 636f  ue is given...co
+00000f90: 6d6d 6974 5f70 6f73 6974 696f 6e32 203d  mmit_position2 =
+00000fa0: 2063 6c69 656e 742e 6170 7065 6e64 5f74   client.append_t
+00000fb0: 6f5f 7374 7265 616d 280a 2020 2020 7374  o_stream(.    st
+00000fc0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+00000fd0: 5f6e 616d 6531 2c0a 2020 2020 6375 7272  _name1,.    curr
+00000fe0: 656e 745f 7665 7273 696f 6e3d 312c 0a20  ent_version=1,. 
+00000ff0: 2020 2065 7665 6e74 733d 5b65 7665 6e74     events=[event
+00001000: 335d 2c0a 290a 0a23 202d 2061 6c6c 6f63  3],.)..# - alloc
+00001010: 6174 6564 2063 6f6d 6d69 7420 706f 7369  ated commit posi
+00001020: 7469 6f6e 7320 696e 6372 6561 7365 206d  tions increase m
+00001030: 6f6e 6f74 6f6e 6963 616c 6c79 0a61 7373  onotonically.ass
+00001040: 6572 7420 636f 6d6d 6974 5f70 6f73 6974  ert commit_posit
+00001050: 696f 6e32 203e 2063 6f6d 6d69 745f 706f  ion2 > commit_po
+00001060: 7369 7469 6f6e 310a 0a0a 2320 4765 7420  sition1...# Get 
+00001070: 6576 656e 7473 2072 6563 6f72 6465 6420  events recorded 
+00001080: 696e 2061 2073 7472 6561 6d2e 2054 6869  in a stream. Thi
+00001090: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
+000010a0: 0a23 2061 2073 6571 7565 6e63 6520 6f66  .# a sequence of
+000010b0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+000010c0: 6f62 6a65 6374 732e 2054 6865 2072 6563  objects. The rec
+000010d0: 6f72 6465 640a 2320 6576 656e 7420 6f62  orded.# event ob
+000010e0: 6a65 6374 7320 6d61 7920 6265 2064 6573  jects may be des
+000010f0: 6572 6961 6c69 7a65 6420 746f 2064 6f6d  erialized to dom
+00001100: 6169 6e20 6576 656e 740a 2320 6f62 6a65  ain event.# obje
+00001110: 6374 7320 6f66 2064 6966 6665 7265 6e74  cts of different
+00001120: 2074 7970 6573 2061 6e64 2075 7365 6420   types and used 
+00001130: 746f 2072 6563 6f6e 7374 7275 6374 0a23  to reconstruct.#
+00001140: 2061 6e20 6167 6772 6567 6174 6520 696e   an aggregate in
+00001150: 2061 2064 6f6d 6169 6e20 6d6f 6465 6c2e   a domain model.
+00001160: 0a0a 7265 636f 7264 6564 5f65 7665 6e74  ..recorded_event
+00001170: 7320 3d20 636c 6965 6e74 2e67 6574 5f73  s = client.get_s
+00001180: 7472 6561 6d28 0a20 2020 2073 7472 6561  tream(.    strea
+00001190: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+000011a0: 6d65 310a 290a 0a23 202d 2073 7472 6561  me1.)..# - strea
+000011b0: 6d20 2773 7472 6561 6d5f 6e61 6d65 3127  m 'stream_name1'
+000011c0: 206e 6f77 2068 6173 2074 6872 6565 2065   now has three e
+000011d0: 7665 6e74 730a 6173 7365 7274 206c 656e  vents.assert len
+000011e0: 2872 6563 6f72 6465 645f 6576 656e 7473  (recorded_events
+000011f0: 2920 3d3d 2033 0a0a 2320 2d20 616c 6c6f  ) == 3..# - allo
+00001200: 6361 7465 6420 7374 7265 616d 2070 6f73  cated stream pos
+00001210: 6974 696f 6e73 2061 7265 207a 6572 6f2d  itions are zero-
+00001220: 6261 7365 6420 616e 6420 6761 706c 6573  based and gaples
+00001230: 730a 6173 7365 7274 2072 6563 6f72 6465  s.assert recorde
+00001240: 645f 6576 656e 7473 5b30 5d2e 7374 7265  d_events[0].stre
+00001250: 616d 5f70 6f73 6974 696f 6e20 3d3d 2030  am_position == 0
+00001260: 0a61 7373 6572 7420 7265 636f 7264 6564  .assert recorded
+00001270: 5f65 7665 6e74 735b 315d 2e73 7472 6561  _events[1].strea
+00001280: 6d5f 706f 7369 7469 6f6e 203d 3d20 310a  m_position == 1.
+00001290: 6173 7365 7274 2072 6563 6f72 6465 645f  assert recorded_
+000012a0: 6576 656e 7473 5b32 5d2e 7374 7265 616d  events[2].stream
+000012b0: 5f70 6f73 6974 696f 6e20 3d3d 2032 0a0a  _position == 2..
+000012c0: 2320 2d20 6576 656e 7420 6174 7472 6962  # - event attrib
+000012d0: 7574 6520 7661 6c75 6573 2061 7265 2072  ute values are r
+000012e0: 6563 6f72 6465 6420 6661 6974 6866 756c  ecorded faithful
+000012f0: 6c79 0a61 7373 6572 7420 7265 636f 7264  ly.assert record
+00001300: 6564 5f65 7665 6e74 735b 305d 2e74 7970  ed_events[0].typ
+00001310: 6520 3d3d 2022 4f72 6465 7243 7265 6174  e == "OrderCreat
+00001320: 6564 220a 6173 7365 7274 2072 6563 6f72  ed".assert recor
+00001330: 6465 645f 6576 656e 7473 5b30 5d2e 6461  ded_events[0].da
+00001340: 7461 203d 3d20 6227 7b22 6f72 6465 725f  ta == b'{"order_
+00001350: 6e75 6d62 6572 223a 2022 3132 3334 3536  number": "123456
+00001360: 227d 270a 6173 7365 7274 2072 6563 6f72  "}'.assert recor
+00001370: 6465 645f 6576 656e 7473 5b30 5d2e 6964  ded_events[0].id
+00001380: 203d 3d20 6576 656e 7431 2e69 640a 0a61   == event1.id..a
+00001390: 7373 6572 7420 7265 636f 7264 6564 5f65  ssert recorded_e
+000013a0: 7665 6e74 735b 315d 2e74 7970 6520 3d3d  vents[1].type ==
+000013b0: 2022 4f72 6465 7253 7562 6d69 7474 6564   "OrderSubmitted
+000013c0: 220a 6173 7365 7274 2072 6563 6f72 6465  ".assert recorde
+000013d0: 645f 6576 656e 7473 5b31 5d2e 6461 7461  d_events[1].data
+000013e0: 203d 3d20 6227 7b7d 270a 6173 7365 7274   == b'{}'.assert
+000013f0: 2072 6563 6f72 6465 645f 6576 656e 7473   recorded_events
+00001400: 5b31 5d2e 6964 203d 3d20 6576 656e 7432  [1].id == event2
+00001410: 2e69 640a 0a61 7373 6572 7420 7265 636f  .id..assert reco
+00001420: 7264 6564 5f65 7665 6e74 735b 325d 2e74  rded_events[2].t
+00001430: 7970 6520 3d3d 2022 4f72 6465 7243 616e  ype == "OrderCan
+00001440: 6365 6c6c 6564 220a 6173 7365 7274 2072  celled".assert r
+00001450: 6563 6f72 6465 645f 6576 656e 7473 5b32  ecorded_events[2
+00001460: 5d2e 6461 7461 203d 3d20 6227 7b7d 270a  ].data == b'{}'.
+00001470: 6173 7365 7274 2072 6563 6f72 6465 645f  assert recorded_
+00001480: 6576 656e 7473 5b32 5d2e 6964 203d 3d20  events[2].id == 
+00001490: 6576 656e 7433 2e69 640a 0a0a 2320 5374  event3.id...# St
+000014a0: 6172 7420 6120 6361 7463 682d 7570 2073  art a catch-up s
+000014b0: 7562 7363 7269 7074 696f 6e20 6672 6f6d  ubscription from
+000014c0: 206c 6173 7420 7265 636f 7264 6564 2070   last recorded p
+000014d0: 6f73 6974 696f 6e2e 0a23 2054 6869 7320  osition..# This 
+000014e0: 6d65 7468 6f64 2072 6574 7572 6e73 2061  method returns a
+000014f0: 2022 6361 7463 682d 7570 2073 7562 7363   "catch-up subsc
+00001500: 7269 7074 696f 6e22 206f 626a 6563 742c  ription" object,
+00001510: 0a23 2077 6869 6368 2063 616e 2062 6520  .# which can be 
+00001520: 6974 6572 6174 6564 206f 7665 7220 746f  iterated over to
+00001530: 206f 6274 6169 6e20 7265 636f 7264 6564   obtain recorded
+00001540: 2065 7665 6e74 732e 0a23 2054 6865 2069   events..# The i
+00001550: 7465 7261 746f 7220 7769 6c6c 206e 6f74  terator will not
+00001560: 2073 746f 7020 7768 656e 2074 6865 7265   stop when there
+00001570: 2061 7265 206e 6f20 6d6f 7265 2072 6563   are no more rec
+00001580: 6f72 6465 640a 2320 6576 656e 7473 2074  orded.# events t
+00001590: 6f20 6265 2072 6574 7572 6e65 642c 2062  o be returned, b
+000015a0: 7574 2069 6e73 7465 6164 2077 696c 6c20  ut instead will 
+000015b0: 626c 6f63 6b2c 2061 6e64 2074 6865 6e20  block, and then 
+000015c0: 636f 6e74 696e 7565 0a23 2077 6865 6e20  continue.# when 
+000015d0: 6675 7274 6865 7220 6576 656e 7473 2061  further events a
+000015e0: 7265 2072 6563 6f72 6465 642e 2049 7420  re recorded. It 
+000015f0: 6361 6e20 6265 2075 7365 6420 6173 2061  can be used as a
+00001600: 2063 6f6e 7465 7874 0a23 206d 616e 6167   context.# manag
+00001610: 6572 2073 6f20 7468 6174 2074 6865 2075  er so that the u
+00001620: 6e64 6572 6c79 696e 6720 7374 7265 616d  nderlying stream
+00001630: 696e 6720 6752 5043 2063 616c 6c20 746f  ing gRPC call to
+00001640: 2074 6865 2064 6174 6162 6173 650a 2320   the database.# 
+00001650: 6361 6e20 6265 2063 616e 6365 6c6c 6564  can be cancelled
+00001660: 2063 6c65 616e 6c79 2069 6e20 6361 7365   cleanly in case
+00001670: 206f 6620 616e 7920 6572 726f 722e 0a0a   of any error...
+00001680: 7265 6365 6976 6564 5f65 7665 6e74 7320  received_events 
+00001690: 3d20 5b5d 0a77 6974 6820 636c 6965 6e74  = [].with client
+000016a0: 2e73 7562 7363 7269 6265 5f74 6f5f 616c  .subscribe_to_al
+000016b0: 6c28 636f 6d6d 6974 5f70 6f73 6974 696f  l(commit_positio
+000016c0: 6e3d 3029 2061 7320 7375 6273 6372 6970  n=0) as subscrip
+000016d0: 7469 6f6e 3a0a 0a20 2020 2023 2049 7465  tion:..    # Ite
+000016e0: 7261 7465 206f 7665 7220 7468 6520 6361  rate over the ca
+000016f0: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
+00001700: 696f 6e2e 2050 726f 6365 7373 2065 6163  ion. Process eac
+00001710: 6820 7265 636f 7264 6564 0a20 2020 2023  h recorded.    #
+00001720: 2065 7665 6e74 2069 6e20 7475 726e 2e20   event in turn. 
+00001730: 5769 7468 696e 2061 6e20 6174 6f6d 6963  Within an atomic
+00001740: 2064 6174 6162 6173 6520 7472 616e 7361   database transa
+00001750: 6374 696f 6e2c 2072 6563 6f72 640a 2020  ction, record.  
+00001760: 2020 2320 7468 6520 6576 656e 7427 7320    # the event's 
+00001770: 2263 6f6d 6d69 7420 706f 7369 7469 6f6e  "commit position
+00001780: 2220 616c 6f6e 6720 7769 7468 2061 6e79  " along with any
+00001790: 206e 6577 2073 7461 7465 2067 656e 6572   new state gener
+000017a0: 6174 6564 0a20 2020 2023 2062 7920 7072  ated.    # by pr
+000017b0: 6f63 6573 7369 6e67 2074 6865 2065 7665  ocessing the eve
+000017c0: 6e74 2e20 5573 6520 7468 6520 636f 6d70  nt. Use the comp
+000017d0: 6f6e 656e 7427 7320 6c61 7374 2072 6563  onent's last rec
+000017e0: 6f72 6465 6420 636f 6d6d 6974 0a20 2020  orded commit.   
+000017f0: 2023 2070 6f73 6974 696f 6e20 7768 656e   # position when
+00001800: 2072 6573 7461 7274 696e 6720 7468 6520   restarting the 
+00001810: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+00001820: 7074 696f 6e2e 0a0a 2020 2020 666f 7220  ption...    for 
+00001830: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
+00001840: 7074 696f 6e3a 0a20 2020 2020 2020 2072  ption:.        r
+00001850: 6563 6569 7665 645f 6576 656e 7473 2e61  eceived_events.a
+00001860: 7070 656e 6428 6576 656e 7429 0a0a 2020  ppend(event)..  
+00001870: 2020 2020 2020 6966 2065 7665 6e74 2e63        if event.c
+00001880: 6f6d 6d69 745f 706f 7369 7469 6f6e 203d  ommit_position =
+00001890: 3d20 636f 6d6d 6974 5f70 6f73 6974 696f  = commit_positio
+000018a0: 6e32 3a0a 2020 2020 2020 2020 2020 2020  n2:.            
+000018b0: 2320 4272 6561 6b20 736f 2077 6520 6361  # Break so we ca
+000018c0: 6e20 636f 6e74 696e 7565 2077 6974 6820  n continue with 
+000018d0: 7468 6520 6578 616d 706c 652e 0a20 2020  the example..   
+000018e0: 2020 2020 2020 2020 2062 7265 616b 0a0a           break..
+000018f0: 0a23 202d 2065 7665 6e74 7320 6172 6520  .# - events are 
+00001900: 7265 6365 6976 6564 2069 6e20 7468 6520  received in the 
+00001910: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
+00001920: 7265 636f 7264 6564 0a61 7373 6572 7420  recorded.assert 
+00001930: 7265 6365 6976 6564 5f65 7665 6e74 735b  received_events[
+00001940: 2d33 5d2e 7479 7065 203d 3d20 224f 7264  -3].type == "Ord
+00001950: 6572 4372 6561 7465 6422 0a61 7373 6572  erCreated".asser
+00001960: 7420 7265 6365 6976 6564 5f65 7665 6e74  t received_event
+00001970: 735b 2d33 5d2e 6461 7461 203d 3d20 6227  s[-3].data == b'
+00001980: 7b22 6f72 6465 725f 6e75 6d62 6572 223a  {"order_number":
+00001990: 2022 3132 3334 3536 227d 270a 6173 7365   "123456"}'.asse
+000019a0: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
+000019b0: 7473 5b2d 335d 2e69 6420 3d3d 2065 7665  ts[-3].id == eve
+000019c0: 6e74 312e 6964 0a0a 6173 7365 7274 2072  nt1.id..assert r
+000019d0: 6563 6569 7665 645f 6576 656e 7473 5b2d  eceived_events[-
+000019e0: 325d 2e74 7970 6520 3d3d 2022 4f72 6465  2].type == "Orde
+000019f0: 7253 7562 6d69 7474 6564 220a 6173 7365  rSubmitted".asse
+00001a00: 7274 2072 6563 6569 7665 645f 6576 656e  rt received_even
+00001a10: 7473 5b2d 325d 2e64 6174 6120 3d3d 2062  ts[-2].data == b
+00001a20: 277b 7d27 0a61 7373 6572 7420 7265 6365  '{}'.assert rece
+00001a30: 6976 6564 5f65 7665 6e74 735b 2d32 5d2e  ived_events[-2].
+00001a40: 6964 203d 3d20 6576 656e 7432 2e69 640a  id == event2.id.
+00001a50: 0a61 7373 6572 7420 7265 6365 6976 6564  .assert received
+00001a60: 5f65 7665 6e74 735b 2d31 5d2e 7479 7065  _events[-1].type
+00001a70: 203d 3d20 224f 7264 6572 4361 6e63 656c   == "OrderCancel
+00001a80: 6c65 6422 0a61 7373 6572 7420 7265 6365  led".assert rece
+00001a90: 6976 6564 5f65 7665 6e74 735b 2d31 5d2e  ived_events[-1].
+00001aa0: 6461 7461 203d 3d20 6227 7b7d 270a 6173  data == b'{}'.as
+00001ab0: 7365 7274 2072 6563 6569 7665 645f 6576  sert received_ev
+00001ac0: 656e 7473 5b2d 315d 2e69 6420 3d3d 2065  ents[-1].id == e
+00001ad0: 7665 6e74 332e 6964 0a0a 0a23 2043 6c6f  vent3.id...# Clo
+00001ae0: 7365 2074 6865 2063 6c69 656e 7427 7320  se the client's 
+00001af0: 6752 5043 2063 6f6e 6e65 6374 696f 6e2e  gRPC connection.
+00001b00: 0a0a 636c 6965 6e74 2e63 6c6f 7365 2829  ..client.close()
+00001b10: 0a60 6060 0a0a 5365 6520 6265 6c6f 7720  .```..See below 
+00001b20: 666f 7220 6d6f 7265 2064 6574 6169 6c73  for more details
+00001b30: 2e0a 0a46 6f72 2061 6e20 6578 616d 706c  ...For an exampl
+00001b40: 6520 6f66 2075 7361 6765 2c20 7365 6520  e of usage, see 
+00001b50: 7468 6520 5b65 7665 6e74 736f 7572 6369  the [eventsourci
+00001b60: 6e67 2d65 7665 6e74 7374 6f72 6564 625d  ng-eventstoredb]
+00001b70: 280a 6874 7470 733a 2f2f 6769 7468 7562  (.https://github
+00001b80: 2e63 6f6d 2f70 7965 7665 6e74 736f 7572  .com/pyeventsour
+00001b90: 6369 6e67 2f65 7665 6e74 736f 7572 6369  cing/eventsourci
+00001ba0: 6e67 2d65 7665 6e74 7374 6f72 6564 6229  ng-eventstoredb)
+00001bb0: 2070 6163 6b61 6765 2e0a 0a23 2320 5461   package...## Ta
+00001bc0: 626c 6520 6f66 2063 6f6e 7465 6e74 730a  ble of contents.
+00001bd0: 0a3c 212d 2d20 544f 4320 2d2d 3e0a 2a20  .<!-- TOC -->.* 
+00001be0: 5b49 6e73 7461 6c6c 2070 6163 6b61 6765  [Install package
+00001bf0: 5d28 2369 6e73 7461 6c6c 2d70 6163 6b61  ](#install-packa
+00001c00: 6765 290a 2020 2a20 5b46 726f 6d20 5079  ge).  * [From Py
+00001c10: 5049 5d28 2366 726f 6d2d 7079 7069 290a  PI](#from-pypi).
+00001c20: 2020 2a20 5b57 6974 6820 506f 6574 7279    * [With Poetry
+00001c30: 5d28 2377 6974 682d 706f 6574 7279 290a  ](#with-poetry).
+00001c40: 2a20 5b45 7665 6e74 5374 6f72 6544 4220  * [EventStoreDB 
+00001c50: 7365 7276 6572 5d28 2365 7665 6e74 7374  server](#eventst
+00001c60: 6f72 6564 622d 7365 7276 6572 290a 2020  oredb-server).  
+00001c70: 2a20 5b52 756e 2063 6f6e 7461 696e 6572  * [Run container
+00001c80: 5d28 2372 756e 2d63 6f6e 7461 696e 6572  ](#run-container
+00001c90: 290a 2020 2a20 5b53 746f 7020 636f 6e74  ).  * [Stop cont
+00001ca0: 6169 6e65 725d 2823 7374 6f70 2d63 6f6e  ainer](#stop-con
+00001cb0: 7461 696e 6572 290a 2a20 5b45 7665 6e74  tainer).* [Event
+00001cc0: 5374 6f72 6544 4220 636c 6965 6e74 5d28  StoreDB client](
+00001cd0: 2365 7665 6e74 7374 6f72 6564 622d 636c  #eventstoredb-cl
+00001ce0: 6965 6e74 290a 2020 2a20 5b49 6d70 6f72  ient).  * [Impor
+00001cf0: 7420 636c 6173 735d 2823 696d 706f 7274  t class](#import
+00001d00: 2d63 6c61 7373 290a 2020 2a20 5b43 6f6e  -class).  * [Con
+00001d10: 7374 7275 6374 2063 6c69 656e 745d 2823  struct client](#
+00001d20: 636f 6e73 7472 7563 742d 636c 6965 6e74  construct-client
+00001d30: 290a 2a20 5b43 6f6e 6e65 6374 696f 6e20  ).* [Connection 
+00001d40: 7374 7269 6e67 735d 2823 636f 6e6e 6563  strings](#connec
+00001d50: 7469 6f6e 2d73 7472 696e 6773 290a 2020  tion-strings).  
+00001d60: 2a20 5b54 776f 2073 6368 656d 6573 5d28  * [Two schemes](
+00001d70: 2374 776f 2d73 6368 656d 6573 290a 2020  #two-schemes).  
+00001d80: 2a20 5b55 7365 7220 696e 666f 2073 7472  * [User info str
+00001d90: 696e 675d 2823 7573 6572 2d69 6e66 6f2d  ing](#user-info-
+00001da0: 7374 7269 6e67 290a 2020 2a20 5b51 7565  string).  * [Que
+00001db0: 7279 2073 7472 696e 675d 2823 7175 6572  ry string](#quer
+00001dc0: 792d 7374 7269 6e67 290a 2020 2a20 5b45  y-string).  * [E
+00001dd0: 7861 6d70 6c65 735d 2823 6578 616d 706c  xamples](#exampl
+00001de0: 6573 290a 2a20 5b45 7665 6e74 206f 626a  es).* [Event obj
+00001df0: 6563 7473 5d28 2365 7665 6e74 2d6f 626a  ects](#event-obj
+00001e00: 6563 7473 290a 2020 2a20 5b4e 6577 2065  ects).  * [New e
+00001e10: 7665 6e74 735d 2823 6e65 772d 6576 656e  vents](#new-even
+00001e20: 7473 290a 2020 2a20 5b52 6563 6f72 6465  ts).  * [Recorde
+00001e30: 6420 6576 656e 7473 5d28 2372 6563 6f72  d events](#recor
+00001e40: 6465 642d 6576 656e 7473 290a 2a20 5b53  ded-events).* [S
+00001e50: 7472 6561 6d73 5d28 2373 7472 6561 6d73  treams](#streams
+00001e60: 290a 2020 2a20 5b41 7070 656e 6420 6576  ).  * [Append ev
+00001e70: 656e 7473 5d28 2361 7070 656e 642d 6576  ents](#append-ev
+00001e80: 656e 7473 290a 2020 2a20 5b49 6465 6d70  ents).  * [Idemp
+00001e90: 6f74 656e 7420 6170 7065 6e64 206f 7065  otent append ope
+00001ea0: 7261 7469 6f6e 735d 2823 6964 656d 706f  rations](#idempo
+00001eb0: 7465 6e74 2d61 7070 656e 642d 6f70 6572  tent-append-oper
+00001ec0: 6174 696f 6e73 290a 2020 2a20 5b52 6561  ations).  * [Rea
+00001ed0: 6420 7374 7265 616d 2065 7665 6e74 735d  d stream events]
+00001ee0: 2823 7265 6164 2d73 7472 6561 6d2d 6576  (#read-stream-ev
+00001ef0: 656e 7473 290a 2020 2a20 5b47 6574 2063  ents).  * [Get c
+00001f00: 7572 7265 6e74 2076 6572 7369 6f6e 5d28  urrent version](
+00001f10: 2367 6574 2d63 7572 7265 6e74 2d76 6572  #get-current-ver
+00001f20: 7369 6f6e 290a 2020 2a20 5b48 6f77 2074  sion).  * [How t
+00001f30: 6f20 696d 706c 656d 656e 7420 736e 6170  o implement snap
+00001f40: 7368 6f74 7469 6e67 2077 6974 6820 4576  shotting with Ev
+00001f50: 656e 7453 746f 7265 4442 5d28 2368 6f77  entStoreDB](#how
+00001f60: 2d74 6f2d 696d 706c 656d 656e 742d 736e  -to-implement-sn
+00001f70: 6170 7368 6f74 7469 6e67 2d77 6974 682d  apshotting-with-
+00001f80: 6576 656e 7473 746f 7265 6462 290a 2020  eventstoredb).  
+00001f90: 2a20 5b52 6561 6420 616c 6c20 6576 656e  * [Read all even
+00001fa0: 7473 5d28 2372 6561 642d 616c 6c2d 6576  ts](#read-all-ev
+00001fb0: 656e 7473 290a 2020 2a20 5b47 6574 2063  ents).  * [Get c
+00001fc0: 6f6d 6d69 7420 706f 7369 7469 6f6e 5d28  ommit position](
+00001fd0: 2367 6574 2d63 6f6d 6d69 742d 706f 7369  #get-commit-posi
+00001fe0: 7469 6f6e 290a 2020 2a20 5b47 6574 2073  tion).  * [Get s
+00001ff0: 7472 6561 6d20 6d65 7461 6461 7461 5d28  tream metadata](
+00002000: 2367 6574 2d73 7472 6561 6d2d 6d65 7461  #get-stream-meta
+00002010: 6461 7461 290a 2020 2a20 5b53 6574 2073  data).  * [Set s
+00002020: 7472 6561 6d20 6d65 7461 6461 7461 5d28  tream metadata](
+00002030: 2373 6574 2d73 7472 6561 6d2d 6d65 7461  #set-stream-meta
+00002040: 6461 7461 290a 2020 2a20 5b44 656c 6574  data).  * [Delet
+00002050: 6520 7374 7265 616d 5d28 2364 656c 6574  e stream](#delet
+00002060: 652d 7374 7265 616d 290a 2020 2a20 5b54  e-stream).  * [T
+00002070: 6f6d 6273 746f 6e65 2073 7472 6561 6d5d  ombstone stream]
+00002080: 2823 746f 6d62 7374 6f6e 652d 7374 7265  (#tombstone-stre
+00002090: 616d 290a 2a20 5b43 6174 6368 2d75 7020  am).* [Catch-up 
+000020a0: 7375 6273 6372 6970 7469 6f6e 735d 2823  subscriptions](#
+000020b0: 6361 7463 682d 7570 2d73 7562 7363 7269  catch-up-subscri
+000020c0: 7074 696f 6e73 290a 2020 2a20 5b53 7562  ptions).  * [Sub
+000020d0: 7363 7269 6265 2074 6f20 616c 6c20 6576  scribe to all ev
+000020e0: 656e 7473 5d28 2373 7562 7363 7269 6265  ents](#subscribe
+000020f0: 2d74 6f2d 616c 6c2d 6576 656e 7473 290a  -to-all-events).
+00002100: 2020 2a20 5b53 7562 7363 7269 6265 2074    * [Subscribe t
+00002110: 6f20 7374 7265 616d 2065 7665 6e74 735d  o stream events]
+00002120: 2823 7375 6273 6372 6962 652d 746f 2d73  (#subscribe-to-s
+00002130: 7472 6561 6d2d 6576 656e 7473 290a 2020  tream-events).  
+00002140: 2a20 5b48 6f77 2074 6f20 696d 706c 656d  * [How to implem
+00002150: 656e 7420 6578 6163 746c 792d 6f6e 6365  ent exactly-once
+00002160: 2065 7665 6e74 2070 726f 6365 7373 696e   event processin
+00002170: 675d 2823 686f 772d 746f 2d69 6d70 6c65  g](#how-to-imple
+00002180: 6d65 6e74 2d65 7861 6374 6c79 2d6f 6e63  ment-exactly-onc
+00002190: 652d 6576 656e 742d 7072 6f63 6573 7369  e-event-processi
+000021a0: 6e67 290a 2a20 5b50 6572 7369 7374 656e  ng).* [Persisten
+000021b0: 7420 7375 6273 6372 6970 7469 6f6e 735d  t subscriptions]
+000021c0: 2823 7065 7273 6973 7465 6e74 2d73 7562  (#persistent-sub
+000021d0: 7363 7269 7074 696f 6e73 290a 2020 2a20  scriptions).  * 
+000021e0: 5b43 7265 6174 6520 7375 6273 6372 6970  [Create subscrip
+000021f0: 7469 6f6e 2074 6f20 616c 6c5d 2823 6372  tion to all](#cr
+00002200: 6561 7465 2d73 7562 7363 7269 7074 696f  eate-subscriptio
+00002210: 6e2d 746f 2d61 6c6c 290a 2020 2a20 5b52  n-to-all).  * [R
+00002220: 6561 6420 7375 6273 6372 6970 7469 6f6e  ead subscription
+00002230: 2074 6f20 616c 6c5d 2823 7265 6164 2d73   to all](#read-s
+00002240: 7562 7363 7269 7074 696f 6e2d 746f 2d61  ubscription-to-a
+00002250: 6c6c 290a 2020 2a20 5b48 6f77 2074 6f20  ll).  * [How to 
+00002260: 7772 6974 6520 6120 7065 7273 6973 7465  write a persiste
+00002270: 6e74 2073 7562 7363 7269 7074 696f 6e20  nt subscription 
+00002280: 636f 6e73 756d 6572 5d28 2368 6f77 2d74  consumer](#how-t
+00002290: 6f2d 7772 6974 652d 612d 7065 7273 6973  o-write-a-persis
+000022a0: 7465 6e74 2d73 7562 7363 7269 7074 696f  tent-subscriptio
+000022b0: 6e2d 636f 6e73 756d 6572 290a 2020 2a20  n-consumer).  * 
+000022c0: 5b55 7064 6174 6520 7375 6273 6372 6970  [Update subscrip
+000022d0: 7469 6f6e 2074 6f20 616c 6c5d 2823 7570  tion to all](#up
+000022e0: 6461 7465 2d73 7562 7363 7269 7074 696f  date-subscriptio
+000022f0: 6e2d 746f 2d61 6c6c 290a 2020 2a20 5b43  n-to-all).  * [C
+00002300: 7265 6174 6520 7375 6273 6372 6970 7469  reate subscripti
+00002310: 6f6e 2074 6f20 7374 7265 616d 5d28 2363  on to stream](#c
+00002320: 7265 6174 652d 7375 6273 6372 6970 7469  reate-subscripti
+00002330: 6f6e 2d74 6f2d 7374 7265 616d 290a 2020  on-to-stream).  
+00002340: 2a20 5b52 6561 6420 7375 6273 6372 6970  * [Read subscrip
+00002350: 7469 6f6e 2074 6f20 7374 7265 616d 5d28  tion to stream](
+00002360: 2372 6561 642d 7375 6273 6372 6970 7469  #read-subscripti
+00002370: 6f6e 2d74 6f2d 7374 7265 616d 290a 2020  on-to-stream).  
+00002380: 2a20 5b55 7064 6174 6520 7375 6273 6372  * [Update subscr
+00002390: 6970 7469 6f6e 2074 6f20 7374 7265 616d  iption to stream
+000023a0: 5d28 2375 7064 6174 652d 7375 6273 6372  ](#update-subscr
+000023b0: 6970 7469 6f6e 2d74 6f2d 7374 7265 616d  iption-to-stream
+000023c0: 290a 2020 2a20 5b52 6570 6c61 7920 7061  ).  * [Replay pa
+000023d0: 726b 6564 2065 7665 6e74 735d 2823 7265  rked events](#re
+000023e0: 706c 6179 2d70 6172 6b65 642d 6576 656e  play-parked-even
+000023f0: 7473 290a 2020 2a20 5b47 6574 2073 7562  ts).  * [Get sub
+00002400: 7363 7269 7074 696f 6e20 696e 666f 5d28  scription info](
+00002410: 2367 6574 2d73 7562 7363 7269 7074 696f  #get-subscriptio
+00002420: 6e2d 696e 666f 290a 2020 2a20 5b4c 6973  n-info).  * [Lis
+00002430: 7420 7375 6273 6372 6970 7469 6f6e 735d  t subscriptions]
+00002440: 2823 6c69 7374 2d73 7562 7363 7269 7074  (#list-subscript
+00002450: 696f 6e73 290a 2020 2a20 5b4c 6973 7420  ions).  * [List 
+00002460: 7375 6273 6372 6970 7469 6f6e 7320 746f  subscriptions to
+00002470: 2073 7472 6561 6d5d 2823 6c69 7374 2d73   stream](#list-s
+00002480: 7562 7363 7269 7074 696f 6e73 2d74 6f2d  ubscriptions-to-
+00002490: 7374 7265 616d 290a 2020 2a20 5b44 656c  stream).  * [Del
+000024a0: 6574 6520 7375 6273 6372 6970 7469 6f6e  ete subscription
+000024b0: 5d28 2364 656c 6574 652d 7375 6273 6372  ](#delete-subscr
+000024c0: 6970 7469 6f6e 290a 2a20 5b50 726f 6a65  iption).* [Proje
+000024d0: 6374 696f 6e73 5d28 2370 726f 6a65 6374  ctions](#project
+000024e0: 696f 6e73 290a 2020 2a20 5b43 7265 6174  ions).  * [Creat
+000024f0: 6520 7072 6f6a 6563 7469 6f6e 5d28 2363  e projection](#c
+00002500: 7265 6174 652d 7072 6f6a 6563 7469 6f6e  reate-projection
+00002510: 290a 2020 2a20 5b55 7064 6174 6520 7072  ).  * [Update pr
+00002520: 6f6a 6563 7469 6f6e 5d28 2375 7064 6174  ojection](#updat
+00002530: 652d 7072 6f6a 6563 7469 6f6e 290a 2020  e-projection).  
+00002540: 2a20 5b47 6574 2070 726f 6a65 6374 696f  * [Get projectio
+00002550: 6e20 7374 6174 6973 7469 6373 5d28 2367  n statistics](#g
+00002560: 6574 2d70 726f 6a65 6374 696f 6e2d 7374  et-projection-st
+00002570: 6174 6973 7469 6373 290a 2020 2a20 5b47  atistics).  * [G
+00002580: 6574 2070 726f 6a65 6374 696f 6e20 7374  et projection st
+00002590: 6174 655d 2823 6765 742d 7072 6f6a 6563  ate](#get-projec
+000025a0: 7469 6f6e 2d73 7461 7465 290a 2020 2a20  tion-state).  * 
+000025b0: 5b47 6574 2070 726f 6a65 6374 696f 6e20  [Get projection 
+000025c0: 7265 7375 6c74 5d28 2367 6574 2d70 726f  result](#get-pro
+000025d0: 6a65 6374 696f 6e2d 7265 7375 6c74 290a  jection-result).
+000025e0: 2020 2a20 5b45 6e61 626c 6520 7072 6f6a    * [Enable proj
+000025f0: 6563 7469 6f6e 5d28 2365 6e61 626c 652d  ection](#enable-
+00002600: 7072 6f6a 6563 7469 6f6e 290a 2020 2a20  projection).  * 
+00002610: 5b44 6973 6162 6c65 2070 726f 6a65 6374  [Disable project
+00002620: 696f 6e5d 2823 6469 7361 626c 652d 7072  ion](#disable-pr
+00002630: 6f6a 6563 7469 6f6e 290a 2020 2a20 5b52  ojection).  * [R
+00002640: 6573 6574 2070 726f 6a65 6374 696f 6e5d  eset projection]
+00002650: 2823 7265 7365 742d 7072 6f6a 6563 7469  (#reset-projecti
+00002660: 6f6e 290a 2020 2a20 5b44 656c 6574 6520  on).  * [Delete 
+00002670: 7072 6f6a 6563 7469 6f6e 5d28 2364 656c  projection](#del
+00002680: 6574 652d 7072 6f6a 6563 7469 6f6e 290a  ete-projection).
+00002690: 2020 2a20 5b52 6573 7461 7274 2070 726f    * [Restart pro
+000026a0: 6a65 6374 696f 6e73 2073 7562 7379 7374  jections subsyst
+000026b0: 656d 5d28 2372 6573 7461 7274 2d70 726f  em](#restart-pro
+000026c0: 6a65 6374 696f 6e73 2d73 7562 7379 7374  jections-subsyst
+000026d0: 656d 290a 2a20 5b43 616c 6c20 6372 6564  em).* [Call cred
+000026e0: 656e 7469 616c 735d 2823 6361 6c6c 2d63  entials](#call-c
+000026f0: 7265 6465 6e74 6961 6c73 290a 2020 2a20  redentials).  * 
+00002700: 5b43 6f6e 7374 7275 6374 2063 616c 6c20  [Construct call 
+00002710: 6372 6564 656e 7469 616c 735d 2823 636f  credentials](#co
+00002720: 6e73 7472 7563 742d 6361 6c6c 2d63 7265  nstruct-call-cre
+00002730: 6465 6e74 6961 6c73 290a 2a20 5b43 6f6e  dentials).* [Con
+00002740: 6e65 6374 696f 6e5d 2823 636f 6e6e 6563  nection](#connec
+00002750: 7469 6f6e 290a 2020 2a20 5b52 6563 6f6e  tion).  * [Recon
+00002760: 6e65 6374 5d28 2372 6563 6f6e 6e65 6374  nect](#reconnect
+00002770: 290a 2020 2a20 5b43 6c6f 7365 5d28 2363  ).  * [Close](#c
+00002780: 6c6f 7365 290a 2a20 5b41 7379 6e63 696f  lose).* [Asyncio
+00002790: 2063 6c69 656e 745d 2823 6173 796e 6369   client](#asynci
+000027a0: 6f2d 636c 6965 6e74 290a 2020 2a20 5b53  o-client).  * [S
+000027b0: 796e 6f70 7369 735d 2823 7379 6e6f 7073  ynopsis](#synops
+000027c0: 6973 2d31 290a 2a20 5b4e 6f74 6573 5d28  is-1).* [Notes](
+000027d0: 236e 6f74 6573 290a 2020 2a20 5b52 6567  #notes).  * [Reg
+000027e0: 756c 6172 2065 7870 7265 7373 696f 6e20  ular expression 
+000027f0: 6669 6c74 6572 735d 2823 7265 6775 6c61  filters](#regula
+00002800: 722d 6578 7072 6573 7369 6f6e 2d66 696c  r-expression-fil
+00002810: 7465 7273 290a 2020 2a20 5b52 6563 6f6e  ters).  * [Recon
+00002820: 6e65 6374 2061 6e64 2072 6574 7279 206d  nect and retry m
+00002830: 6574 686f 6420 6465 636f 7261 746f 7273  ethod decorators
+00002840: 5d28 2372 6563 6f6e 6e65 6374 2d61 6e64  ](#reconnect-and
+00002850: 2d72 6574 7279 2d6d 6574 686f 642d 6465  -retry-method-de
+00002860: 636f 7261 746f 7273 290a 2a20 5b43 6f6e  corators).* [Con
+00002870: 7472 6962 7574 6f72 735d 2823 636f 6e74  tributors](#cont
+00002880: 7269 6275 746f 7273 290a 2020 2a20 5b49  ributors).  * [I
+00002890: 6e73 7461 6c6c 2050 6f65 7472 795d 2823  nstall Poetry](#
+000028a0: 696e 7374 616c 6c2d 706f 6574 7279 290a  install-poetry).
+000028b0: 2020 2a20 5b53 6574 7570 2066 6f72 2050    * [Setup for P
+000028c0: 7943 6861 726d 2075 7365 7273 5d28 2373  yCharm users](#s
+000028d0: 6574 7570 2d66 6f72 2d70 7963 6861 726d  etup-for-pycharm
+000028e0: 2d75 7365 7273 290a 2020 2a20 5b53 6574  -users).  * [Set
+000028f0: 7570 2066 726f 6d20 636f 6d6d 616e 6420  up from command 
+00002900: 6c69 6e65 5d28 2373 6574 7570 2d66 726f  line](#setup-fro
+00002910: 6d2d 636f 6d6d 616e 642d 6c69 6e65 290a  m-command-line).
+00002920: 2020 2a20 5b50 726f 6a65 6374 204d 616b    * [Project Mak
+00002930: 6566 696c 6520 636f 6d6d 616e 6473 5d28  efile commands](
+00002940: 2370 726f 6a65 6374 2d6d 616b 6566 696c  #project-makefil
+00002950: 652d 636f 6d6d 616e 6473 290a 3c21 2d2d  e-commands).<!--
+00002960: 2054 4f43 202d 2d3e 0a0a 2323 2049 6e73   TOC -->..## Ins
+00002970: 7461 6c6c 2070 6163 6b61 6765 3c61 2069  tall package<a i
+00002980: 643d 2269 6e73 7461 6c6c 2d70 6163 6b61  d="install-packa
+00002990: 6765 223e 3c2f 613e 0a0a 4974 2069 7320  ge"></a>..It is 
+000029a0: 7265 636f 6d6d 656e 6465 6420 746f 2069  recommended to i
+000029b0: 6e73 7461 6c6c 2050 7974 686f 6e20 7061  nstall Python pa
+000029c0: 636b 6167 6573 2069 6e74 6f20 6120 5079  ckages into a Py
+000029d0: 7468 6f6e 2076 6972 7475 616c 2065 6e76  thon virtual env
+000029e0: 6972 6f6e 6d65 6e74 2e0a 0a23 2323 2046  ironment...### F
+000029f0: 726f 6d20 5079 5049 3c61 2069 643d 2266  rom PyPI<a id="f
+00002a00: 726f 6d2d 7079 7069 223e 3c2f 613e 0a0a  rom-pypi"></a>..
+00002a10: 596f 7520 6361 6e20 7573 6520 7069 7020  You can use pip 
+00002a20: 746f 2069 6e73 7461 6c6c 2074 6869 7320  to install this 
+00002a30: 7061 636b 6167 6520 6469 7265 6374 6c79  package directly
+00002a40: 2066 726f 6d0a 5b74 6865 2050 7974 686f   from.[the Pytho
+00002a50: 6e20 5061 636b 6167 6520 496e 6465 785d  n Package Index]
+00002a60: 2868 7474 7073 3a2f 2f70 7970 692e 6f72  (https://pypi.or
+00002a70: 672f 7072 6f6a 6563 742f 6573 6462 636c  g/project/esdbcl
+00002a80: 6965 6e74 2f29 2e0a 0a20 2020 2024 2070  ient/)...    $ p
+00002a90: 6970 2069 6e73 7461 6c6c 2065 7364 6263  ip install esdbc
+00002aa0: 6c69 656e 740a 0a23 2323 2057 6974 6820  lient..### With 
+00002ab0: 506f 6574 7279 3c61 2069 643d 2277 6974  Poetry<a id="wit
+00002ac0: 682d 706f 6574 7279 223e 3c2f 613e 0a0a  h-poetry"></a>..
+00002ad0: 596f 7520 6361 6e20 7573 6520 506f 6574  You can use Poet
+00002ae0: 7279 2074 6f20 6164 6420 7468 6973 2070  ry to add this p
+00002af0: 6163 6b61 6765 2074 6f20 796f 7572 2070  ackage to your p
+00002b00: 7970 726f 6a65 6374 2e74 6f6d 6c20 616e  yproject.toml an
+00002b10: 6420 696e 7374 616c 6c20 6974 2e0a 0a20  d install it... 
+00002b20: 2020 2024 2070 6f65 7472 7920 6164 6420     $ poetry add 
+00002b30: 6573 6462 636c 6965 6e74 0a0a 2323 2045  esdbclient..## E
+00002b40: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
+00002b50: 6572 3c61 2069 643d 2265 7665 6e74 7374  er<a id="eventst
+00002b60: 6f72 6564 622d 7365 7276 6572 223e 3c2f  oredb-server"></
+00002b70: 613e 0a0a 5468 6520 4576 656e 7453 746f  a>..The EventSto
+00002b80: 7265 4442 2073 6572 7665 7220 6361 6e20  reDB server can 
+00002b90: 6265 2072 756e 206c 6f63 616c 6c79 2075  be run locally u
+00002ba0: 7369 6e67 2074 6865 206f 6666 6963 6961  sing the officia
+00002bb0: 6c20 446f 636b 6572 2063 6f6e 7461 696e  l Docker contain
+00002bc0: 6572 2069 6d61 6765 2e0a 0a23 2323 2052  er image...### R
+00002bd0: 756e 2063 6f6e 7461 696e 6572 3c61 2069  un container<a i
+00002be0: 643d 2272 756e 2d63 6f6e 7461 696e 6572  d="run-container
+00002bf0: 223e 3c2f 613e 0a0a 466f 7220 6465 7665  "></a>..For deve
+00002c00: 6c6f 706d 656e 742c 2079 6f75 2063 616e  lopment, you can
+00002c10: 2072 756e 2061 2022 7365 6375 7265 2220   run a "secure" 
+00002c20: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
+00002c30: 7665 7220 7573 696e 6720 7468 6520 666f  ver using the fo
+00002c40: 6c6c 6f77 696e 6720 636f 6d6d 616e 642e  llowing command.
+00002c50: 0a0a 2020 2020 2420 646f 636b 6572 2072  ..    $ docker r
+00002c60: 756e 202d 6420 2d2d 6e61 6d65 2065 7665  un -d --name eve
+00002c70: 6e74 7374 6f72 6564 622d 7365 6375 7265  ntstoredb-secure
+00002c80: 202d 6974 202d 7020 3231 3133 3a32 3131   -it -p 2113:211
+00002c90: 3320 2d2d 656e 7620 2248 4f4d 453d 2f74  3 --env "HOME=/t
+00002ca0: 6d70 2220 6576 656e 7473 746f 7265 2f65  mp" eventstore/e
+00002cb0: 7665 6e74 7374 6f72 653a 3231 2e31 302e  ventstore:21.10.
+00002cc0: 392d 6275 7374 6572 2d73 6c69 6d20 2d2d  9-buster-slim --
+00002cd0: 6465 760a 0a41 7320 7765 2077 696c 6c20  dev..As we will 
+00002ce0: 7365 652c 2079 6f75 7220 636c 6965 6e74  see, your client
+00002cf0: 2077 696c 6c20 6e65 6564 2061 6e20 4576   will need an Ev
+00002d00: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
+00002d10: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+00002d20: 2061 7320 7468 6520 7661 6c75 650a 6f66   as the value.of
+00002d30: 2069 7473 2060 7572 6960 2063 6f6e 7374   its `uri` const
+00002d40: 7275 6374 6f72 2061 7267 756d 656e 742e  ructor argument.
+00002d50: 2054 6865 2063 6f6e 6e65 6374 696f 6e20   The connection 
+00002d60: 7374 7269 6e67 2066 6f72 2074 6869 7320  string for this 
+00002d70: 2273 6563 7572 6522 2045 7665 6e74 5374  "secure" EventSt
+00002d80: 6f72 6544 420a 7365 7276 6572 2077 6f75  oreDB.server wou
+00002d90: 6c64 2062 653a 0a0a 2020 2020 6573 6462  ld be:..    esdb
+00002da0: 3a2f 2f61 646d 696e 3a63 6861 6e67 6569  ://admin:changei
+00002db0: 7440 6c6f 6361 6c68 6f73 743a 3231 3133  t@localhost:2113
+00002dc0: 0a0a 546f 2063 6f6e 6e65 6374 2074 6f20  ..To connect to 
+00002dd0: 6120 2273 6563 7572 6522 2073 6572 7665  a "secure" serve
+00002de0: 722c 2079 6f75 2077 696c 6c20 7573 7561  r, you will usua
+00002df0: 6c6c 7920 6e65 6564 2074 6f20 696e 636c  lly need to incl
+00002e00: 7564 6520 6120 2275 7365 726e 616d 6522  ude a "username"
+00002e10: 0a61 6e64 2061 2022 7061 7373 776f 7264  .and a "password
+00002e20: 2220 696e 2074 6865 2063 6f6e 6e65 6374  " in the connect
+00002e30: 696f 6e20 7374 7269 6e67 2c20 736f 2074  ion string, so t
+00002e40: 6861 7420 7468 6520 7365 7276 6572 2063  hat the server c
+00002e50: 616e 2061 7574 6865 6e74 6963 6174 6520  an authenticate 
+00002e60: 7468 650a 636c 6965 6e74 2e20 5769 7468  the.client. With
+00002e70: 2045 7665 6e74 5374 6f72 6544 422c 2074   EventStoreDB, t
+00002e80: 6865 2064 6566 6175 6c74 2075 7365 726e  he default usern
+00002e90: 616d 6520 6973 2022 6164 6d69 6e22 2061  ame is "admin" a
+00002ea0: 6e64 2074 6865 2064 6566 6175 6c74 2070  nd the default p
+00002eb0: 6173 7377 6f72 640a 6973 2022 6368 616e  assword.is "chan
+00002ec0: 6765 6974 222e 0a0a 5768 656e 2063 6f6e  geit"...When con
+00002ed0: 6e65 6374 696e 6720 746f 2061 2022 7365  necting to a "se
+00002ee0: 6375 7265 2220 7365 7276 6572 2c20 796f  cure" server, yo
+00002ef0: 7520 6d61 7920 616c 736f 206e 6565 6420  u may also need 
+00002f00: 746f 2070 726f 7669 6465 2061 6e20 5353  to provide an SS
+00002f10: 4c2f 544c 5320 6365 7274 6966 6963 6174  L/TLS certificat
+00002f20: 650a 6173 2074 6865 2076 616c 7565 206f  e.as the value o
+00002f30: 6620 7468 6520 6072 6f6f 745f 6365 7274  f the `root_cert
+00002f40: 6966 6963 6174 6573 6020 636f 6e73 7472  ificates` constr
+00002f50: 7563 746f 7220 6172 6775 6d65 6e74 2e20  uctor argument. 
+00002f60: 4966 2074 6865 2073 6572 7665 7220 6365  If the server ce
+00002f70: 7274 6966 6963 6174 650a 6973 2070 7562  rtificate.is pub
+00002f80: 6c69 636c 7920 7369 676e 6564 2c20 7468  licly signed, th
+00002f90: 6520 726f 6f74 2063 6572 7469 6669 6361  e root certifica
+00002fa0: 7465 7320 6f66 2074 6865 2063 6572 7469  tes of the certi
+00002fb0: 6669 6361 7465 2061 7574 686f 7269 7479  ficate authority
+00002fc0: 206d 6179 2062 6520 696e 7374 616c 6c65   may be installe
+00002fd0: 640a 6c6f 6361 6c6c 7920 616e 6420 7069  d.locally and pi
+00002fe0: 636b 6564 2075 7020 6279 2074 6865 2067  cked up by the g
+00002ff0: 7270 6320 7061 636b 6167 6520 6672 6f6d  rpc package from
+00003000: 2061 2064 6566 6175 6c74 206c 6f63 6174   a default locat
+00003010: 696f 6e2e 2054 6865 2063 6c69 656e 7420  ion. The client 
+00003020: 7573 6573 2074 6865 0a72 6f6f 7420 5353  uses the.root SS
+00003030: 4c2f 544c 5320 6365 7274 6966 6963 6174  L/TLS certificat
+00003040: 6520 746f 2061 7574 6865 6e74 6963 6174  e to authenticat
+00003050: 6520 7468 6520 7365 7276 6572 2e20 466f  e the server. Fo
+00003060: 7220 6465 7665 6c6f 706d 656e 742c 2079  r development, y
+00003070: 6f75 2063 616e 2065 6974 6865 720a 7573  ou can either.us
+00003080: 6520 7468 6520 5353 4c2f 544c 5320 6365  e the SSL/TLS ce
+00003090: 7274 6966 6963 6174 6520 6f66 2061 2073  rtificate of a s
+000030a0: 656c 662d 7369 676e 696e 6720 6365 7274  elf-signing cert
+000030b0: 6966 6963 6174 6520 6175 7468 6f72 6974  ificate authorit
+000030c0: 7920 7573 6564 2074 6f20 6372 6561 7465  y used to create
+000030d0: 2074 6865 0a73 6572 7665 7227 7320 6365   the.server's ce
+000030e0: 7274 6966 6963 6174 652e 204f 722c 2077  rtificate. Or, w
+000030f0: 6865 6e20 7573 696e 6720 6120 7369 6e67  hen using a sing
+00003100: 6c65 2d6e 6f64 6520 636c 7573 7465 722c  le-node cluster,
+00003110: 2079 6f75 2063 616e 206a 7573 7420 7573   you can just us
+00003120: 6520 7468 6520 7365 7276 6572 0a63 6572  e the server.cer
+00003130: 7469 6669 6361 7465 2069 7473 656c 662c  tificate itself,
+00003140: 2067 6574 7469 6e67 2074 6865 2073 6572   getting the ser
+00003150: 7665 7220 6365 7274 6966 6963 6174 6520  ver certificate 
+00003160: 7769 7468 2074 6865 2066 6f6c 6c6f 7769  with the followi
+00003170: 6e67 2050 7974 686f 6e20 636f 6465 2e0a  ng Python code..
+00003180: 0a60 6060 7079 7468 6f6e 0a69 6d70 6f72  .```python.impor
+00003190: 7420 7373 6c0a 0a73 6572 7665 725f 6365  t ssl..server_ce
+000031a0: 7274 6966 6963 6174 6520 3d20 7373 6c2e  rtificate = ssl.
+000031b0: 6765 745f 7365 7276 6572 5f63 6572 7469  get_server_certi
+000031c0: 6669 6361 7465 2861 6464 723d 2827 6c6f  ficate(addr=('lo
+000031d0: 6361 6c68 6f73 7427 2c20 3231 3133 2929  calhost', 2113))
+000031e0: 0a60 6060 0a0a 416c 7465 726e 6174 6976  .```..Alternativ
+000031f0: 656c 792c 2079 6f75 2063 616e 2073 7461  ely, you can sta
+00003200: 7274 2061 6e20 2269 6e73 6563 7572 6522  rt an "insecure"
+00003210: 2073 6572 7665 7220 7573 696e 6720 7468   server using th
+00003220: 6520 666f 6c6c 6f77 696e 6720 636f 6d6d  e following comm
+00003230: 616e 642e 0a0a 2020 2020 2420 646f 636b  and...    $ dock
+00003240: 6572 2072 756e 202d 6420 2d2d 6e61 6d65  er run -d --name
+00003250: 2065 7665 6e74 7374 6f72 6564 622d 696e   eventstoredb-in
+00003260: 7365 6375 7265 202d 6974 202d 7020 3231  secure -it -p 21
+00003270: 3133 3a32 3131 3320 6576 656e 7473 746f  13:2113 eventsto
+00003280: 7265 2f65 7665 6e74 7374 6f72 653a 3231  re/eventstore:21
+00003290: 2e31 302e 392d 6275 7374 6572 2d73 6c69  .10.9-buster-sli
+000032a0: 6d20 2d2d 696e 7365 6375 7265 0a0a 5468  m --insecure..Th
+000032b0: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+000032c0: 696e 6720 5552 4920 666f 7220 7468 6973  ing URI for this
+000032d0: 2022 696e 7365 6375 7265 2220 7365 7276   "insecure" serv
+000032e0: 6572 2077 6f75 6c64 2062 653a 0a0a 2020  er would be:..  
+000032f0: 2020 6573 6462 3a2f 2f6c 6f63 616c 686f    esdb://localho
+00003300: 7374 3a32 3131 333f 546c 733d 6661 6c73  st:2113?Tls=fals
+00003310: 650a 0a41 7320 7765 2077 696c 6c20 7365  e..As we will se
+00003320: 652c 2077 6865 6e20 636f 6e6e 6563 7469  e, when connecti
+00003330: 6e67 2074 6f20 616e 2022 696e 7365 6375  ng to an "insecu
+00003340: 7265 2220 7365 7276 6572 2c20 7468 6572  re" server, ther
+00003350: 6520 6973 206e 6f20 6e65 6564 2074 6f20  e is no need to 
+00003360: 696e 636c 7564 650a 6120 2275 7365 726e  include.a "usern
+00003370: 616d 6522 2061 6e64 2061 2022 7061 7373  ame" and a "pass
+00003380: 776f 7264 2220 696e 2074 6865 2063 6f6e  word" in the con
+00003390: 6e65 6374 696f 6e20 7374 7269 6e67 2e20  nection string. 
+000033a0: 4966 2079 6f75 2064 6f2c 2074 6865 7365  If you do, these
+000033b0: 2076 616c 7565 7320 7769 6c6c 0a62 6520   values will.be 
+000033c0: 6967 6e6f 7265 6420 6279 2074 6865 2063  ignored by the c
+000033d0: 6c69 656e 742c 2073 6f20 7468 6174 2074  lient, so that t
+000033e0: 6865 7920 6172 6520 6e6f 7420 7365 6e74  hey are not sent
+000033f0: 206f 7665 7220 616e 2069 6e73 6563 7572   over an insecur
+00003400: 6520 6368 616e 6e65 6c2e 0a0a 506c 6561  e channel...Plea
+00003410: 7365 206e 6f74 652c 2074 6865 2022 696e  se note, the "in
+00003420: 7365 6375 7265 2220 636f 6e6e 6563 7469  secure" connecti
+00003430: 6f6e 2073 7472 696e 6720 7573 6573 2061  on string uses a
+00003440: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
+00003450: 7468 2074 6865 2066 6965 6c64 2d76 616c  th the field-val
+00003460: 7565 0a60 546c 733d 6661 6c73 6560 2e20  ue.`Tls=false`. 
+00003470: 5468 6520 7661 6c75 6520 6f66 2074 6869  The value of thi
+00003480: 7320 6669 656c 6420 6973 2062 7920 6465  s field is by de
+00003490: 6661 756c 7420 6074 7275 6560 2e0a 0a23  fault `true`...#
+000034a0: 2323 2053 746f 7020 636f 6e74 6169 6e65  ## Stop containe
+000034b0: 723c 6120 6964 3d22 7374 6f70 2d63 6f6e  r<a id="stop-con
+000034c0: 7461 696e 6572 223e 3c2f 613e 0a0a 546f  tainer"></a>..To
+000034d0: 2073 746f 7020 616e 6420 7265 6d6f 7665   stop and remove
+000034e0: 2074 6865 2022 7365 6375 7265 2220 636f   the "secure" co
+000034f0: 6e74 6169 6e65 722c 2075 7365 2074 6865  ntainer, use the
+00003500: 2066 6f6c 6c6f 7769 6e67 2044 6f63 6b65   following Docke
+00003510: 7220 636f 6d6d 616e 6473 2e0a 0a20 2020  r commands...   
+00003520: 2024 2064 6f63 6b65 7220 7374 6f70 2065   $ docker stop e
+00003530: 7665 6e74 7374 6f72 6564 622d 7365 6375  ventstoredb-secu
+00003540: 7265 0a09 2420 646f 636b 6572 2072 6d20  re..$ docker rm 
+00003550: 6576 656e 7473 746f 7265 6462 2d73 6563  eventstoredb-sec
+00003560: 7572 650a 0a54 6f20 7374 6f70 2061 6e64  ure..To stop and
+00003570: 2072 656d 6f76 6520 7468 6520 2269 6e73   remove the "ins
+00003580: 6563 7572 6522 2063 6f6e 7461 696e 6572  ecure" container
+00003590: 2c20 7573 6520 7468 6520 666f 6c6c 6f77  , use the follow
+000035a0: 696e 6720 446f 636b 6572 2063 6f6d 6d61  ing Docker comma
+000035b0: 6e64 732e 0a0a 2020 2020 2420 646f 636b  nds...    $ dock
+000035c0: 6572 2073 746f 7020 6576 656e 7473 746f  er stop eventsto
+000035d0: 7265 6462 2d69 6e73 6563 7572 650a 0924  redb-insecure..$
+000035e0: 2064 6f63 6b65 7220 726d 2065 7665 6e74   docker rm event
+000035f0: 7374 6f72 6564 622d 696e 7365 6375 7265  storedb-insecure
+00003600: 0a0a 0a23 2320 4576 656e 7453 746f 7265  ...## EventStore
+00003610: 4442 2063 6c69 656e 743c 6120 6964 3d22  DB client<a id="
+00003620: 6576 656e 7473 746f 7265 6462 2d63 6c69  eventstoredb-cli
+00003630: 656e 7422 3e3c 2f61 3e0a 0a54 6869 7320  ent"></a>..This 
+00003640: 4576 656e 7453 746f 7265 4442 2063 6c69  EventStoreDB cli
+00003650: 656e 7420 6973 2069 6d70 6c65 6d65 6e74  ent is implement
+00003660: 6564 2069 6e20 7468 6520 6065 7364 6263  ed in the `esdbc
+00003670: 6c69 656e 7460 2070 6163 6b61 6765 2077  lient` package w
+00003680: 6974 680a 7468 6520 6045 7665 6e74 5374  ith.the `EventSt
+00003690: 6f72 6544 4243 6c69 656e 7460 2063 6c61  oreDBClient` cla
+000036a0: 7373 2e0a 0a23 2323 2049 6d70 6f72 7420  ss...### Import 
+000036b0: 636c 6173 733c 6120 6964 3d22 696d 706f  class<a id="impo
+000036c0: 7274 2d63 6c61 7373 223e 3c2f 613e 0a0a  rt-class"></a>..
+000036d0: 5468 6520 6045 7665 6e74 5374 6f72 6544  The `EventStoreD
+000036e0: 4243 6c69 656e 7460 2063 6c61 7373 2063  BClient` class c
+000036f0: 616e 2062 6520 696d 706f 7274 6564 2066  an be imported f
+00003700: 726f 6d20 7468 6520 6065 7364 6263 6c69  rom the `esdbcli
+00003710: 656e 7460 2070 6163 6b61 6765 2e0a 0a60  ent` package...`
+00003720: 6060 7079 7468 6f6e 0a66 726f 6d20 6573  ``python.from es
+00003730: 6462 636c 6965 6e74 2069 6d70 6f72 7420  dbclient import 
+00003740: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
+00003750: 6e74 0a60 6060 0a0a 2323 2320 436f 6e73  nt.```..### Cons
+00003760: 7472 7563 7420 636c 6965 6e74 3c61 2069  truct client<a i
+00003770: 643d 2263 6f6e 7374 7275 6374 2d63 6c69  d="construct-cli
+00003780: 656e 7422 3e3c 2f61 3e0a 0a54 6865 2060  ent"></a>..The `
+00003790: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
+000037a0: 6e74 6020 636c 6173 7320 6861 7320 6f6e  nt` class has on
+000037b0: 6520 7265 7175 6972 6564 2063 6f6e 7374  e required const
+000037c0: 7275 6374 6f72 2061 7267 756d 656e 742c  ructor argument,
+000037d0: 2060 7572 6960 2c20 616e 6420 6f6e 650a   `uri`, and one.
+000037e0: 6f70 7469 6f6e 616c 2063 6f6e 7374 7275  optional constru
+000037f0: 6374 6f72 2061 7267 756d 656e 742c 2060  ctor argument, `
+00003800: 726f 6f74 5f63 6572 7469 6669 6361 7465  root_certificate
+00003810: 7360 2e0a 0a54 6865 2060 7572 6960 2061  s`...The `uri` a
+00003820: 7267 756d 656e 7420 6973 2065 7870 6563  rgument is expec
+00003830: 7465 6420 746f 2062 6520 616e 2045 7665  ted to be an Eve
+00003840: 6e74 5374 6f72 6544 4220 636f 6e6e 6563  ntStoreDB connec
+00003850: 7469 6f6e 2073 7472 696e 6720 5552 4920  tion string URI 
+00003860: 7468 6174 0a63 6f6e 666f 726d 7320 7769  that.conforms wi
+00003870: 7468 2074 6865 2073 7461 6e64 6172 6420  th the standard 
+00003880: 4576 656e 7453 746f 7265 4442 2022 6573  EventStoreDB "es
+00003890: 6462 2220 6f72 2022 6573 6462 2b64 6973  db" or "esdb+dis
+000038a0: 636f 7665 7222 2055 5249 2073 6368 656d  cover" URI schem
+000038b0: 6573 2e0a 0a46 6f72 2065 7861 6d70 6c65  es...For example
+000038c0: 2c20 7468 6520 666f 6c6c 6f77 696e 6720  , the following 
+000038d0: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+000038e0: 6720 7370 6563 6966 6965 7320 7468 6174  g specifies that
+000038f0: 2074 6865 2063 6c69 656e 7420 7368 6f75   the client shou
+00003900: 6c64 0a61 7474 656d 7074 2074 6f20 6372  ld.attempt to cr
+00003910: 6561 7465 2061 2022 7365 6375 7265 2220  eate a "secure" 
+00003920: 636f 6e6e 6563 7469 6f6e 2074 6f20 706f  connection to po
+00003930: 7274 2032 3131 3320 6f6e 2022 6c6f 6361  rt 2113 on "loca
+00003940: 6c68 6f73 7422 2c20 616e 6420 7573 6520  lhost", and use 
+00003950: 7468 650a 636c 6965 6e74 2063 7265 6465  the.client crede
+00003960: 6e74 6961 6c73 2022 7573 6572 6e61 6d65  ntials "username
+00003970: 2220 616e 6420 2270 6173 7377 6f72 6422  " and "password"
+00003980: 2077 6865 6e20 6d61 6b69 6e67 2063 616c   when making cal
+00003990: 6c73 2074 6f20 7468 6520 7365 7276 6572  ls to the server
+000039a0: 2e0a 0a20 2020 2065 7364 623a 2f2f 7573  ...    esdb://us
+000039b0: 6572 6e61 6d65 3a70 6173 7377 6f72 6440  ername:password@
+000039c0: 6c6f 6361 6c68 6f73 743a 3231 3133 3f54  localhost:2113?T
+000039d0: 6c73 3d74 7275 650a 0a54 6865 2063 6c69  ls=true..The cli
+000039e0: 656e 7420 6d75 7374 2062 6520 636f 6e66  ent must be conf
+000039f0: 6967 7572 6564 2074 6f20 6372 6561 7465  igured to create
+00003a00: 2061 2022 7365 6375 7265 2220 636f 6e6e   a "secure" conn
+00003a10: 6563 7469 6f6e 2074 6f20 6120 2273 6563  ection to a "sec
+00003a20: 7572 6522 2073 6572 7665 722c 0a6f 7220  ure" server,.or 
+00003a30: 616c 7465 726e 6174 6976 656c 7920 616e  alternatively an
+00003a40: 2022 696e 7365 6375 7265 2220 636f 6e6e   "insecure" conn
+00003a50: 6563 7469 6f6e 2074 6f20 616e 2022 696e  ection to an "in
+00003a60: 7365 6375 7265 2220 7365 7276 6572 2e20  secure" server. 
+00003a70: 4279 2064 6566 6175 6c74 2c20 7468 650a  By default, the.
+00003a80: 636c 6965 6e74 2077 696c 6c20 6174 7465  client will atte
+00003a90: 6d70 7420 746f 2063 7265 6174 6520 6120  mpt to create a 
+00003aa0: 2273 6563 7572 6522 2063 6f6e 6e65 6374  "secure" connect
+00003ab0: 696f 6e2e 2041 6e64 2073 6f2c 2077 6865  ion. And so, whe
+00003ac0: 6e20 636f 6e6e 6563 7469 6e67 2074 6f20  n connecting to 
+00003ad0: 616e 0a22 696e 7365 6375 7265 2220 7365  an."insecure" se
+00003ae0: 7276 6572 2c20 7468 6520 636f 6e6e 6563  rver, the connec
+00003af0: 7469 6f6e 2073 7472 696e 6720 6d75 7374  tion string must
+00003b00: 2073 7065 6369 6679 2074 6861 7420 7468   specify that th
+00003b10: 6520 636c 6965 6e74 2073 686f 756c 6420  e client should 
+00003b20: 6174 7465 6d70 740a 746f 206d 616b 6520  attempt.to make 
+00003b30: 616e 2022 696e 7365 6375 7265 2220 636f  an "insecure" co
+00003b40: 6e6e 6563 7469 6f6e 2e0a 0a54 6865 2066  nnection...The f
+00003b50: 6f6c 6c6f 7769 6e67 2063 6f6e 6e65 6374  ollowing connect
+00003b60: 696f 6e20 7374 7269 6e67 2073 7065 6369  ion string speci
+00003b70: 6669 6573 2074 6861 7420 7468 6520 636c  fies that the cl
+00003b80: 6965 6e74 2073 686f 756c 640a 6174 7465  ient should.atte
+00003b90: 6d70 7420 746f 2063 7265 6174 6520 616e  mpt to create an
+00003ba0: 2022 696e 7365 6375 7265 2220 636f 6e6e   "insecure" conn
+00003bb0: 6563 7469 6f6e 2074 6f20 706f 7274 2032  ection to port 2
+00003bc0: 3131 3320 6f6e 2022 6c6f 6361 6c68 6f73  113 on "localhos
+00003bd0: 7422 2e0a 5768 656e 2063 6f6e 6e65 6374  t"..When connect
+00003be0: 696e 6720 746f 2061 6e20 2269 6e73 6563  ing to an "insec
+00003bf0: 7572 6522 2073 6572 7665 722c 2074 6865  ure" server, the
+00003c00: 2063 6c69 656e 7420 7769 6c6c 2069 676e   client will ign
+00003c10: 6f72 6520 616e 790a 7573 6572 6e61 6d65  ore any.username
+00003c20: 2061 6e64 2070 6173 7377 6f72 6420 696e   and password in
+00003c30: 666f 726d 6174 696f 6e20 696e 636c 7564  formation includ
+00003c40: 6564 2069 6e20 7468 6520 636f 6e6e 6563  ed in the connec
+00003c50: 7469 6f6e 2073 7472 696e 672c 0a73 6f20  tion string,.so 
+00003c60: 7468 6174 2075 7365 726e 616d 6573 2061  that usernames a
+00003c70: 6e64 2070 6173 7377 6f72 6473 2061 7265  nd passwords are
+00003c80: 206e 6f74 2073 656e 7420 6f76 6572 2061   not sent over a
+00003c90: 6e20 2269 6e73 6563 7572 6522 2063 6f6e  n "insecure" con
+00003ca0: 6e65 6374 696f 6e2e 0a0a 2020 2020 6573  nection...    es
+00003cb0: 6462 3a2f 2f6c 6f63 616c 686f 7374 3a32  db://localhost:2
+00003cc0: 3131 333f 546c 733d 6661 6c73 650a 0a50  113?Tls=false..P
+00003cd0: 6c65 6173 6520 6e6f 7465 2c20 7468 6520  lease note, the 
+00003ce0: 2269 6e73 6563 7572 6522 2063 6f6e 6e65  "insecure" conne
+00003cf0: 6374 696f 6e20 7374 7269 6e67 2075 7365  ction string use
+00003d00: 7320 6120 7175 6572 7920 7374 7269 6e67  s a query string
+00003d10: 2077 6974 6820 7468 6520 6669 656c 642d   with the field-
+00003d20: 7661 6c75 650a 6054 6c73 3d66 616c 7365  value.`Tls=false
+00003d30: 602e 2054 6865 2076 616c 7565 206f 6620  `. The value of 
+00003d40: 7468 6973 2066 6965 6c64 2069 7320 6279  this field is by
+00003d50: 2064 6566 6175 6c74 2060 7472 7565 602e   default `true`.
+00003d60: 0a0a 5768 656e 2063 6f6e 6e65 6374 696e  ..When connectin
+00003d70: 6720 746f 2061 2022 7365 6375 7265 2220  g to a "secure" 
+00003d80: 7365 7276 6572 2c20 7468 6520 6072 6f6f  server, the `roo
+00003d90: 745f 6365 7274 6966 6963 6174 6573 6020  t_certificates` 
+00003da0: 6172 6775 6d65 6e74 2063 616e 2062 650a  argument can be.
+00003db0: 6120 5079 7468 6f6e 2060 7374 7260 2063  a Python `str` c
+00003dc0: 6f6e 7461 696e 696e 6720 5045 4d20 656e  ontaining PEM en
+00003dd0: 636f 6465 6420 5353 4c2f 544c 5320 726f  coded SSL/TLS ro
+00003de0: 6f74 2063 6572 7469 6669 6361 7465 732e  ot certificates.
+00003df0: 2054 6869 7320 7661 6c75 6520 6973 0a70   This value is.p
+00003e00: 6173 7365 6420 6469 7265 6374 6c79 2074  assed directly t
+00003e10: 6f20 6067 7270 632e 7373 6c5f 6368 616e  o `grpc.ssl_chan
+00003e20: 6e65 6c5f 6372 6564 656e 7469 616c 7328  nel_credentials(
+00003e30: 2960 2e20 4974 2069 7320 7573 6564 2066  )`. It is used f
+00003e40: 6f72 2061 7574 6865 6e74 6963 6174 696e  or authenticatin
+00003e50: 6720 7468 650a 7365 7276 6572 2074 6f20  g the.server to 
+00003e60: 7468 6520 636c 6965 6e74 2e20 4974 2069  the client. It i
+00003e70: 7320 636f 6d6d 6f6e 6c79 2074 6865 2063  s commonly the c
+00003e80: 6572 7469 6669 6361 7465 206f 6620 7468  ertificate of th
+00003e90: 6520 6365 7274 6966 6963 6174 6520 6175  e certificate au
+00003ea0: 7468 6f72 6974 7920 7468 6174 0a77 6173  thority that.was
+00003eb0: 2072 6573 706f 6e73 6962 6c65 2066 6f72   responsible for
+00003ec0: 2067 656e 6572 6174 696e 6720 7468 6520   generating the 
+00003ed0: 5353 4c2f 544c 5320 6365 7274 6966 6963  SSL/TLS certific
+00003ee0: 6174 6520 7573 6564 2062 7920 7468 6520  ate used by the 
+00003ef0: 4576 656e 7453 746f 7265 4442 2073 6572  EventStoreDB ser
+00003f00: 7665 722e 0a4f 6674 656e 2069 7420 6973  ver..Often it is
+00003f10: 2075 6e6e 6563 6573 7361 7279 2074 6f20   unnecessary to 
+00003f20: 7072 6f76 6964 6520 7468 6573 6520 6365  provide these ce
+00003f30: 7274 6966 6963 6174 6573 2065 7870 6c69  rtificates expli
+00003f40: 6369 746c 792c 2069 6620 7468 6579 2061  citly, if they a
+00003f50: 7265 2069 6e73 7461 6c6c 6564 0a6c 6f63  re installed.loc
+00003f60: 616c 6c79 2069 6e20 6120 7375 6368 2061  ally in a such a
+00003f70: 2077 6179 2074 6861 7420 7468 6520 5079   way that the Py
+00003f80: 7468 6f6e 2067 7270 6320 6c69 6272 6172  thon grpc librar
+00003f90: 7920 6361 6e20 7069 636b 2074 6865 6d20  y can pick them 
+00003fa0: 7570 2066 726f 6d20 6120 6465 6661 756c  up from a defaul
+00003fb0: 740a 6c6f 6361 7469 6f6e 2e20 416c 7465  t.location. Alte
+00003fc0: 726e 6174 6976 656c 792c 2066 6f72 2064  rnatively, for d
+00003fd0: 6576 656c 6f70 6d65 6e74 2c20 796f 7520  evelopment, you 
+00003fe0: 6361 6e20 7573 6520 7468 6520 7365 7276  can use the serv
+00003ff0: 6572 2773 2063 6572 7469 6669 6361 7465  er's certificate
+00004000: 2069 7473 656c 662e 0a0a 496e 2074 6865   itself...In the
+00004010: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
+00004020: 7468 6520 636f 6e73 7472 7563 746f 7220  the constructor 
+00004030: 6172 6775 6d65 6e74 2076 616c 7565 7320  argument values 
+00004040: 6172 6520 7461 6b65 6e20 6672 6f6d 2074  are taken from t
+00004050: 6865 206f 7065 7261 7469 6e67 0a73 7973  he operating.sys
+00004060: 7465 6d20 656e 7669 726f 6e6d 656e 742e  tem environment.
+00004070: 0a0a 6060 6070 7974 686f 6e0a 696d 706f  ..```python.impo
+00004080: 7274 206f 730a 0a63 6c69 656e 7420 3d20  rt os..client = 
+00004090: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
+000040a0: 6e74 280a 2020 2020 7572 693d 6f73 2e67  nt(.    uri=os.g
+000040b0: 6574 656e 7628 2245 5344 425f 5552 4922  etenv("ESDB_URI"
+000040c0: 292c 0a20 2020 2072 6f6f 745f 6365 7274  ),.    root_cert
+000040d0: 6966 6963 6174 6573 3d6f 732e 6765 7465  ificates=os.gete
+000040e0: 6e76 2822 4553 4442 5f52 4f4f 545f 4345  nv("ESDB_ROOT_CE
+000040f0: 5254 4946 4943 4154 4553 2229 2c0a 290a  RTIFICATES"),.).
+00004100: 6060 600a 0a23 2320 436f 6e6e 6563 7469  ```..## Connecti
+00004110: 6f6e 2073 7472 696e 6773 3c61 2069 643d  on strings<a id=
+00004120: 2263 6f6e 6e65 6374 696f 6e2d 7374 7269  "connection-stri
+00004130: 6e67 7322 3e3c 2f61 3e0a 0a41 6e20 4576  ngs"></a>..An Ev
+00004140: 656e 7453 746f 7265 4442 2063 6f6e 6e65  entStoreDB conne
+00004150: 6374 696f 6e20 7374 7269 6e67 2069 7320  ction string is 
+00004160: 6120 5552 4920 7468 6174 2063 6f6e 666f  a URI that confo
+00004170: 726d 7320 7769 7468 206f 6e65 206f 6620  rms with one of 
+00004180: 7477 6f20 706f 7373 6962 6c65 0a73 6368  two possible.sch
+00004190: 656d 6573 3a20 6569 7468 6572 2074 6865  emes: either the
+000041a0: 2022 6573 6462 2220 7363 6865 6d65 2c20   "esdb" scheme, 
+000041b0: 6f72 2074 6865 2022 6573 6462 2b64 6973  or the "esdb+dis
+000041c0: 636f 7665 7222 2073 6368 656d 652e 0a0a  cover" scheme...
+000041d0: 5468 6520 7379 6e74 6178 2061 6e64 2073  The syntax and s
+000041e0: 656d 616e 7469 6373 206f 6620 7468 6520  emantics of the 
+000041f0: 4576 656e 7453 746f 7265 4442 2055 5249  EventStoreDB URI
+00004200: 2073 6368 656d 6573 2061 7265 2064 6573   schemes are des
+00004210: 6372 6962 6564 2062 656c 6f77 2e20 5468  cribed below. Th
+00004220: 650a 7379 6e74 6178 2069 7320 6465 6669  e.syntax is defi
+00004230: 6e65 6420 7573 696e 6720 5b45 424e 465d  ned using [EBNF]
+00004240: 2868 7474 7073 3a2f 2f65 6e2e 7769 6b69  (https://en.wiki
+00004250: 7065 6469 612e 6f72 672f 7769 6b69 2f45  pedia.org/wiki/E
+00004260: 7874 656e 6465 645f 4261 636b 7573 e280  xtended_Backus..
+00004270: 934e 6175 725f 666f 726d 292e 0a0a 2323  .Naur_form)...##
+00004280: 2320 5477 6f20 7363 6865 6d65 733c 6120  # Two schemes<a 
+00004290: 6964 3d22 7477 6f2d 7363 6865 6d65 7322  id="two-schemes"
+000042a0: 3e3c 2f61 3e0a 0a54 6865 2022 6573 6462  ></a>..The "esdb
+000042b0: 2220 5552 4920 7363 6865 6d65 2063 616e  " URI scheme can
+000042c0: 2062 6520 6465 6669 6e65 6420 696e 2074   be defined in t
+000042d0: 6865 2066 6f6c 6c6f 7769 6e67 2077 6179  he following way
+000042e0: 2e0a 0a20 2020 2065 7364 622d 7572 6920  ...    esdb-uri 
+000042f0: 3d20 2265 7364 623a 2f2f 2220 2c20 5b20  = "esdb://" , [ 
+00004300: 7573 6572 2d69 6e66 6f20 2c20 2240 2220  user-info , "@" 
+00004310: 5d20 2c20 6772 7063 2d74 6172 6765 742c  ] , grpc-target,
+00004320: 207b 2022 2c22 202c 2067 7270 632d 7461   { "," , grpc-ta
+00004330: 7267 6574 207d 202c 205b 2022 3f22 202c  rget } , [ "?" ,
+00004340: 2071 7565 7279 2d73 7472 696e 6720 5d20   query-string ] 
+00004350: 3b0a 0a49 6e20 7468 6520 2265 7364 6222  ;..In the "esdb"
+00004360: 2055 5249 2073 6368 656d 652c 2061 6674   URI scheme, aft
+00004370: 6572 2074 6865 206f 7074 696f 6e61 6c20  er the optional 
+00004380: 7573 6572 2069 6e66 6f20 7374 7269 6e67  user info string
+00004390: 2c20 7468 6572 6520 6d75 7374 2062 6520  , there must be 
+000043a0: 6174 206c 6561 7374 0a6f 6e65 2067 5250  at least.one gRP
+000043b0: 4320 7461 7267 6574 2e20 4966 2074 6865  C target. If the
+000043c0: 7265 2061 7265 2073 6576 6572 616c 2067  re are several g
+000043d0: 5250 4320 7461 7267 6574 732c 2074 6865  RPC targets, the
+000043e0: 7920 6d75 7374 2062 6520 7365 7061 7261  y must be separa
+000043f0: 7465 6420 6672 6f6d 2065 6163 680a 6f74  ted from each.ot
+00004400: 6865 7220 7769 7468 2074 6865 2022 2c22  her with the ","
+00004410: 2063 6861 7261 6374 6572 2e0a 0a45 6163   character...Eac
+00004420: 6820 6752 5043 2074 6172 6765 7420 7368  h gRPC target sh
+00004430: 6f75 6c64 2069 6e64 6963 6174 6520 616e  ould indicate an
+00004440: 2045 7665 6e74 5374 6f72 6544 4220 6752   EventStoreDB gR
+00004450: 5043 2073 6572 7665 7220 736f 636b 6574  PC server socket
+00004460: 2c20 616c 6c20 696e 2074 6865 2073 616d  , all in the sam
+00004470: 650a 4576 656e 7453 746f 7265 4442 2063  e.EventStoreDB c
+00004480: 6c75 7374 6572 2c20 6279 2073 7065 6369  luster, by speci
+00004490: 6679 696e 6720 6120 686f 7374 2061 6e64  fying a host and
+000044a0: 2061 2070 6f72 7420 6e75 6d62 6572 2073   a port number s
+000044b0: 6570 6172 6174 6564 2077 6974 6820 7468  eparated with th
+000044c0: 6520 223a 220a 6368 6172 6163 7465 722e  e ":".character.
+000044d0: 2054 6865 2068 6f73 7420 6d61 7920 6265   The host may be
+000044e0: 2061 2068 6f73 746e 616d 6520 7468 6174   a hostname that
+000044f0: 2063 616e 2062 6520 7265 736f 6c76 6564   can be resolved
+00004500: 2074 6f20 616e 2049 5020 6164 6472 6573   to an IP addres
+00004510: 732c 206f 7220 616e 2049 500a 6164 6472  s, or an IP.addr
+00004520: 6573 732e 0a0a 2020 2020 6772 7063 2d74  ess...    grpc-t
+00004530: 6172 6765 7420 3d20 2820 686f 7374 6e61  arget = ( hostna
+00004540: 6d65 207c 2069 702d 6164 6472 6573 7320  me | ip-address 
+00004550: 2920 2c20 223a 2220 2c20 706f 7274 2d6e  ) , ":" , port-n
+00004560: 756d 6265 7220 3b0a 0a49 6620 7468 6572  umber ;..If ther
+00004570: 6520 6973 206f 6e65 2067 5250 4320 7461  e is one gRPC ta
+00004580: 7267 6574 2c20 7468 6520 636c 6965 6e74  rget, the client
+00004590: 2077 696c 6c20 7369 6d70 6c79 2061 7474   will simply att
+000045a0: 656d 7074 2074 6f20 636f 6e6e 6563 7420  empt to connect 
+000045b0: 746f 2074 6869 730a 7365 7276 6572 2c20  to this.server, 
+000045c0: 616e 6420 6974 2077 696c 6c20 7573 6520  and it will use 
+000045d0: 7468 6973 2063 6f6e 6e65 6374 696f 6e20  this connection 
+000045e0: 7768 656e 2072 6563 6f72 6469 6e67 2061  when recording a
+000045f0: 6e64 2072 6574 7269 6576 696e 6720 6576  nd retrieving ev
+00004600: 656e 7473 2e0a 0a49 6620 7468 6572 6520  ents...If there 
+00004610: 6172 6520 7477 6f20 6f72 206d 6f72 6520  are two or more 
+00004620: 6752 5043 2074 6172 6765 7473 2c20 7468  gRPC targets, th
+00004630: 6520 636c 6965 6e74 2077 696c 6c20 6174  e client will at
+00004640: 7465 6d70 7420 746f 2063 6f6e 6e65 6374  tempt to connect
+00004650: 2074 6f20 7468 650a 476f 7373 6970 2041   to the.Gossip A
+00004660: 5049 206f 6620 6561 6368 2069 6e20 7475  PI of each in tu
+00004670: 726e 2c20 746f 206f 6274 6169 6e20 696e  rn, to obtain in
+00004680: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
+00004690: 7468 6520 7768 6f6c 6520 636c 7573 7465  the whole cluste
+000046a0: 722e 2041 206d 656d 6265 720a 6f66 2074  r. A member.of t
+000046b0: 6865 2063 6c75 7374 6572 2069 7320 7468  he cluster is th
+000046c0: 656e 2073 656c 6563 7465 6420 6279 2074  en selected by t
+000046d0: 6865 2063 6c69 656e 7420 6163 636f 7264  he client accord
+000046e0: 696e 6720 746f 2074 6865 2022 6e6f 6465  ing to the "node
+000046f0: 2070 7265 6665 7265 6e63 6522 206f 7074   preference" opt
+00004700: 696f 6e0a 6f66 2074 6865 2063 6f6e 6e65  ion.of the conne
+00004710: 6374 696f 6e20 7374 7269 6e67 2e20 5468  ction string. Th
+00004720: 6520 636c 6965 6e74 206d 6179 2074 6865  e client may the
+00004730: 6e20 6e65 6564 2074 6f20 636c 6f73 6520  n need to close 
+00004740: 6974 7320 636f 6e6e 6563 7469 6f6e 2061  its connection a
+00004750: 6e64 2072 6563 6f6e 6e65 6374 0a74 6f20  nd reconnect.to 
+00004760: 7468 6520 7365 6c65 6374 6564 206e 6f64  the selected nod
+00004770: 652e 0a0a 5468 6520 2265 7364 622b 6469  e...The "esdb+di
+00004780: 7363 6f76 6572 2220 5552 4920 7363 6865  scover" URI sche
+00004790: 6d65 2063 616e 2062 6520 6465 6669 6e65  me can be define
+000047a0: 6420 696e 2074 6865 2066 6f6c 6c6f 7769  d in the followi
+000047b0: 6e67 2077 6179 2e0a 0a20 2020 2065 7364  ng way...    esd
+000047c0: 622d 6469 7363 6f76 6572 2d75 7269 203d  b-discover-uri =
+000047d0: 2022 6573 6462 2b64 6973 636f 7665 723a   "esdb+discover:
+000047e0: 2f2f 2220 2c20 5b20 7573 6572 2d69 6e66  //" , [ user-inf
+000047f0: 6f2c 2022 4022 205d 202c 2063 6c75 7374  o, "@" ] , clust
+00004800: 6572 2d64 6f6d 6169 6e6e 616d 652c 205b  er-domainname, [
+00004810: 2022 3a22 202c 2070 6f72 742d 6e75 6d62   ":" , port-numb
+00004820: 6572 205d 202c 205b 2022 3f22 202c 2071  er ] , [ "?" , q
+00004830: 7565 7279 2d73 7472 696e 6720 5d20 3b0a  uery-string ] ;.
+00004840: 0a49 6e20 7468 6520 2265 7364 622b 6469  .In the "esdb+di
+00004850: 7363 6f76 6572 2220 5552 4920 7363 6865  scover" URI sche
+00004860: 6d65 2c20 6166 7465 7220 7468 6520 6f70  me, after the op
+00004870: 7469 6f6e 616c 2075 7365 7220 696e 666f  tional user info
+00004880: 2073 7472 696e 672c 2074 6865 7265 2073   string, there s
+00004890: 686f 756c 6420 6265 0a61 2064 6f6d 6169  hould be.a domai
+000048a0: 6e20 6e61 6d65 2077 6869 6368 2069 6465  n name which ide
+000048b0: 6e74 6966 6965 7320 6120 636c 7573 7465  ntifies a cluste
+000048c0: 7220 6f66 2045 7665 6e74 5374 6f72 6544  r of EventStoreD
+000048d0: 4220 7365 7276 6572 732e 2049 6e64 6976  B servers. Indiv
+000048e0: 6964 7561 6c20 6e6f 6465 7320 696e 0a74  idual nodes in.t
+000048f0: 6865 2063 6c75 7374 6572 2073 686f 756c  he cluster shoul
+00004900: 6420 6265 2064 6563 6c61 7265 6420 7769  d be declared wi
+00004910: 7468 2044 4e53 2027 4127 2072 6563 6f72  th DNS 'A' recor
+00004920: 6473 2e0a 0a54 6865 2063 6c69 656e 7420  ds...The client 
+00004930: 7769 6c6c 2063 7265 6174 6520 6120 6752  will create a gR
+00004940: 5043 2063 6f6e 6e65 6374 696f 6e20 7573  PC connection us
+00004950: 696e 6720 7468 6520 636c 7573 7465 7227  ing the cluster'
+00004960: 7320 646f 6d61 696e 206e 616d 652c 2075  s domain name, u
+00004970: 7369 6e67 2074 6865 0a67 5250 4320 6c69  sing the.gRPC li
+00004980: 6272 6172 7927 7320 2772 6f75 6e64 2072  brary's 'round r
+00004990: 6f62 696e 2720 6c6f 6164 2062 616c 616e  obin' load balan
+000049a0: 6369 6e67 2073 7472 6174 6567 7920 746f  cing strategy to
+000049b0: 2063 616c 6c20 7468 6520 476f 7373 6970   call the Gossip
+000049c0: 2041 5049 206f 6620 6164 6472 6573 7365   API of addresse
+000049d0: 730a 746f 2077 6869 6368 2074 6869 7320  s.to which this 
+000049e0: 646f 6d61 696e 206e 616d 6520 7265 736f  domain name reso
+000049f0: 6c76 6573 2e20 496e 666f 726d 6174 696f  lves. Informatio
+00004a00: 6e20 6162 6f75 7420 7468 6520 4576 656e  n about the Even
+00004a10: 7453 746f 7265 4442 2063 6c75 7374 6572  tStoreDB cluster
+00004a20: 2069 730a 6f62 7461 696e 6564 2066 726f   is.obtained fro
+00004a30: 6d20 7468 6520 476f 7373 6970 2041 5049  m the Gossip API
+00004a40: 2e20 4120 6d65 6d62 6572 206f 6620 7468  . A member of th
+00004a50: 6520 636c 7573 7465 7220 6973 2074 6865  e cluster is the
+00004a60: 6e20 7365 6c65 6374 6564 2062 7920 7468  n selected by th
+00004a70: 6520 636c 6965 6e74 0a61 6363 6f72 6469  e client.accordi
+00004a80: 6e67 2074 6f20 7468 6520 226e 6f64 6520  ng to the "node 
+00004a90: 7072 6566 6572 656e 6365 2220 6f70 7469  preference" opti
+00004aa0: 6f6e 2e20 5468 6520 636c 6965 6e74 206d  on. The client m
+00004ab0: 6179 2074 6865 6e20 6e65 6564 2074 6f20  ay then need to 
+00004ac0: 636c 6f73 6520 6974 730a 636f 6e6e 6563  close its.connec
+00004ad0: 7469 6f6e 2061 6e64 2072 6563 6f6e 6e65  tion and reconne
+00004ae0: 6374 2074 6f20 7468 6520 7365 6c65 6374  ct to the select
+00004af0: 6564 206e 6f64 652e 0a0a 2323 2320 5573  ed node...### Us
+00004b00: 6572 2069 6e66 6f20 7374 7269 6e67 3c61  er info string<a
+00004b10: 2069 643d 2275 7365 722d 696e 666f 2d73   id="user-info-s
+00004b20: 7472 696e 6722 3e3c 2f61 3e0a 0a49 6e20  tring"></a>..In 
+00004b30: 626f 7468 2074 6865 2022 6573 6462 2220  both the "esdb" 
+00004b40: 616e 6420 2265 7364 622b 6469 7363 6f76  and "esdb+discov
+00004b50: 6572 2220 7363 6865 6d65 732c 2074 6865  er" schemes, the
+00004b60: 2055 5249 206d 6179 2069 6e63 6c75 6465   URI may include
+00004b70: 2061 2075 7365 7220 696e 666f 2073 7472   a user info str
+00004b80: 696e 672e 0a49 6620 6974 2065 7869 7374  ing..If it exist
+00004b90: 7320 696e 2074 6865 2055 5249 2c20 7468  s in the URI, th
+00004ba0: 6520 7573 6572 2069 6e66 6f20 7374 7269  e user info stri
+00004bb0: 6e67 206d 7573 7420 6265 2073 6570 6172  ng must be separ
+00004bc0: 6174 6564 2066 726f 6d20 7468 6520 7265  ated from the re
+00004bd0: 7374 206f 6620 7468 6520 5552 490a 7769  st of the URI.wi
+00004be0: 7468 2074 6865 2022 4022 2063 6861 7261  th the "@" chara
+00004bf0: 6374 6572 2e20 5468 6520 7573 6572 2069  cter. The user i
+00004c00: 6e66 6f20 7374 7269 6e67 206d 7573 7420  nfo string must 
+00004c10: 696e 636c 7564 6520 6120 7573 6572 6e61  include a userna
+00004c20: 6d65 2061 6e64 2061 2070 6173 7377 6f72  me and a passwor
+00004c30: 642c 0a73 6570 6172 6174 6564 2077 6974  d,.separated wit
+00004c40: 6820 7468 6520 223a 2220 6368 6172 6163  h the ":" charac
+00004c50: 7465 722e 0a0a 2020 2020 7573 6572 2d69  ter...    user-i
+00004c60: 6e66 6f20 3d20 7573 6572 6e61 6d65 202c  nfo = username ,
+00004c70: 2022 3a22 202c 2070 6173 7377 6f72 6420   ":" , password 
+00004c80: 3b0a 0a54 6865 2075 7365 7220 696e 666f  ;..The user info
+00004c90: 2069 7320 7365 6e74 2062 7920 7468 6520   is sent by the 
+00004ca0: 636c 6965 6e74 2061 7320 2263 616c 6c20  client as "call 
+00004cb0: 6372 6564 656e 7469 616c 7322 2069 6e20  credentials" in 
+00004cc0: 6561 6368 2063 616c 6c20 746f 2061 2022  each call to a "
+00004cd0: 7365 6375 7265 220a 7365 7276 6572 2c20  secure".server, 
+00004ce0: 696e 2061 2022 6261 7369 6320 6175 7468  in a "basic auth
+00004cf0: 2220 6175 7468 6f72 697a 6174 696f 6e20  " authorization 
+00004d00: 6865 6164 6572 2e20 5468 6973 2061 7574  header. This aut
+00004d10: 686f 7269 7a61 7469 6f6e 2068 6561 6465  horization heade
+00004d20: 7220 6973 2075 7365 6420 6279 0a74 6865  r is used by.the
+00004d30: 2073 6572 7665 7220 746f 2061 7574 6865   server to authe
+00004d40: 6e74 6963 6174 6520 7468 6520 636c 6965  nticate the clie
+00004d50: 6e74 2e20 5468 6520 6175 7468 6f72 697a  nt. The authoriz
+00004d60: 6174 696f 6e20 6865 6164 6572 2069 7320  ation header is 
+00004d70: 6e6f 7420 7365 6e74 2074 6f0a 2269 6e73  not sent to."ins
+00004d80: 6563 7572 6522 2073 6572 7665 7273 2e0a  ecure" servers..
+00004d90: 0a23 2323 2051 7565 7279 2073 7472 696e  .### Query strin
+00004da0: 673c 6120 6964 3d22 7175 6572 792d 7374  g<a id="query-st
+00004db0: 7269 6e67 223e 3c2f 613e 0a0a 496e 2062  ring"></a>..In b
+00004dc0: 6f74 6820 7468 6520 2265 7364 6222 2061  oth the "esdb" a
+00004dd0: 6e64 2022 6573 6462 2b64 6973 636f 7665  nd "esdb+discove
+00004de0: 7222 2073 6368 656d 6573 2c20 7468 6520  r" schemes, the 
+00004df0: 6f70 7469 6f6e 616c 2071 7565 7279 2073  optional query s
+00004e00: 7472 696e 6720 6d75 7374 2062 6520 6f6e  tring must be on
+00004e10: 650a 6f72 206d 616e 7920 6669 656c 642d  e.or many field-
+00004e20: 7661 6c75 6520 6172 6775 6d65 6e74 732c  value arguments,
+00004e30: 2073 6570 6172 6174 6564 2066 726f 6d20   separated from 
+00004e40: 6561 6368 206f 7468 6572 2077 6974 6820  each other with 
+00004e50: 7468 6520 2226 2220 6368 6172 6163 7465  the "&" characte
+00004e60: 722e 0a0a 2020 2020 7175 6572 792d 7374  r...    query-st
+00004e70: 7269 6e67 203d 2066 6965 6c64 2d76 616c  ring = field-val
+00004e80: 7565 2c20 7b20 2226 222c 2066 6965 6c64  ue, { "&", field
+00004e90: 2d76 616c 7565 207d 203b 0a0a 4561 6368  -value } ;..Each
+00004ea0: 2066 6965 6c64 2d76 616c 7565 2061 7267   field-value arg
+00004eb0: 756d 656e 7420 6d75 7374 2062 6520 6f6e  ument must be on
+00004ec0: 6520 6f66 2074 6865 2073 7570 706f 7274  e of the support
+00004ed0: 6564 2066 6965 6c64 732c 2061 6e64 2061  ed fields, and a
+00004ee0: 6e0a 6170 7072 6f70 7269 6174 6520 7661  n.appropriate va
+00004ef0: 6c75 652c 2073 6570 6172 6174 6564 2077  lue, separated w
+00004f00: 6974 6820 7468 6520 223d 2220 6368 6172  ith the "=" char
+00004f10: 6163 7465 722e 0a0a 2020 2020 6669 656c  acter...    fiel
+00004f20: 642d 7661 6c75 6520 3d20 2820 2254 6c73  d-value = ( "Tls
+00004f30: 222c 2022 3d22 202c 2022 7472 7565 2220  ", "=" , "true" 
+00004f40: 7c20 2266 616c 7365 2220 290a 2020 2020  | "false" ).    
+00004f50: 2020 2020 2020 2020 2020 2020 7c20 2820              | ( 
+00004f60: 2254 6c73 5665 7269 6679 4365 7274 222c  "TlsVerifyCert",
+00004f70: 2022 3d22 202c 2022 7472 7565 2220 7c20   "=" , "true" | 
+00004f80: 2266 616c 7365 2220 290a 2020 2020 2020  "false" ).      
+00004f90: 2020 2020 2020 2020 2020 7c20 2820 2243            | ( "C
+00004fa0: 6f6e 6e65 6374 696f 6e4e 616d 6522 2c20  onnectionName", 
+00004fb0: 223d 2220 2c20 7374 7269 6e67 2029 0a20  "=" , string ). 
+00004fc0: 2020 2020 2020 2020 2020 2020 2020 207c                 |
+00004fd0: 2028 2022 4e6f 6465 5072 6566 6572 656e   ( "NodePreferen
+00004fe0: 6365 222c 2022 3d22 202c 2022 6c65 6164  ce", "=" , "lead
+00004ff0: 6572 2220 7c20 2266 6f6c 6c6f 7765 7222  er" | "follower"
+00005000: 207c 2022 7265 6164 6f6e 6c79 7265 706c   | "readonlyrepl
+00005010: 6963 6122 207c 2022 7261 6e64 6f6d 2220  ica" | "random" 
+00005020: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00005030: 2020 7c20 2820 2244 6566 6175 6c74 4465    | ( "DefaultDe
+00005040: 6164 6c69 6e65 222c 2022 3d22 202c 2069  adline", "=" , i
+00005050: 6e74 6567 6572 2029 0a20 2020 2020 2020  nteger ).       
+00005060: 2020 2020 2020 2020 207c 2028 2022 476f           | ( "Go
+00005070: 7373 6970 5469 6d65 6f75 7422 2c20 223d  ssipTimeout", "=
+00005080: 2220 2c20 696e 7465 6765 7220 290a 2020  " , integer ).  
+00005090: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
+000050a0: 2820 224d 6178 4469 7363 6f76 6572 4174  ( "MaxDiscoverAt
+000050b0: 7465 6d70 7473 222c 2022 3d22 202c 2069  tempts", "=" , i
+000050c0: 6e74 6567 6572 2029 0a20 2020 2020 2020  nteger ).       
+000050d0: 2020 2020 2020 2020 207c 2028 2022 4469           | ( "Di
+000050e0: 7363 6f76 6572 7949 6e74 6572 7661 6c22  scoveryInterval"
+000050f0: 2c20 223d 2220 2c20 696e 7465 6765 7220  , "=" , integer 
+00005100: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00005110: 2020 7c20 2820 224b 6565 7041 6c69 7665    | ( "KeepAlive
+00005120: 496e 7465 7276 616c 222c 2022 3d22 202c  Interval", "=" ,
+00005130: 2069 6e74 6567 6572 2029 0a20 2020 2020   integer ).     
+00005140: 2020 2020 2020 2020 2020 207c 2028 2022             | ( "
+00005150: 4b65 6570 416c 6976 6554 696d 656f 7574  KeepAliveTimeout
+00005160: 222c 2022 3d22 202c 2069 6e74 6567 6572  ", "=" , integer
+00005170: 2029 203b 0a0a 5468 6520 7461 626c 6520   ) ;..The table 
+00005180: 6265 6c6f 7720 6465 7363 7269 6265 7320  below describes 
+00005190: 7468 6520 7175 6572 7920 6669 656c 642d  the query field-
+000051a0: 7661 6c75 6573 2073 7570 706f 7274 6564  values supported
+000051b0: 2062 7920 7468 6973 2063 6c69 656e 742e   by this client.
+000051c0: 0a0a 7c20 4669 656c 6420 2020 2020 2020  ..| Field       
+000051d0: 2020 2020 2020 2020 7c20 5661 6c75 6520          | Value 
+000051e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005220: 7c20 4465 7363 7269 7074 696f 6e20 2020  | Description   
+00005230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052c0: 2020 2020 7c0a 7c2d 2d2d 2d2d 2d2d 2d2d      |.|---------
+000052d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 7c2d 2d2d  ------------|---
+000052e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000052f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005300: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005310: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005320: 2d2d 2d2d 7c2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----|-----------
+00005330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000053a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000053b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000053c0: 2d2d 2d2d 2d2d 2d2d 7c0a 7c20 546c 7320  --------|.| Tls 
+000053d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000053e0: 7c20 2274 7275 6522 2c20 2266 616c 7365  | "true", "false
+000053f0: 2220 2864 6566 6175 6c74 3a20 2274 7275  " (default: "tru
+00005400: 6522 2920 2020 2020 2020 2020 2020 2020  e")             
+00005410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005420: 2020 2020 2020 2020 7c20 4966 2022 7472          | If "tr
+00005430: 7565 2220 7468 6520 636c 6965 6e74 2077  ue" the client w
+00005440: 696c 6c20 6372 6561 7465 2061 2022 7365  ill create a "se
+00005450: 6375 7265 2220 6752 5043 2063 6861 6e6e  cure" gRPC chann
+00005460: 656c 2e20 4966 2022 6661 6c73 6522 2074  el. If "false" t
+00005470: 6865 2063 6c69 656e 7420 7769 6c6c 2063  he client will c
+00005480: 7265 6174 6520 616e 2022 696e 7365 6375  reate an "insecu
+00005490: 7265 2220 6752 5043 2063 6861 6e6e 656c  re" gRPC channel
+000054a0: 2e20 5468 6973 206d 7573 7420 6d61 7463  . This must matc
+000054b0: 6820 7468 6520 7365 7276 6572 2063 6f6e  h the server con
+000054c0: 6669 6775 7261 7469 6f6e 2e20 7c0a 7c20  figuration. |.| 
+000054d0: 546c 7356 6572 6966 7943 6572 7420 2020  TlsVerifyCert   
+000054e0: 2020 2020 7c20 2274 7275 6522 2c20 2266      | "true", "f
+000054f0: 616c 7365 2220 2864 6566 6175 6c74 3a20  alse" (default: 
+00005500: 2274 7275 6522 2920 2020 2020 2020 2020  "true")         
+00005510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005520: 2020 2020 2020 2020 2020 2020 7c20 5468              | Th
+00005530: 6973 2076 616c 7565 2069 7320 6375 7272  is value is curr
+00005540: 656e 746c 7920 6967 6e6f 7265 642e 2020  ently ignored.  
+00005550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000055b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000055c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000055d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000055e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000055f0: 2020 2020 2020 2020 207c 5c6e 7c20 4e6f           |\n| No
-00005600: 6465 5072 6566 6572 656e 6365 2020 2020  dePreference    
-00005610: 2020 7c20 226c 6561 6465 7222 2c20 2266    | "leader", "f
-00005620: 6f6c 6c6f 7765 7222 2c20 2272 6561 646f  ollower", "reado
-00005630: 6e6c 7972 6570 6c69 6361 222c 2022 7261  nlyreplica", "ra
-00005640: 6e64 6f6d 2220 2864 6566 6175 6c74 3a20  ndom" (default: 
-00005650: 226c 6561 6465 7222 2920 7c20 5468 6520  "leader") | The 
-00005660: 6e6f 6465 2073 7461 7465 2070 7265 6665  node state prefe
-00005670: 7272 6564 2062 7920 7468 6520 636c 6965  rred by the clie
-00005680: 6e74 2e20 5468 6520 636c 6965 6e74 2077  nt. The client w
-00005690: 696c 6c20 7365 6c65 6374 2061 206e 6f64  ill select a nod
-000056a0: 6520 6672 6f6d 2074 6865 2063 6c75 7374  e from the clust
-000056b0: 6572 2069 6e66 6f20 7265 6365 6976 6564  er info received
-000056c0: 2066 726f 6d20 7468 6520 476f 7373 6970   from the Gossip
-000056d0: 2041 5049 2061 6363 6f72 6469 6e67 2074   API according t
-000056e0: 6f20 7468 6973 2070 7265 6665 7265 6e63  o this preferenc
-000056f0: 652e 2020 2020 2020 2020 2020 2020 7c5c  e.            |\
-00005700: 6e7c 2044 6566 6175 6c74 4465 6164 6c69  n| DefaultDeadli
-00005710: 6e65 2020 2020 207c 2069 6e74 6567 6572  ne     | integer
-00005720: 2028 6465 6661 756c 743a 2060 4e6f 6e65   (default: `None
-00005730: 6029 2020 2020 2020 2020 2020 2020 2020  `)              
-00005740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005750: 2020 2020 2020 2020 2020 2020 2020 207c                 |
-00005760: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
-00005770: 7565 2028 696e 2073 6563 6f6e 6473 2920  ue (in seconds) 
-00005780: 6f66 2074 6865 2060 7469 6d65 6f75 7460  of the `timeout`
-00005790: 2061 7267 756d 656e 7420 6f66 2063 6c69   argument of cli
-000057a0: 656e 7420 2277 7269 7465 2220 6d65 7468  ent "write" meth
-000057b0: 6f64 7320 7375 6368 2061 7320 6061 7070  ods such as `app
-000057c0: 656e 645f 746f 5f73 7472 6561 6d28 2960  end_to_stream()`
-000057d0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-000057e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000057f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005800: 2020 207c 5c6e 7c20 476f 7373 6970 5469     |\n| GossipTi
-00005810: 6d65 6f75 7420 2020 2020 2020 7c20 696e  meout       | in
-00005820: 7465 6765 7220 2864 6566 6175 6c74 3a20  teger (default: 
-00005830: 3529 2020 2020 2020 2020 2020 2020 2020  5)              
-00005840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005860: 2020 2020 7c20 5468 6520 6465 6661 756c      | The defaul
-00005870: 7420 7661 6c75 6520 2869 6e20 7365 636f  t value (in seco
-00005880: 6e64 7329 206f 6620 7468 6520 6074 696d  nds) of the `tim
-00005890: 656f 7574 6020 6172 6775 6d65 6e74 206f  eout` argument o
-000058a0: 6620 676f 7373 6970 2072 6561 6420 6d65  f gossip read me
-000058b0: 7468 6f64 732c 2073 7563 6820 6173 2060  thods, such as `
-000058c0: 7265 6164 5f67 6f73 7369 7028 2960 2e20  read_gossip()`. 
-000058d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000058e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000058f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005900: 2020 2020 2020 2020 7c5c 6e7c 204d 6178          |\n| Max
-00005910: 4469 7363 6f76 6572 4174 7465 6d70 7473  DiscoverAttempts
-00005920: 207c 2069 6e74 6567 6572 2028 6465 6661   | integer (defa
-00005930: 756c 743a 2031 3029 2020 2020 2020 2020  ult: 10)        
-00005940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005960: 2020 2020 2020 2020 207c 2054 6865 206e           | The n
-00005970: 756d 6265 7220 6f66 2061 7474 656d 7074  umber of attempt
-00005980: 7320 746f 2072 6561 6420 676f 7373 6970  s to read gossip
-00005990: 2077 6865 6e20 636f 6e6e 6563 7469 6e67   when connecting
-000059a0: 206f 7220 7265 636f 6e6e 6563 7469 6e67   or reconnecting
-000059b0: 2074 6f20 6120 636c 7573 7465 7220 6d65   to a cluster me
-000059c0: 6d62 6572 2e20 2020 2020 2020 2020 2020  mber.           
+000055d0: 7c0a 7c20 436f 6e6e 6563 7469 6f6e 4e61  |.| ConnectionNa
+000055e0: 6d65 2020 2020 2020 7c20 7374 7269 6e67  me      | string
+000055f0: 2028 6465 6661 756c 743a 2061 7574 6f2d   (default: auto-
+00005600: 6765 6e65 7261 7465 6420 7665 7273 696f  generated versio
+00005610: 6e2d 3420 5555 4944 2920 2020 2020 2020  n-4 UUID)       
+00005620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005630: 7c20 5365 6e74 2069 6e20 6361 6c6c 206d  | Sent in call m
+00005640: 6574 6164 6174 6120 666f 7220 6576 6572  etadata for ever
+00005650: 7920 6361 6c6c 2c20 746f 2069 6465 6e74  y call, to ident
+00005660: 6966 7920 7468 6520 636c 6965 6e74 2074  ify the client t
+00005670: 6f20 7468 6520 636c 7573 7465 722e 2020  o the cluster.  
+00005680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000056d0: 2020 2020 7c0a 7c20 4e6f 6465 5072 6566      |.| NodePref
+000056e0: 6572 656e 6365 2020 2020 2020 7c20 226c  erence      | "l
+000056f0: 6561 6465 7222 2c20 2266 6f6c 6c6f 7765  eader", "followe
+00005700: 7222 2c20 2272 6561 646f 6e6c 7972 6570  r", "readonlyrep
+00005710: 6c69 6361 222c 2022 7261 6e64 6f6d 2220  lica", "random" 
+00005720: 2864 6566 6175 6c74 3a20 226c 6561 6465  (default: "leade
+00005730: 7222 2920 7c20 5468 6520 6e6f 6465 2073  r") | The node s
+00005740: 7461 7465 2070 7265 6665 7272 6564 2062  tate preferred b
+00005750: 7920 7468 6520 636c 6965 6e74 2e20 5468  y the client. Th
+00005760: 6520 636c 6965 6e74 2077 696c 6c20 7365  e client will se
+00005770: 6c65 6374 2061 206e 6f64 6520 6672 6f6d  lect a node from
+00005780: 2074 6865 2063 6c75 7374 6572 2069 6e66   the cluster inf
+00005790: 6f20 7265 6365 6976 6564 2066 726f 6d20  o received from 
+000057a0: 7468 6520 476f 7373 6970 2041 5049 2061  the Gossip API a
+000057b0: 6363 6f72 6469 6e67 2074 6f20 7468 6973  ccording to this
+000057c0: 2070 7265 6665 7265 6e63 652e 2020 2020   preference.    
+000057d0: 2020 2020 2020 2020 7c0a 7c20 4465 6661          |.| Defa
+000057e0: 756c 7444 6561 646c 696e 6520 2020 2020  ultDeadline     
+000057f0: 7c20 696e 7465 6765 7220 2864 6566 6175  | integer (defau
+00005800: 6c74 3a20 604e 6f6e 6560 2920 2020 2020  lt: `None`)     
+00005810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005830: 2020 2020 2020 2020 7c20 5468 6520 6465          | The de
+00005840: 6661 756c 7420 7661 6c75 6520 2869 6e20  fault value (in 
+00005850: 7365 636f 6e64 7329 206f 6620 7468 6520  seconds) of the 
+00005860: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
+00005870: 6e74 206f 6620 636c 6965 6e74 2022 7772  nt of client "wr
+00005880: 6974 6522 206d 6574 686f 6473 2073 7563  ite" methods suc
+00005890: 6820 6173 2060 6170 7065 6e64 5f74 6f5f  h as `append_to_
+000058a0: 7374 7265 616d 2829 602e 2020 2020 2020  stream()`.      
+000058b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058d0: 2020 2020 2020 2020 2020 2020 7c0a 7c20              |.| 
+000058e0: 476f 7373 6970 5469 6d65 6f75 7420 2020  GossipTimeout   
+000058f0: 2020 2020 7c20 696e 7465 6765 7220 2864      | integer (d
+00005900: 6566 6175 6c74 3a20 3529 2020 2020 2020  efault: 5)      
+00005910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005930: 2020 2020 2020 2020 2020 2020 7c20 5468              | Th
+00005940: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+00005950: 2869 6e20 7365 636f 6e64 7329 206f 6620  (in seconds) of 
+00005960: 7468 6520 6074 696d 656f 7574 6020 6172  the `timeout` ar
+00005970: 6775 6d65 6e74 206f 6620 676f 7373 6970  gument of gossip
+00005980: 2072 6561 6420 6d65 7468 6f64 732c 2073   read methods, s
+00005990: 7563 6820 6173 2060 7265 6164 5f67 6f73  uch as `read_gos
+000059a0: 7369 7028 2960 2e20 2020 2020 2020 2020  sip()`.         
+000059b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000059c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000059d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000059e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000059f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005a00: 2020 2020 2020 2020 2020 2020 207c 5c6e               |\n
-00005a10: 7c20 4469 7363 6f76 6572 7949 6e74 6572  | DiscoveryInter
-00005a20: 7661 6c20 2020 7c20 696e 7465 6765 7220  val   | integer 
-00005a30: 2864 6566 6175 6c74 3a20 3130 3029 2020  (default: 100)  
-00005a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005a60: 2020 2020 2020 2020 2020 2020 2020 7c20                | 
-00005a70: 486f 7720 6c6f 6e67 2074 6f20 7761 6974  How long to wait
-00005a80: 2028 696e 206d 696c 6c69 7365 636f 6e64   (in millisecond
-00005a90: 7329 2062 6574 7765 656e 2067 6f73 7369  s) between gossi
-00005aa0: 7020 7265 7472 6965 732e 2020 2020 2020  p retries.      
+000059e0: 7c0a 7c20 4d61 7844 6973 636f 7665 7241  |.| MaxDiscoverA
+000059f0: 7474 656d 7074 7320 7c20 696e 7465 6765  ttempts | intege
+00005a00: 7220 2864 6566 6175 6c74 3a20 3130 2920  r (default: 10) 
+00005a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a40: 7c20 5468 6520 6e75 6d62 6572 206f 6620  | The number of 
+00005a50: 6174 7465 6d70 7473 2074 6f20 7265 6164  attempts to read
+00005a60: 2067 6f73 7369 7020 7768 656e 2063 6f6e   gossip when con
+00005a70: 6e65 6374 696e 6720 6f72 2072 6563 6f6e  necting or recon
+00005a80: 6e65 6374 696e 6720 746f 2061 2063 6c75  necting to a clu
+00005a90: 7374 6572 206d 656d 6265 722e 2020 2020  ster member.    
+00005aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b10: 2020 7c5c 6e7c 204b 6565 7041 6c69 7665    |\n| KeepAlive
-00005b20: 496e 7465 7276 616c 2020 207c 2069 6e74  Interval   | int
-00005b30: 6567 6572 2028 6465 6661 756c 743a 2060  eger (default: `
-00005b40: 4e6f 6e65 6029 2020 2020 2020 2020 2020  None`)          
-00005b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b70: 2020 207c 2054 6865 2076 616c 7565 206f     | The value o
-00005b80: 6620 7468 6520 2267 7270 632e 6b65 6570  f the "grpc.keep
-00005b90: 616c 6976 655f 6d73 2220 6752 5043 2063  alive_ms" gRPC c
-00005ba0: 6861 6e6e 656c 206f 7074 696f 6e2e 2020  hannel option.  
+00005ae0: 2020 2020 7c0a 7c20 4469 7363 6f76 6572      |.| Discover
+00005af0: 7949 6e74 6572 7661 6c20 2020 7c20 696e  yInterval   | in
+00005b00: 7465 6765 7220 2864 6566 6175 6c74 3a20  teger (default: 
+00005b10: 3130 3029 2020 2020 2020 2020 2020 2020  100)            
+00005b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b40: 2020 2020 7c20 486f 7720 6c6f 6e67 2074      | How long t
+00005b50: 6f20 7761 6974 2028 696e 206d 696c 6c69  o wait (in milli
+00005b60: 7365 636f 6e64 7329 2062 6574 7765 656e  seconds) between
+00005b70: 2067 6f73 7369 7020 7265 7472 6965 732e   gossip retries.
+00005b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c10: 2020 2020 2020 207c 5c6e 7c20 4b65 6570         |\n| Keep
-00005c20: 416c 6976 6554 696d 656f 7574 2020 2020  AliveTimeout    
-00005c30: 7c20 696e 7465 6765 7220 2864 6566 6175  | integer (defau
-00005c40: 6c74 3a20 604e 6f6e 6560 2920 2020 2020  lt: `None`)     
-00005c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c70: 2020 2020 2020 2020 7c20 5468 6520 7661          | The va
-00005c80: 6c75 6520 6f66 2074 6865 2022 6772 7063  lue of the "grpc
-00005c90: 2e6b 6565 7061 6c69 7665 5f74 696d 656f  .keepalive_timeo
-00005ca0: 7574 5f6d 7322 2067 5250 4320 6368 616e  ut_ms" gRPC chan
-00005cb0: 6e65 6c20 6f70 7469 6f6e 2e20 2020 2020  nel option.     
+00005be0: 2020 2020 2020 2020 7c0a 7c20 4b65 6570          |.| Keep
+00005bf0: 416c 6976 6549 6e74 6572 7661 6c20 2020  AliveInterval   
+00005c00: 7c20 696e 7465 6765 7220 2864 6566 6175  | integer (defau
+00005c10: 6c74 3a20 604e 6f6e 6560 2920 2020 2020  lt: `None`)     
+00005c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c40: 2020 2020 2020 2020 7c20 5468 6520 7661          | The va
+00005c50: 6c75 6520 6f66 2074 6865 2022 6772 7063  lue of the "grpc
+00005c60: 2e6b 6565 7061 6c69 7665 5f6d 7322 2067  .keepalive_ms" g
+00005c70: 5250 4320 6368 616e 6e65 6c20 6f70 7469  RPC channel opti
+00005c80: 6f6e 2e20 2020 2020 2020 2020 2020 2020  on.             
+00005c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d10: 2020 2020 2020 2020 2020 2020 7c5c 6e5c              |\n\
-00005d20: 6e5c 6e23 2323 2045 7861 6d70 6c65 735c  n\n### Examples\
-00005d30: 6e5c 6e48 6572 6520 6172 6520 736f 6d65  n\nHere are some
-00005d40: 2065 7861 6d70 6c65 7320 6f66 2045 7665   examples of Eve
-00005d50: 6e74 5374 6f72 6544 4220 636f 6e6e 6563  ntStoreDB connec
-00005d60: 7469 6f6e 2073 7472 696e 6720 5552 4973  tion string URIs
-00005d70: 2e5c 6e5c 6e54 6865 2066 6f6c 6c6f 7769  .\n\nThe followi
-00005d80: 6e67 2055 5249 2077 696c 6c20 6361 7573  ng URI will caus
-00005d90: 6520 7468 6520 636c 6965 6e74 2074 6f20  e the client to 
-00005da0: 636f 6e6e 6563 7420 746f 2c20 616e 6420  connect to, and 
-00005db0: 6765 745c 6e63 6c75 7374 6572 2069 6e66  get\ncluster inf
-00005dc0: 6f2c 2066 726f 6d20 2273 6563 7572 6522  o, from "secure"
-00005dd0: 2073 6572 7665 7220 736f 636b 6574 2060   server socket `
-00005de0: 6c6f 6361 6c68 6f73 743a 3231 3133 602e  localhost:2113`.
-00005df0: 2041 6e64 5c6e 7468 656e 2074 6f20 636f   And\nthen to co
-00005e00: 6e6e 6563 7420 746f 2061 2022 6c65 6164  nnect to a "lead
-00005e10: 6572 2220 6e6f 6465 2e20 416e 6420 616c  er" node. And al
-00005e20: 736f 2074 6f20 7573 6520 2261 646d 696e  so to use "admin
-00005e30: 2220 616e 645c 6e22 6368 616e 6765 6974  " and\n"changeit
-00005e40: 2220 6173 2074 6865 2075 7365 726e 616d  " as the usernam
-00005e50: 6520 616e 6420 7061 7373 776f 7264 2077  e and password w
-00005e60: 6865 6e20 6d61 6b69 6e67 2063 616c 6c73  hen making calls
-00005e70: 2074 6f5c 6e45 7665 6e74 5374 6f72 6544   to\nEventStoreD
-00005e80: 4220 4150 4920 6d65 7468 6f64 732e 5c6e  B API methods.\n
-00005e90: 5c6e 2020 2020 6573 6462 3a2f 2f61 646d  \n    esdb://adm
-00005ea0: 696e 3a63 6861 6e67 6569 7440 6c6f 6361  in:changeit@loca
-00005eb0: 6c68 6f73 743a 3231 3133 5c6e 5c6e 5c6e  lhost:2113\n\n\n
-00005ec0: 5468 6520 666f 6c6c 6f77 696e 6720 5552  The following UR
-00005ed0: 4920 7769 6c6c 2063 6175 7365 2074 6865  I will cause the
-00005ee0: 2063 6c69 656e 7420 746f 2067 6574 2063   client to get c
-00005ef0: 6c75 7374 6572 2069 6e66 6f20 6672 6f6d  luster info from
-00005f00: 5c6e 2269 6e73 6563 7572 6522 2073 6572  \n"insecure" ser
-00005f10: 7665 7220 736f 636b 6574 2031 3237 2e30  ver socket 127.0
-00005f20: 2e30 2e31 3a32 3131 332e 2020 416e 6420  .0.1:2113.  And 
-00005f30: 7468 656e 2074 6f20 636f 6e6e 6563 7420  then to connect 
-00005f40: 746f 5c6e 6120 226c 6561 6465 7222 206e  to\na "leader" n
-00005f50: 6f64 652e 5c6e 5c6e 2020 2020 6573 6462  ode.\n\n    esdb
-00005f60: 3a2f 2f31 3237 2e30 2e30 2e31 3a32 3131  ://127.0.0.1:211
-00005f70: 333f 546c 733d 6661 6c73 655c 6e5c 6e5c  3?Tls=false\n\n\
-00005f80: 6e54 6865 2066 6f6c 6c6f 7769 6e67 2055  nThe following U
-00005f90: 5249 2077 696c 6c20 6361 7573 6520 7468  RI will cause th
-00005fa0: 6520 636c 6965 6e74 2074 6f20 6765 7420  e client to get 
-00005fb0: 636c 7573 7465 7220 696e 666f 2066 726f  cluster info fro
-00005fc0: 6d5c 6e61 6464 7265 7373 6573 2069 6e20  m\naddresses in 
-00005fd0: 444e 5320 5c27 415c 2720 7265 636f 7264  DNS \'A\' record
-00005fe0: 7320 666f 7220 636c 7573 7465 7231 2e65  s for cluster1.e
-00005ff0: 7861 6d70 6c65 2e63 6f6d 2e20 416e 6420  xample.com. And 
-00006000: 7468 656e 5c6e 746f 2063 6f6e 6e65 6374  then\nto connect
-00006010: 2074 6f20 6120 226c 6561 6465 7222 206e   to a "leader" n
-00006020: 6f64 652e 2041 6e64 2075 7365 2061 2064  ode. And use a d
-00006030: 6566 6175 6c74 2064 6561 646c 696e 6520  efault deadline 
-00006040: 6f66 2035 5c6e 7365 636f 6e64 7320 7768  of 5\nseconds wh
-00006050: 656e 206d 616b 696e 6720 6361 6c6c 7320  en making calls 
-00006060: 746f 2045 7665 6e74 5374 6f72 6520 4150  to EventStore AP
-00006070: 4920 2277 7269 7465 2220 6d65 7468 6f64  I "write" method
-00006080: 732e 5c6e 5c6e 2020 2020 6573 6462 2b64  s.\n\n    esdb+d
-00006090: 6973 636f 7665 723a 2f2f 6164 6d69 6e3a  iscover://admin:
-000060a0: 6368 616e 6765 6974 4063 6c75 7374 6572  changeit@cluster
-000060b0: 312e 6578 616d 706c 652e 636f 6d3f 4465  1.example.com?De
-000060c0: 6661 756c 7444 6561 646c 696e 653d 355c  faultDeadline=5\
-000060d0: 6e5c 6e5c 6e54 6865 2066 6f6c 6c6f 7769  n\n\nThe followi
-000060e0: 6e67 2055 5249 2077 696c 6c20 6361 7573  ng URI will caus
-000060f0: 6520 7468 6520 636c 6965 6e74 2074 6f20  e the client to 
-00006100: 6765 7420 636c 7573 7465 7220 696e 666f  get cluster info
-00006110: 2066 726f 6d20 6569 7468 6572 5c6e 6c6f   from either\nlo
-00006120: 6361 6c68 6f73 743a 3231 3131 2c20 6f72  calhost:2111, or
-00006130: 206c 6f63 616c 686f 7374 3a32 3131 322c   localhost:2112,
-00006140: 206f 7220 6c6f 6361 6c68 6f73 743a 3231   or localhost:21
-00006150: 3133 2e20 416e 6420 7468 656e 2074 6f20  13. And then to 
-00006160: 636f 6e6e 6563 745c 6e74 6f20 6120 2266  connect\nto a "f
-00006170: 6f6c 6c6f 7765 7222 206e 6f64 652e 5c6e  ollower" node.\n
-00006180: 5c6e 2020 2020 6573 6462 3a2f 2f61 646d  \n    esdb://adm
-00006190: 696e 3a63 6861 6e67 6569 7440 6c6f 6361  in:changeit@loca
-000061a0: 6c68 6f73 743a 3231 3131 2c6c 6f63 616c  lhost:2111,local
-000061b0: 686f 7374 3a32 3131 322c 6c6f 6361 6c68  host:2112,localh
-000061c0: 6f73 743a 3231 3133 3f4e 6f64 6550 7265  ost:2113?NodePre
-000061d0: 6665 7265 6e63 653d 666f 6c6c 6f77 6572  ference=follower
-000061e0: 5c6e 5c6e 5c6e 5468 6520 666f 6c6c 6f77  \n\n\nThe follow
-000061f0: 696e 6720 5552 4920 7769 6c6c 2063 6175  ing URI will cau
-00006200: 7365 2074 6865 2063 6c69 656e 7420 746f  se the client to
-00006210: 2067 6574 2063 6c75 7374 6572 2069 6e66   get cluster inf
-00006220: 6f20 6672 6f6d 2061 6464 7265 7373 6573  o from addresses
-00006230: 2069 6e5c 6e44 4e53 205c 2741 5c27 2072   in\nDNS \'A\' r
-00006240: 6563 6f72 6473 2066 6f72 2063 6c75 7374  ecords for clust
-00006250: 6572 312e 6578 616d 706c 652e 636f 6d2e  er1.example.com.
-00006260: 2041 6e64 2074 6f20 636f 6e66 6967 7572   And to configur
-00006270: 6520 226b 6565 7020 616c 6976 6522 2074  e "keep alive" t
-00006280: 696d 656f 7574 5c6e 616e 6420 696e 7465  imeout\nand inte
-00006290: 7276 616c 2069 6e20 7468 6520 6752 5043  rval in the gRPC
-000062a0: 2063 6861 6e6e 656c 2e5c 6e5c 6e20 2020   channel.\n\n   
-000062b0: 2065 7364 622b 6469 7363 6f76 6572 3a2f   esdb+discover:/
-000062c0: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
-000062d0: 636c 7573 7465 7231 2e65 7861 6d70 6c65  cluster1.example
-000062e0: 2e63 6f6d 3f4b 6565 7041 6c69 7665 496e  .com?KeepAliveIn
-000062f0: 7465 7276 616c 3d31 3030 3030 264b 6565  terval=10000&Kee
-00006300: 7041 6c69 7665 5469 6d65 6f75 743d 3130  pAliveTimeout=10
-00006310: 3030 305c 6e5c 6e5c 6e50 6c65 6173 6520  000\n\n\nPlease 
-00006320: 6e6f 7465 2c20 7468 6520 636c 6965 6e74  note, the client
-00006330: 2069 7320 696e 7365 6e73 6974 6976 6520   is insensitive 
-00006340: 746f 2074 6865 2063 6173 6520 6f66 2066  to the case of f
-00006350: 6965 6c64 7320 616e 6420 7661 6c75 6573  ields and values
-00006360: 2e20 4966 2066 6965 6c64 7320 6172 655c  . If fields are\
-00006370: 6e72 6570 6561 7465 6420 696e 2074 6865  nrepeated in the
-00006380: 2071 7565 7279 2073 7472 696e 672c 2074   query string, t
-00006390: 6865 2071 7565 7279 2073 7472 696e 6720  he query string 
-000063a0: 7769 6c6c 2062 6520 7061 7273 6564 2077  will be parsed w
-000063b0: 6974 686f 7574 2065 7272 6f72 2e20 486f  ithout error. Ho
-000063c0: 7765 7665 722c 5c6e 7468 6520 636f 6e6e  wever,\nthe conn
-000063d0: 6563 7469 6f6e 206f 7074 696f 6e73 2075  ection options u
-000063e0: 7365 6420 6279 2074 6865 2063 6c69 656e  sed by the clien
-000063f0: 7420 7769 6c6c 2075 7365 2074 6865 2076  t will use the v
-00006400: 616c 7565 206f 6620 7468 6520 6669 7273  alue of the firs
-00006410: 7420 6669 656c 642e 2041 6c6c 5c6e 7468  t field. All\nth
-00006420: 6520 6f74 6865 7220 6669 656c 642d 7661  e other field-va
-00006430: 6c75 6573 2069 6e20 7468 6520 7175 6572  lues in the quer
-00006440: 7920 7374 7269 6e67 2077 6974 6820 7468  y string with th
-00006450: 6520 7361 6d65 2066 6965 6c64 206e 616d  e same field nam
-00006460: 6520 7769 6c6c 2062 6520 6967 6e6f 7265  e will be ignore
-00006470: 642e 5c6e 4669 656c 6473 2077 6974 686f  d.\nFields witho
-00006480: 7574 2076 616c 7565 7320 7769 6c6c 2061  ut values will a
-00006490: 6c73 6f20 6265 2069 676e 6f72 6564 2e5c  lso be ignored.\
-000064a0: 6e5c 6e49 6620 7468 6520 636c 6965 6e74  n\nIf the client
-000064b0: 5c27 7320 6e6f 6465 2070 7265 6665 7265  \'s node prefere
-000064c0: 6e63 6520 6973 2022 6c65 6164 6572 2220  nce is "leader" 
-000064d0: 616e 6420 7468 6520 6e6f 6465 2062 6563  and the node bec
-000064e0: 6f6d 6573 2061 5c6e 2266 6f6c 6c6f 7765  omes a\n"followe
-000064f0: 7222 2c20 7468 6520 636c 6965 6e74 2077  r", the client w
-00006500: 696c 6c20 6174 7465 6d70 7420 746f 2072  ill attempt to r
-00006510: 6563 6f6e 6e65 6374 2074 6f20 7468 6520  econnect to the 
-00006520: 6375 7272 656e 7420 6c65 6164 6572 2077  current leader w
-00006530: 6865 6e20 6120 6d65 7468 6f64 5c6e 6973  hen a method\nis
-00006540: 2063 616c 6c65 6420 7468 6174 2065 7870   called that exp
-00006550: 6563 7473 2074 6f20 6361 6c6c 2061 206c  ects to call a l
-00006560: 6561 6465 722e 204d 6574 686f 6473 2077  eader. Methods w
-00006570: 6869 6368 206d 7574 6174 6520 7468 6520  hich mutate the 
-00006580: 7374 6174 6520 6f66 2074 6865 2064 6174  state of the dat
-00006590: 6162 6173 655c 6e65 7870 6563 7420 746f  abase\nexpect to
-000065a0: 2063 616c 6c20 6120 6c65 6164 6572 2e20   call a leader. 
-000065b0: 466f 7220 7375 6368 206d 6574 686f 6473  For such methods
-000065c0: 2c20 7468 6520 4854 5450 2068 6561 6465  , the HTTP heade
-000065d0: 7220 2272 6571 7569 7265 732d 6c65 6164  r "requires-lead
-000065e0: 6572 2220 6973 2073 6574 2074 6f5c 6e22  er" is set to\n"
-000065f0: 7472 7565 222c 2061 6e64 2074 6869 7320  true", and this 
-00006600: 6865 6164 6572 2069 7320 6f62 7365 7276  header is observ
-00006610: 6564 2062 7920 7468 6520 7365 7276 6572  ed by the server
-00006620: 2c20 616e 6420 736f 2061 206e 6f64 6520  , and so a node 
-00006630: 7768 6963 6820 6973 206e 6f74 2061 206c  which is not a l
-00006640: 6561 6465 725c 6e74 6861 7420 7265 6365  eader\nthat rece
-00006650: 6976 6573 2073 7563 6820 6120 7265 7175  ives such a requ
-00006660: 6573 7420 7769 6c6c 2072 6574 7572 6e20  est will return 
-00006670: 616e 2065 7272 6f72 2e20 5468 6973 2065  an error. This e
-00006680: 7272 6f72 2069 7320 6465 7465 6374 6564  rror is detected
-00006690: 2062 7920 7468 6520 636c 6965 6e74 2c5c   by the client,\
-000066a0: 6e77 6869 6368 2077 696c 6c20 7468 656e  nwhich will then
-000066b0: 2063 6c6f 7365 2074 6865 2063 7572 7265   close the curre
-000066c0: 6e74 2067 5250 4320 636f 6e6e 6563 7469  nt gRPC connecti
-000066d0: 6f6e 2061 6e64 2063 7265 6174 6520 6120  on and create a 
-000066e0: 6e65 7720 636f 6e6e 6563 7469 6f6e 2074  new connection t
-000066f0: 6f20 7468 655c 6e6c 6561 6465 722e 2054  o the\nleader. T
-00006700: 6865 2072 6571 7565 7374 2077 696c 6c20  he request will 
-00006710: 7468 656e 2062 6520 7265 7472 6965 6420  then be retried 
-00006720: 7769 7468 2074 6865 206c 6561 6465 722e  with the leader.
-00006730: 5c6e 5c6e 4966 2074 6865 2063 6c69 656e  \n\nIf the clien
-00006740: 745c 2773 206e 6f64 6520 7072 6566 6572  t\'s node prefer
-00006750: 656e 6365 2069 7320 2266 6f6c 6c6f 7765  ence is "followe
-00006760: 7222 2061 6e64 2074 6865 7265 2061 7265  r" and there are
-00006770: 206e 6f20 666f 6c6c 6f77 6572 5c6e 6e6f   no follower\nno
-00006780: 6465 7320 696e 2074 6865 2063 6c75 7374  des in the clust
-00006790: 6572 2c20 7468 656e 2074 6865 2063 6c69  er, then the cli
-000067a0: 656e 7420 7769 6c6c 2072 6169 7365 2061  ent will raise a
-000067b0: 6e20 6578 6365 7074 696f 6e2e 2053 696d  n exception. Sim
-000067c0: 696c 6172 6c79 2c20 6966 2074 6865 5c6e  ilarly, if the\n
-000067d0: 636c 6965 6e74 5c27 7320 6e6f 6465 2070  client\'s node p
-000067e0: 7265 6665 7265 6e63 6520 6973 2022 7265  reference is "re
-000067f0: 6164 6f6e 6c79 7265 706c 6963 6122 2061  adonlyreplica" a
-00006800: 6e64 2074 6865 7265 2061 7265 206e 6f20  nd there are no 
-00006810: 7265 6164 2d6f 6e6c 7920 7265 706c 6963  read-only replic
-00006820: 615c 6e6e 6f64 6573 2069 6e20 7468 6520  a\nnodes in the 
-00006830: 636c 7573 7465 722c 2074 6865 6e20 7468  cluster, then th
-00006840: 6520 636c 6965 6e74 2077 696c 6c20 616c  e client will al
-00006850: 736f 2072 6169 7365 2061 6e20 6578 6365  so raise an exce
-00006860: 7074 696f 6e2e 5c6e 5c6e 5468 6520 6752  ption.\n\nThe gR
-00006870: 5043 2063 6861 6e6e 656c 206f 7074 696f  PC channel optio
-00006880: 6e20 2267 7270 632e 6d61 785f 7265 6365  n "grpc.max_rece
-00006890: 6976 655f 6d65 7373 6167 655f 6c65 6e67  ive_message_leng
-000068a0: 7468 2220 6973 2061 7574 6f6d 6174 6963  th" is automatic
-000068b0: 616c 6c79 5c6e 636f 6e66 6967 7572 6564  ally\nconfigured
-000068c0: 2074 6f20 7468 6520 7661 6c75 6520 6031   to the value `1
-000068d0: 3720 2a20 3130 3234 202a 2031 3032 3460  7 * 1024 * 1024`
-000068e0: 2e20 5468 6973 2076 616c 7565 2063 616e  . This value can
-000068f0: 6e6f 7420 6265 2063 6861 6e67 6564 2e5c  not be changed.\
-00006900: 6e5c 6e5c 6e23 2320 4576 656e 7420 6f62  n\n\n## Event ob
-00006910: 6a65 6374 735c 6e5c 6e54 6869 7320 7061  jects\n\nThis pa
-00006920: 636b 6167 6520 6465 6669 6e65 7320 6120  ckage defines a 
-00006930: 604e 6577 4576 656e 7460 2063 6c61 7373  `NewEvent` class
-00006940: 2061 6e64 2061 2060 5265 636f 7264 6564   and a `Recorded
-00006950: 4576 656e 7460 2063 6c61 7373 2e20 5468  Event` class. Th
-00006960: 655c 6e60 4e65 7745 7665 6e74 6020 636c  e\n`NewEvent` cl
-00006970: 6173 7320 7368 6f75 6c64 2062 6520 7573  ass should be us
-00006980: 6564 2077 6865 6e20 7772 6974 696e 6720  ed when writing 
-00006990: 6576 656e 7473 2074 6f20 7468 6520 6461  events to the da
-000069a0: 7461 6261 7365 2e20 5468 655c 6e60 5265  tabase. The\n`Re
-000069b0: 636f 7264 6564 4576 656e 7460 2063 6c61  cordedEvent` cla
-000069c0: 7373 2069 7320 7573 6564 2077 6865 6e20  ss is used when 
-000069d0: 7265 6164 696e 6720 6576 656e 7473 2066  reading events f
-000069e0: 726f 6d20 7468 6520 6461 7461 6261 7365  rom the database
-000069f0: 2e5c 6e5c 6e23 2323 204e 6577 2065 7665  .\n\n### New eve
-00006a00: 6e74 735c 6e5c 6e54 6865 2060 4e65 7745  nts\n\nThe `NewE
-00006a10: 7665 6e74 6020 636c 6173 7320 7368 6f75  vent` class shou
-00006a20: 6c64 2062 6520 7573 6564 2077 6865 6e20  ld be used when 
-00006a30: 7772 6974 696e 6720 6576 656e 7473 2074  writing events t
-00006a40: 6f20 616e 2045 7665 6e74 5374 6f72 6544  o an EventStoreD
-00006a50: 4220 6461 7461 6261 7365 2e5c 6e59 6f75  B database.\nYou
-00006a60: 2077 696c 6c20 6e65 6564 2074 6f20 636f   will need to co
-00006a70: 6e73 7472 7563 7420 6e65 7720 6576 656e  nstruct new even
-00006a80: 7420 6f62 6a65 6374 7320 6265 666f 7265  t objects before
-00006a90: 2063 616c 6c69 6e67 2060 6170 7065 6e64   calling `append
-00006aa0: 5f74 6f5f 7374 7265 616d 2829 602e 5c6e  _to_stream()`.\n
-00006ab0: 5c6e 5468 6520 604e 6577 4576 656e 7460  \nThe `NewEvent`
-00006ac0: 2063 6c61 7373 2069 7320 6120 6672 6f7a   class is a froz
-00006ad0: 656e 2050 7974 686f 6e20 6461 7461 636c  en Python datacl
-00006ae0: 6173 732e 2049 7420 6861 7320 7477 6f20  ass. It has two 
-00006af0: 7265 7175 6972 6564 2063 6f6e 7374 7275  required constru
-00006b00: 6374 6f72 5c6e 6172 6775 6d65 6e74 7320  ctor\narguments 
-00006b10: 2860 7479 7065 6020 616e 6420 6064 6174  (`type` and `dat
-00006b20: 6160 2920 616e 6420 7468 7265 6520 6f70  a`) and three op
-00006b30: 7469 6f6e 616c 2063 6f6e 7374 7275 6374  tional construct
-00006b40: 6f72 2061 7267 756d 656e 7473 2028 606d  or arguments (`m
-00006b50: 6574 6164 6174 6160 2c5c 6e60 636f 6e74  etadata`,\n`cont
-00006b60: 656e 745f 7479 7065 6020 616e 6420 6069  ent_type` and `i
-00006b70: 6460 292e 5c6e 5c6e 5468 6520 7265 7175  d`).\n\nThe requ
-00006b80: 6972 6564 2060 7479 7065 6020 6172 6775  ired `type` argu
-00006b90: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
-00006ba0: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
-00006bb0: 6465 7363 7269 6265 2074 6865 2074 7970  describe the typ
-00006bc0: 6520 6f66 5c6e 646f 6d61 696e 2065 7665  e of\ndomain eve
-00006bd0: 6e74 2074 6861 7420 6973 2062 6569 6e67  nt that is being
-00006be0: 2072 6563 6f72 6465 642e 5c6e 5c6e 5468   recorded.\n\nTh
-00006bf0: 6520 7265 7175 6972 6564 2060 6461 7461  e required `data
-00006c00: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-00006c10: 5079 7468 6f6e 2060 6279 7465 7360 206f  Python `bytes` o
-00006c20: 626a 6563 742c 2075 7365 6420 746f 2073  bject, used to s
-00006c30: 7461 7465 2074 6865 5c6e 7365 7269 616c  tate the\nserial
-00006c40: 697a 6564 2064 6174 6120 6f66 2074 6865  ized data of the
-00006c50: 2064 6f6d 6169 6e20 6576 656e 7420 7468   domain event th
-00006c60: 6174 2069 7320 6265 696e 6720 7265 636f  at is being reco
-00006c70: 7264 6564 2e5c 6e5c 6e54 6865 206f 7074  rded.\n\nThe opt
-00006c80: 696f 6e61 6c20 606d 6574 6164 6174 6160  ional `metadata`
-00006c90: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
-00006ca0: 7974 686f 6e20 6062 7974 6573 6020 6f62  ython `bytes` ob
-00006cb0: 6a65 6374 2c20 7573 6564 2074 6f20 696e  ject, used to in
-00006cc0: 6469 6361 7465 2061 6e79 5c6e 6d65 7461  dicate any\nmeta
-00006cd0: 6461 7461 206f 6620 7468 6520 6576 656e  data of the even
-00006ce0: 7420 7468 6174 2077 696c 6c20 6265 2072  t that will be r
-00006cf0: 6563 6f72 6465 642e 2054 6865 2064 6566  ecorded. The def
-00006d00: 6175 6c74 2076 616c 7565 2069 7320 616e  ault value is an
-00006d10: 2065 6d70 7479 2060 6279 7465 7360 5c6e   empty `bytes`\n
-00006d20: 6f62 6a65 6374 2e5c 6e5c 6e54 6865 206f  object.\n\nThe o
-00006d30: 7074 696f 6e61 6c20 6063 6f6e 7465 6e74  ptional `content
-00006d40: 5f74 7970 6560 2061 7267 756d 656e 7420  _type` argument 
-00006d50: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
-00006d60: 602c 2075 7365 6420 746f 2069 6e64 6963  `, used to indic
-00006d70: 6174 6520 7468 655c 6e6b 696e 6420 6f66  ate the\nkind of
-00006d80: 2064 6174 6120 7468 6174 2069 7320 6265   data that is be
-00006d90: 696e 6720 7265 636f 7264 6564 2e20 5468  ing recorded. Th
-00006da0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-00006db0: 6973 2060 5c27 6170 706c 6963 6174 696f  is `\'applicatio
-00006dc0: 6e2f 6a73 6f6e 5c27 602c 5c6e 7768 6963  n/json\'`,\nwhic
-00006dd0: 6820 696e 6469 6361 7465 7320 7468 6174  h indicates that
-00006de0: 2074 6865 2060 6461 7461 6020 7761 7320   the `data` was 
-00006df0: 7365 7269 616c 6973 6564 2075 7369 6e67  serialised using
-00006e00: 204a 534f 4e2e 2041 6e20 616c 7465 726e   JSON. An altern
-00006e10: 6174 6976 6520 7661 6c75 655c 6e66 6f72  ative value\nfor
-00006e20: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
-00006e30: 7320 7468 6520 6d6f 7265 2067 656e 6572  s the more gener
-00006e40: 616c 2069 6e64 6963 6174 696f 6e20 605c  al indication `\
-00006e50: 2761 7070 6c69 6361 7469 6f6e 2f6f 6374  'application/oct
-00006e60: 6574 2d73 7472 6561 6d5c 2760 2e5c 6e5c  et-stream\'`.\n\
-00006e70: 6e54 6865 206f 7074 696f 6e61 6c20 6069  nThe optional `i
-00006e80: 6460 2061 7267 756d 656e 7420 6973 2061  d` argument is a
-00006e90: 2050 7974 686f 6e20 6055 5549 4460 206f   Python `UUID` o
-00006ea0: 626a 6563 742c 2075 7365 6420 746f 2073  bject, used to s
-00006eb0: 7065 6369 6679 2074 6865 2075 6e69 7175  pecify the uniqu
-00006ec0: 6520 4944 5c6e 6f66 2074 6865 2065 7665  e ID\nof the eve
-00006ed0: 6e74 2074 6861 7420 7769 6c6c 2062 6520  nt that will be 
-00006ee0: 7265 636f 7264 6564 2e20 4966 206e 6f20  recorded. If no 
-00006ef0: 7661 6c75 6520 6973 2070 726f 7669 6465  value is provide
-00006f00: 642c 2061 206e 6577 2076 6572 7369 6f6e  d, a new version
-00006f10: 2d34 2055 5549 445c 6e77 696c 6c20 6265  -4 UUID\nwill be
-00006f20: 2067 656e 6572 6174 6564 2e5c 6e5c 6e60   generated.\n\n`
-00006f30: 6060 7079 7468 6f6e 5c6e 6e65 775f 6576  ``python\nnew_ev
-00006f40: 656e 7431 203d 204e 6577 4576 656e 7428  ent1 = NewEvent(
-00006f50: 5c6e 2020 2020 7479 7065 3d5c 274f 7264  \n    type=\'Ord
-00006f60: 6572 4372 6561 7465 645c 272c 5c6e 2020  erCreated\',\n  
-00006f70: 2020 6461 7461 3d62 5c27 7b22 6e61 6d65    data=b\'{"name
-00006f80: 223a 2022 4772 6567 227d 5c27 2c5c 6e29  ": "Greg"}\',\n)
-00006f90: 5c6e 6173 7365 7274 206e 6577 5f65 7665  \nassert new_eve
-00006fa0: 6e74 312e 7479 7065 203d 3d20 5c27 4f72  nt1.type == \'Or
-00006fb0: 6465 7243 7265 6174 6564 5c27 5c6e 6173  derCreated\'\nas
-00006fc0: 7365 7274 206e 6577 5f65 7665 6e74 312e  sert new_event1.
-00006fd0: 6461 7461 203d 3d20 625c 277b 226e 616d  data == b\'{"nam
-00006fe0: 6522 3a20 2247 7265 6722 7d5c 275c 6e61  e": "Greg"}\'\na
-00006ff0: 7373 6572 7420 6e65 775f 6576 656e 7431  ssert new_event1
-00007000: 2e6d 6574 6164 6174 6120 3d3d 2062 5c27  .metadata == b\'
-00007010: 5c27 5c6e 6173 7365 7274 206e 6577 5f65  \'\nassert new_e
-00007020: 7665 6e74 312e 636f 6e74 656e 745f 7479  vent1.content_ty
-00007030: 7065 203d 3d20 5c27 6170 706c 6963 6174  pe == \'applicat
-00007040: 696f 6e2f 6a73 6f6e 5c27 5c6e 6173 7365  ion/json\'\nasse
-00007050: 7274 2069 7369 6e73 7461 6e63 6528 6e65  rt isinstance(ne
-00007060: 775f 6576 656e 7431 2e69 642c 2075 7569  w_event1.id, uui
-00007070: 642e 5555 4944 295c 6e5c 6e65 7665 6e74  d.UUID)\n\nevent
-00007080: 5f69 6420 3d20 7575 6964 2e75 7569 6434  _id = uuid.uuid4
-00007090: 2829 5c6e 6e65 775f 6576 656e 7432 203d  ()\nnew_event2 =
-000070a0: 204e 6577 4576 656e 7428 5c6e 2020 2020   NewEvent(\n    
-000070b0: 7479 7065 3d5c 2749 6d61 6765 4372 6561  type=\'ImageCrea
-000070c0: 7465 645c 272c 5c6e 2020 2020 6461 7461  ted\',\n    data
-000070d0: 3d62 5c27 3031 3031 3031 3031 3031 3031  =b\'010101010101
-000070e0: 3031 5c27 2c5c 6e20 2020 206d 6574 6164  01\',\n    metad
-000070f0: 6174 613d 625c 277b 2261 223a 2031 7d5c  ata=b\'{"a": 1}\
-00007100: 272c 5c6e 2020 2020 636f 6e74 656e 745f  ',\n    content_
-00007110: 7479 7065 3d5c 2761 7070 6c69 6361 7469  type=\'applicati
-00007120: 6f6e 2f6f 6374 6574 2d73 7472 6561 6d5c  on/octet-stream\
-00007130: 272c 5c6e 2020 2020 6964 3d65 7665 6e74  ',\n    id=event
-00007140: 5f69 642c 5c6e 295c 6e61 7373 6572 7420  _id,\n)\nassert 
-00007150: 6e65 775f 6576 656e 7432 2e74 7970 6520  new_event2.type 
-00007160: 3d3d 205c 2749 6d61 6765 4372 6561 7465  == \'ImageCreate
-00007170: 645c 275c 6e61 7373 6572 7420 6e65 775f  d\'\nassert new_
-00007180: 6576 656e 7432 2e64 6174 6120 3d3d 2062  event2.data == b
-00007190: 5c27 3031 3031 3031 3031 3031 3031 3031  \'01010101010101
-000071a0: 5c27 5c6e 6173 7365 7274 206e 6577 5f65  \'\nassert new_e
-000071b0: 7665 6e74 322e 6d65 7461 6461 7461 203d  vent2.metadata =
-000071c0: 3d20 625c 277b 2261 223a 2031 7d5c 275c  = b\'{"a": 1}\'\
-000071d0: 6e61 7373 6572 7420 6e65 775f 6576 656e  nassert new_even
-000071e0: 7432 2e63 6f6e 7465 6e74 5f74 7970 6520  t2.content_type 
-000071f0: 3d3d 205c 2761 7070 6c69 6361 7469 6f6e  == \'application
-00007200: 2f6f 6374 6574 2d73 7472 6561 6d5c 275c  /octet-stream\'\
-00007210: 6e61 7373 6572 7420 6e65 775f 6576 656e  nassert new_even
-00007220: 7432 2e69 6420 3d3d 2065 7665 6e74 5f69  t2.id == event_i
-00007230: 645c 6e60 6060 5c6e 5c6e 2323 2320 5265  d\n```\n\n### Re
-00007240: 636f 7264 6564 2065 7665 6e74 735c 6e5c  corded events\n\
-00007250: 6e54 6865 2060 5265 636f 7264 6564 4576  nThe `RecordedEv
-00007260: 656e 7460 2063 6c61 7373 2069 7320 7573  ent` class is us
-00007270: 6564 2077 6865 6e20 7265 6164 696e 6720  ed when reading 
-00007280: 6576 656e 7473 2066 726f 6d20 616e 2045  events from an E
-00007290: 7665 6e74 5374 6f72 6544 425c 6e64 6174  ventStoreDB\ndat
-000072a0: 6162 6173 652e 2054 6865 2063 6c69 656e  abase. The clien
-000072b0: 7420 7769 6c6c 2072 6574 7572 6e20 6576  t will return ev
-000072c0: 656e 7420 6f62 6a65 6374 7320 6f66 2074  ent objects of t
-000072d0: 6869 7320 7479 7065 2066 726f 6d20 616c  his type from al
-000072e0: 6c20 6d65 7468 6f64 735c 6e74 6861 7420  l methods\nthat 
-000072f0: 7265 7475 726e 2072 6563 6f72 6465 6420  return recorded 
-00007300: 6576 656e 7473 2c20 7375 6368 2061 7320  events, such as 
-00007310: 6067 6574 5f73 7472 6561 6d28 2960 2c20  `get_stream()`, 
-00007320: 6073 7562 7363 7269 6265 5f74 6f5f 616c  `subscribe_to_al
-00007330: 6c28 2960 2c5c 6e61 6e64 2060 7265 6164  l()`,\nand `read
-00007340: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
-00007350: 5f61 6c6c 2829 602e 2059 6f75 2064 6f20  _all()`. You do 
-00007360: 6e6f 7420 6e65 6564 2074 6f20 636f 6e73  not need to cons
-00007370: 7472 7563 7420 7265 636f 7264 6564 2065  truct recorded e
-00007380: 7665 6e74 206f 626a 6563 7473 2e5c 6e5c  vent objects.\n\
-00007390: 6e4c 696b 6520 604e 6577 4576 656e 7460  nLike `NewEvent`
-000073a0: 2c20 7468 6520 6052 6563 6f72 6465 6445  , the `RecordedE
-000073b0: 7665 6e74 6020 636c 6173 7320 6973 2061  vent` class is a
-000073c0: 6c73 6f20 6120 6672 6f7a 656e 2050 7974  lso a frozen Pyt
-000073d0: 686f 6e20 6461 7461 636c 6173 732e 2049  hon dataclass. I
-000073e0: 7420 6861 735c 6e61 6c6c 2074 6865 2061  t has\nall the a
-000073f0: 7474 7269 6275 7465 7320 7468 6174 2060  ttributes that `
-00007400: 4e65 7745 7665 6e74 6020 6861 7320 2860  NewEvent` has (`
-00007410: 7479 7065 602c 2060 6461 7461 602c 2060  type`, `data`, `
-00007420: 6d65 7461 6461 7461 602c 2060 636f 6e74  metadata`, `cont
-00007430: 656e 745f 7479 7065 602c 2060 6964 6029  ent_type`, `id`)
-00007440: 5c6e 616e 6420 736f 6d65 2061 6464 6974  \nand some addit
-00007450: 696f 6e61 6c20 6174 7472 6962 7574 6573  ional attributes
-00007460: 2074 6861 7420 666f 6c6c 6f77 2066 726f   that follow fro
-00007470: 6d20 7468 6520 6661 6374 2074 6861 7420  m the fact that 
-00007480: 616e 2065 7665 6e74 2077 6173 2072 6563  an event was rec
-00007490: 6f72 6465 645c 6e28 6073 7472 6561 6d5f  orded\n(`stream_
-000074a0: 6e61 6d65 602c 2060 7374 7265 616d 5f70  name`, `stream_p
-000074b0: 6f73 6974 696f 6e60 2c20 6063 6f6d 6d69  osition`, `commi
-000074c0: 745f 706f 7369 7469 6f6e 6029 2e5c 6e5c  t_position`).\n\
-000074d0: 6e54 6865 2060 7479 7065 6020 6174 7472  nThe `type` attr
-000074e0: 6962 7574 6520 6973 2061 2050 7974 686f  ibute is a Pytho
-000074f0: 6e20 6073 7472 602c 2075 7365 6420 746f  n `str`, used to
-00007500: 2069 6e64 6963 6174 6520 7468 6520 7479   indicate the ty
-00007510: 7065 206f 6620 616e 2065 7665 6e74 5c6e  pe of an event\n
-00007520: 7468 6174 2077 6173 2072 6563 6f72 6465  that was recorde
-00007530: 642e 5c6e 5c6e 5468 6520 6064 6174 6160  d.\n\nThe `data`
-00007540: 2061 7474 7269 6275 7465 2069 7320 6120   attribute is a 
-00007550: 5079 7468 6f6e 2060 6279 7465 7360 206f  Python `bytes` o
-00007560: 626a 6563 742c 2075 7365 6420 746f 2069  bject, used to i
-00007570: 6e64 6963 6174 6520 7468 6520 6461 7461  ndicate the data
-00007580: 206f 6620 616e 5c6e 6576 656e 7420 7468   of an\nevent th
-00007590: 6174 2077 6173 2072 6563 6f72 6465 642e  at was recorded.
-000075a0: 5c6e 5c6e 5468 6520 606d 6574 6164 6174  \n\nThe `metadat
-000075b0: 6160 2061 7474 7269 6275 7465 2069 7320  a` attribute is 
-000075c0: 6120 5079 7468 6f6e 2060 6279 7465 7360  a Python `bytes`
-000075d0: 206f 626a 6563 742c 2075 7365 6420 746f   object, used to
-000075e0: 2069 6e64 6963 6174 6520 7468 6520 6d65   indicate the me
-000075f0: 7461 6461 7461 206f 665c 6e61 6e20 6576  tadata of\nan ev
-00007600: 656e 7420 7468 6174 2077 6173 2072 6563  ent that was rec
-00007610: 6f72 6465 642e 5c6e 5c6e 5468 6520 6063  orded.\n\nThe `c
-00007620: 6f6e 7465 6e74 5f74 7970 6560 2061 7474  ontent_type` att
-00007630: 7269 6275 7465 2069 7320 6120 5079 7468  ribute is a Pyth
-00007640: 6f6e 2060 7374 7260 2c20 7573 6564 2074  on `str`, used t
-00007650: 6f20 696e 6469 6361 7465 2074 6865 2074  o indicate the t
-00007660: 7970 6520 6f66 5c6e 6461 7461 2074 6861  ype of\ndata tha
-00007670: 7420 7761 7320 7265 636f 7264 6564 2066  t was recorded f
-00007680: 6f72 2061 6e20 6576 656e 742e 2049 7420  or an event. It 
-00007690: 6973 2075 7375 616c 6c79 2060 5c27 6170  is usually `\'ap
-000076a0: 706c 6963 6174 696f 6e2f 6a73 6f6e 5c27  plication/json\'
-000076b0: 602c 2069 6e64 6963 6174 696e 675c 6e74  `, indicating\nt
-000076c0: 6861 7420 7468 6520 6461 7461 2063 616e  hat the data can
-000076d0: 2062 6520 7061 7273 6564 2061 7320 4a53   be parsed as JS
-000076e0: 4f4e 2e20 416c 7465 726e 6174 6976 656c  ON. Alternativel
-000076f0: 792c 2069 7420 6973 2060 5c27 6170 706c  y, it is `\'appl
-00007700: 6963 6174 696f 6e2f 6f63 7465 742d 7374  ication/octet-st
-00007710: 7265 616d 5c27 602e 5c6e 5c6e 5468 6520  ream\'`.\n\nThe 
-00007720: 6069 6460 2061 7474 7269 6275 7465 2069  `id` attribute i
-00007730: 7320 6120 5079 7468 6f6e 2060 5555 4944  s a Python `UUID
-00007740: 6020 6f62 6a65 6374 2c20 7573 6564 2074  ` object, used t
-00007750: 6f20 696e 6469 6361 7465 2074 6865 2075  o indicate the u
-00007760: 6e69 7175 6520 4944 206f 6620 616e 5c6e  nique ID of an\n
-00007770: 6576 656e 7420 7468 6174 2077 6173 2072  event that was r
-00007780: 6563 6f72 6465 642e 5c6e 5c6e 5468 6520  ecorded.\n\nThe 
-00007790: 6073 7472 6561 6d5f 6e61 6d65 6020 6174  `stream_name` at
-000077a0: 7472 6962 7574 6520 6973 2061 2050 7974  tribute is a Pyt
-000077b0: 686f 6e20 6073 7472 602c 2075 7365 6420  hon `str`, used 
-000077c0: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
-000077d0: 6e61 6d65 206f 6620 615c 6e73 7472 6561  name of a\nstrea
-000077e0: 6d20 696e 2077 6869 6368 2061 6e20 6576  m in which an ev
-000077f0: 656e 7420 7761 7320 7265 636f 7264 6564  ent was recorded
-00007800: 2e5c 6e5c 6e54 6865 2060 7374 7265 616d  .\n\nThe `stream
-00007810: 5f70 6f73 6974 696f 6e60 2061 7474 7269  _position` attri
-00007820: 6275 7465 2069 7320 6120 5079 7468 6f6e  bute is a Python
-00007830: 2060 696e 7460 2c20 7573 6564 2074 6f20   `int`, used to 
-00007840: 696e 6469 6361 7465 2074 6865 2070 6f73  indicate the pos
-00007850: 6974 696f 6e20 696e 2061 5c6e 7374 7265  ition in a\nstre
-00007860: 616d 2061 7420 7768 6963 6820 616e 2065  am at which an e
-00007870: 7665 6e74 2077 6173 2072 6563 6f72 6465  vent was recorde
-00007880: 642e 5c6e 5c6e 496e 2045 7665 6e74 5374  d.\n\nIn EventSt
-00007890: 6f72 6544 422c 2061 2022 7374 7265 616d  oreDB, a "stream
-000078a0: 2070 6f73 6974 696f 6e22 2069 7320 616e   position" is an
-000078b0: 2069 6e74 6567 6572 2072 6570 7265 7365   integer represe
-000078c0: 6e74 696e 6720 7468 6520 706f 7369 7469  nting the positi
-000078d0: 6f6e 206f 6620 615c 6e72 6563 6f72 6465  on of a\nrecorde
-000078e0: 6420 6576 656e 7420 696e 2061 2073 7472  d event in a str
-000078f0: 6561 6d2e 2045 6163 6820 7265 636f 7264  eam. Each record
-00007900: 6564 2065 7665 6e74 2069 7320 7265 636f  ed event is reco
-00007910: 7264 6564 2061 7420 6120 706f 7369 7469  rded at a positi
-00007920: 6f6e 2069 6e20 6120 7374 7265 616d 2e5c  on in a stream.\
-00007930: 6e45 6163 6820 7374 7265 616d 2070 6f73  nEach stream pos
-00007940: 6974 696f 6e20 6973 206f 6363 7570 6965  ition is occupie
-00007950: 6420 6279 206f 6e6c 7920 6f6e 6520 7265  d by only one re
-00007960: 636f 7264 6564 2065 7665 6e74 2e20 4e65  corded event. Ne
-00007970: 7720 6576 656e 7473 2061 7265 2072 6563  w events are rec
-00007980: 6f72 6465 6420 6174 2074 6865 5c6e 6e65  orded at the\nne
-00007990: 7874 2075 6e6f 6363 7570 6965 6420 706f  xt unoccupied po
-000079a0: 7369 7469 6f6e 2e20 416c 6c20 7365 7175  sition. All sequ
-000079b0: 656e 6365 7320 6f66 2073 7472 6561 6d20  ences of stream 
-000079c0: 706f 7369 7469 6f6e 7320 6172 6520 7a65  positions are ze
-000079d0: 726f 2d62 6173 6564 2061 6e64 2067 6170  ro-based and gap
-000079e0: 6c65 7373 2e5c 6e5c 6e54 6865 2060 636f  less.\n\nThe `co
-000079f0: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
-00007a00: 7474 7269 6275 7465 2069 7320 6120 5079  ttribute is a Py
-00007a10: 7468 6f6e 2060 696e 7460 2c20 7573 6564  thon `int`, used
-00007a20: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
-00007a30: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
-00007a40: 5c6e 6461 7461 6261 7365 2061 7420 7768  \ndatabase at wh
-00007a50: 6963 6820 616e 2065 7665 6e74 2077 6173  ich an event was
-00007a60: 2072 6563 6f72 6465 642e 5c6e 5c6e 496e   recorded.\n\nIn
-00007a70: 2045 7665 6e74 5374 6f72 6544 422c 2061   EventStoreDB, a
-00007a80: 2022 636f 6d6d 6974 2070 6f73 6974 696f   "commit positio
-00007a90: 6e22 2069 7320 616e 2069 6e74 6567 6572  n" is an integer
-00007aa0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-00007ab0: 6520 706f 7369 7469 6f6e 206f 6620 615c  e position of a\
-00007ac0: 6e72 6563 6f72 6465 6420 6576 656e 7420  nrecorded event 
-00007ad0: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
-00007ae0: 2045 6163 6820 7265 636f 7264 6564 2065   Each recorded e
-00007af0: 7665 6e74 2069 7320 7265 636f 7264 6564  vent is recorded
-00007b00: 2061 7420 6120 706f 7369 7469 6f6e 2069   at a position i
-00007b10: 6e20 7468 655c 6e64 6174 6162 6173 652e  n the\ndatabase.
-00007b20: 2045 6163 6820 636f 6d6d 6974 2070 6f73   Each commit pos
-00007b30: 6974 696f 6e20 6973 206f 6363 7570 6965  ition is occupie
-00007b40: 6420 6279 206f 6e6c 7920 6f6e 6520 7265  d by only one re
-00007b50: 636f 7264 6564 2065 7665 6e74 2e20 436f  corded event. Co
-00007b60: 6d6d 6974 2070 6f73 6974 696f 6e73 5c6e  mmit positions\n
-00007b70: 6172 6520 7a65 726f 2d62 6173 6564 2061  are zero-based a
-00007b80: 6e64 2069 6e63 7265 6173 6520 6d6f 6e6f  nd increase mono
-00007b90: 746f 6e69 6361 6c6c 7920 6173 206e 6577  tonically as new
-00007ba0: 2065 7665 6e74 7320 6172 6520 7265 636f   events are reco
-00007bb0: 7264 6564 2e20 4275 742c 2075 6e6c 696b  rded. But, unlik
-00007bc0: 6520 7374 7265 616d 5c6e 706f 7369 7469  e stream\npositi
-00007bd0: 6f6e 732c 2074 6865 2073 6571 7565 6e63  ons, the sequenc
-00007be0: 6520 6f66 2073 7563 6365 7373 6976 6520  e of successive 
-00007bf0: 636f 6d6d 6974 2070 6f73 6974 696f 6e73  commit positions
-00007c00: 2069 7320 6e6f 7420 6761 706c 6573 732e   is not gapless.
-00007c10: 2049 6e64 6565 642c 2074 6865 7265 2061   Indeed, there a
-00007c20: 7265 5c6e 7573 7561 6c6c 7920 6c61 7267  re\nusually larg
-00007c30: 6520 6469 6666 6572 656e 6365 7320 6265  e differences be
-00007c40: 7477 6565 6e20 7468 6520 636f 6d6d 6974  tween the commit
-00007c50: 2070 6f73 6974 696f 6e73 206f 6620 7375   positions of su
-00007c60: 6363 6573 7369 7665 6c79 2072 6563 6f72  ccessively recor
-00007c70: 6465 6420 6576 656e 7473 2e5c 6e5c 6e50  ded events.\n\nP
-00007c80: 6c65 6173 6520 6e6f 7465 2c20 696e 2045  lease note, in E
-00007c90: 7665 6e74 5374 6f72 6544 4220 3231 2e31  ventStoreDB 21.1
-00007ca0: 302c 2074 6865 2060 636f 6d6d 6974 5f70  0, the `commit_p
-00007cb0: 6f73 6974 696f 6e60 206f 6620 616c 6c20  osition` of all 
-00007cc0: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
-00007cd0: 6f62 6a65 6374 735c 6e6f 6274 6169 6e65  objects\nobtaine
-00007ce0: 6420 6672 6f6d 2060 7265 6164 5f73 7472  d from `read_str
-00007cf0: 6561 6d28 2960 2069 7320 604e 6f6e 6560  eam()` is `None`
-00007d00: 2c20 7768 6572 6561 7320 7468 6f73 6520  , whereas those 
-00007d10: 6f62 7461 696e 6564 2066 726f 6d20 6072  obtained from `r
-00007d20: 6561 645f 616c 6c28 2960 2068 6176 655c  ead_all()` have\
-00007d30: 6e74 6865 2061 6374 7561 6c20 636f 6d6d  nthe actual comm
-00007d40: 6974 2070 6f73 6974 696f 6e20 6f66 2074  it position of t
-00007d50: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-00007d60: 742e 2054 6869 7320 7761 7320 6368 616e  t. This was chan
-00007d70: 6765 6420 696e 2076 6572 7369 6f6e 2032  ged in version 2
-00007d80: 322e 3130 2c20 736f 5c6e 7468 6174 2065  2.10, so\nthat e
-00007d90: 7665 6e74 206f 626a 6563 7473 206f 6274  vent objects obt
-00007da0: 6169 6e65 6420 6672 6f6d 2062 6f74 6820  ained from both 
-00007db0: 6067 6574 5f73 7472 6561 6d28 2960 2061  `get_stream()` a
-00007dc0: 6e64 2060 7265 6164 5f61 6c6c 2829 6020  nd `read_all()` 
-00007dd0: 6861 7665 2074 6865 2061 6374 7561 6c5c  have the actual\
-00007de0: 6e63 6f6d 6d69 7420 706f 7369 7469 6f6e  ncommit position
-00007df0: 2e20 5468 6520 6063 6f6d 6d69 745f 706f  . The `commit_po
-00007e00: 7369 7469 6f6e 6020 6174 7472 6962 7574  sition` attribut
-00007e10: 6520 6f66 2074 6865 2060 5265 636f 7264  e of the `Record
-00007e20: 6564 4576 656e 7460 2063 6c61 7373 2069  edEvent` class i
-00007e30: 735c 6e61 6e6e 6f74 6174 6564 2077 6974  s\nannotated wit
-00007e40: 6820 7468 6520 7479 7065 2060 4f70 7469  h the type `Opti
-00007e50: 6f6e 616c 5b69 6e74 5d60 2066 6f72 2074  onal[int]` for t
-00007e60: 6869 7320 7265 6173 6f6e 206f 6e6c 792e  his reason only.
-00007e70: 5c6e 5c6e 5c6e 6060 6070 7974 686f 6e5c  \n\n\n```python\
-00007e80: 6e66 726f 6d20 6573 6462 636c 6965 6e74  nfrom esdbclient
-00007e90: 2e65 7665 6e74 7320 696d 706f 7274 2052  .events import R
-00007ea0: 6563 6f72 6465 6445 7665 6e74 5c6e 5c6e  ecordedEvent\n\n
-00007eb0: 7265 636f 7264 6564 5f65 7665 6e74 203d  recorded_event =
-00007ec0: 2052 6563 6f72 6465 6445 7665 6e74 285c   RecordedEvent(\
-00007ed0: 6e20 2020 2074 7970 653d 5c27 4f72 6465  n    type=\'Orde
-00007ee0: 7243 7265 6174 6564 5c27 2c5c 6e20 2020  rCreated\',\n   
-00007ef0: 2064 6174 613d 625c 277b 7d5c 272c 5c6e   data=b\'{}\',\n
-00007f00: 2020 2020 6d65 7461 6461 7461 3d62 5c27      metadata=b\'
-00007f10: 5c27 2c5c 6e20 2020 2063 6f6e 7465 6e74  \',\n    content
-00007f20: 5f74 7970 653d 5c27 6170 706c 6963 6174  _type=\'applicat
-00007f30: 696f 6e2f 6a73 6f6e 5c27 2c5c 6e20 2020  ion/json\',\n   
-00007f40: 2069 643d 7575 6964 2e75 7569 6434 2829   id=uuid.uuid4()
-00007f50: 2c5c 6e20 2020 2073 7472 6561 6d5f 6e61  ,\n    stream_na
-00007f60: 6d65 3d5c 2773 7472 6561 6d31 5c27 2c5c  me=\'stream1\',\
-00007f70: 6e20 2020 2073 7472 6561 6d5f 706f 7369  n    stream_posi
-00007f80: 7469 6f6e 3d30 2c5c 6e20 2020 2063 6f6d  tion=0,\n    com
-00007f90: 6d69 745f 706f 7369 7469 6f6e 3d35 3132  mit_position=512
-00007fa0: 2c5c 6e29 5c6e 6060 605c 6e5c 6e5c 6e23  ,\n)\n```\n\n\n#
-00007fb0: 2320 5374 7265 616d 735c 6e5c 6e49 6e20  # Streams\n\nIn 
-00007fc0: 4576 656e 7453 746f 7265 4442 2c20 6120  EventStoreDB, a 
-00007fd0: 2273 7472 6561 6d22 2069 7320 6120 7365  "stream" is a se
-00007fe0: 7175 656e 6365 206f 6620 7265 636f 7264  quence of record
-00007ff0: 6564 2065 7665 6e74 7320 7468 6174 2061  ed events that a
-00008000: 6c6c 2068 6176 655c 6e74 6865 2073 616d  ll have\nthe sam
-00008010: 6520 2273 7472 6561 6d20 6e61 6d65 222e  e "stream name".
-00008020: 2054 6865 7265 2077 696c 6c20 6e6f 726d   There will norm
-00008030: 616c 6c79 2062 6520 6d61 6e79 2073 7472  ally be many str
-00008040: 6561 6d73 2069 6e20 6120 6461 7461 6261  eams in a databa
-00008050: 7365 2c5c 6e65 6163 6820 7769 7468 206d  se,\neach with m
-00008060: 616e 7920 7265 636f 7264 6564 2065 7665  any recorded eve
-00008070: 6e74 732e 2045 6163 6820 7265 636f 7264  nts. Each record
-00008080: 6564 2065 7665 6e74 2068 6173 2061 2070  ed event has a p
-00008090: 6f73 6974 696f 6e20 696e 2069 7473 2073  osition in its s
-000080a0: 7472 6561 6d5c 6e28 7468 6520 2273 7472  tream\n(the "str
-000080b0: 6561 6d20 706f 7369 7469 6f6e 2229 2c20  eam position"), 
-000080c0: 616e 6420 6120 706f 7369 7469 6f6e 2069  and a position i
-000080d0: 6e20 7468 6520 6461 7461 6261 7365 2028  n the database (
-000080e0: 7468 6520 2263 6f6d 6d69 7420 706f 7369  the "commit posi
-000080f0: 7469 6f6e 2229 2e5c 6e53 7472 6561 6d20  tion").\nStream 
-00008100: 706f 7369 7469 6f6e 7320 6172 6520 7a65  positions are ze
-00008110: 726f 2d62 6173 6564 2061 6e64 2067 6170  ro-based and gap
-00008120: 6c65 7373 2e20 436f 6d6d 6974 2070 6f73  less. Commit pos
-00008130: 6974 696f 6e73 2061 7265 2061 6c73 6f20  itions are also 
-00008140: 7a65 726f 2d62 6173 6564 2c5c 6e62 7574  zero-based,\nbut
-00008150: 2061 7265 206e 6f74 2067 6170 6c65 7373   are not gapless
-00008160: 2e5c 6e5c 6e54 6865 206d 6574 686f 6473  .\n\nThe methods
-00008170: 2060 6170 7065 6e64 5f74 6f5f 7374 7265   `append_to_stre
-00008180: 616d 2829 602c 2060 6765 745f 7374 7265  am()`, `get_stre
-00008190: 616d 2829 6020 616e 6420 6072 6561 645f  am()` and `read_
-000081a0: 616c 6c28 2960 2063 616e 5c6e 6265 2075  all()` can\nbe u
-000081b0: 7365 6420 746f 2072 6561 6420 616e 6420  sed to read and 
-000081c0: 7265 636f 7264 2069 6e20 7468 6520 6461  record in the da
-000081d0: 7461 6261 7365 2e5c 6e5c 6e23 2323 2041  tabase.\n\n### A
-000081e0: 7070 656e 6420 6576 656e 7473 5c6e 5c6e  ppend events\n\n
-000081f0: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
-00008200: 2a5c 6e5c 6e54 6865 2060 6170 7065 6e64  *\n\nThe `append
-00008210: 5f74 6f5f 7374 7265 616d 2829 6020 6d65  _to_stream()` me
-00008220: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00008230: 2061 746f 6d69 6361 6c6c 7920 746f 2072   atomically to r
-00008240: 6563 6f72 6420 6120 7365 7175 656e 6365  ecord a sequence
-00008250: 206f 6620 6e65 7720 6576 656e 7473 2e5c   of new events.\
-00008260: 6e49 6620 7468 6520 6f70 6572 6174 696f  nIf the operatio
-00008270: 6e20 6973 2073 7563 6365 7373 6675 6c2c  n is successful,
-00008280: 2069 7420 7265 7475 726e 7320 7468 6520   it returns the 
-00008290: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-000082a0: 6f66 2074 6865 206c 6173 7420 6576 656e  of the last even
-000082b0: 7420 696e 2074 6865 5c6e 7365 7175 656e  t in the\nsequen
-000082c0: 6365 2074 6861 7420 6861 7320 6265 656e  ce that has been
-000082d0: 2072 6563 6f72 6465 642e 5c6e 5c6e 5468   recorded.\n\nTh
-000082e0: 6973 206d 6574 686f 6420 6861 7320 7468  is method has th
-000082f0: 7265 6520 7265 7175 6972 6564 2061 7267  ree required arg
-00008300: 756d 656e 7473 2c20 6073 7472 6561 6d5f  uments, `stream_
-00008310: 6e61 6d65 602c 2060 6375 7272 656e 745f  name`, `current_
-00008320: 7665 7273 696f 6e60 5c6e 616e 6420 6065  version`\nand `e
-00008330: 7665 6e74 7360 2e5c 6e5c 6e54 6865 2072  vents`.\n\nThe r
-00008340: 6571 7569 7265 6420 6073 7472 6561 6d5f  equired `stream_
-00008350: 6e61 6d65 6020 6172 6775 6d65 6e74 2069  name` argument i
-00008360: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
-00008370: 2074 6861 7420 756e 6971 7565 6c79 2069   that uniquely i
-00008380: 6465 6e74 6966 6965 7320 615c 6e73 7472  dentifies a\nstr
-00008390: 6561 6d20 746f 2077 6869 6368 2061 2073  eam to which a s
-000083a0: 6571 7565 6e63 6520 6f66 2065 7665 6e74  equence of event
-000083b0: 7320 7769 6c6c 2062 6520 6170 7065 6e64  s will be append
-000083c0: 6564 2e5c 6e5c 6e54 6865 2072 6571 7569  ed.\n\nThe requi
-000083d0: 7265 6420 6063 7572 7265 6e74 5f76 6572  red `current_ver
-000083e0: 7369 6f6e 6020 6172 6775 6d65 6e74 2069  sion` argument i
-000083f0: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
-00008400: 2065 6974 6865 7220 6120 5079 7468 6f6e   either a Python
-00008410: 2060 696e 7460 5c6e 7468 6174 2069 6e64   `int`\nthat ind
-00008420: 6963 6174 6573 2074 6865 2073 7472 6561  icates the strea
-00008430: 6d20 706f 7369 7469 6f6e 206f 6620 7468  m position of th
-00008440: 6520 6c61 7374 2072 6563 6f72 6465 6420  e last recorded 
-00008450: 6576 656e 7420 696e 2074 6865 2073 7472  event in the str
-00008460: 6561 6d2c 206f 725c 6e60 5374 7265 616d  eam, or\n`Stream
-00008470: 5374 6174 652e 4e4f 5f53 5452 4541 4d60  State.NO_STREAM`
-00008480: 2069 6620 7468 6520 7374 7265 616d 2064   if the stream d
-00008490: 6f65 7320 6e6f 7420 7965 7420 6578 6973  oes not yet exis
-000084a0: 7420 6f72 2068 6173 2062 6565 6e20 6465  t or has been de
-000084b0: 6c65 7465 642e 2054 6865 5c6e 7374 7265  leted. The\nstre
-000084c0: 616d 2070 6f73 6974 696f 6e73 2061 7265  am positions are
-000084d0: 207a 6572 6f2d 6261 7365 6420 616e 6420   zero-based and 
-000084e0: 6761 706c 6573 732c 2073 6f20 7468 6174  gapless, so that
-000084f0: 2069 6620 6120 7374 7265 616d 2068 6173   if a stream has
-00008500: 2074 776f 2065 7665 6e74 732c 2074 6865   two events, the
-00008510: 5c6e 6063 7572 7265 6e74 5f76 6572 7369  \n`current_versi
-00008520: 6f6e 6020 7368 6f75 6c64 2062 6520 312e  on` should be 1.
-00008530: 2049 6620 616e 2069 6e63 6f72 7265 6374   If an incorrect
-00008540: 2076 616c 7565 2069 7320 6769 7665 6e2c   value is given,
-00008550: 2074 6869 7320 6d65 7468 6f64 2077 696c   this method wil
-00008560: 6c20 7261 6973 6520 615c 6e60 5772 6f6e  l raise a\n`Wron
-00008570: 6743 7572 7265 6e74 5665 7273 696f 6e60  gCurrentVersion`
-00008580: 2065 7863 6570 7469 6f6e 2e20 5468 6973   exception. This
-00008590: 2062 6568 6176 696f 7220 6973 2064 6573   behavior is des
-000085a0: 6967 6e65 6420 746f 2070 726f 7669 6465  igned to provide
-000085b0: 2063 6f6e 6375 7272 656e 6379 5c6e 636f   concurrency\nco
-000085c0: 6e74 726f 6c20 7768 656e 2072 6563 6f72  ntrol when recor
-000085d0: 6469 6e67 206e 6577 2065 7665 6e74 732e  ding new events.
-000085e0: 2054 6865 2063 6f72 7265 6374 2076 616c   The correct val
-000085f0: 7565 206f 6620 6063 7572 7265 6e74 5f76  ue of `current_v
-00008600: 6572 7369 6f6e 6020 666f 7220 616e 7920  ersion` for any 
-00008610: 7374 7265 616d 5c6e 6361 6e20 6265 206f  stream\ncan be o
-00008620: 6274 6169 6e65 6420 6279 2063 616c 6c69  btained by calli
-00008630: 6e67 2060 6765 745f 6375 7272 656e 745f  ng `get_current_
-00008640: 7665 7273 696f 6e28 2960 2e20 486f 7765  version()`. Howe
-00008650: 7665 722c 2074 6865 2074 7970 6963 616c  ver, the typical
-00008660: 2061 7070 726f 6163 6820 6973 2074 6f5c   approach is to\
-00008670: 6e72 6563 6f6e 7374 7275 6374 2061 6e20  nreconstruct an 
-00008680: 6167 6772 6567 6174 6520 6672 6f6d 2074  aggregate from t
-00008690: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-000086a0: 7473 2c20 736f 2074 6861 7420 7468 6520  ts, so that the 
-000086b0: 7665 7273 696f 6e20 6f66 2074 6865 2061  version of the a
-000086c0: 6767 7265 6761 7465 5c6e 6973 2074 6865  ggregate\nis the
-000086d0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-000086e0: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
-000086f0: 6f72 6465 6420 6576 656e 742c 2074 6865  orded event, the
-00008700: 6e20 6861 7665 2074 6865 2061 6767 7265  n have the aggre
-00008710: 6761 7465 2067 656e 6572 6174 6520 6e65  gate generate ne
-00008720: 775c 6e65 7665 6e74 732c 2061 6e64 2074  w\nevents, and t
-00008730: 6865 6e20 7573 6520 7468 6520 6375 7272  hen use the curr
-00008740: 656e 7420 7665 7273 696f 6e20 6f66 2074  ent version of t
-00008750: 6865 2061 6767 7265 6761 7465 2061 7320  he aggregate as 
-00008760: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
-00008770: 5c6e 6063 7572 7265 6e74 5f76 6572 7369  \n`current_versi
-00008780: 6f6e 6020 6172 6775 6d65 6e74 2077 6865  on` argument whe
-00008790: 6e20 6170 7065 6e64 696e 6720 7468 6520  n appending the 
-000087a0: 6e65 7720 6167 6772 6567 6174 6520 6576  new aggregate ev
-000087b0: 656e 7473 2e20 5468 6973 2065 6e73 7572  ents. This ensur
-000087c0: 6573 5c6e 7468 6520 636f 6e73 6973 7465  es\nthe consiste
-000087d0: 6e63 7920 6f66 2074 6865 2072 6563 6f72  ncy of the recor
-000087e0: 6465 6420 6167 6772 6567 6174 6520 6576  ded aggregate ev
-000087f0: 656e 7473 2c20 6265 6361 7573 6520 6f70  ents, because op
-00008800: 6572 6174 696f 6e73 2074 6861 7420 6765  erations that ge
-00008810: 6e65 7261 7465 5c6e 6e65 7720 6167 6772  nerate\nnew aggr
-00008820: 6567 6174 6520 6576 656e 7473 2063 616e  egate events can
-00008830: 2062 6520 7265 7472 6965 6420 7769 7468   be retried with
-00008840: 2061 2066 7265 7368 6c79 2072 6563 6f6e   a freshly recon
-00008850: 7374 7275 6374 6564 2061 6767 7265 6761  structed aggrega
-00008860: 7465 2069 665c 6e61 2060 5772 6f6e 6743  te if\na `WrongC
-00008870: 7572 7265 6e74 5665 7273 696f 6e60 2065  urrentVersion` e
-00008880: 7863 6570 7469 6f6e 2069 7320 656e 636f  xception is enco
-00008890: 756e 7465 7265 6420 7768 656e 2072 6563  untered when rec
-000088a0: 6f72 6469 6e67 206e 6577 2065 7665 6e74  ording new event
-000088b0: 732e 2054 6869 735c 6e63 6f6e 7472 6f6c  s. This\ncontrol
-000088c0: 6c69 6e67 2062 6568 6176 696f 7220 6361  ling behavior ca
-000088d0: 6e20 6265 2064 6973 6162 6c65 6420 6279  n be disabled by
-000088e0: 2073 6574 7469 6e67 2074 6865 2076 616c   setting the val
-000088f0: 7565 206f 6620 7468 6520 6063 7572 7265  ue of the `curre
-00008900: 6e74 5f76 6572 7369 6f6e 605c 6e61 7267  nt_version`\narg
-00008910: 756d 656e 7420 746f 2074 6865 2063 6f6e  ument to the con
-00008920: 7374 616e 7420 6053 7472 6561 6d53 7461  stant `StreamSta
-00008930: 7465 2e41 4e59 602e 5c6e 5c6e 5468 6520  te.ANY`.\n\nThe 
-00008940: 7265 7175 6972 6564 2060 6576 656e 7473  required `events
-00008950: 6020 6172 6775 6d65 6e74 2069 7320 6578  ` argument is ex
-00008960: 7065 6374 6564 2074 6f20 6265 2061 2073  pected to be a s
-00008970: 6571 7565 6e63 6520 6f66 206e 6577 2065  equence of new e
-00008980: 7665 6e74 206f 626a 6563 7473 2e20 5468  vent objects. Th
-00008990: 655c 6e60 4e65 7745 7665 6e74 6020 636c  e\n`NewEvent` cl
-000089a0: 6173 7320 7368 6f75 6c64 2062 6520 7573  ass should be us
-000089b0: 6564 2074 6f20 636f 6e73 7472 7563 7420  ed to construct 
-000089c0: 6e65 7720 6576 656e 7420 6f62 6a65 6374  new event object
-000089d0: 732e 2054 6865 2060 6170 7065 6e64 5f74  s. The `append_t
-000089e0: 6f5f 7374 7265 616d 2829 605c 6e6f 7065  o_stream()`\nope
-000089f0: 7261 7469 6f6e 2069 7320 6174 6f6d 6963  ration is atomic
-00008a00: 2c20 736f 2074 6861 7420 6569 7468 6572  , so that either
-00008a10: 2061 6c6c 206f 7220 6e6f 6e65 206f 6620   all or none of 
-00008a20: 7468 6520 6e65 7720 6576 656e 7473 2077  the new events w
-00008a30: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
-00008a40: 2049 745c 6e69 7320 6e6f 7420 706f 7373   It\nis not poss
-00008a50: 6962 6c65 2077 6974 6820 4576 656e 7453  ible with EventS
-00008a60: 746f 7265 4442 2061 746f 6d69 6361 6c6c  toreDB atomicall
-00008a70: 7920 746f 2072 6563 6f72 6420 6e65 7720  y to record new 
-00008a80: 6576 656e 7473 2069 6e20 6d6f 7265 2074  events in more t
-00008a90: 6861 6e20 6f6e 6520 7374 7265 616d 2e5c  han one stream.\
-00008aa0: 6e5c 6e54 6869 7320 6d65 7468 6f64 2061  n\nThis method a
-00008ab0: 6c73 6f20 6861 7320 616e 206f 7074 696f  lso has an optio
-00008ac0: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
-00008ad0: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
-00008ae0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-00008af0: 605c 6e74 6861 7420 7365 7473 2061 2064  `\nthat sets a d
-00008b00: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-00008b10: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-00008b20: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-00008b30: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
-00008b40: 2061 6c73 6f20 6861 7320 616e 206f 7074   also has an opt
-00008b50: 696f 6e61 6c20 6063 7265 6465 6e74 6961  ional `credentia
-00008b60: 6c73 6020 6172 6775 6d65 6e74 2c20 7768  ls` argument, wh
-00008b70: 6963 6820 6361 6e20 6265 2075 7365 6420  ich can be used 
-00008b80: 746f 5c6e 6f76 6572 7269 6465 2063 616c  to\noverride cal
-00008b90: 6c20 6372 6564 656e 7469 616c 7320 6465  l credentials de
-00008ba0: 7269 7665 6420 6672 6f6d 2074 6865 2063  rived from the c
-00008bb0: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-00008bc0: 2055 5249 2e5c 6e5c 6e49 6e20 7468 6520   URI.\n\nIn the 
-00008bd0: 6578 616d 706c 6520 6265 6c6f 772c 2061  example below, a
-00008be0: 206e 6577 2065 7665 6e74 2c20 6065 7665   new event, `eve
-00008bf0: 6e74 3160 2c20 6973 2061 7070 656e 6465  nt1`, is appende
-00008c00: 6420 746f 2061 206e 6577 2073 7472 6561  d to a new strea
-00008c10: 6d2e 2054 6865 2073 7472 6561 6d5c 6e64  m. The stream\nd
-00008c20: 6f65 7320 6e6f 7420 7965 7420 6578 6973  oes not yet exis
-00008c30: 742c 2073 6f20 6063 7572 7265 6e74 5f76  t, so `current_v
-00008c40: 6572 7369 6f6e 6020 6973 2060 5374 7265  ersion` is `Stre
-00008c50: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
-00008c60: 4d60 2e5c 6e5c 6e60 6060 7079 7468 6f6e  M`.\n\n```python
-00008c70: 5c6e 2320 436f 6e73 7472 7563 7420 6120  \n# Construct a 
-00008c80: 6e65 7720 6576 656e 7420 6f62 6a65 6374  new event object
-00008c90: 2e5c 6e65 7665 6e74 3120 3d20 4e65 7745  .\nevent1 = NewE
-00008ca0: 7665 6e74 2874 7970 653d 5c27 4f72 6465  vent(type=\'Orde
-00008cb0: 7243 7265 6174 6564 5c27 2c20 6461 7461  rCreated\', data
-00008cc0: 3d62 5c27 6461 7461 315c 2729 5c6e 5c6e  =b\'data1\')\n\n
-00008cd0: 2320 4465 6669 6e65 2061 206e 6577 2073  # Define a new s
-00008ce0: 7472 6561 6d20 6e61 6d65 2e5c 6e73 7472  tream name.\nstr
-00008cf0: 6561 6d5f 6e61 6d65 3120 3d20 7374 7228  eam_name1 = str(
-00008d00: 7575 6964 2e75 7569 6434 2829 295c 6e5c  uuid.uuid4())\n\
-00008d10: 6e23 2041 7070 656e 6420 7468 6520 6e65  n# Append the ne
-00008d20: 7720 6576 656e 7473 2074 6f20 7468 6520  w events to the 
-00008d30: 6e65 7720 7374 7265 616d 2e5c 6e63 6f6d  new stream.\ncom
-00008d40: 6d69 745f 706f 7369 7469 6f6e 3120 3d20  mit_position1 = 
-00008d50: 636c 6965 6e74 2e61 7070 656e 645f 746f  client.append_to
-00008d60: 5f73 7472 6561 6d28 5c6e 2020 2020 7374  _stream(\n    st
-00008d70: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00008d80: 5f6e 616d 6531 2c5c 6e20 2020 2063 7572  _name1,\n    cur
-00008d90: 7265 6e74 5f76 6572 7369 6f6e 3d53 7472  rent_version=Str
-00008da0: 6561 6d53 7461 7465 2e4e 4f5f 5354 5245  eamState.NO_STRE
-00008db0: 414d 2c5c 6e20 2020 2065 7665 6e74 733d  AM,\n    events=
-00008dc0: 5b65 7665 6e74 315d 2c5c 6e29 5c6e 6060  [event1],\n)\n``
-00008dd0: 605c 6e5c 6e49 6e20 7468 6520 6578 616d  `\n\nIn the exam
-00008de0: 706c 6520 6265 6c6f 772c 2074 776f 2073  ple below, two s
-00008df0: 7562 7365 7175 656e 7420 6576 656e 7473  ubsequent events
-00008e00: 2061 7265 2061 7070 656e 6465 6420 746f   are appended to
-00008e10: 2061 6e20 6578 6973 7469 6e67 5c6e 7374   an existing\nst
-00008e20: 7265 616d 2e20 5468 6520 7374 7265 616d  ream. The stream
-00008e30: 2068 6173 206f 6e65 2072 6563 6f72 6465   has one recorde
-00008e40: 6420 6576 656e 742c 2073 6f20 6063 7572  d event, so `cur
-00008e50: 7265 6e74 5f76 6572 7369 6f6e 6020 6973  rent_version` is
-00008e60: 2060 3060 2e5c 6e5c 6e60 6060 7079 7468   `0`.\n\n```pyth
-00008e70: 6f6e 5c6e 6576 656e 7432 203d 204e 6577  on\nevent2 = New
-00008e80: 4576 656e 7428 7479 7065 3d5c 274f 7264  Event(type=\'Ord
-00008e90: 6572 5570 6461 7465 645c 272c 2064 6174  erUpdated\', dat
-00008ea0: 613d 625c 2764 6174 6132 5c27 295c 6e65  a=b\'data2\')\ne
-00008eb0: 7665 6e74 3320 3d20 4e65 7745 7665 6e74  vent3 = NewEvent
-00008ec0: 2874 7970 653d 5c27 4f72 6465 7244 656c  (type=\'OrderDel
-00008ed0: 6574 6564 5c27 2c20 6461 7461 3d62 5c27  eted\', data=b\'
-00008ee0: 6461 7461 335c 2729 5c6e 5c6e 636f 6d6d  data3\')\n\ncomm
-00008ef0: 6974 5f70 6f73 6974 696f 6e32 203d 2063  it_position2 = c
-00008f00: 6c69 656e 742e 6170 7065 6e64 5f74 6f5f  lient.append_to_
-00008f10: 7374 7265 616d 285c 6e20 2020 2073 7472  stream(\n    str
-00008f20: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00008f30: 6e61 6d65 312c 5c6e 2020 2020 6375 7272  name1,\n    curr
-00008f40: 656e 745f 7665 7273 696f 6e3d 302c 5c6e  ent_version=0,\n
-00008f50: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
-00008f60: 7432 2c20 6576 656e 7433 5d2c 5c6e 295c  t2, event3],\n)\
-00008f70: 6e60 6060 5c6e 5c6e 5468 6520 7265 7475  n```\n\nThe retu
-00008f80: 726e 6564 2076 616c 7565 732c 2060 636f  rned values, `co
-00008f90: 6d6d 6974 5f70 6f73 6974 696f 6e31 6020  mmit_position1` 
-00008fa0: 616e 6420 6063 6f6d 6d69 745f 706f 7369  and `commit_posi
-00008fb0: 7469 6f6e 3260 2c20 6172 6520 7468 655c  tion2`, are the\
-00008fc0: 6e63 6f6d 6d69 7420 706f 7369 7469 6f6e  ncommit position
-00008fd0: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
-00008fe0: 6520 6f66 2074 6865 206c 6173 7420 6576  e of the last ev
-00008ff0: 656e 7473 2069 6e20 7468 6520 7265 636f  ents in the reco
-00009000: 7264 6564 2073 6571 7565 6e63 6573 2e5c  rded sequences.\
-00009010: 6e54 6861 7420 6973 2c20 6063 6f6d 6d69  nThat is, `commi
-00009020: 745f 706f 7369 7469 6f6e 3160 2069 7320  t_position1` is 
-00009030: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
-00009040: 696f 6e20 6f66 2060 6576 656e 7431 6020  ion of `event1` 
-00009050: 616e 645c 6e60 636f 6d6d 6974 5f70 6f73  and\n`commit_pos
-00009060: 6974 696f 6e32 6020 6973 2074 6865 2063  ition2` is the c
-00009070: 6f6d 6d69 7420 706f 7369 7469 6f6e 206f  ommit position o
-00009080: 6620 6065 7665 6e74 3360 2e5c 6e5c 6e43  f `event3`.\n\nC
-00009090: 6f6d 6d69 7420 706f 7369 7469 6f6e 7320  ommit positions 
-000090a0: 7468 6174 2061 7265 2072 6574 7572 6e65  that are returne
-000090b0: 6420 696e 2074 6869 7320 7761 7920 6361  d in this way ca
-000090c0: 6e20 6265 2075 7365 6420 6279 2061 2075  n be used by a u
-000090d0: 7365 7220 696e 7465 7266 6163 6520 746f  ser interface to
-000090e0: 2070 6f6c 6c5c 6e61 2064 6f77 6e73 7472   poll\na downstr
-000090f0: 6561 6d20 636f 6d70 6f6e 656e 7420 756e  eam component un
-00009100: 7469 6c20 6974 2068 6173 2070 726f 6365  til it has proce
-00009110: 7373 6564 2061 6c6c 2074 6865 206e 6577  ssed all the new
-00009120: 6c79 2072 6563 6f72 6465 6420 6576 656e  ly recorded even
-00009130: 7473 2e20 466f 7220 6578 616d 706c 652c  ts. For example,
-00009140: 5c6e 636f 6e73 6964 6572 2061 2075 7365  \nconsider a use
-00009150: 7220 696e 7465 7266 6163 6520 636f 6d6d  r interface comm
-00009160: 616e 6420 7468 6174 2072 6573 756c 7473  and that results
-00009170: 2069 6e20 7468 6520 7265 636f 7264 696e   in the recordin
-00009180: 6720 6f66 206e 6577 2065 7665 6e74 732c  g of new events,
-00009190: 2061 6e64 2061 6e5c 6e65 7665 6e74 7561   and an\neventua
-000091a0: 6c6c 7920 636f 6e73 6973 7465 6e74 206d  lly consistent m
-000091b0: 6174 6572 6961 6c69 7a65 6420 7669 6577  aterialized view
-000091c0: 2069 6e20 6120 646f 776e 7374 7265 616d   in a downstream
-000091d0: 2063 6f6d 706f 6e65 6e74 2074 6861 7420   component that 
-000091e0: 6973 2075 7064 6174 6564 2066 726f 6d5c  is updated from\
-000091f0: 6e74 6865 7365 2065 7665 6e74 732e 2049  nthese events. I
-00009200: 6620 7468 6520 6e65 7720 6576 656e 7473  f the new events
-00009210: 2068 6176 6520 6e6f 7420 7965 7420 6265   have not yet be
-00009220: 656e 2070 726f 6365 7373 6564 2c20 7468  en processed, th
-00009230: 6520 7669 6577 206d 6967 6874 2062 6520  e view might be 
-00009240: 7374 616c 652c 5c6e 6f72 206f 7574 2d6f  stale,\nor out-o
-00009250: 662d 6461 7465 2e20 496e 7374 6561 6420  f-date. Instead 
-00009260: 6f66 2064 6973 706c 6179 696e 6720 6120  of displaying a 
-00009270: 7374 616c 6520 7669 6577 2c20 7468 6520  stale view, the 
-00009280: 7573 6572 2069 6e74 6572 6661 6365 2063  user interface c
-00009290: 616e 2070 6f6c 6c20 7468 655c 6e64 6f77  an poll the\ndow
-000092a0: 6e73 7472 6561 6d20 636f 6d70 6f6e 656e  nstream componen
-000092b0: 7420 756e 7469 6c20 6974 2068 6173 2070  t until it has p
-000092c0: 726f 6365 7373 6564 2074 6865 206e 6577  rocessed the new
-000092d0: 6c79 2072 6563 6f72 6465 6420 6576 656e  ly recorded even
-000092e0: 7473 2c20 616e 6420 7468 656e 2064 6973  ts, and then dis
-000092f0: 706c 6179 5c6e 616e 2075 702d 746f 2d64  play\nan up-to-d
-00009300: 6174 6520 7669 6577 2074 6f20 7468 6520  ate view to the 
-00009310: 7573 6572 2e5c 6e5c 6e5c 6e23 2323 2049  user.\n\n\n### I
-00009320: 6465 6d70 6f74 656e 7420 6170 7065 6e64  dempotent append
-00009330: 206f 7065 7261 7469 6f6e 735c 6e5c 6e54   operations\n\nT
-00009340: 6865 2060 6170 7065 6e64 5f74 6f5f 7374  he `append_to_st
-00009350: 7265 616d 2829 6020 6d65 7468 6f64 2069  ream()` method i
-00009360: 7320 2269 6465 6d70 6f74 656e 7422 2c20  s "idempotent", 
-00009370: 696e 2074 6861 7420 6966 2063 616c 6c65  in that if calle
-00009380: 6420 7769 7468 206e 6577 2065 7665 6e74  d with new event
-00009390: 7320 7768 6f73 655c 6e60 6964 6020 6174  s whose\n`id` at
-000093a0: 7472 6962 7574 6520 7661 6c75 6573 2065  tribute values e
-000093b0: 7175 616c 2074 686f 7365 206f 6620 7265  qual those of re
-000093c0: 636f 7264 6564 2065 7665 6e74 7320 696e  corded events in
-000093d0: 2074 6865 206e 616d 6564 2073 7472 6561   the named strea
-000093e0: 6d20 696d 6d65 6469 6174 656c 795c 6e61  m immediately\na
-000093f0: 6674 6572 2074 6865 2073 7472 6561 6d20  fter the stream 
-00009400: 706f 7369 7469 6f6e 2073 7065 6369 6669  position specifi
-00009410: 6564 2062 7920 7468 6520 7661 6c75 6520  ed by the value 
-00009420: 6f66 2074 6865 2060 6375 7272 656e 745f  of the `current_
-00009430: 7665 7273 696f 6e60 2061 7267 756d 656e  version` argumen
-00009440: 742c 2074 6865 6e5c 6e69 7420 7769 6c6c  t, then\nit will
-00009450: 2072 6574 7572 6e20 7468 6520 636f 6d6d   return the comm
-00009460: 6974 2070 6f73 6974 696f 6e20 6f66 2074  it position of t
-00009470: 6865 206c 6173 7420 6e65 7720 6576 656e  he last new even
-00009480: 742c 2077 6974 686f 7574 206d 616b 696e  t, without makin
-00009490: 6720 616e 7920 6368 616e 6765 7320 746f  g any changes to
-000094a0: 5c6e 7468 6520 6461 7461 6261 7365 2e5c  \nthe database.\
-000094b0: 6e5c 6e53 6f6d 6574 696d 6573 2069 7420  n\nSometimes it 
-000094c0: 6d61 7920 6861 7070 656e 2c20 7768 656e  may happen, when
-000094d0: 2063 616c 6c69 6e67 2060 6170 7065 6e64   calling `append
-000094e0: 5f74 6f5f 7374 7265 616d 2829 602c 2074  _to_stream()`, t
-000094f0: 6861 7420 7468 6520 6e65 7720 6576 656e  hat the new even
-00009500: 7473 2061 7265 5c6e 7375 6363 6573 7366  ts are\nsuccessf
-00009510: 756c 6c79 2072 6563 6f72 6465 6420 6275  ully recorded bu
-00009520: 7420 736f 6d65 686f 7720 6120 636f 6e6e  t somehow a conn
-00009530: 6563 7469 6f6e 2069 7373 7565 206f 6363  ection issue occ
-00009540: 7572 7320 6265 666f 7265 2074 6865 2073  urs before the s
-00009550: 7563 6365 7373 6675 6c20 6361 6c6c 5c6e  uccessful call\n
-00009560: 6361 6e20 7265 7475 726e 2073 7563 6365  can return succe
-00009570: 7373 6675 6c6c 7920 746f 2074 6865 2063  ssfully to the c
-00009580: 6c69 656e 742e 2057 6520 6361 6e6e 6f74  lient. We cannot
-00009590: 2062 6520 7375 7265 2069 6620 7468 6520   be sure if the 
-000095a0: 6576 656e 7473 2077 6572 6520 7265 636f  events were reco
-000095b0: 7264 6564 5c6e 6f72 206e 6f74 2c20 616e  rded\nor not, an
-000095c0: 6420 736f 2077 6520 6d61 7920 7769 7368  d so we may wish
-000095d0: 2074 6f20 7265 7472 792e 2049 6620 7468   to retry. If th
-000095e0: 6520 6576 656e 7473 2077 6572 6520 696e  e events were in
-000095f0: 2066 6163 7420 7375 6363 6573 7366 756c   fact successful
-00009600: 6c79 2072 6563 6f72 6465 642c 5c6e 6974  ly recorded,\nit
-00009610: 2069 7320 636f 6e76 656e 6965 6e74 2066   is convenient f
-00009620: 6f72 2074 6865 2072 6574 7269 6564 206f  or the retried o
-00009630: 7065 7261 7469 6f6e 2074 6f20 7265 7475  peration to retu
-00009640: 726e 2073 7563 6365 7373 6675 6c6c 7920  rn successfully 
-00009650: 7769 7468 6f75 7420 7261 6973 696e 6720  without raising 
-00009660: 616e 5c6e 6578 6365 7074 696f 6e2e 2049  an\nexception. I
-00009670: 6620 7468 6f73 6520 6e65 7720 6576 656e  f those new even
-00009680: 7473 2077 6572 6520 696e 2066 6163 7420  ts were in fact 
-00009690: 6e6f 7420 7265 636f 7264 6564 2c20 616e  not recorded, an
-000096a0: 6420 696e 2074 6865 206d 6561 6e74 696d  d in the meantim
-000096b0: 6520 6e6f 206f 7468 6572 5c6e 6e65 7720  e no other\nnew 
-000096c0: 6576 656e 7473 2077 6572 6520 7265 636f  events were reco
-000096d0: 7264 6564 2069 6e20 7468 6174 2073 7472  rded in that str
-000096e0: 6561 6d2c 2074 6865 6e20 6974 206d 616b  eam, then it mak
-000096f0: 6573 2073 656e 7365 2074 6861 7420 7468  es sense that th
-00009700: 6520 6e65 7720 6576 656e 7473 2077 696c  e new events wil
-00009710: 6c5c 6e62 6520 7265 636f 7264 6564 2077  l\nbe recorded w
-00009720: 6865 6e20 7468 6520 6170 7065 6e64 206f  hen the append o
-00009730: 7065 7261 7469 6f6e 2069 7320 7265 7472  peration is retr
-00009740: 6965 642e 204f 6620 636f 7572 7365 2c20  ied. Of course, 
-00009750: 6966 2061 2060 5772 6f6e 6743 7572 7265  if a `WrongCurre
-00009760: 6e74 5665 7273 696f 6e60 5c6e 6578 6365  ntVersion`\nexce
-00009770: 7074 696f 6e20 6973 2072 6169 7365 6420  ption is raised 
-00009780: 7768 656e 2072 6574 7279 696e 6720 7468  when retrying th
-00009790: 6520 6f70 6572 6174 696f 6e2c 2074 6865  e operation, the
-000097a0: 6e20 616e 2061 7070 6c69 6361 7469 6f6e  n an application
-000097b0: 2063 6f6d 6d61 6e64 2077 6869 6368 5c6e   command which\n
-000097c0: 6765 6e65 7261 7465 6420 7468 6520 6e65  generated the ne
-000097d0: 7720 6576 656e 7473 2069 6e20 7468 6520  w events in the 
-000097e0: 636f 6e74 6578 7420 6f66 2061 6c72 6561  context of alrea
-000097f0: 6479 2072 6563 6f72 6465 6420 6576 656e  dy recorded even
-00009800: 7473 206d 6179 206e 6565 6420 746f 2062  ts may need to b
-00009810: 655c 6e65 7865 6375 7465 6420 6167 6169  e\nexecuted agai
-00009820: 6e2e 2041 6c74 6572 6e61 7469 7665 6c79  n. Alternatively
-00009830: 2c20 6120 7375 6974 6162 6c65 2065 7272  , a suitable err
-00009840: 6f72 206d 6967 6874 2062 6520 6469 7370  or might be disp
-00009850: 6c61 7965 6420 6279 2074 6865 2061 7070  layed by the app
-00009860: 6c69 6361 7469 6f6e 2c5c 6e77 6974 6820  lication,\nwith 
-00009870: 616e 2075 702d 746f 2d64 6174 6520 7669  an up-to-date vi
-00009880: 6577 206f 6620 7468 6520 7265 636f 7264  ew of the record
-00009890: 6564 2064 6174 612c 2067 6976 696e 6720  ed data, giving 
-000098a0: 6120 7573 6572 206f 6620 7468 6520 6170  a user of the ap
-000098b0: 706c 6963 6174 696f 6e20 616e 5c6e 6f70  plication an\nop
-000098c0: 706f 7274 756e 6974 7920 746f 2064 6563  portunity to dec
-000098d0: 6964 6520 6966 2074 6865 7920 7374 696c  ide if they stil
-000098e0: 6c20 7769 7368 2074 6f20 7072 6f63 6565  l wish to procee
-000098f0: 6420 7769 7468 2074 6865 6972 206f 7269  d with their ori
-00009900: 6769 6e61 6c20 696e 7465 6e74 696f 6e2e  ginal intention.
-00009910: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-00009920: 6265 6c6f 7720 7368 6f77 7320 7468 6520  below shows the 
-00009930: 6061 7070 656e 645f 746f 5f73 7472 6561  `append_to_strea
-00009940: 6d28 2960 206d 6574 686f 6420 6265 696e  m()` method bein
-00009950: 6720 6361 6c6c 6564 2061 6761 696e 2077  g called again w
-00009960: 6974 685c 6e60 6576 656e 7433 6020 616e  ith\n`event3` an
-00009970: 6420 6063 7572 7265 6e74 5f76 6572 7369  d `current_versi
-00009980: 6f6e 3d30 602e 2057 6520 6361 6e20 7365  on=0`. We can se
-00009990: 6520 7468 6174 2072 6570 6561 7469 6e67  e that repeating
-000099a0: 2074 6865 2063 616c 6c20 746f 5c6e 6061   the call to\n`a
-000099b0: 7070 656e 645f 746f 5f73 7472 6561 6d28  ppend_to_stream(
-000099c0: 2960 2072 6574 7572 6e73 2073 7563 6365  )` returns succe
-000099d0: 7373 6675 6c6c 792e 5c6e 5c6e 6060 6070  ssfully.\n\n```p
-000099e0: 7974 686f 6e5c 6e23 2052 6574 7279 2061  ython\n# Retry a
-000099f0: 7070 656e 6469 6e67 2065 7665 6e74 332e  ppending event3.
-00009a00: 5c6e 636f 6d6d 6974 5f70 6f73 6974 696f  \ncommit_positio
-00009a10: 6e5f 7265 7472 7920 3d20 636c 6965 6e74  n_retry = client
-00009a20: 2e61 7070 656e 645f 746f 5f73 7472 6561  .append_to_strea
-00009a30: 6d28 5c6e 2020 2020 7374 7265 616d 5f6e  m(\n    stream_n
-00009a40: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
-00009a50: 2c5c 6e20 2020 2063 7572 7265 6e74 5f76  ,\n    current_v
-00009a60: 6572 7369 6f6e 3d30 2c5c 6e20 2020 2065  ersion=0,\n    e
-00009a70: 7665 6e74 733d 5b65 7665 6e74 322c 2065  vents=[event2, e
-00009a80: 7665 6e74 335d 2c5c 6e29 5c6e 6060 605c  vent3],\n)\n```\
-00009a90: 6e5c 6e57 6520 6361 6e20 7365 6520 7468  n\nWe can see th
-00009aa0: 6174 2074 6865 2073 616d 6520 636f 6d6d  at the same comm
-00009ab0: 6974 2070 6f73 6974 696f 6e20 6973 2072  it position is r
-00009ac0: 6574 7572 6e65 6420 6173 2061 626f 7665  eturned as above
-00009ad0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-00009ae0: 6173 7365 7274 2063 6f6d 6d69 745f 706f  assert commit_po
-00009af0: 7369 7469 6f6e 5f72 6574 7279 203d 3d20  sition_retry == 
-00009b00: 636f 6d6d 6974 5f70 6f73 6974 696f 6e32  commit_position2
-00009b10: 5c6e 6060 605c 6e5c 6e42 7920 6361 6c6c  \n```\n\nBy call
-00009b20: 696e 6720 6067 6574 5f73 7472 6561 6d28  ing `get_stream(
-00009b30: 2960 2c20 7765 2063 616e 2061 6c73 6f20  )`, we can also 
-00009b40: 7365 6520 7468 6520 7374 7265 616d 2068  see the stream h
-00009b50: 6173 2062 6565 6e20 756e 6368 616e 6765  as been unchange
-00009b60: 645c 6e64 6573 7069 7465 2074 6865 2060  d\ndespite the `
-00009b70: 6170 7065 6e64 5f74 6f5f 7374 7265 616d  append_to_stream
-00009b80: 2829 6020 6d65 7468 6f64 2068 6176 696e  ()` method havin
-00009b90: 6720 6265 656e 2063 616c 6c65 6420 7477  g been called tw
-00009ba0: 6963 6520 7769 7468 2074 6865 2073 616d  ice with the sam
-00009bb0: 6520 6172 6775 6d65 6e74 732e 5c6e 5468  e arguments.\nTh
-00009bc0: 6174 2069 732c 2074 6865 7265 2061 7265  at is, there are
-00009bd0: 2073 7469 6c6c 206f 6e6c 7920 7468 7265   still only thre
-00009be0: 6520 6576 656e 7473 2069 6e20 7468 6520  e events in the 
-00009bf0: 7374 7265 616d 2e5c 6e5c 6e60 6060 7079  stream.\n\n```py
-00009c00: 7468 6f6e 5c6e 6576 656e 7473 203d 2063  thon\nevents = c
-00009c10: 6c69 656e 742e 6765 745f 7374 7265 616d  lient.get_stream
-00009c20: 285c 6e20 2020 2073 7472 6561 6d5f 6e61  (\n    stream_na
-00009c30: 6d65 3d73 7472 6561 6d5f 6e61 6d65 315c  me=stream_name1\
-00009c40: 6e29 5c6e 5c6e 6173 7365 7274 206c 656e  n)\n\nassert len
-00009c50: 2865 7665 6e74 7329 203d 3d20 335c 6e60  (events) == 3\n`
-00009c60: 6060 5c6e 5c6e 5468 6973 2069 6465 6d70  ``\n\nThis idemp
-00009c70: 6f74 656e 7420 6265 6861 7669 6f75 7220  otent behaviour 
-00009c80: 6465 7065 6e64 7320 6f6e 2074 6865 2060  depends on the `
-00009c90: 6964 6020 6174 7472 6962 7574 6520 6f66  id` attribute of
-00009ca0: 2074 6865 2060 4e65 7745 7665 6e74 6020   the `NewEvent` 
-00009cb0: 636c 6173 732e 5c6e 5468 6973 2061 7474  class.\nThis att
-00009cc0: 7269 6275 7465 2c20 6279 2064 6566 6175  ribute, by defau
-00009cd0: 6c74 2c20 6973 2061 7373 6967 6e65 6420  lt, is assigned 
-00009ce0: 6120 6e65 7720 616e 6420 756e 6971 7565  a new and unique
-00009cf0: 2076 6572 7369 6f6e 2d34 2055 5549 4420   version-4 UUID 
-00009d00: 7768 656e 2061 6e5c 6e69 6e73 7461 6e63  when an\ninstanc
-00009d10: 6520 6f66 2060 4e65 7745 7665 6e74 6020  e of `NewEvent` 
-00009d20: 6973 2063 6f6e 7374 7275 6374 6564 2e20  is constructed. 
-00009d30: 5468 6520 6069 6460 2061 7267 756d 656e  The `id` argumen
-00009d40: 7420 6361 6e20 6265 2075 7365 6420 7768  t can be used wh
-00009d50: 656e 5c6e 636f 6e73 7472 7563 7469 6e67  en\nconstructing
-00009d60: 2060 4e65 7745 7665 6e74 6020 6f62 6a65   `NewEvent` obje
-00009d70: 6374 7320 746f 2073 6574 2074 6865 2076  cts to set the v
-00009d80: 616c 7565 206f 6620 7468 6973 2061 7474  alue of this att
-00009d90: 7269 6275 7465 2e5c 6e5c 6e5c 6e23 2323  ribute.\n\n\n###
-00009da0: 2052 6561 6420 7374 7265 616d 2065 7665   Read stream eve
-00009db0: 6e74 735c 6e5c 6e54 6865 2060 7265 6164  nts\n\nThe `read
-00009dc0: 5f73 7472 6561 6d28 2960 206d 6574 686f  _stream()` metho
-00009dd0: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
-00009de0: 2067 6574 2065 7665 6e74 7320 7468 6174   get events that
-00009df0: 2068 6176 6520 6265 656e 2061 7070 656e   have been appen
-00009e00: 6465 645c 6e74 6f20 6120 7374 7265 616d  ded\nto a stream
-00009e10: 2e20 5468 6973 206d 6574 686f 6420 7265  . This method re
-00009e20: 7475 726e 7320 6120 2272 6561 6420 7265  turns a "read re
-00009e30: 7370 6f6e 7365 2220 6f62 6a65 6374 2e5c  sponse" object.\
-00009e40: 6e5c 6e41 2022 7265 6164 2072 6573 706f  n\nA "read respo
-00009e50: 6e73 6522 206f 626a 6563 7420 6973 2061  nse" object is a
-00009e60: 2050 7974 686f 6e20 6974 6572 6174 6f72   Python iterator
-00009e70: 2e20 5265 636f 7264 6564 2065 7665 6e74  . Recorded event
-00009e80: 7320 6361 6e20 6265 5c6e 6f62 7461 696e  s can be\nobtain
-00009e90: 6564 2062 7920 6974 6572 6174 696e 6720  ed by iterating 
-00009ea0: 6f76 6572 2074 6865 2022 7265 6164 2072  over the "read r
-00009eb0: 6573 706f 6e73 6522 206f 626a 6563 742e  esponse" object.
-00009ec0: 2052 6563 6f72 6465 6420 6576 656e 7473   Recorded events
-00009ed0: 2061 7265 5c6e 7374 7265 616d 6564 2066   are\nstreamed f
-00009ee0: 726f 6d20 7468 6520 7365 7276 6572 2074  rom the server t
-00009ef0: 6f20 7468 6520 636c 6965 6e74 2061 7320  o the client as 
-00009f00: 7468 6520 6974 6572 6174 696f 6e20 7072  the iteration pr
-00009f10: 6f63 6565 6473 2e20 5468 6520 6974 6572  oceeds. The iter
-00009f20: 6174 696f 6e5c 6e77 696c 6c20 6175 746f  ation\nwill auto
-00009f30: 6d61 7469 6361 6c6c 7920 7374 6f70 2077  matically stop w
-00009f40: 6865 6e20 7468 6572 6520 6172 6520 6e6f  hen there are no
-00009f50: 206d 6f72 6520 7265 636f 7264 6564 2065   more recorded e
-00009f60: 7665 6e74 7320 746f 2062 6520 7265 7475  vents to be retu
-00009f70: 726e 6564 2e5c 6e54 6865 2073 7472 6561  rned.\nThe strea
-00009f80: 6d69 6e67 206f 6620 6576 656e 7473 2c20  ming of events, 
-00009f90: 616e 6420 6865 6e63 6520 7468 6520 6974  and hence the it
-00009fa0: 6572 6174 6f72 2c20 6361 6e20 616c 736f  erator, can also
-00009fb0: 2062 6520 7374 6f70 7065 6420 6279 2063   be stopped by c
-00009fc0: 616c 6c69 6e67 5c6e 7468 6520 6073 746f  alling\nthe `sto
-00009fd0: 7028 2960 206d 6574 686f 6420 6f6e 2074  p()` method on t
-00009fe0: 6865 2022 7265 6164 2072 6573 706f 6e73  he "read respons
-00009ff0: 6522 206f 626a 6563 742e 5c6e 5c6e 5468  e" object.\n\nTh
-0000a000: 6520 6067 6574 5f73 7472 6561 6d28 2960  e `get_stream()`
-0000a010: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
-0000a020: 7365 6420 746f 2067 6574 2065 7665 6e74  sed to get event
-0000a030: 7320 7468 6174 2068 6176 6520 6265 656e  s that have been
-0000a040: 2061 7070 656e 6465 645c 6e74 6f20 6120   appended\nto a 
-0000a050: 7374 7265 616d 2e20 5468 6973 206d 6574  stream. This met
-0000a060: 686f 6420 7265 7475 726e 7320 6120 5079  hod returns a Py
-0000a070: 7468 6f6e 2060 7475 706c 6560 206f 6620  thon `tuple` of 
-0000a080: 7265 636f 7264 6564 2065 7665 6e74 206f  recorded event o
-0000a090: 626a 6563 7473 2e5c 6e54 6865 2072 6563  bjects.\nThe rec
-0000a0a0: 6f72 6465 6420 6576 656e 7420 6f62 6a65  orded event obje
-0000a0b0: 6374 7320 6172 6520 696e 7374 616e 6365  cts are instance
-0000a0c0: 7320 6f66 2074 6865 2060 5265 636f 7264  s of the `Record
-0000a0d0: 6564 4576 656e 7460 2063 6c61 7373 2e20  edEvent` class. 
-0000a0e0: 4974 5c6e 6361 6c6c 7320 6072 6561 645f  It\ncalls `read_
-0000a0f0: 7374 7265 616d 2829 6020 616e 6420 7061  stream()` and pa
-0000a100: 7373 6573 2074 6865 2022 7265 6164 2072  sses the "read r
-0000a110: 6573 706f 6e73 6522 2069 7465 7261 746f  esponse" iterato
-0000a120: 7220 696e 746f 2061 2050 7974 686f 6e5c  r into a Python\
-0000a130: 6e60 7475 706c 6560 2c20 736f 2074 6861  n`tuple`, so tha
-0000a140: 7420 7468 6520 7374 7265 616d 696e 6720  t the streaming 
-0000a150: 7769 6c6c 2063 6f6d 706c 6574 6520 6265  will complete be
-0000a160: 666f 7265 2074 6865 206d 6574 686f 6420  fore the method 
-0000a170: 7265 7475 726e 732e 5c6e 5c6e 5468 6520  returns.\n\nThe 
-0000a180: 6072 6561 645f 7374 7265 616d 2829 6020  `read_stream()` 
-0000a190: 616e 6420 6067 6574 5f73 7472 6561 6d28  and `get_stream(
-0000a1a0: 2960 206d 6574 686f 6473 2068 6176 6520  )` methods have 
-0000a1b0: 6f6e 6520 7265 7175 6972 6564 2061 7267  one required arg
-0000a1c0: 756d 656e 742c 2060 7374 7265 616d 5f6e  ument, `stream_n
-0000a1d0: 616d 6560 2e5c 6e5c 6e54 6865 2072 6571  ame`.\n\nThe req
-0000a1e0: 7569 7265 6420 6073 7472 6561 6d5f 6e61  uired `stream_na
-0000a1f0: 6d65 6020 6172 6775 6d65 6e74 2069 7320  me` argument is 
-0000a200: 6120 5079 7468 6f6e 2060 7374 7260 2074  a Python `str` t
-0000a210: 6861 7420 756e 6971 7565 6c79 2069 6465  hat uniquely ide
-0000a220: 6e74 6966 6965 7320 615c 6e73 7472 6561  ntifies a\nstrea
-0000a230: 6d20 6672 6f6d 2077 6869 6368 2072 6563  m from which rec
-0000a240: 6f72 6465 6420 6576 656e 7473 2077 696c  orded events wil
-0000a250: 6c20 6265 2072 6574 7572 6e65 642e 5c6e  l be returned.\n
-0000a260: 5c6e 5468 6520 6072 6561 645f 7374 7265  \nThe `read_stre
-0000a270: 616d 2829 6020 616e 6420 6067 6574 5f73  am()` and `get_s
-0000a280: 7472 6561 6d28 2960 206d 6574 686f 6473  tream()` methods
-0000a290: 2061 6c73 6f20 6861 7665 2066 6976 6520   also have five 
-0000a2a0: 6f70 7469 6f6e 616c 2061 7267 756d 656e  optional argumen
-0000a2b0: 7473 2c5c 6e60 7374 7265 616d 5f70 6f73  ts,\n`stream_pos
-0000a2c0: 6974 696f 6e60 2c20 6062 6163 6b77 6172  ition`, `backwar
-0000a2d0: 6473 602c 2060 7265 736f 6c76 655f 6c69  ds`, `resolve_li
-0000a2e0: 6e6b 7360 2c20 606c 696d 6974 602c 2061  nks`, `limit`, a
-0000a2f0: 6e64 2060 7469 6d65 6f75 7460 2e5c 6e5c  nd `timeout`.\n\
-0000a300: 6e54 6865 206f 7074 696f 6e61 6c20 6073  nThe optional `s
-0000a310: 7472 6561 6d5f 706f 7369 7469 6f6e 6020  tream_position` 
-0000a320: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-0000a330: 7468 6f6e 2060 696e 7460 2074 6861 7420  thon `int` that 
-0000a340: 6361 6e20 6265 2075 7365 6420 746f 5c6e  can be used to\n
-0000a350: 696e 6469 6361 7465 2074 6865 2070 6f73  indicate the pos
-0000a360: 6974 696f 6e20 696e 2074 6865 2073 7472  ition in the str
-0000a370: 6561 6d20 6672 6f6d 2077 6869 6368 2074  eam from which t
-0000a380: 6f20 7374 6172 7420 7265 6164 696e 672e  o start reading.
-0000a390: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
-0000a3a0: 7565 5c6e 6f66 2060 7374 7265 616d 5f70  ue\nof `stream_p
-0000a3b0: 6f73 6974 696f 6e60 2069 7320 604e 6f6e  osition` is `Non
-0000a3c0: 6560 2e20 5768 656e 2072 6561 6469 6e67  e`. When reading
-0000a3d0: 2061 2073 7472 6561 6d20 6672 6f6d 2061   a stream from a
-0000a3e0: 2073 7065 6369 6669 6320 706f 7369 7469   specific positi
-0000a3f0: 6f6e 2069 6e20 7468 655c 6e73 7472 6561  on in the\nstrea
-0000a400: 6d2c 2074 6865 2072 6563 6f72 6465 6420  m, the recorded 
-0000a410: 6576 656e 7420 6174 2074 6861 7420 706f  event at that po
-0000a420: 7369 7469 6f6e 2077 696c 6c20 6265 2069  sition will be i
-0000a430: 6e63 6c75 6465 642c 2062 6f74 6820 7768  ncluded, both wh
-0000a440: 656e 2072 6561 6469 6e67 5c6e 666f 7277  en reading\nforw
-0000a450: 6172 6473 2066 726f 6d20 7468 6174 2070  ards from that p
-0000a460: 6f73 6974 696f 6e2c 2061 6e64 2077 6865  osition, and whe
-0000a470: 6e20 7265 6164 696e 6720 6261 636b 7761  n reading backwa
-0000a480: 7264 732e 5c6e 5c6e 5468 6520 6f70 7469  rds.\n\nThe opti
-0000a490: 6f6e 616c 2060 6261 636b 7761 7264 7360  onal `backwards`
-0000a4a0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
-0000a4b0: 7974 686f 6e20 6062 6f6f 6c60 2e20 5468  ython `bool`. Th
-0000a4c0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-0000a4d0: 6f66 2060 6261 636b 7761 7264 7360 5c6e  of `backwards`\n
-0000a4e0: 6973 2060 4661 6c73 6560 2c20 7768 6963  is `False`, whic
-0000a4f0: 6820 6d65 616e 7320 7468 6520 7374 7265  h means the stre
-0000a500: 616d 2077 696c 6c20 6265 2072 6561 6420  am will be read 
-0000a510: 666f 7277 6172 6473 2c20 736f 2074 6861  forwards, so tha
-0000a520: 7420 6576 656e 7473 2061 7265 2072 6574  t events are ret
-0000a530: 7572 6e65 645c 6e69 6e20 7468 6520 6f72  urned\nin the or
-0000a540: 6465 7220 7468 6579 2077 6572 6520 7265  der they were re
-0000a550: 636f 7264 6564 2e20 4966 2060 6261 636b  corded. If `back
-0000a560: 7761 7264 7360 2069 7320 6054 7275 6560  wards` is `True`
-0000a570: 2c20 7468 6520 6576 656e 7473 2061 7265  , the events are
-0000a580: 2072 6574 7572 6e65 6420 696e 5c6e 7265   returned in\nre
-0000a590: 7665 7273 6520 6f72 6465 722e 5c6e 5c6e  verse order.\n\n
-0000a5a0: 4966 2060 6261 636b 7761 7264 7360 2069  If `backwards` i
-0000a5b0: 7320 6046 616c 7365 6020 616e 6420 6073  s `False` and `s
-0000a5c0: 7472 6561 6d5f 706f 7369 7469 6f6e 6020  tream_position` 
-0000a5d0: 6973 2060 4e6f 6e65 602c 2074 6865 2073  is `None`, the s
-0000a5e0: 7472 6561 6d5c 2773 2065 7665 6e74 7320  tream\'s events 
-0000a5f0: 7769 6c6c 2062 655c 6e72 6574 7572 6e65  will be\nreturne
-0000a600: 6420 696e 2074 6865 206f 7264 6572 2074  d in the order t
-0000a610: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
-0000a620: 642c 2073 7461 7274 696e 6720 6672 6f6d  d, starting from
-0000a630: 2074 6865 2066 6972 7374 2072 6563 6f72   the first recor
-0000a640: 6465 6420 6576 656e 742e 2049 665c 6e60  ded event. If\n`
-0000a650: 6261 636b 7761 7264 7360 2069 7320 6054  backwards` is `T
-0000a660: 7275 6560 2061 6e64 2060 7374 7265 616d  rue` and `stream
-0000a670: 5f70 6f73 6974 696f 6e60 2069 7320 604e  _position` is `N
-0000a680: 6f6e 6560 2c20 7468 6520 7374 7265 616d  one`, the stream
-0000a690: 5c27 7320 6576 656e 7473 2077 696c 6c20  \'s events will 
-0000a6a0: 6265 5c6e 7265 7475 726e 6564 2069 6e20  be\nreturned in 
-0000a6b0: 7265 7665 7273 6520 6f72 6465 722c 2073  reverse order, s
-0000a6c0: 7461 7274 696e 6720 6672 6f6d 2074 6865  tarting from the
-0000a6d0: 206c 6173 7420 7265 636f 7264 6564 2065   last recorded e
-0000a6e0: 7665 6e74 2e5c 6e5c 6e54 6865 206f 7074  vent.\n\nThe opt
-0000a6f0: 696f 6e61 6c20 6072 6573 6f6c 7665 5f6c  ional `resolve_l
-0000a700: 696e 6b73 6020 6172 6775 6d65 6e74 2069  inks` argument i
-0000a710: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
-0000a720: 602e 2054 6865 2064 6566 6175 6c74 2076  `. The default v
-0000a730: 616c 7565 206f 6620 6072 6573 6f6c 7665  alue of `resolve
-0000a740: 5f6c 696e 6b73 605c 6e69 7320 6046 616c  _links`\nis `Fal
-0000a750: 7365 602c 2077 6869 6368 206d 6561 6e73  se`, which means
-0000a760: 2061 6e79 2065 7665 6e74 206c 696e 6b73   any event links
-0000a770: 2077 696c 6c20 6e6f 7420 6265 2072 6573   will not be res
-0000a780: 6f6c 7665 642c 2073 6f20 7468 6174 2074  olved, so that t
-0000a790: 6865 2065 7665 6e74 7320 7468 6174 2061  he events that a
-0000a7a0: 7265 5c6e 7265 7475 726e 6564 206d 6179  re\nreturned may
-0000a7b0: 2072 6570 7265 7365 6e74 2065 7665 6e74   represent event
-0000a7c0: 206c 696e 6b73 2e20 4966 2060 7265 736f   links. If `reso
-0000a7d0: 6c76 655f 6c69 6e6b 7360 2069 7320 6054  lve_links` is `T
-0000a7e0: 7275 6560 2c20 616e 7920 6576 656e 7420  rue`, any event 
-0000a7f0: 6c69 6e6b 7320 7769 6c6c 5c6e 6265 2072  links will\nbe r
-0000a800: 6573 6f6c 7665 642c 2073 6f20 7468 6174  esolved, so that
-0000a810: 2074 6865 206c 696e 6b65 6420 6576 656e   the linked even
-0000a820: 7473 2077 696c 6c20 6265 2072 6574 7572  ts will be retur
-0000a830: 6e65 6420 696e 7374 6561 6420 6f66 2074  ned instead of t
-0000a840: 6865 2065 7665 6e74 206c 696e 6b73 2e5c  he event links.\
-0000a850: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
-0000a860: 606c 696d 6974 6020 6172 6775 6d65 6e74  `limit` argument
-0000a870: 2069 7320 6120 5079 7468 6f6e 2060 696e   is a Python `in
-0000a880: 7460 2077 6869 6368 2072 6573 7472 6963  t` which restric
-0000a890: 7473 2074 6865 206e 756d 6265 7220 6f66  ts the number of
-0000a8a0: 2065 7665 6e74 735c 6e74 6861 7420 7769   events\nthat wi
-0000a8b0: 6c6c 2062 6520 7265 7475 726e 6564 2e20  ll be returned. 
-0000a8c0: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
-0000a8d0: 6520 6f66 2060 6c69 6d69 7460 2069 7320  e of `limit` is 
-0000a8e0: 6073 7973 2e6d 6178 696e 7460 2e5c 6e5c  `sys.maxint`.\n\
-0000a8f0: 6e54 6865 206f 7074 696f 6e61 6c20 6074  nThe optional `t
-0000a900: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
-0000a910: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
-0000a920: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
-0000a930: 6120 6465 6164 6c69 6e65 2066 6f72 5c6e  a deadline for\n
-0000a940: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
-0000a950: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
-0000a960: 7469 6f6e 2e5c 6e5c 6e54 6869 7320 6d65  tion.\n\nThis me
-0000a970: 7468 6f64 2061 6c73 6f20 6861 7320 616e  thod also has an
-0000a980: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-0000a990: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-0000a9a0: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
-0000a9b0: 7365 6420 746f 5c6e 6f76 6572 7269 6465  sed to\noverride
-0000a9c0: 2063 616c 6c20 6372 6564 656e 7469 616c   call credential
-0000a9d0: 7320 6465 7269 7665 6420 6672 6f6d 2074  s derived from t
-0000a9e0: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-0000a9f0: 7269 6e67 2055 5249 2e5c 6e5c 6e54 6865  ring URI.\n\nThe
-0000aa00: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-0000aa10: 686f 7773 2074 6865 2064 6566 6175 6c74  hows the default
-0000aa20: 2062 6568 6176 696f 722c 2077 6869 6368   behavior, which
-0000aa30: 2069 7320 746f 2072 6574 7572 6e20 616c   is to return al
-0000aa40: 6c20 7468 6520 7265 636f 7264 6564 5c6e  l the recorded\n
-0000aa50: 6576 656e 7473 206f 6620 6120 7374 7265  events of a stre
-0000aa60: 616d 2066 6f72 7761 7264 7320 6672 6f6d  am forwards from
-0000aa70: 2074 6865 2066 6972 7374 2072 6563 6f72   the first recor
-0000aa80: 6465 6420 6576 656e 7473 2074 6f20 7468  ded events to th
-0000aa90: 6520 6c61 7374 2e5c 6e5c 6e60 6060 7079  e last.\n\n```py
-0000aaa0: 7468 6f6e 5c6e 6576 656e 7473 203d 2063  thon\nevents = c
-0000aab0: 6c69 656e 742e 6765 745f 7374 7265 616d  lient.get_stream
-0000aac0: 285c 6e20 2020 2073 7472 6561 6d5f 6e61  (\n    stream_na
-0000aad0: 6d65 3d73 7472 6561 6d5f 6e61 6d65 315c  me=stream_name1\
-0000aae0: 6e29 5c6e 5c6e 6173 7365 7274 206c 656e  n)\n\nassert len
-0000aaf0: 2865 7665 6e74 7329 203d 3d20 335c 6e61  (events) == 3\na
-0000ab00: 7373 6572 7420 6576 656e 7473 5b30 5d2e  ssert events[0].
-0000ab10: 6964 203d 3d20 6576 656e 7431 2e69 645c  id == event1.id\
-0000ab20: 6e61 7373 6572 7420 6576 656e 7473 5b31  nassert events[1
-0000ab30: 5d2e 6964 203d 3d20 6576 656e 7432 2e69  ].id == event2.i
-0000ab40: 645c 6e61 7373 6572 7420 6576 656e 7473  d\nassert events
-0000ab50: 5b32 5d2e 6964 203d 3d20 6576 656e 7433  [2].id == event3
-0000ab60: 2e69 645c 6e60 6060 5c6e 5c6e 5468 6520  .id\n```\n\nThe 
-0000ab70: 6578 616d 706c 6520 6265 6c6f 7720 7368  example below sh
-0000ab80: 6f77 7320 686f 7720 746f 2075 7365 2074  ows how to use t
-0000ab90: 6865 2060 7374 7265 616d 5f70 6f73 6974  he `stream_posit
-0000aba0: 696f 6e60 2061 7267 756d 656e 7420 746f  ion` argument to
-0000abb0: 2072 6561 6420 6120 7374 7265 616d 5c6e   read a stream\n
-0000abc0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
-0000abd0: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
-0000abe0: 746f 2074 6865 2065 6e64 206f 6620 7468  to the end of th
-0000abf0: 6520 7374 7265 616d 2e20 5374 7265 616d  e stream. Stream
-0000ac00: 2070 6f73 6974 696f 6e73 2061 7265 5c6e   positions are\n
-0000ac10: 7a65 726f 2d62 6173 6564 2c20 616e 6420  zero-based, and 
-0000ac20: 736f 2060 7374 7265 616d 5f70 6f73 6974  so `stream_posit
-0000ac30: 696f 6e3d 3160 2063 6f72 7265 7370 6f6e  ion=1` correspon
-0000ac40: 6473 2074 6f20 7468 6520 7365 636f 6e64  ds to the second
-0000ac50: 2065 7665 6e74 2074 6861 7420 7761 735c   event that was\
-0000ac60: 6e72 6563 6f72 6465 6420 696e 2074 6865  nrecorded in the
-0000ac70: 2073 7472 6561 6d2c 2069 6e20 7468 6973   stream, in this
-0000ac80: 2063 6173 6520 6065 7665 6e74 3260 2e5c   case `event2`.\
-0000ac90: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 6576  n\n```python\nev
-0000aca0: 656e 7473 203d 2063 6c69 656e 742e 6765  ents = client.ge
-0000acb0: 745f 7374 7265 616d 285c 6e20 2020 2073  t_stream(\n    s
-0000acc0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
-0000acd0: 6d5f 6e61 6d65 312c 5c6e 2020 2020 7374  m_name1,\n    st
-0000ace0: 7265 616d 5f70 6f73 6974 696f 6e3d 312c  ream_position=1,
-0000acf0: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
-0000ad00: 6e28 6576 656e 7473 2920 3d3d 2032 5c6e  n(events) == 2\n
-0000ad10: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-0000ad20: 2e69 6420 3d3d 2065 7665 6e74 322e 6964  .id == event2.id
-0000ad30: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-0000ad40: 315d 2e69 6420 3d3d 2065 7665 6e74 332e  1].id == event3.
-0000ad50: 6964 5c6e 6060 605c 6e5c 6e54 6865 2065  id\n```\n\nThe e
-0000ad60: 7861 6d70 6c65 2062 656c 6f77 2073 686f  xample below sho
-0000ad70: 7773 2068 6f77 2074 6f20 7573 6520 7468  ws how to use th
-0000ad80: 6520 6062 6163 6b77 6172 6473 6020 6172  e `backwards` ar
-0000ad90: 6775 6d65 6e74 2074 6f20 7265 6164 2061  gument to read a
-0000ada0: 2073 7472 6561 6d20 6261 636b 7761 7264   stream backward
-0000adb0: 732e 5c6e 5c6e 6060 6070 7974 686f 6e5c  s.\n\n```python\
-0000adc0: 6e65 7665 6e74 7320 3d20 636c 6965 6e74  nevents = client
-0000add0: 2e67 6574 5f73 7472 6561 6d28 5c6e 2020  .get_stream(\n  
-0000ade0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
-0000adf0: 7265 616d 5f6e 616d 6531 2c5c 6e20 2020  ream_name1,\n   
-0000ae00: 2062 6163 6b77 6172 6473 3d54 7275 652c   backwards=True,
-0000ae10: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
-0000ae20: 6e28 6576 656e 7473 2920 3d3d 2033 5c6e  n(events) == 3\n
-0000ae30: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-0000ae40: 2e69 6420 3d3d 2065 7665 6e74 332e 6964  .id == event3.id
-0000ae50: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-0000ae60: 315d 2e69 6420 3d3d 2065 7665 6e74 322e  1].id == event2.
-0000ae70: 6964 5c6e 6173 7365 7274 2065 7665 6e74  id\nassert event
-0000ae80: 735b 325d 2e69 6420 3d3d 2065 7665 6e74  s[2].id == event
-0000ae90: 312e 6964 5c6e 6060 605c 6e5c 6e54 6865  1.id\n```\n\nThe
-0000aea0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-0000aeb0: 686f 7773 2068 6f77 2074 6f20 7573 6520  hows how to use 
-0000aec0: 7468 6520 606c 696d 6974 6020 6172 6775  the `limit` argu
-0000aed0: 6d65 6e74 2074 6f20 7265 6164 2061 206c  ment to read a l
-0000aee0: 696d 6974 6564 206e 756d 6265 7220 6f66  imited number of
-0000aef0: 5c6e 6576 656e 7473 2e5c 6e5c 6e60 6060  \nevents.\n\n```
-0000af00: 7079 7468 6f6e 5c6e 6576 656e 7473 203d  python\nevents =
-0000af10: 2063 6c69 656e 742e 6765 745f 7374 7265   client.get_stre
-0000af20: 616d 285c 6e20 2020 2073 7472 6561 6d5f  am(\n    stream_
-0000af30: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
-0000af40: 312c 5c6e 2020 2020 6c69 6d69 743d 322c  1,\n    limit=2,
-0000af50: 5c6e 295c 6e5c 6e61 7373 6572 7420 6c65  \n)\n\nassert le
-0000af60: 6e28 6576 656e 7473 2920 3d3d 2032 5c6e  n(events) == 2\n
-0000af70: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-0000af80: 2e69 6420 3d3d 2065 7665 6e74 312e 6964  .id == event1.id
-0000af90: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-0000afa0: 315d 2e69 6420 3d3d 2065 7665 6e74 322e  1].id == event2.
-0000afb0: 6964 5c6e 6060 605c 6e5c 6e54 6865 2060  id\n```\n\nThe `
-0000afc0: 7265 6164 5f73 7472 6561 6d28 2960 2061  read_stream()` a
-0000afd0: 6e64 2060 6765 745f 7374 7265 616d 2829  nd `get_stream()
-0000afe0: 6020 6d65 7468 6f64 7320 7769 6c6c 2072  ` methods will r
-0000aff0: 6169 7365 2061 2060 4e6f 7446 6f75 6e64  aise a `NotFound
-0000b000: 6020 6578 6365 7074 696f 6e20 6966 2074  ` exception if t
-0000b010: 6865 5c6e 6e61 6d65 6420 7374 7265 616d  he\nnamed stream
-0000b020: 2068 6173 206e 6576 6572 2065 7869 7374   has never exist
-0000b030: 6564 206f 7220 6861 7320 6265 656e 2064  ed or has been d
-0000b040: 656c 6574 6564 2e5c 6e5c 6e60 6060 7079  eleted.\n\n```py
-0000b050: 7468 6f6e 5c6e 6672 6f6d 2065 7364 6263  thon\nfrom esdbc
-0000b060: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
-0000b070: 2069 6d70 6f72 7420 4e6f 7446 6f75 6e64   import NotFound
-0000b080: 5c6e 5c6e 5c6e 7472 793a 5c6e 2020 2020  \n\n\ntry:\n    
-0000b090: 636c 6965 6e74 2e67 6574 5f73 7472 6561  client.get_strea
-0000b0a0: 6d28 5c27 646f 6573 2d6e 6f74 2d65 7869  m(\'does-not-exi
-0000b0b0: 7374 5c27 295c 6e65 7863 6570 7420 4e6f  st\')\nexcept No
-0000b0c0: 7446 6f75 6e64 3a5c 6e20 2020 2070 6173  tFound:\n    pas
-0000b0d0: 7320 2023 2054 6865 2073 7472 6561 6d20  s  # The stream 
-0000b0e0: 646f 6573 206e 6f74 2065 7869 7374 2e5c  does not exist.\
-0000b0f0: 6e65 6c73 653a 5c6e 2020 2020 7261 6973  nelse:\n    rais
-0000b100: 6520 4578 6365 7074 696f 6e28 2253 686f  e Exception("Sho
-0000b110: 756c 646e 5c27 7420 6765 7420 6865 7265  uldn\'t get here
-0000b120: 2229 5c6e 6060 605c 6e5c 6e50 6c65 6173  ")\n```\n\nPleas
-0000b130: 6520 6e6f 7465 2c20 7468 6520 6067 6574  e note, the `get
-0000b140: 5f73 7472 6561 6d28 2960 206d 6574 686f  _stream()` metho
-0000b150: 6420 6973 2064 6563 6f72 6174 6564 2077  d is decorated w
-0000b160: 6974 6820 7468 6520 6040 6175 746f 7265  ith the `@autore
-0000b170: 636f 6e6e 6563 7460 2061 6e64 5c6e 6040  connect` and\n`@
-0000b180: 7265 7472 7967 7270 6360 2064 6563 6f72  retrygrpc` decor
-0000b190: 6174 6f72 732c 2077 6869 6c73 7420 7468  ators, whilst th
-0000b1a0: 6520 6072 6561 645f 7374 7265 616d 2829  e `read_stream()
-0000b1b0: 6020 6d65 7468 6f64 2069 7320 6e6f 742e  ` method is not.
-0000b1c0: 2054 6869 7320 6d65 616e 7320 7468 6174   This means that
-0000b1d0: 5c6e 616c 6c20 6572 726f 7273 2064 7565  \nall errors due
-0000b1e0: 2074 6f20 636f 6e6e 6563 7469 6f6e 2069   to connection i
-0000b1f0: 7373 7565 7320 7769 6c6c 2062 6520 6361  ssues will be ca
-0000b200: 7567 6874 2062 7920 7468 6520 7265 7472  ught by the retr
-0000b210: 7920 616e 6420 7265 636f 6e6e 6563 7420  y and reconnect 
-0000b220: 6465 636f 7261 746f 7273 5c6e 7768 656e  decorators\nwhen
-0000b230: 2063 616c 6c69 6e67 2074 6865 2060 6765   calling the `ge
-0000b240: 745f 7374 7265 616d 2829 6020 6d65 7468  t_stream()` meth
-0000b250: 6f64 2c20 6275 7420 6e6f 7420 7768 656e  od, but not when
-0000b260: 2063 616c 6c69 6e67 2060 7265 6164 5f73   calling `read_s
-0000b270: 7472 6561 6d28 2960 2e20 5468 655c 6e60  tream()`. The\n`
-0000b280: 7265 6164 5f73 7472 6561 6d28 2960 206d  read_stream()` m
-0000b290: 6574 686f 6420 6861 7320 6e6f 2073 7563  ethod has no suc
-0000b2a0: 6820 6465 636f 7261 746f 7273 2062 6563  h decorators bec
-0000b2b0: 6175 7365 2074 6865 2073 7472 6561 6d69  ause the streami
-0000b2c0: 6e67 206f 6e6c 7920 7374 6172 7473 5c6e  ng only starts\n
-0000b2d0: 7768 656e 2069 7465 7261 7469 6e67 206f  when iterating o
-0000b2e0: 7665 7220 7468 6520 2272 6561 6420 7265  ver the "read re
-0000b2f0: 7370 6f6e 7365 2220 7374 6172 7473 2c20  sponse" starts, 
-0000b300: 7768 6963 6820 6d65 616e 7320 7468 6174  which means that
-0000b310: 2074 6865 206d 6574 686f 6420 7265 7475   the method retu
-0000b320: 726e 735c 6e62 6566 6f72 6520 7468 6520  rns\nbefore the 
-0000b330: 7374 7265 616d 696e 6720 7374 6172 7473  streaming starts
-0000b340: 2c20 616e 6420 736f 2074 6865 7265 2069  , and so there i
-0000b350: 7320 6e6f 2063 6861 6e63 6520 666f 7220  s no chance for 
-0000b360: 616e 7920 6465 636f 7261 746f 7273 2074  any decorators t
-0000b370: 6f20 6361 7463 685c 6e61 6e79 2063 6f6e  o catch\nany con
-0000b380: 6e65 6374 696f 6e20 6973 7375 6573 2e5c  nection issues.\
-0000b390: 6e5c 6e46 6f72 2074 6865 2073 616d 6520  n\nFor the same 
-0000b3a0: 7265 6173 6f6e 2c20 6072 6561 645f 7374  reason, `read_st
-0000b3b0: 7265 616d 2829 6020 7769 6c6c 206e 6f74  ream()` will not
-0000b3c0: 2072 6169 7365 2061 2060 4e6f 7446 6f75   raise a `NotFou
-0000b3d0: 6e64 6020 6578 6365 7074 696f 6e20 7768  nd` exception wh
-0000b3e0: 656e 5c6e 7468 6520 7374 7265 616d 2064  en\nthe stream d
-0000b3f0: 6f65 7320 6e6f 7420 6578 6973 742c 2075  oes not exist, u
-0000b400: 6e74 696c 2069 7465 7261 7469 6e67 206f  ntil iterating o
-0000b410: 7665 7220 7468 6520 2272 6561 6420 7265  ver the "read re
-0000b420: 7370 6f6e 7365 2220 6f62 6a65 6374 2062  sponse" object b
-0000b430: 6567 696e 732e 5c6e 5c6e 4966 2079 6f75  egins.\n\nIf you
-0000b440: 2061 7265 2072 6561 6469 6e67 2061 2076   are reading a v
-0000b450: 6572 7920 6c61 7267 6520 7374 7265 616d  ery large stream
-0000b460: 2c20 7468 656e 2079 6f75 206d 6967 6874  , then you might
-0000b470: 2070 7265 6665 7220 746f 2063 616c 6c20   prefer to call 
-0000b480: 6072 6561 645f 7374 7265 616d 2829 602c  `read_stream()`,
-0000b490: 5c6e 616e 6420 6265 6769 6e20 6974 6572  \nand begin iter
-0000b4a0: 6174 696e 6720 7468 726f 7567 6820 7468  ating through th
-0000b4b0: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-0000b4c0: 7320 7768 696c 7374 2074 6865 7920 6172  s whilst they ar
-0000b4d0: 6520 6265 696e 6720 7374 7265 616d 6564  e being streamed
-0000b4e0: 2066 726f 6d5c 6e74 6865 2073 6572 7665   from\nthe serve
-0000b4f0: 722c 2072 6174 6865 7220 7468 616e 2062  r, rather than b
-0000b500: 6f74 6820 7761 6974 696e 6720 616e 6420  oth waiting and 
-0000b510: 6861 7669 6e67 2074 6865 6d20 616c 6c20  having them all 
-0000b520: 6163 6375 6d75 6c61 7465 2069 6e20 6d65  accumulate in me
-0000b530: 6d6f 7279 2e5c 6e5c 6e23 2323 2047 6574  mory.\n\n### Get
-0000b540: 2063 7572 7265 6e74 2076 6572 7369 6f6e   current version
-0000b550: 5c6e 5c6e 5468 6520 6067 6574 5f63 7572  \n\nThe `get_cur
-0000b560: 7265 6e74 5f76 6572 7369 6f6e 2829 6020  rent_version()` 
-0000b570: 6d65 7468 6f64 2069 7320 6120 636f 6e76  method is a conv
-0000b580: 656e 6965 6e63 6520 6d65 7468 6f64 2074  enience method t
-0000b590: 6861 7420 6573 7365 6e74 6961 6c6c 7920  hat essentially 
-0000b5a0: 6361 6c6c 735c 6e60 6765 745f 7374 7265  calls\n`get_stre
-0000b5b0: 616d 2829 6020 7769 7468 2060 6261 636b  am()` with `back
-0000b5c0: 7761 7264 733d 5472 7565 6020 616e 6420  wards=True` and 
-0000b5d0: 606c 696d 6974 3d31 602e 2054 6869 7320  `limit=1`. This 
-0000b5e0: 6d65 7468 6f64 2072 6574 7572 6e73 5c6e  method returns\n
-0000b5f0: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
-0000b600: 2060 7374 7265 616d 5f70 6f73 6974 696f   `stream_positio
-0000b610: 6e60 2061 7474 7269 6275 7465 206f 6620  n` attribute of 
-0000b620: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-0000b630: 6420 6576 656e 7420 696e 2061 5c6e 7374  d event in a\nst
-0000b640: 7265 616d 2e20 4966 2061 2073 7472 6561  ream. If a strea
-0000b650: 6d20 646f 6573 206e 6f74 2065 7869 7374  m does not exist
-0000b660: 2c20 7468 6520 7265 7475 726e 6564 2076  , the returned v
-0000b670: 616c 7565 2069 7320 6053 7472 6561 6d53  alue is `StreamS
-0000b680: 7461 7465 2e4e 4f5f 5354 5245 414d 602e  tate.NO_STREAM`.
-0000b690: 5c6e 5468 6520 7265 7475 726e 6564 2076  \nThe returned v
-0000b6a0: 616c 7565 2069 7320 7468 6520 636f 7272  alue is the corr
-0000b6b0: 6563 7420 7661 6c75 6520 6f66 2060 6375  ect value of `cu
-0000b6c0: 7272 656e 745f 7665 7273 696f 6e60 2077  rrent_version` w
-0000b6d0: 6865 6e20 6170 7065 6e64 696e 6720 6576  hen appending ev
-0000b6e0: 656e 7473 5c6e 746f 2061 2073 7472 6561  ents\nto a strea
-0000b6f0: 6d2c 2061 6e64 2077 6865 6e20 6465 6c65  m, and when dele
-0000b700: 7469 6e67 206f 7220 746f 6d62 7374 6f6e  ting or tombston
-0000b710: 696e 6720 6120 7374 7265 616d 2e5c 6e5c  ing a stream.\n\
-0000b720: 6e54 6869 7320 6d65 7468 6f64 2068 6173  nThis method has
-0000b730: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
-0000b740: 6775 6d65 6e74 2c20 6073 7472 6561 6d5f  gument, `stream_
-0000b750: 6e61 6d65 602e 5c6e 5c6e 5468 6520 7265  name`.\n\nThe re
-0000b760: 7175 6972 6564 2060 7374 7265 616d 5f6e  quired `stream_n
-0000b770: 616d 6560 2061 7267 756d 656e 7420 6973  ame` argument is
-0000b780: 2061 2050 7974 686f 6e20 6073 7472 6020   a Python `str` 
-0000b790: 7468 6174 2075 6e69 7175 656c 7920 6964  that uniquely id
-0000b7a0: 656e 7469 6669 6573 2061 5c6e 7374 7265  entifies a\nstre
-0000b7b0: 616d 2066 726f 6d20 7768 6963 6820 6120  am from which a 
-0000b7c0: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
-0000b7d0: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
-0000b7e0: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
-0000b7f0: 2061 6c73 6f20 6861 7320 616e 206f 7074   also has an opt
-0000b800: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-0000b810: 6172 6775 6d65 6e74 2c20 7468 6174 5c6e  argument, that\n
-0000b820: 6973 2065 7870 6563 7465 6420 746f 2062  is expected to b
-0000b830: 6520 6120 5079 7468 6f6e 2060 666c 6f61  e a Python `floa
-0000b840: 7460 2c20 7768 6963 6820 7365 7473 2061  t`, which sets a
-0000b850: 2064 6561 646c 696e 655c 6e66 6f72 2074   deadline\nfor t
-0000b860: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-0000b870: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-0000b880: 696f 6e2e 5c6e 5c6e 5468 6973 206d 6574  ion.\n\nThis met
-0000b890: 686f 6420 616c 736f 2068 6173 2061 6e20  hod also has an 
-0000b8a0: 6f70 7469 6f6e 616c 2060 6372 6564 656e  optional `creden
-0000b8b0: 7469 616c 7360 2061 7267 756d 656e 742c  tials` argument,
-0000b8c0: 2077 6869 6368 2063 616e 2062 6520 7573   which can be us
-0000b8d0: 6564 2074 6f5c 6e6f 7665 7272 6964 6520  ed to\noverride 
-0000b8e0: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
-0000b8f0: 2064 6572 6976 6564 2066 726f 6d20 7468   derived from th
-0000b900: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
-0000b910: 696e 6720 5552 492e 5c6e 5c6e 496e 2074  ing URI.\n\nIn t
-0000b920: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-0000b930: 2c20 7468 6520 6c61 7374 2073 7472 6561  , the last strea
-0000b940: 6d20 706f 7369 7469 6f6e 206f 6620 6073  m position of `s
-0000b950: 7472 6561 6d5f 6e61 6d65 3160 2069 7320  tream_name1` is 
-0000b960: 6f62 7461 696e 6564 2e5c 6e53 696e 6365  obtained.\nSince
-0000b970: 2074 6872 6565 2065 7665 6e74 7320 6861   three events ha
-0000b980: 7665 2062 6565 6e20 6170 7065 6e64 6564  ve been appended
-0000b990: 2074 6f20 6073 7472 6561 6d5f 6e61 6d65   to `stream_name
-0000b9a0: 3160 2c20 616e 6420 6265 6361 7573 6520  1`, and because 
-0000b9b0: 706f 7369 7469 6f6e 735c 6e69 6e20 6120  positions\nin a 
-0000b9c0: 7374 7265 616d 2061 7265 207a 6572 6f2d  stream are zero-
-0000b9d0: 6261 7365 6420 616e 6420 6761 706c 6573  based and gaples
-0000b9e0: 732c 2073 6f20 7468 6520 6375 7272 656e  s, so the curren
-0000b9f0: 7420 7665 7273 696f 6e20 6973 2060 3260  t version is `2`
-0000ba00: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-0000ba10: 6375 7272 656e 745f 7665 7273 696f 6e20  current_version 
-0000ba20: 3d20 636c 6965 6e74 2e67 6574 5f63 7572  = client.get_cur
-0000ba30: 7265 6e74 5f76 6572 7369 6f6e 285c 6e20  rent_version(\n 
-0000ba40: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-0000ba50: 7472 6561 6d5f 6e61 6d65 315c 6e29 5c6e  tream_name1\n)\n
-0000ba60: 5c6e 6173 7365 7274 2063 7572 7265 6e74  \nassert current
-0000ba70: 5f76 6572 7369 6f6e 203d 3d20 325c 6e60  _version == 2\n`
-0000ba80: 6060 5c6e 5c6e 4966 2061 2073 7472 6561  ``\n\nIf a strea
-0000ba90: 6d20 6861 7320 6e65 7665 7220 6578 6973  m has never exis
-0000baa0: 7465 6420 6f72 2068 6173 2062 6565 6e20  ted or has been 
-0000bab0: 6465 6c65 7465 642c 2074 6865 2072 6574  deleted, the ret
-0000bac0: 7572 6e65 6420 7661 6c75 6520 6973 5c6e  urned value is\n
-0000bad0: 6053 7472 6561 6d53 7461 7465 2e4e 4f5f  `StreamState.NO_
-0000bae0: 5354 5245 414d 602c 2077 6869 6368 2069  STREAM`, which i
-0000baf0: 7320 7468 6520 636f 7272 6563 7420 7661  s the correct va
-0000bb00: 6c75 6520 6f66 2074 6865 2060 6375 7272  lue of the `curr
-0000bb10: 656e 745f 7665 7273 696f 6e60 5c6e 6172  ent_version`\nar
-0000bb20: 6775 6d65 6e74 2062 6f74 6820 7768 656e  gument both when
-0000bb30: 2061 7070 656e 6469 6e67 2074 6865 2066   appending the f
-0000bb40: 6972 7374 2065 7665 6e74 206f 6620 6120  irst event of a 
-0000bb50: 6e65 7720 7374 7265 616d 2c20 616e 6420  new stream, and 
-0000bb60: 616c 736f 2077 6865 6e5c 6e61 7070 656e  also when\nappen
-0000bb70: 6469 6e67 2065 7665 6e74 7320 746f 2061  ding events to a
-0000bb80: 2073 7472 6561 6d20 7468 6174 2068 6173   stream that has
-0000bb90: 2062 6565 6e20 6465 6c65 7465 642e 5c6e   been deleted.\n
-0000bba0: 5c6e 6060 6070 7974 686f 6e5c 6e63 7572  \n```python\ncur
-0000bbb0: 7265 6e74 5f76 6572 7369 6f6e 203d 2063  rent_version = c
-0000bbc0: 6c69 656e 742e 6765 745f 6375 7272 656e  lient.get_curren
-0000bbd0: 745f 7665 7273 696f 6e28 5c6e 2020 2020  t_version(\n    
-0000bbe0: 7374 7265 616d 5f6e 616d 653d 5c27 646f  stream_name=\'do
-0000bbf0: 6573 2d6e 6f74 2d65 7869 7374 5c27 5c6e  es-not-exist\'\n
-0000bc00: 295c 6e5c 6e61 7373 6572 7420 6375 7272  )\n\nassert curr
-0000bc10: 656e 745f 7665 7273 696f 6e20 6973 2053  ent_version is S
-0000bc20: 7472 6561 6d53 7461 7465 2e4e 4f5f 5354  treamState.NO_ST
-0000bc30: 5245 414d 5c6e 6060 605c 6e5c 6e23 2323  REAM\n```\n\n###
-0000bc40: 2048 6f77 2074 6f20 696d 706c 656d 656e   How to implemen
-0000bc50: 7420 736e 6170 7368 6f74 7469 6e67 2077  t snapshotting w
-0000bc60: 6974 6820 4576 656e 7453 746f 7265 4442  ith EventStoreDB
-0000bc70: 5c6e 5c6e 536e 6170 7368 6f74 7320 6361  \n\nSnapshots ca
-0000bc80: 6e20 696d 7072 6f76 6520 7468 6520 7065  n improve the pe
-0000bc90: 7266 6f72 6d61 6e63 6520 6f66 2061 6767  rformance of agg
-0000bca0: 7265 6761 7465 7320 7468 6174 2077 6f75  regates that wou
-0000bcb0: 6c64 206f 7468 6572 7769 7365 2062 655c  ld otherwise be\
-0000bcc0: 6e72 6563 6f6e 7374 7275 6374 6564 2066  nreconstructed f
-0000bcd0: 726f 6d20 7665 7279 206c 6f6e 6720 7374  rom very long st
-0000bce0: 7265 616d 732e 2048 6f77 6576 6572 2c20  reams. However, 
-0000bcf0: 6974 2069 7320 6765 6e65 7261 6c6c 7920  it is generally 
-0000bd00: 7265 636f 6d6d 656e 6465 6420 746f 2064  recommended to d
-0000bd10: 6573 6967 6e5c 6e61 6767 7265 6761 7465  esign\naggregate
-0000bd20: 7320 746f 2068 6176 6520 6120 6669 6e69  s to have a fini
-0000bd30: 7465 206c 6966 6563 7963 6c65 2c20 616e  te lifecycle, an
-0000bd40: 6420 736f 2074 6f20 6861 7665 2072 656c  d so to have rel
-0000bd50: 6174 6976 656c 7920 7368 6f72 7420 7374  atively short st
-0000bd60: 7265 616d 732c 5c6e 7468 6572 6562 7920  reams,\nthereby 
-0000bd70: 6176 6f69 6469 6e67 2074 6865 206e 6565  avoiding the nee
-0000bd80: 6420 666f 7220 736e 6170 7368 6f74 7469  d for snapshotti
-0000bd90: 6e67 2e20 5468 6973 2022 686f 7720 746f  ng. This "how to
-0000bda0: 2220 7365 6374 696f 6e20 6973 2069 6e74  " section is int
-0000bdb0: 656e 6465 6420 6d65 7265 6c79 5c6e 746f  ended merely\nto
-0000bdc0: 2073 686f 7720 686f 7720 736e 6170 7368   show how snapsh
-0000bdd0: 6f74 7469 6e67 206f 6620 6167 6772 6567  otting of aggreg
-0000bde0: 6174 6573 2063 616e 2062 6520 696d 706c  ates can be impl
-0000bdf0: 656d 656e 7465 6420 7769 7468 2045 7665  emented with Eve
-0000be00: 6e74 5374 6f72 6544 4220 7573 696e 675c  ntStoreDB using\
-0000be10: 6e74 6869 7320 5079 7468 6f6e 2063 6c69  nthis Python cli
-0000be20: 656e 742e 5c6e 5c6e 4576 656e 742d 736f  ent.\n\nEvent-so
-0000be30: 7572 6365 6420 6167 6772 6567 6174 6573  urced aggregates
-0000be40: 2061 7265 2074 7970 6963 616c 6c79 2072   are typically r
-0000be50: 6563 6f6e 7374 7275 6374 6564 2066 726f  econstructed fro
-0000be60: 6d20 7265 636f 7264 6564 2065 7665 6e74  m recorded event
-0000be70: 7320 6279 2063 616c 6c69 6e67 5c6e 6120  s by calling\na 
-0000be80: 6d75 7461 746f 7220 6675 6e63 7469 6f6e  mutator function
-0000be90: 2066 6f72 2065 6163 6820 7265 636f 7264   for each record
-0000bea0: 6564 2065 7665 6e74 2c20 6576 6f6c 7669  ed event, evolvi
-0000beb0: 6e67 2066 726f 6d20 616e 2069 6e69 7469  ng from an initi
-0000bec0: 616c 2073 7461 7465 5c6e 604e 6f6e 6560  al state\n`None`
-0000bed0: 2074 6f20 7468 6520 6375 7272 656e 7420   to the current 
-0000bee0: 7374 6174 6520 6f66 2074 6865 2061 6767  state of the agg
-0000bef0: 7265 6761 7465 2e20 5468 6520 6675 6e63  regate. The func
-0000bf00: 7469 6f6e 2060 6765 745f 6167 6772 6567  tion `get_aggreg
-0000bf10: 6174 6528 2960 2073 686f 7773 5c6e 686f  ate()` shows\nho
-0000bf20: 7720 7468 6973 2063 616e 2062 6520 646f  w this can be do
-0000bf30: 6e65 2e20 5468 6520 6167 6772 6567 6174  ne. The aggregat
-0000bf40: 6520 4944 2069 7320 7573 6564 2061 7320  e ID is used as 
-0000bf50: 6120 7374 7265 616d 206e 616d 652e 2054  a stream name. T
-0000bf60: 6865 2065 7863 6570 7469 6f6e 5c6e 6041  he exception\n`A
-0000bf70: 6767 7265 6761 7465 4e6f 7446 6f75 6e64  ggregateNotFound
-0000bf80: 6020 6973 2072 6169 7365 6420 6966 2074  ` is raised if t
-0000bf90: 6865 2061 6767 7265 6761 7465 2073 7472  he aggregate str
-0000bfa0: 6561 6d20 6973 206e 6f74 2066 6f75 6e64  eam is not found
-0000bfb0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-0000bfc0: 636c 6173 7320 4167 6772 6567 6174 654e  class AggregateN
-0000bfd0: 6f74 466f 756e 6428 4578 6365 7074 696f  otFound(Exceptio
-0000bfe0: 6e29 3a5c 6e20 2020 2022 2222 5261 6973  n):\n    """Rais
-0000bff0: 6564 2077 6865 6e20 616e 2061 6767 7265  ed when an aggre
-0000c000: 6761 7465 2069 7320 6e6f 7420 666f 756e  gate is not foun
-0000c010: 642e 2222 225c 6e5c 6e5c 6e64 6566 2067  d."""\n\n\ndef g
-0000c020: 6574 5f61 6767 7265 6761 7465 2861 6767  et_aggregate(agg
-0000c030: 7265 6761 7465 5f69 642c 206d 7574 6174  regate_id, mutat
-0000c040: 6f72 5f66 756e 6329 3a5c 6e20 2020 2073  or_func):\n    s
-0000c050: 7472 6561 6d5f 6e61 6d65 203d 2061 6767  tream_name = agg
-0000c060: 7265 6761 7465 5f69 645c 6e5c 6e20 2020  regate_id\n\n   
-0000c070: 2023 2047 6574 2072 6563 6f72 6465 6420   # Get recorded 
-0000c080: 6576 656e 7473 2e5c 6e20 2020 2074 7279  events.\n    try
-0000c090: 3a5c 6e20 2020 2020 2020 2065 7665 6e74  :\n        event
-0000c0a0: 7320 3d20 636c 6965 6e74 2e67 6574 5f73  s = client.get_s
-0000c0b0: 7472 6561 6d28 5c6e 2020 2020 2020 2020  tream(\n        
-0000c0c0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
-0000c0d0: 7374 7265 616d 5f6e 616d 652c 5c6e 2020  stream_name,\n  
-0000c0e0: 2020 2020 2020 2020 2020 7374 7265 616d            stream
-0000c0f0: 5f70 6f73 6974 696f 6e3d 4e6f 6e65 5c6e  _position=None\n
-0000c100: 2020 2020 2020 2020 295c 6e20 2020 2065          )\n    e
-0000c110: 7863 6570 7420 4e6f 7446 6f75 6e64 2061  xcept NotFound a
-0000c120: 7320 653a 5c6e 2020 2020 2020 2020 7261  s e:\n        ra
-0000c130: 6973 6520 4167 6772 6567 6174 654e 6f74  ise AggregateNot
-0000c140: 466f 756e 6428 6167 6772 6567 6174 655f  Found(aggregate_
-0000c150: 6964 2920 6672 6f6d 2065 5c6e 2020 2020  id) from e\n    
-0000c160: 656c 7365 3a5c 6e20 2020 2020 2020 2023  else:\n        #
-0000c170: 2052 6563 6f6e 7374 7275 6374 2061 6767   Reconstruct agg
-0000c180: 7265 6761 7465 2066 726f 6d20 7265 636f  regate from reco
-0000c190: 7264 6564 2065 7665 6e74 732e 5c6e 2020  rded events.\n  
-0000c1a0: 2020 2020 2020 6167 6772 6567 6174 6520        aggregate 
-0000c1b0: 3d20 4e6f 6e65 5c6e 2020 2020 2020 2020  = None\n        
-0000c1c0: 666f 7220 6576 656e 7420 696e 2065 7665  for event in eve
-0000c1d0: 6e74 733a 5c6e 2020 2020 2020 2020 2020  nts:\n          
-0000c1e0: 2020 6167 6772 6567 6174 6520 3d20 6d75    aggregate = mu
-0000c1f0: 7461 746f 725f 6675 6e63 2861 6767 7265  tator_func(aggre
-0000c200: 6761 7465 2c20 6576 656e 7429 5c6e 2020  gate, event)\n  
-0000c210: 2020 2020 2020 7265 7475 726e 2061 6767        return agg
-0000c220: 7265 6761 7465 5c6e 6060 605c 6e5c 6e53  regate\n```\n\nS
-0000c230: 6e61 7073 686f 7474 696e 6720 6f66 2061  napshotting of a
-0000c240: 6767 7265 6761 7465 7320 6361 6e20 6265  ggregates can be
-0000c250: 2069 6d70 6c65 6d65 6e74 6564 2062 7920   implemented by 
-0000c260: 7265 636f 7264 696e 6720 7468 6520 6375  recording the cu
-0000c270: 7272 656e 7420 7374 6174 6520 6f66 5c6e  rrent state of\n
-0000c280: 616e 2061 6767 7265 6761 7465 2061 7320  an aggregate as 
-0000c290: 6120 6e65 7720 6576 656e 742e 5c6e 5c6e  a new event.\n\n
-0000c2a0: 4966 2061 6e20 6167 6772 6567 6174 6520  If an aggregate 
-0000c2b0: 6f62 6a65 6374 2068 6173 2061 2076 6572  object has a ver
-0000c2c0: 7369 6f6e 206e 756d 6265 7220 7468 6174  sion number that
-0000c2d0: 2063 6f72 7265 7370 6f6e 6473 2074 6f20   corresponds to 
-0000c2e0: 7468 6520 7374 7265 616d 2070 6f73 6974  the stream posit
-0000c2f0: 696f 6e20 6f66 5c6e 7468 6520 6c61 7374  ion of\nthe last
-0000c300: 2065 7665 6e74 2074 6861 7420 7761 7320   event that was 
-0000c310: 7573 6564 2074 6f20 7265 636f 6e73 7472  used to reconstr
-0000c320: 7563 7420 7468 6520 6167 6772 6567 6174  uct the aggregat
-0000c330: 652c 2061 6e64 2074 6869 7320 7665 7273  e, and this vers
-0000c340: 696f 6e20 6e75 6d62 6572 5c6e 6973 2072  ion number\nis r
-0000c350: 6563 6f72 6465 6420 696e 2074 6865 2073  ecorded in the s
-0000c360: 6e61 7073 686f 7420 6d65 7461 6461 7461  napshot metadata
-0000c370: 2c20 7468 656e 2061 6e79 2065 7665 6e74  , then any event
-0000c380: 7320 7468 6174 2061 7265 2072 6563 6f72  s that are recor
-0000c390: 6465 6420 6166 7465 7220 7468 655c 6e73  ded after the\ns
-0000c3a0: 6e61 7073 686f 7420 6361 6e20 6265 2073  napshot can be s
-0000c3b0: 656c 6563 7465 6420 7573 696e 6720 7468  elected using th
-0000c3c0: 6973 2076 6572 7369 6f6e 206e 756d 6265  is version numbe
-0000c3d0: 722e 2054 6865 2061 6767 7265 6761 7465  r. The aggregate
-0000c3e0: 2063 616e 2074 6865 6e20 6265 5c6e 7265   can then be\nre
-0000c3f0: 636f 6e73 7472 7563 7465 6420 6672 6f6d  constructed from
-0000c400: 2074 6865 206c 6173 7420 736e 6170 7368   the last snapsh
-0000c410: 6f74 2061 6e64 2061 6e79 2073 7562 7365  ot and any subse
-0000c420: 7175 656e 7420 6576 656e 7473 2c20 7769  quent events, wi
-0000c430: 7468 6f75 7420 6861 7669 6e67 5c6e 746f  thout having\nto
-0000c440: 2072 6570 6c61 7920 7468 6520 656e 7469   replay the enti
-0000c450: 7265 2068 6973 746f 7279 2e5c 6e5c 6e57  re history.\n\nW
-0000c460: 6520 7769 6c6c 2075 7365 2061 2073 6570  e will use a sep
-0000c470: 6172 6174 6520 7374 7265 616d 2066 6f72  arate stream for
-0000c480: 2061 6e20 6167 6772 6567 6174 655c 2773   an aggregate\'s
-0000c490: 2073 6e61 7073 686f 7473 2074 6861 7420   snapshots that 
-0000c4a0: 6973 206e 616d 6564 2061 6674 6572 2074  is named after t
-0000c4b0: 6865 5c6e 7374 7265 616d 2075 7365 6420  he\nstream used 
-0000c4c0: 666f 7220 7265 636f 7264 696e 6720 6974  for recording it
-0000c4d0: 7320 6576 656e 7473 2e20 5468 6520 6e61  s events. The na
-0000c4e0: 6d65 206f 6620 7468 6520 736e 6170 7368  me of the snapsh
-0000c4f0: 6f74 2073 7472 6561 6d20 7769 6c6c 2062  ot stream will b
-0000c500: 655c 6e63 6f6e 7374 7275 6374 6564 2062  e\nconstructed b
-0000c510: 7920 7072 6566 6978 696e 6720 7468 6520  y prefixing the 
-0000c520: 6167 6772 6567 6174 655c 2773 2073 7472  aggregate\'s str
-0000c530: 6561 6d20 6e61 6d65 2077 6974 6820 605c  eam name with `\
-0000c540: 2773 6e61 7073 686f 742d 245c 2760 2e5c  'snapshot-$\'`.\
-0000c550: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 534e  n\n```python\nSN
-0000c560: 4150 5348 4f54 5f53 5452 4541 4d5f 4e41  APSHOT_STREAM_NA
-0000c570: 4d45 5f50 5245 4649 5820 3d20 5c27 736e  ME_PREFIX = \'sn
-0000c580: 6170 7368 6f74 2d24 5c27 5c6e 5c6e 6465  apshot-$\'\n\nde
-0000c590: 6620 6d61 6b65 5f73 6e61 7073 686f 745f  f make_snapshot_
-0000c5a0: 7374 7265 616d 5f6e 616d 6528 7374 7265  stream_name(stre
-0000c5b0: 616d 5f6e 616d 6529 3a5c 6e20 2020 2072  am_name):\n    r
-0000c5c0: 6574 7572 6e20 665c 277b 534e 4150 5348  eturn f\'{SNAPSH
-0000c5d0: 4f54 5f53 5452 4541 4d5f 4e41 4d45 5f50  OT_STREAM_NAME_P
-0000c5e0: 5245 4649 587d 7b73 7472 6561 6d5f 6e61  REFIX}{stream_na
-0000c5f0: 6d65 7d5c 275c 6e5c 6e5c 6e64 6566 2072  me}\'\n\n\ndef r
-0000c600: 656d 6f76 655f 736e 6170 7368 6f74 5f73  emove_snapshot_s
-0000c610: 7472 6561 6d5f 7072 6566 6978 2873 6e61  tream_prefix(sna
-0000c620: 7073 686f 745f 7374 7265 616d 5f6e 616d  pshot_stream_nam
-0000c630: 6529 3a5c 6e20 2020 2061 7373 6572 7420  e):\n    assert 
-0000c640: 736e 6170 7368 6f74 5f73 7472 6561 6d5f  snapshot_stream_
-0000c650: 6e61 6d65 2e73 7461 7274 7377 6974 6828  name.startswith(
-0000c660: 534e 4150 5348 4f54 5f53 5452 4541 4d5f  SNAPSHOT_STREAM_
-0000c670: 4e41 4d45 5f50 5245 4649 5829 5c6e 2020  NAME_PREFIX)\n  
-0000c680: 2020 7265 7475 726e 2073 6e61 7073 686f    return snapsho
-0000c690: 745f 7374 7265 616d 5f6e 616d 655b 6c65  t_stream_name[le
-0000c6a0: 6e28 534e 4150 5348 4f54 5f53 5452 4541  n(SNAPSHOT_STREA
-0000c6b0: 4d5f 4e41 4d45 5f50 5245 4649 5829 3a5d  M_NAME_PREFIX):]
-0000c6c0: 5c6e 6060 605c 6e5c 6e4e 6f77 2c20 6c65  \n```\n\nNow, le
-0000c6d0: 745c 2773 2072 6564 6566 696e 6520 7468  t\'s redefine th
-0000c6e0: 6520 6067 6574 5f61 6767 7265 6761 7465  e `get_aggregate
-0000c6f0: 2829 6020 6675 6e63 7469 6f6e 2c20 736f  ()` function, so
-0000c700: 2074 6861 7420 6974 206c 6f6f 6b73 2066   that it looks f
-0000c710: 6f72 2061 2073 6e61 7073 686f 7420 6576  or a snapshot ev
-0000c720: 656e 742c 5c6e 7468 656e 2073 656c 6563  ent,\nthen selec
-0000c730: 7473 2073 7562 7365 7175 656e 7420 6167  ts subsequent ag
-0000c740: 6772 6567 6174 6520 6576 656e 7473 2c20  gregate events, 
-0000c750: 616e 6420 7468 656e 2063 616c 6c73 2061  and then calls a
-0000c760: 206d 7574 6174 6f72 2066 756e 6374 696f   mutator functio
-0000c770: 6e20 666f 7220 6561 6368 5c6e 7265 636f  n for each\nreco
-0000c780: 7264 6564 2065 7665 6e74 2e5c 6e5c 6e4e  rded event.\n\nN
-0000c790: 6f74 6963 6520 7468 6174 2074 6865 2061  otice that the a
-0000c7a0: 6767 7265 6761 7465 2065 7665 6e74 7320  ggregate events 
-0000c7b0: 6172 6520 7265 6164 2066 726f 6d20 6120  are read from a 
-0000c7c0: 7374 7265 616d 2066 6f72 2073 6572 6961  stream for seria
-0000c7d0: 6c69 7a65 6420 6167 6772 6567 6174 655c  lized aggregate\
-0000c7e0: 6e65 7665 6e74 732c 2077 6869 6c73 7420  nevents, whilst 
-0000c7f0: 7468 6520 736e 6170 7368 6f74 2069 7320  the snapshot is 
-0000c800: 7265 6164 2066 726f 6d20 6120 7365 7061  read from a sepa
-0000c810: 7261 7465 2073 7472 6561 6d20 666f 7220  rate stream for 
-0000c820: 7365 7269 616c 697a 6564 2061 6767 7265  serialized aggre
-0000c830: 6761 7465 5c6e 736e 6170 7368 6f74 732e  gate\nsnapshots.
-0000c840: 2057 6520 7769 6c6c 2075 7365 204a 534f   We will use JSO
-0000c850: 4e20 746f 2073 6572 6961 6c69 7a65 2061  N to serialize a
-0000c860: 6e64 2064 6573 6572 6961 6c69 7a65 2065  nd deserialize e
-0000c870: 7665 6e74 2064 6174 612e 5c6e 5c6e 5c6e  vent data.\n\n\n
-0000c880: 6060 6070 7974 686f 6e5c 6e69 6d70 6f72  ```python\nimpor
-0000c890: 7420 6a73 6f6e 5c6e 5c6e 5c6e 6465 6620  t json\n\n\ndef 
-0000c8a0: 6765 745f 6167 6772 6567 6174 6528 6167  get_aggregate(ag
-0000c8b0: 6772 6567 6174 655f 6964 2c20 6d75 7461  gregate_id, muta
-0000c8c0: 746f 725f 6675 6e63 293a 5c6e 2020 2020  tor_func):\n    
-0000c8d0: 7374 7265 616d 5f6e 616d 6520 3d20 6167  stream_name = ag
-0000c8e0: 6772 6567 6174 655f 6964 5c6e 2020 2020  gregate_id\n    
-0000c8f0: 7265 636f 7264 6564 5f65 7665 6e74 7320  recorded_events 
-0000c900: 3d20 5b5d 5c6e 5c6e 2020 2020 2320 4c6f  = []\n\n    # Lo
-0000c910: 6f6b 2066 6f72 2061 2073 6e61 7073 686f  ok for a snapsho
-0000c920: 742e 5c6e 2020 2020 7472 793a 5c6e 2020  t.\n    try:\n  
-0000c930: 2020 2020 2020 736e 6170 7368 6f74 7320        snapshots 
-0000c940: 3d20 636c 6965 6e74 2e67 6574 5f73 7472  = client.get_str
-0000c950: 6561 6d28 5c6e 2020 2020 2020 2020 2020  eam(\n          
-0000c960: 2020 7374 7265 616d 5f6e 616d 653d 6d61    stream_name=ma
-0000c970: 6b65 5f73 6e61 7073 686f 745f 7374 7265  ke_snapshot_stre
-0000c980: 616d 5f6e 616d 6528 7374 7265 616d 5f6e  am_name(stream_n
-0000c990: 616d 6529 2c5c 6e20 2020 2020 2020 2020  ame),\n         
-0000c9a0: 2020 2062 6163 6b77 6172 6473 3d54 7275     backwards=Tru
-0000c9b0: 652c 5c6e 2020 2020 2020 2020 2020 2020  e,\n            
-0000c9c0: 6c69 6d69 743d 315c 6e20 2020 2020 2020  limit=1\n       
-0000c9d0: 2029 5c6e 2020 2020 6578 6365 7074 204e   )\n    except N
-0000c9e0: 6f74 466f 756e 643a 5c6e 2020 2020 2020  otFound:\n      
-0000c9f0: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
-0000ca00: 6e20 3d20 4e6f 6e65 5c6e 2020 2020 656c  n = None\n    el
-0000ca10: 7365 3a5c 6e20 2020 2020 2020 2061 7373  se:\n        ass
-0000ca20: 6572 7420 6c65 6e28 736e 6170 7368 6f74  ert len(snapshot
-0000ca30: 7329 203d 3d20 315c 6e20 2020 2020 2020  s) == 1\n       
-0000ca40: 2073 6e61 7073 686f 7420 3d20 736e 6170   snapshot = snap
-0000ca50: 7368 6f74 735b 305d 5c6e 2020 2020 2020  shots[0]\n      
-0000ca60: 2020 7374 7265 616d 5f70 6f73 6974 696f    stream_positio
-0000ca70: 6e20 3d20 6465 7365 7269 616c 697a 6528  n = deserialize(
-0000ca80: 736e 6170 7368 6f74 2e6d 6574 6164 6174  snapshot.metadat
-0000ca90: 6129 5b5c 2776 6572 7369 6f6e 5c27 5d20  a)[\'version\'] 
-0000caa0: 2b20 315c 6e20 2020 2020 2020 2072 6563  + 1\n        rec
-0000cab0: 6f72 6465 645f 6576 656e 7473 2e61 7070  orded_events.app
-0000cac0: 656e 6428 736e 6170 7368 6f74 295c 6e5c  end(snapshot)\n\
-0000cad0: 6e20 2020 2023 2047 6574 2073 7562 7365  n    # Get subse
-0000cae0: 7175 656e 7420 6576 656e 7473 2e5c 6e20  quent events.\n 
-0000caf0: 2020 2074 7279 3a5c 6e20 2020 2020 2020     try:\n       
-0000cb00: 2065 7665 6e74 7320 3d20 636c 6965 6e74   events = client
-0000cb10: 2e67 6574 5f73 7472 6561 6d28 5c6e 2020  .get_stream(\n  
-0000cb20: 2020 2020 2020 2020 2020 7374 7265 616d            stream
-0000cb30: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-0000cb40: 652c 5c6e 2020 2020 2020 2020 2020 2020  e,\n            
-0000cb50: 7374 7265 616d 5f70 6f73 6974 696f 6e3d  stream_position=
-0000cb60: 7374 7265 616d 5f70 6f73 6974 696f 6e5c  stream_position\
-0000cb70: 6e20 2020 2020 2020 2029 5c6e 2020 2020  n        )\n    
-0000cb80: 6578 6365 7074 204e 6f74 466f 756e 6420  except NotFound 
-0000cb90: 6173 2065 3a5c 6e20 2020 2020 2020 2072  as e:\n        r
-0000cba0: 6169 7365 2041 6767 7265 6761 7465 4e6f  aise AggregateNo
-0000cbb0: 7446 6f75 6e64 2861 6767 7265 6761 7465  tFound(aggregate
-0000cbc0: 5f69 6429 2066 726f 6d20 655c 6e20 2020  _id) from e\n   
-0000cbd0: 2065 6c73 653a 5c6e 2020 2020 2020 2020   else:\n        
-0000cbe0: 7265 636f 7264 6564 5f65 7665 6e74 7320  recorded_events 
-0000cbf0: 2b3d 2065 7665 6e74 735c 6e5c 6e20 2020  += events\n\n   
-0000cc00: 2023 2052 6563 6f6e 7374 7275 6374 2061   # Reconstruct a
-0000cc10: 6767 7265 6761 7465 2066 726f 6d20 7265  ggregate from re
-0000cc20: 636f 7264 6564 2065 7665 6e74 732e 5c6e  corded events.\n
-0000cc30: 2020 2020 6167 6772 6567 6174 6520 3d20      aggregate = 
-0000cc40: 4e6f 6e65 5c6e 2020 2020 666f 7220 6576  None\n    for ev
-0000cc50: 656e 7420 696e 2072 6563 6f72 6465 645f  ent in recorded_
-0000cc60: 6576 656e 7473 3a5c 6e20 2020 2020 2020  events:\n       
-0000cc70: 2061 6767 7265 6761 7465 203d 206d 7574   aggregate = mut
-0000cc80: 6174 6f72 5f66 756e 6328 6167 6772 6567  ator_func(aggreg
-0000cc90: 6174 652c 2065 7665 6e74 295c 6e5c 6e20  ate, event)\n\n 
-0000cca0: 2020 2072 6574 7572 6e20 6167 6772 6567     return aggreg
-0000ccb0: 6174 655c 6e5c 6e5c 6e64 6566 2073 6572  ate\n\n\ndef ser
-0000ccc0: 6961 6c69 7a65 2864 293a 5c6e 2020 2020  ialize(d):\n    
-0000ccd0: 7265 7475 726e 206a 736f 6e2e 6475 6d70  return json.dump
-0000cce0: 7328 6429 2e65 6e63 6f64 6528 5c27 7574  s(d).encode(\'ut
-0000ccf0: 6638 5c27 295c 6e5c 6e5c 6e64 6566 2064  f8\')\n\n\ndef d
-0000cd00: 6573 6572 6961 6c69 7a65 2873 293a 5c6e  eserialize(s):\n
-0000cd10: 2020 2020 7265 7475 726e 206a 736f 6e2e      return json.
-0000cd20: 6c6f 6164 7328 732e 6465 636f 6465 285c  loads(s.decode(\
-0000cd30: 2775 7466 385c 2729 295c 6e60 6060 5c6e  'utf8\'))\n```\n
-0000cd40: 5c6e 546f 2073 686f 7720 686f 7720 6067  \nTo show how `g
-0000cd50: 6574 5f61 6767 7265 6761 7465 2829 6020  et_aggregate()` 
-0000cd60: 6361 6e20 6265 2075 7365 642c 206c 6574  can be used, let
-0000cd70: 5c27 7320 6465 6669 6e65 2061 2060 446f  \'s define a `Do
-0000cd80: 6760 2061 6767 7265 6761 7465 2063 6c61  g` aggregate cla
-0000cd90: 7373 2c20 7769 7468 5c6e 6174 7472 6962  ss, with\nattrib
-0000cda0: 7574 6573 2060 6e61 6d65 6020 616e 6420  utes `name` and 
-0000cdb0: 6074 7269 636b 7360 2e20 5468 6520 6174  `tricks`. The at
-0000cdc0: 7472 6962 7574 6573 2060 6964 6020 616e  tributes `id` an
-0000cdd0: 6420 6076 6572 7369 6f6e 6020 7769 6c6c  d `version` will
-0000cde0: 2069 6e64 6963 6174 6520 616e 5c6e 6167   indicate an\nag
-0000cdf0: 6772 6567 6174 6520 6f62 6a65 6374 5c27  gregate object\'
-0000ce00: 7320 4944 2061 6e64 2076 6572 7369 6f6e  s ID and version
-0000ce10: 206e 756d 6265 722e 2054 6865 2061 7474   number. The att
-0000ce20: 7269 6275 7465 2060 6973 5f66 726f 6d5f  ribute `is_from_
-0000ce30: 736e 6170 7368 6f74 6020 6973 2061 6464  snapshot` is add
-0000ce40: 6564 5c6e 6865 7265 206d 6572 656c 7920  ed\nhere merely 
-0000ce50: 746f 2064 656d 6f6e 7374 7261 7465 2062  to demonstrate b
-0000ce60: 656c 6f77 2077 6865 6e20 616e 2061 6767  elow when an agg
-0000ce70: 7265 6761 7465 206f 626a 6563 7420 6861  regate object ha
-0000ce80: 7320 6265 656e 2072 6563 6f6e 7374 7275  s been reconstru
-0000ce90: 6374 6564 2075 7369 6e67 5c6e 6120 736e  cted using\na sn
-0000cea0: 6170 7368 6f74 2e5c 6e5c 6e60 6060 7079  apshot.\n\n```py
-0000ceb0: 7468 6f6e 5c6e 6672 6f6d 2064 6174 6163  thon\nfrom datac
-0000cec0: 6c61 7373 6573 2069 6d70 6f72 7420 6461  lasses import da
-0000ced0: 7461 636c 6173 735c 6e5c 6e5c 6e40 6461  taclass\n\n\n@da
-0000cee0: 7461 636c 6173 7328 6672 6f7a 656e 3d54  taclass(frozen=T
-0000cef0: 7275 6529 5c6e 636c 6173 7320 4167 6772  rue)\nclass Aggr
-0000cf00: 6567 6174 653a 5c6e 2020 2020 6964 3a20  egate:\n    id: 
-0000cf10: 7374 725c 6e20 2020 2076 6572 7369 6f6e  str\n    version
-0000cf20: 3a20 696e 745c 6e20 2020 2069 735f 6672  : int\n    is_fr
-0000cf30: 6f6d 5f73 6e61 7073 686f 743a 2062 6f6f  om_snapshot: boo
-0000cf40: 6c5c 6e5c 6e5c 6e40 6461 7461 636c 6173  l\n\n\n@dataclas
-0000cf50: 7328 6672 6f7a 656e 3d54 7275 6529 5c6e  s(frozen=True)\n
-0000cf60: 636c 6173 7320 446f 6728 4167 6772 6567  class Dog(Aggreg
-0000cf70: 6174 6529 3a5c 6e20 2020 206e 616d 653a  ate):\n    name:
-0000cf80: 2073 7472 5c6e 2020 2020 7472 6963 6b73   str\n    tricks
-0000cf90: 3a20 6c69 7374 5c6e 6060 605c 6e5c 6e4c  : list\n```\n\nL
-0000cfa0: 6574 5c27 7320 616c 736f 2064 6566 696e  et\'s also defin
-0000cfb0: 6520 6120 6d75 7461 746f 7220 6675 6e63  e a mutator func
-0000cfc0: 7469 6f6e 2060 6d75 7461 7465 5f64 6f67  tion `mutate_dog
-0000cfd0: 2829 6020 7468 6174 2065 766f 6c76 6573  ()` that evolves
-0000cfe0: 2074 6865 2073 7461 7465 206f 6620 615c   the state of a\
-0000cff0: 6e60 446f 6760 2061 6767 7265 6761 7465  n`Dog` aggregate
-0000d000: 2067 6976 656e 2076 6172 696f 7573 2064   given various d
-0000d010: 6966 6665 7265 6e74 2074 7970 6573 206f  ifferent types o
-0000d020: 6620 6576 656e 7473 2c20 605c 2744 6f67  f events, `\'Dog
-0000d030: 5265 6769 7374 6572 6564 5c27 602c 5c6e  Registered\'`,\n
-0000d040: 605c 2744 6f67 4c65 6172 6e65 6454 7269  `\'DogLearnedTri
-0000d050: 636b 5c27 602c 2061 6e64 2060 5c27 536e  ck\'`, and `\'Sn
-0000d060: 6170 7368 6f74 5c27 602e 5c6e 5c6e 6060  apshot\'`.\n\n``
-0000d070: 6070 7974 686f 6e5c 6e64 6566 206d 7574  `python\ndef mut
-0000d080: 6174 655f 646f 6728 646f 672c 2065 7665  ate_dog(dog, eve
-0000d090: 6e74 293a 5c6e 2020 2020 6461 7461 203d  nt):\n    data =
-0000d0a0: 2064 6573 6572 6961 6c69 7a65 2865 7665   deserialize(eve
-0000d0b0: 6e74 2e64 6174 6129 5c6e 2020 2020 6966  nt.data)\n    if
-0000d0c0: 2065 7665 6e74 2e74 7970 6520 3d3d 205c   event.type == \
-0000d0d0: 2744 6f67 5265 6769 7374 6572 6564 5c27  'DogRegistered\'
-0000d0e0: 3a5c 6e20 2020 2020 2020 2072 6574 7572  :\n        retur
-0000d0f0: 6e20 446f 6728 5c6e 2020 2020 2020 2020  n Dog(\n        
-0000d100: 2020 2020 6964 3d65 7665 6e74 2e73 7472      id=event.str
-0000d110: 6561 6d5f 6e61 6d65 2c5c 6e20 2020 2020  eam_name,\n     
-0000d120: 2020 2020 2020 2076 6572 7369 6f6e 3d65         version=e
-0000d130: 7665 6e74 2e73 7472 6561 6d5f 706f 7369  vent.stream_posi
-0000d140: 7469 6f6e 2c5c 6e20 2020 2020 2020 2020  tion,\n         
-0000d150: 2020 2069 735f 6672 6f6d 5f73 6e61 7073     is_from_snaps
-0000d160: 686f 743d 4661 6c73 652c 5c6e 2020 2020  hot=False,\n    
-0000d170: 2020 2020 2020 2020 6e61 6d65 3d64 6174          name=dat
-0000d180: 615b 5c27 6e61 6d65 5c27 5d2c 5c6e 2020  a[\'name\'],\n  
-0000d190: 2020 2020 2020 2020 2020 7472 6963 6b73            tricks
-0000d1a0: 3d5b 5d2c 5c6e 2020 2020 2020 2020 295c  =[],\n        )\
-0000d1b0: 6e20 2020 2065 6c69 6620 6576 656e 742e  n    elif event.
-0000d1c0: 7479 7065 203d 3d20 5c27 446f 674c 6561  type == \'DogLea
-0000d1d0: 726e 6564 5472 6963 6b5c 273a 5c6e 2020  rnedTrick\':\n  
-0000d1e0: 2020 2020 2020 6173 7365 7274 2065 7665        assert eve
-0000d1f0: 6e74 2e73 7472 6561 6d5f 706f 7369 7469  nt.stream_positi
-0000d200: 6f6e 203d 3d20 646f 672e 7665 7273 696f  on == dog.versio
-0000d210: 6e20 2b20 315c 6e20 2020 2020 2020 2061  n + 1\n        a
-0000d220: 7373 6572 7420 6576 656e 742e 7374 7265  ssert event.stre
-0000d230: 616d 5f6e 616d 6520 3d3d 2064 6f67 2e69  am_name == dog.i
-0000d240: 642c 2028 6576 656e 742e 7374 7265 616d  d, (event.stream
-0000d250: 5f6e 616d 652c 2064 6f67 2e69 6429 5c6e  _name, dog.id)\n
-0000d260: 2020 2020 2020 2020 7265 7475 726e 2044          return D
-0000d270: 6f67 285c 6e20 2020 2020 2020 2020 2020  og(\n           
-0000d280: 2069 643d 646f 672e 6964 2c5c 6e20 2020   id=dog.id,\n   
-0000d290: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
-0000d2a0: 3d65 7665 6e74 2e73 7472 6561 6d5f 706f  =event.stream_po
-0000d2b0: 7369 7469 6f6e 2c5c 6e20 2020 2020 2020  sition,\n       
-0000d2c0: 2020 2020 2069 735f 6672 6f6d 5f73 6e61       is_from_sna
-0000d2d0: 7073 686f 743d 646f 672e 6973 5f66 726f  pshot=dog.is_fro
-0000d2e0: 6d5f 736e 6170 7368 6f74 2c5c 6e20 2020  m_snapshot,\n   
-0000d2f0: 2020 2020 2020 2020 206e 616d 653d 646f           name=do
-0000d300: 672e 6e61 6d65 2c5c 6e20 2020 2020 2020  g.name,\n       
-0000d310: 2020 2020 2074 7269 636b 733d 646f 672e       tricks=dog.
-0000d320: 7472 6963 6b73 202b 205b 6461 7461 5b5c  tricks + [data[\
-0000d330: 2774 7269 636b 5c27 5d5d 2c5c 6e20 2020  'trick\']],\n   
-0000d340: 2020 2020 2029 5c6e 2020 2020 656c 6966       )\n    elif
-0000d350: 2065 7665 6e74 2e74 7970 6520 3d3d 205c   event.type == \
-0000d360: 2753 6e61 7073 686f 745c 273a 5c6e 2020  'Snapshot\':\n  
-0000d370: 2020 2020 2020 7265 7475 726e 2044 6f67        return Dog
-0000d380: 285c 6e20 2020 2020 2020 2020 2020 2069  (\n            i
-0000d390: 643d 7265 6d6f 7665 5f73 6e61 7073 686f  d=remove_snapsho
-0000d3a0: 745f 7374 7265 616d 5f70 7265 6669 7828  t_stream_prefix(
-0000d3b0: 6576 656e 742e 7374 7265 616d 5f6e 616d  event.stream_nam
-0000d3c0: 6529 2c5c 6e20 2020 2020 2020 2020 2020  e),\n           
-0000d3d0: 2076 6572 7369 6f6e 3d64 6573 6572 6961   version=deseria
-0000d3e0: 6c69 7a65 2865 7665 6e74 2e6d 6574 6164  lize(event.metad
-0000d3f0: 6174 6129 5b5c 2776 6572 7369 6f6e 5c27  ata)[\'version\'
-0000d400: 5d2c 5c6e 2020 2020 2020 2020 2020 2020  ],\n            
-0000d410: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
-0000d420: 3d54 7275 652c 5c6e 2020 2020 2020 2020  =True,\n        
-0000d430: 2020 2020 6e61 6d65 3d64 6174 615b 5c27      name=data[\'
-0000d440: 6e61 6d65 5c27 5d2c 5c6e 2020 2020 2020  name\'],\n      
-0000d450: 2020 2020 2020 7472 6963 6b73 3d64 6174        tricks=dat
-0000d460: 615b 5c27 7472 6963 6b73 5c27 5d2c 5c6e  a[\'tricks\'],\n
-0000d470: 2020 2020 2020 2020 295c 6e20 2020 2065          )\n    e
-0000d480: 6c73 653a 5c6e 2020 2020 2020 2020 7261  lse:\n        ra
-0000d490: 6973 6520 4578 6365 7074 696f 6e28 6622  ise Exception(f"
-0000d4a0: 556e 6b6e 6f77 6e20 6576 656e 7420 7479  Unknown event ty
-0000d4b0: 7065 3a20 7b65 7665 6e74 2e74 7970 657d  pe: {event.type}
-0000d4c0: 2229 5c6e 6060 605c 6e5c 6e46 6f72 2063  ")\n```\n\nFor c
-0000d4d0: 6f6e 7665 6e69 656e 6365 2c20 6c65 745c  onvenience, let\
-0000d4e0: 2773 2061 6c73 6f20 6465 6669 6e65 2061  's also define a
-0000d4f0: 2060 6765 745f 646f 6728 2960 2066 756e   `get_dog()` fun
-0000d500: 6374 696f 6e20 7468 6174 2063 616c 6c73  ction that calls
-0000d510: 2060 6765 745f 6167 6772 6567 6174 6528   `get_aggregate(
-0000d520: 2960 5c6e 7769 7468 2074 6865 2060 6d75  )`\nwith the `mu
-0000d530: 7461 7465 5f64 6f67 2829 6020 6675 6e63  tate_dog()` func
-0000d540: 7469 6f6e 2061 7320 7468 6520 7661 6c75  tion as the valu
-0000d550: 6520 6f66 2069 7473 2060 6d75 7461 746f  e of its `mutato
-0000d560: 725f 6675 6e63 6020 6172 6775 6d65 6e74  r_func` argument
-0000d570: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-0000d580: 6465 6620 6765 745f 646f 6728 646f 675f  def get_dog(dog_
-0000d590: 6964 293a 5c6e 2020 2020 7265 7475 726e  id):\n    return
-0000d5a0: 2067 6574 5f61 6767 7265 6761 7465 285c   get_aggregate(\
-0000d5b0: 6e20 2020 2020 2020 2061 6767 7265 6761  n        aggrega
-0000d5c0: 7465 5f69 643d 646f 675f 6964 2c5c 6e20  te_id=dog_id,\n 
-0000d5d0: 2020 2020 2020 206d 7574 6174 6f72 5f66         mutator_f
-0000d5e0: 756e 633d 6d75 7461 7465 5f64 6f67 2c5c  unc=mutate_dog,\
-0000d5f0: 6e20 2020 2029 5c6e 6060 605c 6e5c 6e57  n    )\n```\n\nW
-0000d600: 6520 6361 6e20 616c 736f 2064 6566 696e  e can also defin
-0000d610: 6520 736f 6d65 2022 636f 6d6d 616e 6422  e some "command"
-0000d620: 2066 756e 6374 696f 6e73 2074 6861 7420   functions that 
-0000d630: 6170 7065 6e64 206e 6577 2065 7665 6e74  append new event
-0000d640: 7320 746f 2074 6865 5c6e 6461 7461 6261  s to the\ndataba
-0000d650: 7365 2e20 5468 6520 6072 6567 6973 7465  se. The `registe
-0000d660: 725f 646f 6728 2960 2066 756e 6374 696f  r_dog()` functio
-0000d670: 6e20 6170 7065 6e64 7320 6120 6044 6f67  n appends a `Dog
-0000d680: 5265 6769 7374 6572 6564 6020 6576 656e  Registered` even
-0000d690: 742e 2054 6865 5c6e 6072 6563 6f72 645f  t. The\n`record_
-0000d6a0: 7472 6963 6b5f 6c65 6172 6e65 6428 2960  trick_learned()`
-0000d6b0: 2061 7070 656e 6473 2061 2060 446f 674c   appends a `DogL
-0000d6c0: 6561 726e 6564 5472 6963 6b60 2065 7665  earnedTrick` eve
-0000d6d0: 6e74 2e20 5468 6520 6675 6e63 7469 6f6e  nt. The function
-0000d6e0: 5c6e 6073 6e61 7073 686f 745f 646f 6728  \n`snapshot_dog(
-0000d6f0: 2960 2061 7070 656e 6473 2061 2060 536e  )` appends a `Sn
-0000d700: 6170 7368 6f74 6020 6576 656e 742e 204e  apshot` event. N
-0000d710: 6f74 6963 6520 7468 6174 2074 6865 5c6e  otice that the\n
-0000d720: 6072 6563 6f72 645f 7472 6963 6b5f 6c65  `record_trick_le
-0000d730: 6172 6e65 6428 2960 2061 6e64 2060 736e  arned()` and `sn
-0000d740: 6170 7368 6f74 5f64 6f67 2829 6020 6675  apshot_dog()` fu
-0000d750: 6e63 7469 6f6e 7320 7573 6520 6067 6574  nctions use `get
-0000d760: 5f64 6f67 2829 602e 5c6e 5c6e 4e6f 7469  _dog()`.\n\nNoti
-0000d770: 6365 2061 6c73 6f20 7468 6174 2074 6865  ce also that the
-0000d780: 2060 446f 6752 6567 6973 7465 7265 6460   `DogRegistered`
-0000d790: 2061 6e64 2060 446f 674c 6561 726e 6564   and `DogLearned
-0000d7a0: 5472 6963 6b60 2065 7665 6e74 7320 6172  Trick` events ar
-0000d7b0: 6520 6170 7065 6e64 6564 2074 6f20 615c  e appended to a\
-0000d7c0: 6e73 7472 6561 6d20 666f 7220 6167 6772  nstream for aggr
-0000d7d0: 6567 6174 6520 6576 656e 7473 2c20 7768  egate events, wh
-0000d7e0: 696c 7374 2074 6865 2060 536e 6170 7368  ilst the `Snapsh
-0000d7f0: 6f74 6020 6576 656e 7420 6973 2061 7070  ot` event is app
-0000d800: 656e 6465 6420 746f 2061 2073 6570 6172  ended to a separ
-0000d810: 6174 655c 6e73 7472 6561 6d20 666f 7220  ate\nstream for 
-0000d820: 6167 6772 6567 6174 6520 736e 6170 7368  aggregate snapsh
-0000d830: 6f74 732e 5c6e 5c6e 6060 6070 7974 686f  ots.\n\n```pytho
-0000d840: 6e5c 6e64 6566 2072 6567 6973 7465 725f  n\ndef register_
-0000d850: 646f 6728 6e61 6d65 293a 5c6e 2020 2020  dog(name):\n    
-0000d860: 646f 675f 6964 203d 2073 7472 2875 7569  dog_id = str(uui
-0000d870: 642e 7575 6964 3428 2929 5c6e 2020 2020  d.uuid4())\n    
-0000d880: 6576 656e 7420 3d20 4e65 7745 7665 6e74  event = NewEvent
-0000d890: 285c 6e20 2020 2020 2020 2074 7970 653d  (\n        type=
-0000d8a0: 5c27 446f 6752 6567 6973 7465 7265 645c  \'DogRegistered\
-0000d8b0: 272c 5c6e 2020 2020 2020 2020 6461 7461  ',\n        data
-0000d8c0: 3d73 6572 6961 6c69 7a65 287b 5c27 6e61  =serialize({\'na
-0000d8d0: 6d65 5c27 3a20 6e61 6d65 7d29 2c5c 6e20  me\': name}),\n 
-0000d8e0: 2020 2029 5c6e 2020 2020 636c 6965 6e74     )\n    client
-0000d8f0: 2e61 7070 656e 645f 746f 5f73 7472 6561  .append_to_strea
-0000d900: 6d28 5c6e 2020 2020 2020 2020 7374 7265  m(\n        stre
-0000d910: 616d 5f6e 616d 653d 646f 675f 6964 2c5c  am_name=dog_id,\
-0000d920: 6e20 2020 2020 2020 2063 7572 7265 6e74  n        current
-0000d930: 5f76 6572 7369 6f6e 3d53 7472 6561 6d53  _version=StreamS
-0000d940: 7461 7465 2e4e 4f5f 5354 5245 414d 2c5c  tate.NO_STREAM,\
-0000d950: 6e20 2020 2020 2020 2065 7665 6e74 733d  n        events=
-0000d960: 6576 656e 742c 5c6e 2020 2020 295c 6e20  event,\n    )\n 
-0000d970: 2020 2072 6574 7572 6e20 646f 675f 6964     return dog_id
-0000d980: 5c6e 5c6e 5c6e 6465 6620 7265 636f 7264  \n\n\ndef record
-0000d990: 5f74 7269 636b 5f6c 6561 726e 6564 2864  _trick_learned(d
-0000d9a0: 6f67 5f69 642c 2074 7269 636b 293a 5c6e  og_id, trick):\n
-0000d9b0: 2020 2020 646f 6720 3d20 6765 745f 646f      dog = get_do
-0000d9c0: 6728 646f 675f 6964 295c 6e20 2020 2065  g(dog_id)\n    e
-0000d9d0: 7665 6e74 203d 204e 6577 4576 656e 7428  vent = NewEvent(
-0000d9e0: 5c6e 2020 2020 2020 2020 7479 7065 3d5c  \n        type=\
-0000d9f0: 2744 6f67 4c65 6172 6e65 6454 7269 636b  'DogLearnedTrick
-0000da00: 5c27 2c5c 6e20 2020 2020 2020 2064 6174  \',\n        dat
-0000da10: 613d 7365 7269 616c 697a 6528 7b5c 2774  a=serialize({\'t
-0000da20: 7269 636b 5c27 3a20 7472 6963 6b7d 292c  rick\': trick}),
-0000da30: 5c6e 2020 2020 295c 6e20 2020 2063 6c69  \n    )\n    cli
-0000da40: 656e 742e 6170 7065 6e64 5f74 6f5f 7374  ent.append_to_st
-0000da50: 7265 616d 285c 6e20 2020 2020 2020 2073  ream(\n        s
-0000da60: 7472 6561 6d5f 6e61 6d65 3d64 6f67 5f69  tream_name=dog_i
-0000da70: 642c 5c6e 2020 2020 2020 2020 6375 7272  d,\n        curr
-0000da80: 656e 745f 7665 7273 696f 6e3d 646f 672e  ent_version=dog.
-0000da90: 7665 7273 696f 6e2c 5c6e 2020 2020 2020  version,\n      
-0000daa0: 2020 6576 656e 7473 3d65 7665 6e74 2c5c    events=event,\
-0000dab0: 6e20 2020 2029 5c6e 5c6e 5c6e 6465 6620  n    )\n\n\ndef 
-0000dac0: 736e 6170 7368 6f74 5f64 6f67 2864 6f67  snapshot_dog(dog
-0000dad0: 5f69 6429 3a5c 6e20 2020 2064 6f67 203d  _id):\n    dog =
-0000dae0: 2067 6574 5f64 6f67 2864 6f67 5f69 6429   get_dog(dog_id)
-0000daf0: 5c6e 2020 2020 6576 656e 7420 3d20 4e65  \n    event = Ne
-0000db00: 7745 7665 6e74 285c 6e20 2020 2020 2020  wEvent(\n       
-0000db10: 2074 7970 653d 5c27 536e 6170 7368 6f74   type=\'Snapshot
-0000db20: 5c27 2c5c 6e20 2020 2020 2020 2064 6174  \',\n        dat
-0000db30: 613d 7365 7269 616c 697a 6528 7b5c 276e  a=serialize({\'n
-0000db40: 616d 655c 273a 2064 6f67 2e6e 616d 652c  ame\': dog.name,
-0000db50: 205c 2774 7269 636b 735c 273a 2064 6f67   \'tricks\': dog
-0000db60: 2e74 7269 636b 737d 292c 5c6e 2020 2020  .tricks}),\n    
-0000db70: 2020 2020 6d65 7461 6461 7461 3d73 6572      metadata=ser
-0000db80: 6961 6c69 7a65 287b 5c27 7665 7273 696f  ialize({\'versio
-0000db90: 6e5c 273a 2064 6f67 2e76 6572 7369 6f6e  n\': dog.version
-0000dba0: 7d29 2c5c 6e20 2020 2029 5c6e 2020 2020  }),\n    )\n    
-0000dbb0: 636c 6965 6e74 2e61 7070 656e 645f 746f  client.append_to
-0000dbc0: 5f73 7472 6561 6d28 5c6e 2020 2020 2020  _stream(\n      
-0000dbd0: 2020 7374 7265 616d 5f6e 616d 653d 6d61    stream_name=ma
-0000dbe0: 6b65 5f73 6e61 7073 686f 745f 7374 7265  ke_snapshot_stre
-0000dbf0: 616d 5f6e 616d 6528 646f 675f 6964 292c  am_name(dog_id),
-0000dc00: 5c6e 2020 2020 2020 2020 6375 7272 656e  \n        curren
-0000dc10: 745f 7665 7273 696f 6e3d 5374 7265 616d  t_version=Stream
-0000dc20: 5374 6174 652e 414e 592c 5c6e 2020 2020  State.ANY,\n    
-0000dc30: 2020 2020 6576 656e 7473 3d65 7665 6e74      events=event
-0000dc40: 2c5c 6e20 2020 2029 5c6e 6060 605c 6e5c  ,\n    )\n```\n\
-0000dc50: 6e57 6520 6361 6e20 6361 6c6c 2060 7265  nWe can call `re
-0000dc60: 6769 7374 6572 5f64 6f67 2829 6020 746f  gister_dog()` to
-0000dc70: 2072 6567 6973 7465 7220 6120 6e65 7720   register a new 
-0000dc80: 646f 672e 5c6e 5c6e 6060 6070 7974 686f  dog.\n\n```pytho
-0000dc90: 6e5c 6e23 2052 6567 6973 7465 7220 6120  n\n# Register a 
-0000dca0: 6e65 7720 646f 672e 5c6e 646f 675f 6964  new dog.\ndog_id
-0000dcb0: 203d 2072 6567 6973 7465 725f 646f 6728   = register_dog(
-0000dcc0: 5c27 4669 646f 5c27 295c 6e5c 6e64 6f67  \'Fido\')\n\ndog
-0000dcd0: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
-0000dce0: 6429 5c6e 6173 7365 7274 2064 6f67 2e6e  d)\nassert dog.n
-0000dcf0: 616d 6520 3d3d 205c 2746 6964 6f5c 275c  ame == \'Fido\'\
-0000dd00: 6e61 7373 6572 7420 646f 672e 7472 6963  nassert dog.tric
-0000dd10: 6b73 203d 3d20 5b5d 5c6e 6173 7365 7274  ks == []\nassert
-0000dd20: 2064 6f67 2e76 6572 7369 6f6e 203d 3d20   dog.version == 
-0000dd30: 305c 6e61 7373 6572 7420 646f 672e 6973  0\nassert dog.is
-0000dd40: 5f66 726f 6d5f 736e 6170 7368 6f74 2069  _from_snapshot i
-0000dd50: 7320 4661 6c73 655c 6e5c 6e60 6060 5c6e  s False\n\n```\n
-0000dd60: 5c6e 5765 2063 616e 2063 616c 6c20 6072  \nWe can call `r
-0000dd70: 6563 6f72 645f 7472 6963 6b5f 6c65 6172  ecord_trick_lear
-0000dd80: 6e65 6428 2960 2074 6f20 7265 636f 7264  ned()` to record
-0000dd90: 2074 6861 7420 736f 6d65 2074 7269 636b   that some trick
-0000dda0: 7320 6861 7665 2062 6565 6e20 6c65 6172  s have been lear
-0000ddb0: 6e65 642e 5c6e 5c6e 6060 6070 7974 686f  ned.\n\n```pytho
-0000ddc0: 6e5c 6e5c 6e23 2052 6563 6f72 6420 7468  n\n\n# Record th
-0000ddd0: 6174 205c 2746 6964 6f5c 2720 6c65 6172  at \'Fido\' lear
-0000dde0: 6e65 6420 6120 6e65 7720 7472 6963 6b2e  ned a new trick.
-0000ddf0: 5c6e 7265 636f 7264 5f74 7269 636b 5f6c  \nrecord_trick_l
-0000de00: 6561 726e 6564 2864 6f67 5f69 642c 2074  earned(dog_id, t
-0000de10: 7269 636b 3d5c 2772 6f6c 6c20 6f76 6572  rick=\'roll over
-0000de20: 5c27 295c 6e5c 6e64 6f67 203d 2067 6574  \')\n\ndog = get
-0000de30: 5f64 6f67 2864 6f67 5f69 6429 5c6e 6173  _dog(dog_id)\nas
-0000de40: 7365 7274 2064 6f67 2e6e 616d 6520 3d3d  sert dog.name ==
-0000de50: 205c 2746 6964 6f5c 275c 6e61 7373 6572   \'Fido\'\nasser
-0000de60: 7420 646f 672e 7472 6963 6b73 203d 3d20  t dog.tricks == 
-0000de70: 5b5c 2772 6f6c 6c20 6f76 6572 5c27 5d5c  [\'roll over\']\
-0000de80: 6e61 7373 6572 7420 646f 672e 7665 7273  nassert dog.vers
-0000de90: 696f 6e20 3d3d 2031 5c6e 6173 7365 7274  ion == 1\nassert
-0000dea0: 2064 6f67 2e69 735f 6672 6f6d 5f73 6e61   dog.is_from_sna
-0000deb0: 7073 686f 7420 6973 2046 616c 7365 5c6e  pshot is False\n
-0000dec0: 5c6e 5c6e 2320 5265 636f 7264 2074 6861  \n\n# Record tha
-0000ded0: 7420 5c27 4669 646f 5c27 206c 6561 726e  t \'Fido\' learn
-0000dee0: 6564 2061 6e6f 7468 6572 206e 6577 2074  ed another new t
-0000def0: 7269 636b 2e5c 6e72 6563 6f72 645f 7472  rick.\nrecord_tr
-0000df00: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
-0000df10: 6964 2c20 7472 6963 6b3d 5c27 6665 7463  id, trick=\'fetc
-0000df20: 6820 6261 6c6c 5c27 295c 6e5c 6e64 6f67  h ball\')\n\ndog
-0000df30: 203d 2067 6574 5f64 6f67 2864 6f67 5f69   = get_dog(dog_i
-0000df40: 6429 5c6e 6173 7365 7274 2064 6f67 2e6e  d)\nassert dog.n
-0000df50: 616d 6520 3d3d 205c 2746 6964 6f5c 275c  ame == \'Fido\'\
-0000df60: 6e61 7373 6572 7420 646f 672e 7472 6963  nassert dog.tric
-0000df70: 6b73 203d 3d20 5b5c 2772 6f6c 6c20 6f76  ks == [\'roll ov
-0000df80: 6572 5c27 2c20 5c27 6665 7463 6820 6261  er\', \'fetch ba
-0000df90: 6c6c 5c27 5d5c 6e61 7373 6572 7420 646f  ll\']\nassert do
-0000dfa0: 672e 7665 7273 696f 6e20 3d3d 2032 5c6e  g.version == 2\n
-0000dfb0: 6173 7365 7274 2064 6f67 2e69 735f 6672  assert dog.is_fr
-0000dfc0: 6f6d 5f73 6e61 7073 686f 7420 6973 2046  om_snapshot is F
-0000dfd0: 616c 7365 5c6e 6060 605c 6e5c 6e57 6520  alse\n```\n\nWe 
-0000dfe0: 6361 6e20 6361 6c6c 2060 736e 6170 7368  can call `snapsh
-0000dff0: 6f74 5f64 6f67 2829 6020 746f 2072 6563  ot_dog()` to rec
-0000e000: 6f72 6420 6120 736e 6170 7368 6f74 206f  ord a snapshot o
-0000e010: 6620 7468 6520 6375 7272 656e 7420 7374  f the current st
-0000e020: 6174 6520 6f66 2074 6865 2060 446f 6760  ate of the `Dog`
-0000e030: 5c6e 6167 6772 6567 6174 652e 2041 6674  \naggregate. Aft
-0000e040: 6572 2077 6520 6361 6c6c 2060 736e 6170  er we call `snap
-0000e050: 7368 6f74 5f64 6f67 2829 602c 2074 6865  shot_dog()`, the
-0000e060: 2060 6765 745f 646f 6728 2960 2066 756e   `get_dog()` fun
-0000e070: 6374 696f 6e20 7769 6c6c 2072 6574 7572  ction will retur
-0000e080: 6e20 6120 6044 6f67 605c 6e6f 626a 6563  n a `Dog`\nobjec
-0000e090: 7420 7468 6174 2068 6173 2062 6565 6e20  t that has been 
-0000e0a0: 636f 6e73 7472 7563 7465 6420 7573 696e  constructed usin
-0000e0b0: 6720 7468 6520 6053 6e61 7073 686f 7460  g the `Snapshot`
-0000e0c0: 2065 7665 6e74 2e5c 6e5c 6e60 6060 7079   event.\n\n```py
-0000e0d0: 7468 6f6e 5c6e 2320 536e 6170 7368 6f74  thon\n# Snapshot
-0000e0e0: 205c 2746 6964 6f5c 272e 5c6e 736e 6170   \'Fido\'.\nsnap
-0000e0f0: 7368 6f74 5f64 6f67 2864 6f67 5f69 6429  shot_dog(dog_id)
-0000e100: 5c6e 5c6e 646f 6720 3d20 6765 745f 646f  \n\ndog = get_do
-0000e110: 6728 646f 675f 6964 295c 6e61 7373 6572  g(dog_id)\nasser
-0000e120: 7420 646f 672e 6e61 6d65 203d 3d20 5c27  t dog.name == \'
-0000e130: 4669 646f 5c27 5c6e 6173 7365 7274 2064  Fido\'\nassert d
-0000e140: 6f67 2e74 7269 636b 7320 3d3d 205b 5c27  og.tricks == [\'
-0000e150: 726f 6c6c 206f 7665 725c 272c 205c 2766  roll over\', \'f
-0000e160: 6574 6368 2062 616c 6c5c 275d 5c6e 6173  etch ball\']\nas
-0000e170: 7365 7274 2064 6f67 2e76 6572 7369 6f6e  sert dog.version
-0000e180: 203d 3d20 325c 6e61 7373 6572 7420 646f   == 2\nassert do
-0000e190: 672e 6973 5f66 726f 6d5f 736e 6170 7368  g.is_from_snapsh
-0000e1a0: 6f74 2069 7320 5472 7565 5c6e 6060 605c  ot is True\n```\
-0000e1b0: 6e5c 6e57 6520 6361 6e20 636f 6e74 696e  n\nWe can contin
-0000e1c0: 7565 2074 6f20 6576 6f6c 7665 2074 6865  ue to evolve the
-0000e1d0: 2073 7461 7465 206f 6620 7468 6520 6044   state of the `D
-0000e1e0: 6f67 6020 6167 6772 6567 6174 652c 2075  og` aggregate, u
-0000e1f0: 7369 6e67 5c6e 7468 6520 736e 6170 7368  sing\nthe snapsh
-0000e200: 6f74 2062 6f74 6820 6475 7269 6e67 2074  ot both during t
-0000e210: 6865 2063 616c 6c20 746f 2060 7265 636f  he call to `reco
-0000e220: 7264 5f74 7269 636b 5f6c 6561 726e 6564  rd_trick_learned
-0000e230: 2829 6020 616e 645c 6e77 6865 6e20 6361  ()` and\nwhen ca
-0000e240: 6c6c 696e 6720 6067 6574 5f64 6f67 2829  lling `get_dog()
-0000e250: 6020 6469 7265 6374 6c79 2e5c 6e5c 6e60  ` directly.\n\n`
-0000e260: 6060 7079 7468 6f6e 5c6e 7265 636f 7264  ``python\nrecord
-0000e270: 5f74 7269 636b 5f6c 6561 726e 6564 2864  _trick_learned(d
-0000e280: 6f67 5f69 642c 2074 7269 636b 3d5c 2773  og_id, trick=\'s
-0000e290: 6974 5c27 295c 6e5c 6e64 6f67 203d 2067  it\')\n\ndog = g
-0000e2a0: 6574 5f64 6f67 2864 6f67 5f69 6429 5c6e  et_dog(dog_id)\n
-0000e2b0: 6173 7365 7274 2064 6f67 2e6e 616d 6520  assert dog.name 
-0000e2c0: 3d3d 205c 2746 6964 6f5c 275c 6e61 7373  == \'Fido\'\nass
-0000e2d0: 6572 7420 646f 672e 7472 6963 6b73 203d  ert dog.tricks =
-0000e2e0: 3d20 5b5c 2772 6f6c 6c20 6f76 6572 5c27  = [\'roll over\'
-0000e2f0: 2c20 5c27 6665 7463 6820 6261 6c6c 5c27  , \'fetch ball\'
-0000e300: 2c20 5c27 7369 745c 275d 5c6e 6173 7365  , \'sit\']\nasse
-0000e310: 7274 2064 6f67 2e76 6572 7369 6f6e 203d  rt dog.version =
-0000e320: 3d20 335c 6e61 7373 6572 7420 646f 672e  = 3\nassert dog.
-0000e330: 6973 5f66 726f 6d5f 736e 6170 7368 6f74  is_from_snapshot
-0000e340: 2069 7320 5472 7565 5c6e 6060 605c 6e5c   is True\n```\n\
-0000e350: 6e57 6520 6361 6e20 7365 6520 6672 6f6d  nWe can see from
-0000e360: 2074 6865 2060 6973 5f66 726f 6d5f 736e   the `is_from_sn
-0000e370: 6170 7368 6f74 6020 6174 7472 6962 7574  apshot` attribut
-0000e380: 6520 7468 6174 2074 6865 2060 446f 6760  e that the `Dog`
-0000e390: 206f 626a 6563 7420 7761 7320 696e 6465   object was inde
-0000e3a0: 6564 5c6e 7265 636f 6e73 7472 7563 7465  ed\nreconstructe
-0000e3b0: 6420 6672 6f6d 2074 6865 2073 6e61 7073  d from the snaps
-0000e3c0: 686f 742e 5c6e 5c6e 536e 6170 7368 6f74  hot.\n\nSnapshot
-0000e3d0: 7320 6361 6e20 6265 2063 7265 6174 6564  s can be created
-0000e3e0: 2061 7420 6669 7865 6420 7665 7273 696f   at fixed versio
-0000e3f0: 6e20 6e75 6d62 6572 2069 6e74 6572 7661  n number interva
-0000e400: 6c73 2c20 6669 7865 6420 7469 6d65 5c6e  ls, fixed time\n
-0000e410: 7065 7269 6f64 732c 2061 6674 6572 2061  periods, after a
-0000e420: 2070 6172 7469 6375 6c61 7220 7479 7065   particular type
-0000e430: 206f 6620 6576 656e 742c 2069 6d6d 6564   of event, immed
-0000e440: 6961 7465 6c79 2061 6674 6572 2065 7665  iately after eve
-0000e450: 6e74 7320 6172 655c 6e61 7070 656e 6465  nts are\nappende
-0000e460: 642c 206f 7220 6173 2061 2062 6163 6b67  d, or as a backg
-0000e470: 726f 756e 6420 7072 6f63 6573 732e 5c6e  round process.\n
-0000e480: 5c6e 5c6e 2323 2320 5265 6164 2061 6c6c  \n\n### Read all
-0000e490: 2065 7665 6e74 735c 6e5c 6e54 6865 2060   events\n\nThe `
-0000e4a0: 7265 6164 5f61 6c6c 2829 6020 6d65 7468  read_all()` meth
-0000e4b0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
-0000e4c0: 6f20 6765 7420 616c 6c20 7265 636f 7264  o get all record
-0000e4d0: 6564 2065 7665 6e74 735c 6e69 6e20 7468  ed events\nin th
-0000e4e0: 6520 6461 7461 6261 7365 2069 6e20 7468  e database in th
-0000e4f0: 6520 6f72 6465 7220 7468 6579 2077 6572  e order they wer
-0000e500: 6520 7265 636f 7264 6564 2e20 5468 6973  e recorded. This
-0000e510: 206d 6574 686f 6420 7265 7475 726e 735c   method returns\
-0000e520: 6e61 2022 7265 6164 2072 6573 706f 6e73  na "read respons
-0000e530: 6522 206f 626a 6563 742c 206a 7573 7420  e" object, just 
-0000e540: 6c69 6b65 2060 7265 6164 5f73 7472 6561  like `read_strea
-0000e550: 6d28 2960 2e5c 6e5c 6e41 2022 7265 6164  m()`.\n\nA "read
-0000e560: 2072 6573 706f 6e73 6522 2069 7320 616e   response" is an
-0000e570: 2069 7465 7261 746f 722c 2061 6e64 206e   iterator, and n
-0000e580: 6f74 2061 2073 6571 7565 6e63 652e 2052  ot a sequence. R
-0000e590: 6563 6f72 6465 6420 6576 656e 7473 2063  ecorded events c
-0000e5a0: 616e 2062 655c 6e6f 6274 6169 6e65 6420  an be\nobtained 
-0000e5b0: 6279 2069 7465 7261 7469 6e67 206f 7665  by iterating ove
-0000e5c0: 7220 7468 6520 2272 6561 6420 7265 7370  r the "read resp
-0000e5d0: 6f6e 7365 2220 6f62 6a65 6374 2e20 5265  onse" object. Re
-0000e5e0: 636f 7264 6564 2065 7665 6e74 7320 6172  corded events ar
-0000e5f0: 655c 6e73 7472 6561 6d65 6420 6672 6f6d  e\nstreamed from
-0000e600: 2074 6865 2073 6572 7665 7220 746f 2074   the server to t
-0000e610: 6865 2063 6c69 656e 7420 6173 2074 6865  he client as the
-0000e620: 2069 7465 7261 7469 6f6e 2070 726f 6365   iteration proce
-0000e630: 6564 732e 2054 6865 2069 7465 7261 7469  eds. The iterati
-0000e640: 6f6e 5c6e 7769 6c6c 2061 7574 6f6d 6174  on\nwill automat
-0000e650: 6963 616c 6c79 2073 746f 7020 7768 656e  ically stop when
-0000e660: 2074 6865 7265 2061 7265 206e 6f20 6d6f   there are no mo
-0000e670: 7265 2072 6563 6f72 6465 6420 6576 656e  re recorded even
-0000e680: 7473 2074 6f20 6265 2072 6574 7572 6e65  ts to be returne
-0000e690: 642e 5c6e 5468 6520 7374 7265 616d 696e  d.\nThe streamin
-0000e6a0: 6720 6f66 2065 7665 6e74 732c 2061 6e64  g of events, and
-0000e6b0: 2068 656e 6365 2074 6865 2069 7465 7261   hence the itera
-0000e6c0: 746f 722c 2063 616e 2061 6c73 6f20 6265  tor, can also be
-0000e6d0: 2073 746f 7070 6564 2062 7920 6361 6c6c   stopped by call
-0000e6e0: 696e 675c 6e74 6865 2060 7374 6f70 2829  ing\nthe `stop()
-0000e6f0: 6020 6d65 7468 6f64 206f 6e20 7468 6520  ` method on the 
-0000e700: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
-0000e710: 6f62 6a65 6374 2e20 5468 6520 7265 636f  object. The reco
-0000e720: 7264 6564 2065 7665 6e74 206f 626a 6563  rded event objec
-0000e730: 7473 5c6e 6172 6520 696e 7374 616e 6365  ts\nare instance
-0000e740: 7320 6f66 2074 6865 2060 5265 636f 7264  s of the `Record
-0000e750: 6564 4576 656e 7460 2063 6c61 7373 2e5c  edEvent` class.\
-0000e760: 6e5c 6e54 6869 7320 6d65 7468 6f64 2068  n\nThis method h
-0000e770: 6173 2065 6967 6874 206f 7074 696f 6e61  as eight optiona
-0000e780: 6c20 6172 6775 6d65 6e74 732c 2060 636f  l arguments, `co
-0000e790: 6d6d 6974 5f70 6f73 6974 696f 6e60 2c20  mmit_position`, 
-0000e7a0: 6062 6163 6b77 6172 6473 602c 5c6e 6066  `backwards`,\n`f
-0000e7b0: 696c 7465 725f 6578 636c 7564 6560 2c20  ilter_exclude`, 
-0000e7c0: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
-0000e7d0: 2c20 6066 696c 7465 725f 6279 5f73 7472  , `filter_by_str
-0000e7e0: 6561 6d5f 6e61 6d65 602c 2060 6c69 6d69  eam_name`, `limi
-0000e7f0: 7460 2c20 6074 696d 656f 7574 602c 5c6e  t`, `timeout`,\n
-0000e800: 616e 6420 6063 7265 6465 6e74 6961 6c73  and `credentials
-0000e810: 602e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  `.\n\nThe option
-0000e820: 616c 2060 636f 6d6d 6974 5f70 6f73 6974  al `commit_posit
-0000e830: 696f 6e60 2061 7267 756d 656e 7420 6973  ion` argument is
-0000e840: 2061 2050 7974 686f 6e20 6069 6e74 6020   a Python `int` 
-0000e850: 7468 6174 2063 616e 2062 6520 7573 6564  that can be used
-0000e860: 2074 6f5c 6e73 7065 6369 6679 2061 2063   to\nspecify a c
-0000e870: 6f6d 6d69 7420 706f 7369 7469 6f6e 2066  ommit position f
-0000e880: 726f 6d20 7768 6963 6820 746f 2073 7461  rom which to sta
-0000e890: 7274 2072 6561 6469 6e67 2e20 5468 6520  rt reading. The 
-0000e8a0: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
-0000e8b0: 5c6e 6063 6f6d 6d69 745f 706f 7369 7469  \n`commit_positi
-0000e8c0: 6f6e 6020 6973 2060 4e6f 6e65 602e 2050  on` is `None`. P
-0000e8d0: 6c65 6173 6520 6e6f 7465 2c20 6966 2061  lease note, if a
-0000e8e0: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-0000e8f0: 2069 7320 7370 6563 6966 6965 642c 5c6e   is specified,\n
-0000e900: 6974 206d 7573 7420 6265 2061 6e20 6163  it must be an ac
-0000e910: 7475 616c 6c79 2065 7869 7374 696e 6720  tually existing 
-0000e920: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000e930: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
-0000e940: 2057 6865 6e20 7265 6164 696e 675c 6e66   When reading\nf
-0000e950: 6f72 7761 7264 732c 2074 6865 2065 7665  orwards, the eve
-0000e960: 6e74 2061 7420 7468 6520 636f 6d6d 6974  nt at the commit
-0000e970: 2070 6f73 6974 696f 6e20 6d61 7920 6265   position may be
-0000e980: 2069 6e63 6c75 6465 642c 2064 6570 656e   included, depen
-0000e990: 6469 6e67 2075 706f 6e20 7468 655c 6e66  ding upon the\nf
-0000e9a0: 696c 7465 722e 2057 6865 6e20 7265 6164  ilter. When read
-0000e9b0: 696e 6720 6261 636b 7761 7264 732c 2074  ing backwards, t
-0000e9c0: 6865 2065 7665 6e74 2061 7420 7468 6520  he event at the 
-0000e9d0: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-0000e9e0: 7769 6c6c 206e 6f74 2062 655c 6e69 6e63  will not be\ninc
-0000e9f0: 6c75 6465 642e 5c6e 5c6e 5468 6520 6f70  luded.\n\nThe op
-0000ea00: 7469 6f6e 616c 2060 6261 636b 7761 7264  tional `backward
-0000ea10: 7360 2061 7267 756d 656e 7420 6973 2061  s` argument is a
-0000ea20: 2050 7974 686f 6e20 6062 6f6f 6c60 2e20   Python `bool`. 
-0000ea30: 5468 6520 6465 6661 756c 7420 6f66 2060  The default of `
-0000ea40: 6261 636b 7761 7264 7360 2069 735c 6e60  backwards` is\n`
-0000ea50: 4661 6c73 6560 2c20 7768 6963 6820 6d65  False`, which me
-0000ea60: 616e 7320 6576 656e 7473 2061 7265 2072  ans events are r
-0000ea70: 6574 7572 6e65 6420 696e 2074 6865 206f  eturned in the o
-0000ea80: 7264 6572 2074 6865 7920 7765 7265 2072  rder they were r
-0000ea90: 6563 6f72 6465 642c 2049 665c 6e60 6261  ecorded, If\n`ba
-0000eaa0: 636b 7761 7264 7360 2069 7320 6054 7275  ckwards` is `Tru
-0000eab0: 6560 2c20 7468 656e 2065 7665 6e74 7320  e`, then events 
-0000eac0: 6172 6520 7265 7475 726e 6564 2069 6e20  are returned in 
-0000ead0: 7265 7665 7273 6520 6f72 6465 722e 5c6e  reverse order.\n
-0000eae0: 5c6e 4966 2060 6261 636b 7761 7264 7360  \nIf `backwards`
-0000eaf0: 2069 7320 6046 616c 7365 6020 616e 6420   is `False` and 
-0000eb00: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-0000eb10: 6020 6973 2060 4e6f 6e65 602c 2074 6865  ` is `None`, the
-0000eb20: 2064 6174 6162 6173 655c 2773 2065 7665   database\'s eve
-0000eb30: 6e74 7320 7769 6c6c 5c6e 6265 2072 6574  nts will\nbe ret
-0000eb40: 7572 6e65 6420 696e 2074 6865 206f 7264  urned in the ord
-0000eb50: 6572 2074 6865 7920 7765 7265 2072 6563  er they were rec
-0000eb60: 6f72 6465 642c 2073 7461 7274 696e 6720  orded, starting 
-0000eb70: 6672 6f6d 2074 6865 2066 6972 7374 2072  from the first r
-0000eb80: 6563 6f72 6465 6420 6576 656e 742e 5c6e  ecorded event.\n
-0000eb90: 5468 6973 2069 7320 7468 6520 6465 6661  This is the defa
-0000eba0: 756c 7420 6265 6861 7669 6f72 206f 6620  ult behavior of 
-0000ebb0: 6072 6561 645f 616c 6c28 2960 2e20 4966  `read_all()`. If
-0000ebc0: 2060 6261 636b 7761 7264 7360 2069 7320   `backwards` is 
-0000ebd0: 6054 7275 6560 2061 6e64 5c6e 6063 6f6d  `True` and\n`com
-0000ebe0: 6d69 745f 706f 7369 7469 6f6e 6020 6973  mit_position` is
-0000ebf0: 2060 4e6f 6e65 602c 2074 6865 2064 6174   `None`, the dat
-0000ec00: 6162 6173 655c 2773 2065 7665 6e74 7320  abase\'s events 
-0000ec10: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
-0000ec20: 2069 6e20 7265 7665 7273 6520 6f72 6465   in reverse orde
-0000ec30: 722c 5c6e 7374 6172 7469 6e67 2066 726f  r,\nstarting fro
-0000ec40: 6d20 7468 6520 6c61 7374 2072 6563 6f72  m the last recor
-0000ec50: 6465 6420 6576 656e 742e 5c6e 5c6e 5468  ded event.\n\nTh
-0000ec60: 6520 6f70 7469 6f6e 616c 2060 6669 6c74  e optional `filt
-0000ec70: 6572 5f65 7863 6c75 6465 6020 6172 6775  er_exclude` argu
-0000ec80: 6d65 6e74 2069 7320 6120 7365 7175 656e  ment is a sequen
-0000ec90: 6365 206f 6620 7265 6775 6c61 7220 6578  ce of regular ex
-0000eca0: 7072 6573 7369 6f6e 7320 7468 6174 5c6e  pressions that\n
-0000ecb0: 7370 6563 6966 6965 7320 7768 6963 6820  specifies which 
-0000ecc0: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-0000ecd0: 7368 6f75 6c64 2062 6520 7265 7475 726e  should be return
-0000ece0: 6564 2e20 5468 6973 2061 7267 756d 656e  ed. This argumen
-0000ecf0: 7420 6973 2069 676e 6f72 6564 5c6e 6966  t is ignored\nif
-0000ed00: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
-0000ed10: 6020 6973 2073 6574 2074 6f20 6120 6e6f  ` is set to a no
-0000ed20: 6e2d 656d 7074 7920 7365 7175 656e 6365  n-empty sequence
-0000ed30: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
-0000ed40: 6c75 6520 6f66 2074 6869 735c 6e61 7267  lue of this\narg
-0000ed50: 756d 656e 7420 6d61 7463 6865 7320 7468  ument matches th
-0000ed60: 6520 6576 656e 7420 7479 7065 7320 6f66  e event types of
-0000ed70: 2045 7665 6e74 5374 6f72 6544 4220 2273   EventStoreDB "s
-0000ed80: 7973 7465 6d20 6576 656e 7473 222c 2073  ystem events", s
-0000ed90: 6f20 7468 6174 2073 7973 7465 6d5c 6e65  o that system\ne
-0000eda0: 7665 6e74 7320 7769 6c6c 206e 6f74 206e  vents will not n
-0000edb0: 6f72 6d61 6c6c 7920 6265 2069 6e63 6c75  ormally be inclu
-0000edc0: 6465 642e 2053 6565 2074 6865 204e 6f74  ded. See the Not
-0000edd0: 6573 2073 6563 7469 6f6e 2062 656c 6f77  es section below
-0000ede0: 2066 6f72 206d 6f72 655c 6e69 6e66 6f72   for more\ninfor
-0000edf0: 6d61 7469 6f6e 2061 626f 7574 2066 696c  mation about fil
-0000ee00: 7465 7220 6578 7072 6573 7369 6f6e 732e  ter expressions.
-0000ee10: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
-0000ee20: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
-0000ee30: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-0000ee40: 7365 7175 656e 6365 206f 6620 7265 6775  sequence of regu
-0000ee50: 6c61 7220 6578 7072 6573 7369 6f6e 735c  lar expressions\
-0000ee60: 6e74 6861 7420 7370 6563 6966 6965 7320  nthat specifies 
-0000ee70: 7768 6963 6820 7265 636f 7264 6564 2065  which recorded e
-0000ee80: 7665 6e74 7320 7368 6f75 6c64 2062 6520  vents should be 
-0000ee90: 7265 7475 726e 6564 2e20 4279 2064 6566  returned. By def
-0000eea0: 6175 6c74 2c20 7468 6973 5c6e 6172 6775  ault, this\nargu
-0000eeb0: 6d65 6e74 2069 7320 616e 2065 6d70 7479  ment is an empty
-0000eec0: 2074 7570 6c65 2e20 4966 2074 6869 7320   tuple. If this 
-0000eed0: 6172 6775 6d65 6e74 2069 7320 7365 7420  argument is set 
-0000eee0: 746f 2061 206e 6f6e 2d65 6d70 7479 2073  to a non-empty s
-0000eef0: 6571 7565 6e63 652c 5c6e 7468 6520 6066  equence,\nthe `f
-0000ef00: 696c 7465 725f 6578 636c 7564 6560 2061  ilter_exclude` a
-0000ef10: 7267 756d 656e 7420 6973 2069 676e 6f72  rgument is ignor
-0000ef20: 6564 2e5c 6e5c 6e54 6865 206f 7074 696f  ed.\n\nThe optio
-0000ef30: 6e61 6c20 6066 696c 7465 725f 6279 5f73  nal `filter_by_s
-0000ef40: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
-0000ef50: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
-0000ef60: 2060 626f 6f6c 6020 7468 6174 2069 6e64   `bool` that ind
-0000ef70: 6963 6174 6573 5c6e 7768 6574 6865 7220  icates\nwhether 
-0000ef80: 7468 6520 6669 6c74 6572 696e 6720 7769  the filtering wi
-0000ef90: 6c6c 2061 7070 6c79 2074 6f20 6576 656e  ll apply to even
-0000efa0: 7420 7479 7065 7320 6f72 2073 7472 6561  t types or strea
-0000efb0: 6d20 6e61 6d65 732e 2042 7920 6465 6661  m names. By defa
-0000efc0: 756c 742c 2074 6869 735c 6e76 616c 7565  ult, this\nvalue
-0000efd0: 2069 7320 6046 616c 7365 6020 616e 6420   is `False` and 
-0000efe0: 736f 2074 6865 2066 696c 7465 7269 6e67  so the filtering
-0000eff0: 2077 696c 6c20 6170 706c 7920 746f 2074   will apply to t
-0000f000: 6865 2065 7665 6e74 2074 7970 6520 7374  he event type st
-0000f010: 7269 6e67 7320 6f66 5c6e 7265 636f 7264  rings of\nrecord
-0000f020: 6564 2065 7665 6e74 732e 5c6e 5c6e 5468  ed events.\n\nTh
-0000f030: 6520 6f70 7469 6f6e 616c 2060 6c69 6d69  e optional `limi
-0000f040: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
-0000f050: 6e20 696e 7465 6765 7220 7768 6963 6820  n integer which 
-0000f060: 7265 7374 7269 6374 7320 7468 6520 6e75  restricts the nu
-0000f070: 6d62 6572 206f 6620 6576 656e 7473 2074  mber of events t
-0000f080: 6861 745c 6e77 696c 6c20 6265 2072 6574  hat\nwill be ret
-0000f090: 7572 6e65 642e 2054 6865 2064 6566 6175  urned. The defau
-0000f0a0: 6c74 2076 616c 7565 2069 7320 6073 7973  lt value is `sys
-0000f0b0: 2e6d 6178 696e 7460 2e5c 6e5c 6e54 6865  .maxint`.\n\nThe
-0000f0c0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-0000f0d0: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
-0000f0e0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
-0000f0f0: 2077 6869 6368 2073 6574 7320 615c 6e64   which sets a\nd
-0000f100: 6561 646c 696e 6520 666f 7220 7468 6520  eadline for the 
-0000f110: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
-0000f120: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
-0000f130: 2e5c 6e5c 6e54 6865 206f 7074 696f 6e61  .\n\nThe optiona
-0000f140: 6c20 6063 7265 6465 6e74 6961 6c73 6020  l `credentials` 
-0000f150: 6172 6775 6d65 6e74 2063 616e 2062 6520  argument can be 
-0000f160: 7573 6564 2074 6f5c 6e6f 7665 7272 6964  used to\noverrid
-0000f170: 6520 6361 6c6c 2063 7265 6465 6e74 6961  e call credentia
-0000f180: 6c73 2064 6572 6976 6564 2066 726f 6d20  ls derived from 
-0000f190: 7468 6520 636f 6e6e 6563 7469 6f6e 2073  the connection s
-0000f1a0: 7472 696e 6720 5552 492e 5c6e 5c6e 5468  tring URI.\n\nTh
-0000f1b0: 6520 6669 6c74 6572 696e 6720 6f66 2065  e filtering of e
-0000f1c0: 7665 6e74 7320 6973 2064 6f6e 6520 6f6e  vents is done on
-0000f1d0: 2074 6865 2045 7665 6e74 5374 6f72 6544   the EventStoreD
-0000f1e0: 4220 7365 7276 6572 2e20 5468 655c 6e60  B server. The\n`
-0000f1f0: 6c69 6d69 7460 2061 7267 756d 656e 7420  limit` argument 
-0000f200: 6973 2061 7070 6c69 6564 206f 6e20 7468  is applied on th
-0000f210: 6520 7365 7276 6572 2061 6674 6572 2066  e server after f
-0000f220: 696c 7465 7269 6e67 2e5c 6e5c 6e54 6865  iltering.\n\nThe
-0000f230: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-0000f240: 686f 7773 2068 6f77 2074 6f20 6765 7420  hows how to get 
-0000f250: 616c 6c20 7468 6520 6576 656e 7473 2077  all the events w
-0000f260: 6520 6861 7665 2072 6563 6f72 6465 6420  e have recorded 
-0000f270: 696e 2074 6865 2064 6174 6162 6173 655c  in the database\
-0000f280: 6e73 6f20 6661 722c 2069 6e20 7468 6520  nso far, in the 
-0000f290: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
-0000f2a0: 7265 636f 7264 6564 2e20 5765 2063 616e  recorded. We can
-0000f2b0: 2073 6565 2074 6865 2074 6872 6565 2065   see the three e
-0000f2c0: 7665 6e74 7320 6f66 2060 7374 7265 616d  vents of `stream
-0000f2d0: 5f6e 616d 6531 605c 6e28 6065 7665 6e74  _name1`\n(`event
-0000f2e0: 3160 2c20 6065 7665 6e74 3260 2061 6e64  1`, `event2` and
-0000f2f0: 2060 6576 656e 7433 6029 2061 7265 2069   `event3`) are i
-0000f300: 6e63 6c75 6465 642c 2061 6c6f 6e67 2077  ncluded, along w
-0000f310: 6974 6820 6f74 6865 7273 2e5c 6e5c 6e60  ith others.\n\n`
-0000f320: 6060 7079 7468 6f6e 5c6e 2320 5265 6164  ``python\n# Read
-0000f330: 2061 6c6c 2065 7665 6e74 7320 2863 7265   all events (cre
-0000f340: 6174 6573 2061 2073 7472 6561 6d69 6e67  ates a streaming
-0000f350: 2067 5250 4320 6361 6c6c 292e 5c6e 7265   gRPC call).\nre
-0000f360: 6164 5f72 6573 706f 6e73 6520 3d20 636c  ad_response = cl
-0000f370: 6965 6e74 2e72 6561 645f 616c 6c28 295c  ient.read_all()\
-0000f380: 6e5c 6e23 2043 6f6e 7665 7274 2074 6865  n\n# Convert the
-0000f390: 2069 7465 7261 746f 7220 696e 746f 2061   iterator into a
-0000f3a0: 2073 6571 7565 6e63 6520 6f66 2072 6563   sequence of rec
-0000f3b0: 6f72 6465 6420 6576 656e 7473 2e5c 6e65  orded events.\ne
-0000f3c0: 7665 6e74 7320 3d20 7475 706c 6528 7265  vents = tuple(re
-0000f3d0: 6164 5f72 6573 706f 6e73 6529 5c6e 6173  ad_response)\nas
-0000f3e0: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-0000f3f0: 203e 2033 2020 2320 6d6f 7265 2074 6861   > 3  # more tha
-0000f400: 6e20 7468 7265 655c 6e5c 6e23 2043 6f6e  n three\n\n# Con
-0000f410: 7665 7274 2074 6865 2073 6571 7565 6e63  vert the sequenc
-0000f420: 6520 6f66 2072 6563 6f72 6465 6420 6576  e of recorded ev
-0000f430: 656e 7473 2069 6e74 6f20 6120 7365 7420  ents into a set 
-0000f440: 6f66 2065 7665 6e74 2049 4473 2e5c 6e65  of event IDs.\ne
-0000f450: 7665 6e74 5f69 6473 203d 2073 6574 2865  vent_ids = set(e
-0000f460: 2e69 6420 666f 7220 6520 696e 2065 7665  .id for e in eve
-0000f470: 6e74 7329 5c6e 6173 7365 7274 2065 7665  nts)\nassert eve
-0000f480: 6e74 312e 6964 2069 6e20 6576 656e 745f  nt1.id in event_
-0000f490: 6964 735c 6e61 7373 6572 7420 6576 656e  ids\nassert even
-0000f4a0: 7432 2e69 6420 696e 2065 7665 6e74 5f69  t2.id in event_i
-0000f4b0: 6473 5c6e 6173 7365 7274 2065 7665 6e74  ds\nassert event
-0000f4c0: 332e 6964 2069 6e20 6576 656e 745f 6964  3.id in event_id
-0000f4d0: 735c 6e60 6060 5c6e 5c6e 5468 6520 6578  s\n```\n\nThe ex
-0000f4e0: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
-0000f4f0: 7320 686f 7720 746f 2072 6561 6420 616c  s how to read al
-0000f500: 6c20 7265 636f 7264 6564 2065 7665 6e74  l recorded event
-0000f510: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
-0000f520: 6520 6672 6f6d 5c6e 6120 7061 7274 6963  e from\na partic
-0000f530: 756c 6172 2063 6f6d 6d69 7420 706f 7369  ular commit posi
-0000f540: 7469 6f6e 2c20 696e 2074 6869 7320 6361  tion, in this ca
-0000f550: 7365 2060 636f 6d6d 6974 5f70 6f73 6974  se `commit_posit
-0000f560: 696f 6e31 602e 2057 6865 6e20 7265 6164  ion1`. When read
-0000f570: 696e 675c 6e66 6f72 7761 7264 7320 6672  ing\nforwards fr
-0000f580: 6f6d 2061 2073 7065 6369 6669 6320 636f  om a specific co
-0000f590: 6d6d 6974 2070 6f73 6974 696f 6e2c 2074  mmit position, t
-0000f5a0: 6865 2065 7665 6e74 2061 7420 7468 6520  he event at the 
-0000f5b0: 7370 6563 6966 6965 6420 706f 7369 7469  specified positi
-0000f5c0: 6f6e 5c6e 7769 6c6c 2062 6520 696e 636c  on\nwill be incl
-0000f5d0: 7564 6564 2e20 5468 6520 7661 6c75 6520  uded. The value 
-0000f5e0: 6f66 2060 636f 6d6d 6974 5f70 6f73 6974  of `commit_posit
-0000f5f0: 696f 6e31 6020 6973 2074 6865 2070 6f73  ion1` is the pos
-0000f600: 6974 696f 6e20 7765 206f 6274 6169 6e65  ition we obtaine
-0000f610: 645c 6e77 6865 6e20 6170 7065 6e64 696e  d\nwhen appendin
-0000f620: 6720 6065 7665 6e74 3160 2e20 416e 6420  g `event1`. And 
-0000f630: 736f 2060 6576 656e 7431 6020 6973 2074  so `event1` is t
-0000f640: 6865 2066 6972 7374 2072 6563 6f72 6465  he first recorde
-0000f650: 6420 6576 656e 7420 7765 2073 6861 6c6c  d event we shall
-0000f660: 5c6e 7265 6365 6976 652c 2060 6576 656e  \nreceive, `even
-0000f670: 7432 6020 6973 2074 6865 2073 6563 6f6e  t2` is the secon
-0000f680: 642c 2061 6e64 2060 6576 656e 7433 6020  d, and `event3` 
-0000f690: 6973 2074 6865 2074 6869 7264 2e5c 6e5c  is the third.\n\
-0000f6a0: 6e60 6060 7079 7468 6f6e 5c6e 2320 5265  n```python\n# Re
-0000f6b0: 6164 2061 6c6c 2065 7665 6e74 7320 666f  ad all events fo
-0000f6c0: 7277 6172 6473 2066 726f 6d20 6120 636f  rwards from a co
-0000f6d0: 6d6d 6974 2070 6f73 6974 696f 6e2e 5c6e  mmit position.\n
-0000f6e0: 7265 6164 5f72 6573 706f 6e73 6520 3d20  read_response = 
-0000f6f0: 636c 6965 6e74 2e72 6561 645f 616c 6c28  client.read_all(
-0000f700: 5c6e 2020 2020 636f 6d6d 6974 5f70 6f73  \n    commit_pos
-0000f710: 6974 696f 6e3d 636f 6d6d 6974 5f70 6f73  ition=commit_pos
-0000f720: 6974 696f 6e31 5c6e 295c 6e5c 6e23 2053  ition1\n)\n\n# S
-0000f730: 7465 7020 7468 726f 7567 6820 7468 6520  tep through the 
-0000f740: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
-0000f750: 6974 6572 6174 6f72 2e5c 6e61 7373 6572  iterator.\nasser
-0000f760: 7420 6e65 7874 2872 6561 645f 7265 7370  t next(read_resp
-0000f770: 6f6e 7365 292e 6964 203d 3d20 6576 656e  onse).id == even
-0000f780: 7431 2e69 645c 6e61 7373 6572 7420 6e65  t1.id\nassert ne
-0000f790: 7874 2872 6561 645f 7265 7370 6f6e 7365  xt(read_response
-0000f7a0: 292e 6964 203d 3d20 6576 656e 7432 2e69  ).id == event2.i
-0000f7b0: 645c 6e61 7373 6572 7420 6e65 7874 2872  d\nassert next(r
-0000f7c0: 6561 645f 7265 7370 6f6e 7365 292e 6964  ead_response).id
-0000f7d0: 203d 3d20 6576 656e 7433 2e69 645c 6e5c   == event3.id\n\
-0000f7e0: 6e23 2053 746f 7020 7468 6520 6974 6572  n# Stop the iter
-0000f7f0: 6174 6f72 2e5c 6e72 6561 645f 7265 7370  ator.\nread_resp
-0000f800: 6f6e 7365 2e73 746f 7028 295c 6e60 6060  onse.stop()\n```
-0000f810: 5c6e 5c6e 5468 6520 6578 616d 706c 6520  \n\nThe example 
-0000f820: 6265 6c6f 7720 7368 6f77 7320 686f 7720  below shows how 
-0000f830: 746f 2072 6561 6420 616c 6c20 6576 656e  to read all even
-0000f840: 7473 2072 6563 6f72 6465 6420 696e 2074  ts recorded in t
-0000f850: 6865 2064 6174 6162 6173 6520 696e 2072  he database in r
-0000f860: 6576 6572 7365 5c6e 6f72 6465 722e 2057  everse\norder. W
-0000f870: 6520 6361 6e20 7365 6520 7468 6174 2074  e can see that t
-0000f880: 6865 2066 6972 7374 2065 7665 6e74 7320  he first events 
-0000f890: 7765 2072 6563 6569 7665 2061 7265 2074  we receive are t
-0000f8a0: 6865 206c 6173 7420 6576 656e 7473 2074  he last events t
-0000f8b0: 6861 7420 7765 7265 5c6e 7265 636f 7264  hat were\nrecord
-0000f8c0: 6564 3a20 7468 6520 6576 656e 7473 206f  ed: the events o
-0000f8d0: 6620 7468 6520 6044 6f67 6020 6167 6772  f the `Dog` aggr
-0000f8e0: 6567 6174 6520 6672 6f6d 2074 6865 2073  egate from the s
-0000f8f0: 6563 7469 6f6e 2061 626f 7574 2073 6e61  ection about sna
-0000f900: 7073 686f 7474 696e 675c 6e61 6e64 2074  pshotting\nand t
-0000f910: 6865 2073 6e61 7073 686f 742e 5c6e 5c6e  he snapshot.\n\n
-0000f920: 6060 6070 7974 686f 6e5c 6e23 2052 6561  ```python\n# Rea
-0000f930: 6420 616c 6c20 6576 656e 7473 2062 6163  d all events bac
-0000f940: 6b77 6172 6473 2066 726f 6d20 7468 6520  kwards from the 
-0000f950: 656e 642e 5c6e 7265 6164 5f72 6573 706f  end.\nread_respo
-0000f960: 6e73 6520 3d20 636c 6965 6e74 2e72 6561  nse = client.rea
-0000f970: 645f 616c 6c28 5c6e 2020 2020 6261 636b  d_all(\n    back
-0000f980: 7761 7264 733d 5472 7565 5c6e 295c 6e5c  wards=True\n)\n\
-0000f990: 6e23 2053 7465 7020 7468 726f 7567 6820  n# Step through 
-0000f9a0: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
-0000f9b0: 7365 2220 6974 6572 6174 6f72 2e5c 6e61  se" iterator.\na
-0000f9c0: 7373 6572 7420 6e65 7874 2872 6561 645f  ssert next(read_
-0000f9d0: 7265 7370 6f6e 7365 292e 7479 7065 203d  response).type =
-0000f9e0: 3d20 2244 6f67 4c65 6172 6e65 6454 7269  = "DogLearnedTri
-0000f9f0: 636b 225c 6e61 7373 6572 7420 6e65 7874  ck"\nassert next
-0000fa00: 2872 6561 645f 7265 7370 6f6e 7365 292e  (read_response).
-0000fa10: 7479 7065 203d 3d20 2253 6e61 7073 686f  type == "Snapsho
-0000fa20: 7422 5c6e 6173 7365 7274 206e 6578 7428  t"\nassert next(
-0000fa30: 7265 6164 5f72 6573 706f 6e73 6529 2e74  read_response).t
-0000fa40: 7970 6520 3d3d 2022 446f 674c 6561 726e  ype == "DogLearn
-0000fa50: 6564 5472 6963 6b22 5c6e 6173 7365 7274  edTrick"\nassert
-0000fa60: 206e 6578 7428 7265 6164 5f72 6573 706f   next(read_respo
-0000fa70: 6e73 6529 2e74 7970 6520 3d3d 2022 446f  nse).type == "Do
-0000fa80: 674c 6561 726e 6564 5472 6963 6b22 5c6e  gLearnedTrick"\n
-0000fa90: 6173 7365 7274 206e 6578 7428 7265 6164  assert next(read
-0000faa0: 5f72 6573 706f 6e73 6529 2e74 7970 6520  _response).type 
-0000fab0: 3d3d 2022 446f 6752 6567 6973 7465 7265  == "DogRegistere
-0000fac0: 6422 5c6e 5c6e 2320 5374 6f70 2074 6865  d"\n\n# Stop the
-0000fad0: 2069 7465 7261 746f 722e 5c6e 7265 6164   iterator.\nread
-0000fae0: 5f72 6573 706f 6e73 652e 7374 6f70 2829  _response.stop()
-0000faf0: 5c6e 6060 605c 6e5c 6e54 6865 2065 7861  \n```\n\nThe exa
-0000fb00: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
-0000fb10: 2068 6f77 2074 6f20 7265 6164 2061 206c   how to read a l
-0000fb20: 696d 6974 6564 206e 756d 6265 7220 6f66  imited number of
-0000fb30: 2065 7665 6e74 735c 6e66 6f72 7761 7264   events\nforward
-0000fb40: 7320 6672 6f6d 2061 2073 7065 6369 6669  s from a specifi
-0000fb50: 6320 636f 6d6d 6974 2070 6f73 6974 696f  c commit positio
-0000fb60: 6e2e 5c6e 5c6e 6060 6070 7974 686f 6e5c  n.\n\n```python\
-0000fb70: 6e65 7665 6e74 7320 3d20 7475 706c 6528  nevents = tuple(
-0000fb80: 5c6e 2020 2020 636c 6965 6e74 2e72 6561  \n    client.rea
-0000fb90: 645f 616c 6c28 5c6e 2020 2020 2020 2020  d_all(\n        
-0000fba0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e3d  commit_position=
-0000fbb0: 636f 6d6d 6974 5f70 6f73 6974 696f 6e31  commit_position1
-0000fbc0: 2c5c 6e20 2020 2020 2020 206c 696d 6974  ,\n        limit
-0000fbd0: 3d31 2c5c 6e20 2020 2029 5c6e 295c 6e5c  =1,\n    )\n)\n\
-0000fbe0: 6e61 7373 6572 7420 6c65 6e28 6576 656e  nassert len(even
-0000fbf0: 7473 2920 3d3d 2031 5c6e 6173 7365 7274  ts) == 1\nassert
-0000fc00: 2065 7665 6e74 735b 305d 2e69 6420 3d3d   events[0].id ==
-0000fc10: 2065 7665 6e74 312e 6964 5c6e 6060 605c   event1.id\n```\
-0000fc20: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
-0000fc30: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
-0000fc40: 6f20 7265 6164 2061 206c 696d 6974 6564  o read a limited
-0000fc50: 206e 756d 6265 7220 6f66 2074 6865 2072   number of the r
-0000fc60: 6563 6f72 6465 6420 6576 656e 7473 5c6e  ecorded events\n
-0000fc70: 696e 2074 6865 2064 6174 6162 6173 6520  in the database 
-0000fc80: 6261 636b 7761 7264 7320 6672 6f6d 2074  backwards from t
-0000fc90: 6865 2065 6e64 2e20 496e 2074 6869 7320  he end. In this 
-0000fca0: 6361 7365 2c20 7468 6520 6c69 6d69 7420  case, the limit 
-0000fcb0: 6973 2031 2c20 616e 645c 6e73 6f20 7765  is 1, and\nso we
-0000fcc0: 2072 6563 6569 7665 2074 6865 206c 6173   receive the las
-0000fcd0: 7420 7265 636f 7264 6564 2065 7665 6e74  t recorded event
-0000fce0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-0000fcf0: 6576 656e 7473 203d 2074 7570 6c65 285c  events = tuple(\
-0000fd00: 6e20 2020 2063 6c69 656e 742e 7265 6164  n    client.read
-0000fd10: 5f61 6c6c 285c 6e20 2020 2020 2020 2062  _all(\n        b
-0000fd20: 6163 6b77 6172 6473 3d54 7275 652c 5c6e  ackwards=True,\n
-0000fd30: 2020 2020 2020 2020 6c69 6d69 743d 312c          limit=1,
-0000fd40: 5c6e 2020 2020 295c 6e29 5c6e 5c6e 6173  \n    )\n)\n\nas
-0000fd50: 7365 7274 206c 656e 2865 7665 6e74 7329  sert len(events)
-0000fd60: 203d 3d20 315c 6e5c 6e61 7373 6572 7420   == 1\n\nassert 
-0000fd70: 6576 656e 7473 5b30 5d2e 7479 7065 203d  events[0].type =
-0000fd80: 3d20 5c27 446f 674c 6561 726e 6564 5472  = \'DogLearnedTr
-0000fd90: 6963 6b5c 275c 6e61 7373 6572 7420 6465  ick\'\nassert de
-0000fda0: 7365 7269 616c 697a 6528 6576 656e 7473  serialize(events
-0000fdb0: 5b30 5d2e 6461 7461 295b 5c27 7472 6963  [0].data)[\'tric
-0000fdc0: 6b5c 275d 203d 3d20 5c27 7369 745c 275c  k\'] == \'sit\'\
-0000fdd0: 6e60 6060 5c6e 5c6e 506c 6561 7365 206e  n```\n\nPlease n
-0000fde0: 6f74 652c 206c 696b 6520 7468 6520 6072  ote, like the `r
-0000fdf0: 6561 645f 7374 7265 616d 2829 6020 6d65  ead_stream()` me
-0000fe00: 7468 6f64 2c20 7468 6520 6072 6561 645f  thod, the `read_
-0000fe10: 616c 6c28 2960 206d 6574 686f 645c 6e69  all()` method\ni
-0000fe20: 7320 6e6f 7420 6465 636f 7261 7465 6420  s not decorated 
-0000fe30: 7769 7468 2072 6574 7279 2061 6e64 2072  with retry and r
-0000fe40: 6563 6f6e 6e65 6374 2064 6563 6f72 6174  econnect decorat
-0000fe50: 6f72 732c 2062 6563 6175 7365 2074 6865  ors, because the
-0000fe60: 2073 7472 6561 6d69 6e67 206f 6620 7265   streaming of re
-0000fe70: 636f 7264 6564 5c6e 6576 656e 7473 2066  corded\nevents f
-0000fe80: 726f 6d20 7468 6520 7365 7276 6572 206f  rom the server o
-0000fe90: 6e6c 7920 7374 6172 7473 2077 6865 6e20  nly starts when 
-0000fea0: 6974 6572 6174 696e 6720 6f76 6572 2074  iterating over t
-0000feb0: 6865 2022 7265 6164 2072 6573 706f 6e73  he "read respons
-0000fec0: 6522 2073 7461 7274 732c 2077 6869 6368  e" starts, which
-0000fed0: 5c6e 6d65 616e 7320 7468 6174 2074 6865  \nmeans that the
-0000fee0: 206d 6574 686f 6420 7265 7475 726e 7320   method returns 
-0000fef0: 6265 666f 7265 2074 6865 2073 7472 6561  before the strea
-0000ff00: 6d69 6e67 2073 7461 7274 732c 2061 6e64  ming starts, and
-0000ff10: 2073 6f20 7468 6572 6520 6973 206e 6f20   so there is no 
-0000ff20: 6368 616e 6365 2066 6f72 5c6e 616e 7920  chance for\nany 
-0000ff30: 6465 636f 7261 746f 7273 2074 6f20 6361  decorators to ca
-0000ff40: 7463 6820 616e 7920 636f 6e6e 6563 7469  tch any connecti
-0000ff50: 6f6e 2069 7373 7565 732e 5c6e 5c6e 2323  on issues.\n\n##
-0000ff60: 2320 4765 7420 636f 6d6d 6974 2070 6f73  # Get commit pos
-0000ff70: 6974 696f 6e5c 6e5c 6e54 6865 2060 6765  ition\n\nThe `ge
-0000ff80: 745f 636f 6d6d 6974 5f70 6f73 6974 696f  t_commit_positio
-0000ff90: 6e28 2960 206d 6574 686f 6420 6361 6e20  n()` method can 
-0000ffa0: 6265 2075 7365 6420 746f 2067 6574 2074  be used to get t
-0000ffb0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-0000ffc0: 6f6e 206f 6620 7468 655c 6e6c 6173 7420  on of the\nlast 
-0000ffd0: 7265 636f 7264 6564 2065 7665 6e74 2069  recorded event i
-0000ffe0: 6e20 7468 6520 6461 7461 6261 7365 2e20  n the database. 
-0000fff0: 4974 2073 696d 706c 7920 6361 6c6c 7320  It simply calls 
-00010000: 6072 6561 645f 616c 6c28 2960 2077 6974  `read_all()` wit
-00010010: 685c 6e60 6261 636b 7761 7264 733d 5472  h\n`backwards=Tr
-00010020: 7565 6020 616e 6420 606c 696d 6974 3d31  ue` and `limit=1
-00010030: 602c 2061 6e64 2072 6574 7572 6e73 2074  `, and returns t
-00010040: 6865 2076 616c 7565 206f 6620 7468 6520  he value of the 
-00010050: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
-00010060: 605c 6e61 7474 7269 6275 7465 206f 6620  `\nattribute of 
-00010070: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-00010080: 6420 6576 656e 742e 5c6e 5c6e 6060 6070  d event.\n\n```p
-00010090: 7974 686f 6e5c 6e63 6f6d 6d69 745f 706f  ython\ncommit_po
-000100a0: 7369 7469 6f6e 203d 2063 6c69 656e 742e  sition = client.
-000100b0: 6765 745f 636f 6d6d 6974 5f70 6f73 6974  get_commit_posit
-000100c0: 696f 6e28 295c 6e60 6060 5c6e 5c6e 5468  ion()\n```\n\nTh
-000100d0: 6973 206d 6574 686f 6420 6861 7320 6669  is method has fi
-000100e0: 7665 206f 7074 696f 6e61 6c20 6172 6775  ve optional argu
-000100f0: 6d65 6e74 732c 2060 6669 6c74 6572 5f65  ments, `filter_e
-00010100: 7863 6c75 6465 602c 2060 6669 6c74 6572  xclude`, `filter
-00010110: 5f69 6e63 6c75 6465 602c 5c6e 6066 696c  _include`,\n`fil
-00010120: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
-00010130: 6d65 602c 2060 7469 6d65 6f75 7460 2061  me`, `timeout` a
-00010140: 6e64 2060 6372 6564 656e 7469 616c 7360  nd `credentials`
-00010150: 2e20 5468 6573 6520 7661 6c75 6573 2061  . These values a
-00010160: 7265 2070 6173 7365 6420 746f 5c6e 6072  re passed to\n`r
-00010170: 6561 645f 616c 6c28 2960 2e5c 6e5c 6e54  ead_all()`.\n\nT
-00010180: 6865 206f 7074 696f 6e61 6c20 6066 696c  he optional `fil
-00010190: 7465 725f 6578 636c 7564 6560 2c20 6066  ter_exclude`, `f
-000101a0: 696c 7465 725f 696e 636c 7564 6560 2061  ilter_include` a
-000101b0: 6e64 2060 6669 6c74 6572 5f62 795f 7374  nd `filter_by_st
-000101c0: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
-000101d0: 656e 7473 5c6e 776f 726b 2069 6e20 7468  ents\nwork in th
-000101e0: 6520 7361 6d65 2077 6179 2061 7320 7468  e same way as th
-000101f0: 6579 2064 6f20 696e 2074 6865 2060 7265  ey do in the `re
-00010200: 6164 5f61 6c6c 2829 6020 6d65 7468 6f64  ad_all()` method
-00010210: 2e5c 6e5c 6e54 6865 206f 7074 696f 6e61  .\n\nThe optiona
-00010220: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
-00010230: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
-00010240: 2060 666c 6f61 7460 2074 6861 7420 7365   `float` that se
-00010250: 7473 5c6e 6120 6465 6164 6c69 6e65 2066  ts\na deadline f
-00010260: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
-00010270: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
-00010280: 6572 6174 696f 6e2e 5c6e 5c6e 5468 6520  eration.\n\nThe 
-00010290: 6f70 7469 6f6e 616c 2060 6372 6564 656e  optional `creden
-000102a0: 7469 616c 7360 2061 7267 756d 656e 7420  tials` argument 
-000102b0: 6361 6e20 6265 2075 7365 6420 746f 206f  can be used to o
-000102c0: 7665 7272 6964 6520 6361 6c6c 2063 7265  verride call cre
-000102d0: 6465 6e74 6961 6c73 5c6e 6465 7269 7665  dentials\nderive
-000102e0: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
-000102f0: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-00010300: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
-00010310: 206d 6967 6874 2062 6520 7573 6564 2074   might be used t
-00010320: 6f20 6d65 6173 7572 6520 7072 6f67 7265  o measure progre
-00010330: 7373 206f 6620 6120 646f 776e 7374 7265  ss of a downstre
-00010340: 616d 2063 6f6d 706f 6e65 6e74 5c6e 7468  am component\nth
-00010350: 6174 2069 7320 7072 6f63 6573 7369 6e67  at is processing
-00010360: 2061 6c6c 2072 6563 6f72 6465 6420 6576   all recorded ev
-00010370: 656e 7473 2c20 6279 2063 6f6d 7061 7269  ents, by compari
-00010380: 6e67 2074 6865 2063 7572 7265 6e74 2063  ng the current c
-00010390: 6f6d 6d69 745c 6e70 6f73 6974 696f 6e20  ommit\nposition 
-000103a0: 7769 7468 2074 6865 2072 6563 6f72 6465  with the recorde
-000103b0: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
-000103c0: 6e20 6f66 2074 6865 206c 6173 7420 7375  n of the last su
-000103d0: 6363 6573 7366 756c 6c79 2070 726f 6365  ccessfully proce
-000103e0: 7373 6564 5c6e 6576 656e 7420 696e 2061  ssed\nevent in a
-000103f0: 2064 6f77 6e73 7472 6561 6d20 636f 6d70   downstream comp
-00010400: 6f6e 656e 742e 2049 6e20 7468 6973 2063  onent. In this c
-00010410: 6173 652c 2074 6865 2076 616c 7565 206f  ase, the value o
-00010420: 6620 7468 6520 6066 696c 7465 725f 6578  f the `filter_ex
-00010430: 636c 7564 6560 2c5c 6e60 6669 6c74 6572  clude`,\n`filter
-00010440: 5f69 6e63 6c75 6465 6020 616e 6420 6066  _include` and `f
-00010450: 696c 7465 725f 6279 5f73 7472 6561 6d5f  ilter_by_stream_
-00010460: 6e61 6d65 6020 6172 6775 6d65 6e74 7320  name` arguments 
-00010470: 7368 6f75 6c64 2065 7175 616c 2074 686f  should equal tho
-00010480: 7365 2075 7365 645c 6e62 7920 7468 6520  se used\nby the 
-00010490: 646f 776e 7374 7265 616d 2063 6f6d 706f  downstream compo
-000104a0: 6e65 6e74 2074 6f20 6f62 7461 696e 2072  nent to obtain r
-000104b0: 6563 6f72 6465 6420 6576 656e 7473 2e5c  ecorded events.\
-000104c0: 6e5c 6e5c 6e23 2323 2047 6574 2073 7472  n\n\n### Get str
-000104d0: 6561 6d20 6d65 7461 6461 7461 5c6e 5c6e  eam metadata\n\n
-000104e0: 5468 6520 6067 6574 5f73 7472 6561 6d5f  The `get_stream_
-000104f0: 6d65 7461 6461 7461 2829 6020 6d65 7468  metadata()` meth
-00010500: 6f64 2072 6574 7572 6e73 2074 6865 206d  od returns the m
-00010510: 6574 6164 6174 6120 666f 7220 6120 7374  etadata for a st
-00010520: 7265 616d 2c20 616c 6f6e 675c 6e77 6974  ream, along\nwit
-00010530: 6820 7468 6520 7665 7273 696f 6e20 6f66  h the version of
-00010540: 2074 6865 2073 7472 6561 6d20 6d65 7461   the stream meta
-00010550: 6461 7461 2e5c 6e5c 6e54 6869 7320 6d65  data.\n\nThis me
-00010560: 7468 6f64 2068 6173 206f 6e65 2072 6571  thod has one req
-00010570: 7569 7265 6420 6172 6775 6d65 6e74 2c20  uired argument, 
-00010580: 6073 7472 6561 6d5f 6e61 6d65 602c 2077  `stream_name`, w
-00010590: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
-000105a0: 2060 7374 7260 2074 6861 745c 6e75 6e69   `str` that\nuni
-000105b0: 7175 656c 7920 6964 656e 7469 6669 6573  quely identifies
-000105c0: 2061 2073 7472 6561 6d20 666f 7220 7768   a stream for wh
-000105d0: 6963 6820 6120 7374 7265 616d 206d 6574  ich a stream met
-000105e0: 6164 6174 6120 7769 6c6c 2062 6520 6f62  adata will be ob
-000105f0: 7461 696e 6564 2e5c 6e5c 6e54 6869 7320  tained.\n\nThis 
-00010600: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
-00010610: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-00010620: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
-00010630: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
-00010640: 6f61 7460 2074 6861 7420 7365 7473 5c6e  oat` that sets\n
-00010650: 6120 6465 6164 6c69 6e65 2066 6f72 2074  a deadline for t
-00010660: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-00010670: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-00010680: 696f 6e2e 5c6e 5c6e 5468 6973 206d 6574  ion.\n\nThis met
-00010690: 686f 6420 6861 7320 616e 206f 7074 696f  hod has an optio
-000106a0: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
-000106b0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-000106c0: 6820 6361 6e20 6265 2075 7365 6420 746f  h can be used to
-000106d0: 5c6e 6f76 6572 7269 6465 2063 616c 6c20  \noverride call 
-000106e0: 6372 6564 656e 7469 616c 7320 6465 7269  credentials deri
-000106f0: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
-00010700: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
-00010710: 5249 2e5c 6e5c 6e49 6e20 7468 6520 6578  RI.\n\nIn the ex
-00010720: 616d 706c 6520 6265 6c6f 772c 206d 6574  ample below, met
-00010730: 6164 6174 6120 666f 7220 6073 7472 6561  adata for `strea
-00010740: 6d5f 6e61 6d65 3160 2069 7320 6f62 7461  m_name1` is obta
-00010750: 696e 6564 2e5c 6e5c 6e60 6060 7079 7468  ined.\n\n```pyth
-00010760: 6f6e 5c6e 6d65 7461 6461 7461 2c20 6d65  on\nmetadata, me
-00010770: 7461 6461 7461 5f76 6572 7369 6f6e 203d  tadata_version =
-00010780: 2063 6c69 656e 742e 6765 745f 7374 7265   client.get_stre
-00010790: 616d 5f6d 6574 6164 6174 6128 7374 7265  am_metadata(stre
-000107a0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-000107b0: 616d 6531 295c 6e60 6060 5c6e 5c6e 5468  ame1)\n```\n\nTh
-000107c0: 6520 7265 7475 726e 6564 2060 6d65 7461  e returned `meta
-000107d0: 6461 7461 6020 7661 6c75 6520 6973 2061  data` value is a
-000107e0: 2050 7974 686f 6e20 6064 6963 7460 2e20   Python `dict`. 
-000107f0: 5468 6520 7265 7475 726e 6564 2060 6d65  The returned `me
-00010800: 7461 6461 7461 5f76 6572 7369 6f6e 605c  tadata_version`\
-00010810: 6e76 616c 7565 2069 7320 6569 7468 6572  nvalue is either
-00010820: 2061 6e20 6069 6e74 6020 6966 2074 6865   an `int` if the
-00010830: 2073 7472 6561 6d20 6578 6973 7473 2c20   stream exists, 
-00010840: 6f72 2060 5374 7265 616d 5374 6174 652e  or `StreamState.
-00010850: 4e4f 5f53 5452 4541 4d60 2069 6620 7468  NO_STREAM` if th
-00010860: 6520 7374 7265 616d 5c6e 646f 6573 206e  e stream\ndoes n
-00010870: 6f74 2065 7869 7374 2061 6e64 206e 6f20  ot exist and no 
-00010880: 6d65 7461 6461 7461 2068 6173 2062 6565  metadata has bee
-00010890: 6e20 7365 742e 2054 6865 7365 2076 616c  n set. These val
-000108a0: 7565 7320 6361 6e20 6265 2075 7365 6420  ues can be used 
-000108b0: 6173 2074 6865 2061 7267 756d 656e 7473  as the arguments
-000108c0: 5c6e 6f66 2060 7365 745f 7374 7265 616d  \nof `set_stream
-000108d0: 5f6d 6574 6164 6174 6128 2960 2e5c 6e5c  _metadata()`.\n\
-000108e0: 6e23 2323 2053 6574 2073 7472 6561 6d20  n### Set stream 
-000108f0: 6d65 7461 6461 7461 5c6e 5c6e 2a72 6571  metadata\n\n*req
-00010900: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
-00010910: 6e54 6865 206d 6574 686f 6420 6073 6574  nThe method `set
-00010920: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
-00010930: 2829 6020 7365 7473 206d 6574 6164 6174  ()` sets metadat
-00010940: 6120 666f 7220 6120 7374 7265 616d 2e20  a for a stream. 
-00010950: 5374 7265 616d 206d 6574 6164 6174 615c  Stream metadata\
-00010960: 6e63 616e 2062 6520 7365 7420 6265 666f  ncan be set befo
-00010970: 7265 2061 7070 656e 6469 6e67 2065 7665  re appending eve
-00010980: 6e74 7320 746f 2061 2073 7472 6561 6d2e  nts to a stream.
-00010990: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-000109a0: 6861 7320 6f6e 6520 7265 7175 6972 6564  has one required
-000109b0: 2061 7267 756d 656e 742c 2060 7374 7265   argument, `stre
-000109c0: 616d 5f6e 616d 6560 2c20 7768 6963 6820  am_name`, which 
-000109d0: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
-000109e0: 6020 7468 6174 5c6e 756e 6971 7565 6c79  ` that\nuniquely
-000109f0: 2069 6465 6e74 6966 6965 7320 6120 7374   identifies a st
-00010a00: 7265 616d 2066 6f72 2077 6869 6368 2061  ream for which a
-00010a10: 2073 7472 6561 6d20 6d65 7461 6461 7461   stream metadata
-00010a20: 2077 696c 6c20 6265 2073 6574 2e5c 6e5c   will be set.\n\
-00010a30: 6e54 6869 7320 6d65 7468 6f64 2068 6173  nThis method has
-00010a40: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
-00010a50: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
-00010a60: 2077 6869 6368 2069 7320 6120 5079 7468   which is a Pyth
-00010a70: 6f6e 2060 666c 6f61 7460 2074 6861 7420  on `float` that 
-00010a80: 7365 7473 5c6e 6120 6465 6164 6c69 6e65  sets\na deadline
-00010a90: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
-00010aa0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00010ab0: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 5468  operation.\n\nTh
-00010ac0: 6973 206d 6574 686f 6420 6861 7320 616e  is method has an
-00010ad0: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-00010ae0: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-00010af0: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
-00010b00: 7365 6420 746f 5c6e 6f76 6572 7269 6465  sed to\noverride
-00010b10: 2063 616c 6c20 6372 6564 656e 7469 616c   call credential
-00010b20: 7320 6465 7269 7665 6420 6672 6f6d 2074  s derived from t
-00010b30: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-00010b40: 7269 6e67 2055 5249 2e5c 6e5c 6e49 6e20  ring URI.\n\nIn 
-00010b50: 7468 6520 6578 616d 706c 6520 6265 6c6f  the example belo
-00010b60: 772c 206d 6574 6164 6174 6120 666f 7220  w, metadata for 
-00010b70: 6073 7472 6561 6d5f 6e61 6d65 3160 2069  `stream_name1` i
-00010b80: 7320 7365 742e 5c6e 5c6e 5c6e 6060 6070  s set.\n\n\n```p
-00010b90: 7974 686f 6e5c 6e6d 6574 6164 6174 615b  ython\nmetadata[
-00010ba0: 2266 6f6f 225d 203d 2022 6261 7222 5c6e  "foo"] = "bar"\n
-00010bb0: 5c6e 636c 6965 6e74 2e73 6574 5f73 7472  \nclient.set_str
-00010bc0: 6561 6d5f 6d65 7461 6461 7461 285c 6e20  eam_metadata(\n 
-00010bd0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-00010be0: 7472 6561 6d5f 6e61 6d65 312c 5c6e 2020  tream_name1,\n  
-00010bf0: 2020 6d65 7461 6461 7461 3d6d 6574 6164    metadata=metad
-00010c00: 6174 612c 5c6e 2020 2020 6375 7272 656e  ata,\n    curren
-00010c10: 745f 7665 7273 696f 6e3d 6d65 7461 6461  t_version=metada
-00010c20: 7461 5f76 6572 7369 6f6e 2c5c 6e29 5c6e  ta_version,\n)\n
-00010c30: 6060 605c 6e5c 6e54 6865 2060 6375 7272  ```\n\nThe `curr
-00010c40: 656e 745f 7665 7273 696f 6e60 2061 7267  ent_version` arg
-00010c50: 756d 656e 7420 7368 6f75 6c64 2062 6520  ument should be 
-00010c60: 7468 6520 6375 7272 656e 7420 7665 7273  the current vers
-00010c70: 696f 6e20 6f66 2074 6865 2073 7472 6561  ion of the strea
-00010c80: 6d20 6d65 7461 6461 7461 5c6e 6f62 7461  m metadata\nobta
-00010c90: 696e 6564 2066 726f 6d20 6067 6574 5f73  ined from `get_s
-00010ca0: 7472 6561 6d5f 6d65 7461 6461 7461 2829  tream_metadata()
-00010cb0: 602e 5c6e 5c6e 506c 6561 7365 2072 6566  `.\n\nPlease ref
-00010cc0: 6572 2074 6f20 7468 6520 4576 656e 7453  er to the EventS
-00010cd0: 746f 7265 4442 2064 6f63 756d 656e 7461  toreDB documenta
-00010ce0: 7469 6f6e 2066 6f72 206d 6f72 6520 696e  tion for more in
-00010cf0: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
-00010d00: 7374 7265 616d 5c6e 6d65 7461 6461 7461  stream\nmetadata
-00010d10: 2e5c 6e5c 6e23 2323 2044 656c 6574 6520  .\n\n### Delete 
-00010d20: 7374 7265 616d 5c6e 5c6e 2a72 6571 7569  stream\n\n*requi
-00010d30: 7265 7320 6c65 6164 6572 2a5c 6e5c 6e54  res leader*\n\nT
-00010d40: 6865 206d 6574 686f 6420 6064 656c 6574  he method `delet
-00010d50: 655f 7374 7265 616d 2829 6020 6361 6e20  e_stream()` can 
-00010d60: 6265 2075 7365 6420 746f 2022 6465 6c65  be used to "dele
-00010d70: 7465 2220 6120 7374 7265 616d 2e5c 6e5c  te" a stream.\n\
-00010d80: 6e54 6869 7320 6d65 7468 6f64 2068 6173  nThis method has
-00010d90: 2074 776f 2072 6571 7569 7265 6420 6172   two required ar
-00010da0: 6775 6d65 6e74 732c 2060 7374 7265 616d  guments, `stream
-00010db0: 5f6e 616d 6560 2061 6e64 2060 6375 7272  _name` and `curr
-00010dc0: 656e 745f 7665 7273 696f 6e60 2e5c 6e5c  ent_version`.\n\
-00010dd0: 6e54 6865 2072 6571 7569 7265 6420 6073  nThe required `s
-00010de0: 7472 6561 6d5f 6e61 6d65 6020 6172 6775  tream_name` argu
-00010df0: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
-00010e00: 2060 7374 7260 2074 6861 7420 756e 6971   `str` that uniq
-00010e10: 7565 6c79 2069 6465 6e74 6966 6965 7320  uely identifies 
-00010e20: 615c 6e73 7472 6561 6d20 746f 2077 6869  a\nstream to whi
-00010e30: 6368 2061 2073 6571 7565 6e63 6520 6f66  ch a sequence of
-00010e40: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
-00010e50: 6170 7065 6e64 6564 2e5c 6e5c 6e54 6865  appended.\n\nThe
-00010e60: 2072 6571 7569 7265 6420 6063 7572 7265   required `curre
-00010e70: 6e74 5f76 6572 7369 6f6e 6020 6172 6775  nt_version` argu
-00010e80: 6d65 6e74 2069 7320 6578 7065 6374 6564  ment is expected
-00010e90: 2074 6f20 6265 2065 6974 6865 7220 6120   to be either a 
-00010ea0: 5079 7468 6f6e 2060 696e 7460 5c6e 7468  Python `int`\nth
-00010eb0: 6174 2069 6e64 6963 6174 6573 2074 6865  at indicates the
-00010ec0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
-00010ed0: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
-00010ee0: 6f72 6465 6420 6576 656e 7420 696e 2074  orded event in t
-00010ef0: 6865 2073 7472 6561 6d2e 5c6e 5c6e 5468  he stream.\n\nTh
-00010f00: 6973 206d 6574 686f 6420 6861 7320 616e  is method has an
-00010f10: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
-00010f20: 7574 6020 6172 6775 6d65 6e74 2c20 7768  ut` argument, wh
-00010f30: 6963 6820 6973 2061 2050 7974 686f 6e20  ich is a Python 
-00010f40: 6066 6c6f 6174 6020 7468 6174 2073 6574  `float` that set
-00010f50: 735c 6e61 2064 6561 646c 696e 6520 666f  s\na deadline fo
-00010f60: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
-00010f70: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
-00010f80: 7261 7469 6f6e 2e5c 6e5c 6e54 6869 7320  ration.\n\nThis 
-00010f90: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
-00010fa0: 7469 6f6e 616c 2060 6372 6564 656e 7469  tional `credenti
-00010fb0: 616c 7360 2061 7267 756d 656e 742c 2077  als` argument, w
-00010fc0: 6869 6368 2063 616e 2062 6520 7573 6564  hich can be used
-00010fd0: 2074 6f5c 6e6f 7665 7272 6964 6520 6361   to\noverride ca
-00010fe0: 6c6c 2063 7265 6465 6e74 6961 6c73 2064  ll credentials d
-00010ff0: 6572 6976 6564 2066 726f 6d20 7468 6520  erived from the 
-00011000: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00011010: 6720 5552 492e 5c6e 5c6e 496e 2074 6865  g URI.\n\nIn the
-00011020: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
-00011030: 6073 7472 6561 6d5f 6e61 6d65 3160 2069  `stream_name1` i
-00011040: 7320 6465 6c65 7465 642e 5c6e 5c6e 6060  s deleted.\n\n``
-00011050: 6070 7974 686f 6e5c 6e63 6f6d 6d69 745f  `python\ncommit_
-00011060: 706f 7369 7469 6f6e 203d 2063 6c69 656e  position = clien
-00011070: 742e 6465 6c65 7465 5f73 7472 6561 6d28  t.delete_stream(
-00011080: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00011090: 616d 5f6e 616d 6531 2c20 6375 7272 656e  am_name1, curren
-000110a0: 745f 7665 7273 696f 6e3d 3229 5c6e 6060  t_version=2)\n``
-000110b0: 605c 6e5c 6e41 6674 6572 2064 656c 6574  `\n\nAfter delet
-000110c0: 696e 6720 6120 7374 7265 616d 2c20 6974  ing a stream, it
-000110d0: 5c27 7320 7374 696c 6c20 706f 7373 6962  \'s still possib
-000110e0: 6c65 2074 6f20 6170 7065 6e64 206e 6577  le to append new
-000110f0: 2065 7665 6e74 732e 2052 6561 6469 6e67   events. Reading
-00011100: 2066 726f 6d20 615c 6e64 656c 6574 6564   from a\ndeleted
-00011110: 2073 7472 6561 6d20 7769 6c6c 2072 6574   stream will ret
-00011120: 7572 6e20 6f6e 6c79 2065 7665 6e74 7320  urn only events 
-00011130: 7468 6174 2068 6176 6520 6265 656e 2061  that have been a
-00011140: 7070 656e 6465 6420 6166 7465 7220 6974  ppended after it
-00011150: 2077 6173 5c6e 6465 6c65 7465 642e 5c6e   was\ndeleted.\n
-00011160: 5c6e 2323 2320 546f 6d62 7374 6f6e 6520  \n### Tombstone 
-00011170: 7374 7265 616d 5c6e 5c6e 2a72 6571 7569  stream\n\n*requi
-00011180: 7265 7320 6c65 6164 6572 2a5c 6e5c 6e54  res leader*\n\nT
-00011190: 6865 206d 6574 686f 6420 6074 6f6d 6273  he method `tombs
-000111a0: 746f 6e65 5f73 7472 6561 6d28 2960 2063  tone_stream()` c
-000111b0: 616e 2062 6520 7573 6564 2074 6f20 2274  an be used to "t
-000111c0: 6f6d 6273 746f 6e65 2220 6120 7374 7265  ombstone" a stre
-000111d0: 616d 2e5c 6e5c 6e54 6869 7320 6d65 7468  am.\n\nThis meth
-000111e0: 6f64 2068 6173 2074 776f 2072 6571 7569  od has two requi
-000111f0: 7265 6420 6172 6775 6d65 6e74 732c 2060  red arguments, `
-00011200: 7374 7265 616d 5f6e 616d 6560 2061 6e64  stream_name` and
-00011210: 2060 6375 7272 656e 745f 7665 7273 696f   `current_versio
-00011220: 6e60 2e5c 6e5c 6e54 6865 2072 6571 7569  n`.\n\nThe requi
-00011230: 7265 6420 6073 7472 6561 6d5f 6e61 6d65  red `stream_name
-00011240: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
-00011250: 5079 7468 6f6e 2060 7374 7260 2074 6861  Python `str` tha
-00011260: 7420 756e 6971 7565 6c79 2069 6465 6e74  t uniquely ident
-00011270: 6966 6965 7320 615c 6e73 7472 6561 6d20  ifies a\nstream 
-00011280: 746f 2077 6869 6368 2061 2073 6571 7565  to which a seque
-00011290: 6e63 6520 6f66 2065 7665 6e74 7320 7769  nce of events wi
-000112a0: 6c6c 2062 6520 6170 7065 6e64 6564 2e5c  ll be appended.\
-000112b0: 6e5c 6e54 6865 2072 6571 7569 7265 6420  n\nThe required 
-000112c0: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
-000112d0: 6020 6172 6775 6d65 6e74 2069 7320 6578  ` argument is ex
-000112e0: 7065 6374 6564 2074 6f20 6265 2065 6974  pected to be eit
-000112f0: 6865 7220 6120 5079 7468 6f6e 2060 696e  her a Python `in
-00011300: 7460 5c6e 7468 6174 2069 6e64 6963 6174  t`\nthat indicat
-00011310: 6573 2074 6865 2073 7472 6561 6d20 706f  es the stream po
-00011320: 7369 7469 6f6e 206f 6620 7468 6520 6c61  sition of the la
-00011330: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
-00011340: 7420 696e 2074 6865 2073 7472 6561 6d2e  t in the stream.
-00011350: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00011360: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
-00011370: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-00011380: 6e74 2c20 7768 6963 6820 6973 2061 2050  nt, which is a P
-00011390: 7974 686f 6e20 6066 6c6f 6174 6020 7468  ython `float` th
-000113a0: 6174 2073 6574 735c 6e61 2064 6561 646c  at sets\na deadl
-000113b0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
-000113c0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-000113d0: 5043 206f 7065 7261 7469 6f6e 2e5c 6e5c  PC operation.\n\
-000113e0: 6e54 6869 7320 6d65 7468 6f64 2068 6173  nThis method has
-000113f0: 2061 6e20 6f70 7469 6f6e 616c 2060 6372   an optional `cr
-00011400: 6564 656e 7469 616c 7360 2061 7267 756d  edentials` argum
-00011410: 656e 742c 2077 6869 6368 2063 616e 2062  ent, which can b
-00011420: 6520 7573 6564 2074 6f5c 6e6f 7665 7272  e used to\noverr
-00011430: 6964 6520 6361 6c6c 2063 7265 6465 6e74  ide call credent
-00011440: 6961 6c73 2064 6572 6976 6564 2066 726f  ials derived fro
-00011450: 6d20 7468 6520 636f 6e6e 6563 7469 6f6e  m the connection
-00011460: 2073 7472 696e 6720 5552 492e 5c6e 5c6e   string URI.\n\n
-00011470: 496e 2074 6865 2065 7861 6d70 6c65 2062  In the example b
-00011480: 656c 6f77 2c20 6073 7472 6561 6d5f 6e61  elow, `stream_na
-00011490: 6d65 3160 2069 7320 746f 6d62 7374 6f6e  me1` is tombston
-000114a0: 6564 2e5c 6e5c 6e60 6060 7079 7468 6f6e  ed.\n\n```python
-000114b0: 5c6e 636f 6d6d 6974 5f70 6f73 6974 696f  \ncommit_positio
-000114c0: 6e20 3d20 636c 6965 6e74 2e74 6f6d 6273  n = client.tombs
-000114d0: 746f 6e65 5f73 7472 6561 6d28 7374 7265  tone_stream(stre
-000114e0: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-000114f0: 616d 6531 2c20 6375 7272 656e 745f 7665  ame1, current_ve
-00011500: 7273 696f 6e3d 3229 5c6e 6060 605c 6e5c  rsion=2)\n```\n\
-00011510: 6e41 6674 6572 2074 6f6d 6273 746f 6e69  nAfter tombstoni
-00011520: 6e67 2061 2073 7472 6561 6d2c 2069 745c  ng a stream, it\
-00011530: 2773 206e 6f74 2070 6f73 7369 626c 6520  's not possible 
-00011540: 746f 2061 7070 656e 6420 6e65 7720 6576  to append new ev
-00011550: 656e 7473 2e5c 6e5c 6e5c 6e23 2320 4361  ents.\n\n\n## Ca
-00011560: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-00011570: 696f 6e73 5c6e 5c6e 4120 2263 6174 6368  ions\n\nA "catch
-00011580: 2d75 7022 2073 7562 7363 7269 7074 696f  -up" subscriptio
-00011590: 6e20 6361 6e20 6265 2075 7365 6420 746f  n can be used to
-000115a0: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
-000115b0: 7468 6174 2068 6176 6520 616c 7265 6164  that have alread
-000115c0: 7920 6265 656e 5c6e 7265 636f 7264 6564  y been\nrecorded
-000115d0: 2061 6e64 2065 7665 6e74 7320 7468 6174   and events that
-000115e0: 2061 7265 2072 6563 6f72 6465 6420 7375   are recorded su
-000115f0: 6273 6571 7565 6e74 6c79 2e20 4120 6361  bsequently. A ca
-00011600: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-00011610: 696f 6e20 6361 6e5c 6e62 6520 7573 6564  ion can\nbe used
-00011620: 2062 7920 616e 2065 7665 6e74 2d70 726f   by an event-pro
-00011630: 6365 7373 696e 6720 636f 6d70 6f6e 656e  cessing componen
-00011640: 7420 7468 6174 2070 726f 6365 7373 6573  t that processes
-00011650: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-00011660: 2077 6974 685c 6e22 6578 6163 746c 792d   with\n"exactly-
-00011670: 6f6e 6365 2220 7365 6d61 6e74 6963 732e  once" semantics.
-00011680: 5c6e 5c6e 5468 6520 6073 7562 7363 7269  \n\nThe `subscri
-00011690: 6265 5f74 6f5f 616c 6c28 2960 206d 6574  be_to_all()` met
-000116a0: 686f 6420 7374 6172 7473 2061 2063 6174  hod starts a cat
-000116b0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-000116c0: 6f6e 2074 6861 7420 6361 6e20 7265 6365  on that can rece
-000116d0: 6976 655c 6e61 6c6c 2065 7665 6e74 7320  ive\nall events 
-000116e0: 696e 2074 6865 2064 6174 6162 6173 652e  in the database.
-000116f0: 2054 6865 2060 7375 6273 6372 6962 655f   The `subscribe_
-00011700: 746f 5f73 7472 6561 6d28 2960 206d 6574  to_stream()` met
-00011710: 686f 6420 7374 6172 7473 2061 2063 6174  hod starts a cat
-00011720: 6368 2d75 705c 6e73 7562 7363 7269 7074  ch-up\nsubscript
-00011730: 696f 6e20 7468 6174 2063 616e 2072 6563  ion that can rec
-00011740: 6569 7665 2065 7665 6e74 7320 6672 6f6d  eive events from
-00011750: 2061 2073 7065 6369 6669 6320 7374 7265   a specific stre
-00011760: 616d 2e20 426f 7468 206d 6574 686f 6473  am. Both methods
-00011770: 2072 6574 7572 6e20 615c 6e22 6361 7463   return a\n"catc
-00011780: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-00011790: 6e22 206f 626a 6563 742c 2077 6869 6368  n" object, which
-000117a0: 2069 7320 6120 5079 7468 6f6e 2069 7465   is a Python ite
-000117b0: 7261 746f 722e 2052 6563 6f72 6465 6420  rator. Recorded 
-000117c0: 6576 656e 7473 2063 616e 2062 655c 6e6f  events can be\no
-000117d0: 6274 6169 6e65 6420 6279 2069 7465 7261  btained by itera
-000117e0: 7469 6f6e 2e20 5265 636f 7264 6564 2065  tion. Recorded e
-000117f0: 7665 6e74 206f 626a 6563 7473 206f 6274  vent objects obt
-00011800: 6169 6e65 6420 696e 2074 6869 7320 7761  ained in this wa
-00011810: 7920 6172 6520 696e 7374 616e 6365 735c  y are instances\
-00011820: 6e6f 6620 7468 6520 6052 6563 6f72 6465  nof the `Recorde
-00011830: 6445 7665 6e74 6020 636c 6173 732e 5c6e  dEvent` class.\n
-00011840: 5c6e 4265 666f 7265 2074 6865 2022 6361  \nBefore the "ca
-00011850: 7463 682d 7570 2073 7562 7363 7269 7074  tch-up subscript
-00011860: 696f 6e22 206f 626a 6563 7420 6973 2072  ion" object is r
-00011870: 6574 7572 6e65 6420 746f 2074 6865 2063  eturned to the c
-00011880: 616c 6c65 722c 2074 6865 2063 6c69 656e  aller, the clien
-00011890: 7420 7769 6c6c 5c6e 6669 7273 746c 7920  t will\nfirstly 
-000118a0: 6f62 7461 696e 2061 2022 636f 6e66 6972  obtain a "confir
-000118b0: 6d61 7469 6f6e 2220 7265 7370 6f6e 7365  mation" response
-000118c0: 2066 726f 6d20 7468 6520 7365 7276 6572   from the server
-000118d0: 2c20 7768 6963 6820 616c 6c6f 7773 2074  , which allows t
-000118e0: 6865 2063 6c69 656e 7420 746f 5c6e 6465  he client to\nde
-000118f0: 7465 6374 2074 6861 7420 626f 7468 2074  tect that both t
-00011900: 6865 2067 5250 4320 636f 6e6e 6563 7469  he gRPC connecti
-00011910: 6f6e 2061 6e64 2074 6865 2073 7472 6561  on and the strea
-00011920: 6d69 6e67 2067 5250 4320 6361 6c6c 2069  ming gRPC call i
-00011930: 7320 6f70 6572 6174 696f 6e61 6c2e 2046  s operational. F
-00011940: 6f72 5c6e 7468 6973 2072 6561 736f 6e2c  or\nthis reason,
-00011950: 2074 6865 2060 7375 6273 6372 6962 655f   the `subscribe_
-00011960: 746f 5f61 6c6c 2829 6020 616e 6420 6073  to_all()` and `s
-00011970: 7562 7363 7269 6265 5f74 6f5f 7374 7265  ubscribe_to_stre
-00011980: 616d 2829 6020 6d65 7468 6f64 7320 6172  am()` methods ar
-00011990: 6520 626f 7468 5c6e 7573 6566 756c 6c79  e both\nusefully
-000119a0: 2064 6563 6f72 6174 6564 2077 6974 6820   decorated with 
-000119b0: 7468 6520 7265 636f 6e6e 6563 7420 616e  the reconnect an
-000119c0: 6420 7265 7472 7920 6465 636f 7261 746f  d retry decorato
-000119d0: 7273 2e20 486f 7765 7665 722c 206f 6e63  rs. However, onc
-000119e0: 6520 7468 6520 6d65 7468 6f64 5c6e 6861  e the method\nha
-000119f0: 7320 7265 7475 726e 6564 2c20 7468 6520  s returned, the 
-00011a00: 6465 636f 7261 746f 7273 2077 696c 6c20  decorators will 
-00011a10: 6861 7665 2065 7869 7465 642c 2061 6e64  have exited, and
-00011a20: 2061 6e79 2065 7863 6570 7469 6f6e 7320   any exceptions 
-00011a30: 7468 6174 2061 7265 2072 6169 7365 645c  that are raised\
-00011a40: 6e64 7565 2074 6f20 636f 6e6e 6563 7469  ndue to connecti
-00011a50: 6f6e 2069 7373 7565 7320 7768 696c 7374  on issues whilst
-00011a60: 2069 7465 7261 7469 6e67 206f 7665 7220   iterating over 
-00011a70: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-00011a80: 206f 626a 6563 7420 7769 6c6c 2068 6176   object will hav
-00011a90: 6520 746f 5c6e 6265 2068 616e 646c 6564  e to\nbe handled
-00011aa0: 2062 7920 796f 7572 2063 6f64 652e 5c6e   by your code.\n
-00011ab0: 5c6e 4120 2263 6174 6368 2d75 7020 7375  \nA "catch-up su
-00011ac0: 6273 6372 6970 7469 6f6e 2220 6974 6572  bscription" iter
-00011ad0: 6174 6f72 2077 696c 6c20 6e6f 7420 6175  ator will not au
-00011ae0: 746f 6d61 7469 6361 6c6c 7920 7374 6f70  tomatically stop
-00011af0: 2077 6865 6e20 7468 6572 6520 6172 6520   when there are 
-00011b00: 6e6f 206d 6f72 655c 6e65 7665 6e74 7320  no more\nevents 
-00011b10: 746f 2062 6520 7265 7475 726e 6564 2c20  to be returned, 
-00011b20: 6275 7420 696e 7374 6561 6420 7468 6520  but instead the 
-00011b30: 6974 6572 6174 696f 6e20 7769 6c6c 2062  iteration will b
-00011b40: 6c6f 636b 2075 6e74 696c 206e 6577 2065  lock until new e
-00011b50: 7665 6e74 7320 6172 655c 6e73 7562 7365  vents are\nsubse
-00011b60: 7175 656e 746c 7920 7265 636f 7264 6564  quently recorded
-00011b70: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
-00011b80: 2e20 416e 7920 7375 6273 6571 7565 6e74  . Any subsequent
-00011b90: 6c79 2072 6563 6f72 6465 6420 6576 656e  ly recorded even
-00011ba0: 7473 2077 696c 6c20 7468 656e 2062 655c  ts will then be\
-00011bb0: 6e69 6d6d 6564 6961 7465 6c79 2073 7472  nimmediately str
-00011bc0: 6561 6d65 6420 746f 2074 6865 2063 6c69  eamed to the cli
-00011bd0: 656e 742c 2061 6e64 2074 6865 2069 7465  ent, and the ite
-00011be0: 7261 7469 6f6e 2077 696c 6c20 7468 656e  ration will then
-00011bf0: 2063 6f6e 7469 6e75 652e 2054 6865 2073   continue. The s
-00011c00: 7472 6561 6d69 6e67 5c6e 6f66 2065 7665  treaming\nof eve
-00011c10: 6e74 732c 2061 6e64 2068 656e 6365 2074  nts, and hence t
-00011c20: 6865 2069 7465 7261 7469 6f6e 2c20 6361  he iteration, ca
-00011c30: 6e20 6265 2073 746f 7070 6564 2062 7920  n be stopped by 
-00011c40: 6361 6c6c 696e 6720 7468 6520 6073 746f  calling the `sto
-00011c50: 7028 2960 206d 6574 686f 6420 6f6e 2074  p()` method on t
-00011c60: 6865 5c6e 2263 6174 6368 2d75 7020 7375  he\n"catch-up su
-00011c70: 6273 6372 6970 7469 6f6e 2220 6f62 6a65  bscription" obje
-00011c80: 6374 2e5c 6e5c 6e23 2323 2053 7562 7363  ct.\n\n### Subsc
-00011c90: 7269 6265 2074 6f20 616c 6c20 6576 656e  ribe to all even
-00011ca0: 7473 5c6e 5c6e 5468 6560 7375 6273 6372  ts\n\nThe`subscr
-00011cb0: 6962 655f 746f 5f61 6c6c 2829 6020 6d65  ibe_to_all()` me
-00011cc0: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00011cd0: 2074 6f20 7374 6172 7420 6120 6361 7463   to start a catc
-00011ce0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-00011cf0: 6e5c 6e66 726f 6d20 7768 6963 6820 616c  n\nfrom which al
-00011d00: 6c20 6576 656e 7473 2072 6563 6f72 6465  l events recorde
-00011d10: 6420 696e 2074 6865 2064 6174 6162 6173  d in the databas
-00011d20: 6520 6361 6e20 6265 206f 6274 6169 6e65  e can be obtaine
-00011d30: 6420 696e 2074 6865 206f 7264 6572 5c6e  d in the order\n
-00011d40: 7468 6579 2077 6572 6520 7265 636f 7264  they were record
-00011d50: 6564 2e20 5468 6973 206d 6574 686f 6420  ed. This method 
-00011d60: 7265 7475 726e 7320 6120 2263 6174 6368  returns a "catch
-00011d70: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
-00011d80: 2220 6974 6572 6174 6f72 2e5c 6e5c 6e54  " iterator.\n\nT
-00011d90: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
-00011da0: 6861 7320 7369 7820 6f70 7469 6f6e 616c  has six optional
-00011db0: 2061 7267 756d 656e 7473 2c20 6063 6f6d   arguments, `com
-00011dc0: 6d69 745f 706f 7369 7469 6f6e 602c 2060  mit_position`, `
-00011dd0: 6669 6c74 6572 5f65 7863 6c75 6465 602c  filter_exclude`,
-00011de0: 5c6e 6066 696c 7465 725f 696e 636c 7564  \n`filter_includ
-00011df0: 6560 2c20 6066 696c 7465 725f 6279 5f73  e`, `filter_by_s
-00011e00: 7472 6561 6d5f 6e61 6d65 602c 2060 7469  tream_name`, `ti
-00011e10: 6d65 6f75 7460 2061 6e64 2060 6372 6564  meout` and `cred
-00011e20: 656e 7469 616c 7360 2e5c 6e5c 6e54 6865  entials`.\n\nThe
-00011e30: 206f 7074 696f 6e61 6c20 6063 6f6d 6d69   optional `commi
-00011e40: 745f 706f 7369 7469 6f6e 6020 6172 6775  t_position` argu
-00011e50: 6d65 6e74 2073 7065 6369 6669 6573 2061  ment specifies a
-00011e60: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
-00011e70: 2e20 5468 6520 6465 6661 756c 745c 6e76  . The default\nv
-00011e80: 616c 7565 206f 6620 6063 6f6d 6d69 745f  alue of `commit_
-00011e90: 706f 7369 7469 6f6e 6020 6973 2060 4e6f  position` is `No
-00011ea0: 6e65 602c 2077 6869 6368 206d 6561 6e73  ne`, which means
-00011eb0: 2074 6865 2063 6174 6368 2d75 7020 7375   the catch-up su
-00011ec0: 6273 6372 6970 7469 6f6e 2077 696c 6c5c  bscription will\
-00011ed0: 6e73 7461 7274 2066 726f 6d20 7468 6520  nstart from the 
-00011ee0: 6669 7273 7420 7265 636f 7264 6564 2065  first recorded e
-00011ef0: 7665 6e74 2069 6e20 7468 6520 6461 7461  vent in the data
-00011f00: 6261 7365 2e20 4966 2061 2063 6f6d 6d69  base. If a commi
-00011f10: 7420 706f 7369 7469 6f6e 2069 7320 6769  t position is gi
-00011f20: 7665 6e2c 5c6e 6974 206d 7573 7420 6d61  ven,\nit must ma
-00011f30: 7463 6820 616e 2061 6374 7561 6c6c 7920  tch an actually 
-00011f40: 6578 6973 7469 6e67 2063 6f6d 6d69 7420  existing commit 
-00011f50: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
-00011f60: 6461 7461 6261 7365 2e20 4f6e 6c79 2065  database. Only e
-00011f70: 7665 6e74 735c 6e72 6563 6f72 6465 6420  vents\nrecorded 
-00011f80: 6166 7465 7220 7468 6174 2070 6f73 6974  after that posit
-00011f90: 696f 6e20 7769 6c6c 2062 6520 6f62 7461  ion will be obta
-00011fa0: 696e 6564 2e5c 6e5c 6e54 6865 206f 7074  ined.\n\nThe opt
-00011fb0: 696f 6e61 6c20 6066 696c 7465 725f 6578  ional `filter_ex
-00011fc0: 636c 7564 6560 2061 7267 756d 656e 7420  clude` argument 
-00011fd0: 6973 2061 2073 6571 7565 6e63 6520 6f66  is a sequence of
-00011fe0: 2072 6567 756c 6172 2065 7870 7265 7373   regular express
-00011ff0: 696f 6e73 2074 6861 745c 6e73 7065 6369  ions that\nspeci
-00012000: 6669 6573 2077 6869 6368 2072 6563 6f72  fies which recor
-00012010: 6465 6420 6576 656e 7473 2073 686f 756c  ded events shoul
-00012020: 6420 6265 2072 6574 7572 6e65 642e 2054  d be returned. T
-00012030: 6869 7320 6172 6775 6d65 6e74 2069 7320  his argument is 
-00012040: 6967 6e6f 7265 645c 6e69 6620 6066 696c  ignored\nif `fil
-00012050: 7465 725f 696e 636c 7564 6560 2069 7320  ter_include` is 
-00012060: 7365 7420 746f 2061 206e 6f6e 2d65 6d70  set to a non-emp
-00012070: 7479 2073 6571 7565 6e63 652e 2054 6865  ty sequence. The
-00012080: 2064 6566 6175 6c74 2076 616c 7565 206f   default value o
-00012090: 6620 7468 6973 5c6e 6172 6775 6d65 6e74  f this\nargument
-000120a0: 206d 6174 6368 6573 2074 6865 2065 7665   matches the eve
-000120b0: 6e74 2074 7970 6573 206f 6620 4576 656e  nt types of Even
-000120c0: 7453 746f 7265 4442 2022 7379 7374 656d  tStoreDB "system
-000120d0: 2065 7665 6e74 7322 2c20 736f 2074 6861   events", so tha
-000120e0: 7420 7379 7374 656d 5c6e 6576 656e 7473  t system\nevents
-000120f0: 2077 696c 6c20 6e6f 7420 6e6f 726d 616c   will not normal
-00012100: 6c79 2062 6520 696e 636c 7564 6564 2e20  ly be included. 
-00012110: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
-00012120: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
-00012130: 6d6f 7265 5c6e 696e 666f 726d 6174 696f  more\ninformatio
-00012140: 6e20 6162 6f75 7420 6669 6c74 6572 2065  n about filter e
-00012150: 7870 7265 7373 696f 6e73 2e5c 6e5c 6e54  xpressions.\n\nT
-00012160: 6865 206f 7074 696f 6e61 6c20 6066 696c  he optional `fil
-00012170: 7465 725f 696e 636c 7564 6560 2061 7267  ter_include` arg
-00012180: 756d 656e 7420 6973 2061 2073 6571 7565  ument is a seque
-00012190: 6e63 6520 6f66 2072 6567 756c 6172 2065  nce of regular e
-000121a0: 7870 7265 7373 696f 6e73 5c6e 7468 6174  xpressions\nthat
-000121b0: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
-000121c0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
-000121d0: 2073 686f 756c 6420 6265 2072 6574 7572   should be retur
-000121e0: 6e65 642e 2042 7920 6465 6661 756c 742c  ned. By default,
-000121f0: 2074 6869 735c 6e61 7267 756d 656e 7420   this\nargument 
-00012200: 6973 2061 6e20 656d 7074 7920 7475 706c  is an empty tupl
-00012210: 652e 2049 6620 7468 6973 2061 7267 756d  e. If this argum
-00012220: 656e 7420 6973 2073 6574 2074 6f20 6120  ent is set to a 
-00012230: 6e6f 6e2d 656d 7074 7920 7365 7175 656e  non-empty sequen
-00012240: 6365 2c5c 6e74 6865 2060 6669 6c74 6572  ce,\nthe `filter
-00012250: 5f65 7863 6c75 6465 6020 6172 6775 6d65  _exclude` argume
-00012260: 6e74 2069 7320 6967 6e6f 7265 642e 5c6e  nt is ignored.\n
-00012270: 5c6e 5468 6520 6f70 7469 6f6e 616c 2060  \nThe optional `
-00012280: 6669 6c74 6572 5f62 795f 7374 7265 616d  filter_by_stream
-00012290: 5f6e 616d 6560 2061 7267 756d 656e 7420  _name` argument 
-000122a0: 6973 2061 2050 7974 686f 6e20 6062 6f6f  is a Python `boo
-000122b0: 6c60 2074 6861 7420 696e 6469 6361 7465  l` that indicate
-000122c0: 735c 6e77 6865 7468 6572 2074 6865 2066  s\nwhether the f
-000122d0: 696c 7465 7269 6e67 2077 696c 6c20 6170  iltering will ap
-000122e0: 706c 7920 746f 2065 7665 6e74 2074 7970  ply to event typ
-000122f0: 6573 206f 7220 7374 7265 616d 206e 616d  es or stream nam
-00012300: 6573 2e20 4279 2064 6566 6175 6c74 2c20  es. By default, 
-00012310: 7468 6973 5c6e 7661 6c75 6520 6973 2060  this\nvalue is `
-00012320: 4661 6c73 6560 2061 6e64 2073 6f20 7468  False` and so th
-00012330: 6520 6669 6c74 6572 696e 6720 7769 6c6c  e filtering will
-00012340: 2061 7070 6c79 2074 6f20 7468 6520 6576   apply to the ev
-00012350: 656e 7420 7479 7065 2073 7472 696e 6773  ent type strings
-00012360: 206f 665c 6e72 6563 6f72 6465 6420 6576   of\nrecorded ev
-00012370: 656e 7473 2e5c 6e5c 6e54 6865 206f 7074  ents.\n\nThe opt
-00012380: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
-00012390: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
-000123a0: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
-000123b0: 6368 2073 6574 7320 615c 6e64 6561 646c  ch sets a\ndeadl
-000123c0: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
-000123d0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-000123e0: 5043 206f 7065 7261 7469 6f6e 2e5c 6e5c  PC operation.\n\
-000123f0: 6e54 6865 206f 7074 696f 6e61 6c20 6063  nThe optional `c
-00012400: 7265 6465 6e74 6961 6c73 6020 6172 6775  redentials` argu
-00012410: 6d65 6e74 2063 616e 2062 6520 7573 6564  ment can be used
-00012420: 2074 6f5c 6e6f 7665 7272 6964 6520 6361   to\noverride ca
-00012430: 6c6c 2063 7265 6465 6e74 6961 6c73 2064  ll credentials d
-00012440: 6572 6976 6564 2066 726f 6d20 7468 6520  erived from the 
-00012450: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
-00012460: 6720 5552 492e 5c6e 5c6e 5468 6520 6578  g URI.\n\nThe ex
-00012470: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
-00012480: 7320 686f 7720 746f 2073 7461 7274 2061  s how to start a
-00012490: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
-000124a0: 6970 7469 6f6e 2074 6861 7420 7374 6172  iption that star
-000124b0: 7473 5c6e 6672 6f6d 2074 6865 2066 6972  ts\nfrom the fir
-000124c0: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
-000124d0: 7420 696e 2074 6865 2064 6174 6162 6173  t in the databas
-000124e0: 652e 5c6e 5c6e 6060 6070 7974 686f 6e5c  e.\n\n```python\
-000124f0: 6e23 2053 7562 7363 7269 6265 2066 726f  n# Subscribe fro
-00012500: 6d20 7468 6520 6669 7273 7420 7265 636f  m the first reco
-00012510: 7264 6564 2065 7665 6e74 2069 6e20 7468  rded event in th
-00012520: 6520 6461 7461 6261 7365 2e5c 6e63 6174  e database.\ncat
-00012530: 6368 7570 5f73 7562 7363 7269 7074 696f  chup_subscriptio
-00012540: 6e20 3d20 636c 6965 6e74 2e73 7562 7363  n = client.subsc
-00012550: 7269 6265 5f74 6f5f 616c 6c28 295c 6e60  ribe_to_all()\n`
-00012560: 6060 5c6e 5c6e 5468 6520 6578 616d 706c  ``\n\nThe exampl
-00012570: 6520 6265 6c6f 7720 7368 6f77 7320 7468  e below shows th
-00012580: 6174 2063 6174 6368 2d75 7020 7375 6273  at catch-up subs
-00012590: 6372 6970 7469 6f6e 7320 646f 206e 6f74  criptions do not
-000125a0: 2073 746f 705c 6e61 7574 6f6d 6174 6963   stop\nautomatic
-000125b0: 616c 6c79 2c20 6275 7420 626c 6f63 6b20  ally, but block 
-000125c0: 7768 656e 2074 6865 206c 6173 7420 7265  when the last re
-000125d0: 636f 7264 6564 2065 7665 6e74 2069 7320  corded event is 
-000125e0: 7265 6365 6976 6564 2c5c 6e61 6e64 2074  received,\nand t
-000125f0: 6865 6e20 636f 6e74 696e 7565 2077 6865  hen continue whe
-00012600: 6e20 7375 6273 6571 7565 6e74 2065 7665  n subsequent eve
-00012610: 6e74 7320 6172 6520 7265 636f 7264 6564  nts are recorded
-00012620: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-00012630: 6672 6f6d 2074 696d 6520 696d 706f 7274  from time import
-00012640: 2073 6c65 6570 5c6e 6672 6f6d 2074 6872   sleep\nfrom thr
-00012650: 6561 6469 6e67 2069 6d70 6f72 7420 5468  eading import Th
-00012660: 7265 6164 5c6e 5c6e 5c6e 2320 4170 7065  read\n\n\n# Appe
-00012670: 6e64 2061 206e 6577 2065 7665 6e74 2074  nd a new event t
-00012680: 6f20 6120 6e65 7720 7374 7265 616d 2e5c  o a new stream.\
-00012690: 6e73 7472 6561 6d5f 6e61 6d65 3220 3d20  nstream_name2 = 
-000126a0: 7374 7228 7575 6964 2e75 7569 6434 2829  str(uuid.uuid4()
-000126b0: 295c 6e65 7665 6e74 3420 3d20 4e65 7745  )\nevent4 = NewE
-000126c0: 7665 6e74 2874 7970 653d 5c27 4f72 6465  vent(type=\'Orde
-000126d0: 7243 7265 6174 6564 5c27 2c20 6461 7461  rCreated\', data
-000126e0: 3d62 5c27 6461 7461 345c 2729 5c6e 5c6e  =b\'data4\')\n\n
-000126f0: 636c 6965 6e74 2e61 7070 656e 645f 746f  client.append_to
-00012700: 5f73 7472 6561 6d28 5c6e 2020 2020 7374  _stream(\n    st
-00012710: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00012720: 5f6e 616d 6532 2c5c 6e20 2020 2063 7572  _name2,\n    cur
-00012730: 7265 6e74 5f76 6572 7369 6f6e 3d53 7472  rent_version=Str
-00012740: 6561 6d53 7461 7465 2e4e 4f5f 5354 5245  eamState.NO_STRE
-00012750: 414d 2c5c 6e20 2020 2065 7665 6e74 733d  AM,\n    events=
-00012760: 5b65 7665 6e74 345d 2c5c 6e29 5c6e 5c6e  [event4],\n)\n\n
-00012770: 5c6e 2320 5265 6365 6976 6520 6576 656e  \n# Receive even
-00012780: 7473 2066 726f 6d20 7468 6520 6361 7463  ts from the catc
-00012790: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-000127a0: 6e20 696e 2061 2064 6966 6665 7265 6e74  n in a different
-000127b0: 2074 6872 6561 642e 5c6e 7265 6365 6976   thread.\nreceiv
-000127c0: 6564 5f65 7665 6e74 7320 3d20 5b5d 5c6e  ed_events = []\n
-000127d0: 5c6e 6465 6620 7265 6365 6976 655f 6576  \ndef receive_ev
-000127e0: 656e 7473 2829 3a5c 6e20 2020 2066 6f72  ents():\n    for
-000127f0: 2065 7665 6e74 2069 6e20 6361 7463 6875   event in catchu
-00012800: 705f 7375 6273 6372 6970 7469 6f6e 3a5c  p_subscription:\
-00012810: 6e20 2020 2020 2020 2072 6563 6569 7665  n        receive
-00012820: 645f 6576 656e 7473 2e61 7070 656e 6428  d_events.append(
-00012830: 6576 656e 7429 5c6e 5c6e 5c6e 6465 6620  event)\n\n\ndef 
-00012840: 7761 6974 5f66 6f72 5f65 7665 6e74 2865  wait_for_event(e
-00012850: 7665 6e74 5f69 6429 3a5c 6e20 2020 2066  vent_id):\n    f
-00012860: 6f72 205f 2069 6e20 7261 6e67 6528 3130  or _ in range(10
-00012870: 3029 3a5c 6e20 2020 2020 2020 2066 6f72  0):\n        for
-00012880: 2065 7665 6e74 2069 6e20 7265 7665 7273   event in revers
-00012890: 6564 2872 6563 6569 7665 645f 6576 656e  ed(received_even
-000128a0: 7473 293a 5c6e 2020 2020 2020 2020 2020  ts):\n          
-000128b0: 2020 6966 2065 7665 6e74 2e69 6420 3d3d    if event.id ==
-000128c0: 2065 7665 6e74 5f69 643a 5c6e 2020 2020   event_id:\n    
-000128d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000128e0: 726e 5c6e 2020 2020 2020 2020 656c 7365  rn\n        else
-000128f0: 3a5c 6e20 2020 2020 2020 2020 2020 2073  :\n            s
-00012900: 6c65 6570 2830 2e31 295c 6e20 2020 2065  leep(0.1)\n    e
-00012910: 6c73 653a 5c6e 2020 2020 2020 2020 7261  lse:\n        ra
-00012920: 6973 6520 4173 7365 7274 696f 6e45 7272  ise AssertionErr
-00012930: 6f72 2822 4576 656e 7420 7761 736e 5c27  or("Event wasn\'
-00012940: 7420 7265 6365 6976 6564 2229 5c6e 5c6e  t received")\n\n
-00012950: 5c6e 7468 7265 6164 203d 2054 6872 6561  \nthread = Threa
-00012960: 6428 7461 7267 6574 3d72 6563 6569 7665  d(target=receive
-00012970: 5f65 7665 6e74 732c 2064 6165 6d6f 6e3d  _events, daemon=
-00012980: 5472 7565 295c 6e74 6872 6561 642e 7374  True)\nthread.st
-00012990: 6172 7428 295c 6e5c 6e23 2057 6169 7420  art()\n\n# Wait 
-000129a0: 746f 2072 6563 6569 7665 2065 7665 6e74  to receive event
-000129b0: 342e 5c6e 7761 6974 5f66 6f72 5f65 7665  4.\nwait_for_eve
-000129c0: 6e74 2865 7665 6e74 342e 6964 295c 6e5c  nt(event4.id)\n\
-000129d0: 6e23 2041 7070 656e 6420 616e 6f74 6865  n# Append anothe
-000129e0: 7220 6576 656e 7420 7768 696c 7374 2074  r event whilst t
-000129f0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-00012a00: 6973 2072 756e 6e69 6e67 2e5c 6e65 7665  is running.\neve
-00012a10: 6e74 3520 3d20 4e65 7745 7665 6e74 2874  nt5 = NewEvent(t
-00012a20: 7970 653d 5c27 4f72 6465 7255 7064 6174  ype=\'OrderUpdat
-00012a30: 6564 5c27 2c20 6461 7461 3d62 5c27 6461  ed\', data=b\'da
-00012a40: 7461 355c 2729 5c6e 636c 6965 6e74 2e61  ta5\')\nclient.a
-00012a50: 7070 656e 645f 746f 5f73 7472 6561 6d28  ppend_to_stream(
-00012a60: 5c6e 2020 2020 7374 7265 616d 5f6e 616d  \n    stream_nam
-00012a70: 653d 7374 7265 616d 5f6e 616d 6532 2c5c  e=stream_name2,\
-00012a80: 6e20 2020 2063 7572 7265 6e74 5f76 6572  n    current_ver
-00012a90: 7369 6f6e 3d30 2c5c 6e20 2020 2065 7665  sion=0,\n    eve
-00012aa0: 6e74 733d 5b65 7665 6e74 355d 2c5c 6e29  nts=[event5],\n)
-00012ab0: 5c6e 5c6e 2320 5761 6974 2066 6f72 2074  \n\n# Wait for t
-00012ac0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-00012ad0: 746f 2062 6c6f 636b 2e5c 6e77 6169 745f  to block.\nwait_
-00012ae0: 666f 725f 6576 656e 7428 6576 656e 7435  for_event(event5
-00012af0: 2e69 6429 5c6e 5c6e 2320 5374 6f70 2074  .id)\n\n# Stop t
-00012b00: 6865 2073 7562 7363 7269 7074 696f 6e2e  he subscription.
-00012b10: 5c6e 6361 7463 6875 705f 7375 6273 6372  \ncatchup_subscr
-00012b20: 6970 7469 6f6e 2e73 746f 7028 295c 6e74  iption.stop()\nt
-00012b30: 6872 6561 642e 6a6f 696e 2829 5c6e 6060  hread.join()\n``
-00012b40: 605c 6e5c 6e54 6865 2065 7861 6d70 6c65  `\n\nThe example
-00012b50: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
-00012b60: 2074 6f20 7375 6273 6372 6962 6520 746f   to subscribe to
-00012b70: 2065 7665 6e74 7320 7265 636f 7264 6564   events recorded
-00012b80: 2061 6674 6572 2061 5c6e 7061 7274 6963   after a\npartic
-00012b90: 756c 6172 2063 6f6d 6d69 7420 706f 7369  ular commit posi
-00012ba0: 7469 6f6e 2c20 696e 2074 6869 7320 6361  tion, in this ca
-00012bb0: 7365 2066 726f 6d20 7468 6520 636f 6d6d  se from the comm
-00012bc0: 6974 2070 6f73 6974 696f 6e20 6f66 5c6e  it position of\n
-00012bd0: 7468 6520 6c61 7374 2072 6563 6f72 6465  the last recorde
-00012be0: 6420 6576 656e 7420 7468 6174 2077 6173  d event that was
-00012bf0: 2072 6563 6569 7665 6420 6162 6f76 652e   received above.
-00012c00: 2041 6e6f 7468 6572 2065 7665 6e74 2069   Another event i
-00012c10: 735c 6e72 6563 6f72 6465 6420 6265 666f  s\nrecorded befo
-00012c20: 7265 2074 6865 2073 7562 7363 7269 7074  re the subscript
-00012c30: 696f 6e20 6973 2072 6573 7461 7274 6564  ion is restarted
-00012c40: 2e20 4675 7274 6865 7220 6576 656e 7473  . Further events
-00012c50: 2061 7265 5c6e 7265 636f 7264 6564 2077   are\nrecorded w
-00012c60: 6869 6c73 7420 7468 6520 7375 6273 6372  hilst the subscr
-00012c70: 6970 7469 6f6e 2069 7320 7275 6e6e 696e  iption is runnin
-00012c80: 672e 2054 6865 2065 7665 6e74 7320 7765  g. The events we
-00012c90: 2061 7070 656e 6465 645c 6e61 7265 2072   appended\nare r
-00012ca0: 6563 6569 7665 6420 696e 2074 6865 206f  eceived in the o
-00012cb0: 7264 6572 2074 6865 7920 7765 7265 2072  rder they were r
-00012cc0: 6563 6f72 6465 642e 5c6e 5c6e 5c6e 6060  ecorded.\n\n\n``
-00012cd0: 6070 7974 686f 6e5c 6e5c 6e23 2041 7070  `python\n\n# App
-00012ce0: 656e 6420 616e 6f74 6865 7220 6576 656e  end another even
-00012cf0: 742e 5c6e 6576 656e 7436 203d 204e 6577  t.\nevent6 = New
-00012d00: 4576 656e 7428 7479 7065 3d5c 274f 7264  Event(type=\'Ord
-00012d10: 6572 4465 6c65 7465 645c 272c 2064 6174  erDeleted\', dat
-00012d20: 613d 625c 2764 6174 6136 5c27 295c 6e63  a=b\'data6\')\nc
-00012d30: 6c69 656e 742e 6170 7065 6e64 5f74 6f5f  lient.append_to_
-00012d40: 7374 7265 616d 285c 6e20 2020 2073 7472  stream(\n    str
-00012d50: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00012d60: 6e61 6d65 322c 5c6e 2020 2020 6375 7272  name2,\n    curr
-00012d70: 656e 745f 7665 7273 696f 6e3d 312c 5c6e  ent_version=1,\n
-00012d80: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
-00012d90: 7436 5d2c 5c6e 295c 6e5c 6e23 2052 6573  t6],\n)\n\n# Res
-00012da0: 7461 7274 2073 7562 7363 7269 6269 6e67  tart subscribing
-00012db0: 2074 6f20 616c 6c20 6576 656e 7473 2061   to all events a
-00012dc0: 6674 6572 2074 6865 5c6e 2320 636f 6d6d  fter the\n# comm
-00012dd0: 6974 2070 6f73 6974 696f 6e20 6f66 2074  it position of t
-00012de0: 6865 206c 6173 7420 7265 6365 6976 6564  he last received
-00012df0: 2065 7665 6e74 2e5c 6e63 6174 6368 7570   event.\ncatchup
-00012e00: 5f73 7562 7363 7269 7074 696f 6e20 3d20  _subscription = 
-00012e10: 636c 6965 6e74 2e73 7562 7363 7269 6265  client.subscribe
-00012e20: 5f74 6f5f 616c 6c28 5c6e 2020 2020 636f  _to_all(\n    co
-00012e30: 6d6d 6974 5f70 6f73 6974 696f 6e3d 7265  mmit_position=re
-00012e40: 6365 6976 6564 5f65 7665 6e74 735b 2d31  ceived_events[-1
-00012e50: 5d2e 636f 6d6d 6974 5f70 6f73 6974 696f  ].commit_positio
-00012e60: 6e5c 6e29 5c6e 5c6e 7468 7265 6164 203d  n\n)\n\nthread =
-00012e70: 2054 6872 6561 6428 7461 7267 6574 3d72   Thread(target=r
-00012e80: 6563 6569 7665 5f65 7665 6e74 732c 2064  eceive_events, d
-00012e90: 6165 6d6f 6e3d 5472 7565 295c 6e74 6872  aemon=True)\nthr
-00012ea0: 6561 642e 7374 6172 7428 295c 6e5c 6e23  ead.start()\n\n#
-00012eb0: 2057 6169 7420 666f 7220 6576 656e 7436   Wait for event6
-00012ec0: 2e5c 6e77 6169 745f 666f 725f 6576 656e  .\nwait_for_even
-00012ed0: 7428 6576 656e 7436 2e69 6429 5c6e 5c6e  t(event6.id)\n\n
-00012ee0: 2320 4170 7065 6e64 2074 6872 6565 206d  # Append three m
-00012ef0: 6f72 6520 6576 656e 7473 2074 6f20 6120  ore events to a 
-00012f00: 6e65 7720 7374 7265 616d 2e5c 6e73 7472  new stream.\nstr
-00012f10: 6561 6d5f 6e61 6d65 3320 3d20 7374 7228  eam_name3 = str(
-00012f20: 7575 6964 2e75 7569 6434 2829 295c 6e65  uuid.uuid4())\ne
-00012f30: 7665 6e74 3720 3d20 4e65 7745 7665 6e74  vent7 = NewEvent
-00012f40: 2874 7970 653d 5c27 4f72 6465 7243 7265  (type=\'OrderCre
-00012f50: 6174 6564 5c27 2c20 6461 7461 3d62 5c27  ated\', data=b\'
-00012f60: 6461 7461 375c 2729 5c6e 6576 656e 7438  data7\')\nevent8
-00012f70: 203d 204e 6577 4576 656e 7428 7479 7065   = NewEvent(type
-00012f80: 3d5c 274f 7264 6572 5570 6461 7465 645c  =\'OrderUpdated\
-00012f90: 272c 2064 6174 613d 625c 2764 6174 6138  ', data=b\'data8
-00012fa0: 5c27 295c 6e65 7665 6e74 3920 3d20 4e65  \')\nevent9 = Ne
-00012fb0: 7745 7665 6e74 2874 7970 653d 5c27 4f72  wEvent(type=\'Or
-00012fc0: 6465 7244 656c 6574 6564 5c27 2c20 6461  derDeleted\', da
-00012fd0: 7461 3d62 5c27 6461 7461 395c 2729 5c6e  ta=b\'data9\')\n
-00012fe0: 5c6e 636c 6965 6e74 2e61 7070 656e 645f  \nclient.append_
-00012ff0: 746f 5f73 7472 6561 6d28 5c6e 2020 2020  to_stream(\n    
-00013000: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
-00013010: 616d 5f6e 616d 6533 2c5c 6e20 2020 2063  am_name3,\n    c
-00013020: 7572 7265 6e74 5f76 6572 7369 6f6e 3d53  urrent_version=S
-00013030: 7472 6561 6d53 7461 7465 2e4e 4f5f 5354  treamState.NO_ST
-00013040: 5245 414d 2c5c 6e20 2020 2065 7665 6e74  REAM,\n    event
-00013050: 733d 5b65 7665 6e74 372c 2065 7665 6e74  s=[event7, event
-00013060: 382c 2065 7665 6e74 395d 2c5c 6e29 5c6e  8, event9],\n)\n
-00013070: 5c6e 2320 5761 6974 2066 6f72 2065 7665  \n# Wait for eve
-00013080: 6e74 732e 5c6e 7761 6974 5f66 6f72 5f65  nts.\nwait_for_e
-00013090: 7665 6e74 2865 7665 6e74 372e 6964 295c  vent(event7.id)\
-000130a0: 6e77 6169 745f 666f 725f 6576 656e 7428  nwait_for_event(
-000130b0: 6576 656e 7438 2e69 6429 5c6e 7761 6974  event8.id)\nwait
-000130c0: 5f66 6f72 5f65 7665 6e74 2865 7665 6e74  _for_event(event
-000130d0: 392e 6964 295c 6e5c 6e23 2053 746f 7020  9.id)\n\n# Stop 
-000130e0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-000130f0: 2e5c 6e63 6174 6368 7570 5f73 7562 7363  .\ncatchup_subsc
-00013100: 7269 7074 696f 6e2e 7374 6f70 2829 5c6e  ription.stop()\n
-00013110: 7468 7265 6164 2e6a 6f69 6e28 295c 6e60  thread.join()\n`
-00013120: 6060 5c6e 5c6e 5468 6520 6361 7463 682d  ``\n\nThe catch-
-00013130: 7570 2073 7562 7363 7269 7074 696f 6e20  up subscription 
-00013140: 6361 6c6c 2069 7320 656e 6465 6420 6173  call is ended as
-00013150: 2073 6f6f 6e20 6173 2074 6865 2073 7562   soon as the sub
-00013160: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
-00013170: 5c27 735c 6e60 7374 6f70 2829 6020 6d65  \'s\n`stop()` me
-00013180: 7468 6f64 2069 7320 6361 6c6c 6564 2e20  thod is called. 
-00013190: 5468 6973 2068 6170 7065 6e73 2061 7574  This happens aut
-000131a0: 6f6d 6174 6963 616c 6c79 2077 6865 6e20  omatically when 
-000131b0: 6974 2067 6f65 7320 6f75 7420 6f66 2073  it goes out of s
-000131c0: 636f 7065 2c5c 6e6f 7220 7768 656e 2069  cope,\nor when i
-000131d0: 7420 6973 2065 7870 6c69 6369 746c 7920  t is explicitly 
-000131e0: 6465 6c65 7465 6420 6672 6f6d 206d 656d  deleted from mem
-000131f0: 6f72 7920 7573 696e 6720 7468 6520 5079  ory using the Py
-00013200: 7468 6f6e 2060 6465 6c60 206b 6579 776f  thon `del` keywo
-00013210: 7264 2e5c 6e5c 6e23 2323 2053 7562 7363  rd.\n\n### Subsc
-00013220: 7269 6265 2074 6f20 7374 7265 616d 2065  ribe to stream e
-00013230: 7665 6e74 735c 6e5c 6e54 6865 2060 7375  vents\n\nThe `su
-00013240: 6273 6372 6962 655f 746f 5f73 7472 6561  bscribe_to_strea
-00013250: 6d28 2960 206d 6574 686f 6420 6361 6e20  m()` method can 
-00013260: 6265 2075 7365 6420 746f 2073 7461 7274  be used to start
-00013270: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-00013280: 6372 6970 7469 6f6e 5c6e 6672 6f6d 2077  cription\nfrom w
-00013290: 6869 6368 2065 7665 6e74 7320 7265 636f  hich events reco
-000132a0: 7264 6564 2069 6e20 6120 7369 6e67 6c65  rded in a single
-000132b0: 2073 7472 6561 6d20 6361 6e20 6265 206f   stream can be o
-000132c0: 6274 6169 6e65 642e 2054 6869 7320 6d65  btained. This me
-000132d0: 7468 6f64 5c6e 7265 7475 726e 7320 6120  thod\nreturns a 
-000132e0: 2263 6174 6368 2d75 7020 7375 6273 6372  "catch-up subscr
-000132f0: 6970 7469 6f6e 2220 6974 6572 6174 6f72  iption" iterator
-00013300: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
-00013310: 2068 6173 2061 2072 6571 7569 7265 6420   has a required 
-00013320: 6073 7472 6561 6d5f 6e61 6d65 6020 6172  `stream_name` ar
-00013330: 6775 6d65 6e74 2c20 7768 6963 6820 7370  gument, which sp
-00013340: 6563 6966 6965 7320 7468 6520 6e61 6d65  ecifies the name
-00013350: 206f 6620 7468 655c 6e73 7472 6561 6d20   of the\nstream 
-00013360: 6672 6f6d 2077 6869 6368 2072 6563 6f72  from which recor
-00013370: 6465 6420 6576 656e 7473 2077 696c 6c20  ded events will 
-00013380: 6265 2072 6563 6569 7665 642e 5c6e 5c6e  be received.\n\n
-00013390: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
-000133a0: 2068 6173 2066 6f75 7220 6f70 7469 6f6e   has four option
-000133b0: 616c 2061 7267 756d 656e 7473 2c20 6073  al arguments, `s
-000133c0: 7472 6561 6d5f 706f 7369 7469 6f6e 602c  tream_position`,
-000133d0: 2060 7265 736f 6c76 655f 6c69 6e6b 7360   `resolve_links`
-000133e0: 2c5c 6e60 7469 6d65 6f75 7460 2061 6e64  ,\n`timeout` and
-000133f0: 2060 6372 6564 656e 7469 616c 7360 2e5c   `credentials`.\
-00013400: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
-00013410: 6073 7472 6561 6d5f 706f 7369 7469 6f6e  `stream_position
-00013420: 6020 6172 6775 6d65 6e74 2073 7065 6369  ` argument speci
-00013430: 6669 6573 2061 2070 6f73 6974 696f 6e20  fies a position 
-00013440: 696e 2074 6865 2073 7472 6561 6d2e 2054  in the stream. T
-00013450: 6865 5c6e 6465 6661 756c 7420 7661 6c75  he\ndefault valu
-00013460: 6520 6f66 2060 7374 7265 616d 5f70 6f73  e of `stream_pos
-00013470: 6974 696f 6e60 2069 7320 604e 6f6e 6560  ition` is `None`
-00013480: 2c20 7768 6963 6820 6d65 616e 7320 7468  , which means th
-00013490: 6174 2061 6c6c 2065 7665 6e74 735c 6e72  at all events\nr
-000134a0: 6563 6f72 6465 6420 696e 2074 6865 2073  ecorded in the s
-000134b0: 7472 6561 6d20 7769 6c6c 2062 6520 6f62  tream will be ob
-000134c0: 7461 696e 6564 2069 6e20 7468 6520 6f72  tained in the or
-000134d0: 6465 7220 7468 6579 2077 6572 6520 7265  der they were re
-000134e0: 636f 7264 6564 2e5c 6e49 6620 6120 7374  corded.\nIf a st
-000134f0: 7265 616d 2070 6f73 6974 696f 6e20 6973  ream position is
-00013500: 2067 6976 656e 2c20 7468 656e 206f 6e6c   given, then onl
-00013510: 7920 6576 656e 7473 2072 6563 6f72 6465  y events recorde
-00013520: 6420 6166 7465 7220 7468 6174 2070 6f73  d after that pos
-00013530: 6974 696f 6e5c 6e77 696c 6c20 6265 206f  ition\nwill be o
-00013540: 6274 6169 6e65 642e 5c6e 5c6e 5468 6520  btained.\n\nThe 
-00013550: 6f70 7469 6f6e 616c 2060 7265 736f 6c76  optional `resolv
-00013560: 655f 6c69 6e6b 7360 2061 7267 756d 656e  e_links` argumen
-00013570: 7420 6973 2061 2050 7974 686f 6e20 6062  t is a Python `b
-00013580: 6f6f 6c60 2e20 5468 6520 6465 6661 756c  ool`. The defaul
-00013590: 7420 7661 6c75 6520 6f66 2060 7265 736f  t value of `reso
-000135a0: 6c76 655f 6c69 6e6b 7360 5c6e 6973 2060  lve_links`\nis `
-000135b0: 4661 6c73 6560 2c20 7768 6963 6820 6d65  False`, which me
-000135c0: 616e 7320 616e 7920 6576 656e 7420 6c69  ans any event li
-000135d0: 6e6b 7320 7769 6c6c 206e 6f74 2062 6520  nks will not be 
-000135e0: 7265 736f 6c76 6564 2c20 736f 2074 6861  resolved, so tha
-000135f0: 7420 7468 6520 6576 656e 7473 2074 6861  t the events tha
-00013600: 7420 6172 655c 6e72 6574 7572 6e65 6420  t are\nreturned 
-00013610: 6d61 7920 7265 7072 6573 656e 7420 6576  may represent ev
-00013620: 656e 7420 6c69 6e6b 732e 2049 6620 6072  ent links. If `r
-00013630: 6573 6f6c 7665 5f6c 696e 6b73 6020 6973  esolve_links` is
-00013640: 2060 5472 7565 602c 2061 6e79 2065 7665   `True`, any eve
-00013650: 6e74 206c 696e 6b73 2077 696c 6c5c 6e62  nt links will\nb
-00013660: 6520 7265 736f 6c76 6564 2c20 736f 2074  e resolved, so t
-00013670: 6861 7420 7468 6520 6c69 6e6b 6564 2065  hat the linked e
-00013680: 7665 6e74 7320 7769 6c6c 2062 6520 7265  vents will be re
-00013690: 7475 726e 6564 2069 6e73 7465 6164 206f  turned instead o
-000136a0: 6620 7468 6520 6576 656e 7420 6c69 6e6b  f the event link
-000136b0: 732e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  s.\n\nThe option
-000136c0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
-000136d0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-000136e0: 6e20 6066 6c6f 6174 6020 7468 6174 2073  n `float` that s
-000136f0: 6574 735c 6e61 2064 6561 646c 696e 6520  ets\na deadline 
-00013700: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00013710: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00013720: 7065 7261 7469 6f6e 2e5c 6e5c 6e54 6865  peration.\n\nThe
-00013730: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-00013740: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-00013750: 2063 616e 2062 6520 7573 6564 2074 6f5c   can be used to\
-00013760: 6e6f 7665 7272 6964 6520 6361 6c6c 2063  noverride call c
-00013770: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
-00013780: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
-00013790: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
-000137a0: 492e 5c6e 5c6e 5468 6520 6578 616d 706c  I.\n\nThe exampl
-000137b0: 6520 6265 6c6f 7720 7368 6f77 7320 686f  e below shows ho
-000137c0: 7720 746f 2073 7461 7274 2061 2063 6174  w to start a cat
-000137d0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-000137e0: 6f6e 2066 726f 6d5c 6e74 6865 2066 6972  on from\nthe fir
-000137f0: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
-00013800: 7420 696e 2061 2073 7472 6561 6d2e 5c6e  t in a stream.\n
-00013810: 5c6e 6060 6070 7974 686f 6e5c 6e23 2053  \n```python\n# S
-00013820: 7562 7363 7269 6265 2066 726f 6d20 7468  ubscribe from th
-00013830: 6520 7374 6172 7420 6f66 205c 2773 7472  e start of \'str
-00013840: 6561 6d32 5c27 2e5c 6e73 7562 7363 7269  eam2\'.\nsubscri
-00013850: 7074 696f 6e20 3d20 636c 6965 6e74 2e73  ption = client.s
-00013860: 7562 7363 7269 6265 5f74 6f5f 7374 7265  ubscribe_to_stre
-00013870: 616d 2873 7472 6561 6d5f 6e61 6d65 3d73  am(stream_name=s
-00013880: 7472 6561 6d5f 6e61 6d65 3229 5c6e 6060  tream_name2)\n``
-00013890: 605c 6e5c 6e54 6865 2065 7861 6d70 6c65  `\n\nThe example
-000138a0: 2062 656c 6f77 2073 686f 7773 2068 6f77   below shows how
-000138b0: 2074 6f20 7374 6172 7420 6120 6361 7463   to start a catc
-000138c0: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-000138d0: 6e20 6672 6f6d 5c6e 6120 7061 7274 6963  n from\na partic
-000138e0: 756c 6172 2073 7472 6561 6d20 706f 7369  ular stream posi
-000138f0: 7469 6f6e 2e5c 6e5c 6e60 6060 7079 7468  tion.\n\n```pyth
-00013900: 6f6e 5c6e 2320 5375 6273 6372 6962 6520  on\n# Subscribe 
-00013910: 746f 2073 7472 6561 6d32 2c20 6672 6f6d  to stream2, from
-00013920: 2074 6865 2073 6563 6f6e 6420 7265 636f   the second reco
-00013930: 7264 6564 2065 7665 6e74 2e5c 6e73 7562  rded event.\nsub
-00013940: 7363 7269 7074 696f 6e20 3d20 636c 6965  scription = clie
-00013950: 6e74 2e73 7562 7363 7269 6265 5f74 6f5f  nt.subscribe_to_
-00013960: 7374 7265 616d 285c 6e20 2020 2073 7472  stream(\n    str
-00013970: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
-00013980: 6e61 6d65 322c 5c6e 2020 2020 7374 7265  name2,\n    stre
-00013990: 616d 5f70 6f73 6974 696f 6e3d 312c 5c6e  am_position=1,\n
-000139a0: 295c 6e60 6060 5c6e 5c6e 2323 2320 486f  )\n```\n\n### Ho
-000139b0: 7720 746f 2069 6d70 6c65 6d65 6e74 2065  w to implement e
-000139c0: 7861 6374 6c79 2d6f 6e63 6520 6576 656e  xactly-once even
-000139d0: 7420 7072 6f63 6573 7369 6e67 5c6e 5c6e  t processing\n\n
-000139e0: 5468 6520 636f 6d6d 6974 2070 6f73 6974  The commit posit
-000139f0: 696f 6e73 206f 6620 7265 636f 7264 6564  ions of recorded
-00013a00: 2065 7665 6e74 7320 7468 6174 2061 7265   events that are
-00013a10: 2072 6563 6569 7665 6420 616e 6420 7072   received and pr
-00013a20: 6f63 6573 7365 6420 6279 2061 5c6e 646f  ocessed by a\ndo
-00013a30: 776e 7374 7265 616d 2063 6f6d 706f 6e65  wnstream compone
-00013a40: 6e74 2061 7265 2075 7365 6675 6c6c 7920  nt are usefully 
-00013a50: 7265 636f 7264 6564 2062 7920 7468 6520  recorded by the 
-00013a60: 646f 776e 7374 7265 616d 2063 6f6d 706f  downstream compo
-00013a70: 6e65 6e74 2c20 736f 2074 6861 745c 6e74  nent, so that\nt
-00013a80: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-00013a90: 6f6e 206f 6620 6c61 7374 2070 726f 6365  on of last proce
-00013aa0: 7373 6564 2065 7665 6e74 2063 616e 2062  ssed event can b
-00013ab0: 6520 6465 7465 726d 696e 6564 2077 6865  e determined whe
-00013ac0: 6e20 7072 6f63 6573 7369 6e67 2069 735c  n processing is\
-00013ad0: 6e72 6573 756d 6564 2e5c 6e5c 6e54 6865  nresumed.\n\nThe
-00013ae0: 206c 6173 7420 7265 636f 7264 6564 2063   last recorded c
-00013af0: 6f6d 6d69 7420 706f 7369 7469 6f6e 2063  ommit position c
-00013b00: 616e 2062 6520 7573 6564 2074 6f20 7370  an be used to sp
-00013b10: 6563 6966 7920 7468 6520 636f 6d6d 6974  ecify the commit
-00013b20: 2070 6f73 6974 696f 6e20 6672 6f6d 2077   position from w
-00013b30: 6869 6368 5c6e 746f 2073 7562 7363 7269  hich\nto subscri
-00013b40: 6265 2077 6865 6e20 7072 6f63 6573 7369  be when processi
-00013b50: 6e67 2069 7320 7265 7375 6d65 642e 2053  ng is resumed. S
-00013b60: 696e 6365 2074 6869 7320 636f 6d6d 6974  ince this commit
-00013b70: 2070 6f73 6974 696f 6e20 7769 6c6c 2072   position will r
-00013b80: 6570 7265 7365 6e74 2074 6865 5c6e 706f  epresent the\npo
-00013b90: 7369 7469 6f6e 206f 6620 7468 6520 6c61  sition of the la
-00013ba0: 7374 2073 7563 6365 7373 6675 6c6c 7920  st successfully 
-00013bb0: 7072 6f63 6573 7365 6420 6576 656e 7420  processed event 
-00013bc0: 696e 2061 2064 6f77 6e73 7472 6561 6d20  in a downstream 
-00013bd0: 636f 6d70 6f6e 656e 742c 2073 6f20 6974  component, so it
-00013be0: 5c6e 7769 6c6c 2062 6520 7573 7561 6c20  \nwill be usual 
-00013bf0: 746f 2077 616e 7420 7468 6520 6e65 7874  to want the next
-00013c00: 2065 7665 6e74 2061 6674 6572 2074 6869   event after thi
-00013c10: 7320 706f 7369 7469 6f6e 2c20 6265 6361  s position, beca
-00013c20: 7573 6520 7468 6174 2069 7320 7468 6520  use that is the 
-00013c30: 6e65 7874 5c6e 6576 656e 7420 7468 6174  next\nevent that
-00013c40: 2068 6173 206e 6f74 2079 6574 2062 6565   has not yet bee
-00013c50: 6e20 7072 6f63 6573 7365 642e 2046 6f72  n processed. For
-00013c60: 2074 6869 7320 7265 6173 6f6e 2c20 7768   this reason, wh
-00013c70: 656e 2073 7562 7363 7269 6269 6e67 2066  en subscribing f
-00013c80: 6f72 2065 7665 6e74 735c 6e66 726f 6d20  or events\nfrom 
-00013c90: 6120 7370 6563 6966 6963 2063 6f6d 6d69  a specific commi
-00013ca0: 7420 706f 7369 7469 6f6e 2075 7369 6e67  t position using
-00013cb0: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
-00013cc0: 6372 6970 7469 6f6e 2069 6e20 4576 656e  cription in Even
-00013cd0: 7453 746f 7265 4442 2c20 7468 655c 6e72  tStoreDB, the\nr
-00013ce0: 6563 6f72 6465 6420 6576 656e 7420 6174  ecorded event at
-00013cf0: 2074 6865 2073 7065 6369 6669 6564 2063   the specified c
-00013d00: 6f6d 6d69 7420 706f 7369 7469 6f6e 2077  ommit position w
-00013d10: 696c 6c20 4e4f 5420 6265 2069 6e63 6c75  ill NOT be inclu
-00013d20: 6465 6420 696e 2074 6865 2073 6571 7565  ded in the seque
-00013d30: 6e63 655c 6e6f 6620 7265 636f 7264 6564  nce\nof recorded
-00013d40: 2065 7665 6e74 7320 7468 6174 2061 7265   events that are
-00013d50: 2072 6563 6569 7665 642e 5c6e 5c6e 546f   received.\n\nTo
-00013d60: 2061 6363 6f6d 706c 6973 6820 2265 7861   accomplish "exa
-00013d70: 6374 6c79 2d6f 6e63 6522 2070 726f 6365  ctly-once" proce
-00013d80: 7373 696e 6720 6f66 2072 6563 6f72 6465  ssing of recorde
-00013d90: 6420 6576 656e 7473 2069 6e20 6120 646f  d events in a do
-00013da0: 776e 7374 7265 616d 5c6e 636f 6d70 6f6e  wnstream\ncompon
-00013db0: 656e 7420 7768 656e 2075 7369 6e67 2061  ent when using a
-00013dc0: 2063 6174 6368 2d75 7020 7375 6273 6372   catch-up subscr
-00013dd0: 6970 7469 6f6e 2c20 7468 6520 636f 6d6d  iption, the comm
-00013de0: 6974 2070 6f73 6974 696f 6e20 6f66 2061  it position of a
-00013df0: 2072 6563 6f72 6465 645c 6e65 7665 6e74   recorded\nevent
-00013e00: 2073 686f 756c 6420 6265 2072 6563 6f72   should be recor
-00013e10: 6465 6420 6174 6f6d 6963 616c 6c79 2061  ded atomically a
-00013e20: 6e64 2075 6e69 7175 656c 7920 616c 6f6e  nd uniquely alon
-00013e30: 6720 7769 7468 2074 6865 2072 6573 756c  g with the resul
-00013e40: 7420 6f66 2070 726f 6365 7373 696e 675c  t of processing\
-00013e50: 6e72 6563 6f72 6465 6420 6576 656e 7473  nrecorded events
-00013e60: 2c20 666f 7220 6578 616d 706c 6520 696e  , for example in
-00013e70: 2074 6865 2073 616d 6520 6461 7461 6261   the same databa
-00013e80: 7365 2061 7320 6d61 7465 7269 616c 6973  se as materialis
-00013e90: 6564 2076 6965 7773 2077 6865 6e5c 6e69  ed views when\ni
-00013ea0: 6d70 6c65 6d65 6e74 696e 6720 6576 656e  mplementing even
-00013eb0: 7475 616c 6c79 2d63 6f6e 7369 7374 656e  tually-consisten
-00013ec0: 7420 4351 5253 2c20 6f72 2069 6e20 7468  t CQRS, or in th
-00013ed0: 6520 7361 6d65 2064 6174 6162 6173 6520  e same database 
-00013ee0: 6173 2061 2064 6f77 6e73 7472 6561 6d5c  as a downstream\
-00013ef0: 6e61 6e61 6c79 7469 6373 206f 7220 7265  nanalytics or re
-00013f00: 706f 7274 696e 6720 6f72 2061 7263 6869  porting or archi
-00013f10: 7669 6e67 2061 7070 6c69 6361 7469 6f6e  ving application
-00013f20: 2e20 4279 2072 6563 6f72 6469 6e67 2074  . By recording t
-00013f30: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
-00013f40: 6f6e 5c6e 6f66 2072 6563 6f72 6465 6420  on\nof recorded 
-00013f50: 6576 656e 7473 2061 746f 6d69 6361 6c6c  events atomicall
-00013f60: 7920 7769 7468 2074 6865 206e 6577 2073  y with the new s
-00013f70: 7461 7465 2074 6861 7420 7265 7375 6c74  tate that result
-00013f80: 7320 6672 6f6d 2070 726f 6365 7373 696e  s from processin
-00013f90: 675c 6e72 6563 6f72 6465 6420 6576 656e  g\nrecorded even
-00013fa0: 7473 2c20 2264 7561 6c20 7772 6974 696e  ts, "dual writin
-00013fb0: 6722 2069 6e20 7468 6520 636f 6e73 756d  g" in the consum
-00013fc0: 7074 696f 6e20 6f66 2072 6563 6f72 6465  ption of recorde
-00013fd0: 6420 6576 656e 7473 2063 616e 2062 655c  d events can be\
-00013fe0: 6e61 766f 6964 6564 2e20 4279 2061 6c73  navoided. By als
-00013ff0: 6f20 7265 636f 7264 696e 6720 7468 6520  o recording the 
-00014000: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
-00014010: 756e 6971 7565 6c79 2c20 7468 6520 6e65  uniquely, the ne
-00014020: 7720 7374 6174 6520 6361 6e6e 6f74 2062  w state cannot b
-00014030: 655c 6e72 6563 6f72 6465 6420 7477 6963  e\nrecorded twic
-00014040: 652c 2061 6e64 2068 656e 6365 2074 6865  e, and hence the
-00014050: 2072 6563 6f72 6465 6420 7374 6174 6520   recorded state 
-00014060: 6f66 2074 6865 2064 6f77 6e73 7472 6561  of the downstrea
-00014070: 6d20 636f 6d70 6f6e 656e 7420 7769 6c6c  m component will
-00014080: 2062 655c 6e75 7064 6174 6564 206f 6e6c   be\nupdated onl
-00014090: 7920 6f6e 6365 2066 6f72 2061 6e79 2072  y once for any r
-000140a0: 6563 6f72 6465 6420 6576 656e 742e 2042  ecorded event. B
-000140b0: 7920 7573 696e 6720 7468 6520 6772 6561  y using the grea
-000140c0: 7465 7374 2072 6563 6f72 6465 6420 636f  test recorded co
-000140d0: 6d6d 6974 5c6e 706f 7369 7469 6f6e 2074  mmit\nposition t
-000140e0: 6f20 7265 7375 6d65 2061 2063 6174 6368  o resume a catch
-000140f0: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
-00014100: 2c20 616c 6c20 7265 636f 7264 6564 2065  , all recorded e
-00014110: 7665 6e74 7320 7769 6c6c 2065 7665 6e74  vents will event
-00014120: 7561 6c6c 795c 6e62 6520 7072 6f63 6573  ually\nbe proces
-00014130: 7365 642e 2054 6865 2063 6f6d 6269 6e61  sed. The combina
-00014140: 7469 6f6e 206f 6620 7468 6520 2261 742d  tion of the "at-
-00014150: 6d6f 7374 2d6f 6e63 6522 2063 6f6e 6469  most-once" condi
-00014160: 7469 6f6e 2061 6e64 2074 6865 2022 6174  tion and the "at
-00014170: 2d6c 6561 7374 2d6f 6e63 6522 5c6e 636f  -least-once"\nco
-00014180: 6e64 6974 696f 6e20 6769 7665 7320 7468  ndition gives th
-00014190: 6520 2265 7861 6374 6c79 2d6f 6e63 6522  e "exactly-once"
-000141a0: 2063 6f6e 6469 7469 6f6e 2e5c 6e5c 6e54   condition.\n\nT
-000141b0: 6865 2064 616e 6765 7220 7769 7468 2022  he danger with "
-000141c0: 6475 616c 2077 7269 7469 6e67 2220 696e  dual writing" in
-000141d0: 2074 6865 2063 6f6e 7375 6d70 7469 6f6e   the consumption
-000141e0: 206f 6620 7265 636f 7264 6564 2065 7665   of recorded eve
-000141f0: 6e74 7320 6973 2074 6861 7420 6966 2061  nts is that if a
-00014200: 5c6e 7265 636f 7264 6564 2065 7665 6e74  \nrecorded event
-00014210: 2069 7320 7375 6363 6573 7366 756c 6c79   is successfully
-00014220: 2070 726f 6365 7373 6564 2061 6e64 206e   processed and n
-00014230: 6577 2073 7461 7465 2072 6563 6f72 6465  ew state recorde
-00014240: 6420 6174 6f6d 6963 616c 6c79 2069 6e20  d atomically in 
-00014250: 6f6e 655c 6e74 7261 6e73 6163 7469 6f6e  one\ntransaction
-00014260: 2077 6974 6820 7468 6520 636f 6d6d 6974   with the commit
-00014270: 2070 6f73 6974 696f 6e20 7265 636f 7264   position record
-00014280: 6564 2069 6e20 6120 7365 7061 7261 7465  ed in a separate
-00014290: 2074 7261 6e73 6163 7469 6f6e 2c20 6f6e   transaction, on
-000142a0: 6520 6d61 795c 6e68 6170 7065 6e20 616e  e may\nhappen an
-000142b0: 6420 6e6f 7420 7468 6520 6f74 6865 722e  d not the other.
-000142c0: 2049 6620 7468 6520 6e65 7720 7374 6174   If the new stat
-000142d0: 6520 6973 2072 6563 6f72 6465 6420 6275  e is recorded bu
-000142e0: 7420 7468 6520 706f 7369 7469 6f6e 2069  t the position i
-000142f0: 7320 6c6f 7374 2c5c 6e61 6e64 2074 6865  s lost,\nand the
-00014300: 6e20 7468 6520 7072 6f63 6573 7369 6e67  n the processing
-00014310: 2069 7320 7374 6f70 7065 6420 616e 6420   is stopped and 
-00014320: 7265 7375 6d65 642c 2074 6865 2072 6563  resumed, the rec
-00014330: 6f72 6465 6420 6576 656e 7420 6d61 7920  orded event may 
-00014340: 6265 2070 726f 6365 7373 6564 5c6e 7477  be processed\ntw
-00014350: 6963 652e 204f 6e20 7468 6520 6f74 6865  ice. On the othe
-00014360: 7220 6861 6e64 2c20 6966 2074 6865 2063  r hand, if the c
-00014370: 6f6d 6d69 7420 706f 7369 7469 6f6e 2069  ommit position i
-00014380: 7320 7265 636f 7264 6564 2062 7574 2074  s recorded but t
-00014390: 6865 206e 6577 2073 7461 7465 2069 735c  he new state is\
-000143a0: 6e6c 6f73 742c 2074 6865 2072 6563 6f72  nlost, the recor
-000143b0: 6465 6420 6576 656e 7420 6d61 7920 6566  ded event may ef
-000143c0: 6665 6374 6976 656c 7920 6e6f 7420 6265  fectively not be
-000143d0: 2070 726f 6365 7373 6564 2061 7420 616c   processed at al
-000143e0: 6c2e 2042 7920 6569 7468 6572 5c6e 7072  l. By either\npr
-000143f0: 6f63 6573 7369 6e67 2061 6e20 6576 656e  ocessing an even
-00014400: 7420 6d6f 7265 2074 6861 6e20 6f6e 6365  t more than once
-00014410: 2c20 6f72 2062 7920 6661 696c 696e 6720  , or by failing 
-00014420: 746f 2070 726f 6365 7373 2061 6e20 6576  to process an ev
-00014430: 656e 742c 2074 6865 2072 6563 6f72 6465  ent, the recorde
-00014440: 645c 6e73 7461 7465 206f 6620 7468 6520  d\nstate of the 
-00014450: 646f 776e 7374 7265 616d 2063 6f6d 706f  downstream compo
-00014460: 6e65 6e74 206d 6967 6874 2062 6520 696e  nent might be in
-00014470: 6163 6375 7261 7465 2c20 6f72 2070 6f73  accurate, or pos
-00014480: 7369 626c 7920 696e 636f 6e73 6973 7465  sibly inconsiste
-00014490: 6e74 2c20 616e 645c 6e70 6572 6861 7073  nt, and\nperhaps
-000144a0: 2063 6174 6173 7472 6f70 6869 6361 6c6c   catastrophicall
-000144b0: 7920 736f 2e20 5375 6368 2063 6f6e 7365  y so. Such conse
-000144c0: 7175 656e 6365 7320 6d61 7920 6f72 206d  quences may or m
-000144d0: 6179 206e 6f74 206d 6174 7465 7220 696e  ay not matter in
-000144e0: 2079 6f75 7220 7369 7475 6174 696f 6e2e   your situation.
-000144f0: 5c6e 4275 7420 736f 6d65 7469 6d65 7320  \nBut sometimes 
-00014500: 696e 636f 6e73 6973 7465 6e63 6965 7320  inconsistencies 
-00014510: 6d61 7920 6861 6c74 2070 726f 6365 7373  may halt process
-00014520: 696e 6720 756e 7469 6c20 7468 6520 6973  ing until the is
-00014530: 7375 6520 6973 2072 6573 6f6c 7665 642e  sue is resolved.
-00014540: 2059 6f75 2063 616e 5c6e 6176 6f69 6420   You can\navoid 
-00014550: 2264 7561 6c20 7772 6974 696e 6722 2069  "dual writing" i
-00014560: 6e20 7468 6520 636f 6e73 756d 7074 696f  n the consumptio
-00014570: 6e20 6f66 2065 7665 6e74 7320 6279 2061  n of events by a
-00014580: 746f 6d69 6361 6c6c 7920 7265 636f 7264  tomically record
-00014590: 696e 6720 7468 6520 636f 6d6d 6974 5c6e  ing the commit\n
-000145a0: 706f 7369 7469 6f6e 206f 6620 6120 7265  position of a re
-000145b0: 636f 7264 6564 2065 7665 6e74 2061 6c6f  corded event alo
-000145c0: 6e67 2077 6974 6820 7468 6520 6e65 7720  ng with the new 
-000145d0: 7374 6174 6520 7468 6174 2072 6573 756c  state that resul
-000145e0: 7473 2066 726f 6d20 7072 6f63 6573 7369  ts from processi
-000145f0: 6e67 2074 6861 745c 6e65 7665 6e74 2069  ng that\nevent i
-00014600: 6e20 7468 6520 7361 6d65 2061 746f 6d69  n the same atomi
-00014610: 6320 7472 616e 7361 6374 696f 6e2e 2042  c transaction. B
-00014620: 7920 6d61 6b69 6e67 2074 6865 2072 6563  y making the rec
-00014630: 6f72 6469 6e67 206f 6620 7468 6520 636f  ording of the co
-00014640: 6d6d 6974 2070 6f73 6974 696f 6e73 5c6e  mmit positions\n
-00014650: 756e 6971 7565 2c20 736f 2074 6861 7420  unique, so that 
-00014660: 7472 616e 7361 6374 696f 6e73 2077 696c  transactions wil
-00014670: 6c20 6265 2072 6f6c 6c65 6420 6261 636b  l be rolled back
-00014680: 2077 6865 6e20 7468 6572 6520 6973 2061   when there is a
-00014690: 2063 6f6e 666c 6963 742c 2079 6f75 2077   conflict, you w
-000146a0: 696c 6c5c 6e70 7265 7665 6e74 2074 6865  ill\nprevent the
-000146b0: 2072 6573 756c 7473 206f 6620 616e 7920   results of any 
-000146c0: 6475 706c 6963 6174 6520 7072 6f63 6573  duplicate proces
-000146d0: 7369 6e67 206f 6620 6120 7265 636f 7264  sing of a record
-000146e0: 6564 2065 7665 6e74 2062 6569 6e67 2063  ed event being c
-000146f0: 6f6d 6d69 7474 6564 2e5c 6e5c 6e52 6563  ommitted.\n\nRec
-00014700: 6f72 6465 6420 6576 656e 7473 2072 6563  orded events rec
-00014710: 6569 7665 6420 6672 6f6d 2061 2063 6174  eived from a cat
-00014720: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
-00014730: 6f6e 2063 616e 6e6f 7420 6265 2061 636b  on cannot be ack
-00014740: 6e6f 776c 6564 6765 6420 6261 636b 5c6e  nowledged back\n
-00014750: 746f 2074 6865 2045 7665 6e74 5374 6f72  to the EventStor
-00014760: 6544 4220 7365 7276 6572 2e20 4163 6b6e  eDB server. Ackn
-00014770: 6f77 6c65 6467 696e 6720 6576 656e 7473  owledging events
-00014780: 2c20 686f 7765 7665 722c 2069 7320 616e  , however, is an
-00014790: 2061 7370 6563 7420 6f66 2022 7065 7273   aspect of "pers
-000147a0: 6973 7465 6e74 5c6e 7375 6273 6372 6970  istent\nsubscrip
-000147b0: 7469 6f6e 7322 2e20 486f 7069 6e67 2074  tions". Hoping t
-000147c0: 6f20 7265 6c79 206f 6e20 6163 6b6e 6f77  o rely on acknow
-000147d0: 6c65 6467 696e 6720 6576 656e 7473 2074  ledging events t
-000147e0: 6f20 616e 2075 7073 7472 6561 6d5c 6e63  o an upstream\nc
-000147f0: 6f6d 706f 6e65 6e74 2069 7320 616e 2065  omponent is an e
-00014800: 7861 6d70 6c65 206f 6620 6475 616c 2077  xample of dual w
-00014810: 7269 7469 6e67 2e5c 6e5c 6e5c 6e23 2320  riting.\n\n\n## 
-00014820: 5065 7273 6973 7465 6e74 2073 7562 7363  Persistent subsc
-00014830: 7269 7074 696f 6e73 5c6e 5c6e 496e 2045  riptions\n\nIn E
-00014840: 7665 6e74 5374 6f72 6544 422c 2022 7065  ventStoreDB, "pe
-00014850: 7273 6973 7465 6e74 2220 7375 6273 6372  rsistent" subscr
-00014860: 6970 7469 6f6e 7320 6172 6520 7369 6d69  iptions are simi
-00014870: 6c61 7220 746f 2063 6174 6368 2d75 7020  lar to catch-up 
-00014880: 7375 6273 6372 6970 7469 6f6e 732c 5c6e  subscriptions,\n
-00014890: 696e 2074 6861 7420 7265 6164 696e 6720  in that reading 
-000148a0: 6120 7065 7273 6973 7465 6e74 2073 7562  a persistent sub
-000148b0: 7363 7269 7074 696f 6e20 7769 6c6c 2062  scription will b
-000148c0: 6c6f 636b 2077 6865 6e20 7468 6572 6520  lock when there 
-000148d0: 6172 6520 6e6f 206d 6f72 6520 7265 636f  are no more reco
-000148e0: 7264 6564 5c6e 6576 656e 7473 2074 6f20  rded\nevents to 
-000148f0: 6265 2072 6563 6569 7665 642c 2061 6e64  be received, and
-00014900: 2074 6865 6e20 636f 6e74 696e 7565 2077   then continue w
-00014910: 6865 6e20 6e65 7720 6576 656e 7473 2061  hen new events a
-00014920: 7265 2073 7562 7365 7175 656e 746c 7920  re subsequently 
-00014930: 7265 636f 7264 6564 2e5c 6e5c 6e50 6572  recorded.\n\nPer
-00014940: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-00014950: 7469 6f6e 7320 6361 6e5c 6e5c 6e50 6572  tions can\n\nPer
-00014960: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-00014970: 7469 6f6e 7320 6361 6e20 6265 2063 6f6e  tions can be con
-00014980: 7375 6d65 6420 6279 2061 2067 726f 7570  sumed by a group
-00014990: 206f 6620 636f 6e73 756d 6572 7320 6f70   of consumers op
-000149a0: 6572 6174 696e 6720 7769 7468 206f 6e65  erating with one
-000149b0: 5c6e 6f66 2074 6865 2073 7570 706f 7274  \nof the support
-000149c0: 6564 2022 636f 6e73 756d 6572 2073 7472  ed "consumer str
-000149d0: 6174 6567 6965 7322 2e5c 6e5c 6e54 6865  ategies".\n\nThe
-000149e0: 2073 6967 6e69 6669 6361 6e74 2064 6966   significant dif
-000149f0: 6665 7265 6e74 2077 6974 6820 7065 7273  ferent with pers
-00014a00: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
-00014a10: 696f 6e73 2069 7320 7468 6520 7365 7276  ions is the serv
-00014a20: 6572 2077 696c 6c20 6b65 6570 2074 7261  er will keep tra
-00014a30: 636b 5c6e 6f66 2074 6865 2070 726f 6772  ck\nof the progr
-00014a40: 6573 7320 6f66 2074 6865 2063 6f6e 7375  ess of the consu
-00014a50: 6d65 7273 2e20 5468 6520 636f 6e73 756d  mers. The consum
-00014a60: 6572 206f 6620 6120 7065 7273 6973 7465  er of a persiste
-00014a70: 6e74 2073 7562 7363 7269 7074 696f 6e20  nt subscription 
-00014a80: 7769 6c6c 5c6e 7468 6572 6566 6f72 6520  will\ntherefore 
-00014a90: 6e65 6564 2074 6f20 2261 636b 6e6f 776c  need to "acknowl
-00014aa0: 6564 6765 2220 7768 656e 2061 2072 6563  edge" when a rec
-00014ab0: 6f72 6465 6420 6576 656e 7420 6861 7320  orded event has 
-00014ac0: 6265 656e 2070 726f 6365 7373 6564 2073  been processed s
-00014ad0: 7563 6365 7373 6675 6c6c 792c 5c6e 616e  uccessfully,\nan
-00014ae0: 6420 6f74 6865 7277 6973 6520 226e 6567  d otherwise "neg
-00014af0: 6174 6976 656c 7920 6163 6b6e 6f77 6c65  atively acknowle
-00014b00: 6467 6522 2061 2072 6563 6f72 6465 6420  dge" a recorded 
-00014b10: 6576 656e 7420 7468 6174 2068 6173 2062  event that has b
-00014b20: 6565 6e20 7265 6365 6976 6564 2062 7574  een received but
-00014b30: 2077 6173 5c6e 6e6f 7420 7375 6363 6573   was\nnot succes
-00014b40: 7366 756c 6c79 2070 726f 6365 7373 6564  sfully processed
-00014b50: 2e5c 6e5c 6e41 6c6c 206f 6620 7468 6973  .\n\nAll of this
-00014b60: 206d 6561 6e73 2074 6861 7420 666f 7220   means that for 
-00014b70: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00014b80: 7269 7074 696f 6e73 2074 6865 7265 2061  riptions there a
-00014b90: 7265 2022 6372 6561 7465 222c 2022 7265  re "create", "re
-00014ba0: 6164 222c 2022 7570 6461 7465 225c 6e22  ad", "update"\n"
-00014bb0: 6465 6c65 7465 222c 2022 6163 6b22 2c20  delete", "ack", 
-00014bc0: 616e 6420 226e 6163 6b22 206f 7065 7261  and "nack" opera
-00014bd0: 7469 6f6e 7320 746f 2063 6f6e 7369 6465  tions to conside
-00014be0: 722e 5c6e 5c6e 5768 696c 7374 2074 6865  r.\n\nWhilst the
-00014bf0: 7265 2061 7265 2073 6f6d 6520 6164 7661  re are some adva
-00014c00: 6e74 6167 6573 206f 6620 7065 7273 6973  ntages of persis
-00014c10: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-00014c20: 6e73 2c20 696e 2070 6172 7469 6375 6c61  ns, in particula
-00014c30: 7220 7468 655c 6e63 6f6e 6375 7272 656e  r the\nconcurren
-00014c40: 7420 7072 6f63 6573 7369 6e67 206f 6620  t processing of 
-00014c50: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-00014c60: 6279 2061 2067 726f 7570 206f 6620 636f  by a group of co
-00014c70: 6e73 756d 6572 732c 2062 7920 7472 6163  nsumers, by trac
-00014c80: 6b69 6e67 2069 6e5c 6e74 6865 2073 6572  king in\nthe ser
-00014c90: 7665 7220 7468 6520 706f 7369 7469 6f6e  ver the position
-00014ca0: 2069 6e20 7468 6520 636f 6d6d 6974 2073   in the commit s
-00014cb0: 6571 7565 6e63 6520 6f66 2065 7665 6e74  equence of event
-00014cc0: 7320 7468 6174 2068 6176 6520 6265 656e  s that have been
-00014cd0: 2070 726f 6365 7373 6564 2c5c 6e74 6865   processed,\nthe
-00014ce0: 2069 7373 7565 206f 6620 2264 7561 6c20   issue of "dual 
-00014cf0: 7772 6974 696e 6722 2069 6e20 7468 6520  writing" in the 
-00014d00: 636f 6e73 756d 7074 696f 6e20 6f66 2065  consumption of e
-00014d10: 7665 6e74 7320 6172 6973 6573 2e20 5265  vents arises. Re
-00014d20: 6c69 6162 696c 6974 7920 696e 2074 6865  liability in the
-00014d30: 5c6e 7072 6f63 6573 7369 6e67 206f 6620  \nprocessing of 
-00014d40: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-00014d50: 6279 2061 2067 726f 7570 206f 6620 7065  by a group of pe
-00014d60: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-00014d70: 7074 696f 6e20 636f 6e73 756d 6572 7320  ption consumers 
-00014d80: 7769 6c6c 5c6e 7265 6c79 206f 6e20 7468  will\nrely on th
-00014d90: 6569 7220 6964 656d 706f 7465 6e74 2068  eir idempotent h
-00014da0: 616e 646c 696e 6720 6f66 2064 7570 6c69  andling of dupli
-00014db0: 6361 7465 206d 6573 7361 6765 732c 2061  cate messages, a
-00014dc0: 6e64 2074 6865 6972 2072 6573 696c 6965  nd their resilie
-00014dd0: 6e63 6520 746f 5c6e 6f75 742d 6f66 2d6f  nce to\nout-of-o
-00014de0: 7264 6572 2064 656c 6976 6572 792e 5c6e  rder delivery.\n
-00014df0: 5c6e 5c6e 2323 2320 4372 6561 7465 2073  \n\n### Create s
-00014e00: 7562 7363 7269 7074 696f 6e20 746f 2061  ubscription to a
-00014e10: 6c6c 5c6e 5c6e 2a72 6571 7569 7265 7320  ll\n\n*requires 
-00014e20: 6c65 6164 6572 2a5c 6e5c 6e54 6865 2060  leader*\n\nThe `
-00014e30: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
-00014e40: 696f 6e5f 746f 5f61 6c6c 2829 6020 6d65  ion_to_all()` me
-00014e50: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
-00014e60: 2074 6f20 6372 6561 7465 2061 2022 7065   to create a "pe
-00014e70: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-00014e80: 7074 696f 6e22 5c6e 746f 2061 6c6c 2074  ption"\nto all t
-00014e90: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
-00014ea0: 7473 2069 6e20 7468 6520 6461 7461 6261  ts in the databa
-00014eb0: 7365 2061 6372 6f73 7320 616c 6c20 7374  se across all st
-00014ec0: 7265 616d 732e 5c6e 5c6e 5468 6973 206d  reams.\n\nThis m
-00014ed0: 6574 686f 6420 6861 7320 6120 7265 7175  ethod has a requ
-00014ee0: 6972 6564 2060 6772 6f75 705f 6e61 6d65  ired `group_name
-00014ef0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
-00014f00: 6820 6973 2074 6865 5c6e 6e61 6d65 206f  h is the\nname o
-00014f10: 6620 6120 2267 726f 7570 2220 6f66 2063  f a "group" of c
-00014f20: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
-00014f30: 7375 6273 6372 6970 7469 6f6e 2e5c 6e5c  subscription.\n\
-00014f40: 6e54 6869 7320 6d65 7468 6f64 2061 6c73  nThis method als
-00014f50: 6f20 6861 7320 6569 6768 7420 6f70 7469  o has eight opti
-00014f60: 6f6e 616c 2061 7267 756d 656e 7473 2c20  onal arguments, 
-00014f70: 6066 726f 6d5f 656e 6460 2c20 6063 6f6d  `from_end`, `com
-00014f80: 6d69 745f 706f 7369 7469 6f6e 602c 5c6e  mit_position`,\n
-00014f90: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
-00014fa0: 2c20 6066 696c 7465 725f 696e 636c 7564  , `filter_includ
-00014fb0: 6560 2c20 6066 696c 7465 725f 6279 5f73  e`, `filter_by_s
-00014fc0: 7472 6561 6d5f 6e61 6d65 602c 2060 636f  tream_name`, `co
-00014fd0: 6e73 756d 6572 5f73 7472 6174 6567 7960  nsumer_strategy`
-00014fe0: 2c5c 6e60 7469 6d65 6f75 7460 2061 6e64  ,\n`timeout` and
-00014ff0: 2060 6372 6564 656e 7469 616c 7360 2e5c   `credentials`.\
-00015000: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
-00015010: 6066 726f 6d5f 656e 6460 2061 7267 756d  `from_end` argum
-00015020: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
-00015030: 746f 2073 7065 6369 6679 2074 6861 7420  to specify that 
-00015040: 7468 6520 6772 6f75 7020 6f66 2063 6f6e  the group of con
-00015050: 7375 6d65 7273 5c6e 6f66 2074 6865 2073  sumers\nof the s
-00015060: 7562 7363 7269 7074 696f 6e20 7368 6f75  ubscription shou
-00015070: 6c64 206f 6e6c 7920 7265 6365 6976 6520  ld only receive 
-00015080: 6576 656e 7473 2074 6861 7420 7765 7265  events that were
-00015090: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
-000150a0: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
-000150b0: 5c6e 7761 7320 6372 6561 7465 642e 5c6e  \nwas created.\n
-000150c0: 5c6e 416c 7465 726e 6174 6976 656c 792c  \nAlternatively,
-000150d0: 2074 6865 206f 7074 696f 6e61 6c20 6063   the optional `c
-000150e0: 6f6d 6d69 745f 706f 7369 7469 6f6e 6020  ommit_position` 
-000150f0: 6172 6775 6d65 6e74 2063 616e 2062 6520  argument can be 
-00015100: 7573 6564 2074 6f20 7370 6563 6966 7920  used to specify 
-00015110: 6120 636f 6d6d 6974 5c6e 706f 7369 7469  a commit\npositi
-00015120: 6f6e 2066 726f 6d20 7768 6963 6820 636f  on from which co
-00015130: 6d6d 6974 2070 6f73 6974 696f 6e20 7468  mmit position th
-00015140: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
-00015150: 6d65 7273 206f 6620 7468 6520 7375 6273  mers of the subs
-00015160: 6372 6970 7469 6f6e 2073 686f 756c 645c  cription should\
-00015170: 6e72 6563 6569 7665 2065 7665 6e74 732e  nreceive events.
-00015180: 2050 6c65 6173 6520 6e6f 7465 2c20 7468   Please note, th
-00015190: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
-000151a0: 2061 7420 7468 6520 7370 6563 6966 6965   at the specifie
-000151b0: 6420 636f 6d6d 6974 2070 6f73 6974 696f  d commit positio
-000151c0: 6e20 6d69 6768 745c 6e62 6520 696e 636c  n might\nbe incl
-000151d0: 7564 6564 2069 6e20 7468 6520 7265 636f  uded in the reco
-000151e0: 7264 6564 2065 7665 6e74 7320 7265 6365  rded events rece
-000151f0: 6976 6564 2062 7920 7468 6520 6772 6f75  ived by the grou
-00015200: 7020 6f66 2063 6f6e 7375 6d65 7273 2e5c  p of consumers.\
-00015210: 6e5c 6e49 6620 6e65 6974 6865 7220 6066  n\nIf neither `f
-00015220: 726f 6d5f 656e 6460 206f 7220 6063 6f6d  rom_end` or `com
-00015230: 6d69 745f 706f 7369 7469 6f6e 6020 6172  mit_position` ar
-00015240: 6520 7370 6563 6966 6965 642c 2074 6865  e specified, the
-00015250: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
-00015260: 6572 735c 6e6f 6620 7468 6520 7375 6273  ers\nof the subs
-00015270: 6372 6970 7469 6f6e 2077 696c 6c20 706f  cription will po
-00015280: 7465 6e74 6961 6c6c 7920 7265 6365 6976  tentially receiv
-00015290: 6520 616c 6c20 7265 636f 7264 6564 2065  e all recorded e
-000152a0: 7665 6e74 7320 696e 2074 6865 2064 6174  vents in the dat
-000152b0: 6162 6173 652e 5c6e 5c6e 5468 6520 6f70  abase.\n\nThe op
-000152c0: 7469 6f6e 616c 2060 6669 6c74 6572 5f65  tional `filter_e
-000152d0: 7863 6c75 6465 6020 6172 6775 6d65 6e74  xclude` argument
-000152e0: 2069 7320 6120 7365 7175 656e 6365 206f   is a sequence o
-000152f0: 6620 7265 6775 6c61 7220 6578 7072 6573  f regular expres
-00015300: 7369 6f6e 7320 7468 6174 5c6e 7370 6563  sions that\nspec
-00015310: 6966 6965 7320 7768 6963 6820 7265 636f  ifies which reco
-00015320: 7264 6564 2065 7665 6e74 7320 7368 6f75  rded events shou
-00015330: 6c64 2062 6520 7265 7475 726e 6564 2e20  ld be returned. 
-00015340: 5468 6973 2061 7267 756d 656e 7420 6973  This argument is
-00015350: 2069 676e 6f72 6564 5c6e 6966 2060 6669   ignored\nif `fi
-00015360: 6c74 6572 5f69 6e63 6c75 6465 6020 6973  lter_include` is
-00015370: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
-00015380: 7074 7920 7365 7175 656e 6365 2e20 5468  pty sequence. Th
-00015390: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
-000153a0: 6f66 2074 6869 735c 6e61 7267 756d 656e  of this\nargumen
-000153b0: 7420 6d61 7463 6865 7320 7468 6520 6576  t matches the ev
-000153c0: 656e 7420 7479 7065 7320 6f66 2045 7665  ent types of Eve
-000153d0: 6e74 5374 6f72 6544 4220 2273 7973 7465  ntStoreDB "syste
-000153e0: 6d20 6576 656e 7473 222c 2073 6f20 7468  m events", so th
-000153f0: 6174 2073 7973 7465 6d5c 6e65 7665 6e74  at system\nevent
-00015400: 7320 7769 6c6c 206e 6f74 206e 6f72 6d61  s will not norma
-00015410: 6c6c 7920 6265 2069 6e63 6c75 6465 642e  lly be included.
-00015420: 2053 6565 2074 6865 204e 6f74 6573 2073   See the Notes s
-00015430: 6563 7469 6f6e 2062 656c 6f77 2066 6f72  ection below for
-00015440: 206d 6f72 655c 6e69 6e66 6f72 6d61 7469   more\ninformati
-00015450: 6f6e 2061 626f 7574 2066 696c 7465 7220  on about filter 
-00015460: 6578 7072 6573 7369 6f6e 732e 5c6e 5c6e  expressions.\n\n
-00015470: 5468 6520 6f70 7469 6f6e 616c 2060 6669  The optional `fi
-00015480: 6c74 6572 5f69 6e63 6c75 6465 6020 6172  lter_include` ar
-00015490: 6775 6d65 6e74 2069 7320 6120 7365 7175  gument is a sequ
-000154a0: 656e 6365 206f 6620 7265 6775 6c61 7220  ence of regular 
-000154b0: 6578 7072 6573 7369 6f6e 735c 6e74 6861  expressions\ntha
-000154c0: 7420 7370 6563 6966 6965 7320 7768 6963  t specifies whic
-000154d0: 6820 7265 636f 7264 6564 2065 7665 6e74  h recorded event
-000154e0: 7320 7368 6f75 6c64 2062 6520 7265 7475  s should be retu
-000154f0: 726e 6564 2e20 4279 2064 6566 6175 6c74  rned. By default
-00015500: 2c20 7468 6973 5c6e 6172 6775 6d65 6e74  , this\nargument
-00015510: 2069 7320 616e 2065 6d70 7479 2074 7570   is an empty tup
-00015520: 6c65 2e20 4966 2074 6869 7320 6172 6775  le. If this argu
-00015530: 6d65 6e74 2069 7320 7365 7420 746f 2061  ment is set to a
-00015540: 206e 6f6e 2d65 6d70 7479 2073 6571 7565   non-empty seque
-00015550: 6e63 652c 5c6e 7468 6520 6066 696c 7465  nce,\nthe `filte
-00015560: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
-00015570: 656e 7420 6973 2069 676e 6f72 6564 2e5c  ent is ignored.\
-00015580: 6e5c 6e54 6865 206f 7074 696f 6e61 6c20  n\nThe optional 
-00015590: 6066 696c 7465 725f 6279 5f73 7472 6561  `filter_by_strea
-000155a0: 6d5f 6e61 6d65 6020 6172 6775 6d65 6e74  m_name` argument
-000155b0: 2069 7320 6120 5079 7468 6f6e 2060 626f   is a Python `bo
-000155c0: 6f6c 6020 7468 6174 2069 6e64 6963 6174  ol` that indicat
-000155d0: 6573 5c6e 7768 6574 6865 7220 7468 6520  es\nwhether the 
-000155e0: 6669 6c74 6572 696e 6720 7769 6c6c 2061  filtering will a
-000155f0: 7070 6c79 2074 6f20 6576 656e 7420 7479  pply to event ty
-00015600: 7065 7320 6f72 2073 7472 6561 6d20 6e61  pes or stream na
-00015610: 6d65 732e 2042 7920 6465 6661 756c 742c  mes. By default,
-00015620: 2074 6869 735c 6e76 616c 7565 2069 7320   this\nvalue is 
-00015630: 6046 616c 7365 6020 616e 6420 736f 2074  `False` and so t
-00015640: 6865 2066 696c 7465 7269 6e67 2077 696c  he filtering wil
-00015650: 6c20 6170 706c 7920 746f 2074 6865 2065  l apply to the e
-00015660: 7665 6e74 2074 7970 6520 7374 7269 6e67  vent type string
-00015670: 7320 6f66 5c6e 7265 636f 7264 6564 2065  s of\nrecorded e
-00015680: 7665 6e74 732e 5c6e 5c6e 5468 6520 6f70  vents.\n\nThe op
-00015690: 7469 6f6e 616c 2060 636f 6e73 756d 6572  tional `consumer
-000156a0: 5f73 7472 6174 6567 7960 2061 7267 756d  _strategy` argum
-000156b0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
-000156c0: 6073 7472 6020 7468 6174 2064 6566 696e  `str` that defin
-000156d0: 6573 5c6e 7468 6520 636f 6e73 756d 6572  es\nthe consumer
-000156e0: 2073 7472 6174 6567 7920 666f 7220 7468   strategy for th
-000156f0: 6973 2070 6572 7369 7374 656e 7420 7375  is persistent su
-00015700: 6273 6372 6970 7469 6f6e 2e20 5468 6520  bscription. The 
-00015710: 7661 6c75 6520 6f66 2074 6869 7320 6172  value of this ar
-00015720: 6775 6d65 6e74 5c6e 6361 6e20 6265 2060  gument\ncan be `
-00015730: 5c27 4469 7370 6174 6368 546f 5369 6e67  \'DispatchToSing
-00015740: 6c65 5c27 602c 2060 5c27 526f 756e 6452  le\'`, `\'RoundR
-00015750: 6f62 696e 5c27 602c 2060 5c27 5069 6e6e  obin\'`, `\'Pinn
-00015760: 6564 5c27 602c 206f 7220 605c 2750 696e  ed\'`, or `\'Pin
-00015770: 6e65 6442 7943 6f72 7265 6c61 7469 6f6e  nedByCorrelation
-00015780: 5c27 602e 2054 6865 5c6e 6465 6661 756c  \'`. The\ndefaul
-00015790: 7420 7661 6c75 6520 6973 2060 5c27 4469  t value is `\'Di
-000157a0: 7370 6174 6368 546f 5369 6e67 6c65 5c27  spatchToSingle\'
-000157b0: 602e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  `.\n\nThe option
-000157c0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
-000157d0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-000157e0: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
-000157f0: 7365 7473 2061 5c6e 6465 6164 6c69 6e65  sets a\ndeadline
-00015800: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
-00015810: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00015820: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 5468  operation.\n\nTh
-00015830: 6520 6f70 7469 6f6e 616c 2060 6372 6564  e optional `cred
-00015840: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
-00015850: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-00015860: 5c6e 6f76 6572 7269 6465 2063 616c 6c20  \noverride call 
-00015870: 6372 6564 656e 7469 616c 7320 6465 7269  credentials deri
-00015880: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
-00015890: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
-000158a0: 5249 2e5c 6e5c 6e54 6865 206d 6574 686f  RI.\n\nThe metho
-000158b0: 6420 6063 7265 6174 655f 7375 6273 6372  d `create_subscr
-000158c0: 6970 7469 6f6e 5f74 6f5f 616c 6c28 2960  iption_to_all()`
-000158d0: 2064 6f65 7320 6e6f 7420 7265 7475 726e   does not return
-000158e0: 2061 2076 616c 7565 2e20 5265 636f 7264   a value. Record
-000158f0: 6564 2065 7665 6e74 7320 6172 655c 6e6f  ed events are\no
-00015900: 6274 6169 6e65 6420 6279 2063 616c 6c69  btained by calli
-00015910: 6e67 2074 6865 2060 7265 6164 5f73 7562  ng the `read_sub
-00015920: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
-00015930: 2829 6020 6d65 7468 6f64 2e5c 6e5c 6e49  ()` method.\n\nI
-00015940: 6e20 7468 6520 6578 616d 706c 6520 6265  n the example be
-00015950: 6c6f 772c 2061 2070 6572 7369 7374 656e  low, a persisten
-00015960: 7420 7375 6273 6372 6970 7469 6f6e 2069  t subscription i
-00015970: 7320 6372 6561 7465 6420 746f 206f 7065  s created to ope
-00015980: 7261 7465 2066 726f 6d20 7468 655c 6e66  rate from the\nf
-00015990: 6972 7374 2072 6563 6f72 6465 6420 6e6f  irst recorded no
-000159a0: 6e2d 7379 7374 656d 2065 7665 6e74 2069  n-system event i
-000159b0: 6e20 7468 6520 6461 7461 6261 7365 2e5c  n the database.\
-000159c0: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 2320  n\n```python\n# 
-000159d0: 4372 6561 7465 2061 2070 6572 7369 7374  Create a persist
-000159e0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-000159f0: 2e5c 6e67 726f 7570 5f6e 616d 6531 203d  .\ngroup_name1 =
-00015a00: 2066 2267 726f 7570 2d7b 7575 6964 2e75   f"group-{uuid.u
-00015a10: 7569 6434 2829 7d22 5c6e 636c 6965 6e74  uid4()}"\nclient
-00015a20: 2e63 7265 6174 655f 7375 6273 6372 6970  .create_subscrip
-00015a30: 7469 6f6e 5f74 6f5f 616c 6c28 6772 6f75  tion_to_all(grou
-00015a40: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
-00015a50: 6531 295c 6e60 6060 5c6e 5c6e 2323 2320  e1)\n```\n\n### 
-00015a60: 5265 6164 2073 7562 7363 7269 7074 696f  Read subscriptio
-00015a70: 6e20 746f 2061 6c6c 5c6e 5c6e 2a72 6571  n to all\n\n*req
-00015a80: 7569 7265 7320 6c65 6164 6572 2a5c 6e5c  uires leader*\n\
-00015a90: 6e54 6865 2060 7265 6164 5f73 7562 7363  nThe `read_subsc
-00015aa0: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
-00015ab0: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
-00015ac0: 7573 6564 2062 7920 6120 6772 6f75 7020  used by a group 
-00015ad0: 6f66 2063 6f6e 7375 6d65 7273 2074 6f20  of consumers to 
-00015ae0: 7265 6365 6976 655c 6e72 6563 6f72 6465  receive\nrecorde
-00015af0: 6420 6576 656e 7473 2066 726f 6d20 6120  d events from a 
-00015b00: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00015b10: 7269 7074 696f 6e20 7468 6174 2068 6173  ription that has
-00015b20: 2062 6565 6e20 6372 6561 7465 6420 7573   been created us
-00015b30: 696e 675c 6e74 6865 2060 6372 6561 7465  ing\nthe `create
-00015b40: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
-00015b50: 5f61 6c6c 2829 6020 6d65 7468 6f64 2e5c  _all()` method.\
-00015b60: 6e5c 6e54 6869 7320 6d65 7468 6f64 2068  n\nThis method h
-00015b70: 6173 2061 2072 6571 7569 7265 6420 6067  as a required `g
-00015b80: 726f 7570 5f6e 616d 6560 2061 7267 756d  roup_name` argum
-00015b90: 656e 742c 2077 6869 6368 2069 735c 6e74  ent, which is\nt
-00015ba0: 6865 206e 616d 6520 6f66 2061 2022 6772  he name of a "gr
-00015bb0: 6f75 7022 206f 6620 636f 6e73 756d 6572  oup" of consumer
-00015bc0: 7320 6f66 2074 6865 2073 7562 7363 7269  s of the subscri
-00015bd0: 7074 696f 6e20 7370 6563 6966 6965 645c  ption specified\
-00015be0: 6e77 6865 6e20 6063 7265 6174 655f 7375  nwhen `create_su
-00015bf0: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
-00015c00: 6c28 2960 2077 6173 2063 616c 6c65 642e  l()` was called.
-00015c10: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00015c20: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
-00015c30: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-00015c40: 6e74 2c20 7468 6174 5c6e 6973 2065 7870  nt, that\nis exp
-00015c50: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
-00015c60: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
-00015c70: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
-00015c80: 696e 655c 6e66 6f72 2074 6865 2063 6f6d  ine\nfor the com
-00015c90: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-00015ca0: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
-00015cb0: 5c6e 5468 6973 206d 6574 686f 6420 616c  \nThis method al
-00015cc0: 736f 2068 6173 2061 6e20 6f70 7469 6f6e  so has an option
-00015cd0: 616c 2060 6372 6564 656e 7469 616c 7360  al `credentials`
-00015ce0: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
-00015cf0: 2063 616e 2062 6520 7573 6564 2074 6f5c   can be used to\
-00015d00: 6e6f 7665 7272 6964 6520 6361 6c6c 2063  noverride call c
-00015d10: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
-00015d20: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
-00015d30: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
-00015d40: 492e 5c6e 5c6e 5468 6973 206d 6574 686f  I.\n\nThis metho
-00015d50: 6420 7265 7475 726e 7320 6120 6050 6572  d returns a `Per
-00015d60: 7369 7374 656e 7453 7562 7363 7269 7074  sistentSubscript
-00015d70: 696f 6e60 206f 626a 6563 742c 2077 6869  ion` object, whi
-00015d80: 6368 2069 7320 616e 2069 7465 7261 746f  ch is an iterato
-00015d90: 725c 6e67 6976 696e 6720 6052 6563 6f72  r\ngiving `Recor
-00015da0: 6465 6445 7665 6e74 6020 6f62 6a65 6374  dedEvent` object
-00015db0: 732e 2049 7420 616c 736f 2068 6173 2060  s. It also has `
-00015dc0: 6163 6b28 2960 2c20 606e 6163 6b28 2960  ack()`, `nack()`
-00015dd0: 2061 6e64 2060 7374 6f70 2829 605c 6e6d   and `stop()`\nm
-00015de0: 6574 686f 6473 2e5c 6e5c 6e60 6060 7079  ethods.\n\n```py
-00015df0: 7468 6f6e 5c6e 7375 6273 6372 6970 7469  thon\nsubscripti
-00015e00: 6f6e 203d 2063 6c69 656e 742e 7265 6164  on = client.read
-00015e10: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
-00015e20: 5f61 6c6c 2867 726f 7570 5f6e 616d 653d  _all(group_name=
-00015e30: 6772 6f75 705f 6e61 6d65 3129 5c6e 6060  group_name1)\n``
-00015e40: 605c 6e5c 6e54 6865 2060 6163 6b28 2960  `\n\nThe `ack()`
-00015e50: 206d 6574 686f 6420 7368 6f75 6c64 2062   method should b
-00015e60: 6520 7573 6564 2062 7920 6120 636f 6e73  e used by a cons
-00015e70: 756d 6572 2074 6f20 696e 6469 6361 7465  umer to indicate
-00015e80: 2074 6f20 7468 6520 7365 7276 6572 2074   to the server t
-00015e90: 6861 7420 6974 5c6e 6861 7320 7265 6365  hat it\nhas rece
-00015ea0: 6976 6564 2061 6e64 2073 7563 6365 7373  ived and success
-00015eb0: 6675 6c6c 7920 7072 6f63 6573 7365 6420  fully processed 
-00015ec0: 6120 7265 636f 7264 6564 2065 7665 6e74  a recorded event
-00015ed0: 2e20 5468 6973 2077 696c 6c20 7072 6576  . This will prev
-00015ee0: 656e 7420 7468 6174 5c6e 7265 636f 7264  ent that\nrecord
-00015ef0: 6564 2065 7665 6e74 2062 6569 6e67 2072  ed event being r
-00015f00: 6563 6569 7665 6420 6279 2061 6e6f 7468  eceived by anoth
-00015f10: 6572 2063 6f6e 7375 6d65 7220 696e 2074  er consumer in t
-00015f20: 6865 2073 616d 6520 6772 6f75 702e 2054  he same group. T
-00015f30: 6865 2060 6163 6b28 2960 5c6e 6d65 7468  he `ack()`\nmeth
-00015f40: 6f64 2074 616b 6573 2061 6e20 6065 7665  od takes an `eve
-00015f50: 6e74 5f69 6460 2061 7267 756d 656e 742c  nt_id` argument,
-00015f60: 2077 6869 6368 2069 7320 7468 6520 4944   which is the ID
-00015f70: 206f 6620 7468 6520 7265 636f 7264 6564   of the recorded
-00015f80: 2065 7665 6e74 2074 6861 745c 6e68 6173   event that\nhas
-00015f90: 2062 6565 6e20 7265 6365 6976 6564 2e5c   been received.\
-00015fa0: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
-00015fb0: 656c 6f77 2069 7465 7261 7465 7320 6f76  elow iterates ov
-00015fc0: 6572 2074 6865 2073 7562 7363 7269 7074  er the subscript
-00015fd0: 696f 6e20 6f62 6a65 6374 2c20 616e 6420  ion object, and 
-00015fe0: 6361 6c6c 7320 6061 636b 2829 602e 2054  calls `ack()`. T
-00015ff0: 6865 5c6e 6073 746f 7028 2960 206d 6574  he\n`stop()` met
-00016000: 686f 6420 6973 2063 616c 6c65 6420 7768  hod is called wh
-00016010: 656e 2077 6520 6861 7665 2072 6563 6569  en we have recei
-00016020: 7665 6420 7468 6520 6c61 7374 2065 7665  ved the last eve
-00016030: 6e74 2c20 736f 2074 6861 7420 7765 2063  nt, so that we c
-00016040: 616e 5c6e 636f 6e74 696e 7565 2077 6974  an\ncontinue wit
-00016050: 6820 7468 6520 6578 616d 706c 6573 2062  h the examples b
-00016060: 656c 6f77 2e5c 6e5c 6e60 6060 7079 7468  elow.\n\n```pyth
-00016070: 6f6e 5c6e 7265 6365 6976 6564 5f65 7665  on\nreceived_eve
-00016080: 6e74 7320 3d20 5b5d 5c6e 5c6e 666f 7220  nts = []\n\nfor 
-00016090: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
-000160a0: 7074 696f 6e3a 5c6e 2020 2020 7265 6365  ption:\n    rece
-000160b0: 6976 6564 5f65 7665 6e74 732e 6170 7065  ived_events.appe
-000160c0: 6e64 2865 7665 6e74 295c 6e5c 6e20 2020  nd(event)\n\n   
-000160d0: 2023 2041 636b 6e6f 776c 6564 6765 2074   # Acknowledge t
-000160e0: 6865 2072 6563 6569 7665 6420 6576 656e  he received even
-000160f0: 742e 5c6e 2020 2020 7375 6273 6372 6970  t.\n    subscrip
-00016100: 7469 6f6e 2e61 636b 2865 7665 6e74 5f69  tion.ack(event_i
-00016110: 643d 6576 656e 742e 6964 295c 6e5c 6e20  d=event.id)\n\n 
-00016120: 2020 2023 2053 746f 7020 7768 656e 205c     # Stop when \
-00016130: 2765 7665 6e74 395c 2720 6861 7320 6265  'event9\' has be
-00016140: 656e 2072 6563 6569 7665 642e 5c6e 2020  en received.\n  
-00016150: 2020 6966 2065 7665 6e74 2e69 6420 3d3d    if event.id ==
-00016160: 2065 7665 6e74 392e 6964 3a5c 6e20 2020   event9.id:\n   
-00016170: 2020 2020 2073 7562 7363 7269 7074 696f       subscriptio
-00016180: 6e2e 7374 6f70 2829 5c6e 6060 605c 6e5c  n.stop()\n```\n\
-00016190: 6e54 6865 2065 7665 6e74 7320 6172 6520  nThe events are 
-000161a0: 6e6f 7420 6775 6172 616e 7465 6564 2074  not guaranteed t
-000161b0: 6f20 6265 2072 6563 6569 7665 6420 696e  o be received in
-000161c0: 2074 6865 206f 7264 6572 2074 6865 7920   the order they 
-000161d0: 7765 7265 2072 6563 6f72 6465 642e 2042  were recorded. B
-000161e0: 7574 5c6e 7765 2077 696c 6c20 6861 7665  ut\nwe will have
-000161f0: 2072 6563 6569 7665 6420 6065 7665 6e74   received `event
-00016200: 3960 2e5c 6e5c 6e60 6060 7079 7468 6f6e  9`.\n\n```python
-00016210: 5c6e 6173 7365 7274 2065 7665 6e74 392e  \nassert event9.
-00016220: 6964 2069 6e20 5b65 2e69 6420 666f 7220  id in [e.id for 
-00016230: 6520 696e 2072 6563 6569 7665 645f 6576  e in received_ev
-00016240: 656e 7473 5d5c 6e60 6060 5c6e 5c6e 5468  ents]\n```\n\nTh
-00016250: 6520 6050 6572 7369 7374 656e 7453 7562  e `PersistentSub
-00016260: 7363 7269 7074 696f 6e60 206f 626a 6563  scription` objec
-00016270: 7420 616c 736f 2068 6173 2061 6e20 606e  t also has an `n
-00016280: 6163 6b28 2960 206d 6574 686f 6420 7468  ack()` method th
-00016290: 6174 2073 686f 756c 6420 6265 2075 7365  at should be use
-000162a0: 645c 6e62 7920 6120 636f 6e73 756d 6572  d\nby a consumer
-000162b0: 2074 6f20 6e65 6761 7469 7665 6c79 2061   to negatively a
-000162c0: 636b 6e6f 776c 6564 6765 2074 6f20 7468  cknowledge to th
-000162d0: 6520 7365 7276 6572 2074 6861 7420 6974  e server that it
-000162e0: 2068 6173 2072 6563 6569 7665 6420 6275   has received bu
-000162f0: 7420 6e6f 745c 6e73 7563 6365 7373 6675  t not\nsuccessfu
-00016300: 6c6c 7920 7072 6f63 6573 7365 6420 6120  lly processed a 
-00016310: 7265 636f 7264 6564 2065 7665 6e74 2e20  recorded event. 
-00016320: 5468 6520 606e 6163 6b28 2960 206d 6574  The `nack()` met
-00016330: 686f 6420 6861 7320 616e 2060 6576 656e  hod has an `even
-00016340: 745f 6964 605c 6e61 7267 756d 656e 742c  t_id`\nargument,
-00016350: 2077 6869 6368 2069 7320 7468 6520 4944   which is the ID
-00016360: 206f 6620 7468 6520 7265 636f 7264 6564   of the recorded
-00016370: 2065 7665 6e74 2074 6861 7420 6861 7320   event that has 
-00016380: 6265 656e 2072 6563 6569 7665 642e 2054  been received. T
-00016390: 6865 2060 6e61 636b 2829 605c 6e6d 6574  he `nack()`\nmet
-000163a0: 686f 6420 616c 736f 2068 6173 2061 6e20  hod also has an 
-000163b0: 6061 6374 696f 6e60 2061 7267 756d 656e  `action` argumen
-000163c0: 742c 2077 6869 6368 2073 686f 756c 6420  t, which should 
-000163d0: 6265 2061 2050 7974 686f 6e20 6073 7472  be a Python `str
-000163e0: 603a 2065 6974 6865 725c 6e60 5c27 756e  `: either\n`\'un
-000163f0: 6b6e 6f77 6e5c 2760 2c20 605c 2770 6172  known\'`, `\'par
-00016400: 6b5c 2760 2c20 605c 2772 6574 7279 5c27  k\'`, `\'retry\'
-00016410: 602c 2060 5c27 736b 6970 5c27 6020 6f72  `, `\'skip\'` or
-00016420: 2060 5c27 7374 6f70 5c27 602e 5c6e 5c6e   `\'stop\'`.\n\n
-00016430: 5c6e 2323 2320 486f 7720 746f 2077 7269  \n### How to wri
-00016440: 7465 2061 2070 6572 7369 7374 656e 7420  te a persistent 
-00016450: 7375 6273 6372 6970 7469 6f6e 2063 6f6e  subscription con
-00016460: 7375 6d65 725c 6e5c 6e54 6865 2072 6561  sumer\n\nThe rea
-00016470: 6469 6e67 206f 6620 6120 7065 7273 6973  ding of a persis
-00016480: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-00016490: 6e20 6361 6e20 6265 2065 6e63 6170 7375  n can be encapsu
-000164a0: 6c61 7465 6420 696e 2061 2022 636f 6e73  lated in a "cons
-000164b0: 756d 6572 2220 7468 6174 2063 616c 6c73  umer" that calls
-000164c0: 5c6e 6120 2270 6f6c 6963 7922 2066 756e  \na "policy" fun
-000164d0: 6374 696f 6e20 7768 656e 2061 2072 6563  ction when a rec
-000164e0: 6f72 6465 6420 6576 656e 7420 6973 2072  orded event is r
-000164f0: 6563 6569 7665 6420 616e 6420 7468 656e  eceived and then
-00016500: 2061 7574 6f6d 6174 6963 616c 6c79 2063   automatically c
-00016510: 616c 6c73 5c6e 6061 636b 2829 6020 6966  alls\n`ack()` if
-00016520: 2074 6865 2070 6f6c 6963 7920 6675 6e63   the policy func
-00016530: 7469 6f6e 2072 6574 7572 6e73 206e 6f72  tion returns nor
-00016540: 6d61 6c6c 792c 2061 6e64 2060 6e61 636b  mally, and `nack
-00016550: 2829 6020 6966 2069 7420 7261 6973 6573  ()` if it raises
-00016560: 2061 6e20 6578 6365 7074 696f 6e2c 5c6e   an exception,\n
-00016570: 7065 7268 6170 7320 7265 7472 7969 6e67  perhaps retrying
-00016580: 2074 6865 2065 7665 6e74 2066 6f72 2061   the event for a
-00016590: 2063 6572 7461 696e 206e 756d 6265 7220   certain number 
-000165a0: 6f66 2074 696d 6573 2062 6566 6f72 6520  of times before 
-000165b0: 7061 726b 696e 6720 7468 6520 6576 656e  parking the even
-000165c0: 742e 5c6e 5c6e 5468 6520 7369 6d70 6c65  t.\n\nThe simple
-000165d0: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
-000165e0: 686f 7773 2068 6f77 2074 6869 7320 6d69  hows how this mi
-000165f0: 6768 7420 6265 2064 6f6e 652e 2057 6520  ght be done. We 
-00016600: 6361 6e20 7365 6520 7468 6174 205c 2765  can see that \'e
-00016610: 7665 6e74 395c 2720 6973 5c6e 6163 6b6e  vent9\' is\nackn
-00016620: 6f77 6c65 6467 6564 2062 6566 6f72 6520  owledged before 
-00016630: 5c27 6576 656e 7435 5c27 2069 7320 6669  \'event5\' is fi
-00016640: 6e61 6c6c 7920 7061 726b 6564 2e5c 6e5c  nally parked.\n\
-00016650: 6e5c 6e60 6060 7079 7468 6f6e 5c6e 6163  n\n```python\nac
-00016660: 6b65 645f 6576 656e 7473 203d 207b 7d5c  ked_events = {}\
-00016670: 6e6e 6163 6b65 645f 6576 656e 7473 203d  nnacked_events =
-00016680: 207b 7d5c 6e5c 6e5c 6e63 6c61 7373 2045   {}\n\n\nclass E
-00016690: 7861 6d70 6c65 436f 6e73 756d 6572 3a5c  xampleConsumer:\
-000166a0: 6e20 2020 2064 6566 205f 5f69 6e69 745f  n    def __init_
-000166b0: 5f28 7365 6c66 2c20 7375 6273 6372 6970  _(self, subscrip
-000166c0: 7469 6f6e 2c20 6d61 785f 7265 7472 6965  tion, max_retrie
-000166d0: 732c 2066 696e 616c 5f61 6374 696f 6e29  s, final_action)
-000166e0: 3a5c 6e20 2020 2020 2020 2073 656c 662e  :\n        self.
-000166f0: 7375 6273 6372 6970 7469 6f6e 203d 2073  subscription = s
-00016700: 7562 7363 7269 7074 696f 6e5c 6e20 2020  ubscription\n   
-00016710: 2020 2020 2073 656c 662e 6d61 785f 7265       self.max_re
-00016720: 7472 6965 7320 3d20 6d61 785f 7265 7472  tries = max_retr
-00016730: 6965 735c 6e20 2020 2020 2020 2073 656c  ies\n        sel
-00016740: 662e 6669 6e61 6c5f 6163 7469 6f6e 203d  f.final_action =
-00016750: 2066 696e 616c 5f61 6374 696f 6e5c 6e20   final_action\n 
-00016760: 2020 2020 2020 2073 656c 662e 6572 726f         self.erro
-00016770: 7220 3d20 4e6f 6e65 5c6e 5c6e 2020 2020  r = None\n\n    
-00016780: 6465 6620 7275 6e28 7365 6c66 293a 5c6e  def run(self):\n
-00016790: 2020 2020 2020 2020 7472 793a 5c6e 2020          try:\n  
-000167a0: 2020 2020 2020 2020 2020 666f 7220 6576            for ev
-000167b0: 656e 7420 696e 2073 656c 662e 7375 6273  ent in self.subs
-000167c0: 6372 6970 7469 6f6e 3a5c 6e20 2020 2020  cription:\n     
-000167d0: 2020 2020 2020 2020 2020 2074 7279 3a5c             try:\
-000167e0: 6e20 2020 2020 2020 2020 2020 2020 2020  n               
-000167f0: 2020 2020 2073 656c 662e 706f 6c69 6379       self.policy
-00016800: 2865 7665 6e74 295c 6e20 2020 2020 2020  (event)\n       
-00016810: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-00016820: 4578 6365 7074 696f 6e3a 5c6e 2020 2020  Exception:\n    
-00016830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016840: 6966 2065 7665 6e74 2e72 6574 7279 5f63  if event.retry_c
-00016850: 6f75 6e74 203c 2073 656c 662e 6d61 785f  ount < self.max_
-00016860: 7265 7472 6965 733a 5c6e 2020 2020 2020  retries:\n      
-00016870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016880: 2020 6163 7469 6f6e 203d 2022 7265 7472    action = "retr
-00016890: 7922 5c6e 2020 2020 2020 2020 2020 2020  y"\n            
-000168a0: 2020 2020 2020 2020 656c 7365 3a5c 6e20          else:\n 
-000168b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168c0: 2020 2020 2020 2061 6374 696f 6e20 3d20         action = 
-000168d0: 7365 6c66 2e66 696e 616c 5f61 6374 696f  self.final_actio
-000168e0: 6e5c 6e20 2020 2020 2020 2020 2020 2020  n\n             
-000168f0: 2020 2020 2020 2073 656c 662e 7375 6273         self.subs
-00016900: 6372 6970 7469 6f6e 2e6e 6163 6b28 6576  cription.nack(ev
-00016910: 656e 742e 6964 2c20 6163 7469 6f6e 3d61  ent.id, action=a
-00016920: 6374 696f 6e29 5c6e 2020 2020 2020 2020  ction)\n        
-00016930: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00016940: 2e61 6674 6572 5f6e 6163 6b28 6576 656e  .after_nack(even
-00016950: 742c 2061 6374 696f 6e29 5c6e 2020 2020  t, action)\n    
-00016960: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00016970: 3a5c 6e20 2020 2020 2020 2020 2020 2020  :\n             
-00016980: 2020 2020 2020 2073 656c 662e 7375 6273         self.subs
-00016990: 6372 6970 7469 6f6e 2e61 636b 2865 7665  cription.ack(eve
-000169a0: 6e74 2e69 6429 5c6e 2020 2020 2020 2020  nt.id)\n        
-000169b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000169c0: 2e61 6674 6572 5f61 636b 2865 7665 6e74  .after_ack(event
-000169d0: 295c 6e20 2020 2020 2020 2065 7863 6570  )\n        excep
-000169e0: 7420 4578 6365 7074 696f 6e3a 5c6e 2020  t Exception:\n  
-000169f0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00016a00: 746f 7028 295c 6e20 2020 2020 2020 2020  top()\n         
-00016a10: 2020 2072 6169 7365 5c6e 5c6e 2020 2020     raise\n\n    
-00016a20: 6465 6620 7374 6f70 2873 656c 6629 3a5c  def stop(self):\
-00016a30: 6e20 2020 2020 2020 2073 656c 662e 7375  n        self.su
-00016a40: 6273 6372 6970 7469 6f6e 2e73 746f 7028  bscription.stop(
-00016a50: 295c 6e5c 6e20 2020 2064 6566 2070 6f6c  )\n\n    def pol
-00016a60: 6963 7928 7365 6c66 2c20 6576 656e 7429  icy(self, event)
-00016a70: 3a5c 6e20 2020 2020 2020 2023 2052 6169  :\n        # Rai
-00016a80: 7365 2061 6e20 6578 6365 7074 696f 6e20  se an exception 
-00016a90: 7768 656e 2077 6520 7365 6520 2265 7665  when we see "eve
-00016aa0: 6e74 3522 2e5c 6e20 2020 2020 2020 2069  nt5".\n        i
-00016ab0: 6620 6576 656e 742e 6964 203d 3d20 6576  f event.id == ev
-00016ac0: 656e 7435 2e69 643a 5c6e 2020 2020 2020  ent5.id:\n      
-00016ad0: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
-00016ae0: 7074 696f 6e28 295c 6e5c 6e20 2020 2064  ption()\n\n    d
-00016af0: 6566 2061 6674 6572 5f61 636b 2873 656c  ef after_ack(sel
-00016b00: 662c 2065 7665 6e74 293a 5c6e 2020 2020  f, event):\n    
-00016b10: 2020 2020 2320 5472 6163 6b20 7265 7472      # Track retr
-00016b20: 7920 636f 756e 7420 6f66 2061 636b 6564  y count of acked
-00016b30: 2065 7665 6e74 732e 5c6e 2020 2020 2020   events.\n      
-00016b40: 2020 6163 6b65 645f 6576 656e 7473 5b65    acked_events[e
-00016b50: 7665 6e74 2e69 645d 203d 2065 7665 6e74  vent.id] = event
-00016b60: 2e72 6574 7279 5f63 6f75 6e74 5c6e 5c6e  .retry_count\n\n
-00016b70: 2020 2020 6465 6620 6166 7465 725f 6e61      def after_na
-00016b80: 636b 2873 656c 662c 2065 7665 6e74 2c20  ck(self, event, 
-00016b90: 6163 7469 6f6e 293a 5c6e 2020 2020 2020  action):\n      
-00016ba0: 2020 2320 5472 6163 6b20 7265 7472 7920    # Track retry 
-00016bb0: 636f 756e 7420 6f66 206e 6163 6b65 6420  count of nacked 
-00016bc0: 6576 656e 7473 2e5c 6e20 2020 2020 2020  events.\n       
-00016bd0: 206e 6163 6b65 645f 6576 656e 7473 5b65   nacked_events[e
-00016be0: 7665 6e74 2e69 645d 203d 2065 7665 6e74  vent.id] = event
-00016bf0: 2e72 6574 7279 5f63 6f75 6e74 5c6e 5c6e  .retry_count\n\n
-00016c00: 2020 2020 2020 2020 6966 2061 6374 696f          if actio
-00016c10: 6e20 3d3d 2073 656c 662e 6669 6e61 6c5f  n == self.final_
-00016c20: 6163 7469 6f6e 3a5c 6e20 2020 2020 2020  action:\n       
-00016c30: 2020 2020 2023 2053 746f 7020 7468 6520       # Stop the 
-00016c40: 636f 6e73 756d 6572 2c20 736f 2077 6520  consumer, so we 
-00016c50: 6361 6e20 636f 6e74 696e 7565 2077 6974  can continue wit
-00016c60: 6820 7468 6520 6578 616d 706c 6573 2e5c  h the examples.\
-00016c70: 6e20 2020 2020 2020 2020 2020 2073 656c  n            sel
-00016c80: 662e 7374 6f70 2829 5c6e 5c6e 5c6e 2320  f.stop()\n\n\n# 
-00016c90: 4372 6561 7465 2073 7562 7363 7269 7074  Create subscript
-00016ca0: 696f 6e2e 5c6e 6772 6f75 705f 6e61 6d65  ion.\ngroup_name
-00016cb0: 203d 2066 2267 726f 7570 2d7b 7575 6964   = f"group-{uuid
-00016cc0: 2e75 7569 6434 2829 7d22 5c6e 636c 6965  .uuid4()}"\nclie
-00016cd0: 6e74 2e63 7265 6174 655f 7375 6273 6372  nt.create_subscr
-00016ce0: 6970 7469 6f6e 5f74 6f5f 616c 6c28 6772  iption_to_all(gr
-00016cf0: 6f75 705f 6e61 6d65 2c20 636f 6d6d 6974  oup_name, commit
-00016d00: 5f70 6f73 6974 696f 6e3d 636f 6d6d 6974  _position=commit
-00016d10: 5f70 6f73 6974 696f 6e31 295c 6e5c 6e23  _position1)\n\n#
-00016d20: 2052 6561 6420 7375 6273 6372 6970 7469   Read subscripti
-00016d30: 6f6e 2e5c 6e73 7562 7363 7269 7074 696f  on.\nsubscriptio
-00016d40: 6e20 3d20 636c 6965 6e74 2e72 6561 645f  n = client.read_
-00016d50: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
-00016d60: 616c 6c28 6772 6f75 705f 6e61 6d65 295c  all(group_name)\
-00016d70: 6e5c 6e23 2043 6f6e 7374 7275 6374 2063  n\n# Construct c
-00016d80: 6f6e 7375 6d65 722e 5c6e 636f 6e73 756d  onsumer.\nconsum
-00016d90: 6572 203d 2045 7861 6d70 6c65 436f 6e73  er = ExampleCons
-00016da0: 756d 6572 285c 6e20 2020 2073 7562 7363  umer(\n    subsc
-00016db0: 7269 7074 696f 6e3d 7375 6273 6372 6970  ription=subscrip
-00016dc0: 7469 6f6e 2c5c 6e20 2020 206d 6178 5f72  tion,\n    max_r
-00016dd0: 6574 7269 6573 3d35 2c5c 6e20 2020 2066  etries=5,\n    f
-00016de0: 696e 616c 5f61 6374 696f 6e3d 2270 6172  inal_action="par
-00016df0: 6b22 2c5c 6e29 5c6e 5c6e 2320 5275 6e20  k",\n)\n\n# Run 
-00016e00: 636f 6e73 756d 6572 2e5c 6e63 6f6e 7375  consumer.\nconsu
-00016e10: 6d65 722e 7275 6e28 295c 6e5c 6e23 2043  mer.run()\n\n# C
-00016e20: 6865 636b 205c 2765 7665 6e74 355c 2720  heck \'event5\' 
-00016e30: 7761 7320 6e61 636b 6564 2061 6e64 206e  was nacked and n
-00016e40: 6576 6572 2061 636b 6564 2e5c 6e61 7373  ever acked.\nass
-00016e50: 6572 7420 6576 656e 7435 2e69 6420 696e  ert event5.id in
-00016e60: 206e 6163 6b65 645f 6576 656e 7473 5c6e   nacked_events\n
-00016e70: 6173 7365 7274 2065 7665 6e74 352e 6964  assert event5.id
-00016e80: 206e 6f74 2069 6e20 6163 6b65 645f 6576   not in acked_ev
-00016e90: 656e 7473 5c6e 6173 7365 7274 206e 6163  ents\nassert nac
-00016ea0: 6b65 645f 6576 656e 7473 5b65 7665 6e74  ked_events[event
-00016eb0: 352e 6964 5d20 3d3d 2035 5c6e 5c6e 2320  5.id] == 5\n\n# 
-00016ec0: 4368 6563 6b20 5c27 6576 656e 7439 5c27  Check \'event9\'
-00016ed0: 2077 6173 2061 636b 6564 2061 6e64 206e   was acked and n
-00016ee0: 6576 6572 206e 6163 6b65 642e 5c6e 6173  ever nacked.\nas
-00016ef0: 7365 7274 2065 7665 6e74 392e 6964 2069  sert event9.id i
-00016f00: 6e20 6163 6b65 645f 6576 656e 7473 5c6e  n acked_events\n
-00016f10: 6173 7365 7274 2065 7665 6e74 392e 6964  assert event9.id
-00016f20: 206e 6f74 2069 6e20 6e61 636b 6564 5f65   not in nacked_e
-00016f30: 7665 6e74 735c 6e60 6060 5c6e 5c6e 2323  vents\n```\n\n##
-00016f40: 2320 5570 6461 7465 2073 7562 7363 7269  # Update subscri
-00016f50: 7074 696f 6e20 746f 2061 6c6c 5c6e 5c6e  ption to all\n\n
-00016f60: 2a72 6571 7569 7265 7320 6c65 6164 6572  *requires leader
-00016f70: 2a5c 6e5c 6e54 6865 2060 7570 6461 7465  *\n\nThe `update
-00016f80: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
-00016f90: 5f61 6c6c 2829 6020 6d65 7468 6f64 2063  _all()` method c
-00016fa0: 616e 2062 6520 7573 6564 2074 6f20 7570  an be used to up
-00016fb0: 6461 7465 2061 5c6e 2270 6572 7369 7374  date a\n"persist
-00016fc0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-00016fd0: 222e 5c6e 5c6e 5468 6973 206d 6574 686f  ".\n\nThis metho
-00016fe0: 6420 6861 7320 6120 7265 7175 6972 6564  d has a required
-00016ff0: 2060 6772 6f75 705f 6e61 6d65 6020 6172   `group_name` ar
-00017000: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
-00017010: 2074 6865 5c6e 6e61 6d65 206f 6620 6120   the\nname of a 
-00017020: 2267 726f 7570 2220 6f66 2063 6f6e 7375  "group" of consu
-00017030: 6d65 7273 206f 6620 7468 6520 7375 6273  mers of the subs
-00017040: 6372 6970 7469 6f6e 2e5c 6e5c 6e54 6869  cription.\n\nThi
-00017050: 7320 6d65 7468 6f64 2061 6c73 6f20 6861  s method also ha
-00017060: 7320 7468 7265 6520 6f70 7469 6f6e 616c  s three optional
-00017070: 2061 7267 756d 656e 7473 2c20 6066 726f   arguments, `fro
-00017080: 6d5f 656e 6460 2c20 6063 6f6d 6d69 745f  m_end`, `commit_
-00017090: 706f 7369 7469 6f6e 602c 2060 7469 6d65  position`, `time
-000170a0: 6f75 7460 5c6e 616e 6420 6063 7265 6465  out`\nand `crede
-000170b0: 6e74 6961 6c73 602e 5c6e 5c6e 5468 6520  ntials`.\n\nThe 
-000170c0: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
-000170d0: 6e64 6020 6172 6775 6d65 6e74 2063 616e  nd` argument can
-000170e0: 2062 6520 7573 6564 2074 6f20 7370 6563   be used to spec
-000170f0: 6966 7920 7468 6174 2074 6865 2067 726f  ify that the gro
-00017100: 7570 206f 6620 636f 6e73 756d 6572 735c  up of consumers\
-00017110: 6e6f 6620 7468 6520 7375 6273 6372 6970  nof the subscrip
-00017120: 7469 6f6e 2073 686f 756c 6420 6f6e 6c79  tion should only
-00017130: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
-00017140: 7468 6174 2077 6572 6520 7265 636f 7264  that were record
-00017150: 6564 2061 6674 6572 2074 6865 2073 7562  ed after the sub
-00017160: 7363 7269 7074 696f 6e5c 6e77 6173 2075  scription\nwas u
-00017170: 7064 6174 6564 2e5c 6e5c 6e41 6c74 6572  pdated.\n\nAlter
-00017180: 6e61 7469 7665 6c79 2c20 7468 6520 6f70  natively, the op
-00017190: 7469 6f6e 616c 2060 636f 6d6d 6974 5f70  tional `commit_p
-000171a0: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-000171b0: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-000171c0: 2073 7065 6369 6679 2061 2063 6f6d 6d69   specify a commi
-000171d0: 745c 6e70 6f73 6974 696f 6e20 6672 6f6d  t\nposition from
-000171e0: 2077 6869 6368 2063 6f6d 6d69 7420 706f   which commit po
-000171f0: 7369 7469 6f6e 2074 6865 2067 726f 7570  sition the group
-00017200: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
-00017210: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-00017220: 6e20 7368 6f75 6c64 5c6e 7265 6365 6976  n should\nreceiv
-00017230: 6520 6576 656e 7473 2e20 506c 6561 7365  e events. Please
-00017240: 206e 6f74 652c 2074 6865 2072 6563 6f72   note, the recor
-00017250: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
-00017260: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
-00017270: 7420 706f 7369 7469 6f6e 206d 6967 6874  t position might
-00017280: 5c6e 6265 2069 6e63 6c75 6465 6420 696e  \nbe included in
-00017290: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
-000172a0: 656e 7473 2072 6563 6569 7665 6420 6279  ents received by
-000172b0: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
-000172c0: 6e73 756d 6572 732e 5c6e 5c6e 4966 206e  nsumers.\n\nIf n
-000172d0: 6569 7468 6572 2060 6672 6f6d 5f65 6e64  either `from_end
-000172e0: 6020 6f72 2060 636f 6d6d 6974 5f70 6f73  ` or `commit_pos
-000172f0: 6974 696f 6e60 2061 7265 2073 7065 6369  ition` are speci
-00017300: 6669 6564 2c20 7468 6520 6772 6f75 7020  fied, the group 
-00017310: 6f66 2063 6f6e 7375 6d65 7273 5c6e 6f66  of consumers\nof
-00017320: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-00017330: 6e20 7769 6c6c 2070 6f74 656e 7469 616c  n will potential
-00017340: 6c79 2072 6563 6569 7665 2061 6c6c 2072  ly receive all r
-00017350: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
-00017360: 6e20 7468 6520 6461 7461 6261 7365 2e5c  n the database.\
-00017370: 6e5c 6e50 6c65 6173 6520 6e6f 7465 2c20  n\nPlease note, 
-00017380: 7468 6520 6669 6c74 6572 206f 7074 696f  the filter optio
-00017390: 6e73 2061 6e64 2063 6f6e 7375 6d65 7220  ns and consumer 
-000173a0: 7374 7261 7465 6779 2063 616e 6e6f 7420  strategy cannot 
-000173b0: 6265 2061 646a 7573 7465 642e 5c6e 5c6e  be adjusted.\n\n
-000173c0: 5468 6520 6f70 7469 6f6e 616c 2060 7469  The optional `ti
-000173d0: 6d65 6f75 7460 2061 7267 756d 656e 7420  meout` argument 
-000173e0: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
-000173f0: 6174 6020 7768 6963 6820 7365 7473 2061  at` which sets a
-00017400: 5c6e 6465 6164 6c69 6e65 2066 6f72 2074  \ndeadline for t
-00017410: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
-00017420: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
-00017430: 696f 6e2e 5c6e 5c6e 5468 6520 6f70 7469  ion.\n\nThe opti
-00017440: 6f6e 616c 2060 6372 6564 656e 7469 616c  onal `credential
-00017450: 7360 2061 7267 756d 656e 7420 6361 6e20  s` argument can 
-00017460: 6265 2075 7365 6420 746f 5c6e 6f76 6572  be used to\nover
-00017470: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
-00017480: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
-00017490: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
-000174a0: 6e20 7374 7269 6e67 2055 5249 2e5c 6e5c  n string URI.\n\
-000174b0: 6e54 6865 206d 6574 686f 6420 6075 7064  nThe method `upd
-000174c0: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-000174d0: 5f74 6f5f 616c 6c28 2960 2064 6f65 7320  _to_all()` does 
-000174e0: 6e6f 7420 7265 7475 726e 2061 2076 616c  not return a val
-000174f0: 7565 2e5c 6e5c 6e49 6e20 7468 6520 6578  ue.\n\nIn the ex
-00017500: 616d 706c 6520 6265 6c6f 772c 2061 2070  ample below, a p
-00017510: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00017520: 6970 7469 6f6e 2069 7320 7570 6461 7465  iption is update
-00017530: 6420 746f 2072 756e 2066 726f 6d20 7468  d to run from th
-00017540: 6520 656e 6420 6f66 2074 6865 5c6e 6461  e end of the\nda
-00017550: 7461 6261 7365 2e5c 6e5c 6e60 6060 7079  tabase.\n\n```py
-00017560: 7468 6f6e 5c6e 2320 4372 6561 7465 2061  thon\n# Create a
-00017570: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-00017580: 6372 6970 7469 6f6e 2e5c 6e63 6c69 656e  cription.\nclien
-00017590: 742e 7570 6461 7465 5f73 7562 7363 7269  t.update_subscri
-000175a0: 7074 696f 6e5f 746f 5f61 6c6c 2867 726f  ption_to_all(gro
-000175b0: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
-000175c0: 6d65 312c 2066 726f 6d5f 656e 643d 5472  me1, from_end=Tr
-000175d0: 7565 295c 6e60 6060 5c6e 5c6e 2323 2320  ue)\n```\n\n### 
-000175e0: 4372 6561 7465 2073 7562 7363 7269 7074  Create subscript
-000175f0: 696f 6e20 746f 2073 7472 6561 6d5c 6e5c  ion to stream\n\
-00017600: 6e2a 7265 7175 6972 6573 206c 6561 6465  n*requires leade
-00017610: 722a 5c6e 5c6e 5468 6520 6063 7265 6174  r*\n\nThe `creat
-00017620: 655f 7375 6273 6372 6970 7469 6f6e 5f74  e_subscription_t
-00017630: 6f5f 7374 7265 616d 2829 6020 6d65 7468  o_stream()` meth
-00017640: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
-00017650: 6f20 6372 6561 7465 2061 2070 6572 7369  o create a persi
-00017660: 7374 656e 745c 6e73 7562 7363 7269 7074  stent\nsubscript
-00017670: 696f 6e20 746f 2061 2073 7472 6561 6d2e  ion to a stream.
-00017680: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00017690: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
-000176a0: 2061 7267 756d 656e 7473 2c20 6067 726f   arguments, `gro
-000176b0: 7570 5f6e 616d 6560 2061 6e64 2060 7374  up_name` and `st
-000176c0: 7265 616d 5f6e 616d 6560 2e20 5468 655c  ream_name`. The\
-000176d0: 6e60 6772 6f75 705f 6e61 6d65 6020 6172  n`group_name` ar
-000176e0: 6775 6d65 6e74 206e 616d 6573 2074 6865  gument names the
-000176f0: 2067 726f 7570 206f 6620 636f 6e73 756d   group of consum
-00017700: 6572 7320 7468 6174 2077 696c 6c20 7265  ers that will re
-00017710: 6365 6976 6520 6576 656e 7473 5c6e 6672  ceive events\nfr
-00017720: 6f6d 2074 6869 7320 7375 6273 6372 6970  om this subscrip
-00017730: 7469 6f6e 2e20 5468 6520 6073 7472 6561  tion. The `strea
-00017740: 6d5f 6e61 6d65 6020 6172 6775 6d65 6e74  m_name` argument
-00017750: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
-00017760: 2073 7472 6561 6d5c 6e74 6865 2073 7562   stream\nthe sub
-00017770: 7363 7269 7074 696f 6e20 7769 6c6c 2066  scription will f
-00017780: 6f6c 6c6f 772e 2054 6865 2076 616c 7565  ollow. The value
-00017790: 7320 6f66 2062 6f74 6820 7468 6573 6520  s of both these 
-000177a0: 6172 6775 6d65 6e74 7320 6172 6520 6578  arguments are ex
-000177b0: 7065 6374 6564 5c6e 746f 2062 6520 5079  pected\nto be Py
-000177c0: 7468 6f6e 2060 7374 7260 206f 626a 6563  thon `str` objec
-000177d0: 7473 2e5c 6e5c 6e54 6869 7320 6d65 7468  ts.\n\nThis meth
-000177e0: 6f64 2061 6c73 6f20 6861 7320 6669 7665  od also has five
-000177f0: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
-00017800: 6e74 732c 2060 7374 7265 616d 5f70 6f73  nts, `stream_pos
-00017810: 6974 696f 6e60 2c20 6066 726f 6d5f 656e  ition`, `from_en
-00017820: 6460 2c5c 6e60 636f 6e73 756d 6572 5f73  d`,\n`consumer_s
-00017830: 7472 6174 6567 7960 2c20 6074 696d 656f  trategy`, `timeo
-00017840: 7574 6020 616e 6420 6063 7265 6465 6e74  ut` and `credent
-00017850: 6961 6c73 602e 5c6e 5c6e 5468 6520 6f70  ials`.\n\nThe op
-00017860: 7469 6f6e 616c 2060 7374 7265 616d 5f70  tional `stream_p
-00017870: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
-00017880: 7420 7370 6563 6966 6965 7320 6120 7374  t specifies a st
-00017890: 7265 616d 2070 6f73 6974 696f 6e20 6672  ream position fr
-000178a0: 6f6d 5c6e 7768 6963 6820 746f 2073 7562  om\nwhich to sub
-000178b0: 7363 7269 6265 2e20 5468 6520 7265 636f  scribe. The reco
-000178c0: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
-000178d0: 6973 2073 7472 6561 6d5c 6e70 6f73 6974  is stream\nposit
-000178e0: 696f 6e20 7769 6c6c 2062 6520 7265 6365  ion will be rece
-000178f0: 6976 6564 2077 6865 6e20 7265 6164 696e  ived when readin
-00017900: 6720 7468 6520 7375 6273 6372 6970 7469  g the subscripti
-00017910: 6f6e 2e5c 6e5c 6e54 6865 206f 7074 696f  on.\n\nThe optio
-00017920: 6e61 6c20 6066 726f 6d5f 656e 6460 2061  nal `from_end` a
-00017930: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
-00017940: 686f 6e20 6062 6f6f 6c60 2e5c 6e42 7920  hon `bool`.\nBy 
-00017950: 6465 6661 756c 742c 2074 6865 2076 616c  default, the val
-00017960: 7565 206f 6620 7468 6973 2061 7267 756d  ue of this argum
-00017970: 656e 7420 6973 2060 4661 6c73 6560 2e20  ent is `False`. 
-00017980: 4966 2074 6869 7320 6172 6775 6d65 6e74  If this argument
-00017990: 2069 7320 7365 745c 6e74 6f20 6054 7275   is set\nto `Tru
-000179a0: 6560 2c20 7265 6164 696e 6720 6672 6f6d  e`, reading from
-000179b0: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
-000179c0: 6e20 7769 6c6c 2072 6563 6569 7665 206f  n will receive o
-000179d0: 6e6c 7920 6576 656e 7473 5c6e 7265 636f  nly events\nreco
-000179e0: 7264 6564 2061 6674 6572 2074 6865 2073  rded after the s
-000179f0: 7562 7363 7269 7074 696f 6e20 7761 7320  ubscription was 
-00017a00: 6372 6561 7465 642e 2054 6861 7420 6973  created. That is
-00017a10: 2c20 6974 2069 7320 6e6f 7420 696e 636c  , it is not incl
-00017a20: 7573 6976 655c 6e6f 6620 7468 6520 6375  usive\nof the cu
-00017a30: 7272 656e 7420 7374 7265 616d 2070 6f73  rrent stream pos
-00017a40: 6974 696f 6e2e 5c6e 5c6e 5468 6520 6f70  ition.\n\nThe op
-00017a50: 7469 6f6e 616c 2060 636f 6e73 756d 6572  tional `consumer
-00017a60: 5f73 7472 6174 6567 7960 2061 7267 756d  _strategy` argum
-00017a70: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
-00017a80: 6073 7472 6020 7468 6174 2064 6566 696e  `str` that defin
-00017a90: 6573 5c6e 7468 6520 636f 6e73 756d 6572  es\nthe consumer
-00017aa0: 2073 7472 6174 6567 7920 666f 7220 7468   strategy for th
-00017ab0: 6973 2070 6572 7369 7374 656e 7420 7375  is persistent su
-00017ac0: 6273 6372 6970 7469 6f6e 2e20 5468 6520  bscription. The 
-00017ad0: 7661 6c75 6520 6f66 2074 6869 7320 6172  value of this ar
-00017ae0: 6775 6d65 6e74 5c6e 6361 6e20 6265 2060  gument\ncan be `
-00017af0: 5c27 4469 7370 6174 6368 546f 5369 6e67  \'DispatchToSing
-00017b00: 6c65 5c27 602c 2060 5c27 526f 756e 6452  le\'`, `\'RoundR
-00017b10: 6f62 696e 5c27 602c 2060 5c27 5069 6e6e  obin\'`, `\'Pinn
-00017b20: 6564 5c27 602c 206f 7220 605c 2750 696e  ed\'`, or `\'Pin
-00017b30: 6e65 6442 7943 6f72 7265 6c61 7469 6f6e  nedByCorrelation
-00017b40: 5c27 602e 2054 6865 5c6e 6465 6661 756c  \'`. The\ndefaul
-00017b50: 7420 7661 6c75 6520 6973 2060 5c27 4469  t value is `\'Di
-00017b60: 7370 6174 6368 546f 5369 6e67 6c65 5c27  spatchToSingle\'
-00017b70: 602e 5c6e 5c6e 5468 6520 6f70 7469 6f6e  `.\n\nThe option
-00017b80: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
-00017b90: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
-00017ba0: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
-00017bb0: 7365 7473 2061 2064 6561 646c 696e 655c  sets a deadline\
-00017bc0: 6e66 6f72 2074 6865 2063 6f6d 706c 6574  nfor the complet
-00017bd0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
-00017be0: 6f70 6572 6174 696f 6e2e 5c6e 5c6e 5468  operation.\n\nTh
-00017bf0: 6520 6f70 7469 6f6e 616c 2060 6372 6564  e optional `cred
-00017c00: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
-00017c10: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
-00017c20: 5c6e 6f76 6572 7269 6465 2063 616c 6c20  \noverride call 
-00017c30: 6372 6564 656e 7469 616c 7320 6465 7269  credentials deri
-00017c40: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
-00017c50: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
-00017c60: 5249 2e5c 6e5c 6e54 6869 7320 6d65 7468  RI.\n\nThis meth
-00017c70: 6f64 2064 6f65 7320 6e6f 7420 7265 7475  od does not retu
-00017c80: 726e 2061 2076 616c 7565 2e20 4576 656e  rn a value. Even
-00017c90: 7473 2063 616e 2062 6520 7265 6365 6976  ts can be receiv
-00017ca0: 6564 2062 7920 6361 6c6c 696e 675c 6e60  ed by calling\n`
-00017cb0: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
-00017cc0: 6e5f 746f 5f73 7472 6561 6d28 2960 2e5c  n_to_stream()`.\
-00017cd0: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
-00017ce0: 656c 6f77 2063 7265 6174 6573 2061 2070  elow creates a p
-00017cf0: 6572 7369 7374 656e 7420 7374 7265 616d  ersistent stream
-00017d00: 2073 7562 7363 7269 7074 696f 6e20 6672   subscription fr
-00017d10: 6f6d 2074 6865 2073 7461 7274 206f 6620  om the start of 
-00017d20: 7468 6520 7374 7265 616d 2e5c 6e5c 6e60  the stream.\n\n`
-00017d30: 6060 7079 7468 6f6e 5c6e 2320 4372 6561  ``python\n# Crea
-00017d40: 7465 2061 2070 6572 7369 7374 656e 7420  te a persistent 
-00017d50: 7374 7265 616d 2073 7562 7363 7269 7074  stream subscript
-00017d60: 696f 6e20 6672 6f6d 2073 7461 7274 206f  ion from start o
-00017d70: 6620 7468 6520 7374 7265 616d 2e5c 6e67  f the stream.\ng
-00017d80: 726f 7570 5f6e 616d 6532 203d 2066 2267  roup_name2 = f"g
-00017d90: 726f 7570 2d7b 7575 6964 2e75 7569 6434  roup-{uuid.uuid4
-00017da0: 2829 7d22 5c6e 636c 6965 6e74 2e63 7265  ()}"\nclient.cre
-00017db0: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-00017dc0: 5f74 6f5f 7374 7265 616d 285c 6e20 2020  _to_stream(\n   
-00017dd0: 2067 726f 7570 5f6e 616d 653d 6772 6f75   group_name=grou
-00017de0: 705f 6e61 6d65 322c 5c6e 2020 2020 7374  p_name2,\n    st
-00017df0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
-00017e00: 5f6e 616d 6532 2c5c 6e29 5c6e 6060 605c  _name2,\n)\n```\
-00017e10: 6e5c 6e23 2323 2052 6561 6420 7375 6273  n\n### Read subs
-00017e20: 6372 6970 7469 6f6e 2074 6f20 7374 7265  cription to stre
-00017e30: 616d 5c6e 5c6e 2a72 6571 7569 7265 7320  am\n\n*requires 
-00017e40: 6c65 6164 6572 2a5c 6e5c 6e54 6865 2060  leader*\n\nThe `
-00017e50: 7265 6164 5f73 7562 7363 7269 7074 696f  read_subscriptio
-00017e60: 6e5f 746f 5f73 7472 6561 6d28 2960 206d  n_to_stream()` m
-00017e70: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00017e80: 6420 746f 2072 6561 6420 6120 7065 7273  d to read a pers
-00017e90: 6973 7465 6e74 5c6e 7375 6273 6372 6970  istent\nsubscrip
-00017ea0: 7469 6f6e 2074 6f20 6120 7374 7265 616d  tion to a stream
-00017eb0: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
-00017ec0: 2068 6173 2074 776f 2072 6571 7569 7265   has two require
-00017ed0: 6420 6172 6775 6d65 6e74 732c 2060 6772  d arguments, `gr
-00017ee0: 6f75 705f 6e61 6d65 6020 616e 6420 6073  oup_name` and `s
-00017ef0: 7472 6561 6d5f 6e61 6d65 602c 2077 6869  tream_name`, whi
-00017f00: 6368 5c6e 7368 6f75 6c64 206d 6174 6368  ch\nshould match
-00017f10: 2074 6865 2076 616c 7565 7320 6f66 2061   the values of a
-00017f20: 7267 756d 656e 7473 2075 7365 6420 7768  rguments used wh
-00017f30: 656e 2063 616c 6c69 6e67 2060 6372 6561  en calling `crea
-00017f40: 7465 5f73 7562 7363 7269 7074 696f 6e5f  te_subscription_
-00017f50: 746f 5f73 7472 6561 6d28 2960 2e5c 6e5c  to_stream()`.\n\
-00017f60: 6e54 6869 7320 6d65 7468 6f64 2068 6173  nThis method has
-00017f70: 2061 6e20 6f70 7469 6f6e 616c 2060 7469   an optional `ti
-00017f80: 6d65 6f75 7460 2061 7267 756d 656e 742c  meout` argument,
-00017f90: 2074 6861 745c 6e69 7320 6578 7065 6374   that\nis expect
-00017fa0: 6564 2074 6f20 6265 2061 2050 7974 686f  ed to be a Pytho
-00017fb0: 6e20 6066 6c6f 6174 602c 2077 6869 6368  n `float`, which
-00017fc0: 2073 6574 7320 6120 6465 6164 6c69 6e65   sets a deadline
-00017fd0: 5c6e 666f 7220 7468 6520 636f 6d70 6c65  \nfor the comple
-00017fe0: 7469 6f6e 206f 6620 7468 6520 6752 5043  tion of the gRPC
-00017ff0: 206f 7065 7261 7469 6f6e 2e5c 6e5c 6e54   operation.\n\nT
-00018000: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
-00018010: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
-00018020: 6063 7265 6465 6e74 6961 6c73 6020 6172  `credentials` ar
-00018030: 6775 6d65 6e74 2c20 7768 6963 6820 6361  gument, which ca
-00018040: 6e20 6265 2075 7365 6420 746f 5c6e 6f76  n be used to\nov
-00018050: 6572 7269 6465 2063 616c 6c20 6372 6564  erride call cred
-00018060: 656e 7469 616c 7320 6465 7269 7665 6420  entials derived 
-00018070: 6672 6f6d 2074 6865 2063 6f6e 6e65 6374  from the connect
-00018080: 696f 6e20 7374 7269 6e67 2055 5249 2e5c  ion string URI.\
-00018090: 6e5c 6e54 6869 7320 6d65 7468 6f64 2072  n\nThis method r
-000180a0: 6574 7572 6e73 2061 2060 5065 7273 6973  eturns a `Persis
-000180b0: 7465 6e74 5375 6273 6372 6970 7469 6f6e  tentSubscription
-000180c0: 6020 6f62 6a65 6374 2c20 7768 6963 6820  ` object, which 
-000180d0: 6973 2061 6e20 6974 6572 6174 6f72 5c6e  is an iterator\n
-000180e0: 6769 7669 6e67 2060 5265 636f 7264 6564  giving `Recorded
-000180f0: 4576 656e 7460 206f 626a 6563 7473 2c20  Event` objects, 
-00018100: 7468 6174 2061 6c73 6f20 6861 7320 6061  that also has `a
-00018110: 636b 2829 602c 2060 6e61 636b 2829 6020  ck()`, `nack()` 
-00018120: 616e 6420 6073 746f 7028 2960 5c6e 6d65  and `stop()`\nme
-00018130: 7468 6f64 732e 5c6e 5c6e 6060 6070 7974  thods.\n\n```pyt
-00018140: 686f 6e5c 6e73 7562 7363 7269 7074 696f  hon\nsubscriptio
-00018150: 6e20 3d20 636c 6965 6e74 2e72 6561 645f  n = client.read_
-00018160: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
-00018170: 7374 7265 616d 285c 6e20 2020 2067 726f  stream(\n    gro
-00018180: 7570 5f6e 616d 653d 6772 6f75 705f 6e61  up_name=group_na
-00018190: 6d65 322c 5c6e 2020 2020 7374 7265 616d  me2,\n    stream
-000181a0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-000181b0: 6532 2c5c 6e29 5c6e 6060 605c 6e5c 6e54  e2,\n)\n```\n\nT
-000181c0: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
-000181d0: 2069 7465 7261 7465 7320 6f76 6572 2074   iterates over t
-000181e0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
-000181f0: 6f62 6a65 6374 2c20 616e 6420 6361 6c6c  object, and call
-00018200: 7320 6061 636b 2829 602e 5c6e 5468 6520  s `ack()`.\nThe 
-00018210: 666f 7220 6c6f 6f70 2062 7265 616b 7320  for loop breaks 
-00018220: 7768 656e 2077 6520 6861 7665 2072 6563  when we have rec
-00018230: 6569 7665 6420 7468 6520 6c61 7374 2065  eived the last e
-00018240: 7665 6e74 2069 6e20 7468 6520 7374 7265  vent in the stre
-00018250: 616d 2c20 736f 5c6e 7468 6174 2077 6520  am, so\nthat we 
-00018260: 6361 6e20 6669 6e69 7368 2074 6865 2065  can finish the e
-00018270: 7861 6d70 6c65 7320 696e 2074 6869 7320  xamples in this 
-00018280: 646f 6375 6d65 6e74 6174 696f 6e2e 5c6e  documentation.\n
-00018290: 5c6e 6060 6070 7974 686f 6e5c 6e65 7665  \n```python\neve
-000182a0: 6e74 7320 3d20 5b5d 5c6e 666f 7220 6576  nts = []\nfor ev
-000182b0: 656e 7420 696e 2073 7562 7363 7269 7074  ent in subscript
-000182c0: 696f 6e3a 5c6e 2020 2020 6576 656e 7473  ion:\n    events
-000182d0: 2e61 7070 656e 6428 6576 656e 7429 5c6e  .append(event)\n
-000182e0: 5c6e 2020 2020 2320 4163 6b6e 6f77 6c65  \n    # Acknowle
-000182f0: 6467 6520 7468 6520 7265 6365 6976 6564  dge the received
-00018300: 2065 7665 6e74 2e5c 6e20 2020 2073 7562   event.\n    sub
-00018310: 7363 7269 7074 696f 6e2e 6163 6b28 6576  scription.ack(ev
-00018320: 656e 745f 6964 3d65 7665 6e74 2e69 6429  ent_id=event.id)
-00018330: 5c6e 5c6e 2020 2020 2320 5374 6f70 2077  \n\n    # Stop w
-00018340: 6865 6e20 5c27 6576 656e 7436 5c27 2068  hen \'event6\' h
-00018350: 6173 2062 6565 6e20 7265 6365 6976 6564  as been received
-00018360: 2e5c 6e20 2020 2069 6620 6576 656e 742e  .\n    if event.
-00018370: 6964 203d 3d20 6576 656e 7436 2e69 643a  id == event6.id:
-00018380: 5c6e 2020 2020 2020 2020 7375 6273 6372  \n        subscr
-00018390: 6970 7469 6f6e 2e73 746f 7028 295c 6e60  iption.stop()\n`
-000183a0: 6060 5c6e 5c6e 5765 2063 616e 2063 6865  ``\n\nWe can che
-000183b0: 636b 2077 6520 7265 6365 6976 6564 2061  ck we received a
-000183c0: 6c6c 2074 6865 2065 7665 6e74 7320 7468  ll the events th
-000183d0: 6174 2077 6572 6520 6170 7065 6e64 6564  at were appended
-000183e0: 2074 6f20 6073 7472 6561 6d5f 6e61 6d65   to `stream_name
-000183f0: 3260 5c6e 696e 2074 6865 2065 7861 6d70  2`\nin the examp
-00018400: 6c65 7320 6162 6f76 652e 5c6e 5c6e 6060  les above.\n\n``
-00018410: 6070 7974 686f 6e5c 6e61 7373 6572 7420  `python\nassert 
-00018420: 6c65 6e28 6576 656e 7473 2920 3d3d 2033  len(events) == 3
-00018430: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-00018440: 305d 2e73 7472 6561 6d5f 6e61 6d65 203d  0].stream_name =
-00018450: 3d20 7374 7265 616d 5f6e 616d 6532 5c6e  = stream_name2\n
-00018460: 6173 7365 7274 2065 7665 6e74 735b 305d  assert events[0]
-00018470: 2e69 6420 3d3d 2065 7665 6e74 342e 6964  .id == event4.id
-00018480: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-00018490: 315d 2e73 7472 6561 6d5f 6e61 6d65 203d  1].stream_name =
-000184a0: 3d20 7374 7265 616d 5f6e 616d 6532 5c6e  = stream_name2\n
-000184b0: 6173 7365 7274 2065 7665 6e74 735b 315d  assert events[1]
-000184c0: 2e69 6420 3d3d 2065 7665 6e74 352e 6964  .id == event5.id
-000184d0: 5c6e 6173 7365 7274 2065 7665 6e74 735b  \nassert events[
-000184e0: 325d 2e73 7472 6561 6d5f 6e61 6d65 203d  2].stream_name =
-000184f0: 3d20 7374 7265 616d 5f6e 616d 6532 5c6e  = stream_name2\n
-00018500: 6173 7365 7274 2065 7665 6e74 735b 325d  assert events[2]
-00018510: 2e69 6420 3d3d 2065 7665 6e74 362e 6964  .id == event6.id
-00018520: 5c6e 6060 605c 6e5c 6e23 2323 2055 7064  \n```\n\n### Upd
-00018530: 6174 6520 7375 6273 6372 6970 7469 6f6e  ate subscription
-00018540: 2074 6f20 7374 7265 616d 5c6e 5c6e 2a72   to stream\n\n*r
-00018550: 6571 7569 7265 7320 6c65 6164 6572 2a5c  equires leader*\
-00018560: 6e5c 6e54 6865 2060 7570 6461 7465 5f73  n\nThe `update_s
-00018570: 7562 7363 7269 7074 696f 6e5f 746f 5f73  ubscription_to_s
-00018580: 7472 6561 6d28 2960 206d 6574 686f 6420  tream()` method 
-00018590: 6361 6e20 6265 2075 7365 6420 746f 2075  can be used to u
-000185a0: 7064 6174 6520 615c 6e70 6572 7369 7374  pdate a\npersist
-000185b0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-000185c0: 2074 6f20 6120 7374 7265 616d 2e5c 6e5c   to a stream.\n\
-000185d0: 6e54 6869 7320 6d65 7468 6f64 2068 6173  nThis method has
-000185e0: 2061 2072 6571 7569 7265 6420 6067 726f   a required `gro
-000185f0: 7570 5f6e 616d 6560 2061 7267 756d 656e  up_name` argumen
-00018600: 742c 2077 6869 6368 2069 7320 7468 655c  t, which is the\
-00018610: 6e6e 616d 6520 6f66 2061 2022 6772 6f75  nname of a "grou
-00018620: 7022 206f 6620 636f 6e73 756d 6572 7320  p" of consumers 
-00018630: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
-00018640: 696f 6e2c 2061 6e64 2061 2072 6571 7569  ion, and a requi
-00018650: 7265 645c 6e60 7374 7265 616d 5f6e 616d  red\n`stream_nam
-00018660: 6560 2061 7267 756d 656e 742c 2077 6869  e` argument, whi
-00018670: 6368 2069 7320 7468 6520 6e61 6d65 206f  ch is the name o
-00018680: 6620 6120 7374 7265 616d 2e5c 6e5c 6e54  f a stream.\n\nT
-00018690: 6869 7320 6d65 7468 6f64 2061 6c73 6f20  his method also 
-000186a0: 6861 7320 666f 7572 206f 7074 696f 6e61  has four optiona
-000186b0: 6c20 6172 6775 6d65 6e74 732c 2060 6672  l arguments, `fr
-000186c0: 6f6d 5f65 6e64 602c 2060 7374 7265 616d  om_end`, `stream
-000186d0: 5f70 6f73 6974 696f 6e60 2c5c 6e60 7469  _position`,\n`ti
-000186e0: 6d65 6f75 7460 2061 6e64 2060 6372 6564  meout` and `cred
-000186f0: 656e 7469 616c 7360 2e5c 6e5c 6e54 6865  entials`.\n\nThe
-00018700: 206f 7074 696f 6e61 6c20 6066 726f 6d5f   optional `from_
-00018710: 656e 6460 2061 7267 756d 656e 7420 6361  end` argument ca
-00018720: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
-00018730: 6369 6679 2074 6861 7420 7468 6520 6772  cify that the gr
-00018740: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
-00018750: 5c6e 6f66 2074 6865 2073 7562 7363 7269  \nof the subscri
-00018760: 7074 696f 6e20 7368 6f75 6c64 206f 6e6c  ption should onl
-00018770: 7920 7265 6365 6976 6520 6576 656e 7473  y receive events
-00018780: 2074 6861 7420 7765 7265 2072 6563 6f72   that were recor
-00018790: 6465 6420 6166 7465 7220 7468 6520 7375  ded after the su
-000187a0: 6273 6372 6970 7469 6f6e 5c6e 7761 7320  bscription\nwas 
-000187b0: 7570 6461 7465 642e 5c6e 5c6e 416c 7465  updated.\n\nAlte
-000187c0: 726e 6174 6976 656c 792c 2074 6865 206f  rnatively, the o
-000187d0: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
-000187e0: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
-000187f0: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
-00018800: 6f20 7370 6563 6966 7920 6120 7374 7265  o specify a stre
-00018810: 616d 5c6e 706f 7369 7469 6f6e 2066 726f  am\nposition fro
-00018820: 6d20 7768 6963 6820 636f 6d6d 6974 2070  m which commit p
-00018830: 6f73 6974 696f 6e20 7468 6520 6772 6f75  osition the grou
-00018840: 7020 6f66 2063 6f6e 7375 6d65 7273 206f  p of consumers o
-00018850: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
-00018860: 6f6e 2073 686f 756c 645c 6e72 6563 6569  on should\nrecei
-00018870: 7665 2065 7665 6e74 732e 2050 6c65 6173  ve events. Pleas
-00018880: 6520 6e6f 7465 2c20 7468 6520 7265 636f  e note, the reco
-00018890: 7264 6564 2065 7665 6e74 2061 7420 7468  rded event at th
-000188a0: 6520 7370 6563 6966 6965 6420 7374 7265  e specified stre
-000188b0: 616d 2070 6f73 6974 696f 6e20 6d69 6768  am position migh
-000188c0: 745c 6e62 6520 696e 636c 7564 6564 2069  t\nbe included i
-000188d0: 6e20 7468 6520 7265 636f 7264 6564 2065  n the recorded e
-000188e0: 7665 6e74 7320 7265 6365 6976 6564 2062  vents received b
-000188f0: 7920 7468 6520 6772 6f75 7020 6f66 2063  y the group of c
-00018900: 6f6e 7375 6d65 7273 2e5c 6e5c 6e49 6620  onsumers.\n\nIf 
-00018910: 6e65 6974 6865 7220 6066 726f 6d5f 656e  neither `from_en
-00018920: 6460 206f 7220 6063 6f6d 6d69 745f 706f  d` or `commit_po
-00018930: 7369 7469 6f6e 6020 6172 6520 7370 6563  sition` are spec
-00018940: 6966 6965 642c 2074 6865 2067 726f 7570  ified, the group
-00018950: 206f 6620 636f 6e73 756d 6572 735c 6e6f   of consumers\no
-00018960: 6620 7468 6520 7375 6273 6372 6970 7469  f the subscripti
-00018970: 6f6e 2077 696c 6c20 706f 7465 6e74 6961  on will potentia
-00018980: 6c6c 7920 7265 6365 6976 6520 616c 6c20  lly receive all 
-00018990: 7265 636f 7264 6564 2065 7665 6e74 7320  recorded events 
-000189a0: 696e 2074 6865 2073 7472 6561 6d2e 5c6e  in the stream.\n
-000189b0: 5c6e 506c 6561 7365 206e 6f74 652c 2074  \nPlease note, t
-000189c0: 6865 2063 6f6e 7375 6d65 7220 7374 7261  he consumer stra
-000189d0: 7465 6779 2063 616e 6e6f 7420 6265 2061  tegy cannot be a
-000189e0: 646a 7573 7465 642e 5c6e 5c6e 5468 6520  djusted.\n\nThe 
-000189f0: 6f70 7469 6f6e 616c 2060 7469 6d65 6f75  optional `timeou
-00018a00: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
-00018a10: 2050 7974 686f 6e20 6066 6c6f 6174 6020   Python `float` 
-00018a20: 7768 6963 6820 7365 7473 2061 5c6e 6465  which sets a\nde
-00018a30: 6164 6c69 6e65 2066 6f72 2074 6865 2063  adline for the c
-00018a40: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
-00018a50: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
-00018a60: 5c6e 5c6e 5468 6520 6f70 7469 6f6e 616c  \n\nThe optional
-00018a70: 2060 6372 6564 656e 7469 616c 7360 2061   `credentials` a
-00018a80: 7267 756d 656e 7420 6361 6e20 6265 2075  rgument can be u
-00018a90: 7365 6420 746f 5c6e 6f76 6572 7269 6465  sed to\noverride
-00018aa0: 2063 616c 6c20 6372 6564 656e 7469 616c   call credential
-00018ab0: 7320 6465 7269 7665 6420 6672 6f6d 2074  s derived from t
-00018ac0: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-00018ad0: 7269 6e67 2055 5249 2e5c 6e5c 6e54 6865  ring URI.\n\nThe
-00018ae0: 2060 7570 6461 7465 5f73 7562 7363 7269   `update_subscri
-00018af0: 7074 696f 6e5f 746f 5f73 7472 6561 6d28  ption_to_stream(
-00018b00: 2960 206d 6574 686f 6420 646f 6573 206e  )` method does n
-00018b10: 6f74 2072 6574 7572 6e20 6120 7661 6c75  ot return a valu
-00018b20: 652e 5c6e 5c6e 496e 2074 6865 2065 7861  e.\n\nIn the exa
-00018b30: 6d70 6c65 2062 656c 6f77 2c20 6120 7065  mple below, a pe
-00018b40: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
-00018b50: 7074 696f 6e20 746f 2061 2073 7472 6561  ption to a strea
-00018b60: 6d20 6973 2075 7064 6174 6564 2074 6f20  m is updated to 
-00018b70: 7275 6e20 6672 6f6d 2074 6865 5c6e 656e  run from the\nen
-00018b80: 6420 6f66 2074 6865 2073 7472 6561 6d2e  d of the stream.
-00018b90: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e23  \n\n```python\n#
-00018ba0: 2043 7265 6174 6520 6120 7065 7273 6973   Create a persis
-00018bb0: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
-00018bc0: 6e2e 5c6e 636c 6965 6e74 2e75 7064 6174  n.\nclient.updat
-00018bd0: 655f 7375 6273 6372 6970 7469 6f6e 5f74  e_subscription_t
-00018be0: 6f5f 7374 7265 616d 285c 6e20 2020 2067  o_stream(\n    g
-00018bf0: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
-00018c00: 6e61 6d65 322c 5c6e 2020 2020 7374 7265  name2,\n    stre
-00018c10: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
-00018c20: 616d 6532 2c5c 6e20 2020 2066 726f 6d5f  ame2,\n    from_
-00018c30: 656e 643d 5472 7565 2c5c 6e29 5c6e 6060  end=True,\n)\n``
-00018c40: 605c 6e5c 6e23 2323 2052 6570 6c61 7920  `\n\n### Replay 
-00018c50: 7061 726b 6564 2065 7665 6e74 735c 6e5c  parked events\n\
-00018c60: 6e2a 7265 7175 6972 6573 206c 6561 6465  n*requires leade
-00018c70: 722a 5c6e 5c6e 5468 6520 6072 6570 6c61  r*\n\nThe `repla
-00018c80: 795f 7061 726b 6564 5f65 7665 6e74 7328  y_parked_events(
-00018c90: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
-00018ca0: 2075 7365 6420 746f 2022 7265 706c 6179   used to "replay
-00018cb0: 2220 6576 656e 7473 2074 6861 7420 6861  " events that ha
-00018cc0: 7665 5c6e 6265 656e 2022 7061 726b 6564  ve\nbeen "parked
-00018cd0: 2220 286e 6567 6174 6976 656c 7920 6163  " (negatively ac
-00018ce0: 6b6e 6f77 6c65 6467 6564 2077 6974 6820  knowledged with 
-00018cf0: 7468 6520 6163 7469 6f6e 2060 5c27 7061  the action `\'pa
-00018d00: 726b 5c27 6029 2077 6865 6e20 7265 6164  rk\'`) when read
-00018d10: 696e 675c 6e61 2070 6572 7369 7374 656e  ing\na persisten
-00018d20: 7420 7375 6273 6372 6970 7469 6f6e 2e20  t subscription. 
-00018d30: 5061 726b 6564 2065 7665 6e74 7320 7769  Parked events wi
-00018d40: 6c6c 2074 6865 6e20 6265 2072 6563 6569  ll then be recei
-00018d50: 7665 6420 6167 6169 6e20 6279 2063 6f6e  ved again by con
-00018d60: 7375 6d65 7273 5c6e 7265 6164 696e 6720  sumers\nreading 
-00018d70: 6672 6f6d 2074 6865 2070 6572 7369 7374  from the persist
-00018d80: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
-00018d90: 2e5c 6e5c 6e54 6869 7320 6d65 7468 6f64  .\n\nThis method
-00018da0: 2068 6173 2061 2072 6571 7569 7265 6420   has a required 
-00018db0: 6067 726f 7570 5f6e 616d 6560 2061 7267  `group_name` arg
-00018dc0: 756d 656e 7420 616e 6420 616e 206f 7074  ument and an opt
-00018dd0: 696f 6e61 6c20 6073 7472 6561 6d5f 6e61  ional `stream_na
-00018de0: 6d65 605c 6e61 7267 756d 656e 742e 2054  me`\nargument. T
-00018df0: 6865 2076 616c 7565 7320 6f66 2074 6865  he values of the
-00018e00: 7365 2061 7267 756d 656e 7473 2073 686f  se arguments sho
-00018e10: 756c 6420 6d61 7463 6820 7468 6f73 6520  uld match those 
-00018e20: 7573 6564 2077 6865 6e20 6361 6c6c 696e  used when callin
-00018e30: 675c 6e60 6372 6561 7465 5f73 7562 7363  g\n`create_subsc
-00018e40: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
-00018e50: 6020 6f72 2060 6372 6561 7465 5f73 7562  ` or `create_sub
-00018e60: 7363 7269 7074 696f 6e5f 746f 5f73 7472  scription_to_str
-00018e70: 6561 6d28 2960 2e5c 6e5c 6e54 6869 7320  eam()`.\n\nThis 
-00018e80: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
-00018e90: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
-00018ea0: 2061 7267 756d 656e 742c 2074 6861 745c   argument, that\
-00018eb0: 6e69 7320 6578 7065 6374 6564 2074 6f20  nis expected to 
-00018ec0: 6265 2061 2050 7974 686f 6e20 6066 6c6f  be a Python `flo
-00018ed0: 6174 602c 2077 6869 6368 2073 6574 7320  at`, which sets 
-00018ee0: 6120 6465 6164 6c69 6e65 5c6e 666f 7220  a deadline\nfor 
-00018ef0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
-00018f00: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
-00018f10: 7469 6f6e 2e5c 6e5c 6e54 6869 7320 6d65  tion.\n\nThis me
-00018f20: 7468 6f64 2061 6c73 6f20 6861 7320 616e  thod also has an
-00018f30: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
-00018f40: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
-00018f50: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
-00018f60: 7365 6420 746f 5c6e 6f76 6572 7269 6465  sed to\noverride
-00018f70: 2063 616c 6c20 6372 6564 656e 7469 616c   call credential
-00018f80: 7320 6465 7269 7665 6420 6672 6f6d 2074  s derived from t
-00018f90: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
-00018fa0: 7269 6e67 2055 5249 2e5c 6e5c 6e54 6865  ring URI.\n\nThe
-00018fb0: 2065 7861 6d70 6c65 2062 656c 6f77 2072   example below r
-00018fc0: 6570 6c61 7973 2070 6172 6b65 6420 6576  eplays parked ev
-00018fd0: 656e 7473 2066 6f72 2067 726f 7570 2060  ents for group `
-00018fe0: 6772 6f75 705f 6e61 6d65 3160 2e5c 6e5c  group_name1`.\n\
-00018ff0: 6e60 6060 7079 7468 6f6e 5c6e 636c 6965  n```python\nclie
-00019000: 6e74 2e72 6570 6c61 795f 7061 726b 6564  nt.replay_parked
-00019010: 5f65 7665 6e74 7328 5c6e 2020 2020 6772  _events(\n    gr
-00019020: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
-00019030: 616d 6531 2c5c 6e29 5c6e 6060 605c 6e5c  ame1,\n)\n```\n\
-00019040: 6e54 6865 2065 7861 6d70 6c65 2062 656c  nThe example bel
-00019050: 6f77 2072 6570 6c61 7973 2070 6172 6b65  ow replays parke
-00019060: 6420 6576 656e 7473 2066 6f72 2067 726f  d events for gro
-00019070: 7570 2060 6772 6f75 705f 6e61 6d65 3260  up `group_name2`
-00019080: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-00019090: 636c 6965 6e74 2e72 6570 6c61 795f 7061  client.replay_pa
-000190a0: 726b 6564 5f65 7665 6e74 7328 5c6e 2020  rked_events(\n  
-000190b0: 2020 6772 6f75 705f 6e61 6d65 3d67 726f    group_name=gro
-000190c0: 7570 5f6e 616d 6532 2c5c 6e20 2020 2073  up_name2,\n    s
-000190d0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
-000190e0: 6d5f 6e61 6d65 322c 5c6e 295c 6e60 6060  m_name2,\n)\n```
-000190f0: 5c6e 5c6e 2323 2320 4765 7420 7375 6273  \n\n### Get subs
-00019100: 6372 6970 7469 6f6e 2069 6e66 6f5c 6e5c  cription info\n\
-00019110: 6e2a 7265 7175 6972 6573 206c 6561 6465  n*requires leade
-00019120: 722a 5c6e 5c6e 5468 6520 6067 6574 5f73  r*\n\nThe `get_s
-00019130: 7562 7363 7269 7074 696f 6e5f 696e 666f  ubscription_info
-00019140: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
-00019150: 6520 7573 6564 2074 6f20 6765 7420 696e  e used to get in
-00019160: 666f 726d 6174 696f 6e20 666f 7220 615c  formation for a\
-00019170: 6e70 6572 7369 7374 656e 7420 7375 6273  npersistent subs
-00019180: 6372 6970 7469 6f6e 2e5c 6e5c 6e54 6869  cription.\n\nThi
-00019190: 7320 6d65 7468 6f64 2068 6173 2061 2072  s method has a r
-000191a0: 6571 7569 7265 6420 6067 726f 7570 5f6e  equired `group_n
-000191b0: 616d 6560 2061 7267 756d 656e 7420 616e  ame` argument an
-000191c0: 6420 616e 206f 7074 696f 6e61 6c20 6073  d an optional `s
-000191d0: 7472 6561 6d5f 6e61 6d65 605c 6e61 7267  tream_name`\narg
-000191e0: 756d 656e 742c 2077 6869 6368 2073 686f  ument, which sho
-000191f0: 756c 6420 6d61 7463 6820 7468 6520 7661  uld match the va
-00019200: 6c75 6573 206f 6620 6172 6775 6d65 6e74  lues of argument
-00019210: 7320 7573 6564 2077 6865 6e20 6361 6c6c  s used when call
-00019220: 696e 6720 6569 7468 6572 5c6e 6063 7265  ing either\n`cre
-00019230: 6174 655f 7375 6273 6372 6970 7469 6f6e  ate_subscription
-00019240: 5f74 6f5f 616c 6c28 2960 206f 7220 6063  _to_all()` or `c
-00019250: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
-00019260: 6f6e 5f74 6f5f 7374 7265 616d 2829 602e  on_to_stream()`.
-00019270: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-00019280: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
-00019290: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-000192a0: 6e74 2c20 7468 6174 5c6e 6973 2065 7870  nt, that\nis exp
-000192b0: 6563 7465 6420 746f 2062 6520 6120 5079  ected to be a Py
-000192c0: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
-000192d0: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
-000192e0: 696e 655c 6e66 6f72 2074 6865 2063 6f6d  ine\nfor the com
-000192f0: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
-00019300: 5250 4320 6f70 6572 6174 696f 6e2e 5c6e  RPC operation.\n
-00019310: 5c6e 5468 6973 206d 6574 686f 6420 616c  \nThis method al
-00019320: 736f 2068 6173 2061 6e20 6f70 7469 6f6e  so has an option
-00019330: 616c 2060 6372 6564 656e 7469 616c 7360  al `credentials`
-00019340: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
-00019350: 2063 616e 2062 6520 7573 6564 2074 6f5c   can be used to\
-00019360: 6e6f 7665 7272 6964 6520 6361 6c6c 2063  noverride call c
-00019370: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
-00019380: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
-00019390: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
-000193a0: 492e 5c6e 5c6e 5468 6520 6578 616d 706c  I.\n\nThe exampl
-000193b0: 6520 6265 6c6f 7720 6765 7473 2069 6e66  e below gets inf
-000193c0: 6f72 6d61 7469 6f6e 2066 6f72 2074 6865  ormation for the
-000193d0: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
-000193e0: 6372 6970 7469 6f6e 2060 6772 6f75 705f  cription `group_
-000193f0: 6e61 6d65 3160 2077 6869 6368 5c6e 7761  name1` which\nwa
-00019400: 7320 6372 6561 7465 6420 6279 2063 616c  s created by cal
-00019410: 6c69 6e67 2060 6372 6561 7465 5f73 7562  ling `create_sub
-00019420: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
-00019430: 2829 602e 5c6e 5c6e 6060 6070 7974 686f  ()`.\n\n```pytho
-00019440: 6e5c 6e73 7562 7363 7269 7074 696f 6e5f  n\nsubscription_
-00019450: 696e 666f 203d 2063 6c69 656e 742e 6765  info = client.ge
-00019460: 745f 7375 6273 6372 6970 7469 6f6e 5f69  t_subscription_i
-00019470: 6e66 6f28 5c6e 2020 2020 6772 6f75 705f  nfo(\n    group_
-00019480: 6e61 6d65 3d67 726f 7570 5f6e 616d 6531  name=group_name1
-00019490: 2c5c 6e29 5c6e 6060 605c 6e5c 6e54 6865  ,\n)\n```\n\nThe
-000194a0: 2065 7861 6d70 6c65 2062 656c 6f77 2067   example below g
-000194b0: 6574 7320 696e 666f 726d 6174 696f 6e20  ets information 
-000194c0: 666f 7220 7468 6520 7065 7273 6973 7465  for the persiste
-000194d0: 6e74 2073 7562 7363 7269 7074 696f 6e20  nt subscription 
-000194e0: 6067 726f 7570 5f6e 616d 6532 6020 6f6e  `group_name2` on
-000194f0: 5c6e 6073 7472 6561 6d5f 6e61 6d65 3260  \n`stream_name2`
-00019500: 2077 6869 6368 2077 6173 2063 7265 6174   which was creat
-00019510: 6564 2062 7920 6361 6c6c 696e 6720 6063  ed by calling `c
-00019520: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
-00019530: 6f6e 5f74 6f5f 7374 7265 616d 2829 602e  on_to_stream()`.
-00019540: 5c6e 5c6e 6060 6070 7974 686f 6e5c 6e73  \n\n```python\ns
-00019550: 7562 7363 7269 7074 696f 6e5f 696e 666f  ubscription_info
-00019560: 203d 2063 6c69 656e 742e 6765 745f 7375   = client.get_su
-00019570: 6273 6372 6970 7469 6f6e 5f69 6e66 6f28  bscription_info(
-00019580: 5c6e 2020 2020 6772 6f75 705f 6e61 6d65  \n    group_name
-00019590: 3d67 726f 7570 5f6e 616d 6532 2c5c 6e20  =group_name2,\n 
-000195a0: 2020 2073 7472 6561 6d5f 6e61 6d65 3d73     stream_name=s
-000195b0: 7472 6561 6d5f 6e61 6d65 322c 5c6e 295c  tream_name2,\n)\
-000195c0: 6e60 6060 5c6e 5c6e 5468 6520 7265 7475  n```\n\nThe retu
-000195d0: 726e 6564 2076 616c 7565 2069 7320 6120  rned value is a 
-000195e0: 6053 7562 7363 7269 7074 696f 6e49 6e66  `SubscriptionInf
-000195f0: 6f60 206f 626a 6563 742e 5c6e 5c6e 2323  o` object.\n\n##
-00019600: 2320 4c69 7374 2073 7562 7363 7269 7074  # List subscript
-00019610: 696f 6e73 5c6e 5c6e 2a72 6571 7569 7265  ions\n\n*require
-00019620: 7320 6c65 6164 6572 2a5c 6e5c 6e54 6865  s leader*\n\nThe
-00019630: 2060 6c69 7374 5f73 7562 7363 7269 7074   `list_subscript
-00019640: 696f 6e73 2829 6020 6d65 7468 6f64 2063  ions()` method c
-00019650: 616e 2062 6520 7573 6564 2074 6f20 6765  an be used to ge
-00019660: 7420 696e 666f 726d 6174 696f 6e20 666f  t information fo
-00019670: 7220 616c 6c5c 6e65 7869 7374 696e 6720  r all\nexisting 
-00019680: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
-00019690: 7269 7074 696f 6e73 2c20 626f 7468 2022  riptions, both "
-000196a0: 7375 6273 6372 6970 7469 6f6e 7320 746f  subscriptions to
-000196b0: 2061 6c6c 2220 616e 645c 6e22 7375 6273   all" and\n"subs
-000196c0: 6372 6970 7469 6f6e 7320 746f 2073 7472  criptions to str
-000196d0: 6561 6d22 2e5c 6e5c 6e54 6869 7320 6d65  eam".\n\nThis me
-000196e0: 7468 6f64 2068 6173 2061 6e20 6f70 7469  thod has an opti
-000196f0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
-00019700: 7267 756d 656e 742c 2074 6861 745c 6e69  rgument, that\ni
-00019710: 7320 6578 7065 6374 6564 2074 6f20 6265  s expected to be
-00019720: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
-00019730: 602c 2077 6869 6368 2073 6574 7320 6120  `, which sets a 
-00019740: 6465 6164 6c69 6e65 5c6e 666f 7220 7468  deadline\nfor th
-00019750: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
-00019760: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
-00019770: 6f6e 2e5c 6e5c 6e54 6869 7320 6d65 7468  on.\n\nThis meth
-00019780: 6f64 2061 6c73 6f20 6861 7320 616e 206f  od also has an o
-00019790: 7074 696f 6e61 6c20 6063 7265 6465 6e74  ptional `credent
-000197a0: 6961 6c73 6020 6172 6775 6d65 6e74 2c20  ials` argument, 
-000197b0: 7768 6963 6820 6361 6e20 6265 2075 7365  which can be use
-000197c0: 6420 746f 5c6e 6f76 6572 7269 6465 2063  d to\noverride c
-000197d0: 616c 6c20 6372 6564 656e 7469 616c 7320  all credentials 
-000197e0: 6465 7269 7665 6420 6672 6f6d 2074 6865  derived from the
-000197f0: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
-00019800: 6e67 2055 5249 2e5c 6e5c 6e54 6865 2065  ng URI.\n\nThe e
-00019810: 7861 6d70 6c65 2062 656c 6f77 206c 6973  xample below lis
-00019820: 7473 2061 6c6c 2074 6865 2065 7869 7374  ts all the exist
-00019830: 696e 6720 7065 7273 6973 7465 6e74 2073  ing persistent s
-00019840: 7562 7363 7269 7074 696f 6e73 2e5c 6e5c  ubscriptions.\n\
-00019850: 6e60 6060 7079 7468 6f6e 5c6e 7375 6273  n```python\nsubs
-00019860: 6372 6970 7469 6f6e 7320 3d20 636c 6965  criptions = clie
-00019870: 6e74 2e6c 6973 745f 7375 6273 6372 6970  nt.list_subscrip
-00019880: 7469 6f6e 7328 295c 6e60 6060 5c6e 5c6e  tions()\n```\n\n
-00019890: 5468 6520 7265 7475 726e 6564 2076 616c  The returned val
-000198a0: 7565 2069 7320 6120 6c69 7374 206f 6620  ue is a list of 
-000198b0: 6053 7562 7363 7269 7074 696f 6e49 6e66  `SubscriptionInf
-000198c0: 6f60 206f 626a 6563 7473 2e5c 6e5c 6e5c  o` objects.\n\n\
-000198d0: 6e23 2323 204c 6973 7420 7375 6273 6372  n### List subscr
-000198e0: 6970 7469 6f6e 7320 746f 2073 7472 6561  iptions to strea
-000198f0: 6d5c 6e5c 6e2a 7265 7175 6972 6573 206c  m\n\n*requires l
-00019900: 6561 6465 722a 5c6e 5c6e 5468 6520 606c  eader*\n\nThe `l
-00019910: 6973 745f 7375 6273 6372 6970 7469 6f6e  ist_subscription
-00019920: 735f 746f 5f73 7472 6561 6d28 2960 206d  s_to_stream()` m
-00019930: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-00019940: 6420 746f 2067 6574 2069 6e66 6f72 6d61  d to get informa
-00019950: 7469 6f6e 2066 6f72 2061 6c6c 5c6e 7468  tion for all\nth
-00019960: 6520 7065 7273 6973 7465 6e74 2073 7562  e persistent sub
-00019970: 7363 7269 7074 696f 6e73 2074 6f20 6120  scriptions to a 
-00019980: 7374 7265 616d 2e5c 6e5c 6e54 6869 7320  stream.\n\nThis 
-00019990: 6d65 7468 6f64 2068 6173 206f 6e65 2072  method has one r
-000199a0: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
-000199b0: 2c20 6073 7472 6561 6d5f 6e61 6d65 602e  , `stream_name`.
-000199c0: 5c6e 5c6e 5468 6973 206d 6574 686f 6420  \n\nThis method 
-000199d0: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
-000199e0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
-000199f0: 6e74 2c20 7468 6174 2069 7320 6578 7065  nt, that is expe
-00019a00: 6374 6564 2074 6f20 6265 2061 5c6e 5079  cted to be a\nPy
-00019a10: 7468 6f6e 2060 666c 6f61 7460 2c20 7768  thon `float`, wh
-00019a20: 6963 6820 7365 7473 2061 2064 6561 646c  ich sets a deadl
-00019a30: 696e 6520 666f 7220 7468 6520 636f 6d70  ine for the comp
-00019a40: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
-00019a50: 5043 206f 7065 7261 7469 6f6e 2e5c 6e5c  PC operation.\n\
-00019a60: 6e54 6869 7320 6d65 7468 6f64 2061 6c73  nThis method als
-00019a70: 6f20 6861 7320 616e 206f 7074 696f 6e61  o has an optiona
-00019a80: 6c20 6063 7265 6465 6e74 6961 6c73 6020  l `credentials` 
-00019a90: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
-00019aa0: 6361 6e20 6265 2075 7365 6420 746f 5c6e  can be used to\n
-00019ab0: 6f76 6572 7269 6465 2063 616c 6c20 6372  override call cr
-00019ac0: 6564 656e 7469 616c 7320 6465 7269 7665  edentials derive
-00019ad0: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
-00019ae0: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
-00019af0: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-00019b00: 7375 6273 6372 6970 7469 6f6e 7320 3d20  subscriptions = 
-00019b10: 636c 6965 6e74 2e6c 6973 745f 7375 6273  client.list_subs
-00019b20: 6372 6970 7469 6f6e 735f 746f 5f73 7472  criptions_to_str
-00019b30: 6561 6d28 5c6e 2020 2020 7374 7265 616d  eam(\n    stream
-00019b40: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
-00019b50: 6532 2c5c 6e29 5c6e 6060 605c 6e5c 6e54  e2,\n)\n```\n\nT
-00019b60: 6865 2072 6574 7572 6e65 6420 7661 6c75  he returned valu
-00019b70: 6520 6973 2061 206c 6973 7420 6f66 2060  e is a list of `
-00019b80: 5375 6273 6372 6970 7469 6f6e 496e 666f  SubscriptionInfo
-00019b90: 6020 6f62 6a65 6374 732e 5c6e 5c6e 5c6e  ` objects.\n\n\n
-00019ba0: 2323 2320 4465 6c65 7465 2073 7562 7363  ### Delete subsc
-00019bb0: 7269 7074 696f 6e5c 6e5c 6e2a 7265 7175  ription\n\n*requ
-00019bc0: 6972 6573 206c 6561 6465 722a 5c6e 5c6e  ires leader*\n\n
-00019bd0: 5468 6520 6064 656c 6574 655f 7375 6273  The `delete_subs
-00019be0: 6372 6970 7469 6f6e 2829 6020 6d65 7468  cription()` meth
-00019bf0: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
-00019c00: 6f20 6465 6c65 7465 2061 2070 6572 7369  o delete a persi
-00019c10: 7374 656e 745c 6e73 7562 7363 7269 7074  stent\nsubscript
-00019c20: 696f 6e2e 5c6e 5c6e 5468 6973 206d 6574  ion.\n\nThis met
-00019c30: 686f 6420 6861 7320 6120 7265 7175 6972  hod has a requir
-00019c40: 6564 2060 6772 6f75 705f 6e61 6d65 6020  ed `group_name` 
-00019c50: 6172 6775 6d65 6e74 2061 6e64 2061 6e20  argument and an 
-00019c60: 6f70 7469 6f6e 616c 2060 7374 7265 616d  optional `stream
-00019c70: 5f6e 616d 6560 5c6e 6172 6775 6d65 6e74  _name`\nargument
-00019c80: 2c20 7768 6963 6820 7368 6f75 6c64 206d  , which should m
-00019c90: 6174 6368 2074 6865 2076 616c 7565 7320  atch the values 
-00019ca0: 6f66 2061 7267 756d 656e 7473 2075 7365  of arguments use
-00019cb0: 6420 7768 656e 2063 616c 6c69 6e67 2065  d when calling e
-00019cc0: 6974 6865 725c 6e60 6372 6561 7465 5f73  ither\n`create_s
-00019cd0: 7562 7363 7269 7074 696f 6e5f 746f 5f61  ubscription_to_a
-00019ce0: 6c6c 2829 6020 6f72 2060 6372 6561 7465  ll()` or `create
-00019cf0: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
-00019d00: 5f73 7472 6561 6d28 2960 2e5c 6e5c 6e54  _stream()`.\n\nT
-00019d10: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
-00019d20: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
-00019d30: 6f75 7460 2061 7267 756d 656e 742c 2074  out` argument, t
-00019d40: 6861 745c 6e69 7320 6578 7065 6374 6564  hat\nis expected
-00019d50: 2074 6f20 6265 2061 2050 7974 686f 6e20   to be a Python 
-00019d60: 6066 6c6f 6174 602c 2077 6869 6368 2073  `float`, which s
-00019d70: 6574 7320 6120 6465 6164 6c69 6e65 5c6e  ets a deadline\n
-00019d80: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
-00019d90: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
-00019da0: 7065 7261 7469 6f6e 2e5c 6e5c 6e54 6869  peration.\n\nThi
-00019db0: 7320 6d65 7468 6f64 2061 6c73 6f20 6861  s method also ha
-00019dc0: 7320 616e 206f 7074 696f 6e61 6c20 6063  s an optional `c
-00019dd0: 7265 6465 6e74 6961 6c73 6020 6172 6775  redentials` argu
-00019de0: 6d65 6e74 2c20 7768 6963 6820 6361 6e20  ment, which can 
-00019df0: 6265 2075 7365 6420 746f 5c6e 6f76 6572  be used to\nover
-00019e00: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
-00019e10: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
-00019e20: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
-00019e30: 6e20 7374 7269 6e67 2055 5249 2e5c 6e5c  n string URI.\n\
-00019e40: 6e54 6865 2065 7861 6d70 6c65 2062 656c  nThe example bel
-00019e50: 6f77 2064 656c 6574 6573 2074 6865 2070  ow deletes the p
-00019e60: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
-00019e70: 6970 7469 6f6e 2060 6772 6f75 705f 6e61  iption `group_na
-00019e80: 6d65 3160 2077 6869 6368 5c6e 7761 7320  me1` which\nwas 
-00019e90: 6372 6561 7465 6420 6279 2063 616c 6c69  created by calli
-00019ea0: 6e67 2060 6372 6561 7465 5f73 7562 7363  ng `create_subsc
-00019eb0: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
-00019ec0: 602e 5c6e 5c6e 6060 6070 7974 686f 6e5c  `.\n\n```python\
-00019ed0: 6e63 6c69 656e 742e 6465 6c65 7465 5f73  nclient.delete_s
-00019ee0: 7562 7363 7269 7074 696f 6e28 5c6e 2020  ubscription(\n  
-00019ef0: 2020 6772 6f75 705f 6e61 6d65 3d67 726f    group_name=gro
-00019f00: 7570 5f6e 616d 6531 2c5c 6e29 5c6e 6060  up_name1,\n)\n``
-00019f10: 605c 6e5c 6e54 6865 2065 7861 6d70 6c65  `\n\nThe example
-00019f20: 2062 656c 6f77 2064 656c 6574 6564 2074   below deleted t
-00019f30: 6865 2070 6572 7369 7374 656e 7420 7375  he persistent su
-00019f40: 6273 6372 6970 7469 6f6e 2060 6772 6f75  bscription `grou
-00019f50: 705f 6e61 6d65 3260 206f 6e5c 6e60 7374  p_name2` on\n`st
-00019f60: 7265 616d 5f6e 616d 6532 6020 7768 6963  ream_name2` whic
-00019f70: 6820 7761 7320 6372 6561 7465 6420 6279  h was created by
-00019f80: 2063 616c 6c69 6e67 2060 6372 6561 7465   calling `create
-00019f90: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
-00019fa0: 5f73 7472 6561 6d28 2960 2e5c 6e5c 6e60  _stream()`.\n\n`
-00019fb0: 6060 7079 7468 6f6e 5c6e 636c 6965 6e74  ``python\nclient
-00019fc0: 2e64 656c 6574 655f 7375 6273 6372 6970  .delete_subscrip
-00019fd0: 7469 6f6e 285c 6e20 2020 2067 726f 7570  tion(\n    group
-00019fe0: 5f6e 616d 653d 6772 6f75 705f 6e61 6d65  _name=group_name
-00019ff0: 322c 5c6e 2020 2020 7374 7265 616d 5f6e  2,\n    stream_n
-0001a000: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
-0001a010: 2c5c 6e29 5c6e 6060 605c 6e5c 6e23 2323  ,\n)\n```\n\n###
-0001a020: 2043 616c 6c20 6372 6564 656e 7469 616c   Call credential
-0001a030: 735c 6e5c 6e44 6566 6175 6c74 2063 616c  s\n\nDefault cal
-0001a040: 6c20 6372 6564 656e 7469 616c 7320 6172  l credentials ar
-0001a050: 6520 6465 7269 7665 6420 6279 2074 6865  e derived by the
-0001a060: 2063 6c69 656e 7420 6672 6f6d 2074 6865   client from the
-0001a070: 2075 7365 7220 696e 666f 2070 6172 7420   user info part 
-0001a080: 6f66 2074 6865 5c6e 636f 6e6e 6563 7469  of the\nconnecti
-0001a090: 6f6e 2073 7472 696e 6720 5552 492e 5c6e  on string URI.\n
-0001a0a0: 5c6e 4d61 6e79 206f 6620 7468 6520 636c  \nMany of the cl
-0001a0b0: 6965 6e74 206d 6574 686f 6473 2064 6573  ient methods des
-0001a0c0: 6372 6962 6564 2061 626f 7665 2068 6176  cribed above hav
-0001a0d0: 6520 616e 206f 7074 696f 6e61 6c20 6063  e an optional `c
-0001a0e0: 7265 6465 6e74 6961 6c73 6020 6172 6775  redentials` argu
-0001a0f0: 6d65 6e74 2c5c 6e77 6869 6368 2063 616e  ment,\nwhich can
-0001a100: 2062 6520 7573 6564 2074 6f20 7365 7420   be used to set 
-0001a110: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
-0001a120: 2066 6f72 2061 6e20 696e 6469 7669 6475   for an individu
-0001a130: 616c 206d 6574 686f 6420 6361 6c6c 2074  al method call t
-0001a140: 6861 7420 6f76 6572 7269 6465 5c6e 7468  hat override\nth
-0001a150: 6f73 6520 6465 7269 7665 6420 6672 6f6d  ose derived from
-0001a160: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
-0001a170: 7374 7269 6e67 2055 5249 2e5c 6e5c 6e23  string URI.\n\n#
-0001a180: 2323 2043 6f6e 7374 7275 6374 2063 616c  ## Construct cal
-0001a190: 6c20 6372 6564 656e 7469 616c 735c 6e5c  l credentials\n\
-0001a1a0: 6e54 6865 2063 6c69 656e 7420 6d65 7468  nThe client meth
-0001a1b0: 6f64 2060 636f 6e73 7472 7563 745f 6361  od `construct_ca
-0001a1c0: 6c6c 5f63 7265 6465 6e74 6961 6c73 2829  ll_credentials()
-0001a1d0: 6020 6361 6e20 6265 2075 7365 6420 746f  ` can be used to
-0001a1e0: 2063 6f6e 7374 7275 6374 2061 2063 616c   construct a cal
-0001a1f0: 6c5c 6e63 7265 6465 6e74 6961 6c73 206f  l\ncredentials o
-0001a200: 626a 6563 7420 6672 6f6d 2061 2075 7365  bject from a use
-0001a210: 726e 616d 6520 616e 6420 7061 7373 776f  rname and passwo
-0001a220: 7264 2e5c 6e5c 6e60 6060 7079 7468 6f6e  rd.\n\n```python
-0001a230: 5c6e 6361 6c6c 5f63 7265 6465 6e74 6961  \ncall_credentia
-0001a240: 6c73 203d 2063 6c69 656e 742e 636f 6e73  ls = client.cons
-0001a250: 7472 7563 745f 6361 6c6c 5f63 7265 6465  truct_call_crede
-0001a260: 6e74 6961 6c73 285c 6e20 2020 2075 7365  ntials(\n    use
-0001a270: 726e 616d 653d 5c27 6164 6d69 6e5c 272c  rname=\'admin\',
-0001a280: 2070 6173 7377 6f72 643d 5c27 6368 616e   password=\'chan
-0001a290: 6765 6974 5c27 5c6e 295c 6e60 6060 5c6e  geit\'\n)\n```\n
-0001a2a0: 5c6e 5468 6520 6361 6c6c 2063 7265 6465  \nThe call crede
-0001a2b0: 6e74 6961 6c73 206f 626a 6563 7420 6361  ntials object ca
-0001a2c0: 6e20 6265 2075 7365 6420 6173 2074 6865  n be used as the
-0001a2d0: 2076 616c 7565 206f 6620 7468 6520 6063   value of the `c
-0001a2e0: 7265 6465 6e74 6961 6c73 605c 6e61 7267  redentials`\narg
-0001a2f0: 756d 656e 7420 696e 206f 7468 6572 2063  ument in other c
-0001a300: 6c69 656e 7420 6d65 7468 6f64 732e 5c6e  lient methods.\n
-0001a310: 5c6e 2323 2043 6f6e 6e65 6374 696f 6e5c  \n## Connection\
-0001a320: 6e5c 6e23 2323 2052 6563 6f6e 6e65 6374  n\n### Reconnect
-0001a330: 5c6e 5c6e 5468 6520 6072 6563 6f6e 6e65  \n\nThe `reconne
-0001a340: 6374 2829 6020 6d65 7468 6f64 2063 616e  ct()` method can
-0001a350: 2062 6520 7573 6564 2074 6f20 6d61 6e75   be used to manu
-0001a360: 616c 6c79 2072 6563 6f6e 6e65 6374 2074  ally reconnect t
-0001a370: 6865 2063 6c69 656e 7420 746f 2061 5c6e  he client to a\n
-0001a380: 7375 6974 6162 6c65 2045 7665 6e74 5374  suitable EventSt
-0001a390: 6f72 6544 4220 6e6f 6465 2e20 5468 6973  oreDB node. This
-0001a3a0: 206d 6574 686f 6420 7573 6573 2074 6865   method uses the
-0001a3b0: 2073 616d 6520 726f 7574 696e 6520 666f   same routine fo
-0001a3c0: 7220 7265 6164 696e 6720 7468 655c 6e63  r reading the\nc
-0001a3d0: 6c75 7374 6572 206e 6f64 6520 7374 6174  luster node stat
-0001a3e0: 6573 2061 6e64 2074 6865 6e20 636f 6e6e  es and then conn
-0001a3f0: 6563 7469 6e67 2074 6f20 6120 7375 6974  ecting to a suit
-0001a400: 6162 6c65 206e 6f64 6520 6163 636f 7264  able node accord
-0001a410: 696e 6720 746f 2074 6865 5c6e 636c 6965  ing to the\nclie
-0001a420: 6e74 5c27 7320 6e6f 6465 2070 7265 6665  nt\'s node prefe
-0001a430: 7265 6e63 6520 7468 6174 2069 7320 7370  rence that is sp
-0001a440: 6563 6966 6965 6420 696e 2074 6865 2063  ecified in the c
-0001a450: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
-0001a460: 2055 5249 2077 6865 6e5c 6e74 6865 2063   URI when\nthe c
-0001a470: 6c69 656e 7420 6973 2063 6f6e 7374 7275  lient is constru
-0001a480: 6374 6564 2e20 5468 6973 206d 6574 686f  cted. This metho
-0001a490: 6420 6973 2074 6872 6561 642d 7361 6665  d is thread-safe
-0001a4a0: 2c20 696e 2074 6861 7420 7768 656e 2069  , in that when i
-0001a4b0: 7420 6973 2063 616c 6c65 645c 6e62 7920  t is called\nby 
-0001a4c0: 7365 7665 7261 6c20 7468 7265 6164 7320  several threads 
-0001a4d0: 6174 2074 6865 2073 616d 6520 7469 6d65  at the same time
-0001a4e0: 2c20 6f6e 6c79 206f 6e65 2072 6563 6f6e  , only one recon
-0001a4f0: 6e65 6374 696f 6e20 7769 6c6c 206f 6363  nection will occ
-0001a500: 7572 2e20 436f 6e63 7572 7265 6e74 5c6e  ur. Concurrent\n
-0001a510: 6174 7465 6d70 7473 2074 6f20 7265 636f  attempts to reco
-0001a520: 6e6e 6563 7420 7769 6c6c 2062 6c6f 636b  nnect will block
-0001a530: 2075 6e74 696c 2074 6865 2063 6c69 656e   until the clien
-0001a540: 7420 6861 7320 7265 636f 6e6e 6563 7465  t has reconnecte
-0001a550: 6420 7375 6363 6573 7366 756c 6c79 2c5c  d successfully,\
-0001a560: 6e61 6e64 2074 6865 6e20 7468 6579 2077  nand then they w
-0001a570: 696c 6c20 616c 6c20 7265 7475 726e 206e  ill all return n
-0001a580: 6f72 6d61 6c6c 792e 5c6e 5c6e 6060 6070  ormally.\n\n```p
-0001a590: 7974 686f 6e5c 6e63 6c69 656e 742e 7265  ython\nclient.re
-0001a5a0: 636f 6e6e 6563 7428 295c 6e60 6060 5c6e  connect()\n```\n
-0001a5b0: 5c6e 416e 2065 7861 6d70 6c65 206f 6620  \nAn example of 
-0001a5c0: 7768 656e 2069 7420 6d69 6768 7420 6265  when it might be
-0001a5d0: 2064 6573 6972 6162 6c65 2074 6f20 7265   desirable to re
-0001a5e0: 636f 6e6e 6563 7420 6d61 6e75 616c 6c79  connect manually
-0001a5f0: 2069 7320 7768 656e 2028 666f 7220 7065   is when (for pe
-0001a600: 7266 6f72 6d61 6e63 655c 6e72 6561 736f  rformance\nreaso
-0001a610: 6e73 2920 7468 6520 636c 6965 6e74 5c27  ns) the client\'
-0001a620: 7320 6e6f 6465 2070 7265 6665 7265 6e63  s node preferenc
-0001a630: 6520 6973 2074 6f20 6265 2063 6f6e 6e65  e is to be conne
-0001a640: 6374 6564 2074 6f20 6120 666f 6c6c 6f77  cted to a follow
-0001a650: 6572 206e 6f64 6520 696e 2074 6865 5c6e  er node in the\n
-0001a660: 636c 7573 7465 722c 2061 6e64 2c20 6166  cluster, and, af
-0001a670: 7465 7220 6120 636c 7573 7465 7220 6c65  ter a cluster le
-0001a680: 6164 6572 2065 6c65 6374 696f 6e2c 2074  ader election, t
-0001a690: 6865 2066 6f6c 6c6f 7765 7220 6265 636f  he follower beco
-0001a6a0: 6d65 7320 7468 6520 6c65 6164 6572 2e5c  mes the leader.\
-0001a6b0: 6e52 6563 6f6e 6e65 6374 696e 6720 746f  nReconnecting to
-0001a6c0: 2061 2066 6f6c 6c6f 7765 7220 6e6f 6465   a follower node
-0001a6d0: 2069 6e20 7468 6973 2063 6173 6520 6973   in this case is
-0001a6e0: 2063 7572 7265 6e74 6c79 2062 6579 6f6e   currently beyon
-0001a6f0: 6420 7468 6520 6361 7061 6269 6c69 7469  d the capabiliti
-0001a700: 6573 206f 665c 6e74 6869 7320 636c 6965  es of\nthis clie
-0001a710: 6e74 2c20 6275 7420 7468 6973 2062 6568  nt, but this beh
-0001a720: 6176 696f 7220 6d69 6768 7420 6265 2069  avior might be i
-0001a730: 6d70 6c65 6d65 6e74 6564 2069 6e20 6120  mplemented in a 
-0001a740: 6675 7475 7265 2072 656c 6561 7365 2e5c  future release.\
-0001a750: 6e5c 6e52 6563 6f6e 6e65 6374 696f 6e20  n\nReconnection 
-0001a760: 7769 6c6c 2068 6170 7065 6e20 6175 746f  will happen auto
-0001a770: 6d61 7469 6361 6c6c 7920 696e 206d 616e  matically in man
-0001a780: 7920 6361 7365 732c 2064 7565 2074 6f20  y cases, due to 
-0001a790: 7468 6520 6040 6175 746f 7265 636f 6e6e  the `@autoreconn
-0001a7a0: 6563 7460 5c6e 6465 636f 7261 746f 722e  ect`\ndecorator.
-0001a7b0: 5c6e 5c6e 2323 2320 436c 6f73 655c 6e5c  \n\n### Close\n\
-0001a7c0: 6e54 6865 2060 636c 6f73 6528 2960 206d  nThe `close()` m
-0001a7d0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
-0001a7e0: 6420 746f 2063 6c65 616e 6c79 2063 6c6f  d to cleanly clo
-0001a7f0: 7365 2074 6865 2063 6c69 656e 745c 2773  se the client\'s
-0001a800: 2067 5250 4320 636f 6e6e 6563 7469 6f6e   gRPC connection
-0001a810: 2e5c 6e5c 6e60 6060 7079 7468 6f6e 5c6e  .\n\n```python\n
-0001a820: 636c 6965 6e74 2e63 6c6f 7365 2829 5c6e  client.close()\n
-0001a830: 6060 605c 6e5c 6e5c 6e23 2320 4173 796e  ```\n\n\n## Asyn
-0001a840: 6369 6f20 636c 6965 6e74 5c6e 5c6e 5468  cio client\n\nTh
-0001a850: 6520 6065 7364 6263 6c69 656e 7460 2070  e `esdbclient` p
-0001a860: 6163 6b61 6765 2061 6c73 6f20 696e 636c  ackage also incl
-0001a870: 7564 6573 2061 6e20 6561 726c 7920 7665  udes an early ve
-0001a880: 7273 696f 6e20 6f66 2061 6e20 6173 796e  rsion of an asyn
-0001a890: 6368 726f 6e6f 7573 2049 2f4f 5c6e 6752  chronous I/O\ngR
-0001a8a0: 5043 2050 7974 686f 6e20 636c 6965 6e74  PC Python client
-0001a8b0: 2e20 4974 2066 6f6c 6c6f 7773 2065 7861  . It follows exa
-0001a8c0: 6374 6c79 2074 6865 2073 616d 6520 6265  ctly the same be
-0001a8d0: 6861 7669 6f72 7320 6173 2074 6865 206d  haviors as the m
-0001a8e0: 756c 7469 7468 7265 6164 6564 5c6e 6045  ultithreaded\n`E
-0001a8f0: 7665 6e74 5374 6f72 6544 4243 6c69 656e  ventStoreDBClien
-0001a900: 7460 2c20 6275 7420 7573 6573 2074 6865  t`, but uses the
-0001a910: 2060 6772 7063 2e61 696f 6020 7061 636b   `grpc.aio` pack
-0001a920: 6167 6520 616e 6420 7468 6520 6061 7379  age and the `asy
-0001a930: 6e63 696f 6020 6d6f 6475 6c65 2c20 696e  ncio` module, in
-0001a940: 7374 6561 6420 6f66 5c6e 6067 7270 6360  stead of\n`grpc`
-0001a950: 2061 6e64 2060 7468 7265 6164 696e 6760   and `threading`
-0001a960: 2e5c 6e5c 6e54 6865 2061 7379 6e63 2066  .\n\nThe async f
-0001a970: 756e 6374 696f 6e20 6041 7379 6e63 696f  unction `Asyncio
-0001a980: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
-0001a990: 6e74 6020 636f 6e73 7472 7563 7473 2074  nt` constructs t
-0001a9a0: 6865 2063 6c69 656e 742c 2061 6e64 2063  he client, and c
-0001a9b0: 6f6e 6e65 6374 7320 746f 5c6e 6120 7365  onnects to\na se
-0001a9c0: 7276 6572 2e20 4974 2063 616e 2062 6520  rver. It can be 
-0001a9d0: 696d 706f 7274 6564 2066 726f 6d20 6065  imported from `e
-0001a9e0: 7364 6263 6c69 656e 7460 2c20 616e 6420  sdbclient`, and 
-0001a9f0: 6361 6e20 6265 2063 616c 6c65 6420 7769  can be called wi
-0001aa00: 7468 2074 6865 2073 616d 655c 6e61 7267  th the same\narg
-0001aa10: 756d 656e 7473 2061 7320 6045 7665 6e74  uments as `Event
-0001aa20: 5374 6f72 6544 4243 6c69 656e 7460 2e20  StoreDBClient`. 
-0001aa30: 4974 2073 7570 706f 7274 7320 626f 7468  It supports both
-0001aa40: 2074 6865 2022 6573 6462 2220 616e 6420   the "esdb" and 
-0001aa50: 7468 6520 2265 7364 622b 6469 7363 6f76  the "esdb+discov
-0001aa60: 6572 225c 6e63 6f6e 6e65 6374 696f 6e20  er"\nconnection 
-0001aa70: 7374 7269 6e67 2055 5249 2073 6368 656d  string URI schem
-0001aa80: 6573 2c20 616e 6420 6361 6e20 636f 6e6e  es, and can conn
-0001aa90: 6563 7420 746f 2062 6f74 6820 2273 6563  ect to both "sec
-0001aaa0: 7572 6522 2061 6e64 2022 696e 7365 6375  ure" and "insecu
-0001aab0: 7265 225c 6e45 7665 6e74 5374 6f72 6544  re"\nEventStoreD
-0001aac0: 4220 7365 7276 6572 732e 2049 7420 7265  B servers. It re
-0001aad0: 636f 6e6e 6563 7473 206f 7220 7265 7472  connects or retr
-0001aae0: 6965 7320 7768 656e 2063 6f6e 6e65 6374  ies when connect
-0001aaf0: 696f 6e20 6973 7375 6573 206f 7220 7365  ion issues or se
-0001ab00: 7276 6572 5c6e 6572 726f 7273 2061 7265  rver\nerrors are
-0001ab10: 2065 6e63 6f75 6e74 6572 6564 2e5c 6e5c   encountered.\n\
-0001ab20: 6e60 6060 7079 7468 6f6e 5c6e 6672 6f6d  n```python\nfrom
-0001ab30: 2065 7364 6263 6c69 656e 7420 696d 706f   esdbclient impo
-0001ab40: 7274 2041 7379 6e63 696f 4576 656e 7453  rt AsyncioEventS
-0001ab50: 746f 7265 4442 436c 6965 6e74 5c6e 6060  toreDBClient\n``
-0001ab60: 605c 6e5c 6e54 6865 2061 7379 6e63 6872  `\n\nThe asynchr
-0001ab70: 6f6e 6f75 7320 492f 4f20 636c 6965 6e74  onous I/O client
-0001ab80: 2068 6173 2074 6865 2066 6f6c 6c6f 7769   has the followi
-0001ab90: 6e67 206d 6574 686f 6473 3a20 6061 7070  ng methods: `app
-0001aba0: 656e 645f 746f 5f73 7472 6561 6d28 2960  end_to_stream()`
-0001abb0: 2c5c 6e60 6765 745f 7374 7265 616d 2829  ,\n`get_stream()
-0001abc0: 602c 2060 7265 6164 5f61 6c6c 2829 602c  `, `read_all()`,
-0001abd0: 2060 7375 6273 6372 6962 655f 746f 5f61   `subscribe_to_a
-0001abe0: 6c6c 2829 602c 5c6e 6064 656c 6574 655f  ll()`,\n`delete_
-0001abf0: 7374 7265 616d 2829 602c 2060 746f 6d62  stream()`, `tomb
-0001ac00: 7374 6f6e 655f 7374 7265 616d 2829 602c  stone_stream()`,
-0001ac10: 2061 6e64 2060 7265 636f 6e6e 6563 7428   and `reconnect(
-0001ac20: 2960 2e5c 6e5c 6e54 6865 7365 206d 6574  )`.\n\nThese met
-0001ac30: 686f 6473 2061 7265 2065 7175 6976 616c  hods are equival
-0001ac40: 656e 7420 746f 2074 6865 206d 6574 686f  ent to the metho
-0001ac50: 6473 206f 6e20 6045 7665 6e74 5374 6f72  ds on `EventStor
-0001ac60: 6544 4243 6c69 656e 7460 2e20 5468 6579  eDBClient`. They
-0001ac70: 2068 6176 6520 7468 6520 7361 6d65 5c6e   have the same\n
-0001ac80: 6d65 7468 6f64 2073 6967 6e61 7475 7265  method signature
-0001ac90: 732c 2061 6e64 2063 616e 2062 6520 6361  s, and can be ca
-0001aca0: 6c6c 6564 2077 6974 6820 7468 6520 7361  lled with the sa
-0001acb0: 6d65 2061 7267 756d 656e 7473 2c20 746f  me arguments, to
-0001acc0: 2074 6865 2073 616d 6520 6566 6665 6374   the same effect
-0001acd0: 2e5c 6e54 6865 206d 6574 686f 6473 2077  .\nThe methods w
-0001ace0: 6869 6368 2061 7070 6561 7220 6f6e 2060  hich appear on `
-0001acf0: 4576 656e 7453 746f 7265 4442 436c 6965  EventStoreDBClie
-0001ad00: 6e74 6020 6275 7420 6e6f 7420 6f6e 2060  nt` but not on `
-0001ad10: 4173 796e 6369 6f45 7665 6e74 5374 6f72  AsyncioEventStor
-0001ad20: 6544 4243 6c69 656e 7460 2077 696c 6c20  eDBClient` will 
-0001ad30: 6265 5c6e 6164 6465 6420 736f 6f6e 2e5c  be\nadded soon.\
-0001ad40: 6e5c 6e23 2323 2053 796e 6f70 7369 735c  n\n### Synopsis\
-0001ad50: 6e5c 6e54 6865 2065 7861 6d70 6c65 2062  n\nThe example b
-0001ad60: 656c 6f77 2064 656d 6f6e 7374 7261 7465  elow demonstrate
-0001ad70: 7320 7468 6520 6061 7070 656e 645f 746f  s the `append_to
-0001ad80: 5f73 7472 6561 6d28 2960 2c20 6067 6574  _stream()`, `get
-0001ad90: 5f73 7472 6561 6d28 2960 2061 6e64 5c6e  _stream()` and\n
-0001ada0: 6073 7562 7363 7269 6265 5f74 6f5f 616c  `subscribe_to_al
-0001adb0: 6c28 2960 206d 6574 686f 6473 2e20 5468  l()` methods. Th
-0001adc0: 6573 6520 6172 6520 7468 6520 6d6f 7374  ese are the most
-0001add0: 2075 7365 6675 6c20 6d65 7468 6f64 7320   useful methods 
-0001ade0: 666f 7220 7772 6974 696e 675c 6e61 6e20  for writing\nan 
-0001adf0: 6576 656e 742d 736f 7572 6365 6420 6170  event-sourced ap
-0001ae00: 706c 6963 6174 696f 6e2c 2061 6c6c 6f77  plication, allow
-0001ae10: 696e 6720 6e65 7720 6167 6772 6567 6174  ing new aggregat
-0001ae20: 6520 6576 656e 7473 2074 6f20 6265 2072  e events to be r
-0001ae30: 6563 6f72 6465 642c 2074 6865 5c6e 7265  ecorded, the\nre
-0001ae40: 636f 7264 6564 2065 7665 6e74 7320 6f66  corded events of
-0001ae50: 2061 6e20 6167 6772 6567 6174 6520 746f   an aggregate to
-0001ae60: 2062 6520 6f62 7461 696e 6564 2073 6f20   be obtained so 
-0001ae70: 6167 6772 6567 6174 6573 2063 616e 2062  aggregates can b
-0001ae80: 6520 7265 636f 6e73 7472 7563 7465 642c  e reconstructed,
-0001ae90: 5c6e 616e 6420 7468 6520 7374 6174 6520  \nand the state 
-0001aea0: 6f66 2061 6e20 6170 706c 6963 6174 696f  of an applicatio
-0001aeb0: 6e20 746f 2070 726f 7061 6761 7465 6420  n to propagated 
-0001aec0: 616e 6420 7072 6f63 6573 7365 6420 7769  and processed wi
-0001aed0: 7468 2022 6578 6163 746c 792d 6f6e 6365  th "exactly-once
-0001aee0: 225c 6e73 656d 616e 7469 6373 2e5c 6e5c  "\nsemantics.\n\
-0001aef0: 6e60 6060 7079 7468 6f6e 5c6e 696d 706f  n```python\nimpo
-0001af00: 7274 2061 7379 6e63 696f 5c6e 5c6e 6173  rt asyncio\n\nas
-0001af10: 796e 6320 6465 6620 6465 6d6f 6e73 7472  ync def demonstr
-0001af20: 6174 655f 6173 796e 6369 6f5f 636c 6965  ate_asyncio_clie
-0001af30: 6e74 2829 3a5c 6e5c 6e20 2020 2023 2043  nt():\n\n    # C
-0001af40: 6f6e 7374 7275 6374 2063 6c69 656e 742e  onstruct client.
-0001af50: 5c6e 2020 2020 636c 6965 6e74 203d 2061  \n    client = a
-0001af60: 7761 6974 2041 7379 6e63 696f 4576 656e  wait AsyncioEven
-0001af70: 7453 746f 7265 4442 436c 6965 6e74 285c  tStoreDBClient(\
-0001af80: 6e20 2020 2020 2020 2075 7269 3d6f 732e  n        uri=os.
-0001af90: 6765 7465 6e76 2822 4553 4442 5f55 5249  getenv("ESDB_URI
-0001afa0: 2229 2c5c 6e20 2020 2020 2020 2072 6f6f  "),\n        roo
-0001afb0: 745f 6365 7274 6966 6963 6174 6573 3d6f  t_certificates=o
-0001afc0: 732e 6765 7465 6e76 2822 4553 4442 5f52  s.getenv("ESDB_R
-0001afd0: 4f4f 545f 4345 5254 4946 4943 4154 4553  OOT_CERTIFICATES
-0001afe0: 2229 2c5c 6e20 2020 2029 5c6e 5c6e 2020  "),\n    )\n\n  
-0001aff0: 2020 2320 4170 7065 6e64 2065 7665 6e74    # Append event
-0001b000: 732e 5c6e 2020 2020 7374 7265 616d 5f6e  s.\n    stream_n
-0001b010: 616d 6520 3d20 7374 7228 7575 6964 2e75  ame = str(uuid.u
-0001b020: 7569 6434 2829 295c 6e20 2020 2065 7665  uid4())\n    eve
-0001b030: 6e74 3120 3d20 4e65 7745 7665 6e74 2822  nt1 = NewEvent("
-0001b040: 4f72 6465 7243 7265 6174 6564 222c 2064  OrderCreated", d
-0001b050: 6174 613d 625c 277b 7d5c 2729 5c6e 2020  ata=b\'{}\')\n  
-0001b060: 2020 6576 656e 7432 203d 204e 6577 4576    event2 = NewEv
-0001b070: 656e 7428 224f 7264 6572 5570 6461 7465  ent("OrderUpdate
-0001b080: 6422 2c20 6461 7461 3d62 5c27 7b7d 5c27  d", data=b\'{}\'
-0001b090: 295c 6e20 2020 2065 7665 6e74 3320 3d20  )\n    event3 = 
-0001b0a0: 4e65 7745 7665 6e74 2822 4f72 6465 7244  NewEvent("OrderD
-0001b0b0: 656c 6574 6564 222c 2064 6174 613d 625c  eleted", data=b\
-0001b0c0: 277b 7d5c 2729 5c6e 5c6e 2020 2020 636f  '{}\')\n\n    co
-0001b0d0: 6d6d 6974 5f70 6f73 6974 696f 6e20 3d20  mmit_position = 
-0001b0e0: 6177 6169 7420 636c 6965 6e74 2e61 7070  await client.app
-0001b0f0: 656e 645f 746f 5f73 7472 6561 6d28 5c6e  end_to_stream(\n
-0001b100: 2020 2020 2020 2020 7374 7265 616d 5f6e          stream_n
-0001b110: 616d 653d 7374 7265 616d 5f6e 616d 652c  ame=stream_name,
-0001b120: 5c6e 2020 2020 2020 2020 6375 7272 656e  \n        curren
-0001b130: 745f 7665 7273 696f 6e3d 5374 7265 616d  t_version=Stream
-0001b140: 5374 6174 652e 4e4f 5f53 5452 4541 4d2c  State.NO_STREAM,
-0001b150: 5c6e 2020 2020 2020 2020 6576 656e 7473  \n        events
-0001b160: 3d5b 6576 656e 7431 2c20 6576 656e 7432  =[event1, event2
-0001b170: 2c20 6576 656e 7433 5d5c 6e20 2020 2029  , event3]\n    )
-0001b180: 5c6e 5c6e 2020 2020 2320 5265 6164 2073  \n\n    # Read s
-0001b190: 7472 6561 6d20 6576 656e 7473 2e5c 6e20  tream events.\n 
-0001b1a0: 2020 2072 6563 6f72 6465 6420 3d20 6177     recorded = aw
-0001b1b0: 6169 7420 636c 6965 6e74 2e67 6574 5f73  ait client.get_s
-0001b1c0: 7472 6561 6d28 7374 7265 616d 5f6e 616d  tream(stream_nam
-0001b1d0: 6529 5c6e 2020 2020 6173 7365 7274 206c  e)\n    assert l
-0001b1e0: 656e 2872 6563 6f72 6465 6429 203d 3d20  en(recorded) == 
-0001b1f0: 335c 6e20 2020 2061 7373 6572 7420 7265  3\n    assert re
-0001b200: 636f 7264 6564 5b30 5d2e 6964 203d 3d20  corded[0].id == 
-0001b210: 6576 656e 7431 2e69 645c 6e20 2020 2061  event1.id\n    a
-0001b220: 7373 6572 7420 7265 636f 7264 6564 5b31  ssert recorded[1
-0001b230: 5d2e 6964 203d 3d20 6576 656e 7432 2e69  ].id == event2.i
-0001b240: 645c 6e20 2020 2061 7373 6572 7420 7265  d\n    assert re
-0001b250: 636f 7264 6564 5b32 5d2e 6964 203d 3d20  corded[2].id == 
-0001b260: 6576 656e 7433 2e69 645c 6e5c 6e5c 6e20  event3.id\n\n\n 
-0001b270: 2020 2023 2053 7562 7363 7269 6265 2061     # Subscribe a
-0001b280: 6c6c 2065 7665 6e74 732e 5c6e 2020 2020  ll events.\n    
-0001b290: 7265 6365 6976 6564 203d 205b 5d5c 6e20  received = []\n 
-0001b2a0: 2020 2061 7379 6e63 2066 6f72 2065 7665     async for eve
-0001b2b0: 6e74 2069 6e20 6177 6169 7420 636c 6965  nt in await clie
-0001b2c0: 6e74 2e73 7562 7363 7269 6265 5f74 6f5f  nt.subscribe_to_
-0001b2d0: 616c 6c28 293a 5c6e 2020 2020 2020 2020  all():\n        
-0001b2e0: 7265 6365 6976 6564 2e61 7070 656e 6428  received.append(
-0001b2f0: 6576 656e 7429 5c6e 2020 2020 2020 2020  event)\n        
-0001b300: 6966 2065 7665 6e74 2e63 6f6d 6d69 745f  if event.commit_
-0001b310: 706f 7369 7469 6f6e 203d 3d20 636f 6d6d  position == comm
-0001b320: 6974 5f70 6f73 6974 696f 6e3a 5c6e 2020  it_position:\n  
-0001b330: 2020 2020 2020 2020 2020 6272 6561 6b5c            break\
-0001b340: 6e20 2020 2061 7373 6572 7420 7265 6365  n    assert rece
-0001b350: 6976 6564 5b2d 335d 2e69 6420 3d3d 2065  ived[-3].id == e
-0001b360: 7665 6e74 312e 6964 5c6e 2020 2020 6173  vent1.id\n    as
-0001b370: 7365 7274 2072 6563 6569 7665 645b 2d32  sert received[-2
-0001b380: 5d2e 6964 203d 3d20 6576 656e 7432 2e69  ].id == event2.i
-0001b390: 645c 6e20 2020 2061 7373 6572 7420 7265  d\n    assert re
-0001b3a0: 6365 6976 6564 5b2d 315d 2e69 6420 3d3d  ceived[-1].id ==
-0001b3b0: 2065 7665 6e74 332e 6964 5c6e 5c6e 5c6e   event3.id\n\n\n
-0001b3c0: 2020 2020 2320 436c 6f73 6520 7468 6520      # Close the 
-0001b3d0: 636c 6965 6e74 2e5c 6e20 2020 2061 7761  client.\n    awa
-0001b3e0: 6974 2063 6c69 656e 742e 636c 6f73 6528  it client.close(
-0001b3f0: 295c 6e5c 6e5c 6e23 2052 756e 2074 6865  )\n\n\n# Run the
-0001b400: 2064 656d 6f2e 5c6e 6173 796e 6369 6f2e   demo.\nasyncio.
-0001b410: 6765 745f 6576 656e 745f 6c6f 6f70 2829  get_event_loop()
-0001b420: 2e72 756e 5f75 6e74 696c 5f63 6f6d 706c  .run_until_compl
-0001b430: 6574 6528 5c6e 2020 2020 6465 6d6f 6e73  ete(\n    demons
-0001b440: 7472 6174 655f 6173 796e 6369 6f5f 636c  trate_asyncio_cl
-0001b450: 6965 6e74 2829 5c6e 295c 6e60 6060 5c6e  ient()\n)\n```\n
-0001b460: 5c6e 2323 204e 6f74 6573 5c6e 5c6e 2323  \n## Notes\n\n##
-0001b470: 2320 5265 6775 6c61 7220 6578 7072 6573  # Regular expres
-0001b480: 7369 6f6e 2066 696c 7465 7273 5c6e 5c6e  sion filters\n\n
-0001b490: 5468 6520 6072 6561 645f 616c 6c28 2960  The `read_all()`
-0001b4a0: 2c20 6073 7562 7363 7269 6265 5f74 6f5f  , `subscribe_to_
-0001b4b0: 616c 6c28 2960 2c20 6063 7265 6174 655f  all()`, `create_
-0001b4c0: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
-0001b4d0: 616c 6c28 2960 5c6e 616e 6420 6067 6574  all()`\nand `get
-0001b4e0: 5f63 6f6d 6d69 745f 706f 7369 7469 6f6e  _commit_position
-0001b4f0: 2829 6020 6d65 7468 6f64 7320 6861 7665  ()` methods have
-0001b500: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
-0001b510: 6020 616e 6420 6066 696c 7465 725f 696e  ` and `filter_in
-0001b520: 636c 7564 6560 5c6e 6172 6775 6d65 6e74  clude`\nargument
-0001b530: 732e 2054 6869 7320 7365 6374 696f 6e20  s. This section 
-0001b540: 7072 6f76 6964 6573 2073 6f6d 6520 6d6f  provides some mo
-0001b550: 7265 2064 6574 6169 6c73 2061 626f 7574  re details about
-0001b560: 2074 6865 2076 616c 7565 7320 6f66 2074   the values of t
-0001b570: 6865 7365 5c6e 6172 6775 6d65 6e74 732e  hese\narguments.
-0001b580: 5c6e 5c6e 5468 6520 6669 7273 7420 7468  \n\nThe first th
-0001b590: 696e 6720 746f 206e 6f74 6520 6973 2074  ing to note is t
-0001b5a0: 6861 7420 7468 6573 6520 6172 6775 6d65  hat these argume
-0001b5b0: 6e74 7320 6172 6520 7365 7175 656e 6365  nts are sequence
-0001b5c0: 7320 6f66 2072 6567 756c 6172 2065 7870  s of regular exp
-0001b5d0: 7265 7373 696f 6e73 2e5c 6e54 6865 7920  ressions.\nThey 
-0001b5e0: 6172 6520 636f 6e63 6174 656e 6174 6564  are concatenated
-0001b5f0: 2074 6f67 6574 6865 7220 6279 2074 6865   together by the
-0001b600: 2063 6c69 656e 7420 6173 2062 7261 636b   client as brack
-0001b610: 6574 6564 2061 6c74 6572 6e61 7469 7665  eted alternative
-0001b620: 7320 696e 2061 206c 6172 6765 725c 6e72  s in a larger\nr
-0001b630: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-0001b640: 6e20 7468 6174 2069 7320 616e 6368 6f72  n that is anchor
-0001b650: 6564 2074 6f20 7468 6520 7374 6172 7420  ed to the start 
-0001b660: 616e 6420 656e 6420 6f66 2074 6865 2073  and end of the s
-0001b670: 7472 696e 6773 2062 6569 6e67 5c6e 6d61  trings being\nma
-0001b680: 7463 6865 642e 2053 6f20 796f 7520 7368  tched. So you sh
-0001b690: 6f75 6c64 6e5c 2774 2069 6e63 6c75 6465  ouldn\'t include
-0001b6a0: 2074 6865 2060 5c27 5e5c 2760 2061 6e64   the `\'^\'` and
-0001b6b0: 2060 5c27 245c 2760 2061 6e63 686f 7220   `\'$\'` anchor 
-0001b6c0: 6368 6172 6163 7465 7273 2c20 756e 6c65  characters, unle
-0001b6d0: 7373 5c6e 7468 6573 6520 6368 6172 6163  ss\nthese charac
-0001b6e0: 7465 7273 2061 7265 2065 7363 6170 6564  ters are escaped
-0001b6f0: 2061 7320 6c69 7465 7261 6c20 6368 6172   as literal char
-0001b700: 6163 7465 7273 2074 6f20 6265 206d 6174  acters to be mat
-0001b710: 6368 6564 2e20 4275 7420 796f 7520 7368  ched. But you sh
-0001b720: 6f75 6c64 5c6e 7573 6520 7769 6c64 6361  ould\nuse wildca
-0001b730: 7264 7320 6966 2079 6f75 2077 616e 7420  rds if you want 
-0001b740: 746f 206d 6174 6368 2073 7562 7374 7269  to match substri
-0001b750: 6e67 732c 2066 6f72 2065 7861 6d70 6c65  ngs, for example
-0001b760: 2060 5c27 2e2a 536e 6170 7368 6f74 5c27   `\'.*Snapshot\'
-0001b770: 6020 746f 206d 6174 6368 5c6e 616c 6c20  ` to match\nall 
-0001b780: 7374 7269 6e67 7320 7468 6174 2065 6e64  strings that end
-0001b790: 2077 6974 6820 605c 2753 6e61 7073 686f   with `\'Snapsho
-0001b7a0: 7460 5c27 2e5c 6e5c 6e49 6e20 616c 6c20  t`\'.\n\nIn all 
-0001b7b0: 6d65 7468 6f64 732c 2074 6865 2064 6566  methods, the def
-0001b7c0: 6175 6c74 2076 616c 7565 206f 6620 7468  ault value of th
-0001b7d0: 6520 6066 696c 7465 725f 6578 636c 7564  e `filter_exclud
-0001b7e0: 6560 2061 7267 756d 656e 7420 6973 2074  e` argument is t
-0001b7f0: 6865 2063 6f6e 7374 616e 745c 6e60 4445  he constant\n`DE
-0001b800: 4641 554c 545f 4558 434c 5544 455f 4649  FAULT_EXCLUDE_FI
-0001b810: 4c54 4552 602c 2077 6869 6368 2069 7320  LTER`, which is 
-0001b820: 6465 7369 676e 6564 2074 6f20 6578 636c  designed to excl
-0001b830: 7564 6520 4576 656e 7453 746f 7265 4442  ude EventStoreDB
-0001b840: 2022 7379 7374 656d 2220 616e 645c 6e22   "system" and\n"
-0001b850: 7065 7273 6973 7465 6e63 6520 7375 6273  persistence subs
-0001b860: 6372 6970 7469 6f6e 2063 6f6e 6669 6722  cription config"
-0001b870: 2065 7665 6e74 2074 7970 6573 2c20 7768   event types, wh
-0001b880: 6963 6820 6f74 6865 7277 6973 6520 776f  ich otherwise wo
-0001b890: 756c 6420 6265 2069 6e63 6c75 6465 642e  uld be included.
-0001b8a0: 5c6e 5c6e 5379 7374 656d 2065 7665 6e74  \n\nSystem event
-0001b8b0: 7320 6765 6e65 7261 7465 6420 6279 2045  s generated by E
-0001b8c0: 7665 6e74 5374 6f72 6544 4220 6861 7665  ventStoreDB have
-0001b8d0: 2060 7479 7065 6020 7374 7269 6e67 7320   `type` strings 
-0001b8e0: 7468 6174 2073 7461 7274 2077 6974 685c  that start with\
-0001b8f0: 6e74 6865 2060 2460 2073 6967 6e2e 2050  nthe `$` sign. P
-0001b900: 6572 7369 7374 656e 6365 2073 7562 7363  ersistence subsc
-0001b910: 7269 7074 696f 6e20 6576 656e 7473 2067  ription events g
-0001b920: 656e 6572 6174 6564 2077 6865 6e20 6d61  enerated when ma
-0001b930: 6e69 7075 6c61 7469 6e67 5c6e 7065 7273  nipulating\npers
-0001b940: 6973 7465 6e63 6520 7375 6273 6372 6970  istence subscrip
-0001b950: 7469 6f6e 7320 6861 7665 2060 7479 7065  tions have `type
-0001b960: 6020 7374 7269 6e67 7320 7468 6174 2073  ` strings that s
-0001b970: 7461 7274 2077 6974 6820 6050 6572 7369  tart with `Persi
-0001b980: 7374 656e 7443 6f6e 6669 6760 2e5c 6e5c  stentConfig`.\n\
-0001b990: 6e46 6f72 2065 7861 6d70 6c65 2c20 746f  nFor example, to
-0001b9a0: 206d 6174 6368 2074 6865 2074 7970 6520   match the type 
-0001b9b0: 6f66 2045 7665 6e74 5374 6f72 6544 4220  of EventStoreDB 
-0001b9c0: 7379 7374 656d 2065 7665 6e74 732c 2075  system events, u
-0001b9d0: 7365 2074 6865 2072 6567 756c 6172 5c6e  se the regular\n
-0001b9e0: 6578 7072 6573 7369 6f6e 2073 7472 696e  expression strin
-0001b9f0: 6720 6072 5c27 5c5c 242e 2b5c 2760 2e20  g `r\'\\$.+\'`. 
-0001ba00: 506c 6561 7365 206e 6f74 652c 2074 6865  Please note, the
-0001ba10: 2063 6f6e 7374 616e 7420 6045 5344 425f   constant `ESDB_
-0001ba20: 5359 5354 454d 5f45 5645 4e54 535f 5245  SYSTEM_EVENTS_RE
-0001ba30: 4745 5860 2069 735c 6e73 6574 2074 6f20  GEX` is\nset to 
-0001ba40: 7468 6973 2076 616c 7565 2e20 596f 7520  this value. You 
-0001ba50: 6361 6e20 696d 706f 7274 2074 6869 7320  can import this 
-0001ba60: 636f 6e73 7461 6e74 2066 726f 6d20 6065  constant from `e
-0001ba70: 7364 6263 6c69 656e 7460 2061 6e64 2075  sdbclient` and u
-0001ba80: 7365 2069 7420 7768 656e 5c6e 6275 696c  se it when\nbuil
-0001ba90: 6469 6e67 206c 6f6e 6765 7220 7365 7175  ding longer sequ
-0001baa0: 656e 6365 7320 6f66 2072 6567 756c 6172  ences of regular
-0001bab0: 2065 7870 7265 7373 696f 6e73 2e5c 6e5c   expressions.\n\
-0001bac0: 6e53 696d 696c 6172 6c79 2c20 746f 206d  nSimilarly, to m
-0001bad0: 6174 6368 2074 6865 2074 7970 6520 6f66  atch the type of
-0001bae0: 2045 7665 6e74 5374 6f72 6544 4220 7065   EventStoreDB pe
-0001baf0: 7273 6973 7465 6e63 6520 7375 6273 6372  rsistence subscr
-0001bb00: 6970 7469 6f6e 2065 7665 6e74 732c 2075  iption events, u
-0001bb10: 7365 2074 6865 5c6e 7265 6775 6c61 7220  se the\nregular 
-0001bb20: 6578 7072 6573 7369 6f6e 2060 725c 2750  expression `r\'P
-0001bb30: 6572 7369 7374 656e 7443 6f6e 6669 675c  ersistentConfig\
-0001bb40: 5c64 2b5c 2760 2e20 5468 6520 636f 6e73  \d+\'`. The cons
-0001bb50: 7461 6e74 2060 4553 4442 5f50 4552 5349  tant `ESDB_PERSI
-0001bb60: 5354 454e 545f 434f 4e46 4947 5f45 5645  STENT_CONFIG_EVE
-0001bb70: 4e54 535f 5245 4745 5860 5c6e 6973 2073  NTS_REGEX`\nis s
-0001bb80: 6574 2074 6f20 7468 6973 2076 616c 7565  et to this value
-0001bb90: 2e20 596f 7520 6361 6e20 696d 706f 7274  . You can import
-0001bba0: 2074 6869 7320 636f 6e73 7461 6e74 2066   this constant f
-0001bbb0: 726f 6d20 6065 7364 6263 6c69 656e 7460  rom `esdbclient`
-0001bbc0: 2020 616e 6420 7573 6520 6974 2077 6865    and use it whe
-0001bbd0: 6e5c 6e62 7569 6c64 696e 6720 6c6f 6e67  n\nbuilding long
-0001bbe0: 6572 2073 6571 7565 6e63 6573 206f 6620  er sequences of 
-0001bbf0: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
-0001bc00: 6f6e 732e 5c6e 5c6e 5468 6520 636f 6e73  ons.\n\nThe cons
-0001bc10: 7461 6e74 2060 4445 4641 554c 545f 4558  tant `DEFAULT_EX
-0001bc20: 434c 5544 455f 4649 4c54 4552 6020 6973  CLUDE_FILTER` is
-0001bc30: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
-0001bc40: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-0001bc50: 6e73 2074 6861 7420 696e 636c 7564 6573  ns that includes
-0001bc60: 5c6e 626f 7468 2060 4553 4442 5f53 5953  \nboth `ESDB_SYS
-0001bc70: 5445 4d5f 4556 454e 5453 5f52 4547 4558  TEM_EVENTS_REGEX
-0001bc80: 6020 616e 6420 6045 5344 425f 5045 5253  ` and `ESDB_PERS
-0001bc90: 4953 5445 4e54 5f43 4f4e 4649 475f 4556  ISTENT_CONFIG_EV
-0001bca0: 454e 5453 5f52 4547 4558 602e 2049 7420  ENTS_REGEX`. It 
-0001bcb0: 6973 2075 7365 645c 6e61 7320 7468 6520  is used\nas the 
-0001bcc0: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
-0001bcd0: 2060 6669 6c74 6572 5f65 7863 6c75 6465   `filter_exclude
-0001bce0: 6020 736f 2074 6861 7420 7468 6520 6576  ` so that the ev
-0001bcf0: 656e 7473 2074 6861 7420 4576 656e 7453  ents that EventS
-0001bd00: 746f 7265 4442 2067 656e 6572 6174 6573  toreDB generates
-0001bd10: 5c6e 696e 7465 726e 616c 6c79 2061 7265  \ninternally are
-0001bd20: 2065 7863 6c75 6465 6420 6279 2064 6566   excluded by def
-0001bd30: 6175 6c74 2e5c 6e5c 6e46 6f72 2065 7861  ault.\n\nFor exa
-0001bd40: 6d70 6c65 2c20 6966 2079 6f75 2077 616e  mple, if you wan
-0001bd50: 7420 746f 2065 7863 6c75 6465 2073 6e61  t to exclude sna
-0001bd60: 7073 686f 7473 2061 6e64 2073 7973 7465  pshots and syste
-0001bd70: 6d20 6576 656e 7473 2061 6e64 2070 6572  m events and per
-0001bd80: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
-0001bd90: 7469 6f6e 5c6e 6576 656e 7473 2c20 7468  tion\nevents, th
-0001bda0: 656e 2079 6f75 206d 6179 2077 6973 6820  en you may wish 
-0001bdb0: 746f 2075 7365 2061 2061 7070 726f 7072  to use a appropr
-0001bdc0: 6961 7465 6c79 2065 7874 656e 6465 6420  iately extended 
-0001bdd0: 636f 7079 206f 6620 6044 4546 4155 4c54  copy of `DEFAULT
-0001bde0: 5f45 5843 4c55 4445 5f46 494c 5445 5260  _EXCLUDE_FILTER`
-0001bdf0: 5c6e 6173 2074 6865 2076 616c 7565 206f  \nas the value o
-0001be00: 6620 7468 6520 6066 696c 7465 725f 6578  f the `filter_ex
-0001be10: 636c 7564 6560 2061 7267 756d 656e 7473  clude` arguments
-0001be20: 2c20 7375 6368 2061 7320 6044 4546 4155  , such as `DEFAU
-0001be30: 4c54 5f45 5843 4c55 4445 5f46 494c 5445  LT_EXCLUDE_FILTE
-0001be40: 5220 2b20 5b5c 272e 2a53 6e61 7073 686f  R + [\'.*Snapsho
-0001be50: 745c 275d 602e 5c6e 5c6e 5c6e 2323 2320  t\']`.\n\n\n### 
-0001be60: 5265 636f 6e6e 6563 7420 616e 6420 7265  Reconnect and re
-0001be70: 7472 7920 6d65 7468 6f64 2064 6563 6f72  try method decor
-0001be80: 6174 6f72 735c 6e5c 6e50 6c65 6173 6520  ators\n\nPlease 
-0001be90: 6e6f 7465 2c20 6e65 6172 6c79 2061 6c6c  note, nearly all
-0001bea0: 2074 6865 2063 6c69 656e 7420 6d65 7468   the client meth
-0001beb0: 6f64 7320 6172 6520 6465 636f 7261 7465  ods are decorate
-0001bec0: 6420 7769 7468 2074 6865 2060 4061 7574  d with the `@aut
-0001bed0: 6f72 6563 6f6e 6e65 6374 6020 616e 645c  oreconnect` and\
-0001bee0: 6e74 6865 2060 4072 6574 7279 6772 7063  nthe `@retrygrpc
-0001bef0: 6020 6465 636f 7261 746f 7273 2e5c 6e5c  ` decorators.\n\
-0001bf00: 6e54 6865 2060 4061 7574 6f72 6563 6f6e  nThe `@autorecon
-0001bf10: 6e65 6374 6020 6465 636f 7261 746f 7220  nect` decorator 
-0001bf20: 7769 6c6c 2072 6563 6f6e 6e65 6374 2074  will reconnect t
-0001bf30: 6f20 6120 7375 6974 6162 6c65 206e 6f64  o a suitable nod
-0001bf40: 6520 696e 2074 6865 2063 6c75 7374 6572  e in the cluster
-0001bf50: 2077 6865 6e5c 6e74 6865 2073 6572 7665   when\nthe serve
-0001bf60: 7220 746f 2077 6869 6368 2074 6865 2063  r to which the c
-0001bf70: 6c69 656e 7420 6861 7320 6265 656e 2063  lient has been c
-0001bf80: 6f6e 6e65 6374 6564 2068 6173 2062 6563  onnected has bec
-0001bf90: 6f6d 6520 756e 6176 6169 6c61 626c 652c  ome unavailable,
-0001bfa0: 206f 7220 7768 656e 2074 6865 5c6e 636c   or when the\ncl
-0001bfb0: 6965 6e74 5c27 7320 6752 5043 2063 6861  ient\'s gRPC cha
-0001bfc0: 6e6e 656c 2068 6170 7065 6e73 2074 6f20  nnel happens to 
-0001bfd0: 6861 7665 2062 6565 6e20 636c 6f73 6564  have been closed
-0001bfe0: 2e20 5468 6520 636c 6965 6e74 2077 696c  . The client wil
-0001bff0: 6c20 616c 736f 2072 6563 6f6e 6e65 6374  l also reconnect
-0001c000: 2077 6865 6e5c 6e61 206d 6574 686f 6420   when\na method 
-0001c010: 6973 2063 616c 6c65 6420 7468 6174 2072  is called that r
-0001c020: 6571 7569 7265 7320 6120 6c65 6164 6572  equires a leader
-0001c030: 2c20 616e 6420 7468 6520 636c 6965 6e74  , and the client
-0001c040: 5c27 7320 6e6f 6465 2070 7265 6665 7265  \'s node prefere
-0001c050: 6e63 6520 6973 2074 6f20 6265 5c6e 636f  nce is to be\nco
-0001c060: 6e6e 6563 7465 6420 746f 2061 206c 6561  nnected to a lea
-0001c070: 6465 722c 2062 7574 2074 6865 206e 6f64  der, but the nod
-0001c080: 6520 7468 6174 2074 6865 2063 6c69 656e  e that the clien
-0001c090: 7420 6861 7320 6265 656e 2063 6f6e 6e65  t has been conne
-0001c0a0: 6374 6564 2074 6f20 7374 6f70 7320 6265  cted to stops be
-0001c0b0: 696e 675c 6e74 6865 206c 6561 6465 722e  ing\nthe leader.
-0001c0c0: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
-0001c0d0: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
-0001c0e0: 6563 6f6e 6e65 6374 2074 6f20 7468 6520  econnect to the 
-0001c0f0: 6375 7272 656e 7420 6c65 6164 6572 2e20  current leader. 
-0001c100: 4166 7465 725c 6e72 6563 6f6e 6e65 6374  After\nreconnect
-0001c110: 696e 672c 2074 6865 2066 6169 6c65 6420  ing, the failed 
-0001c120: 6f70 6572 6174 696f 6e20 7769 6c6c 2062  operation will b
-0001c130: 6520 7265 7472 6965 642e 5c6e 5c6e 5468  e retried.\n\nTh
-0001c140: 6520 6040 7265 7472 7967 7270 6360 2064  e `@retrygrpc` d
-0001c150: 6563 6f72 6174 6f72 2072 6574 7269 6573  ecorator retries
-0001c160: 206f 7065 7261 7469 6f6e 7320 7468 6174   operations that
-0001c170: 2068 6176 6520 6661 696c 6564 2064 7565   have failed due
-0001c180: 2074 6f20 6120 6465 6164 6c69 6e65 2062   to a deadline b
-0001c190: 6569 6e67 5c6e 7265 6163 6865 6420 2873  eing\nreached (s
-0001c1a0: 6f20 7468 6174 2074 6865 206f 7065 7261  o that the opera
-0001c1b0: 7469 6f6e 2074 696d 6573 206f 7574 292c  tion times out),
-0001c1c0: 2061 6e64 2069 6e20 6361 7365 2074 6865   and in case the
-0001c1d0: 2073 6572 7665 7220 7468 726f 7773 2061   server throws a
-0001c1e0: 6e20 6578 6365 7074 696f 6e5c 6e77 6865  n exception\nwhe
-0001c1f0: 6e20 6861 6e64 6c69 6e67 2061 2063 6c69  n handling a cli
-0001c200: 656e 7420 7265 7175 6573 742e 5c6e 5c6e  ent request.\n\n
-0001c210: 506c 6561 7365 2061 6c73 6f20 6e6f 7465  Please also note
-0001c220: 2c20 7468 6520 6173 7065 6374 7320 6e6f  , the aspects no
-0001c230: 7420 636f 7665 7265 6420 6279 2074 6865  t covered by the
-0001c240: 2072 6563 6f6e 6e65 6374 2061 6e64 2072   reconnect and r
-0001c250: 6574 7279 2064 6563 6f72 6174 6f72 5c6e  etry decorator\n
-0001c260: 6265 6861 7669 6f75 7273 2068 6176 6520  behaviours have 
-0001c270: 746f 2064 6f20 7769 7468 206d 6574 686f  to do with metho
-0001c280: 6473 2074 6861 7420 7265 7475 726e 2069  ds that return i
-0001c290: 7465 7261 746f 7273 2e20 466f 7220 6578  terators. For ex
-0001c2a0: 616d 706c 652c 2063 6f6e 7369 6465 725c  ample, consider\
-0001c2b0: 6e74 6865 2022 7265 6164 2072 6573 706f  nthe "read respo
-0001c2c0: 6e73 6522 2069 7465 7261 746f 7220 7265  nse" iterator re
-0001c2d0: 7475 726e 6564 2066 726f 6d20 7468 6520  turned from the 
-0001c2e0: 6072 6561 645f 616c 6c28 2960 206d 6574  `read_all()` met
-0001c2f0: 686f 642e 2054 6865 5c6e 6072 6561 645f  hod. The\n`read_
-0001c300: 616c 6c28 2960 206d 6574 686f 6420 7769  all()` method wi
-0001c310: 6c6c 2068 6176 6520 7265 7475 726e 6564  ll have returned
-0001c320: 2c20 616e 6420 7468 6520 6d65 7468 6f64  , and the method
-0001c330: 2064 6563 6f72 6174 6f72 7320 7769 6c6c   decorators will
-0001c340: 2074 6865 7265 666f 7265 5c6e 6861 7665   therefore\nhave
-0001c350: 2065 7869 7465 642c 2062 6566 6f72 6520   exited, before 
-0001c360: 6974 6572 6174 696e 6720 6f76 6572 2074  iterating over t
-0001c370: 6865 2022 7265 6164 2072 6573 706f 6e73  he "read respons
-0001c380: 6522 2062 6567 696e 732e 2054 6865 7265  e" begins. There
-0001c390: 666f 7265 2c20 6966 2061 5c6e 636f 6e6e  fore, if a\nconn
-0001c3a0: 6563 7469 6f6e 2069 7373 7565 7320 6f63  ection issues oc
-0001c3b0: 6375 7273 2077 6869 6c73 7420 6974 6572  curs whilst iter
-0001c3c0: 6174 696e 6720 6f76 6572 2074 6865 2022  ating over the "
-0001c3d0: 7265 6164 2072 6573 706f 6e73 6522 2c20  read response", 
-0001c3e0: 6974 2069 736e 5c27 7420 706f 7373 6962  it isn\'t possib
-0001c3f0: 6c65 5c6e 666f 7220 616e 7920 6465 636f  le\nfor any deco
-0001c400: 7261 746f 7220 6f6e 2074 6865 2060 7265  rator on the `re
-0001c410: 6164 5f61 6c6c 2829 6020 6d65 7468 6f64  ad_all()` method
-0001c420: 2074 6f20 7472 6967 6765 7220 6120 7265   to trigger a re
-0001c430: 636f 6e6e 6563 7469 6f6e 2e5c 6e5c 6e57  connection.\n\nW
-0001c440: 6974 6820 7468 6520 2263 6174 6368 2d75  ith the "catch-u
-0001c450: 7020 7375 6273 6372 6970 7469 6f6e 2220  p subscription" 
-0001c460: 6f62 6a65 6374 732c 2074 6865 7265 2069  objects, there i
-0001c470: 7320 616e 2069 6e69 7469 616c 2022 636f  s an initial "co
-0001c480: 6e66 6972 6d61 7469 6f6e 2220 7265 7370  nfirmation" resp
-0001c490: 6f6e 7365 5c6e 6672 6f6d 2074 6865 2073  onse\nfrom the s
-0001c4a0: 6572 7665 7220 7768 6963 6820 6973 2072  erver which is r
-0001c4b0: 6563 6569 7665 6420 616e 6420 6368 6563  eceived and chec
-0001c4c0: 6b65 6420 6279 2074 6865 2063 6c69 656e  ked by the clien
-0001c4d0: 742e 2041 6e64 2073 6f2c 2077 6865 6e20  t. And so, when 
-0001c4e0: 6120 6361 6c6c 2069 735c 6e6d 6164 6520  a call is\nmade 
-0001c4f0: 746f 2060 7375 6273 6372 6962 655f 746f  to `subscribe_to
-0001c500: 5f61 6c6c 2829 6020 6f72 2060 7375 6273  _all()` or `subs
-0001c510: 6372 6962 655f 746f 5f73 7472 6561 6d28  cribe_to_stream(
-0001c520: 2960 2c20 6966 2074 6865 2073 6572 7665  )`, if the serve
-0001c530: 7220 6973 2075 6e61 7661 696c 6162 6c65  r is unavailable
-0001c540: 2c5c 6e6f 7220 6966 2074 6865 2063 6861  ,\nor if the cha
-0001c550: 6e6e 656c 2068 6173 2073 6f6d 6568 6f77  nnel has somehow
-0001c560: 2062 6565 6e20 636c 6f73 6564 2c20 6f72   been closed, or
-0001c570: 2069 6620 7468 6520 7265 7175 6573 7420   if the request 
-0001c580: 6661 696c 7320 666f 7220 736f 6d65 206f  fails for some o
-0001c590: 7468 6572 2072 6561 736f 6e2c 5c6e 7468  ther reason,\nth
-0001c5a0: 656e 2074 6865 2063 6c69 656e 7420 7769  en the client wi
-0001c5b0: 6c6c 2072 6563 6f6e 6e65 6374 2061 6e64  ll reconnect and
-0001c5c0: 2072 6574 7279 2e20 486f 7765 7665 722c   retry. However,
-0001c5d0: 2069 6620 616e 2065 7863 6570 7469 6f6e   if an exception
-0001c5e0: 2069 7320 7261 6973 6564 2077 6865 6e20   is raised when 
-0001c5f0: 6974 6572 6174 696e 6720 6f76 6572 2061  iterating over a
-0001c600: 5c6e 7375 6363 6573 7366 756c 6c79 2072  \nsuccessfully r
-0001c610: 6574 7572 6e65 6420 2263 6174 6368 2d75  eturned "catch-u
-0001c620: 7020 7375 6273 6372 6970 7469 6f6e 2220  p subscription" 
-0001c630: 6f62 6a65 6374 2c20 7468 6520 6361 7463  object, the catc
-0001c640: 682d 7570 2073 7562 7363 7269 7074 696f  h-up subscriptio
-0001c650: 6e20 7769 6c6c 5c6e 6e65 6564 2074 6f20  n will\nneed to 
-0001c660: 6265 2072 6573 7461 7274 6564 2e20 5369  be restarted. Si
-0001c670: 6d69 6c61 726c 792c 2077 6865 6e20 7265  milarly, when re
-0001c680: 6164 696e 6720 7065 7273 6973 7465 6e74  ading persistent
-0001c690: 2073 7562 7363 7269 7074 696f 6e73 2c20   subscriptions, 
-0001c6a0: 6966 2074 6865 7265 2061 7265 5c6e 636f  if there are\nco
-0001c6b0: 6e6e 6563 7469 6f6e 2069 7373 7565 7320  nnection issues 
-0001c6c0: 7768 696c 7374 2069 7465 7261 7469 6e67  whilst iterating
-0001c6d0: 206f 7665 7220 6120 7375 6363 6573 7366   over a successf
-0001c6e0: 756c 6c79 2072 6563 6569 7665 6420 7265  ully received re
-0001c6f0: 7370 6f6e 7365 2c20 7468 6520 636f 6e73  sponse, the cons
-0001c700: 756d 6572 5c6e 7769 6c6c 206e 6565 6420  umer\nwill need 
-0001c710: 746f 2062 6520 7265 7374 6172 7465 642e  to be restarted.
-0001c720: 5c6e 5c6e 5c6e 2323 2043 6f6e 7472 6962  \n\n\n## Contrib
-0001c730: 7574 6f72 735c 6e5c 6e23 2323 2049 6e73  utors\n\n### Ins
-0001c740: 7461 6c6c 2050 6f65 7472 795c 6e5c 6e54  tall Poetry\n\nT
-0001c750: 6865 2066 6972 7374 2074 6869 6e67 2069  he first thing i
-0001c760: 7320 746f 2063 6865 636b 2079 6f75 2068  s to check you h
-0001c770: 6176 6520 506f 6574 7279 2069 6e73 7461  ave Poetry insta
-0001c780: 6c6c 6564 2e5c 6e5c 6e20 2020 2024 2070  lled.\n\n    $ p
-0001c790: 6f65 7472 7920 2d2d 7665 7273 696f 6e5c  oetry --version\
-0001c7a0: 6e5c 6e49 6620 796f 7520 646f 6e5c 2774  n\nIf you don\'t
-0001c7b0: 2c20 7468 656e 2070 6c65 6173 6520 5b69  , then please [i
-0001c7c0: 6e73 7461 6c6c 2050 6f65 7472 795d 2868  nstall Poetry](h
-0001c7d0: 7474 7073 3a2f 2f70 7974 686f 6e2d 706f  ttps://python-po
-0001c7e0: 6574 7279 2e6f 7267 2f64 6f63 732f 2369  etry.org/docs/#i
-0001c7f0: 6e73 7461 6c6c 696e 672d 7769 7468 2d74  nstalling-with-t
-0001c800: 6865 2d6f 6666 6963 6961 6c2d 696e 7374  he-official-inst
-0001c810: 616c 6c65 7229 2e5c 6e5c 6e20 2020 2024  aller).\n\n    $
-0001c820: 2063 7572 6c20 2d73 534c 2068 7474 7073   curl -sSL https
-0001c830: 3a2f 2f69 6e73 7461 6c6c 2e70 7974 686f  ://install.pytho
-0001c840: 6e2d 706f 6574 7279 2e6f 7267 207c 2070  n-poetry.org | p
-0001c850: 7974 686f 6e33 202d 5c6e 5c6e 4974 2077  ython3 -\n\nIt w
-0001c860: 696c 6c20 6865 6c70 2074 6f20 6d61 6b65  ill help to make
-0001c870: 2073 7572 6520 506f 6574 7279 5c27 7320   sure Poetry\'s 
-0001c880: 6269 6e20 6469 7265 6374 6f72 7920 6973  bin directory is
-0001c890: 2069 6e20 796f 7572 2060 5041 5448 6020   in your `PATH` 
-0001c8a0: 656e 7669 726f 6e6d 656e 7420 7661 7269  environment vari
-0001c8b0: 6162 6c65 2e5c 6e5c 6e42 7574 2069 6e20  able.\n\nBut in 
-0001c8c0: 616e 7920 6361 7365 2c20 6d61 6b65 2073  any case, make s
-0001c8d0: 7572 6520 796f 7520 6b6e 6f77 2074 6865  ure you know the
-0001c8e0: 2070 6174 6820 746f 2074 6865 2060 706f   path to the `po
-0001c8f0: 6574 7279 6020 6578 6563 7574 6162 6c65  etry` executable
-0001c900: 2e20 5468 6520 506f 6574 7279 5c6e 696e  . The Poetry\nin
-0001c910: 7374 616c 6c65 7220 7465 6c6c 7320 796f  staller tells yo
-0001c920: 7520 7768 6572 6520 6974 2068 6173 2062  u where it has b
-0001c930: 6565 6e20 696e 7374 616c 6c65 642c 2061  een installed, a
-0001c940: 6e64 2068 6f77 2074 6f20 636f 6e66 6967  nd how to config
-0001c950: 7572 6520 796f 7572 2073 6865 6c6c 2e5c  ure your shell.\
-0001c960: 6e5c 6e50 6c65 6173 6520 7265 6665 7220  n\nPlease refer 
-0001c970: 746f 2074 6865 205b 506f 6574 7279 2064  to the [Poetry d
-0001c980: 6f63 735d 2868 7474 7073 3a2f 2f70 7974  ocs](https://pyt
-0001c990: 686f 6e2d 706f 6574 7279 2e6f 7267 2f64  hon-poetry.org/d
-0001c9a0: 6f63 732f 2920 666f 7220 6775 6964 616e  ocs/) for guidan
-0001c9b0: 6365 206f 6e5c 6e75 7369 6e67 2050 6f65  ce on\nusing Poe
-0001c9c0: 7472 792e 5c6e 5c6e 2323 2320 5365 7475  try.\n\n### Setu
-0001c9d0: 7020 666f 7220 5079 4368 6172 6d20 7573  p for PyCharm us
-0001c9e0: 6572 735c 6e5c 6e59 6f75 2063 616e 2065  ers\n\nYou can e
-0001c9f0: 6173 696c 7920 6f62 7461 696e 2074 6865  asily obtain the
-0001ca00: 2070 726f 6a65 6374 2066 696c 6573 2075   project files u
-0001ca10: 7369 6e67 2050 7943 6861 726d 2028 6d65  sing PyCharm (me
-0001ca20: 6e75 2022 4769 7420 3e20 436c 6f6e 652e  nu "Git > Clone.
-0001ca30: 2e2e 2229 2e5c 6e50 7943 6861 726d 2077  ..").\nPyCharm w
-0001ca40: 696c 6c20 7468 656e 2075 7375 616c 6c79  ill then usually
-0001ca50: 2070 726f 6d70 7420 796f 7520 746f 206f   prompt you to o
-0001ca60: 7065 6e20 7468 6520 7072 6f6a 6563 742e  pen the project.
-0001ca70: 5c6e 5c6e 4f70 656e 2074 6865 2070 726f  \n\nOpen the pro
-0001ca80: 6a65 6374 2069 6e20 6120 6e65 7720 7769  ject in a new wi
-0001ca90: 6e64 6f77 2e20 5079 4368 6172 6d20 7769  ndow. PyCharm wi
-0001caa0: 6c6c 2074 6865 6e20 7573 7561 6c6c 7920  ll then usually 
-0001cab0: 7072 6f6d 7074 2079 6f75 2074 6f20 6372  prompt you to cr
-0001cac0: 6561 7465 5c6e 6120 6e65 7720 7669 7274  eate\na new virt
-0001cad0: 7561 6c20 656e 7669 726f 6e6d 656e 742e  ual environment.
-0001cae0: 5c6e 5c6e 4372 6561 7465 2061 206e 6577  \n\nCreate a new
-0001caf0: 2050 6f65 7472 7920 7669 7274 7561 6c20   Poetry virtual 
-0001cb00: 656e 7669 726f 6e6d 656e 7420 666f 7220  environment for 
-0001cb10: 7468 6520 7072 6f6a 6563 742e 2049 6620  the project. If 
-0001cb20: 5079 4368 6172 6d20 646f 6573 6e5c 2774  PyCharm doesn\'t
-0001cb30: 2061 6c72 6561 6479 5c6e 6b6e 6f77 2077   already\nknow w
-0001cb40: 6865 7265 2079 6f75 7220 6070 6f65 7472  here your `poetr
-0001cb50: 7960 2065 7865 6375 7461 626c 6520 6973  y` executable is
-0001cb60: 2c20 7468 656e 2073 6574 2074 6865 2070  , then set the p
-0001cb70: 6174 6820 746f 2079 6f75 7220 6070 6f65  ath to your `poe
-0001cb80: 7472 7960 2065 7865 6375 7461 626c 655c  try` executable\
-0001cb90: 6e69 6e20 7468 6520 224e 6577 2050 6f65  nin the "New Poe
-0001cba0: 7472 7920 456e 7669 726f 6e6d 656e 7422  try Environment"
-0001cbb0: 2066 6f72 6d20 696e 7075 7420 6669 656c   form input fiel
-0001cbc0: 6420 6c61 6265 6c6c 6564 2022 506f 6574  d labelled "Poet
-0001cbd0: 7279 2065 7865 6375 7461 626c 6522 2e20  ry executable". 
-0001cbe0: 496e 2074 6865 5c6e 224e 6577 2050 6f65  In the\n"New Poe
-0001cbf0: 7472 7920 456e 7669 726f 6e6d 656e 7422  try Environment"
-0001cc00: 2066 6f72 6d2c 2079 6f75 2077 696c 6c20   form, you will 
-0001cc10: 616c 736f 2068 6176 6520 7468 6520 6f70  also have the op
-0001cc20: 706f 7274 756e 6974 7920 746f 2073 656c  portunity to sel
-0001cc30: 6563 7420 7768 6963 685c 6e50 7974 686f  ect which\nPytho
-0001cc40: 6e20 6578 6563 7574 6162 6c65 2077 696c  n executable wil
-0001cc50: 6c20 6265 2075 7365 6420 6279 2074 6865  l be used by the
-0001cc60: 2076 6972 7475 616c 2065 6e76 6972 6f6e   virtual environ
-0001cc70: 6d65 6e74 2e5c 6e5c 6e50 7943 6861 726d  ment.\n\nPyCharm
-0001cc80: 2077 696c 6c20 7468 656e 2063 7265 6174   will then creat
-0001cc90: 6520 6120 6e65 7720 506f 6574 7279 2076  e a new Poetry v
-0001cca0: 6972 7475 616c 2065 6e76 6972 6f6e 6d65  irtual environme
-0001ccb0: 6e74 2066 6f72 2079 6f75 7220 7072 6f6a  nt for your proj
-0001ccc0: 6563 742c 2075 7369 6e67 5c6e 6120 7061  ect, using\na pa
-0001ccd0: 7274 6963 756c 6172 2076 6572 7369 6f6e  rticular version
-0001cce0: 206f 6620 5079 7468 6f6e 2c20 616e 6420   of Python, and 
-0001ccf0: 616c 736f 2069 6e73 7461 6c6c 2069 6e74  also install int
-0001cd00: 6f20 7468 6973 2076 6972 7475 616c 2065  o this virtual e
-0001cd10: 6e76 6972 6f6e 6d65 6e74 2074 6865 5c6e  nvironment the\n
-0001cd20: 7072 6f6a 6563 745c 2773 2070 6163 6b61  project\'s packa
-0001cd30: 6765 2064 6570 656e 6465 6e63 6965 7320  ge dependencies 
-0001cd40: 6163 636f 7264 696e 6720 746f 2074 6865  according to the
-0001cd50: 2070 726f 6a65 6374 5c27 7320 6070 6f65   project\'s `poe
-0001cd60: 7472 792e 6c6f 636b 6020 6669 6c65 2e5c  try.lock` file.\
-0001cd70: 6e5c 6e59 6f75 2063 616e 2061 6464 2064  n\nYou can add d
-0001cd80: 6966 6665 7265 6e74 2050 6f65 7472 7920  ifferent Poetry 
-0001cd90: 656e 7669 726f 6e6d 656e 7473 2066 6f72  environments for
-0001cda0: 2064 6966 6665 7265 6e74 2050 7974 686f   different Pytho
-0001cdb0: 6e20 7665 7273 696f 6e73 2c20 616e 6420  n versions, and 
-0001cdc0: 7377 6974 6368 5c6e 6265 7477 6565 6e20  switch\nbetween 
-0001cdd0: 7468 656d 2075 7369 6e67 2074 6865 2022  them using the "
-0001cde0: 5079 7468 6f6e 2049 6e74 6572 7072 6574  Python Interpret
-0001cdf0: 6572 2220 7365 7474 696e 6773 206f 6620  er" settings of 
-0001ce00: 5079 4368 6172 6d2e 2049 6620 796f 7520  PyCharm. If you 
-0001ce10: 7761 6e74 2074 6f20 7573 655c 6e61 2076  want to use\na v
-0001ce20: 6572 7369 6f6e 206f 6620 5079 7468 6f6e  ersion of Python
-0001ce30: 2074 6861 7420 6973 6e5c 2774 2069 6e73   that isn\'t ins
-0001ce40: 7461 6c6c 6564 2c20 6569 7468 6572 2075  talled, either u
-0001ce50: 7365 2079 6f75 7220 6661 766f 7572 6974  se your favourit
-0001ce60: 6520 7061 636b 6167 6520 6d61 6e61 6765  e package manage
-0001ce70: 722c 5c6e 6f72 2069 6e73 7461 6c6c 2050  r,\nor install P
-0001ce80: 7974 686f 6e20 6279 2064 6f77 6e6c 6f61  ython by downloa
-0001ce90: 6469 6e67 2061 6e20 696e 7374 616c 6c65  ding an installe
-0001cea0: 7220 666f 7220 7265 6365 6e74 2076 6572  r for recent ver
-0001ceb0: 7369 6f6e 7320 6f66 2050 7974 686f 6e20  sions of Python 
-0001cec0: 6469 7265 6374 6c79 5c6e 6672 6f6d 2074  directly\nfrom t
-0001ced0: 6865 205b 5079 7468 6f6e 2077 6562 7369  he [Python websi
-0001cee0: 7465 5d28 6874 7470 733a 2f2f 7777 772e  te](https://www.
-0001cef0: 7079 7468 6f6e 2e6f 7267 2f64 6f77 6e6c  python.org/downl
-0001cf00: 6f61 6473 2f29 2e5c 6e5c 6e4f 6e63 6520  oads/).\n\nOnce 
-0001cf10: 7072 6f6a 6563 7420 6465 7065 6e64 656e  project dependen
-0001cf20: 6369 6573 2068 6176 6520 6265 656e 2069  cies have been i
-0001cf30: 6e73 7461 6c6c 6564 2c20 796f 7520 7368  nstalled, you sh
-0001cf40: 6f75 6c64 2062 6520 6162 6c65 2074 6f20  ould be able to 
-0001cf50: 7275 6e20 7465 7374 735c 6e66 726f 6d20  run tests\nfrom 
-0001cf60: 7769 7468 696e 2050 7943 6861 726d 2028  within PyCharm (
-0001cf70: 7269 6768 742d 636c 6963 6b20 6f6e 2074  right-click on t
-0001cf80: 6865 2060 7465 7374 7360 2066 6f6c 6465  he `tests` folde
-0001cf90: 7220 616e 6420 7365 6c65 6374 2074 6865  r and select the
-0001cfa0: 205c 2752 756e 5c27 206f 7074 696f 6e29   \'Run\' option)
-0001cfb0: 2e5c 6e5c 6e42 6563 6175 7365 206f 6620  .\n\nBecause of 
-0001cfc0: 6120 636f 6e66 6c69 6374 2062 6574 7765  a conflict betwe
-0001cfd0: 656e 2070 7974 6573 7420 616e 6420 5079  en pytest and Py
-0001cfe0: 4368 6172 6d5c 2773 2064 6562 7567 6765  Charm\'s debugge
-0001cff0: 7220 616e 6420 7468 6520 636f 7665 7261  r and the covera
-0001d000: 6765 2074 6f6f 6c2c 5c6e 796f 7520 6d61  ge tool,\nyou ma
-0001d010: 7920 6e65 6564 2074 6f20 6164 6420 6060  y need to add ``
-0001d020: 2d2d 6e6f 2d63 6f76 6060 2061 7320 616e  --no-cov`` as an
-0001d030: 206f 7074 696f 6e20 746f 2074 6865 2074   option to the t
-0001d040: 6573 7420 7275 6e6e 6572 2074 656d 706c  est runner templ
-0001d050: 6174 652e 2041 6c74 6572 6e61 7469 7665  ate. Alternative
-0001d060: 6c79 2c5c 6e6a 7573 7420 7573 6520 7468  ly,\njust use th
-0001d070: 6520 5079 7468 6f6e 2053 7461 6e64 6172  e Python Standar
-0001d080: 6420 4c69 6272 6172 795c 2773 2060 6075  d Library\'s ``u
-0001d090: 6e69 7474 6573 7460 6020 6d6f 6475 6c65  nittest`` module
-0001d0a0: 2e5c 6e5c 6e59 6f75 2073 686f 756c 6420  .\n\nYou should 
-0001d0b0: 616c 736f 2062 6520 6162 6c65 2074 6f20  also be able to 
-0001d0c0: 6f70 656e 2061 2074 6572 6d69 6e61 6c20  open a terminal 
-0001d0d0: 7769 6e64 6f77 2069 6e20 5079 4368 6172  window in PyChar
-0001d0e0: 6d2c 2061 6e64 2072 756e 2074 6865 2070  m, and run the p
-0001d0f0: 726f 6a65 6374 5c27 735c 6e4d 616b 6566  roject\'s\nMakef
-0001d100: 696c 6520 636f 6d6d 616e 6473 2066 726f  ile commands fro
-0001d110: 6d20 7468 6520 636f 6d6d 616e 6420 6c69  m the command li
-0001d120: 6e65 2028 7365 6520 6265 6c6f 7729 2e5c  ne (see below).\
-0001d130: 6e5c 6e23 2323 2053 6574 7570 2066 726f  n\n### Setup fro
-0001d140: 6d20 636f 6d6d 616e 6420 6c69 6e65 5c6e  m command line\n
-0001d150: 5c6e 4f62 7461 696e 2074 6865 2070 726f  \nObtain the pro
-0001d160: 6a65 6374 2066 696c 6573 2c20 7573 696e  ject files, usin
-0001d170: 6720 4769 7420 6f72 2073 7569 7461 626c  g Git or suitabl
-0001d180: 6520 616c 7465 726e 6174 6976 652e 5c6e  e alternative.\n
-0001d190: 5c6e 496e 2061 2074 6572 6d69 6e61 6c20  \nIn a terminal 
-0001d1a0: 6170 706c 6963 6174 696f 6e2c 2063 6861  application, cha
-0001d1b0: 6e67 6520 796f 7572 2063 7572 7265 6e74  nge your current
-0001d1c0: 2077 6f72 6b69 6e67 2064 6972 6563 746f   working directo
-0001d1d0: 7279 5c6e 746f 2074 6865 2072 6f6f 7420  ry\nto the root 
-0001d1e0: 666f 6c64 6572 206f 6620 7468 6520 7072  folder of the pr
-0001d1f0: 6f6a 6563 7420 6669 6c65 732e 2054 6865  oject files. The
-0001d200: 7265 2073 686f 756c 6420 6265 2061 204d  re should be a M
-0001d210: 616b 6566 696c 655c 6e69 6e20 7468 6973  akefile\nin this
-0001d220: 2066 6f6c 6465 722e 5c6e 5c6e 5573 6520   folder.\n\nUse 
-0001d230: 7468 6520 4d61 6b65 6669 6c65 2074 6f20  the Makefile to 
-0001d240: 6372 6561 7465 2061 206e 6577 2050 6f65  create a new Poe
-0001d250: 7472 7920 7669 7274 7561 6c20 656e 7669  try virtual envi
-0001d260: 726f 6e6d 656e 7420 666f 7220 7468 655c  ronment for the\
-0001d270: 6e70 726f 6a65 6374 2061 6e64 2069 6e73  nproject and ins
-0001d280: 7461 6c6c 2074 6865 2070 726f 6a65 6374  tall the project
-0001d290: 5c27 7320 7061 636b 6167 6520 6465 7065  \'s package depe
-0001d2a0: 6e64 656e 6369 6573 2069 6e74 6f20 6974  ndencies into it
-0001d2b0: 2c5c 6e75 7369 6e67 2074 6865 2066 6f6c  ,\nusing the fol
-0001d2c0: 6c6f 7769 6e67 2063 6f6d 6d61 6e64 2e5c  lowing command.\
-0001d2d0: 6e5c 6e20 2020 2024 206d 616b 6520 696e  n\n    $ make in
-0001d2e0: 7374 616c 6c2d 7061 636b 6167 6573 5c6e  stall-packages\n
-0001d2f0: 5c6e 4974 5c27 7320 616c 736f 2070 6f73  \nIt\'s also pos
-0001d300: 7369 626c 6520 746f 2061 6c73 6f20 696e  sible to also in
-0001d310: 7374 616c 6c20 7468 6520 7072 6f6a 6563  stall the projec
-0001d320: 7420 696e 205c 2765 6469 7461 626c 6520  t in \'editable 
-0001d330: 6d6f 6465 5c27 2e5c 6e5c 6e20 2020 2024  mode\'.\n\n    $
-0001d340: 206d 616b 6520 696e 7374 616c 6c5c 6e5c   make install\n\
-0001d350: 6e50 6c65 6173 6520 6e6f 7465 2c20 6966  nPlease note, if
-0001d360: 2079 6f75 2063 7265 6174 6520 7468 6520   you create the 
-0001d370: 7669 7274 7561 6c20 656e 7669 726f 6e6d  virtual environm
-0001d380: 656e 7420 696e 2074 6869 7320 7761 792c  ent in this way,
-0001d390: 2061 6e64 2074 6865 6e20 7472 7920 746f   and then try to
-0001d3a0: 5c6e 6f70 656e 2074 6865 2070 726f 6a65  \nopen the proje
-0001d3b0: 6374 2069 6e20 5079 4368 6172 6d20 616e  ct in PyCharm an
-0001d3c0: 6420 636f 6e66 6967 7572 6520 7468 6520  d configure the 
-0001d3d0: 7072 6f6a 6563 7420 746f 2075 7365 2074  project to use t
-0001d3e0: 6869 7320 7669 7274 7561 6c5c 6e65 6e76  his virtual\nenv
-0001d3f0: 6972 6f6e 6d65 6e74 2061 7320 616e 2022  ironment as an "
-0001d400: 4578 6973 7469 6e67 2050 6f65 7472 7920  Existing Poetry 
-0001d410: 456e 7669 726f 6e6d 656e 7422 2c20 5079  Environment", Py
-0001d420: 4368 6172 6d20 736f 6d65 7469 6d65 7320  Charm sometimes 
-0001d430: 6861 7320 736f 6d65 5c6e 6973 7375 6573  has some\nissues
-0001d440: 2028 646f 6e5c 2774 206b 6e6f 7720 7768   (don\'t know wh
-0001d450: 7929 2077 6869 6368 206d 6967 6874 2062  y) which might b
-0001d460: 6520 7072 6f62 6c65 6d61 7469 632e 2049  e problematic. I
-0001d470: 6620 796f 7520 656e 636f 756e 7465 7220  f you encounter 
-0001d480: 7375 6368 5c6e 6973 7375 6573 2c20 796f  such\nissues, yo
-0001d490: 7520 6361 6e20 7265 736f 6c76 6520 7468  u can resolve th
-0001d4a0: 6573 6520 6973 7375 6573 2062 7920 6465  ese issues by de
-0001d4b0: 6c65 7469 6e67 2074 6865 2076 6972 7475  leting the virtu
-0001d4c0: 616c 2065 6e76 6972 6f6e 6d65 6e74 5c6e  al environment\n
-0001d4d0: 616e 6420 6372 6561 7469 6e67 2074 6865  and creating the
-0001d4e0: 2050 6f65 7472 7920 7669 7274 7561 6c20   Poetry virtual 
-0001d4f0: 656e 7669 726f 6e6d 656e 7420 7573 696e  environment usin
-0001d500: 6720 5079 4368 6172 6d20 2873 6565 2061  g PyCharm (see a
-0001d510: 626f 7665 292e 5c6e 5c6e 2323 2320 5072  bove).\n\n### Pr
-0001d520: 6f6a 6563 7420 4d61 6b65 6669 6c65 2063  oject Makefile c
-0001d530: 6f6d 6d61 6e64 735c 6e5c 6e59 6f75 2063  ommands\n\nYou c
-0001d540: 616e 2073 7461 7274 2045 7665 6e74 5374  an start EventSt
-0001d550: 6f72 6544 4220 7573 696e 6720 7468 6520  oreDB using the 
-0001d560: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
-0001d570: 642e 5c6e 5c6e 2020 2020 2420 6d61 6b65  d.\n\n    $ make
-0001d580: 2073 7461 7274 2d65 7665 6e74 7374 6f72   start-eventstor
-0001d590: 6564 625c 6e5c 6e59 6f75 2063 616e 2072  edb\n\nYou can r
-0001d5a0: 756e 2074 6573 7473 2075 7369 6e67 2074  un tests using t
-0001d5b0: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
-0001d5c0: 6d61 6e64 2028 6e65 6564 7320 4576 656e  mand (needs Even
-0001d5d0: 7453 746f 7265 4442 2074 6f20 6265 2072  tStoreDB to be r
-0001d5e0: 756e 6e69 6e67 292e 5c6e 5c6e 2020 2020  unning).\n\n    
-0001d5f0: 2420 6d61 6b65 2074 6573 745c 6e5c 6e59  $ make test\n\nY
-0001d600: 6f75 2063 616e 2073 746f 7020 4576 656e  ou can stop Even
-0001d610: 7453 746f 7265 4442 2075 7369 6e67 2074  tStoreDB using t
-0001d620: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
-0001d630: 6d61 6e64 2e5c 6e5c 6e20 2020 2024 206d  mand.\n\n    $ m
-0001d640: 616b 6520 7374 6f70 2d65 7665 6e74 7374  ake stop-eventst
-0001d650: 6f72 6564 625c 6e5c 6e59 6f75 2063 616e  oredb\n\nYou can
-0001d660: 2063 6865 636b 2074 6865 2066 6f72 6d61   check the forma
-0001d670: 7474 696e 6720 6f66 2074 6865 2063 6f64  tting of the cod
-0001d680: 6520 7573 696e 6720 7468 6520 666f 6c6c  e using the foll
-0001d690: 6f77 696e 6720 636f 6d6d 616e 642e 5c6e  owing command.\n
-0001d6a0: 5c6e 2020 2020 2420 6d61 6b65 206c 696e  \n    $ make lin
-0001d6b0: 745c 6e5c 6e59 6f75 2063 616e 2072 6566  t\n\nYou can ref
-0001d6c0: 6f72 6d61 7420 7468 6520 636f 6465 2075  ormat the code u
-0001d6d0: 7369 6e67 2074 6865 2066 6f6c 6c6f 7769  sing the followi
-0001d6e0: 6e67 2063 6f6d 6d61 6e64 2e5c 6e5c 6e20  ng command.\n\n 
-0001d6f0: 2020 2024 206d 616b 6520 666d 745c 6e5c     $ make fmt\n\
-0001d700: 6e54 6573 7473 2062 656c 6f6e 6720 696e  nTests belong in
-0001d710: 2060 2e2f 7465 7374 7360 2e20 436f 6465   `./tests`. Code
-0001d720: 2d75 6e64 6572 2d74 6573 7420 6265 6c6f  -under-test belo
-0001d730: 6e67 7320 696e 2060 2e2f 6573 6462 636c  ngs in `./esdbcl
-0001d740: 6965 6e74 602e 5c6e 5c6e 4564 6974 2070  ient`.\n\nEdit p
-0001d750: 6163 6b61 6765 2064 6570 656e 6465 6e63  ackage dependenc
-0001d760: 6965 7320 696e 2060 7079 7072 6f6a 6563  ies in `pyprojec
-0001d770: 742e 746f 6d6c 602e 2055 7064 6174 6520  t.toml`. Update 
-0001d780: 696e 7374 616c 6c65 6420 7061 636b 6167  installed packag
-0001d790: 6573 2028 616e 6420 7468 655c 6e60 706f  es (and the\n`po
-0001d7a0: 6574 7279 2e6c 6f63 6b60 2066 696c 6529  etry.lock` file)
-0001d7b0: 2075 7369 6e67 2074 6865 2066 6f6c 6c6f   using the follo
-0001d7c0: 7769 6e67 2063 6f6d 6d61 6e64 2e5c 6e5c  wing command.\n\
-0001d7d0: 6e20 2020 2024 206d 616b 6520 7570 6461  n    $ make upda
-0001d7e0: 7465 2d70 6163 6b61 6765 735c 6e27 2c0a  te-packages\n',.
-0001d7f0: 2020 2020 2761 7574 686f 7227 3a20 274a      'author': 'J
-0001d800: 6f68 6e20 4279 7761 7465 7227 2c0a 2020  ohn Bywater',.  
-0001d810: 2020 2761 7574 686f 725f 656d 6169 6c27    'author_email'
-0001d820: 3a20 276a 6f68 6e2e 6279 7761 7465 7240  : 'john.bywater@
-0001d830: 6170 7072 6f70 7269 6174 6573 6f66 7477  appropriatesoftw
-0001d840: 6172 652e 6e65 7427 2c0a 2020 2020 276d  are.net',.    'm
-0001d850: 6169 6e74 6169 6e65 7227 3a20 274e 6f6e  aintainer': 'Non
-0001d860: 6527 2c0a 2020 2020 276d 6169 6e74 6169  e',.    'maintai
-0001d870: 6e65 725f 656d 6169 6c27 3a20 274e 6f6e  ner_email': 'Non
-0001d880: 6527 2c0a 2020 2020 2775 726c 273a 2027  e',.    'url': '
-0001d890: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-0001d8a0: 6f6d 2f70 7965 7665 6e74 736f 7572 6369  om/pyeventsourci
-0001d8b0: 6e67 2f65 7364 6263 6c69 656e 7427 2c0a  ng/esdbclient',.
-0001d8c0: 2020 2020 2770 6163 6b61 6765 7327 3a20      'packages': 
-0001d8d0: 7061 636b 6167 6573 2c0a 2020 2020 2770  packages,.    'p
-0001d8e0: 6163 6b61 6765 5f64 6174 6127 3a20 7061  ackage_data': pa
-0001d8f0: 636b 6167 655f 6461 7461 2c0a 2020 2020  ckage_data,.    
-0001d900: 2769 6e73 7461 6c6c 5f72 6571 7569 7265  'install_require
-0001d910: 7327 3a20 696e 7374 616c 6c5f 7265 7175  s': install_requ
-0001d920: 6972 6573 2c0a 2020 2020 2770 7974 686f  ires,.    'pytho
-0001d930: 6e5f 7265 7175 6972 6573 273a 2027 3e3d  n_requires': '>=
-0001d940: 332e 372c 3c34 2e30 272c 0a7d 0a0a 0a73  3.7,<4.0',.}...s
-0001d950: 6574 7570 282a 2a73 6574 7570 5f6b 7761  etup(**setup_kwa
-0001d960: 7267 7329 0a                             rgs).
+00005ce0: 2020 2020 2020 2020 2020 2020 7c0a 7c20              |.| 
+00005cf0: 4b65 6570 416c 6976 6554 696d 656f 7574  KeepAliveTimeout
+00005d00: 2020 2020 7c20 696e 7465 6765 7220 2864      | integer (d
+00005d10: 6566 6175 6c74 3a20 604e 6f6e 6560 2920  efault: `None`) 
+00005d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d40: 2020 2020 2020 2020 2020 2020 7c20 5468              | Th
+00005d50: 6520 7661 6c75 6520 6f66 2074 6865 2022  e value of the "
+00005d60: 6772 7063 2e6b 6565 7061 6c69 7665 5f74  grpc.keepalive_t
+00005d70: 696d 656f 7574 5f6d 7322 2067 5250 4320  imeout_ms" gRPC 
+00005d80: 6368 616e 6e65 6c20 6f70 7469 6f6e 2e20  channel option. 
+00005d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005df0: 7c0a 0a0a 2323 2320 4578 616d 706c 6573  |...### Examples
+00005e00: 3c61 2069 643d 2265 7861 6d70 6c65 7322  <a id="examples"
+00005e10: 3e3c 2f61 3e0a 0a48 6572 6520 6172 6520  ></a>..Here are 
+00005e20: 736f 6d65 2065 7861 6d70 6c65 7320 6f66  some examples of
+00005e30: 2045 7665 6e74 5374 6f72 6544 4220 636f   EventStoreDB co
+00005e40: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+00005e50: 5552 4973 2e0a 0a54 6865 2066 6f6c 6c6f  URIs...The follo
+00005e60: 7769 6e67 2055 5249 2077 696c 6c20 6361  wing URI will ca
+00005e70: 7573 6520 7468 6520 636c 6965 6e74 2074  use the client t
+00005e80: 6f20 636f 6e6e 6563 7420 746f 2c20 616e  o connect to, an
+00005e90: 6420 6765 740a 636c 7573 7465 7220 696e  d get.cluster in
+00005ea0: 666f 2c20 6672 6f6d 2022 7365 6375 7265  fo, from "secure
+00005eb0: 2220 7365 7276 6572 2073 6f63 6b65 7420  " server socket 
+00005ec0: 606c 6f63 616c 686f 7374 3a32 3131 3360  `localhost:2113`
+00005ed0: 2e20 416e 640a 7468 656e 2074 6f20 636f  . And.then to co
+00005ee0: 6e6e 6563 7420 746f 2061 2022 6c65 6164  nnect to a "lead
+00005ef0: 6572 2220 6e6f 6465 2e20 416e 6420 616c  er" node. And al
+00005f00: 736f 2074 6f20 7573 6520 2261 646d 696e  so to use "admin
+00005f10: 2220 616e 640a 2263 6861 6e67 6569 7422  " and."changeit"
+00005f20: 2061 7320 7468 6520 7573 6572 6e61 6d65   as the username
+00005f30: 2061 6e64 2070 6173 7377 6f72 6420 7768   and password wh
+00005f40: 656e 206d 616b 696e 6720 6361 6c6c 7320  en making calls 
+00005f50: 746f 0a45 7665 6e74 5374 6f72 6544 4220  to.EventStoreDB 
+00005f60: 4150 4920 6d65 7468 6f64 732e 0a0a 2020  API methods...  
+00005f70: 2020 6573 6462 3a2f 2f61 646d 696e 3a63    esdb://admin:c
+00005f80: 6861 6e67 6569 7440 6c6f 6361 6c68 6f73  hangeit@localhos
+00005f90: 743a 3231 3133 0a0a 0a54 6865 2066 6f6c  t:2113...The fol
+00005fa0: 6c6f 7769 6e67 2055 5249 2077 696c 6c20  lowing URI will 
+00005fb0: 6361 7573 6520 7468 6520 636c 6965 6e74  cause the client
+00005fc0: 2074 6f20 6765 7420 636c 7573 7465 7220   to get cluster 
+00005fd0: 696e 666f 2066 726f 6d0a 2269 6e73 6563  info from."insec
+00005fe0: 7572 6522 2073 6572 7665 7220 736f 636b  ure" server sock
+00005ff0: 6574 2031 3237 2e30 2e30 2e31 3a32 3131  et 127.0.0.1:211
+00006000: 332e 2020 416e 6420 7468 656e 2074 6f20  3.  And then to 
+00006010: 636f 6e6e 6563 7420 746f 0a61 2022 6c65  connect to.a "le
+00006020: 6164 6572 2220 6e6f 6465 2e0a 0a20 2020  ader" node...   
+00006030: 2065 7364 623a 2f2f 3132 372e 302e 302e   esdb://127.0.0.
+00006040: 313a 3231 3133 3f54 6c73 3d66 616c 7365  1:2113?Tls=false
+00006050: 0a0a 0a54 6865 2066 6f6c 6c6f 7769 6e67  ...The following
+00006060: 2055 5249 2077 696c 6c20 6361 7573 6520   URI will cause 
+00006070: 7468 6520 636c 6965 6e74 2074 6f20 6765  the client to ge
+00006080: 7420 636c 7573 7465 7220 696e 666f 2066  t cluster info f
+00006090: 726f 6d0a 6164 6472 6573 7365 7320 696e  rom.addresses in
+000060a0: 2044 4e53 2027 4127 2072 6563 6f72 6473   DNS 'A' records
+000060b0: 2066 6f72 2063 6c75 7374 6572 312e 6578   for cluster1.ex
+000060c0: 616d 706c 652e 636f 6d2e 2041 6e64 2074  ample.com. And t
+000060d0: 6865 6e0a 746f 2063 6f6e 6e65 6374 2074  hen.to connect t
+000060e0: 6f20 6120 226c 6561 6465 7222 206e 6f64  o a "leader" nod
+000060f0: 652e 2041 6e64 2075 7365 2061 2064 6566  e. And use a def
+00006100: 6175 6c74 2064 6561 646c 696e 6520 6f66  ault deadline of
+00006110: 2035 0a73 6563 6f6e 6473 2077 6865 6e20   5.seconds when 
+00006120: 6d61 6b69 6e67 2063 616c 6c73 2074 6f20  making calls to 
+00006130: 4576 656e 7453 746f 7265 2041 5049 2022  EventStore API "
+00006140: 7772 6974 6522 206d 6574 686f 6473 2e0a  write" methods..
+00006150: 0a20 2020 2065 7364 622b 6469 7363 6f76  .    esdb+discov
+00006160: 6572 3a2f 2f61 646d 696e 3a63 6861 6e67  er://admin:chang
+00006170: 6569 7440 636c 7573 7465 7231 2e65 7861  eit@cluster1.exa
+00006180: 6d70 6c65 2e63 6f6d 3f44 6566 6175 6c74  mple.com?Default
+00006190: 4465 6164 6c69 6e65 3d35 0a0a 0a54 6865  Deadline=5...The
+000061a0: 2066 6f6c 6c6f 7769 6e67 2055 5249 2077   following URI w
+000061b0: 696c 6c20 6361 7573 6520 7468 6520 636c  ill cause the cl
+000061c0: 6965 6e74 2074 6f20 6765 7420 636c 7573  ient to get clus
+000061d0: 7465 7220 696e 666f 2066 726f 6d20 6569  ter info from ei
+000061e0: 7468 6572 0a6c 6f63 616c 686f 7374 3a32  ther.localhost:2
+000061f0: 3131 312c 206f 7220 6c6f 6361 6c68 6f73  111, or localhos
+00006200: 743a 3231 3132 2c20 6f72 206c 6f63 616c  t:2112, or local
+00006210: 686f 7374 3a32 3131 332e 2041 6e64 2074  host:2113. And t
+00006220: 6865 6e20 746f 2063 6f6e 6e65 6374 0a74  hen to connect.t
+00006230: 6f20 6120 2266 6f6c 6c6f 7765 7222 206e  o a "follower" n
+00006240: 6f64 652e 0a0a 2020 2020 6573 6462 3a2f  ode...    esdb:/
+00006250: 2f61 646d 696e 3a63 6861 6e67 6569 7440  /admin:changeit@
+00006260: 6c6f 6361 6c68 6f73 743a 3231 3131 2c6c  localhost:2111,l
+00006270: 6f63 616c 686f 7374 3a32 3131 322c 6c6f  ocalhost:2112,lo
+00006280: 6361 6c68 6f73 743a 3231 3133 3f4e 6f64  calhost:2113?Nod
+00006290: 6550 7265 6665 7265 6e63 653d 666f 6c6c  ePreference=foll
+000062a0: 6f77 6572 0a0a 0a54 6865 2066 6f6c 6c6f  ower...The follo
+000062b0: 7769 6e67 2055 5249 2077 696c 6c20 6361  wing URI will ca
+000062c0: 7573 6520 7468 6520 636c 6965 6e74 2074  use the client t
+000062d0: 6f20 6765 7420 636c 7573 7465 7220 696e  o get cluster in
+000062e0: 666f 2066 726f 6d20 6164 6472 6573 7365  fo from addresse
+000062f0: 7320 696e 0a44 4e53 2027 4127 2072 6563  s in.DNS 'A' rec
+00006300: 6f72 6473 2066 6f72 2063 6c75 7374 6572  ords for cluster
+00006310: 312e 6578 616d 706c 652e 636f 6d2e 2041  1.example.com. A
+00006320: 6e64 2074 6f20 636f 6e66 6967 7572 6520  nd to configure 
+00006330: 226b 6565 7020 616c 6976 6522 2074 696d  "keep alive" tim
+00006340: 656f 7574 0a61 6e64 2069 6e74 6572 7661  eout.and interva
+00006350: 6c20 696e 2074 6865 2067 5250 4320 6368  l in the gRPC ch
+00006360: 616e 6e65 6c2e 0a0a 2020 2020 6573 6462  annel...    esdb
+00006370: 2b64 6973 636f 7665 723a 2f2f 6164 6d69  +discover://admi
+00006380: 6e3a 6368 616e 6765 6974 4063 6c75 7374  n:changeit@clust
+00006390: 6572 312e 6578 616d 706c 652e 636f 6d3f  er1.example.com?
+000063a0: 4b65 6570 416c 6976 6549 6e74 6572 7661  KeepAliveInterva
+000063b0: 6c3d 3130 3030 3026 4b65 6570 416c 6976  l=10000&KeepAliv
+000063c0: 6554 696d 656f 7574 3d31 3030 3030 0a0a  eTimeout=10000..
+000063d0: 0a50 6c65 6173 6520 6e6f 7465 2c20 7468  .Please note, th
+000063e0: 6520 636c 6965 6e74 2069 7320 696e 7365  e client is inse
+000063f0: 6e73 6974 6976 6520 746f 2074 6865 2063  nsitive to the c
+00006400: 6173 6520 6f66 2066 6965 6c64 7320 616e  ase of fields an
+00006410: 6420 7661 6c75 6573 2e20 4966 2066 6965  d values. If fie
+00006420: 6c64 7320 6172 650a 7265 7065 6174 6564  lds are.repeated
+00006430: 2069 6e20 7468 6520 7175 6572 7920 7374   in the query st
+00006440: 7269 6e67 2c20 7468 6520 7175 6572 7920  ring, the query 
+00006450: 7374 7269 6e67 2077 696c 6c20 6265 2070  string will be p
+00006460: 6172 7365 6420 7769 7468 6f75 7420 6572  arsed without er
+00006470: 726f 722e 2048 6f77 6576 6572 2c0a 7468  ror. However,.th
+00006480: 6520 636f 6e6e 6563 7469 6f6e 206f 7074  e connection opt
+00006490: 696f 6e73 2075 7365 6420 6279 2074 6865  ions used by the
+000064a0: 2063 6c69 656e 7420 7769 6c6c 2075 7365   client will use
+000064b0: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
+000064c0: 6520 6669 7273 7420 6669 656c 642e 2041  e first field. A
+000064d0: 6c6c 0a74 6865 206f 7468 6572 2066 6965  ll.the other fie
+000064e0: 6c64 2d76 616c 7565 7320 696e 2074 6865  ld-values in the
+000064f0: 2071 7565 7279 2073 7472 696e 6720 7769   query string wi
+00006500: 7468 2074 6865 2073 616d 6520 6669 656c  th the same fiel
+00006510: 6420 6e61 6d65 2077 696c 6c20 6265 2069  d name will be i
+00006520: 676e 6f72 6564 2e0a 4669 656c 6473 2077  gnored..Fields w
+00006530: 6974 686f 7574 2076 616c 7565 7320 7769  ithout values wi
+00006540: 6c6c 2061 6c73 6f20 6265 2069 676e 6f72  ll also be ignor
+00006550: 6564 2e0a 0a49 6620 7468 6520 636c 6965  ed...If the clie
+00006560: 6e74 2773 206e 6f64 6520 7072 6566 6572  nt's node prefer
+00006570: 656e 6365 2069 7320 226c 6561 6465 7222  ence is "leader"
+00006580: 2061 6e64 2074 6865 206e 6f64 6520 6265   and the node be
+00006590: 636f 6d65 7320 610a 2266 6f6c 6c6f 7765  comes a."followe
+000065a0: 7222 2c20 7468 6520 636c 6965 6e74 2077  r", the client w
+000065b0: 696c 6c20 6174 7465 6d70 7420 746f 2072  ill attempt to r
+000065c0: 6563 6f6e 6e65 6374 2074 6f20 7468 6520  econnect to the 
+000065d0: 6375 7272 656e 7420 6c65 6164 6572 2077  current leader w
+000065e0: 6865 6e20 6120 6d65 7468 6f64 0a69 7320  hen a method.is 
+000065f0: 6361 6c6c 6564 2074 6861 7420 6578 7065  called that expe
+00006600: 6374 7320 746f 2063 616c 6c20 6120 6c65  cts to call a le
+00006610: 6164 6572 2e20 4d65 7468 6f64 7320 7768  ader. Methods wh
+00006620: 6963 6820 6d75 7461 7465 2074 6865 2073  ich mutate the s
+00006630: 7461 7465 206f 6620 7468 6520 6461 7461  tate of the data
+00006640: 6261 7365 0a65 7870 6563 7420 746f 2063  base.expect to c
+00006650: 616c 6c20 6120 6c65 6164 6572 2e20 466f  all a leader. Fo
+00006660: 7220 7375 6368 206d 6574 686f 6473 2c20  r such methods, 
+00006670: 7468 6520 4854 5450 2068 6561 6465 7220  the HTTP header 
+00006680: 2272 6571 7569 7265 732d 6c65 6164 6572  "requires-leader
+00006690: 2220 6973 2073 6574 2074 6f0a 2274 7275  " is set to."tru
+000066a0: 6522 2c20 616e 6420 7468 6973 2068 6561  e", and this hea
+000066b0: 6465 7220 6973 206f 6273 6572 7665 6420  der is observed 
+000066c0: 6279 2074 6865 2073 6572 7665 722c 2061  by the server, a
+000066d0: 6e64 2073 6f20 6120 6e6f 6465 2077 6869  nd so a node whi
+000066e0: 6368 2069 7320 6e6f 7420 6120 6c65 6164  ch is not a lead
+000066f0: 6572 0a74 6861 7420 7265 6365 6976 6573  er.that receives
+00006700: 2073 7563 6820 6120 7265 7175 6573 7420   such a request 
+00006710: 7769 6c6c 2072 6574 7572 6e20 616e 2065  will return an e
+00006720: 7272 6f72 2e20 5468 6973 2065 7272 6f72  rror. This error
+00006730: 2069 7320 6465 7465 6374 6564 2062 7920   is detected by 
+00006740: 7468 6520 636c 6965 6e74 2c0a 7768 6963  the client,.whic
+00006750: 6820 7769 6c6c 2074 6865 6e20 636c 6f73  h will then clos
+00006760: 6520 7468 6520 6375 7272 656e 7420 6752  e the current gR
+00006770: 5043 2063 6f6e 6e65 6374 696f 6e20 616e  PC connection an
+00006780: 6420 6372 6561 7465 2061 206e 6577 2063  d create a new c
+00006790: 6f6e 6e65 6374 696f 6e20 746f 2074 6865  onnection to the
+000067a0: 0a6c 6561 6465 722e 2054 6865 2072 6571  .leader. The req
+000067b0: 7565 7374 2077 696c 6c20 7468 656e 2062  uest will then b
+000067c0: 6520 7265 7472 6965 6420 7769 7468 2074  e retried with t
+000067d0: 6865 206c 6561 6465 722e 0a0a 4966 2074  he leader...If t
+000067e0: 6865 2063 6c69 656e 7427 7320 6e6f 6465  he client's node
+000067f0: 2070 7265 6665 7265 6e63 6520 6973 2022   preference is "
+00006800: 666f 6c6c 6f77 6572 2220 616e 6420 7468  follower" and th
+00006810: 6572 6520 6172 6520 6e6f 2066 6f6c 6c6f  ere are no follo
+00006820: 7765 720a 6e6f 6465 7320 696e 2074 6865  wer.nodes in the
+00006830: 2063 6c75 7374 6572 2c20 7468 656e 2074   cluster, then t
+00006840: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
+00006850: 6169 7365 2061 6e20 6578 6365 7074 696f  aise an exceptio
+00006860: 6e2e 2053 696d 696c 6172 6c79 2c20 6966  n. Similarly, if
+00006870: 2074 6865 0a63 6c69 656e 7427 7320 6e6f   the.client's no
+00006880: 6465 2070 7265 6665 7265 6e63 6520 6973  de preference is
+00006890: 2022 7265 6164 6f6e 6c79 7265 706c 6963   "readonlyreplic
+000068a0: 6122 2061 6e64 2074 6865 7265 2061 7265  a" and there are
+000068b0: 206e 6f20 7265 6164 2d6f 6e6c 7920 7265   no read-only re
+000068c0: 706c 6963 610a 6e6f 6465 7320 696e 2074  plica.nodes in t
+000068d0: 6865 2063 6c75 7374 6572 2c20 7468 656e  he cluster, then
+000068e0: 2074 6865 2063 6c69 656e 7420 7769 6c6c   the client will
+000068f0: 2061 6c73 6f20 7261 6973 6520 616e 2065   also raise an e
+00006900: 7863 6570 7469 6f6e 2e0a 0a54 6865 2067  xception...The g
+00006910: 5250 4320 6368 616e 6e65 6c20 6f70 7469  RPC channel opti
+00006920: 6f6e 2022 6772 7063 2e6d 6178 5f72 6563  on "grpc.max_rec
+00006930: 6569 7665 5f6d 6573 7361 6765 5f6c 656e  eive_message_len
+00006940: 6774 6822 2069 7320 6175 746f 6d61 7469  gth" is automati
+00006950: 6361 6c6c 790a 636f 6e66 6967 7572 6564  cally.configured
+00006960: 2074 6f20 7468 6520 7661 6c75 6520 6031   to the value `1
+00006970: 3720 2a20 3130 3234 202a 2031 3032 3460  7 * 1024 * 1024`
+00006980: 2e20 5468 6973 2076 616c 7565 2063 616e  . This value can
+00006990: 6e6f 7420 6265 2063 6861 6e67 6564 2e0a  not be changed..
+000069a0: 0a0a 2323 2045 7665 6e74 206f 626a 6563  ..## Event objec
+000069b0: 7473 3c61 2069 643d 2265 7665 6e74 2d6f  ts<a id="event-o
+000069c0: 626a 6563 7473 223e 3c2f 613e 0a0a 5468  bjects"></a>..Th
+000069d0: 6973 2070 6163 6b61 6765 2064 6566 696e  is package defin
+000069e0: 6573 2061 2060 4e65 7745 7665 6e74 6020  es a `NewEvent` 
+000069f0: 636c 6173 7320 616e 6420 6120 6052 6563  class and a `Rec
+00006a00: 6f72 6465 6445 7665 6e74 6020 636c 6173  ordedEvent` clas
+00006a10: 732e 2054 6865 0a60 4e65 7745 7665 6e74  s. The.`NewEvent
+00006a20: 6020 636c 6173 7320 7368 6f75 6c64 2062  ` class should b
+00006a30: 6520 7573 6564 2077 6865 6e20 7772 6974  e used when writ
+00006a40: 696e 6720 6576 656e 7473 2074 6f20 7468  ing events to th
+00006a50: 6520 6461 7461 6261 7365 2e20 5468 650a  e database. The.
+00006a60: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
+00006a70: 636c 6173 7320 6973 2075 7365 6420 7768  class is used wh
+00006a80: 656e 2072 6561 6469 6e67 2065 7665 6e74  en reading event
+00006a90: 7320 6672 6f6d 2074 6865 2064 6174 6162  s from the datab
+00006aa0: 6173 652e 0a0a 2323 2320 4e65 7720 6576  ase...### New ev
+00006ab0: 656e 7473 3c61 2069 643d 226e 6577 2d65  ents<a id="new-e
+00006ac0: 7665 6e74 7322 3e3c 2f61 3e0a 0a54 6865  vents"></a>..The
+00006ad0: 2060 4e65 7745 7665 6e74 6020 636c 6173   `NewEvent` clas
+00006ae0: 7320 7368 6f75 6c64 2062 6520 7573 6564  s should be used
+00006af0: 2077 6865 6e20 7772 6974 696e 6720 6576   when writing ev
+00006b00: 656e 7473 2074 6f20 616e 2045 7665 6e74  ents to an Event
+00006b10: 5374 6f72 6544 4220 6461 7461 6261 7365  StoreDB database
+00006b20: 2e0a 596f 7520 7769 6c6c 206e 6565 6420  ..You will need 
+00006b30: 746f 2063 6f6e 7374 7275 6374 206e 6577  to construct new
+00006b40: 2065 7665 6e74 206f 626a 6563 7473 2062   event objects b
+00006b50: 6566 6f72 6520 6361 6c6c 696e 6720 6061  efore calling `a
+00006b60: 7070 656e 645f 746f 5f73 7472 6561 6d28  ppend_to_stream(
+00006b70: 2960 2e0a 0a54 6865 2060 4e65 7745 7665  )`...The `NewEve
+00006b80: 6e74 6020 636c 6173 7320 6973 2061 2066  nt` class is a f
+00006b90: 726f 7a65 6e20 5079 7468 6f6e 2064 6174  rozen Python dat
+00006ba0: 6163 6c61 7373 2e20 4974 2068 6173 2074  aclass. It has t
+00006bb0: 776f 2072 6571 7569 7265 6420 636f 6e73  wo required cons
+00006bc0: 7472 7563 746f 720a 6172 6775 6d65 6e74  tructor.argument
+00006bd0: 7320 2860 7479 7065 6020 616e 6420 6064  s (`type` and `d
+00006be0: 6174 6160 2920 616e 6420 7468 7265 6520  ata`) and three 
+00006bf0: 6f70 7469 6f6e 616c 2063 6f6e 7374 7275  optional constru
+00006c00: 6374 6f72 2061 7267 756d 656e 7473 2028  ctor arguments (
+00006c10: 606d 6574 6164 6174 6160 2c0a 6063 6f6e  `metadata`,.`con
+00006c20: 7465 6e74 5f74 7970 6560 2061 6e64 2060  tent_type` and `
+00006c30: 6964 6029 2e0a 0a54 6865 2072 6571 7569  id`)...The requi
+00006c40: 7265 6420 6074 7970 6560 2061 7267 756d  red `type` argum
+00006c50: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+00006c60: 6073 7472 602c 2075 7365 6420 746f 2064  `str`, used to d
+00006c70: 6573 6372 6962 6520 7468 6520 7479 7065  escribe the type
+00006c80: 206f 660a 646f 6d61 696e 2065 7665 6e74   of.domain event
+00006c90: 2074 6861 7420 6973 2062 6569 6e67 2072   that is being r
+00006ca0: 6563 6f72 6465 642e 0a0a 5468 6520 7265  ecorded...The re
+00006cb0: 7175 6972 6564 2060 6461 7461 6020 6172  quired `data` ar
+00006cc0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00006cd0: 6f6e 2060 6279 7465 7360 206f 626a 6563  on `bytes` objec
+00006ce0: 742c 2075 7365 6420 746f 2073 7461 7465  t, used to state
+00006cf0: 2074 6865 0a73 6572 6961 6c69 7a65 6420   the.serialized 
+00006d00: 6461 7461 206f 6620 7468 6520 646f 6d61  data of the doma
+00006d10: 696e 2065 7665 6e74 2074 6861 7420 6973  in event that is
+00006d20: 2062 6569 6e67 2072 6563 6f72 6465 642e   being recorded.
+00006d30: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+00006d40: 6d65 7461 6461 7461 6020 6172 6775 6d65  metadata` argume
+00006d50: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+00006d60: 6279 7465 7360 206f 626a 6563 742c 2075  bytes` object, u
+00006d70: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
+00006d80: 616e 790a 6d65 7461 6461 7461 206f 6620  any.metadata of 
+00006d90: 7468 6520 6576 656e 7420 7468 6174 2077  the event that w
+00006da0: 696c 6c20 6265 2072 6563 6f72 6465 642e  ill be recorded.
+00006db0: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
+00006dc0: 7565 2069 7320 616e 2065 6d70 7479 2060  ue is an empty `
+00006dd0: 6279 7465 7360 0a6f 626a 6563 742e 0a0a  bytes`.object...
+00006de0: 5468 6520 6f70 7469 6f6e 616c 2060 636f  The optional `co
+00006df0: 6e74 656e 745f 7479 7065 6020 6172 6775  ntent_type` argu
+00006e00: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00006e10: 2060 7374 7260 2c20 7573 6564 2074 6f20   `str`, used to 
+00006e20: 696e 6469 6361 7465 2074 6865 0a6b 696e  indicate the.kin
+00006e30: 6420 6f66 2064 6174 6120 7468 6174 2069  d of data that i
+00006e40: 7320 6265 696e 6720 7265 636f 7264 6564  s being recorded
+00006e50: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+00006e60: 6c75 6520 6973 2060 2761 7070 6c69 6361  lue is `'applica
+00006e70: 7469 6f6e 2f6a 736f 6e27 602c 0a77 6869  tion/json'`,.whi
+00006e80: 6368 2069 6e64 6963 6174 6573 2074 6861  ch indicates tha
+00006e90: 7420 7468 6520 6064 6174 6160 2077 6173  t the `data` was
+00006ea0: 2073 6572 6961 6c69 7365 6420 7573 696e   serialised usin
+00006eb0: 6720 4a53 4f4e 2e20 416e 2061 6c74 6572  g JSON. An alter
+00006ec0: 6e61 7469 7665 2076 616c 7565 0a66 6f72  native value.for
+00006ed0: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
+00006ee0: 7320 7468 6520 6d6f 7265 2067 656e 6572  s the more gener
+00006ef0: 616c 2069 6e64 6963 6174 696f 6e20 6027  al indication `'
+00006f00: 6170 706c 6963 6174 696f 6e2f 6f63 7465  application/octe
+00006f10: 742d 7374 7265 616d 2760 2e0a 0a54 6865  t-stream'`...The
+00006f20: 206f 7074 696f 6e61 6c20 6069 6460 2061   optional `id` a
+00006f30: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00006f40: 686f 6e20 6055 5549 4460 206f 626a 6563  hon `UUID` objec
+00006f50: 742c 2075 7365 6420 746f 2073 7065 6369  t, used to speci
+00006f60: 6679 2074 6865 2075 6e69 7175 6520 4944  fy the unique ID
+00006f70: 0a6f 6620 7468 6520 6576 656e 7420 7468  .of the event th
+00006f80: 6174 2077 696c 6c20 6265 2072 6563 6f72  at will be recor
+00006f90: 6465 642e 2049 6620 6e6f 2076 616c 7565  ded. If no value
+00006fa0: 2069 7320 7072 6f76 6964 6564 2c20 6120   is provided, a 
+00006fb0: 6e65 7720 7665 7273 696f 6e2d 3420 5555  new version-4 UU
+00006fc0: 4944 0a77 696c 6c20 6265 2067 656e 6572  ID.will be gener
+00006fd0: 6174 6564 2e0a 0a60 6060 7079 7468 6f6e  ated...```python
+00006fe0: 0a6e 6577 5f65 7665 6e74 3120 3d20 4e65  .new_event1 = Ne
+00006ff0: 7745 7665 6e74 280a 2020 2020 7479 7065  wEvent(.    type
+00007000: 3d27 4f72 6465 7243 7265 6174 6564 272c  ='OrderCreated',
+00007010: 0a20 2020 2064 6174 613d 6227 7b22 6e61  .    data=b'{"na
+00007020: 6d65 223a 2022 4772 6567 227d 272c 0a29  me": "Greg"}',.)
+00007030: 0a61 7373 6572 7420 6e65 775f 6576 656e  .assert new_even
+00007040: 7431 2e74 7970 6520 3d3d 2027 4f72 6465  t1.type == 'Orde
+00007050: 7243 7265 6174 6564 270a 6173 7365 7274  rCreated'.assert
+00007060: 206e 6577 5f65 7665 6e74 312e 6461 7461   new_event1.data
+00007070: 203d 3d20 6227 7b22 6e61 6d65 223a 2022   == b'{"name": "
+00007080: 4772 6567 227d 270a 6173 7365 7274 206e  Greg"}'.assert n
+00007090: 6577 5f65 7665 6e74 312e 6d65 7461 6461  ew_event1.metada
+000070a0: 7461 203d 3d20 6227 270a 6173 7365 7274  ta == b''.assert
+000070b0: 206e 6577 5f65 7665 6e74 312e 636f 6e74   new_event1.cont
+000070c0: 656e 745f 7479 7065 203d 3d20 2761 7070  ent_type == 'app
+000070d0: 6c69 6361 7469 6f6e 2f6a 736f 6e27 0a61  lication/json'.a
+000070e0: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+000070f0: 286e 6577 5f65 7665 6e74 312e 6964 2c20  (new_event1.id, 
+00007100: 7575 6964 2e55 5549 4429 0a0a 6576 656e  uuid.UUID)..even
+00007110: 745f 6964 203d 2075 7569 642e 7575 6964  t_id = uuid.uuid
+00007120: 3428 290a 6e65 775f 6576 656e 7432 203d  4().new_event2 =
+00007130: 204e 6577 4576 656e 7428 0a20 2020 2074   NewEvent(.    t
+00007140: 7970 653d 2749 6d61 6765 4372 6561 7465  ype='ImageCreate
+00007150: 6427 2c0a 2020 2020 6461 7461 3d62 2730  d',.    data=b'0
+00007160: 3130 3130 3130 3130 3130 3130 3127 2c0a  1010101010101',.
+00007170: 2020 2020 6d65 7461 6461 7461 3d62 277b      metadata=b'{
+00007180: 2261 223a 2031 7d27 2c0a 2020 2020 636f  "a": 1}',.    co
+00007190: 6e74 656e 745f 7479 7065 3d27 6170 706c  ntent_type='appl
+000071a0: 6963 6174 696f 6e2f 6f63 7465 742d 7374  ication/octet-st
+000071b0: 7265 616d 272c 0a20 2020 2069 643d 6576  ream',.    id=ev
+000071c0: 656e 745f 6964 2c0a 290a 6173 7365 7274  ent_id,.).assert
+000071d0: 206e 6577 5f65 7665 6e74 322e 7479 7065   new_event2.type
+000071e0: 203d 3d20 2749 6d61 6765 4372 6561 7465   == 'ImageCreate
+000071f0: 6427 0a61 7373 6572 7420 6e65 775f 6576  d'.assert new_ev
+00007200: 656e 7432 2e64 6174 6120 3d3d 2062 2730  ent2.data == b'0
+00007210: 3130 3130 3130 3130 3130 3130 3127 0a61  1010101010101'.a
+00007220: 7373 6572 7420 6e65 775f 6576 656e 7432  ssert new_event2
+00007230: 2e6d 6574 6164 6174 6120 3d3d 2062 277b  .metadata == b'{
+00007240: 2261 223a 2031 7d27 0a61 7373 6572 7420  "a": 1}'.assert 
+00007250: 6e65 775f 6576 656e 7432 2e63 6f6e 7465  new_event2.conte
+00007260: 6e74 5f74 7970 6520 3d3d 2027 6170 706c  nt_type == 'appl
+00007270: 6963 6174 696f 6e2f 6f63 7465 742d 7374  ication/octet-st
+00007280: 7265 616d 270a 6173 7365 7274 206e 6577  ream'.assert new
+00007290: 5f65 7665 6e74 322e 6964 203d 3d20 6576  _event2.id == ev
+000072a0: 656e 745f 6964 0a60 6060 0a0a 2323 2320  ent_id.```..### 
+000072b0: 5265 636f 7264 6564 2065 7665 6e74 733c  Recorded events<
+000072c0: 6120 6964 3d22 7265 636f 7264 6564 2d65  a id="recorded-e
+000072d0: 7665 6e74 7322 3e3c 2f61 3e0a 0a54 6865  vents"></a>..The
+000072e0: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+000072f0: 2063 6c61 7373 2069 7320 7573 6564 2077   class is used w
+00007300: 6865 6e20 7265 6164 696e 6720 6576 656e  hen reading even
+00007310: 7473 2066 726f 6d20 616e 2045 7665 6e74  ts from an Event
+00007320: 5374 6f72 6544 420a 6461 7461 6261 7365  StoreDB.database
+00007330: 2e20 5468 6520 636c 6965 6e74 2077 696c  . The client wil
+00007340: 6c20 7265 7475 726e 2065 7665 6e74 206f  l return event o
+00007350: 626a 6563 7473 206f 6620 7468 6973 2074  bjects of this t
+00007360: 7970 6520 6672 6f6d 2061 6c6c 206d 6574  ype from all met
+00007370: 686f 6473 0a74 6861 7420 7265 7475 726e  hods.that return
+00007380: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+00007390: 2c20 7375 6368 2061 7320 6067 6574 5f73  , such as `get_s
+000073a0: 7472 6561 6d28 2960 2c20 6073 7562 7363  tream()`, `subsc
+000073b0: 7269 6265 5f74 6f5f 616c 6c28 2960 2c0a  ribe_to_all()`,.
+000073c0: 616e 6420 6072 6561 645f 7375 6273 6372  and `read_subscr
+000073d0: 6970 7469 6f6e 5f74 6f5f 616c 6c28 2960  iption_to_all()`
+000073e0: 2e20 596f 7520 646f 206e 6f74 206e 6565  . You do not nee
+000073f0: 6420 746f 2063 6f6e 7374 7275 6374 2072  d to construct r
+00007400: 6563 6f72 6465 6420 6576 656e 7420 6f62  ecorded event ob
+00007410: 6a65 6374 732e 0a0a 4c69 6b65 2060 4e65  jects...Like `Ne
+00007420: 7745 7665 6e74 602c 2074 6865 2060 5265  wEvent`, the `Re
+00007430: 636f 7264 6564 4576 656e 7460 2063 6c61  cordedEvent` cla
+00007440: 7373 2069 7320 6120 6672 6f7a 656e 2050  ss is a frozen P
+00007450: 7974 686f 6e20 6461 7461 636c 6173 732e  ython dataclass.
+00007460: 2049 7420 6861 730a 616c 6c20 7468 6520   It has.all the 
+00007470: 6174 7472 6962 7574 6573 2074 6861 7420  attributes that 
+00007480: 604e 6577 4576 656e 7460 2068 6173 2028  `NewEvent` has (
+00007490: 6074 7970 6560 2c20 6064 6174 6160 2c20  `type`, `data`, 
+000074a0: 606d 6574 6164 6174 6160 2c20 6063 6f6e  `metadata`, `con
+000074b0: 7465 6e74 5f74 7970 6560 2c20 6069 6460  tent_type`, `id`
+000074c0: 290a 7468 6174 2066 6f6c 6c6f 7720 6672  ).that follow fr
+000074d0: 6f6d 2061 6e20 6576 656e 7420 7468 6174  om an event that
+000074e0: 2077 6173 2072 6563 6f72 6465 642c 2061   was recorded, a
+000074f0: 6e64 2073 6f6d 6520 6164 6469 7469 6f6e  nd some addition
+00007500: 616c 2061 7474 7269 6275 7465 7320 7468  al attributes th
+00007510: 6174 2066 6f6c 6c6f 770a 6672 6f6d 2074  at follow.from t
+00007520: 6865 2072 6563 6f72 6469 6e67 206f 6620  he recording of 
+00007530: 616e 2065 7665 6e74 2028 6073 7472 6561  an event (`strea
+00007540: 6d5f 6e61 6d65 602c 2060 7374 7265 616d  m_name`, `stream
+00007550: 5f70 6f73 6974 696f 6e60 2c20 6063 6f6d  _position`, `com
+00007560: 6d69 745f 706f 7369 7469 6f6e 602c 0a60  mit_position`,.`
+00007570: 7265 636f 7264 6564 5f61 7460 292e 2049  recorded_at`). I
+00007580: 7420 616c 736f 2068 6173 2061 2060 6c69  t also has a `li
+00007590: 6e6b 6020 6174 7472 6962 7574 652c 2077  nk` attribute, w
+000075a0: 6869 6368 2069 7320 7365 7420 6f6e 6c79  hich is set only
+000075b0: 2077 6865 6e20 226c 696e 6b20 6576 656e   when "link even
+000075c0: 7473 220a 6172 6520 2272 6573 6f6c 7665  ts".are "resolve
+000075d0: 6422 2e20 416e 6420 6974 2068 6173 2061  d". And it has a
+000075e0: 2060 7265 7472 795f 636f 756e 7460 2077   `retry_count` w
+000075f0: 6869 6368 2069 7320 7365 7420 6f6e 6c79  hich is set only
+00007600: 2077 6865 6e20 7265 6164 696e 6720 7065   when reading pe
+00007610: 7273 6973 7465 6e63 650a 7375 6273 6372  rsistence.subscr
+00007620: 6970 7469 6f6e 732e 0a0a 5468 6520 6074  iptions...The `t
+00007630: 7970 6560 2061 7474 7269 6275 7465 2069  ype` attribute i
+00007640: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
+00007650: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
+00007660: 7465 2074 6865 2074 7970 6520 6f66 2061  te the type of a
+00007670: 6e20 6576 656e 740a 7468 6174 2077 6173  n event.that was
+00007680: 2072 6563 6f72 6465 642e 0a0a 5468 6520   recorded...The 
+00007690: 6064 6174 6160 2061 7474 7269 6275 7465  `data` attribute
+000076a0: 2069 7320 6120 5079 7468 6f6e 2060 6279   is a Python `by
+000076b0: 7465 7360 206f 626a 6563 742c 2075 7365  tes` object, use
+000076c0: 6420 746f 2069 6e64 6963 6174 6520 7468  d to indicate th
+000076d0: 6520 6461 7461 206f 6620 616e 0a65 7665  e data of an.eve
+000076e0: 6e74 2074 6861 7420 7761 7320 7265 636f  nt that was reco
+000076f0: 7264 6564 2e0a 0a54 6865 2060 6d65 7461  rded...The `meta
+00007700: 6461 7461 6020 6174 7472 6962 7574 6520  data` attribute 
+00007710: 6973 2061 2050 7974 686f 6e20 6062 7974  is a Python `byt
+00007720: 6573 6020 6f62 6a65 6374 2c20 7573 6564  es` object, used
+00007730: 2074 6f20 696e 6469 6361 7465 2074 6865   to indicate the
+00007740: 206d 6574 6164 6174 6120 6f66 0a61 6e20   metadata of.an 
+00007750: 6576 656e 7420 7468 6174 2077 6173 2072  event that was r
+00007760: 6563 6f72 6465 642e 0a0a 5468 6520 6063  ecorded...The `c
+00007770: 6f6e 7465 6e74 5f74 7970 6560 2061 7474  ontent_type` att
+00007780: 7269 6275 7465 2069 7320 6120 5079 7468  ribute is a Pyth
+00007790: 6f6e 2060 7374 7260 2c20 7573 6564 2074  on `str`, used t
+000077a0: 6f20 696e 6469 6361 7465 2074 6865 2074  o indicate the t
+000077b0: 7970 6520 6f66 0a64 6174 6120 7468 6174  ype of.data that
+000077c0: 2077 6173 2072 6563 6f72 6465 6420 666f   was recorded fo
+000077d0: 7220 616e 2065 7665 6e74 2e20 4974 2069  r an event. It i
+000077e0: 7320 7573 7561 6c6c 7920 6027 6170 706c  s usually `'appl
+000077f0: 6963 6174 696f 6e2f 6a73 6f6e 2760 2c20  ication/json'`, 
+00007800: 696e 6469 6361 7469 6e67 0a74 6861 7420  indicating.that 
+00007810: 7468 6520 6461 7461 2063 616e 2062 6520  the data can be 
+00007820: 7061 7273 6564 2061 7320 4a53 4f4e 2e20  parsed as JSON. 
+00007830: 416c 7465 726e 6174 6976 656c 792c 2069  Alternatively, i
+00007840: 7420 6973 2060 2761 7070 6c69 6361 7469  t is `'applicati
+00007850: 6f6e 2f6f 6374 6574 2d73 7472 6561 6d27  on/octet-stream'
+00007860: 602e 0a0a 5468 6520 6069 6460 2061 7474  `...The `id` att
+00007870: 7269 6275 7465 2069 7320 6120 5079 7468  ribute is a Pyth
+00007880: 6f6e 2060 5555 4944 6020 6f62 6a65 6374  on `UUID` object
+00007890: 2c20 7573 6564 2074 6f20 696e 6469 6361  , used to indica
+000078a0: 7465 2074 6865 2075 6e69 7175 6520 4944  te the unique ID
+000078b0: 206f 6620 616e 0a65 7665 6e74 2074 6861   of an.event tha
+000078c0: 7420 7761 7320 7265 636f 7264 6564 2e0a  t was recorded..
+000078d0: 0a54 6865 2060 7374 7265 616d 5f6e 616d  .The `stream_nam
+000078e0: 6560 2061 7474 7269 6275 7465 2069 7320  e` attribute is 
+000078f0: 6120 5079 7468 6f6e 2060 7374 7260 2c20  a Python `str`, 
+00007900: 7573 6564 2074 6f20 696e 6469 6361 7465  used to indicate
+00007910: 2074 6865 206e 616d 6520 6f66 2061 0a73   the name of a.s
+00007920: 7472 6561 6d20 696e 2077 6869 6368 2061  tream in which a
+00007930: 6e20 6576 656e 7420 7761 7320 7265 636f  n event was reco
+00007940: 7264 6564 2e0a 0a54 6865 2060 7374 7265  rded...The `stre
+00007950: 616d 5f70 6f73 6974 696f 6e60 2061 7474  am_position` att
+00007960: 7269 6275 7465 2069 7320 6120 5079 7468  ribute is a Pyth
+00007970: 6f6e 2060 696e 7460 2c20 7573 6564 2074  on `int`, used t
+00007980: 6f20 696e 6469 6361 7465 2074 6865 2070  o indicate the p
+00007990: 6f73 6974 696f 6e20 696e 2061 0a73 7472  osition in a.str
+000079a0: 6561 6d20 6174 2077 6869 6368 2061 6e20  eam at which an 
+000079b0: 6576 656e 7420 7761 7320 7265 636f 7264  event was record
+000079c0: 6564 2e0a 0a49 6e20 4576 656e 7453 746f  ed...In EventSto
+000079d0: 7265 4442 2c20 6120 2273 7472 6561 6d20  reDB, a "stream 
+000079e0: 706f 7369 7469 6f6e 2220 6973 2061 6e20  position" is an 
+000079f0: 696e 7465 6765 7220 7265 7072 6573 656e  integer represen
+00007a00: 7469 6e67 2074 6865 2070 6f73 6974 696f  ting the positio
+00007a10: 6e20 6f66 2061 0a72 6563 6f72 6465 6420  n of a.recorded 
+00007a20: 6576 656e 7420 696e 2061 2073 7472 6561  event in a strea
+00007a30: 6d2e 2045 6163 6820 7265 636f 7264 6564  m. Each recorded
+00007a40: 2065 7665 6e74 2069 7320 7265 636f 7264   event is record
+00007a50: 6564 2061 7420 6120 706f 7369 7469 6f6e  ed at a position
+00007a60: 2069 6e20 6120 7374 7265 616d 2e0a 4561   in a stream..Ea
+00007a70: 6368 2073 7472 6561 6d20 706f 7369 7469  ch stream positi
+00007a80: 6f6e 2069 7320 6f63 6375 7069 6564 2062  on is occupied b
+00007a90: 7920 6f6e 6c79 206f 6e65 2072 6563 6f72  y only one recor
+00007aa0: 6465 6420 6576 656e 742e 204e 6577 2065  ded event. New e
+00007ab0: 7665 6e74 7320 6172 6520 7265 636f 7264  vents are record
+00007ac0: 6564 2061 7420 7468 650a 6e65 7874 2075  ed at the.next u
+00007ad0: 6e6f 6363 7570 6965 6420 706f 7369 7469  noccupied positi
+00007ae0: 6f6e 2e20 416c 6c20 7365 7175 656e 6365  on. All sequence
+00007af0: 7320 6f66 2073 7472 6561 6d20 706f 7369  s of stream posi
+00007b00: 7469 6f6e 7320 6172 6520 7a65 726f 2d62  tions are zero-b
+00007b10: 6173 6564 2061 6e64 2067 6170 6c65 7373  ased and gapless
+00007b20: 2e0a 0a54 6865 2060 636f 6d6d 6974 5f70  ...The `commit_p
+00007b30: 6f73 6974 696f 6e60 2061 7474 7269 6275  osition` attribu
+00007b40: 7465 2069 7320 6120 5079 7468 6f6e 2060  te is a Python `
+00007b50: 696e 7460 2c20 7573 6564 2074 6f20 696e  int`, used to in
+00007b60: 6469 6361 7465 2074 6865 2070 6f73 6974  dicate the posit
+00007b70: 696f 6e20 696e 2074 6865 0a64 6174 6162  ion in the.datab
+00007b80: 6173 6520 6174 2077 6869 6368 2061 6e20  ase at which an 
+00007b90: 6576 656e 7420 7761 7320 7265 636f 7264  event was record
+00007ba0: 6564 2e0a 0a49 6e20 4576 656e 7453 746f  ed...In EventSto
+00007bb0: 7265 4442 2c20 6120 2263 6f6d 6d69 7420  reDB, a "commit 
+00007bc0: 706f 7369 7469 6f6e 2220 6973 2061 6e20  position" is an 
+00007bd0: 696e 7465 6765 7220 7265 7072 6573 656e  integer represen
+00007be0: 7469 6e67 2074 6865 2070 6f73 6974 696f  ting the positio
+00007bf0: 6e20 6f66 2061 0a72 6563 6f72 6465 6420  n of a.recorded 
+00007c00: 6576 656e 7420 696e 2074 6865 2064 6174  event in the dat
+00007c10: 6162 6173 652e 2045 6163 6820 7265 636f  abase. Each reco
+00007c20: 7264 6564 2065 7665 6e74 2069 7320 7265  rded event is re
+00007c30: 636f 7264 6564 2061 7420 6120 706f 7369  corded at a posi
+00007c40: 7469 6f6e 2069 6e20 7468 650a 6461 7461  tion in the.data
+00007c50: 6261 7365 2e20 4561 6368 2063 6f6d 6d69  base. Each commi
+00007c60: 7420 706f 7369 7469 6f6e 2069 7320 6f63  t position is oc
+00007c70: 6375 7069 6564 2062 7920 6f6e 6c79 206f  cupied by only o
+00007c80: 6e65 2072 6563 6f72 6465 6420 6576 656e  ne recorded even
+00007c90: 742e 2043 6f6d 6d69 7420 706f 7369 7469  t. Commit positi
+00007ca0: 6f6e 730a 6172 6520 7a65 726f 2d62 6173  ons.are zero-bas
+00007cb0: 6564 2061 6e64 2069 6e63 7265 6173 6520  ed and increase 
+00007cc0: 6d6f 6e6f 746f 6e69 6361 6c6c 7920 6173  monotonically as
+00007cd0: 206e 6577 2065 7665 6e74 7320 6172 6520   new events are 
+00007ce0: 7265 636f 7264 6564 2e20 4275 742c 2075  recorded. But, u
+00007cf0: 6e6c 696b 6520 7374 7265 616d 0a70 6f73  nlike stream.pos
+00007d00: 6974 696f 6e73 2c20 7468 6520 7365 7175  itions, the sequ
+00007d10: 656e 6365 206f 6620 7375 6363 6573 7369  ence of successi
+00007d20: 7665 2063 6f6d 6d69 7420 706f 7369 7469  ve commit positi
+00007d30: 6f6e 7320 6973 206e 6f74 2067 6170 6c65  ons is not gaple
+00007d40: 7373 2e20 496e 6465 6564 2c20 7468 6572  ss. Indeed, ther
+00007d50: 6520 6172 650a 7573 7561 6c6c 7920 6c61  e are.usually la
+00007d60: 7267 6520 6469 6666 6572 656e 6365 7320  rge differences 
+00007d70: 6265 7477 6565 6e20 7468 6520 636f 6d6d  between the comm
+00007d80: 6974 2070 6f73 6974 696f 6e73 206f 6620  it positions of 
+00007d90: 7375 6363 6573 7369 7665 6c79 2072 6563  successively rec
+00007da0: 6f72 6465 6420 6576 656e 7473 2e0a 0a50  orded events...P
+00007db0: 6c65 6173 6520 6e6f 7465 2c20 696e 2045  lease note, in E
+00007dc0: 7665 6e74 5374 6f72 6544 4220 3231 2e31  ventStoreDB 21.1
+00007dd0: 302c 2074 6865 2060 636f 6d6d 6974 5f70  0, the `commit_p
+00007de0: 6f73 6974 696f 6e60 206f 6620 616c 6c20  osition` of all 
+00007df0: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
+00007e00: 6f62 6a65 6374 730a 6f62 7461 696e 6564  objects.obtained
+00007e10: 2066 726f 6d20 6072 6561 645f 7374 7265   from `read_stre
+00007e20: 616d 2829 6020 6973 2060 4e6f 6e65 602c  am()` is `None`,
+00007e30: 2077 6865 7265 6173 2074 686f 7365 206f   whereas those o
+00007e40: 6274 6169 6e65 6420 6672 6f6d 2060 7265  btained from `re
+00007e50: 6164 5f61 6c6c 2829 6020 6861 7665 0a74  ad_all()` have.t
+00007e60: 6865 2061 6374 7561 6c20 636f 6d6d 6974  he actual commit
+00007e70: 2070 6f73 6974 696f 6e20 6f66 2074 6865   position of the
+00007e80: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
+00007e90: 2054 6869 7320 7761 7320 6368 616e 6765   This was change
+00007ea0: 6420 696e 2076 6572 7369 6f6e 2032 322e  d in version 22.
+00007eb0: 3130 2c20 736f 0a74 6861 7420 6576 656e  10, so.that even
+00007ec0: 7420 6f62 6a65 6374 7320 6f62 7461 696e  t objects obtain
+00007ed0: 6564 2066 726f 6d20 626f 7468 2060 6765  ed from both `ge
+00007ee0: 745f 7374 7265 616d 2829 6020 616e 6420  t_stream()` and 
+00007ef0: 6072 6561 645f 616c 6c28 2960 2068 6176  `read_all()` hav
+00007f00: 6520 7468 6520 6163 7475 616c 0a63 6f6d  e the actual.com
+00007f10: 6d69 7420 706f 7369 7469 6f6e 2e20 5468  mit position. Th
+00007f20: 6520 6063 6f6d 6d69 745f 706f 7369 7469  e `commit_positi
+00007f30: 6f6e 6020 6174 7472 6962 7574 6520 6f66  on` attribute of
+00007f40: 2074 6865 2060 5265 636f 7264 6564 4576   the `RecordedEv
+00007f50: 656e 7460 2063 6c61 7373 2069 730a 616e  ent` class is.an
+00007f60: 6e6f 7461 7465 6420 7769 7468 2074 6865  notated with the
+00007f70: 2074 7970 6520 604f 7074 696f 6e61 6c5b   type `Optional[
+00007f80: 696e 745d 6020 666f 7220 7468 6973 2072  int]` for this r
+00007f90: 6561 736f 6e20 6f6e 6c79 2e0a 0a54 6865  eason only...The
+00007fa0: 2060 7265 636f 7264 6564 5f61 7460 2061   `recorded_at` a
+00007fb0: 7474 7269 6275 7465 2069 7320 6120 5079  ttribute is a Py
+00007fc0: 7468 6f6e 2060 6461 7465 7469 6d65 602c  thon `datetime`,
+00007fd0: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
+00007fe0: 6520 7768 656e 2061 6e20 6576 656e 7420  e when an event 
+00007ff0: 7761 730a 7265 636f 7264 6564 2062 7920  was.recorded by 
+00008000: 7468 6520 6461 7461 6261 7365 2e0a 0a54  the database...T
+00008010: 6865 2060 6c69 6e6b 6020 6174 7472 6962  he `link` attrib
+00008020: 7574 6520 6973 2061 6e20 6f70 7469 6f6e  ute is an option
+00008030: 616c 2060 5265 636f 7264 6564 4576 656e  al `RecordedEven
+00008040: 7460 2074 6861 7420 6361 7272 6965 7320  t` that carries 
+00008050: 696e 666f 726d 6174 696f 6e20 6162 6f75  information abou
+00008060: 740a 6120 226c 696e 6b20 6576 656e 7422  t.a "link event"
+00008070: 2074 6861 7420 6861 7320 6265 656e 2022   that has been "
+00008080: 7265 736f 6c76 6564 2220 746f 2074 6865  resolved" to the
+00008090: 206c 696e 6b65 6420 6576 656e 742e 2054   linked event. T
+000080a0: 6869 7320 616c 6c6f 7773 2061 6363 6573  his allows acces
+000080b0: 7320 746f 0a74 6865 206c 696e 6b20 6576  s to.the link ev
+000080c0: 656e 7420 6174 7472 6962 7574 6573 2077  ent attributes w
+000080d0: 6865 6e20 6c69 6e6b 2065 7665 6e74 7320  hen link events 
+000080e0: 6861 7665 2062 6565 6e20 7265 736f 6c76  have been resolv
+000080f0: 6564 2c20 666f 7220 6578 616d 706c 6520  ed, for example 
+00008100: 6163 6365 7373 0a74 6f20 7468 6520 636f  access.to the co
+00008110: 7272 6563 7420 6576 656e 7420 4944 2074  rrect event ID t
+00008120: 6f20 6265 2075 7365 6420 7768 656e 2061  o be used when a
+00008130: 636b 6e6f 776c 6564 6769 6e67 206f 7220  cknowledging or 
+00008140: 6e65 6761 7469 7665 6c79 2061 636b 6e6f  negatively ackno
+00008150: 776c 6564 6769 6e67 0a6c 696e 6b20 6576  wledging.link ev
+00008160: 656e 7473 2e20 4c69 6e6b 2065 7665 6e74  ents. Link event
+00008170: 7320 6172 6520 2272 6573 6f6c 7665 6422  s are "resolved"
+00008180: 2077 6865 6e20 7468 6520 6072 6573 6f6c   when the `resol
+00008190: 7665 5f6c 696e 6b73 6020 6172 6775 6d65  ve_links` argume
+000081a0: 6e74 2069 7320 6054 7275 6560 0a61 6e64  nt is `True`.and
+000081b0: 2077 6865 6e20 7265 706c 6179 696e 6720   when replaying 
+000081c0: 7061 726b 6564 2065 7665 6e74 7320 286e  parked events (n
+000081d0: 6567 6174 6976 656c 7920 6163 6b6e 6f77  egatively acknow
+000081e0: 6c65 6467 696e 6720 616e 2065 7665 6e74  ledging an event
+000081f0: 2072 6563 6569 7665 6420 6672 6f6d 0a61   received from.a
+00008200: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00008210: 6372 6970 7469 6f6e 2077 6974 6820 7468  cription with th
+00008220: 6520 6027 7061 726b 2760 2061 6374 696f  e `'park'` actio
+00008230: 6e20 7769 6c6c 2063 7265 6174 6520 6120  n will create a 
+00008240: 6c69 6e6b 2065 7665 6e74 2c20 616e 640a  link event, and.
+00008250: 7768 656e 2070 6172 6b65 6420 6576 656e  when parked even
+00008260: 7420 6172 6520 7265 706c 6179 6564 2074  t are replayed t
+00008270: 6865 7920 6172 6520 7265 6365 6976 6564  hey are received
+00008280: 2061 7320 7265 736f 6c76 6564 2065 7665   as resolved eve
+00008290: 6e74 7329 2e20 5468 650a 6061 636b 5f69  nts). The.`ack_i
+000082a0: 6460 2070 726f 7065 7274 7920 6865 6c70  d` property help
+000082b0: 7320 7769 7468 206f 6274 6169 6e69 6e67  s with obtaining
+000082c0: 2074 6865 2063 6f72 7265 6374 2065 7665   the correct eve
+000082d0: 6e74 2049 4420 746f 2075 7365 2077 6865  nt ID to use whe
+000082e0: 6e20 6163 6b6e 6f77 6c65 6467 696e 670a  n acknowledging.
+000082f0: 6f72 206e 6567 6174 6976 656c 7920 6163  or negatively ac
+00008300: 6b6e 6f77 6c65 6467 696e 6720 6576 656e  knowledging even
+00008310: 7473 2072 6563 6569 7665 6420 6672 6f6d  ts received from
+00008320: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+00008330: 6372 6970 7469 6f6e 732e 0a0a 5468 6520  criptions...The 
+00008340: 6072 6574 7279 5f63 6f75 6e74 6020 6973  `retry_count` is
+00008350: 2061 2050 7974 686f 6e20 6069 6e74 602c   a Python `int`,
+00008360: 2075 7365 6420 746f 2069 6e64 6963 6174   used to indicat
+00008370: 6520 7468 6520 6e75 6d62 6572 206f 6620  e the number of 
+00008380: 7469 6d65 7320 6120 7065 7273 6973 7465  times a persiste
+00008390: 6e74 0a73 7562 7363 7269 7074 696f 6e20  nt.subscription 
+000083a0: 6861 7320 7265 7472 6965 6420 7365 6e64  has retried send
+000083b0: 696e 6720 7468 6520 6576 656e 7420 746f  ing the event to
+000083c0: 2061 2063 6f6e 7375 6d65 722e 0a0a 0a60   a consumer....`
+000083d0: 6060 7079 7468 6f6e 0a66 726f 6d20 6461  ``python.from da
+000083e0: 7461 636c 6173 7365 7320 696d 706f 7274  taclasses import
+000083f0: 2064 6174 6163 6c61 7373 0a66 726f 6d20   dataclass.from 
+00008400: 6461 7465 7469 6d65 2069 6d70 6f72 7420  datetime import 
+00008410: 6461 7465 7469 6d65 0a0a 4064 6174 6163  datetime..@datac
+00008420: 6c61 7373 2866 726f 7a65 6e3d 5472 7565  lass(frozen=True
+00008430: 290a 636c 6173 7320 5265 636f 7264 6564  ).class Recorded
+00008440: 4576 656e 743a 0a20 2020 2022 2222 0a20  Event:.    """. 
+00008450: 2020 2045 6e63 6170 7375 6c61 7465 7320     Encapsulates 
+00008460: 6576 656e 7420 6461 7461 2074 6861 7420  event data that 
+00008470: 6861 7320 6265 656e 2072 6563 6f72 6465  has been recorde
+00008480: 6420 696e 2045 7665 6e74 5374 6f72 6544  d in EventStoreD
+00008490: 422e 0a20 2020 2022 2222 0a0a 2020 2020  B..    """..    
+000084a0: 7479 7065 3a20 7374 720a 2020 2020 6461  type: str.    da
+000084b0: 7461 3a20 6279 7465 730a 2020 2020 6d65  ta: bytes.    me
+000084c0: 7461 6461 7461 3a20 6279 7465 730a 2020  tadata: bytes.  
+000084d0: 2020 636f 6e74 656e 745f 7479 7065 3a20    content_type: 
+000084e0: 7374 720a 2020 2020 6964 3a20 5555 4944  str.    id: UUID
+000084f0: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+00008500: 3a20 7374 720a 2020 2020 7374 7265 616d  : str.    stream
+00008510: 5f70 6f73 6974 696f 6e3a 2069 6e74 0a20  _position: int. 
+00008520: 2020 2063 6f6d 6d69 745f 706f 7369 7469     commit_positi
+00008530: 6f6e 3a20 4f70 7469 6f6e 616c 5b69 6e74  on: Optional[int
+00008540: 5d0a 2020 2020 7265 636f 7264 6564 5f61  ].    recorded_a
+00008550: 743a 204f 7074 696f 6e61 6c5b 6461 7465  t: Optional[date
+00008560: 7469 6d65 5d20 3d20 4e6f 6e65 0a20 2020  time] = None.   
+00008570: 206c 696e 6b3a 204f 7074 696f 6e61 6c5b   link: Optional[
+00008580: 2252 6563 6f72 6465 6445 7665 6e74 225d  "RecordedEvent"]
+00008590: 203d 204e 6f6e 650a 2020 2020 7265 7472   = None.    retr
+000085a0: 795f 636f 756e 743a 204f 7074 696f 6e61  y_count: Optiona
+000085b0: 6c5b 696e 745d 203d 204e 6f6e 650a 0a20  l[int] = None.. 
+000085c0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+000085d0: 2064 6566 2061 636b 5f69 6428 7365 6c66   def ack_id(self
+000085e0: 2920 2d3e 2055 5549 443a 0a20 2020 2020  ) -> UUID:.     
+000085f0: 2020 2069 6620 7365 6c66 2e6c 696e 6b20     if self.link 
+00008600: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00008610: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00008620: 7365 6c66 2e6c 696e 6b2e 6964 0a20 2020  self.link.id.   
+00008630: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00008640: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00008650: 6c66 2e69 640a 0a20 2020 2040 7072 6f70  lf.id..    @prop
+00008660: 6572 7479 0a20 2020 2064 6566 2069 735f  erty.    def is_
+00008670: 7379 7374 656d 5f65 7665 6e74 2873 656c  system_event(sel
+00008680: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
+00008690: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000086a0: 7479 7065 2e73 7461 7274 7377 6974 6828  type.startswith(
+000086b0: 2224 2229 0a0a 2020 2020 4070 726f 7065  "$")..    @prope
+000086c0: 7274 790a 2020 2020 6465 6620 6973 5f6c  rty.    def is_l
+000086d0: 696e 6b5f 6576 656e 7428 7365 6c66 2920  ink_event(self) 
+000086e0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+000086f0: 2072 6574 7572 6e20 7365 6c66 2e74 7970   return self.typ
+00008700: 6520 3d3d 2022 243e 220a 0a20 2020 2040  e == "$>"..    @
+00008710: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00008720: 2069 735f 7265 736f 6c76 6564 5f65 7665   is_resolved_eve
+00008730: 6e74 2873 656c 6629 202d 3e20 626f 6f6c  nt(self) -> bool
+00008740: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00008750: 2073 656c 662e 6c69 6e6b 2069 7320 6e6f   self.link is no
+00008760: 7420 4e6f 6e65 0a0a 2020 2020 4070 726f  t None..    @pro
+00008770: 7065 7274 790a 2020 2020 6465 6620 6973  perty.    def is
+00008780: 5f63 6865 636b 706f 696e 7428 7365 6c66  _checkpoint(self
+00008790: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
+000087a0: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+000087b0: 6060 600a 0a54 6865 2070 726f 7065 7274  ```..The propert
+000087c0: 7920 6061 636b 5f69 6460 2063 616e 2062  y `ack_id` can b
+000087d0: 6520 7573 6564 2074 6f20 6f62 7461 696e  e used to obtain
+000087e0: 2074 6865 2063 6f72 7265 6374 2065 7665   the correct eve
+000087f0: 6e74 2049 4420 746f 2060 6163 6b28 2960  nt ID to `ack()`
+00008800: 206f 7220 606e 6163 6b28 2960 0a65 7665   or `nack()`.eve
+00008810: 6e74 7320 7265 6365 6976 6564 2077 6865  nts received whe
+00008820: 6e20 7265 6164 696e 6720 7065 7273 6973  n reading persis
+00008830: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00008840: 6e73 2e20 5468 6520 7265 7475 726e 6564  ns. The returned
+00008850: 2076 616c 7565 2069 7320 6569 7468 6572   value is either
+00008860: 2074 6865 0a76 616c 7565 206f 6620 7468   the.value of th
+00008870: 6520 6069 6460 2061 7474 7269 6275 7465  e `id` attribute
+00008880: 206f 6620 7468 6520 606c 696e 6b60 2061   of the `link` a
+00008890: 7474 7269 6275 7465 2c20 6966 2060 6c69  ttribute, if `li
+000088a0: 6e6b 6020 6973 206e 6f74 2060 4e6f 6e65  nk` is not `None
+000088b0: 602c 206f 7468 6572 7769 7365 0a69 7420  `, otherwise.it 
+000088c0: 6973 2074 6865 2076 616c 7565 206f 6620  is the value of 
+000088d0: 7468 6520 6069 6460 2061 7474 7269 6275  the `id` attribu
+000088e0: 7465 2e0a 0a54 6865 2070 726f 7065 7274  te...The propert
+000088f0: 7920 6069 735f 7379 7374 656d 5f65 7665  y `is_system_eve
+00008900: 6e74 6020 696e 6469 6361 7465 7320 7768  nt` indicates wh
+00008910: 6574 6865 7220 7468 6520 6576 656e 7420  ether the event 
+00008920: 6973 2061 2022 7379 7374 656d 2065 7665  is a "system eve
+00008930: 6e74 222e 2053 7973 7465 6d0a 6576 656e  nt". System.even
+00008940: 7473 2068 6176 6520 6120 6074 7970 6560  ts have a `type`
+00008950: 2076 616c 7565 2074 6861 7420 7374 6172   value that star
+00008960: 7473 2077 6974 6820 6027 2427 602e 0a0a  ts with `'$'`...
+00008970: 5468 6520 7072 6f70 6572 7479 2060 6973  The property `is
+00008980: 5f6c 696e 6b5f 6576 656e 7460 2069 6e64  _link_event` ind
+00008990: 6963 6174 6573 2077 6865 7468 6572 2074  icates whether t
+000089a0: 6865 2065 7665 6e74 2069 7320 6120 226c  he event is a "l
+000089b0: 696e 6b20 6576 656e 7422 2e20 4c69 6e6b  ink event". Link
+000089c0: 0a65 7665 6e74 7320 6861 7665 2061 2060  .events have a `
+000089d0: 7479 7065 6020 7661 6c75 6520 6f66 2060  type` value of `
+000089e0: 2724 3e27 602e 0a0a 5468 6520 7072 6f70  '$>'`...The prop
+000089f0: 6572 7479 2060 6973 5f72 6573 6f6c 7665  erty `is_resolve
+00008a00: 5f65 7665 6e74 6020 696e 6469 6361 7465  _event` indicate
+00008a10: 7320 7768 6574 6865 7220 7468 6520 6576  s whether the ev
+00008a20: 656e 7420 6861 7320 6265 656e 2072 6573  ent has been res
+00008a30: 6f6c 7665 6420 6672 6f6d 2061 0a22 6c69  olved from a."li
+00008a40: 6e6b 2065 7665 6e74 222e 2054 6865 2072  nk event". The r
+00008a50: 6574 7572 6e65 6420 7661 6c75 6520 6973  eturned value is
+00008a60: 2060 5472 7565 6020 6966 2060 6c69 6e6b   `True` if `link
+00008a70: 6020 6973 206e 6f74 2060 4e6f 6e65 602e  ` is not `None`.
+00008a80: 0a0a 5468 6520 7072 6f70 6572 7479 2060  ..The property `
+00008a90: 6973 5f63 6865 636b 706f 696e 7460 2069  is_checkpoint` i
+00008aa0: 7320 6046 616c 7365 602e 2054 6869 7320  s `False`. This 
+00008ab0: 6361 6e20 6265 2075 7365 6420 746f 2069  can be used to i
+00008ac0: 6465 6e74 6966 7920 6043 6865 636b 706f  dentify `Checkpo
+00008ad0: 696e 7460 0a69 6e73 7461 6e63 6573 2072  int`.instances r
+00008ae0: 6574 7572 6e65 6420 7768 656e 2072 6563  eturned when rec
+00008af0: 6569 7669 6e67 2065 7665 6e74 7320 6672  eiving events fr
+00008b00: 6f6d 2060 696e 636c 7564 655f 6368 6563  om `include_chec
+00008b10: 6b70 6f69 6e74 733d 5472 7565 602e 0a0a  kpoints=True`...
+00008b20: 0a0a 2323 2053 7472 6561 6d73 3c61 2069  ..## Streams<a i
+00008b30: 643d 2273 7472 6561 6d73 223e 3c2f 613e  d="streams"></a>
+00008b40: 0a0a 496e 2045 7665 6e74 5374 6f72 6544  ..In EventStoreD
+00008b50: 422c 2061 2022 7374 7265 616d 2220 6973  B, a "stream" is
+00008b60: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
+00008b70: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
+00008b80: 6861 7420 616c 6c20 6861 7665 0a74 6865  hat all have.the
+00008b90: 2073 616d 6520 2273 7472 6561 6d20 6e61   same "stream na
+00008ba0: 6d65 222e 2054 6865 7265 2077 696c 6c20  me". There will 
+00008bb0: 6e6f 726d 616c 6c79 2062 6520 6d61 6e79  normally be many
+00008bc0: 2073 7472 6561 6d73 2069 6e20 6120 6461   streams in a da
+00008bd0: 7461 6261 7365 2c0a 6561 6368 2077 6974  tabase,.each wit
+00008be0: 6820 6d61 6e79 2072 6563 6f72 6465 6420  h many recorded 
+00008bf0: 6576 656e 7473 2e20 4561 6368 2072 6563  events. Each rec
+00008c00: 6f72 6465 6420 6576 656e 7420 6861 7320  orded event has 
+00008c10: 6120 706f 7369 7469 6f6e 2069 6e20 6974  a position in it
+00008c20: 7320 7374 7265 616d 0a28 7468 6520 2273  s stream.(the "s
+00008c30: 7472 6561 6d20 706f 7369 7469 6f6e 2229  tream position")
+00008c40: 2c20 616e 6420 6120 706f 7369 7469 6f6e  , and a position
+00008c50: 2069 6e20 7468 6520 6461 7461 6261 7365   in the database
+00008c60: 2028 7468 6520 2263 6f6d 6d69 7420 706f   (the "commit po
+00008c70: 7369 7469 6f6e 2229 2e0a 5374 7265 616d  sition")..Stream
+00008c80: 2070 6f73 6974 696f 6e73 2061 7265 207a   positions are z
+00008c90: 6572 6f2d 6261 7365 6420 616e 6420 6761  ero-based and ga
+00008ca0: 706c 6573 732e 2043 6f6d 6d69 7420 706f  pless. Commit po
+00008cb0: 7369 7469 6f6e 7320 6172 6520 616c 736f  sitions are also
+00008cc0: 207a 6572 6f2d 6261 7365 642c 0a62 7574   zero-based,.but
+00008cd0: 2061 7265 206e 6f74 2067 6170 6c65 7373   are not gapless
+00008ce0: 2e0a 0a54 6865 206d 6574 686f 6473 2060  ...The methods `
+00008cf0: 6170 7065 6e64 5f74 6f5f 7374 7265 616d  append_to_stream
+00008d00: 2829 602c 2060 6765 745f 7374 7265 616d  ()`, `get_stream
+00008d10: 2829 6020 616e 6420 6072 6561 645f 616c  ()` and `read_al
+00008d20: 6c28 2960 2063 616e 0a62 6520 7573 6564  l()` can.be used
+00008d30: 2074 6f20 7265 6164 2061 6e64 2072 6563   to read and rec
+00008d40: 6f72 6420 696e 2074 6865 2064 6174 6162  ord in the datab
+00008d50: 6173 652e 0a0a 2323 2320 4170 7065 6e64  ase...### Append
+00008d60: 2065 7665 6e74 733c 6120 6964 3d22 6170   events<a id="ap
+00008d70: 7065 6e64 2d65 7665 6e74 7322 3e3c 2f61  pend-events"></a
+00008d80: 3e0a 0a2a 7265 7175 6972 6573 206c 6561  >..*requires lea
+00008d90: 6465 722a 0a0a 5468 6520 6061 7070 656e  der*..The `appen
+00008da0: 645f 746f 5f73 7472 6561 6d28 2960 206d  d_to_stream()` m
+00008db0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+00008dc0: 6420 6174 6f6d 6963 616c 6c79 2074 6f20  d atomically to 
+00008dd0: 7265 636f 7264 2061 2073 6571 7565 6e63  record a sequenc
+00008de0: 6520 6f66 206e 6577 2065 7665 6e74 732e  e of new events.
+00008df0: 0a49 6620 7468 6520 6f70 6572 6174 696f  .If the operatio
+00008e00: 6e20 6973 2073 7563 6365 7373 6675 6c2c  n is successful,
+00008e10: 2069 7420 7265 7475 726e 7320 7468 6520   it returns the 
+00008e20: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+00008e30: 6f66 2074 6865 206c 6173 7420 6576 656e  of the last even
+00008e40: 7420 696e 2074 6865 0a73 6571 7565 6e63  t in the.sequenc
+00008e50: 6520 7468 6174 2068 6173 2062 6565 6e20  e that has been 
+00008e60: 7265 636f 7264 6564 2e0a 0a54 6869 7320  recorded...This 
+00008e70: 6d65 7468 6f64 2068 6173 2074 6872 6565  method has three
+00008e80: 2072 6571 7569 7265 6420 6172 6775 6d65   required argume
+00008e90: 6e74 732c 2060 7374 7265 616d 5f6e 616d  nts, `stream_nam
+00008ea0: 6560 2c20 6063 7572 7265 6e74 5f76 6572  e`, `current_ver
+00008eb0: 7369 6f6e 600a 616e 6420 6065 7665 6e74  sion`.and `event
+00008ec0: 7360 2e0a 0a54 6865 2072 6571 7569 7265  s`...The require
+00008ed0: 6420 6073 7472 6561 6d5f 6e61 6d65 6020  d `stream_name` 
+00008ee0: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+00008ef0: 7468 6f6e 2060 7374 7260 2074 6861 7420  thon `str` that 
+00008f00: 756e 6971 7565 6c79 2069 6465 6e74 6966  uniquely identif
+00008f10: 6965 7320 610a 7374 7265 616d 2074 6f20  ies a.stream to 
+00008f20: 7768 6963 6820 6120 7365 7175 656e 6365  which a sequence
+00008f30: 206f 6620 6576 656e 7473 2077 696c 6c20   of events will 
+00008f40: 6265 2061 7070 656e 6465 642e 0a0a 5468  be appended...Th
+00008f50: 6520 7265 7175 6972 6564 2060 6375 7272  e required `curr
+00008f60: 656e 745f 7665 7273 696f 6e60 2061 7267  ent_version` arg
+00008f70: 756d 656e 7420 6973 2065 7870 6563 7465  ument is expecte
+00008f80: 6420 746f 2062 6520 6569 7468 6572 2061  d to be either a
+00008f90: 2050 7974 686f 6e20 6069 6e74 600a 7468   Python `int`.th
+00008fa0: 6174 2069 6e64 6963 6174 6573 2074 6865  at indicates the
+00008fb0: 2073 7472 6561 6d20 706f 7369 7469 6f6e   stream position
+00008fc0: 206f 6620 7468 6520 6c61 7374 2072 6563   of the last rec
+00008fd0: 6f72 6465 6420 6576 656e 7420 696e 2074  orded event in t
+00008fe0: 6865 2073 7472 6561 6d2c 206f 720a 6053  he stream, or.`S
+00008ff0: 7472 6561 6d53 7461 7465 2e4e 4f5f 5354  treamState.NO_ST
+00009000: 5245 414d 6020 6966 2074 6865 2073 7472  REAM` if the str
+00009010: 6561 6d20 646f 6573 206e 6f74 2079 6574  eam does not yet
+00009020: 2065 7869 7374 206f 7220 6861 7320 6265   exist or has be
+00009030: 656e 2064 656c 6574 6564 2e20 5468 650a  en deleted. The.
+00009040: 7374 7265 616d 2070 6f73 6974 696f 6e73  stream positions
+00009050: 2061 7265 207a 6572 6f2d 6261 7365 6420   are zero-based 
+00009060: 616e 6420 6761 706c 6573 732c 2073 6f20  and gapless, so 
+00009070: 7468 6174 2069 6620 6120 7374 7265 616d  that if a stream
+00009080: 2068 6173 2074 776f 2065 7665 6e74 732c   has two events,
+00009090: 2074 6865 0a60 6375 7272 656e 745f 7665   the.`current_ve
+000090a0: 7273 696f 6e60 2073 686f 756c 6420 6265  rsion` should be
+000090b0: 2031 2e20 4966 2061 6e20 696e 636f 7272   1. If an incorr
+000090c0: 6563 7420 7661 6c75 6520 6973 2067 6976  ect value is giv
+000090d0: 656e 2c20 7468 6973 206d 6574 686f 6420  en, this method 
+000090e0: 7769 6c6c 2072 6169 7365 2061 0a60 5772  will raise a.`Wr
+000090f0: 6f6e 6743 7572 7265 6e74 5665 7273 696f  ongCurrentVersio
+00009100: 6e60 2065 7863 6570 7469 6f6e 2e20 5468  n` exception. Th
+00009110: 6973 2062 6568 6176 696f 7220 6973 2064  is behavior is d
+00009120: 6573 6967 6e65 6420 746f 2070 726f 7669  esigned to provi
+00009130: 6465 2063 6f6e 6375 7272 656e 6379 0a63  de concurrency.c
+00009140: 6f6e 7472 6f6c 2077 6865 6e20 7265 636f  ontrol when reco
+00009150: 7264 696e 6720 6e65 7720 6576 656e 7473  rding new events
+00009160: 2e20 5468 6520 636f 7272 6563 7420 7661  . The correct va
+00009170: 6c75 6520 6f66 2060 6375 7272 656e 745f  lue of `current_
+00009180: 7665 7273 696f 6e60 2066 6f72 2061 6e79  version` for any
+00009190: 2073 7472 6561 6d0a 6361 6e20 6265 206f   stream.can be o
+000091a0: 6274 6169 6e65 6420 6279 2063 616c 6c69  btained by calli
+000091b0: 6e67 2060 6765 745f 6375 7272 656e 745f  ng `get_current_
+000091c0: 7665 7273 696f 6e28 2960 2e20 486f 7765  version()`. Howe
+000091d0: 7665 722c 2074 6865 2074 7970 6963 616c  ver, the typical
+000091e0: 2061 7070 726f 6163 6820 6973 2074 6f0a   approach is to.
+000091f0: 7265 636f 6e73 7472 7563 7420 616e 2061  reconstruct an a
+00009200: 6767 7265 6761 7465 2066 726f 6d20 7468  ggregate from th
+00009210: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+00009220: 732c 2073 6f20 7468 6174 2074 6865 2076  s, so that the v
+00009230: 6572 7369 6f6e 206f 6620 7468 6520 6167  ersion of the ag
+00009240: 6772 6567 6174 650a 6973 2074 6865 2073  gregate.is the s
+00009250: 7472 6561 6d20 706f 7369 7469 6f6e 206f  tream position o
+00009260: 6620 7468 6520 6c61 7374 2072 6563 6f72  f the last recor
+00009270: 6465 6420 6576 656e 742c 2074 6865 6e20  ded event, then 
+00009280: 6861 7665 2074 6865 2061 6767 7265 6761  have the aggrega
+00009290: 7465 2067 656e 6572 6174 6520 6e65 770a  te generate new.
+000092a0: 6576 656e 7473 2c20 616e 6420 7468 656e  events, and then
+000092b0: 2075 7365 2074 6865 2063 7572 7265 6e74   use the current
+000092c0: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
+000092d0: 6167 6772 6567 6174 6520 6173 2074 6865  aggregate as the
+000092e0: 2076 616c 7565 206f 6620 7468 650a 6063   value of the.`c
+000092f0: 7572 7265 6e74 5f76 6572 7369 6f6e 6020  urrent_version` 
+00009300: 6172 6775 6d65 6e74 2077 6865 6e20 6170  argument when ap
+00009310: 7065 6e64 696e 6720 7468 6520 6e65 7720  pending the new 
+00009320: 6167 6772 6567 6174 6520 6576 656e 7473  aggregate events
+00009330: 2e20 5468 6973 2065 6e73 7572 6573 0a74  . This ensures.t
+00009340: 6865 2063 6f6e 7369 7374 656e 6379 206f  he consistency o
+00009350: 6620 7468 6520 7265 636f 7264 6564 2061  f the recorded a
+00009360: 6767 7265 6761 7465 2065 7665 6e74 732c  ggregate events,
+00009370: 2062 6563 6175 7365 206f 7065 7261 7469   because operati
+00009380: 6f6e 7320 7468 6174 2067 656e 6572 6174  ons that generat
+00009390: 650a 6e65 7720 6167 6772 6567 6174 6520  e.new aggregate 
+000093a0: 6576 656e 7473 2063 616e 2062 6520 7265  events can be re
+000093b0: 7472 6965 6420 7769 7468 2061 2066 7265  tried with a fre
+000093c0: 7368 6c79 2072 6563 6f6e 7374 7275 6374  shly reconstruct
+000093d0: 6564 2061 6767 7265 6761 7465 2069 660a  ed aggregate if.
+000093e0: 6120 6057 726f 6e67 4375 7272 656e 7456  a `WrongCurrentV
+000093f0: 6572 7369 6f6e 6020 6578 6365 7074 696f  ersion` exceptio
+00009400: 6e20 6973 2065 6e63 6f75 6e74 6572 6564  n is encountered
+00009410: 2077 6865 6e20 7265 636f 7264 696e 6720   when recording 
+00009420: 6e65 7720 6576 656e 7473 2e20 5468 6973  new events. This
+00009430: 0a63 6f6e 7472 6f6c 6c69 6e67 2062 6568  .controlling beh
+00009440: 6176 696f 7220 6361 6e20 6265 2065 6e74  avior can be ent
+00009450: 6972 656c 7920 6469 7361 626c 6564 2062  irely disabled b
+00009460: 7920 7365 7474 696e 6720 7468 6520 7661  y setting the va
+00009470: 6c75 6520 6f66 2074 6865 2060 6375 7272  lue of the `curr
+00009480: 656e 745f 7665 7273 696f 6e60 0a61 7267  ent_version`.arg
+00009490: 756d 656e 7420 746f 2074 6865 2063 6f6e  ument to the con
+000094a0: 7374 616e 7420 6053 7472 6561 6d53 7461  stant `StreamSta
+000094b0: 7465 2e41 4e59 602e 204d 6f72 6520 7365  te.ANY`. More se
+000094c0: 6c65 6374 6976 656c 792c 2074 6869 7320  lectively, this 
+000094d0: 6265 6861 7669 6f75 7220 6361 6e20 6265  behaviour can be
+000094e0: 0a64 6973 6162 6c65 6420 666f 7220 6578  .disabled for ex
+000094f0: 6973 7469 6e67 2073 7472 6561 6d73 2062  isting streams b
+00009500: 7920 7365 7474 696e 6720 7468 6520 7661  y setting the va
+00009510: 6c75 6520 6f66 2074 6865 2060 6375 7272  lue of the `curr
+00009520: 656e 745f 7665 7273 696f 6e60 0a61 7267  ent_version`.arg
+00009530: 756d 656e 7420 746f 2074 6865 2063 6f6e  ument to the con
+00009540: 7374 616e 7420 6053 7472 6561 6d53 7461  stant `StreamSta
+00009550: 7465 2e45 5849 5354 5360 2e0a 0a54 6865  te.EXISTS`...The
+00009560: 2072 6571 7569 7265 6420 6065 7665 6e74   required `event
+00009570: 7360 2061 7267 756d 656e 7420 6973 2065  s` argument is e
+00009580: 7870 6563 7465 6420 746f 2062 6520 6120  xpected to be a 
+00009590: 7365 7175 656e 6365 206f 6620 6e65 7720  sequence of new 
+000095a0: 6576 656e 7420 6f62 6a65 6374 732e 2054  event objects. T
+000095b0: 6865 0a60 4e65 7745 7665 6e74 6020 636c  he.`NewEvent` cl
+000095c0: 6173 7320 7368 6f75 6c64 2062 6520 7573  ass should be us
+000095d0: 6564 2074 6f20 636f 6e73 7472 7563 7420  ed to construct 
+000095e0: 6e65 7720 6576 656e 7420 6f62 6a65 6374  new event object
+000095f0: 732e 2054 6865 2060 6170 7065 6e64 5f74  s. The `append_t
+00009600: 6f5f 7374 7265 616d 2829 600a 6f70 6572  o_stream()`.oper
+00009610: 6174 696f 6e20 6973 2061 746f 6d69 632c  ation is atomic,
+00009620: 2073 6f20 7468 6174 2065 6974 6865 7220   so that either 
+00009630: 616c 6c20 6f72 206e 6f6e 6520 6f66 2074  all or none of t
+00009640: 6865 206e 6577 2065 7665 6e74 7320 7769  he new events wi
+00009650: 6c6c 2062 6520 7265 636f 7264 6564 2e20  ll be recorded. 
+00009660: 4974 0a69 7320 6e6f 7420 706f 7373 6962  It.is not possib
+00009670: 6c65 2077 6974 6820 4576 656e 7453 746f  le with EventSto
+00009680: 7265 4442 2061 746f 6d69 6361 6c6c 7920  reDB atomically 
+00009690: 746f 2072 6563 6f72 6420 6e65 7720 6576  to record new ev
+000096a0: 656e 7473 2069 6e20 6d6f 7265 2074 6861  ents in more tha
+000096b0: 6e20 6f6e 6520 7374 7265 616d 2e0a 0a54  n one stream...T
+000096c0: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
+000096d0: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
+000096e0: 6f75 7460 2061 7267 756d 656e 742c 2077  out` argument, w
+000096f0: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
+00009700: 2060 666c 6f61 7460 0a74 6861 7420 7365   `float`.that se
+00009710: 7473 2061 206d 6178 696d 756d 2064 7572  ts a maximum dur
+00009720: 6174 696f 6e2c 2069 6e20 7365 636f 6e64  ation, in second
+00009730: 732c 2066 6f72 2074 6865 2063 6f6d 706c  s, for the compl
+00009740: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+00009750: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+00009760: 6973 206d 6574 686f 6420 6861 7320 616e  is method has an
+00009770: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
+00009780: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
+00009790: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
+000097a0: 7365 6420 746f 0a6f 7665 7272 6964 6520  sed to.override 
+000097b0: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
+000097c0: 2064 6572 6976 6564 2066 726f 6d20 7468   derived from th
+000097d0: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+000097e0: 696e 6720 5552 492e 0a0a 496e 2074 6865  ing URI...In the
+000097f0: 2065 7861 6d70 6c65 2062 656c 6f77 2c20   example below, 
+00009800: 6120 6e65 7720 6576 656e 742c 2060 6576  a new event, `ev
+00009810: 656e 7431 602c 2069 7320 6170 7065 6e64  ent1`, is append
+00009820: 6564 2074 6f20 6120 6e65 7720 7374 7265  ed to a new stre
+00009830: 616d 2e20 5468 6520 7374 7265 616d 0a64  am. The stream.d
+00009840: 6f65 7320 6e6f 7420 7965 7420 6578 6973  oes not yet exis
+00009850: 742c 2073 6f20 6063 7572 7265 6e74 5f76  t, so `current_v
+00009860: 6572 7369 6f6e 6020 6973 2060 5374 7265  ersion` is `Stre
+00009870: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
+00009880: 4d60 2e0a 0a60 6060 7079 7468 6f6e 0a23  M`...```python.#
+00009890: 2043 6f6e 7374 7275 6374 2061 206e 6577   Construct a new
+000098a0: 2065 7665 6e74 206f 626a 6563 742e 0a65   event object..e
+000098b0: 7665 6e74 3120 3d20 4e65 7745 7665 6e74  vent1 = NewEvent
+000098c0: 2874 7970 653d 274f 7264 6572 4372 6561  (type='OrderCrea
+000098d0: 7465 6427 2c20 6461 7461 3d62 277b 7d27  ted', data=b'{}'
+000098e0: 290a 0a23 2044 6566 696e 6520 6120 6e65  )..# Define a ne
+000098f0: 7720 7374 7265 616d 206e 616d 652e 0a73  w stream name..s
+00009900: 7472 6561 6d5f 6e61 6d65 3120 3d20 7374  tream_name1 = st
+00009910: 7228 7575 6964 2e75 7569 6434 2829 290a  r(uuid.uuid4()).
+00009920: 0a23 2041 7070 656e 6420 7468 6520 6e65  .# Append the ne
+00009930: 7720 6576 656e 7473 2074 6f20 7468 6520  w events to the 
+00009940: 6e65 7720 7374 7265 616d 2e0a 636f 6d6d  new stream..comm
+00009950: 6974 5f70 6f73 6974 696f 6e31 203d 2063  it_position1 = c
+00009960: 6c69 656e 742e 6170 7065 6e64 5f74 6f5f  lient.append_to_
+00009970: 7374 7265 616d 280a 2020 2020 7374 7265  stream(.    stre
+00009980: 616d 5f6e 616d 653d 7374 7265 616d 5f6e  am_name=stream_n
+00009990: 616d 6531 2c0a 2020 2020 6375 7272 656e  ame1,.    curren
+000099a0: 745f 7665 7273 696f 6e3d 5374 7265 616d  t_version=Stream
+000099b0: 5374 6174 652e 4e4f 5f53 5452 4541 4d2c  State.NO_STREAM,
+000099c0: 0a20 2020 2065 7665 6e74 733d 5b65 7665  .    events=[eve
+000099d0: 6e74 315d 2c0a 290a 6060 600a 0a49 6e20  nt1],.).```..In 
+000099e0: 7468 6520 6578 616d 706c 6520 6265 6c6f  the example belo
+000099f0: 772c 2074 776f 2073 7562 7365 7175 656e  w, two subsequen
+00009a00: 7420 6576 656e 7473 2061 7265 2061 7070  t events are app
+00009a10: 656e 6465 6420 746f 2061 6e20 6578 6973  ended to an exis
+00009a20: 7469 6e67 0a73 7472 6561 6d2e 2054 6865  ting.stream. The
+00009a30: 2073 7472 6561 6d20 6861 7320 6f6e 6520   stream has one 
+00009a40: 7265 636f 7264 6564 2065 7665 6e74 2c20  recorded event, 
+00009a50: 736f 2060 6375 7272 656e 745f 7665 7273  so `current_vers
+00009a60: 696f 6e60 2069 7320 6030 602e 0a0a 6060  ion` is `0`...``
+00009a70: 6070 7974 686f 6e0a 6576 656e 7432 203d  `python.event2 =
+00009a80: 204e 6577 4576 656e 7428 7479 7065 3d27   NewEvent(type='
+00009a90: 4f72 6465 7255 7064 6174 6564 272c 2064  OrderUpdated', d
+00009aa0: 6174 613d 6227 7b7d 2729 0a65 7665 6e74  ata=b'{}').event
+00009ab0: 3320 3d20 4e65 7745 7665 6e74 2874 7970  3 = NewEvent(typ
+00009ac0: 653d 274f 7264 6572 4465 6c65 7465 6427  e='OrderDeleted'
+00009ad0: 2c20 6461 7461 3d62 277b 7d27 290a 0a63  , data=b'{}')..c
+00009ae0: 6f6d 6d69 745f 706f 7369 7469 6f6e 3220  ommit_position2 
+00009af0: 3d20 636c 6965 6e74 2e61 7070 656e 645f  = client.append_
+00009b00: 746f 5f73 7472 6561 6d28 0a20 2020 2073  to_stream(.    s
+00009b10: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+00009b20: 6d5f 6e61 6d65 312c 0a20 2020 2063 7572  m_name1,.    cur
+00009b30: 7265 6e74 5f76 6572 7369 6f6e 3d30 2c0a  rent_version=0,.
+00009b40: 2020 2020 6576 656e 7473 3d5b 6576 656e      events=[even
+00009b50: 7432 2c20 6576 656e 7433 5d2c 0a29 0a60  t2, event3],.).`
+00009b60: 6060 0a0a 5468 6520 7265 7475 726e 6564  ``..The returned
+00009b70: 2076 616c 7565 732c 2060 636f 6d6d 6974   values, `commit
+00009b80: 5f70 6f73 6974 696f 6e31 6020 616e 6420  _position1` and 
+00009b90: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+00009ba0: 3260 2c20 6172 6520 7468 650a 636f 6d6d  2`, are the.comm
+00009bb0: 6974 2070 6f73 6974 696f 6e73 2069 6e20  it positions in 
+00009bc0: 7468 6520 6461 7461 6261 7365 206f 6620  the database of 
+00009bd0: 7468 6520 6c61 7374 2065 7665 6e74 7320  the last events 
+00009be0: 696e 2074 6865 2072 6563 6f72 6465 6420  in the recorded 
+00009bf0: 7365 7175 656e 6365 732e 0a54 6861 7420  sequences..That 
+00009c00: 6973 2c20 6063 6f6d 6d69 745f 706f 7369  is, `commit_posi
+00009c10: 7469 6f6e 3160 2069 7320 7468 6520 636f  tion1` is the co
+00009c20: 6d6d 6974 2070 6f73 6974 696f 6e20 6f66  mmit position of
+00009c30: 2060 6576 656e 7431 6020 616e 640a 6063   `event1` and.`c
+00009c40: 6f6d 6d69 745f 706f 7369 7469 6f6e 3260  ommit_position2`
+00009c50: 2069 7320 7468 6520 636f 6d6d 6974 2070   is the commit p
+00009c60: 6f73 6974 696f 6e20 6f66 2060 6576 656e  osition of `even
+00009c70: 7433 602e 0a0a 436f 6d6d 6974 2070 6f73  t3`...Commit pos
+00009c80: 6974 696f 6e73 2074 6861 7420 6172 6520  itions that are 
+00009c90: 7265 7475 726e 6564 2069 6e20 7468 6973  returned in this
+00009ca0: 2077 6179 2063 616e 2062 6520 7573 6564   way can be used
+00009cb0: 2062 7920 6120 7573 6572 2069 6e74 6572   by a user inter
+00009cc0: 6661 6365 2074 6f20 706f 6c6c 0a61 2064  face to poll.a d
+00009cd0: 6f77 6e73 7472 6561 6d20 636f 6d70 6f6e  ownstream compon
+00009ce0: 656e 7420 756e 7469 6c20 6974 2068 6173  ent until it has
+00009cf0: 2070 726f 6365 7373 6564 2061 6c6c 2074   processed all t
+00009d00: 6865 206e 6577 6c79 2072 6563 6f72 6465  he newly recorde
+00009d10: 6420 6576 656e 7473 2e20 466f 7220 6578  d events. For ex
+00009d20: 616d 706c 652c 0a63 6f6e 7369 6465 7220  ample,.consider 
+00009d30: 6120 7573 6572 2069 6e74 6572 6661 6365  a user interface
+00009d40: 2063 6f6d 6d61 6e64 2074 6861 7420 7265   command that re
+00009d50: 7375 6c74 7320 696e 2074 6865 2072 6563  sults in the rec
+00009d60: 6f72 6469 6e67 206f 6620 6e65 7720 6576  ording of new ev
+00009d70: 656e 7473 2c20 616e 6420 616e 0a65 7665  ents, and an.eve
+00009d80: 6e74 7561 6c6c 7920 636f 6e73 6973 7465  ntually consiste
+00009d90: 6e74 206d 6174 6572 6961 6c69 7a65 6420  nt materialized 
+00009da0: 7669 6577 2069 6e20 6120 646f 776e 7374  view in a downst
+00009db0: 7265 616d 2063 6f6d 706f 6e65 6e74 2074  ream component t
+00009dc0: 6861 7420 6973 2075 7064 6174 6564 2066  hat is updated f
+00009dd0: 726f 6d0a 7468 6573 6520 6576 656e 7473  rom.these events
+00009de0: 2e20 4966 2074 6865 206e 6577 2065 7665  . If the new eve
+00009df0: 6e74 7320 6861 7665 206e 6f74 2079 6574  nts have not yet
+00009e00: 2062 6565 6e20 7072 6f63 6573 7365 642c   been processed,
+00009e10: 2074 6865 2076 6965 7720 6d69 6768 7420   the view might 
+00009e20: 6265 2073 7461 6c65 2c0a 6f72 206f 7574  be stale,.or out
+00009e30: 2d6f 662d 6461 7465 2e20 496e 7374 6561  -of-date. Instea
+00009e40: 6420 6f66 2064 6973 706c 6179 696e 6720  d of displaying 
+00009e50: 6120 7374 616c 6520 7669 6577 2c20 7468  a stale view, th
+00009e60: 6520 7573 6572 2069 6e74 6572 6661 6365  e user interface
+00009e70: 2063 616e 2070 6f6c 6c20 7468 650a 646f   can poll the.do
+00009e80: 776e 7374 7265 616d 2063 6f6d 706f 6e65  wnstream compone
+00009e90: 6e74 2075 6e74 696c 2069 7420 6861 7320  nt until it has 
+00009ea0: 7072 6f63 6573 7365 6420 7468 6520 6e65  processed the ne
+00009eb0: 776c 7920 7265 636f 7264 6564 2065 7665  wly recorded eve
+00009ec0: 6e74 732c 2061 6e64 2074 6865 6e20 6469  nts, and then di
+00009ed0: 7370 6c61 790a 616e 2075 702d 746f 2d64  splay.an up-to-d
+00009ee0: 6174 6520 7669 6577 2074 6f20 7468 6520  ate view to the 
+00009ef0: 7573 6572 2e0a 0a0a 2323 2320 4964 656d  user....### Idem
+00009f00: 706f 7465 6e74 2061 7070 656e 6420 6f70  potent append op
+00009f10: 6572 6174 696f 6e73 3c61 2069 643d 2269  erations<a id="i
+00009f20: 6465 6d70 6f74 656e 742d 6170 7065 6e64  dempotent-append
+00009f30: 2d6f 7065 7261 7469 6f6e 7322 3e3c 2f61  -operations"></a
+00009f40: 3e0a 0a54 6865 2060 6170 7065 6e64 5f74  >..The `append_t
+00009f50: 6f5f 7374 7265 616d 2829 6020 6d65 7468  o_stream()` meth
+00009f60: 6f64 2069 7320 2269 6465 6d70 6f74 656e  od is "idempoten
+00009f70: 7422 2077 6974 6820 7265 7370 6563 7420  t" with respect 
+00009f80: 746f 2074 6865 2060 6964 6020 7661 6c75  to the `id` valu
+00009f90: 6520 6f66 2061 0a60 4e65 7745 7665 6e74  e of a.`NewEvent
+00009fa0: 6020 6f62 6a65 6374 2e20 5468 6174 2069  ` object. That i
+00009fb0: 7320 746f 2073 6179 2c20 6966 2060 6170  s to say, if `ap
+00009fc0: 7065 6e64 5f74 6f5f 7374 7265 616d 2829  pend_to_stream()
+00009fd0: 6020 6973 2063 616c 6c65 6420 7769 7468  ` is called with
+00009fe0: 2065 7665 6e74 730a 7768 6f73 6520 6069   events.whose `i
+00009ff0: 6460 2076 616c 7565 7320 6172 6520 6571  d` values are eq
+0000a000: 7561 6c20 746f 2074 686f 7365 2061 6c72  ual to those alr
+0000a010: 6561 6479 2072 6563 6f72 6465 6420 696e  eady recorded in
+0000a020: 2074 6865 2073 7472 6561 6d2c 2074 6865   the stream, the
+0000a030: 6e20 7468 650a 6d65 7468 6f64 2063 616c  n the.method cal
+0000a040: 6c20 7769 6c6c 2073 7563 6365 7373 6675  l will successfu
+0000a050: 6c6c 7920 7265 7475 726e 2c20 7769 7468  lly return, with
+0000a060: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+0000a070: 7469 6f6e 206f 6620 7468 6520 6c61 7374  tion of the last
+0000a080: 206e 6577 2065 7665 6e74 2c0a 7769 7468   new event,.with
+0000a090: 6f75 7420 6d61 6b69 6e67 2061 6e79 2063  out making any c
+0000a0a0: 6861 6e67 6573 2074 6f20 7468 6520 6461  hanges to the da
+0000a0b0: 7461 6261 7365 2e0a 0a54 6869 7320 6973  tabase...This is
+0000a0c0: 2062 6563 6175 7365 2073 6f6d 6574 696d   because sometim
+0000a0d0: 6573 2069 7420 6d61 7920 6861 7070 656e  es it may happen
+0000a0e0: 2c20 7768 656e 2063 616c 6c69 6e67 2060  , when calling `
+0000a0f0: 6170 7065 6e64 5f74 6f5f 7374 7265 616d  append_to_stream
+0000a100: 2829 602c 2074 6861 7420 7468 6520 6e65  ()`, that the ne
+0000a110: 770a 6576 656e 7473 2061 7265 2073 7563  w.events are suc
+0000a120: 6365 7373 6675 6c6c 7920 7265 636f 7264  cessfully record
+0000a130: 6564 2c20 6275 7420 736f 6d65 686f 7720  ed, but somehow 
+0000a140: 736f 6d65 7468 696e 6720 6261 6420 6861  something bad ha
+0000a150: 7070 656e 7320 6265 666f 7265 2074 6865  ppens before the
+0000a160: 206d 6574 686f 6420 6361 6c6c 0a63 616e   method call.can
+0000a170: 2072 6574 7572 6e20 7375 6363 6573 7366   return successf
+0000a180: 756c 6c79 2074 6f20 7468 6520 6361 6c6c  ully to the call
+0000a190: 6572 2e20 496e 2074 6869 7320 6361 7365  er. In this case
+0000a1a0: 2c20 7765 2063 616e 6e6f 7420 6265 2073  , we cannot be s
+0000a1b0: 7572 6520 7468 6174 2074 6865 2065 7665  ure that the eve
+0000a1c0: 6e74 7320 6861 7665 0a69 6e20 6661 6374  nts have.in fact
+0000a1d0: 2062 6565 6e20 7265 636f 7264 6564 2c20   been recorded, 
+0000a1e0: 616e 6420 736f 2077 6520 6d61 7920 7769  and so we may wi
+0000a1f0: 7368 2074 6f20 7265 7472 792e 0a0a 4966  sh to retry...If
+0000a200: 2074 6865 2065 7665 6e74 7320 7765 7265   the events were
+0000a210: 2069 6e20 6661 6374 2073 7563 6365 7373   in fact success
+0000a220: 6675 6c6c 7920 7265 636f 7264 6564 2c20  fully recorded, 
+0000a230: 6974 2069 7320 636f 6e76 656e 6965 6e74  it is convenient
+0000a240: 2066 6f72 2074 6865 2072 6574 7269 6564   for the retried
+0000a250: 206d 6574 686f 6420 6361 6c6c 0a74 6f20   method call.to 
+0000a260: 7265 7475 726e 2073 7563 6365 7373 6675  return successfu
+0000a270: 6c6c 792c 2061 6e64 2077 6974 686f 7574  lly, and without
+0000a280: 2065 6974 6865 7220 7261 6973 696e 6720   either raising 
+0000a290: 616e 2065 7863 6570 7469 6f6e 2028 7768  an exception (wh
+0000a2a0: 656e 2060 6375 7272 656e 745f 7665 7273  en `current_vers
+0000a2b0: 696f 6e60 0a69 7320 6569 7468 6572 2060  ion`.is either `
+0000a2c0: 5374 7265 616d 5374 6174 652e 4e4f 5f53  StreamState.NO_S
+0000a2d0: 5452 4541 4d60 2061 6e20 696e 7465 6765  TREAM` an intege
+0000a2e0: 7220 7661 6c75 6529 206f 7220 6372 6561  r value) or crea
+0000a2f0: 7469 6e67 2066 7572 7468 6572 2065 7665  ting further eve
+0000a300: 6e74 2072 6563 6f72 6473 0a28 7768 656e  nt records.(when
+0000a310: 2060 6375 7272 656e 745f 7665 7273 696f   `current_versio
+0000a320: 6e60 2069 7320 6053 7472 6561 6d53 7461  n` is `StreamSta
+0000a330: 7465 2e41 4e59 6020 6f72 2060 5374 7265  te.ANY` or `Stre
+0000a340: 616d 5374 6174 652e 4558 4953 5453 6029  amState.EXISTS`)
+0000a350: 2c20 6173 2069 7420 776f 756c 640a 6966  , as it would.if
+0000a360: 2074 6865 2060 6170 7065 6e64 5f74 6f5f   the `append_to_
+0000a370: 7374 7265 616d 2829 6020 6d65 7468 6f64  stream()` method
+0000a380: 2077 6572 6520 6e6f 7420 6964 656d 706f   were not idempo
+0000a390: 7465 6e74 2e0a 0a49 6620 7468 6520 6d65  tent...If the me
+0000a3a0: 7468 6f64 2063 616c 6c20 696e 6974 6961  thod call initia
+0000a3b0: 6c6c 7920 6661 696c 6564 2061 6e64 2074  lly failed and t
+0000a3c0: 6865 206e 6577 2065 7665 6e74 7320 7765  he new events we
+0000a3d0: 7265 206e 6f74 2069 6e20 6661 6374 2072  re not in fact r
+0000a3e0: 6563 6f72 6465 642c 2069 740a 6d61 6b65  ecorded, it.make
+0000a3f0: 7320 676f 6f64 2073 656e 7365 2c20 7768  s good sense, wh
+0000a400: 656e 2074 6865 206d 6574 686f 6420 6361  en the method ca
+0000a410: 6c6c 2069 7320 7265 7472 6965 642c 2074  ll is retried, t
+0000a420: 6861 7420 7468 6520 6e65 7720 6576 656e  hat the new even
+0000a430: 7473 2061 7265 2072 6563 6f72 6465 640a  ts are recorded.
+0000a440: 616e 6420 7468 6174 2074 6865 206d 6574  and that the met
+0000a450: 686f 6420 6361 6c6c 2072 6574 7572 6e73  hod call returns
+0000a460: 2073 7563 6365 7373 6675 6c6c 792e 2049   successfully. I
+0000a470: 6620 7468 6520 636f 6e63 7572 7265 6e63  f the concurrenc
+0000a480: 7920 636f 6e74 726f 6c73 2068 6176 6520  y controls have 
+0000a490: 6e6f 7420 6265 656e 2064 6973 6162 6c65  not been disable
+0000a4a0: 642c 0a74 6861 7420 6973 2069 6620 7468  d,.that is if th
+0000a4b0: 6520 6063 7572 7265 6e74 2076 6572 7369  e `current versi
+0000a4c0: 6f6e 6020 6973 2065 6974 6865 7220 6053  on` is either `S
+0000a4d0: 7472 6561 6d53 7461 7465 2e4e 4f5f 5354  treamState.NO_ST
+0000a4e0: 5245 414d 6020 6f72 2061 6e20 696e 7465  REAM` or an inte
+0000a4f0: 6765 7220 7661 6c75 652c 2061 6e64 0a69  ger value, and.i
+0000a500: 6620 6120 6057 726f 6e67 4375 7272 656e  f a `WrongCurren
+0000a510: 7456 6572 7369 6f6e 6020 6578 6365 7074  tVersion` except
+0000a520: 696f 6e20 6973 2072 6169 7365 6420 7768  ion is raised wh
+0000a530: 656e 2072 6574 7279 696e 6720 7468 6520  en retrying the 
+0000a540: 6d65 7468 6f64 2063 616c 6c2c 2074 6865  method call, the
+0000a550: 6e20 7765 2063 616e 2061 7373 756d 650a  n we can assume.
+0000a560: 626f 7468 2074 6861 7420 7468 6520 696e  both that the in
+0000a570: 6974 6961 6c20 6d65 7468 6f64 2063 616c  itial method cal
+0000a580: 6c20 6469 6420 6e6f 7420 696e 2066 6163  l did not in fac
+0000a590: 7420 7375 6363 6573 7366 756c 6c79 2072  t successfully r
+0000a5a0: 6563 6f72 6420 7468 6520 6576 656e 7473  ecord the events
+0000a5b0: 2c20 616e 6420 616c 736f 0a74 6861 7420  , and also.that 
+0000a5c0: 7375 6273 6571 7565 6e74 2065 7665 6e74  subsequent event
+0000a5d0: 7320 6861 7665 2069 6e20 7468 6520 6d65  s have in the me
+0000a5e0: 616e 7469 6d65 2062 6565 6e20 7265 636f  antime been reco
+0000a5f0: 7264 6564 2062 7920 736f 6d65 626f 6479  rded by somebody
+0000a600: 2065 6c73 652e 2049 6e20 7468 6973 2063   else. In this c
+0000a610: 6173 652c 0a61 6e20 6170 706c 6963 6174  ase,.an applicat
+0000a620: 696f 6e20 636f 6d6d 616e 6420 7768 6963  ion command whic
+0000a630: 6820 6765 6e65 7261 7465 6420 7468 6520  h generated the 
+0000a640: 6e65 7720 6576 656e 7473 206d 6179 206e  new events may n
+0000a650: 6565 6420 746f 2062 6520 6578 6563 7574  eed to be execut
+0000a660: 6564 2061 6761 696e 2e20 416e 640a 7468  ed again. And.th
+0000a670: 6520 7573 6572 206f 6620 7468 6520 6170  e user of the ap
+0000a680: 706c 6963 6174 696f 6e20 6d61 7920 6e65  plication may ne
+0000a690: 6564 2074 6f20 6265 2067 6976 656e 2061  ed to be given a
+0000a6a0: 6e20 6f70 706f 7274 756e 6974 7920 746f  n opportunity to
+0000a6b0: 2064 6563 6964 6520 6966 2074 6865 7920   decide if they 
+0000a6c0: 7374 696c 6c20 7769 7368 2074 6f0a 7072  still wish to.pr
+0000a6d0: 6f63 6565 6420 7769 7468 2074 6865 6972  oceed with their
+0000a6e0: 206f 7269 6769 6e61 6c20 696e 7465 6e74   original intent
+0000a6f0: 696f 6e2c 2062 7920 6469 7370 6c61 7969  ion, by displayi
+0000a700: 6e67 2061 2073 7569 7461 626c 6520 6572  ng a suitable er
+0000a710: 726f 7220 7769 7468 2061 6e20 7570 2d74  ror with an up-t
+0000a720: 6f2d 6461 7465 2076 6965 7720 6f66 0a74  o-date view of.t
+0000a730: 6865 2072 6563 6f72 6465 6420 7374 6174  he recorded stat
+0000a740: 652e 2049 6e20 7468 6520 6361 7365 2077  e. In the case w
+0000a750: 6865 7265 2063 6f6e 6375 7272 656e 6379  here concurrency
+0000a760: 2063 6f6e 7472 6f6c 7320 6861 7665 2062   controls have b
+0000a770: 6565 6e20 6469 7361 626c 6564 2c20 6279  een disabled, by
+0000a780: 2075 7369 6e67 2060 5374 7265 616d 5374   using `StreamSt
+0000a790: 6174 652e 414e 5960 206f 720a 6053 7472  ate.ANY` or.`Str
+0000a7a0: 6561 6d53 7461 7465 2e45 5849 5354 5360  eamState.EXISTS`
+0000a7b0: 2061 7320 7468 6520 7661 6c75 6520 6f66   as the value of
+0000a7c0: 2060 6375 7272 656e 745f 706f 7369 7469   `current_positi
+0000a7d0: 6f6e 602c 2072 6574 7279 696e 6720 6120  on`, retrying a 
+0000a7e0: 6d65 7468 6f64 2063 616c 6c20 7468 6174  method call that
+0000a7f0: 2066 6169 6c65 6420 746f 0a72 6574 7572   failed to.retur
+0000a800: 6e20 7375 6363 6573 7366 756c 6c79 2077  n successfully w
+0000a810: 696c 6c2c 206d 6f72 6520 7369 6d70 6c79  ill, more simply
+0000a820: 2c20 6a75 7374 2061 7474 656d 7074 2074  , just attempt t
+0000a830: 6f20 656e 7375 7265 2074 6865 206e 6577  o ensure the new
+0000a840: 2065 7665 6e74 7320 6172 6520 7265 636f   events are reco
+0000a850: 7264 6564 2c20 7265 6761 7264 6c65 7373  rded, regardless
+0000a860: 0a6f 6620 7468 6569 7220 7265 7375 6c74  .of their result
+0000a870: 696e 6720 7374 7265 616d 2070 6f73 6974  ing stream posit
+0000a880: 696f 6e73 2e20 496e 2065 6974 6865 7220  ions. In either 
+0000a890: 6361 7365 2c20 7768 656e 2074 6865 206d  case, when the m
+0000a8a0: 6574 686f 6420 6361 6c6c 2064 6f65 7320  ethod call does 
+0000a8b0: 7265 7475 726e 2073 7563 6365 7373 6675  return successfu
+0000a8c0: 6c6c 792c 2077 650a 6361 6e20 6265 2073  lly, we.can be s
+0000a8d0: 7572 6520 7468 6520 6576 656e 7473 2068  ure the events h
+0000a8e0: 6176 6520 6265 656e 2072 6563 6f72 6465  ave been recorde
+0000a8f0: 642e 0a0a 5468 6520 6578 616d 706c 6520  d...The example 
+0000a900: 6265 6c6f 7720 7368 6f77 7320 7468 6520  below shows the 
+0000a910: 6061 7070 656e 645f 746f 5f73 7472 6561  `append_to_strea
+0000a920: 6d28 2960 206d 6574 686f 6420 6265 696e  m()` method bein
+0000a930: 6720 6361 6c6c 6564 2061 6761 696e 2077  g called again w
+0000a940: 6974 6820 6576 656e 7473 0a60 6576 656e  ith events.`even
+0000a950: 7432 6020 616e 6420 6065 7665 6e74 3360  t2` and `event3`
+0000a960: 2c20 616e 6420 7769 7468 2060 6375 7272  , and with `curr
+0000a970: 656e 745f 7665 7273 696f 6e3d 3060 2e20  ent_version=0`. 
+0000a980: 5765 2063 616e 2073 6565 2074 6861 7420  We can see that 
+0000a990: 7265 7065 6174 696e 6720 7468 6520 6361  repeating the ca
+0000a9a0: 6c6c 0a74 6f20 6061 7070 656e 645f 746f  ll.to `append_to
+0000a9b0: 5f73 7472 6561 6d28 2960 2072 6574 7572  _stream()` retur
+0000a9c0: 6e73 2073 7563 6365 7373 6675 6c6c 7920  ns successfully 
+0000a9d0: 7769 7468 6f75 7420 7261 6973 696e 6720  without raising 
+0000a9e0: 6120 6057 726f 6e67 4375 7272 656e 7456  a `WrongCurrentV
+0000a9f0: 6572 7369 6f6e 600a 6578 6365 7074 696f  ersion`.exceptio
+0000aa00: 6e2c 2061 7320 6974 2077 6f75 6c64 2069  n, as it would i
+0000aa10: 6620 7468 6520 6061 7070 656e 645f 746f  f the `append_to
+0000aa20: 5f73 7472 6561 6d28 2960 206f 7065 7261  _stream()` opera
+0000aa30: 7469 6f6e 2077 6572 6520 6e6f 7420 6964  tion were not id
+0000aa40: 656d 706f 7465 6e74 2e0a 0a60 6060 7079  empotent...```py
+0000aa50: 7468 6f6e 0a23 2052 6574 7279 2061 7070  thon.# Retry app
+0000aa60: 656e 6469 6e67 2065 7665 6e74 332e 0a63  ending event3..c
+0000aa70: 6f6d 6d69 745f 706f 7369 7469 6f6e 5f72  ommit_position_r
+0000aa80: 6574 7279 203d 2063 6c69 656e 742e 6170  etry = client.ap
+0000aa90: 7065 6e64 5f74 6f5f 7374 7265 616d 280a  pend_to_stream(.
+0000aaa0: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+0000aab0: 7374 7265 616d 5f6e 616d 6531 2c0a 2020  stream_name1,.  
+0000aac0: 2020 6375 7272 656e 745f 7665 7273 696f    current_versio
+0000aad0: 6e3d 302c 0a20 2020 2065 7665 6e74 733d  n=0,.    events=
+0000aae0: 5b65 7665 6e74 322c 2065 7665 6e74 335d  [event2, event3]
+0000aaf0: 2c0a 290a 6060 600a 0a57 6520 6361 6e20  ,.).```..We can 
+0000ab00: 7365 6520 7468 6174 2074 6865 2073 616d  see that the sam
+0000ab10: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+0000ab20: 6e20 6973 2072 6574 7572 6e65 6420 6173  n is returned as
+0000ab30: 2061 626f 7665 2e0a 0a60 6060 7079 7468   above...```pyth
+0000ab40: 6f6e 0a61 7373 6572 7420 636f 6d6d 6974  on.assert commit
+0000ab50: 5f70 6f73 6974 696f 6e5f 7265 7472 7920  _position_retry 
+0000ab60: 3d3d 2063 6f6d 6d69 745f 706f 7369 7469  == commit_positi
+0000ab70: 6f6e 320a 6060 600a 0a54 6865 2065 7861  on2.```..The exa
+0000ab80: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
+0000ab90: 2074 6865 2060 6170 7065 6e64 5f74 6f5f   the `append_to_
+0000aba0: 7374 7265 616d 2829 6020 6d65 7468 6f64  stream()` method
+0000abb0: 2062 6569 6e67 2063 616c 6c65 6420 6167   being called ag
+0000abc0: 6169 6e20 7769 7468 2065 7665 6e74 730a  ain with events.
+0000abd0: 6065 7665 6e74 3260 2061 6e64 2060 6576  `event2` and `ev
+0000abe0: 656e 7433 602c 2077 6974 6820 616e 6420  ent3`, with and 
+0000abf0: 6063 7572 7265 6e74 5f76 6572 7369 6f6e  `current_version
+0000ac00: 3d53 7472 6561 6d53 7461 7465 2e41 4e59  =StreamState.ANY
+0000ac10: 602e 0a0a 6060 6070 7974 686f 6e0a 2320  `...```python.# 
+0000ac20: 5265 7472 7920 6170 7065 6e64 696e 6720  Retry appending 
+0000ac30: 6576 656e 7433 2e0a 636f 6d6d 6974 5f70  event3..commit_p
+0000ac40: 6f73 6974 696f 6e5f 7265 7472 7920 3d20  osition_retry = 
+0000ac50: 636c 6965 6e74 2e61 7070 656e 645f 746f  client.append_to
+0000ac60: 5f73 7472 6561 6d28 0a20 2020 2073 7472  _stream(.    str
+0000ac70: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+0000ac80: 6e61 6d65 312c 0a20 2020 2063 7572 7265  name1,.    curre
+0000ac90: 6e74 5f76 6572 7369 6f6e 3d30 2c0a 2020  nt_version=0,.  
+0000aca0: 2020 6576 656e 7473 3d5b 6576 656e 7432    events=[event2
+0000acb0: 2c20 6576 656e 7433 5d2c 0a29 0a60 6060  , event3],.).```
+0000acc0: 0a0a 5765 2063 616e 2073 6565 2074 6861  ..We can see tha
+0000acd0: 7420 7468 6520 7361 6d65 2063 6f6d 6d69  t the same commi
+0000ace0: 7420 706f 7369 7469 6f6e 2069 7320 7265  t position is re
+0000acf0: 7475 726e 6564 2061 7320 6162 6f76 652e  turned as above.
+0000ad00: 0a0a 6060 6070 7974 686f 6e0a 6173 7365  ..```python.asse
+0000ad10: 7274 2063 6f6d 6d69 745f 706f 7369 7469  rt commit_positi
+0000ad20: 6f6e 5f72 6574 7279 203d 3d20 636f 6d6d  on_retry == comm
+0000ad30: 6974 5f70 6f73 6974 696f 6e32 0a60 6060  it_position2.```
+0000ad40: 0a0a 4279 2063 616c 6c69 6e67 2060 6765  ..By calling `ge
+0000ad50: 745f 7374 7265 616d 2829 602c 2077 6520  t_stream()`, we 
+0000ad60: 6361 6e20 616c 736f 2073 6565 2074 6865  can also see the
+0000ad70: 2073 7472 6561 6d20 6861 7320 6265 656e   stream has been
+0000ad80: 2075 6e63 6861 6e67 6564 2e0a 5468 6174   unchanged..That
+0000ad90: 2069 732c 2074 6865 7265 2061 7265 2073   is, there are s
+0000ada0: 7469 6c6c 206f 6e6c 7920 7468 7265 6520  till only three 
+0000adb0: 6576 656e 7473 2069 6e20 7468 6520 7374  events in the st
+0000adc0: 7265 616d 2e0a 0a60 6060 7079 7468 6f6e  ream...```python
+0000add0: 0a65 7665 6e74 7320 3d20 636c 6965 6e74  .events = client
+0000ade0: 2e67 6574 5f73 7472 6561 6d28 0a20 2020  .get_stream(.   
+0000adf0: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+0000ae00: 6561 6d5f 6e61 6d65 310a 290a 0a61 7373  eam_name1.)..ass
+0000ae10: 6572 7420 6c65 6e28 6576 656e 7473 2920  ert len(events) 
+0000ae20: 3d3d 2033 0a60 6060 0a0a 5468 6973 2069  == 3.```..This i
+0000ae30: 6465 6d70 6f74 656e 7420 6265 6861 7669  dempotent behavi
+0000ae40: 6f75 7220 6465 7065 6e64 7320 6f6e 2074  our depends on t
+0000ae50: 6865 2060 6964 6020 6174 7472 6962 7574  he `id` attribut
+0000ae60: 6520 6f66 2074 6865 2060 4e65 7745 7665  e of the `NewEve
+0000ae70: 6e74 6020 636c 6173 732e 0a54 6869 7320  nt` class..This 
+0000ae80: 6174 7472 6962 7574 6520 6973 2c20 6279  attribute is, by
+0000ae90: 2064 6566 6175 6c74 2c20 6173 7369 676e   default, assign
+0000aea0: 6564 2061 206e 6577 2061 6e64 2075 6e69  ed a new and uni
+0000aeb0: 7175 6520 7665 7273 696f 6e2d 3420 5555  que version-4 UU
+0000aec0: 4944 2077 6865 6e20 616e 0a69 6e73 7461  ID when an.insta
+0000aed0: 6e63 6520 6f66 2060 4e65 7745 7665 6e74  nce of `NewEvent
+0000aee0: 6020 6973 2063 6f6e 7374 7275 6374 6564  ` is constructed
+0000aef0: 2e20 546f 2073 6574 2074 6865 2060 6964  . To set the `id
+0000af00: 6020 7661 6c75 6520 6f66 2061 2060 4e65  ` value of a `Ne
+0000af10: 7745 7665 6e74 602c 0a74 6865 206f 7074  wEvent`,.the opt
+0000af20: 696f 6e61 6c20 6069 6460 2063 6f6e 7374  ional `id` const
+0000af30: 7275 6374 6f72 2061 7267 756d 656e 7420  ructor argument 
+0000af40: 6361 6e20 6265 2075 7365 6420 7768 656e  can be used when
+0000af50: 2063 6f6e 7374 7275 6374 696e 6720 604e   constructing `N
+0000af60: 6577 4576 656e 7460 206f 626a 6563 7473  ewEvent` objects
+0000af70: 2e0a 0a0a 2323 2320 5265 6164 2073 7472  ....### Read str
+0000af80: 6561 6d20 6576 656e 7473 3c61 2069 643d  eam events<a id=
+0000af90: 2272 6561 642d 7374 7265 616d 2d65 7665  "read-stream-eve
+0000afa0: 6e74 7322 3e3c 2f61 3e0a 0a54 6865 2060  nts"></a>..The `
+0000afb0: 7265 6164 5f73 7472 6561 6d28 2960 206d  read_stream()` m
+0000afc0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+0000afd0: 6420 746f 2067 6574 2065 7665 6e74 7320  d to get events 
+0000afe0: 7468 6174 2068 6176 6520 6265 656e 2061  that have been a
+0000aff0: 7070 656e 6465 640a 746f 2061 2073 7472  ppended.to a str
+0000b000: 6561 6d2e 2054 6869 7320 6d65 7468 6f64  eam. This method
+0000b010: 2072 6574 7572 6e73 2061 2022 7265 6164   returns a "read
+0000b020: 2072 6573 706f 6e73 6522 206f 626a 6563   response" objec
+0000b030: 742e 0a0a 4120 2272 6561 6420 7265 7370  t...A "read resp
+0000b040: 6f6e 7365 2220 6f62 6a65 6374 2069 7320  onse" object is 
+0000b050: 6120 5079 7468 6f6e 2069 7465 7261 746f  a Python iterato
+0000b060: 722e 2052 6563 6f72 6465 6420 6576 656e  r. Recorded even
+0000b070: 7473 2063 616e 2062 650a 6f62 7461 696e  ts can be.obtain
+0000b080: 6564 2062 7920 6974 6572 6174 696e 6720  ed by iterating 
+0000b090: 6f76 6572 2074 6865 2022 7265 6164 2072  over the "read r
+0000b0a0: 6573 706f 6e73 6522 206f 626a 6563 742e  esponse" object.
+0000b0b0: 2052 6563 6f72 6465 6420 6576 656e 7473   Recorded events
+0000b0c0: 2061 7265 0a73 7472 6561 6d65 6420 6672   are.streamed fr
+0000b0d0: 6f6d 2074 6865 2073 6572 7665 7220 746f  om the server to
+0000b0e0: 2074 6865 2063 6c69 656e 7420 6173 2074   the client as t
+0000b0f0: 6865 2069 7465 7261 7469 6f6e 2070 726f  he iteration pro
+0000b100: 6365 6564 732e 2054 6865 2069 7465 7261  ceeds. The itera
+0000b110: 7469 6f6e 0a77 696c 6c20 6175 746f 6d61  tion.will automa
+0000b120: 7469 6361 6c6c 7920 7374 6f70 2077 6865  tically stop whe
+0000b130: 6e20 7468 6572 6520 6172 6520 6e6f 206d  n there are no m
+0000b140: 6f72 6520 7265 636f 7264 6564 2065 7665  ore recorded eve
+0000b150: 6e74 7320 746f 2062 6520 7265 7475 726e  nts to be return
+0000b160: 6564 2e0a 5468 6520 7374 7265 616d 696e  ed..The streamin
+0000b170: 6720 6f66 2065 7665 6e74 732c 2061 6e64  g of events, and
+0000b180: 2068 656e 6365 2074 6865 2069 7465 7261   hence the itera
+0000b190: 746f 722c 2063 616e 2061 6c73 6f20 6265  tor, can also be
+0000b1a0: 2073 746f 7070 6564 2062 7920 6361 6c6c   stopped by call
+0000b1b0: 696e 670a 7468 6520 6073 746f 7028 2960  ing.the `stop()`
+0000b1c0: 206d 6574 686f 6420 6f6e 2074 6865 2022   method on the "
+0000b1d0: 7265 6164 2072 6573 706f 6e73 6522 206f  read response" o
+0000b1e0: 626a 6563 742e 0a0a 5468 6520 6067 6574  bject...The `get
+0000b1f0: 5f73 7472 6561 6d28 2960 206d 6574 686f  _stream()` metho
+0000b200: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
+0000b210: 2067 6574 2065 7665 6e74 7320 7468 6174   get events that
+0000b220: 2068 6176 6520 6265 656e 2061 7070 656e   have been appen
+0000b230: 6465 640a 746f 2061 2073 7472 6561 6d2e  ded.to a stream.
+0000b240: 2054 6869 7320 6d65 7468 6f64 2072 6574   This method ret
+0000b250: 7572 6e73 2061 2050 7974 686f 6e20 6074  urns a Python `t
+0000b260: 7570 6c65 6020 6f66 2072 6563 6f72 6465  uple` of recorde
+0000b270: 6420 6576 656e 7420 6f62 6a65 6374 732e  d event objects.
+0000b280: 0a54 6865 2072 6563 6f72 6465 6420 6576  .The recorded ev
+0000b290: 656e 7420 6f62 6a65 6374 7320 6172 6520  ent objects are 
+0000b2a0: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
+0000b2b0: 2060 5265 636f 7264 6564 4576 656e 7460   `RecordedEvent`
+0000b2c0: 2063 6c61 7373 2e20 4974 0a63 616c 6c73   class. It.calls
+0000b2d0: 2060 7265 6164 5f73 7472 6561 6d28 2960   `read_stream()`
+0000b2e0: 2061 6e64 2070 6173 7365 7320 7468 6520   and passes the 
+0000b2f0: 2272 6561 6420 7265 7370 6f6e 7365 2220  "read response" 
+0000b300: 6974 6572 6174 6f72 2069 6e74 6f20 6120  iterator into a 
+0000b310: 5079 7468 6f6e 0a60 7475 706c 6560 2c20  Python.`tuple`, 
+0000b320: 736f 2074 6861 7420 7468 6520 7374 7265  so that the stre
+0000b330: 616d 696e 6720 7769 6c6c 2063 6f6d 706c  aming will compl
+0000b340: 6574 6520 6265 666f 7265 2074 6865 206d  ete before the m
+0000b350: 6574 686f 6420 7265 7475 726e 732e 0a0a  ethod returns...
+0000b360: 5468 6520 6072 6561 645f 7374 7265 616d  The `read_stream
+0000b370: 2829 6020 616e 6420 6067 6574 5f73 7472  ()` and `get_str
+0000b380: 6561 6d28 2960 206d 6574 686f 6473 2068  eam()` methods h
+0000b390: 6176 6520 6f6e 6520 7265 7175 6972 6564  ave one required
+0000b3a0: 2061 7267 756d 656e 742c 2060 7374 7265   argument, `stre
+0000b3b0: 616d 5f6e 616d 6560 2e0a 0a54 6865 2072  am_name`...The r
+0000b3c0: 6571 7569 7265 6420 6073 7472 6561 6d5f  equired `stream_
+0000b3d0: 6e61 6d65 6020 6172 6775 6d65 6e74 2069  name` argument i
+0000b3e0: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
+0000b3f0: 2074 6861 7420 756e 6971 7565 6c79 2069   that uniquely i
+0000b400: 6465 6e74 6966 6965 7320 610a 7374 7265  dentifies a.stre
+0000b410: 616d 2066 726f 6d20 7768 6963 6820 7265  am from which re
+0000b420: 636f 7264 6564 2065 7665 6e74 7320 7769  corded events wi
+0000b430: 6c6c 2062 6520 7265 7475 726e 6564 2e0a  ll be returned..
+0000b440: 0a54 6865 2060 7265 6164 5f73 7472 6561  .The `read_strea
+0000b450: 6d28 2960 2061 6e64 2060 6765 745f 7374  m()` and `get_st
+0000b460: 7265 616d 2829 6020 6d65 7468 6f64 7320  ream()` methods 
+0000b470: 616c 736f 2068 6176 6520 7369 7820 6f70  also have six op
+0000b480: 7469 6f6e 616c 2061 7267 756d 656e 7473  tional arguments
+0000b490: 2c0a 6073 7472 6561 6d5f 706f 7369 7469  ,.`stream_positi
+0000b4a0: 6f6e 602c 2060 6261 636b 7761 7264 7360  on`, `backwards`
+0000b4b0: 2c20 6072 6573 6f6c 7665 5f6c 696e 6b73  , `resolve_links
+0000b4c0: 602c 2060 6c69 6d69 7460 2c20 6074 696d  `, `limit`, `tim
+0000b4d0: 656f 7574 602c 2061 6e64 2060 6372 6564  eout`, and `cred
+0000b4e0: 656e 7469 616c 7360 2e0a 0a54 6865 206f  entials`...The o
+0000b4f0: 7074 696f 6e61 6c20 6073 7472 6561 6d5f  ptional `stream_
+0000b500: 706f 7369 7469 6f6e 6020 6172 6775 6d65  position` argume
+0000b510: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+0000b520: 696e 7460 2074 6861 7420 6361 6e20 6265  int` that can be
+0000b530: 2075 7365 6420 746f 0a69 6e64 6963 6174   used to.indicat
+0000b540: 6520 7468 6520 706f 7369 7469 6f6e 2069  e the position i
+0000b550: 6e20 7468 6520 7374 7265 616d 2066 726f  n the stream fro
+0000b560: 6d20 7768 6963 6820 746f 2073 7461 7274  m which to start
+0000b570: 2072 6561 6469 6e67 2e20 5468 6520 6465   reading. The de
+0000b580: 6661 756c 7420 7661 6c75 650a 6f66 2060  fault value.of `
+0000b590: 7374 7265 616d 5f70 6f73 6974 696f 6e60  stream_position`
+0000b5a0: 2069 7320 604e 6f6e 6560 2e20 5768 656e   is `None`. When
+0000b5b0: 2072 6561 6469 6e67 2061 2073 7472 6561   reading a strea
+0000b5c0: 6d20 6672 6f6d 2061 2073 7065 6369 6669  m from a specifi
+0000b5d0: 6320 706f 7369 7469 6f6e 2069 6e20 7468  c position in th
+0000b5e0: 650a 7374 7265 616d 2c20 7468 6520 7265  e.stream, the re
+0000b5f0: 636f 7264 6564 2065 7665 6e74 2061 7420  corded event at 
+0000b600: 7468 6174 2070 6f73 6974 696f 6e20 7769  that position wi
+0000b610: 6c6c 2062 6520 696e 636c 7564 6564 2c20  ll be included, 
+0000b620: 626f 7468 2077 6865 6e20 7265 6164 696e  both when readin
+0000b630: 670a 666f 7277 6172 6473 2066 726f 6d20  g.forwards from 
+0000b640: 7468 6174 2070 6f73 6974 696f 6e2c 2061  that position, a
+0000b650: 6e64 2077 6865 6e20 7265 6164 696e 6720  nd when reading 
+0000b660: 6261 636b 7761 7264 732e 0a0a 5468 6520  backwards...The 
+0000b670: 6f70 7469 6f6e 616c 2060 6261 636b 7761  optional `backwa
+0000b680: 7264 7360 2061 7267 756d 656e 7420 6973  rds` argument is
+0000b690: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+0000b6a0: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+0000b6b0: 6c75 6520 6f66 2060 6261 636b 7761 7264  lue of `backward
+0000b6c0: 7360 0a69 7320 6046 616c 7365 602c 2077  s`.is `False`, w
+0000b6d0: 6869 6368 206d 6561 6e73 2074 6865 2073  hich means the s
+0000b6e0: 7472 6561 6d20 7769 6c6c 2062 6520 7265  tream will be re
+0000b6f0: 6164 2066 6f72 7761 7264 732c 2073 6f20  ad forwards, so 
+0000b700: 7468 6174 2065 7665 6e74 7320 6172 6520  that events are 
+0000b710: 7265 7475 726e 6564 0a69 6e20 7468 6520  returned.in the 
+0000b720: 6f72 6465 7220 7468 6579 2077 6572 6520  order they were 
+0000b730: 7265 636f 7264 6564 2e20 4966 2060 6261  recorded. If `ba
+0000b740: 636b 7761 7264 7360 2069 7320 6054 7275  ckwards` is `Tru
+0000b750: 6560 2c20 7468 6520 6576 656e 7473 2061  e`, the events a
+0000b760: 7265 2072 6574 7572 6e65 6420 696e 0a72  re returned in.r
+0000b770: 6576 6572 7365 206f 7264 6572 2e0a 0a49  everse order...I
+0000b780: 6620 6062 6163 6b77 6172 6473 6020 6973  f `backwards` is
+0000b790: 2060 4661 6c73 6560 2061 6e64 2060 7374   `False` and `st
+0000b7a0: 7265 616d 5f70 6f73 6974 696f 6e60 2069  ream_position` i
+0000b7b0: 7320 604e 6f6e 6560 2c20 7468 6520 7374  s `None`, the st
+0000b7c0: 7265 616d 2773 2065 7665 6e74 7320 7769  ream's events wi
+0000b7d0: 6c6c 2062 650a 7265 7475 726e 6564 2069  ll be.returned i
+0000b7e0: 6e20 7468 6520 6f72 6465 7220 7468 6579  n the order they
+0000b7f0: 2077 6572 6520 7265 636f 7264 6564 2c20   were recorded, 
+0000b800: 7374 6172 7469 6e67 2066 726f 6d20 7468  starting from th
+0000b810: 6520 6669 7273 7420 7265 636f 7264 6564  e first recorded
+0000b820: 2065 7665 6e74 2e20 4966 0a60 6261 636b   event. If.`back
+0000b830: 7761 7264 7360 2069 7320 6054 7275 6560  wards` is `True`
+0000b840: 2061 6e64 2060 7374 7265 616d 5f70 6f73   and `stream_pos
+0000b850: 6974 696f 6e60 2069 7320 604e 6f6e 6560  ition` is `None`
+0000b860: 2c20 7468 6520 7374 7265 616d 2773 2065  , the stream's e
+0000b870: 7665 6e74 7320 7769 6c6c 2062 650a 7265  vents will be.re
+0000b880: 7475 726e 6564 2069 6e20 7265 7665 7273  turned in revers
+0000b890: 6520 6f72 6465 722c 2073 7461 7274 696e  e order, startin
+0000b8a0: 6720 6672 6f6d 2074 6865 206c 6173 7420  g from the last 
+0000b8b0: 7265 636f 7264 6564 2065 7665 6e74 2e0a  recorded event..
+0000b8c0: 0a54 6865 206f 7074 696f 6e61 6c20 6072  .The optional `r
+0000b8d0: 6573 6f6c 7665 5f6c 696e 6b73 6020 6172  esolve_links` ar
+0000b8e0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0000b8f0: 6f6e 2060 626f 6f6c 602e 2054 6865 2064  on `bool`. The d
+0000b900: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+0000b910: 6072 6573 6f6c 7665 5f6c 696e 6b73 600a  `resolve_links`.
+0000b920: 6973 2060 4661 6c73 6560 2c20 7768 6963  is `False`, whic
+0000b930: 6820 6d65 616e 7320 616e 7920 6576 656e  h means any even
+0000b940: 7420 6c69 6e6b 7320 7769 6c6c 206e 6f74  t links will not
+0000b950: 2062 6520 7265 736f 6c76 6564 2c20 736f   be resolved, so
+0000b960: 2074 6861 7420 7468 6520 6576 656e 7473   that the events
+0000b970: 2074 6861 7420 6172 650a 7265 7475 726e   that are.return
+0000b980: 6564 206d 6179 2072 6570 7265 7365 6e74  ed may represent
+0000b990: 2065 7665 6e74 206c 696e 6b73 2e20 4966   event links. If
+0000b9a0: 2060 7265 736f 6c76 655f 6c69 6e6b 7360   `resolve_links`
+0000b9b0: 2069 7320 6054 7275 6560 2c20 616e 7920   is `True`, any 
+0000b9c0: 6576 656e 7420 6c69 6e6b 7320 7769 6c6c  event links will
+0000b9d0: 0a62 6520 7265 736f 6c76 6564 2c20 736f  .be resolved, so
+0000b9e0: 2074 6861 7420 7468 6520 6c69 6e6b 6564   that the linked
+0000b9f0: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+0000ba00: 7265 7475 726e 6564 2069 6e73 7465 6164  returned instead
+0000ba10: 206f 6620 7468 6520 6576 656e 7420 6c69   of the event li
+0000ba20: 6e6b 732e 0a0a 5468 6520 6f70 7469 6f6e  nks...The option
+0000ba30: 616c 2060 6c69 6d69 7460 2061 7267 756d  al `limit` argum
+0000ba40: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+0000ba50: 6069 6e74 6020 7768 6963 6820 7265 7374  `int` which rest
+0000ba60: 7269 6374 7320 7468 6520 6e75 6d62 6572  ricts the number
+0000ba70: 206f 6620 6576 656e 7473 0a74 6861 7420   of events.that 
+0000ba80: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
+0000ba90: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+0000baa0: 6c75 6520 6f66 2060 6c69 6d69 7460 2069  lue of `limit` i
+0000bab0: 7320 6073 7973 2e6d 6178 696e 7460 2e0a  s `sys.maxint`..
+0000bac0: 0a54 6865 206f 7074 696f 6e61 6c20 6074  .The optional `t
+0000bad0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+0000bae0: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+0000baf0: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
+0000bb00: 610a 6d61 7869 6d75 6d20 6475 7261 7469  a.maximum durati
+0000bb10: 6f6e 2c20 696e 2073 6563 6f6e 6473 2c20  on, in seconds, 
+0000bb20: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+0000bb30: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+0000bb40: 7065 7261 7469 6f6e 2e0a 0a54 6865 206f  peration...The o
+0000bb50: 7074 696f 6e61 6c20 6063 7265 6465 6e74  ptional `credent
+0000bb60: 6961 6c73 6020 6172 6775 6d65 6e74 2063  ials` argument c
+0000bb70: 616e 2062 6520 7573 6564 2074 6f20 6f76  an be used to ov
+0000bb80: 6572 7269 6465 2063 616c 6c20 6372 6564  erride call cred
+0000bb90: 656e 7469 616c 7320 6465 7269 7665 640a  entials derived.
+0000bba0: 6672 6f6d 2074 6865 2063 6f6e 6e65 6374  from the connect
+0000bbb0: 696f 6e20 7374 7269 6e67 2055 5249 2e20  ion string URI. 
+0000bbc0: 4120 7375 6974 6162 6c65 2076 616c 7565  A suitable value
+0000bbd0: 2066 6f72 2074 6869 7320 6172 6775 6d65   for this argume
+0000bbe0: 6e74 2063 616e 2062 6520 636f 6e73 7472  nt can be constr
+0000bbf0: 7563 7465 640a 6279 2063 616c 6c69 6e67  ucted.by calling
+0000bc00: 2074 6865 2063 6c69 656e 7420 6d65 7468   the client meth
+0000bc10: 6f64 2060 636f 6e73 7472 7563 745f 6361  od `construct_ca
+0000bc20: 6c6c 5f63 7265 6465 6e74 6961 6c73 2829  ll_credentials()
+0000bc30: 602e 0a0a 5468 6520 6578 616d 706c 6520  `...The example 
+0000bc40: 6265 6c6f 7720 7368 6f77 7320 7468 6520  below shows the 
+0000bc50: 6465 6661 756c 7420 6265 6861 7669 6f72  default behavior
+0000bc60: 2c20 7768 6963 6820 6973 2074 6f20 7265  , which is to re
+0000bc70: 7475 726e 2061 6c6c 2074 6865 2072 6563  turn all the rec
+0000bc80: 6f72 6465 640a 6576 656e 7473 206f 6620  orded.events of 
+0000bc90: 6120 7374 7265 616d 2066 6f72 7761 7264  a stream forward
+0000bca0: 7320 6672 6f6d 2074 6865 2066 6972 7374  s from the first
+0000bcb0: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0000bcc0: 2074 6f20 7468 6520 6c61 7374 2e0a 0a60   to the last...`
+0000bcd0: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
+0000bce0: 3d20 636c 6965 6e74 2e67 6574 5f73 7472  = client.get_str
+0000bcf0: 6561 6d28 0a20 2020 2073 7472 6561 6d5f  eam(.    stream_
+0000bd00: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+0000bd10: 310a 290a 0a61 7373 6572 7420 6c65 6e28  1.)..assert len(
+0000bd20: 6576 656e 7473 2920 3d3d 2033 0a61 7373  events) == 3.ass
+0000bd30: 6572 7420 6576 656e 7473 5b30 5d20 3d3d  ert events[0] ==
+0000bd40: 2065 7665 6e74 310a 6173 7365 7274 2065   event1.assert e
+0000bd50: 7665 6e74 735b 315d 203d 3d20 6576 656e  vents[1] == even
+0000bd60: 7432 0a61 7373 6572 7420 6576 656e 7473  t2.assert events
+0000bd70: 5b32 5d20 3d3d 2065 7665 6e74 330a 6060  [2] == event3.``
+0000bd80: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
+0000bd90: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
+0000bda0: 6f20 7573 6520 7468 6520 6073 7472 6561  o use the `strea
+0000bdb0: 6d5f 706f 7369 7469 6f6e 6020 6172 6775  m_position` argu
+0000bdc0: 6d65 6e74 2074 6f20 7265 6164 2061 2073  ment to read a s
+0000bdd0: 7472 6561 6d0a 6672 6f6d 2061 2073 7065  tream.from a spe
+0000bde0: 6369 6669 6320 7374 7265 616d 2070 6f73  cific stream pos
+0000bdf0: 6974 696f 6e20 746f 2074 6865 2065 6e64  ition to the end
+0000be00: 206f 6620 7468 6520 7374 7265 616d 2e20   of the stream. 
+0000be10: 5374 7265 616d 2070 6f73 6974 696f 6e73  Stream positions
+0000be20: 2061 7265 0a7a 6572 6f2d 6261 7365 642c   are.zero-based,
+0000be30: 2061 6e64 2073 6f20 6073 7472 6561 6d5f   and so `stream_
+0000be40: 706f 7369 7469 6f6e 3d31 6020 636f 7272  position=1` corr
+0000be50: 6573 706f 6e64 7320 746f 2074 6865 2073  esponds to the s
+0000be60: 6563 6f6e 6420 6576 656e 7420 7468 6174  econd event that
+0000be70: 2077 6173 0a72 6563 6f72 6465 6420 696e   was.recorded in
+0000be80: 2074 6865 2073 7472 6561 6d2c 2069 6e20   the stream, in 
+0000be90: 7468 6973 2063 6173 6520 6065 7665 6e74  this case `event
+0000bea0: 3260 2e0a 0a60 6060 7079 7468 6f6e 0a65  2`...```python.e
+0000beb0: 7665 6e74 7320 3d20 636c 6965 6e74 2e67  vents = client.g
+0000bec0: 6574 5f73 7472 6561 6d28 0a20 2020 2073  et_stream(.    s
+0000bed0: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+0000bee0: 6d5f 6e61 6d65 312c 0a20 2020 2073 7472  m_name1,.    str
+0000bef0: 6561 6d5f 706f 7369 7469 6f6e 3d31 2c0a  eam_position=1,.
+0000bf00: 290a 0a61 7373 6572 7420 6c65 6e28 6576  )..assert len(ev
+0000bf10: 656e 7473 2920 3d3d 2032 0a61 7373 6572  ents) == 2.asser
+0000bf20: 7420 6576 656e 7473 5b30 5d20 3d3d 2065  t events[0] == e
+0000bf30: 7665 6e74 320a 6173 7365 7274 2065 7665  vent2.assert eve
+0000bf40: 6e74 735b 315d 203d 3d20 6576 656e 7433  nts[1] == event3
+0000bf50: 0a60 6060 0a0a 5468 6520 6578 616d 706c  .```..The exampl
+0000bf60: 6520 6265 6c6f 7720 7368 6f77 7320 686f  e below shows ho
+0000bf70: 7720 746f 2075 7365 2074 6865 2060 6261  w to use the `ba
+0000bf80: 636b 7761 7264 7360 2061 7267 756d 656e  ckwards` argumen
+0000bf90: 7420 746f 2072 6561 6420 6120 7374 7265  t to read a stre
+0000bfa0: 616d 2062 6163 6b77 6172 6473 2e0a 0a60  am backwards...`
+0000bfb0: 6060 7079 7468 6f6e 0a65 7665 6e74 7320  ``python.events 
+0000bfc0: 3d20 636c 6965 6e74 2e67 6574 5f73 7472  = client.get_str
+0000bfd0: 6561 6d28 0a20 2020 2073 7472 6561 6d5f  eam(.    stream_
+0000bfe0: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+0000bff0: 312c 0a20 2020 2062 6163 6b77 6172 6473  1,.    backwards
+0000c000: 3d54 7275 652c 0a29 0a0a 6173 7365 7274  =True,.)..assert
+0000c010: 206c 656e 2865 7665 6e74 7329 203d 3d20   len(events) == 
+0000c020: 330a 6173 7365 7274 2065 7665 6e74 735b  3.assert events[
+0000c030: 305d 203d 3d20 6576 656e 7433 0a61 7373  0] == event3.ass
+0000c040: 6572 7420 6576 656e 7473 5b31 5d20 3d3d  ert events[1] ==
+0000c050: 2065 7665 6e74 320a 6173 7365 7274 2065   event2.assert e
+0000c060: 7665 6e74 735b 325d 203d 3d20 6576 656e  vents[2] == even
+0000c070: 7431 0a60 6060 0a0a 5468 6520 6578 616d  t1.```..The exam
+0000c080: 706c 6520 6265 6c6f 7720 7368 6f77 7320  ple below shows 
+0000c090: 686f 7720 746f 2075 7365 2074 6865 2060  how to use the `
+0000c0a0: 6c69 6d69 7460 2061 7267 756d 656e 7420  limit` argument 
+0000c0b0: 746f 2072 6561 6420 6120 6c69 6d69 7465  to read a limite
+0000c0c0: 6420 6e75 6d62 6572 206f 660a 6576 656e  d number of.even
+0000c0d0: 7473 2e0a 0a60 6060 7079 7468 6f6e 0a65  ts...```python.e
+0000c0e0: 7665 6e74 7320 3d20 636c 6965 6e74 2e67  vents = client.g
+0000c0f0: 6574 5f73 7472 6561 6d28 0a20 2020 2073  et_stream(.    s
+0000c100: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+0000c110: 6d5f 6e61 6d65 312c 0a20 2020 206c 696d  m_name1,.    lim
+0000c120: 6974 3d32 2c0a 290a 0a61 7373 6572 7420  it=2,.)..assert 
+0000c130: 6c65 6e28 6576 656e 7473 2920 3d3d 2032  len(events) == 2
+0000c140: 0a61 7373 6572 7420 6576 656e 7473 5b30  .assert events[0
+0000c150: 5d20 3d3d 2065 7665 6e74 310a 6173 7365  ] == event1.asse
+0000c160: 7274 2065 7665 6e74 735b 315d 203d 3d20  rt events[1] == 
+0000c170: 6576 656e 7432 0a60 6060 0a0a 5468 6520  event2.```..The 
+0000c180: 6072 6561 645f 7374 7265 616d 2829 6020  `read_stream()` 
+0000c190: 616e 6420 6067 6574 5f73 7472 6561 6d28  and `get_stream(
+0000c1a0: 2960 206d 6574 686f 6473 2077 696c 6c20  )` methods will 
+0000c1b0: 7261 6973 6520 6120 604e 6f74 466f 756e  raise a `NotFoun
+0000c1c0: 6460 2065 7863 6570 7469 6f6e 2069 6620  d` exception if 
+0000c1d0: 7468 650a 6e61 6d65 6420 7374 7265 616d  the.named stream
+0000c1e0: 2068 6173 206e 6576 6572 2065 7869 7374   has never exist
+0000c1f0: 6564 206f 7220 6861 7320 6265 656e 2064  ed or has been d
+0000c200: 656c 6574 6564 2e0a 0a60 6060 7079 7468  eleted...```pyth
+0000c210: 6f6e 0a66 726f 6d20 6573 6462 636c 6965  on.from esdbclie
+0000c220: 6e74 2e65 7863 6570 7469 6f6e 7320 696d  nt.exceptions im
+0000c230: 706f 7274 204e 6f74 466f 756e 640a 0a0a  port NotFound...
+0000c240: 7472 793a 0a20 2020 2063 6c69 656e 742e  try:.    client.
+0000c250: 6765 745f 7374 7265 616d 2827 646f 6573  get_stream('does
+0000c260: 2d6e 6f74 2d65 7869 7374 2729 0a65 7863  -not-exist').exc
+0000c270: 6570 7420 4e6f 7446 6f75 6e64 3a0a 2020  ept NotFound:.  
+0000c280: 2020 7061 7373 2020 2320 5468 6520 7374    pass  # The st
+0000c290: 7265 616d 2064 6f65 7320 6e6f 7420 6578  ream does not ex
+0000c2a0: 6973 742e 0a65 6c73 653a 0a20 2020 2072  ist..else:.    r
+0000c2b0: 6169 7365 2045 7863 6570 7469 6f6e 2822  aise Exception("
+0000c2c0: 5368 6f75 6c64 6e27 7420 6765 7420 6865  Shouldn't get he
+0000c2d0: 7265 2229 0a60 6060 0a0a 506c 6561 7365  re").```..Please
+0000c2e0: 206e 6f74 652c 2074 6865 2060 6765 745f   note, the `get_
+0000c2f0: 7374 7265 616d 2829 6020 6d65 7468 6f64  stream()` method
+0000c300: 2069 7320 6465 636f 7261 7465 6420 7769   is decorated wi
+0000c310: 7468 2074 6865 2060 4061 7574 6f72 6563  th the `@autorec
+0000c320: 6f6e 6e65 6374 6020 616e 640a 6040 7265  onnect` and.`@re
+0000c330: 7472 7967 7270 6360 2064 6563 6f72 6174  trygrpc` decorat
+0000c340: 6f72 732c 2077 6869 6c73 7420 7468 6520  ors, whilst the 
+0000c350: 6072 6561 645f 7374 7265 616d 2829 6020  `read_stream()` 
+0000c360: 6d65 7468 6f64 2069 7320 6e6f 742e 2054  method is not. T
+0000c370: 6869 7320 6d65 616e 7320 7468 6174 0a61  his means that.a
+0000c380: 6c6c 2065 7272 6f72 7320 6475 6520 746f  ll errors due to
+0000c390: 2063 6f6e 6e65 6374 696f 6e20 6973 7375   connection issu
+0000c3a0: 6573 2077 696c 6c20 6265 2063 6175 6768  es will be caugh
+0000c3b0: 7420 6279 2074 6865 2072 6574 7279 2061  t by the retry a
+0000c3c0: 6e64 2072 6563 6f6e 6e65 6374 2064 6563  nd reconnect dec
+0000c3d0: 6f72 6174 6f72 730a 7768 656e 2063 616c  orators.when cal
+0000c3e0: 6c69 6e67 2074 6865 2060 6765 745f 7374  ling the `get_st
+0000c3f0: 7265 616d 2829 6020 6d65 7468 6f64 2c20  ream()` method, 
+0000c400: 6275 7420 6e6f 7420 7768 656e 2063 616c  but not when cal
+0000c410: 6c69 6e67 2060 7265 6164 5f73 7472 6561  ling `read_strea
+0000c420: 6d28 2960 2e20 5468 650a 6072 6561 645f  m()`. The.`read_
+0000c430: 7374 7265 616d 2829 6020 6d65 7468 6f64  stream()` method
+0000c440: 2068 6173 206e 6f20 7375 6368 2064 6563   has no such dec
+0000c450: 6f72 6174 6f72 7320 6265 6361 7573 6520  orators because 
+0000c460: 7468 6520 7374 7265 616d 696e 6720 6f6e  the streaming on
+0000c470: 6c79 2073 7461 7274 730a 7768 656e 2069  ly starts.when i
+0000c480: 7465 7261 7469 6e67 206f 7665 7220 7468  terating over th
+0000c490: 6520 2272 6561 6420 7265 7370 6f6e 7365  e "read response
+0000c4a0: 2220 7374 6172 7473 2c20 7768 6963 6820  " starts, which 
+0000c4b0: 6d65 616e 7320 7468 6174 2074 6865 206d  means that the m
+0000c4c0: 6574 686f 6420 7265 7475 726e 730a 6265  ethod returns.be
+0000c4d0: 666f 7265 2074 6865 2073 7472 6561 6d69  fore the streami
+0000c4e0: 6e67 2073 7461 7274 732c 2061 6e64 2073  ng starts, and s
+0000c4f0: 6f20 7468 6572 6520 6973 206e 6f20 6368  o there is no ch
+0000c500: 616e 6365 2066 6f72 2061 6e79 2064 6563  ance for any dec
+0000c510: 6f72 6174 6f72 7320 746f 2063 6174 6368  orators to catch
+0000c520: 0a61 6e79 2063 6f6e 6e65 6374 696f 6e20  .any connection 
+0000c530: 6973 7375 6573 2e0a 0a46 6f72 2074 6865  issues...For the
+0000c540: 2073 616d 6520 7265 6173 6f6e 2c20 6072   same reason, `r
+0000c550: 6561 645f 7374 7265 616d 2829 6020 7769  ead_stream()` wi
+0000c560: 6c6c 206e 6f74 2072 6169 7365 2061 2060  ll not raise a `
+0000c570: 4e6f 7446 6f75 6e64 6020 6578 6365 7074  NotFound` except
+0000c580: 696f 6e20 7768 656e 0a74 6865 2073 7472  ion when.the str
+0000c590: 6561 6d20 646f 6573 206e 6f74 2065 7869  eam does not exi
+0000c5a0: 7374 2c20 756e 7469 6c20 6974 6572 6174  st, until iterat
+0000c5b0: 696e 6720 6f76 6572 2074 6865 2022 7265  ing over the "re
+0000c5c0: 6164 2072 6573 706f 6e73 6522 206f 626a  ad response" obj
+0000c5d0: 6563 7420 6265 6769 6e73 2e0a 0a49 6620  ect begins...If 
+0000c5e0: 796f 7520 6172 6520 7265 6164 696e 6720  you are reading 
+0000c5f0: 6120 7665 7279 206c 6172 6765 2073 7472  a very large str
+0000c600: 6561 6d2c 2074 6865 6e20 796f 7520 6d69  eam, then you mi
+0000c610: 6768 7420 7072 6566 6572 2074 6f20 6361  ght prefer to ca
+0000c620: 6c6c 2060 7265 6164 5f73 7472 6561 6d28  ll `read_stream(
+0000c630: 2960 2c0a 616e 6420 6265 6769 6e20 6974  )`,.and begin it
+0000c640: 6572 6174 696e 6720 7468 726f 7567 6820  erating through 
+0000c650: 7468 6520 7265 636f 7264 6564 2065 7665  the recorded eve
+0000c660: 6e74 7320 7768 696c 7374 2074 6865 7920  nts whilst they 
+0000c670: 6172 6520 6265 696e 6720 7374 7265 616d  are being stream
+0000c680: 6564 2066 726f 6d0a 7468 6520 7365 7276  ed from.the serv
+0000c690: 6572 2c20 7261 7468 6572 2074 6861 6e20  er, rather than 
+0000c6a0: 626f 7468 2077 6169 7469 6e67 2061 6e64  both waiting and
+0000c6b0: 2068 6176 696e 6720 7468 656d 2061 6c6c   having them all
+0000c6c0: 2061 6363 756d 756c 6174 6520 696e 206d   accumulate in m
+0000c6d0: 656d 6f72 792e 0a0a 2323 2320 4765 7420  emory...### Get 
+0000c6e0: 6375 7272 656e 7420 7665 7273 696f 6e3c  current version<
+0000c6f0: 6120 6964 3d22 6765 742d 6375 7272 656e  a id="get-curren
+0000c700: 742d 7665 7273 696f 6e22 3e3c 2f61 3e0a  t-version"></a>.
+0000c710: 0a54 6865 2060 6765 745f 6375 7272 656e  .The `get_curren
+0000c720: 745f 7665 7273 696f 6e28 2960 206d 6574  t_version()` met
+0000c730: 686f 6420 6973 2061 2063 6f6e 7665 6e69  hod is a conveni
+0000c740: 656e 6365 206d 6574 686f 6420 7468 6174  ence method that
+0000c750: 2065 7373 656e 7469 616c 6c79 2063 616c   essentially cal
+0000c760: 6c73 0a60 6765 745f 7374 7265 616d 2829  ls.`get_stream()
+0000c770: 6020 7769 7468 2060 6261 636b 7761 7264  ` with `backward
+0000c780: 733d 5472 7565 6020 616e 6420 606c 696d  s=True` and `lim
+0000c790: 6974 3d31 602e 2054 6869 7320 6d65 7468  it=1`. This meth
+0000c7a0: 6f64 2072 6574 7572 6e73 0a74 6865 2076  od returns.the v
+0000c7b0: 616c 7565 206f 6620 7468 6520 6073 7472  alue of the `str
+0000c7c0: 6561 6d5f 706f 7369 7469 6f6e 6020 6174  eam_position` at
+0000c7d0: 7472 6962 7574 6520 6f66 2074 6865 206c  tribute of the l
+0000c7e0: 6173 7420 7265 636f 7264 6564 2065 7665  ast recorded eve
+0000c7f0: 6e74 2069 6e20 610a 7374 7265 616d 2e20  nt in a.stream. 
+0000c800: 4966 2061 2073 7472 6561 6d20 646f 6573  If a stream does
+0000c810: 206e 6f74 2065 7869 7374 2c20 7468 6520   not exist, the 
+0000c820: 7265 7475 726e 6564 2076 616c 7565 2069  returned value i
+0000c830: 7320 6053 7472 6561 6d53 7461 7465 2e4e  s `StreamState.N
+0000c840: 4f5f 5354 5245 414d 602e 0a54 6865 2072  O_STREAM`..The r
+0000c850: 6574 7572 6e65 6420 7661 6c75 6520 6973  eturned value is
+0000c860: 2074 6865 2063 6f72 7265 6374 2076 616c   the correct val
+0000c870: 7565 206f 6620 6063 7572 7265 6e74 5f76  ue of `current_v
+0000c880: 6572 7369 6f6e 6020 7768 656e 2061 7070  ersion` when app
+0000c890: 656e 6469 6e67 2065 7665 6e74 730a 746f  ending events.to
+0000c8a0: 2061 2073 7472 6561 6d2c 2061 6e64 2077   a stream, and w
+0000c8b0: 6865 6e20 6465 6c65 7469 6e67 206f 7220  hen deleting or 
+0000c8c0: 746f 6d62 7374 6f6e 696e 6720 6120 7374  tombstoning a st
+0000c8d0: 7265 616d 2e0a 0a54 6869 7320 6d65 7468  ream...This meth
+0000c8e0: 6f64 2068 6173 206f 6e65 2072 6571 7569  od has one requi
+0000c8f0: 7265 6420 6172 6775 6d65 6e74 2c20 6073  red argument, `s
+0000c900: 7472 6561 6d5f 6e61 6d65 602e 0a0a 5468  tream_name`...Th
+0000c910: 6520 7265 7175 6972 6564 2060 7374 7265  e required `stre
+0000c920: 616d 5f6e 616d 6560 2061 7267 756d 656e  am_name` argumen
+0000c930: 7420 6973 2061 2050 7974 686f 6e20 6073  t is a Python `s
+0000c940: 7472 6020 7468 6174 2075 6e69 7175 656c  tr` that uniquel
+0000c950: 7920 6964 656e 7469 6669 6573 2061 0a73  y identifies a.s
+0000c960: 7472 6561 6d20 6672 6f6d 2077 6869 6368  tream from which
+0000c970: 2061 2073 7472 6561 6d20 706f 7369 7469   a stream positi
+0000c980: 6f6e 2077 696c 6c20 6265 2072 6574 7572  on will be retur
+0000c990: 6e65 642e 0a0a 5468 6973 206d 6574 686f  ned...This metho
+0000c9a0: 6420 6861 7320 616e 206f 7074 696f 6e61  d has an optiona
+0000c9b0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+0000c9c0: 6d65 6e74 2c20 7768 6963 6820 6973 2061  ment, which is a
+0000c9d0: 2050 7974 686f 6e20 6066 6c6f 6174 600a   Python `float`.
+0000c9e0: 7468 6174 2073 6574 7320 6120 6d61 7869  that sets a maxi
+0000c9f0: 6d75 6d20 6475 7261 7469 6f6e 2c20 696e  mum duration, in
+0000ca00: 2073 6563 6f6e 6473 2c20 666f 7220 7468   seconds, for th
+0000ca10: 6520 636f 6d70 6c65 7469 6f6e 206f 6620  e completion of 
+0000ca20: 7468 6520 6752 5043 206f 7065 7261 7469  the gRPC operati
+0000ca30: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
+0000ca40: 2068 6173 2061 6e20 6f70 7469 6f6e 616c   has an optional
+0000ca50: 2060 6372 6564 656e 7469 616c 7360 2061   `credentials` a
+0000ca60: 7267 756d 656e 742c 2077 6869 6368 2063  rgument, which c
+0000ca70: 616e 2062 6520 7573 6564 2074 6f0a 6f76  an be used to.ov
+0000ca80: 6572 7269 6465 2063 616c 6c20 6372 6564  erride call cred
+0000ca90: 656e 7469 616c 7320 6465 7269 7665 6420  entials derived 
+0000caa0: 6672 6f6d 2074 6865 2063 6f6e 6e65 6374  from the connect
+0000cab0: 696f 6e20 7374 7269 6e67 2055 5249 2e0a  ion string URI..
+0000cac0: 0a49 6e20 7468 6520 6578 616d 706c 6520  .In the example 
+0000cad0: 6265 6c6f 772c 2074 6865 206c 6173 7420  below, the last 
+0000cae0: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+0000caf0: 6f66 2060 7374 7265 616d 5f6e 616d 6531  of `stream_name1
+0000cb00: 6020 6973 206f 6274 6169 6e65 642e 0a53  ` is obtained..S
+0000cb10: 696e 6365 2074 6872 6565 2065 7665 6e74  ince three event
+0000cb20: 7320 6861 7665 2062 6565 6e20 6170 7065  s have been appe
+0000cb30: 6e64 6564 2074 6f20 6073 7472 6561 6d5f  nded to `stream_
+0000cb40: 6e61 6d65 3160 2c20 616e 6420 6265 6361  name1`, and beca
+0000cb50: 7573 6520 706f 7369 7469 6f6e 730a 696e  use positions.in
+0000cb60: 2061 2073 7472 6561 6d20 6172 6520 7a65   a stream are ze
+0000cb70: 726f 2d62 6173 6564 2061 6e64 2067 6170  ro-based and gap
+0000cb80: 6c65 7373 2c20 736f 2074 6865 2063 7572  less, so the cur
+0000cb90: 7265 6e74 2076 6572 7369 6f6e 2069 7320  rent version is 
+0000cba0: 6032 602e 0a0a 6060 6070 7974 686f 6e0a  `2`...```python.
+0000cbb0: 6375 7272 656e 745f 7665 7273 696f 6e20  current_version 
+0000cbc0: 3d20 636c 6965 6e74 2e67 6574 5f63 7572  = client.get_cur
+0000cbd0: 7265 6e74 5f76 6572 7369 6f6e 280a 2020  rent_version(.  
+0000cbe0: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+0000cbf0: 7265 616d 5f6e 616d 6531 0a29 0a0a 6173  ream_name1.)..as
+0000cc00: 7365 7274 2063 7572 7265 6e74 5f76 6572  sert current_ver
+0000cc10: 7369 6f6e 203d 3d20 320a 6060 600a 0a49  sion == 2.```..I
+0000cc20: 6620 6120 7374 7265 616d 2068 6173 206e  f a stream has n
+0000cc30: 6576 6572 2065 7869 7374 6564 206f 7220  ever existed or 
+0000cc40: 6861 7320 6265 656e 2064 656c 6574 6564  has been deleted
+0000cc50: 2c20 7468 6520 7265 7475 726e 6564 2076  , the returned v
+0000cc60: 616c 7565 2069 730a 6053 7472 6561 6d53  alue is.`StreamS
+0000cc70: 7461 7465 2e4e 4f5f 5354 5245 414d 602c  tate.NO_STREAM`,
+0000cc80: 2077 6869 6368 2069 7320 7468 6520 636f   which is the co
+0000cc90: 7272 6563 7420 7661 6c75 6520 6f66 2074  rrect value of t
+0000cca0: 6865 2060 6375 7272 656e 745f 7665 7273  he `current_vers
+0000ccb0: 696f 6e60 0a61 7267 756d 656e 7420 626f  ion`.argument bo
+0000ccc0: 7468 2077 6865 6e20 6170 7065 6e64 696e  th when appendin
+0000ccd0: 6720 7468 6520 6669 7273 7420 6576 656e  g the first even
+0000cce0: 7420 6f66 2061 206e 6577 2073 7472 6561  t of a new strea
+0000ccf0: 6d2c 2061 6e64 2061 6c73 6f20 7768 656e  m, and also when
+0000cd00: 0a61 7070 656e 6469 6e67 2065 7665 6e74  .appending event
+0000cd10: 7320 746f 2061 2073 7472 6561 6d20 7468  s to a stream th
+0000cd20: 6174 2068 6173 2062 6565 6e20 6465 6c65  at has been dele
+0000cd30: 7465 642e 0a0a 6060 6070 7974 686f 6e0a  ted...```python.
+0000cd40: 6375 7272 656e 745f 7665 7273 696f 6e20  current_version 
+0000cd50: 3d20 636c 6965 6e74 2e67 6574 5f63 7572  = client.get_cur
+0000cd60: 7265 6e74 5f76 6572 7369 6f6e 280a 2020  rent_version(.  
+0000cd70: 2020 7374 7265 616d 5f6e 616d 653d 2764    stream_name='d
+0000cd80: 6f65 732d 6e6f 742d 6578 6973 7427 0a29  oes-not-exist'.)
+0000cd90: 0a0a 6173 7365 7274 2063 7572 7265 6e74  ..assert current
+0000cda0: 5f76 6572 7369 6f6e 2069 7320 5374 7265  _version is Stre
+0000cdb0: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
+0000cdc0: 4d0a 6060 600a 0a23 2323 2048 6f77 2074  M.```..### How t
+0000cdd0: 6f20 696d 706c 656d 656e 7420 736e 6170  o implement snap
+0000cde0: 7368 6f74 7469 6e67 2077 6974 6820 4576  shotting with Ev
+0000cdf0: 656e 7453 746f 7265 4442 3c61 2069 643d  entStoreDB<a id=
+0000ce00: 2268 6f77 2d74 6f2d 696d 706c 656d 656e  "how-to-implemen
+0000ce10: 742d 736e 6170 7368 6f74 7469 6e67 2d77  t-snapshotting-w
+0000ce20: 6974 682d 6576 656e 7473 746f 7265 6462  ith-eventstoredb
+0000ce30: 223e 3c2f 613e 0a0a 536e 6170 7368 6f74  "></a>..Snapshot
+0000ce40: 7320 6361 6e20 696d 7072 6f76 6520 7468  s can improve th
+0000ce50: 6520 7065 7266 6f72 6d61 6e63 6520 6f66  e performance of
+0000ce60: 2061 6767 7265 6761 7465 7320 7468 6174   aggregates that
+0000ce70: 2077 6f75 6c64 206f 7468 6572 7769 7365   would otherwise
+0000ce80: 2062 650a 7265 636f 6e73 7472 7563 7465   be.reconstructe
+0000ce90: 6420 6672 6f6d 2076 6572 7920 6c6f 6e67  d from very long
+0000cea0: 2073 7472 6561 6d73 2e20 486f 7765 7665   streams. Howeve
+0000ceb0: 722c 2069 7420 6973 2067 656e 6572 616c  r, it is general
+0000cec0: 6c79 2072 6563 6f6d 6d65 6e64 6564 2074  ly recommended t
+0000ced0: 6f20 6465 7369 676e 0a61 6767 7265 6761  o design.aggrega
+0000cee0: 7465 7320 746f 2068 6176 6520 6120 6669  tes to have a fi
+0000cef0: 6e69 7465 206c 6966 6563 7963 6c65 2c20  nite lifecycle, 
+0000cf00: 616e 6420 736f 2074 6f20 6861 7665 2072  and so to have r
+0000cf10: 656c 6174 6976 656c 7920 7368 6f72 7420  elatively short 
+0000cf20: 7374 7265 616d 732c 0a74 6865 7265 6279  streams,.thereby
+0000cf30: 2061 766f 6964 696e 6720 7468 6520 6e65   avoiding the ne
+0000cf40: 6564 2066 6f72 2073 6e61 7073 686f 7474  ed for snapshott
+0000cf50: 696e 672e 2054 6869 7320 2268 6f77 2074  ing. This "how t
+0000cf60: 6f22 2073 6563 7469 6f6e 2069 7320 696e  o" section is in
+0000cf70: 7465 6e64 6564 206d 6572 656c 790a 746f  tended merely.to
+0000cf80: 2073 686f 7720 686f 7720 736e 6170 7368   show how snapsh
+0000cf90: 6f74 7469 6e67 206f 6620 6167 6772 6567  otting of aggreg
+0000cfa0: 6174 6573 2063 616e 2062 6520 696d 706c  ates can be impl
+0000cfb0: 656d 656e 7465 6420 7769 7468 2045 7665  emented with Eve
+0000cfc0: 6e74 5374 6f72 6544 4220 7573 696e 670a  ntStoreDB using.
+0000cfd0: 7468 6973 2050 7974 686f 6e20 636c 6965  this Python clie
+0000cfe0: 6e74 2e0a 0a45 7665 6e74 2d73 6f75 7263  nt...Event-sourc
+0000cff0: 6564 2061 6767 7265 6761 7465 7320 6172  ed aggregates ar
+0000d000: 6520 7479 7069 6361 6c6c 7920 7265 636f  e typically reco
+0000d010: 6e73 7472 7563 7465 6420 6672 6f6d 2072  nstructed from r
+0000d020: 6563 6f72 6465 6420 6576 656e 7473 2062  ecorded events b
+0000d030: 7920 6361 6c6c 696e 670a 6120 6d75 7461  y calling.a muta
+0000d040: 746f 7220 6675 6e63 7469 6f6e 2066 6f72  tor function for
+0000d050: 2065 6163 6820 7265 636f 7264 6564 2065   each recorded e
+0000d060: 7665 6e74 2c20 6576 6f6c 7669 6e67 2066  vent, evolving f
+0000d070: 726f 6d20 616e 2069 6e69 7469 616c 2073  rom an initial s
+0000d080: 7461 7465 0a60 4e6f 6e65 6020 746f 2074  tate.`None` to t
+0000d090: 6865 2063 7572 7265 6e74 2073 7461 7465  he current state
+0000d0a0: 206f 6620 7468 6520 6167 6772 6567 6174   of the aggregat
+0000d0b0: 652e 2054 6865 2066 756e 6374 696f 6e20  e. The function 
+0000d0c0: 6067 6574 5f61 6767 7265 6761 7465 2829  `get_aggregate()
+0000d0d0: 6020 7368 6f77 730a 686f 7720 7468 6973  ` shows.how this
+0000d0e0: 2063 616e 2062 6520 646f 6e65 2e20 5468   can be done. Th
+0000d0f0: 6520 6167 6772 6567 6174 6520 4944 2069  e aggregate ID i
+0000d100: 7320 7573 6564 2061 7320 6120 7374 7265  s used as a stre
+0000d110: 616d 206e 616d 652e 2054 6865 2065 7863  am name. The exc
+0000d120: 6570 7469 6f6e 0a60 4167 6772 6567 6174  eption.`Aggregat
+0000d130: 654e 6f74 466f 756e 6460 2069 7320 7261  eNotFound` is ra
+0000d140: 6973 6564 2069 6620 7468 6520 6167 6772  ised if the aggr
+0000d150: 6567 6174 6520 7374 7265 616d 2069 7320  egate stream is 
+0000d160: 6e6f 7420 666f 756e 642e 0a0a 6060 6070  not found...```p
+0000d170: 7974 686f 6e0a 636c 6173 7320 4167 6772  ython.class Aggr
+0000d180: 6567 6174 654e 6f74 466f 756e 6428 4578  egateNotFound(Ex
+0000d190: 6365 7074 696f 6e29 3a0a 2020 2020 2222  ception):.    ""
+0000d1a0: 2252 6169 7365 6420 7768 656e 2061 6e20  "Raised when an 
+0000d1b0: 6167 6772 6567 6174 6520 6973 206e 6f74  aggregate is not
+0000d1c0: 2066 6f75 6e64 2e22 2222 0a0a 0a64 6566   found."""...def
+0000d1d0: 2067 6574 5f61 6767 7265 6761 7465 2861   get_aggregate(a
+0000d1e0: 6767 7265 6761 7465 5f69 642c 206d 7574  ggregate_id, mut
+0000d1f0: 6174 6f72 5f66 756e 6329 3a0a 2020 2020  ator_func):.    
+0000d200: 7374 7265 616d 5f6e 616d 6520 3d20 6167  stream_name = ag
+0000d210: 6772 6567 6174 655f 6964 0a0a 2020 2020  gregate_id..    
+0000d220: 2320 4765 7420 7265 636f 7264 6564 2065  # Get recorded e
+0000d230: 7665 6e74 732e 0a20 2020 2074 7279 3a0a  vents..    try:.
+0000d240: 2020 2020 2020 2020 6576 656e 7473 203d          events =
+0000d250: 2063 6c69 656e 742e 6765 745f 7374 7265   client.get_stre
+0000d260: 616d 280a 2020 2020 2020 2020 2020 2020  am(.            
+0000d270: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+0000d280: 616d 5f6e 616d 652c 0a20 2020 2020 2020  am_name,.       
+0000d290: 2020 2020 2073 7472 6561 6d5f 706f 7369       stream_posi
+0000d2a0: 7469 6f6e 3d4e 6f6e 650a 2020 2020 2020  tion=None.      
+0000d2b0: 2020 290a 2020 2020 6578 6365 7074 204e    ).    except N
+0000d2c0: 6f74 466f 756e 6420 6173 2065 3a0a 2020  otFound as e:.  
+0000d2d0: 2020 2020 2020 7261 6973 6520 4167 6772        raise Aggr
+0000d2e0: 6567 6174 654e 6f74 466f 756e 6428 6167  egateNotFound(ag
+0000d2f0: 6772 6567 6174 655f 6964 2920 6672 6f6d  gregate_id) from
+0000d300: 2065 0a20 2020 2065 6c73 653a 0a20 2020   e.    else:.   
+0000d310: 2020 2020 2023 2052 6563 6f6e 7374 7275       # Reconstru
+0000d320: 6374 2061 6767 7265 6761 7465 2066 726f  ct aggregate fro
+0000d330: 6d20 7265 636f 7264 6564 2065 7665 6e74  m recorded event
+0000d340: 732e 0a20 2020 2020 2020 2061 6767 7265  s..        aggre
+0000d350: 6761 7465 203d 204e 6f6e 650a 2020 2020  gate = None.    
+0000d360: 2020 2020 666f 7220 6576 656e 7420 696e      for event in
+0000d370: 2065 7665 6e74 733a 0a20 2020 2020 2020   events:.       
+0000d380: 2020 2020 2061 6767 7265 6761 7465 203d       aggregate =
+0000d390: 206d 7574 6174 6f72 5f66 756e 6328 6167   mutator_func(ag
+0000d3a0: 6772 6567 6174 652c 2065 7665 6e74 290a  gregate, event).
+0000d3b0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+0000d3c0: 6767 7265 6761 7465 0a60 6060 0a0a 536e  ggregate.```..Sn
+0000d3d0: 6170 7368 6f74 7469 6e67 206f 6620 6167  apshotting of ag
+0000d3e0: 6772 6567 6174 6573 2063 616e 2062 6520  gregates can be 
+0000d3f0: 696d 706c 656d 656e 7465 6420 6279 2072  implemented by r
+0000d400: 6563 6f72 6469 6e67 2074 6865 2063 7572  ecording the cur
+0000d410: 7265 6e74 2073 7461 7465 206f 660a 616e  rent state of.an
+0000d420: 2061 6767 7265 6761 7465 2061 7320 6120   aggregate as a 
+0000d430: 6e65 7720 6576 656e 742e 0a0a 4966 2061  new event...If a
+0000d440: 6e20 6167 6772 6567 6174 6520 6f62 6a65  n aggregate obje
+0000d450: 6374 2068 6173 2061 2076 6572 7369 6f6e  ct has a version
+0000d460: 206e 756d 6265 7220 7468 6174 2063 6f72   number that cor
+0000d470: 7265 7370 6f6e 6473 2074 6f20 7468 6520  responds to the 
+0000d480: 7374 7265 616d 2070 6f73 6974 696f 6e20  stream position 
+0000d490: 6f66 0a74 6865 206c 6173 7420 6576 656e  of.the last even
+0000d4a0: 7420 7468 6174 2077 6173 2075 7365 6420  t that was used 
+0000d4b0: 746f 2072 6563 6f6e 7374 7275 6374 2074  to reconstruct t
+0000d4c0: 6865 2061 6767 7265 6761 7465 2c20 616e  he aggregate, an
+0000d4d0: 6420 7468 6973 2076 6572 7369 6f6e 206e  d this version n
+0000d4e0: 756d 6265 720a 6973 2072 6563 6f72 6465  umber.is recorde
+0000d4f0: 6420 696e 2074 6865 2073 6e61 7073 686f  d in the snapsho
+0000d500: 7420 6d65 7461 6461 7461 2c20 7468 656e  t metadata, then
+0000d510: 2061 6e79 2065 7665 6e74 7320 7468 6174   any events that
+0000d520: 2061 7265 2072 6563 6f72 6465 6420 6166   are recorded af
+0000d530: 7465 7220 7468 650a 736e 6170 7368 6f74  ter the.snapshot
+0000d540: 2063 616e 2062 6520 7365 6c65 6374 6564   can be selected
+0000d550: 2075 7369 6e67 2074 6869 7320 7665 7273   using this vers
+0000d560: 696f 6e20 6e75 6d62 6572 2e20 5468 6520  ion number. The 
+0000d570: 6167 6772 6567 6174 6520 6361 6e20 7468  aggregate can th
+0000d580: 656e 2062 650a 7265 636f 6e73 7472 7563  en be.reconstruc
+0000d590: 7465 6420 6672 6f6d 2074 6865 206c 6173  ted from the las
+0000d5a0: 7420 736e 6170 7368 6f74 2061 6e64 2061  t snapshot and a
+0000d5b0: 6e79 2073 7562 7365 7175 656e 7420 6576  ny subsequent ev
+0000d5c0: 656e 7473 2c20 7769 7468 6f75 7420 6861  ents, without ha
+0000d5d0: 7669 6e67 0a74 6f20 7265 706c 6179 2074  ving.to replay t
+0000d5e0: 6865 2065 6e74 6972 6520 6869 7374 6f72  he entire histor
+0000d5f0: 792e 0a0a 5765 2077 696c 6c20 7573 6520  y...We will use 
+0000d600: 6120 7365 7061 7261 7465 2073 7472 6561  a separate strea
+0000d610: 6d20 666f 7220 616e 2061 6767 7265 6761  m for an aggrega
+0000d620: 7465 2773 2073 6e61 7073 686f 7473 2074  te's snapshots t
+0000d630: 6861 7420 6973 206e 616d 6564 2061 6674  hat is named aft
+0000d640: 6572 2074 6865 0a73 7472 6561 6d20 7573  er the.stream us
+0000d650: 6564 2066 6f72 2072 6563 6f72 6469 6e67  ed for recording
+0000d660: 2069 7473 2065 7665 6e74 732e 2054 6865   its events. The
+0000d670: 206e 616d 6520 6f66 2074 6865 2073 6e61   name of the sna
+0000d680: 7073 686f 7420 7374 7265 616d 2077 696c  pshot stream wil
+0000d690: 6c20 6265 0a63 6f6e 7374 7275 6374 6564  l be.constructed
+0000d6a0: 2062 7920 7072 6566 6978 696e 6720 7468   by prefixing th
+0000d6b0: 6520 6167 6772 6567 6174 6527 7320 7374  e aggregate's st
+0000d6c0: 7265 616d 206e 616d 6520 7769 7468 2060  ream name with `
+0000d6d0: 2773 6e61 7073 686f 742d 2427 602e 0a0a  'snapshot-$'`...
+0000d6e0: 6060 6070 7974 686f 6e0a 534e 4150 5348  ```python.SNAPSH
+0000d6f0: 4f54 5f53 5452 4541 4d5f 4e41 4d45 5f50  OT_STREAM_NAME_P
+0000d700: 5245 4649 5820 3d20 2773 6e61 7073 686f  REFIX = 'snapsho
+0000d710: 742d 2427 0a0a 6465 6620 6d61 6b65 5f73  t-$'..def make_s
+0000d720: 6e61 7073 686f 745f 7374 7265 616d 5f6e  napshot_stream_n
+0000d730: 616d 6528 7374 7265 616d 5f6e 616d 6529  ame(stream_name)
+0000d740: 3a0a 2020 2020 7265 7475 726e 2066 277b  :.    return f'{
+0000d750: 534e 4150 5348 4f54 5f53 5452 4541 4d5f  SNAPSHOT_STREAM_
+0000d760: 4e41 4d45 5f50 5245 4649 587d 7b73 7472  NAME_PREFIX}{str
+0000d770: 6561 6d5f 6e61 6d65 7d27 0a0a 0a64 6566  eam_name}'...def
+0000d780: 2072 656d 6f76 655f 736e 6170 7368 6f74   remove_snapshot
+0000d790: 5f73 7472 6561 6d5f 7072 6566 6978 2873  _stream_prefix(s
+0000d7a0: 6e61 7073 686f 745f 7374 7265 616d 5f6e  napshot_stream_n
+0000d7b0: 616d 6529 3a0a 2020 2020 6173 7365 7274  ame):.    assert
+0000d7c0: 2073 6e61 7073 686f 745f 7374 7265 616d   snapshot_stream
+0000d7d0: 5f6e 616d 652e 7374 6172 7473 7769 7468  _name.startswith
+0000d7e0: 2853 4e41 5053 484f 545f 5354 5245 414d  (SNAPSHOT_STREAM
+0000d7f0: 5f4e 414d 455f 5052 4546 4958 290a 2020  _NAME_PREFIX).  
+0000d800: 2020 7265 7475 726e 2073 6e61 7073 686f    return snapsho
+0000d810: 745f 7374 7265 616d 5f6e 616d 655b 6c65  t_stream_name[le
+0000d820: 6e28 534e 4150 5348 4f54 5f53 5452 4541  n(SNAPSHOT_STREA
+0000d830: 4d5f 4e41 4d45 5f50 5245 4649 5829 3a5d  M_NAME_PREFIX):]
+0000d840: 0a60 6060 0a0a 4e6f 772c 206c 6574 2773  .```..Now, let's
+0000d850: 2072 6564 6566 696e 6520 7468 6520 6067   redefine the `g
+0000d860: 6574 5f61 6767 7265 6761 7465 2829 6020  et_aggregate()` 
+0000d870: 6675 6e63 7469 6f6e 2c20 736f 2074 6861  function, so tha
+0000d880: 7420 6974 206c 6f6f 6b73 2066 6f72 2061  t it looks for a
+0000d890: 2073 6e61 7073 686f 7420 6576 656e 742c   snapshot event,
+0000d8a0: 0a74 6865 6e20 7365 6c65 6374 7320 7375  .then selects su
+0000d8b0: 6273 6571 7565 6e74 2061 6767 7265 6761  bsequent aggrega
+0000d8c0: 7465 2065 7665 6e74 732c 2061 6e64 2074  te events, and t
+0000d8d0: 6865 6e20 6361 6c6c 7320 6120 6d75 7461  hen calls a muta
+0000d8e0: 746f 7220 6675 6e63 7469 6f6e 2066 6f72  tor function for
+0000d8f0: 2065 6163 680a 7265 636f 7264 6564 2065   each.recorded e
+0000d900: 7665 6e74 2e0a 0a4e 6f74 6963 6520 7468  vent...Notice th
+0000d910: 6174 2074 6865 2061 6767 7265 6761 7465  at the aggregate
+0000d920: 2065 7665 6e74 7320 6172 6520 7265 6164   events are read
+0000d930: 2066 726f 6d20 6120 7374 7265 616d 2066   from a stream f
+0000d940: 6f72 2073 6572 6961 6c69 7a65 6420 6167  or serialized ag
+0000d950: 6772 6567 6174 650a 6576 656e 7473 2c20  gregate.events, 
+0000d960: 7768 696c 7374 2074 6865 2073 6e61 7073  whilst the snaps
+0000d970: 686f 7420 6973 2072 6561 6420 6672 6f6d  hot is read from
+0000d980: 2061 2073 6570 6172 6174 6520 7374 7265   a separate stre
+0000d990: 616d 2066 6f72 2073 6572 6961 6c69 7a65  am for serialize
+0000d9a0: 6420 6167 6772 6567 6174 650a 736e 6170  d aggregate.snap
+0000d9b0: 7368 6f74 732e 2057 6520 7769 6c6c 2075  shots. We will u
+0000d9c0: 7365 204a 534f 4e20 746f 2073 6572 6961  se JSON to seria
+0000d9d0: 6c69 7a65 2061 6e64 2064 6573 6572 6961  lize and deseria
+0000d9e0: 6c69 7a65 2065 7665 6e74 2064 6174 612e  lize event data.
+0000d9f0: 0a0a 0a60 6060 7079 7468 6f6e 0a69 6d70  ...```python.imp
+0000da00: 6f72 7420 6a73 6f6e 0a0a 0a64 6566 2067  ort json...def g
+0000da10: 6574 5f61 6767 7265 6761 7465 2861 6767  et_aggregate(agg
+0000da20: 7265 6761 7465 5f69 642c 206d 7574 6174  regate_id, mutat
+0000da30: 6f72 5f66 756e 6329 3a0a 2020 2020 7374  or_func):.    st
+0000da40: 7265 616d 5f6e 616d 6520 3d20 6167 6772  ream_name = aggr
+0000da50: 6567 6174 655f 6964 0a20 2020 2072 6563  egate_id.    rec
+0000da60: 6f72 6465 645f 6576 656e 7473 203d 205b  orded_events = [
+0000da70: 5d0a 0a20 2020 2023 204c 6f6f 6b20 666f  ]..    # Look fo
+0000da80: 7220 6120 736e 6170 7368 6f74 2e0a 2020  r a snapshot..  
+0000da90: 2020 7472 793a 0a20 2020 2020 2020 2073    try:.        s
+0000daa0: 6e61 7073 686f 7473 203d 2063 6c69 656e  napshots = clien
+0000dab0: 742e 6765 745f 7374 7265 616d 280a 2020  t.get_stream(.  
+0000dac0: 2020 2020 2020 2020 2020 7374 7265 616d            stream
+0000dad0: 5f6e 616d 653d 6d61 6b65 5f73 6e61 7073  _name=make_snaps
+0000dae0: 686f 745f 7374 7265 616d 5f6e 616d 6528  hot_stream_name(
+0000daf0: 7374 7265 616d 5f6e 616d 6529 2c0a 2020  stream_name),.  
+0000db00: 2020 2020 2020 2020 2020 6261 636b 7761            backwa
+0000db10: 7264 733d 5472 7565 2c0a 2020 2020 2020  rds=True,.      
+0000db20: 2020 2020 2020 6c69 6d69 743d 310a 2020        limit=1.  
+0000db30: 2020 2020 2020 290a 2020 2020 6578 6365        ).    exce
+0000db40: 7074 204e 6f74 466f 756e 643a 0a20 2020  pt NotFound:.   
+0000db50: 2020 2020 2073 7472 6561 6d5f 706f 7369       stream_posi
+0000db60: 7469 6f6e 203d 204e 6f6e 650a 2020 2020  tion = None.    
+0000db70: 656c 7365 3a0a 2020 2020 2020 2020 6173  else:.        as
+0000db80: 7365 7274 206c 656e 2873 6e61 7073 686f  sert len(snapsho
+0000db90: 7473 2920 3d3d 2031 0a20 2020 2020 2020  ts) == 1.       
+0000dba0: 2073 6e61 7073 686f 7420 3d20 736e 6170   snapshot = snap
+0000dbb0: 7368 6f74 735b 305d 0a20 2020 2020 2020  shots[0].       
+0000dbc0: 2073 7472 6561 6d5f 706f 7369 7469 6f6e   stream_position
+0000dbd0: 203d 2064 6573 6572 6961 6c69 7a65 2873   = deserialize(s
+0000dbe0: 6e61 7073 686f 742e 6d65 7461 6461 7461  napshot.metadata
+0000dbf0: 295b 2776 6572 7369 6f6e 275d 202b 2031  )['version'] + 1
+0000dc00: 0a20 2020 2020 2020 2072 6563 6f72 6465  .        recorde
+0000dc10: 645f 6576 656e 7473 2e61 7070 656e 6428  d_events.append(
+0000dc20: 736e 6170 7368 6f74 290a 0a20 2020 2023  snapshot)..    #
+0000dc30: 2047 6574 2073 7562 7365 7175 656e 7420   Get subsequent 
+0000dc40: 6576 656e 7473 2e0a 2020 2020 7472 793a  events..    try:
+0000dc50: 0a20 2020 2020 2020 2065 7665 6e74 7320  .        events 
+0000dc60: 3d20 636c 6965 6e74 2e67 6574 5f73 7472  = client.get_str
+0000dc70: 6561 6d28 0a20 2020 2020 2020 2020 2020  eam(.           
+0000dc80: 2073 7472 6561 6d5f 6e61 6d65 3d73 7472   stream_name=str
+0000dc90: 6561 6d5f 6e61 6d65 2c0a 2020 2020 2020  eam_name,.      
+0000dca0: 2020 2020 2020 7374 7265 616d 5f70 6f73        stream_pos
+0000dcb0: 6974 696f 6e3d 7374 7265 616d 5f70 6f73  ition=stream_pos
+0000dcc0: 6974 696f 6e0a 2020 2020 2020 2020 290a  ition.        ).
+0000dcd0: 2020 2020 6578 6365 7074 204e 6f74 466f      except NotFo
+0000dce0: 756e 6420 6173 2065 3a0a 2020 2020 2020  und as e:.      
+0000dcf0: 2020 7261 6973 6520 4167 6772 6567 6174    raise Aggregat
+0000dd00: 654e 6f74 466f 756e 6428 6167 6772 6567  eNotFound(aggreg
+0000dd10: 6174 655f 6964 2920 6672 6f6d 2065 0a20  ate_id) from e. 
+0000dd20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000dd30: 2072 6563 6f72 6465 645f 6576 656e 7473   recorded_events
+0000dd40: 202b 3d20 6576 656e 7473 0a0a 2020 2020   += events..    
+0000dd50: 2320 5265 636f 6e73 7472 7563 7420 6167  # Reconstruct ag
+0000dd60: 6772 6567 6174 6520 6672 6f6d 2072 6563  gregate from rec
+0000dd70: 6f72 6465 6420 6576 656e 7473 2e0a 2020  orded events..  
+0000dd80: 2020 6167 6772 6567 6174 6520 3d20 4e6f    aggregate = No
+0000dd90: 6e65 0a20 2020 2066 6f72 2065 7665 6e74  ne.    for event
+0000dda0: 2069 6e20 7265 636f 7264 6564 5f65 7665   in recorded_eve
+0000ddb0: 6e74 733a 0a20 2020 2020 2020 2061 6767  nts:.        agg
+0000ddc0: 7265 6761 7465 203d 206d 7574 6174 6f72  regate = mutator
+0000ddd0: 5f66 756e 6328 6167 6772 6567 6174 652c  _func(aggregate,
+0000dde0: 2065 7665 6e74 290a 0a20 2020 2072 6574   event)..    ret
+0000ddf0: 7572 6e20 6167 6772 6567 6174 650a 0a0a  urn aggregate...
+0000de00: 6465 6620 7365 7269 616c 697a 6528 6429  def serialize(d)
+0000de10: 3a0a 2020 2020 7265 7475 726e 206a 736f  :.    return jso
+0000de20: 6e2e 6475 6d70 7328 6429 2e65 6e63 6f64  n.dumps(d).encod
+0000de30: 6528 2775 7466 3827 290a 0a0a 6465 6620  e('utf8')...def 
+0000de40: 6465 7365 7269 616c 697a 6528 7329 3a0a  deserialize(s):.
+0000de50: 2020 2020 7265 7475 726e 206a 736f 6e2e      return json.
+0000de60: 6c6f 6164 7328 732e 6465 636f 6465 2827  loads(s.decode('
+0000de70: 7574 6638 2729 290a 6060 600a 0a54 6f20  utf8')).```..To 
+0000de80: 7368 6f77 2068 6f77 2060 6765 745f 6167  show how `get_ag
+0000de90: 6772 6567 6174 6528 2960 2063 616e 2062  gregate()` can b
+0000dea0: 6520 7573 6564 2c20 6c65 7427 7320 6465  e used, let's de
+0000deb0: 6669 6e65 2061 2060 446f 6760 2061 6767  fine a `Dog` agg
+0000dec0: 7265 6761 7465 2063 6c61 7373 2c20 7769  regate class, wi
+0000ded0: 7468 0a61 7474 7269 6275 7465 7320 606e  th.attributes `n
+0000dee0: 616d 6560 2061 6e64 2060 7472 6963 6b73  ame` and `tricks
+0000def0: 602e 2054 6865 2061 7474 7269 6275 7465  `. The attribute
+0000df00: 7320 6069 6460 2061 6e64 2060 7665 7273  s `id` and `vers
+0000df10: 696f 6e60 2077 696c 6c20 696e 6469 6361  ion` will indica
+0000df20: 7465 2061 6e0a 6167 6772 6567 6174 6520  te an.aggregate 
+0000df30: 6f62 6a65 6374 2773 2049 4420 616e 6420  object's ID and 
+0000df40: 7665 7273 696f 6e20 6e75 6d62 6572 2e20  version number. 
+0000df50: 5468 6520 6174 7472 6962 7574 6520 6069  The attribute `i
+0000df60: 735f 6672 6f6d 5f73 6e61 7073 686f 7460  s_from_snapshot`
+0000df70: 2069 7320 6164 6465 640a 6865 7265 206d   is added.here m
+0000df80: 6572 656c 7920 746f 2064 656d 6f6e 7374  erely to demonst
+0000df90: 7261 7465 2062 656c 6f77 2077 6865 6e20  rate below when 
+0000dfa0: 616e 2061 6767 7265 6761 7465 206f 626a  an aggregate obj
+0000dfb0: 6563 7420 6861 7320 6265 656e 2072 6563  ect has been rec
+0000dfc0: 6f6e 7374 7275 6374 6564 2075 7369 6e67  onstructed using
+0000dfd0: 0a61 2073 6e61 7073 686f 742e 0a0a 6060  .a snapshot...``
+0000dfe0: 6070 7974 686f 6e0a 6672 6f6d 2064 6174  `python.from dat
+0000dff0: 6163 6c61 7373 6573 2069 6d70 6f72 7420  aclasses import 
+0000e000: 6461 7461 636c 6173 730a 0a0a 4064 6174  dataclass...@dat
+0000e010: 6163 6c61 7373 2866 726f 7a65 6e3d 5472  aclass(frozen=Tr
+0000e020: 7565 290a 636c 6173 7320 4167 6772 6567  ue).class Aggreg
+0000e030: 6174 653a 0a20 2020 2069 643a 2073 7472  ate:.    id: str
+0000e040: 0a20 2020 2076 6572 7369 6f6e 3a20 696e  .    version: in
+0000e050: 740a 2020 2020 6973 5f66 726f 6d5f 736e  t.    is_from_sn
+0000e060: 6170 7368 6f74 3a20 626f 6f6c 0a0a 0a40  apshot: bool...@
+0000e070: 6461 7461 636c 6173 7328 6672 6f7a 656e  dataclass(frozen
+0000e080: 3d54 7275 6529 0a63 6c61 7373 2044 6f67  =True).class Dog
+0000e090: 2841 6767 7265 6761 7465 293a 0a20 2020  (Aggregate):.   
+0000e0a0: 206e 616d 653a 2073 7472 0a20 2020 2074   name: str.    t
+0000e0b0: 7269 636b 733a 206c 6973 740a 6060 600a  ricks: list.```.
+0000e0c0: 0a4c 6574 2773 2061 6c73 6f20 6465 6669  .Let's also defi
+0000e0d0: 6e65 2061 206d 7574 6174 6f72 2066 756e  ne a mutator fun
+0000e0e0: 6374 696f 6e20 606d 7574 6174 655f 646f  ction `mutate_do
+0000e0f0: 6728 2960 2074 6861 7420 6576 6f6c 7665  g()` that evolve
+0000e100: 7320 7468 6520 7374 6174 6520 6f66 2061  s the state of a
+0000e110: 0a60 446f 6760 2061 6767 7265 6761 7465  .`Dog` aggregate
+0000e120: 2067 6976 656e 2076 6172 696f 7573 2064   given various d
+0000e130: 6966 6665 7265 6e74 2074 7970 6573 206f  ifferent types o
+0000e140: 6620 6576 656e 7473 2c20 6027 446f 6752  f events, `'DogR
+0000e150: 6567 6973 7465 7265 6427 602c 0a60 2744  egistered'`,.`'D
+0000e160: 6f67 4c65 6172 6e65 6454 7269 636b 2760  ogLearnedTrick'`
+0000e170: 2c20 616e 6420 6027 536e 6170 7368 6f74  , and `'Snapshot
+0000e180: 2760 2e0a 0a60 6060 7079 7468 6f6e 0a64  '`...```python.d
+0000e190: 6566 206d 7574 6174 655f 646f 6728 646f  ef mutate_dog(do
+0000e1a0: 672c 2065 7665 6e74 293a 0a20 2020 2064  g, event):.    d
+0000e1b0: 6174 6120 3d20 6465 7365 7269 616c 697a  ata = deserializ
+0000e1c0: 6528 6576 656e 742e 6461 7461 290a 2020  e(event.data).  
+0000e1d0: 2020 6966 2065 7665 6e74 2e74 7970 6520    if event.type 
+0000e1e0: 3d3d 2027 446f 6752 6567 6973 7465 7265  == 'DogRegistere
+0000e1f0: 6427 3a0a 2020 2020 2020 2020 7265 7475  d':.        retu
+0000e200: 726e 2044 6f67 280a 2020 2020 2020 2020  rn Dog(.        
+0000e210: 2020 2020 6964 3d65 7665 6e74 2e73 7472      id=event.str
+0000e220: 6561 6d5f 6e61 6d65 2c0a 2020 2020 2020  eam_name,.      
+0000e230: 2020 2020 2020 7665 7273 696f 6e3d 6576        version=ev
+0000e240: 656e 742e 7374 7265 616d 5f70 6f73 6974  ent.stream_posit
+0000e250: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0000e260: 2069 735f 6672 6f6d 5f73 6e61 7073 686f   is_from_snapsho
+0000e270: 743d 4661 6c73 652c 0a20 2020 2020 2020  t=False,.       
+0000e280: 2020 2020 206e 616d 653d 6461 7461 5b27       name=data['
+0000e290: 6e61 6d65 275d 2c0a 2020 2020 2020 2020  name'],.        
+0000e2a0: 2020 2020 7472 6963 6b73 3d5b 5d2c 0a20      tricks=[],. 
+0000e2b0: 2020 2020 2020 2029 0a20 2020 2065 6c69         ).    eli
+0000e2c0: 6620 6576 656e 742e 7479 7065 203d 3d20  f event.type == 
+0000e2d0: 2744 6f67 4c65 6172 6e65 6454 7269 636b  'DogLearnedTrick
+0000e2e0: 273a 0a20 2020 2020 2020 2061 7373 6572  ':.        asser
+0000e2f0: 7420 6576 656e 742e 7374 7265 616d 5f70  t event.stream_p
+0000e300: 6f73 6974 696f 6e20 3d3d 2064 6f67 2e76  osition == dog.v
+0000e310: 6572 7369 6f6e 202b 2031 0a20 2020 2020  ersion + 1.     
+0000e320: 2020 2061 7373 6572 7420 6576 656e 742e     assert event.
+0000e330: 7374 7265 616d 5f6e 616d 6520 3d3d 2064  stream_name == d
+0000e340: 6f67 2e69 642c 2028 6576 656e 742e 7374  og.id, (event.st
+0000e350: 7265 616d 5f6e 616d 652c 2064 6f67 2e69  ream_name, dog.i
+0000e360: 6429 0a20 2020 2020 2020 2072 6574 7572  d).        retur
+0000e370: 6e20 446f 6728 0a20 2020 2020 2020 2020  n Dog(.         
+0000e380: 2020 2069 643d 646f 672e 6964 2c0a 2020     id=dog.id,.  
+0000e390: 2020 2020 2020 2020 2020 7665 7273 696f            versio
+0000e3a0: 6e3d 6576 656e 742e 7374 7265 616d 5f70  n=event.stream_p
+0000e3b0: 6f73 6974 696f 6e2c 0a20 2020 2020 2020  osition,.       
+0000e3c0: 2020 2020 2069 735f 6672 6f6d 5f73 6e61       is_from_sna
+0000e3d0: 7073 686f 743d 646f 672e 6973 5f66 726f  pshot=dog.is_fro
+0000e3e0: 6d5f 736e 6170 7368 6f74 2c0a 2020 2020  m_snapshot,.    
+0000e3f0: 2020 2020 2020 2020 6e61 6d65 3d64 6f67          name=dog
+0000e400: 2e6e 616d 652c 0a20 2020 2020 2020 2020  .name,.         
+0000e410: 2020 2074 7269 636b 733d 646f 672e 7472     tricks=dog.tr
+0000e420: 6963 6b73 202b 205b 6461 7461 5b27 7472  icks + [data['tr
+0000e430: 6963 6b27 5d5d 2c0a 2020 2020 2020 2020  ick']],.        
+0000e440: 290a 2020 2020 656c 6966 2065 7665 6e74  ).    elif event
+0000e450: 2e74 7970 6520 3d3d 2027 536e 6170 7368  .type == 'Snapsh
+0000e460: 6f74 273a 0a20 2020 2020 2020 2072 6574  ot':.        ret
+0000e470: 7572 6e20 446f 6728 0a20 2020 2020 2020  urn Dog(.       
+0000e480: 2020 2020 2069 643d 7265 6d6f 7665 5f73       id=remove_s
+0000e490: 6e61 7073 686f 745f 7374 7265 616d 5f70  napshot_stream_p
+0000e4a0: 7265 6669 7828 6576 656e 742e 7374 7265  refix(event.stre
+0000e4b0: 616d 5f6e 616d 6529 2c0a 2020 2020 2020  am_name),.      
+0000e4c0: 2020 2020 2020 7665 7273 696f 6e3d 6465        version=de
+0000e4d0: 7365 7269 616c 697a 6528 6576 656e 742e  serialize(event.
+0000e4e0: 6d65 7461 6461 7461 295b 2776 6572 7369  metadata)['versi
+0000e4f0: 6f6e 275d 2c0a 2020 2020 2020 2020 2020  on'],.          
+0000e500: 2020 6973 5f66 726f 6d5f 736e 6170 7368    is_from_snapsh
+0000e510: 6f74 3d54 7275 652c 0a20 2020 2020 2020  ot=True,.       
+0000e520: 2020 2020 206e 616d 653d 6461 7461 5b27       name=data['
+0000e530: 6e61 6d65 275d 2c0a 2020 2020 2020 2020  name'],.        
+0000e540: 2020 2020 7472 6963 6b73 3d64 6174 615b      tricks=data[
+0000e550: 2774 7269 636b 7327 5d2c 0a20 2020 2020  'tricks'],.     
+0000e560: 2020 2029 0a20 2020 2065 6c73 653a 0a20     ).    else:. 
+0000e570: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+0000e580: 6570 7469 6f6e 2866 2255 6e6b 6e6f 776e  eption(f"Unknown
+0000e590: 2065 7665 6e74 2074 7970 653a 207b 6576   event type: {ev
+0000e5a0: 656e 742e 7479 7065 7d22 290a 6060 600a  ent.type}").```.
+0000e5b0: 0a46 6f72 2063 6f6e 7665 6e69 656e 6365  .For convenience
+0000e5c0: 2c20 6c65 7427 7320 616c 736f 2064 6566  , let's also def
+0000e5d0: 696e 6520 6120 6067 6574 5f64 6f67 2829  ine a `get_dog()
+0000e5e0: 6020 6675 6e63 7469 6f6e 2074 6861 7420  ` function that 
+0000e5f0: 6361 6c6c 7320 6067 6574 5f61 6767 7265  calls `get_aggre
+0000e600: 6761 7465 2829 600a 7769 7468 2074 6865  gate()`.with the
+0000e610: 2060 6d75 7461 7465 5f64 6f67 2829 6020   `mutate_dog()` 
+0000e620: 6675 6e63 7469 6f6e 2061 7320 7468 6520  function as the 
+0000e630: 7661 6c75 6520 6f66 2069 7473 2060 6d75  value of its `mu
+0000e640: 7461 746f 725f 6675 6e63 6020 6172 6775  tator_func` argu
+0000e650: 6d65 6e74 2e0a 0a60 6060 7079 7468 6f6e  ment...```python
+0000e660: 0a64 6566 2067 6574 5f64 6f67 2864 6f67  .def get_dog(dog
+0000e670: 5f69 6429 3a0a 2020 2020 7265 7475 726e  _id):.    return
+0000e680: 2067 6574 5f61 6767 7265 6761 7465 280a   get_aggregate(.
+0000e690: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0000e6a0: 655f 6964 3d64 6f67 5f69 642c 0a20 2020  e_id=dog_id,.   
+0000e6b0: 2020 2020 206d 7574 6174 6f72 5f66 756e       mutator_fun
+0000e6c0: 633d 6d75 7461 7465 5f64 6f67 2c0a 2020  c=mutate_dog,.  
+0000e6d0: 2020 290a 6060 600a 0a57 6520 6361 6e20    ).```..We can 
+0000e6e0: 616c 736f 2064 6566 696e 6520 736f 6d65  also define some
+0000e6f0: 2022 636f 6d6d 616e 6422 2066 756e 6374   "command" funct
+0000e700: 696f 6e73 2074 6861 7420 6170 7065 6e64  ions that append
+0000e710: 206e 6577 2065 7665 6e74 7320 746f 2074   new events to t
+0000e720: 6865 0a64 6174 6162 6173 652e 2054 6865  he.database. The
+0000e730: 2060 7265 6769 7374 6572 5f64 6f67 2829   `register_dog()
+0000e740: 6020 6675 6e63 7469 6f6e 2061 7070 656e  ` function appen
+0000e750: 6473 2061 2060 446f 6752 6567 6973 7465  ds a `DogRegiste
+0000e760: 7265 6460 2065 7665 6e74 2e20 5468 650a  red` event. The.
+0000e770: 6072 6563 6f72 645f 7472 6963 6b5f 6c65  `record_trick_le
+0000e780: 6172 6e65 6428 2960 2061 7070 656e 6473  arned()` appends
+0000e790: 2061 2060 446f 674c 6561 726e 6564 5472   a `DogLearnedTr
+0000e7a0: 6963 6b60 2065 7665 6e74 2e20 5468 6520  ick` event. The 
+0000e7b0: 6675 6e63 7469 6f6e 0a60 736e 6170 7368  function.`snapsh
+0000e7c0: 6f74 5f64 6f67 2829 6020 6170 7065 6e64  ot_dog()` append
+0000e7d0: 7320 6120 6053 6e61 7073 686f 7460 2065  s a `Snapshot` e
+0000e7e0: 7665 6e74 2e20 4e6f 7469 6365 2074 6861  vent. Notice tha
+0000e7f0: 7420 7468 650a 6072 6563 6f72 645f 7472  t the.`record_tr
+0000e800: 6963 6b5f 6c65 6172 6e65 6428 2960 2061  ick_learned()` a
+0000e810: 6e64 2060 736e 6170 7368 6f74 5f64 6f67  nd `snapshot_dog
+0000e820: 2829 6020 6675 6e63 7469 6f6e 7320 7573  ()` functions us
+0000e830: 6520 6067 6574 5f64 6f67 2829 602e 0a0a  e `get_dog()`...
+0000e840: 4e6f 7469 6365 2061 6c73 6f20 7468 6174  Notice also that
+0000e850: 2074 6865 2060 446f 6752 6567 6973 7465   the `DogRegiste
+0000e860: 7265 6460 2061 6e64 2060 446f 674c 6561  red` and `DogLea
+0000e870: 726e 6564 5472 6963 6b60 2065 7665 6e74  rnedTrick` event
+0000e880: 7320 6172 6520 6170 7065 6e64 6564 2074  s are appended t
+0000e890: 6f20 610a 7374 7265 616d 2066 6f72 2061  o a.stream for a
+0000e8a0: 6767 7265 6761 7465 2065 7665 6e74 732c  ggregate events,
+0000e8b0: 2077 6869 6c73 7420 7468 6520 6053 6e61   whilst the `Sna
+0000e8c0: 7073 686f 7460 2065 7665 6e74 2069 7320  pshot` event is 
+0000e8d0: 6170 7065 6e64 6564 2074 6f20 6120 7365  appended to a se
+0000e8e0: 7061 7261 7465 0a73 7472 6561 6d20 666f  parate.stream fo
+0000e8f0: 7220 6167 6772 6567 6174 6520 736e 6170  r aggregate snap
+0000e900: 7368 6f74 732e 0a0a 6060 6070 7974 686f  shots...```pytho
+0000e910: 6e0a 6465 6620 7265 6769 7374 6572 5f64  n.def register_d
+0000e920: 6f67 286e 616d 6529 3a0a 2020 2020 646f  og(name):.    do
+0000e930: 675f 6964 203d 2073 7472 2875 7569 642e  g_id = str(uuid.
+0000e940: 7575 6964 3428 2929 0a20 2020 2065 7665  uuid4()).    eve
+0000e950: 6e74 203d 204e 6577 4576 656e 7428 0a20  nt = NewEvent(. 
+0000e960: 2020 2020 2020 2074 7970 653d 2744 6f67         type='Dog
+0000e970: 5265 6769 7374 6572 6564 272c 0a20 2020  Registered',.   
+0000e980: 2020 2020 2064 6174 613d 7365 7269 616c       data=serial
+0000e990: 697a 6528 7b27 6e61 6d65 273a 206e 616d  ize({'name': nam
+0000e9a0: 657d 292c 0a20 2020 2029 0a20 2020 2063  e}),.    ).    c
+0000e9b0: 6c69 656e 742e 6170 7065 6e64 5f74 6f5f  lient.append_to_
+0000e9c0: 7374 7265 616d 280a 2020 2020 2020 2020  stream(.        
+0000e9d0: 7374 7265 616d 5f6e 616d 653d 646f 675f  stream_name=dog_
+0000e9e0: 6964 2c0a 2020 2020 2020 2020 6375 7272  id,.        curr
+0000e9f0: 656e 745f 7665 7273 696f 6e3d 5374 7265  ent_version=Stre
+0000ea00: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
+0000ea10: 4d2c 0a20 2020 2020 2020 2065 7665 6e74  M,.        event
+0000ea20: 733d 6576 656e 742c 0a20 2020 2029 0a20  s=event,.    ). 
+0000ea30: 2020 2072 6574 7572 6e20 646f 675f 6964     return dog_id
+0000ea40: 0a0a 0a64 6566 2072 6563 6f72 645f 7472  ...def record_tr
+0000ea50: 6963 6b5f 6c65 6172 6e65 6428 646f 675f  ick_learned(dog_
+0000ea60: 6964 2c20 7472 6963 6b29 3a0a 2020 2020  id, trick):.    
+0000ea70: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+0000ea80: 675f 6964 290a 2020 2020 6576 656e 7420  g_id).    event 
+0000ea90: 3d20 4e65 7745 7665 6e74 280a 2020 2020  = NewEvent(.    
+0000eaa0: 2020 2020 7479 7065 3d27 446f 674c 6561      type='DogLea
+0000eab0: 726e 6564 5472 6963 6b27 2c0a 2020 2020  rnedTrick',.    
+0000eac0: 2020 2020 6461 7461 3d73 6572 6961 6c69      data=seriali
+0000ead0: 7a65 287b 2774 7269 636b 273a 2074 7269  ze({'trick': tri
+0000eae0: 636b 7d29 2c0a 2020 2020 290a 2020 2020  ck}),.    ).    
+0000eaf0: 636c 6965 6e74 2e61 7070 656e 645f 746f  client.append_to
+0000eb00: 5f73 7472 6561 6d28 0a20 2020 2020 2020  _stream(.       
+0000eb10: 2073 7472 6561 6d5f 6e61 6d65 3d64 6f67   stream_name=dog
+0000eb20: 5f69 642c 0a20 2020 2020 2020 2063 7572  _id,.        cur
+0000eb30: 7265 6e74 5f76 6572 7369 6f6e 3d64 6f67  rent_version=dog
+0000eb40: 2e76 6572 7369 6f6e 2c0a 2020 2020 2020  .version,.      
+0000eb50: 2020 6576 656e 7473 3d65 7665 6e74 2c0a    events=event,.
+0000eb60: 2020 2020 290a 0a0a 6465 6620 736e 6170      )...def snap
+0000eb70: 7368 6f74 5f64 6f67 2864 6f67 5f69 6429  shot_dog(dog_id)
+0000eb80: 3a0a 2020 2020 646f 6720 3d20 6765 745f  :.    dog = get_
+0000eb90: 646f 6728 646f 675f 6964 290a 2020 2020  dog(dog_id).    
+0000eba0: 6576 656e 7420 3d20 4e65 7745 7665 6e74  event = NewEvent
+0000ebb0: 280a 2020 2020 2020 2020 7479 7065 3d27  (.        type='
+0000ebc0: 536e 6170 7368 6f74 272c 0a20 2020 2020  Snapshot',.     
+0000ebd0: 2020 2064 6174 613d 7365 7269 616c 697a     data=serializ
+0000ebe0: 6528 7b27 6e61 6d65 273a 2064 6f67 2e6e  e({'name': dog.n
+0000ebf0: 616d 652c 2027 7472 6963 6b73 273a 2064  ame, 'tricks': d
+0000ec00: 6f67 2e74 7269 636b 737d 292c 0a20 2020  og.tricks}),.   
+0000ec10: 2020 2020 206d 6574 6164 6174 613d 7365       metadata=se
+0000ec20: 7269 616c 697a 6528 7b27 7665 7273 696f  rialize({'versio
+0000ec30: 6e27 3a20 646f 672e 7665 7273 696f 6e7d  n': dog.version}
+0000ec40: 292c 0a20 2020 2029 0a20 2020 2063 6c69  ),.    ).    cli
+0000ec50: 656e 742e 6170 7065 6e64 5f74 6f5f 7374  ent.append_to_st
+0000ec60: 7265 616d 280a 2020 2020 2020 2020 7374  ream(.        st
+0000ec70: 7265 616d 5f6e 616d 653d 6d61 6b65 5f73  ream_name=make_s
+0000ec80: 6e61 7073 686f 745f 7374 7265 616d 5f6e  napshot_stream_n
+0000ec90: 616d 6528 646f 675f 6964 292c 0a20 2020  ame(dog_id),.   
+0000eca0: 2020 2020 2063 7572 7265 6e74 5f76 6572       current_ver
+0000ecb0: 7369 6f6e 3d53 7472 6561 6d53 7461 7465  sion=StreamState
+0000ecc0: 2e41 4e59 2c0a 2020 2020 2020 2020 6576  .ANY,.        ev
+0000ecd0: 656e 7473 3d65 7665 6e74 2c0a 2020 2020  ents=event,.    
+0000ece0: 290a 6060 600a 0a57 6520 6361 6e20 6361  ).```..We can ca
+0000ecf0: 6c6c 2060 7265 6769 7374 6572 5f64 6f67  ll `register_dog
+0000ed00: 2829 6020 746f 2072 6567 6973 7465 7220  ()` to register 
+0000ed10: 6120 6e65 7720 646f 672e 0a0a 6060 6070  a new dog...```p
+0000ed20: 7974 686f 6e0a 2320 5265 6769 7374 6572  ython.# Register
+0000ed30: 2061 206e 6577 2064 6f67 2e0a 646f 675f   a new dog..dog_
+0000ed40: 6964 203d 2072 6567 6973 7465 725f 646f  id = register_do
+0000ed50: 6728 2746 6964 6f27 290a 0a64 6f67 203d  g('Fido')..dog =
+0000ed60: 2067 6574 5f64 6f67 2864 6f67 5f69 6429   get_dog(dog_id)
+0000ed70: 0a61 7373 6572 7420 646f 672e 6e61 6d65  .assert dog.name
+0000ed80: 203d 3d20 2746 6964 6f27 0a61 7373 6572   == 'Fido'.asser
+0000ed90: 7420 646f 672e 7472 6963 6b73 203d 3d20  t dog.tricks == 
+0000eda0: 5b5d 0a61 7373 6572 7420 646f 672e 7665  [].assert dog.ve
+0000edb0: 7273 696f 6e20 3d3d 2030 0a61 7373 6572  rsion == 0.asser
+0000edc0: 7420 646f 672e 6973 5f66 726f 6d5f 736e  t dog.is_from_sn
+0000edd0: 6170 7368 6f74 2069 7320 4661 6c73 650a  apshot is False.
+0000ede0: 0a60 6060 0a0a 5765 2063 616e 2063 616c  .```..We can cal
+0000edf0: 6c20 6072 6563 6f72 645f 7472 6963 6b5f  l `record_trick_
+0000ee00: 6c65 6172 6e65 6428 2960 2074 6f20 7265  learned()` to re
+0000ee10: 636f 7264 2074 6861 7420 736f 6d65 2074  cord that some t
+0000ee20: 7269 636b 7320 6861 7665 2062 6565 6e20  ricks have been 
+0000ee30: 6c65 6172 6e65 642e 0a0a 6060 6070 7974  learned...```pyt
+0000ee40: 686f 6e0a 0a23 2052 6563 6f72 6420 7468  hon..# Record th
+0000ee50: 6174 2027 4669 646f 2720 6c65 6172 6e65  at 'Fido' learne
+0000ee60: 6420 6120 6e65 7720 7472 6963 6b2e 0a72  d a new trick..r
+0000ee70: 6563 6f72 645f 7472 6963 6b5f 6c65 6172  ecord_trick_lear
+0000ee80: 6e65 6428 646f 675f 6964 2c20 7472 6963  ned(dog_id, tric
+0000ee90: 6b3d 2772 6f6c 6c20 6f76 6572 2729 0a0a  k='roll over')..
+0000eea0: 646f 6720 3d20 6765 745f 646f 6728 646f  dog = get_dog(do
+0000eeb0: 675f 6964 290a 6173 7365 7274 2064 6f67  g_id).assert dog
+0000eec0: 2e6e 616d 6520 3d3d 2027 4669 646f 270a  .name == 'Fido'.
+0000eed0: 6173 7365 7274 2064 6f67 2e74 7269 636b  assert dog.trick
+0000eee0: 7320 3d3d 205b 2772 6f6c 6c20 6f76 6572  s == ['roll over
+0000eef0: 275d 0a61 7373 6572 7420 646f 672e 7665  '].assert dog.ve
+0000ef00: 7273 696f 6e20 3d3d 2031 0a61 7373 6572  rsion == 1.asser
+0000ef10: 7420 646f 672e 6973 5f66 726f 6d5f 736e  t dog.is_from_sn
+0000ef20: 6170 7368 6f74 2069 7320 4661 6c73 650a  apshot is False.
+0000ef30: 0a0a 2320 5265 636f 7264 2074 6861 7420  ..# Record that 
+0000ef40: 2746 6964 6f27 206c 6561 726e 6564 2061  'Fido' learned a
+0000ef50: 6e6f 7468 6572 206e 6577 2074 7269 636b  nother new trick
+0000ef60: 2e0a 7265 636f 7264 5f74 7269 636b 5f6c  ..record_trick_l
+0000ef70: 6561 726e 6564 2864 6f67 5f69 642c 2074  earned(dog_id, t
+0000ef80: 7269 636b 3d27 6665 7463 6820 6261 6c6c  rick='fetch ball
+0000ef90: 2729 0a0a 646f 6720 3d20 6765 745f 646f  ')..dog = get_do
+0000efa0: 6728 646f 675f 6964 290a 6173 7365 7274  g(dog_id).assert
+0000efb0: 2064 6f67 2e6e 616d 6520 3d3d 2027 4669   dog.name == 'Fi
+0000efc0: 646f 270a 6173 7365 7274 2064 6f67 2e74  do'.assert dog.t
+0000efd0: 7269 636b 7320 3d3d 205b 2772 6f6c 6c20  ricks == ['roll 
+0000efe0: 6f76 6572 272c 2027 6665 7463 6820 6261  over', 'fetch ba
+0000eff0: 6c6c 275d 0a61 7373 6572 7420 646f 672e  ll'].assert dog.
+0000f000: 7665 7273 696f 6e20 3d3d 2032 0a61 7373  version == 2.ass
+0000f010: 6572 7420 646f 672e 6973 5f66 726f 6d5f  ert dog.is_from_
+0000f020: 736e 6170 7368 6f74 2069 7320 4661 6c73  snapshot is Fals
+0000f030: 650a 6060 600a 0a57 6520 6361 6e20 6361  e.```..We can ca
+0000f040: 6c6c 2060 736e 6170 7368 6f74 5f64 6f67  ll `snapshot_dog
+0000f050: 2829 6020 746f 2072 6563 6f72 6420 6120  ()` to record a 
+0000f060: 736e 6170 7368 6f74 206f 6620 7468 6520  snapshot of the 
+0000f070: 6375 7272 656e 7420 7374 6174 6520 6f66  current state of
+0000f080: 2074 6865 2060 446f 6760 0a61 6767 7265   the `Dog`.aggre
+0000f090: 6761 7465 2e20 4166 7465 7220 7765 2063  gate. After we c
+0000f0a0: 616c 6c20 6073 6e61 7073 686f 745f 646f  all `snapshot_do
+0000f0b0: 6728 2960 2c20 7468 6520 6067 6574 5f64  g()`, the `get_d
+0000f0c0: 6f67 2829 6020 6675 6e63 7469 6f6e 2077  og()` function w
+0000f0d0: 696c 6c20 7265 7475 726e 2061 2060 446f  ill return a `Do
+0000f0e0: 6760 0a6f 626a 6563 7420 7468 6174 2068  g`.object that h
+0000f0f0: 6173 2062 6565 6e20 636f 6e73 7472 7563  as been construc
+0000f100: 7465 6420 7573 696e 6720 7468 6520 6053  ted using the `S
+0000f110: 6e61 7073 686f 7460 2065 7665 6e74 2e0a  napshot` event..
+0000f120: 0a60 6060 7079 7468 6f6e 0a23 2053 6e61  .```python.# Sna
+0000f130: 7073 686f 7420 2746 6964 6f27 2e0a 736e  pshot 'Fido'..sn
+0000f140: 6170 7368 6f74 5f64 6f67 2864 6f67 5f69  apshot_dog(dog_i
+0000f150: 6429 0a0a 646f 6720 3d20 6765 745f 646f  d)..dog = get_do
+0000f160: 6728 646f 675f 6964 290a 6173 7365 7274  g(dog_id).assert
+0000f170: 2064 6f67 2e6e 616d 6520 3d3d 2027 4669   dog.name == 'Fi
+0000f180: 646f 270a 6173 7365 7274 2064 6f67 2e74  do'.assert dog.t
+0000f190: 7269 636b 7320 3d3d 205b 2772 6f6c 6c20  ricks == ['roll 
+0000f1a0: 6f76 6572 272c 2027 6665 7463 6820 6261  over', 'fetch ba
+0000f1b0: 6c6c 275d 0a61 7373 6572 7420 646f 672e  ll'].assert dog.
+0000f1c0: 7665 7273 696f 6e20 3d3d 2032 0a61 7373  version == 2.ass
+0000f1d0: 6572 7420 646f 672e 6973 5f66 726f 6d5f  ert dog.is_from_
+0000f1e0: 736e 6170 7368 6f74 2069 7320 5472 7565  snapshot is True
+0000f1f0: 0a60 6060 0a0a 5765 2063 616e 2063 6f6e  .```..We can con
+0000f200: 7469 6e75 6520 746f 2065 766f 6c76 6520  tinue to evolve 
+0000f210: 7468 6520 7374 6174 6520 6f66 2074 6865  the state of the
+0000f220: 2060 446f 6760 2061 6767 7265 6761 7465   `Dog` aggregate
+0000f230: 2c20 7573 696e 670a 7468 6520 736e 6170  , using.the snap
+0000f240: 7368 6f74 2062 6f74 6820 6475 7269 6e67  shot both during
+0000f250: 2074 6865 2063 616c 6c20 746f 2060 7265   the call to `re
+0000f260: 636f 7264 5f74 7269 636b 5f6c 6561 726e  cord_trick_learn
+0000f270: 6564 2829 6020 616e 640a 7768 656e 2063  ed()` and.when c
+0000f280: 616c 6c69 6e67 2060 6765 745f 646f 6728  alling `get_dog(
+0000f290: 2960 2064 6972 6563 746c 792e 0a0a 6060  )` directly...``
+0000f2a0: 6070 7974 686f 6e0a 7265 636f 7264 5f74  `python.record_t
+0000f2b0: 7269 636b 5f6c 6561 726e 6564 2864 6f67  rick_learned(dog
+0000f2c0: 5f69 642c 2074 7269 636b 3d27 7369 7427  _id, trick='sit'
+0000f2d0: 290a 0a64 6f67 203d 2067 6574 5f64 6f67  )..dog = get_dog
+0000f2e0: 2864 6f67 5f69 6429 0a61 7373 6572 7420  (dog_id).assert 
+0000f2f0: 646f 672e 6e61 6d65 203d 3d20 2746 6964  dog.name == 'Fid
+0000f300: 6f27 0a61 7373 6572 7420 646f 672e 7472  o'.assert dog.tr
+0000f310: 6963 6b73 203d 3d20 5b27 726f 6c6c 206f  icks == ['roll o
+0000f320: 7665 7227 2c20 2766 6574 6368 2062 616c  ver', 'fetch bal
+0000f330: 6c27 2c20 2773 6974 275d 0a61 7373 6572  l', 'sit'].asser
+0000f340: 7420 646f 672e 7665 7273 696f 6e20 3d3d  t dog.version ==
+0000f350: 2033 0a61 7373 6572 7420 646f 672e 6973   3.assert dog.is
+0000f360: 5f66 726f 6d5f 736e 6170 7368 6f74 2069  _from_snapshot i
+0000f370: 7320 5472 7565 0a60 6060 0a0a 5765 2063  s True.```..We c
+0000f380: 616e 2073 6565 2066 726f 6d20 7468 6520  an see from the 
+0000f390: 6069 735f 6672 6f6d 5f73 6e61 7073 686f  `is_from_snapsho
+0000f3a0: 7460 2061 7474 7269 6275 7465 2074 6861  t` attribute tha
+0000f3b0: 7420 7468 6520 6044 6f67 6020 6f62 6a65  t the `Dog` obje
+0000f3c0: 6374 2077 6173 2069 6e64 6565 640a 7265  ct was indeed.re
+0000f3d0: 636f 6e73 7472 7563 7465 6420 6672 6f6d  constructed from
+0000f3e0: 2074 6865 2073 6e61 7073 686f 742e 0a0a   the snapshot...
+0000f3f0: 536e 6170 7368 6f74 7320 6361 6e20 6265  Snapshots can be
+0000f400: 2063 7265 6174 6564 2061 7420 6669 7865   created at fixe
+0000f410: 6420 7665 7273 696f 6e20 6e75 6d62 6572  d version number
+0000f420: 2069 6e74 6572 7661 6c73 2c20 6669 7865   intervals, fixe
+0000f430: 6420 7469 6d65 0a70 6572 696f 6473 2c20  d time.periods, 
+0000f440: 6166 7465 7220 6120 7061 7274 6963 756c  after a particul
+0000f450: 6172 2074 7970 6520 6f66 2065 7665 6e74  ar type of event
+0000f460: 2c20 696d 6d65 6469 6174 656c 7920 6166  , immediately af
+0000f470: 7465 7220 6576 656e 7473 2061 7265 0a61  ter events are.a
+0000f480: 7070 656e 6465 642c 206f 7220 6173 2061  ppended, or as a
+0000f490: 2062 6163 6b67 726f 756e 6420 7072 6f63   background proc
+0000f4a0: 6573 732e 0a0a 0a23 2323 2052 6561 6420  ess....### Read 
+0000f4b0: 616c 6c20 6576 656e 7473 3c61 2069 643d  all events<a id=
+0000f4c0: 2272 6561 642d 616c 6c2d 6576 656e 7473  "read-all-events
+0000f4d0: 223e 3c2f 613e 0a0a 5468 6520 6072 6561  "></a>..The `rea
+0000f4e0: 645f 616c 6c28 2960 206d 6574 686f 6420  d_all()` method 
+0000f4f0: 6361 6e20 6265 2075 7365 6420 746f 2067  can be used to g
+0000f500: 6574 2061 6c6c 2072 6563 6f72 6465 6420  et all recorded 
+0000f510: 6576 656e 7473 0a69 6e20 7468 6520 6461  events.in the da
+0000f520: 7461 6261 7365 2069 6e20 7468 6520 6f72  tabase in the or
+0000f530: 6465 7220 7468 6579 2077 6572 6520 7265  der they were re
+0000f540: 636f 7264 6564 2e20 5468 6973 206d 6574  corded. This met
+0000f550: 686f 6420 7265 7475 726e 730a 6120 2272  hod returns.a "r
+0000f560: 6561 6420 7265 7370 6f6e 7365 2220 6f62  ead response" ob
+0000f570: 6a65 6374 2c20 6a75 7374 206c 696b 6520  ject, just like 
+0000f580: 6072 6561 645f 7374 7265 616d 2829 602e  `read_stream()`.
+0000f590: 0a0a 4120 2272 6561 6420 7265 7370 6f6e  ..A "read respon
+0000f5a0: 7365 2220 6973 2061 6e20 6974 6572 6174  se" is an iterat
+0000f5b0: 6f72 2c20 616e 6420 6e6f 7420 6120 7365  or, and not a se
+0000f5c0: 7175 656e 6365 2e20 5265 636f 7264 6564  quence. Recorded
+0000f5d0: 2065 7665 6e74 7320 6361 6e20 6265 0a6f   events can be.o
+0000f5e0: 6274 6169 6e65 6420 6279 2069 7465 7261  btained by itera
+0000f5f0: 7469 6e67 206f 7665 7220 7468 6520 2272  ting over the "r
+0000f600: 6561 6420 7265 7370 6f6e 7365 2220 6f62  ead response" ob
+0000f610: 6a65 6374 2e20 5265 636f 7264 6564 2065  ject. Recorded e
+0000f620: 7665 6e74 7320 6172 650a 7374 7265 616d  vents are.stream
+0000f630: 6564 2066 726f 6d20 7468 6520 7365 7276  ed from the serv
+0000f640: 6572 2074 6f20 7468 6520 636c 6965 6e74  er to the client
+0000f650: 2061 7320 7468 6520 6974 6572 6174 696f   as the iteratio
+0000f660: 6e20 7072 6f63 6565 6473 2e20 5468 6520  n proceeds. The 
+0000f670: 6974 6572 6174 696f 6e0a 7769 6c6c 2061  iteration.will a
+0000f680: 7574 6f6d 6174 6963 616c 6c79 2073 746f  utomatically sto
+0000f690: 7020 7768 656e 2074 6865 7265 2061 7265  p when there are
+0000f6a0: 206e 6f20 6d6f 7265 2072 6563 6f72 6465   no more recorde
+0000f6b0: 6420 6576 656e 7473 2074 6f20 6265 2072  d events to be r
+0000f6c0: 6574 7572 6e65 642e 0a54 6865 2073 7472  eturned..The str
+0000f6d0: 6561 6d69 6e67 206f 6620 6576 656e 7473  eaming of events
+0000f6e0: 2c20 616e 6420 6865 6e63 6520 7468 6520  , and hence the 
+0000f6f0: 6974 6572 6174 6f72 2c20 6361 6e20 616c  iterator, can al
+0000f700: 736f 2062 6520 7374 6f70 7065 6420 6279  so be stopped by
+0000f710: 2063 616c 6c69 6e67 0a74 6865 2060 7374   calling.the `st
+0000f720: 6f70 2829 6020 6d65 7468 6f64 206f 6e20  op()` method on 
+0000f730: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
+0000f740: 7365 2220 6f62 6a65 6374 2e20 5468 6520  se" object. The 
+0000f750: 7265 636f 7264 6564 2065 7665 6e74 206f  recorded event o
+0000f760: 626a 6563 7473 0a61 7265 2069 6e73 7461  bjects.are insta
+0000f770: 6e63 6573 206f 6620 7468 6520 6052 6563  nces of the `Rec
+0000f780: 6f72 6465 6445 7665 6e74 6020 636c 6173  ordedEvent` clas
+0000f790: 732e 0a0a 5468 6973 206d 6574 686f 6420  s...This method 
+0000f7a0: 6861 7320 6e69 6e65 206f 7074 696f 6e61  has nine optiona
+0000f7b0: 6c20 6172 6775 6d65 6e74 732c 2060 636f  l arguments, `co
+0000f7c0: 6d6d 6974 5f70 6f73 6974 696f 6e60 2c20  mmit_position`, 
+0000f7d0: 6062 6163 6b77 6172 6473 602c 2060 7265  `backwards`, `re
+0000f7e0: 736f 6c76 655f 6c69 6e6b 7360 2c0a 6066  solve_links`,.`f
+0000f7f0: 696c 7465 725f 6578 636c 7564 6560 2c20  ilter_exclude`, 
+0000f800: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+0000f810: 2c20 6066 696c 7465 725f 6279 5f73 7472  , `filter_by_str
+0000f820: 6561 6d5f 6e61 6d65 602c 2060 6c69 6d69  eam_name`, `limi
+0000f830: 7460 2c20 6074 696d 656f 7574 602c 0a61  t`, `timeout`,.a
+0000f840: 6e64 2060 6372 6564 656e 7469 616c 7360  nd `credentials`
+0000f850: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0000f860: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+0000f870: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+0000f880: 5079 7468 6f6e 2060 696e 7460 2074 6861  Python `int` tha
+0000f890: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+0000f8a0: 0a73 7065 6369 6679 2061 2063 6f6d 6d69  .specify a commi
+0000f8b0: 7420 706f 7369 7469 6f6e 2066 726f 6d20  t position from 
+0000f8c0: 7768 6963 6820 746f 2073 7461 7274 2072  which to start r
+0000f8d0: 6561 6469 6e67 2e20 5468 6520 6465 6661  eading. The defa
+0000f8e0: 756c 7420 7661 6c75 6520 6f66 0a60 636f  ult value of.`co
+0000f8f0: 6d6d 6974 5f70 6f73 6974 696f 6e60 2069  mmit_position` i
+0000f900: 7320 604e 6f6e 6560 2e20 506c 6561 7365  s `None`. Please
+0000f910: 206e 6f74 652c 2069 6620 6120 636f 6d6d   note, if a comm
+0000f920: 6974 2070 6f73 6974 696f 6e20 6973 2073  it position is s
+0000f930: 7065 6369 6669 6564 2c0a 6974 206d 7573  pecified,.it mus
+0000f940: 7420 6265 2061 6e20 6163 7475 616c 6c79  t be an actually
+0000f950: 2065 7869 7374 696e 6720 636f 6d6d 6974   existing commit
+0000f960: 2070 6f73 6974 696f 6e20 696e 2074 6865   position in the
+0000f970: 2064 6174 6162 6173 652e 2057 6865 6e20   database. When 
+0000f980: 7265 6164 696e 670a 666f 7277 6172 6473  reading.forwards
+0000f990: 2c20 7468 6520 6576 656e 7420 6174 2074  , the event at t
+0000f9a0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+0000f9b0: 6f6e 206d 6179 2062 6520 696e 636c 7564  on may be includ
+0000f9c0: 6564 2c20 6465 7065 6e64 696e 6720 7570  ed, depending up
+0000f9d0: 6f6e 2074 6865 0a66 696c 7465 722e 2057  on the.filter. W
+0000f9e0: 6865 6e20 7265 6164 696e 6720 6261 636b  hen reading back
+0000f9f0: 7761 7264 732c 2074 6865 2065 7665 6e74  wards, the event
+0000fa00: 2061 7420 7468 6520 636f 6d6d 6974 2070   at the commit p
+0000fa10: 6f73 6974 696f 6e20 7769 6c6c 206e 6f74  osition will not
+0000fa20: 2062 650a 696e 636c 7564 6564 2e0a 0a54   be.included...T
+0000fa30: 6865 206f 7074 696f 6e61 6c20 6062 6163  he optional `bac
+0000fa40: 6b77 6172 6473 6020 6172 6775 6d65 6e74  kwards` argument
+0000fa50: 2069 7320 6120 5079 7468 6f6e 2060 626f   is a Python `bo
+0000fa60: 6f6c 602e 2054 6865 2064 6566 6175 6c74  ol`. The default
+0000fa70: 206f 6620 6062 6163 6b77 6172 6473 6020   of `backwards` 
+0000fa80: 6973 0a60 4661 6c73 6560 2c20 7768 6963  is.`False`, whic
+0000fa90: 6820 6d65 616e 7320 6576 656e 7473 2061  h means events a
+0000faa0: 7265 2072 6574 7572 6e65 6420 696e 2074  re returned in t
+0000fab0: 6865 206f 7264 6572 2074 6865 7920 7765  he order they we
+0000fac0: 7265 2072 6563 6f72 6465 642c 2049 660a  re recorded, If.
+0000fad0: 6062 6163 6b77 6172 6473 6020 6973 2060  `backwards` is `
+0000fae0: 5472 7565 602c 2074 6865 6e20 6576 656e  True`, then even
+0000faf0: 7473 2061 7265 2072 6574 7572 6e65 6420  ts are returned 
+0000fb00: 696e 2072 6576 6572 7365 206f 7264 6572  in reverse order
+0000fb10: 2e0a 0a49 6620 6062 6163 6b77 6172 6473  ...If `backwards
+0000fb20: 6020 6973 2060 4661 6c73 6560 2061 6e64  ` is `False` and
+0000fb30: 2060 636f 6d6d 6974 5f70 6f73 6974 696f   `commit_positio
+0000fb40: 6e60 2069 7320 604e 6f6e 6560 2c20 7468  n` is `None`, th
+0000fb50: 6520 6461 7461 6261 7365 2773 2065 7665  e database's eve
+0000fb60: 6e74 7320 7769 6c6c 0a62 6520 7265 7475  nts will.be retu
+0000fb70: 726e 6564 2069 6e20 7468 6520 6f72 6465  rned in the orde
+0000fb80: 7220 7468 6579 2077 6572 6520 7265 636f  r they were reco
+0000fb90: 7264 6564 2c20 7374 6172 7469 6e67 2066  rded, starting f
+0000fba0: 726f 6d20 7468 6520 6669 7273 7420 7265  rom the first re
+0000fbb0: 636f 7264 6564 2065 7665 6e74 2e0a 5468  corded event..Th
+0000fbc0: 6973 2069 7320 7468 6520 6465 6661 756c  is is the defaul
+0000fbd0: 7420 6265 6861 7669 6f72 206f 6620 6072  t behavior of `r
+0000fbe0: 6561 645f 616c 6c28 2960 2e20 4966 2060  ead_all()`. If `
+0000fbf0: 6261 636b 7761 7264 7360 2069 7320 6054  backwards` is `T
+0000fc00: 7275 6560 2061 6e64 0a60 636f 6d6d 6974  rue` and.`commit
+0000fc10: 5f70 6f73 6974 696f 6e60 2069 7320 604e  _position` is `N
+0000fc20: 6f6e 6560 2c20 7468 6520 6461 7461 6261  one`, the databa
+0000fc30: 7365 2773 2065 7665 6e74 7320 7769 6c6c  se's events will
+0000fc40: 2062 6520 7265 7475 726e 6564 2069 6e20   be returned in 
+0000fc50: 7265 7665 7273 6520 6f72 6465 722c 0a73  reverse order,.s
+0000fc60: 7461 7274 696e 6720 6672 6f6d 2074 6865  tarting from the
+0000fc70: 206c 6173 7420 7265 636f 7264 6564 2065   last recorded e
+0000fc80: 7665 6e74 2e0a 0a54 6865 206f 7074 696f  vent...The optio
+0000fc90: 6e61 6c20 6072 6573 6f6c 7665 5f6c 696e  nal `resolve_lin
+0000fca0: 6b73 6020 6172 6775 6d65 6e74 2069 7320  ks` argument is 
+0000fcb0: 6120 5079 7468 6f6e 2060 626f 6f6c 602e  a Python `bool`.
+0000fcc0: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
+0000fcd0: 7565 206f 6620 6072 6573 6f6c 7665 5f6c  ue of `resolve_l
+0000fce0: 696e 6b73 600a 6973 2060 4661 6c73 6560  inks`.is `False`
+0000fcf0: 2c20 7768 6963 6820 6d65 616e 7320 616e  , which means an
+0000fd00: 7920 6576 656e 7420 6c69 6e6b 7320 7769  y event links wi
+0000fd10: 6c6c 206e 6f74 2062 6520 7265 736f 6c76  ll not be resolv
+0000fd20: 6564 2c20 736f 2074 6861 7420 7468 6520  ed, so that the 
+0000fd30: 6576 656e 7473 2074 6861 7420 6172 650a  events that are.
+0000fd40: 7265 7475 726e 6564 206d 6179 2072 6570  returned may rep
+0000fd50: 7265 7365 6e74 2065 7665 6e74 206c 696e  resent event lin
+0000fd60: 6b73 2e20 4966 2060 7265 736f 6c76 655f  ks. If `resolve_
+0000fd70: 6c69 6e6b 7360 2069 7320 6054 7275 6560  links` is `True`
+0000fd80: 2c20 616e 7920 6576 656e 7420 6c69 6e6b  , any event link
+0000fd90: 7320 7769 6c6c 0a62 6520 7265 736f 6c76  s will.be resolv
+0000fda0: 6564 2c20 736f 2074 6861 7420 7468 6520  ed, so that the 
+0000fdb0: 6c69 6e6b 6564 2065 7665 6e74 7320 7769  linked events wi
+0000fdc0: 6c6c 2062 6520 7265 7475 726e 6564 2069  ll be returned i
+0000fdd0: 6e73 7465 6164 206f 6620 7468 6520 6576  nstead of the ev
+0000fde0: 656e 7420 6c69 6e6b 732e 0a0a 5468 6520  ent links...The 
+0000fdf0: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
+0000fe00: 5f65 7863 6c75 6465 6020 6172 6775 6d65  _exclude` argume
+0000fe10: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
+0000fe20: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
+0000fe30: 6573 7369 6f6e 7320 7468 6174 0a73 7065  essions that.spe
+0000fe40: 6369 6669 6573 2077 6869 6368 2072 6563  cifies which rec
+0000fe50: 6f72 6465 6420 6576 656e 7473 2073 686f  orded events sho
+0000fe60: 756c 6420 6265 2072 6574 7572 6e65 642e  uld be returned.
+0000fe70: 2054 6869 7320 6172 6775 6d65 6e74 2069   This argument i
+0000fe80: 7320 6967 6e6f 7265 640a 6966 2060 6669  s ignored.if `fi
+0000fe90: 6c74 6572 5f69 6e63 6c75 6465 6020 6973  lter_include` is
+0000fea0: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
+0000feb0: 7074 7920 7365 7175 656e 6365 2e20 5468  pty sequence. Th
+0000fec0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+0000fed0: 6f66 2074 6869 730a 6172 6775 6d65 6e74  of this.argument
+0000fee0: 206d 6174 6368 6573 2074 6865 2065 7665   matches the eve
+0000fef0: 6e74 2074 7970 6573 206f 6620 4576 656e  nt types of Even
+0000ff00: 7453 746f 7265 4442 2022 7379 7374 656d  tStoreDB "system
+0000ff10: 2065 7665 6e74 7322 2c20 736f 2074 6861   events", so tha
+0000ff20: 7420 7379 7374 656d 0a65 7665 6e74 7320  t system.events 
+0000ff30: 7769 6c6c 206e 6f74 206e 6f72 6d61 6c6c  will not normall
+0000ff40: 7920 6265 2069 6e63 6c75 6465 642e 2053  y be included. S
+0000ff50: 6565 2074 6865 204e 6f74 6573 2073 6563  ee the Notes sec
+0000ff60: 7469 6f6e 2062 656c 6f77 2066 6f72 206d  tion below for m
+0000ff70: 6f72 650a 696e 666f 726d 6174 696f 6e20  ore.information 
+0000ff80: 6162 6f75 7420 6669 6c74 6572 2065 7870  about filter exp
+0000ff90: 7265 7373 696f 6e73 2e0a 0a54 6865 206f  ressions...The o
+0000ffa0: 7074 696f 6e61 6c20 6066 696c 7465 725f  ptional `filter_
+0000ffb0: 696e 636c 7564 6560 2061 7267 756d 656e  include` argumen
+0000ffc0: 7420 6973 2061 2073 6571 7565 6e63 6520  t is a sequence 
+0000ffd0: 6f66 2072 6567 756c 6172 2065 7870 7265  of regular expre
+0000ffe0: 7373 696f 6e73 0a74 6861 7420 7370 6563  ssions.that spec
+0000fff0: 6966 6965 7320 7768 6963 6820 7265 636f  ifies which reco
+00010000: 7264 6564 2065 7665 6e74 7320 7368 6f75  rded events shou
+00010010: 6c64 2062 6520 7265 7475 726e 6564 2e20  ld be returned. 
+00010020: 4279 2064 6566 6175 6c74 2c20 7468 6973  By default, this
+00010030: 0a61 7267 756d 656e 7420 6973 2061 6e20  .argument is an 
+00010040: 656d 7074 7920 7475 706c 652e 2049 6620  empty tuple. If 
+00010050: 7468 6973 2061 7267 756d 656e 7420 6973  this argument is
+00010060: 2073 6574 2074 6f20 6120 6e6f 6e2d 656d   set to a non-em
+00010070: 7074 7920 7365 7175 656e 6365 2c0a 7468  pty sequence,.th
+00010080: 6520 6066 696c 7465 725f 6578 636c 7564  e `filter_exclud
+00010090: 6560 2061 7267 756d 656e 7420 6973 2069  e` argument is i
+000100a0: 676e 6f72 6564 2e0a 0a54 6865 206f 7074  gnored...The opt
+000100b0: 696f 6e61 6c20 6066 696c 7465 725f 6279  ional `filter_by
+000100c0: 5f73 7472 6561 6d5f 6e61 6d65 6020 6172  _stream_name` ar
+000100d0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+000100e0: 6f6e 2060 626f 6f6c 6020 7468 6174 2069  on `bool` that i
+000100f0: 6e64 6963 6174 6573 0a77 6865 7468 6572  ndicates.whether
+00010100: 2074 6865 2066 696c 7465 7269 6e67 2077   the filtering w
+00010110: 696c 6c20 6170 706c 7920 746f 2065 7665  ill apply to eve
+00010120: 6e74 2074 7970 6573 206f 7220 7374 7265  nt types or stre
+00010130: 616d 206e 616d 6573 2e20 4279 2064 6566  am names. By def
+00010140: 6175 6c74 2c20 7468 6973 0a76 616c 7565  ault, this.value
+00010150: 2069 7320 6046 616c 7365 6020 616e 6420   is `False` and 
+00010160: 736f 2074 6865 2066 696c 7465 7269 6e67  so the filtering
+00010170: 2077 696c 6c20 6170 706c 7920 746f 2074   will apply to t
+00010180: 6865 2065 7665 6e74 2074 7970 6520 7374  he event type st
+00010190: 7269 6e67 7320 6f66 0a72 6563 6f72 6465  rings of.recorde
+000101a0: 6420 6576 656e 7473 2e0a 0a54 6865 206f  d events...The o
+000101b0: 7074 696f 6e61 6c20 606c 696d 6974 6020  ptional `limit` 
+000101c0: 6172 6775 6d65 6e74 2069 7320 616e 2069  argument is an i
+000101d0: 6e74 6567 6572 2077 6869 6368 2072 6573  nteger which res
+000101e0: 7472 6963 7473 2074 6865 206e 756d 6265  tricts the numbe
+000101f0: 7220 6f66 2065 7665 6e74 7320 7468 6174  r of events that
+00010200: 0a77 696c 6c20 6265 2072 6574 7572 6e65  .will be returne
+00010210: 642e 2054 6865 2064 6566 6175 6c74 2076  d. The default v
+00010220: 616c 7565 2069 7320 6073 7973 2e6d 6178  alue is `sys.max
+00010230: 696e 7460 2e0a 0a54 6865 206f 7074 696f  int`...The optio
+00010240: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+00010250: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00010260: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
+00010270: 2073 6574 7320 610a 6d61 7869 6d75 6d20   sets a.maximum 
+00010280: 6475 7261 7469 6f6e 2c20 696e 2073 6563  duration, in sec
+00010290: 6f6e 6473 2c20 666f 7220 7468 6520 636f  onds, for the co
+000102a0: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
+000102b0: 6752 5043 206f 7065 7261 7469 6f6e 2e0a  gRPC operation..
+000102c0: 0a54 6865 206f 7074 696f 6e61 6c20 6063  .The optional `c
+000102d0: 7265 6465 6e74 6961 6c73 6020 6172 6775  redentials` argu
+000102e0: 6d65 6e74 2063 616e 2062 6520 7573 6564  ment can be used
+000102f0: 2074 6f0a 6f76 6572 7269 6465 2063 616c   to.override cal
+00010300: 6c20 6372 6564 656e 7469 616c 7320 6465  l credentials de
+00010310: 7269 7665 6420 6672 6f6d 2074 6865 2063  rived from the c
+00010320: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+00010330: 2055 5249 2e0a 0a54 6865 2066 696c 7465   URI...The filte
+00010340: 7269 6e67 206f 6620 6576 656e 7473 2069  ring of events i
+00010350: 7320 646f 6e65 206f 6e20 7468 6520 4576  s done on the Ev
+00010360: 656e 7453 746f 7265 4442 2073 6572 7665  entStoreDB serve
+00010370: 722e 2054 6865 0a60 6c69 6d69 7460 2061  r. The.`limit` a
+00010380: 7267 756d 656e 7420 6973 2061 7070 6c69  rgument is appli
+00010390: 6564 206f 6e20 7468 6520 7365 7276 6572  ed on the server
+000103a0: 2061 6674 6572 2066 696c 7465 7269 6e67   after filtering
+000103b0: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
+000103c0: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
+000103d0: 6f20 6765 7420 616c 6c20 7468 6520 6576  o get all the ev
+000103e0: 656e 7473 2077 6520 6861 7665 2072 6563  ents we have rec
+000103f0: 6f72 6465 6420 696e 2074 6865 2064 6174  orded in the dat
+00010400: 6162 6173 650a 736f 2066 6172 2c20 696e  abase.so far, in
+00010410: 2074 6865 206f 7264 6572 2074 6865 7920   the order they 
+00010420: 7765 7265 2072 6563 6f72 6465 642e 2057  were recorded. W
+00010430: 6520 6361 6e20 7365 6520 7468 6520 7468  e can see the th
+00010440: 7265 6520 6576 656e 7473 206f 6620 6073  ree events of `s
+00010450: 7472 6561 6d5f 6e61 6d65 3160 0a28 6065  tream_name1`.(`e
+00010460: 7665 6e74 3160 2c20 6065 7665 6e74 3260  vent1`, `event2`
+00010470: 2061 6e64 2060 6576 656e 7433 6029 2061   and `event3`) a
+00010480: 7265 2069 6e63 6c75 6465 642c 2061 6c6f  re included, alo
+00010490: 6e67 2077 6974 6820 6f74 6865 7273 2e0a  ng with others..
+000104a0: 0a60 6060 7079 7468 6f6e 0a23 2052 6561  .```python.# Rea
+000104b0: 6420 616c 6c20 6576 656e 7473 2028 6372  d all events (cr
+000104c0: 6561 7465 7320 6120 7374 7265 616d 696e  eates a streamin
+000104d0: 6720 6752 5043 2063 616c 6c29 2e0a 7265  g gRPC call)..re
+000104e0: 6164 5f72 6573 706f 6e73 6520 3d20 636c  ad_response = cl
+000104f0: 6965 6e74 2e72 6561 645f 616c 6c28 290a  ient.read_all().
+00010500: 0a23 2043 6f6e 7665 7274 2074 6865 2069  .# Convert the i
+00010510: 7465 7261 746f 7220 696e 746f 2061 2073  terator into a s
+00010520: 6571 7565 6e63 6520 6f66 2072 6563 6f72  equence of recor
+00010530: 6465 6420 6576 656e 7473 2e0a 6576 656e  ded events..even
+00010540: 7473 203d 2074 7570 6c65 2872 6561 645f  ts = tuple(read_
+00010550: 7265 7370 6f6e 7365 290a 6173 7365 7274  response).assert
+00010560: 206c 656e 2865 7665 6e74 7329 203e 2033   len(events) > 3
+00010570: 2020 2320 6d6f 7265 2074 6861 6e20 7468    # more than th
+00010580: 7265 650a 0a23 2043 6f6e 7665 7274 2074  ree..# Convert t
+00010590: 6865 2073 6571 7565 6e63 6520 6f66 2072  he sequence of r
+000105a0: 6563 6f72 6465 6420 6576 656e 7473 2069  ecorded events i
+000105b0: 6e74 6f20 6120 7365 7420 6f66 2065 7665  nto a set of eve
+000105c0: 6e74 2049 4473 2e0a 6576 656e 745f 6964  nt IDs..event_id
+000105d0: 7320 3d20 7365 7428 652e 6964 2066 6f72  s = set(e.id for
+000105e0: 2065 2069 6e20 6576 656e 7473 290a 6173   e in events).as
+000105f0: 7365 7274 2065 7665 6e74 312e 6964 2069  sert event1.id i
+00010600: 6e20 6576 656e 745f 6964 730a 6173 7365  n event_ids.asse
+00010610: 7274 2065 7665 6e74 322e 6964 2069 6e20  rt event2.id in 
+00010620: 6576 656e 745f 6964 730a 6173 7365 7274  event_ids.assert
+00010630: 2065 7665 6e74 332e 6964 2069 6e20 6576   event3.id in ev
+00010640: 656e 745f 6964 730a 6060 600a 0a54 6865  ent_ids.```..The
+00010650: 2065 7861 6d70 6c65 2062 656c 6f77 2073   example below s
+00010660: 686f 7773 2068 6f77 2074 6f20 7265 6164  hows how to read
+00010670: 2061 6c6c 2072 6563 6f72 6465 6420 6576   all recorded ev
+00010680: 656e 7473 2069 6e20 7468 6520 6461 7461  ents in the data
+00010690: 6261 7365 2066 726f 6d0a 6120 7061 7274  base from.a part
+000106a0: 6963 756c 6172 2063 6f6d 6d69 7420 706f  icular commit po
+000106b0: 7369 7469 6f6e 2c20 696e 2074 6869 7320  sition, in this 
+000106c0: 6361 7365 2060 636f 6d6d 6974 5f70 6f73  case `commit_pos
+000106d0: 6974 696f 6e31 602e 2057 6865 6e20 7265  ition1`. When re
+000106e0: 6164 696e 670a 666f 7277 6172 6473 2066  ading.forwards f
+000106f0: 726f 6d20 6120 7370 6563 6966 6963 2063  rom a specific c
+00010700: 6f6d 6d69 7420 706f 7369 7469 6f6e 2c20  ommit position, 
+00010710: 7468 6520 6576 656e 7420 6174 2074 6865  the event at the
+00010720: 2073 7065 6369 6669 6564 2070 6f73 6974   specified posit
+00010730: 696f 6e0a 7769 6c6c 2062 6520 696e 636c  ion.will be incl
+00010740: 7564 6564 2e20 5468 6520 7661 6c75 6520  uded. The value 
+00010750: 6f66 2060 636f 6d6d 6974 5f70 6f73 6974  of `commit_posit
+00010760: 696f 6e31 6020 6973 2074 6865 2070 6f73  ion1` is the pos
+00010770: 6974 696f 6e20 7765 206f 6274 6169 6e65  ition we obtaine
+00010780: 640a 7768 656e 2061 7070 656e 6469 6e67  d.when appending
+00010790: 2060 6576 656e 7431 602e 2041 6e64 2073   `event1`. And s
+000107a0: 6f20 6065 7665 6e74 3160 2069 7320 7468  o `event1` is th
+000107b0: 6520 6669 7273 7420 7265 636f 7264 6564  e first recorded
+000107c0: 2065 7665 6e74 2077 6520 7368 616c 6c0a   event we shall.
+000107d0: 7265 6365 6976 652c 2060 6576 656e 7432  receive, `event2
+000107e0: 6020 6973 2074 6865 2073 6563 6f6e 642c  ` is the second,
+000107f0: 2061 6e64 2060 6576 656e 7433 6020 6973   and `event3` is
+00010800: 2074 6865 2074 6869 7264 2e0a 0a60 6060   the third...```
+00010810: 7079 7468 6f6e 0a23 2052 6561 6420 616c  python.# Read al
+00010820: 6c20 6576 656e 7473 2066 6f72 7761 7264  l events forward
+00010830: 7320 6672 6f6d 2061 2063 6f6d 6d69 7420  s from a commit 
+00010840: 706f 7369 7469 6f6e 2e0a 7265 6164 5f72  position..read_r
+00010850: 6573 706f 6e73 6520 3d20 636c 6965 6e74  esponse = client
+00010860: 2e72 6561 645f 616c 6c28 0a20 2020 2063  .read_all(.    c
+00010870: 6f6d 6d69 745f 706f 7369 7469 6f6e 3d63  ommit_position=c
+00010880: 6f6d 6d69 745f 706f 7369 7469 6f6e 310a  ommit_position1.
+00010890: 290a 0a23 2053 7465 7020 7468 726f 7567  )..# Step throug
+000108a0: 6820 7468 6520 2272 6561 6420 7265 7370  h the "read resp
+000108b0: 6f6e 7365 2220 6974 6572 6174 6f72 2e0a  onse" iterator..
+000108c0: 6173 7365 7274 206e 6578 7428 7265 6164  assert next(read
+000108d0: 5f72 6573 706f 6e73 6529 203d 3d20 6576  _response) == ev
+000108e0: 656e 7431 0a61 7373 6572 7420 6e65 7874  ent1.assert next
+000108f0: 2872 6561 645f 7265 7370 6f6e 7365 2920  (read_response) 
+00010900: 3d3d 2065 7665 6e74 320a 6173 7365 7274  == event2.assert
+00010910: 206e 6578 7428 7265 6164 5f72 6573 706f   next(read_respo
+00010920: 6e73 6529 203d 3d20 6576 656e 7433 0a0a  nse) == event3..
+00010930: 2320 5374 6f70 2074 6865 2069 7465 7261  # Stop the itera
+00010940: 746f 722e 0a72 6561 645f 7265 7370 6f6e  tor..read_respon
+00010950: 7365 2e73 746f 7028 290a 6060 600a 0a54  se.stop().```..T
+00010960: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00010970: 2073 686f 7773 2068 6f77 2074 6f20 7265   shows how to re
+00010980: 6164 2061 6c6c 2065 7665 6e74 7320 7265  ad all events re
+00010990: 636f 7264 6564 2069 6e20 7468 6520 6461  corded in the da
+000109a0: 7461 6261 7365 2069 6e20 7265 7665 7273  tabase in revers
+000109b0: 650a 6f72 6465 722e 2057 6520 6361 6e20  e.order. We can 
+000109c0: 7365 6520 7468 6174 2074 6865 2066 6972  see that the fir
+000109d0: 7374 2065 7665 6e74 7320 7765 2072 6563  st events we rec
+000109e0: 6569 7665 2061 7265 2074 6865 206c 6173  eive are the las
+000109f0: 7420 6576 656e 7473 2074 6861 7420 7765  t events that we
+00010a00: 7265 0a72 6563 6f72 6465 643a 2074 6865  re.recorded: the
+00010a10: 2065 7665 6e74 7320 6f66 2074 6865 2060   events of the `
+00010a20: 446f 6760 2061 6767 7265 6761 7465 2066  Dog` aggregate f
+00010a30: 726f 6d20 7468 6520 7365 6374 696f 6e20  rom the section 
+00010a40: 6162 6f75 7420 736e 6170 7368 6f74 7469  about snapshotti
+00010a50: 6e67 0a61 6e64 2074 6865 2073 6e61 7073  ng.and the snaps
+00010a60: 686f 742e 0a0a 6060 6070 7974 686f 6e0a  hot...```python.
+00010a70: 2320 5265 6164 2061 6c6c 2065 7665 6e74  # Read all event
+00010a80: 7320 6261 636b 7761 7264 7320 6672 6f6d  s backwards from
+00010a90: 2074 6865 2065 6e64 2e0a 7265 6164 5f72   the end..read_r
+00010aa0: 6573 706f 6e73 6520 3d20 636c 6965 6e74  esponse = client
+00010ab0: 2e72 6561 645f 616c 6c28 0a20 2020 2062  .read_all(.    b
+00010ac0: 6163 6b77 6172 6473 3d54 7275 650a 290a  ackwards=True.).
+00010ad0: 0a23 2053 7465 7020 7468 726f 7567 6820  .# Step through 
+00010ae0: 7468 6520 2272 6561 6420 7265 7370 6f6e  the "read respon
+00010af0: 7365 2220 6974 6572 6174 6f72 2e0a 6173  se" iterator..as
+00010b00: 7365 7274 206e 6578 7428 7265 6164 5f72  sert next(read_r
+00010b10: 6573 706f 6e73 6529 2e74 7970 6520 3d3d  esponse).type ==
+00010b20: 2022 446f 674c 6561 726e 6564 5472 6963   "DogLearnedTric
+00010b30: 6b22 0a61 7373 6572 7420 6e65 7874 2872  k".assert next(r
+00010b40: 6561 645f 7265 7370 6f6e 7365 292e 7479  ead_response).ty
+00010b50: 7065 203d 3d20 2253 6e61 7073 686f 7422  pe == "Snapshot"
+00010b60: 0a61 7373 6572 7420 6e65 7874 2872 6561  .assert next(rea
+00010b70: 645f 7265 7370 6f6e 7365 292e 7479 7065  d_response).type
+00010b80: 203d 3d20 2244 6f67 4c65 6172 6e65 6454   == "DogLearnedT
+00010b90: 7269 636b 220a 6173 7365 7274 206e 6578  rick".assert nex
+00010ba0: 7428 7265 6164 5f72 6573 706f 6e73 6529  t(read_response)
+00010bb0: 2e74 7970 6520 3d3d 2022 446f 674c 6561  .type == "DogLea
+00010bc0: 726e 6564 5472 6963 6b22 0a61 7373 6572  rnedTrick".asser
+00010bd0: 7420 6e65 7874 2872 6561 645f 7265 7370  t next(read_resp
+00010be0: 6f6e 7365 292e 7479 7065 203d 3d20 2244  onse).type == "D
+00010bf0: 6f67 5265 6769 7374 6572 6564 220a 0a23  ogRegistered"..#
+00010c00: 2053 746f 7020 7468 6520 6974 6572 6174   Stop the iterat
+00010c10: 6f72 2e0a 7265 6164 5f72 6573 706f 6e73  or..read_respons
+00010c20: 652e 7374 6f70 2829 0a60 6060 0a0a 5468  e.stop().```..Th
+00010c30: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+00010c40: 7368 6f77 7320 686f 7720 746f 2072 6561  shows how to rea
+00010c50: 6420 6120 6c69 6d69 7465 6420 6e75 6d62  d a limited numb
+00010c60: 6572 206f 6620 6576 656e 7473 0a66 6f72  er of events.for
+00010c70: 7761 7264 7320 6672 6f6d 2061 2073 7065  wards from a spe
+00010c80: 6369 6669 6320 636f 6d6d 6974 2070 6f73  cific commit pos
+00010c90: 6974 696f 6e2e 0a0a 6060 6070 7974 686f  ition...```pytho
+00010ca0: 6e0a 6576 656e 7473 203d 2074 7570 6c65  n.events = tuple
+00010cb0: 280a 2020 2020 636c 6965 6e74 2e72 6561  (.    client.rea
+00010cc0: 645f 616c 6c28 0a20 2020 2020 2020 2063  d_all(.        c
+00010cd0: 6f6d 6d69 745f 706f 7369 7469 6f6e 3d63  ommit_position=c
+00010ce0: 6f6d 6d69 745f 706f 7369 7469 6f6e 312c  ommit_position1,
+00010cf0: 0a20 2020 2020 2020 206c 696d 6974 3d31  .        limit=1
+00010d00: 2c0a 2020 2020 290a 290a 0a61 7373 6572  ,.    ).)..asser
+00010d10: 7420 6c65 6e28 6576 656e 7473 2920 3d3d  t len(events) ==
+00010d20: 2031 0a61 7373 6572 7420 6576 656e 7473   1.assert events
+00010d30: 5b30 5d20 3d3d 2065 7665 6e74 310a 6060  [0] == event1.``
+00010d40: 600a 0a54 6865 2065 7861 6d70 6c65 2062  `..The example b
+00010d50: 656c 6f77 2073 686f 7773 2068 6f77 2074  elow shows how t
+00010d60: 6f20 7265 6164 2061 206c 696d 6974 6564  o read a limited
+00010d70: 206e 756d 6265 7220 6f66 2074 6865 2072   number of the r
+00010d80: 6563 6f72 6465 6420 6576 656e 7473 0a69  ecorded events.i
+00010d90: 6e20 7468 6520 6461 7461 6261 7365 2062  n the database b
+00010da0: 6163 6b77 6172 6473 2066 726f 6d20 7468  ackwards from th
+00010db0: 6520 656e 642e 2049 6e20 7468 6973 2063  e end. In this c
+00010dc0: 6173 652c 2074 6865 206c 696d 6974 2069  ase, the limit i
+00010dd0: 7320 312c 2061 6e64 0a73 6f20 7765 2072  s 1, and.so we r
+00010de0: 6563 6569 7665 2074 6865 206c 6173 7420  eceive the last 
+00010df0: 7265 636f 7264 6564 2065 7665 6e74 2e0a  recorded event..
+00010e00: 0a60 6060 7079 7468 6f6e 0a65 7665 6e74  .```python.event
+00010e10: 7320 3d20 7475 706c 6528 0a20 2020 2063  s = tuple(.    c
+00010e20: 6c69 656e 742e 7265 6164 5f61 6c6c 280a  lient.read_all(.
+00010e30: 2020 2020 2020 2020 6261 636b 7761 7264          backward
+00010e40: 733d 5472 7565 2c0a 2020 2020 2020 2020  s=True,.        
+00010e50: 6c69 6d69 743d 312c 0a20 2020 2029 0a29  limit=1,.    ).)
+00010e60: 0a0a 6173 7365 7274 206c 656e 2865 7665  ..assert len(eve
+00010e70: 6e74 7329 203d 3d20 310a 0a61 7373 6572  nts) == 1..asser
+00010e80: 7420 6576 656e 7473 5b30 5d2e 7479 7065  t events[0].type
+00010e90: 203d 3d20 2744 6f67 4c65 6172 6e65 6454   == 'DogLearnedT
+00010ea0: 7269 636b 270a 6173 7365 7274 2064 6573  rick'.assert des
+00010eb0: 6572 6961 6c69 7a65 2865 7665 6e74 735b  erialize(events[
+00010ec0: 305d 2e64 6174 6129 5b27 7472 6963 6b27  0].data)['trick'
+00010ed0: 5d20 3d3d 2027 7369 7427 0a60 6060 0a0a  ] == 'sit'.```..
+00010ee0: 506c 6561 7365 206e 6f74 652c 206c 696b  Please note, lik
+00010ef0: 6520 7468 6520 6072 6561 645f 7374 7265  e the `read_stre
+00010f00: 616d 2829 6020 6d65 7468 6f64 2c20 7468  am()` method, th
+00010f10: 6520 6072 6561 645f 616c 6c28 2960 206d  e `read_all()` m
+00010f20: 6574 686f 640a 6973 206e 6f74 2064 6563  ethod.is not dec
+00010f30: 6f72 6174 6564 2077 6974 6820 7265 7472  orated with retr
+00010f40: 7920 616e 6420 7265 636f 6e6e 6563 7420  y and reconnect 
+00010f50: 6465 636f 7261 746f 7273 2c20 6265 6361  decorators, beca
+00010f60: 7573 6520 7468 6520 7374 7265 616d 696e  use the streamin
+00010f70: 6720 6f66 2072 6563 6f72 6465 640a 6576  g of recorded.ev
+00010f80: 656e 7473 2066 726f 6d20 7468 6520 7365  ents from the se
+00010f90: 7276 6572 206f 6e6c 7920 7374 6172 7473  rver only starts
+00010fa0: 2077 6865 6e20 6974 6572 6174 696e 6720   when iterating 
+00010fb0: 6f76 6572 2074 6865 2022 7265 6164 2072  over the "read r
+00010fc0: 6573 706f 6e73 6522 2073 7461 7274 732c  esponse" starts,
+00010fd0: 2077 6869 6368 0a6d 6561 6e73 2074 6861   which.means tha
+00010fe0: 7420 7468 6520 6d65 7468 6f64 2072 6574  t the method ret
+00010ff0: 7572 6e73 2062 6566 6f72 6520 7468 6520  urns before the 
+00011000: 7374 7265 616d 696e 6720 7374 6172 7473  streaming starts
+00011010: 2c20 616e 6420 736f 2074 6865 7265 2069  , and so there i
+00011020: 7320 6e6f 2063 6861 6e63 6520 666f 720a  s no chance for.
+00011030: 616e 7920 6465 636f 7261 746f 7273 2074  any decorators t
+00011040: 6f20 6361 7463 6820 616e 7920 636f 6e6e  o catch any conn
+00011050: 6563 7469 6f6e 2069 7373 7565 732e 0a0a  ection issues...
+00011060: 2323 2320 4765 7420 636f 6d6d 6974 2070  ### Get commit p
+00011070: 6f73 6974 696f 6e3c 6120 6964 3d22 6765  osition<a id="ge
+00011080: 742d 636f 6d6d 6974 2d70 6f73 6974 696f  t-commit-positio
+00011090: 6e22 3e3c 2f61 3e0a 0a54 6865 2060 6765  n"></a>..The `ge
+000110a0: 745f 636f 6d6d 6974 5f70 6f73 6974 696f  t_commit_positio
+000110b0: 6e28 2960 206d 6574 686f 6420 6361 6e20  n()` method can 
+000110c0: 6265 2075 7365 6420 746f 2067 6574 2074  be used to get t
+000110d0: 6865 2063 6f6d 6d69 7420 706f 7369 7469  he commit positi
+000110e0: 6f6e 206f 6620 7468 650a 6c61 7374 2072  on of the.last r
+000110f0: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
+00011100: 2074 6865 2064 6174 6162 6173 652e 2049   the database. I
+00011110: 7420 7369 6d70 6c79 2063 616c 6c73 2060  t simply calls `
+00011120: 7265 6164 5f61 6c6c 2829 6020 7769 7468  read_all()` with
+00011130: 0a60 6261 636b 7761 7264 733d 5472 7565  .`backwards=True
+00011140: 6020 616e 6420 606c 696d 6974 3d31 602c  ` and `limit=1`,
+00011150: 2061 6e64 2072 6574 7572 6e73 2074 6865   and returns the
+00011160: 2076 616c 7565 206f 6620 7468 6520 6063   value of the `c
+00011170: 6f6d 6d69 745f 706f 7369 7469 6f6e 600a  ommit_position`.
+00011180: 6174 7472 6962 7574 6520 6f66 2074 6865  attribute of the
+00011190: 206c 6173 7420 7265 636f 7264 6564 2065   last recorded e
+000111a0: 7665 6e74 2e0a 0a60 6060 7079 7468 6f6e  vent...```python
+000111b0: 0a63 6f6d 6d69 745f 706f 7369 7469 6f6e  .commit_position
+000111c0: 203d 2063 6c69 656e 742e 6765 745f 636f   = client.get_co
+000111d0: 6d6d 6974 5f70 6f73 6974 696f 6e28 290a  mmit_position().
+000111e0: 6060 600a 0a54 6869 7320 6d65 7468 6f64  ```..This method
+000111f0: 2068 6173 2066 6976 6520 6f70 7469 6f6e   has five option
+00011200: 616c 2061 7267 756d 656e 7473 2c20 6066  al arguments, `f
+00011210: 696c 7465 725f 6578 636c 7564 6560 2c20  ilter_exclude`, 
+00011220: 6066 696c 7465 725f 696e 636c 7564 6560  `filter_include`
+00011230: 2c0a 6066 696c 7465 725f 6279 5f73 7472  ,.`filter_by_str
+00011240: 6561 6d5f 6e61 6d65 602c 2060 7469 6d65  eam_name`, `time
+00011250: 6f75 7460 2061 6e64 2060 6372 6564 656e  out` and `creden
+00011260: 7469 616c 7360 2e20 5468 6573 6520 7661  tials`. These va
+00011270: 6c75 6573 2061 7265 2070 6173 7365 6420  lues are passed 
+00011280: 746f 0a60 7265 6164 5f61 6c6c 2829 602e  to.`read_all()`.
+00011290: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+000112a0: 6669 6c74 6572 5f65 7863 6c75 6465 602c  filter_exclude`,
+000112b0: 2060 6669 6c74 6572 5f69 6e63 6c75 6465   `filter_include
+000112c0: 6020 616e 6420 6066 696c 7465 725f 6279  ` and `filter_by
+000112d0: 5f73 7472 6561 6d5f 6e61 6d65 6020 6172  _stream_name` ar
+000112e0: 6775 6d65 6e74 730a 776f 726b 2069 6e20  guments.work in 
+000112f0: 7468 6520 7361 6d65 2077 6179 2061 7320  the same way as 
+00011300: 7468 6579 2064 6f20 696e 2074 6865 2060  they do in the `
+00011310: 7265 6164 5f61 6c6c 2829 6020 6d65 7468  read_all()` meth
+00011320: 6f64 2e0a 0a54 6865 206f 7074 696f 6e61  od...The optiona
+00011330: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+00011340: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00011350: 2060 666c 6f61 7460 2077 6869 6368 2073   `float` which s
+00011360: 6574 7320 610a 6d61 7869 6d75 6d20 6475  ets a.maximum du
+00011370: 7261 7469 6f6e 2c20 696e 2073 6563 6f6e  ration, in secon
+00011380: 6473 2c20 666f 7220 7468 6520 636f 6d70  ds, for the comp
+00011390: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+000113a0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+000113b0: 6865 206f 7074 696f 6e61 6c20 6063 7265  he optional `cre
+000113c0: 6465 6e74 6961 6c73 6020 6172 6775 6d65  dentials` argume
+000113d0: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+000113e0: 6f20 6f76 6572 7269 6465 2063 616c 6c20  o override call 
+000113f0: 6372 6564 656e 7469 616c 730a 6465 7269  credentials.deri
+00011400: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
+00011410: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
+00011420: 5249 2e0a 0a54 6869 7320 6d65 7468 6f64  RI...This method
+00011430: 206d 6967 6874 2062 6520 7573 6564 2074   might be used t
+00011440: 6f20 6d65 6173 7572 6520 7072 6f67 7265  o measure progre
+00011450: 7373 206f 6620 6120 646f 776e 7374 7265  ss of a downstre
+00011460: 616d 2063 6f6d 706f 6e65 6e74 0a74 6861  am component.tha
+00011470: 7420 6973 2070 726f 6365 7373 696e 6720  t is processing 
+00011480: 616c 6c20 7265 636f 7264 6564 2065 7665  all recorded eve
+00011490: 6e74 732c 2062 7920 636f 6d70 6172 696e  nts, by comparin
+000114a0: 6720 7468 6520 6375 7272 656e 7420 636f  g the current co
+000114b0: 6d6d 6974 0a70 6f73 6974 696f 6e20 7769  mmit.position wi
+000114c0: 7468 2074 6865 2072 6563 6f72 6465 6420  th the recorded 
+000114d0: 636f 6d6d 6974 2070 6f73 6974 696f 6e20  commit position 
+000114e0: 6f66 2074 6865 206c 6173 7420 7375 6363  of the last succ
+000114f0: 6573 7366 756c 6c79 2070 726f 6365 7373  essfully process
+00011500: 6564 0a65 7665 6e74 2069 6e20 6120 646f  ed.event in a do
+00011510: 776e 7374 7265 616d 2063 6f6d 706f 6e65  wnstream compone
+00011520: 6e74 2e20 496e 2074 6869 7320 6361 7365  nt. In this case
+00011530: 2c20 7468 6520 7661 6c75 6520 6f66 2074  , the value of t
+00011540: 6865 2060 6669 6c74 6572 5f65 7863 6c75  he `filter_exclu
+00011550: 6465 602c 0a60 6669 6c74 6572 5f69 6e63  de`,.`filter_inc
+00011560: 6c75 6465 6020 616e 6420 6066 696c 7465  lude` and `filte
+00011570: 725f 6279 5f73 7472 6561 6d5f 6e61 6d65  r_by_stream_name
+00011580: 6020 6172 6775 6d65 6e74 7320 7368 6f75  ` arguments shou
+00011590: 6c64 2065 7175 616c 2074 686f 7365 2075  ld equal those u
+000115a0: 7365 640a 6279 2074 6865 2064 6f77 6e73  sed.by the downs
+000115b0: 7472 6561 6d20 636f 6d70 6f6e 656e 7420  tream component 
+000115c0: 746f 206f 6274 6169 6e20 7265 636f 7264  to obtain record
+000115d0: 6564 2065 7665 6e74 732e 0a0a 0a23 2323  ed events....###
+000115e0: 2047 6574 2073 7472 6561 6d20 6d65 7461   Get stream meta
+000115f0: 6461 7461 3c61 2069 643d 2267 6574 2d73  data<a id="get-s
+00011600: 7472 6561 6d2d 6d65 7461 6461 7461 223e  tream-metadata">
+00011610: 3c2f 613e 0a0a 5468 6520 6067 6574 5f73  </a>..The `get_s
+00011620: 7472 6561 6d5f 6d65 7461 6461 7461 2829  tream_metadata()
+00011630: 6020 6d65 7468 6f64 2072 6574 7572 6e73  ` method returns
+00011640: 2074 6865 206d 6574 6164 6174 6120 666f   the metadata fo
+00011650: 7220 6120 7374 7265 616d 2c20 616c 6f6e  r a stream, alon
+00011660: 670a 7769 7468 2074 6865 2076 6572 7369  g.with the versi
+00011670: 6f6e 206f 6620 7468 6520 7374 7265 616d  on of the stream
+00011680: 206d 6574 6164 6174 612e 0a0a 5468 6973   metadata...This
+00011690: 206d 6574 686f 6420 6861 7320 6f6e 6520   method has one 
+000116a0: 7265 7175 6972 6564 2061 7267 756d 656e  required argumen
+000116b0: 742c 2060 7374 7265 616d 5f6e 616d 6560  t, `stream_name`
+000116c0: 2c20 7768 6963 6820 6973 2061 2050 7974  , which is a Pyt
+000116d0: 686f 6e20 6073 7472 6020 7468 6174 0a75  hon `str` that.u
+000116e0: 6e69 7175 656c 7920 6964 656e 7469 6669  niquely identifi
+000116f0: 6573 2061 2073 7472 6561 6d20 666f 7220  es a stream for 
+00011700: 7768 6963 6820 6120 7374 7265 616d 206d  which a stream m
+00011710: 6574 6164 6174 6120 7769 6c6c 2062 6520  etadata will be 
+00011720: 6f62 7461 696e 6564 2e0a 0a54 6869 7320  obtained...This 
+00011730: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
+00011740: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00011750: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+00011760: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+00011770: 6f61 7460 0a74 6861 7420 7365 7473 2061  oat`.that sets a
+00011780: 206d 6178 696d 756d 2064 7572 6174 696f   maximum duratio
+00011790: 6e2c 2069 6e20 7365 636f 6e64 732c 2066  n, in seconds, f
+000117a0: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
+000117b0: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
+000117c0: 6572 6174 696f 6e2e 0a0a 5468 6973 206d  eration...This m
+000117d0: 6574 686f 6420 6861 7320 616e 206f 7074  ethod has an opt
+000117e0: 696f 6e61 6c20 6063 7265 6465 6e74 6961  ional `credentia
+000117f0: 6c73 6020 6172 6775 6d65 6e74 2c20 7768  ls` argument, wh
+00011800: 6963 6820 6361 6e20 6265 2075 7365 6420  ich can be used 
+00011810: 746f 0a6f 7665 7272 6964 6520 6361 6c6c  to.override call
+00011820: 2063 7265 6465 6e74 6961 6c73 2064 6572   credentials der
+00011830: 6976 6564 2066 726f 6d20 7468 6520 636f  ived from the co
+00011840: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+00011850: 5552 492e 0a0a 496e 2074 6865 2065 7861  URI...In the exa
+00011860: 6d70 6c65 2062 656c 6f77 2c20 6d65 7461  mple below, meta
+00011870: 6461 7461 2066 6f72 2060 7374 7265 616d  data for `stream
+00011880: 5f6e 616d 6531 6020 6973 206f 6274 6169  _name1` is obtai
+00011890: 6e65 642e 0a0a 6060 6070 7974 686f 6e0a  ned...```python.
+000118a0: 6d65 7461 6461 7461 2c20 6d65 7461 6461  metadata, metada
+000118b0: 7461 5f76 6572 7369 6f6e 203d 2063 6c69  ta_version = cli
+000118c0: 656e 742e 6765 745f 7374 7265 616d 5f6d  ent.get_stream_m
+000118d0: 6574 6164 6174 6128 7374 7265 616d 5f6e  etadata(stream_n
+000118e0: 616d 653d 7374 7265 616d 5f6e 616d 6531  ame=stream_name1
+000118f0: 290a 6060 600a 0a54 6865 2072 6574 7572  ).```..The retur
+00011900: 6e65 6420 606d 6574 6164 6174 6160 2076  ned `metadata` v
+00011910: 616c 7565 2069 7320 6120 5079 7468 6f6e  alue is a Python
+00011920: 2060 6469 6374 602e 2054 6865 2072 6574   `dict`. The ret
+00011930: 7572 6e65 6420 606d 6574 6164 6174 615f  urned `metadata_
+00011940: 7665 7273 696f 6e60 0a76 616c 7565 2069  version`.value i
+00011950: 7320 6569 7468 6572 2061 6e20 6069 6e74  s either an `int
+00011960: 6020 6966 2074 6865 2073 7472 6561 6d20  ` if the stream 
+00011970: 6578 6973 7473 2c20 6f72 2060 5374 7265  exists, or `Stre
+00011980: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
+00011990: 4d60 2069 6620 7468 6520 7374 7265 616d  M` if the stream
+000119a0: 0a64 6f65 7320 6e6f 7420 6578 6973 7420  .does not exist 
+000119b0: 616e 6420 6e6f 206d 6574 6164 6174 6120  and no metadata 
+000119c0: 6861 7320 6265 656e 2073 6574 2e20 5468  has been set. Th
+000119d0: 6573 6520 7661 6c75 6573 2063 616e 2062  ese values can b
+000119e0: 6520 7573 6564 2061 7320 7468 6520 6172  e used as the ar
+000119f0: 6775 6d65 6e74 730a 6f66 2060 7365 745f  guments.of `set_
+00011a00: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
+00011a10: 2960 2e0a 0a23 2323 2053 6574 2073 7472  )`...### Set str
+00011a20: 6561 6d20 6d65 7461 6461 7461 3c61 2069  eam metadata<a i
+00011a30: 643d 2273 6574 2d73 7472 6561 6d2d 6d65  d="set-stream-me
+00011a40: 7461 6461 7461 223e 3c2f 613e 0a0a 2a72  tadata"></a>..*r
+00011a50: 6571 7569 7265 7320 6c65 6164 6572 2a0a  equires leader*.
+00011a60: 0a54 6865 206d 6574 686f 6420 6073 6574  .The method `set
+00011a70: 5f73 7472 6561 6d5f 6d65 7461 6461 7461  _stream_metadata
+00011a80: 2829 6020 7365 7473 206d 6574 6164 6174  ()` sets metadat
+00011a90: 6120 666f 7220 6120 7374 7265 616d 2e20  a for a stream. 
+00011aa0: 5374 7265 616d 206d 6574 6164 6174 610a  Stream metadata.
+00011ab0: 6361 6e20 6265 2073 6574 2062 6566 6f72  can be set befor
+00011ac0: 6520 6170 7065 6e64 696e 6720 6576 656e  e appending even
+00011ad0: 7473 2074 6f20 6120 7374 7265 616d 2e0a  ts to a stream..
+00011ae0: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+00011af0: 206f 6e65 2072 6571 7569 7265 6420 6172   one required ar
+00011b00: 6775 6d65 6e74 2c20 6073 7472 6561 6d5f  gument, `stream_
+00011b10: 6e61 6d65 602c 2077 6869 6368 2069 7320  name`, which is 
+00011b20: 6120 5079 7468 6f6e 2060 7374 7260 2074  a Python `str` t
+00011b30: 6861 740a 756e 6971 7565 6c79 2069 6465  hat.uniquely ide
+00011b40: 6e74 6966 6965 7320 6120 7374 7265 616d  ntifies a stream
+00011b50: 2066 6f72 2077 6869 6368 2061 2073 7472   for which a str
+00011b60: 6561 6d20 6d65 7461 6461 7461 2077 696c  eam metadata wil
+00011b70: 6c20 6265 2073 6574 2e0a 0a54 6869 7320  l be set...This 
+00011b80: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
+00011b90: 7469 6f6e 616c 2060 7469 6d65 6f75 7460  tional `timeout`
+00011ba0: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+00011bb0: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+00011bc0: 6f61 7460 0a74 6861 7420 7365 7473 2061  oat`.that sets a
+00011bd0: 206d 6178 696d 756d 2064 7572 6174 696f   maximum duratio
+00011be0: 6e2c 2069 6e20 7365 636f 6e64 732c 2066  n, in seconds, f
+00011bf0: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
+00011c00: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
+00011c10: 6572 6174 696f 6e2e 0a0a 5468 6973 206d  eration...This m
+00011c20: 6574 686f 6420 6861 7320 616e 206f 7074  ethod has an opt
+00011c30: 696f 6e61 6c20 6063 7265 6465 6e74 6961  ional `credentia
+00011c40: 6c73 6020 6172 6775 6d65 6e74 2c20 7768  ls` argument, wh
+00011c50: 6963 6820 6361 6e20 6265 2075 7365 6420  ich can be used 
+00011c60: 746f 0a6f 7665 7272 6964 6520 6361 6c6c  to.override call
+00011c70: 2063 7265 6465 6e74 6961 6c73 2064 6572   credentials der
+00011c80: 6976 6564 2066 726f 6d20 7468 6520 636f  ived from the co
+00011c90: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+00011ca0: 5552 492e 0a0a 496e 2074 6865 2065 7861  URI...In the exa
+00011cb0: 6d70 6c65 2062 656c 6f77 2c20 6d65 7461  mple below, meta
+00011cc0: 6461 7461 2066 6f72 2060 7374 7265 616d  data for `stream
+00011cd0: 5f6e 616d 6531 6020 6973 2073 6574 2e0a  _name1` is set..
+00011ce0: 0a0a 6060 6070 7974 686f 6e0a 6d65 7461  ..```python.meta
+00011cf0: 6461 7461 5b22 666f 6f22 5d20 3d20 2262  data["foo"] = "b
+00011d00: 6172 220a 0a63 6c69 656e 742e 7365 745f  ar"..client.set_
+00011d10: 7374 7265 616d 5f6d 6574 6164 6174 6128  stream_metadata(
+00011d20: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+00011d30: 3d73 7472 6561 6d5f 6e61 6d65 312c 0a20  =stream_name1,. 
+00011d40: 2020 206d 6574 6164 6174 613d 6d65 7461     metadata=meta
+00011d50: 6461 7461 2c0a 2020 2020 6375 7272 656e  data,.    curren
+00011d60: 745f 7665 7273 696f 6e3d 6d65 7461 6461  t_version=metada
+00011d70: 7461 5f76 6572 7369 6f6e 2c0a 290a 6060  ta_version,.).``
+00011d80: 600a 0a54 6865 2060 6375 7272 656e 745f  `..The `current_
+00011d90: 7665 7273 696f 6e60 2061 7267 756d 656e  version` argumen
+00011da0: 7420 7368 6f75 6c64 2062 6520 7468 6520  t should be the 
+00011db0: 6375 7272 656e 7420 7665 7273 696f 6e20  current version 
+00011dc0: 6f66 2074 6865 2073 7472 6561 6d20 6d65  of the stream me
+00011dd0: 7461 6461 7461 0a6f 6274 6169 6e65 6420  tadata.obtained 
+00011de0: 6672 6f6d 2060 6765 745f 7374 7265 616d  from `get_stream
+00011df0: 5f6d 6574 6164 6174 6128 2960 2e0a 0a50  _metadata()`...P
+00011e00: 6c65 6173 6520 7265 6665 7220 746f 2074  lease refer to t
+00011e10: 6865 2045 7665 6e74 5374 6f72 6544 4220  he EventStoreDB 
+00011e20: 646f 6375 6d65 6e74 6174 696f 6e20 666f  documentation fo
+00011e30: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
+00011e40: 6f6e 2061 626f 7574 2073 7472 6561 6d0a  on about stream.
+00011e50: 6d65 7461 6461 7461 2e0a 0a23 2323 2044  metadata...### D
+00011e60: 656c 6574 6520 7374 7265 616d 3c61 2069  elete stream<a i
+00011e70: 643d 2264 656c 6574 652d 7374 7265 616d  d="delete-stream
+00011e80: 223e 3c2f 613e 0a0a 2a72 6571 7569 7265  "></a>..*require
+00011e90: 7320 6c65 6164 6572 2a0a 0a54 6865 206d  s leader*..The m
+00011ea0: 6574 686f 6420 6064 656c 6574 655f 7374  ethod `delete_st
+00011eb0: 7265 616d 2829 6020 6361 6e20 6265 2075  ream()` can be u
+00011ec0: 7365 6420 746f 2022 6465 6c65 7465 2220  sed to "delete" 
+00011ed0: 6120 7374 7265 616d 2e0a 0a54 6869 7320  a stream...This 
+00011ee0: 6d65 7468 6f64 2068 6173 2074 776f 2072  method has two r
+00011ef0: 6571 7569 7265 6420 6172 6775 6d65 6e74  equired argument
+00011f00: 732c 2060 7374 7265 616d 5f6e 616d 6560  s, `stream_name`
+00011f10: 2061 6e64 2060 6375 7272 656e 745f 7665   and `current_ve
+00011f20: 7273 696f 6e60 2e0a 0a54 6865 2072 6571  rsion`...The req
+00011f30: 7569 7265 6420 6073 7472 6561 6d5f 6e61  uired `stream_na
+00011f40: 6d65 6020 6172 6775 6d65 6e74 2069 7320  me` argument is 
+00011f50: 6120 5079 7468 6f6e 2060 7374 7260 2074  a Python `str` t
+00011f60: 6861 7420 756e 6971 7565 6c79 2069 6465  hat uniquely ide
+00011f70: 6e74 6966 6965 7320 610a 7374 7265 616d  ntifies a.stream
+00011f80: 2074 6f20 7768 6963 6820 6120 7365 7175   to which a sequ
+00011f90: 656e 6365 206f 6620 6576 656e 7473 2077  ence of events w
+00011fa0: 696c 6c20 6265 2061 7070 656e 6465 642e  ill be appended.
+00011fb0: 0a0a 5468 6520 7265 7175 6972 6564 2060  ..The required `
+00011fc0: 6375 7272 656e 745f 7665 7273 696f 6e60  current_version`
+00011fd0: 2061 7267 756d 656e 7420 6973 2065 7870   argument is exp
+00011fe0: 6563 7465 6420 746f 2062 6520 6569 7468  ected to be eith
+00011ff0: 6572 2061 2050 7974 686f 6e20 6069 6e74  er a Python `int
+00012000: 600a 7468 6174 2069 6e64 6963 6174 6573  `.that indicates
+00012010: 2074 6865 2073 7472 6561 6d20 706f 7369   the stream posi
+00012020: 7469 6f6e 206f 6620 7468 6520 6c61 7374  tion of the last
+00012030: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+00012040: 696e 2074 6865 2073 7472 6561 6d2e 0a0a  in the stream...
+00012050: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+00012060: 616e 206f 7074 696f 6e61 6c20 6074 696d  an optional `tim
+00012070: 656f 7574 6020 6172 6775 6d65 6e74 2c20  eout` argument, 
+00012080: 7768 6963 6820 6973 2061 2050 7974 686f  which is a Pytho
+00012090: 6e20 6066 6c6f 6174 600a 7468 6174 2073  n `float`.that s
+000120a0: 6574 7320 6120 6d61 7869 6d75 6d20 6475  ets a maximum du
+000120b0: 7261 7469 6f6e 2c20 696e 2073 6563 6f6e  ration, in secon
+000120c0: 6473 2c20 666f 7220 7468 6520 636f 6d70  ds, for the comp
+000120d0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+000120e0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+000120f0: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
+00012100: 6e20 6f70 7469 6f6e 616c 2060 6372 6564  n optional `cred
+00012110: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
+00012120: 742c 2077 6869 6368 2063 616e 2062 6520  t, which can be 
+00012130: 7573 6564 2074 6f0a 6f76 6572 7269 6465  used to.override
+00012140: 2063 616c 6c20 6372 6564 656e 7469 616c   call credential
+00012150: 7320 6465 7269 7665 6420 6672 6f6d 2074  s derived from t
+00012160: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
+00012170: 7269 6e67 2055 5249 2e0a 0a49 6e20 7468  ring URI...In th
+00012180: 6520 6578 616d 706c 6520 6265 6c6f 772c  e example below,
+00012190: 2060 7374 7265 616d 5f6e 616d 6531 6020   `stream_name1` 
+000121a0: 6973 2064 656c 6574 6564 2e0a 0a60 6060  is deleted...```
+000121b0: 7079 7468 6f6e 0a63 6f6d 6d69 745f 706f  python.commit_po
+000121c0: 7369 7469 6f6e 203d 2063 6c69 656e 742e  sition = client.
+000121d0: 6465 6c65 7465 5f73 7472 6561 6d28 7374  delete_stream(st
+000121e0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+000121f0: 5f6e 616d 6531 2c20 6375 7272 656e 745f  _name1, current_
+00012200: 7665 7273 696f 6e3d 3229 0a60 6060 0a0a  version=2).```..
+00012210: 4166 7465 7220 6465 6c65 7469 6e67 2061  After deleting a
+00012220: 2073 7472 6561 6d2c 2069 7427 7320 7374   stream, it's st
+00012230: 696c 6c20 706f 7373 6962 6c65 2074 6f20  ill possible to 
+00012240: 6170 7065 6e64 206e 6577 2065 7665 6e74  append new event
+00012250: 732e 2052 6561 6469 6e67 2066 726f 6d20  s. Reading from 
+00012260: 610a 6465 6c65 7465 6420 7374 7265 616d  a.deleted stream
+00012270: 2077 696c 6c20 7265 7475 726e 206f 6e6c   will return onl
+00012280: 7920 6576 656e 7473 2074 6861 7420 6861  y events that ha
+00012290: 7665 2062 6565 6e20 6170 7065 6e64 6564  ve been appended
+000122a0: 2061 6674 6572 2069 7420 7761 730a 6465   after it was.de
+000122b0: 6c65 7465 642e 0a0a 2323 2320 546f 6d62  leted...### Tomb
+000122c0: 7374 6f6e 6520 7374 7265 616d 3c61 2069  stone stream<a i
+000122d0: 643d 2274 6f6d 6273 746f 6e65 2d73 7472  d="tombstone-str
+000122e0: 6561 6d22 3e3c 2f61 3e0a 0a2a 7265 7175  eam"></a>..*requ
+000122f0: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
+00012300: 6520 6d65 7468 6f64 2060 746f 6d62 7374  e method `tombst
+00012310: 6f6e 655f 7374 7265 616d 2829 6020 6361  one_stream()` ca
+00012320: 6e20 6265 2075 7365 6420 746f 2022 746f  n be used to "to
+00012330: 6d62 7374 6f6e 6522 2061 2073 7472 6561  mbstone" a strea
+00012340: 6d2e 0a0a 5468 6973 206d 6574 686f 6420  m...This method 
+00012350: 6861 7320 7477 6f20 7265 7175 6972 6564  has two required
+00012360: 2061 7267 756d 656e 7473 2c20 6073 7472   arguments, `str
+00012370: 6561 6d5f 6e61 6d65 6020 616e 6420 6063  eam_name` and `c
+00012380: 7572 7265 6e74 5f76 6572 7369 6f6e 602e  urrent_version`.
+00012390: 0a0a 5468 6520 7265 7175 6972 6564 2060  ..The required `
+000123a0: 7374 7265 616d 5f6e 616d 6560 2061 7267  stream_name` arg
+000123b0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+000123c0: 6e20 6073 7472 6020 7468 6174 2075 6e69  n `str` that uni
+000123d0: 7175 656c 7920 6964 656e 7469 6669 6573  quely identifies
+000123e0: 2061 0a73 7472 6561 6d20 746f 2077 6869   a.stream to whi
+000123f0: 6368 2061 2073 6571 7565 6e63 6520 6f66  ch a sequence of
+00012400: 2065 7665 6e74 7320 7769 6c6c 2062 6520   events will be 
+00012410: 6170 7065 6e64 6564 2e0a 0a54 6865 2072  appended...The r
+00012420: 6571 7569 7265 6420 6063 7572 7265 6e74  equired `current
+00012430: 5f76 6572 7369 6f6e 6020 6172 6775 6d65  _version` argume
+00012440: 6e74 2069 7320 6578 7065 6374 6564 2074  nt is expected t
+00012450: 6f20 6265 2065 6974 6865 7220 6120 5079  o be either a Py
+00012460: 7468 6f6e 2060 696e 7460 0a74 6861 7420  thon `int`.that 
+00012470: 696e 6469 6361 7465 7320 7468 6520 7374  indicates the st
+00012480: 7265 616d 2070 6f73 6974 696f 6e20 6f66  ream position of
+00012490: 2074 6865 206c 6173 7420 7265 636f 7264   the last record
+000124a0: 6564 2065 7665 6e74 2069 6e20 7468 6520  ed event in the 
+000124b0: 7374 7265 616d 2e0a 0a54 6869 7320 6d65  stream...This me
+000124c0: 7468 6f64 2068 6173 2061 6e20 6f70 7469  thod has an opti
+000124d0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+000124e0: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
+000124f0: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+00012500: 7460 0a74 6861 7420 7365 7473 2061 206d  t`.that sets a m
+00012510: 6178 696d 756d 2064 7572 6174 696f 6e2c  aximum duration,
+00012520: 2069 6e20 7365 636f 6e64 732c 2066 6f72   in seconds, for
+00012530: 2074 6865 2063 6f6d 706c 6574 696f 6e20   the completion 
+00012540: 6f66 2074 6865 2067 5250 4320 6f70 6572  of the gRPC oper
+00012550: 6174 696f 6e2e 0a0a 5468 6973 206d 6574  ation...This met
+00012560: 686f 6420 6861 7320 616e 206f 7074 696f  hod has an optio
+00012570: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
+00012580: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+00012590: 6820 6361 6e20 6265 2075 7365 6420 746f  h can be used to
+000125a0: 0a6f 7665 7272 6964 6520 6361 6c6c 2063  .override call c
+000125b0: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
+000125c0: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
+000125d0: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
+000125e0: 492e 0a0a 496e 2074 6865 2065 7861 6d70  I...In the examp
+000125f0: 6c65 2062 656c 6f77 2c20 6073 7472 6561  le below, `strea
+00012600: 6d5f 6e61 6d65 3160 2069 7320 746f 6d62  m_name1` is tomb
+00012610: 7374 6f6e 6564 2e0a 0a60 6060 7079 7468  stoned...```pyth
+00012620: 6f6e 0a63 6f6d 6d69 745f 706f 7369 7469  on.commit_positi
+00012630: 6f6e 203d 2063 6c69 656e 742e 746f 6d62  on = client.tomb
+00012640: 7374 6f6e 655f 7374 7265 616d 2873 7472  stone_stream(str
+00012650: 6561 6d5f 6e61 6d65 3d73 7472 6561 6d5f  eam_name=stream_
+00012660: 6e61 6d65 312c 2063 7572 7265 6e74 5f76  name1, current_v
+00012670: 6572 7369 6f6e 3d32 290a 6060 600a 0a41  ersion=2).```..A
+00012680: 6674 6572 2074 6f6d 6273 746f 6e69 6e67  fter tombstoning
+00012690: 2061 2073 7472 6561 6d2c 2069 7427 7320   a stream, it's 
+000126a0: 6e6f 7420 706f 7373 6962 6c65 2074 6f20  not possible to 
+000126b0: 6170 7065 6e64 206e 6577 2065 7665 6e74  append new event
+000126c0: 732e 0a0a 0a23 2320 4361 7463 682d 7570  s....## Catch-up
+000126d0: 2073 7562 7363 7269 7074 696f 6e73 3c61   subscriptions<a
+000126e0: 2069 643d 2263 6174 6368 2d75 702d 7375   id="catch-up-su
+000126f0: 6273 6372 6970 7469 6f6e 7322 3e3c 2f61  bscriptions"></a
+00012700: 3e0a 0a41 2022 6361 7463 682d 7570 2220  >..A "catch-up" 
+00012710: 7375 6273 6372 6970 7469 6f6e 2063 616e  subscription can
+00012720: 2062 6520 7573 6564 2074 6f20 7265 6365   be used to rece
+00012730: 6976 6520 6576 656e 7473 2074 6861 7420  ive events that 
+00012740: 6861 7665 2061 6c72 6561 6479 2062 6565  have already bee
+00012750: 6e0a 7265 636f 7264 6564 2061 6e64 2065  n.recorded and e
+00012760: 7665 6e74 7320 7468 6174 2061 7265 2072  vents that are r
+00012770: 6563 6f72 6465 6420 7375 6273 6571 7565  ecorded subseque
+00012780: 6e74 6c79 2e20 4120 6361 7463 682d 7570  ntly. A catch-up
+00012790: 2073 7562 7363 7269 7074 696f 6e20 6361   subscription ca
+000127a0: 6e0a 6265 2075 7365 6420 6279 2061 6e20  n.be used by an 
+000127b0: 6576 656e 742d 7072 6f63 6573 7369 6e67  event-processing
+000127c0: 2063 6f6d 706f 6e65 6e74 2074 6861 7420   component that 
+000127d0: 7072 6f63 6573 7365 7320 7265 636f 7264  processes record
+000127e0: 6564 2065 7665 6e74 7320 7769 7468 0a22  ed events with."
+000127f0: 6578 6163 746c 792d 6f6e 6365 2220 7365  exactly-once" se
+00012800: 6d61 6e74 6963 732e 0a0a 5468 6520 6073  mantics...The `s
+00012810: 7562 7363 7269 6265 5f74 6f5f 616c 6c28  ubscribe_to_all(
+00012820: 2960 206d 6574 686f 6420 7374 6172 7473  )` method starts
+00012830: 2061 2063 6174 6368 2d75 7020 7375 6273   a catch-up subs
+00012840: 6372 6970 7469 6f6e 2074 6861 7420 6361  cription that ca
+00012850: 6e20 7265 6365 6976 650a 616c 6c20 6576  n receive.all ev
+00012860: 656e 7473 2069 6e20 7468 6520 6461 7461  ents in the data
+00012870: 6261 7365 2e20 5468 6520 6073 7562 7363  base. The `subsc
+00012880: 7269 6265 5f74 6f5f 7374 7265 616d 2829  ribe_to_stream()
+00012890: 6020 6d65 7468 6f64 2073 7461 7274 7320  ` method starts 
+000128a0: 6120 6361 7463 682d 7570 0a73 7562 7363  a catch-up.subsc
+000128b0: 7269 7074 696f 6e20 7468 6174 2063 616e  ription that can
+000128c0: 2072 6563 6569 7665 2065 7665 6e74 7320   receive events 
+000128d0: 6672 6f6d 2061 2073 7065 6369 6669 6320  from a specific 
+000128e0: 7374 7265 616d 2e20 426f 7468 206d 6574  stream. Both met
+000128f0: 686f 6473 2072 6574 7572 6e20 610a 2263  hods return a."c
+00012900: 6174 6368 2d75 7020 7375 6273 6372 6970  atch-up subscrip
+00012910: 7469 6f6e 2220 6f62 6a65 6374 2c20 7768  tion" object, wh
+00012920: 6963 6820 6973 2061 2050 7974 686f 6e20  ich is a Python 
+00012930: 6974 6572 6174 6f72 2e20 5265 636f 7264  iterator. Record
+00012940: 6564 2065 7665 6e74 7320 6361 6e20 6265  ed events can be
+00012950: 0a6f 6274 6169 6e65 6420 6279 2069 7465  .obtained by ite
+00012960: 7261 7469 6f6e 2e20 5265 636f 7264 6564  ration. Recorded
+00012970: 2065 7665 6e74 206f 626a 6563 7473 206f   event objects o
+00012980: 6274 6169 6e65 6420 696e 2074 6869 7320  btained in this 
+00012990: 7761 7920 6172 6520 696e 7374 616e 6365  way are instance
+000129a0: 730a 6f66 2074 6865 2060 5265 636f 7264  s.of the `Record
+000129b0: 6564 4576 656e 7460 2063 6c61 7373 2e0a  edEvent` class..
+000129c0: 0a42 6566 6f72 6520 7468 6520 2263 6174  .Before the "cat
+000129d0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+000129e0: 6f6e 2220 6f62 6a65 6374 2069 7320 7265  on" object is re
+000129f0: 7475 726e 6564 2074 6f20 7468 6520 6361  turned to the ca
+00012a00: 6c6c 6572 2c20 7468 6520 636c 6965 6e74  ller, the client
+00012a10: 2077 696c 6c0a 6669 7273 746c 7920 6f62   will.firstly ob
+00012a20: 7461 696e 2061 2022 636f 6e66 6972 6d61  tain a "confirma
+00012a30: 7469 6f6e 2220 7265 7370 6f6e 7365 2066  tion" response f
+00012a40: 726f 6d20 7468 6520 7365 7276 6572 2c20  rom the server, 
+00012a50: 7768 6963 6820 616c 6c6f 7773 2074 6865  which allows the
+00012a60: 2063 6c69 656e 7420 746f 0a64 6574 6563   client to.detec
+00012a70: 7420 7468 6174 2062 6f74 6820 7468 6520  t that both the 
+00012a80: 6752 5043 2063 6f6e 6e65 6374 696f 6e20  gRPC connection 
+00012a90: 616e 6420 7468 6520 7374 7265 616d 696e  and the streamin
+00012aa0: 6720 6752 5043 2063 616c 6c20 6973 206f  g gRPC call is o
+00012ab0: 7065 7261 7469 6f6e 616c 2e20 466f 720a  perational. For.
+00012ac0: 7468 6973 2072 6561 736f 6e2c 2074 6865  this reason, the
+00012ad0: 2060 7375 6273 6372 6962 655f 746f 5f61   `subscribe_to_a
+00012ae0: 6c6c 2829 6020 616e 6420 6073 7562 7363  ll()` and `subsc
+00012af0: 7269 6265 5f74 6f5f 7374 7265 616d 2829  ribe_to_stream()
+00012b00: 6020 6d65 7468 6f64 7320 6172 6520 626f  ` methods are bo
+00012b10: 7468 0a75 7365 6675 6c6c 7920 6465 636f  th.usefully deco
+00012b20: 7261 7465 6420 7769 7468 2074 6865 2072  rated with the r
+00012b30: 6563 6f6e 6e65 6374 2061 6e64 2072 6574  econnect and ret
+00012b40: 7279 2064 6563 6f72 6174 6f72 732e 2048  ry decorators. H
+00012b50: 6f77 6576 6572 2c20 6f6e 6365 2074 6865  owever, once the
+00012b60: 206d 6574 686f 640a 6861 7320 7265 7475   method.has retu
+00012b70: 726e 6564 2c20 7468 6520 6465 636f 7261  rned, the decora
+00012b80: 746f 7273 2077 696c 6c20 6861 7665 2065  tors will have e
+00012b90: 7869 7465 642c 2061 6e64 2061 6e79 2065  xited, and any e
+00012ba0: 7863 6570 7469 6f6e 7320 7468 6174 2061  xceptions that a
+00012bb0: 7265 2072 6169 7365 640a 6475 6520 746f  re raised.due to
+00012bc0: 2063 6f6e 6e65 6374 696f 6e20 6973 7375   connection issu
+00012bd0: 6573 2077 6869 6c73 7420 6974 6572 6174  es whilst iterat
+00012be0: 696e 6720 6f76 6572 2074 6865 2073 7562  ing over the sub
+00012bf0: 7363 7269 7074 696f 6e20 6f62 6a65 6374  scription object
+00012c00: 2077 696c 6c20 6861 7665 2074 6f0a 6265   will have to.be
+00012c10: 2068 616e 646c 6564 2062 7920 796f 7572   handled by your
+00012c20: 2063 6f64 652e 0a0a 4120 2263 6174 6368   code...A "catch
+00012c30: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+00012c40: 2220 6974 6572 6174 6f72 2077 696c 6c20  " iterator will 
+00012c50: 6e6f 7420 6175 746f 6d61 7469 6361 6c6c  not automaticall
+00012c60: 7920 7374 6f70 2077 6865 6e20 7468 6572  y stop when ther
+00012c70: 6520 6172 6520 6e6f 206d 6f72 650a 6576  e are no more.ev
+00012c80: 656e 7473 2074 6f20 6265 2072 6574 7572  ents to be retur
+00012c90: 6e65 642c 2062 7574 2069 6e73 7465 6164  ned, but instead
+00012ca0: 2074 6865 2069 7465 7261 7469 6f6e 2077   the iteration w
+00012cb0: 696c 6c20 626c 6f63 6b20 756e 7469 6c20  ill block until 
+00012cc0: 6e65 7720 6576 656e 7473 2061 7265 0a73  new events are.s
+00012cd0: 7562 7365 7175 656e 746c 7920 7265 636f  ubsequently reco
+00012ce0: 7264 6564 2069 6e20 7468 6520 6461 7461  rded in the data
+00012cf0: 6261 7365 2e20 416e 7920 7375 6273 6571  base. Any subseq
+00012d00: 7565 6e74 6c79 2072 6563 6f72 6465 6420  uently recorded 
+00012d10: 6576 656e 7473 2077 696c 6c20 7468 656e  events will then
+00012d20: 2062 650a 696d 6d65 6469 6174 656c 7920   be.immediately 
+00012d30: 7374 7265 616d 6564 2074 6f20 7468 6520  streamed to the 
+00012d40: 636c 6965 6e74 2c20 616e 6420 7468 6520  client, and the 
+00012d50: 6974 6572 6174 696f 6e20 7769 6c6c 2074  iteration will t
+00012d60: 6865 6e20 636f 6e74 696e 7565 2e20 5468  hen continue. Th
+00012d70: 6520 7374 7265 616d 696e 670a 6f66 2065  e streaming.of e
+00012d80: 7665 6e74 732c 2061 6e64 2068 656e 6365  vents, and hence
+00012d90: 2074 6865 2069 7465 7261 7469 6f6e 2c20   the iteration, 
+00012da0: 6361 6e20 6265 2073 746f 7070 6564 2062  can be stopped b
+00012db0: 7920 6361 6c6c 696e 6720 7468 6520 6073  y calling the `s
+00012dc0: 746f 7028 2960 206d 6574 686f 6420 6f6e  top()` method on
+00012dd0: 2074 6865 0a22 6361 7463 682d 7570 2073   the."catch-up s
+00012de0: 7562 7363 7269 7074 696f 6e22 206f 626a  ubscription" obj
+00012df0: 6563 742e 0a0a 2323 2320 5375 6273 6372  ect...### Subscr
+00012e00: 6962 6520 746f 2061 6c6c 2065 7665 6e74  ibe to all event
+00012e10: 733c 6120 6964 3d22 7375 6273 6372 6962  s<a id="subscrib
+00012e20: 652d 746f 2d61 6c6c 2d65 7665 6e74 7322  e-to-all-events"
+00012e30: 3e3c 2f61 3e0a 0a54 6865 6073 7562 7363  ></a>..The`subsc
+00012e40: 7269 6265 5f74 6f5f 616c 6c28 2960 206d  ribe_to_all()` m
+00012e50: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+00012e60: 6420 746f 2073 7461 7274 2061 2063 6174  d to start a cat
+00012e70: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+00012e80: 6f6e 0a66 726f 6d20 7768 6963 6820 616c  on.from which al
+00012e90: 6c20 6576 656e 7473 2072 6563 6f72 6465  l events recorde
+00012ea0: 6420 696e 2074 6865 2064 6174 6162 6173  d in the databas
+00012eb0: 6520 6361 6e20 6265 206f 6274 6169 6e65  e can be obtaine
+00012ec0: 6420 696e 2074 6865 206f 7264 6572 0a74  d in the order.t
+00012ed0: 6865 7920 7765 7265 2072 6563 6f72 6465  hey were recorde
+00012ee0: 642e 2054 6869 7320 6d65 7468 6f64 2072  d. This method r
+00012ef0: 6574 7572 6e73 2061 2022 6361 7463 682d  eturns a "catch-
+00012f00: 7570 2073 7562 7363 7269 7074 696f 6e22  up subscription"
+00012f10: 2069 7465 7261 746f 722e 0a0a 5468 6973   iterator...This
+00012f20: 206d 6574 686f 6420 616c 736f 2068 6173   method also has
+00012f30: 2074 656e 206f 7074 696f 6e61 6c20 6172   ten optional ar
+00012f40: 6775 6d65 6e74 732c 2060 636f 6d6d 6974  guments, `commit
+00012f50: 5f70 6f73 6974 696f 6e60 2c20 6066 726f  _position`, `fro
+00012f60: 6d5f 656e 6460 2c20 6072 6573 6f6c 7665  m_end`, `resolve
+00012f70: 5f6c 696e 6b73 602c 0a60 6669 6c74 6572  _links`,.`filter
+00012f80: 5f65 7863 6c75 6465 602c 2060 6669 6c74  _exclude`, `filt
+00012f90: 6572 5f69 6e63 6c75 6465 602c 2060 6669  er_include`, `fi
+00012fa0: 6c74 6572 5f62 795f 7374 7265 616d 5f6e  lter_by_stream_n
+00012fb0: 616d 6560 2c20 6069 6e63 6c75 6465 5f63  ame`, `include_c
+00012fc0: 6865 636b 706f 696e 7473 602c 0a60 696e  heckpoints`,.`in
+00012fd0: 636c 7564 655f 6361 7567 6874 5f75 7060  clude_caught_up`
+00012fe0: 2c20 6074 696d 656f 7574 6020 616e 6420  , `timeout` and 
+00012ff0: 6063 7265 6465 6e74 6961 6c73 602e 0a0a  `credentials`...
+00013000: 5468 6520 6f70 7469 6f6e 616c 2060 636f  The optional `co
+00013010: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
+00013020: 7267 756d 656e 7420 7370 6563 6966 6965  rgument specifie
+00013030: 7320 6120 636f 6d6d 6974 2070 6f73 6974  s a commit posit
+00013040: 696f 6e2e 2054 6865 2064 6566 6175 6c74  ion. The default
+00013050: 0a76 616c 7565 206f 6620 6063 6f6d 6d69  .value of `commi
+00013060: 745f 706f 7369 7469 6f6e 6020 6973 2060  t_position` is `
+00013070: 4e6f 6e65 602c 2077 6869 6368 206d 6561  None`, which mea
+00013080: 6e73 2074 6865 2063 6174 6368 2d75 7020  ns the catch-up 
+00013090: 7375 6273 6372 6970 7469 6f6e 2077 696c  subscription wil
+000130a0: 6c0a 7374 6172 7420 6672 6f6d 2074 6865  l.start from the
+000130b0: 2066 6972 7374 2072 6563 6f72 6465 6420   first recorded 
+000130c0: 6576 656e 7420 696e 2074 6865 2064 6174  event in the dat
+000130d0: 6162 6173 652e 2049 6620 6120 636f 6d6d  abase. If a comm
+000130e0: 6974 2070 6f73 6974 696f 6e20 6973 2067  it position is g
+000130f0: 6976 656e 2c0a 6974 206d 7573 7420 6d61  iven,.it must ma
+00013100: 7463 6820 616e 2061 6374 7561 6c6c 7920  tch an actually 
+00013110: 6578 6973 7469 6e67 2063 6f6d 6d69 7420  existing commit 
+00013120: 706f 7369 7469 6f6e 2069 6e20 7468 6520  position in the 
+00013130: 6461 7461 6261 7365 2e20 4f6e 6c79 2065  database. Only e
+00013140: 7665 6e74 730a 7265 636f 7264 6564 2061  vents.recorded a
+00013150: 6674 6572 2074 6861 7420 706f 7369 7469  fter that positi
+00013160: 6f6e 2077 696c 6c20 6265 206f 6274 6169  on will be obtai
+00013170: 6e65 642e 0a0a 5468 6520 6f70 7469 6f6e  ned...The option
+00013180: 616c 2060 6672 6f6d 5f65 6e64 6020 6172  al `from_end` ar
+00013190: 6775 6d65 6e74 2073 7065 6369 6669 6573  gument specifies
+000131a0: 2077 6865 7468 6572 206f 7220 6e6f 7420   whether or not 
+000131b0: 7468 6520 6361 7463 682d 7570 2073 7562  the catch-up sub
+000131c0: 7363 7269 7074 696f 6e0a 7769 6c6c 2073  scription.will s
+000131d0: 7461 7274 2066 726f 6d20 7468 6520 6c61  tart from the la
+000131e0: 7374 2072 6563 6f72 6465 6420 6576 656e  st recorded even
+000131f0: 7420 696e 2074 6865 2064 6174 6162 6173  t in the databas
+00013200: 652e 2042 7920 6465 6661 756c 742c 2074  e. By default, t
+00013210: 6869 7320 6172 6775 6d65 6e74 0a69 7320  his argument.is 
+00013220: 6046 616c 7365 602e 2049 6620 6066 726f  `False`. If `fro
+00013230: 6d5f 656e 6460 2069 7320 6054 7275 6560  m_end` is `True`
+00013240: 2c20 6f6e 6c79 2065 7665 6e74 7320 7265  , only events re
+00013250: 636f 7264 6564 2061 6674 6572 2074 6865  corded after the
+00013260: 2073 7562 7363 7269 7074 696f 6e0a 6973   subscription.is
+00013270: 2073 7461 7274 6564 2077 696c 6c20 6265   started will be
+00013280: 206f 6274 6169 6e65 642e 2054 6869 7320   obtained. This 
+00013290: 6172 6775 6d65 6e74 2077 696c 6c20 6265  argument will be
+000132a0: 2064 6973 7265 6761 7264 6564 2069 6620   disregarded if 
+000132b0: 6063 6f6d 6d69 745f 706f 7369 7469 6f6e  `commit_position
+000132c0: 600a 6973 206e 6f74 2060 4e6f 6e65 602e  `.is not `None`.
+000132d0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+000132e0: 7265 736f 6c76 655f 6c69 6e6b 7360 2061  resolve_links` a
+000132f0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00013300: 686f 6e20 6062 6f6f 6c60 2e20 5468 6520  hon `bool`. The 
+00013310: 6465 6661 756c 7420 7661 6c75 6520 6f66  default value of
+00013320: 2060 7265 736f 6c76 655f 6c69 6e6b 7360   `resolve_links`
+00013330: 0a69 7320 6046 616c 7365 602c 2077 6869  .is `False`, whi
+00013340: 6368 206d 6561 6e73 2061 6e79 2065 7665  ch means any eve
+00013350: 6e74 206c 696e 6b73 2077 696c 6c20 6e6f  nt links will no
+00013360: 7420 6265 2072 6573 6f6c 7665 642c 2073  t be resolved, s
+00013370: 6f20 7468 6174 2074 6865 2065 7665 6e74  o that the event
+00013380: 7320 7468 6174 2061 7265 0a72 6574 7572  s that are.retur
+00013390: 6e65 6420 6d61 7920 7265 7072 6573 656e  ned may represen
+000133a0: 7420 6576 656e 7420 6c69 6e6b 732e 2049  t event links. I
+000133b0: 6620 6072 6573 6f6c 7665 5f6c 696e 6b73  f `resolve_links
+000133c0: 6020 6973 2060 5472 7565 602c 2061 6e79  ` is `True`, any
+000133d0: 2065 7665 6e74 206c 696e 6b73 2077 696c   event links wil
+000133e0: 6c0a 6265 2072 6573 6f6c 7665 642c 2073  l.be resolved, s
+000133f0: 6f20 7468 6174 2074 6865 206c 696e 6b65  o that the linke
+00013400: 6420 6576 656e 7473 2077 696c 6c20 6265  d events will be
+00013410: 2072 6574 7572 6e65 6420 696e 7374 6561   returned instea
+00013420: 6420 6f66 2074 6865 2065 7665 6e74 206c  d of the event l
+00013430: 696e 6b73 2e0a 0a54 6865 206f 7074 696f  inks...The optio
+00013440: 6e61 6c20 6066 696c 7465 725f 6578 636c  nal `filter_excl
+00013450: 7564 6560 2061 7267 756d 656e 7420 6973  ude` argument is
+00013460: 2061 2073 6571 7565 6e63 6520 6f66 2072   a sequence of r
+00013470: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
+00013480: 6e73 2074 6861 740a 7370 6563 6966 6965  ns that.specifie
+00013490: 7320 7768 6963 6820 7265 636f 7264 6564  s which recorded
+000134a0: 2065 7665 6e74 7320 7368 6f75 6c64 2062   events should b
+000134b0: 6520 7265 7475 726e 6564 2e20 5468 6973  e returned. This
+000134c0: 2061 7267 756d 656e 7420 6973 2069 676e   argument is ign
+000134d0: 6f72 6564 0a69 6620 6066 696c 7465 725f  ored.if `filter_
+000134e0: 696e 636c 7564 6560 2069 7320 7365 7420  include` is set 
+000134f0: 746f 2061 206e 6f6e 2d65 6d70 7479 2073  to a non-empty s
+00013500: 6571 7565 6e63 652e 2054 6865 2064 6566  equence. The def
+00013510: 6175 6c74 2076 616c 7565 206f 6620 7468  ault value of th
+00013520: 6973 0a61 7267 756d 656e 7420 6d61 7463  is.argument matc
+00013530: 6865 7320 7468 6520 6576 656e 7420 7479  hes the event ty
+00013540: 7065 7320 6f66 2045 7665 6e74 5374 6f72  pes of EventStor
+00013550: 6544 4220 2273 7973 7465 6d20 6576 656e  eDB "system even
+00013560: 7473 222c 2073 6f20 7468 6174 2073 7973  ts", so that sys
+00013570: 7465 6d0a 6576 656e 7473 2077 696c 6c20  tem.events will 
+00013580: 6e6f 7420 6e6f 726d 616c 6c79 2062 6520  not normally be 
+00013590: 696e 636c 7564 6564 2e20 5365 6520 7468  included. See th
+000135a0: 6520 4e6f 7465 7320 7365 6374 696f 6e20  e Notes section 
+000135b0: 6265 6c6f 7720 666f 7220 6d6f 7265 0a69  below for more.i
+000135c0: 6e66 6f72 6d61 7469 6f6e 2061 626f 7574  nformation about
+000135d0: 2066 696c 7465 7220 6578 7072 6573 7369   filter expressi
+000135e0: 6f6e 732e 0a0a 5468 6520 6f70 7469 6f6e  ons...The option
+000135f0: 616c 2060 6669 6c74 6572 5f69 6e63 6c75  al `filter_inclu
+00013600: 6465 6020 6172 6775 6d65 6e74 2069 7320  de` argument is 
+00013610: 6120 7365 7175 656e 6365 206f 6620 7265  a sequence of re
+00013620: 6775 6c61 7220 6578 7072 6573 7369 6f6e  gular expression
+00013630: 730a 7468 6174 2073 7065 6369 6669 6573  s.that specifies
+00013640: 2077 6869 6368 2072 6563 6f72 6465 6420   which recorded 
+00013650: 6576 656e 7473 2073 686f 756c 6420 6265  events should be
+00013660: 2072 6574 7572 6e65 642e 2042 7920 6465   returned. By de
+00013670: 6661 756c 742c 2074 6869 730a 6172 6775  fault, this.argu
+00013680: 6d65 6e74 2069 7320 616e 2065 6d70 7479  ment is an empty
+00013690: 2074 7570 6c65 2e20 4966 2074 6869 7320   tuple. If this 
+000136a0: 6172 6775 6d65 6e74 2069 7320 7365 7420  argument is set 
+000136b0: 746f 2061 206e 6f6e 2d65 6d70 7479 2073  to a non-empty s
+000136c0: 6571 7565 6e63 652c 0a74 6865 2060 6669  equence,.the `fi
+000136d0: 6c74 6572 5f65 7863 6c75 6465 6020 6172  lter_exclude` ar
+000136e0: 6775 6d65 6e74 2069 7320 6967 6e6f 7265  gument is ignore
+000136f0: 642e 0a0a 5468 6520 6f70 7469 6f6e 616c  d...The optional
+00013700: 2060 6669 6c74 6572 5f62 795f 7374 7265   `filter_by_stre
+00013710: 616d 5f6e 616d 6560 2061 7267 756d 656e  am_name` argumen
+00013720: 7420 6973 2061 2050 7974 686f 6e20 6062  t is a Python `b
+00013730: 6f6f 6c60 2074 6861 7420 696e 6469 6361  ool` that indica
+00013740: 7465 730a 7768 6574 6865 7220 7468 6520  tes.whether the 
+00013750: 6669 6c74 6572 696e 6720 7769 6c6c 2061  filtering will a
+00013760: 7070 6c79 2074 6f20 6576 656e 7420 7479  pply to event ty
+00013770: 7065 7320 6f72 2073 7472 6561 6d20 6e61  pes or stream na
+00013780: 6d65 732e 2042 7920 6465 6661 756c 742c  mes. By default,
+00013790: 2074 6869 730a 7661 6c75 6520 6973 2060   this.value is `
+000137a0: 4661 6c73 6560 2061 6e64 2073 6f20 7468  False` and so th
+000137b0: 6520 6669 6c74 6572 696e 6720 7769 6c6c  e filtering will
+000137c0: 2061 7070 6c79 2074 6f20 7468 6520 6576   apply to the ev
+000137d0: 656e 7420 7479 7065 2073 7472 696e 6773  ent type strings
+000137e0: 206f 660a 7265 636f 7264 6564 2065 7665   of.recorded eve
+000137f0: 6e74 732e 0a0a 5468 6520 6f70 7469 6f6e  nts...The option
+00013800: 616c 2060 696e 636c 7564 655f 6368 6563  al `include_chec
+00013810: 6b70 6f69 6e74 7360 2061 7267 756d 656e  kpoints` argumen
+00013820: 7420 6973 2061 2050 7974 686f 6e20 6062  t is a Python `b
+00013830: 6f6f 6c60 2077 6869 6368 2069 6e64 6963  ool` which indic
+00013840: 6174 6573 0a77 6865 7468 6572 2022 6368  ates.whether "ch
+00013850: 6563 6b70 6f69 6e74 2220 6d65 7373 6167  eckpoint" messag
+00013860: 6573 2073 686f 756c 6420 6265 2069 6e63  es should be inc
+00013870: 6c75 6465 6420 7768 656e 2072 6563 6f72  luded when recor
+00013880: 6465 6420 6576 656e 7473 2061 7265 2072  ded events are r
+00013890: 6563 6569 7665 642e 0a43 6865 636b 706f  eceived..Checkpo
+000138a0: 696e 7473 2068 6176 6520 6120 6063 6f6d  ints have a `com
+000138b0: 6d69 745f 706f 7369 7469 6f6e 6020 7661  mit_position` va
+000138c0: 6c75 6520 7468 6174 2063 616e 2062 6520  lue that can be 
+000138d0: 7573 6564 2062 7920 616e 2065 7665 6e74  used by an event
+000138e0: 2070 726f 6365 7373 696e 6720 636f 6d70   processing comp
+000138f0: 6f6e 656e 7420 746f 0a75 7064 6174 6520  onent to.update 
+00013900: 6974 7320 7265 636f 7264 6564 2063 6f6d  its recorded com
+00013910: 6d69 7420 706f 7369 7469 6f6e 2076 616c  mit position val
+00013920: 7565 2c20 736f 2074 6861 742c 2077 6865  ue, so that, whe
+00013930: 6e20 6c6f 7473 206f 6620 6576 656e 7473  n lots of events
+00013940: 2061 7265 2062 6569 6e67 0a66 696c 7465   are being.filte
+00013950: 7220 6f75 742c 2074 6865 2073 7562 7363  r out, the subsc
+00013960: 7269 6265 7220 646f 6573 206e 6f74 2068  riber does not h
+00013970: 6176 6520 746f 2073 7461 7274 2066 726f  ave to start fro
+00013980: 6d20 7468 6520 7361 6d65 206f 6c64 2070  m the same old p
+00013990: 6f73 6974 696f 6e20 7768 656e 0a74 6865  osition when.the
+000139a0: 2065 7665 6e74 2070 726f 6365 7373 696e   event processin
+000139b0: 6720 636f 6d70 6f6e 656e 7420 6973 2072  g component is r
+000139c0: 6573 7461 7274 6564 2e0a 0a54 6865 206f  estarted...The o
+000139d0: 7074 696f 6e61 6c20 6069 6e63 6c75 6465  ptional `include
+000139e0: 5f63 6175 6768 745f 7570 6020 6172 6775  _caught_up` argu
+000139f0: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+00013a00: 2060 626f 6f6c 6020 7768 6963 6820 696e   `bool` which in
+00013a10: 6469 6361 7465 730a 7768 6574 6865 7220  dicates.whether 
+00013a20: 2263 6175 6768 7420 7570 2220 6d65 7373  "caught up" mess
+00013a30: 6167 6573 2073 686f 756c 6420 6265 2069  ages should be i
+00013a40: 6e63 6c75 6465 6420 7768 656e 2072 6563  ncluded when rec
+00013a50: 6f72 6465 6420 6576 656e 7473 2061 7265  orded events are
+00013a60: 0a72 6563 6569 7665 642e 2054 6865 2064  .received. The d
+00013a70: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+00013a80: 6069 6e63 6c75 6465 5f63 6175 6768 745f  `include_caught_
+00013a90: 7570 6020 6973 2060 4661 6c73 6560 2e0a  up` is `False`..
+00013aa0: 0a54 6865 206f 7074 696f 6e61 6c20 6074  .The optional `t
+00013ab0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00013ac0: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+00013ad0: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
+00013ae0: 610a 6d61 7869 6d75 6d20 6475 7261 7469  a.maximum durati
+00013af0: 6f6e 2c20 696e 2073 6563 6f6e 6473 2c20  on, in seconds, 
+00013b00: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+00013b10: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+00013b20: 7065 7261 7469 6f6e 2e0a 0a54 6865 206f  peration...The o
+00013b30: 7074 696f 6e61 6c20 6063 7265 6465 6e74  ptional `credent
+00013b40: 6961 6c73 6020 6172 6775 6d65 6e74 2063  ials` argument c
+00013b50: 616e 2062 6520 7573 6564 2074 6f0a 6f76  an be used to.ov
+00013b60: 6572 7269 6465 2063 616c 6c20 6372 6564  erride call cred
+00013b70: 656e 7469 616c 7320 6465 7269 7665 6420  entials derived 
+00013b80: 6672 6f6d 2074 6865 2063 6f6e 6e65 6374  from the connect
+00013b90: 696f 6e20 7374 7269 6e67 2055 5249 2e0a  ion string URI..
+00013ba0: 0a54 6865 2065 7861 6d70 6c65 2062 656c  .The example bel
+00013bb0: 6f77 2073 686f 7773 2068 6f77 2074 6f20  ow shows how to 
+00013bc0: 7374 6172 7420 6120 6361 7463 682d 7570  start a catch-up
+00013bd0: 2073 7562 7363 7269 7074 696f 6e20 7468   subscription th
+00013be0: 6174 2073 7461 7274 730a 6672 6f6d 2074  at starts.from t
+00013bf0: 6865 2066 6972 7374 2072 6563 6f72 6465  he first recorde
+00013c00: 6420 6576 656e 7420 696e 2074 6865 2064  d event in the d
+00013c10: 6174 6162 6173 652e 0a0a 6060 6070 7974  atabase...```pyt
+00013c20: 686f 6e0a 2320 5375 6273 6372 6962 6520  hon.# Subscribe 
+00013c30: 6672 6f6d 2074 6865 2066 6972 7374 2072  from the first r
+00013c40: 6563 6f72 6465 6420 6576 656e 7420 696e  ecorded event in
+00013c50: 2074 6865 2064 6174 6162 6173 652e 0a63   the database..c
+00013c60: 6174 6368 7570 5f73 7562 7363 7269 7074  atchup_subscript
+00013c70: 696f 6e20 3d20 636c 6965 6e74 2e73 7562  ion = client.sub
+00013c80: 7363 7269 6265 5f74 6f5f 616c 6c28 290a  scribe_to_all().
+00013c90: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
+00013ca0: 2062 656c 6f77 2073 686f 7773 2074 6861   below shows tha
+00013cb0: 7420 6361 7463 682d 7570 2073 7562 7363  t catch-up subsc
+00013cc0: 7269 7074 696f 6e73 2064 6f20 6e6f 7420  riptions do not 
+00013cd0: 7374 6f70 0a61 7574 6f6d 6174 6963 616c  stop.automatical
+00013ce0: 6c79 2c20 6275 7420 626c 6f63 6b20 7768  ly, but block wh
+00013cf0: 656e 2074 6865 206c 6173 7420 7265 636f  en the last reco
+00013d00: 7264 6564 2065 7665 6e74 2069 7320 7265  rded event is re
+00013d10: 6365 6976 6564 2c0a 616e 6420 7468 656e  ceived,.and then
+00013d20: 2063 6f6e 7469 6e75 6520 7768 656e 2073   continue when s
+00013d30: 7562 7365 7175 656e 7420 6576 656e 7473  ubsequent events
+00013d40: 2061 7265 2072 6563 6f72 6465 642e 0a0a   are recorded...
+00013d50: 6060 6070 7974 686f 6e0a 6672 6f6d 2074  ```python.from t
+00013d60: 696d 6520 696d 706f 7274 2073 6c65 6570  ime import sleep
+00013d70: 0a66 726f 6d20 7468 7265 6164 696e 6720  .from threading 
+00013d80: 696d 706f 7274 2054 6872 6561 640a 0a0a  import Thread...
+00013d90: 2320 4170 7065 6e64 2061 206e 6577 2065  # Append a new e
+00013da0: 7665 6e74 2074 6f20 6120 6e65 7720 7374  vent to a new st
+00013db0: 7265 616d 2e0a 7374 7265 616d 5f6e 616d  ream..stream_nam
+00013dc0: 6532 203d 2073 7472 2875 7569 642e 7575  e2 = str(uuid.uu
+00013dd0: 6964 3428 2929 0a65 7665 6e74 3420 3d20  id4()).event4 = 
+00013de0: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+00013df0: 7264 6572 4372 6561 7465 6427 2c20 6461  rderCreated', da
+00013e00: 7461 3d62 277b 7d27 290a 0a63 6c69 656e  ta=b'{}')..clien
+00013e10: 742e 6170 7065 6e64 5f74 6f5f 7374 7265  t.append_to_stre
+00013e20: 616d 280a 2020 2020 7374 7265 616d 5f6e  am(.    stream_n
+00013e30: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+00013e40: 2c0a 2020 2020 6375 7272 656e 745f 7665  ,.    current_ve
+00013e50: 7273 696f 6e3d 5374 7265 616d 5374 6174  rsion=StreamStat
+00013e60: 652e 4e4f 5f53 5452 4541 4d2c 0a20 2020  e.NO_STREAM,.   
+00013e70: 2065 7665 6e74 733d 5b65 7665 6e74 345d   events=[event4]
+00013e80: 2c0a 290a 0a0a 2320 5265 6365 6976 6520  ,.)...# Receive 
+00013e90: 6576 656e 7473 2066 726f 6d20 7468 6520  events from the 
+00013ea0: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+00013eb0: 7074 696f 6e20 696e 2061 2064 6966 6665  ption in a diffe
+00013ec0: 7265 6e74 2074 6872 6561 642e 0a72 6563  rent thread..rec
+00013ed0: 6569 7665 645f 6576 656e 7473 203d 205b  eived_events = [
+00013ee0: 5d0a 0a64 6566 2072 6563 6569 7665 5f65  ]..def receive_e
+00013ef0: 7665 6e74 7328 293a 0a20 2020 2066 6f72  vents():.    for
+00013f00: 2065 7665 6e74 2069 6e20 6361 7463 6875   event in catchu
+00013f10: 705f 7375 6273 6372 6970 7469 6f6e 3a0a  p_subscription:.
+00013f20: 2020 2020 2020 2020 7265 6365 6976 6564          received
+00013f30: 5f65 7665 6e74 732e 6170 7065 6e64 2865  _events.append(e
+00013f40: 7665 6e74 290a 0a0a 6465 6620 7761 6974  vent)...def wait
+00013f50: 5f66 6f72 5f65 7665 6e74 2865 7665 6e74  _for_event(event
+00013f60: 293a 0a20 2020 2066 6f72 205f 2069 6e20  ):.    for _ in 
+00013f70: 7261 6e67 6528 3130 3029 3a0a 2020 2020  range(100):.    
+00013f80: 2020 2020 666f 7220 7265 6365 6976 6564      for received
+00013f90: 2069 6e20 7265 7665 7273 6564 2872 6563   in reversed(rec
+00013fa0: 6569 7665 645f 6576 656e 7473 293a 0a20  eived_events):. 
+00013fb0: 2020 2020 2020 2020 2020 2069 6620 6576             if ev
+00013fc0: 656e 7420 3d3d 2072 6563 6569 7665 643a  ent == received:
+00013fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013fe0: 2072 6574 7572 6e0a 2020 2020 2020 2020   return.        
+00013ff0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00014000: 2020 736c 6565 7028 302e 3129 0a20 2020    sleep(0.1).   
+00014010: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+00014020: 6169 7365 2041 7373 6572 7469 6f6e 4572  aise AssertionEr
+00014030: 726f 7228 2245 7665 6e74 2077 6173 6e27  ror("Event wasn'
+00014040: 7420 7265 6365 6976 6564 2229 0a0a 0a74  t received")...t
+00014050: 6872 6561 6420 3d20 5468 7265 6164 2874  hread = Thread(t
+00014060: 6172 6765 743d 7265 6365 6976 655f 6576  arget=receive_ev
+00014070: 656e 7473 2c20 6461 656d 6f6e 3d54 7275  ents, daemon=Tru
+00014080: 6529 0a74 6872 6561 642e 7374 6172 7428  e).thread.start(
+00014090: 290a 0a23 2057 6169 7420 746f 2072 6563  )..# Wait to rec
+000140a0: 6569 7665 2065 7665 6e74 342e 0a77 6169  eive event4..wai
+000140b0: 745f 666f 725f 6576 656e 7428 6576 656e  t_for_event(even
+000140c0: 7434 290a 0a23 2041 7070 656e 6420 616e  t4)..# Append an
+000140d0: 6f74 6865 7220 6576 656e 7420 7768 696c  other event whil
+000140e0: 7374 2074 6865 2073 7562 7363 7269 7074  st the subscript
+000140f0: 696f 6e20 6973 2072 756e 6e69 6e67 2e0a  ion is running..
+00014100: 6576 656e 7435 203d 204e 6577 4576 656e  event5 = NewEven
+00014110: 7428 7479 7065 3d27 4f72 6465 7255 7064  t(type='OrderUpd
+00014120: 6174 6564 272c 2064 6174 613d 6227 7b7d  ated', data=b'{}
+00014130: 2729 0a63 6c69 656e 742e 6170 7065 6e64  ').client.append
+00014140: 5f74 6f5f 7374 7265 616d 280a 2020 2020  _to_stream(.    
+00014150: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00014160: 616d 5f6e 616d 6532 2c0a 2020 2020 6375  am_name2,.    cu
+00014170: 7272 656e 745f 7665 7273 696f 6e3d 302c  rrent_version=0,
+00014180: 0a20 2020 2065 7665 6e74 733d 5b65 7665  .    events=[eve
+00014190: 6e74 355d 2c0a 290a 0a23 2057 6169 7420  nt5],.)..# Wait 
+000141a0: 666f 7220 7468 6520 7375 6273 6372 6970  for the subscrip
+000141b0: 7469 6f6e 2074 6f20 626c 6f63 6b2e 0a77  tion to block..w
+000141c0: 6169 745f 666f 725f 6576 656e 7428 6576  ait_for_event(ev
+000141d0: 656e 7435 290a 0a23 2053 746f 7020 7468  ent5)..# Stop th
+000141e0: 6520 7375 6273 6372 6970 7469 6f6e 2e0a  e subscription..
+000141f0: 6361 7463 6875 705f 7375 6273 6372 6970  catchup_subscrip
+00014200: 7469 6f6e 2e73 746f 7028 290a 7468 7265  tion.stop().thre
+00014210: 6164 2e6a 6f69 6e28 290a 6060 600a 0a54  ad.join().```..T
+00014220: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00014230: 2073 686f 7773 2068 6f77 2074 6f20 7375   shows how to su
+00014240: 6273 6372 6962 6520 746f 2065 7665 6e74  bscribe to event
+00014250: 7320 7265 636f 7264 6564 2061 6674 6572  s recorded after
+00014260: 2061 0a70 6172 7469 6375 6c61 7220 636f   a.particular co
+00014270: 6d6d 6974 2070 6f73 6974 696f 6e2c 2069  mmit position, i
+00014280: 6e20 7468 6973 2063 6173 6520 6672 6f6d  n this case from
+00014290: 2074 6865 2063 6f6d 6d69 7420 706f 7369   the commit posi
+000142a0: 7469 6f6e 206f 660a 7468 6520 6c61 7374  tion of.the last
+000142b0: 2072 6563 6f72 6465 6420 6576 656e 7420   recorded event 
+000142c0: 7468 6174 2077 6173 2072 6563 6569 7665  that was receive
+000142d0: 6420 6162 6f76 652e 2054 6865 6e2c 2061  d above. Then, a
+000142e0: 6e6f 7468 6572 2065 7665 6e74 2069 730a  nother event is.
+000142f0: 7265 636f 7264 6564 2062 6566 6f72 6520  recorded before 
+00014300: 7468 6520 7375 6273 6372 6970 7469 6f6e  the subscription
+00014310: 2069 7320 7265 7374 6172 7465 642e 2041   is restarted. A
+00014320: 6e64 2074 6872 6565 206d 6f72 6520 6576  nd three more ev
+00014330: 656e 7473 2061 7265 0a72 6563 6f72 6465  ents are.recorde
+00014340: 6420 7768 696c 7374 2074 6865 2073 7562  d whilst the sub
+00014350: 7363 7269 7074 696f 6e20 6973 2072 756e  scription is run
+00014360: 6e69 6e67 2e20 5468 6573 6520 666f 7572  ning. These four
+00014370: 2065 7665 6e74 7320 6172 650a 7265 6365   events are.rece
+00014380: 6976 6564 2069 6e20 7468 6520 6f72 6465  ived in the orde
+00014390: 7220 7468 6579 2077 6572 6520 7265 636f  r they were reco
+000143a0: 7264 6564 2e0a 0a0a 6060 6070 7974 686f  rded....```pytho
+000143b0: 6e0a 0a23 2041 7070 656e 6420 616e 6f74  n..# Append anot
+000143c0: 6865 7220 6576 656e 742e 0a65 7665 6e74  her event..event
+000143d0: 3620 3d20 4e65 7745 7665 6e74 2874 7970  6 = NewEvent(typ
+000143e0: 653d 274f 7264 6572 4465 6c65 7465 6427  e='OrderDeleted'
+000143f0: 2c20 6461 7461 3d62 277b 7d27 290a 636c  , data=b'{}').cl
+00014400: 6965 6e74 2e61 7070 656e 645f 746f 5f73  ient.append_to_s
+00014410: 7472 6561 6d28 0a20 2020 2073 7472 6561  tream(.    strea
+00014420: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+00014430: 6d65 322c 0a20 2020 2063 7572 7265 6e74  me2,.    current
+00014440: 5f76 6572 7369 6f6e 3d31 2c0a 2020 2020  _version=1,.    
+00014450: 6576 656e 7473 3d5b 6576 656e 7436 5d2c  events=[event6],
+00014460: 0a29 0a0a 2320 5265 7374 6172 7420 7375  .)..# Restart su
+00014470: 6273 6372 6962 696e 6720 746f 2061 6c6c  bscribing to all
+00014480: 2065 7665 6e74 7320 6166 7465 7220 7468   events after th
+00014490: 650a 2320 636f 6d6d 6974 2070 6f73 6974  e.# commit posit
+000144a0: 696f 6e20 6f66 2074 6865 206c 6173 7420  ion of the last 
+000144b0: 7265 6365 6976 6564 2065 7665 6e74 2e0a  received event..
+000144c0: 6361 7463 6875 705f 7375 6273 6372 6970  catchup_subscrip
+000144d0: 7469 6f6e 203d 2063 6c69 656e 742e 7375  tion = client.su
+000144e0: 6273 6372 6962 655f 746f 5f61 6c6c 280a  bscribe_to_all(.
+000144f0: 2020 2020 636f 6d6d 6974 5f70 6f73 6974      commit_posit
+00014500: 696f 6e3d 7265 6365 6976 6564 5f65 7665  ion=received_eve
+00014510: 6e74 735b 2d31 5d2e 636f 6d6d 6974 5f70  nts[-1].commit_p
+00014520: 6f73 6974 696f 6e0a 290a 0a74 6872 6561  osition.)..threa
+00014530: 6420 3d20 5468 7265 6164 2874 6172 6765  d = Thread(targe
+00014540: 743d 7265 6365 6976 655f 6576 656e 7473  t=receive_events
+00014550: 2c20 6461 656d 6f6e 3d54 7275 6529 0a74  , daemon=True).t
+00014560: 6872 6561 642e 7374 6172 7428 290a 0a23  hread.start()..#
+00014570: 2057 6169 7420 666f 7220 6576 656e 7436   Wait for event6
+00014580: 2e0a 7761 6974 5f66 6f72 5f65 7665 6e74  ..wait_for_event
+00014590: 2865 7665 6e74 3629 0a0a 2320 4170 7065  (event6)..# Appe
+000145a0: 6e64 2074 6872 6565 206d 6f72 6520 6576  nd three more ev
+000145b0: 656e 7473 2074 6f20 6120 6e65 7720 7374  ents to a new st
+000145c0: 7265 616d 2e0a 7374 7265 616d 5f6e 616d  ream..stream_nam
+000145d0: 6533 203d 2073 7472 2875 7569 642e 7575  e3 = str(uuid.uu
+000145e0: 6964 3428 2929 0a65 7665 6e74 3720 3d20  id4()).event7 = 
+000145f0: 4e65 7745 7665 6e74 2874 7970 653d 274f  NewEvent(type='O
+00014600: 7264 6572 4372 6561 7465 6427 2c20 6461  rderCreated', da
+00014610: 7461 3d62 277b 7d27 290a 6576 656e 7438  ta=b'{}').event8
+00014620: 203d 204e 6577 4576 656e 7428 7479 7065   = NewEvent(type
+00014630: 3d27 4f72 6465 7255 7064 6174 6564 272c  ='OrderUpdated',
+00014640: 2064 6174 613d 6227 7b7d 2729 0a65 7665   data=b'{}').eve
+00014650: 6e74 3920 3d20 4e65 7745 7665 6e74 2874  nt9 = NewEvent(t
+00014660: 7970 653d 274f 7264 6572 4465 6c65 7465  ype='OrderDelete
+00014670: 6427 2c20 6461 7461 3d62 277b 7d27 290a  d', data=b'{}').
+00014680: 0a63 6c69 656e 742e 6170 7065 6e64 5f74  .client.append_t
+00014690: 6f5f 7374 7265 616d 280a 2020 2020 7374  o_stream(.    st
+000146a0: 7265 616d 5f6e 616d 653d 7374 7265 616d  ream_name=stream
+000146b0: 5f6e 616d 6533 2c0a 2020 2020 6375 7272  _name3,.    curr
+000146c0: 656e 745f 7665 7273 696f 6e3d 5374 7265  ent_version=Stre
+000146d0: 616d 5374 6174 652e 4e4f 5f53 5452 4541  amState.NO_STREA
+000146e0: 4d2c 0a20 2020 2065 7665 6e74 733d 5b65  M,.    events=[e
+000146f0: 7665 6e74 372c 2065 7665 6e74 382c 2065  vent7, event8, e
+00014700: 7665 6e74 395d 2c0a 290a 0a23 2057 6169  vent9],.)..# Wai
+00014710: 7420 666f 7220 6576 656e 7473 2037 2c20  t for events 7, 
+00014720: 3820 616e 6420 392e 0a77 6169 745f 666f  8 and 9..wait_fo
+00014730: 725f 6576 656e 7428 6576 656e 7437 290a  r_event(event7).
+00014740: 7761 6974 5f66 6f72 5f65 7665 6e74 2865  wait_for_event(e
+00014750: 7665 6e74 3829 0a77 6169 745f 666f 725f  vent8).wait_for_
+00014760: 6576 656e 7428 6576 656e 7439 290a 0a23  event(event9)..#
+00014770: 2053 746f 7020 7468 6520 7375 6273 6372   Stop the subscr
+00014780: 6970 7469 6f6e 2e0a 6361 7463 6875 705f  iption..catchup_
+00014790: 7375 6273 6372 6970 7469 6f6e 2e73 746f  subscription.sto
+000147a0: 7028 290a 7468 7265 6164 2e6a 6f69 6e28  p().thread.join(
+000147b0: 290a 6060 600a 0a54 6865 2063 6174 6368  ).```..The catch
+000147c0: 2d75 7020 7375 6273 6372 6970 7469 6f6e  -up subscription
+000147d0: 2063 616c 6c20 6973 2065 6e64 6564 2061   call is ended a
+000147e0: 7320 736f 6f6e 2061 7320 7468 6520 7375  s soon as the su
+000147f0: 6273 6372 6970 7469 6f6e 206f 626a 6563  bscription objec
+00014800: 7427 730a 6073 746f 7028 2960 206d 6574  t's.`stop()` met
+00014810: 686f 6420 6973 2063 616c 6c65 642e 2054  hod is called. T
+00014820: 6869 7320 6861 7070 656e 7320 6175 746f  his happens auto
+00014830: 6d61 7469 6361 6c6c 7920 7768 656e 2069  matically when i
+00014840: 7420 676f 6573 206f 7574 206f 6620 7363  t goes out of sc
+00014850: 6f70 652c 0a6f 7220 7768 656e 2069 7420  ope,.or when it 
+00014860: 6973 2065 7870 6c69 6369 746c 7920 6465  is explicitly de
+00014870: 6c65 7465 6420 6672 6f6d 206d 656d 6f72  leted from memor
+00014880: 7920 7573 696e 6720 7468 6520 5079 7468  y using the Pyth
+00014890: 6f6e 2060 6465 6c60 206b 6579 776f 7264  on `del` keyword
+000148a0: 2e0a 0a23 2323 2053 7562 7363 7269 6265  ...### Subscribe
+000148b0: 2074 6f20 7374 7265 616d 2065 7665 6e74   to stream event
+000148c0: 733c 6120 6964 3d22 7375 6273 6372 6962  s<a id="subscrib
+000148d0: 652d 746f 2d73 7472 6561 6d2d 6576 656e  e-to-stream-even
+000148e0: 7473 223e 3c2f 613e 0a0a 5468 6520 6073  ts"></a>..The `s
+000148f0: 7562 7363 7269 6265 5f74 6f5f 7374 7265  ubscribe_to_stre
+00014900: 616d 2829 6020 6d65 7468 6f64 2063 616e  am()` method can
+00014910: 2062 6520 7573 6564 2074 6f20 7374 6172   be used to star
+00014920: 7420 6120 6361 7463 682d 7570 2073 7562  t a catch-up sub
+00014930: 7363 7269 7074 696f 6e0a 6672 6f6d 2077  scription.from w
+00014940: 6869 6368 2065 7665 6e74 7320 7265 636f  hich events reco
+00014950: 7264 6564 2069 6e20 6120 7369 6e67 6c65  rded in a single
+00014960: 2073 7472 6561 6d20 6361 6e20 6265 206f   stream can be o
+00014970: 6274 6169 6e65 642e 2054 6869 7320 6d65  btained. This me
+00014980: 7468 6f64 0a72 6574 7572 6e73 2061 2022  thod.returns a "
+00014990: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+000149a0: 7074 696f 6e22 2069 7465 7261 746f 722e  ption" iterator.
+000149b0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+000149c0: 7320 6120 7265 7175 6972 6564 2060 7374  s a required `st
+000149d0: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+000149e0: 656e 742c 2077 6869 6368 2073 7065 6369  ent, which speci
+000149f0: 6669 6573 2074 6865 206e 616d 6520 6f66  fies the name of
+00014a00: 2074 6865 0a73 7472 6561 6d20 6672 6f6d   the.stream from
+00014a10: 2077 6869 6368 2072 6563 6f72 6465 6420   which recorded 
+00014a20: 6576 656e 7473 2077 696c 6c20 6265 2072  events will be r
+00014a30: 6563 6569 7665 642e 0a0a 5468 6973 206d  eceived...This m
+00014a40: 6574 686f 6420 616c 736f 2068 6173 2073  ethod also has s
+00014a50: 6978 206f 7074 696f 6e61 6c20 6172 6775  ix optional argu
+00014a60: 6d65 6e74 732c 2060 7374 7265 616d 5f70  ments, `stream_p
+00014a70: 6f73 6974 696f 6e60 2c20 6066 726f 6d5f  osition`, `from_
+00014a80: 656e 6460 2c0a 6072 6573 6f6c 7665 5f6c  end`,.`resolve_l
+00014a90: 696e 6b73 602c 2060 696e 636c 7564 655f  inks`, `include_
+00014aa0: 6361 7567 6874 5f75 7060 2c20 6074 696d  caught_up`, `tim
+00014ab0: 656f 7574 6020 616e 6420 6063 7265 6465  eout` and `crede
+00014ac0: 6e74 6961 6c73 602e 0a0a 5468 6520 6f70  ntials`...The op
+00014ad0: 7469 6f6e 616c 2060 7374 7265 616d 5f70  tional `stream_p
+00014ae0: 6f73 6974 696f 6e60 2061 7267 756d 656e  osition` argumen
+00014af0: 7420 7370 6563 6966 6965 7320 6120 706f  t specifies a po
+00014b00: 7369 7469 6f6e 2069 6e20 7468 6520 7374  sition in the st
+00014b10: 7265 616d 2066 726f 6d0a 7768 6963 6820  ream from.which 
+00014b20: 746f 2073 7461 7274 2073 7562 7363 7269  to start subscri
+00014b30: 6269 6e67 2e20 5468 6520 6465 6661 756c  bing. The defaul
+00014b40: 7420 7661 6c75 6520 6f66 2060 7374 7265  t value of `stre
+00014b50: 616d 5f70 6f73 6974 696f 6e60 2069 7320  am_position` is 
+00014b60: 604e 6f6e 6560 2c0a 7768 6963 6820 6d65  `None`,.which me
+00014b70: 616e 7320 7468 6174 2061 6c6c 2065 7665  ans that all eve
+00014b80: 6e74 7320 7265 636f 7264 6564 2069 6e20  nts recorded in 
+00014b90: 7468 6520 7374 7265 616d 2077 696c 6c20  the stream will 
+00014ba0: 6265 206f 6274 6169 6e65 6420 696e 2074  be obtained in t
+00014bb0: 6865 0a6f 7264 6572 2074 6865 7920 7765  he.order they we
+00014bc0: 7265 2072 6563 6f72 6465 642c 2075 6e6c  re recorded, unl
+00014bd0: 6573 7320 6066 726f 6d5f 656e 6460 2069  ess `from_end` i
+00014be0: 7320 7365 7420 746f 2060 5472 7565 602e  s set to `True`.
+00014bf0: 2049 6620 6120 7374 7265 616d 0a70 6f73   If a stream.pos
+00014c00: 6974 696f 6e20 6973 2067 6976 656e 2c20  ition is given, 
+00014c10: 7468 656e 206f 6e6c 7920 6576 656e 7473  then only events
+00014c20: 2072 6563 6f72 6465 6420 6166 7465 7220   recorded after 
+00014c30: 7468 6174 2070 6f73 6974 696f 6e20 7769  that position wi
+00014c40: 6c6c 2062 6520 6f62 7461 696e 6564 2e0a  ll be obtained..
+00014c50: 0a54 6865 206f 7074 696f 6e61 6c20 6066  .The optional `f
+00014c60: 726f 6d5f 656e 6460 2061 7267 756d 656e  rom_end` argumen
+00014c70: 7420 7370 6563 6966 6965 7320 7468 6174  t specifies that
+00014c80: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+00014c90: 6e20 7769 6c6c 2073 7461 7274 0a66 726f  n will start.fro
+00014ca0: 6d20 7468 6520 6c61 7374 2070 6f73 6974  m the last posit
+00014cb0: 696f 6e20 696e 2074 6865 2073 7472 6561  ion in the strea
+00014cc0: 6d2e 2054 6865 2064 6566 6175 6c74 2076  m. The default v
+00014cd0: 616c 7565 206f 6620 6066 726f 6d5f 656e  alue of `from_en
+00014ce0: 6460 2069 7320 6046 616c 7365 602e 0a49  d` is `False`..I
+00014cf0: 6620 6066 726f 6d5f 656e 6460 2069 7320  f `from_end` is 
+00014d00: 6054 7275 6560 2c20 7468 656e 206f 6e6c  `True`, then onl
+00014d10: 7920 6576 656e 7473 2072 6563 6f72 6465  y events recorde
+00014d20: 6420 6166 7465 7220 7468 6520 7375 6273  d after the subs
+00014d30: 6372 6970 7469 6f6e 2077 6173 0a63 7265  cription was.cre
+00014d40: 6174 6564 2077 696c 6c20 6265 206f 6274  ated will be obt
+00014d50: 6169 6e65 642e 2054 6869 7320 6172 6775  ained. This argu
+00014d60: 6d65 6e74 2069 6620 6967 6e6f 7265 6420  ment if ignored 
+00014d70: 6973 2060 7374 7265 616d 5f70 6f73 6974  is `stream_posit
+00014d80: 696f 6e60 2069 7320 7365 742e 0a0a 5468  ion` is set...Th
+00014d90: 6520 6f70 7469 6f6e 616c 2060 7265 736f  e optional `reso
+00014da0: 6c76 655f 6c69 6e6b 7360 2061 7267 756d  lve_links` argum
+00014db0: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+00014dc0: 6062 6f6f 6c60 2e20 5468 6520 6465 6661  `bool`. The defa
+00014dd0: 756c 7420 7661 6c75 6520 6f66 2060 7265  ult value of `re
+00014de0: 736f 6c76 655f 6c69 6e6b 7360 0a69 7320  solve_links`.is 
+00014df0: 6046 616c 7365 602c 2077 6869 6368 206d  `False`, which m
+00014e00: 6561 6e73 2061 6e79 2065 7665 6e74 206c  eans any event l
+00014e10: 696e 6b73 2077 696c 6c20 6e6f 7420 6265  inks will not be
+00014e20: 2072 6573 6f6c 7665 642c 2073 6f20 7468   resolved, so th
+00014e30: 6174 2074 6865 2065 7665 6e74 7320 7468  at the events th
+00014e40: 6174 2061 7265 0a72 6574 7572 6e65 6420  at are.returned 
+00014e50: 6d61 7920 7265 7072 6573 656e 7420 6576  may represent ev
+00014e60: 656e 7420 6c69 6e6b 732e 2049 6620 6072  ent links. If `r
+00014e70: 6573 6f6c 7665 5f6c 696e 6b73 6020 6973  esolve_links` is
+00014e80: 2060 5472 7565 602c 2061 6e79 2065 7665   `True`, any eve
+00014e90: 6e74 206c 696e 6b73 2077 696c 6c0a 6265  nt links will.be
+00014ea0: 2072 6573 6f6c 7665 642c 2073 6f20 7468   resolved, so th
+00014eb0: 6174 2074 6865 206c 696e 6b65 6420 6576  at the linked ev
+00014ec0: 656e 7473 2077 696c 6c20 6265 2072 6574  ents will be ret
+00014ed0: 7572 6e65 6420 696e 7374 6561 6420 6f66  urned instead of
+00014ee0: 2074 6865 2065 7665 6e74 206c 696e 6b73   the event links
+00014ef0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00014f00: 6069 6e63 6c75 6465 5f63 6175 6768 745f  `include_caught_
+00014f10: 7570 6020 6172 6775 6d65 6e74 2069 7320  up` argument is 
+00014f20: 6120 5079 7468 6f6e 2060 626f 6f6c 6020  a Python `bool` 
+00014f30: 7768 6963 6820 696e 6469 6361 7465 730a  which indicates.
+00014f40: 7768 6574 6865 7220 2263 6175 6768 7420  whether "caught 
+00014f50: 7570 2220 6d65 7373 6167 6573 2073 686f  up" messages sho
+00014f60: 756c 6420 6265 2069 6e63 6c75 6465 6420  uld be included 
+00014f70: 7768 656e 2072 6563 6f72 6465 6420 6576  when recorded ev
+00014f80: 656e 7473 2061 7265 0a72 6563 6569 7665  ents are.receive
+00014f90: 642e 2054 6865 2064 6566 6175 6c74 2076  d. The default v
+00014fa0: 616c 7565 206f 6620 6069 6e63 6c75 6465  alue of `include
+00014fb0: 5f63 6175 6768 745f 7570 6020 6973 2060  _caught_up` is `
+00014fc0: 4661 6c73 6560 2e0a 0a54 6865 206f 7074  False`...The opt
+00014fd0: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+00014fe0: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+00014ff0: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
+00015000: 6368 2073 6574 7320 610a 6d61 7869 6d75  ch sets a.maximu
+00015010: 6d20 6475 7261 7469 6f6e 2c20 696e 2073  m duration, in s
+00015020: 6563 6f6e 6473 2c20 666f 7220 7468 6520  econds, for the 
+00015030: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+00015040: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+00015050: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+00015060: 6063 7265 6465 6e74 6961 6c73 6020 6172  `credentials` ar
+00015070: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
+00015080: 6564 2074 6f0a 6f76 6572 7269 6465 2063  ed to.override c
+00015090: 616c 6c20 6372 6564 656e 7469 616c 7320  all credentials 
+000150a0: 6465 7269 7665 6420 6672 6f6d 2074 6865  derived from the
+000150b0: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
+000150c0: 6e67 2055 5249 2e0a 0a54 6865 2065 7861  ng URI...The exa
+000150d0: 6d70 6c65 2062 656c 6f77 2073 686f 7773  mple below shows
+000150e0: 2068 6f77 2074 6f20 7374 6172 7420 6120   how to start a 
+000150f0: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+00015100: 7074 696f 6e20 6672 6f6d 0a74 6865 2066  ption from.the f
+00015110: 6972 7374 2072 6563 6f72 6465 6420 6576  irst recorded ev
+00015120: 656e 7420 696e 2061 2073 7472 6561 6d2e  ent in a stream.
+00015130: 0a0a 6060 6070 7974 686f 6e0a 2320 5375  ..```python.# Su
+00015140: 6273 6372 6962 6520 6672 6f6d 2074 6865  bscribe from the
+00015150: 2073 7461 7274 206f 6620 2773 7472 6561   start of 'strea
+00015160: 6d32 272e 0a73 7562 7363 7269 7074 696f  m2'..subscriptio
+00015170: 6e20 3d20 636c 6965 6e74 2e73 7562 7363  n = client.subsc
+00015180: 7269 6265 5f74 6f5f 7374 7265 616d 2873  ribe_to_stream(s
+00015190: 7472 6561 6d5f 6e61 6d65 3d73 7472 6561  tream_name=strea
+000151a0: 6d5f 6e61 6d65 3229 0a60 6060 0a0a 5468  m_name2).```..Th
+000151b0: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+000151c0: 7368 6f77 7320 686f 7720 746f 2073 7461  shows how to sta
+000151d0: 7274 2061 2063 6174 6368 2d75 7020 7375  rt a catch-up su
+000151e0: 6273 6372 6970 7469 6f6e 2066 726f 6d0a  bscription from.
+000151f0: 6120 7061 7274 6963 756c 6172 2073 7472  a particular str
+00015200: 6561 6d20 706f 7369 7469 6f6e 2e0a 0a60  eam position...`
+00015210: 6060 7079 7468 6f6e 0a23 2053 7562 7363  ``python.# Subsc
+00015220: 7269 6265 2074 6f20 7374 7265 616d 322c  ribe to stream2,
+00015230: 2066 726f 6d20 7468 6520 7365 636f 6e64   from the second
+00015240: 2072 6563 6f72 6465 6420 6576 656e 742e   recorded event.
+00015250: 0a73 7562 7363 7269 7074 696f 6e20 3d20  .subscription = 
+00015260: 636c 6965 6e74 2e73 7562 7363 7269 6265  client.subscribe
+00015270: 5f74 6f5f 7374 7265 616d 280a 2020 2020  _to_stream(.    
+00015280: 7374 7265 616d 5f6e 616d 653d 7374 7265  stream_name=stre
+00015290: 616d 5f6e 616d 6532 2c0a 2020 2020 7374  am_name2,.    st
+000152a0: 7265 616d 5f70 6f73 6974 696f 6e3d 312c  ream_position=1,
+000152b0: 0a29 0a60 6060 0a0a 2323 2320 486f 7720  .).```..### How 
+000152c0: 746f 2069 6d70 6c65 6d65 6e74 2065 7861  to implement exa
+000152d0: 6374 6c79 2d6f 6e63 6520 6576 656e 7420  ctly-once event 
+000152e0: 7072 6f63 6573 7369 6e67 3c61 2069 643d  processing<a id=
+000152f0: 2268 6f77 2d74 6f2d 696d 706c 656d 656e  "how-to-implemen
+00015300: 742d 6578 6163 746c 792d 6f6e 6365 2d65  t-exactly-once-e
+00015310: 7665 6e74 2d70 726f 6365 7373 696e 6722  vent-processing"
+00015320: 3e3c 2f61 3e0a 0a54 6865 2063 6f6d 6d69  ></a>..The commi
+00015330: 7420 706f 7369 7469 6f6e 7320 6f66 2072  t positions of r
+00015340: 6563 6f72 6465 6420 6576 656e 7473 2074  ecorded events t
+00015350: 6861 7420 6172 6520 7265 6365 6976 6564  hat are received
+00015360: 2061 6e64 2070 726f 6365 7373 6564 2062   and processed b
+00015370: 7920 610a 646f 776e 7374 7265 616d 2063  y a.downstream c
+00015380: 6f6d 706f 6e65 6e74 2061 7265 2075 7365  omponent are use
+00015390: 6675 6c6c 7920 7265 636f 7264 6564 2062  fully recorded b
+000153a0: 7920 7468 6520 646f 776e 7374 7265 616d  y the downstream
+000153b0: 2063 6f6d 706f 6e65 6e74 2c20 736f 2074   component, so t
+000153c0: 6861 740a 7468 6520 636f 6d6d 6974 2070  hat.the commit p
+000153d0: 6f73 6974 696f 6e20 6f66 206c 6173 7420  osition of last 
+000153e0: 7072 6f63 6573 7365 6420 6576 656e 7420  processed event 
+000153f0: 6361 6e20 6265 2064 6574 6572 6d69 6e65  can be determine
+00015400: 6420 7768 656e 2070 726f 6365 7373 696e  d when processin
+00015410: 6720 6973 0a72 6573 756d 6564 2e0a 0a54  g is.resumed...T
+00015420: 6865 206c 6173 7420 7265 636f 7264 6564  he last recorded
+00015430: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+00015440: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+00015450: 7370 6563 6966 7920 7468 6520 636f 6d6d  specify the comm
+00015460: 6974 2070 6f73 6974 696f 6e20 6672 6f6d  it position from
+00015470: 2077 6869 6368 0a74 6f20 7375 6273 6372   which.to subscr
+00015480: 6962 6520 7768 656e 2070 726f 6365 7373  ibe when process
+00015490: 696e 6720 6973 2072 6573 756d 6564 2e20  ing is resumed. 
+000154a0: 5369 6e63 6520 7468 6973 2063 6f6d 6d69  Since this commi
+000154b0: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+000154c0: 7265 7072 6573 656e 7420 7468 650a 706f  represent the.po
+000154d0: 7369 7469 6f6e 206f 6620 7468 6520 6c61  sition of the la
+000154e0: 7374 2073 7563 6365 7373 6675 6c6c 7920  st successfully 
+000154f0: 7072 6f63 6573 7365 6420 6576 656e 7420  processed event 
+00015500: 696e 2061 2064 6f77 6e73 7472 6561 6d20  in a downstream 
+00015510: 636f 6d70 6f6e 656e 742c 2073 6f20 6974  component, so it
+00015520: 0a77 696c 6c20 6265 2075 7375 616c 2074  .will be usual t
+00015530: 6f20 7761 6e74 2074 6865 206e 6578 7420  o want the next 
+00015540: 6576 656e 7420 6166 7465 7220 7468 6973  event after this
+00015550: 2070 6f73 6974 696f 6e2c 2062 6563 6175   position, becau
+00015560: 7365 2074 6861 7420 6973 2074 6865 206e  se that is the n
+00015570: 6578 740a 6576 656e 7420 7468 6174 2068  ext.event that h
+00015580: 6173 206e 6f74 2079 6574 2062 6565 6e20  as not yet been 
+00015590: 7072 6f63 6573 7365 642e 2046 6f72 2074  processed. For t
+000155a0: 6869 7320 7265 6173 6f6e 2c20 7768 656e  his reason, when
+000155b0: 2073 7562 7363 7269 6269 6e67 2066 6f72   subscribing for
+000155c0: 2065 7665 6e74 730a 6672 6f6d 2061 2073   events.from a s
+000155d0: 7065 6369 6669 6320 636f 6d6d 6974 2070  pecific commit p
+000155e0: 6f73 6974 696f 6e20 7573 696e 6720 6120  osition using a 
+000155f0: 6361 7463 682d 7570 2073 7562 7363 7269  catch-up subscri
+00015600: 7074 696f 6e20 696e 2045 7665 6e74 5374  ption in EventSt
+00015610: 6f72 6544 422c 2074 6865 0a72 6563 6f72  oreDB, the.recor
+00015620: 6465 6420 6576 656e 7420 6174 2074 6865  ded event at the
+00015630: 2073 7065 6369 6669 6564 2063 6f6d 6d69   specified commi
+00015640: 7420 706f 7369 7469 6f6e 2077 696c 6c20  t position will 
+00015650: 4e4f 5420 6265 2069 6e63 6c75 6465 6420  NOT be included 
+00015660: 696e 2074 6865 2073 6571 7565 6e63 650a  in the sequence.
+00015670: 6f66 2072 6563 6f72 6465 6420 6576 656e  of recorded even
+00015680: 7473 2074 6861 7420 6172 6520 7265 6365  ts that are rece
+00015690: 6976 6564 2e0a 0a54 6f20 6163 636f 6d70  ived...To accomp
+000156a0: 6c69 7368 2022 6578 6163 746c 792d 6f6e  lish "exactly-on
+000156b0: 6365 2220 7072 6f63 6573 7369 6e67 206f  ce" processing o
+000156c0: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
+000156d0: 7320 696e 2061 2064 6f77 6e73 7472 6561  s in a downstrea
+000156e0: 6d0a 636f 6d70 6f6e 656e 7420 7768 656e  m.component when
+000156f0: 2075 7369 6e67 2061 2063 6174 6368 2d75   using a catch-u
+00015700: 7020 7375 6273 6372 6970 7469 6f6e 2c20  p subscription, 
+00015710: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
+00015720: 696f 6e20 6f66 2061 2072 6563 6f72 6465  ion of a recorde
+00015730: 640a 6576 656e 7420 7368 6f75 6c64 2062  d.event should b
+00015740: 6520 7265 636f 7264 6564 2061 746f 6d69  e recorded atomi
+00015750: 6361 6c6c 7920 616e 6420 756e 6971 7565  cally and unique
+00015760: 6c79 2061 6c6f 6e67 2077 6974 6820 7468  ly along with th
+00015770: 6520 7265 7375 6c74 206f 6620 7072 6f63  e result of proc
+00015780: 6573 7369 6e67 0a72 6563 6f72 6465 6420  essing.recorded 
+00015790: 6576 656e 7473 2c20 666f 7220 6578 616d  events, for exam
+000157a0: 706c 6520 696e 2074 6865 2073 616d 6520  ple in the same 
+000157b0: 6461 7461 6261 7365 2061 7320 6d61 7465  database as mate
+000157c0: 7269 616c 6973 6564 2076 6965 7773 2077  rialised views w
+000157d0: 6865 6e0a 696d 706c 656d 656e 7469 6e67  hen.implementing
+000157e0: 2065 7665 6e74 7561 6c6c 792d 636f 6e73   eventually-cons
+000157f0: 6973 7465 6e74 2043 5152 532c 206f 7220  istent CQRS, or 
+00015800: 696e 2074 6865 2073 616d 6520 6461 7461  in the same data
+00015810: 6261 7365 2061 7320 6120 646f 776e 7374  base as a downst
+00015820: 7265 616d 0a61 6e61 6c79 7469 6373 206f  ream.analytics o
+00015830: 7220 7265 706f 7274 696e 6720 6f72 2061  r reporting or a
+00015840: 7263 6869 7669 6e67 2061 7070 6c69 6361  rchiving applica
+00015850: 7469 6f6e 2e20 4279 2072 6563 6f72 6469  tion. By recordi
+00015860: 6e67 2074 6865 2063 6f6d 6d69 7420 706f  ng the commit po
+00015870: 7369 7469 6f6e 0a6f 6620 7265 636f 7264  sition.of record
+00015880: 6564 2065 7665 6e74 7320 6174 6f6d 6963  ed events atomic
+00015890: 616c 6c79 2077 6974 6820 7468 6520 6e65  ally with the ne
+000158a0: 7720 7374 6174 6520 7468 6174 2072 6573  w state that res
+000158b0: 756c 7473 2066 726f 6d20 7072 6f63 6573  ults from proces
+000158c0: 7369 6e67 0a72 6563 6f72 6465 6420 6576  sing.recorded ev
+000158d0: 656e 7473 2c20 2264 7561 6c20 7772 6974  ents, "dual writ
+000158e0: 696e 6722 2069 6e20 7468 6520 636f 6e73  ing" in the cons
+000158f0: 756d 7074 696f 6e20 6f66 2072 6563 6f72  umption of recor
+00015900: 6465 6420 6576 656e 7473 2063 616e 2062  ded events can b
+00015910: 650a 6176 6f69 6465 642e 2042 7920 616c  e.avoided. By al
+00015920: 736f 2072 6563 6f72 6469 6e67 2074 6865  so recording the
+00015930: 2063 6f6d 6d69 7420 706f 7369 7469 6f6e   commit position
+00015940: 2075 6e69 7175 656c 792c 2074 6865 206e   uniquely, the n
+00015950: 6577 2073 7461 7465 2063 616e 6e6f 7420  ew state cannot 
+00015960: 6265 0a72 6563 6f72 6465 6420 7477 6963  be.recorded twic
+00015970: 652c 2061 6e64 2068 656e 6365 2074 6865  e, and hence the
+00015980: 2072 6563 6f72 6465 6420 7374 6174 6520   recorded state 
+00015990: 6f66 2074 6865 2064 6f77 6e73 7472 6561  of the downstrea
+000159a0: 6d20 636f 6d70 6f6e 656e 7420 7769 6c6c  m component will
+000159b0: 2062 650a 7570 6461 7465 6420 6f6e 6c79   be.updated only
+000159c0: 206f 6e63 6520 666f 7220 616e 7920 7265   once for any re
+000159d0: 636f 7264 6564 2065 7665 6e74 2e20 4279  corded event. By
+000159e0: 2075 7369 6e67 2074 6865 2067 7265 6174   using the great
+000159f0: 6573 7420 7265 636f 7264 6564 2063 6f6d  est recorded com
+00015a00: 6d69 740a 706f 7369 7469 6f6e 2074 6f20  mit.position to 
+00015a10: 7265 7375 6d65 2061 2063 6174 6368 2d75  resume a catch-u
+00015a20: 7020 7375 6273 6372 6970 7469 6f6e 2c20  p subscription, 
+00015a30: 616c 6c20 7265 636f 7264 6564 2065 7665  all recorded eve
+00015a40: 6e74 7320 7769 6c6c 2065 7665 6e74 7561  nts will eventua
+00015a50: 6c6c 790a 6265 2070 726f 6365 7373 6564  lly.be processed
+00015a60: 2e20 5468 6520 636f 6d62 696e 6174 696f  . The combinatio
+00015a70: 6e20 6f66 2074 6865 2022 6174 2d6d 6f73  n of the "at-mos
+00015a80: 742d 6f6e 6365 2220 636f 6e64 6974 696f  t-once" conditio
+00015a90: 6e20 616e 6420 7468 6520 2261 742d 6c65  n and the "at-le
+00015aa0: 6173 742d 6f6e 6365 220a 636f 6e64 6974  ast-once".condit
+00015ab0: 696f 6e20 6769 7665 7320 7468 6520 2265  ion gives the "e
+00015ac0: 7861 6374 6c79 2d6f 6e63 6522 2063 6f6e  xactly-once" con
+00015ad0: 6469 7469 6f6e 2e0a 0a54 6865 2064 616e  dition...The dan
+00015ae0: 6765 7220 7769 7468 2022 6475 616c 2077  ger with "dual w
+00015af0: 7269 7469 6e67 2220 696e 2074 6865 2063  riting" in the c
+00015b00: 6f6e 7375 6d70 7469 6f6e 206f 6620 7265  onsumption of re
+00015b10: 636f 7264 6564 2065 7665 6e74 7320 6973  corded events is
+00015b20: 2074 6861 7420 6966 2061 0a72 6563 6f72   that if a.recor
+00015b30: 6465 6420 6576 656e 7420 6973 2073 7563  ded event is suc
+00015b40: 6365 7373 6675 6c6c 7920 7072 6f63 6573  cessfully proces
+00015b50: 7365 6420 616e 6420 6e65 7720 7374 6174  sed and new stat
+00015b60: 6520 7265 636f 7264 6564 2061 746f 6d69  e recorded atomi
+00015b70: 6361 6c6c 7920 696e 206f 6e65 0a74 7261  cally in one.tra
+00015b80: 6e73 6163 7469 6f6e 2077 6974 6820 7468  nsaction with th
+00015b90: 6520 636f 6d6d 6974 2070 6f73 6974 696f  e commit positio
+00015ba0: 6e20 7265 636f 7264 6564 2069 6e20 6120  n recorded in a 
+00015bb0: 7365 7061 7261 7465 2074 7261 6e73 6163  separate transac
+00015bc0: 7469 6f6e 2c20 6f6e 6520 6d61 790a 6861  tion, one may.ha
+00015bd0: 7070 656e 2061 6e64 206e 6f74 2074 6865  ppen and not the
+00015be0: 206f 7468 6572 2e20 4966 2074 6865 206e   other. If the n
+00015bf0: 6577 2073 7461 7465 2069 7320 7265 636f  ew state is reco
+00015c00: 7264 6564 2062 7574 2074 6865 2070 6f73  rded but the pos
+00015c10: 6974 696f 6e20 6973 206c 6f73 742c 0a61  ition is lost,.a
+00015c20: 6e64 2074 6865 6e20 7468 6520 7072 6f63  nd then the proc
+00015c30: 6573 7369 6e67 2069 7320 7374 6f70 7065  essing is stoppe
+00015c40: 6420 616e 6420 7265 7375 6d65 642c 2074  d and resumed, t
+00015c50: 6865 2072 6563 6f72 6465 6420 6576 656e  he recorded even
+00015c60: 7420 6d61 7920 6265 2070 726f 6365 7373  t may be process
+00015c70: 6564 0a74 7769 6365 2e20 4f6e 2074 6865  ed.twice. On the
+00015c80: 206f 7468 6572 2068 616e 642c 2069 6620   other hand, if 
+00015c90: 7468 6520 636f 6d6d 6974 2070 6f73 6974  the commit posit
+00015ca0: 696f 6e20 6973 2072 6563 6f72 6465 6420  ion is recorded 
+00015cb0: 6275 7420 7468 6520 6e65 7720 7374 6174  but the new stat
+00015cc0: 6520 6973 0a6c 6f73 742c 2074 6865 2072  e is.lost, the r
+00015cd0: 6563 6f72 6465 6420 6576 656e 7420 6d61  ecorded event ma
+00015ce0: 7920 6566 6665 6374 6976 656c 7920 6e6f  y effectively no
+00015cf0: 7420 6265 2070 726f 6365 7373 6564 2061  t be processed a
+00015d00: 7420 616c 6c2e 2042 7920 6569 7468 6572  t all. By either
+00015d10: 0a70 726f 6365 7373 696e 6720 616e 2065  .processing an e
+00015d20: 7665 6e74 206d 6f72 6520 7468 616e 206f  vent more than o
+00015d30: 6e63 652c 206f 7220 6279 2066 6169 6c69  nce, or by faili
+00015d40: 6e67 2074 6f20 7072 6f63 6573 7320 616e  ng to process an
+00015d50: 2065 7665 6e74 2c20 7468 6520 7265 636f   event, the reco
+00015d60: 7264 6564 0a73 7461 7465 206f 6620 7468  rded.state of th
+00015d70: 6520 646f 776e 7374 7265 616d 2063 6f6d  e downstream com
+00015d80: 706f 6e65 6e74 206d 6967 6874 2062 6520  ponent might be 
+00015d90: 696e 6163 6375 7261 7465 2c20 6f72 2070  inaccurate, or p
+00015da0: 6f73 7369 626c 7920 696e 636f 6e73 6973  ossibly inconsis
+00015db0: 7465 6e74 2c20 616e 640a 7065 7268 6170  tent, and.perhap
+00015dc0: 7320 6361 7461 7374 726f 7068 6963 616c  s catastrophical
+00015dd0: 6c79 2073 6f2e 2053 7563 6820 636f 6e73  ly so. Such cons
+00015de0: 6571 7565 6e63 6573 206d 6179 206f 7220  equences may or 
+00015df0: 6d61 7920 6e6f 7420 6d61 7474 6572 2069  may not matter i
+00015e00: 6e20 796f 7572 2073 6974 7561 7469 6f6e  n your situation
+00015e10: 2e0a 4275 7420 736f 6d65 7469 6d65 7320  ..But sometimes 
+00015e20: 696e 636f 6e73 6973 7465 6e63 6965 7320  inconsistencies 
+00015e30: 6d61 7920 6861 6c74 2070 726f 6365 7373  may halt process
+00015e40: 696e 6720 756e 7469 6c20 7468 6520 6973  ing until the is
+00015e50: 7375 6520 6973 2072 6573 6f6c 7665 642e  sue is resolved.
+00015e60: 2059 6f75 2063 616e 0a61 766f 6964 2022   You can.avoid "
+00015e70: 6475 616c 2077 7269 7469 6e67 2220 696e  dual writing" in
+00015e80: 2074 6865 2063 6f6e 7375 6d70 7469 6f6e   the consumption
+00015e90: 206f 6620 6576 656e 7473 2062 7920 6174   of events by at
+00015ea0: 6f6d 6963 616c 6c79 2072 6563 6f72 6469  omically recordi
+00015eb0: 6e67 2074 6865 2063 6f6d 6d69 740a 706f  ng the commit.po
+00015ec0: 7369 7469 6f6e 206f 6620 6120 7265 636f  sition of a reco
+00015ed0: 7264 6564 2065 7665 6e74 2061 6c6f 6e67  rded event along
+00015ee0: 2077 6974 6820 7468 6520 6e65 7720 7374   with the new st
+00015ef0: 6174 6520 7468 6174 2072 6573 756c 7473  ate that results
+00015f00: 2066 726f 6d20 7072 6f63 6573 7369 6e67   from processing
+00015f10: 2074 6861 740a 6576 656e 7420 696e 2074   that.event in t
+00015f20: 6865 2073 616d 6520 6174 6f6d 6963 2074  he same atomic t
+00015f30: 7261 6e73 6163 7469 6f6e 2e20 4279 206d  ransaction. By m
+00015f40: 616b 696e 6720 7468 6520 7265 636f 7264  aking the record
+00015f50: 696e 6720 6f66 2074 6865 2063 6f6d 6d69  ing of the commi
+00015f60: 7420 706f 7369 7469 6f6e 730a 756e 6971  t positions.uniq
+00015f70: 7565 2c20 736f 2074 6861 7420 7472 616e  ue, so that tran
+00015f80: 7361 6374 696f 6e73 2077 696c 6c20 6265  sactions will be
+00015f90: 2072 6f6c 6c65 6420 6261 636b 2077 6865   rolled back whe
+00015fa0: 6e20 7468 6572 6520 6973 2061 2063 6f6e  n there is a con
+00015fb0: 666c 6963 742c 2079 6f75 2077 696c 6c0a  flict, you will.
+00015fc0: 7072 6576 656e 7420 7468 6520 7265 7375  prevent the resu
+00015fd0: 6c74 7320 6f66 2061 6e79 2064 7570 6c69  lts of any dupli
+00015fe0: 6361 7465 2070 726f 6365 7373 696e 6720  cate processing 
+00015ff0: 6f66 2061 2072 6563 6f72 6465 6420 6576  of a recorded ev
+00016000: 656e 7420 6265 696e 6720 636f 6d6d 6974  ent being commit
+00016010: 7465 642e 0a0a 5265 636f 7264 6564 2065  ted...Recorded e
+00016020: 7665 6e74 7320 7265 6365 6976 6564 2066  vents received f
+00016030: 726f 6d20 6120 6361 7463 682d 7570 2073  rom a catch-up s
+00016040: 7562 7363 7269 7074 696f 6e20 6361 6e6e  ubscription cann
+00016050: 6f74 2062 6520 6163 6b6e 6f77 6c65 6467  ot be acknowledg
+00016060: 6564 2062 6163 6b0a 746f 2074 6865 2045  ed back.to the E
+00016070: 7665 6e74 5374 6f72 6544 4220 7365 7276  ventStoreDB serv
+00016080: 6572 2e20 4163 6b6e 6f77 6c65 6467 696e  er. Acknowledgin
+00016090: 6720 6576 656e 7473 2c20 686f 7765 7665  g events, howeve
+000160a0: 722c 2069 7320 616e 2061 7370 6563 7420  r, is an aspect 
+000160b0: 6f66 2022 7065 7273 6973 7465 6e74 0a73  of "persistent.s
+000160c0: 7562 7363 7269 7074 696f 6e73 222e 2048  ubscriptions". H
+000160d0: 6f70 696e 6720 746f 2072 656c 7920 6f6e  oping to rely on
+000160e0: 2061 636b 6e6f 776c 6564 6769 6e67 2065   acknowledging e
+000160f0: 7665 6e74 7320 746f 2061 6e20 7570 7374  vents to an upst
+00016100: 7265 616d 0a63 6f6d 706f 6e65 6e74 2069  ream.component i
+00016110: 7320 616e 2065 7861 6d70 6c65 206f 6620  s an example of 
+00016120: 6475 616c 2077 7269 7469 6e67 2e0a 0a0a  dual writing....
+00016130: 2323 2050 6572 7369 7374 656e 7420 7375  ## Persistent su
+00016140: 6273 6372 6970 7469 6f6e 733c 6120 6964  bscriptions<a id
+00016150: 3d22 7065 7273 6973 7465 6e74 2d73 7562  ="persistent-sub
+00016160: 7363 7269 7074 696f 6e73 223e 3c2f 613e  scriptions"></a>
+00016170: 0a0a 496e 2045 7665 6e74 5374 6f72 6544  ..In EventStoreD
+00016180: 422c 2022 7065 7273 6973 7465 6e74 2220  B, "persistent" 
+00016190: 7375 6273 6372 6970 7469 6f6e 7320 6172  subscriptions ar
+000161a0: 6520 7369 6d69 6c61 7220 746f 2063 6174  e similar to cat
+000161b0: 6368 2d75 7020 7375 6273 6372 6970 7469  ch-up subscripti
+000161c0: 6f6e 732c 0a69 6e20 7468 6174 2072 6561  ons,.in that rea
+000161d0: 6469 6e67 2061 2070 6572 7369 7374 656e  ding a persisten
+000161e0: 7420 7375 6273 6372 6970 7469 6f6e 2077  t subscription w
+000161f0: 696c 6c20 626c 6f63 6b20 7768 656e 2074  ill block when t
+00016200: 6865 7265 2061 7265 206e 6f20 6d6f 7265  here are no more
+00016210: 2072 6563 6f72 6465 640a 6576 656e 7473   recorded.events
+00016220: 2074 6f20 6265 2072 6563 6569 7665 642c   to be received,
+00016230: 2061 6e64 2074 6865 6e20 636f 6e74 696e   and then contin
+00016240: 7565 2077 6865 6e20 6e65 7720 6576 656e  ue when new even
+00016250: 7473 2061 7265 2073 7562 7365 7175 656e  ts are subsequen
+00016260: 746c 7920 7265 636f 7264 6564 2e0a 0a50  tly recorded...P
+00016270: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+00016280: 6970 7469 6f6e 7320 6361 6e20 6265 2063  iptions can be c
+00016290: 6f6e 7375 6d65 6420 6279 2061 2067 726f  onsumed by a gro
+000162a0: 7570 206f 6620 636f 6e73 756d 6572 7320  up of consumers 
+000162b0: 6f70 6572 6174 696e 6720 7769 7468 206f  operating with o
+000162c0: 6e65 0a6f 6620 7468 6520 7375 7070 6f72  ne.of the suppor
+000162d0: 7465 6420 2263 6f6e 7375 6d65 7220 7374  ted "consumer st
+000162e0: 7261 7465 6769 6573 222e 0a0a 5468 6520  rategies"...The 
+000162f0: 7369 676e 6966 6963 616e 7420 6469 6666  significant diff
+00016300: 6572 656e 7420 7769 7468 2070 6572 7369  erent with persi
+00016310: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+00016320: 6f6e 7320 6973 2074 6865 2073 6572 7665  ons is the serve
+00016330: 7220 7769 6c6c 206b 6565 7020 7472 6163  r will keep trac
+00016340: 6b0a 6f66 2074 6865 2070 726f 6772 6573  k.of the progres
+00016350: 7320 6f66 2074 6865 2063 6f6e 7375 6d65  s of the consume
+00016360: 7273 2e20 5468 6520 636f 6e73 756d 6572  rs. The consumer
+00016370: 206f 6620 6120 7065 7273 6973 7465 6e74   of a persistent
+00016380: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
+00016390: 6c6c 0a74 6865 7265 666f 7265 206e 6565  ll.therefore nee
+000163a0: 6420 746f 2022 6163 6b6e 6f77 6c65 6467  d to "acknowledg
+000163b0: 6522 2077 6865 6e20 6120 7265 636f 7264  e" when a record
+000163c0: 6564 2065 7665 6e74 2068 6173 2062 6565  ed event has bee
+000163d0: 6e20 7072 6f63 6573 7365 6420 7375 6363  n processed succ
+000163e0: 6573 7366 756c 6c79 2c0a 616e 6420 6f74  essfully,.and ot
+000163f0: 6865 7277 6973 6520 226e 6567 6174 6976  herwise "negativ
+00016400: 656c 7920 6163 6b6e 6f77 6c65 6467 6522  ely acknowledge"
+00016410: 2061 2072 6563 6f72 6465 6420 6576 656e   a recorded even
+00016420: 7420 7468 6174 2068 6173 2062 6565 6e20  t that has been 
+00016430: 7265 6365 6976 6564 2062 7574 2077 6173  received but was
+00016440: 0a6e 6f74 2073 7563 6365 7373 6675 6c6c  .not successfull
+00016450: 7920 7072 6f63 6573 7365 642e 0a0a 416c  y processed...Al
+00016460: 6c20 6f66 2074 6869 7320 6d65 616e 7320  l of this means 
+00016470: 7468 6174 2066 6f72 2070 6572 7369 7374  that for persist
+00016480: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00016490: 7320 7468 6572 6520 6172 6520 2263 7265  s there are "cre
+000164a0: 6174 6522 2c20 2272 6561 6422 2c20 2275  ate", "read", "u
+000164b0: 7064 6174 6522 0a22 6465 6c65 7465 222c  pdate"."delete",
+000164c0: 2022 6163 6b22 2c20 616e 6420 226e 6163   "ack", and "nac
+000164d0: 6b22 206f 7065 7261 7469 6f6e 7320 746f  k" operations to
+000164e0: 2063 6f6e 7369 6465 722e 0a0a 5768 696c   consider...Whil
+000164f0: 7374 2074 6865 7265 2061 7265 2073 6f6d  st there are som
+00016500: 6520 6164 7661 6e74 6167 6573 206f 6620  e advantages of 
+00016510: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00016520: 7269 7074 696f 6e73 2c20 696e 2070 6172  riptions, in par
+00016530: 7469 6375 6c61 7220 7468 650a 636f 6e63  ticular the.conc
+00016540: 7572 7265 6e74 2070 726f 6365 7373 696e  urrent processin
+00016550: 6720 6f66 2072 6563 6f72 6465 6420 6576  g of recorded ev
+00016560: 656e 7473 2062 7920 6120 6772 6f75 7020  ents by a group 
+00016570: 6f66 2063 6f6e 7375 6d65 7273 2c20 6279  of consumers, by
+00016580: 2074 7261 636b 696e 6720 696e 0a74 6865   tracking in.the
+00016590: 2073 6572 7665 7220 7468 6520 706f 7369   server the posi
+000165a0: 7469 6f6e 2069 6e20 7468 6520 636f 6d6d  tion in the comm
+000165b0: 6974 2073 6571 7565 6e63 6520 6f66 2065  it sequence of e
+000165c0: 7665 6e74 7320 7468 6174 2068 6176 6520  vents that have 
+000165d0: 6265 656e 2070 726f 6365 7373 6564 2c0a  been processed,.
+000165e0: 7468 6520 6973 7375 6520 6f66 2022 6475  the issue of "du
+000165f0: 616c 2077 7269 7469 6e67 2220 696e 2074  al writing" in t
+00016600: 6865 2063 6f6e 7375 6d70 7469 6f6e 206f  he consumption o
+00016610: 6620 6576 656e 7473 2061 7269 7365 732e  f events arises.
+00016620: 2052 656c 6961 6269 6c69 7479 2069 6e20   Reliability in 
+00016630: 7468 650a 7072 6f63 6573 7369 6e67 206f  the.processing o
+00016640: 6620 7265 636f 7264 6564 2065 7665 6e74  f recorded event
+00016650: 7320 6279 2061 2067 726f 7570 206f 6620  s by a group of 
+00016660: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+00016670: 7269 7074 696f 6e20 636f 6e73 756d 6572  ription consumer
+00016680: 7320 7769 6c6c 0a72 656c 7920 6f6e 2074  s will.rely on t
+00016690: 6865 6972 2069 6465 6d70 6f74 656e 7420  heir idempotent 
+000166a0: 6861 6e64 6c69 6e67 206f 6620 6475 706c  handling of dupl
+000166b0: 6963 6174 6520 6d65 7373 6167 6573 2c20  icate messages, 
+000166c0: 616e 6420 7468 6569 7220 7265 7369 6c69  and their resili
+000166d0: 656e 6365 2074 6f0a 6f75 742d 6f66 2d6f  ence to.out-of-o
+000166e0: 7264 6572 2064 656c 6976 6572 792e 0a0a  rder delivery...
+000166f0: 0a23 2323 2043 7265 6174 6520 7375 6273  .### Create subs
+00016700: 6372 6970 7469 6f6e 2074 6f20 616c 6c3c  cription to all<
+00016710: 6120 6964 3d22 6372 6561 7465 2d73 7562  a id="create-sub
+00016720: 7363 7269 7074 696f 6e2d 746f 2d61 6c6c  scription-to-all
+00016730: 223e 3c2f 613e 0a0a 2a72 6571 7569 7265  "></a>..*require
+00016740: 7320 6c65 6164 6572 2a0a 0a54 6865 2060  s leader*..The `
+00016750: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
+00016760: 696f 6e5f 746f 5f61 6c6c 2829 6020 6d65  ion_to_all()` me
+00016770: 7468 6f64 2063 616e 2062 6520 7573 6564  thod can be used
+00016780: 2074 6f20 6372 6561 7465 2061 2022 7065   to create a "pe
+00016790: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+000167a0: 7074 696f 6e22 0a74 6f20 616c 6c20 7468  ption".to all th
+000167b0: 6520 7265 636f 7264 6564 2065 7665 6e74  e recorded event
+000167c0: 7320 696e 2074 6865 2064 6174 6162 6173  s in the databas
+000167d0: 6520 6163 726f 7373 2061 6c6c 2073 7472  e across all str
+000167e0: 6561 6d73 2e0a 0a54 6869 7320 6d65 7468  eams...This meth
+000167f0: 6f64 2068 6173 2061 2072 6571 7569 7265  od has a require
+00016800: 6420 6067 726f 7570 5f6e 616d 6560 2061  d `group_name` a
+00016810: 7267 756d 656e 742c 2077 6869 6368 2069  rgument, which i
+00016820: 7320 7468 650a 6e61 6d65 206f 6620 6120  s the.name of a 
+00016830: 2267 726f 7570 2220 6f66 2063 6f6e 7375  "group" of consu
+00016840: 6d65 7273 206f 6620 7468 6520 7375 6273  mers of the subs
+00016850: 6372 6970 7469 6f6e 2e0a 0a54 6869 7320  cription...This 
+00016860: 6d65 7468 6f64 2068 6173 206e 696e 6574  method has ninet
+00016870: 6565 6e20 6f70 7469 6f6e 616c 2061 7267  een optional arg
+00016880: 756d 656e 7473 2c20 6066 726f 6d5f 656e  uments, `from_en
+00016890: 6460 2c20 6063 6f6d 6d69 745f 706f 7369  d`, `commit_posi
+000168a0: 7469 6f6e 602c 2060 7265 736f 6c76 655f  tion`, `resolve_
+000168b0: 6c69 6e6b 7360 2c0a 6066 696c 7465 725f  links`,.`filter_
+000168c0: 6578 636c 7564 6560 2c20 6066 696c 7465  exclude`, `filte
+000168d0: 725f 696e 636c 7564 6560 2c20 6066 696c  r_include`, `fil
+000168e0: 7465 725f 6279 5f73 7472 6561 6d5f 6e61  ter_by_stream_na
+000168f0: 6d65 602c 2060 636f 6e73 756d 6572 5f73  me`, `consumer_s
+00016900: 7472 6174 6567 7960 2c0a 606d 6573 7361  trategy`,.`messa
+00016910: 6765 5f74 696d 656f 7574 602c 2060 6d61  ge_timeout`, `ma
+00016920: 785f 7265 7472 795f 636f 756e 7460 2c20  x_retry_count`, 
+00016930: 606d 696e 5f63 6865 636b 706f 696e 745f  `min_checkpoint_
+00016940: 636f 756e 7460 2c20 606d 6178 5f63 6865  count`, `max_che
+00016950: 636b 706f 696e 745f 636f 756e 7460 2c0a  ckpoint_count`,.
+00016960: 6063 6865 636b 706f 696e 745f 6166 7465  `checkpoint_afte
+00016970: 7260 2c20 606d 6178 5f73 7562 7363 7269  r`, `max_subscri
+00016980: 6265 725f 636f 756e 7460 2c20 606c 6976  ber_count`, `liv
+00016990: 655f 6275 6666 6572 5f73 697a 6560 2c20  e_buffer_size`, 
+000169a0: 6072 6561 645f 6261 7463 685f 7369 7a65  `read_batch_size
+000169b0: 602c 0a60 6869 7374 6f72 795f 6275 6666  `,.`history_buff
+000169c0: 6572 5f73 697a 6560 2c20 6065 7874 7261  er_size`, `extra
+000169d0: 5f73 7461 7469 7374 6963 7360 2c20 6074  _statistics`, `t
+000169e0: 696d 656f 7574 6020 616e 6420 6063 7265  imeout` and `cre
+000169f0: 6465 6e74 6961 6c73 602e 0a0a 5468 6520  dentials`...The 
+00016a00: 6f70 7469 6f6e 616c 2060 6672 6f6d 5f65  optional `from_e
+00016a10: 6e64 6020 6172 6775 6d65 6e74 2063 616e  nd` argument can
+00016a20: 2062 6520 7573 6564 2074 6f20 7370 6563   be used to spec
+00016a30: 6966 7920 7468 6174 2074 6865 2067 726f  ify that the gro
+00016a40: 7570 206f 6620 636f 6e73 756d 6572 730a  up of consumers.
+00016a50: 6f66 2074 6865 2073 7562 7363 7269 7074  of the subscript
+00016a60: 696f 6e20 7368 6f75 6c64 206f 6e6c 7920  ion should only 
+00016a70: 7265 6365 6976 6520 6576 656e 7473 2074  receive events t
+00016a80: 6861 7420 7765 7265 2072 6563 6f72 6465  hat were recorde
+00016a90: 6420 6166 7465 7220 7468 6520 7375 6273  d after the subs
+00016aa0: 6372 6970 7469 6f6e 0a77 6173 2063 7265  cription.was cre
+00016ab0: 6174 6564 2e0a 0a41 6c74 6572 6e61 7469  ated...Alternati
+00016ac0: 7665 6c79 2c20 7468 6520 6f70 7469 6f6e  vely, the option
+00016ad0: 616c 2060 636f 6d6d 6974 5f70 6f73 6974  al `commit_posit
+00016ae0: 696f 6e60 2061 7267 756d 656e 7420 6361  ion` argument ca
+00016af0: 6e20 6265 2075 7365 6420 746f 2073 7065  n be used to spe
+00016b00: 6369 6679 2061 2063 6f6d 6d69 740a 706f  cify a commit.po
+00016b10: 7369 7469 6f6e 2066 726f 6d20 7768 6963  sition from whic
+00016b20: 6820 7468 6520 6772 6f75 7020 6f66 2063  h the group of c
+00016b30: 6f6e 7375 6d65 7273 206f 6620 7468 6520  onsumers of the 
+00016b40: 7375 6273 6372 6970 7469 6f6e 2073 686f  subscription sho
+00016b50: 756c 640a 7265 6365 6976 6520 6576 656e  uld.receive even
+00016b60: 7473 2e20 506c 6561 7365 206e 6f74 652c  ts. Please note,
+00016b70: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+00016b80: 656e 7420 6174 2074 6865 2073 7065 6369  ent at the speci
+00016b90: 6669 6564 2063 6f6d 6d69 7420 706f 7369  fied commit posi
+00016ba0: 7469 6f6e 206d 6967 6874 0a62 6520 696e  tion might.be in
+00016bb0: 636c 7564 6564 2069 6e20 7468 6520 7265  cluded in the re
+00016bc0: 636f 7264 6564 2065 7665 6e74 7320 7265  corded events re
+00016bd0: 6365 6976 6564 2062 7920 7468 6520 6772  ceived by the gr
+00016be0: 6f75 7020 6f66 2063 6f6e 7375 6d65 7273  oup of consumers
+00016bf0: 2e0a 0a49 6620 6e65 6974 6865 7220 6066  ...If neither `f
+00016c00: 726f 6d5f 656e 6460 206e 6f72 2060 636f  rom_end` nor `co
+00016c10: 6d6d 6974 5f70 6f73 6974 696f 6e60 2061  mmit_position` a
+00016c20: 7265 2073 7065 6369 6669 6564 2c20 7468  re specified, th
+00016c30: 6520 6772 6f75 7020 6f66 2063 6f6e 7375  e group of consu
+00016c40: 6d65 7273 0a6f 6620 7468 6520 7375 6273  mers.of the subs
+00016c50: 6372 6970 7469 6f6e 2077 696c 6c20 706f  cription will po
+00016c60: 7465 6e74 6961 6c6c 7920 7265 6365 6976  tentially receiv
+00016c70: 6520 616c 6c20 7265 636f 7264 6564 2065  e all recorded e
+00016c80: 7665 6e74 7320 696e 2074 6865 2064 6174  vents in the dat
+00016c90: 6162 6173 652e 0a0a 5468 6520 6f70 7469  abase...The opti
+00016ca0: 6f6e 616c 2060 7265 736f 6c76 655f 6c69  onal `resolve_li
+00016cb0: 6e6b 7360 2061 7267 756d 656e 7420 6973  nks` argument is
+00016cc0: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+00016cd0: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+00016ce0: 6c75 6520 6f66 2060 7265 736f 6c76 655f  lue of `resolve_
+00016cf0: 6c69 6e6b 7360 0a69 7320 6046 616c 7365  links`.is `False
+00016d00: 602c 2077 6869 6368 206d 6561 6e73 2061  `, which means a
+00016d10: 6e79 2065 7665 6e74 206c 696e 6b73 2077  ny event links w
+00016d20: 696c 6c20 6e6f 7420 6265 2072 6573 6f6c  ill not be resol
+00016d30: 7665 642c 2073 6f20 7468 6174 2074 6865  ved, so that the
+00016d40: 2065 7665 6e74 7320 7468 6174 2061 7265   events that are
+00016d50: 0a72 6574 7572 6e65 6420 6d61 7920 7265  .returned may re
+00016d60: 7072 6573 656e 7420 6576 656e 7420 6c69  present event li
+00016d70: 6e6b 732e 2049 6620 6072 6573 6f6c 7665  nks. If `resolve
+00016d80: 5f6c 696e 6b73 6020 6973 2060 5472 7565  _links` is `True
+00016d90: 602c 2061 6e79 2065 7665 6e74 206c 696e  `, any event lin
+00016da0: 6b73 2077 696c 6c0a 6265 2072 6573 6f6c  ks will.be resol
+00016db0: 7665 642c 2073 6f20 7468 6174 2074 6865  ved, so that the
+00016dc0: 206c 696e 6b65 6420 6576 656e 7473 2077   linked events w
+00016dd0: 696c 6c20 6265 2072 6574 7572 6e65 6420  ill be returned 
+00016de0: 696e 7374 6561 6420 6f66 2074 6865 2065  instead of the e
+00016df0: 7665 6e74 206c 696e 6b73 2e0a 0a54 6865  vent links...The
+00016e00: 206f 7074 696f 6e61 6c20 6066 696c 7465   optional `filte
+00016e10: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
+00016e20: 656e 7420 6973 2061 2073 6571 7565 6e63  ent is a sequenc
+00016e30: 6520 6f66 2072 6567 756c 6172 2065 7870  e of regular exp
+00016e40: 7265 7373 696f 6e73 2074 6861 740a 7370  ressions that.sp
+00016e50: 6563 6966 6965 7320 7768 6963 6820 7265  ecifies which re
+00016e60: 636f 7264 6564 2065 7665 6e74 7320 7368  corded events sh
+00016e70: 6f75 6c64 2062 6520 7265 7475 726e 6564  ould be returned
+00016e80: 2e20 5468 6973 2061 7267 756d 656e 7420  . This argument 
+00016e90: 6973 2069 676e 6f72 6564 0a69 6620 6066  is ignored.if `f
+00016ea0: 696c 7465 725f 696e 636c 7564 6560 2069  ilter_include` i
+00016eb0: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
+00016ec0: 6d70 7479 2073 6571 7565 6e63 652e 2054  mpty sequence. T
+00016ed0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00016ee0: 206f 6620 7468 6973 0a61 7267 756d 656e   of this.argumen
+00016ef0: 7420 6d61 7463 6865 7320 7468 6520 6576  t matches the ev
+00016f00: 656e 7420 7479 7065 7320 6f66 2045 7665  ent types of Eve
+00016f10: 6e74 5374 6f72 6544 4220 2273 7973 7465  ntStoreDB "syste
+00016f20: 6d20 6576 656e 7473 222c 2073 6f20 7468  m events", so th
+00016f30: 6174 2073 7973 7465 6d0a 6576 656e 7473  at system.events
+00016f40: 2077 696c 6c20 6e6f 7420 6e6f 726d 616c   will not normal
+00016f50: 6c79 2062 6520 696e 636c 7564 6564 2e20  ly be included. 
+00016f60: 5365 6520 7468 6520 4e6f 7465 7320 7365  See the Notes se
+00016f70: 6374 696f 6e20 6265 6c6f 7720 666f 7220  ction below for 
+00016f80: 6d6f 7265 0a69 6e66 6f72 6d61 7469 6f6e  more.information
+00016f90: 2061 626f 7574 2066 696c 7465 7220 6578   about filter ex
+00016fa0: 7072 6573 7369 6f6e 732e 0a0a 5468 6520  pressions...The 
+00016fb0: 6f70 7469 6f6e 616c 2060 6669 6c74 6572  optional `filter
+00016fc0: 5f69 6e63 6c75 6465 6020 6172 6775 6d65  _include` argume
+00016fd0: 6e74 2069 7320 6120 7365 7175 656e 6365  nt is a sequence
+00016fe0: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
+00016ff0: 6573 7369 6f6e 730a 7468 6174 2073 7065  essions.that spe
+00017000: 6369 6669 6573 2077 6869 6368 2072 6563  cifies which rec
+00017010: 6f72 6465 6420 6576 656e 7473 2073 686f  orded events sho
+00017020: 756c 6420 6265 2072 6574 7572 6e65 642e  uld be returned.
+00017030: 2042 7920 6465 6661 756c 742c 2074 6869   By default, thi
+00017040: 730a 6172 6775 6d65 6e74 2069 7320 616e  s.argument is an
+00017050: 2065 6d70 7479 2074 7570 6c65 2e20 4966   empty tuple. If
+00017060: 2074 6869 7320 6172 6775 6d65 6e74 2069   this argument i
+00017070: 7320 7365 7420 746f 2061 206e 6f6e 2d65  s set to a non-e
+00017080: 6d70 7479 2073 6571 7565 6e63 652c 0a74  mpty sequence,.t
+00017090: 6865 2060 6669 6c74 6572 5f65 7863 6c75  he `filter_exclu
+000170a0: 6465 6020 6172 6775 6d65 6e74 2069 7320  de` argument is 
+000170b0: 6967 6e6f 7265 642e 0a0a 5468 6520 6f70  ignored...The op
+000170c0: 7469 6f6e 616c 2060 6669 6c74 6572 5f62  tional `filter_b
+000170d0: 795f 7374 7265 616d 5f6e 616d 6560 2061  y_stream_name` a
+000170e0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+000170f0: 686f 6e20 6062 6f6f 6c60 2074 6861 7420  hon `bool` that 
+00017100: 696e 6469 6361 7465 730a 7768 6574 6865  indicates.whethe
+00017110: 7220 7468 6520 6669 6c74 6572 696e 6720  r the filtering 
+00017120: 7769 6c6c 2061 7070 6c79 2074 6f20 6576  will apply to ev
+00017130: 656e 7420 7479 7065 7320 6f72 2073 7472  ent types or str
+00017140: 6561 6d20 6e61 6d65 732e 2042 7920 6465  eam names. By de
+00017150: 6661 756c 742c 2074 6869 730a 7661 6c75  fault, this.valu
+00017160: 6520 6973 2060 4661 6c73 6560 2061 6e64  e is `False` and
+00017170: 2073 6f20 7468 6520 6669 6c74 6572 696e   so the filterin
+00017180: 6720 7769 6c6c 2061 7070 6c79 2074 6f20  g will apply to 
+00017190: 7468 6520 6576 656e 7420 7479 7065 2073  the event type s
+000171a0: 7472 696e 6773 206f 660a 7265 636f 7264  trings of.record
+000171b0: 6564 2065 7665 6e74 732e 0a0a 5468 6520  ed events...The 
+000171c0: 6f70 7469 6f6e 616c 2060 636f 6e73 756d  optional `consum
+000171d0: 6572 5f73 7472 6174 6567 7960 2061 7267  er_strategy` arg
+000171e0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+000171f0: 6e20 6073 7472 6020 7468 6174 2064 6566  n `str` that def
+00017200: 696e 6573 0a74 6865 2063 6f6e 7375 6d65  ines.the consume
+00017210: 7220 7374 7261 7465 6779 2066 6f72 2074  r strategy for t
+00017220: 6869 7320 7065 7273 6973 7465 6e74 2073  his persistent s
+00017230: 7562 7363 7269 7074 696f 6e2e 2054 6865  ubscription. The
+00017240: 2076 616c 7565 206f 6620 7468 6973 2061   value of this a
+00017250: 7267 756d 656e 740a 6361 6e20 6265 2060  rgument.can be `
+00017260: 2744 6973 7061 7463 6854 6f53 696e 676c  'DispatchToSingl
+00017270: 6527 602c 2060 2752 6f75 6e64 526f 6269  e'`, `'RoundRobi
+00017280: 6e27 602c 2060 2750 696e 6e65 6427 602c  n'`, `'Pinned'`,
+00017290: 206f 7220 6027 5069 6e6e 6564 4279 436f   or `'PinnedByCo
+000172a0: 7272 656c 6174 696f 6e27 602e 2054 6865  rrelation'`. The
+000172b0: 0a64 6566 6175 6c74 2076 616c 7565 2069  .default value i
+000172c0: 7320 6027 4469 7370 6174 6368 546f 5369  s `'DispatchToSi
+000172d0: 6e67 6c65 2760 2e0a 0a54 6865 206f 7074  ngle'`...The opt
+000172e0: 696f 6e61 6c20 606d 6573 7361 6765 5f74  ional `message_t
+000172f0: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00017300: 2069 7320 6120 5079 7468 6f6e 2060 666c   is a Python `fl
+00017310: 6f61 7460 2077 6869 6368 2073 6574 7320  oat` which sets 
+00017320: 6120 6d61 7869 6d75 6d20 6475 7261 7469  a maximum durati
+00017330: 6f6e 2c0a 696e 2073 6563 6f6e 6473 2c20  on,.in seconds, 
+00017340: 6672 6f6d 2074 6865 2073 6572 7665 7220  from the server 
+00017350: 7365 6e64 696e 6720 6120 7265 636f 7264  sending a record
+00017360: 6564 2065 7665 6e74 2074 6f20 6120 636f  ed event to a co
+00017370: 6e73 756d 6572 206f 6620 7468 6520 7065  nsumer of the pe
+00017380: 7273 6973 7465 6e74 0a73 7562 7363 7269  rsistent.subscri
+00017390: 7074 696f 6e20 756e 7469 6c20 6569 7468  ption until eith
+000173a0: 6572 2061 6e20 2261 636b 6e6f 776c 6564  er an "acknowled
+000173b0: 6765 6d65 6e74 2220 2861 636b 2920 6f72  gement" (ack) or
+000173c0: 2061 2022 6e65 6761 7469 7665 2061 636b   a "negative ack
+000173d0: 6e6f 776c 6564 6765 6d65 6e74 220a 286e  nowledgement".(n
+000173e0: 6163 6b29 2069 7320 7265 6365 6976 6564  ack) is received
+000173f0: 2062 7920 7468 6520 7365 7276 6572 2c20   by the server, 
+00017400: 6166 7465 7220 7768 6963 6820 7468 6520  after which the 
+00017410: 7365 7276 6572 2077 696c 6c20 7265 7472  server will retr
+00017420: 7920 746f 2073 656e 6420 7468 6520 6576  y to send the ev
+00017430: 656e 742e 0a54 6865 2064 6566 6175 6c74  ent..The default
+00017440: 2076 616c 7565 206f 6620 606d 6573 7361   value of `messa
+00017450: 6765 5f74 696d 656f 7574 6020 6973 2060  ge_timeout` is `
+00017460: 3330 2e30 602e 0a0a 5468 6520 6f70 7469  30.0`...The opti
+00017470: 6f6e 616c 2060 6d61 785f 7265 7472 795f  onal `max_retry_
+00017480: 636f 756e 7460 2061 7267 756d 656e 7420  count` argument 
+00017490: 6973 2061 2050 7974 686f 6e20 6069 6e74  is a Python `int
+000174a0: 6020 7768 6963 6820 7365 7473 2074 6865  ` which sets the
+000174b0: 206e 756d 6265 7220 6f66 2074 696d 6573   number of times
+000174c0: 0a74 6865 2073 6572 7665 7220 7769 6c6c  .the server will
+000174d0: 2072 6574 7279 2074 6f20 7365 6e64 2061   retry to send a
+000174e0: 6e20 6576 656e 742e 2054 6865 2064 6566  n event. The def
+000174f0: 6175 6c74 2076 616c 7565 206f 6620 606d  ault value of `m
+00017500: 6178 5f72 6574 7279 5f63 6f75 6e74 6020  ax_retry_count` 
+00017510: 6973 2060 3130 602e 0a0a 5468 6520 6f70  is `10`...The op
+00017520: 7469 6f6e 616c 2060 6d69 6e5f 6368 6563  tional `min_chec
+00017530: 6b70 6f69 6e74 5f63 6f75 6e74 6020 6172  kpoint_count` ar
+00017540: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+00017550: 6f6e 2060 696e 7460 2077 6869 6368 2073  on `int` which s
+00017560: 6574 7320 7468 6520 6d69 6e69 6d75 6d0a  ets the minimum.
+00017570: 6e75 6d62 6572 206f 6620 2261 636b 6e6f  number of "ackno
+00017580: 776c 6564 6765 6d65 6e74 7322 2028 6163  wledgements" (ac
+00017590: 6b73 2920 7265 6365 6976 6564 2062 7920  ks) received by 
+000175a0: 7468 6520 7365 7276 6572 2062 6566 6f72  the server befor
+000175b0: 6520 7468 6520 7365 7276 6572 206d 6179  e the server may
+000175c0: 2072 6563 6f72 640a 7468 6520 6163 6b6e   record.the ackn
+000175d0: 6f77 6c65 6467 656d 656e 7473 2e20 5468  owledgements. Th
+000175e0: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+000175f0: 6f66 2060 6d69 6e5f 6368 6563 6b70 6f69  of `min_checkpoi
+00017600: 6e74 5f63 6f75 6e74 6020 6973 2060 3130  nt_count` is `10
+00017610: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
+00017620: 2060 6d61 785f 6368 6563 6b70 6f69 6e74   `max_checkpoint
+00017630: 5f63 6f75 6e74 6020 6172 6775 6d65 6e74  _count` argument
+00017640: 2069 7320 6120 5079 7468 6f6e 2060 696e   is a Python `in
+00017650: 7460 2077 6869 6368 2073 6574 7320 7468  t` which sets th
+00017660: 6520 6d61 7869 6d75 6d0a 6e75 6d62 6572  e maximum.number
+00017670: 206f 6620 2261 636b 6e6f 776c 6564 6765   of "acknowledge
+00017680: 6d65 6e74 7322 2028 6163 6b73 2920 7265  ments" (acks) re
+00017690: 6365 6976 6564 2062 7920 7468 6520 7365  ceived by the se
+000176a0: 7276 6572 2062 6566 6f72 6520 7468 6520  rver before the 
+000176b0: 7365 7276 6572 206d 7573 740a 7265 636f  server must.reco
+000176c0: 7264 2074 6865 2061 636b 6e6f 776c 6564  rd the acknowled
+000176d0: 6765 6d65 6e74 732e 2054 6865 2064 6566  gements. The def
+000176e0: 6175 6c74 2076 616c 7565 206f 6620 606d  ault value of `m
+000176f0: 6178 5f63 6865 636b 706f 696e 745f 636f  ax_checkpoint_co
+00017700: 756e 7460 2069 7320 6031 3030 3060 2e0a  unt` is `1000`..
+00017710: 0a54 6865 206f 7074 696f 6e61 6c20 6063  .The optional `c
+00017720: 6865 636b 706f 696e 745f 6166 7465 7260  heckpoint_after`
+00017730: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+00017740: 7974 686f 6e20 6066 6c6f 6174 6020 7768  ython `float` wh
+00017750: 6963 6820 7365 7473 2074 6865 206d 6178  ich sets the max
+00017760: 696d 756d 0a64 7572 6174 696f 6e20 696e  imum.duration in
+00017770: 2073 6563 6f6e 6473 2062 6574 7765 656e   seconds between
+00017780: 2072 6563 6f72 6469 6e67 2022 6163 6b6e   recording "ackn
+00017790: 6f77 6c65 6467 656d 656e 7473 2220 2861  owledgements" (a
+000177a0: 636b 7329 2e20 5468 6520 6465 6661 756c  cks). The defaul
+000177b0: 7420 7661 6c75 6520 6f66 0a60 6368 6563  t value of.`chec
+000177c0: 6b70 6f69 6e74 5f61 6674 6572 6020 6973  kpoint_after` is
+000177d0: 2060 322e 3060 2e0a 0a54 6865 206f 7074   `2.0`...The opt
+000177e0: 696f 6e61 6c20 606d 6178 5f73 7562 7363  ional `max_subsc
+000177f0: 7269 6265 725f 636f 756e 7460 2061 7267  riber_count` arg
+00017800: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+00017810: 6e20 6069 6e74 6020 7768 6963 6820 7365  n `int` which se
+00017820: 7473 2074 6865 206d 6178 696d 756d 0a6e  ts the maximum.n
+00017830: 756d 6265 7220 6f66 2063 6f6e 6375 7272  umber of concurr
+00017840: 656e 7420 7265 6164 6572 7320 6f66 2074  ent readers of t
+00017850: 6865 2070 6572 7369 7374 656e 7420 7375  he persistent su
+00017860: 6273 6372 6970 7469 6f6e 2c20 6265 796f  bscription, beyo
+00017870: 6e64 2077 6869 6368 2061 7474 656d 7074  nd which attempt
+00017880: 7320 746f 0a72 6561 6420 7468 6520 7065  s to.read the pe
+00017890: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+000178a0: 7074 696f 6e20 7769 6c6c 2072 6169 7365  ption will raise
+000178b0: 2061 2060 4d61 7869 6d75 6d53 7562 7363   a `MaximumSubsc
+000178c0: 7269 7074 696f 6e73 5265 6163 6865 6460  riptionsReached`
+000178d0: 2065 7272 6f72 2e0a 0a54 6865 206f 7074   error...The opt
+000178e0: 696f 6e61 6c20 606c 6976 655f 6275 6666  ional `live_buff
+000178f0: 6572 5f73 697a 6560 2061 7267 756d 656e  er_size` argumen
+00017900: 7420 6973 2061 2050 7974 686f 6e20 6069  t is a Python `i
+00017910: 6e74 6020 7768 6963 6820 7365 7473 2074  nt` which sets t
+00017920: 6865 2073 697a 6520 6f66 2074 6865 0a62  he size of the.b
+00017930: 7566 6665 7220 2869 6e2d 6d65 6d6f 7279  uffer (in-memory
+00017940: 2920 686f 6c64 696e 6720 6e65 776c 7920  ) holding newly 
+00017950: 7265 636f 7264 6564 2065 7665 6e74 732e  recorded events.
+00017960: 2054 6865 2064 6566 6175 6c74 2076 616c   The default val
+00017970: 7565 206f 6620 606c 6976 655f 6275 6666  ue of `live_buff
+00017980: 6572 5f73 697a 6560 0a69 7320 3530 302e  er_size`.is 500.
+00017990: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+000179a0: 7265 6164 5f62 6174 6368 5f73 697a 6560  read_batch_size`
+000179b0: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+000179c0: 7974 686f 6e20 6069 6e74 6020 7768 6963  ython `int` whic
+000179d0: 6820 7365 7473 2074 6865 206e 756d 6265  h sets the numbe
+000179e0: 7220 6f66 0a72 6563 6f72 6465 6420 6576  r of.recorded ev
+000179f0: 656e 7473 2072 6561 6420 6672 6f6d 2064  ents read from d
+00017a00: 6973 6b20 7768 656e 2063 6174 6368 696e  isk when catchin
+00017a10: 6720 7570 2e20 5468 6520 6465 6661 756c  g up. The defaul
+00017a20: 7420 7661 6c75 6520 6f66 2060 7265 6164  t value of `read
+00017a30: 5f62 6174 6368 5f73 697a 6560 0a69 7320  _batch_size`.is 
+00017a40: 3230 302e 0a0a 5468 6520 6f70 7469 6f6e  200...The option
+00017a50: 616c 2060 6869 7374 6f72 795f 6275 6666  al `history_buff
+00017a60: 6572 5f73 697a 6560 2061 7267 756d 656e  er_size` argumen
+00017a70: 7420 6973 2061 2050 7974 686f 6e20 6069  t is a Python `i
+00017a80: 6e74 6020 7768 6963 6820 7365 7473 2074  nt` which sets t
+00017a90: 6865 206e 756d 6265 7220 6f66 0a72 6563  he number of.rec
+00017aa0: 6f72 6465 6420 6576 656e 7473 2074 6f20  orded events to 
+00017ab0: 6361 6368 6520 696e 206d 656d 6f72 7920  cache in memory 
+00017ac0: 7768 656e 2063 6174 6368 696e 6720 7570  when catching up
+00017ad0: 2e20 5468 6520 6465 6661 756c 7420 7661  . The default va
+00017ae0: 6c75 6520 6f66 2060 6869 7374 6f72 795f  lue of `history_
+00017af0: 6275 6666 6572 5f73 697a 6560 0a69 7320  buffer_size`.is 
+00017b00: 3530 302e 0a0a 5468 6520 6f70 7469 6f6e  500...The option
+00017b10: 616c 2060 6578 7472 615f 7374 6174 6973  al `extra_statis
+00017b20: 7469 6373 6020 6172 6775 6d65 6e74 2069  tics` argument i
+00017b30: 7320 6120 5079 7468 6f6e 2060 626f 6f6c  s a Python `bool
+00017b40: 6020 7768 6963 6820 656e 6162 6c65 7320  ` which enables 
+00017b50: 7472 6163 6b69 6e67 206f 660a 6578 7472  tracking of.extr
+00017b60: 6120 7374 6174 6973 7469 6373 206f 6e20  a statistics on 
+00017b70: 7468 6973 2073 7562 7363 7269 7074 696f  this subscriptio
+00017b80: 6e2e 2054 6865 2064 6566 6175 6c74 2076  n. The default v
+00017b90: 616c 7565 206f 6620 6065 7874 7261 5f73  alue of `extra_s
+00017ba0: 7461 7469 7374 6963 7360 2069 7320 6046  tatistics` is `F
+00017bb0: 616c 7365 602e 0a0a 5468 6520 6f70 7469  alse`...The opti
+00017bc0: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+00017bd0: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+00017be0: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
+00017bf0: 6820 7365 7473 2061 0a6d 6178 696d 756d  h sets a.maximum
+00017c00: 2064 7572 6174 696f 6e2c 2069 6e20 7365   duration, in se
+00017c10: 636f 6e64 732c 2066 6f72 2074 6865 2063  conds, for the c
+00017c20: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
+00017c30: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
+00017c40: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+00017c50: 6372 6564 656e 7469 616c 7360 2061 7267  credentials` arg
+00017c60: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
+00017c70: 6420 746f 0a6f 7665 7272 6964 6520 6361  d to.override ca
+00017c80: 6c6c 2063 7265 6465 6e74 6961 6c73 2064  ll credentials d
+00017c90: 6572 6976 6564 2066 726f 6d20 7468 6520  erived from the 
+00017ca0: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+00017cb0: 6720 5552 492e 0a0a 5468 6520 6d65 7468  g URI...The meth
+00017cc0: 6f64 2060 6372 6561 7465 5f73 7562 7363  od `create_subsc
+00017cd0: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
+00017ce0: 6020 646f 6573 206e 6f74 2072 6574 7572  ` does not retur
+00017cf0: 6e20 6120 7661 6c75 652e 2052 6563 6f72  n a value. Recor
+00017d00: 6465 6420 6576 656e 7473 2061 7265 0a6f  ded events are.o
+00017d10: 6274 6169 6e65 6420 6279 2063 616c 6c69  btained by calli
+00017d20: 6e67 2074 6865 2060 7265 6164 5f73 7562  ng the `read_sub
+00017d30: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
+00017d40: 2829 6020 6d65 7468 6f64 2e0a 0a49 6e20  ()` method...In 
+00017d50: 7468 6520 6578 616d 706c 6520 6265 6c6f  the example belo
+00017d60: 772c 2061 2070 6572 7369 7374 656e 7420  w, a persistent 
+00017d70: 7375 6273 6372 6970 7469 6f6e 2069 7320  subscription is 
+00017d80: 6372 6561 7465 6420 746f 206f 7065 7261  created to opera
+00017d90: 7465 2066 726f 6d20 7468 650a 6669 7273  te from the.firs
+00017da0: 7420 7265 636f 7264 6564 206e 6f6e 2d73  t recorded non-s
+00017db0: 7973 7465 6d20 6576 656e 7420 696e 2074  ystem event in t
+00017dc0: 6865 2064 6174 6162 6173 652e 0a0a 6060  he database...``
+00017dd0: 6070 7974 686f 6e0a 2320 4372 6561 7465  `python.# Create
+00017de0: 2061 2070 6572 7369 7374 656e 7420 7375   a persistent su
+00017df0: 6273 6372 6970 7469 6f6e 2e0a 6772 6f75  bscription..grou
+00017e00: 705f 6e61 6d65 3120 3d20 6622 6772 6f75  p_name1 = f"grou
+00017e10: 702d 7b75 7569 642e 7575 6964 3428 297d  p-{uuid.uuid4()}
+00017e20: 220a 636c 6965 6e74 2e63 7265 6174 655f  ".client.create_
+00017e30: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+00017e40: 616c 6c28 6772 6f75 705f 6e61 6d65 3d67  all(group_name=g
+00017e50: 726f 7570 5f6e 616d 6531 290a 6060 600a  roup_name1).```.
+00017e60: 0a23 2323 2052 6561 6420 7375 6273 6372  .### Read subscr
+00017e70: 6970 7469 6f6e 2074 6f20 616c 6c3c 6120  iption to all<a 
+00017e80: 6964 3d22 7265 6164 2d73 7562 7363 7269  id="read-subscri
+00017e90: 7074 696f 6e2d 746f 2d61 6c6c 223e 3c2f  ption-to-all"></
+00017ea0: 613e 0a0a 2a72 6571 7569 7265 7320 6c65  a>..*requires le
+00017eb0: 6164 6572 2a0a 0a54 6865 2060 7265 6164  ader*..The `read
+00017ec0: 5f73 7562 7363 7269 7074 696f 6e5f 746f  _subscription_to
+00017ed0: 5f61 6c6c 2829 6020 6d65 7468 6f64 2063  _all()` method c
+00017ee0: 616e 2062 6520 7573 6564 2062 7920 6120  an be used by a 
+00017ef0: 6772 6f75 7020 6f66 2063 6f6e 7375 6d65  group of consume
+00017f00: 7273 2074 6f20 7265 6365 6976 650a 7265  rs to receive.re
+00017f10: 636f 7264 6564 2065 7665 6e74 7320 6672  corded events fr
+00017f20: 6f6d 2061 2070 6572 7369 7374 656e 7420  om a persistent 
+00017f30: 7375 6273 6372 6970 7469 6f6e 2074 6861  subscription tha
+00017f40: 7420 6861 7320 6265 656e 2063 7265 6174  t has been creat
+00017f50: 6564 2075 7369 6e67 0a74 6865 2060 6372  ed using.the `cr
+00017f60: 6561 7465 5f73 7562 7363 7269 7074 696f  eate_subscriptio
+00017f70: 6e5f 746f 5f61 6c6c 2829 6020 6d65 7468  n_to_all()` meth
+00017f80: 6f64 2e0a 0a54 6869 7320 6d65 7468 6f64  od...This method
+00017f90: 2068 6173 2061 2072 6571 7569 7265 6420   has a required 
+00017fa0: 6067 726f 7570 5f6e 616d 6560 2061 7267  `group_name` arg
+00017fb0: 756d 656e 742c 2077 6869 6368 2069 730a  ument, which is.
+00017fc0: 7468 6520 6e61 6d65 206f 6620 6120 2267  the name of a "g
+00017fd0: 726f 7570 2220 6f66 2063 6f6e 7375 6d65  roup" of consume
+00017fe0: 7273 206f 6620 7468 6520 7375 6273 6372  rs of the subscr
+00017ff0: 6970 7469 6f6e 2073 7065 6369 6669 6564  iption specified
+00018000: 0a77 6865 6e20 6063 7265 6174 655f 7375  .when `create_su
+00018010: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
+00018020: 6c28 2960 2077 6173 2063 616c 6c65 642e  l()` was called.
+00018030: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+00018040: 7320 616e 206f 7074 696f 6e61 6c20 6074  s an optional `t
+00018050: 696d 656f 7574 6020 6172 6775 6d65 6e74  imeout` argument
+00018060: 2c20 7768 6963 6820 6973 2061 2050 7974  , which is a Pyt
+00018070: 686f 6e20 6066 6c6f 6174 600a 7468 6174  hon `float`.that
+00018080: 2073 6574 7320 6120 6d61 7869 6d75 6d20   sets a maximum 
+00018090: 6475 7261 7469 6f6e 2c20 696e 2073 6563  duration, in sec
+000180a0: 6f6e 6473 2c20 666f 7220 7468 6520 636f  onds, for the co
+000180b0: 6d70 6c65 7469 6f6e 206f 6620 7468 6520  mpletion of the 
+000180c0: 6752 5043 206f 7065 7261 7469 6f6e 2e0a  gRPC operation..
+000180d0: 0a54 6869 7320 6d65 7468 6f64 2068 6173  .This method has
+000180e0: 2061 6e20 6f70 7469 6f6e 616c 2060 6372   an optional `cr
+000180f0: 6564 656e 7469 616c 7360 2061 7267 756d  edentials` argum
+00018100: 656e 742c 2077 6869 6368 2063 616e 2062  ent, which can b
+00018110: 6520 7573 6564 2074 6f0a 6f76 6572 7269  e used to.overri
+00018120: 6465 2063 616c 6c20 6372 6564 656e 7469  de call credenti
+00018130: 616c 7320 6465 7269 7665 6420 6672 6f6d  als derived from
+00018140: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+00018150: 7374 7269 6e67 2055 5249 2e0a 0a54 6869  string URI...Thi
+00018160: 7320 6d65 7468 6f64 2072 6574 7572 6e73  s method returns
+00018170: 2061 2060 5065 7273 6973 7465 6e74 5375   a `PersistentSu
+00018180: 6273 6372 6970 7469 6f6e 6020 6f62 6a65  bscription` obje
+00018190: 6374 2c20 7768 6963 6820 6973 2061 6e20  ct, which is an 
+000181a0: 6974 6572 6174 6f72 0a67 6976 696e 6720  iterator.giving 
+000181b0: 6052 6563 6f72 6465 6445 7665 6e74 6020  `RecordedEvent` 
+000181c0: 6f62 6a65 6374 732e 2049 7420 616c 736f  objects. It also
+000181d0: 2068 6173 2060 6163 6b28 2960 2c20 606e   has `ack()`, `n
+000181e0: 6163 6b28 2960 2061 6e64 2060 7374 6f70  ack()` and `stop
+000181f0: 2829 600a 6d65 7468 6f64 732e 0a0a 6060  ()`.methods...``
+00018200: 6070 7974 686f 6e0a 7375 6273 6372 6970  `python.subscrip
+00018210: 7469 6f6e 203d 2063 6c69 656e 742e 7265  tion = client.re
+00018220: 6164 5f73 7562 7363 7269 7074 696f 6e5f  ad_subscription_
+00018230: 746f 5f61 6c6c 2867 726f 7570 5f6e 616d  to_all(group_nam
+00018240: 653d 6772 6f75 705f 6e61 6d65 3129 0a60  e=group_name1).`
+00018250: 6060 0a0a 5468 6520 6061 636b 2829 6020  ``..The `ack()` 
+00018260: 6d65 7468 6f64 2073 686f 756c 6420 6265  method should be
+00018270: 2075 7365 6420 6279 2061 2063 6f6e 7375   used by a consu
+00018280: 6d65 7220 746f 2022 6163 6b6e 6f77 6c65  mer to "acknowle
+00018290: 6467 6522 2074 6f20 7468 6520 7365 7276  dge" to the serv
+000182a0: 6572 2074 6861 740a 6974 2068 6173 2072  er that.it has r
+000182b0: 6563 6569 7665 6420 616e 6420 7375 6363  eceived and succ
+000182c0: 6573 7366 756c 6c79 2070 726f 6365 7373  essfully process
+000182d0: 6564 2061 2072 6563 6f72 6465 6420 6576  ed a recorded ev
+000182e0: 656e 742e 2054 6869 7320 7769 6c6c 2070  ent. This will p
+000182f0: 7265 7665 6e74 2074 6861 740a 7265 636f  revent that.reco
+00018300: 7264 6564 2065 7665 6e74 2062 6569 6e67  rded event being
+00018310: 2072 6563 6569 7665 6420 6279 2061 6e6f   received by ano
+00018320: 7468 6572 2063 6f6e 7375 6d65 7220 696e  ther consumer in
+00018330: 2074 6865 2073 616d 6520 6772 6f75 702e   the same group.
+00018340: 2054 6865 2060 6163 6b28 2960 0a68 6173   The `ack()`.has
+00018350: 2061 6e20 6069 7465 6d60 2061 7267 756d   an `item` argum
+00018360: 656e 7420 7768 6963 6820 6361 6e20 6265  ent which can be
+00018370: 2065 6974 6865 7220 6120 6052 6563 6f72   either a `Recor
+00018380: 6465 6445 7665 6e74 6020 6f72 2061 2060  dedEvent` or a `
+00018390: 5555 4944 602e 2049 6620 796f 7520 7061  UUID`. If you pa
+000183a0: 7373 0a69 6e20 6120 6052 6563 6f72 6465  ss.in a `Recorde
+000183b0: 6445 7665 6e74 602c 2074 6865 2076 616c  dEvent`, the val
+000183c0: 7565 206f 6620 6974 7320 6061 636b 5f69  ue of its `ack_i
+000183d0: 6460 2061 7474 7269 6275 7465 2077 696c  d` attribute wil
+000183e0: 6c20 6265 2075 7365 6420 746f 2061 636b  l be used to ack
+000183f0: 6e6f 776c 6564 6765 0a74 6865 2065 7665  nowledge.the eve
+00018400: 6e74 2074 6f20 7468 6520 7365 7276 6572  nt to the server
+00018410: 2e20 4966 2079 6f75 2070 6173 7320 696e  . If you pass in
+00018420: 2061 2055 5549 442c 2074 6865 6e20 7573   a UUID, then us
+00018430: 6564 2074 6865 2076 616c 7565 206f 6620  ed the value of 
+00018440: 7468 6520 6061 636b 5f69 6460 0a6f 6620  the `ack_id`.of 
+00018450: 7468 6520 6052 6563 6f72 6465 6445 7665  the `RecordedEve
+00018460: 6e74 6020 7468 6174 2069 7320 6265 696e  nt` that is bein
+00018470: 6720 6163 6b6e 6f77 6c65 6467 6564 2c20  g acknowledged, 
+00018480: 696e 2063 6173 6520 7468 6520 6576 656e  in case the even
+00018490: 7420 6861 7320 6265 656e 2072 6573 6f6c  t has been resol
+000184a0: 7665 640a 6672 6f6d 2061 206c 696e 6b20  ved.from a link 
+000184b0: 6576 656e 7420 2877 6869 6368 2063 616e  event (which can
+000184c0: 2068 6170 7065 6e20 626f 7468 2077 6865   happen both whe
+000184d0: 6e20 7065 7273 6973 7465 6e74 2073 7562  n persistent sub
+000184e0: 7363 7269 7074 696f 6e20 7365 7474 696e  scription settin
+000184f0: 670a 6072 6573 6f6c 7665 5f6c 696e 6b73  g.`resolve_links
+00018500: 6020 6973 2060 5472 7565 6020 616e 6420  ` is `True` and 
+00018510: 616c 736f 2077 6865 6e20 7265 706c 6179  also when replay
+00018520: 696e 6720 7061 726b 6564 2065 7665 6e74  ing parked event
+00018530: 7320 7265 6761 7264 6c65 7373 206f 6620  s regardless of 
+00018540: 7468 650a 6072 6573 6f6c 7665 5f6c 696e  the.`resolve_lin
+00018550: 6b73 6020 7365 7474 696e 6729 2e0a 0a54  ks` setting)...T
+00018560: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+00018570: 2069 7465 7261 7465 7320 6f76 6572 2074   iterates over t
+00018580: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+00018590: 6f62 6a65 6374 2c20 616e 6420 6361 6c6c  object, and call
+000185a0: 7320 6061 636b 2829 6020 7769 7468 2074  s `ack()` with t
+000185b0: 6865 0a72 6563 6569 7665 6420 6052 6563  he.received `Rec
+000185c0: 6f72 6465 6445 7665 6e74 6020 6f62 6a65  ordedEvent` obje
+000185d0: 6374 732e 2054 6865 2073 7562 7363 7269  cts. The subscri
+000185e0: 7074 696f 6e27 7320 6073 746f 7028 2960  ption's `stop()`
+000185f0: 206d 6574 686f 6420 6973 2063 616c 6c65   method is calle
+00018600: 6420 7768 656e 0a77 6520 6861 7665 2072  d when.we have r
+00018610: 6563 6569 7665 6420 6065 7665 6e74 3960  eceived `event9`
+00018620: 2c20 7374 6f70 7069 6e67 2074 6865 2069  , stopping the i
+00018630: 7465 7261 7469 6f6e 2c20 736f 2074 6861  teration, so tha
+00018640: 7420 7765 2063 616e 2063 6f6e 7469 6e75  t we can continu
+00018650: 6520 7769 7468 2074 6865 0a65 7861 6d70  e with the.examp
+00018660: 6c65 7320 6265 6c6f 772e 0a0a 6060 6070  les below...```p
+00018670: 7974 686f 6e0a 7265 6365 6976 6564 5f65  ython.received_e
+00018680: 7665 6e74 7320 3d20 5b5d 0a0a 666f 7220  vents = []..for 
+00018690: 6576 656e 7420 696e 2073 7562 7363 7269  event in subscri
+000186a0: 7074 696f 6e3a 0a20 2020 2072 6563 6569  ption:.    recei
+000186b0: 7665 645f 6576 656e 7473 2e61 7070 656e  ved_events.appen
+000186c0: 6428 6576 656e 7429 0a0a 2020 2020 2320  d(event)..    # 
+000186d0: 4163 6b6e 6f77 6c65 6467 6520 7468 6520  Acknowledge the 
+000186e0: 7265 6365 6976 6564 2065 7665 6e74 2e0a  received event..
+000186f0: 2020 2020 7375 6273 6372 6970 7469 6f6e      subscription
+00018700: 2e61 636b 2865 7665 6e74 290a 0a20 2020  .ack(event)..   
+00018710: 2023 2053 746f 7020 7768 656e 2027 6576   # Stop when 'ev
+00018720: 656e 7439 2720 6861 7320 6265 656e 2072  ent9' has been r
+00018730: 6563 6569 7665 642e 0a20 2020 2069 6620  eceived..    if 
+00018740: 6576 656e 7420 3d3d 2065 7665 6e74 393a  event == event9:
+00018750: 0a20 2020 2020 2020 2073 7562 7363 7269  .        subscri
+00018760: 7074 696f 6e2e 7374 6f70 2829 0a60 6060  ption.stop().```
+00018770: 0a0a 5468 6520 606e 6163 6b28 2960 2073  ..The `nack()` s
+00018780: 686f 756c 6420 6265 2075 7365 6420 6279  hould be used by
+00018790: 2061 2063 6f6e 7375 6d65 7220 746f 2022   a consumer to "
+000187a0: 6e65 6761 7469 7665 6c79 2061 636b 6e6f  negatively ackno
+000187b0: 776c 6564 6765 2220 746f 2074 6865 2073  wledge" to the s
+000187c0: 6572 7665 7220 7468 6174 0a69 7420 6861  erver that.it ha
+000187d0: 7320 7265 6365 6976 6564 2062 7574 206e  s received but n
+000187e0: 6f74 2073 7563 6365 7373 6675 6c6c 7920  ot successfully 
+000187f0: 7072 6f63 6573 7365 6420 6120 7265 636f  processed a reco
+00018800: 7264 6564 2065 7665 6e74 2e20 5468 6520  rded event. The 
+00018810: 606e 6163 6b28 2960 206d 6574 686f 6420  `nack()` method 
+00018820: 6861 730a 616e 2060 6974 656d 6020 6172  has.an `item` ar
+00018830: 6775 6d65 6e74 2074 6861 7420 776f 726b  gument that work
+00018840: 7320 696e 2074 6865 2073 616d 6520 7761  s in the same wa
+00018850: 7920 6173 2060 6163 6b28 2960 2e20 5573  y as `ack()`. Us
+00018860: 6520 7468 6520 7265 636f 7264 6564 2065  e the recorded e
+00018870: 7665 6e74 206f 7220 6974 730a 6061 636b  vent or its.`ack
+00018880: 5f69 6460 2061 7474 7269 6275 7465 2e20  _id` attribute. 
+00018890: 5468 6520 606e 6163 6b28 2960 206d 6574  The `nack()` met
+000188a0: 686f 6420 616c 736f 2068 6173 2061 6e20  hod also has an 
+000188b0: 6061 6374 696f 6e60 2061 7267 756d 656e  `action` argumen
+000188c0: 742c 2077 6869 6368 2073 686f 756c 6420  t, which should 
+000188d0: 6265 0a61 2050 7974 686f 6e20 6073 7472  be.a Python `str
+000188e0: 603a 2065 6974 6865 7220 6027 756e 6b6e  `: either `'unkn
+000188f0: 6f77 6e27 602c 2060 2770 6172 6b27 602c  own'`, `'park'`,
+00018900: 2060 2772 6574 7279 2760 2c20 6027 736b   `'retry'`, `'sk
+00018910: 6970 2760 206f 7220 6027 7374 6f70 2760  ip'` or `'stop'`
+00018920: 2e0a 0a54 6865 2060 7374 6f70 2829 6020  ...The `stop()` 
+00018930: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+00018940: 6564 2074 6f20 7374 6f70 2074 6865 2067  ed to stop the g
+00018950: 5250 4320 7374 7265 616d 696e 6720 6f70  RPC streaming op
+00018960: 6572 6174 696f 6e2e 0a0a 2323 2320 486f  eration...### Ho
+00018970: 7720 746f 2077 7269 7465 2061 2070 6572  w to write a per
+00018980: 7369 7374 656e 7420 7375 6273 6372 6970  sistent subscrip
+00018990: 7469 6f6e 2063 6f6e 7375 6d65 723c 6120  tion consumer<a 
+000189a0: 6964 3d22 686f 772d 746f 2d77 7269 7465  id="how-to-write
+000189b0: 2d61 2d70 6572 7369 7374 656e 742d 7375  -a-persistent-su
+000189c0: 6273 6372 6970 7469 6f6e 2d63 6f6e 7375  bscription-consu
+000189d0: 6d65 7222 3e3c 2f61 3e0a 0a54 6865 2072  mer"></a>..The r
+000189e0: 6561 6469 6e67 206f 6620 6120 7065 7273  eading of a pers
+000189f0: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+00018a00: 696f 6e20 6361 6e20 6265 2065 6e63 6170  ion can be encap
+00018a10: 7375 6c61 7465 6420 696e 2061 2022 636f  sulated in a "co
+00018a20: 6e73 756d 6572 2220 7468 6174 2063 616c  nsumer" that cal
+00018a30: 6c73 0a61 2022 706f 6c69 6379 2220 6675  ls.a "policy" fu
+00018a40: 6e63 7469 6f6e 2077 6865 6e20 6120 7265  nction when a re
+00018a50: 636f 7264 6564 2065 7665 6e74 2069 7320  corded event is 
+00018a60: 7265 6365 6976 6564 2061 6e64 2074 6865  received and the
+00018a70: 6e20 6175 746f 6d61 7469 6361 6c6c 7920  n automatically 
+00018a80: 6361 6c6c 730a 6061 636b 2829 6020 6966  calls.`ack()` if
+00018a90: 2074 6865 2070 6f6c 6963 7920 6675 6e63   the policy func
+00018aa0: 7469 6f6e 2072 6574 7572 6e73 206e 6f72  tion returns nor
+00018ab0: 6d61 6c6c 792c 2061 6e64 2060 6e61 636b  mally, and `nack
+00018ac0: 2829 6020 6966 2069 7420 7261 6973 6573  ()` if it raises
+00018ad0: 2061 6e20 6578 6365 7074 696f 6e2c 0a70   an exception,.p
+00018ae0: 6572 6861 7073 2072 6574 7279 696e 6720  erhaps retrying 
+00018af0: 7468 6520 6576 656e 7420 666f 7220 6120  the event for a 
+00018b00: 6365 7274 6169 6e20 6e75 6d62 6572 206f  certain number o
+00018b10: 6620 7469 6d65 7320 6265 666f 7265 2070  f times before p
+00018b20: 6172 6b69 6e67 2074 6865 2065 7665 6e74  arking the event
+00018b30: 2e0a 0a54 6865 2073 696d 706c 6520 6578  ...The simple ex
+00018b40: 616d 706c 6520 6265 6c6f 7720 7368 6f77  ample below show
+00018b50: 7320 686f 7720 7468 6973 206d 6967 6874  s how this might
+00018b60: 2062 6520 646f 6e65 2e20 5765 2063 616e   be done. We can
+00018b70: 2073 6565 2074 6861 7420 2765 7665 6e74   see that 'event
+00018b80: 3927 2069 730a 6163 6b6e 6f77 6c65 6467  9' is.acknowledg
+00018b90: 6564 2062 6566 6f72 6520 2765 7665 6e74  ed before 'event
+00018ba0: 3527 2069 7320 6669 6e61 6c6c 7920 7061  5' is finally pa
+00018bb0: 726b 6564 2e0a 0a54 6865 2020 6e75 6d62  rked...The  numb
+00018bc0: 6572 206f 6620 7469 6d65 2061 2060 5265  er of time a `Re
+00018bd0: 636f 7264 6564 4576 656e 7460 2068 6173  cordedEvent` has
+00018be0: 2062 6565 6e20 7265 7472 6965 6420 6973   been retried is
+00018bf0: 2070 7265 7365 6e74 6564 2062 7920 7468   presented by th
+00018c00: 6520 6974 730a 6072 6574 7279 5f63 6f75  e its.`retry_cou
+00018c10: 6e74 6020 6174 7472 6962 7574 652e 0a0a  nt` attribute...
+00018c20: 6060 6070 7974 686f 6e0a 6163 6b65 645f  ```python.acked_
+00018c30: 6576 656e 7473 203d 207b 7d0a 6e61 636b  events = {}.nack
+00018c40: 6564 5f65 7665 6e74 7320 3d20 7b7d 0a0a  ed_events = {}..
+00018c50: 0a63 6c61 7373 2045 7861 6d70 6c65 436f  .class ExampleCo
+00018c60: 6e73 756d 6572 3a0a 2020 2020 6465 6620  nsumer:.    def 
+00018c70: 5f5f 696e 6974 5f5f 2873 656c 662c 2073  __init__(self, s
+00018c80: 7562 7363 7269 7074 696f 6e2c 206d 6178  ubscription, max
+00018c90: 5f72 6574 7279 5f63 6f75 6e74 2c20 6669  _retry_count, fi
+00018ca0: 6e61 6c5f 6163 7469 6f6e 293a 0a20 2020  nal_action):.   
+00018cb0: 2020 2020 2073 656c 662e 7375 6273 6372       self.subscr
+00018cc0: 6970 7469 6f6e 203d 2073 7562 7363 7269  iption = subscri
+00018cd0: 7074 696f 6e0a 2020 2020 2020 2020 7365  ption.        se
+00018ce0: 6c66 2e6d 6178 5f72 6574 7279 5f63 6f75  lf.max_retry_cou
+00018cf0: 6e74 203d 206d 6178 5f72 6574 7279 5f63  nt = max_retry_c
+00018d00: 6f75 6e74 0a20 2020 2020 2020 2073 656c  ount.        sel
+00018d10: 662e 6669 6e61 6c5f 6163 7469 6f6e 203d  f.final_action =
+00018d20: 2066 696e 616c 5f61 6374 696f 6e0a 2020   final_action.  
+00018d30: 2020 2020 2020 7365 6c66 2e65 7272 6f72        self.error
+00018d40: 203d 204e 6f6e 650a 0a20 2020 2064 6566   = None..    def
+00018d50: 2072 756e 2873 656c 6629 3a0a 2020 2020   run(self):.    
+00018d60: 2020 2020 7769 7468 2073 656c 662e 7375      with self.su
+00018d70: 6273 6372 6970 7469 6f6e 3a0a 2020 2020  bscription:.    
+00018d80: 2020 2020 2020 2020 666f 7220 6576 656e          for even
+00018d90: 7420 696e 2073 656c 662e 7375 6273 6372  t in self.subscr
+00018da0: 6970 7469 6f6e 3a0a 2020 2020 2020 2020  iption:.        
+00018db0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00018dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018dd0: 2073 656c 662e 706f 6c69 6379 2865 7665   self.policy(eve
+00018de0: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
+00018df0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+00018e00: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+00018e10: 2020 2020 2020 2020 2020 6966 2065 7665            if eve
+00018e20: 6e74 2e72 6574 7279 5f63 6f75 6e74 203c  nt.retry_count <
+00018e30: 2073 656c 662e 6d61 785f 7265 7472 795f   self.max_retry_
+00018e40: 636f 756e 743a 0a20 2020 2020 2020 2020  count:.         
+00018e50: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00018e60: 6374 696f 6e20 3d20 2272 6574 7279 220a  ction = "retry".
+00018e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00018e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ea0: 2020 6163 7469 6f6e 203d 2073 656c 662e    action = self.
+00018eb0: 6669 6e61 6c5f 6163 7469 6f6e 0a20 2020  final_action.   
+00018ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ed0: 2073 656c 662e 7375 6273 6372 6970 7469   self.subscripti
+00018ee0: 6f6e 2e6e 6163 6b28 6576 656e 742c 2061  on.nack(event, a
+00018ef0: 6374 696f 6e29 0a20 2020 2020 2020 2020  ction).         
+00018f00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018f10: 6166 7465 725f 6e61 636b 2865 7665 6e74  after_nack(event
+00018f20: 2c20 6163 7469 6f6e 290a 2020 2020 2020  , action).      
+00018f30: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00018f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f50: 2020 2020 7365 6c66 2e73 7562 7363 7269      self.subscri
+00018f60: 7074 696f 6e2e 6163 6b28 6576 656e 7429  ption.ack(event)
+00018f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018f80: 2020 2020 2073 656c 662e 6166 7465 725f       self.after_
+00018f90: 6163 6b28 6576 656e 7429 0a0a 2020 2020  ack(event)..    
+00018fa0: 6465 6620 7374 6f70 2873 656c 6629 3a0a  def stop(self):.
+00018fb0: 2020 2020 2020 2020 7365 6c66 2e73 7562          self.sub
+00018fc0: 7363 7269 7074 696f 6e2e 7374 6f70 2829  scription.stop()
+00018fd0: 0a0a 2020 2020 6465 6620 706f 6c69 6379  ..    def policy
+00018fe0: 2873 656c 662c 2065 7665 6e74 293a 0a20  (self, event):. 
+00018ff0: 2020 2020 2020 2023 2052 6169 7365 2061         # Raise a
+00019000: 6e20 6578 6365 7074 696f 6e20 7768 656e  n exception when
+00019010: 2077 6520 7365 6520 2265 7665 6e74 3522   we see "event5"
+00019020: 2e0a 2020 2020 2020 2020 6966 2065 7665  ..        if eve
+00019030: 6e74 203d 3d20 6576 656e 7435 3a0a 2020  nt == event5:.  
+00019040: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00019050: 4578 6365 7074 696f 6e28 290a 0a20 2020  Exception()..   
+00019060: 2064 6566 2061 6674 6572 5f61 636b 2873   def after_ack(s
+00019070: 656c 662c 2065 7665 6e74 293a 0a20 2020  elf, event):.   
+00019080: 2020 2020 2023 2054 7261 636b 2072 6574       # Track ret
+00019090: 7279 2063 6f75 6e74 206f 6620 6163 6b65  ry count of acke
+000190a0: 6420 6576 656e 7473 2e0a 2020 2020 2020  d events..      
+000190b0: 2020 6163 6b65 645f 6576 656e 7473 5b65    acked_events[e
+000190c0: 7665 6e74 2e69 645d 203d 2065 7665 6e74  vent.id] = event
+000190d0: 2e72 6574 7279 5f63 6f75 6e74 0a0a 2020  .retry_count..  
+000190e0: 2020 6465 6620 6166 7465 725f 6e61 636b    def after_nack
+000190f0: 2873 656c 662c 2065 7665 6e74 2c20 6163  (self, event, ac
+00019100: 7469 6f6e 293a 0a20 2020 2020 2020 2023  tion):.        #
+00019110: 2054 7261 636b 2072 6574 7279 2063 6f75   Track retry cou
+00019120: 6e74 206f 6620 6e61 636b 6564 2065 7665  nt of nacked eve
+00019130: 6e74 732e 0a20 2020 2020 2020 206e 6163  nts..        nac
+00019140: 6b65 645f 6576 656e 7473 5b65 7665 6e74  ked_events[event
+00019150: 2e69 645d 203d 2065 7665 6e74 2e72 6574  .id] = event.ret
+00019160: 7279 5f63 6f75 6e74 0a0a 2020 2020 2020  ry_count..      
+00019170: 2020 6966 2061 6374 696f 6e20 3d3d 2073    if action == s
+00019180: 656c 662e 6669 6e61 6c5f 6163 7469 6f6e  elf.final_action
+00019190: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000191a0: 5374 6f70 2074 6865 2063 6f6e 7375 6d65  Stop the consume
+000191b0: 722c 2073 6f20 7765 2063 616e 2063 6f6e  r, so we can con
+000191c0: 7469 6e75 6520 7769 7468 2074 6865 2065  tinue with the e
+000191d0: 7861 6d70 6c65 732e 0a20 2020 2020 2020  xamples..       
+000191e0: 2020 2020 2073 656c 662e 7374 6f70 2829       self.stop()
+000191f0: 0a0a 0a23 2043 7265 6174 6520 7375 6273  ...# Create subs
+00019200: 6372 6970 7469 6f6e 2e0a 6772 6f75 705f  cription..group_
+00019210: 6e61 6d65 203d 2066 2267 726f 7570 2d7b  name = f"group-{
+00019220: 7575 6964 2e75 7569 6434 2829 7d22 0a63  uuid.uuid4()}".c
+00019230: 6c69 656e 742e 6372 6561 7465 5f73 7562  lient.create_sub
+00019240: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
+00019250: 2867 726f 7570 5f6e 616d 652c 2063 6f6d  (group_name, com
+00019260: 6d69 745f 706f 7369 7469 6f6e 3d63 6f6d  mit_position=com
+00019270: 6d69 745f 706f 7369 7469 6f6e 3129 0a0a  mit_position1)..
+00019280: 2320 5265 6164 2073 7562 7363 7269 7074  # Read subscript
+00019290: 696f 6e2e 0a73 7562 7363 7269 7074 696f  ion..subscriptio
+000192a0: 6e20 3d20 636c 6965 6e74 2e72 6561 645f  n = client.read_
+000192b0: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+000192c0: 616c 6c28 6772 6f75 705f 6e61 6d65 290a  all(group_name).
+000192d0: 0a23 2043 6f6e 7374 7275 6374 2063 6f6e  .# Construct con
+000192e0: 7375 6d65 722e 0a63 6f6e 7375 6d65 7220  sumer..consumer 
+000192f0: 3d20 4578 616d 706c 6543 6f6e 7375 6d65  = ExampleConsume
+00019300: 7228 0a20 2020 2073 7562 7363 7269 7074  r(.    subscript
+00019310: 696f 6e3d 7375 6273 6372 6970 7469 6f6e  ion=subscription
+00019320: 2c0a 2020 2020 6d61 785f 7265 7472 795f  ,.    max_retry_
+00019330: 636f 756e 743d 352c 0a20 2020 2066 696e  count=5,.    fin
+00019340: 616c 5f61 6374 696f 6e3d 2270 6172 6b22  al_action="park"
+00019350: 2c0a 290a 0a23 2052 756e 2063 6f6e 7375  ,.)..# Run consu
+00019360: 6d65 722e 0a63 6f6e 7375 6d65 722e 7275  mer..consumer.ru
+00019370: 6e28 290a 0a23 2043 6865 636b 2027 6576  n()..# Check 'ev
+00019380: 656e 7435 2720 7761 7320 6e61 636b 6564  ent5' was nacked
+00019390: 2061 6e64 206e 6576 6572 2061 636b 6564   and never acked
+000193a0: 2e0a 6173 7365 7274 2065 7665 6e74 352e  ..assert event5.
+000193b0: 6964 2069 6e20 6e61 636b 6564 5f65 7665  id in nacked_eve
+000193c0: 6e74 730a 6173 7365 7274 2065 7665 6e74  nts.assert event
+000193d0: 352e 6964 206e 6f74 2069 6e20 6163 6b65  5.id not in acke
+000193e0: 645f 6576 656e 7473 0a61 7373 6572 7420  d_events.assert 
+000193f0: 6e61 636b 6564 5f65 7665 6e74 735b 6576  nacked_events[ev
+00019400: 656e 7435 2e69 645d 203d 3d20 350a 0a23  ent5.id] == 5..#
+00019410: 2043 6865 636b 2027 6576 656e 7439 2720   Check 'event9' 
+00019420: 7761 7320 6163 6b65 6420 616e 6420 6e65  was acked and ne
+00019430: 7665 7220 6e61 636b 6564 2e0a 6173 7365  ver nacked..asse
+00019440: 7274 2065 7665 6e74 392e 6964 2069 6e20  rt event9.id in 
+00019450: 6163 6b65 645f 6576 656e 7473 0a61 7373  acked_events.ass
+00019460: 6572 7420 6576 656e 7439 2e69 6420 6e6f  ert event9.id no
+00019470: 7420 696e 206e 6163 6b65 645f 6576 656e  t in nacked_even
+00019480: 7473 0a60 6060 0a0a 2323 2320 5570 6461  ts.```..### Upda
+00019490: 7465 2073 7562 7363 7269 7074 696f 6e20  te subscription 
+000194a0: 746f 2061 6c6c 3c61 2069 643d 2275 7064  to all<a id="upd
+000194b0: 6174 652d 7375 6273 6372 6970 7469 6f6e  ate-subscription
+000194c0: 2d74 6f2d 616c 6c22 3e3c 2f61 3e0a 0a2a  -to-all"></a>..*
+000194d0: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+000194e0: 0a0a 5468 6520 6075 7064 6174 655f 7375  ..The `update_su
+000194f0: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
+00019500: 6c28 2960 206d 6574 686f 6420 6361 6e20  l()` method can 
+00019510: 6265 2075 7365 6420 746f 2075 7064 6174  be used to updat
+00019520: 6520 610a 2270 6572 7369 7374 656e 7420  e a."persistent 
+00019530: 7375 6273 6372 6970 7469 6f6e 222e 2050  subscription". P
+00019540: 6c65 6173 6520 6e6f 7465 2c20 7468 6520  lease note, the 
+00019550: 6669 6c74 6572 206f 7074 696f 6e73 2061  filter options a
+00019560: 6e64 2063 6f6e 7375 6d65 720a 7374 7261  nd consumer.stra
+00019570: 7465 6779 2063 616e 6e6f 7420 6265 2061  tegy cannot be a
+00019580: 646a 7573 7465 642e 0a0a 5468 6973 206d  djusted...This m
+00019590: 6574 686f 6420 6861 7320 6120 7265 7175  ethod has a requ
+000195a0: 6972 6564 2060 6772 6f75 705f 6e61 6d65  ired `group_name
+000195b0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+000195c0: 6820 6973 2074 6865 0a6e 616d 6520 6f66  h is the.name of
+000195d0: 2061 2022 6772 6f75 7022 206f 6620 636f   a "group" of co
+000195e0: 6e73 756d 6572 7320 6f66 2074 6865 2073  nsumers of the s
+000195f0: 7562 7363 7269 7074 696f 6e2e 0a0a 5468  ubscription...Th
+00019600: 6973 206d 6574 686f 6420 616c 736f 2068  is method also h
+00019610: 6173 2073 6978 7465 656e 206f 7074 696f  as sixteen optio
+00019620: 6e61 6c20 6172 6775 6d65 6e74 732c 2060  nal arguments, `
+00019630: 6672 6f6d 5f65 6e64 602c 2060 636f 6d6d  from_end`, `comm
+00019640: 6974 5f70 6f73 6974 696f 6e60 2c0a 6072  it_position`,.`r
+00019650: 6573 6f6c 7665 5f6c 696e 6b73 602c 2060  esolve_links`, `
+00019660: 636f 6e73 756d 6572 5f73 7472 6174 6567  consumer_strateg
+00019670: 7960 2c20 606d 6573 7361 6765 5f74 696d  y`, `message_tim
+00019680: 656f 7574 602c 2060 6d61 785f 7265 7472  eout`, `max_retr
+00019690: 795f 636f 756e 7460 2c0a 606d 696e 5f63  y_count`,.`min_c
+000196a0: 6865 636b 706f 696e 745f 636f 756e 7460  heckpoint_count`
+000196b0: 2c20 606d 6178 5f63 6865 636b 706f 696e  , `max_checkpoin
+000196c0: 745f 636f 756e 7460 2c20 6063 6865 636b  t_count`, `check
+000196d0: 706f 696e 745f 6166 7465 7260 2c0a 606d  point_after`,.`m
+000196e0: 6178 5f73 7562 7363 7269 6265 725f 636f  ax_subscriber_co
+000196f0: 756e 7460 2c20 606c 6976 655f 6275 6666  unt`, `live_buff
+00019700: 6572 5f73 697a 6560 2c20 6072 6561 645f  er_size`, `read_
+00019710: 6261 7463 685f 7369 7a65 602c 2060 6869  batch_size`, `hi
+00019720: 7374 6f72 795f 6275 6666 6572 5f73 697a  story_buffer_siz
+00019730: 6560 2c0a 6065 7874 7261 5f73 7461 7469  e`,.`extra_stati
+00019740: 7374 6963 7360 2c20 6074 696d 656f 7574  stics`, `timeout
+00019750: 6020 616e 6420 6063 7265 6465 6e74 6961  ` and `credentia
+00019760: 6c73 602e 0a0a 5468 6520 6f70 7469 6f6e  ls`...The option
+00019770: 616c 2061 7267 756d 656e 7473 2060 6672  al arguments `fr
+00019780: 6f6d 5f65 6e64 602c 2060 636f 6d6d 6974  om_end`, `commit
+00019790: 5f70 6f73 6974 696f 6e60 2c0a 6072 6573  _position`,.`res
+000197a0: 6f6c 7665 5f6c 696e 6b73 602c 2060 636f  olve_links`, `co
+000197b0: 6e73 756d 6572 5f73 7472 6174 6567 7960  nsumer_strategy`
+000197c0: 2c20 606d 6573 7361 6765 5f74 696d 656f  , `message_timeo
+000197d0: 7574 602c 2060 6d61 785f 7265 7472 795f  ut`, `max_retry_
+000197e0: 636f 756e 7460 2c0a 606d 696e 5f63 6865  count`,.`min_che
+000197f0: 636b 706f 696e 745f 636f 756e 7460 2c20  ckpoint_count`, 
+00019800: 606d 6178 5f63 6865 636b 706f 696e 745f  `max_checkpoint_
+00019810: 636f 756e 7460 2c20 6063 6865 636b 706f  count`, `checkpo
+00019820: 696e 745f 6166 7465 7260 2c0a 606d 6178  int_after`,.`max
+00019830: 5f73 7562 7363 7269 6265 725f 636f 756e  _subscriber_coun
+00019840: 7460 2c20 606c 6976 655f 6275 6666 6572  t`, `live_buffer
+00019850: 5f73 697a 6560 2c20 6072 6561 645f 6261  _size`, `read_ba
+00019860: 7463 685f 7369 7a65 602c 2060 6869 7374  tch_size`, `hist
+00019870: 6f72 795f 6275 6666 6572 5f73 697a 6560  ory_buffer_size`
+00019880: 2c0a 616d 6420 6065 7874 7261 5f73 7461  ,.amd `extra_sta
+00019890: 7469 7374 6963 7360 2063 616e 2062 6520  tistics` can be 
+000198a0: 7573 6564 2074 6f20 6164 6a75 7374 2074  used to adjust t
+000198b0: 6865 2076 616c 7565 7320 7365 7420 6f6e  he values set on
+000198c0: 2070 7265 7669 6f75 7320 6361 6c6c 7320   previous calls 
+000198d0: 746f 0a60 6372 6561 7465 5f73 7562 7363  to.`create_subsc
+000198e0: 7269 7074 696f 6e5f 746f 5f61 6c6c 2829  ription_to_all()
+000198f0: 6020 616e 6420 6075 7064 6174 655f 7375  ` and `update_su
+00019900: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
+00019910: 6c28 2960 2e20 4966 2061 6e79 206f 660a  l()`. If any of.
+00019920: 7468 6573 6520 6172 6775 6d65 6e74 7320  these arguments 
+00019930: 6172 6520 6e6f 7420 6d65 6e74 696f 6e65  are not mentione
+00019940: 6420 696e 2061 2063 616c 6c20 746f 2060  d in a call to `
+00019950: 7570 6461 7465 5f73 7562 7363 7269 7074  update_subscript
+00019960: 696f 6e5f 746f 5f61 6c6c 2829 602c 0a74  ion_to_all()`,.t
+00019970: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
+00019980: 2073 6574 7469 6e67 7320 6f66 2074 6865   settings of the
+00019990: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+000199a0: 6372 6970 7469 6f6e 2077 696c 6c20 6265  cription will be
+000199b0: 2075 6e63 6861 6e67 6564 2e0a 0a54 6865   unchanged...The
+000199c0: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+000199d0: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
+000199e0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+000199f0: 2077 6869 6368 2073 6574 7320 610a 6d61   which sets a.ma
+00019a00: 7869 6d75 6d20 6475 7261 7469 6f6e 2c20  ximum duration, 
+00019a10: 696e 2073 6563 6f6e 6473 2c20 666f 7220  in seconds, for 
+00019a20: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+00019a30: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+00019a40: 7469 6f6e 2e0a 0a54 6865 206f 7074 696f  tion...The optio
+00019a50: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
+00019a60: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
+00019a70: 6520 7573 6564 2074 6f0a 6f76 6572 7269  e used to.overri
+00019a80: 6465 2063 616c 6c20 6372 6564 656e 7469  de call credenti
+00019a90: 616c 7320 6465 7269 7665 6420 6672 6f6d  als derived from
+00019aa0: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+00019ab0: 7374 7269 6e67 2055 5249 2e0a 0a54 6865  string URI...The
+00019ac0: 206d 6574 686f 6420 6075 7064 6174 655f   method `update_
+00019ad0: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+00019ae0: 616c 6c28 2960 2064 6f65 7320 6e6f 7420  all()` does not 
+00019af0: 7265 7475 726e 2061 2076 616c 7565 2e0a  return a value..
+00019b00: 0a49 6e20 7468 6520 6578 616d 706c 6520  .In the example 
+00019b10: 6265 6c6f 772c 2061 2070 6572 7369 7374  below, a persist
+00019b20: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+00019b30: 2069 7320 7570 6461 7465 6420 746f 2072   is updated to r
+00019b40: 756e 2066 726f 6d20 7468 6520 656e 6420  un from the end 
+00019b50: 6f66 2074 6865 0a64 6174 6162 6173 652e  of the.database.
+00019b60: 0a0a 6060 6070 7974 686f 6e0a 2320 4372  ..```python.# Cr
+00019b70: 6561 7465 2061 2070 6572 7369 7374 656e  eate a persisten
+00019b80: 7420 7375 6273 6372 6970 7469 6f6e 2e0a  t subscription..
+00019b90: 636c 6965 6e74 2e75 7064 6174 655f 7375  client.update_su
+00019ba0: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
+00019bb0: 6c28 6772 6f75 705f 6e61 6d65 3d67 726f  l(group_name=gro
+00019bc0: 7570 5f6e 616d 6531 2c20 6672 6f6d 5f65  up_name1, from_e
+00019bd0: 6e64 3d54 7275 6529 0a60 6060 0a0a 2323  nd=True).```..##
+00019be0: 2320 4372 6561 7465 2073 7562 7363 7269  # Create subscri
+00019bf0: 7074 696f 6e20 746f 2073 7472 6561 6d3c  ption to stream<
+00019c00: 6120 6964 3d22 6372 6561 7465 2d73 7562  a id="create-sub
+00019c10: 7363 7269 7074 696f 6e2d 746f 2d73 7472  scription-to-str
+00019c20: 6561 6d22 3e3c 2f61 3e0a 0a2a 7265 7175  eam"></a>..*requ
+00019c30: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
+00019c40: 6520 6063 7265 6174 655f 7375 6273 6372  e `create_subscr
+00019c50: 6970 7469 6f6e 5f74 6f5f 7374 7265 616d  iption_to_stream
+00019c60: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+00019c70: 6520 7573 6564 2074 6f20 6372 6561 7465  e used to create
+00019c80: 2061 2070 6572 7369 7374 656e 740a 7375   a persistent.su
+00019c90: 6273 6372 6970 7469 6f6e 2074 6f20 6120  bscription to a 
+00019ca0: 7374 7265 616d 2e0a 0a54 6869 7320 6d65  stream...This me
+00019cb0: 7468 6f64 2068 6173 2074 776f 2072 6571  thod has two req
+00019cc0: 7569 7265 6420 6172 6775 6d65 6e74 732c  uired arguments,
+00019cd0: 2060 6772 6f75 705f 6e61 6d65 6020 616e   `group_name` an
+00019ce0: 6420 6073 7472 6561 6d5f 6e61 6d65 602e  d `stream_name`.
+00019cf0: 2054 6865 0a60 6772 6f75 705f 6e61 6d65   The.`group_name
+00019d00: 6020 6172 6775 6d65 6e74 206e 616d 6573  ` argument names
+00019d10: 2074 6865 2067 726f 7570 206f 6620 636f   the group of co
+00019d20: 6e73 756d 6572 7320 7468 6174 2077 696c  nsumers that wil
+00019d30: 6c20 7265 6365 6976 6520 6576 656e 7473  l receive events
+00019d40: 0a66 726f 6d20 7468 6973 2073 7562 7363  .from this subsc
+00019d50: 7269 7074 696f 6e2e 2054 6865 2060 7374  ription. The `st
+00019d60: 7265 616d 5f6e 616d 6560 2061 7267 756d  ream_name` argum
+00019d70: 656e 7420 7370 6563 6966 6965 7320 7768  ent specifies wh
+00019d80: 6963 6820 7374 7265 616d 0a74 6865 2073  ich stream.the s
+00019d90: 7562 7363 7269 7074 696f 6e20 7769 6c6c  ubscription will
+00019da0: 2066 6f6c 6c6f 772e 2054 6865 2076 616c   follow. The val
+00019db0: 7565 7320 6f66 2062 6f74 6820 7468 6573  ues of both thes
+00019dc0: 6520 6172 6775 6d65 6e74 7320 6172 6520  e arguments are 
+00019dd0: 6578 7065 6374 6564 0a74 6f20 6265 2050  expected.to be P
+00019de0: 7974 686f 6e20 6073 7472 6020 6f62 6a65  ython `str` obje
+00019df0: 6374 732e 0a0a 5468 6973 206d 6574 686f  cts...This metho
+00019e00: 6420 616c 736f 2068 6173 2073 6978 7465  d also has sixte
+00019e10: 656e 206f 7074 696f 6e61 6c20 6172 6775  en optional argu
+00019e20: 6d65 6e74 732c 2060 7374 7265 616d 5f70  ments, `stream_p
+00019e30: 6f73 6974 696f 6e60 2c20 6066 726f 6d5f  osition`, `from_
+00019e40: 656e 6460 2c0a 6072 6573 6f6c 7665 5f6c  end`,.`resolve_l
+00019e50: 696e 6b73 602c 2060 636f 6e73 756d 6572  inks`, `consumer
+00019e60: 5f73 7472 6174 6567 7960 2c20 606d 6573  _strategy`, `mes
+00019e70: 7361 6765 5f74 696d 656f 7574 602c 2060  sage_timeout`, `
+00019e80: 6d61 785f 7265 7472 795f 636f 756e 7460  max_retry_count`
+00019e90: 2c0a 606d 696e 5f63 6865 636b 706f 696e  ,.`min_checkpoin
+00019ea0: 745f 636f 756e 7460 2c20 606d 6178 5f63  t_count`, `max_c
+00019eb0: 6865 636b 706f 696e 745f 636f 756e 7460  heckpoint_count`
+00019ec0: 2c20 6063 6865 636b 706f 696e 745f 6166  , `checkpoint_af
+00019ed0: 7465 7260 2c0a 606d 6178 5f73 7562 7363  ter`,.`max_subsc
+00019ee0: 7269 6265 725f 636f 756e 7460 2c20 606c  riber_count`, `l
+00019ef0: 6976 655f 6275 6666 6572 5f73 697a 6560  ive_buffer_size`
+00019f00: 2c20 6072 6561 645f 6261 7463 685f 7369  , `read_batch_si
+00019f10: 7a65 602c 2060 6869 7374 6f72 795f 6275  ze`, `history_bu
+00019f20: 6666 6572 5f73 697a 6560 2c0a 6065 7874  ffer_size`,.`ext
+00019f30: 7261 5f73 7461 7469 7374 6963 7360 2c20  ra_statistics`, 
+00019f40: 6074 696d 656f 7574 6020 616e 6420 6063  `timeout` and `c
+00019f50: 7265 6465 6e74 6961 6c73 602e 0a0a 5468  redentials`...Th
+00019f60: 6520 6f70 7469 6f6e 616c 2060 7374 7265  e optional `stre
+00019f70: 616d 5f70 6f73 6974 696f 6e60 2061 7267  am_position` arg
+00019f80: 756d 656e 7420 7370 6563 6966 6965 7320  ument specifies 
+00019f90: 6120 7374 7265 616d 2070 6f73 6974 696f  a stream positio
+00019fa0: 6e20 6672 6f6d 0a77 6869 6368 2074 6f20  n from.which to 
+00019fb0: 7375 6273 6372 6962 652e 2054 6865 2072  subscribe. The r
+00019fc0: 6563 6f72 6465 6420 6576 656e 7420 6174  ecorded event at
+00019fd0: 2074 6869 7320 7374 7265 616d 0a70 6f73   this stream.pos
+00019fe0: 6974 696f 6e20 7769 6c6c 2062 6520 7265  ition will be re
+00019ff0: 6365 6976 6564 2077 6865 6e20 7265 6164  ceived when read
+0001a000: 696e 6720 7468 6520 7375 6273 6372 6970  ing the subscrip
+0001a010: 7469 6f6e 2e0a 0a54 6865 206f 7074 696f  tion...The optio
+0001a020: 6e61 6c20 6066 726f 6d5f 656e 6460 2061  nal `from_end` a
+0001a030: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0001a040: 686f 6e20 6062 6f6f 6c60 2e0a 4279 2064  hon `bool`..By d
+0001a050: 6566 6175 6c74 2c20 7468 6520 7661 6c75  efault, the valu
+0001a060: 6520 6f66 2074 6869 7320 6172 6775 6d65  e of this argume
+0001a070: 6e74 2069 7320 6046 616c 7365 602e 2049  nt is `False`. I
+0001a080: 6620 7468 6973 2061 7267 756d 656e 7420  f this argument 
+0001a090: 6973 2073 6574 0a74 6f20 6054 7275 6560  is set.to `True`
+0001a0a0: 2c20 7265 6164 696e 6720 6672 6f6d 2074  , reading from t
+0001a0b0: 6865 2073 7562 7363 7269 7074 696f 6e20  he subscription 
+0001a0c0: 7769 6c6c 2072 6563 6569 7665 206f 6e6c  will receive onl
+0001a0d0: 7920 6576 656e 7473 0a72 6563 6f72 6465  y events.recorde
+0001a0e0: 6420 6166 7465 7220 7468 6520 7375 6273  d after the subs
+0001a0f0: 6372 6970 7469 6f6e 2077 6173 2063 7265  cription was cre
+0001a100: 6174 6564 2e20 5468 6174 2069 732c 2069  ated. That is, i
+0001a110: 7420 6973 206e 6f74 2069 6e63 6c75 7369  t is not inclusi
+0001a120: 7665 0a6f 6620 7468 6520 6375 7272 656e  ve.of the curren
+0001a130: 7420 7374 7265 616d 2070 6f73 6974 696f  t stream positio
+0001a140: 6e2e 0a0a 5468 6520 6f70 7469 6f6e 616c  n...The optional
+0001a150: 2060 7265 736f 6c76 655f 6c69 6e6b 7360   `resolve_links`
+0001a160: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+0001a170: 7974 686f 6e20 6062 6f6f 6c60 2e20 5468  ython `bool`. Th
+0001a180: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+0001a190: 6f66 2060 7265 736f 6c76 655f 6c69 6e6b  of `resolve_link
+0001a1a0: 7360 0a69 7320 6046 616c 7365 602c 2077  s`.is `False`, w
+0001a1b0: 6869 6368 206d 6561 6e73 2061 6e79 2065  hich means any e
+0001a1c0: 7665 6e74 206c 696e 6b73 2077 696c 6c20  vent links will 
+0001a1d0: 6e6f 7420 6265 2072 6573 6f6c 7665 642c  not be resolved,
+0001a1e0: 2073 6f20 7468 6174 2074 6865 2065 7665   so that the eve
+0001a1f0: 6e74 7320 7468 6174 2061 7265 0a72 6574  nts that are.ret
+0001a200: 7572 6e65 6420 6d61 7920 7265 7072 6573  urned may repres
+0001a210: 656e 7420 6576 656e 7420 6c69 6e6b 732e  ent event links.
+0001a220: 2049 6620 6072 6573 6f6c 7665 5f6c 696e   If `resolve_lin
+0001a230: 6b73 6020 6973 2060 5472 7565 602c 2061  ks` is `True`, a
+0001a240: 6e79 2065 7665 6e74 206c 696e 6b73 2077  ny event links w
+0001a250: 696c 6c0a 6265 2072 6573 6f6c 7665 642c  ill.be resolved,
+0001a260: 2073 6f20 7468 6174 2074 6865 206c 696e   so that the lin
+0001a270: 6b65 6420 6576 656e 7473 2077 696c 6c20  ked events will 
+0001a280: 6265 2072 6574 7572 6e65 6420 696e 7374  be returned inst
+0001a290: 6561 6420 6f66 2074 6865 2065 7665 6e74  ead of the event
+0001a2a0: 206c 696e 6b73 2e0a 0a54 6865 206f 7074   links...The opt
+0001a2b0: 696f 6e61 6c20 6063 6f6e 7375 6d65 725f  ional `consumer_
+0001a2c0: 7374 7261 7465 6779 6020 6172 6775 6d65  strategy` argume
+0001a2d0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+0001a2e0: 7374 7260 2074 6861 7420 6465 6669 6e65  str` that define
+0001a2f0: 730a 7468 6520 636f 6e73 756d 6572 2073  s.the consumer s
+0001a300: 7472 6174 6567 7920 666f 7220 7468 6973  trategy for this
+0001a310: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+0001a320: 6372 6970 7469 6f6e 2e20 5468 6520 7661  cription. The va
+0001a330: 6c75 6520 6f66 2074 6869 7320 6172 6775  lue of this argu
+0001a340: 6d65 6e74 0a63 616e 2062 6520 6027 4469  ment.can be `'Di
+0001a350: 7370 6174 6368 546f 5369 6e67 6c65 2760  spatchToSingle'`
+0001a360: 2c20 6027 526f 756e 6452 6f62 696e 2760  , `'RoundRobin'`
+0001a370: 2c20 6027 5069 6e6e 6564 2760 2c20 6f72  , `'Pinned'`, or
+0001a380: 2060 2750 696e 6e65 6442 7943 6f72 7265   `'PinnedByCorre
+0001a390: 6c61 7469 6f6e 2760 2e20 5468 650a 6465  lation'`. The.de
+0001a3a0: 6661 756c 7420 7661 6c75 6520 6973 2060  fault value is `
+0001a3b0: 2744 6973 7061 7463 6854 6f53 696e 676c  'DispatchToSingl
+0001a3c0: 6527 602e 0a0a 5468 6520 6f70 7469 6f6e  e'`...The option
+0001a3d0: 616c 2060 6d65 7373 6167 655f 7469 6d65  al `message_time
+0001a3e0: 6f75 7460 2061 7267 756d 656e 7420 6973  out` argument is
+0001a3f0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+0001a400: 6020 7768 6963 6820 7365 7473 2061 206d  ` which sets a m
+0001a410: 6178 696d 756d 2064 7572 6174 696f 6e2c  aximum duration,
+0001a420: 0a69 6e20 7365 636f 6e64 732c 2066 726f  .in seconds, fro
+0001a430: 6d20 7468 6520 7365 7276 6572 2073 656e  m the server sen
+0001a440: 6469 6e67 2061 2072 6563 6f72 6465 6420  ding a recorded 
+0001a450: 6576 656e 7420 746f 2061 2063 6f6e 7375  event to a consu
+0001a460: 6d65 7220 6f66 2074 6865 2070 6572 7369  mer of the persi
+0001a470: 7374 656e 740a 7375 6273 6372 6970 7469  stent.subscripti
+0001a480: 6f6e 2075 6e74 696c 2065 6974 6865 7220  on until either 
+0001a490: 616e 2022 6163 6b6e 6f77 6c65 6467 656d  an "acknowledgem
+0001a4a0: 656e 7422 2028 6163 6b29 206f 7220 6120  ent" (ack) or a 
+0001a4b0: 226e 6567 6174 6976 6520 6163 6b6e 6f77  "negative acknow
+0001a4c0: 6c65 6467 656d 656e 7422 0a28 6e61 636b  ledgement".(nack
+0001a4d0: 2920 6973 2072 6563 6569 7665 6420 6279  ) is received by
+0001a4e0: 2074 6865 2073 6572 7665 722c 2061 6674   the server, aft
+0001a4f0: 6572 2077 6869 6368 2074 6865 2073 6572  er which the ser
+0001a500: 7665 7220 7769 6c6c 2072 6574 7279 2074  ver will retry t
+0001a510: 6f20 7365 6e64 2074 6865 2065 7665 6e74  o send the event
+0001a520: 2e0a 5468 6520 6465 6661 756c 7420 7661  ..The default va
+0001a530: 6c75 6520 6f66 2060 6d65 7373 6167 655f  lue of `message_
+0001a540: 7469 6d65 6f75 7460 2069 7320 6033 302e  timeout` is `30.
+0001a550: 3060 2e0a 0a54 6865 206f 7074 696f 6e61  0`...The optiona
+0001a560: 6c20 606d 6178 5f72 6574 7279 5f63 6f75  l `max_retry_cou
+0001a570: 6e74 6020 6172 6775 6d65 6e74 2069 7320  nt` argument is 
+0001a580: 6120 5079 7468 6f6e 2060 696e 7460 2077  a Python `int` w
+0001a590: 6869 6368 2073 6574 7320 7468 6520 6e75  hich sets the nu
+0001a5a0: 6d62 6572 206f 6620 7469 6d65 730a 7468  mber of times.th
+0001a5b0: 6520 7365 7276 6572 2077 696c 6c20 7265  e server will re
+0001a5c0: 7472 7920 746f 2073 656e 6420 616e 2065  try to send an e
+0001a5d0: 7665 6e74 2e20 5468 6520 6465 6661 756c  vent. The defaul
+0001a5e0: 7420 7661 6c75 6520 6f66 2060 6d61 785f  t value of `max_
+0001a5f0: 7265 7472 795f 636f 756e 7460 2069 7320  retry_count` is 
+0001a600: 6031 3060 2e0a 0a54 6865 206f 7074 696f  `10`...The optio
+0001a610: 6e61 6c20 606d 696e 5f63 6865 636b 706f  nal `min_checkpo
+0001a620: 696e 745f 636f 756e 7460 2061 7267 756d  int_count` argum
+0001a630: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+0001a640: 6069 6e74 6020 7768 6963 6820 7365 7473  `int` which sets
+0001a650: 2074 6865 206d 696e 696d 756d 0a6e 756d   the minimum.num
+0001a660: 6265 7220 6f66 2022 6163 6b6e 6f77 6c65  ber of "acknowle
+0001a670: 6467 656d 656e 7473 2220 2861 636b 7329  dgements" (acks)
+0001a680: 2072 6563 6569 7665 6420 6279 2074 6865   received by the
+0001a690: 2073 6572 7665 7220 6265 666f 7265 2074   server before t
+0001a6a0: 6865 2073 6572 7665 7220 6d61 7920 7265  he server may re
+0001a6b0: 636f 7264 0a74 6865 2061 636b 6e6f 776c  cord.the acknowl
+0001a6c0: 6564 6765 6d65 6e74 732e 2054 6865 2064  edgements. The d
+0001a6d0: 6566 6175 6c74 2076 616c 7565 206f 6620  efault value of 
+0001a6e0: 606d 696e 5f63 6865 636b 706f 696e 745f  `min_checkpoint_
+0001a6f0: 636f 756e 7460 2069 7320 6031 3060 2e0a  count` is `10`..
+0001a700: 0a54 6865 206f 7074 696f 6e61 6c20 606d  .The optional `m
+0001a710: 6178 5f63 6865 636b 706f 696e 745f 636f  ax_checkpoint_co
+0001a720: 756e 7460 2061 7267 756d 656e 7420 6973  unt` argument is
+0001a730: 2061 2050 7974 686f 6e20 6069 6e74 6020   a Python `int` 
+0001a740: 7768 6963 6820 7365 7473 2074 6865 206d  which sets the m
+0001a750: 6178 696d 756d 0a6e 756d 6265 7220 6f66  aximum.number of
+0001a760: 2022 6163 6b6e 6f77 6c65 6467 656d 656e   "acknowledgemen
+0001a770: 7473 2220 2861 636b 7329 2072 6563 6569  ts" (acks) recei
+0001a780: 7665 6420 6279 2074 6865 2073 6572 7665  ved by the serve
+0001a790: 7220 6265 666f 7265 2074 6865 2073 6572  r before the ser
+0001a7a0: 7665 7220 6d75 7374 0a72 6563 6f72 6420  ver must.record 
+0001a7b0: 7468 6520 6163 6b6e 6f77 6c65 6467 656d  the acknowledgem
+0001a7c0: 656e 7473 2e20 5468 6520 6465 6661 756c  ents. The defaul
+0001a7d0: 7420 7661 6c75 6520 6f66 2060 6d61 785f  t value of `max_
+0001a7e0: 6368 6563 6b70 6f69 6e74 5f63 6f75 6e74  checkpoint_count
+0001a7f0: 6020 6973 2060 3130 3030 602e 0a0a 5468  ` is `1000`...Th
+0001a800: 6520 6f70 7469 6f6e 616c 2060 6368 6563  e optional `chec
+0001a810: 6b70 6f69 6e74 5f61 6674 6572 6020 6172  kpoint_after` ar
+0001a820: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0001a830: 6f6e 2060 666c 6f61 7460 2077 6869 6368  on `float` which
+0001a840: 2073 6574 7320 7468 6520 6d61 7869 6d75   sets the maximu
+0001a850: 6d0a 6475 7261 7469 6f6e 2069 6e20 7365  m.duration in se
+0001a860: 636f 6e64 7320 6265 7477 6565 6e20 7265  conds between re
+0001a870: 636f 7264 696e 6720 2261 636b 6e6f 776c  cording "acknowl
+0001a880: 6564 6765 6d65 6e74 7322 2028 6163 6b73  edgements" (acks
+0001a890: 292e 2054 6865 2064 6566 6175 6c74 2076  ). The default v
+0001a8a0: 616c 7565 206f 660a 6063 6865 636b 706f  alue of.`checkpo
+0001a8b0: 696e 745f 6166 7465 7260 2069 7320 6032  int_after` is `2
+0001a8c0: 2e30 602e 0a0a 5468 6520 6f70 7469 6f6e  .0`...The option
+0001a8d0: 616c 2060 6d61 785f 7375 6273 6372 6962  al `max_subscrib
+0001a8e0: 6572 5f63 6f75 6e74 6020 6172 6775 6d65  er_count` argume
+0001a8f0: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+0001a900: 696e 7460 2077 6869 6368 2073 6574 7320  int` which sets 
+0001a910: 7468 6520 6d61 7869 6d75 6d0a 6e75 6d62  the maximum.numb
+0001a920: 6572 206f 6620 636f 6e63 7572 7265 6e74  er of concurrent
+0001a930: 2072 6561 6465 7273 206f 6620 7468 6520   readers of the 
+0001a940: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+0001a950: 7269 7074 696f 6e2c 2062 6579 6f6e 6420  ription, beyond 
+0001a960: 7768 6963 6820 6174 7465 6d70 7473 2074  which attempts t
+0001a970: 6f0a 7265 6164 2074 6865 2070 6572 7369  o.read the persi
+0001a980: 7374 656e 7420 7375 6273 6372 6970 7469  stent subscripti
+0001a990: 6f6e 2077 696c 6c20 7261 6973 6520 6120  on will raise a 
+0001a9a0: 604d 6178 696d 756d 5375 6273 6372 6970  `MaximumSubscrip
+0001a9b0: 7469 6f6e 7352 6561 6368 6564 6020 6572  tionsReached` er
+0001a9c0: 726f 722e 0a0a 5468 6520 6f70 7469 6f6e  ror...The option
+0001a9d0: 616c 2060 6c69 7665 5f62 7566 6665 725f  al `live_buffer_
+0001a9e0: 7369 7a65 6020 6172 6775 6d65 6e74 2069  size` argument i
+0001a9f0: 7320 6120 5079 7468 6f6e 2060 696e 7460  s a Python `int`
+0001aa00: 2077 6869 6368 2073 6574 7320 7468 6520   which sets the 
+0001aa10: 7369 7a65 206f 6620 7468 650a 6275 6666  size of the.buff
+0001aa20: 6572 2028 696e 2d6d 656d 6f72 7929 2068  er (in-memory) h
+0001aa30: 6f6c 6469 6e67 206e 6577 6c79 2072 6563  olding newly rec
+0001aa40: 6f72 6465 6420 6576 656e 7473 2e20 5468  orded events. Th
+0001aa50: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+0001aa60: 6f66 2060 6c69 7665 5f62 7566 6665 725f  of `live_buffer_
+0001aa70: 7369 7a65 600a 6973 2035 3030 2e0a 0a54  size`.is 500...T
+0001aa80: 6865 206f 7074 696f 6e61 6c20 6072 6561  he optional `rea
+0001aa90: 645f 6261 7463 685f 7369 7a65 6020 6172  d_batch_size` ar
+0001aaa0: 6775 6d65 6e74 2069 7320 6120 5079 7468  gument is a Pyth
+0001aab0: 6f6e 2060 696e 7460 2077 6869 6368 2073  on `int` which s
+0001aac0: 6574 7320 7468 6520 6e75 6d62 6572 206f  ets the number o
+0001aad0: 660a 7265 636f 7264 6564 2065 7665 6e74  f.recorded event
+0001aae0: 7320 7265 6164 2066 726f 6d20 6469 736b  s read from disk
+0001aaf0: 2077 6865 6e20 6361 7463 6869 6e67 2075   when catching u
+0001ab00: 702e 2054 6865 2064 6566 6175 6c74 2076  p. The default v
+0001ab10: 616c 7565 206f 6620 6072 6561 645f 6261  alue of `read_ba
+0001ab20: 7463 685f 7369 7a65 600a 6973 2032 3030  tch_size`.is 200
+0001ab30: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001ab40: 6068 6973 746f 7279 5f62 7566 6665 725f  `history_buffer_
+0001ab50: 7369 7a65 6020 6172 6775 6d65 6e74 2069  size` argument i
+0001ab60: 7320 6120 5079 7468 6f6e 2060 696e 7460  s a Python `int`
+0001ab70: 2077 6869 6368 2073 6574 7320 7468 6520   which sets the 
+0001ab80: 6e75 6d62 6572 206f 660a 7265 636f 7264  number of.record
+0001ab90: 6564 2065 7665 6e74 7320 746f 2063 6163  ed events to cac
+0001aba0: 6865 2069 6e20 6d65 6d6f 7279 2077 6865  he in memory whe
+0001abb0: 6e20 6361 7463 6869 6e67 2075 702e 2054  n catching up. T
+0001abc0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0001abd0: 206f 6620 6068 6973 746f 7279 5f62 7566   of `history_buf
+0001abe0: 6665 725f 7369 7a65 600a 6973 2035 3030  fer_size`.is 500
+0001abf0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001ac00: 6065 7874 7261 5f73 7461 7469 7374 6963  `extra_statistic
+0001ac10: 7360 2061 7267 756d 656e 7420 6973 2061  s` argument is a
+0001ac20: 2050 7974 686f 6e20 6062 6f6f 6c60 2077   Python `bool` w
+0001ac30: 6869 6368 2065 6e61 626c 6573 2074 7261  hich enables tra
+0001ac40: 636b 696e 6720 6f66 0a65 7874 7261 2073  cking of.extra s
+0001ac50: 7461 7469 7374 6963 7320 6f6e 2074 6869  tatistics on thi
+0001ac60: 7320 7375 6273 6372 6970 7469 6f6e 2e20  s subscription. 
+0001ac70: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+0001ac80: 6520 6f66 2060 6578 7472 615f 7374 6174  e of `extra_stat
+0001ac90: 6973 7469 6373 6020 6973 2060 4661 6c73  istics` is `Fals
+0001aca0: 6560 2e0a 0a54 6865 206f 7074 696f 6e61  e`...The optiona
+0001acb0: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+0001acc0: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+0001acd0: 2060 666c 6f61 7460 2077 6869 6368 2073   `float` which s
+0001ace0: 6574 7320 610a 6d61 7869 6d75 6d20 6475  ets a.maximum du
+0001acf0: 7261 7469 6f6e 2c20 696e 2073 6563 6f6e  ration, in secon
+0001ad00: 6473 2c20 666f 7220 7468 6520 636f 6d70  ds, for the comp
+0001ad10: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+0001ad20: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+0001ad30: 6865 206f 7074 696f 6e61 6c20 6063 7265  he optional `cre
+0001ad40: 6465 6e74 6961 6c73 6020 6172 6775 6d65  dentials` argume
+0001ad50: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+0001ad60: 6f0a 6f76 6572 7269 6465 2063 616c 6c20  o.override call 
+0001ad70: 6372 6564 656e 7469 616c 7320 6465 7269  credentials deri
+0001ad80: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
+0001ad90: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
+0001ada0: 5249 2e0a 0a54 6869 7320 6d65 7468 6f64  RI...This method
+0001adb0: 2064 6f65 7320 6e6f 7420 7265 7475 726e   does not return
+0001adc0: 2061 2076 616c 7565 2e20 4576 656e 7473   a value. Events
+0001add0: 2063 616e 2062 6520 7265 6365 6976 6564   can be received
+0001ade0: 2062 7920 6361 6c6c 696e 670a 6072 6561   by calling.`rea
+0001adf0: 645f 7375 6273 6372 6970 7469 6f6e 5f74  d_subscription_t
+0001ae00: 6f5f 7374 7265 616d 2829 602e 0a0a 5468  o_stream()`...Th
+0001ae10: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+0001ae20: 6372 6561 7465 7320 6120 7065 7273 6973  creates a persis
+0001ae30: 7465 6e74 2073 7472 6561 6d20 7375 6273  tent stream subs
+0001ae40: 6372 6970 7469 6f6e 2066 726f 6d20 7468  cription from th
+0001ae50: 6520 7374 6172 7420 6f66 2074 6865 2073  e start of the s
+0001ae60: 7472 6561 6d2e 0a0a 6060 6070 7974 686f  tream...```pytho
+0001ae70: 6e0a 2320 4372 6561 7465 2061 2070 6572  n.# Create a per
+0001ae80: 7369 7374 656e 7420 7374 7265 616d 2073  sistent stream s
+0001ae90: 7562 7363 7269 7074 696f 6e20 6672 6f6d  ubscription from
+0001aea0: 2073 7461 7274 206f 6620 7468 6520 7374   start of the st
+0001aeb0: 7265 616d 2e0a 6772 6f75 705f 6e61 6d65  ream..group_name
+0001aec0: 3220 3d20 6622 6772 6f75 702d 7b75 7569  2 = f"group-{uui
+0001aed0: 642e 7575 6964 3428 297d 220a 636c 6965  d.uuid4()}".clie
+0001aee0: 6e74 2e63 7265 6174 655f 7375 6273 6372  nt.create_subscr
+0001aef0: 6970 7469 6f6e 5f74 6f5f 7374 7265 616d  iption_to_stream
+0001af00: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
+0001af10: 3d67 726f 7570 5f6e 616d 6532 2c0a 2020  =group_name2,.  
+0001af20: 2020 7374 7265 616d 5f6e 616d 653d 7374    stream_name=st
+0001af30: 7265 616d 5f6e 616d 6532 2c0a 290a 6060  ream_name2,.).``
+0001af40: 600a 0a23 2323 2052 6561 6420 7375 6273  `..### Read subs
+0001af50: 6372 6970 7469 6f6e 2074 6f20 7374 7265  cription to stre
+0001af60: 616d 3c61 2069 643d 2272 6561 642d 7375  am<a id="read-su
+0001af70: 6273 6372 6970 7469 6f6e 2d74 6f2d 7374  bscription-to-st
+0001af80: 7265 616d 223e 3c2f 613e 0a0a 2a72 6571  ream"></a>..*req
+0001af90: 7569 7265 7320 6c65 6164 6572 2a0a 0a54  uires leader*..T
+0001afa0: 6865 2060 7265 6164 5f73 7562 7363 7269  he `read_subscri
+0001afb0: 7074 696f 6e5f 746f 5f73 7472 6561 6d28  ption_to_stream(
+0001afc0: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+0001afd0: 2075 7365 6420 746f 2072 6561 6420 6120   used to read a 
+0001afe0: 7065 7273 6973 7465 6e74 0a73 7562 7363  persistent.subsc
+0001aff0: 7269 7074 696f 6e20 746f 2061 2073 7472  ription to a str
+0001b000: 6561 6d2e 0a0a 5468 6973 206d 6574 686f  eam...This metho
+0001b010: 6420 6861 7320 7477 6f20 7265 7175 6972  d has two requir
+0001b020: 6564 2061 7267 756d 656e 7473 2c20 6067  ed arguments, `g
+0001b030: 726f 7570 5f6e 616d 6560 2061 6e64 2060  roup_name` and `
+0001b040: 7374 7265 616d 5f6e 616d 6560 2c20 7768  stream_name`, wh
+0001b050: 6963 680a 7368 6f75 6c64 206d 6174 6368  ich.should match
+0001b060: 2074 6865 2076 616c 7565 7320 6f66 2061   the values of a
+0001b070: 7267 756d 656e 7473 2075 7365 6420 7768  rguments used wh
+0001b080: 656e 2063 616c 6c69 6e67 2060 6372 6561  en calling `crea
+0001b090: 7465 5f73 7562 7363 7269 7074 696f 6e5f  te_subscription_
+0001b0a0: 746f 5f73 7472 6561 6d28 2960 2e0a 0a54  to_stream()`...T
+0001b0b0: 6869 7320 6d65 7468 6f64 2068 6173 2061  his method has a
+0001b0c0: 6e20 6f70 7469 6f6e 616c 2060 7469 6d65  n optional `time
+0001b0d0: 6f75 7460 2061 7267 756d 656e 742c 2077  out` argument, w
+0001b0e0: 6869 6368 2069 7320 6120 5079 7468 6f6e  hich is a Python
+0001b0f0: 2060 666c 6f61 7460 0a74 6861 7420 7365   `float`.that se
+0001b100: 7473 2061 206d 6178 696d 756d 2064 7572  ts a maximum dur
+0001b110: 6174 696f 6e2c 2069 6e20 7365 636f 6e64  ation, in second
+0001b120: 732c 2066 6f72 2074 6865 2063 6f6d 706c  s, for the compl
+0001b130: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+0001b140: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+0001b150: 6973 206d 6574 686f 6420 6861 7320 616e  is method has an
+0001b160: 206f 7074 696f 6e61 6c20 6063 7265 6465   optional `crede
+0001b170: 6e74 6961 6c73 6020 6172 6775 6d65 6e74  ntials` argument
+0001b180: 2c20 7768 6963 6820 6361 6e20 6265 2075  , which can be u
+0001b190: 7365 6420 746f 0a6f 7665 7272 6964 6520  sed to.override 
+0001b1a0: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
+0001b1b0: 2064 6572 6976 6564 2066 726f 6d20 7468   derived from th
+0001b1c0: 6520 636f 6e6e 6563 7469 6f6e 2073 7472  e connection str
+0001b1d0: 696e 6720 5552 492e 0a0a 5468 6973 206d  ing URI...This m
+0001b1e0: 6574 686f 6420 7265 7475 726e 7320 6120  ethod returns a 
+0001b1f0: 6050 6572 7369 7374 656e 7453 7562 7363  `PersistentSubsc
+0001b200: 7269 7074 696f 6e60 206f 626a 6563 742c  ription` object,
+0001b210: 2077 6869 6368 2069 7320 616e 2069 7465   which is an ite
+0001b220: 7261 746f 720a 6769 7669 6e67 2060 5265  rator.giving `Re
+0001b230: 636f 7264 6564 4576 656e 7460 206f 626a  cordedEvent` obj
+0001b240: 6563 7473 2c20 7468 6174 2061 6c73 6f20  ects, that also 
+0001b250: 6861 7320 6061 636b 2829 602c 2060 6e61  has `ack()`, `na
+0001b260: 636b 2829 6020 616e 6420 6073 746f 7028  ck()` and `stop(
+0001b270: 2960 0a6d 6574 686f 6473 2e0a 0a60 6060  )`.methods...```
+0001b280: 7079 7468 6f6e 0a73 7562 7363 7269 7074  python.subscript
+0001b290: 696f 6e20 3d20 636c 6965 6e74 2e72 6561  ion = client.rea
+0001b2a0: 645f 7375 6273 6372 6970 7469 6f6e 5f74  d_subscription_t
+0001b2b0: 6f5f 7374 7265 616d 280a 2020 2020 6772  o_stream(.    gr
+0001b2c0: 6f75 705f 6e61 6d65 3d67 726f 7570 5f6e  oup_name=group_n
+0001b2d0: 616d 6532 2c0a 2020 2020 7374 7265 616d  ame2,.    stream
+0001b2e0: 5f6e 616d 653d 7374 7265 616d 5f6e 616d  _name=stream_nam
+0001b2f0: 6532 2c0a 290a 6060 600a 0a54 6865 2065  e2,.).```..The e
+0001b300: 7861 6d70 6c65 2062 656c 6f77 2069 7465  xample below ite
+0001b310: 7261 7465 7320 6f76 6572 2074 6865 2073  rates over the s
+0001b320: 7562 7363 7269 7074 696f 6e20 6f62 6a65  ubscription obje
+0001b330: 6374 2c20 616e 6420 6361 6c6c 7320 6061  ct, and calls `a
+0001b340: 636b 2829 602e 0a54 6865 2073 7562 7363  ck()`..The subsc
+0001b350: 7269 7074 696f 6e27 7320 6073 746f 7028  ription's `stop(
+0001b360: 2960 206d 6574 686f 6420 6973 2063 616c  )` method is cal
+0001b370: 6c65 6420 7768 656e 2077 6520 6861 7665  led when we have
+0001b380: 2072 6563 6569 7665 6420 6065 7665 6e74   received `event
+0001b390: 3660 2c0a 7374 6f70 7069 6e67 2074 6865  6`,.stopping the
+0001b3a0: 2069 7465 7261 7469 6f6e 2c20 736f 2074   iteration, so t
+0001b3b0: 6861 7420 7765 2063 616e 2063 6f6e 7469  hat we can conti
+0001b3c0: 6e75 6520 7769 7468 2074 6865 2065 7861  nue with the exa
+0001b3d0: 6d70 6c65 7320 6265 6c6f 772e 0a0a 6060  mples below...``
+0001b3e0: 6070 7974 686f 6e0a 6576 656e 7473 203d  `python.events =
+0001b3f0: 205b 5d0a 666f 7220 6576 656e 7420 696e   [].for event in
+0001b400: 2073 7562 7363 7269 7074 696f 6e3a 0a20   subscription:. 
+0001b410: 2020 2065 7665 6e74 732e 6170 7065 6e64     events.append
+0001b420: 2865 7665 6e74 290a 0a20 2020 2023 2041  (event)..    # A
+0001b430: 636b 6e6f 776c 6564 6765 2074 6865 2072  cknowledge the r
+0001b440: 6563 6569 7665 6420 6576 656e 742e 0a20  eceived event.. 
+0001b450: 2020 2073 7562 7363 7269 7074 696f 6e2e     subscription.
+0001b460: 6163 6b28 6576 656e 7429 0a0a 2020 2020  ack(event)..    
+0001b470: 2320 5374 6f70 2077 6865 6e20 2765 7665  # Stop when 'eve
+0001b480: 6e74 3627 2068 6173 2062 6565 6e20 7265  nt6' has been re
+0001b490: 6365 6976 6564 2e0a 2020 2020 6966 2065  ceived..    if e
+0001b4a0: 7665 6e74 203d 3d20 6576 656e 7436 3a0a  vent == event6:.
+0001b4b0: 2020 2020 2020 2020 7375 6273 6372 6970          subscrip
+0001b4c0: 7469 6f6e 2e73 746f 7028 290a 6060 600a  tion.stop().```.
+0001b4d0: 0a57 6520 6361 6e20 6368 6563 6b20 7765  .We can check we
+0001b4e0: 2072 6563 6569 7665 6420 616c 6c20 7468   received all th
+0001b4f0: 6520 6576 656e 7473 2074 6861 7420 7765  e events that we
+0001b500: 7265 2061 7070 656e 6465 6420 746f 2060  re appended to `
+0001b510: 7374 7265 616d 5f6e 616d 6532 600a 696e  stream_name2`.in
+0001b520: 2074 6865 2065 7861 6d70 6c65 7320 6162   the examples ab
+0001b530: 6f76 652e 0a0a 6060 6070 7974 686f 6e0a  ove...```python.
+0001b540: 6173 7365 7274 206c 656e 2865 7665 6e74  assert len(event
+0001b550: 7329 203d 3d20 330a 6173 7365 7274 2065  s) == 3.assert e
+0001b560: 7665 6e74 735b 305d 203d 3d20 6576 656e  vents[0] == even
+0001b570: 7434 0a61 7373 6572 7420 6576 656e 7473  t4.assert events
+0001b580: 5b31 5d20 3d3d 2065 7665 6e74 350a 6173  [1] == event5.as
+0001b590: 7365 7274 2065 7665 6e74 735b 325d 203d  sert events[2] =
+0001b5a0: 3d20 6576 656e 7436 0a60 6060 0a0a 2323  = event6.```..##
+0001b5b0: 2320 5570 6461 7465 2073 7562 7363 7269  # Update subscri
+0001b5c0: 7074 696f 6e20 746f 2073 7472 6561 6d3c  ption to stream<
+0001b5d0: 6120 6964 3d22 7570 6461 7465 2d73 7562  a id="update-sub
+0001b5e0: 7363 7269 7074 696f 6e2d 746f 2d73 7472  scription-to-str
+0001b5f0: 6561 6d22 3e3c 2f61 3e0a 0a2a 7265 7175  eam"></a>..*requ
+0001b600: 6972 6573 206c 6561 6465 722a 0a0a 5468  ires leader*..Th
+0001b610: 6520 6075 7064 6174 655f 7375 6273 6372  e `update_subscr
+0001b620: 6970 7469 6f6e 5f74 6f5f 7374 7265 616d  iption_to_stream
+0001b630: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+0001b640: 6520 7573 6564 2074 6f20 7570 6461 7465  e used to update
+0001b650: 2061 2070 6572 7369 7374 656e 740a 7375   a persistent.su
+0001b660: 6273 6372 6970 7469 6f6e 2074 6f20 6120  bscription to a 
+0001b670: 7374 7265 616d 2e20 506c 6561 7365 206e  stream. Please n
+0001b680: 6f74 652c 2074 6865 2063 6f6e 7375 6d65  ote, the consume
+0001b690: 7220 7374 7261 7465 6779 2063 616e 6e6f  r strategy canno
+0001b6a0: 7420 6265 2061 646a 7573 7465 642e 0a0a  t be adjusted...
+0001b6b0: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+0001b6c0: 6120 7265 7175 6972 6564 2060 6772 6f75  a required `grou
+0001b6d0: 705f 6e61 6d65 6020 6172 6775 6d65 6e74  p_name` argument
+0001b6e0: 2c20 7768 6963 6820 6973 2074 6865 0a6e  , which is the.n
+0001b6f0: 616d 6520 6f66 2061 2022 6772 6f75 7022  ame of a "group"
+0001b700: 206f 6620 636f 6e73 756d 6572 7320 6f66   of consumers of
+0001b710: 2074 6865 2073 7562 7363 7269 7074 696f   the subscriptio
+0001b720: 6e2c 2061 6e64 2061 2072 6571 7569 7265  n, and a require
+0001b730: 640a 6073 7472 6561 6d5f 6e61 6d65 6020  d.`stream_name` 
+0001b740: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
+0001b750: 6973 2074 6865 206e 616d 6520 6f66 2061  is the name of a
+0001b760: 2073 7472 6561 6d2e 0a0a 5468 6973 206d   stream...This m
+0001b770: 6574 686f 6420 616c 736f 2068 6173 2073  ethod also has s
+0001b780: 6978 7465 656e 206f 7074 696f 6e61 6c20  ixteen optional 
+0001b790: 6172 6775 6d65 6e74 732c 2060 6672 6f6d  arguments, `from
+0001b7a0: 5f65 6e64 602c 2060 7374 7265 616d 5f70  _end`, `stream_p
+0001b7b0: 6f73 6974 696f 6e60 2c0a 6072 6573 6f6c  osition`,.`resol
+0001b7c0: 7665 5f6c 696e 6b73 602c 2060 636f 6e73  ve_links`, `cons
+0001b7d0: 756d 6572 5f73 7472 6174 6567 7960 2c20  umer_strategy`, 
+0001b7e0: 606d 6573 7361 6765 5f74 696d 656f 7574  `message_timeout
+0001b7f0: 602c 2060 6d61 785f 7265 7472 795f 636f  `, `max_retry_co
+0001b800: 756e 7460 2c0a 606d 6178 5f73 7562 7363  unt`,.`max_subsc
+0001b810: 7269 6265 725f 636f 756e 7460 2c20 606c  riber_count`, `l
+0001b820: 6976 655f 6275 6666 6572 5f73 697a 6560  ive_buffer_size`
+0001b830: 2c20 6072 6561 645f 6261 7463 685f 7369  , `read_batch_si
+0001b840: 7a65 602c 2060 6869 7374 6f72 795f 6275  ze`, `history_bu
+0001b850: 6666 6572 5f73 697a 6560 2c0a 6065 7874  ffer_size`,.`ext
+0001b860: 7261 5f73 7461 7469 7374 6963 7360 2c20  ra_statistics`, 
+0001b870: 606d 696e 5f63 6865 636b 706f 696e 745f  `min_checkpoint_
+0001b880: 636f 756e 7460 2c20 606d 6178 5f63 6865  count`, `max_che
+0001b890: 636b 706f 696e 745f 636f 756e 7460 2c20  ckpoint_count`, 
+0001b8a0: 6063 6865 636b 706f 696e 745f 6166 7465  `checkpoint_afte
+0001b8b0: 7260 2c0a 6074 696d 656f 7574 6020 616e  r`,.`timeout` an
+0001b8c0: 6420 6063 7265 6465 6e74 6961 6c73 602e  d `credentials`.
+0001b8d0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2061  ..The optional a
+0001b8e0: 7267 756d 656e 7473 2060 6672 6f6d 5f65  rguments `from_e
+0001b8f0: 6e64 602c 2060 7374 7265 616d 5f70 6f73  nd`, `stream_pos
+0001b900: 6974 696f 6e60 2c0a 6072 6573 6f6c 7665  ition`,.`resolve
+0001b910: 5f6c 696e 6b73 602c 2060 636f 6e73 756d  _links`, `consum
+0001b920: 6572 5f73 7472 6174 6567 7960 2c20 606d  er_strategy`, `m
+0001b930: 6573 7361 6765 5f74 696d 656f 7574 602c  essage_timeout`,
+0001b940: 2060 6d61 785f 7265 7472 795f 636f 756e   `max_retry_coun
+0001b950: 7460 2c0a 606d 696e 5f63 6865 636b 706f  t`,.`min_checkpo
+0001b960: 696e 745f 636f 756e 7460 2c20 606d 6178  int_count`, `max
+0001b970: 5f63 6865 636b 706f 696e 745f 636f 756e  _checkpoint_coun
+0001b980: 7460 2c20 6063 6865 636b 706f 696e 745f  t`, `checkpoint_
+0001b990: 6166 7465 7260 2c0a 606d 6178 5f73 7562  after`,.`max_sub
+0001b9a0: 7363 7269 6265 725f 636f 756e 7460 2c20  scriber_count`, 
+0001b9b0: 606c 6976 655f 6275 6666 6572 5f73 697a  `live_buffer_siz
+0001b9c0: 6560 2c20 6072 6561 645f 6261 7463 685f  e`, `read_batch_
+0001b9d0: 7369 7a65 602c 2060 6869 7374 6f72 795f  size`, `history_
+0001b9e0: 6275 6666 6572 5f73 697a 6560 2c0a 616e  buffer_size`,.an
+0001b9f0: 6420 6065 7874 7261 5f73 7461 7469 7374  d `extra_statist
+0001ba00: 6963 7360 2063 616e 2062 6520 7573 6564  ics` can be used
+0001ba10: 2074 6f20 6164 6a75 7374 2074 6865 2076   to adjust the v
+0001ba20: 616c 7565 7320 7365 7420 6f6e 2070 7265  alues set on pre
+0001ba30: 7669 6f75 7320 6361 6c6c 7320 746f 0a60  vious calls to.`
+0001ba40: 6372 6561 7465 5f73 7562 7363 7269 7074  create_subscript
+0001ba50: 696f 6e5f 746f 5f73 7472 6561 6d28 2960  ion_to_stream()`
+0001ba60: 2061 6e64 2060 7570 6461 7465 5f73 7562   and `update_sub
+0001ba70: 7363 7269 7074 696f 6e5f 746f 5f73 7472  scription_to_str
+0001ba80: 6561 6d28 2960 2e20 4966 2061 6e79 206f  eam()`. If any o
+0001ba90: 660a 7468 6573 6520 6172 6775 6d65 6e74  f.these argument
+0001baa0: 7320 6172 6520 6e6f 7420 6d65 6e74 696f  s are not mentio
+0001bab0: 6e65 6420 696e 2061 2063 616c 6c20 746f  ned in a call to
+0001bac0: 2060 7570 6461 7465 5f73 7562 7363 7269   `update_subscri
+0001bad0: 7074 696f 6e5f 746f 5f73 7472 6561 6d28  ption_to_stream(
+0001bae0: 2960 2c0a 7468 6520 636f 7272 6573 706f  )`,.the correspo
+0001baf0: 6e64 696e 6720 7365 7474 696e 6773 206f  nding settings o
+0001bb00: 6620 7468 6520 7065 7273 6973 7465 6e74  f the persistent
+0001bb10: 2073 7562 7363 7269 7074 696f 6e20 7769   subscription wi
+0001bb20: 6c6c 2062 6520 756e 6368 616e 6765 642e  ll be unchanged.
+0001bb30: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0001bb40: 7469 6d65 6f75 7460 2061 7267 756d 656e  timeout` argumen
+0001bb50: 7420 6973 2061 2050 7974 686f 6e20 6066  t is a Python `f
+0001bb60: 6c6f 6174 6020 7768 6963 6820 7365 7473  loat` which sets
+0001bb70: 2061 0a6d 6178 696d 756d 2064 7572 6174   a.maximum durat
+0001bb80: 696f 6e2c 2069 6e20 7365 636f 6e64 732c  ion, in seconds,
+0001bb90: 2066 6f72 2074 6865 2063 6f6d 706c 6574   for the complet
+0001bba0: 696f 6e20 6f66 2074 6865 2067 5250 4320  ion of the gRPC 
+0001bbb0: 6f70 6572 6174 696f 6e2e 0a0a 5468 6520  operation...The 
+0001bbc0: 6f70 7469 6f6e 616c 2060 6372 6564 656e  optional `creden
+0001bbd0: 7469 616c 7360 2061 7267 756d 656e 7420  tials` argument 
+0001bbe0: 6361 6e20 6265 2075 7365 6420 746f 0a6f  can be used to.o
+0001bbf0: 7665 7272 6964 6520 6361 6c6c 2063 7265  verride call cre
+0001bc00: 6465 6e74 6961 6c73 2064 6572 6976 6564  dentials derived
+0001bc10: 2066 726f 6d20 7468 6520 636f 6e6e 6563   from the connec
+0001bc20: 7469 6f6e 2073 7472 696e 6720 5552 492e  tion string URI.
+0001bc30: 0a0a 5468 6520 6075 7064 6174 655f 7375  ..The `update_su
+0001bc40: 6273 6372 6970 7469 6f6e 5f74 6f5f 7374  bscription_to_st
+0001bc50: 7265 616d 2829 6020 6d65 7468 6f64 2064  ream()` method d
+0001bc60: 6f65 7320 6e6f 7420 7265 7475 726e 2061  oes not return a
+0001bc70: 2076 616c 7565 2e0a 0a49 6e20 7468 6520   value...In the 
+0001bc80: 6578 616d 706c 6520 6265 6c6f 772c 2061  example below, a
+0001bc90: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+0001bca0: 6372 6970 7469 6f6e 2074 6f20 6120 7374  cription to a st
+0001bcb0: 7265 616d 2069 7320 7570 6461 7465 6420  ream is updated 
+0001bcc0: 746f 2072 756e 2066 726f 6d20 7468 650a  to run from the.
+0001bcd0: 656e 6420 6f66 2074 6865 2073 7472 6561  end of the strea
+0001bce0: 6d2e 0a0a 6060 6070 7974 686f 6e0a 2320  m...```python.# 
+0001bcf0: 4372 6561 7465 2061 2070 6572 7369 7374  Create a persist
+0001bd00: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+0001bd10: 2e0a 636c 6965 6e74 2e75 7064 6174 655f  ..client.update_
+0001bd20: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+0001bd30: 7374 7265 616d 280a 2020 2020 6772 6f75  stream(.    grou
+0001bd40: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+0001bd50: 6532 2c0a 2020 2020 7374 7265 616d 5f6e  e2,.    stream_n
+0001bd60: 616d 653d 7374 7265 616d 5f6e 616d 6532  ame=stream_name2
+0001bd70: 2c0a 2020 2020 6672 6f6d 5f65 6e64 3d54  ,.    from_end=T
+0001bd80: 7275 652c 0a29 0a60 6060 0a0a 2323 2320  rue,.).```..### 
+0001bd90: 5265 706c 6179 2070 6172 6b65 6420 6576  Replay parked ev
+0001bda0: 656e 7473 3c61 2069 643d 2272 6570 6c61  ents<a id="repla
+0001bdb0: 792d 7061 726b 6564 2d65 7665 6e74 7322  y-parked-events"
+0001bdc0: 3e3c 2f61 3e0a 0a2a 7265 7175 6972 6573  ></a>..*requires
+0001bdd0: 206c 6561 6465 722a 0a0a 5468 6520 6072   leader*..The `r
+0001bde0: 6570 6c61 795f 7061 726b 6564 5f65 7665  eplay_parked_eve
+0001bdf0: 6e74 7328 2960 206d 6574 686f 6420 6361  nts()` method ca
+0001be00: 6e20 6265 2075 7365 6420 746f 2022 7265  n be used to "re
+0001be10: 706c 6179 2220 6576 656e 7473 2074 6861  play" events tha
+0001be20: 7420 6861 7665 0a62 6565 6e20 2270 6172  t have.been "par
+0001be30: 6b65 6422 2028 6e65 6761 7469 7665 6c79  ked" (negatively
+0001be40: 2061 636b 6e6f 776c 6564 6765 6420 7769   acknowledged wi
+0001be50: 7468 2074 6865 2061 6374 696f 6e20 6027  th the action `'
+0001be60: 7061 726b 2760 2920 7768 656e 2072 6561  park'`) when rea
+0001be70: 6469 6e67 0a61 2070 6572 7369 7374 656e  ding.a persisten
+0001be80: 7420 7375 6273 6372 6970 7469 6f6e 2e20  t subscription. 
+0001be90: 5061 726b 6564 2065 7665 6e74 7320 7769  Parked events wi
+0001bea0: 6c6c 2074 6865 6e20 6265 2072 6563 6569  ll then be recei
+0001beb0: 7665 6420 6167 6169 6e20 6279 2063 6f6e  ved again by con
+0001bec0: 7375 6d65 7273 0a72 6561 6469 6e67 2066  sumers.reading f
+0001bed0: 726f 6d20 7468 6520 7065 7273 6973 7465  rom the persiste
+0001bee0: 6e74 2073 7562 7363 7269 7074 696f 6e2e  nt subscription.
+0001bef0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+0001bf00: 7320 6120 7265 7175 6972 6564 2060 6772  s a required `gr
+0001bf10: 6f75 705f 6e61 6d65 6020 6172 6775 6d65  oup_name` argume
+0001bf20: 6e74 2061 6e64 2061 6e20 6f70 7469 6f6e  nt and an option
+0001bf30: 616c 2060 7374 7265 616d 5f6e 616d 6560  al `stream_name`
+0001bf40: 0a61 7267 756d 656e 742e 2054 6865 2076  .argument. The v
+0001bf50: 616c 7565 7320 6f66 2074 6865 7365 2061  alues of these a
+0001bf60: 7267 756d 656e 7473 2073 686f 756c 6420  rguments should 
+0001bf70: 6d61 7463 6820 7468 6f73 6520 7573 6564  match those used
+0001bf80: 2077 6865 6e20 6361 6c6c 696e 670a 6063   when calling.`c
+0001bf90: 7265 6174 655f 7375 6273 6372 6970 7469  reate_subscripti
+0001bfa0: 6f6e 5f74 6f5f 616c 6c28 2960 206f 7220  on_to_all()` or 
+0001bfb0: 6063 7265 6174 655f 7375 6273 6372 6970  `create_subscrip
+0001bfc0: 7469 6f6e 5f74 6f5f 7374 7265 616d 2829  tion_to_stream()
+0001bfd0: 602e 0a0a 5468 6973 206d 6574 686f 6420  `...This method 
+0001bfe0: 6861 7320 616e 206f 7074 696f 6e61 6c20  has an optional 
+0001bff0: 6074 696d 656f 7574 6020 6172 6775 6d65  `timeout` argume
+0001c000: 6e74 2c20 7768 6963 6820 6973 2061 2050  nt, which is a P
+0001c010: 7974 686f 6e20 6066 6c6f 6174 600a 7468  ython `float`.th
+0001c020: 6174 2073 6574 7320 6120 6d61 7869 6d75  at sets a maximu
+0001c030: 6d20 6475 7261 7469 6f6e 2c20 696e 2073  m duration, in s
+0001c040: 6563 6f6e 6473 2c20 666f 7220 7468 6520  econds, for the 
+0001c050: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+0001c060: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+0001c070: 2e0a 0a54 6869 7320 6d65 7468 6f64 2068  ...This method h
+0001c080: 6173 2061 6e20 6f70 7469 6f6e 616c 2060  as an optional `
+0001c090: 6372 6564 656e 7469 616c 7360 2061 7267  credentials` arg
+0001c0a0: 756d 656e 742c 2077 6869 6368 2063 616e  ument, which can
+0001c0b0: 2062 6520 7573 6564 2074 6f0a 6f76 6572   be used to.over
+0001c0c0: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
+0001c0d0: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
+0001c0e0: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
+0001c0f0: 6e20 7374 7269 6e67 2055 5249 2e0a 0a54  n string URI...T
+0001c100: 6865 2065 7861 6d70 6c65 2062 656c 6f77  he example below
+0001c110: 2072 6570 6c61 7973 2070 6172 6b65 6420   replays parked 
+0001c120: 6576 656e 7473 2066 6f72 2067 726f 7570  events for group
+0001c130: 2060 6772 6f75 705f 6e61 6d65 3160 2e0a   `group_name1`..
+0001c140: 0a60 6060 7079 7468 6f6e 0a63 6c69 656e  .```python.clien
+0001c150: 742e 7265 706c 6179 5f70 6172 6b65 645f  t.replay_parked_
+0001c160: 6576 656e 7473 280a 2020 2020 6772 6f75  events(.    grou
+0001c170: 705f 6e61 6d65 3d67 726f 7570 5f6e 616d  p_name=group_nam
+0001c180: 6531 2c0a 290a 6060 600a 0a54 6865 2065  e1,.).```..The e
+0001c190: 7861 6d70 6c65 2062 656c 6f77 2072 6570  xample below rep
+0001c1a0: 6c61 7973 2070 6172 6b65 6420 6576 656e  lays parked even
+0001c1b0: 7473 2066 6f72 2067 726f 7570 2060 6772  ts for group `gr
+0001c1c0: 6f75 705f 6e61 6d65 3260 2e0a 0a60 6060  oup_name2`...```
+0001c1d0: 7079 7468 6f6e 0a63 6c69 656e 742e 7265  python.client.re
+0001c1e0: 706c 6179 5f70 6172 6b65 645f 6576 656e  play_parked_even
+0001c1f0: 7473 280a 2020 2020 6772 6f75 705f 6e61  ts(.    group_na
+0001c200: 6d65 3d67 726f 7570 5f6e 616d 6532 2c0a  me=group_name2,.
+0001c210: 2020 2020 7374 7265 616d 5f6e 616d 653d      stream_name=
+0001c220: 7374 7265 616d 5f6e 616d 6532 2c0a 290a  stream_name2,.).
+0001c230: 6060 600a 0a23 2323 2047 6574 2073 7562  ```..### Get sub
+0001c240: 7363 7269 7074 696f 6e20 696e 666f 3c61  scription info<a
+0001c250: 2069 643d 2267 6574 2d73 7562 7363 7269   id="get-subscri
+0001c260: 7074 696f 6e2d 696e 666f 223e 3c2f 613e  ption-info"></a>
+0001c270: 0a0a 2a72 6571 7569 7265 7320 6c65 6164  ..*requires lead
+0001c280: 6572 2a0a 0a54 6865 2060 6765 745f 7375  er*..The `get_su
+0001c290: 6273 6372 6970 7469 6f6e 5f69 6e66 6f28  bscription_info(
+0001c2a0: 2960 206d 6574 686f 6420 6361 6e20 6265  )` method can be
+0001c2b0: 2075 7365 6420 746f 2067 6574 2069 6e66   used to get inf
+0001c2c0: 6f72 6d61 7469 6f6e 2066 6f72 2061 0a70  ormation for a.p
+0001c2d0: 6572 7369 7374 656e 7420 7375 6273 6372  ersistent subscr
+0001c2e0: 6970 7469 6f6e 2e0a 0a54 6869 7320 6d65  iption...This me
+0001c2f0: 7468 6f64 2068 6173 2061 2072 6571 7569  thod has a requi
+0001c300: 7265 6420 6067 726f 7570 5f6e 616d 6560  red `group_name`
+0001c310: 2061 7267 756d 656e 7420 616e 6420 616e   argument and an
+0001c320: 206f 7074 696f 6e61 6c20 6073 7472 6561   optional `strea
+0001c330: 6d5f 6e61 6d65 600a 6172 6775 6d65 6e74  m_name`.argument
+0001c340: 2c20 7768 6963 6820 7368 6f75 6c64 206d  , which should m
+0001c350: 6174 6368 2074 6865 2076 616c 7565 7320  atch the values 
+0001c360: 6f66 2061 7267 756d 656e 7473 2075 7365  of arguments use
+0001c370: 6420 7768 656e 2063 616c 6c69 6e67 2065  d when calling e
+0001c380: 6974 6865 720a 6063 7265 6174 655f 7375  ither.`create_su
+0001c390: 6273 6372 6970 7469 6f6e 5f74 6f5f 616c  bscription_to_al
+0001c3a0: 6c28 2960 206f 7220 6063 7265 6174 655f  l()` or `create_
+0001c3b0: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+0001c3c0: 7374 7265 616d 2829 602e 0a0a 5468 6973  stream()`...This
+0001c3d0: 206d 6574 686f 6420 6861 7320 616e 206f   method has an o
+0001c3e0: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+0001c3f0: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+0001c400: 6820 6973 2061 2050 7974 686f 6e20 6066  h is a Python `f
+0001c410: 6c6f 6174 600a 7468 6174 2073 6574 7320  loat`.that sets 
+0001c420: 6120 6d61 7869 6d75 6d20 6475 7261 7469  a maximum durati
+0001c430: 6f6e 2c20 696e 2073 6563 6f6e 6473 2c20  on, in seconds, 
+0001c440: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+0001c450: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+0001c460: 7065 7261 7469 6f6e 2e0a 0a54 6869 7320  peration...This 
+0001c470: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
+0001c480: 7469 6f6e 616c 2060 6372 6564 656e 7469  tional `credenti
+0001c490: 616c 7360 2061 7267 756d 656e 742c 2077  als` argument, w
+0001c4a0: 6869 6368 2063 616e 2062 6520 7573 6564  hich can be used
+0001c4b0: 2074 6f0a 6f76 6572 7269 6465 2063 616c   to.override cal
+0001c4c0: 6c20 6372 6564 656e 7469 616c 7320 6465  l credentials de
+0001c4d0: 7269 7665 6420 6672 6f6d 2074 6865 2063  rived from the c
+0001c4e0: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+0001c4f0: 2055 5249 2e0a 0a54 6865 2065 7861 6d70   URI...The examp
+0001c500: 6c65 2062 656c 6f77 2067 6574 7320 696e  le below gets in
+0001c510: 666f 726d 6174 696f 6e20 666f 7220 7468  formation for th
+0001c520: 6520 7065 7273 6973 7465 6e74 2073 7562  e persistent sub
+0001c530: 7363 7269 7074 696f 6e20 6067 726f 7570  scription `group
+0001c540: 5f6e 616d 6531 6020 7768 6963 680a 7761  _name1` which.wa
+0001c550: 7320 6372 6561 7465 6420 6279 2063 616c  s created by cal
+0001c560: 6c69 6e67 2060 6372 6561 7465 5f73 7562  ling `create_sub
+0001c570: 7363 7269 7074 696f 6e5f 746f 5f61 6c6c  scription_to_all
+0001c580: 2829 602e 0a0a 6060 6070 7974 686f 6e0a  ()`...```python.
+0001c590: 7375 6273 6372 6970 7469 6f6e 5f69 6e66  subscription_inf
+0001c5a0: 6f20 3d20 636c 6965 6e74 2e67 6574 5f73  o = client.get_s
+0001c5b0: 7562 7363 7269 7074 696f 6e5f 696e 666f  ubscription_info
+0001c5c0: 280a 2020 2020 6772 6f75 705f 6e61 6d65  (.    group_name
+0001c5d0: 3d67 726f 7570 5f6e 616d 6531 2c0a 290a  =group_name1,.).
+0001c5e0: 6060 600a 0a54 6865 2065 7861 6d70 6c65  ```..The example
+0001c5f0: 2062 656c 6f77 2067 6574 7320 696e 666f   below gets info
+0001c600: 726d 6174 696f 6e20 666f 7220 7468 6520  rmation for the 
+0001c610: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+0001c620: 7269 7074 696f 6e20 6067 726f 7570 5f6e  ription `group_n
+0001c630: 616d 6532 6020 6f6e 0a60 7374 7265 616d  ame2` on.`stream
+0001c640: 5f6e 616d 6532 6020 7768 6963 6820 7761  _name2` which wa
+0001c650: 7320 6372 6561 7465 6420 6279 2063 616c  s created by cal
+0001c660: 6c69 6e67 2060 6372 6561 7465 5f73 7562  ling `create_sub
+0001c670: 7363 7269 7074 696f 6e5f 746f 5f73 7472  scription_to_str
+0001c680: 6561 6d28 2960 2e0a 0a60 6060 7079 7468  eam()`...```pyth
+0001c690: 6f6e 0a73 7562 7363 7269 7074 696f 6e5f  on.subscription_
+0001c6a0: 696e 666f 203d 2063 6c69 656e 742e 6765  info = client.ge
+0001c6b0: 745f 7375 6273 6372 6970 7469 6f6e 5f69  t_subscription_i
+0001c6c0: 6e66 6f28 0a20 2020 2067 726f 7570 5f6e  nfo(.    group_n
+0001c6d0: 616d 653d 6772 6f75 705f 6e61 6d65 322c  ame=group_name2,
+0001c6e0: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+0001c6f0: 3d73 7472 6561 6d5f 6e61 6d65 322c 0a29  =stream_name2,.)
+0001c700: 0a60 6060 0a0a 5468 6520 7265 7475 726e  .```..The return
+0001c710: 6564 2076 616c 7565 2069 7320 6120 6053  ed value is a `S
+0001c720: 7562 7363 7269 7074 696f 6e49 6e66 6f60  ubscriptionInfo`
+0001c730: 206f 626a 6563 742e 0a0a 2323 2320 4c69   object...### Li
+0001c740: 7374 2073 7562 7363 7269 7074 696f 6e73  st subscriptions
+0001c750: 3c61 2069 643d 226c 6973 742d 7375 6273  <a id="list-subs
+0001c760: 6372 6970 7469 6f6e 7322 3e3c 2f61 3e0a  criptions"></a>.
+0001c770: 0a2a 7265 7175 6972 6573 206c 6561 6465  .*requires leade
+0001c780: 722a 0a0a 5468 6520 606c 6973 745f 7375  r*..The `list_su
+0001c790: 6273 6372 6970 7469 6f6e 7328 2960 206d  bscriptions()` m
+0001c7a0: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+0001c7b0: 6420 746f 2067 6574 2069 6e66 6f72 6d61  d to get informa
+0001c7c0: 7469 6f6e 2066 6f72 2061 6c6c 0a65 7869  tion for all.exi
+0001c7d0: 7374 696e 6720 7065 7273 6973 7465 6e74  sting persistent
+0001c7e0: 2073 7562 7363 7269 7074 696f 6e73 2c20   subscriptions, 
+0001c7f0: 626f 7468 2022 7375 6273 6372 6970 7469  both "subscripti
+0001c800: 6f6e 7320 746f 2061 6c6c 2220 616e 640a  ons to all" and.
+0001c810: 2273 7562 7363 7269 7074 696f 6e73 2074  "subscriptions t
+0001c820: 6f20 7374 7265 616d 222e 0a0a 5468 6973  o stream"...This
+0001c830: 206d 6574 686f 6420 6861 7320 616e 206f   method has an o
+0001c840: 7074 696f 6e61 6c20 6074 696d 656f 7574  ptional `timeout
+0001c850: 6020 6172 6775 6d65 6e74 2c20 7768 6963  ` argument, whic
+0001c860: 6820 6973 2061 2050 7974 686f 6e20 6066  h is a Python `f
+0001c870: 6c6f 6174 600a 7468 6174 2073 6574 7320  loat`.that sets 
+0001c880: 6120 6d61 7869 6d75 6d20 6475 7261 7469  a maximum durati
+0001c890: 6f6e 2c20 696e 2073 6563 6f6e 6473 2c20  on, in seconds, 
+0001c8a0: 666f 7220 7468 6520 636f 6d70 6c65 7469  for the completi
+0001c8b0: 6f6e 206f 6620 7468 6520 6752 5043 206f  on of the gRPC o
+0001c8c0: 7065 7261 7469 6f6e 2e0a 0a54 6869 7320  peration...This 
+0001c8d0: 6d65 7468 6f64 2068 6173 2061 6e20 6f70  method has an op
+0001c8e0: 7469 6f6e 616c 2060 6372 6564 656e 7469  tional `credenti
+0001c8f0: 616c 7360 2061 7267 756d 656e 742c 2077  als` argument, w
+0001c900: 6869 6368 2063 616e 2062 6520 7573 6564  hich can be used
+0001c910: 2074 6f0a 6f76 6572 7269 6465 2063 616c   to.override cal
+0001c920: 6c20 6372 6564 656e 7469 616c 7320 6465  l credentials de
+0001c930: 7269 7665 6420 6672 6f6d 2074 6865 2063  rived from the c
+0001c940: 6f6e 6e65 6374 696f 6e20 7374 7269 6e67  onnection string
+0001c950: 2055 5249 2e0a 0a54 6865 2065 7861 6d70   URI...The examp
+0001c960: 6c65 2062 656c 6f77 206c 6973 7473 2061  le below lists a
+0001c970: 6c6c 2074 6865 2065 7869 7374 696e 6720  ll the existing 
+0001c980: 7065 7273 6973 7465 6e74 2073 7562 7363  persistent subsc
+0001c990: 7269 7074 696f 6e73 2e0a 0a60 6060 7079  riptions...```py
+0001c9a0: 7468 6f6e 0a73 7562 7363 7269 7074 696f  thon.subscriptio
+0001c9b0: 6e73 203d 2063 6c69 656e 742e 6c69 7374  ns = client.list
+0001c9c0: 5f73 7562 7363 7269 7074 696f 6e73 2829  _subscriptions()
+0001c9d0: 0a60 6060 0a0a 5468 6520 7265 7475 726e  .```..The return
+0001c9e0: 6564 2076 616c 7565 2069 7320 6120 6c69  ed value is a li
+0001c9f0: 7374 206f 6620 6053 7562 7363 7269 7074  st of `Subscript
+0001ca00: 696f 6e49 6e66 6f60 206f 626a 6563 7473  ionInfo` objects
+0001ca10: 2e0a 0a0a 2323 2320 4c69 7374 2073 7562  ....### List sub
+0001ca20: 7363 7269 7074 696f 6e73 2074 6f20 7374  scriptions to st
+0001ca30: 7265 616d 3c61 2069 643d 226c 6973 742d  ream<a id="list-
+0001ca40: 7375 6273 6372 6970 7469 6f6e 732d 746f  subscriptions-to
+0001ca50: 2d73 7472 6561 6d22 3e3c 2f61 3e0a 0a2a  -stream"></a>..*
+0001ca60: 7265 7175 6972 6573 206c 6561 6465 722a  requires leader*
+0001ca70: 0a0a 5468 6520 606c 6973 745f 7375 6273  ..The `list_subs
+0001ca80: 6372 6970 7469 6f6e 735f 746f 5f73 7472  criptions_to_str
+0001ca90: 6561 6d28 2960 206d 6574 686f 6420 6361  eam()` method ca
+0001caa0: 6e20 6265 2075 7365 6420 746f 2067 6574  n be used to get
+0001cab0: 2069 6e66 6f72 6d61 7469 6f6e 2066 6f72   information for
+0001cac0: 2061 6c6c 0a74 6865 2070 6572 7369 7374   all.the persist
+0001cad0: 656e 7420 7375 6273 6372 6970 7469 6f6e  ent subscription
+0001cae0: 7320 746f 2061 2073 7472 6561 6d2e 0a0a  s to a stream...
+0001caf0: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+0001cb00: 6f6e 6520 7265 7175 6972 6564 2061 7267  one required arg
+0001cb10: 756d 656e 742c 2060 7374 7265 616d 5f6e  ument, `stream_n
+0001cb20: 616d 6560 2e0a 0a54 6869 7320 6d65 7468  ame`...This meth
+0001cb30: 6f64 2068 6173 2061 6e20 6f70 7469 6f6e  od has an option
+0001cb40: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+0001cb50: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
+0001cb60: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+0001cb70: 0a74 6861 7420 7365 7473 2061 206d 6178  .that sets a max
+0001cb80: 696d 756d 2064 7572 6174 696f 6e2c 2069  imum duration, i
+0001cb90: 6e20 7365 636f 6e64 732c 2066 6f72 2074  n seconds, for t
+0001cba0: 6865 2063 6f6d 706c 6574 696f 6e20 6f66  he completion of
+0001cbb0: 2074 6865 2067 5250 4320 6f70 6572 6174   the gRPC operat
+0001cbc0: 696f 6e2e 0a0a 5468 6973 206d 6574 686f  ion...This metho
+0001cbd0: 6420 6861 7320 616e 206f 7074 696f 6e61  d has an optiona
+0001cbe0: 6c20 6063 7265 6465 6e74 6961 6c73 6020  l `credentials` 
+0001cbf0: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
+0001cc00: 6361 6e20 6265 2075 7365 6420 746f 0a6f  can be used to.o
+0001cc10: 7665 7272 6964 6520 6361 6c6c 2063 7265  verride call cre
+0001cc20: 6465 6e74 6961 6c73 2064 6572 6976 6564  dentials derived
+0001cc30: 2066 726f 6d20 7468 6520 636f 6e6e 6563   from the connec
+0001cc40: 7469 6f6e 2073 7472 696e 6720 5552 492e  tion string URI.
+0001cc50: 0a0a 6060 6070 7974 686f 6e0a 7375 6273  ..```python.subs
+0001cc60: 6372 6970 7469 6f6e 7320 3d20 636c 6965  criptions = clie
+0001cc70: 6e74 2e6c 6973 745f 7375 6273 6372 6970  nt.list_subscrip
+0001cc80: 7469 6f6e 735f 746f 5f73 7472 6561 6d28  tions_to_stream(
+0001cc90: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+0001cca0: 3d73 7472 6561 6d5f 6e61 6d65 322c 0a29  =stream_name2,.)
+0001ccb0: 0a60 6060 0a0a 5468 6520 7265 7475 726e  .```..The return
+0001ccc0: 6564 2076 616c 7565 2069 7320 6120 6c69  ed value is a li
+0001ccd0: 7374 206f 6620 6053 7562 7363 7269 7074  st of `Subscript
+0001cce0: 696f 6e49 6e66 6f60 206f 626a 6563 7473  ionInfo` objects
+0001ccf0: 2e0a 0a0a 2323 2320 4465 6c65 7465 2073  ....### Delete s
+0001cd00: 7562 7363 7269 7074 696f 6e3c 6120 6964  ubscription<a id
+0001cd10: 3d22 6465 6c65 7465 2d73 7562 7363 7269  ="delete-subscri
+0001cd20: 7074 696f 6e22 3e3c 2f61 3e0a 0a2a 7265  ption"></a>..*re
+0001cd30: 7175 6972 6573 206c 6561 6465 722a 0a0a  quires leader*..
+0001cd40: 5468 6520 6064 656c 6574 655f 7375 6273  The `delete_subs
+0001cd50: 6372 6970 7469 6f6e 2829 6020 6d65 7468  cription()` meth
+0001cd60: 6f64 2063 616e 2062 6520 7573 6564 2074  od can be used t
+0001cd70: 6f20 6465 6c65 7465 2061 2070 6572 7369  o delete a persi
+0001cd80: 7374 656e 740a 7375 6273 6372 6970 7469  stent.subscripti
+0001cd90: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
+0001cda0: 2068 6173 2061 2072 6571 7569 7265 6420   has a required 
+0001cdb0: 6067 726f 7570 5f6e 616d 6560 2061 7267  `group_name` arg
+0001cdc0: 756d 656e 7420 616e 6420 616e 206f 7074  ument and an opt
+0001cdd0: 696f 6e61 6c20 6073 7472 6561 6d5f 6e61  ional `stream_na
+0001cde0: 6d65 600a 6172 6775 6d65 6e74 2c20 7768  me`.argument, wh
+0001cdf0: 6963 6820 7368 6f75 6c64 206d 6174 6368  ich should match
+0001ce00: 2074 6865 2076 616c 7565 7320 6f66 2061   the values of a
+0001ce10: 7267 756d 656e 7473 2075 7365 6420 7768  rguments used wh
+0001ce20: 656e 2063 616c 6c69 6e67 2065 6974 6865  en calling eithe
+0001ce30: 720a 6063 7265 6174 655f 7375 6273 6372  r.`create_subscr
+0001ce40: 6970 7469 6f6e 5f74 6f5f 616c 6c28 2960  iption_to_all()`
+0001ce50: 206f 7220 6063 7265 6174 655f 7375 6273   or `create_subs
+0001ce60: 6372 6970 7469 6f6e 5f74 6f5f 7374 7265  cription_to_stre
+0001ce70: 616d 2829 602e 0a0a 5468 6973 206d 6574  am()`...This met
+0001ce80: 686f 6420 6861 7320 616e 206f 7074 696f  hod has an optio
+0001ce90: 6e61 6c20 6074 696d 656f 7574 6020 6172  nal `timeout` ar
+0001cea0: 6775 6d65 6e74 2c20 7768 6963 6820 6973  gument, which is
+0001ceb0: 2061 2050 7974 686f 6e20 6066 6c6f 6174   a Python `float
+0001cec0: 600a 7468 6174 2073 6574 7320 6120 6d61  `.that sets a ma
+0001ced0: 7869 6d75 6d20 6475 7261 7469 6f6e 2c20  ximum duration, 
+0001cee0: 696e 2073 6563 6f6e 6473 2c20 666f 7220  in seconds, for 
+0001cef0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+0001cf00: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+0001cf10: 7469 6f6e 2e0a 0a54 6869 7320 6d65 7468  tion...This meth
+0001cf20: 6f64 2068 6173 2061 6e20 6f70 7469 6f6e  od has an option
+0001cf30: 616c 2060 6372 6564 656e 7469 616c 7360  al `credentials`
+0001cf40: 2061 7267 756d 656e 742c 2077 6869 6368   argument, which
+0001cf50: 2063 616e 2062 6520 7573 6564 2074 6f0a   can be used to.
+0001cf60: 6f76 6572 7269 6465 2063 616c 6c20 6372  override call cr
+0001cf70: 6564 656e 7469 616c 7320 6465 7269 7665  edentials derive
+0001cf80: 6420 6672 6f6d 2074 6865 2063 6f6e 6e65  d from the conne
+0001cf90: 6374 696f 6e20 7374 7269 6e67 2055 5249  ction string URI
+0001cfa0: 2e0a 0a54 6865 2065 7861 6d70 6c65 2062  ...The example b
+0001cfb0: 656c 6f77 2064 656c 6574 6573 2074 6865  elow deletes the
+0001cfc0: 2070 6572 7369 7374 656e 7420 7375 6273   persistent subs
+0001cfd0: 6372 6970 7469 6f6e 2060 6772 6f75 705f  cription `group_
+0001cfe0: 6e61 6d65 3160 2077 6869 6368 0a77 6173  name1` which.was
+0001cff0: 2063 7265 6174 6564 2062 7920 6361 6c6c   created by call
+0001d000: 696e 6720 6063 7265 6174 655f 7375 6273  ing `create_subs
+0001d010: 6372 6970 7469 6f6e 5f74 6f5f 616c 6c28  cription_to_all(
+0001d020: 2960 2e0a 0a60 6060 7079 7468 6f6e 0a63  )`...```python.c
+0001d030: 6c69 656e 742e 6465 6c65 7465 5f73 7562  lient.delete_sub
+0001d040: 7363 7269 7074 696f 6e28 0a20 2020 2067  scription(.    g
+0001d050: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
+0001d060: 6e61 6d65 312c 0a29 0a60 6060 0a0a 5468  name1,.).```..Th
+0001d070: 6520 6578 616d 706c 6520 6265 6c6f 7720  e example below 
+0001d080: 6465 6c65 7465 6420 7468 6520 7065 7273  deleted the pers
+0001d090: 6973 7465 6e74 2073 7562 7363 7269 7074  istent subscript
+0001d0a0: 696f 6e20 6067 726f 7570 5f6e 616d 6532  ion `group_name2
+0001d0b0: 6020 6f6e 0a60 7374 7265 616d 5f6e 616d  ` on.`stream_nam
+0001d0c0: 6532 6020 7768 6963 6820 7761 7320 6372  e2` which was cr
+0001d0d0: 6561 7465 6420 6279 2063 616c 6c69 6e67  eated by calling
+0001d0e0: 2060 6372 6561 7465 5f73 7562 7363 7269   `create_subscri
+0001d0f0: 7074 696f 6e5f 746f 5f73 7472 6561 6d28  ption_to_stream(
+0001d100: 2960 2e0a 0a60 6060 7079 7468 6f6e 0a63  )`...```python.c
+0001d110: 6c69 656e 742e 6465 6c65 7465 5f73 7562  lient.delete_sub
+0001d120: 7363 7269 7074 696f 6e28 0a20 2020 2067  scription(.    g
+0001d130: 726f 7570 5f6e 616d 653d 6772 6f75 705f  roup_name=group_
+0001d140: 6e61 6d65 322c 0a20 2020 2073 7472 6561  name2,.    strea
+0001d150: 6d5f 6e61 6d65 3d73 7472 6561 6d5f 6e61  m_name=stream_na
+0001d160: 6d65 322c 0a29 0a60 6060 0a0a 0a23 2320  me2,.).```...## 
+0001d170: 5072 6f6a 6563 7469 6f6e 733c 6120 6964  Projections<a id
+0001d180: 3d22 7072 6f6a 6563 7469 6f6e 7322 3e3c  ="projections"><
+0001d190: 2f61 3e0a 0a23 2323 2043 7265 6174 6520  /a>..### Create 
+0001d1a0: 7072 6f6a 6563 7469 6f6e 3c61 2069 643d  projection<a id=
+0001d1b0: 2263 7265 6174 652d 7072 6f6a 6563 7469  "create-projecti
+0001d1c0: 6f6e 223e 3c2f 613e 0a0a 5468 6520 6063  on"></a>..The `c
+0001d1d0: 7265 6174 655f 7072 6f6a 6563 7469 6f6e  reate_projection
+0001d1e0: 2829 6020 6d65 7468 6f64 2063 616e 2062  ()` method can b
+0001d1f0: 6520 7573 6564 2074 6f20 6372 6561 7465  e used to create
+0001d200: 2061 2070 726f 6a65 6374 696f 6e2e 0a0a   a projection...
+0001d210: 5468 6973 206d 6574 686f 6420 6861 7320  This method has 
+0001d220: 6120 7265 7175 6972 6564 2060 7175 6572  a required `quer
+0001d230: 7960 2061 7267 756d 656e 742c 2077 6869  y` argument, whi
+0001d240: 6368 2069 7320 6120 5079 7468 6f6e 2060  ch is a Python `
+0001d250: 7374 7260 2074 6861 740a 6465 6669 6e65  str` that.define
+0001d260: 7320 7768 6174 2074 6865 2070 726f 6a65  s what the proje
+0001d270: 6374 696f 6e20 7769 6c6c 2064 6f2e 0a0a  ction will do...
+0001d280: 5468 6973 206d 6574 686f 6420 616c 736f  This method also
+0001d290: 2068 6173 2073 6978 206f 7074 696f 6e61   has six optiona
+0001d2a0: 6c20 6172 6775 6d65 6e74 732c 2060 6e61  l arguments, `na
+0001d2b0: 6d65 602c 2060 636f 6e74 696e 756f 7573  me`, `continuous
+0001d2c0: 602c 2060 656d 6974 5f65 6e61 626c 6564  `, `emit_enabled
+0001d2d0: 602c 0a60 7472 6163 6b5f 656d 6974 7465  `,.`track_emitte
+0001d2e0: 645f 7374 7265 616d 7360 2c20 6074 696d  d_streams`, `tim
+0001d2f0: 656f 7574 602c 2061 6e64 2060 6372 6564  eout`, and `cred
+0001d300: 656e 7469 616c 7360 2e0a 0a54 6865 206f  entials`...The o
+0001d310: 7074 696f 6e61 6c20 606e 616d 6560 2061  ptional `name` a
+0001d320: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0001d330: 686f 6e20 6073 7472 6020 7768 6963 6820  hon `str` which 
+0001d340: 7370 6563 6966 6965 7320 7468 6520 6e61  specifies the na
+0001d350: 6d65 206f 6620 7468 6520 7072 6f6a 6563  me of the projec
+0001d360: 7469 6f6e 2e0a 4966 2061 206e 616d 6520  tion..If a name 
+0001d370: 6973 2070 726f 7669 6465 642c 2074 6865  is provided, the
+0001d380: 2070 726f 6a65 6374 696f 6e20 7769 6c6c   projection will
+0001d390: 2065 6974 6865 7220 6265 2061 2022 7472   either be a "tr
+0001d3a0: 616e 7369 656e 7422 206f 7220 6120 2263  ansient" or a "c
+0001d3b0: 6f6e 7469 6e75 6f75 7322 0a70 726f 6a65  ontinuous".proje
+0001d3c0: 6374 696f 6e2e 204f 7468 6572 7769 7365  ction. Otherwise
+0001d3d0: 2c20 7468 6520 7072 6f6a 6563 7469 6f6e  , the projection
+0001d3e0: 2077 696c 6c20 6265 2061 2022 6f6e 6520   will be a "one 
+0001d3f0: 7469 6d65 2220 7072 6f6a 6563 7469 6f6e  time" projection
+0001d400: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001d410: 6063 6f6e 7469 6e75 6f75 7360 2061 7267  `continuous` arg
+0001d420: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0001d430: 6e20 6062 6f6f 6c60 2077 6869 6368 2073  n `bool` which s
+0001d440: 7065 6369 6669 6573 2077 6865 7468 6572  pecifies whether
+0001d450: 2061 0a70 726f 6a65 6374 696f 6e20 7769   a.projection wi
+0001d460: 6c6c 2062 6520 6120 2263 6f6e 7469 6e75  ll be a "continu
+0001d470: 6f75 7322 2070 726f 6a65 6374 696f 6e2e  ous" projection.
+0001d480: 2049 6620 6120 6054 7275 6560 2076 616c   If a `True` val
+0001d490: 7565 2069 7320 7370 6563 6966 6965 642c  ue is specified,
+0001d4a0: 2074 6865 0a70 726f 6a65 6374 696f 6e20   the.projection 
+0001d4b0: 7769 6c6c 2062 6520 6120 2263 6f6e 7469  will be a "conti
+0001d4c0: 6e75 6f75 7322 2070 726f 6a65 6374 696f  nuous" projectio
+0001d4d0: 6e2c 206f 7468 6572 7769 7365 2074 6865  n, otherwise the
+0001d4e0: 2070 726f 6a65 6374 696f 6e20 7769 6c6c   projection will
+0001d4f0: 2062 6520 610a 2274 7261 6e73 6965 6e74   be a."transient
+0001d500: 2220 7072 6f6a 6563 7469 6f6e 2e20 5468  " projection. Th
+0001d510: 6520 6465 6661 756c 7420 7661 6c75 6520  e default value 
+0001d520: 6f66 2060 636f 6e74 696e 756f 7573 6020  of `continuous` 
+0001d530: 6973 2060 4661 6c73 6560 2e0a 0a54 6865  is `False`...The
+0001d540: 206f 7074 696f 6e61 6c20 6065 6d69 745f   optional `emit_
+0001d550: 656e 6162 6c65 6460 2061 7267 756d 656e  enabled` argumen
+0001d560: 7420 6973 2061 2050 7974 686f 6e20 6062  t is a Python `b
+0001d570: 6f6f 6c60 2077 6869 6368 2073 7065 6369  ool` which speci
+0001d580: 6669 6573 2077 6865 7468 6572 2061 0a70  fies whether a.p
+0001d590: 726f 6a65 6374 696f 6e20 7769 6c6c 2062  rojection will b
+0001d5a0: 6520 6162 6c65 2074 6f20 656d 6974 2065  e able to emit e
+0001d5b0: 7665 6e74 732e 2049 6620 6120 6054 7275  vents. If a `Tru
+0001d5c0: 6560 2076 616c 7565 2069 7320 7370 6563  e` value is spec
+0001d5d0: 6966 6965 642c 2074 6865 2070 726f 6a65  ified, the proje
+0001d5e0: 6374 696f 6e0a 7769 6c6c 2062 6520 6162  ction.will be ab
+0001d5f0: 6c65 2074 6f20 656d 6974 2065 7665 6e74  le to emit event
+0001d600: 732c 206f 7468 6572 7769 7365 2074 6865  s, otherwise the
+0001d610: 2070 726f 6a65 6374 696f 6e20 7769 6c6c   projection will
+0001d620: 206e 6f74 2062 6520 6162 6c65 2074 6f20   not be able to 
+0001d630: 656d 6974 2065 7665 6e74 732e 0a54 6865  emit events..The
+0001d640: 2064 6566 6175 6c74 2076 616c 7565 206f   default value o
+0001d650: 6620 6065 6d69 745f 656e 6162 6c65 6460  f `emit_enabled`
+0001d660: 2069 7320 6046 616c 7365 602e 0a0a 5468   is `False`...Th
+0001d670: 6520 6f70 7469 6f6e 616c 2060 7472 6163  e optional `trac
+0001d680: 6b5f 656d 6974 7465 645f 7374 7265 616d  k_emitted_stream
+0001d690: 7360 2061 7267 756d 656e 7420 6973 2061  s` argument is a
+0001d6a0: 2050 7974 686f 6e20 6062 6f6f 6c60 2077   Python `bool` w
+0001d6b0: 6869 6368 2073 7065 6369 6669 6573 2077  hich specifies w
+0001d6c0: 6865 7468 6572 0a61 2070 726f 6a65 6374  hether.a project
+0001d6d0: 696f 6e20 7769 6c6c 2068 6176 6520 6974  ion will have it
+0001d6e0: 7320 656d 6974 7465 6420 7374 7265 616d  s emitted stream
+0001d6f0: 7320 7472 6163 6b65 642e 2049 6620 6120  s tracked. If a 
+0001d700: 6054 7275 6560 2076 616c 7565 2069 7320  `True` value is 
+0001d710: 7370 6563 6966 6965 642c 2074 6865 0a70  specified, the.p
+0001d720: 726f 6a65 6374 696f 6e20 7769 6c6c 2068  rojection will h
+0001d730: 6176 6520 6974 7320 656d 6974 7465 6420  ave its emitted 
+0001d740: 7374 7265 616d 7320 7472 6163 6b65 642c  streams tracked,
+0001d750: 206f 7468 6572 7769 7365 2074 6865 2070   otherwise the p
+0001d760: 726f 6a65 6374 696f 6e20 7769 6c6c 206e  rojection will n
+0001d770: 6f74 0a68 6176 6520 6974 7320 656d 6974  ot.have its emit
+0001d780: 7465 6420 7374 7265 616d 7320 7472 6163  ted streams trac
+0001d790: 6b65 642e 2054 6865 2064 6566 6175 6c74  ked. The default
+0001d7a0: 2076 616c 7565 206f 6620 6074 7261 636b   value of `track
+0001d7b0: 5f65 6d69 7474 6564 5f73 7472 6561 6d73  _emitted_streams
+0001d7c0: 6020 6973 2060 4661 6c73 6560 2e0a 0a54  ` is `False`...T
+0001d7d0: 6865 206f 7074 696f 6e61 6c20 6074 696d  he optional `tim
+0001d7e0: 656f 7574 6020 6172 6775 6d65 6e74 2069  eout` argument i
+0001d7f0: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+0001d800: 7460 2077 6869 6368 2073 6574 7320 610a  t` which sets a.
+0001d810: 6d61 7869 6d75 6d20 6475 7261 7469 6f6e  maximum duration
+0001d820: 2c20 696e 2073 6563 6f6e 6473 2c20 666f  , in seconds, fo
+0001d830: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
+0001d840: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
+0001d850: 7261 7469 6f6e 2e0a 0a54 6865 206f 7074  ration...The opt
+0001d860: 696f 6e61 6c20 6063 7265 6465 6e74 6961  ional `credentia
+0001d870: 6c73 6020 6172 6775 6d65 6e74 2063 616e  ls` argument can
+0001d880: 2062 6520 7573 6564 2074 6f0a 6f76 6572   be used to.over
+0001d890: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
+0001d8a0: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
+0001d8b0: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
+0001d8c0: 6e20 7374 7269 6e67 2055 5249 2e0a 0a49  n string URI...I
+0001d8d0: 6e20 7468 6520 6578 616d 706c 6520 6265  n the example be
+0001d8e0: 6c6f 772c 2061 2063 6f6e 7469 6e75 6f75  low, a continuou
+0001d8f0: 7320 7072 6f6a 6563 7469 6f6e 2069 7320  s projection is 
+0001d900: 6372 6561 7465 6420 7468 6174 2070 726f  created that pro
+0001d910: 6365 7373 6573 0a65 7665 6e74 7320 6170  cesses.events ap
+0001d920: 7065 6e64 6564 2074 6f20 6073 7472 6561  pended to `strea
+0001d930: 6d5f 6e61 6d65 3260 2e20 5468 6520 2273  m_name2`. The "s
+0001d940: 7461 7465 2220 6f66 2074 6865 2070 726f  tate" of the pro
+0001d950: 6a65 6374 696f 6e20 6973 0a69 6e69 7469  jection is.initi
+0001d960: 616c 6973 6564 2074 6f20 6861 7665 2061  alised to have a
+0001d970: 2022 636f 756e 7422 2074 6861 7420 6973   "count" that is
+0001d980: 2069 6e63 7265 6d65 6e74 6564 206f 6e63   incremented onc
+0001d990: 6520 666f 7220 6561 6368 2065 7665 6e74  e for each event
+0001d9a0: 2e0a 0a60 6060 7079 7468 6f6e 0a70 726f  ...```python.pro
+0001d9b0: 6a65 6374 696f 6e5f 6e61 6d65 203d 2073  jection_name = s
+0001d9c0: 7472 2875 7569 642e 7575 6964 3428 2929  tr(uuid.uuid4())
+0001d9d0: 0a0a 7072 6f6a 6563 7469 6f6e 5f71 7565  ..projection_que
+0001d9e0: 7279 203d 2022 2222 6672 6f6d 5374 7265  ry = """fromStre
+0001d9f0: 616d 2827 2573 2729 0a2e 7768 656e 287b  am('%s')..when({
+0001da00: 0a20 2024 696e 6974 3a20 6675 6e63 7469  .  $init: functi
+0001da10: 6f6e 2829 7b0a 2020 2020 7265 7475 726e  on(){.    return
+0001da20: 207b 0a20 2020 2020 2063 6f75 6e74 3a20   {.      count: 
+0001da30: 300a 2020 2020 7d3b 0a20 207d 2c0a 2020  0.    };.  },.  
+0001da40: 4f72 6465 7243 7265 6174 6564 3a20 6675  OrderCreated: fu
+0001da50: 6e63 7469 6f6e 2873 2c65 297b 0a20 2020  nction(s,e){.   
+0001da60: 2073 2e63 6f75 6e74 202b 3d20 313b 0a20   s.count += 1;. 
+0001da70: 207d 2c0a 2020 4f72 6465 7255 7064 6174   },.  OrderUpdat
+0001da80: 6564 3a20 6675 6e63 7469 6f6e 2873 2c65  ed: function(s,e
+0001da90: 297b 0a20 2020 2073 2e63 6f75 6e74 202b  ){.    s.count +
+0001daa0: 3d20 313b 0a20 207d 2c0a 2020 4f72 6465  = 1;.  },.  Orde
+0001dab0: 7244 656c 6574 6564 3a20 6675 6e63 7469  rDeleted: functi
+0001dac0: 6f6e 2873 2c65 297b 0a20 2020 2073 2e63  on(s,e){.    s.c
+0001dad0: 6f75 6e74 202b 3d20 313b 0a20 207d 0a7d  ount += 1;.  }.}
+0001dae0: 290a 2e6f 7574 7075 7453 7461 7465 2829  )..outputState()
+0001daf0: 0a22 2222 2020 2520 7374 7265 616d 5f6e  ."""  % stream_n
+0001db00: 616d 6532 0a0a 636c 6965 6e74 2e63 7265  ame2..client.cre
+0001db10: 6174 655f 7072 6f6a 6563 7469 6f6e 280a  ate_projection(.
+0001db20: 2020 2020 6e61 6d65 3d70 726f 6a65 6374      name=project
+0001db30: 696f 6e5f 6e61 6d65 2c0a 2020 2020 7175  ion_name,.    qu
+0001db40: 6572 793d 7072 6f6a 6563 7469 6f6e 5f71  ery=projection_q
+0001db50: 7565 7279 2c0a 2020 2020 636f 6e74 696e  uery,.    contin
+0001db60: 756f 7573 3d54 7275 652c 0a29 0a60 6060  uous=True,.).```
+0001db70: 0a0a 2323 2320 4765 7420 7072 6f6a 6563  ..### Get projec
+0001db80: 7469 6f6e 2073 7461 7465 3c61 2069 643d  tion state<a id=
+0001db90: 2267 6574 2d70 726f 6a65 6374 696f 6e2d  "get-projection-
+0001dba0: 7374 6174 6522 3e3c 2f61 3e0a 0a54 6865  state"></a>..The
+0001dbb0: 2060 6765 745f 7072 6f6a 6563 7469 6f6e   `get_projection
+0001dbc0: 5f73 7461 7465 2829 6020 6d65 7468 6f64  _state()` method
+0001dbd0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0001dbe0: 6765 7420 6120 7072 6f6a 6563 7469 6f6e  get a projection
+0001dbf0: 2773 2073 7461 7465 2e0a 0a54 6869 7320  's state...This 
+0001dc00: 6d65 7468 6f64 2068 6173 2061 2072 6571  method has a req
+0001dc10: 7569 7265 6420 606e 616d 6560 2061 7267  uired `name` arg
+0001dc20: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
+0001dc30: 6120 5079 7468 6f6e 2060 7374 7260 2074  a Python `str` t
+0001dc40: 6861 740a 7370 6563 6966 6965 7320 7468  hat.specifies th
+0001dc50: 6520 6e61 6d65 206f 6620 6120 7072 6f6a  e name of a proj
+0001dc60: 6563 7469 6f6e 2e0a 0a54 6869 7320 6d65  ection...This me
+0001dc70: 7468 6f64 2061 6c73 6f20 6861 7320 7468  thod also has th
+0001dc80: 7265 6520 6f70 7469 6f6e 616c 2061 7267  ree optional arg
+0001dc90: 756d 656e 7473 2c20 6070 6172 7469 7469  uments, `partiti
+0001dca0: 6f6e 602c 2060 7469 6d65 6f75 7460 2c20  on`, `timeout`, 
+0001dcb0: 616e 6420 6063 7265 6465 6e74 6961 6c73  and `credentials
+0001dcc0: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
+0001dcd0: 2060 7061 7274 6974 696f 6e60 2061 7267   `partition` arg
+0001dce0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0001dcf0: 6e20 6073 7472 6020 7768 6963 6820 7370  n `str` which sp
+0001dd00: 6563 6966 6965 7320 6120 7061 7274 6974  ecifies a partit
+0001dd10: 696f 6e2e 2e2e 0a0a 5468 6520 6f70 7469  ion.....The opti
+0001dd20: 6f6e 616c 2060 7469 6d65 6f75 7460 2061  onal `timeout` a
+0001dd30: 7267 756d 656e 7420 6973 2061 2050 7974  rgument is a Pyt
+0001dd40: 686f 6e20 6066 6c6f 6174 6020 7768 6963  hon `float` whic
+0001dd50: 6820 7365 7473 2061 0a6d 6178 696d 756d  h sets a.maximum
+0001dd60: 2064 7572 6174 696f 6e2c 2069 6e20 7365   duration, in se
+0001dd70: 636f 6e64 732c 2066 6f72 2074 6865 2063  conds, for the c
+0001dd80: 6f6d 706c 6574 696f 6e20 6f66 2074 6865  ompletion of the
+0001dd90: 2067 5250 4320 6f70 6572 6174 696f 6e2e   gRPC operation.
+0001dda0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0001ddb0: 6372 6564 656e 7469 616c 7360 2061 7267  credentials` arg
+0001ddc0: 756d 656e 7420 6361 6e20 6265 2075 7365  ument can be use
+0001ddd0: 6420 746f 0a6f 7665 7272 6964 6520 6361  d to.override ca
+0001dde0: 6c6c 2063 7265 6465 6e74 6961 6c73 2064  ll credentials d
+0001ddf0: 6572 6976 6564 2066 726f 6d20 7468 6520  erived from the 
+0001de00: 636f 6e6e 6563 7469 6f6e 2073 7472 696e  connection strin
+0001de10: 6720 5552 492e 0a0a 496e 2074 6865 2065  g URI...In the e
+0001de20: 7861 6d70 6c65 2062 656c 6f77 2c20 6166  xample below, af
+0001de30: 7465 7220 736c 6565 7069 6e67 2066 6f72  ter sleeping for
+0001de40: 2031 2073 6563 6f6e 6420 746f 2061 6c6c   1 second to all
+0001de50: 6f77 2074 6865 2070 726f 6a65 6374 696f  ow the projectio
+0001de60: 6e0a 746f 2070 726f 6365 7373 2061 6c6c  n.to process all
+0001de70: 2074 6865 2072 6563 6f72 6465 6420 6576   the recorded ev
+0001de80: 656e 7473 2c20 7468 6520 7072 6f6a 6563  ents, the projec
+0001de90: 7469 6f6e 2022 7374 6174 6522 2069 7320  tion "state" is 
+0001dea0: 6f62 7461 696e 6564 2e0a 5765 2063 616e  obtained..We can
+0001deb0: 2073 6565 2074 6861 7420 7468 6520 7072   see that the pr
+0001dec0: 6f6a 6563 7469 6f6e 2068 6173 2070 726f  ojection has pro
+0001ded0: 6365 7373 6564 2074 6872 6565 2065 7665  cessed three eve
+0001dee0: 6e74 732e 0a0a 6060 6070 7974 686f 6e0a  nts...```python.
+0001def0: 736c 6565 7028 3129 2020 2320 616c 6c6f  sleep(1)  # allo
+0001df00: 7720 7469 6d65 2066 6f72 2070 726f 6a65  w time for proje
+0001df10: 6374 696f 6e20 746f 2070 726f 6365 7373  ction to process
+0001df20: 2072 6563 6f72 6465 6420 6576 656e 7473   recorded events
+0001df30: 0a0a 7072 6f6a 6563 7469 6f6e 5f73 7461  ..projection_sta
+0001df40: 7465 203d 2063 6c69 656e 742e 6765 745f  te = client.get_
+0001df50: 7072 6f6a 6563 7469 6f6e 5f73 7461 7465  projection_state
+0001df60: 286e 616d 653d 7072 6f6a 6563 7469 6f6e  (name=projection
+0001df70: 5f6e 616d 6529 0a0a 6173 7365 7274 2070  _name)..assert p
+0001df80: 726f 6a65 6374 696f 6e5f 7374 6174 652e  rojection_state.
+0001df90: 7661 6c75 6520 3d3d 207b 2763 6f75 6e74  value == {'count
+0001dfa0: 273a 2033 7d0a 6060 600a 0a23 2323 2047  ': 3}.```..### G
+0001dfb0: 6574 2070 726f 6a65 6374 696f 6e20 7265  et projection re
+0001dfc0: 7375 6c74 3c61 2069 643d 2267 6574 2d70  sult<a id="get-p
+0001dfd0: 726f 6a65 6374 696f 6e2d 7265 7375 6c74  rojection-result
+0001dfe0: 223e 3c2f 613e 0a0a 5468 6520 6067 6574  "></a>..The `get
+0001dff0: 5f70 726f 6a65 6374 696f 6e5f 7265 7375  _projection_resu
+0001e000: 6c74 2829 6020 6d65 7468 6f64 2063 616e  lt()` method can
+0001e010: 2062 6520 7573 6564 2074 6f20 6765 7420   be used to get 
+0001e020: 6120 7072 6f6a 6563 7469 6f6e 2773 2072  a projection's r
+0001e030: 6573 756c 742e 0a0a 5468 6973 206d 6574  esult...This met
+0001e040: 686f 6420 6861 7320 6120 7265 7175 6972  hod has a requir
+0001e050: 6564 2060 6e61 6d65 6020 6172 6775 6d65  ed `name` argume
+0001e060: 6e74 2c20 7768 6963 6820 6973 2061 2050  nt, which is a P
+0001e070: 7974 686f 6e20 6073 7472 6020 7468 6174  ython `str` that
+0001e080: 0a73 7065 6369 6669 6573 2074 6865 206e  .specifies the n
+0001e090: 616d 6520 6f66 2061 2070 726f 6a65 6374  ame of a project
+0001e0a0: 696f 6e2e 0a0a 5468 6973 206d 6574 686f  ion...This metho
+0001e0b0: 6420 616c 736f 2068 6173 2074 6872 6565  d also has three
+0001e0c0: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0001e0d0: 6e74 732c 2060 7061 7274 6974 696f 6e60  nts, `partition`
+0001e0e0: 2c20 6074 696d 656f 7574 602c 2061 6e64  , `timeout`, and
+0001e0f0: 2060 6372 6564 656e 7469 616c 7360 2e0a   `credentials`..
+0001e100: 0a54 6865 206f 7074 696f 6e61 6c20 6070  .The optional `p
+0001e110: 6172 7469 7469 6f6e 6020 6172 6775 6d65  artition` argume
+0001e120: 6e74 2069 7320 6120 5079 7468 6f6e 2060  nt is a Python `
+0001e130: 7374 7260 2077 6869 6368 2073 7065 6369  str` which speci
+0001e140: 6669 6573 2061 2070 6172 7469 7469 6f6e  fies a partition
+0001e150: 2e2e 2e0a 0a54 6865 206f 7074 696f 6e61  .....The optiona
+0001e160: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+0001e170: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+0001e180: 2060 666c 6f61 7460 2077 6869 6368 2073   `float` which s
+0001e190: 6574 7320 610a 6d61 7869 6d75 6d20 6475  ets a.maximum du
+0001e1a0: 7261 7469 6f6e 2c20 696e 2073 6563 6f6e  ration, in secon
+0001e1b0: 6473 2c20 666f 7220 7468 6520 636f 6d70  ds, for the comp
+0001e1c0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+0001e1d0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+0001e1e0: 6865 206f 7074 696f 6e61 6c20 6063 7265  he optional `cre
+0001e1f0: 6465 6e74 6961 6c73 6020 6172 6775 6d65  dentials` argume
+0001e200: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+0001e210: 6f0a 6f76 6572 7269 6465 2063 616c 6c20  o.override call 
+0001e220: 6372 6564 656e 7469 616c 7320 6465 7269  credentials deri
+0001e230: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
+0001e240: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
+0001e250: 5249 2e0a 0a49 6e20 7468 6520 6578 616d  RI...In the exam
+0001e260: 706c 6520 6265 6c6f 772c 2074 6865 2070  ple below, the p
+0001e270: 726f 6a65 6374 696f 6e20 2272 6573 756c  rojection "resul
+0001e280: 7422 2069 7320 6f62 7461 696e 6564 2e0a  t" is obtained..
+0001e290: 5765 2063 616e 2073 6565 2074 6861 7420  We can see that 
+0001e2a0: 7468 6520 7072 6f6a 6563 7469 6f6e 2068  the projection h
+0001e2b0: 6173 2070 726f 6365 7373 6564 2074 6872  as processed thr
+0001e2c0: 6565 2065 7665 6e74 732e 0a0a 6060 6070  ee events...```p
+0001e2d0: 7974 686f 6e0a 7072 6f6a 6563 7469 6f6e  ython.projection
+0001e2e0: 5f72 6573 756c 7420 3d20 636c 6965 6e74  _result = client
+0001e2f0: 2e67 6574 5f70 726f 6a65 6374 696f 6e5f  .get_projection_
+0001e300: 7265 7375 6c74 286e 616d 653d 7072 6f6a  result(name=proj
+0001e310: 6563 7469 6f6e 5f6e 616d 6529 0a0a 6173  ection_name)..as
+0001e320: 7365 7274 2070 726f 6a65 6374 696f 6e5f  sert projection_
+0001e330: 7265 7375 6c74 2e76 616c 7565 203d 3d20  result.value == 
+0001e340: 7b27 636f 756e 7427 3a20 337d 0a60 6060  {'count': 3}.```
+0001e350: 0a0a 2323 2320 4765 7420 7072 6f6a 6563  ..### Get projec
+0001e360: 7469 6f6e 2073 7461 7469 7374 6963 733c  tion statistics<
+0001e370: 6120 6964 3d22 6765 742d 7072 6f6a 6563  a id="get-projec
+0001e380: 7469 6f6e 2d73 7461 7469 7374 6963 7322  tion-statistics"
+0001e390: 3e3c 2f61 3e0a 0a54 6865 2060 6765 745f  ></a>..The `get_
+0001e3a0: 7072 6f6a 6563 7469 6f6e 5f73 7461 7469  projection_stati
+0001e3b0: 7374 7563 7328 2960 206d 6574 686f 6420  stucs()` method 
+0001e3c0: 6361 6e20 6265 2075 7365 6420 746f 2067  can be used to g
+0001e3d0: 6574 2070 726f 6a65 6374 696f 6e20 7374  et projection st
+0001e3e0: 6174 6973 7469 6373 2e0a 0a54 6869 7320  atistics...This 
+0001e3f0: 6d65 7468 6f64 2061 6c73 6f20 6861 7320  method also has 
+0001e400: 7365 7665 6e20 6f70 7469 6f6e 616c 2061  seven optional a
+0001e410: 7267 756d 656e 7473 2c20 606e 616d 6560  rguments, `name`
+0001e420: 2c20 6061 6c6c 602c 2060 7472 616e 7369  , `all`, `transi
+0001e430: 656e 7460 2c0a 6063 6f6e 7469 6e75 6f75  ent`,.`continuou
+0001e440: 7360 2c20 606f 6e65 5f74 696d 6560 2c20  s`, `one_time`, 
+0001e450: 6074 696d 656f 7574 602c 2061 6e64 2060  `timeout`, and `
+0001e460: 6372 6564 656e 7469 616c 7360 2e0a 0a54  credentials`...T
+0001e470: 6865 206f 7074 696f 6e61 6c20 606e 616d  he optional `nam
+0001e480: 6560 2061 7267 756d 656e 7420 6973 2061  e` argument is a
+0001e490: 2050 7974 686f 6e20 6073 7472 6020 7468   Python `str` th
+0001e4a0: 6174 2073 7065 6369 6669 6573 2074 6865  at specifies the
+0001e4b0: 206e 616d 6520 6f66 2061 0a70 726f 6a65   name of a.proje
+0001e4c0: 6374 696f 6e2e 2049 6620 7468 6520 6e61  ction. If the na
+0001e4d0: 6d65 206f 6620 6120 7072 6f6a 6563 7469  me of a projecti
+0001e4e0: 6f6e 2069 7320 7370 6563 6966 6965 642c  on is specified,
+0001e4f0: 2074 6869 7320 6d65 7468 6f64 2077 696c   this method wil
+0001e500: 6c20 7265 7475 726e 0a61 2073 696e 676c  l return.a singl
+0001e510: 6520 6050 726f 6a65 6374 696f 6e53 7461  e `ProjectionSta
+0001e520: 7469 7374 6963 7360 206f 626a 6563 7420  tistics` object 
+0001e530: 7468 6174 2072 6570 7265 7365 6e74 7320  that represents 
+0001e540: 7468 6174 2070 726f 6a65 6374 696f 6e2e  that projection.
+0001e550: 204f 7468 6572 7769 7365 0a74 6869 7320   Otherwise.this 
+0001e560: 6d65 7468 6f64 2077 696c 6c20 7265 7475  method will retu
+0001e570: 726e 2061 2073 6571 7565 6e63 6520 6f66  rn a sequence of
+0001e580: 2060 5072 6f6a 6563 7469 6f6e 5374 6174   `ProjectionStat
+0001e590: 6973 7469 6373 6020 6f62 6a65 6374 732e  istics` objects.
+0001e5a0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0001e5b0: 616c 6c60 2061 7267 756d 656e 7420 6973  all` argument is
+0001e5c0: 2050 7974 686f 6e20 6062 6f6f 6c60 2074   Python `bool` t
+0001e5d0: 6861 7420 6361 6e20 6265 2075 7365 6420  hat can be used 
+0001e5e0: 746f 2072 6571 7565 7374 2073 7461 7469  to request stati
+0001e5f0: 7374 6963 730a 666f 7220 616c 6c20 7072  stics.for all pr
+0001e600: 6f6a 6563 7469 6f6e 732e 0a0a 5468 6520  ojections...The 
+0001e610: 6f70 7469 6f6e 616c 2060 7472 616e 7369  optional `transi
+0001e620: 656e 7460 2061 7267 756d 656e 7420 6973  ent` argument is
+0001e630: 2050 7974 686f 6e20 6062 6f6f 6c60 2074   Python `bool` t
+0001e640: 6861 7420 6361 6e20 6265 2075 7365 6420  hat can be used 
+0001e650: 746f 2072 6571 7565 7374 0a73 7461 7469  to request.stati
+0001e660: 7374 6963 7320 666f 7220 616c 6c20 2274  stics for all "t
+0001e670: 7261 6e73 6965 6e74 2220 7072 6f6a 6563  ransient" projec
+0001e680: 7469 6f6e 732e 0a0a 5468 6520 6f70 7469  tions...The opti
+0001e690: 6f6e 616c 2060 636f 6e74 696e 756f 7573  onal `continuous
+0001e6a0: 6020 6172 6775 6d65 6e74 2069 7320 5079  ` argument is Py
+0001e6b0: 7468 6f6e 2060 626f 6f6c 6020 7468 6174  thon `bool` that
+0001e6c0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0001e6d0: 7265 7175 6573 740a 7374 6174 6973 7469  request.statisti
+0001e6e0: 6373 2066 6f72 2061 6c6c 2022 636f 6e74  cs for all "cont
+0001e6f0: 696e 756f 7573 2220 7072 6f6a 6563 7469  inuous" projecti
+0001e700: 6f6e 732e 0a0a 5468 6520 6f70 7469 6f6e  ons...The option
+0001e710: 616c 2060 6f6e 655f 7469 6d65 6020 6172  al `one_time` ar
+0001e720: 6775 6d65 6e74 2069 7320 5079 7468 6f6e  gument is Python
+0001e730: 2060 626f 6f6c 6020 7468 6174 2063 616e   `bool` that can
+0001e740: 2062 6520 7573 6564 2074 6f20 7265 7175   be used to requ
+0001e750: 6573 740a 7374 6174 6973 7469 6373 2066  est.statistics f
+0001e760: 6f72 2061 6c6c 2022 6f6e 6520 7469 6d65  or all "one time
+0001e770: 2220 7072 6f6a 6563 7469 6f6e 732e 0a0a  " projections...
+0001e780: 5468 6520 6f70 7469 6f6e 616c 2060 7469  The optional `ti
+0001e790: 6d65 6f75 7460 2061 7267 756d 656e 7420  meout` argument 
+0001e7a0: 6973 2061 2050 7974 686f 6e20 6066 6c6f  is a Python `flo
+0001e7b0: 6174 6020 7768 6963 6820 7365 7473 2061  at` which sets a
+0001e7c0: 0a6d 6178 696d 756d 2064 7572 6174 696f  .maximum duratio
+0001e7d0: 6e2c 2069 6e20 7365 636f 6e64 732c 2066  n, in seconds, f
+0001e7e0: 6f72 2074 6865 2063 6f6d 706c 6574 696f  or the completio
+0001e7f0: 6e20 6f66 2074 6865 2067 5250 4320 6f70  n of the gRPC op
+0001e800: 6572 6174 696f 6e2e 0a0a 5468 6520 6f70  eration...The op
+0001e810: 7469 6f6e 616c 2060 6372 6564 656e 7469  tional `credenti
+0001e820: 616c 7360 2061 7267 756d 656e 7420 6361  als` argument ca
+0001e830: 6e20 6265 2075 7365 6420 746f 0a6f 7665  n be used to.ove
+0001e840: 7272 6964 6520 6361 6c6c 2063 7265 6465  rride call crede
+0001e850: 6e74 6961 6c73 2064 6572 6976 6564 2066  ntials derived f
+0001e860: 726f 6d20 7468 6520 636f 6e6e 6563 7469  rom the connecti
+0001e870: 6f6e 2073 7472 696e 6720 5552 492e 0a0a  on string URI...
+0001e880: 6060 6070 7974 686f 6e0a 7374 6174 6973  ```python.statis
+0001e890: 7469 6373 203d 2063 6c69 656e 742e 6765  tics = client.ge
+0001e8a0: 745f 7072 6f6a 6563 7469 6f6e 5f73 7461  t_projection_sta
+0001e8b0: 7469 7374 6963 7328 6e61 6d65 3d70 726f  tistics(name=pro
+0001e8c0: 6a65 6374 696f 6e5f 6e61 6d65 290a 6060  jection_name).``
+0001e8d0: 600a 0a41 2060 5072 6f6a 6563 7469 6f6e  `..A `Projection
+0001e8e0: 5374 6174 6973 7469 6373 6020 6f62 6a65  Statistics` obje
+0001e8f0: 6374 2069 7320 7265 7475 726e 6564 2e20  ct is returned. 
+0001e900: 5468 6520 6174 7472 6962 7574 6573 206f  The attributes o
+0001e910: 6620 7468 6973 206f 626a 6563 740a 6861  f this object.ha
+0001e920: 7665 2076 616c 7565 7320 7468 6174 2072  ve values that r
+0001e930: 6570 7265 7365 6e74 2074 6865 2070 726f  epresent the pro
+0001e940: 6772 6573 7320 6f66 2074 6865 2070 726f  gress of the pro
+0001e950: 6a65 6374 696f 6e2e 0a0a 2323 2320 5570  jection...### Up
+0001e960: 6461 7465 2070 726f 6a65 6374 696f 6e3c  date projection<
+0001e970: 6120 6964 3d22 7570 6461 7465 2d70 726f  a id="update-pro
+0001e980: 6a65 6374 696f 6e22 3e3c 2f61 3e0a 0a54  jection"></a>..T
+0001e990: 6865 2060 7570 6461 7465 5f70 726f 6a65  he `update_proje
+0001e9a0: 6374 696f 6e28 2960 206d 6574 686f 6420  ction()` method 
+0001e9b0: 6361 6e20 6265 2075 7365 6420 746f 2075  can be used to u
+0001e9c0: 7064 6174 6520 6120 7072 6f6a 6563 7469  pdate a projecti
+0001e9d0: 6f6e 2e0a 0a54 6869 7320 6d65 7468 6f64  on...This method
+0001e9e0: 2068 6173 2074 776f 2072 6571 7569 7265   has two require
+0001e9f0: 6420 6172 6775 6d65 6e74 732c 2060 6e61  d arguments, `na
+0001ea00: 6d65 6020 616e 6420 6071 7565 7279 602e  me` and `query`.
+0001ea10: 0a0a 5468 6520 7265 7175 6972 6564 2060  ..The required `
+0001ea20: 6e61 6d65 6020 6172 6775 6d65 6e74 2069  name` argument i
+0001ea30: 7320 6120 5079 7468 6f6e 2060 7374 7260  s a Python `str`
+0001ea40: 2077 6869 6368 2073 7065 6369 6669 6573   which specifies
+0001ea50: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
+0001ea60: 2070 726f 6a65 6374 696f 6e0a 746f 2062   projection.to b
+0001ea70: 6520 7570 6461 7465 642e 0a0a 5468 6520  e updated...The 
+0001ea80: 7265 7175 6972 6564 2060 7175 6572 7960  required `query`
+0001ea90: 2061 7267 756d 656e 7420 6973 2061 2050   argument is a P
+0001eaa0: 7974 686f 6e20 6073 7472 6020 7768 6963  ython `str` whic
+0001eab0: 6820 6465 6669 6e65 7320 7768 6174 2074  h defines what t
+0001eac0: 6865 2070 726f 6a65 6374 696f 6e20 7769  he projection wi
+0001ead0: 6c6c 2064 6f2e 0a0a 5468 6973 206d 6574  ll do...This met
+0001eae0: 686f 6420 616c 736f 2068 6173 2074 6872  hod also has thr
+0001eaf0: 6565 206f 7074 696f 6e61 6c20 6172 6775  ee optional argu
+0001eb00: 6d65 6e74 732c 2060 656d 6974 5f65 6e61  ments, `emit_ena
+0001eb10: 626c 6564 602c 2060 7469 6d65 6f75 7460  bled`, `timeout`
+0001eb20: 2c20 616e 6420 6063 7265 6465 6e74 6961  , and `credentia
+0001eb30: 6c73 602e 0a0a 5468 6520 6f70 7469 6f6e  ls`...The option
+0001eb40: 616c 2060 656d 6974 5f65 6e61 626c 6564  al `emit_enabled
+0001eb50: 6020 6172 6775 6d65 6e74 2069 7320 6120  ` argument is a 
+0001eb60: 5079 7468 6f6e 2060 626f 6f6c 6020 7768  Python `bool` wh
+0001eb70: 6963 6820 7370 6563 6966 6965 7320 7768  ich specifies wh
+0001eb80: 6574 6865 7220 610a 7072 6f6a 6563 7469  ether a.projecti
+0001eb90: 6f6e 2077 696c 6c20 6265 2061 626c 6520  on will be able 
+0001eba0: 746f 2065 6d69 7420 6576 656e 7473 2e20  to emit events. 
+0001ebb0: 4966 2061 2060 5472 7565 6020 7661 6c75  If a `True` valu
+0001ebc0: 6520 6973 2073 7065 6369 6669 6564 2c20  e is specified, 
+0001ebd0: 7468 6520 7072 6f6a 6563 7469 6f6e 0a77  the projection.w
+0001ebe0: 696c 6c20 6265 2061 626c 6520 746f 2065  ill be able to e
+0001ebf0: 6d69 7420 6576 656e 7473 2e20 4966 2061  mit events. If a
+0001ec00: 2060 4661 6c73 6560 2076 616c 7565 2069   `False` value i
+0001ec10: 7320 7370 6563 6966 6965 642c 2074 6865  s specified, the
+0001ec20: 2070 726f 6a65 6374 696f 6e20 7769 6c6c   projection will
+0001ec30: 206e 6f74 0a62 6520 6162 6c65 2074 6f20   not.be able to 
+0001ec40: 656d 6974 2065 7665 6e74 732e 2054 6865  emit events. The
+0001ec50: 2064 6566 6175 6c74 2076 616c 7565 206f   default value o
+0001ec60: 6620 6065 6d69 745f 656e 6162 6c65 6460  f `emit_enabled`
+0001ec70: 2069 7320 604e 6f6e 6560 2e0a 0a54 6865   is `None`...The
+0001ec80: 206f 7074 696f 6e61 6c20 6074 696d 656f   optional `timeo
+0001ec90: 7574 6020 6172 6775 6d65 6e74 2069 7320  ut` argument is 
+0001eca0: 6120 5079 7468 6f6e 2060 666c 6f61 7460  a Python `float`
+0001ecb0: 2077 6869 6368 2073 6574 7320 610a 6d61   which sets a.ma
+0001ecc0: 7869 6d75 6d20 6475 7261 7469 6f6e 2c20  ximum duration, 
+0001ecd0: 696e 2073 6563 6f6e 6473 2c20 666f 7220  in seconds, for 
+0001ece0: 7468 6520 636f 6d70 6c65 7469 6f6e 206f  the completion o
+0001ecf0: 6620 7468 6520 6752 5043 206f 7065 7261  f the gRPC opera
+0001ed00: 7469 6f6e 2e0a 0a54 6865 206f 7074 696f  tion...The optio
+0001ed10: 6e61 6c20 6063 7265 6465 6e74 6961 6c73  nal `credentials
+0001ed20: 6020 6172 6775 6d65 6e74 2063 616e 2062  ` argument can b
+0001ed30: 6520 7573 6564 2074 6f0a 6f76 6572 7269  e used to.overri
+0001ed40: 6465 2063 616c 6c20 6372 6564 656e 7469  de call credenti
+0001ed50: 616c 7320 6465 7269 7665 6420 6672 6f6d  als derived from
+0001ed60: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+0001ed70: 7374 7269 6e67 2055 5249 2e0a 0a60 6060  string URI...```
+0001ed80: 7079 7468 6f6e 0a63 6c69 656e 742e 7570  python.client.up
+0001ed90: 6461 7465 5f70 726f 6a65 6374 696f 6e28  date_projection(
+0001eda0: 6e61 6d65 3d70 726f 6a65 6374 696f 6e5f  name=projection_
+0001edb0: 6e61 6d65 2c20 7175 6572 793d 7072 6f6a  name, query=proj
+0001edc0: 6563 7469 6f6e 5f71 7565 7279 290a 6060  ection_query).``
+0001edd0: 600a 0a23 2323 2045 6e61 626c 6520 7072  `..### Enable pr
+0001ede0: 6f6a 6563 7469 6f6e 3c61 2069 643d 2265  ojection<a id="e
+0001edf0: 6e61 626c 652d 7072 6f6a 6563 7469 6f6e  nable-projection
+0001ee00: 223e 3c2f 613e 0a0a 5468 6520 6065 6e61  "></a>..The `ena
+0001ee10: 626c 655f 7072 6f6a 6563 7469 6f6e 2829  ble_projection()
+0001ee20: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
+0001ee30: 7573 6564 2074 6f20 656e 6162 6c65 2061  used to enable a
+0001ee40: 2070 726f 6a65 6374 696f 6e20 7468 6174   projection that
+0001ee50: 2077 6173 2070 7265 7669 6f75 736c 790a   was previously.
+0001ee60: 6469 7361 626c 6564 2e0a 0a54 6869 7320  disabled...This 
+0001ee70: 6d65 7468 6f64 2068 6173 2061 2072 6571  method has a req
+0001ee80: 7569 7265 6420 606e 616d 6560 2061 7267  uired `name` arg
+0001ee90: 756d 656e 742c 2077 6869 6368 2069 7320  ument, which is 
+0001eea0: 6120 5079 7468 6f6e 2060 7374 7260 2074  a Python `str` t
+0001eeb0: 6861 740a 7370 6563 6966 6965 7320 7468  hat.specifies th
+0001eec0: 6520 6e61 6d65 206f 6620 7468 6520 7072  e name of the pr
+0001eed0: 6f6a 6563 7469 6f6e 2074 6f20 6265 2064  ojection to be d
+0001eee0: 6973 6162 6c65 642e 0a0a 5468 6973 206d  isabled...This m
+0001eef0: 6574 686f 6420 616c 736f 2068 6173 2074  ethod also has t
+0001ef00: 776f 206f 7074 696f 6e61 6c20 6172 6775  wo optional argu
+0001ef10: 6d65 6e74 732c 2060 7469 6d65 6f75 7460  ments, `timeout`
+0001ef20: 2061 6e64 2060 6372 6564 656e 7469 616c   and `credential
+0001ef30: 7360 2e0a 0a54 6865 206f 7074 696f 6e61  s`...The optiona
+0001ef40: 6c20 6074 696d 656f 7574 6020 6172 6775  l `timeout` argu
+0001ef50: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+0001ef60: 2060 666c 6f61 7460 2077 6869 6368 2073   `float` which s
+0001ef70: 6574 7320 610a 6d61 7869 6d75 6d20 6475  ets a.maximum du
+0001ef80: 7261 7469 6f6e 2c20 696e 2073 6563 6f6e  ration, in secon
+0001ef90: 6473 2c20 666f 7220 7468 6520 636f 6d70  ds, for the comp
+0001efa0: 6c65 7469 6f6e 206f 6620 7468 6520 6752  letion of the gR
+0001efb0: 5043 206f 7065 7261 7469 6f6e 2e0a 0a54  PC operation...T
+0001efc0: 6865 206f 7074 696f 6e61 6c20 6063 7265  he optional `cre
+0001efd0: 6465 6e74 6961 6c73 6020 6172 6775 6d65  dentials` argume
+0001efe0: 6e74 2063 616e 2062 6520 7573 6564 2074  nt can be used t
+0001eff0: 6f0a 6f76 6572 7269 6465 2063 616c 6c20  o.override call 
+0001f000: 6372 6564 656e 7469 616c 7320 6465 7269  credentials deri
+0001f010: 7665 6420 6672 6f6d 2074 6865 2063 6f6e  ved from the con
+0001f020: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
+0001f030: 5249 2e0a 0a60 6060 7079 7468 6f6e 0a63  RI...```python.c
+0001f040: 6c69 656e 742e 656e 6162 6c65 5f70 726f  lient.enable_pro
+0001f050: 6a65 6374 696f 6e28 6e61 6d65 3d70 726f  jection(name=pro
+0001f060: 6a65 6374 696f 6e5f 6e61 6d65 290a 6060  jection_name).``
+0001f070: 600a 0a23 2323 2044 6973 6162 6c65 2070  `..### Disable p
+0001f080: 726f 6a65 6374 696f 6e3c 6120 6964 3d22  rojection<a id="
+0001f090: 6469 7361 626c 652d 7072 6f6a 6563 7469  disable-projecti
+0001f0a0: 6f6e 223e 3c2f 613e 0a0a 5468 6520 6064  on"></a>..The `d
+0001f0b0: 6973 6162 6c65 5f70 726f 6a65 6374 696f  isable_projectio
+0001f0c0: 6e28 2960 206d 6574 686f 6420 6361 6e20  n()` method can 
+0001f0d0: 6265 2075 7365 6420 746f 2064 6973 6162  be used to disab
+0001f0e0: 6c65 2061 2070 726f 6a65 6374 696f 6e2e  le a projection.
+0001f0f0: 0a0a 5468 6973 206d 6574 686f 6420 6861  ..This method ha
+0001f100: 7320 6120 7265 7175 6972 6564 2060 6e61  s a required `na
+0001f110: 6d65 6020 6172 6775 6d65 6e74 2c20 7768  me` argument, wh
+0001f120: 6963 6820 6973 2061 2050 7974 686f 6e20  ich is a Python 
+0001f130: 6073 7472 6020 7468 6174 0a73 7065 6369  `str` that.speci
+0001f140: 6669 6573 2074 6865 206e 616d 6520 6f66  fies the name of
+0001f150: 2074 6865 2070 726f 6a65 6374 696f 6e20   the projection 
+0001f160: 746f 2062 6520 6469 7361 626c 6564 2e0a  to be disabled..
+0001f170: 0a54 6869 7320 6d65 7468 6f64 2061 6c73  .This method als
+0001f180: 6f20 6861 7320 7468 7265 6520 6f70 7469  o has three opti
+0001f190: 6f6e 616c 2061 7267 756d 656e 7473 2c20  onal arguments, 
+0001f1a0: 6077 7269 7465 5f63 6865 636b 706f 696e  `write_checkpoin
+0001f1b0: 7460 2c20 6074 696d 656f 7574 602c 2061  t`, `timeout`, a
+0001f1c0: 6e64 2060 6372 6564 656e 7469 616c 7360  nd `credentials`
+0001f1d0: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001f1e0: 6077 7269 7465 5f63 6865 636b 706f 696e  `write_checkpoin
+0001f1f0: 7460 2061 7267 756d 656e 7420 6973 2061  t` argument is a
+0001f200: 2050 7974 686f 6e20 6062 6f6f 6c60 2077   Python `bool` w
+0001f210: 6869 6368 2073 7065 6369 6669 6573 2077  hich specifies w
+0001f220: 6865 7468 6572 0a61 2063 6865 636b 706f  hether.a checkpo
+0001f230: 696e 7420 7769 6c6c 2062 6520 7772 6974  int will be writ
+0001f240: 7465 6e20 7768 656e 2074 6865 2070 726f  ten when the pro
+0001f250: 6a65 6374 696f 6e20 6973 2064 6973 6162  jection is disab
+0001f260: 6c65 642e 2049 6620 6077 7269 7465 5f63  led. If `write_c
+0001f270: 6865 636b 706f 696e 7460 0a69 7320 6054  heckpoint`.is `T
+0001f280: 7275 6560 2061 2063 6865 636b 706f 696e  rue` a checkpoin
+0001f290: 7420 7769 6c6c 2062 6520 7772 6974 7465  t will be writte
+0001f2a0: 6e2c 206f 7468 6572 7769 7365 2061 2063  n, otherwise a c
+0001f2b0: 6865 636b 706f 696e 7420 7769 6c6c 206e  heckpoint will n
+0001f2c0: 6f74 2062 6520 7772 6974 7465 6e2e 0a54  ot be written..T
+0001f2d0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+0001f2e0: 206f 6620 6077 7269 7465 5f63 6865 636b   of `write_check
+0001f2f0: 706f 696e 7460 2069 7320 6046 616c 7365  point` is `False
+0001f300: 602e 0a0a 5468 6520 6f70 7469 6f6e 616c  `...The optional
+0001f310: 2060 7469 6d65 6f75 7460 2061 7267 756d   `timeout` argum
+0001f320: 656e 7420 6973 2061 2050 7974 686f 6e20  ent is a Python 
+0001f330: 6066 6c6f 6174 6020 7768 6963 6820 7365  `float` which se
+0001f340: 7473 2061 0a6d 6178 696d 756d 2064 7572  ts a.maximum dur
+0001f350: 6174 696f 6e2c 2069 6e20 7365 636f 6e64  ation, in second
+0001f360: 732c 2066 6f72 2074 6865 2063 6f6d 706c  s, for the compl
+0001f370: 6574 696f 6e20 6f66 2074 6865 2067 5250  etion of the gRP
+0001f380: 4320 6f70 6572 6174 696f 6e2e 0a0a 5468  C operation...Th
+0001f390: 6520 6f70 7469 6f6e 616c 2060 6372 6564  e optional `cred
+0001f3a0: 656e 7469 616c 7360 2061 7267 756d 656e  entials` argumen
+0001f3b0: 7420 6361 6e20 6265 2075 7365 6420 746f  t can be used to
+0001f3c0: 0a6f 7665 7272 6964 6520 6361 6c6c 2063  .override call c
+0001f3d0: 7265 6465 6e74 6961 6c73 2064 6572 6976  redentials deriv
+0001f3e0: 6564 2066 726f 6d20 7468 6520 636f 6e6e  ed from the conn
+0001f3f0: 6563 7469 6f6e 2073 7472 696e 6720 5552  ection string UR
+0001f400: 492e 0a0a 6060 6070 7974 686f 6e0a 636c  I...```python.cl
+0001f410: 6965 6e74 2e64 6973 6162 6c65 5f70 726f  ient.disable_pro
+0001f420: 6a65 6374 696f 6e28 6e61 6d65 3d70 726f  jection(name=pro
+0001f430: 6a65 6374 696f 6e5f 6e61 6d65 290a 6060  jection_name).``
+0001f440: 600a 0a23 2323 2052 6573 6574 2070 726f  `..### Reset pro
+0001f450: 6a65 6374 696f 6e3c 6120 6964 3d22 7265  jection<a id="re
+0001f460: 7365 742d 7072 6f6a 6563 7469 6f6e 223e  set-projection">
+0001f470: 3c2f 613e 0a0a 5468 6520 6072 6573 6574  </a>..The `reset
+0001f480: 5f70 726f 6a65 6374 696f 6e28 2960 206d  _projection()` m
+0001f490: 6574 686f 6420 6361 6e20 6265 2075 7365  ethod can be use
+0001f4a0: 6420 746f 2072 6573 6574 2061 2070 726f  d to reset a pro
+0001f4b0: 6a65 6374 696f 6e2e 0a0a 5468 6973 206d  jection...This m
+0001f4c0: 6574 686f 6420 6861 7320 6120 7265 7175  ethod has a requ
+0001f4d0: 6972 6564 2060 6e61 6d65 6020 6172 6775  ired `name` argu
+0001f4e0: 6d65 6e74 2c20 7768 6963 6820 6973 2061  ment, which is a
+0001f4f0: 2050 7974 686f 6e20 6073 7472 6020 7468   Python `str` th
+0001f500: 6174 0a73 7065 6369 6669 6573 2074 6865  at.specifies the
+0001f510: 206e 616d 6520 6f66 2074 6865 2070 726f   name of the pro
+0001f520: 6a65 6374 696f 6e20 746f 2062 6520 7265  jection to be re
+0001f530: 7365 742e 0a0a 5468 6973 206d 6574 686f  set...This metho
+0001f540: 6420 616c 736f 2068 6173 2074 6872 6565  d also has three
+0001f550: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0001f560: 6e74 732c 2060 7772 6974 655f 6368 6563  nts, `write_chec
+0001f570: 6b70 6f69 6e74 602c 2060 7469 6d65 6f75  kpoint`, `timeou
+0001f580: 7460 2c20 616e 6420 6063 7265 6465 6e74  t`, and `credent
+0001f590: 6961 6c73 602e 0a0a 5468 6520 6f70 7469  ials`...The opti
+0001f5a0: 6f6e 616c 2060 7772 6974 655f 6368 6563  onal `write_chec
+0001f5b0: 6b70 6f69 6e74 6020 6172 6775 6d65 6e74  kpoint` argument
+0001f5c0: 2069 7320 6120 5079 7468 6f6e 2060 626f   is a Python `bo
+0001f5d0: 6f6c 6020 7768 6963 6820 7370 6563 6966  ol` which specif
+0001f5e0: 6965 7320 7768 6574 6865 720a 6120 6368  ies whether.a ch
+0001f5f0: 6563 6b70 6f69 6e74 2077 696c 6c20 6265  eckpoint will be
+0001f600: 2077 7269 7474 656e 2077 6865 6e20 7468   written when th
+0001f610: 6520 7072 6f6a 6563 7469 6f6e 2069 7320  e projection is 
+0001f620: 7265 7365 742e 2049 6620 6077 7269 7465  reset. If `write
+0001f630: 5f63 6865 636b 706f 696e 7460 0a69 7320  _checkpoint`.is 
+0001f640: 6054 7275 6560 2061 2063 6865 636b 706f  `True` a checkpo
+0001f650: 696e 7420 7769 6c6c 2062 6520 7772 6974  int will be writ
+0001f660: 7465 6e2c 206f 7468 6572 7769 7365 2061  ten, otherwise a
+0001f670: 2063 6865 636b 706f 696e 7420 7769 6c6c   checkpoint will
+0001f680: 206e 6f74 2062 6520 7772 6974 7465 6e2e   not be written.
+0001f690: 0a54 6865 2064 6566 6175 6c74 2076 616c  .The default val
+0001f6a0: 7565 206f 6620 6077 7269 7465 5f63 6865  ue of `write_che
+0001f6b0: 636b 706f 696e 7460 2069 7320 6046 616c  ckpoint` is `Fal
+0001f6c0: 7365 602e 0a0a 5468 6520 6f70 7469 6f6e  se`...The option
+0001f6d0: 616c 2060 7469 6d65 6f75 7460 2061 7267  al `timeout` arg
+0001f6e0: 756d 656e 7420 6973 2061 2050 7974 686f  ument is a Pytho
+0001f6f0: 6e20 6066 6c6f 6174 6020 7768 6963 6820  n `float` which 
+0001f700: 7365 7473 2061 0a6d 6178 696d 756d 2064  sets a.maximum d
+0001f710: 7572 6174 696f 6e2c 2069 6e20 7365 636f  uration, in seco
+0001f720: 6e64 732c 2066 6f72 2074 6865 2063 6f6d  nds, for the com
+0001f730: 706c 6574 696f 6e20 6f66 2074 6865 2067  pletion of the g
+0001f740: 5250 4320 6f70 6572 6174 696f 6e2e 0a0a  RPC operation...
+0001f750: 5468 6520 6f70 7469 6f6e 616c 2060 6372  The optional `cr
+0001f760: 6564 656e 7469 616c 7360 2061 7267 756d  edentials` argum
+0001f770: 656e 7420 6361 6e20 6265 2075 7365 6420  ent can be used 
+0001f780: 746f 0a6f 7665 7272 6964 6520 6361 6c6c  to.override call
+0001f790: 2063 7265 6465 6e74 6961 6c73 2064 6572   credentials der
+0001f7a0: 6976 6564 2066 726f 6d20 7468 6520 636f  ived from the co
+0001f7b0: 6e6e 6563 7469 6f6e 2073 7472 696e 6720  nnection string 
+0001f7c0: 5552 492e 0a0a 6060 6070 7974 686f 6e0a  URI...```python.
+0001f7d0: 636c 6965 6e74 2e72 6573 6574 5f70 726f  client.reset_pro
+0001f7e0: 6a65 6374 696f 6e28 6e61 6d65 3d70 726f  jection(name=pro
+0001f7f0: 6a65 6374 696f 6e5f 6e61 6d65 290a 6060  jection_name).``
+0001f800: 600a 0a23 2323 2044 656c 6574 6520 7072  `..### Delete pr
+0001f810: 6f6a 6563 7469 6f6e 3c61 2069 643d 2264  ojection<a id="d
+0001f820: 656c 6574 652d 7072 6f6a 6563 7469 6f6e  elete-projection
+0001f830: 223e 3c2f 613e 0a0a 5468 6520 6064 656c  "></a>..The `del
+0001f840: 6574 655f 7072 6f6a 6563 7469 6f6e 2829  ete_projection()
+0001f850: 6020 6d65 7468 6f64 2063 616e 2062 6520  ` method can be 
+0001f860: 7573 6564 2074 6f20 6465 6c65 7465 2061  used to delete a
+0001f870: 2070 726f 6a65 6374 696f 6e2e 0a0a 5468   projection...Th
+0001f880: 6973 206d 6574 686f 6420 6861 7320 6120  is method has a 
+0001f890: 7265 7175 6972 6564 2060 6e61 6d65 6020  required `name` 
+0001f8a0: 6172 6775 6d65 6e74 2c20 7768 6963 6820  argument, which 
+0001f8b0: 6973 2061 2050 7974 686f 6e20 6073 7472  is a Python `str
+0001f8c0: 6020 7468 6174 0a73 7065 6369 6669 6573  ` that.specifies
+0001f8d0: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
+0001f8e0: 2070 726f 6a65 6374 696f 6e20 746f 2062   projection to b
+0001f8f0: 6520 6465 6c65 7465 642e 0a0a 5468 6973  e deleted...This
+0001f900: 206d 6574 686f 6420 616c 736f 2068 6173   method also has
+0001f910: 2066 6976 6520 6f70 7469 6f6e 616c 2061   five optional a
+0001f920: 7267 756d 656e 7473 2c20 6064 656c 6574  rguments, `delet
+0001f930: 655f 656d 6974 7465 645f 7374 7265 616d  e_emitted_stream
+0001f940: 7360 2c0a 6064 656c 6574 655f 7374 6174  s`,.`delete_stat
+0001f950: 655f 7374 7265 616d 602c 2060 6465 6c65  e_stream`, `dele
+0001f960: 7465 5f63 6865 636b 706f 696e 745f 7374  te_checkpoint_st
+0001f970: 7265 616d 602c 2060 7469 6d65 6f75 7460  ream`, `timeout`
+0001f980: 2c20 616e 6420 6063 7265 6465 6e74 6961  , and `credentia
+0001f990: 6c73 602e 0a0a 5468 6520 6f70 7469 6f6e  ls`...The option
+0001f9a0: 616c 2060 6465 6c65 7465 5f65 6d69 7474  al `delete_emitt
+0001f9b0: 6564 5f73 7472 6561 6d73 6020 6172 6775  ed_streams` argu
+0001f9c0: 6d65 6e74 2069 7320 6120 5079 7468 6f6e  ment is a Python
+0001f9d0: 2060 626f 6f6c 6020 7768 6963 682e 2e2e   `bool` which...
+0001f9e0: 0a0a 5468 6520 6f70 7469 6f6e 616c 2060  ..The optional `
+0001f9f0: 6465 6c65 7465 5f73 7461 7465 5f73 7472  delete_state_str
+0001fa00: 6561 6d60 2061 7267 756d 656e 7420 6973  eam` argument is
+0001fa10: 2061 2050 7974 686f 6e20 6062 6f6f 6c60   a Python `bool`
+0001fa20: 2077 6869 6368 2e2e 2e0a 0a54 6865 206f   which.....The o
+0001fa30: 7074 696f 6e61 6c20 6064 656c 6574 655f  ptional `delete_
+0001fa40: 6368 6563 6b70 6f69 6e74 5f73 7472 6561  checkpoint_strea
+0001fa50: 6d60 2061 7267 756d 656e 7420 6973 2061  m` argument is a
+0001fa60: 2050 7974 686f 6e20 6062 6f6f 6c60 2077   Python `bool` w
+0001fa70: 6869 6368 2e2e 2e0a 0a54 6865 206f 7074  hich.....The opt
+0001fa80: 696f 6e61 6c20 6074 696d 656f 7574 6020  ional `timeout` 
+0001fa90: 6172 6775 6d65 6e74 2069 7320 6120 5079  argument is a Py
+0001faa0: 7468 6f6e 2060 666c 6f61 7460 2077 6869  thon `float` whi
+0001fab0: 6368 2073 6574 7320 610a 6d61 7869 6d75  ch sets a.maximu
+0001fac0: 6d20 6475 7261 7469 6f6e 2c20 696e 2073  m duration, in s
+0001fad0: 6563 6f6e 6473 2c20 666f 7220 7468 6520  econds, for the 
+0001fae0: 636f 6d70 6c65 7469 6f6e 206f 6620 7468  completion of th
+0001faf0: 6520 6752 5043 206f 7065 7261 7469 6f6e  e gRPC operation
+0001fb00: 2e0a 0a54 6865 206f 7074 696f 6e61 6c20  ...The optional 
+0001fb10: 6063 7265 6465 6e74 6961 6c73 6020 6172  `credentials` ar
+0001fb20: 6775 6d65 6e74 2063 616e 2062 6520 7573  gument can be us
+0001fb30: 6564 2074 6f0a 6f76 6572 7269 6465 2063  ed to.override c
+0001fb40: 616c 6c20 6372 6564 656e 7469 616c 7320  all credentials 
+0001fb50: 6465 7269 7665 6420 6672 6f6d 2074 6865  derived from the
+0001fb60: 2063 6f6e 6e65 6374 696f 6e20 7374 7269   connection stri
+0001fb70: 6e67 2055 5249 2e0a 0a60 6060 7079 7468  ng URI...```pyth
+0001fb80: 6f6e 0a63 6c69 656e 742e 6465 6c65 7465  on.client.delete
+0001fb90: 5f70 726f 6a65 6374 696f 6e28 6e61 6d65  _projection(name
+0001fba0: 3d70 726f 6a65 6374 696f 6e5f 6e61 6d65  =projection_name
+0001fbb0: 290a 6060 600a 0a23 2323 2052 6573 7461  ).```..### Resta
+0001fbc0: 7274 2070 726f 6a65 6374 696f 6e73 2073  rt projections s
+0001fbd0: 7562 7379 7374 656d 3c61 2069 643d 2272  ubsystem<a id="r
+0001fbe0: 6573 7461 7274 2d70 726f 6a65 6374 696f  estart-projectio
+0001fbf0: 6e73 2d73 7562 7379 7374 656d 223e 3c2f  ns-subsystem"></
+0001fc00: 613e 0a0a 5468 6520 6072 6573 7461 7274  a>..The `restart
+0001fc10: 5f70 726f 6a65 6374 696f 6e73 5f73 7562  _projections_sub
+0001fc20: 7379 7374 656d 2829 6020 6d65 7468 6f64  system()` method
+0001fc30: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+0001fc40: 7265 7374 6172 7420 7468 6520 7072 6f6a  restart the proj
+0001fc50: 6563 7469 6f6e 7320 7375 6273 7973 7465  ections subsyste
+0001fc60: 6d2e 0a0a 5468 6973 206d 6574 686f 6420  m...This method 
+0001fc70: 616c 736f 2068 6173 2074 776f 206f 7074  also has two opt
+0001fc80: 696f 6e61 6c20 6172 6775 6d65 6e74 732c  ional arguments,
+0001fc90: 2060 7469 6d65 6f75 7460 2061 6e64 2060   `timeout` and `
+0001fca0: 6372 6564 656e 7469 616c 7360 2e0a 0a54  credentials`...T
+0001fcb0: 6865 206f 7074 696f 6e61 6c20 6074 696d  he optional `tim
+0001fcc0: 656f 7574 6020 6172 6775 6d65 6e74 2069  eout` argument i
+0001fcd0: 7320 6120 5079 7468 6f6e 2060 666c 6f61  s a Python `floa
+0001fce0: 7460 2077 6869 6368 2073 6574 7320 610a  t` which sets a.
+0001fcf0: 6d61 7869 6d75 6d20 6475 7261 7469 6f6e  maximum duration
+0001fd00: 2c20 696e 2073 6563 6f6e 6473 2c20 666f  , in seconds, fo
+0001fd10: 7220 7468 6520 636f 6d70 6c65 7469 6f6e  r the completion
+0001fd20: 206f 6620 7468 6520 6752 5043 206f 7065   of the gRPC ope
+0001fd30: 7261 7469 6f6e 2e0a 0a54 6865 206f 7074  ration...The opt
+0001fd40: 696f 6e61 6c20 6063 7265 6465 6e74 6961  ional `credentia
+0001fd50: 6c73 6020 6172 6775 6d65 6e74 2063 616e  ls` argument can
+0001fd60: 2062 6520 7573 6564 2074 6f0a 6f76 6572   be used to.over
+0001fd70: 7269 6465 2063 616c 6c20 6372 6564 656e  ride call creden
+0001fd80: 7469 616c 7320 6465 7269 7665 6420 6672  tials derived fr
+0001fd90: 6f6d 2074 6865 2063 6f6e 6e65 6374 696f  om the connectio
+0001fda0: 6e20 7374 7269 6e67 2055 5249 2e0a 0a60  n string URI...`
+0001fdb0: 6060 7079 7468 6f6e 0a63 6c69 656e 742e  ``python.client.
+0001fdc0: 7265 7374 6172 745f 7072 6f6a 6563 7469  restart_projecti
+0001fdd0: 6f6e 735f 7375 6273 7973 7465 6d28 290a  ons_subsystem().
+0001fde0: 6060 600a 0a0a 2323 2043 616c 6c20 6372  ```...## Call cr
+0001fdf0: 6564 656e 7469 616c 733c 6120 6964 3d22  edentials<a id="
+0001fe00: 6361 6c6c 2d63 7265 6465 6e74 6961 6c73  call-credentials
+0001fe10: 223e 3c2f 613e 0a0a 4465 6661 756c 7420  "></a>..Default 
+0001fe20: 6361 6c6c 2063 7265 6465 6e74 6961 6c73  call credentials
+0001fe30: 2061 7265 2064 6572 6976 6564 2062 7920   are derived by 
+0001fe40: 7468 6520 636c 6965 6e74 2066 726f 6d20  the client from 
+0001fe50: 7468 6520 7573 6572 2069 6e66 6f20 7061  the user info pa
+0001fe60: 7274 206f 6620 7468 650a 636f 6e6e 6563  rt of the.connec
+0001fe70: 7469 6f6e 2073 7472 696e 6720 5552 492e  tion string URI.
+0001fe80: 0a0a 4d61 6e79 206f 6620 7468 6520 636c  ..Many of the cl
+0001fe90: 6965 6e74 206d 6574 686f 6473 2064 6573  ient methods des
+0001fea0: 6372 6962 6564 2061 626f 7665 2068 6176  cribed above hav
+0001feb0: 6520 616e 206f 7074 696f 6e61 6c20 6063  e an optional `c
+0001fec0: 7265 6465 6e74 6961 6c73 6020 6172 6775  redentials` argu
+0001fed0: 6d65 6e74 2c0a 7768 6963 6820 6361 6e20  ment,.which can 
+0001fee0: 6265 2075 7365 6420 746f 2073 6574 2063  be used to set c
+0001fef0: 616c 6c20 6372 6564 656e 7469 616c 7320  all credentials 
+0001ff00: 666f 7220 616e 2069 6e64 6976 6964 7561  for an individua
+0001ff10: 6c20 6d65 7468 6f64 2063 616c 6c20 7468  l method call th
+0001ff20: 6174 206f 7665 7272 6964 650a 7468 6f73  at override.thos
+0001ff30: 6520 6465 7269 7665 6420 6672 6f6d 2074  e derived from t
+0001ff40: 6865 2063 6f6e 6e65 6374 696f 6e20 7374  he connection st
+0001ff50: 7269 6e67 2055 5249 2e0a 0a23 2323 2043  ring URI...### C
+0001ff60: 6f6e 7374 7275 6374 2063 616c 6c20 6372  onstruct call cr
+0001ff70: 6564 656e 7469 616c 733c 6120 6964 3d22  edentials<a id="
+0001ff80: 636f 6e73 7472 7563 742d 6361 6c6c 2d63  construct-call-c
+0001ff90: 7265 6465 6e74 6961 6c73 223e 3c2f 613e  redentials"></a>
+0001ffa0: 0a0a 5468 6520 636c 6965 6e74 206d 6574  ..The client met
+0001ffb0: 686f 6420 6063 6f6e 7374 7275 6374 5f63  hod `construct_c
+0001ffc0: 616c 6c5f 6372 6564 656e 7469 616c 7328  all_credentials(
+0001ffd0: 2960 2063 616e 2062 6520 7573 6564 2074  )` can be used t
+0001ffe0: 6f20 636f 6e73 7472 7563 7420 6120 6361  o construct a ca
+0001fff0: 6c6c 0a63 7265 6465 6e74 6961 6c73 206f  ll.credentials o
+00020000: 626a 6563 7420 6672 6f6d 2061 2075 7365  bject from a use
+00020010: 726e 616d 6520 616e 6420 7061 7373 776f  rname and passwo
+00020020: 7264 2e0a 0a60 6060 7079 7468 6f6e 0a63  rd...```python.c
+00020030: 616c 6c5f 6372 6564 656e 7469 616c 7320  all_credentials 
+00020040: 3d20 636c 6965 6e74 2e63 6f6e 7374 7275  = client.constru
+00020050: 6374 5f63 616c 6c5f 6372 6564 656e 7469  ct_call_credenti
+00020060: 616c 7328 0a20 2020 2075 7365 726e 616d  als(.    usernam
+00020070: 653d 2761 646d 696e 272c 2070 6173 7377  e='admin', passw
+00020080: 6f72 643d 2763 6861 6e67 6569 7427 0a29  ord='changeit'.)
+00020090: 0a60 6060 0a0a 5468 6520 6361 6c6c 2063  .```..The call c
+000200a0: 7265 6465 6e74 6961 6c73 206f 626a 6563  redentials objec
+000200b0: 7420 6361 6e20 6265 2075 7365 6420 6173  t can be used as
+000200c0: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
+000200d0: 6520 6063 7265 6465 6e74 6961 6c73 600a  e `credentials`.
+000200e0: 6172 6775 6d65 6e74 2069 6e20 6f74 6865  argument in othe
+000200f0: 7220 636c 6965 6e74 206d 6574 686f 6473  r client methods
+00020100: 2e0a 0a23 2320 436f 6e6e 6563 7469 6f6e  ...## Connection
+00020110: 3c61 2069 643d 2263 6f6e 6e65 6374 696f  <a id="connectio
+00020120: 6e22 3e3c 2f61 3e0a 0a23 2323 2052 6563  n"></a>..### Rec
+00020130: 6f6e 6e65 6374 3c61 2069 643d 2272 6563  onnect<a id="rec
+00020140: 6f6e 6e65 6374 223e 3c2f 613e 0a0a 5468  onnect"></a>..Th
+00020150: 6520 6072 6563 6f6e 6e65 6374 2829 6020  e `reconnect()` 
+00020160: 6d65 7468 6f64 2063 616e 2062 6520 7573  method can be us
+00020170: 6564 2074 6f20 6d61 6e75 616c 6c79 2072  ed to manually r
+00020180: 6563 6f6e 6e65 6374 2074 6865 2063 6c69  econnect the cli
+00020190: 656e 7420 746f 2061 0a73 7569 7461 626c  ent to a.suitabl
+000201a0: 6520 4576 656e 7453 746f 7265 4442 206e  e EventStoreDB n
+000201b0: 6f64 652e 2054 6869 7320 6d65 7468 6f64  ode. This method
+000201c0: 2075 7365 7320 7468 6520 7361 6d65 2072   uses the same r
+000201d0: 6f75 7469 6e65 2066 6f72 2072 6561 6469  outine for readi
+000201e0: 6e67 2074 6865 0a63 6c75 7374 6572 206e  ng the.cluster n
+000201f0: 6f64 6520 7374 6174 6573 2061 6e64 2074  ode states and t
+00020200: 6865 6e20 636f 6e6e 6563 7469 6e67 2074  hen connecting t
+00020210: 6f20 6120 7375 6974 6162 6c65 206e 6f64  o a suitable nod
+00020220: 6520 6163 636f 7264 696e 6720 746f 2074  e according to t
+00020230: 6865 0a63 6c69 656e 7427 7320 6e6f 6465  he.client's node
+00020240: 2070 7265 6665 7265 6e63 6520 7468 6174   preference that
+00020250: 2069 7320 7370 6563 6966 6965 6420 696e   is specified in
+00020260: 2074 6865 2063 6f6e 6e65 6374 696f 6e20   the connection 
+00020270: 7374 7269 6e67 2055 5249 2077 6865 6e0a  string URI when.
+00020280: 7468 6520 636c 6965 6e74 2069 7320 636f  the client is co
+00020290: 6e73 7472 7563 7465 642e 2054 6869 7320  nstructed. This 
+000202a0: 6d65 7468 6f64 2069 7320 7468 7265 6164  method is thread
+000202b0: 2d73 6166 652c 2069 6e20 7468 6174 2077  -safe, in that w
+000202c0: 6865 6e20 6974 2069 7320 6361 6c6c 6564  hen it is called
+000202d0: 0a62 7920 7365 7665 7261 6c20 7468 7265  .by several thre
+000202e0: 6164 7320 6174 2074 6865 2073 616d 6520  ads at the same 
+000202f0: 7469 6d65 2c20 6f6e 6c79 206f 6e65 2072  time, only one r
+00020300: 6563 6f6e 6e65 6374 696f 6e20 7769 6c6c  econnection will
+00020310: 206f 6363 7572 2e20 436f 6e63 7572 7265   occur. Concurre
+00020320: 6e74 0a61 7474 656d 7074 7320 746f 2072  nt.attempts to r
+00020330: 6563 6f6e 6e65 6374 2077 696c 6c20 626c  econnect will bl
+00020340: 6f63 6b20 756e 7469 6c20 7468 6520 636c  ock until the cl
+00020350: 6965 6e74 2068 6173 2072 6563 6f6e 6e65  ient has reconne
+00020360: 6374 6564 2073 7563 6365 7373 6675 6c6c  cted successfull
+00020370: 792c 0a61 6e64 2074 6865 6e20 7468 6579  y,.and then they
+00020380: 2077 696c 6c20 616c 6c20 7265 7475 726e   will all return
+00020390: 206e 6f72 6d61 6c6c 792e 0a0a 6060 6070   normally...```p
+000203a0: 7974 686f 6e0a 636c 6965 6e74 2e72 6563  ython.client.rec
+000203b0: 6f6e 6e65 6374 2829 0a60 6060 0a0a 416e  onnect().```..An
+000203c0: 2065 7861 6d70 6c65 206f 6620 7768 656e   example of when
+000203d0: 2069 7420 6d69 6768 7420 6265 2064 6573   it might be des
+000203e0: 6972 6162 6c65 2074 6f20 7265 636f 6e6e  irable to reconn
+000203f0: 6563 7420 6d61 6e75 616c 6c79 2069 7320  ect manually is 
+00020400: 7768 656e 2028 666f 7220 7065 7266 6f72  when (for perfor
+00020410: 6d61 6e63 650a 7265 6173 6f6e 7329 2074  mance.reasons) t
+00020420: 6865 2063 6c69 656e 7427 7320 6e6f 6465  he client's node
+00020430: 2070 7265 6665 7265 6e63 6520 6973 2074   preference is t
+00020440: 6f20 6265 2063 6f6e 6e65 6374 6564 2074  o be connected t
+00020450: 6f20 6120 666f 6c6c 6f77 6572 206e 6f64  o a follower nod
+00020460: 6520 696e 2074 6865 0a63 6c75 7374 6572  e in the.cluster
+00020470: 2c20 616e 642c 2061 6674 6572 2061 2063  , and, after a c
+00020480: 6c75 7374 6572 206c 6561 6465 7220 656c  luster leader el
+00020490: 6563 7469 6f6e 2c20 7468 6520 666f 6c6c  ection, the foll
+000204a0: 6f77 6572 2062 6563 6f6d 6573 2074 6865  ower becomes the
+000204b0: 206c 6561 6465 722e 0a52 6563 6f6e 6e65   leader..Reconne
+000204c0: 6374 696e 6720 746f 2061 2066 6f6c 6c6f  cting to a follo
+000204d0: 7765 7220 6e6f 6465 2069 6e20 7468 6973  wer node in this
+000204e0: 2063 6173 6520 6973 2063 7572 7265 6e74   case is current
+000204f0: 6c79 2062 6579 6f6e 6420 7468 6520 6361  ly beyond the ca
+00020500: 7061 6269 6c69 7469 6573 206f 660a 7468  pabilities of.th
+00020510: 6973 2063 6c69 656e 742c 2062 7574 2074  is client, but t
+00020520: 6869 7320 6265 6861 7669 6f72 206d 6967  his behavior mig
+00020530: 6874 2062 6520 696d 706c 656d 656e 7465  ht be implemente
+00020540: 6420 696e 2061 2066 7574 7572 6520 7265  d in a future re
+00020550: 6c65 6173 652e 0a0a 5265 636f 6e6e 6563  lease...Reconnec
+00020560: 7469 6f6e 2077 696c 6c20 6861 7070 656e  tion will happen
+00020570: 2061 7574 6f6d 6174 6963 616c 6c79 2069   automatically i
+00020580: 6e20 6d61 6e79 2063 6173 6573 2c20 6475  n many cases, du
+00020590: 6520 746f 2074 6865 2060 4061 7574 6f72  e to the `@autor
+000205a0: 6563 6f6e 6e65 6374 600a 6465 636f 7261  econnect`.decora
+000205b0: 746f 722e 0a0a 2323 2320 436c 6f73 653c  tor...### Close<
+000205c0: 6120 6964 3d22 636c 6f73 6522 3e3c 2f61  a id="close"></a
+000205d0: 3e0a 0a54 6865 2060 636c 6f73 6528 2960  >..The `close()`
+000205e0: 206d 6574 686f 6420 6361 6e20 6265 2075   method can be u
+000205f0: 7365 6420 746f 2063 6c65 616e 6c79 2063  sed to cleanly c
+00020600: 6c6f 7365 2074 6865 2063 6c69 656e 7427  lose the client'
+00020610: 7320 6752 5043 2063 6f6e 6e65 6374 696f  s gRPC connectio
+00020620: 6e2e 0a0a 6060 6070 7974 686f 6e0a 636c  n...```python.cl
+00020630: 6965 6e74 2e63 6c6f 7365 2829 0a60 6060  ient.close().```
+00020640: 0a0a 0a23 2320 4173 796e 6369 6f20 636c  ...## Asyncio cl
+00020650: 6965 6e74 3c61 2069 643d 2261 7379 6e63  ient<a id="async
+00020660: 696f 2d63 6c69 656e 7422 3e3c 2f61 3e0a  io-client"></a>.
+00020670: 0a54 6865 2060 6573 6462 636c 6965 6e74  .The `esdbclient
+00020680: 6020 7061 636b 6167 6520 616c 736f 2070  ` package also p
+00020690: 726f 7669 6465 7320 616e 2061 7379 6e63  rovides an async
+000206a0: 6872 6f6e 6f75 7320 492f 4f20 6752 5043  hronous I/O gRPC
+000206b0: 2050 7974 686f 6e20 636c 6965 6e74 2066   Python client f
+000206c0: 6f72 0a45 7665 6e74 5374 6f72 6544 422e  or.EventStoreDB.
+000206d0: 2049 7420 6973 2066 756e 6374 696f 6e61   It is functiona
+000206e0: 6c6c 7920 6571 7569 7661 6c65 6e74 2074  lly equivalent t
+000206f0: 6f20 7468 6520 6d75 6c74 6974 6872 6561  o the multithrea
+00020700: 6465 6420 636c 6965 6e74 2e20 4974 2075  ded client. It u
+00020710: 7365 730a 7468 6520 6067 7270 632e 6169  ses.the `grpc.ai
+00020720: 6f60 2070 6163 6b61 6765 2061 6e64 2074  o` package and t
+00020730: 6865 2060 6173 796e 6369 6f60 206d 6f64  he `asyncio` mod
+00020740: 756c 652c 2069 6e73 7465 6164 206f 6620  ule, instead of 
+00020750: 6067 7270 6360 2061 6e64 2060 7468 7265  `grpc` and `thre
+00020760: 6164 696e 6760 2e0a 0a49 7420 7375 7070  ading`...It supp
+00020770: 6f72 7473 2062 6f74 6820 7468 6520 2265  orts both the "e
+00020780: 7364 6222 2061 6e64 2074 6865 2022 6573  sdb" and the "es
+00020790: 6462 2b64 6973 636f 7665 7222 2063 6f6e  db+discover" con
+000207a0: 6e65 6374 696f 6e20 7374 7269 6e67 2055  nection string U
+000207b0: 5249 2073 6368 656d 6573 2c0a 616e 6420  RI schemes,.and 
+000207c0: 6361 6e20 636f 6e6e 6563 7420 746f 2062  can connect to b
+000207d0: 6f74 6820 2273 6563 7572 6522 2061 6e64  oth "secure" and
+000207e0: 2022 696e 7365 6375 7265 2220 4576 656e   "insecure" Even
+000207f0: 7453 746f 7265 4442 2073 6572 7665 7273  tStoreDB servers
+00020800: 2e0a 0a54 6865 2061 7379 6e63 2066 756e  ...The async fun
+00020810: 6374 696f 6e20 6041 7379 6e63 696f 4576  ction `AsyncioEv
+00020820: 656e 7453 746f 7265 4442 436c 6965 6e74  entStoreDBClient
+00020830: 6020 636f 6e73 7472 7563 7473 2074 6865  ` constructs the
+00020840: 2063 6c69 656e 7420 616e 6420 636f 6e6e   client and conn
+00020850: 6563 7473 2074 6f0a 4576 656e 7453 746f  ects to.EventSto
+00020860: 7265 4442 2e20 4974 2063 616e 2062 6520  reDB. It can be 
+00020870: 696d 706f 7274 6564 2066 726f 6d20 6065  imported from `e
+00020880: 7364 6263 6c69 656e 7460 2e0a 0a54 6865  sdbclient`...The
+00020890: 2061 7379 6e63 696f 2063 6c69 656e 7420   asyncio client 
+000208a0: 6861 7320 6578 6163 746c 7920 7468 6520  has exactly the 
+000208b0: 7361 6d65 206d 6574 686f 6473 2061 7320  same methods as 
+000208c0: 7468 6520 6d75 6c74 6974 6872 6561 6465  the multithreade
+000208d0: 6420 6045 7665 6e74 5374 6f72 6544 4243  d `EventStoreDBC
+000208e0: 6c69 656e 7460 2e0a 5468 6573 6520 6d65  lient`..These me
+000208f0: 7468 6f64 7320 6172 6520 6465 6669 6e65  thods are define
+00020900: 6420 6173 2060 6173 796e 6320 6465 6660  d as `async def`
+00020910: 206d 6574 686f 6473 2c20 616e 6420 736f   methods, and so
+00020920: 2063 616c 6c73 2074 6f20 7468 6573 6520   calls to these 
+00020930: 6d65 7468 6f64 7320 7769 6c6c 0a72 6574  methods will.ret
+00020940: 7572 6e20 5079 7468 6f6e 2022 6177 6169  urn Python "awai
+00020950: 7461 626c 6573 2220 7468 6174 206d 7573  tables" that mus
+00020960: 7420 6265 2061 7761 6974 6564 2074 6f20  t be awaited to 
+00020970: 6f62 7461 696e 2074 6865 206d 6574 686f  obtain the metho
+00020980: 6420 7265 7475 726e 2076 616c 7565 732e  d return values.
+00020990: 0a54 6865 206d 6574 686f 6473 2068 6176  .The methods hav
+000209a0: 6520 7468 6520 7361 6d65 2062 6568 6176  e the same behav
+000209b0: 696f 7273 2c20 7468 6520 7361 6d65 2061  iors, the same a
+000209c0: 7267 756d 656e 7473 2061 6e64 2074 6865  rguments and the
+000209d0: 2073 616d 6520 6f72 2065 7175 6976 616c   same or equival
+000209e0: 656e 740a 7265 7475 726e 2076 616c 7565  ent.return value
+000209f0: 732e 2054 6865 206d 6574 686f 6473 2061  s. The methods a
+00020a00: 7265 2073 696d 696c 6172 6c79 2064 6563  re similarly dec
+00020a10: 6f72 6174 6564 2077 6974 6820 7265 636f  orated with reco
+00020a20: 6e6e 6563 7420 616e 6420 7265 7472 7920  nnect and retry 
+00020a30: 6465 636f 7261 746f 7273 2c0a 7468 6174  decorators,.that
+00020a40: 2073 656c 6563 7469 7665 6c79 2072 6563   selectively rec
+00020a50: 6f6e 6e65 6374 2061 6e64 2072 6574 7279  onnect and retry
+00020a60: 2077 6865 6e20 636f 6e6e 6563 7469 6f6e   when connection
+00020a70: 2069 7373 7565 7320 6f72 2073 6572 7665   issues or serve
+00020a80: 7220 6572 726f 7273 2061 7265 0a65 6e63  r errors are.enc
+00020a90: 6f75 6e74 6572 6564 2e0a 0a57 6865 6e20  ountered...When 
+00020aa0: 6177 6169 7465 642c 2074 6865 206d 6574  awaited, the met
+00020ab0: 686f 6473 2060 7265 6164 5f61 6c6c 2829  hods `read_all()
+00020ac0: 6020 616e 6420 6072 6561 645f 7374 7265  ` and `read_stre
+00020ad0: 616d 2829 6020 7265 7475 726e 2061 6e20  am()` return an 
+00020ae0: 6041 7379 6e63 696f 5265 6164 5265 7370  `AsyncioReadResp
+00020af0: 6f6e 7365 600a 6f62 6a65 6374 2e20 5468  onse`.object. Th
+00020b00: 6520 6d65 7468 6f64 7320 6073 7562 7363  e methods `subsc
+00020b10: 7269 6265 5f74 6f5f 616c 6c28 2960 2061  ribe_to_all()` a
+00020b20: 6e64 2060 7375 6273 6372 6962 655f 746f  nd `subscribe_to
+00020b30: 5f73 7472 6561 6d28 2960 2072 6574 7572  _stream()` retur
+00020b40: 6e20 616e 0a60 4173 796e 6369 6f43 6174  n an.`AsyncioCat
+00020b50: 6368 7570 5375 6273 6372 6970 7469 6f6e  chupSubscription
+00020b60: 6020 6f62 6a65 6374 2e20 5468 6520 6d65  ` object. The me
+00020b70: 7468 6f64 7320 6072 6561 645f 7375 6273  thods `read_subs
+00020b80: 6372 6970 7469 6f6e 5f74 6f5f 616c 6c28  cription_to_all(
+00020b90: 2960 2061 6e64 0a60 7265 6164 5f73 7562  )` and.`read_sub
+00020ba0: 7363 7269 7074 696f 6e5f 746f 5f73 7472  scription_to_str
+00020bb0: 6561 6d28 2960 2072 6574 7572 6e20 616e  eam()` return an
+00020bc0: 2060 4173 796e 6369 6f50 6572 7369 7374   `AsyncioPersist
+00020bd0: 656e 7453 7562 7363 7269 7074 696f 6e60  entSubscription`
+00020be0: 206f 626a 6563 742e 0a54 6865 7365 206f   object..These o
+00020bf0: 626a 6563 7473 2061 7265 2061 7379 6e63  bjects are async
+00020c00: 696f 2069 7465 7261 626c 6573 2c20 7768  io iterables, wh
+00020c10: 6963 6820 796f 7520 6361 6e20 6974 6572  ich you can iter
+00020c20: 6174 6520 6f76 6572 2077 6974 6820 5079  ate over with Py
+00020c30: 7468 6f6e 2773 2060 6173 796e 6320 666f  thon's `async fo
+00020c40: 7260 0a73 796e 7461 7820 746f 206f 6274  r`.syntax to obt
+00020c50: 6169 6e20 6052 6563 6f72 6465 6445 7665  ain `RecordedEve
+00020c60: 6e74 6020 6f62 6a65 6374 732e 2054 6865  nt` objects. The
+00020c70: 7920 6172 6520 616c 736f 2061 7379 6e63  y are also async
+00020c80: 696f 2063 6f6e 7465 7874 206d 616e 6167  io context manag
+00020c90: 6572 732c 0a73 7570 706f 7274 696e 6720  ers,.supporting 
+00020ca0: 7468 6520 6061 7379 6e63 2077 6974 6860  the `async with`
+00020cb0: 2073 796e 7461 782e 2054 6865 7920 616c   syntax. They al
+00020cc0: 736f 2068 6176 6520 6120 6073 746f 7028  so have a `stop(
+00020cd0: 2960 206d 6574 686f 6420 7768 6963 6820  )` method which 
+00020ce0: 6361 6e20 6265 0a75 7365 6420 746f 2074  can be.used to t
+00020cf0: 6572 6d69 6e61 7465 2074 6865 2069 7465  erminate the ite
+00020d00: 7261 746f 7220 696e 2061 2077 6179 2074  rator in a way t
+00020d10: 6861 7420 6163 7469 7665 6c79 2063 616e  hat actively can
+00020d20: 6365 6c73 2074 6865 2073 7472 6561 6d69  cels the streami
+00020d30: 6e67 2067 5250 4320 6361 6c6c 0a74 6f20  ng gRPC call.to 
+00020d40: 7468 6520 7365 7276 6572 2e20 5768 656e  the server. When
+00020d50: 2075 7365 6420 6173 2061 2063 6f6e 7465   used as a conte
+00020d60: 7874 206d 616e 6167 6572 2c20 7468 6520  xt manager, the 
+00020d70: 6073 746f 7028 2960 206d 6574 686f 6420  `stop()` method 
+00020d80: 7769 6c6c 2062 6520 6361 6c6c 6564 2077  will be called w
+00020d90: 6865 6e0a 7468 6520 636f 6e74 6578 7420  hen.the context 
+00020da0: 6d61 6e61 6765 7220 6578 6974 732e 0a0a  manager exits...
+00020db0: 5468 6520 6d65 7468 6f64 7320 6072 6561  The methods `rea
+00020dc0: 645f 7375 6273 6372 6970 7469 6f6e 5f74  d_subscription_t
+00020dd0: 6f5f 616c 6c28 2960 2061 6e64 2060 7265  o_all()` and `re
+00020de0: 6164 5f73 7562 7363 7269 7074 696f 6e5f  ad_subscription_
+00020df0: 746f 5f73 7472 6561 6d28 2960 2072 6574  to_stream()` ret
+00020e00: 7572 6e0a 696e 7374 616e 6365 7320 6f66  urn.instances of
+00020e10: 2074 6865 2063 6c61 7373 2060 4173 796e   the class `Asyn
+00020e20: 6369 6f50 6572 7369 7374 656e 7453 7562  cioPersistentSub
+00020e30: 7363 7269 7074 696f 6e60 2c20 7768 6963  scription`, whic
+00020e40: 6820 6861 7320 6173 796e 6320 6d65 7468  h has async meth
+00020e50: 6f64 7320 6061 636b 2829 602c 0a60 6e61  ods `ack()`,.`na
+00020e60: 636b 2829 6020 7468 6174 2077 6f72 6b20  ck()` that work 
+00020e70: 696e 2074 6865 2073 616d 6520 7761 7920  in the same way 
+00020e80: 6173 2074 6865 206d 6574 686f 6473 206f  as the methods o
+00020e90: 6e20 6050 6572 7369 7374 656e 7453 7562  n `PersistentSub
+00020ea0: 7363 7269 7074 696f 6e60 2c0a 7375 7070  scription`,.supp
+00020eb0: 6f72 7469 6e67 2074 6865 2061 636b 6e6f  orting the ackno
+00020ec0: 776c 6564 6765 6d65 6e74 2061 6e64 206e  wledgement and n
+00020ed0: 6567 6174 6976 6520 6163 6b6e 6f77 6c65  egative acknowle
+00020ee0: 6467 656d 656e 7420 6f66 2072 6563 6f72  dgement of recor
+00020ef0: 6465 6420 6576 656e 7473 2074 6861 740a  ded events that.
+00020f00: 6861 7665 2062 6565 6e20 7265 6365 6976  have been receiv
+00020f10: 6564 2066 726f 6d20 6120 7065 7273 6973  ed from a persis
+00020f20: 7465 6e74 2073 7562 7363 7269 7074 696f  tent subscriptio
+00020f30: 6e2e 2053 6565 2061 626f 7665 2066 6f72  n. See above for
+00020f40: 2064 6574 6169 6c73 2e0a 0a23 2323 2053   details...### S
+00020f50: 796e 6f70 7369 733c 6120 6964 3d22 7379  ynopsis<a id="sy
+00020f60: 6e6f 7073 6973 2d31 223e 3c2f 613e 0a0a  nopsis-1"></a>..
+00020f70: 5468 6520 6578 616d 706c 6520 6265 6c6f  The example belo
+00020f80: 7720 6465 6d6f 6e73 7472 6174 6573 2074  w demonstrates t
+00020f90: 6865 2060 6170 7065 6e64 5f74 6f5f 7374  he `append_to_st
+00020fa0: 7265 616d 2829 602c 2060 6765 745f 7374  ream()`, `get_st
+00020fb0: 7265 616d 2829 6020 616e 640a 6073 7562  ream()` and.`sub
+00020fc0: 7363 7269 6265 5f74 6f5f 616c 6c28 2960  scribe_to_all()`
+00020fd0: 206d 6574 686f 6473 2e20 5468 6573 6520   methods. These 
+00020fe0: 6172 6520 7468 6520 6d6f 7374 2075 7365  are the most use
+00020ff0: 6675 6c20 6d65 7468 6f64 7320 666f 7220  ful methods for 
+00021000: 7772 6974 696e 670a 616e 2065 7665 6e74  writing.an event
+00021010: 2d73 6f75 7263 6564 2061 7070 6c69 6361  -sourced applica
+00021020: 7469 6f6e 2c20 616c 6c6f 7769 6e67 206e  tion, allowing n
+00021030: 6577 2061 6767 7265 6761 7465 2065 7665  ew aggregate eve
+00021040: 6e74 7320 746f 2062 6520 7265 636f 7264  nts to be record
+00021050: 6564 2c20 7468 650a 7265 636f 7264 6564  ed, the.recorded
+00021060: 2065 7665 6e74 7320 6f66 2061 6e20 6167   events of an ag
+00021070: 6772 6567 6174 6520 746f 2062 6520 6f62  gregate to be ob
+00021080: 7461 696e 6564 2073 6f20 6167 6772 6567  tained so aggreg
+00021090: 6174 6573 2063 616e 2062 6520 7265 636f  ates can be reco
+000210a0: 6e73 7472 7563 7465 642c 0a61 6e64 2074  nstructed,.and t
+000210b0: 6865 2073 7461 7465 206f 6620 616e 2061  he state of an a
+000210c0: 7070 6c69 6361 7469 6f6e 2074 6f20 7072  pplication to pr
+000210d0: 6f70 6167 6174 6564 2061 6e64 2070 726f  opagated and pro
+000210e0: 6365 7373 6564 2077 6974 6820 2265 7861  cessed with "exa
+000210f0: 6374 6c79 2d6f 6e63 6522 0a73 656d 616e  ctly-once".seman
+00021100: 7469 6373 2e0a 0a60 6060 7079 7468 6f6e  tics...```python
+00021110: 0a69 6d70 6f72 7420 6173 796e 6369 6f0a  .import asyncio.
+00021120: 0a66 726f 6d20 6573 6462 636c 6965 6e74  .from esdbclient
+00021130: 2069 6d70 6f72 7420 4173 796e 6369 6f45   import AsyncioE
+00021140: 7665 6e74 5374 6f72 6544 4243 6c69 656e  ventStoreDBClien
+00021150: 740a 0a0a 6173 796e 6320 6465 6620 6465  t...async def de
+00021160: 6d6f 6e73 7472 6174 655f 6173 796e 6369  monstrate_asynci
+00021170: 6f5f 636c 6965 6e74 2829 3a0a 0a20 2020  o_client():..   
+00021180: 2023 2043 6f6e 7374 7275 6374 2063 6c69   # Construct cli
+00021190: 656e 742e 0a20 2020 2063 6c69 656e 7420  ent..    client 
+000211a0: 3d20 6177 6169 7420 4173 796e 6369 6f45  = await AsyncioE
+000211b0: 7665 6e74 5374 6f72 6544 4243 6c69 656e  ventStoreDBClien
+000211c0: 7428 0a20 2020 2020 2020 2075 7269 3d6f  t(.        uri=o
+000211d0: 732e 6765 7465 6e76 2822 4553 4442 5f55  s.getenv("ESDB_U
+000211e0: 5249 2229 2c0a 2020 2020 2020 2020 726f  RI"),.        ro
+000211f0: 6f74 5f63 6572 7469 6669 6361 7465 733d  ot_certificates=
+00021200: 6f73 2e67 6574 656e 7628 2245 5344 425f  os.getenv("ESDB_
+00021210: 524f 4f54 5f43 4552 5449 4649 4341 5445  ROOT_CERTIFICATE
+00021220: 5322 292c 0a20 2020 2029 0a0a 2020 2020  S"),.    )..    
+00021230: 2320 4170 7065 6e64 2065 7665 6e74 732e  # Append events.
+00021240: 0a20 2020 2073 7472 6561 6d5f 6e61 6d65  .    stream_name
+00021250: 203d 2073 7472 2875 7569 642e 7575 6964   = str(uuid.uuid
+00021260: 3428 2929 0a20 2020 2065 7665 6e74 3120  4()).    event1 
+00021270: 3d20 4e65 7745 7665 6e74 2822 4f72 6465  = NewEvent("Orde
+00021280: 7243 7265 6174 6564 222c 2064 6174 613d  rCreated", data=
+00021290: 6227 7b7d 2729 0a20 2020 2065 7665 6e74  b'{}').    event
+000212a0: 3220 3d20 4e65 7745 7665 6e74 2822 4f72  2 = NewEvent("Or
+000212b0: 6465 7255 7064 6174 6564 222c 2064 6174  derUpdated", dat
+000212c0: 613d 6227 7b7d 2729 0a20 2020 2065 7665  a=b'{}').    eve
+000212d0: 6e74 3320 3d20 4e65 7745 7665 6e74 2822  nt3 = NewEvent("
+000212e0: 4f72 6465 7244 656c 6574 6564 222c 2064  OrderDeleted", d
+000212f0: 6174 613d 6227 7b7d 2729 0a0a 2020 2020  ata=b'{}')..    
+00021300: 636f 6d6d 6974 5f70 6f73 6974 696f 6e20  commit_position 
+00021310: 3d20 6177 6169 7420 636c 6965 6e74 2e61  = await client.a
+00021320: 7070 656e 645f 746f 5f73 7472 6561 6d28  ppend_to_stream(
+00021330: 0a20 2020 2020 2020 2073 7472 6561 6d5f  .        stream_
+00021340: 6e61 6d65 3d73 7472 6561 6d5f 6e61 6d65  name=stream_name
+00021350: 2c0a 2020 2020 2020 2020 6375 7272 656e  ,.        curren
+00021360: 745f 7665 7273 696f 6e3d 5374 7265 616d  t_version=Stream
+00021370: 5374 6174 652e 4e4f 5f53 5452 4541 4d2c  State.NO_STREAM,
+00021380: 0a20 2020 2020 2020 2065 7665 6e74 733d  .        events=
+00021390: 5b65 7665 6e74 312c 2065 7665 6e74 322c  [event1, event2,
+000213a0: 2065 7665 6e74 335d 0a20 2020 2029 0a0a   event3].    )..
+000213b0: 2020 2020 2320 4765 7420 7374 7265 616d      # Get stream
+000213c0: 2065 7665 6e74 732e 0a20 2020 2072 6563   events..    rec
+000213d0: 6f72 6465 6420 3d20 6177 6169 7420 636c  orded = await cl
+000213e0: 6965 6e74 2e67 6574 5f73 7472 6561 6d28  ient.get_stream(
+000213f0: 7374 7265 616d 5f6e 616d 6529 0a20 2020  stream_name).   
+00021400: 2061 7373 6572 7420 6c65 6e28 7265 636f   assert len(reco
+00021410: 7264 6564 2920 3d3d 2033 0a20 2020 2061  rded) == 3.    a
+00021420: 7373 6572 7420 7265 636f 7264 6564 5b30  ssert recorded[0
+00021430: 5d20 3d3d 2065 7665 6e74 310a 2020 2020  ] == event1.    
+00021440: 6173 7365 7274 2072 6563 6f72 6465 645b  assert recorded[
+00021450: 315d 203d 3d20 6576 656e 7432 0a20 2020  1] == event2.   
+00021460: 2061 7373 6572 7420 7265 636f 7264 6564   assert recorded
+00021470: 5b32 5d20 3d3d 2065 7665 6e74 330a 0a0a  [2] == event3...
+00021480: 2020 2020 2320 5375 6273 6372 6962 6520      # Subscribe 
+00021490: 746f 2061 6c6c 2065 7665 6e74 732e 0a20  to all events.. 
+000214a0: 2020 2072 6563 6569 7665 6420 3d20 5b5d     received = []
+000214b0: 0a20 2020 2061 7379 6e63 2077 6974 6820  .    async with 
+000214c0: 6177 6169 7420 636c 6965 6e74 2e73 7562  await client.sub
+000214d0: 7363 7269 6265 5f74 6f5f 616c 6c28 636f  scribe_to_all(co
+000214e0: 6d6d 6974 5f70 6f73 6974 696f 6e3d 3029  mmit_position=0)
+000214f0: 2061 7320 7375 6273 6372 6970 7469 6f6e   as subscription
+00021500: 3a0a 2020 2020 2020 2020 6173 796e 6320  :.        async 
+00021510: 666f 7220 6576 656e 7420 696e 2073 7562  for event in sub
+00021520: 7363 7269 7074 696f 6e3a 0a20 2020 2020  scription:.     
+00021530: 2020 2020 2020 2072 6563 6569 7665 642e         received.
+00021540: 6170 7065 6e64 2865 7665 6e74 290a 2020  append(event).  
+00021550: 2020 2020 2020 2020 2020 6966 2065 7665            if eve
+00021560: 6e74 2e63 6f6d 6d69 745f 706f 7369 7469  nt.commit_positi
+00021570: 6f6e 203d 3d20 636f 6d6d 6974 5f70 6f73  on == commit_pos
+00021580: 6974 696f 6e3a 0a20 2020 2020 2020 2020  ition:.         
+00021590: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
+000215a0: 2061 7373 6572 7420 7265 6365 6976 6564   assert received
+000215b0: 5b2d 335d 203d 3d20 6576 656e 7431 0a20  [-3] == event1. 
+000215c0: 2020 2061 7373 6572 7420 7265 6365 6976     assert receiv
+000215d0: 6564 5b2d 325d 203d 3d20 6576 656e 7432  ed[-2] == event2
+000215e0: 0a20 2020 2061 7373 6572 7420 7265 6365  .    assert rece
+000215f0: 6976 6564 5b2d 315d 203d 3d20 6576 656e  ived[-1] == even
+00021600: 7433 0a0a 0a20 2020 2023 2043 6c6f 7365  t3...    # Close
+00021610: 2074 6865 2063 6c69 656e 742e 0a20 2020   the client..   
+00021620: 2061 7761 6974 2063 6c69 656e 742e 636c   await client.cl
+00021630: 6f73 6528 290a 0a0a 2320 5275 6e20 7468  ose()...# Run th
+00021640: 6520 6465 6d6f 2e0a 6173 796e 6369 6f2e  e demo..asyncio.
+00021650: 6765 745f 6576 656e 745f 6c6f 6f70 2829  get_event_loop()
+00021660: 2e72 756e 5f75 6e74 696c 5f63 6f6d 706c  .run_until_compl
+00021670: 6574 6528 0a20 2020 2064 656d 6f6e 7374  ete(.    demonst
+00021680: 7261 7465 5f61 7379 6e63 696f 5f63 6c69  rate_asyncio_cli
+00021690: 656e 7428 290a 290a 6060 600a 0a23 2320  ent().).```..## 
+000216a0: 4e6f 7465 733c 6120 6964 3d22 6e6f 7465  Notes<a id="note
+000216b0: 7322 3e3c 2f61 3e0a 0a23 2323 2052 6567  s"></a>..### Reg
+000216c0: 756c 6172 2065 7870 7265 7373 696f 6e20  ular expression 
+000216d0: 6669 6c74 6572 733c 6120 6964 3d22 7265  filters<a id="re
+000216e0: 6775 6c61 722d 6578 7072 6573 7369 6f6e  gular-expression
+000216f0: 2d66 696c 7465 7273 223e 3c2f 613e 0a0a  -filters"></a>..
+00021700: 5468 6520 6072 6561 645f 616c 6c28 2960  The `read_all()`
+00021710: 2c20 6073 7562 7363 7269 6265 5f74 6f5f  , `subscribe_to_
+00021720: 616c 6c28 2960 2c20 6063 7265 6174 655f  all()`, `create_
+00021730: 7375 6273 6372 6970 7469 6f6e 5f74 6f5f  subscription_to_
+00021740: 616c 6c28 2960 0a61 6e64 2060 6765 745f  all()`.and `get_
+00021750: 636f 6d6d 6974 5f70 6f73 6974 696f 6e28  commit_position(
+00021760: 2960 206d 6574 686f 6473 2068 6176 6520  )` methods have 
+00021770: 6066 696c 7465 725f 6578 636c 7564 6560  `filter_exclude`
+00021780: 2061 6e64 2060 6669 6c74 6572 5f69 6e63   and `filter_inc
+00021790: 6c75 6465 600a 6172 6775 6d65 6e74 732e  lude`.arguments.
+000217a0: 2054 6869 7320 7365 6374 696f 6e20 7072   This section pr
+000217b0: 6f76 6964 6573 2073 6f6d 6520 6d6f 7265  ovides some more
+000217c0: 2064 6574 6169 6c73 2061 626f 7574 2074   details about t
+000217d0: 6865 2076 616c 7565 7320 6f66 2074 6865  he values of the
+000217e0: 7365 0a61 7267 756d 656e 7473 2e0a 0a54  se.arguments...T
+000217f0: 6865 2066 6972 7374 2074 6869 6e67 2074  he first thing t
+00021800: 6f20 6e6f 7465 2069 7320 7468 6174 2074  o note is that t
+00021810: 6865 2076 616c 7565 7320 6f66 2074 6865  he values of the
+00021820: 7365 2061 7267 756d 656e 7473 2073 686f  se arguments sho
+00021830: 756c 6420 6265 2073 6571 7565 6e63 6573  uld be sequences
+00021840: 0a6f 6620 7265 6775 6c61 7220 6578 7072  .of regular expr
+00021850: 6573 7369 6f6e 732e 0a0a 506c 6561 7365  essions...Please
+00021860: 206e 6f74 652c 2074 6865 7920 6172 6520   note, they are 
+00021870: 636f 6e63 6174 656e 6174 6564 2074 6f67  concatenated tog
+00021880: 6574 6865 7220 6279 2074 6865 2063 6c69  ether by the cli
+00021890: 656e 7420 6173 2062 7261 636b 6574 6564  ent as bracketed
+000218a0: 2061 6c74 6572 6e61 7469 7665 7320 696e   alternatives in
+000218b0: 2061 206c 6172 6765 720a 7265 6775 6c61   a larger.regula
+000218c0: 7220 6578 7072 6573 7369 6f6e 2074 6861  r expression tha
+000218d0: 7420 6973 2061 6e63 686f 7265 6420 746f  t is anchored to
+000218e0: 2074 6865 2073 7461 7274 2061 6e64 2065   the start and e
+000218f0: 6e64 206f 6620 7468 6520 7374 7269 6e67  nd of the string
+00021900: 7320 6265 696e 670a 6d61 7463 6865 642e  s being.matched.
+00021910: 2053 6f20 7468 6572 6520 6973 206e 6f20   So there is no 
+00021920: 6e65 6564 2074 6f20 696e 636c 7564 6520  need to include 
+00021930: 7468 6520 6027 5e27 6020 616e 6420 6027  the `'^'` and `'
+00021940: 2427 6020 616e 6368 6f72 2061 7373 6572  $'` anchor asser
+00021950: 7469 6f6e 732e 0a0a 596f 7520 7368 6f75  tions...You shou
+00021960: 6c64 2075 7365 2077 696c 6463 6172 6473  ld use wildcards
+00021970: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
+00021980: 6d61 7463 6820 7375 6273 7472 696e 6773  match substrings
+00021990: 2c20 666f 7220 6578 616d 706c 6520 6027  , for example `'
+000219a0: 2e2a 536e 6170 7368 6f74 2760 0a74 6f20  .*Snapshot'`.to 
+000219b0: 6d61 7463 6820 616c 6c20 7374 7269 6e67  match all string
+000219c0: 7320 7468 6174 2065 6e64 2077 6974 6820  s that end with 
+000219d0: 6027 536e 6170 7368 6f74 6027 2c20 6f72  `'Snapshot`', or
+000219e0: 2060 274f 7264 6572 2e2a 2760 2074 6f20   `'Order.*'` to 
+000219f0: 6d61 7463 6820 616c 6c20 7374 7269 6e67  match all string
+00021a00: 730a 7468 6174 2073 7461 7274 2077 6974  s.that start wit
+00021a10: 6820 6027 4f72 6465 7227 602e 0a0a 5379  h `'Order'`...Sy
+00021a20: 7374 656d 2065 7665 6e74 7320 6765 6e65  stem events gene
+00021a30: 7261 7465 6420 6279 2045 7665 6e74 5374  rated by EventSt
+00021a40: 6f72 6544 4220 6861 7665 2060 7479 7065  oreDB have `type
+00021a50: 6020 7374 7269 6e67 7320 7468 6174 2073  ` strings that s
+00021a60: 7461 7274 2077 6974 680a 7468 6520 6024  tart with.the `$
+00021a70: 6020 7369 676e 2e20 5065 7273 6973 7465  ` sign. Persiste
+00021a80: 6e63 6520 7375 6273 6372 6970 7469 6f6e  nce subscription
+00021a90: 2065 7665 6e74 7320 6765 6e65 7261 7465   events generate
+00021aa0: 6420 7768 656e 206d 616e 6970 756c 6174  d when manipulat
+00021ab0: 696e 670a 7065 7273 6973 7465 6e63 6520  ing.persistence 
+00021ac0: 7375 6273 6372 6970 7469 6f6e 7320 6861  subscriptions ha
+00021ad0: 7665 2060 7479 7065 6020 7374 7269 6e67  ve `type` string
+00021ae0: 7320 7468 6174 2073 7461 7274 2077 6974  s that start wit
+00021af0: 6820 6050 6572 7369 7374 656e 7443 6f6e  h `PersistentCon
+00021b00: 6669 6760 2e0a 0a46 6f72 2065 7861 6d70  fig`...For examp
+00021b10: 6c65 2c20 746f 206d 6174 6368 2074 6865  le, to match the
+00021b20: 2074 7970 6520 6f66 2045 7665 6e74 5374   type of EventSt
+00021b30: 6f72 6544 4220 7379 7374 656d 2065 7665  oreDB system eve
+00021b40: 6e74 732c 2075 7365 2074 6865 2072 6567  nts, use the reg
+00021b50: 756c 6172 0a65 7870 7265 7373 696f 6e20  ular.expression 
+00021b60: 7374 7269 6e67 2060 7227 5c24 2e2b 2760  string `r'\$.+'`
+00021b70: 2e20 506c 6561 7365 206e 6f74 652c 2074  . Please note, t
+00021b80: 6865 2063 6f6e 7374 616e 7420 6045 5344  he constant `ESD
+00021b90: 425f 5359 5354 454d 5f45 5645 4e54 535f  B_SYSTEM_EVENTS_
+00021ba0: 5245 4745 5860 2069 730a 7365 7420 746f  REGEX` is.set to
+00021bb0: 2074 6869 7320 7661 6c75 652e 2059 6f75   this value. You
+00021bc0: 2063 616e 2069 6d70 6f72 7420 7468 6973   can import this
+00021bd0: 2063 6f6e 7374 616e 7420 6672 6f6d 2060   constant from `
+00021be0: 6573 6462 636c 6965 6e74 6020 616e 6420  esdbclient` and 
+00021bf0: 7573 6520 6974 2077 6865 6e0a 6275 696c  use it when.buil
+00021c00: 6469 6e67 206c 6f6e 6765 7220 7365 7175  ding longer sequ
+00021c10: 656e 6365 7320 6f66 2072 6567 756c 6172  ences of regular
+00021c20: 2065 7870 7265 7373 696f 6e73 2e0a 0a53   expressions...S
+00021c30: 696d 696c 6172 6c79 2c20 746f 206d 6174  imilarly, to mat
+00021c40: 6368 2074 6865 2074 7970 6520 6f66 2045  ch the type of E
+00021c50: 7665 6e74 5374 6f72 6544 4220 7065 7273  ventStoreDB pers
+00021c60: 6973 7465 6e63 6520 7375 6273 6372 6970  istence subscrip
+00021c70: 7469 6f6e 2065 7665 6e74 732c 2075 7365  tion events, use
+00021c80: 2074 6865 0a72 6567 756c 6172 2065 7870   the.regular exp
+00021c90: 7265 7373 696f 6e20 6072 2750 6572 7369  ression `r'Persi
+00021ca0: 7374 656e 7443 6f6e 6669 675c 642b 2760  stentConfig\d+'`
+00021cb0: 2e20 5468 6520 636f 6e73 7461 6e74 2060  . The constant `
+00021cc0: 4553 4442 5f50 4552 5349 5354 454e 545f  ESDB_PERSISTENT_
+00021cd0: 434f 4e46 4947 5f45 5645 4e54 535f 5245  CONFIG_EVENTS_RE
+00021ce0: 4745 5860 0a69 7320 7365 7420 746f 2074  GEX`.is set to t
+00021cf0: 6869 7320 7661 6c75 652e 2059 6f75 2063  his value. You c
+00021d00: 616e 2069 6d70 6f72 7420 7468 6973 2063  an import this c
+00021d10: 6f6e 7374 616e 7420 6672 6f6d 2060 6573  onstant from `es
+00021d20: 6462 636c 6965 6e74 6020 616e 6420 7573  dbclient` and us
+00021d30: 6520 6974 2077 6865 6e0a 6275 696c 6469  e it when.buildi
+00021d40: 6e67 206c 6f6e 6765 7220 7365 7175 656e  ng longer sequen
+00021d50: 6365 7320 6f66 2072 6567 756c 6172 2065  ces of regular e
+00021d60: 7870 7265 7373 696f 6e73 2e0a 0a54 6865  xpressions...The
+00021d70: 2063 6f6e 7374 616e 7420 6044 4546 4155   constant `DEFAU
+00021d80: 4c54 5f45 5843 4c55 4445 5f46 494c 5445  LT_EXCLUDE_FILTE
+00021d90: 5260 2069 7320 6120 7365 7175 656e 6365  R` is a sequence
+00021da0: 206f 6620 7265 6775 6c61 7220 6578 7072   of regular expr
+00021db0: 6573 7369 6f6e 7320 7468 6174 2069 6e63  essions that inc
+00021dc0: 6c75 6465 730a 626f 7468 2060 4553 4442  ludes.both `ESDB
+00021dd0: 5f53 5953 5445 4d5f 4556 454e 5453 5f52  _SYSTEM_EVENTS_R
+00021de0: 4547 4558 6020 616e 6420 6045 5344 425f  EGEX` and `ESDB_
+00021df0: 5045 5253 4953 5445 4e54 5f43 4f4e 4649  PERSISTENT_CONFI
+00021e00: 475f 4556 454e 5453 5f52 4547 4558 602e  G_EVENTS_REGEX`.
+00021e10: 2049 7420 6973 2075 7365 640a 6173 2074   It is used.as t
+00021e20: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+00021e30: 206f 6620 6066 696c 7465 725f 6578 636c   of `filter_excl
+00021e40: 7564 6560 2073 6f20 7468 6174 2074 6865  ude` so that the
+00021e50: 2065 7665 6e74 7320 6765 6e65 7261 7465   events generate
+00021e60: 6420 696e 7465 726e 616c 6c79 2062 790a  d internally by.
+00021e70: 4576 656e 7453 746f 7265 4442 2061 7265  EventStoreDB are
+00021e80: 2065 7863 6c75 6465 6420 6279 2064 6566   excluded by def
+00021e90: 6175 6c74 2e0a 0a49 6e20 616c 6c20 6d65  ault...In all me
+00021ea0: 7468 6f64 7320 7468 6174 2068 6176 6520  thods that have 
+00021eb0: 6120 6066 696c 7465 725f 6578 636c 7564  a `filter_exclud
+00021ec0: 6560 2061 7267 756d 656e 742c 2074 6865  e` argument, the
+00021ed0: 2064 6566 6175 6c74 2076 616c 7565 206f   default value o
+00021ee0: 6620 7468 6520 6172 6775 6d65 6e74 0a69  f the argument.i
+00021ef0: 7320 7468 6520 636f 6e73 7461 6e74 2060  s the constant `
+00021f00: 4445 4641 554c 545f 4558 434c 5544 455f  DEFAULT_EXCLUDE_
+00021f10: 4649 4c54 4552 602c 2077 6869 6368 2069  FILTER`, which i
+00021f20: 7320 6465 7369 676e 6564 2074 6f20 6d61  s designed to ma
+00021f30: 7463 6820 2861 6e64 2074 6865 7265 666f  tch (and therefo
+00021f40: 7265 0a74 6f20 6578 636c 7564 6529 2062  re.to exclude) b
+00021f50: 6f74 6820 2273 7973 7465 6d22 2061 6e64  oth "system" and
+00021f60: 2022 7065 7273 6973 7465 6e63 6520 7375   "persistence su
+00021f70: 6273 6372 6970 7469 6f6e 2063 6f6e 6669  bscription confi
+00021f80: 6722 2065 7665 6e74 2074 7970 6573 2c20  g" event types, 
+00021f90: 7768 6963 680a 776f 756c 6420 6f74 6865  which.would othe
+00021fa0: 7277 6973 6520 6265 2069 6e63 6c75 6465  rwise be include
+00021fb0: 642e 0a0a 5468 6973 2076 616c 7565 2063  d...This value c
+00021fc0: 616e 2062 6520 6578 7465 6e64 6564 2e20  an be extended. 
+00021fd0: 466f 7220 6578 616d 706c 652c 2069 6620  For example, if 
+00021fe0: 796f 7520 7761 6e74 2074 6f20 6578 636c  you want to excl
+00021ff0: 7564 6520 7379 7374 656d 2065 7665 6e74  ude system event
+00022000: 7320 616e 640a 7065 7273 6973 7465 6e74  s and.persistent
+00022010: 2073 7562 7363 7269 7074 696f 6e20 6576   subscription ev
+00022020: 656e 7473 2061 6e64 2061 6c73 6f20 6576  ents and also ev
+00022030: 656e 7473 2074 6861 7420 6861 7665 2061  ents that have a
+00022040: 2074 7970 6520 7468 6174 2065 6e64 7320   type that ends 
+00022050: 7769 7468 0a60 2753 6e61 7073 686f 7427  with.`'Snapshot'
+00022060: 602c 2074 6865 6e20 796f 7520 6361 6e20  `, then you can 
+00022070: 7573 6520 6044 4546 4155 4c54 5f45 5843  use `DEFAULT_EXC
+00022080: 4c55 4445 5f46 494c 5445 5220 2b20 5b27  LUDE_FILTER + ['
+00022090: 2e2a 536e 6170 7368 6f74 275d 6020 6173  .*Snapshot']` as
+000220a0: 2074 6865 0a60 6669 6c74 6572 5f65 7863   the.`filter_exc
+000220b0: 6c75 6465 6020 6172 6775 6d65 6e74 2e0a  lude` argument..
+000220c0: 0a54 6865 2060 6669 6c74 6572 5f69 6e63  .The `filter_inc
+000220d0: 6c75 6465 6020 616e 6420 6066 696c 7465  lude` and `filte
+000220e0: 725f 6578 636c 7564 6560 2061 7267 756d  r_exclude` argum
+000220f0: 656e 7473 2061 7265 2064 6573 6967 6e65  ents are designe
+00022100: 6420 746f 2068 6176 6520 6578 6163 746c  d to have exactl
+00022110: 790a 7468 6520 6f70 706f 7369 7465 2065  y.the opposite e
+00022120: 6666 6563 7420 6672 6f6d 2065 6163 6820  ffect from each 
+00022130: 6f74 6865 722c 2073 6f20 7468 6174 2061  other, so that a
+00022140: 2073 6571 7565 6e63 6520 6f66 2073 7472   sequence of str
+00022150: 696e 6773 2067 6976 656e 2074 6f0a 6066  ings given to.`f
+00022160: 696c 7465 725f 696e 636c 7564 6560 2077  ilter_include` w
+00022170: 696c 6c20 7265 7475 726e 2065 7861 6374  ill return exact
+00022180: 6c79 2074 686f 7365 2065 7665 6e74 7320  ly those events 
+00022190: 7768 6963 6820 776f 756c 6420 6265 2065  which would be e
+000221a0: 7863 6c75 6465 6420 6966 0a74 6865 2073  xcluded if.the s
+000221b0: 616d 6520 6172 6775 6d65 6e74 2076 616c  ame argument val
+000221c0: 7565 2077 6572 6520 7573 6564 2077 6974  ue were used wit
+000221d0: 6820 6066 696c 7465 725f 6578 636c 7564  h `filter_exclud
+000221e0: 6560 2e20 416e 6420 7669 6365 2076 6572  e`. And vice ver
+000221f0: 7361 2c20 736f 2074 6861 740a 6120 7365  sa, so that.a se
+00022200: 7175 656e 6365 206f 6620 7374 7269 6e67  quence of string
+00022210: 7320 6769 7665 6e20 746f 2060 6669 6c74  s given to `filt
+00022220: 6572 5f65 7863 6c75 6465 6020 7769 6c6c  er_exclude` will
+00022230: 2072 6574 7572 6e20 6578 6163 746c 7920   return exactly 
+00022240: 7468 6f73 6520 6576 656e 7473 0a74 6861  those events.tha
+00022250: 7420 776f 756c 6420 6e6f 7420 6265 2069  t would not be i
+00022260: 6e63 6c75 6465 6420 6966 2074 6865 2073  ncluded if the s
+00022270: 616d 6520 6172 6775 6d65 6e74 2076 616c  ame argument val
+00022280: 7565 2077 6572 6520 7573 6564 2077 6974  ue were used wit
+00022290: 6820 6066 696c 7465 725f 696e 636c 7564  h `filter_includ
+000222a0: 6560 2e0a 0a0a 2323 2320 5265 636f 6e6e  e`....### Reconn
+000222b0: 6563 7420 616e 6420 7265 7472 7920 6d65  ect and retry me
+000222c0: 7468 6f64 2064 6563 6f72 6174 6f72 733c  thod decorators<
+000222d0: 6120 6964 3d22 7265 636f 6e6e 6563 742d  a id="reconnect-
+000222e0: 616e 642d 7265 7472 792d 6d65 7468 6f64  and-retry-method
+000222f0: 2d64 6563 6f72 6174 6f72 7322 3e3c 2f61  -decorators"></a
+00022300: 3e0a 0a50 6c65 6173 6520 6e6f 7465 2c20  >..Please note, 
+00022310: 6e65 6172 6c79 2061 6c6c 2074 6865 2063  nearly all the c
+00022320: 6c69 656e 7420 6d65 7468 6f64 7320 6172  lient methods ar
+00022330: 6520 6465 636f 7261 7465 6420 7769 7468  e decorated with
+00022340: 2074 6865 2060 4061 7574 6f72 6563 6f6e   the `@autorecon
+00022350: 6e65 6374 6020 616e 640a 7468 6520 6040  nect` and.the `@
+00022360: 7265 7472 7967 7270 6360 2064 6563 6f72  retrygrpc` decor
+00022370: 6174 6f72 732e 0a0a 5468 6520 6040 6175  ators...The `@au
+00022380: 746f 7265 636f 6e6e 6563 7460 2064 6563  toreconnect` dec
+00022390: 6f72 6174 6f72 2077 696c 6c20 7265 636f  orator will reco
+000223a0: 6e6e 6563 7420 746f 2061 2073 7569 7461  nnect to a suita
+000223b0: 626c 6520 6e6f 6465 2069 6e20 7468 6520  ble node in the 
+000223c0: 636c 7573 7465 7220 7768 656e 0a74 6865  cluster when.the
+000223d0: 2073 6572 7665 7220 746f 2077 6869 6368   server to which
+000223e0: 2074 6865 2063 6c69 656e 7420 6861 7320   the client has 
+000223f0: 6265 656e 2063 6f6e 6e65 6374 6564 2068  been connected h
+00022400: 6173 2062 6563 6f6d 6520 756e 6176 6169  as become unavai
+00022410: 6c61 626c 652c 206f 7220 7768 656e 2074  lable, or when t
+00022420: 6865 0a63 6c69 656e 7427 7320 6752 5043  he.client's gRPC
+00022430: 2063 6861 6e6e 656c 2068 6170 7065 6e73   channel happens
+00022440: 2074 6f20 6861 7665 2062 6565 6e20 636c   to have been cl
+00022450: 6f73 6564 2e20 5468 6520 636c 6965 6e74  osed. The client
+00022460: 2077 696c 6c20 616c 736f 2072 6563 6f6e   will also recon
+00022470: 6e65 6374 2077 6865 6e0a 6120 6d65 7468  nect when.a meth
+00022480: 6f64 2069 7320 6361 6c6c 6564 2074 6861  od is called tha
+00022490: 7420 7265 7175 6972 6573 2061 206c 6561  t requires a lea
+000224a0: 6465 722c 2061 6e64 2074 6865 2063 6c69  der, and the cli
+000224b0: 656e 7427 7320 6e6f 6465 2070 7265 6665  ent's node prefe
+000224c0: 7265 6e63 6520 6973 2074 6f20 6265 0a63  rence is to be.c
+000224d0: 6f6e 6e65 6374 6564 2074 6f20 6120 6c65  onnected to a le
+000224e0: 6164 6572 2c20 6275 7420 7468 6520 6e6f  ader, but the no
+000224f0: 6465 2074 6861 7420 7468 6520 636c 6965  de that the clie
+00022500: 6e74 2068 6173 2062 6565 6e20 636f 6e6e  nt has been conn
+00022510: 6563 7465 6420 746f 2073 746f 7073 2062  ected to stops b
+00022520: 6569 6e67 0a74 6865 206c 6561 6465 722e  eing.the leader.
+00022530: 2049 6e20 7468 6973 2063 6173 652c 2074   In this case, t
+00022540: 6865 2063 6c69 656e 7420 7769 6c6c 2072  he client will r
+00022550: 6563 6f6e 6e65 6374 2074 6f20 7468 6520  econnect to the 
+00022560: 6375 7272 656e 7420 6c65 6164 6572 2e20  current leader. 
+00022570: 4166 7465 720a 7265 636f 6e6e 6563 7469  After.reconnecti
+00022580: 6e67 2c20 7468 6520 6661 696c 6564 206f  ng, the failed o
+00022590: 7065 7261 7469 6f6e 2077 696c 6c20 6265  peration will be
+000225a0: 2072 6574 7269 6564 2e0a 0a54 6865 2060   retried...The `
+000225b0: 4072 6574 7279 6772 7063 6020 6465 636f  @retrygrpc` deco
+000225c0: 7261 746f 7220 7365 6c65 6374 6976 656c  rator selectivel
+000225d0: 7920 7265 7472 6965 7320 6752 5043 206f  y retries gRPC o
+000225e0: 7065 7261 7469 6f6e 7320 7468 6174 2068  perations that h
+000225f0: 6176 6520 6661 696c 6564 2064 7565 2074  ave failed due t
+00022600: 6f0a 6120 7469 6d65 6f75 742c 206e 6574  o.a timeout, net
+00022610: 776f 726b 2065 7272 6f72 2c20 6f72 2073  work error, or s
+00022620: 6572 7665 7220 6572 726f 722e 2049 7420  erver error. It 
+00022630: 646f 6573 6e27 7420 7265 7472 7920 6f70  doesn't retry op
+00022640: 6572 6174 696f 6e73 2074 6861 7420 6661  erations that fa
+00022650: 696c 2064 7565 2074 6f0a 6261 6420 7265  il due to.bad re
+00022660: 7175 6573 7473 2074 6861 7420 7769 6c6c  quests that will
+00022670: 2063 6572 7461 696e 6c79 2066 6169 6c20   certainly fail 
+00022680: 6167 6169 6e2e 0a0a 506c 6561 7365 2061  again...Please a
+00022690: 6c73 6f20 6e6f 7465 2c20 7468 6520 6173  lso note, the as
+000226a0: 7065 6374 7320 6e6f 7420 636f 7665 7265  pects not covere
+000226b0: 6420 6279 2074 6865 2072 6563 6f6e 6e65  d by the reconne
+000226c0: 6374 2061 6e64 2072 6574 7279 2064 6563  ct and retry dec
+000226d0: 6f72 6174 6f72 0a62 6568 6176 696f 7572  orator.behaviour
+000226e0: 7320 6861 7665 2074 6f20 646f 2077 6974  s have to do wit
+000226f0: 6820 6d65 7468 6f64 7320 7468 6174 2072  h methods that r
+00022700: 6574 7572 6e20 6974 6572 6174 6f72 732e  eturn iterators.
+00022710: 2046 6f72 2065 7861 6d70 6c65 2c20 636f   For example, co
+00022720: 6e73 6964 6572 0a74 6865 2022 7265 6164  nsider.the "read
+00022730: 2072 6573 706f 6e73 6522 2069 7465 7261   response" itera
+00022740: 746f 7220 7265 7475 726e 6564 2066 726f  tor returned fro
+00022750: 6d20 7468 6520 6072 6561 645f 616c 6c28  m the `read_all(
+00022760: 2960 206d 6574 686f 642e 2054 6865 0a60  )` method. The.`
+00022770: 7265 6164 5f61 6c6c 2829 6020 6d65 7468  read_all()` meth
+00022780: 6f64 2077 696c 6c20 6861 7665 2072 6574  od will have ret
+00022790: 7572 6e65 642c 2061 6e64 2074 6865 206d  urned, and the m
+000227a0: 6574 686f 6420 6465 636f 7261 746f 7273  ethod decorators
+000227b0: 2077 696c 6c20 7468 6572 6566 6f72 650a   will therefore.
+000227c0: 6861 7665 2065 7869 7465 642c 2062 6566  have exited, bef
+000227d0: 6f72 6520 6974 6572 6174 696e 6720 6f76  ore iterating ov
+000227e0: 6572 2074 6865 2022 7265 6164 2072 6573  er the "read res
+000227f0: 706f 6e73 6522 2062 6567 696e 732e 2054  ponse" begins. T
+00022800: 6865 7265 666f 7265 2c20 6966 2061 0a63  herefore, if a.c
+00022810: 6f6e 6e65 6374 696f 6e20 6973 7375 6520  onnection issue 
+00022820: 6f63 6375 7273 2077 6869 6c73 7420 6974  occurs whilst it
+00022830: 6572 6174 696e 6720 6f76 6572 2074 6865  erating over the
+00022840: 2022 7265 6164 2072 6573 706f 6e73 6522   "read response"
+00022850: 2c20 6974 2069 736e 2774 2070 6f73 7369  , it isn't possi
+00022860: 626c 650a 666f 7220 616e 7920 6465 636f  ble.for any deco
+00022870: 7261 746f 7220 6f6e 2074 6865 2060 7265  rator on the `re
+00022880: 6164 5f61 6c6c 2829 6020 6d65 7468 6f64  ad_all()` method
+00022890: 2074 6f20 7472 6967 6765 7220 6120 7265   to trigger a re
+000228a0: 636f 6e6e 6563 7469 6f6e 2e0a 0a57 6974  connection...Wit
+000228b0: 6820 7468 6520 2263 6174 6368 2d75 7020  h the "catch-up 
+000228c0: 7375 6273 6372 6970 7469 6f6e 2220 6f62  subscription" ob
+000228d0: 6a65 6374 732c 2074 6865 7265 2069 7320  jects, there is 
+000228e0: 616e 2069 6e69 7469 616c 2022 636f 6e66  an initial "conf
+000228f0: 6972 6d61 7469 6f6e 2220 7265 7370 6f6e  irmation" respon
+00022900: 7365 0a66 726f 6d20 7468 6520 7365 7276  se.from the serv
+00022910: 6572 2077 6869 6368 2069 7320 7265 6365  er which is rece
+00022920: 6976 6564 2061 6e64 2063 6865 636b 6564  ived and checked
+00022930: 2062 7920 7468 6520 636c 6965 6e74 2e20   by the client. 
+00022940: 416e 6420 736f 2c20 7768 656e 2061 2063  And so, when a c
+00022950: 616c 6c20 6973 0a6d 6164 6520 746f 2060  all is.made to `
+00022960: 7375 6273 6372 6962 655f 746f 5f61 6c6c  subscribe_to_all
+00022970: 2829 6020 6f72 2060 7375 6273 6372 6962  ()` or `subscrib
+00022980: 655f 746f 5f73 7472 6561 6d28 2960 2c20  e_to_stream()`, 
+00022990: 6966 2074 6865 2073 6572 7665 7220 6973  if the server is
+000229a0: 2075 6e61 7661 696c 6162 6c65 2c0a 6f72   unavailable,.or
+000229b0: 2069 6620 7468 6520 6368 616e 6e65 6c20   if the channel 
+000229c0: 6861 7320 736f 6d65 686f 7720 6265 656e  has somehow been
+000229d0: 2063 6c6f 7365 642c 206f 7220 6966 2074   closed, or if t
+000229e0: 6865 2072 6571 7565 7374 2066 6169 6c73  he request fails
+000229f0: 2066 6f72 2073 6f6d 6520 6f74 6865 7220   for some other 
+00022a00: 7265 6173 6f6e 2c0a 7468 656e 2074 6865  reason,.then the
+00022a10: 2063 6c69 656e 7420 7769 6c6c 2072 6563   client will rec
+00022a20: 6f6e 6e65 6374 2061 6e64 2072 6574 7279  onnect and retry
+00022a30: 2e20 486f 7765 7665 722c 2069 6620 616e  . However, if an
+00022a40: 2065 7863 6570 7469 6f6e 2069 7320 7261   exception is ra
+00022a50: 6973 6564 2077 6865 6e20 6974 6572 6174  ised when iterat
+00022a60: 696e 6720 6f76 6572 2061 0a73 7563 6365  ing over a.succe
+00022a70: 7373 6675 6c6c 7920 7265 7475 726e 6564  ssfully returned
+00022a80: 2022 6361 7463 682d 7570 2073 7562 7363   "catch-up subsc
+00022a90: 7269 7074 696f 6e22 206f 626a 6563 742c  ription" object,
+00022aa0: 2074 6865 2063 6174 6368 2d75 7020 7375   the catch-up su
+00022ab0: 6273 6372 6970 7469 6f6e 2077 696c 6c0a  bscription will.
+00022ac0: 6e65 6564 2074 6f20 6265 2072 6573 7461  need to be resta
+00022ad0: 7274 6564 2e20 5369 6d69 6c61 726c 792c  rted. Similarly,
+00022ae0: 2077 6865 6e20 7265 6164 696e 6720 7065   when reading pe
+00022af0: 7273 6973 7465 6e74 2073 7562 7363 7269  rsistent subscri
+00022b00: 7074 696f 6e73 2c20 6966 2074 6865 7265  ptions, if there
+00022b10: 2061 7265 0a63 6f6e 6e65 6374 696f 6e20   are.connection 
+00022b20: 6973 7375 6573 2077 6869 6c73 7420 6974  issues whilst it
+00022b30: 6572 6174 696e 6720 6f76 6572 2061 2073  erating over a s
+00022b40: 7563 6365 7373 6675 6c6c 7920 7265 6365  uccessfully rece
+00022b50: 6976 6564 2072 6573 706f 6e73 652c 2074  ived response, t
+00022b60: 6865 2063 6f6e 7375 6d65 720a 7769 6c6c  he consumer.will
+00022b70: 206e 6565 6420 746f 2062 6520 7265 7374   need to be rest
+00022b80: 6172 7465 642e 0a0a 0a23 2320 436f 6e74  arted....## Cont
+00022b90: 7269 6275 746f 7273 3c61 2069 643d 2263  ributors<a id="c
+00022ba0: 6f6e 7472 6962 7574 6f72 7322 3e3c 2f61  ontributors"></a
+00022bb0: 3e0a 0a23 2323 2049 6e73 7461 6c6c 2050  >..### Install P
+00022bc0: 6f65 7472 793c 6120 6964 3d22 696e 7374  oetry<a id="inst
+00022bd0: 616c 6c2d 706f 6574 7279 223e 3c2f 613e  all-poetry"></a>
+00022be0: 0a0a 5468 6520 6669 7273 7420 7468 696e  ..The first thin
+00022bf0: 6720 6973 2074 6f20 6368 6563 6b20 796f  g is to check yo
+00022c00: 7520 6861 7665 2050 6f65 7472 7920 696e  u have Poetry in
+00022c10: 7374 616c 6c65 642e 0a0a 2020 2020 2420  stalled...    $ 
+00022c20: 706f 6574 7279 202d 2d76 6572 7369 6f6e  poetry --version
+00022c30: 0a0a 4966 2079 6f75 2064 6f6e 2774 2c20  ..If you don't, 
+00022c40: 7468 656e 2070 6c65 6173 6520 5b69 6e73  then please [ins
+00022c50: 7461 6c6c 2050 6f65 7472 795d 2868 7474  tall Poetry](htt
+00022c60: 7073 3a2f 2f70 7974 686f 6e2d 706f 6574  ps://python-poet
+00022c70: 7279 2e6f 7267 2f64 6f63 732f 2369 6e73  ry.org/docs/#ins
+00022c80: 7461 6c6c 696e 672d 7769 7468 2d74 6865  talling-with-the
+00022c90: 2d6f 6666 6963 6961 6c2d 696e 7374 616c  -official-instal
+00022ca0: 6c65 7229 2e0a 0a20 2020 2024 2063 7572  ler)...    $ cur
+00022cb0: 6c20 2d73 534c 2068 7474 7073 3a2f 2f69  l -sSL https://i
+00022cc0: 6e73 7461 6c6c 2e70 7974 686f 6e2d 706f  nstall.python-po
+00022cd0: 6574 7279 2e6f 7267 207c 2070 7974 686f  etry.org | pytho
+00022ce0: 6e33 202d 0a0a 4974 2077 696c 6c20 6865  n3 -..It will he
+00022cf0: 6c70 2074 6f20 6d61 6b65 2073 7572 6520  lp to make sure 
+00022d00: 506f 6574 7279 2773 2062 696e 2064 6972  Poetry's bin dir
+00022d10: 6563 746f 7279 2069 7320 696e 2079 6f75  ectory is in you
+00022d20: 7220 6050 4154 4860 2065 6e76 6972 6f6e  r `PATH` environ
+00022d30: 6d65 6e74 2076 6172 6961 626c 652e 0a0a  ment variable...
+00022d40: 4275 7420 696e 2061 6e79 2063 6173 652c  But in any case,
+00022d50: 206d 616b 6520 7375 7265 2079 6f75 206b   make sure you k
+00022d60: 6e6f 7720 7468 6520 7061 7468 2074 6f20  now the path to 
+00022d70: 7468 6520 6070 6f65 7472 7960 2065 7865  the `poetry` exe
+00022d80: 6375 7461 626c 652e 2054 6865 2050 6f65  cutable. The Poe
+00022d90: 7472 790a 696e 7374 616c 6c65 7220 7465  try.installer te
+00022da0: 6c6c 7320 796f 7520 7768 6572 6520 6974  lls you where it
+00022db0: 2068 6173 2062 6565 6e20 696e 7374 616c   has been instal
+00022dc0: 6c65 642c 2061 6e64 2068 6f77 2074 6f20  led, and how to 
+00022dd0: 636f 6e66 6967 7572 6520 796f 7572 2073  configure your s
+00022de0: 6865 6c6c 2e0a 0a50 6c65 6173 6520 7265  hell...Please re
+00022df0: 6665 7220 746f 2074 6865 205b 506f 6574  fer to the [Poet
+00022e00: 7279 2064 6f63 735d 2868 7474 7073 3a2f  ry docs](https:/
+00022e10: 2f70 7974 686f 6e2d 706f 6574 7279 2e6f  /python-poetry.o
+00022e20: 7267 2f64 6f63 732f 2920 666f 7220 6775  rg/docs/) for gu
+00022e30: 6964 616e 6365 206f 6e0a 7573 696e 6720  idance on.using 
+00022e40: 506f 6574 7279 2e0a 0a23 2323 2053 6574  Poetry...### Set
+00022e50: 7570 2066 6f72 2050 7943 6861 726d 2075  up for PyCharm u
+00022e60: 7365 7273 3c61 2069 643d 2273 6574 7570  sers<a id="setup
+00022e70: 2d66 6f72 2d70 7963 6861 726d 2d75 7365  -for-pycharm-use
+00022e80: 7273 223e 3c2f 613e 0a0a 596f 7520 6361  rs"></a>..You ca
+00022e90: 6e20 6561 7369 6c79 206f 6274 6169 6e20  n easily obtain 
+00022ea0: 7468 6520 7072 6f6a 6563 7420 6669 6c65  the project file
+00022eb0: 7320 7573 696e 6720 5079 4368 6172 6d20  s using PyCharm 
+00022ec0: 286d 656e 7520 2247 6974 203e 2043 6c6f  (menu "Git > Clo
+00022ed0: 6e65 2e2e 2e22 292e 0a50 7943 6861 726d  ne...")..PyCharm
+00022ee0: 2077 696c 6c20 7468 656e 2075 7375 616c   will then usual
+00022ef0: 6c79 2070 726f 6d70 7420 796f 7520 746f  ly prompt you to
+00022f00: 206f 7065 6e20 7468 6520 7072 6f6a 6563   open the projec
+00022f10: 742e 0a0a 4f70 656e 2074 6865 2070 726f  t...Open the pro
+00022f20: 6a65 6374 2069 6e20 6120 6e65 7720 7769  ject in a new wi
+00022f30: 6e64 6f77 2e20 5079 4368 6172 6d20 7769  ndow. PyCharm wi
+00022f40: 6c6c 2074 6865 6e20 7573 7561 6c6c 7920  ll then usually 
+00022f50: 7072 6f6d 7074 2079 6f75 2074 6f20 6372  prompt you to cr
+00022f60: 6561 7465 0a61 206e 6577 2076 6972 7475  eate.a new virtu
+00022f70: 616c 2065 6e76 6972 6f6e 6d65 6e74 2e0a  al environment..
+00022f80: 0a43 7265 6174 6520 6120 6e65 7720 506f  .Create a new Po
+00022f90: 6574 7279 2076 6972 7475 616c 2065 6e76  etry virtual env
+00022fa0: 6972 6f6e 6d65 6e74 2066 6f72 2074 6865  ironment for the
+00022fb0: 2070 726f 6a65 6374 2e20 4966 2050 7943   project. If PyC
+00022fc0: 6861 726d 2064 6f65 736e 2774 2061 6c72  harm doesn't alr
+00022fd0: 6561 6479 0a6b 6e6f 7720 7768 6572 6520  eady.know where 
+00022fe0: 796f 7572 2060 706f 6574 7279 6020 6578  your `poetry` ex
+00022ff0: 6563 7574 6162 6c65 2069 732c 2074 6865  ecutable is, the
+00023000: 6e20 7365 7420 7468 6520 7061 7468 2074  n set the path t
+00023010: 6f20 796f 7572 2060 706f 6574 7279 6020  o your `poetry` 
+00023020: 6578 6563 7574 6162 6c65 0a69 6e20 7468  executable.in th
+00023030: 6520 224e 6577 2050 6f65 7472 7920 456e  e "New Poetry En
+00023040: 7669 726f 6e6d 656e 7422 2066 6f72 6d20  vironment" form 
+00023050: 696e 7075 7420 6669 656c 6420 6c61 6265  input field labe
+00023060: 6c6c 6564 2022 506f 6574 7279 2065 7865  lled "Poetry exe
+00023070: 6375 7461 626c 6522 2e20 496e 2074 6865  cutable". In the
+00023080: 0a22 4e65 7720 506f 6574 7279 2045 6e76  ."New Poetry Env
+00023090: 6972 6f6e 6d65 6e74 2220 666f 726d 2c20  ironment" form, 
+000230a0: 796f 7520 7769 6c6c 2061 6c73 6f20 6861  you will also ha
+000230b0: 7665 2074 6865 206f 7070 6f72 7475 6e69  ve the opportuni
+000230c0: 7479 2074 6f20 7365 6c65 6374 2077 6869  ty to select whi
+000230d0: 6368 0a50 7974 686f 6e20 6578 6563 7574  ch.Python execut
+000230e0: 6162 6c65 2077 696c 6c20 6265 2075 7365  able will be use
+000230f0: 6420 6279 2074 6865 2076 6972 7475 616c  d by the virtual
+00023100: 2065 6e76 6972 6f6e 6d65 6e74 2e0a 0a50   environment...P
+00023110: 7943 6861 726d 2077 696c 6c20 7468 656e  yCharm will then
+00023120: 2063 7265 6174 6520 6120 6e65 7720 506f   create a new Po
+00023130: 6574 7279 2076 6972 7475 616c 2065 6e76  etry virtual env
+00023140: 6972 6f6e 6d65 6e74 2066 6f72 2079 6f75  ironment for you
+00023150: 7220 7072 6f6a 6563 742c 2075 7369 6e67  r project, using
+00023160: 0a61 2070 6172 7469 6375 6c61 7220 7665  .a particular ve
+00023170: 7273 696f 6e20 6f66 2050 7974 686f 6e2c  rsion of Python,
+00023180: 2061 6e64 2061 6c73 6f20 696e 7374 616c   and also instal
+00023190: 6c20 696e 746f 2074 6869 7320 7669 7274  l into this virt
+000231a0: 7561 6c20 656e 7669 726f 6e6d 656e 7420  ual environment 
+000231b0: 7468 650a 7072 6f6a 6563 7427 7320 7061  the.project's pa
+000231c0: 636b 6167 6520 6465 7065 6e64 656e 6369  ckage dependenci
+000231d0: 6573 2061 6363 6f72 6469 6e67 2074 6f20  es according to 
+000231e0: 7468 6520 7072 6f6a 6563 7427 7320 6070  the project's `p
+000231f0: 6f65 7472 792e 6c6f 636b 6020 6669 6c65  oetry.lock` file
+00023200: 2e0a 0a59 6f75 2063 616e 2061 6464 2064  ...You can add d
+00023210: 6966 6665 7265 6e74 2050 6f65 7472 7920  ifferent Poetry 
+00023220: 656e 7669 726f 6e6d 656e 7473 2066 6f72  environments for
+00023230: 2064 6966 6665 7265 6e74 2050 7974 686f   different Pytho
+00023240: 6e20 7665 7273 696f 6e73 2c20 616e 6420  n versions, and 
+00023250: 7377 6974 6368 0a62 6574 7765 656e 2074  switch.between t
+00023260: 6865 6d20 7573 696e 6720 7468 6520 2250  hem using the "P
+00023270: 7974 686f 6e20 496e 7465 7270 7265 7465  ython Interprete
+00023280: 7222 2073 6574 7469 6e67 7320 6f66 2050  r" settings of P
+00023290: 7943 6861 726d 2e20 4966 2079 6f75 2077  yCharm. If you w
+000232a0: 616e 7420 746f 2075 7365 0a61 2076 6572  ant to use.a ver
+000232b0: 7369 6f6e 206f 6620 5079 7468 6f6e 2074  sion of Python t
+000232c0: 6861 7420 6973 6e27 7420 696e 7374 616c  hat isn't instal
+000232d0: 6c65 642c 2065 6974 6865 7220 7573 6520  led, either use 
+000232e0: 796f 7572 2066 6176 6f75 7269 7465 2070  your favourite p
+000232f0: 6163 6b61 6765 206d 616e 6167 6572 2c0a  ackage manager,.
+00023300: 6f72 2069 6e73 7461 6c6c 2050 7974 686f  or install Pytho
+00023310: 6e20 6279 2064 6f77 6e6c 6f61 6469 6e67  n by downloading
+00023320: 2061 6e20 696e 7374 616c 6c65 7220 666f   an installer fo
+00023330: 7220 7265 6365 6e74 2076 6572 7369 6f6e  r recent version
+00023340: 7320 6f66 2050 7974 686f 6e20 6469 7265  s of Python dire
+00023350: 6374 6c79 0a66 726f 6d20 7468 6520 5b50  ctly.from the [P
+00023360: 7974 686f 6e20 7765 6273 6974 655d 2868  ython website](h
+00023370: 7474 7073 3a2f 2f77 7777 2e70 7974 686f  ttps://www.pytho
+00023380: 6e2e 6f72 672f 646f 776e 6c6f 6164 732f  n.org/downloads/
+00023390: 292e 0a0a 4f6e 6365 2070 726f 6a65 6374  )...Once project
+000233a0: 2064 6570 656e 6465 6e63 6965 7320 6861   dependencies ha
+000233b0: 7665 2062 6565 6e20 696e 7374 616c 6c65  ve been installe
+000233c0: 642c 2079 6f75 2073 686f 756c 6420 6265  d, you should be
+000233d0: 2061 626c 6520 746f 2072 756e 2074 6573   able to run tes
+000233e0: 7473 0a66 726f 6d20 7769 7468 696e 2050  ts.from within P
+000233f0: 7943 6861 726d 2028 7269 6768 742d 636c  yCharm (right-cl
+00023400: 6963 6b20 6f6e 2074 6865 2060 7465 7374  ick on the `test
+00023410: 7360 2066 6f6c 6465 7220 616e 6420 7365  s` folder and se
+00023420: 6c65 6374 2074 6865 2027 5275 6e27 206f  lect the 'Run' o
+00023430: 7074 696f 6e29 2e0a 0a42 6563 6175 7365  ption)...Because
+00023440: 206f 6620 6120 636f 6e66 6c69 6374 2062   of a conflict b
+00023450: 6574 7765 656e 2070 7974 6573 7420 616e  etween pytest an
+00023460: 6420 5079 4368 6172 6d27 7320 6465 6275  d PyCharm's debu
+00023470: 6767 6572 2061 6e64 2074 6865 2063 6f76  gger and the cov
+00023480: 6572 6167 6520 746f 6f6c 2c0a 796f 7520  erage tool,.you 
+00023490: 6d61 7920 6e65 6564 2074 6f20 6164 6420  may need to add 
+000234a0: 6060 2d2d 6e6f 2d63 6f76 6060 2061 7320  ``--no-cov`` as 
+000234b0: 616e 206f 7074 696f 6e20 746f 2074 6865  an option to the
+000234c0: 2074 6573 7420 7275 6e6e 6572 2074 656d   test runner tem
+000234d0: 706c 6174 652e 2041 6c74 6572 6e61 7469  plate. Alternati
+000234e0: 7665 6c79 2c0a 6a75 7374 2075 7365 2074  vely,.just use t
+000234f0: 6865 2050 7974 686f 6e20 5374 616e 6461  he Python Standa
+00023500: 7264 204c 6962 7261 7279 2773 2060 6075  rd Library's ``u
+00023510: 6e69 7474 6573 7460 6020 6d6f 6475 6c65  nittest`` module
+00023520: 2e0a 0a59 6f75 2073 686f 756c 6420 616c  ...You should al
+00023530: 736f 2062 6520 6162 6c65 2074 6f20 6f70  so be able to op
+00023540: 656e 2061 2074 6572 6d69 6e61 6c20 7769  en a terminal wi
+00023550: 6e64 6f77 2069 6e20 5079 4368 6172 6d2c  ndow in PyCharm,
+00023560: 2061 6e64 2072 756e 2074 6865 2070 726f   and run the pro
+00023570: 6a65 6374 2773 0a4d 616b 6566 696c 6520  ject's.Makefile 
+00023580: 636f 6d6d 616e 6473 2066 726f 6d20 7468  commands from th
+00023590: 6520 636f 6d6d 616e 6420 6c69 6e65 2028  e command line (
+000235a0: 7365 6520 6265 6c6f 7729 2e0a 0a23 2323  see below)...###
+000235b0: 2053 6574 7570 2066 726f 6d20 636f 6d6d   Setup from comm
+000235c0: 616e 6420 6c69 6e65 3c61 2069 643d 2273  and line<a id="s
+000235d0: 6574 7570 2d66 726f 6d2d 636f 6d6d 616e  etup-from-comman
+000235e0: 642d 6c69 6e65 223e 3c2f 613e 0a0a 4f62  d-line"></a>..Ob
+000235f0: 7461 696e 2074 6865 2070 726f 6a65 6374  tain the project
+00023600: 2066 696c 6573 2c20 7573 696e 6720 4769   files, using Gi
+00023610: 7420 6f72 2073 7569 7461 626c 6520 616c  t or suitable al
+00023620: 7465 726e 6174 6976 652e 0a0a 496e 2061  ternative...In a
+00023630: 2074 6572 6d69 6e61 6c20 6170 706c 6963   terminal applic
+00023640: 6174 696f 6e2c 2063 6861 6e67 6520 796f  ation, change yo
+00023650: 7572 2063 7572 7265 6e74 2077 6f72 6b69  ur current worki
+00023660: 6e67 2064 6972 6563 746f 7279 0a74 6f20  ng directory.to 
+00023670: 7468 6520 726f 6f74 2066 6f6c 6465 7220  the root folder 
+00023680: 6f66 2074 6865 2070 726f 6a65 6374 2066  of the project f
+00023690: 696c 6573 2e20 5468 6572 6520 7368 6f75  iles. There shou
+000236a0: 6c64 2062 6520 6120 4d61 6b65 6669 6c65  ld be a Makefile
+000236b0: 0a69 6e20 7468 6973 2066 6f6c 6465 722e  .in this folder.
+000236c0: 0a0a 5573 6520 7468 6520 4d61 6b65 6669  ..Use the Makefi
+000236d0: 6c65 2074 6f20 6372 6561 7465 2061 206e  le to create a n
+000236e0: 6577 2050 6f65 7472 7920 7669 7274 7561  ew Poetry virtua
+000236f0: 6c20 656e 7669 726f 6e6d 656e 7420 666f  l environment fo
+00023700: 7220 7468 650a 7072 6f6a 6563 7420 616e  r the.project an
+00023710: 6420 696e 7374 616c 6c20 7468 6520 7072  d install the pr
+00023720: 6f6a 6563 7427 7320 7061 636b 6167 6520  oject's package 
+00023730: 6465 7065 6e64 656e 6369 6573 2069 6e74  dependencies int
+00023740: 6f20 6974 2c0a 7573 696e 6720 7468 6520  o it,.using the 
+00023750: 666f 6c6c 6f77 696e 6720 636f 6d6d 616e  following comman
+00023760: 642e 0a0a 2020 2020 2420 6d61 6b65 2069  d...    $ make i
+00023770: 6e73 7461 6c6c 2d70 6163 6b61 6765 730a  nstall-packages.
+00023780: 0a49 7427 7320 616c 736f 2070 6f73 7369  .It's also possi
+00023790: 626c 6520 746f 2061 6c73 6f20 696e 7374  ble to also inst
+000237a0: 616c 6c20 7468 6520 7072 6f6a 6563 7420  all the project 
+000237b0: 696e 2027 6564 6974 6162 6c65 206d 6f64  in 'editable mod
+000237c0: 6527 2e0a 0a20 2020 2024 206d 616b 6520  e'...    $ make 
+000237d0: 696e 7374 616c 6c0a 0a50 6c65 6173 6520  install..Please 
+000237e0: 6e6f 7465 2c20 6966 2079 6f75 2063 7265  note, if you cre
+000237f0: 6174 6520 7468 6520 7669 7274 7561 6c20  ate the virtual 
+00023800: 656e 7669 726f 6e6d 656e 7420 696e 2074  environment in t
+00023810: 6869 7320 7761 792c 2061 6e64 2074 6865  his way, and the
+00023820: 6e20 7472 7920 746f 0a6f 7065 6e20 7468  n try to.open th
+00023830: 6520 7072 6f6a 6563 7420 696e 2050 7943  e project in PyC
+00023840: 6861 726d 2061 6e64 2063 6f6e 6669 6775  harm and configu
+00023850: 7265 2074 6865 2070 726f 6a65 6374 2074  re the project t
+00023860: 6f20 7573 6520 7468 6973 2076 6972 7475  o use this virtu
+00023870: 616c 0a65 6e76 6972 6f6e 6d65 6e74 2061  al.environment a
+00023880: 7320 616e 2022 4578 6973 7469 6e67 2050  s an "Existing P
+00023890: 6f65 7472 7920 456e 7669 726f 6e6d 656e  oetry Environmen
+000238a0: 7422 2c20 5079 4368 6172 6d20 736f 6d65  t", PyCharm some
+000238b0: 7469 6d65 7320 6861 7320 736f 6d65 0a69  times has some.i
+000238c0: 7373 7565 7320 2864 6f6e 2774 206b 6e6f  ssues (don't kno
+000238d0: 7720 7768 7929 2077 6869 6368 206d 6967  w why) which mig
+000238e0: 6874 2062 6520 7072 6f62 6c65 6d61 7469  ht be problemati
+000238f0: 632e 2049 6620 796f 7520 656e 636f 756e  c. If you encoun
+00023900: 7465 7220 7375 6368 0a69 7373 7565 732c  ter such.issues,
+00023910: 2079 6f75 2063 616e 2072 6573 6f6c 7665   you can resolve
+00023920: 2074 6865 7365 2069 7373 7565 7320 6279   these issues by
+00023930: 2064 656c 6574 696e 6720 7468 6520 7669   deleting the vi
+00023940: 7274 7561 6c20 656e 7669 726f 6e6d 656e  rtual environmen
+00023950: 740a 616e 6420 6372 6561 7469 6e67 2074  t.and creating t
+00023960: 6865 2050 6f65 7472 7920 7669 7274 7561  he Poetry virtua
+00023970: 6c20 656e 7669 726f 6e6d 656e 7420 7573  l environment us
+00023980: 696e 6720 5079 4368 6172 6d20 2873 6565  ing PyCharm (see
+00023990: 2061 626f 7665 292e 0a0a 2323 2320 5072   above)...### Pr
+000239a0: 6f6a 6563 7420 4d61 6b65 6669 6c65 2063  oject Makefile c
+000239b0: 6f6d 6d61 6e64 733c 6120 6964 3d22 7072  ommands<a id="pr
+000239c0: 6f6a 6563 742d 6d61 6b65 6669 6c65 2d63  oject-makefile-c
+000239d0: 6f6d 6d61 6e64 7322 3e3c 2f61 3e0a 0a59  ommands"></a>..Y
+000239e0: 6f75 2063 616e 2073 7461 7274 2045 7665  ou can start Eve
+000239f0: 6e74 5374 6f72 6544 4220 7573 696e 6720  ntStoreDB using 
+00023a00: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
+00023a10: 6d6d 616e 642e 0a0a 2020 2020 2420 6d61  mmand...    $ ma
+00023a20: 6b65 2073 7461 7274 2d65 7665 6e74 7374  ke start-eventst
+00023a30: 6f72 6564 620a 0a59 6f75 2063 616e 2072  oredb..You can r
+00023a40: 756e 2074 6573 7473 2075 7369 6e67 2074  un tests using t
+00023a50: 6865 2066 6f6c 6c6f 7769 6e67 2063 6f6d  he following com
+00023a60: 6d61 6e64 2028 6e65 6564 7320 4576 656e  mand (needs Even
+00023a70: 7453 746f 7265 4442 2074 6f20 6265 2072  tStoreDB to be r
+00023a80: 756e 6e69 6e67 292e 0a0a 2020 2020 2420  unning)...    $ 
+00023a90: 6d61 6b65 2074 6573 740a 0a59 6f75 2063  make test..You c
+00023aa0: 616e 2073 746f 7020 4576 656e 7453 746f  an stop EventSto
+00023ab0: 7265 4442 2075 7369 6e67 2074 6865 2066  reDB using the f
+00023ac0: 6f6c 6c6f 7769 6e67 2063 6f6d 6d61 6e64  ollowing command
+00023ad0: 2e0a 0a20 2020 2024 206d 616b 6520 7374  ...    $ make st
+00023ae0: 6f70 2d65 7665 6e74 7374 6f72 6564 620a  op-eventstoredb.
+00023af0: 0a59 6f75 2063 616e 2063 6865 636b 2074  .You can check t
+00023b00: 6865 2066 6f72 6d61 7474 696e 6720 6f66  he formatting of
+00023b10: 2074 6865 2063 6f64 6520 7573 696e 6720   the code using 
+00023b20: 7468 6520 666f 6c6c 6f77 696e 6720 636f  the following co
+00023b30: 6d6d 616e 642e 0a0a 2020 2020 2420 6d61  mmand...    $ ma
+00023b40: 6b65 206c 696e 740a 0a59 6f75 2063 616e  ke lint..You can
+00023b50: 2072 6566 6f72 6d61 7420 7468 6520 636f   reformat the co
+00023b60: 6465 2075 7369 6e67 2074 6865 2066 6f6c  de using the fol
+00023b70: 6c6f 7769 6e67 2063 6f6d 6d61 6e64 2e0a  lowing command..
+00023b80: 0a20 2020 2024 206d 616b 6520 666d 740a  .    $ make fmt.
+00023b90: 0a54 6573 7473 2062 656c 6f6e 6720 696e  .Tests belong in
+00023ba0: 2060 2e2f 7465 7374 7360 2e20 436f 6465   `./tests`. Code
+00023bb0: 2d75 6e64 6572 2d74 6573 7420 6265 6c6f  -under-test belo
+00023bc0: 6e67 7320 696e 2060 2e2f 6573 6462 636c  ngs in `./esdbcl
+00023bd0: 6965 6e74 602e 0a0a 4564 6974 2070 6163  ient`...Edit pac
+00023be0: 6b61 6765 2064 6570 656e 6465 6e63 6965  kage dependencie
+00023bf0: 7320 696e 2060 7079 7072 6f6a 6563 742e  s in `pyproject.
+00023c00: 746f 6d6c 602e 2055 7064 6174 6520 696e  toml`. Update in
+00023c10: 7374 616c 6c65 6420 7061 636b 6167 6573  stalled packages
+00023c20: 2028 616e 6420 7468 650a 6070 6f65 7472   (and the.`poetr
+00023c30: 792e 6c6f 636b 6020 6669 6c65 2920 7573  y.lock` file) us
+00023c40: 696e 6720 7468 6520 666f 6c6c 6f77 696e  ing the followin
+00023c50: 6720 636f 6d6d 616e 642e 0a0a 2020 2020  g command...    
+00023c60: 2420 6d61 6b65 2075 7064 6174 652d 7061  $ make update-pa
+00023c70: 636b 6167 6573 0a                        ckages.
```

